* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL640.cbl
* Options: int("EL640.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL640.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL640.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL640.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL640.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 15:38:12.
     7*                            VMOD=2.040
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL640.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.    TRANSACTION - EXC1 - ACCOUNT BILLING.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL640AO FILLER
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 083104    2004083000002  PEMA PREVENT ONLINE BILLING
    37* 072105    2004120100002  PEMA FIX ONLINE BILLING FOR DCC SPP
    38* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    39* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    40******************************************************************
    41 ENVIRONMENT DIVISION.
    42
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL640.cbl
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL640 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.040 ************'.
    50 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    51 77  S1                          PIC S999 COMP-3 VALUE +0.
    52
    53*    COPY ELCSCTM.
    54******************************************************************
    55*                                                                *
    56*                                                                *
    57*                            ELCSCTM                             *
    58*                            VMOD=2.001                          *
    59*                                                                *
    60*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    61*                                                                *
    62******************************************************************
    63 01  SECURITY-MESSAGE.
    64     12  FILLER                          PIC X(30)
    65            VALUE '** LOGIC SECURITY VIOLATION -'.
    66     12  SM-READ                         PIC X(6).
    67     12  FILLER                          PIC X(5)
    68            VALUE ' PGM='.
    69     12  SM-PGM                          PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' OPR='.
    72     12  SM-PROCESSOR-ID                 PIC X(4).
    73     12  FILLER                          PIC X(6)
    74            VALUE ' TERM='.
    75     12  SM-TERMID                       PIC X(4).
    76     12  FILLER                          PIC XX   VALUE SPACE.
    77     12  SM-JUL-DATE                     PIC 9(5).
    78     12  FILLER                          PIC X    VALUE SPACE.
    79     12  SM-TIME                         PIC 99.99.
    80
    81*    COPY ELCSCRTY.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCRTY                            *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    89*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    90*        SAVED IN PI-SECURITY-ADDRESS.                           *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-CONTROL.
    94     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    95     12  FILLER                       PIC XX    VALUE 'SC'.
    96     12  SC-CREDIT-CODES.
    97         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    98             20  SC-CREDIT-DISPLAY    PIC X.
    99             20  SC-CREDIT-UPDATE     PIC X.
   100     12  SC-CLAIMS-CODES.
   101         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL640.cbl
   102             20  SC-CLAIMS-DISPLAY    PIC X.
   103             20  SC-CLAIMS-UPDATE     PIC X.
   104
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL640.cbl
   106 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   107     88  RESP-NORMAL               VALUE +0.
   108     88  RESP-NOTFND               VALUE +13.
   109     88  RESP-NOTOPEN              VALUE +19.
   110     88  RESP-ENDFILE              VALUE +20.
   111
   112 01  STANDARD-AREAS.
   113     12  WS-AH-CATEGORY              PIC X       VALUE ' '.
   114     12  CLAS-LOOK                   PIC XX      VALUE '  '.
   115     12  SC-ITEM             PIC S9(4) COMP VALUE +1.
   116
   117     12  W-TRANSFER-CONTROL.
   118         16  WT-CR-CARRIER           PIC X     VALUE SPACES.
   119         16  WT-CR-GROUPING          PIC X(6)  VALUE SPACES.
   120         16  WT-CR-STATE             PIC XX    VALUE SPACES.
   121         16  WT-CR-ACCOUNT           PIC X(10) VALUE SPACES.
   122         16  WT-CR-FIN-RESP          PIC X(10) VALUE SPACES.
   123         16  WT-CR-TYPE              PIC X     VALUE SPACES.
   124
   125     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   126     12  MAP-NAME            PIC X(8)    VALUE 'EL640A'.
   127     12  MAPSET-NAME         PIC X(8)    VALUE 'EL640S'.
   128     12  SCREEN-NUMBER       PIC X(4)    VALUE '640A'.
   129     12  TRANS-ID            PIC X(4)    VALUE 'EXC1'.
   130     12  EL6311-TRANS-ID     PIC X(4)    VALUE 'EXB1'.
   131     12  EL633-TRANS-ID      PIC X(4)    VALUE 'EXB7'.
   132     12  EL633DMD-TRANS-ID   PIC X(4)    VALUE 'EX1F'.
   133     12  EL635-TRANS-ID      PIC X(4)    VALUE 'EXJ4'.
   134     12  EL650-TRANS-ID      PIC X(4)    VALUE 'EXC4'.
   135     12  EL652-TRANS-ID      PIC X(4)    VALUE 'EXD4'.
   136     12  EL658-TRANS-ID      PIC X(4)    VALUE 'EXJ3'.
   137     12  THIS-PGM            PIC X(8)    VALUE 'EL640'.
   138     12  EL640A              PIC X(8)    VALUE 'EL640A'.
   139     12  EL640B              PIC X(8)    VALUE 'EL640B'.
   140     12  PGM-NAME            PIC X(8).
   141     12  TIME-IN             PIC S9(7).
   142     12  TIME-OUT-R  REDEFINES TIME-IN.
   143         16  FILLER          PIC X.
   144         16  TIME-OUT        PIC 99V99.
   145         16  FILLER          PIC XX.
   146
   147     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   148     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   149     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   150     12  XCTL-633            PIC X(8)    VALUE 'EL633'.
   151     12  XCTL-633DMD         PIC X(8)    VALUE 'EL633DMD'.
   152     12  XCTL-635            PIC X(8)    VALUE 'EL635'.
   153     12  XCTL-PYAJ           PIC X(8)    VALUE 'EL633'.
   154     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   155     12  XCTL-652            PIC X(8)    VALUE 'EL652'.
   156     12  XCTL-658            PIC X(8)    VALUE 'EL658'.
   157     12  XCTL-6401           PIC X(8)    VALUE 'EL6401'.
   158     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   159     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   160     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   161     12  ERPNDB-ALT-FILE-ID  PIC X(8)    VALUE 'ERPNDB2'.
   162     12  ERPNDB-FILE-ID      PIC X(8)    VALUE 'ERPNDB'.
   163     12  ELCNTL-FILE-ID      PIC X(8)    VALUE 'ELCNTL'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL640.cbl
   164     12  ELLETR-FILE-ID      PIC X(8)    VALUE 'ELLETR'.
   165     12  ERCOMP-FILE-ID      PIC X(8)    VALUE 'ERCOMP'.
   166     12  ERPYAJ-FILE-ID      PIC X(8)    VALUE 'ERPYAJ'.
   167     12  ERACCT-ALT-FILE-ID  PIC X(8)    VALUE 'ERACCT2'.
   168     12  ERACCT-FILE-ID      PIC X(8)    VALUE 'ERACCT'.
   169     12  ERBILL-FILE-ID      PIC X(8)    VALUE 'ERBILL'.
   170     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   171     12  QID.
   172         16  QID-TERM        PIC X(4).
   173         16  FILLER          PIC X(4)    VALUE '640A'.
   174     12  CLIENT-ITY          PIC XXX     VALUE 'ITY'.
   175
   176 01  WORK-AREA.
   177     12  W-LETTER-IND            PIC X     VALUE SPACE.
   178         88  W-LETTER-NOT-FOUND    VALUE 'Y'.
   179     12  FIRST-TIME-SW           PIC X     VALUE 'Y'.
   180         88  FIRST-TIME            VALUE 'Y'.
   181     12  C-RECORD-FOUND-SW       PIC X     VALUE 'Y'.
   182         88  C-RECORD-FOUND        VALUE 'Y'.
   183     12  ACCOUNT-FIN-RESP-SW     PIC X     VALUE ' '.
   184         88  ACCOUNT-FIN-RESP      VALUE 'Y'.
   185         88  ACCOUNT-NOT-FIN-RESP  VALUE 'N'.
   186     12  VALID-BILL-TYPE-VALUES  PIC X     VALUE SPACE.
   187         88  VALID-BILL-TYPE       VALUE  '1' '2'.
   188*        88  VALID-BILL-TYPE       VALUE  '1' '2' '3' '4' '5'.
   189     12  BILL-BATCH-TRAILER-SW   PIC X     VALUE SPACE.
   190         88  BILL-BATCH-TRAILER    VALUE 'Y'.
   191     12  PNDB-EOF-SW             PIC X     VALUE SPACE.
   192         88  PNDB-EOF              VALUE 'Y'.
   193     12  PYAJ-EOF-SW             PIC X     VALUE SPACE.
   194         88  PYAJ-EOF              VALUE 'Y'.
   195     12  COMP-UPDATE-SW          PIC X     VALUE SPACE.
   196         88  UPDATE-COMP-TOTALS    VALUE 'Y'.
   197     12  LIMIT-BILLING-SW        PIC X     VALUE SPACE.
   198         88  LIMIT-BILLING         VALUE 'Y'.
   199     12  WS-PROCESS-SW           PIC X     VALUE SPACE.
   200         88  DO-NOT-BILL-THIS-ACCT VALUE 'Y'.
   201     12  WS-CHARGEBACK-LF-SW     PIC X     VALUE SPACE.
   202         88  CHARGEBACK-CAN-LF     VALUE 'Y'.
   203         88  NO-CHARGEBACK-LF      VALUE 'N'.
   204     12  WS-CHARGEBACK-AH-SW     PIC X     VALUE SPACE.
   205         88  CHARGEBACK-CAN-AH     VALUE 'Y'.
   206         88  NO-CHARGEBACK-AH      VALUE 'N'.
   207     12  NO-BILL-REC-SW          PIC X     VALUE SPACE.
   208         88  NO-BILL-RECS          VALUE 'Y'.
   209     12  DATA-VOIDED-SW          PIC X     VALUE SPACE.
   210         88  DATA-VOIDED           VALUE 'Y'.
   211     12  BATCHES-PROCESSED-SW    PIC X     VALUE SPACE.
   212         88  MORE-THAN-6-BATCHES   VALUE 'Y'.
   213     12  BILLING-DETAIL-TYPE     PIC XX    VALUE SPACES.
   214         88  TOTAL-STATEMENT       VALUE 'TS'.
   215         88  BILLING-DETAIL        VALUE 'BD'.
   216         88  CARRIER-ADDRESS       VALUE 'CA'.
   217         88  GEN-AGT-ADDRESS       VALUE 'GA'.
   218     12  ELCNTL-UPDATE-SW        PIC X     VALUE SPACE.
   219         88  ELCNTL-UPDATE         VALUE 'Y'.
   220     12  WS-ENTERED-FROM-MAP     PIC X     VALUE 'A'.
   221         88  WS-ENTERED-FROM-A     VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL640.cbl
   222
   223     12  ACCOM-SUB               PIC 99    VALUE ZEROS.
   224     12  SUB                     PIC S999  COMP-3  VALUE ZEROS.
   225
   226     12  WORK-ZIP                PIC 9(9)  VALUE ZEROS.
   227     12  WORK-ZIPR1 REDEFINES WORK-ZIP.
   228         16  WORK-ZIPR1-4        PIC 9(4).
   229         16  WORK-ZIPR1-5        PIC 9(5).
   230     12  WORK-ZIPR2 REDEFINES WORK-ZIP.
   231         16  WORK-ZIPR2-5        PIC 9(5).
   232         16  WORK-ZIPR2-4        PIC 9(4).
   233     12  WS-AM-ZIP.
   234         16  WS-AM-ZIP-PRIME     PIC X(5).
   235         16  WS-AM-ZIP-DASH      PIC X.
   236         16  WS-AM-ZIP-PLUS4     PIC X(4).
   237     12  WS-AM-CANADIAN-ZIP  REDEFINES  WS-AM-ZIP.
   238         16  WS-AM-CAN-POST-1    PIC XXX.
   239         16  FILLER              PIC X.
   240         16  WS-AM-CAN-POST-2    PIC XXX.
   241         16  FILLER              PIC XXX.
   242     12  WS-CF-ZIP.
   243         16  WS-CF-ZIP-PRIME     PIC X(5) VALUE SPACES.
   244         16  WS-CF-ZIP-DASH      PIC X    VALUE SPACES.
   245         16  WS-CF-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   246     12  WS-CF-CANADIAN-ZIP  REDEFINES  WS-CF-ZIP.
   247         16  WS-CF-CAN-POST-1    PIC XXX.
   248         16  FILLER              PIC X.
   249         16  WS-CF-CAN-POST-2    PIC XXX.
   250         16  FILLER              PIC XXX.
   251     12  WS-CO-ZIP.
   252         16  WS-CO-ZIP-PRIME     PIC X(5) VALUE SPACES.
   253         16  WS-CO-ZIP-DASH      PIC X    VALUE SPACES.
   254         16  WS-CO-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   255     12  WS-CO-CANADIAN-ZIP  REDEFINES  WS-CO-ZIP.
   256         16  WS-CO-CAN-POST-1    PIC XXX.
   257         16  FILLER              PIC X.
   258         16  WS-CO-CAN-POST-2    PIC XXX.
   259         16  FILLER              PIC XXX.
   260
   261     12  WORK-SEQ-NO             PIC S9(9)   COMP-3 VALUE +0.
   262     12  WS-ERROR-MSG.
   263         16  WS-ERROR-TEXT       PIC X(35) VALUE SPACES.
   264         16  WS-ERROR-BATCH      PIC X(6)  VALUE SPACES.
   265         16  FILLER              PIC X(24) VALUE SPACES.
   266     12  WS-WORK-DATE.
   267         16  WS-MONTH            PIC 99    VALUE ZEROS.
   268         16  WS-DAY              PIC 99    VALUE ZEROS.
   269         16  WS-YEAR             PIC 99    VALUE ZEROS.
   270     12  WS-MONTH-END-DATE.
   271         16  WS-ME-YEAR          PIC 99    VALUE ZEROS.
   272         16  WS-ME-MONTH         PIC 99    VALUE ZEROS.
   273         16  WS-ME-DAY           PIC 99    VALUE ZEROS.
   274     12  WS-CURRENT-DATE         PIC XX    VALUE SPACES.
   275     12  WS-CURRENT-DATE-MDY     PIC X(6)  VALUE SPACES.
   276     12  WS-CURRENT-DATE-EDIT    PIC X(8)  VALUE SPACES.
   277     12  WS-PREV-BILL-DATE       PIC XX    VALUE LOW-VALUES.
   278     12  WS-BEGIN-DATE.
   279         16  FILLER              PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL640.cbl
   280         16  WS-BEGIN-DAY        PIC XX    VALUE SPACES.
   281         16  FILLER              PIC X(3)  VALUE SPACES.
   282     12  PRINT-CONTROL.
   283         16  SINGLE-SPACE        PIC X     VALUE SPACE.
   284         16  DOUBLE-SPACE        PIC X     VALUE ZERO.
   285         16  TRIPLE-SPACE        PIC X     VALUE '-'.
   286         16  SUPPRESS-SPACE      PIC X     VALUE '+'.
   287         16  TOP-OF-PAGE         PIC X     VALUE '1'.
   288     12  WS-EXP-DATE.
   289         16  WS-SAV-EXP-DT     OCCURS 10 TIMES
   290                               INDEXED BY DTNDX  PIC XX.
   291     12  WS-REMIT-TO.
   292         16  WS-SAV-REMIT-TO   OCCURS 10 TIMES
   293                               INDEXED BY RTNDX  PIC X(10).
   294     12  WORK-REMIT-TO           PIC X(10) VALUE SPACES.
   295     12  WS-REMITTED             PIC S9(6)V99 VALUE ZEROS.
   296     12  WS-LINECTR              PIC 99    VALUE ZEROS.
   297     12  WS-PGECTR               PIC 999   VALUE 1.
   298     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   299     12  WS-CARR-COMP.
   300         16  WS-CARRIER          PIC X     VALUE SPACE.
   301         16  WS-COMP             PIC X(6)  VALUE SPACES.
   302
   303     12  REPORT-TOTALS.
   304         16  TOT-REPT-LF-PREM    PIC S9(7)V99   VALUE ZEROS.
   305         16  TOT-REPT-LF-REF     PIC S9(7)V99   VALUE ZEROS.
   306         16  TOT-REPT-LF-COMP    PIC S9(7)V99   VALUE ZEROS.
   307         16  TOT-REPT-LF-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   308         16  TOT-REPT-AH-PREM    PIC S9(7)V99   VALUE ZEROS.
   309         16  TOT-REPT-AH-REF     PIC S9(7)V99   VALUE ZEROS.
   310         16  TOT-REPT-AH-COMP    PIC S9(7)V99   VALUE ZEROS.
   311         16  TOT-REPT-AH-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   312         16  TOT-LF-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   313         16  TOT-AH-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   314         16  TOT-REPT-PREM       PIC S9(7)V99   VALUE ZEROS.
   315         16  TOT-REPT-CANCEL-FEE PIC S9(7)V99   VALUE ZEROS.
   316     12  WORK-AMT                PIC S9(7)V99   VALUE ZEROS.
   317     12  WORK-CHECK-AMT          PIC S9(7)V99   VALUE ZEROS.
   318     12  WORK-CANCEL-FEE         PIC S9(7)V99   VALUE ZEROS.
   319     12  WS-I-LF-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   320     12  WS-I-LF-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   321     12  WS-I-AH-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   322     12  WS-I-AH-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   323     12  WS-C-LF-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   324     12  WS-C-AH-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   325     12  WS-C-CANCEL-FEE         PIC S9(5)V99   COMP-3 VALUE +0.
   326     12  WS-LF-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   327     12  WS-AH-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   328     12  WS-PAY-ADJ              PIC S9(6)V99   COMP-3 VALUE +0.
   329     12  WS-CI-LIFE-BENEFIT      PIC S9(7)V99   COMP-3 VALUE +0.
   330     12  LF-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   331     12  JT-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   332     12  AH-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   333     12  AGENT-OWES              PIC X(18)
   334                         VALUE 'AGENT OWES       ='.
   335     12  OWED-TO-AGENT           PIC X(18)
   336                         VALUE 'OWED TO AGENT    ='.
   337     12  WS-PY-ENTRY-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL640.cbl
   338         16  WS-PY-CURRENT-DATE      PIC X(6) VALUE SPACES.
   339         16  FILLER                  PIC X(14) VALUE
   340             ' CHK TO AGENT'.
   341
   342     12  WS-ITY-COMMENT.
   343         16  WS-PY-BEGIN-DT          PIC X(8) VALUE SPACES.
   344         16  FILLER                  PIC X(06) VALUE
   345             ' THRU '.
   346         16  WS-PY-END-DT            PIC X(8) VALUE SPACES.
   347
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL640.cbl
   349     12  WS-ACCT-ADDR-AREA.
   350         16  WS-ACCT-LINES OCCURS 6 TIMES INDEXED BY A-INDX.
   351           18  WS-ACCT-ZIP           PIC X(10) VALUE SPACES.
   352           18  FILLER                PIC X(10) VALUE SPACES.
   353           18  WS-A-LAST-ZIP         PIC X(10) VALUE SPACES.
   354
   355     12  WS-REMIT-ADDR-AREA.
   356         16  WS-REMIT-ACCT           PIC X(10) VALUE SPACES.
   357         16  WS-REMIT-LINES OCCURS 6 TIMES INDEXED BY R-INDX.
   358           18  WS-REMIT-ZIP          PIC X(10) VALUE SPACES.
   359           18  FILLER                PIC X(10) VALUE SPACES.
   360           18  WS-R-LAST-ZIP         PIC X(10) VALUE SPACES.
   361
   362     12  WS-EFFECT-DATE.
   363         16  WS-EFFECT-YR            PIC 99 VALUE ZEROS.
   364         16  WS-EFFECT-MO            PIC 99 VALUE ZEROS.
   365         16  WS-EFFECT-DA            PIC 99 VALUE ZEROS.
   366
   367     12  WS-LIFE-CANCEL-DT.
   368         16  WS-LF-CANCEL-YR         PIC 99 VALUE ZEROS.
   369         16  WS-LF-CANCEL-MO         PIC 99 VALUE ZEROS.
   370         16  WS-LF-CANCEL-DA         PIC 99 VALUE ZEROS.
   371
   372     12  WS-AH-CANCEL-DT.
   373         16  WS-AH-CANCEL-YR         PIC 99 VALUE ZEROS.
   374         16  WS-AH-CANCEL-MO         PIC 99 VALUE ZEROS.
   375         16  WS-AH-CANCEL-DA         PIC 99 VALUE ZEROS.
   376
   377     12  MONTHS-DIFF-LF            PIC S9(05)  VALUE ZEROS.
   378     12  MONTHS-DIFF-AH            PIC S9(05)  VALUE ZEROS.
   379
   380     12  WS-BENEFIT.
   381         16  FILLER                PIC X   VALUE SPACES.
   382         16  WS-BENE-CD            PIC XX  VALUE SPACES.
   383
   384     12  WS-DESC.
   385         16 WS-BATCH-DESC        PIC X(10) VALUE SPACES.
   386         16 WS-BATCH-NBR         PIC X(6)  VALUE SPACES.
   387         16 FILLER               PIC X(4)  VALUE SPACES.
   388     12  WS-NON-PREM             PIC S9(7)V99   COMP-3.
   389     12  WS-NON-COMM             PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL640.cbl
   391 01  ACCESS-KEYS.
   392     12  ERPNDB-PRIME-KEY.
   393         16  ERPNDB-CO-CD        PIC X     VALUE SPACES.
   394         16  ERPNDB-BATCH        PIC X(6)  VALUE SPACES.
   395         16  ERPNDB-SEQ-NO       PIC S9(4) COMP VALUE +0.
   396         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP VALUE +0.
   397
   398     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   399
   400     12  ERPNDB-ALT-KEY.
   401         16  ERPNDB-CO-CD-A1     PIC X     VALUE SPACES.
   402         16  ERPNDB-CARR         PIC X     VALUE SPACES.
   403         16  ERPNDB-GROUP        PIC X(6)  VALUE SPACES.
   404         16  ERPNDB-STATE        PIC XX    VALUE SPACES.
   405         16  ERPNDB-ACCT         PIC X(10) VALUE SPACES.
   406         16  ERPNDB-EFF-DT       PIC XX    VALUE SPACES.
   407         16  ERPNDB-CERT.
   408             20  ERPNDB-CERT-PRM PIC X(10) VALUE SPACES.
   409             20  ERPNDB-CERTSFX  PIC X     VALUE SPACES.
   410         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   411         16  ERPNDB-REC-TYPE     PIC X     VALUE SPACES.
   412
   413     12  ELCNTL-KEY.
   414         16  ELCNTL-COMPANY-ID   PIC XXX   VALUE SPACES.
   415         16  ELCNTL-REC-TYPE     PIC X     VALUE SPACES.
   416         16  ELCNTL-ACCESS.
   417             20  ELCNTL-FILLER   PIC X(3)  VALUE SPACES.
   418             20  ELCNTL-CARRIER  PIC X     VALUE SPACES.
   419         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   420
   421     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   422
   423     12  ERCOMP-KEY.
   424         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   425         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   426         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   427         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   428         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   429         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   430
   431     12  ERPYAJ-BROWSE-COMP-KEY.
   432         16  ERPYAJ-BR-COMP-CD   PIC X     VALUE SPACE.
   433         16  ERPYAJ-BR-CARRIER   PIC X     VALUE SPACES.
   434         16  ERPYAJ-BR-GROUPING  PIC X(6)  VALUE SPACES.
   435         16  ERPYAJ-BR-FIN-RESP  PIC X(10) VALUE SPACES.
   436         16  ERPYAJ-BR-ACCOUNT   PIC X(10) VALUE SPACES.
   437
   438     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   439
   440     12  ERPYAJ-KEY.
   441         16  ERPYAJ-COMP-CD      PIC X     VALUE SPACE.
   442         16  ERPYAJ-CARRIER      PIC X     VALUE SPACES.
   443         16  ERPYAJ-GROUPING     PIC X(6)  VALUE SPACES.
   444         16  ERPYAJ-FIN-RESP     PIC X(10) VALUE SPACES.
   445         16  ERPYAJ-ACCOUNT      PIC X(10) VALUE SPACES.
   446         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) VALUE +0 COMP.
   447         16  ERPYAJ-RECORD-TYPE  PIC X     VALUE SPACES.
   448
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL640.cbl
   449     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
   450
   451     12  ERACCT-PRIME-KEY.
   452         16  ERACCT-P-CO-CD      PIC X     VALUE SPACES.
   453         16  ERACCT-P-CARRIER    PIC X     VALUE SPACES.
   454         16  ERACCT-P-GROUPING   PIC X(6)  VALUE SPACES.
   455         16  ERACCT-P-STATE      PIC XX    VALUE SPACES.
   456         16  ERACCT-P-ACCOUNT    PIC X(10) VALUE SPACES.
   457         16  ERACCT-P-EXP-DATE   PIC XX    VALUE SPACES.
   458         16  FILLER              PIC X(4)  VALUE SPACES.
   459
   460     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   461
   462     12  ERACCT-ALT-KEY.
   463         16  ERACCT-A-CO-CD      PIC X     VALUE SPACES.
   464         16  ERACCT-A-CARRIER    PIC X     VALUE SPACES.
   465         16  ERACCT-A-GROUPING   PIC X(6)  VALUE SPACES.
   466         16  ERACCT-A-STATE      PIC XX    VALUE SPACES.
   467         16  ERACCT-A-ACCOUNT    PIC X(10) VALUE SPACES.
   468         16  ERACCT-A-EXP-DATE   PIC XX    VALUE SPACES.
   469         16  FILLER              PIC X(4)  VALUE SPACES.
   470
   471     12  ERBILL-KEY.
   472         16  ERBILL-CO-CD        PIC X.
   473         16  ERBILL-CARRIER      PIC X.
   474         16  ERBILL-GROUP        PIC X(6).
   475         16  ERBILL-ACCT         PIC X(10).
   476         16  ERBILL-FIN-RESP     PIC X(10).
   477         16  ERBILL-REC-TYPE     PIC X.
   478         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   479
   480     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   481
   482     12  ELLETR-KEY.
   483         16  ELLETR-COMPANY-CD   PIC  X      VALUE SPACE.
   484         16  ELLETR-FORM-NO      PIC  X(12)  VALUE SPACES.
   485         16  ELLETR-LINE-SEQ     PIC S9(04)  VALUE +0 COMP.
   486
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL640.cbl
   488
   489 01  ERROR-NUMBERS.
   490     12  ER-0004                 PIC X(4)  VALUE '0004'.
   491     12  ER-0008                 PIC X(4)  VALUE '0008'.
   492     12  ER-0013                 PIC X(4)  VALUE '0013'.
   493     12  ER-0022                 PIC X(4)  VALUE '0022'.
   494     12  ER-0029                 PIC X(4)  VALUE '0029'.
   495     12  ER-0070                 PIC X(4)  VALUE '0070'.
   496     12  ER-0194                 PIC X(4)  VALUE '0194'.
   497     12  ER-0195                 PIC X(4)  VALUE '0195'.
   498     12  ER-0196                 PIC X(4)  VALUE '0196'.
   499     12  ER-0197                 PIC X(4)  VALUE '0197'.
   500     12  ER-2208                 PIC X(4)  VALUE '2208'.
   501     12  ER-2210                 PIC X(4)  VALUE '2210'.
   502     12  ER-2212                 PIC X(4)  VALUE '2212'.
   503     12  ER-2215                 PIC X(4)  VALUE '2215'.
   504     12  ER-2230                 PIC X(4)  VALUE '2230'.
   505     12  ER-2233                 PIC X(4)  VALUE '2233'.
   506     12  ER-2249                 PIC X(4)  VALUE '2249'.
   507     12  ER-2250                 PIC X(4)  VALUE '2250'.
   508     12  ER-2370                 PIC X(4)  VALUE '2370'.
   509     12  ER-2371                 PIC X(4)  VALUE '2371'.
   510     12  ER-2383                 PIC X(4)  VALUE '2383'.
   511     12  ER-2385                 PIC X(4)  VALUE '2385'.
   512     12  ER-2401                 PIC X(4)  VALUE '2401'.
   513     12  ER-2403                 PIC X(4)  VALUE '2403'.
   514     12  ER-2404                 PIC X(4)  VALUE '2404'.
   515     12  ER-2405                 PIC X(4)  VALUE '2405'.
   516     12  ER-2406                 PIC X(4)  VALUE '2406'.
   517     12  ER-2407                 PIC X(4)  VALUE '2407'.
   518     12  ER-2408                 PIC X(4)  VALUE '2408'.
   519     12  ER-2409                 PIC X(4)  VALUE '2409'.
   520     12  ER-2411                 PIC X(4)  VALUE '2411'.
   521     12  ER-2421                 PIC X(4)  VALUE '2421'.
   522     12  ER-2434                 PIC X(4)  VALUE '2434'.
   523     12  ER-2435                 PIC X(4)  VALUE '2435'.
   524     12  ER-2436                 PIC X(4)  VALUE '2436'.
   525     12  ER-2438                 PIC X(4)  VALUE '2438'.
   526     12  ER-2439                 PIC X(4)  VALUE '2439'.
   527     12  ER-2443                 PIC X(4)  VALUE '2443'.
   528     12  ER-2472                 PIC X(4)  VALUE '2472'.
   529     12  ER-2539                 PIC X(4)  VALUE '2539'.
   530     12  ER-2564                 PIC X(4)  VALUE '2564'.
   531     12  ER-2570                 PIC X(4)  VALUE '2570'.
   532     12  ER-2571                 PIC X(4)  VALUE '2571'.
   533     12  ER-2597                 PIC X(4)  VALUE '2597'.
   534     12  ER-3145                 PIC X(4)  VALUE '3145'.
   535     12  ER-3165                 PIC X(4)  VALUE '3165'.
   536     12  ER-3188                 PIC X(4)  VALUE '3188'.
   537     12  ER-7389                 PIC X(4)  VALUE '7389'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL640.cbl
   539 01  BI-REPORT-HEADINGS.
   540     12  BI-PREVIEW-HD.
   541         16  FILLER          PIC X(42)           VALUE SPACES.
   542         16  FILLER          PIC X(47)           VALUE
   543                '**** STATEMENT IS FOR REVIEW PURPOSES ONLY ****'.
   544         16  FILLER          PIC X(43)           VALUE SPACES.
   545
   546     12  BI-HD1.
   547         16  FILLER          PIC X(44)           VALUE SPACES.
   548         16  FILLER          PIC X(44)           VALUE
   549                 '  CREDIT LIFE, ACCIDENT & HEALTH STATEMENT  '.
   550         16  FILLER          PIC X(36)           VALUE SPACES.
   551         16  FILLER          PIC X(8)            VALUE ' EL640 '.
   552
   553     12  BI-HD2.
   554         16  FILLER          PIC X(51)           VALUE SPACES.
   555         16  BI-HD-CO        PIC X(30).
   556         16  FILLER          PIC X(43)           VALUE SPACES.
   557         16  BI-HD-RUN-DT    PIC X(8)            VALUE SPACES.
   558
   559     12  BI-HD3.
   560         16  FILLER          PIC X(57)           VALUE SPACES.
   561         16  BI-HD-BILL-DT   PIC X(18).
   562         16  FILLER          PIC X(37)           VALUE SPACES.
   563         16  FILLER          PIC X(5)            VALUE 'PAGE'.
   564         16  BI-HD-PG        PIC ZZ,ZZ9.
   565
   566     12  BI-HD4.
   567         16  FILLER          PIC  X(44)      VALUE
   568             '                               CERTIFICATE  '.
   569         16  FILLER          PIC  X(44)      VALUE
   570             'EFFECTIVE   CANCEL       BEN.      WRITTEN  '.
   571         12  FILLER          PIC  X(44)      VALUE
   572             '    COMP.                    FACE AMOUNT /  '.
   573
   574     12  BI-HD5.
   575         16  FILLER          PIC  X(44)      VALUE
   576             '       NAME OF INSURED            NUMBER    '.
   577         16  FILLER          PIC  X(44)      VALUE
   578             '  DATE       DATE   TERM TYPE      PREMIUM  '.
   579         16  FILLER          PIC  X(44)      VALUE
   580             '     PCT.    COMPENSATION        BENEFIT    '.
   581
   582     12  BI-HD6.
   583         16  FILLER          PIC  X(44)      VALUE SPACES.
   584         16  FILLER          PIC  X(37)      VALUE SPACES.
   585         16  FILLER          PIC  X(45)      VALUE
   586             '     PROCESSED                  NON-PROCESSED'.
   587         16  FILLER          PIC  X(07)      VALUE SPACES.
   588     12  BI-HD7.
   589         16  FILLER          PIC  X(44)      VALUE SPACES.
   590         16  FILLER          PIC  X(35)      VALUE SPACES.
   591         16  FILLER          PIC  X(45)      VALUE
   592             ' PREMIUM     COMMISSION        PREMIUM     CO'.
   593         16  FILLER          PIC  X(09)      VALUE
   594             'MMISSION'.
   595
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL640.cbl
   597
   598*                            COPY ELCDATE.
   599******************************************************************
   600*                                                                *
   601*                                                                *
   602*                            ELCDATE.                            *
   603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   604*                            VMOD=2.003
   605*                                                                *
   606*                                                                *
   607*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   608*                 LENGTH = 200                                   *
   609******************************************************************
   610
   611 01  DATE-CONVERSION-DATA.
   612     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   613     12  DC-OPTION-CODE                PIC X.
   614         88  BIN-TO-GREG                VALUE ' '.
   615         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   616         88  EDIT-GREG-TO-BIN           VALUE '2'.
   617         88  YMD-GREG-TO-BIN            VALUE '3'.
   618         88  MDY-GREG-TO-BIN            VALUE '4'.
   619         88  JULIAN-TO-BIN              VALUE '5'.
   620         88  BIN-PLUS-ELAPSED           VALUE '6'.
   621         88  FIND-CENTURY               VALUE '7'.
   622         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   623         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   624         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   625         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   626         88  JULIAN-TO-BIN-3            VALUE 'C'.
   627         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   628         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   629         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   630         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   631         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   632         88  CHECK-LEAP-YEAR            VALUE 'H'.
   633         88  BIN-3-TO-GREG              VALUE 'I'.
   634         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   635         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   636         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   637         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   638         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   639         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   640         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   641         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   642         88  THREE-CHARACTER-BIN
   643                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   644         88  GREGORIAN-TO-BIN
   645                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   646         88  BIN-TO-GREGORIAN
   647                  VALUES ' ' '1' 'I' '8' 'G'.
   648         88  JULIAN-TO-BINARY
   649                  VALUES '5' 'C' 'E' 'F'.
   650     12  DC-ERROR-CODE                 PIC X.
   651         88  NO-CONVERSION-ERROR        VALUE ' '.
   652         88  DATE-CONVERSION-ERROR
   653                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   654         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL640.cbl
   655         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   656         88  DATE-IS-INVALID            VALUE '3'.
   657         88  DATE1-GREATER-DATE2        VALUE '4'.
   658         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   659         88  DATE-INVALID-OPTION        VALUE '9'.
   660         88  INVALID-CENTURY            VALUE 'A'.
   661         88  ONLY-CENTURY               VALUE 'B'.
   662         88  ONLY-LEAP-YEAR             VALUE 'C'.
   663         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   664     12  DC-END-OF-MONTH               PIC X.
   665         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   666     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   667         88  USE-NORMAL-PROCESS         VALUE ' '.
   668         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   669         88  ADJUST-UP-100-YRS          VALUE '2'.
   670     12  FILLER                        PIC X.
   671     12  DC-CONVERSION-DATES.
   672         16  DC-BIN-DATE-1             PIC XX.
   673         16  DC-BIN-DATE-2             PIC XX.
   674         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   675         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   676                       DC-GREG-DATE-1-EDIT.
   677             20  DC-EDIT1-MONTH        PIC 99.
   678             20  SLASH1-1              PIC X.
   679             20  DC-EDIT1-DAY          PIC 99.
   680             20  SLASH1-2              PIC X.
   681             20  DC-EDIT1-YEAR         PIC 99.
   682         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   683         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   684                     DC-GREG-DATE-2-EDIT.
   685             20  DC-EDIT2-MONTH        PIC 99.
   686             20  SLASH2-1              PIC X.
   687             20  DC-EDIT2-DAY          PIC 99.
   688             20  SLASH2-2              PIC X.
   689             20  DC-EDIT2-YEAR         PIC 99.
   690         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   691         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   692                     DC-GREG-DATE-1-YMD.
   693             20  DC-YMD-YEAR           PIC 99.
   694             20  DC-YMD-MONTH          PIC 99.
   695             20  DC-YMD-DAY            PIC 99.
   696         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   697         16  DC-GREG-DATE-1-MDY-R REDEFINES
   698                      DC-GREG-DATE-1-MDY.
   699             20  DC-MDY-MONTH          PIC 99.
   700             20  DC-MDY-DAY            PIC 99.
   701             20  DC-MDY-YEAR           PIC 99.
   702         16  DC-GREG-DATE-1-ALPHA.
   703             20  DC-ALPHA-MONTH        PIC X(10).
   704             20  DC-ALPHA-DAY          PIC 99.
   705             20  FILLER                PIC XX.
   706             20  DC-ALPHA-CENTURY.
   707                 24 DC-ALPHA-CEN-N     PIC 99.
   708             20  DC-ALPHA-YEAR         PIC 99.
   709         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   710         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   711         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   712         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL640.cbl
   713         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   714                                       PIC 9(05).
   715         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   716             20  DC-JULIAN-YEAR        PIC 99.
   717             20  DC-JULIAN-DAYS        PIC 999.
   718         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   719         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   720         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   721     12  DATE-CONVERSION-VARIBLES.
   722         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   723         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   724             20  FILLER                PIC 9(3).
   725             20  HOLD-CEN-1-CCYY.
   726                 24  HOLD-CEN-1-CC     PIC 99.
   727                 24  HOLD-CEN-1-YY     PIC 99.
   728             20  HOLD-CEN-1-MO         PIC 99.
   729             20  HOLD-CEN-1-DA         PIC 99.
   730         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   731             20  HOLD-CEN-1-R-MO       PIC 99.
   732             20  HOLD-CEN-1-R-DA       PIC 99.
   733             20  HOLD-CEN-1-R-CCYY.
   734                 24  HOLD-CEN-1-R-CC   PIC 99.
   735                 24  HOLD-CEN-1-R-YY   PIC 99.
   736             20  FILLER                PIC 9(3).
   737         16  HOLD-CENTURY-1-X.
   738             20  FILLER                PIC X(3)  VALUE SPACES.
   739             20  HOLD-CEN-1-X-CCYY.
   740                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   741                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   743             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   744         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   745             20  HOLD-CEN-1-R-X-MO     PIC XX.
   746             20  HOLD-CEN-1-R-X-DA     PIC XX.
   747             20  HOLD-CEN-1-R-X-CCYY.
   748                 24  HOLD-CEN-1-R-X-CC PIC XX.
   749                 24  HOLD-CEN-1-R-X-YY PIC XX.
   750             20  FILLER                PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   752         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   753         16  DC-JULIAN-DATE-1          PIC 9(07).
   754         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   755             20  DC-JULIAN-1-CCYY.
   756                 24  DC-JULIAN-1-CC    PIC 99.
   757                 24  DC-JULIAN-1-YR    PIC 99.
   758             20  DC-JULIAN-DA-1        PIC 999.
   759         16  DC-JULIAN-DATE-2          PIC 9(07).
   760         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   761             20  DC-JULIAN-2-CCYY.
   762                 24  DC-JULIAN-2-CC    PIC 99.
   763                 24  DC-JULIAN-2-YR    PIC 99.
   764             20  DC-JULIAN-DA-2        PIC 999.
   765         16  DC-GREG-DATE-A-EDIT.
   766             20  DC-EDITA-MONTH        PIC 99.
   767             20  SLASHA-1              PIC X VALUE '/'.
   768             20  DC-EDITA-DAY          PIC 99.
   769             20  SLASHA-2              PIC X VALUE '/'.
   770             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL640.cbl
   771                 24  DC-EDITA-CENT     PIC 99.
   772                 24  DC-EDITA-YEAR     PIC 99.
   773         16  DC-GREG-DATE-B-EDIT.
   774             20  DC-EDITB-MONTH        PIC 99.
   775             20  SLASHB-1              PIC X VALUE '/'.
   776             20  DC-EDITB-DAY          PIC 99.
   777             20  SLASHB-2              PIC X VALUE '/'.
   778             20  DC-EDITB-CCYY.
   779                 24  DC-EDITB-CENT     PIC 99.
   780                 24  DC-EDITB-YEAR     PIC 99.
   781         16  DC-GREG-DATE-CYMD         PIC 9(08).
   782         16  DC-GREG-DATE-CYMD-R REDEFINES
   783                              DC-GREG-DATE-CYMD.
   784             20  DC-CYMD-CEN           PIC 99.
   785             20  DC-CYMD-YEAR          PIC 99.
   786             20  DC-CYMD-MONTH         PIC 99.
   787             20  DC-CYMD-DAY           PIC 99.
   788         16  DC-GREG-DATE-MDCY         PIC 9(08).
   789         16  DC-GREG-DATE-MDCY-R REDEFINES
   790                              DC-GREG-DATE-MDCY.
   791             20  DC-MDCY-MONTH         PIC 99.
   792             20  DC-MDCY-DAY           PIC 99.
   793             20  DC-MDCY-CEN           PIC 99.
   794             20  DC-MDCY-YEAR          PIC 99.
   795    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   796        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   797    12  DC-EL310-DATE                  PIC X(21).
   798    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL640.cbl
   800*                            COPY ELCLOGOF.
   801******************************************************************
   802*                                                                *
   803*                                                                *
   804*                            ELCLOGOF.                           *
   805*                            VMOD=2.001                          *
   806*                                                                *
   807*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   808*                                                                *
   809******************************************************************
   810 01  CLASIC-LOGOFF.
   811     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   812     12  LOGOFF-TEXT.
   813         16  FILLER          PIC X(5)    VALUE SPACES.
   814         16  LOGOFF-MSG.
   815             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   816             20  FILLER      PIC X       VALUE SPACES.
   817             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   818         16  FILLER          PIC X(80)
   819           VALUE '* YOU ARE NOW LOGGED OFF'.
   820         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   821         16  FILLER          PIC X       VALUE QUOTE.
   822         16  LOGOFF-SYS-MSG  PIC X(17)
   823           VALUE 'S CLAS-IC SYSTEM '.
   824     12  TEXT-MESSAGES.
   825         16  UNACCESS-MSG    PIC X(29)
   826             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   827         16  PGMIDERR-MSG    PIC X(17)
   828             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL640.cbl
   830*                            COPY ELCATTR.
   831******************************************************************
   832*                                                                *
   833*                            ELCATTR.                            *
   834*                            VMOD=2.001                          *
   835*                                                                *
   836*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   837*                                                                *
   838*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   839*                                                                *
   840*                   POS 1   P=PROTECTED                          *
   841*                           U=UNPROTECTED                        *
   842*                           S=ASKIP                              *
   843*                   POS 2   A=ALPHA/NUMERIC                      *
   844*                           N=NUMERIC                            *
   845*                   POS 3   N=NORMAL                             *
   846*                           B=BRIGHT                             *
   847*                           D=DARK                               *
   848*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   849*                           OF=MODIFIED DATA TAG OFF             *
   850*                                                                *
   851*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   852******************************************************************
   853 01  ATTRIBUTE-LIST.
   854     12  AL-PABOF            PIC X       VALUE 'Y'.
   855     12  AL-PABON            PIC X       VALUE 'Z'.
   856     12  AL-PADOF            PIC X       VALUE '%'.
   857     12  AL-PADON            PIC X       VALUE '_'.
   858     12  AL-PANOF            PIC X       VALUE '-'.
   859     12  AL-PANON            PIC X       VALUE '/'.
   860     12  AL-SABOF            PIC X       VALUE '8'.
   861     12  AL-SABON            PIC X       VALUE '9'.
   862     12  AL-SADOF            PIC X       VALUE '@'.
   863     12  AL-SADON            PIC X       VALUE QUOTE.
   864     12  AL-SANOF            PIC X       VALUE '0'.
   865     12  AL-SANON            PIC X       VALUE '1'.
   866     12  AL-UABOF            PIC X       VALUE 'H'.
   867     12  AL-UABON            PIC X       VALUE 'I'.
   868     12  AL-UADOF            PIC X       VALUE '<'.
   869     12  AL-UADON            PIC X       VALUE '('.
   870     12  AL-UANOF            PIC X       VALUE ' '.
   871     12  AL-UANON            PIC X       VALUE 'A'.
   872     12  AL-UNBOF            PIC X       VALUE 'Q'.
   873     12  AL-UNBON            PIC X       VALUE 'R'.
   874     12  AL-UNDOF            PIC X       VALUE '*'.
   875     12  AL-UNDON            PIC X       VALUE ')'.
   876     12  AL-UNNOF            PIC X       VALUE '&'.
   877     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL640.cbl
   879*                            COPY ELCEMIB.
   880******************************************************************
   881*                                                                *
   882*                                                                *
   883*                            ELCEMIB.                            *
   884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   885*                            VMOD=2.005                          *
   886*                                                                *
   887*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   888*                                                                *
   889******************************************************************
   890 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   891     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   892     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   893     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   894     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   895     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   896     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   897     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   898     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   899     12  EMI-SWITCH1             PIC X        VALUE '1'.
   900         88  EMI-NO-ERRORS                    VALUE '1'.
   901         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   902         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   903     12  EMI-SWITCH2             PIC X        VALUE '1'.
   904         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   905     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   906         88  EMI-AREA1-EMPTY                  VALUE '1'.
   907         88  EMI-AREA1-FULL                   VALUE '2'.
   908     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   909         88  EMI-AREA2-EMPTY                  VALUE '1'.
   910         88  EMI-AREA2-FULL                   VALUE '2'.
   911     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   912         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   913         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   914         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   915         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   916         88  EMI-BYPASS-FATALS                VALUE 'X'.
   917     12  EMI-ERROR-LINES.
   918         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   919         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   920         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   921         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   922             20  EMI-ERR-CODES OCCURS 10 TIMES.
   923                 24  EMI-ERR-NUM         PIC X(4).
   924                 24  EMI-FILLER          PIC X.
   925                 24  EMI-SEV             PIC X.
   926                 24  FILLER              PIC X.
   927             20  FILLER                  PIC X(02).
   928     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   929         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   930             20  EMI-ERROR-NUMBER    PIC X(4).
   931             20  EMI-FILL            PIC X.
   932             20  EMI-SEVERITY        PIC X.
   933             20  FILLER              PIC X.
   934             20  EMI-ERROR-TEXT.
   935                 24  EMI-TEXT-VARIABLE   PIC X(10).
   936                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL640.cbl
   937     12  EMI-SEVERITY-SAVE           PIC X.
   938         88  EMI-NOTE                    VALUE 'N'.
   939         88  EMI-WARNING                 VALUE 'W'.
   940         88  EMI-FORCABLE                VALUE 'F'.
   941         88  EMI-FATAL                   VALUE 'X'.
   942     12  EMI-MESSAGE-FLAG            PIC X.
   943         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   944         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   945     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   946     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   947         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   948         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   949         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   950     12  FILLER                      PIC X(137)  VALUE SPACES.
   951     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   952     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   953     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   954     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL640.cbl
   956*                            COPY ELCINTF.
   957******************************************************************
   958*                                                                *
   959*                                                                *
   960*                            ELCINTF.                            *
   961*                            VMOD=2.017                          *
   962*                                                                *
   963*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   964*                                                                *
   965*       LENGTH = 1024                                            *
   966*                                                                *
   967******************************************************************
   968 01  PROGRAM-INTERFACE-BLOCK.
   969     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   970     12  PI-CALLING-PROGRAM              PIC X(8).
   971     12  PI-SAVED-PROGRAM-1              PIC X(8).
   972     12  PI-SAVED-PROGRAM-2              PIC X(8).
   973     12  PI-SAVED-PROGRAM-3              PIC X(8).
   974     12  PI-SAVED-PROGRAM-4              PIC X(8).
   975     12  PI-SAVED-PROGRAM-5              PIC X(8).
   976     12  PI-SAVED-PROGRAM-6              PIC X(8).
   977     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   978     12  PI-COMPANY-ID                   PIC XXX.
   979     12  PI-COMPANY-CD                   PIC X.
   980
   981     12  PI-COMPANY-PASSWORD             PIC X(8).
   982
   983     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   984
   985     12  PI-CONTROL-IN-PROGRESS.
   986         16  PI-CARRIER                  PIC X.
   987         16  PI-GROUPING                 PIC X(6).
   988         16  PI-STATE                    PIC XX.
   989         16  PI-ACCOUNT                  PIC X(10).
   990         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   991                                         PIC X(10).
   992         16  PI-CLAIM-CERT-GRP.
   993             20  PI-CLAIM-NO             PIC X(7).
   994             20  PI-CERT-NO.
   995                 25  PI-CERT-PRIME       PIC X(10).
   996                 25  PI-CERT-SFX         PIC X.
   997             20  PI-CERT-EFF-DT          PIC XX.
   998         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   999             20  PI-PLAN-CODE            PIC X(2).
  1000             20  PI-REVISION-NUMBER      PIC X(3).
  1001             20  PI-PLAN-EFF-DT          PIC X(2).
  1002             20  PI-PLAN-EXP-DT          PIC X(2).
  1003             20  FILLER                  PIC X(11).
  1004         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1005             20  PI-OE-REFERENCE-1.
  1006                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1007                 25  PI-OE-REF-1-SUFF    PIC XX.
  1008
  1009     12  PI-SESSION-IN-PROGRESS          PIC X.
  1010         88  CLAIM-SESSION                   VALUE '1'.
  1011         88  CREDIT-SESSION                  VALUE '2'.
  1012         88  WARRANTY-SESSION                VALUE '3'.
  1013         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL640.cbl
  1014         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1015
  1016
  1017*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1018
  1019     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1020     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1021
  1022     12  PI-CREDIT-USER                  PIC X.
  1023         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1024         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1025
  1026     12  PI-CLAIM-USER                   PIC X.
  1027         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1028         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1029
  1030     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1031         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1032         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1033         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1034         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1035         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1036
  1037     12  PI-PROCESSOR-ID                 PIC X(4).
  1038
  1039     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1040
  1041     12  PI-MEMBER-CAPTION               PIC X(10).
  1042
  1043     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1044         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1045
  1046     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1047     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1048     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1049     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1050
  1051     12  PI-AH-OVERRIDE-L1               PIC X.
  1052     12  PI-AH-OVERRIDE-L2               PIC XX.
  1053     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1054     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1055
  1056     12  PI-NEW-SYSTEM                   PIC X(2).
  1057
  1058     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1059     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1060         88  PI-USES-PAID-TO                 VALUE '1'.
  1061     12  PI-CRDTCRD-SYSTEM.
  1062         16  PI-CRDTCRD-USER             PIC X.
  1063             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1064             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1065         16  PI-CC-MONTH-END-DT          PIC XX.
  1066     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1067
  1068     12  PI-OE-REFERENCE-2.
  1069         16  PI-OE-REF-2-PRIME           PIC X(10).
  1070         16  PI-OE-REF-2-SUFF            PIC X.
  1071
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL640.cbl
  1072     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1073
  1074     12  PI-LANGUAGE-TYPE                PIC X.
  1075             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1076             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1077             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1078
  1079     12  PI-POLICY-LINKAGE-IND           PIC X.
  1080         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1081         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1082                                                   LOW-VALUES.
  1083
  1084     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1085     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1086         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1087         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1088     12  FILLER                          PIC X(4).
  1089
  1090     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1091
  1092     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1093         PI-SYSTEM-LEVEL.
  1094
  1095         16  PI-ENTRY-CODES.
  1096             20  PI-ENTRY-CD-1           PIC X.
  1097             20  PI-ENTRY-CD-2           PIC X.
  1098
  1099         16  PI-RETURN-CODES.
  1100             20  PI-RETURN-CD-1          PIC X.
  1101             20  PI-RETURN-CD-2          PIC X.
  1102
  1103         16  PI-UPDATE-STATUS-SAVE.
  1104             20  PI-UPDATE-BY            PIC X(4).
  1105             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1106
  1107         16  PI-LOWER-CASE-LETTERS       PIC X.
  1108             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1109
  1110*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1111*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1112*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1113
  1114         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1115             88  ST-ACCNT-CNTL               VALUE ' '.
  1116             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1117             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1118             88  ACCNT-CNTL                  VALUE '3'.
  1119             88  CARR-ACCNT-CNTL             VALUE '4'.
  1120
  1121         16  PI-PROCESSOR-CAP-LIST.
  1122             20  PI-SYSTEM-CONTROLS.
  1123                24 PI-SYSTEM-DISPLAY     PIC X.
  1124                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1125                24 PI-SYSTEM-MODIFY      PIC X.
  1126                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1127             20  FILLER                  PIC XX.
  1128             20  PI-DISPLAY-CAP          PIC X.
  1129                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL640.cbl
  1130             20  PI-MODIFY-CAP           PIC X.
  1131                 88  MODIFY-CAP              VALUE 'Y'.
  1132             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1133                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1134             20  PI-FORCE-CAP            PIC X.
  1135                 88  FORCE-CAP               VALUE 'Y'.
  1136
  1137         16  PI-PROGRAM-CONTROLS.
  1138             20  PI-PGM-PRINT-OPT        PIC X.
  1139             20  PI-PGM-FORMAT-OPT       PIC X.
  1140             20  PI-PGM-PROCESS-OPT      PIC X.
  1141             20  PI-PGM-TOTALS-OPT       PIC X.
  1142
  1143         16  PI-HELP-INTERFACE.
  1144             20  PI-LAST-ERROR-NO        PIC X(4).
  1145             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1146
  1147         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1148             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1149
  1150         16  PI-CR-CONTROL-IN-PROGRESS.
  1151             20  PI-CR-CARRIER           PIC X.
  1152             20  PI-CR-GROUPING          PIC X(6).
  1153             20  PI-CR-STATE             PIC XX.
  1154             20  PI-CR-ACCOUNT           PIC X(10).
  1155             20  PI-CR-FIN-RESP          PIC X(10).
  1156             20  PI-CR-TYPE              PIC X.
  1157
  1158         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1159
  1160         16  PI-CR-MONTH-END-DT          PIC XX.
  1161
  1162         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1163             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1164             88  PI-ZERO-CARRIER             VALUE '1'.
  1165             88  PI-ZERO-GROUPING            VALUE '2'.
  1166             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1167
  1168         16  PI-CARRIER-SECURITY         PIC X.
  1169             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1170
  1171         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1172             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1173             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1174
  1175         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1176             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1177                                         INDEXED BY PI-ACCESS-NDX
  1178                                         PIC X.
  1179
  1180         16  PI-GA-BILLING-CONTROL       PIC X.
  1181             88  PI-GA-BILLING               VALUE '1'.
  1182
  1183         16  PI-MAIL-PROCESSING          PIC X.
  1184             88  PI-MAIL-YES                 VALUE 'Y'.
  1185
  1186         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1187
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL640.cbl
  1188         16  PI-AR-SYSTEM.
  1189             20  PI-AR-PROCESSING-CNTL   PIC X.
  1190                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1191             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1192             20  PI-AR-MONTH-END-DT      PIC XX.
  1193
  1194         16  PI-MP-SYSTEM.
  1195             20  PI-MORTGAGE-USER            PIC X.
  1196                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1197                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1198             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1199                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1200                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1201                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1202                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1203                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1204             20  PI-MP-MONTH-END-DT          PIC XX.
  1205             20  PI-MP-REFERENCE-NO.
  1206                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1207                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1208
  1209         16  PI-LABEL-CONTROL            PIC X(01).
  1210             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1211             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1212
  1213         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1214             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1215
  1216         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1217             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1218             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1219
  1220         16  FILLER                      PIC X(14).
  1221
  1222     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1223******************************************************************
  1224     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1225         16  PI-MAP-NAME         PIC X(8).
  1226         16  PI-ACCT-NAME        PIC X(30).
  1227         16  PI-SAV-REMIT-TO     PIC X(10).
  1228         16  PI-SAV-ACCT         PIC X(10).
  1229         16  PI-SAV-CARR         PIC X.
  1230         16  PI-SAV-GROUP        PIC X(6).
  1231         16  PI-SAV-STATE        PIC XX.
  1232         16  PI-SAV-EXP-DT       PIC XX.
  1233         16  PI-BAL-FRWD-GA      PIC S9(7)V99   COMP-3.
  1234         16  PI-BAL-FRWD         PIC S9(7)V99   COMP-3.
  1235         16  PI-PREMIUM          PIC S9(7)V99   COMP-3.
  1236         16  PI-REMITTED         PIC S9(7)V99   COMP-3.
  1237         16  PI-TOT-ISS-COMP     PIC S9(7)V99   COMP-3.
  1238         16  PI-TOT-CAN-COMP     PIC S9(7)V99   COMP-3.
  1239         16  PI-ADJUSTMENTS      PIC S9(7)V99   COMP-3.
  1240         16  PI-DISBURSED        PIC S9(7)V99   COMP-3.
  1241         16  PI-END-BAL          PIC S9(7)V99   COMP-3.
  1242         16  PI-LF-ISS-COMP      PIC S9(7)V99   COMP-3.
  1243         16  PI-AH-ISS-COMP      PIC S9(7)V99   COMP-3.
  1244         16  PI-LF-CAN-COMP      PIC S9(7)V99   COMP-3.
  1245         16  PI-AH-CAN-COMP      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL640.cbl
  1246         16  PI-LIMIT-BILLING-BTCHS.
  1247             20  PI-BILLING-BATCHES   OCCURS 3 TIMES
  1248                                 PIC X(6).
  1249         16  PI-BILL-TYPE        PIC X.
  1250             88  PI-PREV-BILL        VALUE '1'.
  1251             88  PI-PREV-REBILL      VALUE '2'.
  1252             88  PI-PREVIEW          VALUE '1' '2'.
  1253             88  PI-BILL             VALUE '3'.
  1254             88  PI-REBILLING        VALUE '4'.
  1255             88  PI-VOID-BILL        VALUE '5'.
  1256             88  PI-TOT-REBILL       VALUE '2' '4'.
  1257             88  PI-UPDATE-FILES     VALUE '3' '4' '5'.
  1258             88  PI-BILLING-FUNCTION VALUE '1' '2' '3' '4'.
  1259         16  PI-BILL-ERRS        PIC X.
  1260         16  PI-CHECK-SW         PIC X.
  1261             88  PI-CHECK-PRODUCED   VALUE 'Y'.
  1262         16  PI-DATA-BILLED-SW   PIC X.
  1263             88  PI-DATA-BILLED      VALUE 'Y'.
  1264         16  PI-MONTH-END-DATE.
  1265             20  PI-ME-MONTH     PIC 99.
  1266             20  FILLER          PIC X.
  1267             20  PI-ME-DAY       PIC 99.
  1268             20  FILLER          PIC X.
  1269             20  PI-ME-YEAR      PIC 99.
  1270         16  PI-BILLING-COUNTS.
  1271             20  FILLER OCCURS 6 TIMES INDEXED BY PINDX.
  1272                 24  PI-BATCH    PIC X(6).
  1273                 24  PI-BILLED   PIC 9(6)  COMP-3.
  1274                 24  PI-PREV     PIC 9(6)  COMP-3.
  1275                 24  PI-NOBILL   PIC 9(6)  COMP-3.
  1276                 24  PI-PREM     PIC S9(7)V99   COMP-3.
  1277                 24  PI-COMM     PIC S9(7)V99   COMP-3.
  1278                 24  PI-NON-PREM PIC S9(7)V99   COMP-3.
  1279                 24  PI-NON-COMM PIC S9(7)V99   COMP-3.
  1280         16  PI-COMP-CONTROL.
  1281             20  PI-COMP-CARRIER     PIC X.
  1282             20  PI-COMP-GROUPING    PIC X(6).
  1283             20  PI-COMP-FIN-RESP    PIC X(10).
  1284         16  PI-SCRN-CONTROL.
  1285             20  PI-SCR-CARRIER      PIC X.
  1286             20  PI-SCR-GROUPING     PIC X(6).
  1287             20  PI-SCR-STATE        PIC X(02).
  1288             20  PI-SCR-ACCOUNT      PIC X(10).
  1289             20  PI-SCR-FIN-RESP     PIC X(10).
  1290             20  PI-SCR-TYPE         PIC X.
  1291         16  PI-TRANSFER-SW          PIC X.
  1292             88  PI-TRANSFER-BEFORE-ACT   VALUE 'Y'.
  1293         16  FILLER                  PIC X(200).
  1294
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL640.cbl
  1296*                            COPY ELCJPFX.
  1297******************************************************************
  1298*                                                                *
  1299*                                                                *
  1300*                            ELCJPFX.                            *
  1301*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1302*                            VMOD=2.002                          *
  1303*                                                                *
  1304*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1305*                                                                *
  1306*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1307*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1308*        ELCNTL - CONTROL FILE                                   *
  1309*        ELMSTR - CLAIM MASTERS                                  *
  1310*        ELTRLR - ACTIVITY TRAILERS                              *
  1311*        ELCHKQ - CHECK QUE                                      *
  1312******************************************************************
  1313 01  JOURNAL-RECORD.
  1314     12  JP-USER-ID                  PIC X(4).
  1315     12  JP-FILE-ID                  PIC X(8).
  1316     12  JP-PROGRAM-ID               PIC X(8).
  1317     12  JP-RECORD-TYPE              PIC X.
  1318         88 JP-ADD              VALUE 'A'.
  1319         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1320         88 JP-AFTER-CHANGE     VALUE 'C'.
  1321         88 JP-DELETE           VALUE 'D'.
  1322         88 JP-GENERIC-DELETE   VALUE 'G'.
  1323         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1324         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1325     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1326     12  JP-RECORD-AREA
  1327
  1328
  1329                             PIC X(1464).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL640.cbl
  1331*                            COPY ELCAID.
  1332******************************************************************
  1333*                                                                *
  1334*                            ELCAID.                             *
  1335*                            VMOD=2.001                          *
  1336*                                                                *
  1337*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1338*                                                                *
  1339*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1340*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1341******************************************************************
  1342
  1343 01  DFHAID.
  1344   02  DFHNULL   PIC  X  VALUE  ' '.
  1345   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1346   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1347   02  DFHPEN    PIC  X  VALUE  '='.
  1348   02  DFHOPID   PIC  X  VALUE  'W'.
  1349   02  DFHPA1    PIC  X  VALUE  '%'.
  1350   02  DFHPA2    PIC  X  VALUE  '>'.
  1351   02  DFHPA3    PIC  X  VALUE  ','.
  1352   02  DFHPF1    PIC  X  VALUE  '1'.
  1353   02  DFHPF2    PIC  X  VALUE  '2'.
  1354   02  DFHPF3    PIC  X  VALUE  '3'.
  1355   02  DFHPF4    PIC  X  VALUE  '4'.
  1356   02  DFHPF5    PIC  X  VALUE  '5'.
  1357   02  DFHPF6    PIC  X  VALUE  '6'.
  1358   02  DFHPF7    PIC  X  VALUE  '7'.
  1359   02  DFHPF8    PIC  X  VALUE  '8'.
  1360   02  DFHPF9    PIC  X  VALUE  '9'.
  1361   02  DFHPF10   PIC  X  VALUE  ':'.
  1362   02  DFHPF11   PIC  X  VALUE  '#'.
  1363   02  DFHPF12   PIC  X  VALUE  '@'.
  1364   02  DFHPF13   PIC  X  VALUE  'A'.
  1365   02  DFHPF14   PIC  X  VALUE  'B'.
  1366   02  DFHPF15   PIC  X  VALUE  'C'.
  1367   02  DFHPF16   PIC  X  VALUE  'D'.
  1368   02  DFHPF17   PIC  X  VALUE  'E'.
  1369   02  DFHPF18   PIC  X  VALUE  'F'.
  1370   02  DFHPF19   PIC  X  VALUE  'G'.
  1371   02  DFHPF20   PIC  X  VALUE  'H'.
  1372   02  DFHPF21   PIC  X  VALUE  'I'.
  1373*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1374   02  DFHPF22   PIC  X  VALUE  '['.
  1375   02  DFHPF23   PIC  X  VALUE  '.'.
  1376   02  DFHPF24   PIC  X  VALUE  '<'.
  1377   02  DFHMSRE   PIC  X  VALUE  'X'.
  1378   02  DFHSTRF   PIC  X  VALUE  'h'.
  1379   02  DFHTRIG   PIC  X  VALUE  '"'.
  1380 01  FILLER    REDEFINES DFHAID.
  1381     12  FILLER              PIC X(8).
  1382     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL640.cbl
  1384*                                         COPY EL640S.
  1385 01  EL640AI.
  1386     05  FILLER            PIC  X(0012).
  1387*    -------------------------------
  1388     05  ADATEL PIC S9(0004) COMP.
  1389     05  ADATEF PIC  X(0001).
  1390     05  FILLER REDEFINES ADATEF.
  1391         10  ADATEA PIC  X(0001).
  1392     05  ADATEI PIC  X(0008).
  1393*    -------------------------------
  1394     05  ATIMEL PIC S9(0004) COMP.
  1395     05  ATIMEF PIC  X(0001).
  1396     05  FILLER REDEFINES ATIMEF.
  1397         10  ATIMEA PIC  X(0001).
  1398     05  ATIMEI PIC  X(0005).
  1399*    -------------------------------
  1400     05  CMPNYIDL PIC S9(0004) COMP.
  1401     05  CMPNYIDF PIC  X(0001).
  1402     05  FILLER REDEFINES CMPNYIDF.
  1403         10  CMPNYIDA PIC  X(0001).
  1404     05  CMPNYIDI PIC  X(0003).
  1405*    -------------------------------
  1406     05  USERIDL PIC S9(0004) COMP.
  1407     05  USERIDF PIC  X(0001).
  1408     05  FILLER REDEFINES USERIDF.
  1409         10  USERIDA PIC  X(0001).
  1410     05  USERIDI PIC  X(0004).
  1411*    -------------------------------
  1412     05  AACTNAML PIC S9(0004) COMP.
  1413     05  AACTNAMF PIC  X(0001).
  1414     05  FILLER REDEFINES AACTNAMF.
  1415         10  AACTNAMA PIC  X(0001).
  1416     05  AACTNAMI PIC  X(0030).
  1417*    -------------------------------
  1418     05  ACARHDGL PIC S9(0004) COMP.
  1419     05  ACARHDGF PIC  X(0001).
  1420     05  FILLER REDEFINES ACARHDGF.
  1421         10  ACARHDGA PIC  X(0001).
  1422     05  ACARHDGI PIC  X(0007).
  1423*    -------------------------------
  1424     05  AGRPHDGL PIC S9(0004) COMP.
  1425     05  AGRPHDGF PIC  X(0001).
  1426     05  FILLER REDEFINES AGRPHDGF.
  1427         10  AGRPHDGA PIC  X(0001).
  1428     05  AGRPHDGI PIC  X(0005).
  1429*    -------------------------------
  1430     05  ASTHDGL PIC S9(0004) COMP.
  1431     05  ASTHDGF PIC  X(0001).
  1432     05  FILLER REDEFINES ASTHDGF.
  1433         10  ASTHDGA PIC  X(0001).
  1434     05  ASTHDGI PIC  X(0005).
  1435*    -------------------------------
  1436     05  AACCTL PIC S9(0004) COMP.
  1437     05  AACCTF PIC  X(0001).
  1438     05  FILLER REDEFINES AACCTF.
  1439         10  AACCTA PIC  X(0001).
  1440     05  AACCTI PIC  X(0010).
  1441*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL640.cbl
  1442     05  ACARIERL PIC S9(0004) COMP.
  1443     05  ACARIERF PIC  X(0001).
  1444     05  FILLER REDEFINES ACARIERF.
  1445         10  ACARIERA PIC  X(0001).
  1446     05  ACARIERI PIC  X(0001).
  1447*    -------------------------------
  1448     05  AGROUPL PIC S9(0004) COMP.
  1449     05  AGROUPF PIC  X(0001).
  1450     05  FILLER REDEFINES AGROUPF.
  1451         10  AGROUPA PIC  X(0001).
  1452     05  AGROUPI PIC  X(0006).
  1453*    -------------------------------
  1454     05  ASTATEL PIC S9(0004) COMP.
  1455     05  ASTATEF PIC  X(0001).
  1456     05  FILLER REDEFINES ASTATEF.
  1457         10  ASTATEA PIC  X(0001).
  1458     05  ASTATEI PIC  X(0002).
  1459*    -------------------------------
  1460     05  ABALFWDL PIC S9(0004) COMP.
  1461     05  ABALFWDF PIC  X(0001).
  1462     05  FILLER REDEFINES ABALFWDF.
  1463         10  ABALFWDA PIC  X(0001).
  1464     05  ABALFWDI PIC  X(0011).
  1465*    -------------------------------
  1466     05  APREMUML PIC S9(0004) COMP.
  1467     05  APREMUMF PIC  X(0001).
  1468     05  FILLER REDEFINES APREMUMF.
  1469         10  APREMUMA PIC  X(0001).
  1470     05  APREMUMI PIC  X(0011).
  1471*    -------------------------------
  1472     05  AHD1L PIC S9(0004) COMP.
  1473     05  AHD1F PIC  X(0001).
  1474     05  FILLER REDEFINES AHD1F.
  1475         10  AHD1A PIC  X(0001).
  1476     05  AHD1I PIC  X(0018).
  1477*    -------------------------------
  1478     05  AREMITL PIC S9(0004) COMP.
  1479     05  AREMITF PIC  X(0001).
  1480     05  FILLER REDEFINES AREMITF.
  1481         10  AREMITA PIC  X(0001).
  1482     05  AREMITI PIC  X(0011).
  1483*    -------------------------------
  1484     05  ABATCH1L PIC S9(0004) COMP.
  1485     05  ABATCH1F PIC  X(0001).
  1486     05  FILLER REDEFINES ABATCH1F.
  1487         10  ABATCH1A PIC  X(0001).
  1488     05  ABATCH1I PIC  X(0006).
  1489*    -------------------------------
  1490     05  ABILL1L PIC S9(0004) COMP.
  1491     05  ABILL1F PIC  X(0001).
  1492     05  FILLER REDEFINES ABILL1F.
  1493         10  ABILL1A PIC  X(0001).
  1494     05  ABILL1I PIC  X(0006).
  1495*    -------------------------------
  1496     05  APREV1L PIC S9(0004) COMP.
  1497     05  APREV1F PIC  X(0001).
  1498     05  FILLER REDEFINES APREV1F.
  1499         10  APREV1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL640.cbl
  1500     05  APREV1I PIC  X(0006).
  1501*    -------------------------------
  1502     05  ANOBIL1L PIC S9(0004) COMP.
  1503     05  ANOBIL1F PIC  X(0001).
  1504     05  FILLER REDEFINES ANOBIL1F.
  1505         10  ANOBIL1A PIC  X(0001).
  1506     05  ANOBIL1I PIC  X(0006).
  1507*    -------------------------------
  1508     05  AHD2L PIC S9(0004) COMP.
  1509     05  AHD2F PIC  X(0001).
  1510     05  FILLER REDEFINES AHD2F.
  1511         10  AHD2A PIC  X(0001).
  1512     05  AHD2I PIC  X(0018).
  1513*    -------------------------------
  1514     05  ACOMPISL PIC S9(0004) COMP.
  1515     05  ACOMPISF PIC  X(0001).
  1516     05  FILLER REDEFINES ACOMPISF.
  1517         10  ACOMPISA PIC  X(0001).
  1518     05  ACOMPISI PIC  X(0011).
  1519*    -------------------------------
  1520     05  ABATCH2L PIC S9(0004) COMP.
  1521     05  ABATCH2F PIC  X(0001).
  1522     05  FILLER REDEFINES ABATCH2F.
  1523         10  ABATCH2A PIC  X(0001).
  1524     05  ABATCH2I PIC  X(0006).
  1525*    -------------------------------
  1526     05  ABILL2L PIC S9(0004) COMP.
  1527     05  ABILL2F PIC  X(0001).
  1528     05  FILLER REDEFINES ABILL2F.
  1529         10  ABILL2A PIC  X(0001).
  1530     05  ABILL2I PIC  X(0006).
  1531*    -------------------------------
  1532     05  APREV2L PIC S9(0004) COMP.
  1533     05  APREV2F PIC  X(0001).
  1534     05  FILLER REDEFINES APREV2F.
  1535         10  APREV2A PIC  X(0001).
  1536     05  APREV2I PIC  X(0006).
  1537*    -------------------------------
  1538     05  ANOBIL2L PIC S9(0004) COMP.
  1539     05  ANOBIL2F PIC  X(0001).
  1540     05  FILLER REDEFINES ANOBIL2F.
  1541         10  ANOBIL2A PIC  X(0001).
  1542     05  ANOBIL2I PIC  X(0006).
  1543*    -------------------------------
  1544     05  AHD3L PIC S9(0004) COMP.
  1545     05  AHD3F PIC  X(0001).
  1546     05  FILLER REDEFINES AHD3F.
  1547         10  AHD3A PIC  X(0001).
  1548     05  AHD3I PIC  X(0018).
  1549*    -------------------------------
  1550     05  ACOMCANL PIC S9(0004) COMP.
  1551     05  ACOMCANF PIC  X(0001).
  1552     05  FILLER REDEFINES ACOMCANF.
  1553         10  ACOMCANA PIC  X(0001).
  1554     05  ACOMCANI PIC  X(0011).
  1555*    -------------------------------
  1556     05  ABATCH3L PIC S9(0004) COMP.
  1557     05  ABATCH3F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL640.cbl
  1558     05  FILLER REDEFINES ABATCH3F.
  1559         10  ABATCH3A PIC  X(0001).
  1560     05  ABATCH3I PIC  X(0006).
  1561*    -------------------------------
  1562     05  ABILL3L PIC S9(0004) COMP.
  1563     05  ABILL3F PIC  X(0001).
  1564     05  FILLER REDEFINES ABILL3F.
  1565         10  ABILL3A PIC  X(0001).
  1566     05  ABILL3I PIC  X(0006).
  1567*    -------------------------------
  1568     05  APREV3L PIC S9(0004) COMP.
  1569     05  APREV3F PIC  X(0001).
  1570     05  FILLER REDEFINES APREV3F.
  1571         10  APREV3A PIC  X(0001).
  1572     05  APREV3I PIC  X(0006).
  1573*    -------------------------------
  1574     05  ANOBIL3L PIC S9(0004) COMP.
  1575     05  ANOBIL3F PIC  X(0001).
  1576     05  FILLER REDEFINES ANOBIL3F.
  1577         10  ANOBIL3A PIC  X(0001).
  1578     05  ANOBIL3I PIC  X(0006).
  1579*    -------------------------------
  1580     05  AHD4L PIC S9(0004) COMP.
  1581     05  AHD4F PIC  X(0001).
  1582     05  FILLER REDEFINES AHD4F.
  1583         10  AHD4A PIC  X(0001).
  1584     05  AHD4I PIC  X(0018).
  1585*    -------------------------------
  1586     05  AADJUSTL PIC S9(0004) COMP.
  1587     05  AADJUSTF PIC  X(0001).
  1588     05  FILLER REDEFINES AADJUSTF.
  1589         10  AADJUSTA PIC  X(0001).
  1590     05  AADJUSTI PIC  X(0011).
  1591*    -------------------------------
  1592     05  ABATCH4L PIC S9(0004) COMP.
  1593     05  ABATCH4F PIC  X(0001).
  1594     05  FILLER REDEFINES ABATCH4F.
  1595         10  ABATCH4A PIC  X(0001).
  1596     05  ABATCH4I PIC  X(0006).
  1597*    -------------------------------
  1598     05  ABILL4L PIC S9(0004) COMP.
  1599     05  ABILL4F PIC  X(0001).
  1600     05  FILLER REDEFINES ABILL4F.
  1601         10  ABILL4A PIC  X(0001).
  1602     05  ABILL4I PIC  X(0006).
  1603*    -------------------------------
  1604     05  APREV4L PIC S9(0004) COMP.
  1605     05  APREV4F PIC  X(0001).
  1606     05  FILLER REDEFINES APREV4F.
  1607         10  APREV4A PIC  X(0001).
  1608     05  APREV4I PIC  X(0006).
  1609*    -------------------------------
  1610     05  ANOBIL4L PIC S9(0004) COMP.
  1611     05  ANOBIL4F PIC  X(0001).
  1612     05  FILLER REDEFINES ANOBIL4F.
  1613         10  ANOBIL4A PIC  X(0001).
  1614     05  ANOBIL4I PIC  X(0006).
  1615*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL640.cbl
  1616     05  AHD5L PIC S9(0004) COMP.
  1617     05  AHD5F PIC  X(0001).
  1618     05  FILLER REDEFINES AHD5F.
  1619         10  AHD5A PIC  X(0001).
  1620     05  AHD5I PIC  X(0018).
  1621*    -------------------------------
  1622     05  ADISBURL PIC S9(0004) COMP.
  1623     05  ADISBURF PIC  X(0001).
  1624     05  FILLER REDEFINES ADISBURF.
  1625         10  ADISBURA PIC  X(0001).
  1626     05  ADISBURI PIC  X(0011).
  1627*    -------------------------------
  1628     05  ABATCH5L PIC S9(0004) COMP.
  1629     05  ABATCH5F PIC  X(0001).
  1630     05  FILLER REDEFINES ABATCH5F.
  1631         10  ABATCH5A PIC  X(0001).
  1632     05  ABATCH5I PIC  X(0006).
  1633*    -------------------------------
  1634     05  ABILL5L PIC S9(0004) COMP.
  1635     05  ABILL5F PIC  X(0001).
  1636     05  FILLER REDEFINES ABILL5F.
  1637         10  ABILL5A PIC  X(0001).
  1638     05  ABILL5I PIC  X(0006).
  1639*    -------------------------------
  1640     05  APREV5L PIC S9(0004) COMP.
  1641     05  APREV5F PIC  X(0001).
  1642     05  FILLER REDEFINES APREV5F.
  1643         10  APREV5A PIC  X(0001).
  1644     05  APREV5I PIC  X(0006).
  1645*    -------------------------------
  1646     05  ANOBIL5L PIC S9(0004) COMP.
  1647     05  ANOBIL5F PIC  X(0001).
  1648     05  FILLER REDEFINES ANOBIL5F.
  1649         10  ANOBIL5A PIC  X(0001).
  1650     05  ANOBIL5I PIC  X(0006).
  1651*    -------------------------------
  1652     05  AENDHDGL PIC S9(0004) COMP.
  1653     05  AENDHDGF PIC  X(0001).
  1654     05  FILLER REDEFINES AENDHDGF.
  1655         10  AENDHDGA PIC  X(0001).
  1656     05  AENDHDGI PIC  X(0018).
  1657*    -------------------------------
  1658     05  ANETDUEL PIC S9(0004) COMP.
  1659     05  ANETDUEF PIC  X(0001).
  1660     05  FILLER REDEFINES ANETDUEF.
  1661         10  ANETDUEA PIC  X(0001).
  1662     05  ANETDUEI PIC  X(0011).
  1663*    -------------------------------
  1664     05  ABATCH6L PIC S9(0004) COMP.
  1665     05  ABATCH6F PIC  X(0001).
  1666     05  FILLER REDEFINES ABATCH6F.
  1667         10  ABATCH6A PIC  X(0001).
  1668     05  ABATCH6I PIC  X(0006).
  1669*    -------------------------------
  1670     05  ABILL6L PIC S9(0004) COMP.
  1671     05  ABILL6F PIC  X(0001).
  1672     05  FILLER REDEFINES ABILL6F.
  1673         10  ABILL6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL640.cbl
  1674     05  ABILL6I PIC  X(0006).
  1675*    -------------------------------
  1676     05  APREV6L PIC S9(0004) COMP.
  1677     05  APREV6F PIC  X(0001).
  1678     05  FILLER REDEFINES APREV6F.
  1679         10  APREV6A PIC  X(0001).
  1680     05  APREV6I PIC  X(0006).
  1681*    -------------------------------
  1682     05  ANOBIL6L PIC S9(0004) COMP.
  1683     05  ANOBIL6F PIC  X(0001).
  1684     05  FILLER REDEFINES ANOBIL6F.
  1685         10  ANOBIL6A PIC  X(0001).
  1686     05  ANOBIL6I PIC  X(0006).
  1687*    -------------------------------
  1688     05  ABILTYPL PIC S9(0004) COMP.
  1689     05  ABILTYPF PIC  X(0001).
  1690     05  FILLER REDEFINES ABILTYPF.
  1691         10  ABILTYPA PIC  X(0001).
  1692     05  ABILTYPI PIC  X(0001).
  1693*    -------------------------------
  1694     05  APRODSWL PIC S9(0004) COMP.
  1695     05  APRODSWF PIC  X(0001).
  1696     05  FILLER REDEFINES APRODSWF.
  1697         10  APRODSWA PIC  X(0001).
  1698     05  APRODSWI PIC  X(0001).
  1699*    -------------------------------
  1700     05  ABILERRL PIC S9(0004) COMP.
  1701     05  ABILERRF PIC  X(0001).
  1702     05  FILLER REDEFINES ABILERRF.
  1703         10  ABILERRA PIC  X(0001).
  1704     05  ABILERRI PIC  X(0001).
  1705*    -------------------------------
  1706     05  ABTCH1L PIC S9(0004) COMP.
  1707     05  ABTCH1F PIC  X(0001).
  1708     05  FILLER REDEFINES ABTCH1F.
  1709         10  ABTCH1A PIC  X(0001).
  1710     05  ABTCH1I PIC  X(0006).
  1711*    -------------------------------
  1712     05  ABTCH2L PIC S9(0004) COMP.
  1713     05  ABTCH2F PIC  X(0001).
  1714     05  FILLER REDEFINES ABTCH2F.
  1715         10  ABTCH2A PIC  X(0001).
  1716     05  ABTCH2I PIC  X(0006).
  1717*    -------------------------------
  1718     05  ABTCH3L PIC S9(0004) COMP.
  1719     05  ABTCH3F PIC  X(0001).
  1720     05  FILLER REDEFINES ABTCH3F.
  1721         10  ABTCH3A PIC  X(0001).
  1722     05  ABTCH3I PIC  X(0006).
  1723*    -------------------------------
  1724     05  AERMSG1L PIC S9(0004) COMP.
  1725     05  AERMSG1F PIC  X(0001).
  1726     05  FILLER REDEFINES AERMSG1F.
  1727         10  AERMSG1A PIC  X(0001).
  1728     05  AERMSG1I PIC  X(0076).
  1729*    -------------------------------
  1730     05  AERMSG2L PIC S9(0004) COMP.
  1731     05  AERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL640.cbl
  1732     05  FILLER REDEFINES AERMSG2F.
  1733         10  AERMSG2A PIC  X(0001).
  1734     05  AERMSG2I PIC  X(0076).
  1735*    -------------------------------
  1736     05  APFNTERL PIC S9(0004) COMP.
  1737     05  APFNTERF PIC  X(0001).
  1738     05  FILLER REDEFINES APFNTERF.
  1739         10  APFNTERA PIC  X(0001).
  1740     05  APFNTERI PIC  9(2).
  1741*    -------------------------------
  1742     05  APF5HDGL PIC S9(0004) COMP.
  1743     05  APF5HDGF PIC  X(0001).
  1744     05  FILLER REDEFINES APF5HDGF.
  1745         10  APF5HDGA PIC  X(0001).
  1746     05  APF5HDGI PIC  X(0020).
  1747*    -------------------------------
  1748     05  AGAHDGL PIC S9(0004) COMP.
  1749     05  AGAHDGF PIC  X(0001).
  1750     05  FILLER REDEFINES AGAHDGF.
  1751         10  AGAHDGA PIC  X(0001).
  1752     05  AGAHDGI PIC  X(0025).
  1753 01  EL640AO REDEFINES EL640AI.
  1754     05  FILLER            PIC  X(0012).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  ADATEO PIC  X(0008).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  ATIMEO PIC  99.99.
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  CMPNYIDO PIC  X(0003).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  USERIDO PIC  X(0004).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  AACTNAMO PIC  X(0030).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  ACARHDGO PIC  X(0007).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  AGRPHDGO PIC  X(0005).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  ASTHDGO PIC  X(0005).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  AACCTO PIC  X(0010).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  ACARIERO PIC  X(0001).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  AGROUPO PIC  X(0006).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL640.cbl
  1790     05  ASTATEO PIC  X(0002).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  ABALFWDO PIC  ZZZZZZ9.99-.
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  APREMUMO PIC  ZZZZZZ9.99-.
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  AHD1O PIC  X(0018).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  AREMITO PIC  ZZZZZZ9.99-.
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  ABATCH1O PIC  X(0006).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  ABILL1O PIC  Z(5)9.
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  APREV1O PIC  Z(5)9.
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  ANOBIL1O PIC  Z(5)9.
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  AHD2O PIC  X(0018).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  ACOMPISO PIC  ZZZZZZ9.99-.
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  ABATCH2O PIC  X(0006).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  ABILL2O PIC  Z(5)9.
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  APREV2O PIC  Z(5)9.
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  ANOBIL2O PIC  Z(5)9.
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  AHD3O PIC  X(0018).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  ACOMCANO PIC  ZZZZZZ9.99-.
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  ABATCH3O PIC  X(0006).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  ABILL3O PIC  Z(5)9.
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  APREV3O PIC  Z(5)9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL640.cbl
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  ANOBIL3O PIC  Z(5)9.
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  AHD4O PIC  X(0018).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  AADJUSTO PIC  ZZZZZZ9.99-.
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  ABATCH4O PIC  X(0006).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  ABILL4O PIC  Z(5)9.
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  APREV4O PIC  Z(5)9.
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  ANOBIL4O PIC  Z(5)9.
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  AHD5O PIC  X(0018).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  ADISBURO PIC  ZZZZZZ9.99-.
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  ABATCH5O PIC  X(0006).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  ABILL5O PIC  Z(5)9.
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  APREV5O PIC  Z(5)9.
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  ANOBIL5O PIC  Z(5)9.
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  AENDHDGO PIC  X(0018).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  ANETDUEO PIC  ZZZZZZ9.99-.
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  ABATCH6O PIC  X(0006).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  ABILL6O PIC  Z(5)9.
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  APREV6O PIC  Z(5)9.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  ANOBIL6O PIC  Z(5)9.
  1905*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL640.cbl
  1906     05  FILLER            PIC  X(0003).
  1907     05  ABILTYPO PIC  X(0001).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  APRODSWO PIC  X(0001).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  ABILERRO PIC  X(0001).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  ABTCH1O PIC  X(0006).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  ABTCH2O PIC  X(0006).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  ABTCH3O PIC  X(0006).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  AERMSG1O PIC  X(0076).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  AERMSG2O PIC  X(0076).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  APFNTERO PIC  99.
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  APF5HDGO PIC  X(0020).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  AGAHDGO PIC  X(0025).
  1938*    -------------------------------
  1939 01  EL640BI REDEFINES EL640AI.
  1940     05  FILLER            PIC  X(0012).
  1941*    -------------------------------
  1942     05  BDATEL PIC S9(0004) COMP.
  1943     05  BDATEF PIC  X(0001).
  1944     05  FILLER REDEFINES BDATEF.
  1945         10  BDATEA PIC  X(0001).
  1946     05  BDATEI PIC  X(0008).
  1947*    -------------------------------
  1948     05  BTIMEL PIC S9(0004) COMP.
  1949     05  BTIMEF PIC  X(0001).
  1950     05  FILLER REDEFINES BTIMEF.
  1951         10  BTIMEA PIC  X(0001).
  1952     05  BTIMEI PIC  X(0005).
  1953*    -------------------------------
  1954     05  BCMPNYL PIC S9(0004) COMP.
  1955     05  BCMPNYF PIC  X(0001).
  1956     05  FILLER REDEFINES BCMPNYF.
  1957         10  BCMPNYA PIC  X(0001).
  1958     05  BCMPNYI PIC  X(0003).
  1959*    -------------------------------
  1960     05  BUSERIDL PIC S9(0004) COMP.
  1961     05  BUSERIDF PIC  X(0001).
  1962     05  FILLER REDEFINES BUSERIDF.
  1963         10  BUSERIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL640.cbl
  1964     05  BUSERIDI PIC  X(0004).
  1965*    -------------------------------
  1966     05  BCHKNOL PIC S9(0004) COMP.
  1967     05  BCHKNOF PIC  X(0001).
  1968     05  FILLER REDEFINES BCHKNOF.
  1969         10  BCHKNOA PIC  X(0001).
  1970     05  BCHKNOI PIC  9(6).
  1971*    -------------------------------
  1972     05  BNAMEL PIC S9(0004) COMP.
  1973     05  BNAMEF PIC  X(0001).
  1974     05  FILLER REDEFINES BNAMEF.
  1975         10  BNAMEA PIC  X(0001).
  1976     05  BNAMEI PIC  X(0029).
  1977*    -------------------------------
  1978     05  BCHKAMTL PIC S9(0004) COMP.
  1979     05  BCHKAMTF PIC  X(0001).
  1980     05  FILLER REDEFINES BCHKAMTF.
  1981         10  BCHKAMTA PIC  X(0001).
  1982     05  BCHKAMTI PIC  S9(9)V99.
  1983*    -------------------------------
  1984     05  BADDR1L PIC S9(0004) COMP.
  1985     05  BADDR1F PIC  X(0001).
  1986     05  FILLER REDEFINES BADDR1F.
  1987         10  BADDR1A PIC  X(0001).
  1988     05  BADDR1I PIC  X(0029).
  1989*    -------------------------------
  1990     05  BADDR2L PIC S9(0004) COMP.
  1991     05  BADDR2F PIC  X(0001).
  1992     05  FILLER REDEFINES BADDR2F.
  1993         10  BADDR2A PIC  X(0001).
  1994     05  BADDR2I PIC  X(0029).
  1995*    -------------------------------
  1996     05  BPAYDT1L PIC S9(0004) COMP.
  1997     05  BPAYDT1F PIC  X(0001).
  1998     05  FILLER REDEFINES BPAYDT1F.
  1999         10  BPAYDT1A PIC  X(0001).
  2000     05  BPAYDT1I PIC  X(0008).
  2001*    -------------------------------
  2002     05  BCITYSTL PIC S9(0004) COMP.
  2003     05  BCITYSTF PIC  X(0001).
  2004     05  FILLER REDEFINES BCITYSTF.
  2005         10  BCITYSTA PIC  X(0001).
  2006     05  BCITYSTI PIC  X(0029).
  2007*    -------------------------------
  2008     05  BPAYDT2L PIC S9(0004) COMP.
  2009     05  BPAYDT2F PIC  X(0001).
  2010     05  FILLER REDEFINES BPAYDT2F.
  2011         10  BPAYDT2A PIC  X(0001).
  2012     05  BPAYDT2I PIC  X(0008).
  2013*    -------------------------------
  2014     05  BZIPL PIC S9(0004) COMP.
  2015     05  BZIPF PIC  X(0001).
  2016     05  FILLER REDEFINES BZIPF.
  2017         10  BZIPA PIC  X(0001).
  2018     05  BZIPI PIC  X(0010).
  2019*    -------------------------------
  2020     05  BACCNAML PIC S9(0004) COMP.
  2021     05  BACCNAMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL640.cbl
  2022     05  FILLER REDEFINES BACCNAMF.
  2023         10  BACCNAMA PIC  X(0001).
  2024     05  BACCNAMI PIC  X(0030).
  2025*    -------------------------------
  2026     05  BACCTL PIC S9(0004) COMP.
  2027     05  BACCTF PIC  X(0001).
  2028     05  FILLER REDEFINES BACCTF.
  2029         10  BACCTA PIC  X(0001).
  2030     05  BACCTI PIC  X(0010).
  2031*    -------------------------------
  2032     05  BCARIERL PIC S9(0004) COMP.
  2033     05  BCARIERF PIC  X(0001).
  2034     05  FILLER REDEFINES BCARIERF.
  2035         10  BCARIERA PIC  X(0001).
  2036     05  BCARIERI PIC  X(0001).
  2037*    -------------------------------
  2038     05  BGROUPL PIC S9(0004) COMP.
  2039     05  BGROUPF PIC  X(0001).
  2040     05  FILLER REDEFINES BGROUPF.
  2041         10  BGROUPA PIC  X(0001).
  2042     05  BGROUPI PIC  X(0006).
  2043*    -------------------------------
  2044     05  BSTATEL PIC S9(0004) COMP.
  2045     05  BSTATEF PIC  X(0001).
  2046     05  FILLER REDEFINES BSTATEF.
  2047         10  BSTATEA PIC  X(0001).
  2048     05  BSTATEI PIC  X(0002).
  2049*    -------------------------------
  2050     05  BFORM1L PIC S9(0004) COMP.
  2051     05  BFORM1F PIC  X(0001).
  2052     05  FILLER REDEFINES BFORM1F.
  2053         10  BFORM1A PIC  X(0001).
  2054     05  BFORM1I PIC  X(0004).
  2055*    -------------------------------
  2056     05  BFORM2L PIC S9(0004) COMP.
  2057     05  BFORM2F PIC  X(0001).
  2058     05  FILLER REDEFINES BFORM2F.
  2059         10  BFORM2A PIC  X(0001).
  2060     05  BFORM2I PIC  X(0004).
  2061*    -------------------------------
  2062     05  BFORM3L PIC S9(0004) COMP.
  2063     05  BFORM3F PIC  X(0001).
  2064     05  FILLER REDEFINES BFORM3F.
  2065         10  BFORM3A PIC  X(0001).
  2066     05  BFORM3I PIC  X(0004).
  2067*    -------------------------------
  2068     05  BALAMTL PIC S9(0004) COMP.
  2069     05  BALAMTF PIC  X(0001).
  2070     05  FILLER REDEFINES BALAMTF.
  2071         10  BALAMTA PIC  X(0001).
  2072     05  BALAMTI PIC  X(0011).
  2073*    -------------------------------
  2074     05  BERMSGL PIC S9(0004) COMP.
  2075     05  BERMSGF PIC  X(0001).
  2076     05  FILLER REDEFINES BERMSGF.
  2077         10  BERMSGA PIC  X(0001).
  2078     05  BERMSGI PIC  X(0078).
  2079*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL640.cbl
  2080     05  BPFNTERL PIC S9(0004) COMP.
  2081     05  BPFNTERF PIC  X(0001).
  2082     05  FILLER REDEFINES BPFNTERF.
  2083         10  BPFNTERA PIC  X(0001).
  2084     05  BPFNTERI PIC  9(2).
  2085 01  EL640BO REDEFINES EL640AI.
  2086     05  FILLER            PIC  X(0012).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  BDATEO PIC  X(0008).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  BTIMEO PIC  99.99.
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  BCMPNYO PIC  X(0003).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  BUSERIDO PIC  X(0004).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  BCHKNOO PIC  X(0006).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  BNAMEO PIC  X(0029).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  BCHKAMTO PIC  Z(7).ZZ-.
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  BADDR1O PIC  X(0029).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  BADDR2O PIC  X(0029).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  BPAYDT1O PIC  X(0008).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  BCITYSTO PIC  X(0029).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  BPAYDT2O PIC  X(0008).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  BZIPO PIC  X(0010).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  BACCNAMO PIC  X(0030).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  BACCTO PIC  X(0010).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  BCARIERO PIC  X(0001).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  BGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL640.cbl
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  BSTATEO PIC  X(0002).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  BFORM1O PIC  X(0004).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  BFORM2O PIC  X(0004).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  BFORM3O PIC  X(0004).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  BALAMTO PIC  Z(7).99-.
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  BERMSGO PIC  X(0078).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  BPFNTERO PIC  9(2).
  2159*    -------------------------------
  2160 01  MAP-A REDEFINES EL640AO.
  2161     12  FILLER                  PIC X(162).
  2162     12  FILLER OCCURS 6 TIMES INDEXED BY ANDX.
  2163         16  FILLER              PIC X(35).
  2164         16  BATCH-LEN           PIC S9(4)   COMP.
  2165         16  BATCH-ATTRB         PIC X.
  2166         16  BATCH               PIC X(6).
  2167         16  BILL-LEN            PIC S9(4)   COMP.
  2168         16  BILL-ATTRB          PIC X.
  2169         16  BILL                PIC Z(6).
  2170         16  PREV-LEN            PIC S9(4)   COMP.
  2171         16  PREV-ATTRB          PIC X.
  2172         16  PREV                PIC Z(6).
  2173         16  NOBILL-LEN          PIC S9(4)   COMP.
  2174         16  NOBILL-ATTRB        PIC X.
  2175         16  NOBILL              PIC Z(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL640.cbl
  2177****************************************************************
  2178*
  2179* Copyright (c) 2007 by Clerity Solutions, Inc.
  2180* All rights reserved.
  2181*
  2182****************************************************************
  2183 01  DFHEIV.
  2184   02  DFHEIV0               PIC X(35).
  2185   02  DFHEIV1               PIC X(08).
  2186   02  DFHEIV2               PIC X(08).
  2187   02  DFHEIV3               PIC X(08).
  2188   02  DFHEIV4               PIC X(06).
  2189   02  DFHEIV5               PIC X(04).
  2190   02  DFHEIV6               PIC X(04).
  2191   02  DFHEIV7               PIC X(02).
  2192   02  DFHEIV8               PIC X(02).
  2193   02  DFHEIV9               PIC X(01).
  2194   02  DFHEIV10              PIC S9(7) COMP-3.
  2195   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2196   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2197   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2198   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2199   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2200   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2201   02  DFHEIV17              PIC X(04).
  2202   02  DFHEIV18              PIC X(04).
  2203   02  DFHEIV19              PIC X(04).
  2204   02  DFHEIV20              USAGE IS POINTER.
  2205   02  DFHEIV21              USAGE IS POINTER.
  2206   02  DFHEIV22              USAGE IS POINTER.
  2207   02  DFHEIV23              USAGE IS POINTER.
  2208   02  DFHEIV24              USAGE IS POINTER.
  2209   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2210   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2211   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2212   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2213   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2214   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2215   02  FILLER                PIC X(02).
  2216   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2217   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2218   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2219   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2220   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2221 LINKAGE  SECTION.
  2222*****************************************************************
  2223*                                                               *
  2224* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2225* All rights reserved.                                          *
  2226*                                                               *
  2227*****************************************************************
  2228 01  dfheiblk.
  2229     02  eibtime          pic s9(7) comp-3.
  2230     02  eibdate          pic s9(7) comp-3.
  2231     02  eibtrnid         pic x(4).
  2232     02  eibtaskn         pic s9(7) comp-3.
  2233     02  eibtrmid         pic x(4).
  2234     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL640.cbl
  2235     02  eibcposn         pic s9(4) comp.
  2236     02  eibcalen         pic s9(4) comp.
  2237     02  eibaid           pic x(1).
  2238     02  eibfiller1       pic x(1).
  2239     02  eibfn            pic x(2).
  2240     02  eibfiller2       pic x(2).
  2241     02  eibrcode         pic x(6).
  2242     02  eibfiller3       pic x(2).
  2243     02  eibds            pic x(8).
  2244     02  eibreqid         pic x(8).
  2245     02  eibrsrce         pic x(8).
  2246     02  eibsync          pic x(1).
  2247     02  eibfree          pic x(1).
  2248     02  eibrecv          pic x(1).
  2249     02  eibsend          pic x(1).
  2250     02  eibatt           pic x(1).
  2251     02  eibeoc           pic x(1).
  2252     02  eibfmh           pic x(1).
  2253     02  eibcompl         pic x(1).
  2254     02  eibsig           pic x(1).
  2255     02  eibconf          pic x(1).
  2256     02  eiberr           pic x(1).
  2257     02  eibrldbk         pic x(1).
  2258     02  eiberrcd         pic x(4).
  2259     02  eibsynrb         pic x(1).
  2260     02  eibnodat         pic x(1).
  2261     02  eibfiller5       pic x(2).
  2262     02  eibresp          pic 9(09) comp.
  2263     02  eibresp2         pic 9(09) comp.
  2264     02  dfheigdj         pic s9(4) comp.
  2265     02  dfheigdk         pic s9(4) comp.
  2266 01  DFHCOMMAREA             PIC X(1024).
  2267
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL640.cbl
  2270*                            COPY ERCPNDB.
  2271******************************************************************
  2272*                                                                *
  2273*                                                                *
  2274*                            ERCPNDB.                            *
  2275*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2276*                            VMOD=2.025                          *
  2277*                                                                *
  2278*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2279*                                                                *
  2280******************************************************************
  2281*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2282*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2283******************************************************************
  2284*                                                                *
  2285*                                                                *
  2286*   FILE TYPE = VSAM,KSDS                                        *
  2287*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2288*                                                                *
  2289*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2290*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2291*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2292*                                                 RKP=13,LEN=36  *
  2293*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2294*                                      AND CHG-SEQ.)             *
  2295*                                                RKP=49,LEN=11   *
  2296*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2297*                                      AND CHG-SEQ.)             *
  2298*                                                RKP=60,LEN=15   *
  2299*                                                                *
  2300*   LOG = NO                                                     *
  2301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2302******************************************************************
  2303******************************************************************
  2304*                   C H A N G E   L O G
  2305*
  2306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2307*-----------------------------------------------------------------
  2308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2309* EFFECTIVE    NUMBER
  2310*-----------------------------------------------------------------
  2311* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2312* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2313* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2314* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2315* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2316* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2317* 032306                   PEMA  ADD BOW LOAN NUMBER
  2318* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2319* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2320* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2321* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2322* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2323* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2324* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2325* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2326******************************************************************
  2327
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL640.cbl
  2328 01  PENDING-BUSINESS.
  2329     12  PB-RECORD-ID                     PIC XX.
  2330         88  VALID-PB-ID                        VALUE 'PB'.
  2331
  2332     12  PB-CONTROL-PRIMARY.
  2333         16  PB-COMPANY-CD                PIC X.
  2334         16  PB-ENTRY-BATCH               PIC X(6).
  2335         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2336         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2337
  2338     12  PB-CONTROL-BY-ACCOUNT.
  2339         16  PB-COMPANY-CD-A1             PIC X.
  2340         16  PB-CARRIER                   PIC X.
  2341         16  PB-GROUPING.
  2342             20  PB-GROUPING-PREFIX       PIC XXX.
  2343             20  PB-GROUPING-PRIME        PIC XXX.
  2344         16  PB-STATE                     PIC XX.
  2345         16  PB-ACCOUNT.
  2346             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2347             20  PB-ACCOUNT-PRIME         PIC X(6).
  2348         16  PB-CERT-EFF-DT               PIC XX.
  2349         16  PB-CERT-NO.
  2350             20  PB-CERT-PRIME            PIC X(10).
  2351             20  PB-CERT-SFX              PIC X.
  2352         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2353
  2354         16  PB-RECORD-TYPE               PIC X.
  2355             88  PB-MAILING-DATA                VALUE '0'.
  2356             88  PB-ISSUE                       VALUE '1'.
  2357             88  PB-CANCELLATION                VALUE '2'.
  2358             88  PB-BATCH-TRAILER               VALUE '9'.
  2359
  2360     12  PB-CONTROL-BY-ORIG-BATCH.
  2361         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2362         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2363         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2364         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2365
  2366     12  PB-CONTROL-BY-CSR.
  2367         16  PB-CSR-COMPANY-CD            PIC X.
  2368         16  PB-CSR-ID                    PIC X(4).
  2369         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2370         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2371         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2372******************************************************************
  2373*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2374******************************************************************
  2375
  2376     12  PB-LAST-MAINT-DT                 PIC XX.
  2377     12  PB-LAST-MAINT-BY                 PIC X(4).
  2378     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2379
  2380     12  PB-RECORD-BODY                   PIC X(375).
  2381
  2382     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2383         16  PB-CERT-ORIGIN               PIC X.
  2384             88  CLASIC-CREATED-CERT         VALUE '1'.
  2385         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL640.cbl
  2386             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2387             20  PB-I-INSURED-FIRST-NAME.
  2388                 24  PB-I-INSURED-1ST-INIT PIC X.
  2389                 24  FILLER                PIC X(9).
  2390             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2391         16  PB-I-AGE                     PIC S99   COMP-3.
  2392         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2393         16  PB-I-BIRTHDAY                PIC XX.
  2394         16  PB-I-INSURED-SEX             PIC X.
  2395             88  PB-SEX-MALE     VALUE 'M'.
  2396             88  PB-SEX-FEMALE   VALUE 'F'.
  2397
  2398         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2399         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2400         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2401         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2402         16  PB-I-SKIP-CODE               PIC X.
  2403             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2404             88  PB-SKIP-JULY              VALUE '1'.
  2405             88  PB-SKIP-AUGUST            VALUE '2'.
  2406             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2407             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2408             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2409             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2410             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2411             88  PB-SKIP-JUNE              VALUE '8'.
  2412             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2413             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2414             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2415         16  PB-I-TERM-TYPE               PIC X.
  2416             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2417             88  PB-PAID-WEEKLY            VALUE 'W'.
  2418             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2419             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2420             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2421         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2422         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2423         16  PB-I-DATA-ENTRY-SW           PIC X.
  2424             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2425             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2426             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2427             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2428         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2429         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2430*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2431         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2432         16  FILLER                       PIC X.
  2433
  2434         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2435             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2436             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2437                                                   '90' THRU '99'.
  2438         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2439                                          PIC XX.
  2440         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2441         16  PB-I-AMOUNT-FINANCED REDEFINES
  2442                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2443         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL640.cbl
  2444         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2445                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2446         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2447         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2448         16  PB-I-CLP-AMOUNT REDEFINES
  2449                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2450         16  PB-I-LF-CALC-FLAG            PIC X.
  2451             88 PB-COMP-LF-PREM               VALUE '?'.
  2452         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2453         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2454         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2455         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2456         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2457         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2458         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2459         16  PB-I-LF-ABBR                 PIC XXX.
  2460         16  PB-I-LF-INPUT-CD             PIC XX.
  2461
  2462         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2463             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2464             88  PB-INVALID-AH               VALUE '  ' '00'
  2465                                                   '90' THRU '99'.
  2466         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2467         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2468         16  PB-I-AH-CALC-FLAG            PIC X.
  2469             88 PB-COMP-AH-PREM                  VALUE '?'.
  2470         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2471         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2472         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2473         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2474         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2475         16  PB-I-AH-ABBR                 PIC XXX.
  2476         16  PB-I-AH-INPUT-CD             PIC XXX.
  2477
  2478         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2479         16  PB-I-REIN-TABLE              PIC XXX.
  2480         16  PB-I-BUSINESS-TYPE           PIC 99.
  2481         16  PB-I-INDV-GRP-CD             PIC X.
  2482         16  PB-I-MORT-CODE.
  2483             20  PB-I-TABLE               PIC X.
  2484             20  PB-I-INTEREST            PIC XX.
  2485             20  PB-I-MORT-TYP            PIC X.
  2486         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2487         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2488         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2489         16  PB-I-INDV-GRP-OVRD           PIC X.
  2490         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2491         16  PB-I-SIG-SW                  PIC X.
  2492             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2493         16  PB-I-RATE-CLASS              PIC XX.
  2494         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2495         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2496         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2497         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2498         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2499         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2500         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2501         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL640.cbl
  2502         16  PB-I-OB-FLAG                 PIC X.
  2503             88  PB-I-OB                      VALUE 'B'.
  2504             88  PB-I-SUMMARY                 VALUE 'Z'.
  2505         16  PB-I-ENTRY-STATUS            PIC X.
  2506             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2507                                              'M' '5' '9' '2'.
  2508             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2509             88  PB-I-POLICY-PENDING          VALUE '2'.
  2510             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2511             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2512             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2513             88  PB-I-REIN-ONLY               VALUE '9'.
  2514             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2515             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2516             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2517             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2518         16  PB-I-INT-CODE                PIC X.
  2519             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2520             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2521         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2522         16  PB-I-SOC-SEC-NO              PIC X(11).
  2523         16  PB-I-MEMBER-NO               PIC X(12).
  2524         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2525*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2526         16  PB-I-OLD-LOF                 PIC XXX.
  2527         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2528         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2529         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2530         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2531         16  PB-I-LIFE-INDICATOR          PIC X.
  2532             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2533         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2534         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2535                                          PIC S9(5)V99    COMP-3.
  2536         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2537             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2538             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2539         16  PB-I-1ST-PMT-DT              PIC XX.
  2540         16  PB-I-JOINT-INSURED.
  2541             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2542             20 PB-I-JOINT-FIRST-NAME.
  2543                24  PB-I-JOINT-FIRST-INIT PIC X.
  2544                24  FILLER                PIC X(9).
  2545             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2546*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2547         16  PB-I-BENEFICIARY-NAME.
  2548             20  PB-I-BANK-NUMBER         PIC X(10).
  2549             20  FILLER                   PIC X(15).
  2550         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2551         16  PB-I-REFERENCE               PIC X(12).
  2552         16  FILLER REDEFINES PB-I-REFERENCE.
  2553             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2554             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2555             20  PB-I-CLP-STATE           PIC XX.
  2556         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2557             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2558             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2559             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL640.cbl
  2560         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2561         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2562         16  PB-I-RESIDENT-STATE          PIC XX.
  2563         16  PB-I-RATE-CODE               PIC X(4).
  2564         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2565         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2566         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2567         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2568         16  PB-I-BANK-NOCHRGB            PIC 99.
  2569         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2570         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2571
  2572     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2573         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2574             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2575         16  PB-C-CANCEL-ORIGIN           PIC X.
  2576             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2577         16  PB-C-LF-CANCEL-DT            PIC XX.
  2578         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2579         16  PB-C-LF-CALC-REQ             PIC X.
  2580             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2581         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2582         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2583         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2584             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2585         16  PB-C-AH-CANCEL-DT            PIC XX.
  2586         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2587         16  PB-C-AH-CALC-REQ             PIC X.
  2588             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2589         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2590         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2591         16  PB-C-LAST-NAME               PIC X(15).
  2592         16  PB-C-REFUND-SW               PIC X.
  2593             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2594             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2595         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2596         16  PB-C-PAYEE-CODE              PIC X(6).
  2597         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2598         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2599         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2600         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2601         16  PB-C-REFERENCE               PIC X(12).
  2602         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2603         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2604         16  PB-C-POST-CARD-IND           PIC X.
  2605         16  PB-C-CANCEL-REASON           PIC X.
  2606         16  PB-C-REF-INTERFACE-SW        PIC X.
  2607         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2608         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2609         16  FILLER                       PIC X(01).
  2610*        16  FILLER                       PIC X(18).
  2611         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2612*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2613         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2614         16  PB-CANCELED-CERT-DATA.
  2615             20  PB-CI-INSURED-NAME.
  2616                 24  PB-CI-LAST-NAME      PIC X(15).
  2617                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL640.cbl
  2618             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2619             20  PB-CI-INSURED-SEX        PIC X.
  2620             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2621             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2622             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2623             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2624             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2625             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2626             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2627             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2628             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2629             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2630             20  PB-CI-RATE-CLASS         PIC XX.
  2631             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2632             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2633             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2634             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2635             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2636             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2637             20  PB-CI-LF-ABBR            PIC X(3).
  2638             20  PB-CI-AH-ABBR            PIC X(3).
  2639             20  PB-CI-OB-FLAG            PIC X.
  2640                 88  PB-CI-OB                VALUE 'B'.
  2641             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2642                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2643                                           'M' '4' '5' '9' '2'.
  2644                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2645                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2646                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2647                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2648                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2649                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2650                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2651                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2652                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2653                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2654                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2655                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2656             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2657                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2658                                           'M' '4' '5' '9' '2'.
  2659                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2660                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2661                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2662                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2663                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2664                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2665                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2666                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2667                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2668                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2669                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2670                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2671             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2672             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2673             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2674             20  PB-CI-MEMBER-NO          PIC X(12).
  2675             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL640.cbl
  2676                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2677                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2678             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2679             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2680             20  PB-CI-COMP-EXCP-SW       PIC X.
  2681                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2682                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2683             20  PB-CI-ENTRY-STATUS       PIC X.
  2684             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2685             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2686             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2687             20  PB-CI-DEATH-DT           PIC XX.
  2688             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2689             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2690             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2691             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2692             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2693             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2694             20  PB-CI-ENTRY-DT              PIC XX.
  2695             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2696             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2697             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2698             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2699             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2700             20  PB-CI-OLD-LOF               PIC XXX.
  2701*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2702             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2703             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2704             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2705             20  PB-CI-INDV-GRP-CD           PIC X.
  2706             20  PB-CI-BENEFICIARY-NAME.
  2707                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2708                 24  FILLER                  PIC X(15).
  2709             20  PB-CI-NOTE-SW               PIC X.
  2710             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2711             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2712             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2713             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2714             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2715             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2716             20  PB-CI-FIRST-NAME            PIC X(10).
  2717             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2718
  2719         16  FILLER                       PIC X(13).
  2720*032306  16  FILLER                       PIC X(27).
  2721*        16  FILLER                       PIC X(46).
  2722
  2723     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2724         16  FILLER                       PIC X(10).
  2725         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2726         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2727         16  PB-M-INSURED-MID-INIT        PIC X.
  2728         16  PB-M-INSURED-AGE             PIC 99.
  2729         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2730         16  PB-M-INSURED-SEX             PIC X.
  2731         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2732         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2733         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL640.cbl
  2734         16  PB-M-INSURED-CITY-STATE.
  2735             20  PB-M-INSURED-CITY        PIC X(28).
  2736             20  PB-M-INSURED-STATE       PIC XX.
  2737         16  PB-M-INSURED-ZIP-CODE.
  2738             20  PB-M-INSURED-ZIP-PRIME.
  2739                 24  PB-M-INSURED-ZIP-1   PIC X.
  2740                     88  PB-M-CANADIAN-POST-CODE
  2741                                             VALUE 'A' THRU 'Z'.
  2742                 24  FILLER               PIC X(4).
  2743             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2744         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2745                                        PB-M-INSURED-ZIP-CODE.
  2746             20  PM-M-INS-CAN-POST1       PIC XXX.
  2747             20  PM-M-INS-CAN-POST2       PIC XXX.
  2748             20  FILLER                   PIC XXX.
  2749         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2750         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2751         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2752         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2753         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2754         16  PB-M-CRED-BENE-CITYST.
  2755             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2756             20  PB-M-CRED-BENE-STATE     PIC XX.
  2757         16  FILLER                       PIC X(92).
  2758
  2759     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2760         16  FILLER                       PIC X(10).
  2761         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2762         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2763         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2764         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2765         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2766         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2767         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2768         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2769         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2770         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2771         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2772         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2773         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2774         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2775         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2776         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2777         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2778         16  PB-ACCOUNT-NAME              PIC X(30).
  2779         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2780         16  PB-REFERENCE                 PIC X(12).
  2781         16  PB-B-RECEIVED-DT             PIC XX.
  2782         16  FILLER                       PIC X(234).
  2783
  2784     12  PB-RECORD-STATUS.
  2785         16  PB-CREDIT-SELECT-DT          PIC XX.
  2786         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2787         16  PB-BILLED-DT                 PIC XX.
  2788         16  PB-BILLING-STATUS            PIC X.
  2789             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2790             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2791             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL640.cbl
  2792         16  PB-RECORD-BILL               PIC X.
  2793             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2794             88  PB-RECORD-RETURNED           VALUE 'R'.
  2795             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2796             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2797             88  PB-OVERRIDE-AH               VALUE 'A'.
  2798             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2799         16  PB-BATCH-ENTRY               PIC X.
  2800             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2801             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2802             88  PB-REISSUED-CERT             VALUE 'E'.
  2803             88  PB-MONTHLY-CERT              VALUE 'M'.
  2804             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2805             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2806             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2807         16  PB-FORCE-CODE                PIC X.
  2808             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2809             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2810             88  PB-CANCEL-FORCE              VALUE '8'.
  2811             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2812             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2813             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2814             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2815             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2816             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2817             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2818         16  PB-FATAL-FLAG                PIC X.
  2819             88  PB-FATAL-ERRORS              VALUE 'X'.
  2820         16  PB-FORCE-ER-CD               PIC X.
  2821             88  PB-FORCE-ERRORS              VALUE 'F'.
  2822             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2823         16  PB-WARN-ER-CD                PIC X.
  2824             88  PB-WARNING-ERRORS            VALUE 'W'.
  2825         16  FILLER                       PIC X.
  2826         16  PB-OUT-BAL-CD                PIC X.
  2827             88  PB-OUT-OF-BAL                VALUE 'O'.
  2828         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2829         16  PB-AH-OVERRIDE-L1            PIC X.
  2830         16  PB-INPUT-DT                  PIC XX.
  2831         16  PB-INPUT-BY                  PIC X(4).
  2832         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2833         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2834         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2835         16  PB-LF-EARNING-METHOD         PIC X.
  2836         16  PB-AH-EARNING-METHOD         PIC X.
  2837         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2838         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2839         16  PB-REIN-CD                   PIC XXX.
  2840         16  PB-LF-REFUND-TYPE            PIC X.
  2841         16  PB-AH-REFUND-TYPE            PIC X.
  2842         16  PB-ACCT-EFF-DT               PIC XX.
  2843         16  PB-ACCT-EXP-DT               PIC XX.
  2844         16  PB-COMPANY-ID                PIC X(3).
  2845         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2846         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2847         16  PB-SV-CARRIER                PIC X.
  2848         16  PB-SV-GROUPING               PIC X(6).
  2849         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL640.cbl
  2850         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2851         16  PB-GA-BILLING-INFO.
  2852             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2853                                          PIC XX.
  2854         16  PB-SV-REMIT-TO  REDEFINES
  2855             PB-GA-BILLING-INFO           PIC X(10).
  2856         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2857         16  PB-I-LOAN-OFFICER            PIC X(5).
  2858         16  PB-I-VIN                     PIC X(17).
  2859
  2860         16  FILLER                       PIC X(04).
  2861         16  IMNET-BYPASS-SW              PIC X.
  2862
  2863******************************************************************
  2864*                COMMON EDIT ERRORS                              *
  2865******************************************************************
  2866
  2867     12  PB-COMMON-ERRORS.
  2868         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2869                                           PIC S9(4)     COMP.
  2870
  2871******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL640.cbl
  2873*                            COPY ELCCNTL.
  2874******************************************************************
  2875*                                                                *
  2876*                                                                *
  2877*                            ELCCNTL.                            *
  2878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2879*                            VMOD=2.059                          *
  2880*                                                                *
  2881*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2882*                                                                *
  2883*   FILE TYPE = VSAM,KSDS                                        *
  2884*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2885*                                                                *
  2886*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2887*       ALTERNATE INDEX = NONE                                   *
  2888*                                                                *
  2889*   LOG = YES                                                    *
  2890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2891******************************************************************
  2892*                   C H A N G E   L O G
  2893*
  2894* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2895*-----------------------------------------------------------------
  2896*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2897* EFFECTIVE    NUMBER
  2898*-----------------------------------------------------------------
  2899* 082503                   PEMA  ADD BENEFIT GROUP
  2900* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2901* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2902* 092705    2005050300006  PEMA  ADD SPP LEASES
  2903* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2904* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2905* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2906* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2907* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2908******************************************************************
  2909*
  2910 01  CONTROL-FILE.
  2911     12  CF-RECORD-ID                       PIC XX.
  2912         88  VALID-CF-ID                        VALUE 'CF'.
  2913
  2914     12  CF-CONTROL-PRIMARY.
  2915         16  CF-COMPANY-ID                  PIC XXX.
  2916         16  CF-RECORD-TYPE                 PIC X.
  2917             88  CF-COMPANY-MASTER              VALUE '1'.
  2918             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2919             88  CF-STATE-MASTER                VALUE '3'.
  2920             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2921             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2922             88  CF-CARRIER-MASTER              VALUE '6'.
  2923             88  CF-MORTALITY-MASTER            VALUE '7'.
  2924             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2925             88  CF-TERMINAL-MASTER             VALUE '9'.
  2926             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2927             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2928             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2929             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2930             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL640.cbl
  2931             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2932             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2933             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2934             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2935         16  CF-ACCESS-CD-GENL              PIC X(4).
  2936         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2937             20  CF-PROCESSOR               PIC X(4).
  2938         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2939             20  CF-STATE-CODE              PIC XX.
  2940             20  FILLER                     PIC XX.
  2941         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2942             20  FILLER                     PIC XX.
  2943             20  CF-HI-BEN-IN-REC           PIC XX.
  2944         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2945             20  FILLER                     PIC XXX.
  2946             20  CF-CARRIER-CNTL            PIC X.
  2947         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2948             20  FILLER                     PIC XX.
  2949             20  CF-HI-TYPE-IN-REC          PIC 99.
  2950         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2951             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2952                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2953             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2954             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2955         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2956             20  FILLER                     PIC X.
  2957             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2958         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2959             20  FILLER                     PIC XX.
  2960             20  CF-MORTGAGE-PLAN           PIC XX.
  2961         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2962
  2963     12  CF-LAST-MAINT-DT                   PIC XX.
  2964     12  CF-LAST-MAINT-BY                   PIC X(4).
  2965     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2966
  2967     12  CF-RECORD-BODY                     PIC X(728).
  2968
  2969
  2970****************************************************************
  2971*             COMPANY MASTER RECORD                            *
  2972****************************************************************
  2973
  2974     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2975         16  CF-COMPANY-ADDRESS.
  2976             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2977             20  CF-CL-IN-CARE-OF           PIC X(30).
  2978             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2979             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2980             20  CF-CL-CITY-STATE           PIC X(30).
  2981             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2982             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2983         16  CF-COMPANY-CD                  PIC X.
  2984         16  CF-COMPANY-PASSWORD            PIC X(8).
  2985         16  CF-SECURITY-OPTION             PIC X.
  2986             88  ALL-SECURITY                   VALUE '1'.
  2987             88  COMPANY-VERIFY                 VALUE '2'.
  2988             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL640.cbl
  2989             88  NO-SECURITY                    VALUE '4'.
  2990             88  ALL-BUT-TERM                   VALUE '5'.
  2991         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2992             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2993         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2994             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2995         16  CF-INFORCE-LOCATION            PIC X.
  2996             88  CERTS-ARE-ONLINE               VALUE '1'.
  2997             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2998             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2999         16  CF-LOWER-CASE-LETTERS          PIC X.
  3000         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3001             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3002             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3003             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3004             88  CF-ACCNT-CNTL                  VALUE '3'.
  3005             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3006
  3007         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3008         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3009
  3010         16  CF-LGX-CREDIT-USER             PIC X.
  3011             88  CO-IS-NOT-USER                 VALUE 'N'.
  3012             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3013
  3014         16 CF-CREDIT-CALC-CODES.
  3015             20  CF-CR-REM-TERM-CALC PIC X.
  3016               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3017               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3018               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3019               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3020               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3021               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3022               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3023             20  CF-CR-R78-METHOD           PIC X.
  3024               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3025               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3026
  3027         16  CF-CLAIM-CONTROL-COUNTS.
  3028             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3029                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3030
  3031             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3032                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3033
  3034             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3035                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3036
  3037             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3038                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3039
  3040         16  CF-CURRENT-MONTH-END           PIC XX.
  3041
  3042         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3043             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3044             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3045             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3046             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL640.cbl
  3047                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3048                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3049             20  CF-CO-PREM-REJECT-SW       PIC X.
  3050                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3051                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3052             20  CF-CO-REF-REJECT-SW        PIC X.
  3053                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3054                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3055
  3056         16  CF-CO-REPORTING-DT             PIC XX.
  3057         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3058         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3059           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3060           88  CF-CO-MONTH-END                  VALUE '1'.
  3061
  3062         16  CF-LGX-CLAIM-USER              PIC X.
  3063             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3064             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3065
  3066         16  CF-CREDIT-EDIT-CONTROLS.
  3067             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3068             20  CF-MIN-AGE                 PIC 99.
  3069             20  CF-DEFAULT-AGE             PIC 99.
  3070             20  CF-MIN-TERM                PIC S999      COMP-3.
  3071             20  CF-MAX-TERM                PIC S999      COMP-3.
  3072             20  CF-DEFAULT-SEX             PIC X.
  3073             20  CF-JOINT-AGE-INPUT         PIC X.
  3074                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3075             20  CF-BIRTH-DATE-INPUT        PIC X.
  3076                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3077             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3078                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3079                 88  CF-ZERO-CARRIER            VALUE '1'.
  3080                 88  CF-ZERO-GROUPING           VALUE '2'.
  3081                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3082             20  CF-EDIT-SW                 PIC X.
  3083                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3084             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3085             20  CF-CR-PR-METHOD            PIC X.
  3086               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3087               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3088             20  FILLER                     PIC X.
  3089
  3090         16  CF-CREDIT-MISC-CONTROLS.
  3091             20  CF-REIN-TABLE-SW           PIC X.
  3092                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3093             20  CF-COMP-TABLE-SW           PIC X.
  3094                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3095             20  CF-EXPERIENCE-RETENTION-AGE
  3096                                            PIC S9        COMP-3.
  3097             20  CF-CONVERSION-DT           PIC XX.
  3098             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3099             20  CF-RUN-FREQUENCY-SW        PIC X.
  3100                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3101                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3102
  3103             20  CF-CR-CHECK-NO-CONTROL.
  3104                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL640.cbl
  3105                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3106                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3107                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3108                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3109                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3110
  3111                 24  CF-CR-CHECK-COUNT       REDEFINES
  3112                     CF-CR-CHECK-COUNTER      PIC X(4).
  3113
  3114                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3115                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3116
  3117                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3118                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3119                 24  CF-MAIL-PROCESSING       PIC X.
  3120                     88  MAIL-PROCESSING          VALUE 'Y'.
  3121
  3122         16  CF-MISC-SYSTEM-CONTROL.
  3123             20  CF-SYSTEM-C                 PIC X.
  3124                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3125             20  CF-SYSTEM-D                 PIC X.
  3126                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3127             20  CF-SOC-SEC-NO-SW            PIC X.
  3128                 88  SOC-SEC-NO-USED             VALUE '1'.
  3129             20  CF-MEMBER-NO-SW             PIC X.
  3130                 88  MEMBER-NO-USED              VALUE '1'.
  3131             20  CF-TAX-ID-NUMBER            PIC X(11).
  3132             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3133             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3134                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3135                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3136                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3137                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3138             20  CF-SYSTEM-E                 PIC X.
  3139                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3140
  3141         16  CF-LGX-LIFE-USER               PIC X.
  3142             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3143             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3144
  3145         16  CF-CR-MONTH-END-DT             PIC XX.
  3146
  3147         16  CF-FILE-MAINT-DATES.
  3148             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3149                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3150             20  CF-LAST-BATCH       REDEFINES
  3151                 CF-LAST-BATCH-NO               PIC X(4).
  3152             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3153             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3154             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3155             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3156             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3157             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3158             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3159             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3160             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3161             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3162
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL640.cbl
  3163         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3164         16  FILLER                         PIC X.
  3165
  3166         16  CF-ALT-MORT-CODE               PIC X(4).
  3167         16  CF-MEMBER-CAPTION              PIC X(10).
  3168
  3169         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3170             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3171             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3172             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3173             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3174             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3175
  3176         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3177
  3178         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3179         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3180         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3181         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3182
  3183         16  CF-AH-OVERRIDE-L1              PIC X.
  3184         16  CF-AH-OVERRIDE-L2              PIC XX.
  3185         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3186         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3187
  3188         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3189         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3190
  3191         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3192         16  CF-AR-LAST-EL860-DT            PIC XX.
  3193         16  CF-MP-MONTH-END-DT             PIC XX.
  3194
  3195         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3196         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3197             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3198
  3199         16  CF-AR-MONTH-END-DT             PIC XX.
  3200
  3201         16  CF-CRDTCRD-USER                PIC X.
  3202             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3203             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3204
  3205         16  CF-CC-MONTH-END-DT             PIC XX.
  3206
  3207         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3208
  3209         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3210             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3211             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3212             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3213         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3214         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3215         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3216         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3217             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3218             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3219         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3220         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL640.cbl
  3221         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3222             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3223         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3224
  3225         16  CF-CL-ZIP-CODE.
  3226             20  CF-CL-ZIP-PRIME.
  3227                 24  CF-CL-ZIP-1ST          PIC X.
  3228                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3229                 24  FILLER                 PIC X(4).
  3230             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3231         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3232             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3233             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3234             20  FILLER                     PIC XXX.
  3235
  3236         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3237         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3238         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3239         16  CF-CO-OPTION-START-DATE        PIC XX.
  3240         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3241           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3242                                                      '3' '4'.
  3243           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3244           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3245           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3246           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3247           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3248           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3249
  3250         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3251
  3252         16  CF-PAYMENT-APPROVAL-LEVELS.
  3253             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3254             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3255             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3256             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3257             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3258             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3259
  3260         16  CF-END-USER-REPORTING-USER     PIC X.
  3261             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3262             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3263
  3264         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3265             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3266             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3267
  3268         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3269
  3270         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3271         16  FILLER                         PIC X.
  3272
  3273         16  CF-CREDIT-ARCHIVE-CNTL.
  3274             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3275             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3276             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3277
  3278         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL640.cbl
  3279
  3280         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3281             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3282             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3283
  3284         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3285             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3286             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3287
  3288         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3289
  3290         16  CF-CO-ACH-ID-CODE              PIC  X.
  3291             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3292             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3293             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3294         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3295         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3296         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3297         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3298         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3299         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3300         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3301         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3302         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3303                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3304         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3305                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3306
  3307         16  CF-CO-OVER-SHORT.
  3308             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3309             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3310
  3311*         16  FILLER                         PIC X(102).
  3312         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3313             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3314             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3315
  3316         16  CF-AH-APPROVAL-DAYS.
  3317             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3318             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3319             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3320             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3321
  3322         16  FILLER                         PIC X(82).
  3323****************************************************************
  3324*             PROCESSOR/USER RECORD                            *
  3325****************************************************************
  3326
  3327     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3328         16  CF-PROCESSOR-NAME              PIC X(30).
  3329         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3330         16  CF-PROCESSOR-TITLE             PIC X(26).
  3331         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3332                 88  MESSAGE-YES                VALUE 'Y'.
  3333                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3334
  3335*****************************************************
  3336****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL640.cbl
  3337****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3338****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3339****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3340*****************************************************
  3341
  3342         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3343             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3344             20  CF-APPLICATION-FORCE       PIC X.
  3345             20  CF-INDIVIDUAL-APP.
  3346                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3347                     28  CF-BROWSE-APP      PIC X.
  3348                     28  CF-UPDATE-APP      PIC X.
  3349
  3350         16  CF-CURRENT-TERM-ON             PIC X(4).
  3351         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3352             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3353             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3354             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3355             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3356             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3357             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3358             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3359         16  CF-PROCESSOR-CARRIER           PIC X.
  3360             88  NO-CARRIER-SECURITY            VALUE ' '.
  3361         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3362             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3363         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3364             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3365         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3366             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3367
  3368         16  CF-PROC-SYS-ACCESS-SW.
  3369             20  CF-PROC-CREDIT-CLAIMS-SW.
  3370                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3371                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3372                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3373                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3374             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3375                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3376                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3377             20  CF-PROC-LIFE-GNRLDGR-SW.
  3378                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3379                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3380                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3381                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3382             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3383                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3384                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3385         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3386             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3387             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3388         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3389
  3390         16  CF-APPROVAL-LEVEL                  PIC X.
  3391             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3392             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3393             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3394             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL640.cbl
  3395
  3396         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3397
  3398         16  CF-LANGUAGE-TYPE                   PIC X.
  3399             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3400             88  CF-LANG-IS-FR                      VALUE 'F'.
  3401         16  FILLER                             PIC  X(240).
  3402
  3403****************************************************************
  3404*             PROCESSOR/REMINDERS RECORD                       *
  3405****************************************************************
  3406
  3407     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3408         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3409             20  CF-START-REMIND-DT         PIC XX.
  3410             20  CF-END-REMIND-DT           PIC XX.
  3411             20  CF-REMINDER-TEXT           PIC X(50).
  3412         16  FILLER                         PIC X(296).
  3413
  3414
  3415****************************************************************
  3416*             STATE MASTER RECORD                              *
  3417****************************************************************
  3418
  3419     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3420         16  CF-STATE-ABBREVIATION          PIC XX.
  3421         16  CF-STATE-NAME                  PIC X(25).
  3422         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3423         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3424             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3425             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3426             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3427             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3428                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3429                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3430             20  CF-ST-PREM-REJECT-SW       PIC X.
  3431                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3432                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3433             20  CF-ST-REF-REJECT-SW        PIC X.
  3434                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3435                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3436         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3437         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3438         16  CF-ST-REFUND-RULES.
  3439             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3440             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3441             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3442         16  CF-ST-FST-PMT-EXTENSION.
  3443             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3444             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3445                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3446                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3447                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3448                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3449         16  CF-ST-STATE-CALL.
  3450             20  CF-ST-CALL-UNEARNED        PIC X.
  3451             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3452             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL640.cbl
  3453         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3454             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3455             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3456         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3457         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3458         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3459         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3460         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3461         16  FILLER                         PIC X.
  3462         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3463             20  CF-ST-BENEFIT-CD           PIC XX.
  3464             20  CF-ST-BENEFIT-KIND         PIC X.
  3465                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3466                 88  CF-ST-AH-KIND              VALUE 'A'.
  3467             20  CF-ST-REM-TERM-CALC        PIC X.
  3468                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3469                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3470                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3471                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3472                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3473                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3474                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3475                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3476
  3477             20  CF-ST-REFUND-CALC          PIC X.
  3478                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3479                 88  ST-REFD-BY-R78             VALUE '1'.
  3480                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3481                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3482                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3483                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3484                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3485                 88  ST-REFD-UTAH               VALUE '7'.
  3486                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3487                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3488                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3489
  3490             20  CF-ST-EARNING-CALC         PIC X.
  3491                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3492                 88  ST-EARN-BY-R78             VALUE '1'.
  3493                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3494                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3495                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3496                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3497                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3498                 88  ST-EARN-MEAN               VALUE '8'.
  3499                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3500
  3501             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3502                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3503                 88  ST-OVRD-BY-R78             VALUE '1'.
  3504                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3505                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3506                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3507                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3508                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3509                 88  ST-OVRD-MEAN               VALUE '8'.
  3510                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL640.cbl
  3511             20  FILLER                     PIC X.
  3512
  3513         16  CF-ST-COMMISSION-CAPS.
  3514             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3515             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3516             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3517             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3518         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3519                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3520
  3521         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3522
  3523         16  CF-ST-STATUTORY-INTEREST.
  3524             20  CF-ST-STAT-DATE-FROM       PIC X.
  3525                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3526                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3527             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3528             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3529             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3530             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3531             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3532
  3533         16  CF-ST-OVER-SHORT.
  3534             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3535             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3536
  3537         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3538
  3539         16  CF-ST-RT-CALC                  PIC X.
  3540
  3541         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3542         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3543         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3544         16  CF-ST-RF-LR-CALC               PIC X.
  3545         16  CF-ST-RF-LL-CALC               PIC X.
  3546         16  CF-ST-RF-LN-CALC               PIC X.
  3547         16  CF-ST-RF-AH-CALC               PIC X.
  3548         16  CF-ST-RF-CP-CALC               PIC X.
  3549*        16  FILLER                         PIC X(206).
  3550*CIDMOD         16  FILLER                         PIC X(192).
  3551         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3552             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3553         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3554         16  CF-ST-VFY-2ND-BENE             PIC X.
  3555         16  FILLER                         PIC X(186).
  3556
  3557****************************************************************
  3558*             BENEFIT MASTER RECORD                            *
  3559****************************************************************
  3560
  3561     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3562         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3563             20  CF-BENEFIT-CODE            PIC XX.
  3564             20  CF-BENEFIT-NUMERIC  REDEFINES
  3565                 CF-BENEFIT-CODE            PIC XX.
  3566             20  CF-BENEFIT-ALPHA           PIC XXX.
  3567             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3568             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL640.cbl
  3569
  3570             20  CF-LF-COVERAGE-TYPE        PIC X.
  3571                 88  CF-REDUCING                VALUE 'R'.
  3572                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3573
  3574             20  CF-SPECIAL-CALC-CD         PIC X.
  3575                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3576                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3577                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3578                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3579                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3580                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3581                 88  CF-FARM-PLAN               VALUE 'F'.
  3582                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3583                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3584                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3585                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3586                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3587                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3588                 88  CF-PRUDENTIAL              VALUE 'P'.
  3589                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3590                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3591                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3592                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3593                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3594                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3595
  3596             20  CF-JOINT-INDICATOR         PIC X.
  3597                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3598
  3599*            20  FILLER                     PIC X(12).
  3600             20  FILLER                     PIC X(11).
  3601             20  CF-BENEFIT-CATEGORY        PIC X.
  3602             20  CF-LOAN-TYPE               PIC X(8).
  3603
  3604             20  CF-CO-REM-TERM-CALC        PIC X.
  3605                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3606                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3607                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3608                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3609                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3610
  3611             20  CF-CO-EARNINGS-CALC        PIC X.
  3612                 88  CO-EARN-BY-R78             VALUE '1'.
  3613                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3614                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3615                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3616                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3617                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3618                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3619                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3620
  3621             20  CF-CO-REFUND-CALC          PIC X.
  3622                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3623                 88  CO-REFD-BY-R78             VALUE '1'.
  3624                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3625                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3626                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL640.cbl
  3627                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3628                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3629                 88  CO-REFD-MEAN               VALUE '8'.
  3630                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3631                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3632                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3633
  3634             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3635                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3636                 88  CO-OVRD-BY-R78             VALUE '1'.
  3637                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3638                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3639                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3640                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3641                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3642                 88  CO-OVRD-MEAN               VALUE '8'.
  3643                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3644
  3645             20  CF-CO-BEN-I-G-CD           PIC X.
  3646                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3647                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3648                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3649
  3650         16  FILLER                         PIC X(304).
  3651
  3652
  3653****************************************************************
  3654*             CARRIER MASTER RECORD                            *
  3655****************************************************************
  3656
  3657     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3658         16  CF-ADDRESS-DATA.
  3659             20  CF-MAIL-TO-NAME            PIC X(30).
  3660             20  CF-IN-CARE-OF              PIC X(30).
  3661             20  CF-ADDRESS-LINE-1          PIC X(30).
  3662             20  CF-ADDRESS-LINE-2          PIC X(30).
  3663             20  CF-CITY-STATE              PIC X(30).
  3664             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3665             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3666
  3667         16  CF-CLAIM-NO-CONTROL.
  3668             20  CF-CLAIM-NO-METHOD         PIC X.
  3669                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3670                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3671                 88  CLAIM-NO-SEQ               VALUE '3'.
  3672                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3673             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3674                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3675                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3676                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3677
  3678         16  CF-CHECK-NO-CONTROL.
  3679             20  CF-CHECK-NO-METHOD         PIC X.
  3680                 88  CHECK-NO-MANUAL            VALUE '1'.
  3681                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3682                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3683                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3684             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL640.cbl
  3685                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3686
  3687         16  CF-DOMICILE-STATE              PIC XX.
  3688
  3689         16  CF-EXPENSE-CONTROLS.
  3690             20  CF-EXPENSE-METHOD          PIC X.
  3691                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3692                 88  DOLLARS-PER-PMT            VALUE '2'.
  3693                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3694                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3695             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3696             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3697
  3698         16  CF-CORRESPONDENCE-CONTROL.
  3699             20  CF-LETTER-RESEND-OPT       PIC X.
  3700                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3701                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3702             20  FILLER                     PIC X(4).
  3703
  3704         16  CF-RESERVE-CONTROLS.
  3705             20  CF-MANUAL-SW               PIC X.
  3706                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3707             20  CF-FUTURE-SW               PIC X.
  3708                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3709             20  CF-PTC-SW                  PIC X.
  3710                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3711             20  CF-IBNR-SW                 PIC X.
  3712                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3713             20  CF-PTC-LF-SW               PIC X.
  3714                 88  CF-LF-PTC-USED             VALUE '1'.
  3715             20  CF-CDT-ACCESS-METHOD       PIC X.
  3716                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3717                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3718                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3719             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3720
  3721         16  CF-CLAIM-CALC-METHOD           PIC X.
  3722             88  360-PLUS-MONTHS                VALUE '1'.
  3723             88  365-PLUS-MONTHS                VALUE '2'.
  3724             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3725             88  360-DAILY                      VALUE '4'.
  3726             88  365-DAILY                      VALUE '5'.
  3727
  3728         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3729         16  FILLER                         PIC X(11).
  3730
  3731         16  CF-LIMIT-AMOUNTS.
  3732             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3733             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3734             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3735             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3736             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3737             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3738             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3739             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3740             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3741             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3742
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL640.cbl
  3743         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3744         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3745         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3746
  3747         16  CF-ZIP-CODE.
  3748             20  CF-ZIP-PRIME.
  3749                 24  CF-ZIP-1ST             PIC X.
  3750                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3751                 24  FILLER                 PIC X(4).
  3752             20  CF-ZIP-PLUS4               PIC X(4).
  3753         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3754             20  CF-CAN-POSTAL-1            PIC XXX.
  3755             20  CF-CAN-POSTAL-2            PIC XXX.
  3756             20  FILLER                     PIC XXX.
  3757
  3758         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3759         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3760         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3761
  3762         16  CF-RATING-SWITCH               PIC X.
  3763             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3764             88  CF-NO-RATING                   VALUE 'N'.
  3765
  3766         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3767
  3768         16  CF-CARRIER-OVER-SHORT.
  3769             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3770             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3771
  3772         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3773         16  CF-SECPAY-SWITCH               PIC X.
  3774             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3775             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3776         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3777         16  FILLER                         PIC X(448).
  3778*        16  FILLER                         PIC X(452).
  3779
  3780
  3781****************************************************************
  3782*             MORTALITY MASTER RECORD                          *
  3783****************************************************************
  3784
  3785     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3786         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3787                                INDEXED BY CF-MORT-NDX.
  3788             20  CF-MORT-TABLE              PIC X(5).
  3789             20  CF-MORT-TABLE-TYPE         PIC X.
  3790                 88  CF-MORT-JOINT              VALUE 'J'.
  3791                 88  CF-MORT-SINGLE             VALUE 'S'.
  3792                 88  CF-MORT-COMBINED           VALUE 'C'.
  3793                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3794                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3795             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3796             20  CF-MORT-AGE-METHOD         PIC XX.
  3797                 88  CF-AGE-LAST                VALUE 'AL'.
  3798                 88  CF-AGE-NEAR                VALUE 'AN'.
  3799             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3800             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL640.cbl
  3801                                            PIC X.
  3802                 88  CF-MINUS                   VALUE '-'.
  3803                 88  CF-PLUS                    VALUE '+'.
  3804             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3805             20  CF-MORT-JOINT-CODE         PIC X.
  3806                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3807             20  CF-MORT-PC-Q               PIC X.
  3808                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3809             20  CF-MORT-TABLE-CODE         PIC X(4).
  3810             20  CF-MORT-COMMENTS           PIC X(15).
  3811             20  FILLER                     PIC X(14).
  3812
  3813         16  FILLER                         PIC X(251).
  3814
  3815
  3816****************************************************************
  3817*             BUSSINESS TYPE MASTER RECORD                     *
  3818****************************************************************
  3819
  3820     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3821* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3822* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3823* AND RECORD 05 IS TYPES 81-99
  3824         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3825             20  CF-BUSINESS-TITLE          PIC  X(19).
  3826             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3827                                            PIC S9V9(4) COMP-3.
  3828             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3829             20  FILLER                     PIC  X.
  3830         16  FILLER                         PIC  X(248).
  3831
  3832
  3833****************************************************************
  3834*             TERMINAL MASTER RECORD                           *
  3835****************************************************************
  3836
  3837     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3838
  3839         16  CF-COMPANY-TERMINALS.
  3840             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3841                                  PIC X(4).
  3842         16  FILLER               PIC X(248).
  3843
  3844
  3845****************************************************************
  3846*             LIFE EDIT MASTER RECORD                          *
  3847****************************************************************
  3848
  3849     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3850         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3851             20  CF-LIFE-CODE-IN            PIC XX.
  3852             20  CF-LIFE-CODE-OUT           PIC XX.
  3853         16  FILLER                         PIC X(248).
  3854
  3855
  3856****************************************************************
  3857*             AH EDIT MASTER RECORD                            *
  3858****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL640.cbl
  3859
  3860     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3861         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3862             20  CF-AH-CODE-IN              PIC XXX.
  3863             20  CF-AH-CODE-OUT             PIC XX.
  3864         16  FILLER                         PIC X(248).
  3865
  3866
  3867****************************************************************
  3868*             CREDIBILITY TABLES                               *
  3869****************************************************************
  3870
  3871     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3872         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3873                             INDEXED BY CF-CRDB-NDX.
  3874             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3875             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3876             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3877         16  FILLER                         PIC  X(332).
  3878
  3879
  3880****************************************************************
  3881*             REPORT CUSTOMIZATION RECORD                      *
  3882****************************************************************
  3883
  3884     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3885         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3886             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3887             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3888             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3889**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3890****       A T-TRANSFER.                                   ****
  3891             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3892
  3893         16  FILLER                         PIC XX.
  3894
  3895         16  CF-CARRIER-CNTL-OPT.
  3896             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3897                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3898                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3899             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3900                                            PIC X.
  3901         16  CF-GROUP-CNTL-OPT.
  3902             20  CF-GROUP-OPT-SEQ           PIC 9.
  3903                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3904                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3905             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3906                                            PIC X(6).
  3907         16  CF-STATE-CNTL-OPT.
  3908             20  CF-STATE-OPT-SEQ           PIC 9.
  3909                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3910                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3911             20  CF-STATE-SELECT OCCURS 3 TIMES
  3912                                            PIC XX.
  3913         16  CF-ACCOUNT-CNTL-OPT.
  3914             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3915                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3916                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL640.cbl
  3917             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3918                                            PIC X(10).
  3919         16  CF-BUS-TYP-CNTL-OPT.
  3920             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3921                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3922                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3923             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3924                                            PIC XX.
  3925         16  CF-LF-TYP-CNTL-OPT.
  3926             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3927                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3928                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3929             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3930                                            PIC XX.
  3931         16  CF-AH-TYP-CNTL-OPT.
  3932             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3933                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3934                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3935             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3936                                            PIC XX.
  3937         16  CF-REPTCD1-CNTL-OPT.
  3938             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3939                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3940                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3941             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3942                                            PIC X(10).
  3943         16  CF-REPTCD2-CNTL-OPT.
  3944             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3945                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3946                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3947             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3948                                            PIC X(10).
  3949         16  CF-USER1-CNTL-OPT.
  3950             20  CF-USER1-OPT-SEQ           PIC 9.
  3951                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3952                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3953             20  CF-USER1-SELECT OCCURS 3 TIMES
  3954                                            PIC X(10).
  3955         16  CF-USER2-CNTL-OPT.
  3956             20  CF-USER2-OPT-SEQ           PIC 9.
  3957                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3958                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3959             20  CF-USER2-SELECT OCCURS 3 TIMES
  3960                                            PIC X(10).
  3961         16  CF-USER3-CNTL-OPT.
  3962             20  CF-USER3-OPT-SEQ           PIC 9.
  3963                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3964                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3965             20  CF-USER3-SELECT OCCURS 3 TIMES
  3966                                            PIC X(10).
  3967         16  CF-USER4-CNTL-OPT.
  3968             20  CF-USER4-OPT-SEQ           PIC 9.
  3969                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3970                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3971             20  CF-USER4-SELECT OCCURS 3 TIMES
  3972                                            PIC X(10).
  3973         16  CF-USER5-CNTL-OPT.
  3974             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL640.cbl
  3975                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3976                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3977             20  CF-USER5-SELECT OCCURS 3 TIMES
  3978                                            PIC X(10).
  3979         16  CF-REINS-CNTL-OPT.
  3980             20  CF-REINS-OPT-SEQ           PIC 9.
  3981                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3982                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3983             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3984                 24  CF-REINS-PRIME         PIC XXX.
  3985                 24  CF-REINS-SUB           PIC XXX.
  3986
  3987         16  CF-AGENT-CNTL-OPT.
  3988             20  CF-AGENT-OPT-SEQ           PIC 9.
  3989                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3990                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3991             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3992                                            PIC X(10).
  3993
  3994         16  FILLER                         PIC X(43).
  3995
  3996         16  CF-LOSS-RATIO-SELECT.
  3997             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3998             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3999         16  CF-ENTRY-DATE-SELECT.
  4000             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4001             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4002         16  CF-EFFECTIVE-DATE-SELECT.
  4003             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4004             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4005
  4006         16  CF-EXCEPTION-LIST-IND          PIC X.
  4007             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4008
  4009         16  FILLER                         PIC X(318).
  4010
  4011****************************************************************
  4012*                  EXCEPTION REPORTING RECORD                  *
  4013****************************************************************
  4014
  4015     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4016         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4017             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4018
  4019         16  CF-COMBINED-LIFE-AH-OPT.
  4020             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4021             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4022             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4023             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4024
  4025         16  CF-LIFE-OPT.
  4026             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4027             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4028             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4029             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4030             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4031             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4032             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL640.cbl
  4033             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4034             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4035             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4036
  4037         16  CF-AH-OPT.
  4038             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4039             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4040             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4041             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4042             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4043             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4044             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4045             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4046             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4047             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4048
  4049         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4050             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4051             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4052             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4053
  4054         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4055
  4056         16  FILLER                         PIC X(673).
  4057
  4058
  4059****************************************************************
  4060*             MORTGAGE SYSTEM PLAN RECORD                      *
  4061****************************************************************
  4062
  4063     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4064         16  CF-PLAN-TYPE                   PIC X.
  4065             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4066             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4067             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4068         16  CF-PLAN-ABBREV                 PIC XXX.
  4069         16  CF-PLAN-DESCRIPT               PIC X(10).
  4070         16  CF-PLAN-NOTES                  PIC X(20).
  4071         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4072         16  CF-PLAN-UNDERWRITING.
  4073             20  CF-PLAN-TERM-DATA.
  4074                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4075                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4076             20  CF-PLAN-AGE-DATA.
  4077                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4078                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4079                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4080             20  CF-PLAN-BENEFIT-DATA.
  4081                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4082                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4083                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4084                                            PIC S9(7)V99  COMP-3.
  4085         16  CF-PLAN-POLICY-FORMS.
  4086             20  CF-POLICY-FORM             PIC X(12).
  4087             20  CF-MASTER-APPLICATION      PIC X(12).
  4088             20  CF-MASTER-POLICY           PIC X(12).
  4089         16  CF-PLAN-RATING.
  4090             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL640.cbl
  4091             20  CF-SEX-RATING              PIC X.
  4092                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4093                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4094             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4095             20  CF-SUB-STD-TYPE            PIC X.
  4096                 88  CF-PCT-OF-PREM            VALUE '1'.
  4097                 88  CF-PCT-OF-BENE            VALUE '2'.
  4098         16  CF-PLAN-PREM-TOLERANCES.
  4099             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4100             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4101         16  CF-PLAN-PYMT-TOLERANCES.
  4102             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4103             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4104         16  CF-PLAN-MISC-DATA.
  4105             20  FILLER                     PIC X.
  4106             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4107             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4108         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4109         16  CF-PLAN-IND-GRP                PIC X.
  4110             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4111                                                     '1'.
  4112             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4113                                                     '2'.
  4114         16  CF-MIB-SEARCH-SW               PIC X.
  4115             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4116             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4117             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4118             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4119         16  CF-ALPHA-SEARCH-SW             PIC X.
  4120             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4121             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4122             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4123             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4124             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4125             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4126             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4127             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4128             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4129             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4130                                                     'A' 'B' 'C'
  4131                                                     'X' 'Y' 'Z'.
  4132         16  CF-EFF-DT-RULE-SW              PIC X.
  4133             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4134             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4135             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4136             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4137             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4138         16  FILLER                         PIC X(4).
  4139         16  CF-HEALTH-QUESTIONS            PIC X.
  4140             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4141         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4142         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4143         16  CF-PLAN-SNGL-JNT               PIC X.
  4144             88  CF-COMBINED-PLAN              VALUE 'C'.
  4145             88  CF-JNT-PLAN                   VALUE 'J'.
  4146             88  CF-SNGL-PLAN                  VALUE 'S'.
  4147         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4148         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL640.cbl
  4149         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4150         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4151         16  CF-RERATE-CNTL                 PIC  X.
  4152             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4153             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4154             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4155             88  CF-AUTO-RECALC                 VALUE '4'.
  4156         16  CF-BENEFIT-TYPE                PIC  X.
  4157             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4158             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4159         16  CF-POLICY-FEE                  PIC S999V99
  4160                                                    COMP-3.
  4161         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4162         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4163         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4164         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4165         16  FILLER                         PIC  X(32).
  4166         16  CF-TERMINATION-FORM            PIC  X(04).
  4167         16  FILLER                         PIC  X(08).
  4168         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4169                                                       COMP-3.
  4170         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4171         16  CF-ISSUE-LETTER                PIC  X(4).
  4172         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4173         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4174             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4175             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4176         16  CF-MP-REFUND-CALC              PIC X.
  4177             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4178             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4179             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4180             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4181             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4182             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4183             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4184             88  CF-MP-REFD-MEAN                VALUE '8'.
  4185         16  CF-ALT-RATE-CODE               PIC  X(5).
  4186
  4187
  4188         16  FILLER                         PIC X(498).
  4189****************************************************************
  4190*             MORTGAGE COMPANY MASTER RECORD                   *
  4191****************************************************************
  4192
  4193     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4194         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4195         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4196             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4197             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4198             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4199             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4200             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4201
  4202         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4203         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4204         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4205         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4206         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL640.cbl
  4207
  4208         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4209             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4210         16  CF-MP-RECON-USE-IND            PIC X(1).
  4211             88  CF-MP-USE-RECON             VALUE 'Y'.
  4212         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4213             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4214         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4215             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4216             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4217         16  FILLER                         PIC X(1).
  4218         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4219             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4220         16  CF-MORTG-MIB-VERSION           PIC X.
  4221             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4222             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4223             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4224         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4225             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4226                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4227             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4228                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4229             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4230                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4231             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4232                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4233             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4234                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4235             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4236                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4237         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4238         16  FILLER                         PIC X(7).
  4239         16  CF-MORTG-DESTINATION-SYMBOL.
  4240             20  CF-MORTG-MIB-COMM          PIC X(5).
  4241             20  CF-MORTG-MIB-TERM          PIC X(5).
  4242         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4243             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4244         16  FILLER                         PIC X(03).
  4245         16  CF-MP-CHECK-NO-CONTROL.
  4246             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4247                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4248                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4249                                                ' ' LOW-VALUES.
  4250                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4251                                               VALUE '3'.
  4252         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4253         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4254         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4255             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4256                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4257             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4258                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4259             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4260                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4261             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4262                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4263             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4264                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL640.cbl
  4265             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4266                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4267         16  CF-MORTG-BILLING-AREA.
  4268             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4269                                            PIC X.
  4270         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4271         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4272         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4273         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4274             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4275             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4276         16  FILLER                         PIC X.
  4277         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4278             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4279             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4280         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4281         16  FILLER                         PIC X(8).
  4282         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4283         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4284         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4285         16  CF-ACH-COMPANY-ID.
  4286             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4287                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4288                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4289                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4290             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4291         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4292             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4293         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4294             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4295             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4296         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4297         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4298         16  FILLER                         PIC X(536).
  4299
  4300****************************************************************
  4301*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4302****************************************************************
  4303
  4304     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4305         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4306             20  CF-FEMALE-HEIGHT.
  4307                 24  CF-FEMALE-FT           PIC 99.
  4308                 24  CF-FEMALE-IN           PIC 99.
  4309             20  CF-FEMALE-MIN-WT           PIC 999.
  4310             20  CF-FEMALE-MAX-WT           PIC 999.
  4311         16  FILLER                         PIC X(428).
  4312
  4313     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4314         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4315             20  CF-MALE-HEIGHT.
  4316                 24  CF-MALE-FT             PIC 99.
  4317                 24  CF-MALE-IN             PIC 99.
  4318             20  CF-MALE-MIN-WT             PIC 999.
  4319             20  CF-MALE-MAX-WT             PIC 999.
  4320         16  FILLER                         PIC X(428).
  4321******************************************************************
  4322*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL640.cbl
  4323******************************************************************
  4324     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4325         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4326             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4327             20  CF-SYS-LETTER-ID           PIC X(04).
  4328             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4329             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4330             20  CF-SYS-RESET-SW            PIC X(01).
  4331             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4332             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4333
  4334         16  FILLER                         PIC X(50).
  4335
  4336         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4337             20  CF-USER-ACTIVE-SW          PIC X(01).
  4338             20  CF-USER-LETTER-ID          PIC X(04).
  4339             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4340             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4341             20  CF-USER-RESET-SW           PIC X(01).
  4342             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4343             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4344             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4345
  4346         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL640.cbl
  4348*                            COPY ERCCOMP.
  4349******************************************************************
  4350*                                                                *
  4351*                                                                *
  4352*                            ERCCOMP                             *
  4353*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4354*                            VMOD=2.019                          *
  4355*                                                                *
  4356*   ONLINE CREDIT SYSTEM                                         *
  4357*                                                                *
  4358*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4359*                                                                *
  4360*   FILE TYPE = VSAM,KSDS                                        *
  4361*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4362*                                                                *
  4363*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4364*       ALTERNATE PATH = NONE                                    *
  4365*                                                                *
  4366*   LOG = NO                                                     *
  4367*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4368*                                                                *
  4369******************************************************************
  4370*                   C H A N G E   L O G
  4371*
  4372* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4373*-----------------------------------------------------------------
  4374*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4375* EFFECTIVE    NUMBER
  4376*-----------------------------------------------------------------
  4377* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4378* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4379* 092205    2005050300006  PEMA  ADD LEASE FEE
  4380* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4381* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4382* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4383* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4384* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4385* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4386******************************************************************
  4387
  4388 01  COMPENSATION-MASTER.
  4389     12  CO-RECORD-ID                          PIC XX.
  4390         88  VALID-CO-ID                          VALUE 'CO'.
  4391
  4392     12  CO-CONTROL-PRIMARY.
  4393         16  CO-COMPANY-CD                     PIC X.
  4394         16  CO-CONTROL.
  4395             20  CO-CTL-1.
  4396                 24  CO-CARR-GROUP.
  4397                     28  CO-CARRIER            PIC X.
  4398                     28  CO-GROUPING.
  4399                         32  CO-GROUP-PREFIX   PIC XXX.
  4400                         32  CO-GROUP-PRIME    PIC XXX.
  4401                 24  CO-RESP-NO.
  4402                     28  CO-RESP-PREFIX        PIC X(4).
  4403                     28  CO-RESP-PRIME         PIC X(6).
  4404             20  CO-CTL-2.
  4405                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL640.cbl
  4406                     28  CO-ACCT-PREFIX        PIC X(4).
  4407                     28  CO-ACCT-PRIME         PIC X(6).
  4408         16  CO-TYPE                           PIC X.
  4409             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4410             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4411             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4412
  4413     12  CO-MAINT-INFORMATION.
  4414         16  CO-LAST-MAINT-DT                  PIC XX.
  4415         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4416         16  CO-LAST-MAINT-USER                PIC X(4).
  4417     12  FILLER                                PIC XX.
  4418     12  CO-STMT-TYPE                          PIC XXX.
  4419     12  CO-COMP-TYPE                          PIC X.
  4420         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4421     12  CO-STMT-OWNER                         PIC X(4).
  4422     12  CO-BALANCE-CONTROL                    PIC X.
  4423         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4424         88  CO-NO-BALANCE                        VALUE 'N'.
  4425
  4426     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4427         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4428         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4429         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4430
  4431     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4432         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4433         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4434
  4435     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4436     12  CO-GA-DIRECT-DEP                      PIC X.
  4437     12  CO-FUTURE-SPACE                       PIC X.
  4438         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4439
  4440     12  CO-ACCT-NAME                          PIC X(30).
  4441     12  CO-MAIL-NAME                          PIC X(30).
  4442     12  CO-ADDR-1                             PIC X(30).
  4443     12  CO-ADDR-2                             PIC X(30).
  4444     12  CO-ADDR-3.
  4445         16  CO-ADDR-CITY                      PIC X(27).
  4446         16  CO-ADDR-STATE                     PIC XX.
  4447     12  CO-CSO-1099                           PIC X.
  4448     12  CO-ZIP.
  4449         16  CO-ZIP-PRIME.
  4450             20  CO-ZIP-PRI-1ST                PIC X.
  4451                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4452             20  FILLER                        PIC X(4).
  4453         16  CO-ZIP-PLUS4                      PIC X(4).
  4454     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4455         16  CO-CAN-POSTAL-1                   PIC XXX.
  4456         16  CO-CAN-POSTAL-2                   PIC XXX.
  4457         16  FILLER                            PIC XXX.
  4458     12  CO-SOC-SEC                            PIC X(13).
  4459     12  CO-TELEPHONE.
  4460         16  CO-AREA-CODE                      PIC XXX.
  4461         16  CO-PREFIX                         PIC XXX.
  4462         16  CO-PHONE                          PIC X(4).
  4463
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL640.cbl
  4464     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4465
  4466     12  CO-AR-BAL-LEVEL                       PIC X.
  4467         88  CO-AR-REF-LVL                        VALUE '1'.
  4468         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4469         88  CO-AR-BILL-LVL                       VALUE '2'.
  4470         88  CO-AR-AGT-LVL                        VALUE '3'.
  4471         88  CO-AR-FR-LVL                         VALUE '4'.
  4472
  4473     12  CO-AR-NORMAL-PRINT                    PIC X.
  4474         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4475         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4476
  4477     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4478
  4479     12  CO-AR-REPORTING                       PIC X.
  4480         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4481         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4482
  4483     12  CO-AR-PULL-CHECK                      PIC X.
  4484         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4485         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4486
  4487     12  CO-AR-BALANCE-PRINT                   PIC X.
  4488         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4489
  4490     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4491         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4492         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4493         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4494
  4495     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4496
  4497     12  CO-USER-CODE                          PIC X.
  4498     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4499
  4500******************************************************************
  4501*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4502*    THE LAST MONTH END RUN.
  4503******************************************************************
  4504
  4505     12  CO-LAST-ACTIVITY-DATE.
  4506         16  CO-ACT-YEAR                       PIC 99.
  4507         16  CO-ACT-MONTH                      PIC 99.
  4508         16  CO-ACT-DAY                        PIC 99.
  4509
  4510     12  CO-LAST-STMT-DT.
  4511         16  CO-LAST-STMT-YEAR                 PIC 99.
  4512         16  CO-LAST-STMT-MONTH                PIC 99.
  4513         16  CO-LAST-STMT-DAY                  PIC 99.
  4514
  4515     12  CO-MO-END-TOTALS.
  4516         16  CO-MONTHLY-TOTALS.
  4517             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4518             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4519             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4520             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4521             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL640.cbl
  4522
  4523         16  CO-AGING-TOTALS.
  4524             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4525             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4526             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4527             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4528
  4529         16  CO-YTD-TOTALS.
  4530             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4531             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4532
  4533         16  CO-OVER-UNDER-TOTALS.
  4534             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4535             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4536
  4537     12  CO-MISCELLANEOUS-TOTALS.
  4538         16  CO-FICA-TOTALS.
  4539             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4540             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4541
  4542         16  CO-CLAIM-TOTALS.
  4543             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4544             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4545
  4546******************************************************************
  4547*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4548*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4549******************************************************************
  4550
  4551     12  CO-CURRENT-TOTALS.
  4552         16  CO-CURRENT-LAST-STMT-DT.
  4553             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4554             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4555             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4556
  4557         16  CO-CURRENT-MONTHLY-TOTALS.
  4558             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4559             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4560             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4561             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4562             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4563
  4564         16  CO-CURRENT-AGING-TOTALS.
  4565             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4566             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4567             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4568             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4569
  4570         16  CO-CURRENT-YTD-TOTALS.
  4571             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4572             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4573
  4574     12  CO-PAID-COMM-TOTALS.
  4575         16  CO-YTD-PAID-COMMS.
  4576             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4577             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4578
  4579     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL640.cbl
  4580         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4581         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4582
  4583     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4584         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4585         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4586         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4587         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4588         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4589         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4590         88  CO-FINAL-LETTER                  VALUE 'F'.
  4591         88  CO-RECONCILING                   VALUE 'R'.
  4592         88  CO-PHONE-CALL                    VALUE 'P'.
  4593         88  CO-LEGAL                         VALUE 'L'.
  4594         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4595         88  CO-WRITE-OFF                     VALUE 'W'.
  4596         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4597
  4598     12  CO-CSR-CODE                       PIC X(4).
  4599
  4600     12  CO-GA-STATUS-INFO.
  4601         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4602         16  CO-GA-TERMINATION-DT          PIC XX.
  4603         16  CO-GA-STATUS-CODE             PIC X.
  4604             88  CO-GA-ACTIVE                 VALUE 'A'.
  4605             88  CO-GA-INACTIVE               VALUE 'I'.
  4606             88  CO-GA-PENDING                VALUE 'P'.
  4607         16  CO-GA-COMMENTS.
  4608             20  CO-GA-COMMENT-1           PIC X(40).
  4609             20  CO-GA-COMMENT-2           PIC X(40).
  4610             20  CO-GA-COMMENT-3           PIC X(40).
  4611             20  CO-GA-COMMENT-4           PIC X(40).
  4612
  4613     12  CO-RPTCD2                         PIC X(10).
  4614     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4615         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4616         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4617
  4618     12  CO-TYPE-AGENT                     PIC X(01).
  4619         88  CO-CORPORATION                   VALUE 'C'.
  4620         88  CO-PARTNERSHIP                   VALUE 'P'.
  4621         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4622         88  CO-TRUST                         VALUE 'T'.
  4623         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4624
  4625     12  CO-FAXNO.
  4626         16  CO-FAX-AREA-CODE                  PIC XXX.
  4627         16  CO-FAX-PREFIX                     PIC XXX.
  4628         16  CO-FAX-PHONE                      PIC X(4).
  4629
  4630     12  CO-BANK-INFORMATION.
  4631         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4632         16  CO-BANK-TRANSIT-NON REDEFINES
  4633             CO-BANK-TRANSIT-NO                PIC 9(8).
  4634
  4635         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4636     12  CO-MISC-DEDUCT-INFO REDEFINES
  4637                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL640.cbl
  4638         16  CO-MD-GL-ACCT                     PIC X(10).
  4639         16  CO-MD-DIV                         PIC XX.
  4640         16  CO-MD-CENTER                      PIC X(4).
  4641         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4642         16  CO-CREATE-AP-CHECK                PIC X.
  4643         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4644         16  FILLER                            PIC XXX.
  4645     12  CO-ACH-STATUS                         PIC X.
  4646         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4647         88  CO-ACH-PENDING                        VALUE 'P'.
  4648
  4649     12  CO-BILL-SW                            PIC X.
  4650     12  CO-CONTROL-NAME                       PIC X(30).
  4651     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4652     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4653     12  CO-CLP-STATE                          PIC XX.
  4654     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4655     12  CO-SPP-REFUND-EDIT                    PIC X.
  4656
  4657******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL640.cbl
  4659*                            COPY ERCPYAJ.
  4660******************************************************************
  4661*                                                                *
  4662*                            ERCPYAJ                             *
  4663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4664*                            VMOD=2.015                          *
  4665*                                                                *
  4666*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4667*                                                                *
  4668*                                                                *
  4669*   FILE TYPE = VSAM,KSDS                                        *
  4670*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4671*                                                                *
  4672*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4673*       ALTERNATE PATHS = NONE                                   *
  4674*                                                                *
  4675*   LOG = YES                                                    *
  4676*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4677******************************************************************
  4678******************************************************************
  4679*                   C H A N G E   L O G
  4680*
  4681* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4682*-----------------------------------------------------------------
  4683*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4684* EFFECTIVE    NUMBER
  4685*-----------------------------------------------------------------
  4686* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4687* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4688******************************************************************
  4689
  4690 01  PENDING-PAY-ADJ.
  4691     12  PY-RECORD-ID                     PIC XX.
  4692         88  VALID-PY-ID                        VALUE 'PY'.
  4693
  4694     12  PY-CONTROL-PRIMARY.
  4695         16  PY-COMPANY-CD                PIC X.
  4696         16  PY-CARRIER                   PIC X.
  4697         16  PY-GROUPING                  PIC X(6).
  4698         16  PY-FIN-RESP                  PIC X(10).
  4699         16  PY-ACCOUNT                   PIC X(10).
  4700         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4701                                          PIC X(10).
  4702         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4703         16  PY-RECORD-TYPE               PIC X.
  4704             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4705             88  PY-DEPOSIT                   VALUE 'D'.
  4706             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4707             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4708             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4709             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4710             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4711             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4712             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4713             88  PY-FICA-ENTRY                VALUE 'F'.
  4714             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4715             88  PY-POLICY-FEE                VALUE 'W'.
  4716             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL640.cbl
  4717
  4718     12  PY-PYMT-TYPE                     PIC X.
  4719             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4720             88  PY-REINS-PYMT                VALUE 'R'.
  4721             88  PY-EXP-PYMT                  VALUE 'E'.
  4722
  4723     12  PY-BIL-INV                       PIC X(6).
  4724     12  PY-REF-NO                        PIC X(12).
  4725
  4726     12  PY-LAST-MAINT-DT                 PIC XX.
  4727     12  PY-LAST-MAINT-BY                 PIC X(4).
  4728     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4729
  4730     12  PY-PYADJ-RECORD.
  4731         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4732         16  PY-ENTRY-COMMENT             PIC X(30).
  4733         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4734             20  PY-GL-ACCOUNT            PIC X(10).
  4735             20  PY-GL-STATE              PIC X(02).
  4736             20  PY-GL-CANC-SW            PIC X(01).
  4737                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4738                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4739             20  PY-GL-COMMENT            PIC X(10).
  4740             20  FILLER      REDEFINES PY-GL-COMMENT.
  4741                 24  PY-GL-CHECK-NO       PIC 9(06).
  4742                 24  FILLER               PIC X(04).
  4743             20  FILLER                   PIC X(07).
  4744         16  PY-SAVE-ACCOUNT              PIC X(10).
  4745         16  PY-SAVE-TYPE                 PIC X(01).
  4746
  4747         16  PY-LETTERS.
  4748             20  PY-LETTER OCCURS 3 TIMES
  4749                           INDEXED BY PY-LET-NDX
  4750                                          PIC X(04).
  4751
  4752         16  PY-ERCOMP-TYPE               PIC X.
  4753             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4754             88  PY-GA-TYPE                   VALUE 'G'.
  4755             88  PY-BANK-TYPE                 VALUE 'B'.
  4756         16  FILLER                       PIC X(05).
  4757
  4758     12  PY-RECORD-STATUS.
  4759         16  PY-CREDIT-SELECT-DT          PIC XX.
  4760         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4761         16  PY-BILLED-DATE               PIC XX.
  4762         16  PY-REPORTED-DT               PIC XX.
  4763         16  PY-PMT-APPLIED               PIC X.
  4764             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4765             88  PY-GA-PMT                    VALUE 'G'.
  4766             88  PY-OVWRITE-PMT               VALUE 'O'.
  4767             88  PY-NON-AR-PMT                VALUE 'N'.
  4768         16  FILLER                       PIC X(5).
  4769         16  PY-INPUT-DT                  PIC XX.
  4770         16  PY-CHECK-NUMBER              PIC X(6).
  4771         16  PY-VOID-SW                   PIC X.
  4772             88  PY-CHECK-VOIDED              VALUE 'V'.
  4773         16  PY-CHECK-ORIGIN-SW           PIC X.
  4774             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL640.cbl
  4775             88  PY-REFUND-CHECK              VALUE 'R'.
  4776             88  PY-GA-CHECK                  VALUE 'G'.
  4777             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4778             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4779         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4780         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4781         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4782         16  PY-BILL-FLAG                 PIC X.
  4783             88  PY-BILLED                    VALUE 'B'.
  4784         16  PY-AR-FLAG                   PIC X.
  4785             88  PY-AR-CYCLE                  VALUE 'C'.
  4786             88  PY-AR-MONTH-END              VALUE 'M'.
  4787         16  PY-AR-DATE                   PIC XX.
  4788
  4789     12  PY-GL-CODES.
  4790         16  PY-GL-DB                     PIC X(14).
  4791         16  PY-GL-CR                     PIC X(14).
  4792         16  PY-GL-FLAG                   PIC X.
  4793         16  PY-GL-DATE                   PIC XX.
  4794
  4795     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4796     12  FILLER                           PIC X(3).
  4797******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL640.cbl
  4799*                            COPY ERCACCT.
  4800******************************************************************
  4801*                                                                *
  4802*                                                                *
  4803*                            ERCACCT                             *
  4804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4805*                            VMOD=2.031                          *
  4806*                                                                *
  4807*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4808*                                                                *
  4809*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4810*   VSAM ACCOUNT MASTER FILES.                                   *
  4811*                                                                *
  4812*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4813*                                                                *
  4814*   FILE TYPE = VSAM,KSDS                                        *
  4815*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4816*                                                                *
  4817*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4818*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4819*                                                                *
  4820*   LOG = NO                                                     *
  4821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4822*                                                                *
  4823*                                                                *
  4824******************************************************************
  4825*                   C H A N G E   L O G
  4826*
  4827* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4828*-----------------------------------------------------------------
  4829*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4830* EFFECTIVE    NUMBER
  4831*-----------------------------------------------------------------
  4832* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4833* 092705    2005050300006  PEMA  ADD SPP LEASES
  4834* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4835* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4836* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4837* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4838* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4839******************************************************************
  4840
  4841 01  ACCOUNT-MASTER.
  4842     12  AM-RECORD-ID                      PIC XX.
  4843         88  VALID-AM-ID                      VALUE 'AM'.
  4844
  4845     12  AM-CONTROL-PRIMARY.
  4846         16  AM-COMPANY-CD                 PIC X.
  4847         16  AM-MSTR-CNTRL.
  4848             20  AM-CONTROL-A.
  4849                 24  AM-CARRIER            PIC X.
  4850                 24  AM-GROUPING.
  4851                     28 AM-GROUPING-PREFIX PIC XXX.
  4852                     28 AM-GROUPING-PRIME  PIC XXX.
  4853                 24  AM-STATE              PIC XX.
  4854                 24  AM-ACCOUNT.
  4855                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4856                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL640.cbl
  4857             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4858                                           PIC X(19).
  4859             20  AM-CNTRL-B.
  4860                 24  AM-EXPIRATION-DT      PIC XX.
  4861                 24  FILLER                PIC X(4).
  4862             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4863                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4864
  4865     12  AM-CONTROL-BY-VAR-GRP.
  4866         16  AM-COMPANY-CD-A1              PIC X.
  4867         16  AM-VG-CARRIER                 PIC X.
  4868         16  AM-VG-GROUPING                PIC X(6).
  4869         16  AM-VG-STATE                   PIC XX.
  4870         16  AM-VG-ACCOUNT                 PIC X(10).
  4871         16  AM-VG-DATE.
  4872             20  AM-VG-EXPIRATION-DT       PIC XX.
  4873             20  FILLER                    PIC X(4).
  4874         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4875                                           PIC 9(11)      COMP-3.
  4876     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4877         16  FILLER                        PIC X(10).
  4878         16  AM-VG-KEY3.
  4879             20  AM-VG3-ACCOUNT            PIC X(10).
  4880             20  AM-VG3-EXP-DT             PIC XX.
  4881         16  FILLER                        PIC X(4).
  4882     12  AM-MAINT-INFORMATION.
  4883         16  AM-LAST-MAINT-DT              PIC XX.
  4884         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4885         16  AM-LAST-MAINT-USER            PIC X(4).
  4886         16  FILLER                        PIC XX.
  4887
  4888     12  AM-EFFECTIVE-DT                   PIC XX.
  4889     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4890
  4891     12  AM-PREV-DATES  COMP-3.
  4892         16  AM-PREV-EXP-DT                PIC 9(11).
  4893         16  AM-PREV-EFF-DT                PIC 9(11).
  4894
  4895     12  AM-REPORT-CODE-1                  PIC X(10).
  4896     12  AM-REPORT-CODE-2                  PIC X(10).
  4897
  4898     12  AM-CITY-CODE                      PIC X(4).
  4899     12  AM-COUNTY-PARISH                  PIC X(6).
  4900
  4901     12  AM-NAME                           PIC X(30).
  4902     12  AM-PERSON                         PIC X(30).
  4903     12  AM-ADDRS                          PIC X(30).
  4904     12  AM-CITY.
  4905         16  AM-ADDR-CITY                  PIC X(28).
  4906         16  AM-ADDR-STATE                 PIC XX.
  4907     12  AM-ZIP.
  4908         16  AM-ZIP-PRIME.
  4909             20  AM-ZIP-PRI-1ST            PIC X.
  4910                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4911             20  FILLER                    PIC X(4).
  4912         16  AM-ZIP-PLUS4                  PIC X(4).
  4913     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4914         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL640.cbl
  4915         16  AM-CAN-POSTAL-2               PIC XXX.
  4916         16  FILLER                        PIC XXX.
  4917     12  AM-TEL-NO.
  4918         16  AM-AREA-CODE                  PIC 999.
  4919         16  AM-TEL-PRE                    PIC 999.
  4920         16  AM-TEL-NBR                    PIC 9(4).
  4921     12  AM-TEL-LOC                        PIC X.
  4922         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4923         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4924
  4925     12  AM-COMM-STRUCTURE.
  4926         16  AM-DEFN-1.
  4927             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4928                 24  AM-AGT.
  4929                     28  AM-AGT-PREFIX     PIC X(4).
  4930                     28  AM-AGT-PRIME      PIC X(6).
  4931                 24  AM-COM-TYP            PIC X.
  4932                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4933                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4934                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4935                 24  AM-RECALC-LV-INDIC    PIC X.
  4936                 24  AM-RETRO-LV-INDIC     PIC X.
  4937                 24  AM-GL-CODES           PIC X.
  4938                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4939                 24  FILLER                PIC X(01).
  4940         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4941             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4942                 24  FILLER                PIC X(11).
  4943                 24  AM-L-COMA             PIC XXX.
  4944                 24  AM-J-COMA             PIC XXX.
  4945                 24  AM-A-COMA             PIC XXX.
  4946                 24  FILLER                PIC X(6).
  4947
  4948     12  AM-COMM-CHANGE-STATUS             PIC X.
  4949         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4950
  4951     12  AM-CSR-CODE                       PIC X(4).
  4952
  4953     12  AM-BILLING-STATUS                 PIC X.
  4954         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4955         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4956     12  AM-AUTO-REFUND-SW                 PIC X.
  4957         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4958         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4959     12  AM-GPCD                           PIC 99.
  4960     12  AM-IG                             PIC X.
  4961         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4962         88  AM-HAS-GROUP                     VALUE '2'.
  4963     12  AM-STATUS                         PIC X.
  4964         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4965         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4966         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4967         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4968         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4969         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4970     12  AM-REMIT-TO                       PIC 99.
  4971     12  AM-ID-NO                          PIC X(11).
  4972
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL640.cbl
  4973     12  AM-CAL-TABLE                      PIC XX.
  4974     12  AM-LF-DEVIATION                   PIC XXX.
  4975     12  AM-AH-DEVIATION                   PIC XXX.
  4976     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4977     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4978     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4979     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4980     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4981     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4982
  4983     12  AM-USER-FIELDS.
  4984         16  AM-FLD-1                      PIC XX.
  4985         16  AM-FLD-2                      PIC XX.
  4986         16  AM-FLD-3                      PIC XX.
  4987         16  AM-FLD-4                      PIC XX.
  4988         16  AM-FLD-5                      PIC XX.
  4989
  4990     12  AM-1ST-PROD-DATE.
  4991         16  AM-1ST-PROD-YR                PIC XX.
  4992         16  AM-1ST-PROD-MO                PIC XX.
  4993         16  AM-1ST-PROD-DA                PIC XX.
  4994     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4995     12  AM-CERTS-PURGED-DATE.
  4996         16  AM-PUR-YR                     PIC XX.
  4997         16  AM-PUR-MO                     PIC XX.
  4998         16  AM-PUR-DA                     PIC XX.
  4999     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5000     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5001     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5002     12  AM-INACTIVE-DATE.
  5003         16  AM-INA-MO                     PIC 99.
  5004         16  AM-INA-DA                     PIC 99.
  5005         16  AM-INA-YR                     PIC 99.
  5006     12  AM-AR-HI-CERT-DATE                PIC XX.
  5007
  5008     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5009     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5010
  5011     12  AM-OB-PAYMENT-MODE                PIC X.
  5012         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5013         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5014         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5015         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5016
  5017     12  AM-AH-ONLY-INDICATOR              PIC X.
  5018         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5019         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5020
  5021     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5022
  5023     12  AM-OVER-SHORT.
  5024         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5025         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5026
  5027     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5028     12  AM-DCC-CLP-STATE                  PIC XX.
  5029
  5030     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL640.cbl
  5031     12  AM-RECALC-REIN                    PIC X.
  5032
  5033     12  AM-REI-TABLE                      PIC XXX.
  5034     12  AM-REI-ET-LF                      PIC X.
  5035     12  AM-REI-ET-AH                      PIC X.
  5036     12  AM-REI-PE-LF                      PIC X.
  5037     12  AM-REI-PE-AH                      PIC X.
  5038     12  AM-REI-PRT-ST                     PIC X.
  5039     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5040     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5041     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5042     12  AM-REI-GROUP-A                    PIC X(6).
  5043     12  AM-REI-MORT                       PIC X(4).
  5044     12  AM-REI-PRT-OW                     PIC X.
  5045     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5046     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5047     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5048     12  AM-REI-GROUP-B                    PIC X(6).
  5049
  5050     12  AM-TRUST-TYPE                     PIC X(2).
  5051
  5052     12  AM-EMPLOYER-STMT-USED             PIC X.
  5053     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5054
  5055     12  AM-STD-AH-TYPE                    PIC XX.
  5056     12  AM-EARN-METHODS.
  5057         16  AM-EARN-METHOD-R              PIC X.
  5058             88 AM-REF-RL-R78                 VALUE 'R'.
  5059             88 AM-REF-RL-PR                  VALUE 'P'.
  5060             88 AM-REF-RL-MEAN                VALUE 'M'.
  5061             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5062         16  AM-EARN-METHOD-L              PIC X.
  5063             88 AM-REF-LL-R78                 VALUE 'R'.
  5064             88 AM-REF-LL-PR                  VALUE 'P'.
  5065             88 AM-REF-LL-MEAN                VALUE 'M'.
  5066             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5067         16  AM-EARN-METHOD-A              PIC X.
  5068             88 AM-REF-AH-R78                 VALUE 'R'.
  5069             88 AM-REF-AH-PR                  VALUE 'P'.
  5070             88 AM-REF-AH-MEAN                VALUE 'M'.
  5071             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5072             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5073             88 AM-REF-AH-NET                 VALUE 'N'.
  5074
  5075     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5076     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5077     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5078
  5079     12  AM-RET-Y-N                        PIC X.
  5080     12  AM-RET-P-E                        PIC X.
  5081     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5082     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5083     12  AM-RET-GRP                        PIC X(6).
  5084     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5085         16  AM-POOL-PRIME                 PIC XXX.
  5086         16  AM-POOL-SUB                   PIC XXX.
  5087     12  AM-RETRO-EARNINGS.
  5088         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL640.cbl
  5089         16  AM-RET-EARN-L                 PIC X.
  5090         16  AM-RET-EARN-A                 PIC X.
  5091     12  AM-RET-ST-TAX-USE                 PIC X.
  5092         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5093         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5094     12  AM-RETRO-BEG-EARNINGS.
  5095         16  AM-RET-BEG-EARN-R             PIC X.
  5096         16  AM-RET-BEG-EARN-L             PIC X.
  5097         16  AM-RET-BEG-EARN-A             PIC X.
  5098     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5099     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5100
  5101     12  AM-USER-SELECT-OPTIONS.
  5102         16  AM-USER-SELECT-1              PIC X(10).
  5103         16  AM-USER-SELECT-2              PIC X(10).
  5104         16  AM-USER-SELECT-3              PIC X(10).
  5105         16  AM-USER-SELECT-4              PIC X(10).
  5106         16  AM-USER-SELECT-5              PIC X(10).
  5107
  5108     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5109
  5110     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5111
  5112     12  AM-RPT045A-SWITCH                 PIC X.
  5113         88  RPT045A-OFF                   VALUE 'N'.
  5114
  5115     12  AM-INSURANCE-LIMITS.
  5116         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5117         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5118
  5119     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5120         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5121
  5122     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5123         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5124         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5125
  5126     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5127
  5128     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5129     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5130     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5131     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5132     12  AM-DCC-UEF-STATE                  PIC XX.
  5133     12  FILLER                            PIC XXX.
  5134     12  AM-REPORT-CODE-3                  PIC X(10).
  5135*    12  FILLER                            PIC X(22).
  5136
  5137     12  AM-RESERVE-DATE.
  5138         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5139         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5140         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5141
  5142     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5143     12  AM-NOTIFICATION-TYPES.
  5144         16  AM-NOTIF-OF-LETTERS           PIC X.
  5145         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5146         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL640.cbl
  5147         16  AM-NOTIF-OF-STATUS            PIC X.
  5148
  5149     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5150         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5151         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5152         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5153         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5154
  5155     12  AM-BENEFIT-CONTROLS.
  5156         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5157             20  AM-BENEFIT-CODE           PIC XX.
  5158             20  AM-BENEFIT-TYPE           PIC X.
  5159             20  AM-BENEFIT-REVISION       PIC XXX.
  5160             20  AM-BENEFIT-REM-TERM       PIC X.
  5161             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5162             20  FILLER                    PIC XX.
  5163         16  FILLER                        PIC X(80).
  5164
  5165     12  AM-TRANSFER-DATA.
  5166         16  AM-TRANSFERRED-FROM.
  5167             20  AM-TRNFROM-CARRIER        PIC X.
  5168             20  AM-TRNFROM-GROUPING.
  5169                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5170                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5171             20  AM-TRNFROM-STATE          PIC XX.
  5172             20  AM-TRNFROM-ACCOUNT.
  5173                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5174                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5175             20  AM-TRNFROM-DTE            PIC XX.
  5176         16  AM-TRANSFERRED-TO.
  5177             20  AM-TRNTO-CARRIER          PIC X.
  5178             20  AM-TRNTO-GROUPING.
  5179                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5180                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5181             20  AM-TRNTO-STATE            PIC XX.
  5182             20  AM-TRNTO-ACCOUNT.
  5183                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5184                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5185             20  AM-TRNTO-DTE              PIC XX.
  5186         16  FILLER                        PIC X(10).
  5187
  5188     12  AM-SAVED-REMIT-TO                 PIC 99.
  5189
  5190     12  AM-COMM-STRUCTURE-SAVED.
  5191         16  AM-DEFN-1-SAVED.
  5192             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5193                 24  AM-AGT-SV             PIC X(10).
  5194                 24  AM-COM-TYP-SV         PIC X.
  5195                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5196                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5197                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5198                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5199                 24  FILLER                PIC X.
  5200                 24  AM-GL-CODES-SV        PIC X.
  5201                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5202                 24  FILLER                PIC X.
  5203         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5204             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL640.cbl
  5205                 24  FILLER                PIC X(11).
  5206                 24  AM-L-COMA-SV          PIC XXX.
  5207                 24  AM-J-COMA-SV          PIC XXX.
  5208                 24  AM-A-COMA-SV          PIC XXX.
  5209                 24  FILLER                PIC X(6).
  5210
  5211     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5212         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5213            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5214            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5215            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5216
  5217     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5218     12  FILLER                            PIC X(120).
  5219
  5220     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5221         16  AM-CONTROL-NAME               PIC X(30).
  5222         16  AM-EXECUTIVE-ONE.
  5223             20  AM-EXEC1-NAME             PIC X(15).
  5224             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5225                                                          COMP-3.
  5226             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5227                                                          COMP-3.
  5228         16  AM-EXECUTIVE-TWO.
  5229             20  AM-EXEC2-NAME             PIC X(15).
  5230             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5231                                                          COMP-3.
  5232             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5233                                                          COMP-3.
  5234
  5235     12  AM-RETRO-ADDITIONAL-DATA.
  5236         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5237         16  AM-RETRO-PREM-P-E             PIC X.
  5238         16  AM-RETRO-CLMS-P-I             PIC X.
  5239         16  AM-RETRO-RET-BRACKET-LF.
  5240             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5241                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5242                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5243             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5244                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5245                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5246             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5247                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5248                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5249         16  AM-RETRO-RET-BRACKET-AH.
  5250             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5251                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5252                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5253                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5254             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5255                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5256                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5257             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5258                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5259                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5260
  5261     12  AM-COMMENTS.
  5262         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL640.cbl
  5263
  5264     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5265         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5266         16  AM-FLI-BILLING-CODE           PIC X.
  5267         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5268         16  AM-FLI-UNITED-IDENT           PIC X.
  5269         16  AM-FLI-INTEREST-LOST-DATA.
  5270             20  AM-FLI-BANK-NO            PIC X(5).
  5271             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5272             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5273             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5274         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5275             20  AM-FLI-AGT                PIC X(9).
  5276             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5277             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5278         16  FILLER                        PIC X(102).
  5279
  5280     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5281         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5282             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5283             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5284             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5285             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5286             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5287         16  FILLER                          PIC X(10).
  5288******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL640.cbl
  5290*                            COPY ERCBILL.
  5291******************************************************************
  5292*                                                                *
  5293*                                                                *
  5294*                            ERCBILL                             *
  5295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5296*                            VMOD=2.007                          *
  5297*                                                                *
  5298*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5299*                                                                *
  5300*   FILE TYPE = VSAM,KSDS                                        *
  5301*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5302*                                                                *
  5303*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5304*                                                                *
  5305*   LOG = NO                                                     *
  5306*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5307******************************************************************
  5308 01  BILLING-STATEMENT.
  5309     02 BILLING-STATEMENT-FILE.
  5310     12  BI-RECORD-ID                PIC XX.
  5311         88  VALID-BI-ID                VALUE 'BI'.
  5312
  5313     12  BI-CONTROL-PRIMARY.
  5314         16  BI-COMPANY-CD           PIC X.
  5315         16  BI-CARRIER              PIC X.
  5316         16  BI-GROUPING             PIC X(6).
  5317         16  BI-ACCOUNT              PIC X(10).
  5318         16  BI-FIN-RESP             PIC X(10).
  5319         16  BI-RECORD-TYPE          PIC X.
  5320             88  BI-HEADER-DATA         VALUE '1'.
  5321             88  BI-ADDRESS-DATA        VALUE '2'.
  5322             88  BI-TEXT-DATA           VALUE '3'.
  5323         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5324
  5325     12  BI-TEXT-RECORD.
  5326         16  BI-SKIP-CONTROL         PIC X.
  5327         16  BI-TEXT-LINE            PIC X(157).
  5328         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5329             20  BI-ADDR-LIT         PIC X(14).
  5330             20  BI-CO               PIC X(7).
  5331             20  BI-DASH             PIC X.
  5332             20  BI-ACCT             PIC X(10).
  5333             20  FILLER              PIC XX.
  5334             20  BI-ACCT-ADDR        PIC X(30).
  5335             20  FILLER              PIC X.
  5336             20  BI-REMIT-LIT        PIC X(11).
  5337             20  FILLER              PIC XX.
  5338             20  BI-REMIT-ADDR       PIC X(30).
  5339             20  FILLER              PIC X(49).
  5340         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5341             20  BI-INS-LAST-NAME    PIC X(15).
  5342             20  FILLER              PIC X.
  5343             20  BI-INS-1ST-NAME     PIC X(10).
  5344             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5345                 24  BI-INS-INITS    PIC XX.
  5346                 24  FILLER          PIC X(8).
  5347             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL640.cbl
  5348             20  BI-UNDRWRTR.
  5349                 24  BI-INS-INIT     PIC X.
  5350                 24  FILLER          PIC XXX.
  5351             20  BI-CERT             PIC X(11).
  5352             20  FILLER              PIC XX.
  5353             20  BI-EFF-DT           PIC X(8).
  5354             20  FILLER              PIC XX.
  5355             20  BI-CAN-DT           PIC X(8).
  5356             20  FILLER              PIC XX.
  5357             20  BI-ED-TERM          PIC ZZZ.
  5358             20  FILLER              PIC XX.
  5359             20  BI-TYPE             PIC XXXX.
  5360             20  FILLER              PIC X.
  5361             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5362             20  FILLER              PIC X(3).
  5363             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5364             20  FILLER              PIC XX.
  5365             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5366             20  FILLER              PIC XX.
  5367             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5368             20  FILLER              PIC X(26).
  5369         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5370             20  FILLER              PIC X(42).
  5371             20  BI-TOT-DESC         PIC X(20).
  5372             20  FILLER REDEFINES BI-TOT-DESC.
  5373                 24  BI-TOT-LIT      PIC X(6).
  5374                 24  BI-OVERRIDE-L6  PIC X(14).
  5375             20  FILLER              PIC X(11).
  5376             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5377             20  BI-TOT-DASH REDEFINES
  5378                 BI-TOT-PREM         PIC X(15).
  5379             20  FILLER              PIC X(11).
  5380             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5381             20  FILLER              PIC XX.
  5382             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5383             20  FILLER              PIC X(26).
  5384         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5385             20  BI-ENTRY-DESC       PIC X(30).
  5386             20  FILLER              PIC X(11).
  5387             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5388             20  FILLER              PIC X(31).
  5389             20  BI-ACCTG-COMMENT    PIC X(30).
  5390             20  FILLER              PIC X(39).
  5391         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5392             20  FILLER              PIC X(42).
  5393             20  BI-TOT-DESC5        PIC X(20).
  5394             20  FILLER              PIC X(11).
  5395             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5396             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5397             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5398             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5399             20  FILLER              PIC X(24).
  5400         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5401             20  BI-TEXT-2-81        PIC X(80).
  5402             20  FILLER              PIC X(77).
  5403         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5404             20  FILLER              PIC X(53).
  5405             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL640.cbl
  5406             20  FILLER              PIC X(25).
  5407         16  BI-TEXT-TYPE            PIC X.
  5408             88 DETAIL-LINE              VALUE 'D'.
  5409         16  BI-TERM                 PIC S999.
  5410         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5411         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5412         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5413
  5414     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5415         16  FILLER                  PIC X.
  5416         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5417         16  FILLER                  PIC X(10).
  5418         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5419         16  FILLER                  PIC X(106).
  5420
  5421     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5422         16  BI-PROCESSOR-CD         PIC X(4).
  5423         16  BI-STATEMENT-TYPE       PIC X.
  5424             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5425         16  BI-NO-OF-COPIES         PIC S9.
  5426         16  BI-CREATION-DT          PIC XX.
  5427         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5428         16  BI-ACCOUNT-TOTALS.
  5429             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5430             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5431             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5432             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5433             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5434             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5435             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5436             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5437         16  BI-FIN-RESP-ACCT        PIC X(10).
  5438         16  BI-FIN-RESP-NAME        PIC X(30).
  5439         16  FILLER                  PIC X(79).
  5440
  5441
  5442     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5443     12  FILLER                      PIC XX.
  5444
  5445     12  GA-CONTROL-PRIMARY.
  5446         16  FILLER                  PIC X(31).
  5447
  5448     12  GA-TEXT-RECORD.
  5449         16  GA-SKIP-CONTROL         PIC X.
  5450         16  GA-TEXT-LINE            PIC X(132).
  5451         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5452             20  FILLER              PIC X.
  5453             20  GA-CARRIER          PIC X.
  5454             20  GA-GROUPING         PIC X(6).
  5455             20  GA-DASH             PIC X.
  5456             20  GA-AGENT            PIC X(10).
  5457             20  FILLER              PIC X.
  5458             20  GA-AGENT-ADDR       PIC X(30).
  5459             20  FILLER              PIC X(82).
  5460         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5461             20  GA-ACCT             PIC X(10).
  5462             20  FILLER              PIC X.
  5463             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL640.cbl
  5464             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5465             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5466             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5467             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5468             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5469             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5470             20  FILLER              PIC X.
  5471             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5472             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5473             20  FILLER              PIC X.
  5474         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5475             20  FILLER              PIC X(11).
  5476             20  GA-ENTRY-DESC       PIC X(30).
  5477             20  FILLER              PIC X(60).
  5478             20  GA-ENTRY-COMMENT    PIC X(30).
  5479             20  FILLER              PIC X.
  5480         16  FILLER.
  5481             20  GA-BENEFIT-CD       PIC XX.
  5482             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5483             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5484             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5485             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5486             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5487             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5488             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5489             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5490
  5491     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5492         16  FILLER                  PIC X.
  5493         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5494         16  FILLER                  PIC X(144).
  5495
  5496     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5497         16  GA-PROCESSOR-CD         PIC X(4).
  5498         16  GA-STATEMENT-TYPE       PIC X.
  5499             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5500         16  GA-NO-OF-COPIES         PIC S9.
  5501         16  GA-CREATION-DT          PIC XX.
  5502         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5503         16  GA-AGENT-TOTALS.
  5504             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5505             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5506             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5507             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5508             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5509             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5510             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5511             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5512             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5513         16  GA-AGENTS-NAME          PIC X(30).
  5514         16  FILLER                  PIC X(81).
  5515     12  FILLER                      PIC XX.
  5516
  5517
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL640.cbl
  5519*                            COPY ELCTEXT.
  5520******************************************************************
  5521*                                                                *
  5522*                                                                *
  5523*                            ELCTEXT.                            *
  5524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5525*                            VMOD=2.008                          *
  5526*                                                                *
  5527*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5528*                                     FORM LETTERS,              *
  5529*                                     CERT FORM DISPLAY.
  5530*                                                                *
  5531*   FILE TYPE = VSAM,KSDS                                        *
  5532*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5533*                                                                *
  5534*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5535*       ALTERNATE INDEX = NONE                                   *
  5536*                                                                *
  5537*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5538*       ALTERNATE INDEX = NONE                                   *
  5539*                                                                *
  5540*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5541*       ALTERNATE INDEX = NONE                                   *
  5542*                                                                *
  5543*   LOG = NO                                                     *
  5544*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5545******************************************************************
  5546 01  TEXT-FILES.
  5547     12  TEXT-FILE-ID                PIC XX.
  5548         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5549         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5550         88  HELP-FILE-TEXT             VALUE 'TH'.
  5551
  5552     12  TX-CONTROL-PRIMARY.
  5553         16  TX-COMPANY-CD           PIC X.
  5554             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5555         16  TX-ACCESS-CD-GENL       PIC X(12).
  5556
  5557         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5558             20  TX-LETTER-NO        PIC X(4).
  5559             20  FILLER              PIC X(8).
  5560
  5561         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5562             20  TX-FORM-NO          PIC X(12).
  5563
  5564         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5565             20  TX-HELP-TYPE        PIC X.
  5566                 88  HELP-FOR-GENERAL   VALUE ' '.
  5567                 88  HELP-BY-SCREEN     VALUE 'S'.
  5568                 88  HELP-BY-ERROR      VALUE 'E'.
  5569             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5570                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5571             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5572                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5573             20  FILLER              PIC X(4).
  5574
  5575         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5576
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL640.cbl
  5577     12  TX-PROCESS-CONTROL          PIC XX.
  5578         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5579
  5580     12  TX-TEXT-LINE                PIC X(70).
  5581
  5582     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5583         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5584         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5585         88  TX-VALID-FORM-SQUEEZE-VALUE
  5586                                        VALUE 'Y' ' '.
  5587
  5588     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5589         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5590         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5591         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5592         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5593         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5594         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5595         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5596                                              'K' 'N' ' '
  5597                                              'Z'.
  5598
  5599     12  TX-ARCHIVE-SW               PIC X.
  5600         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5601         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5602         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5603
  5604     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5605     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5606
  5607     12  TX-BSR-CODE                 PIC X.
  5608         88  TX-BSR-LETTER              VALUE 'B'.
  5609         88  TX-NON-BSR-LETTER          VALUE ' '.
  5610
  5611     12  FILLER                      PIC X.
  5612*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL640.cbl
  5614
  5615 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5616                          CONTROL-FILE COMPENSATION-MASTER
  5617                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5618                          BILLING-STATEMENT TEXT-FILES.
  5619 0000-DFHEXIT SECTION.
  5620     MOVE '9#                    $   ' TO DFHEIV0.
  5621     MOVE 'EL640' TO DFHEIV1.
  5622     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5623
  5624     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5625     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5626     MOVE EIBTRMID               TO QID-TERM.
  5627     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5628     MOVE '5'                    TO DC-OPTION-CODE.
  5629     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5630     MOVE DC-BIN-DATE-1          TO WS-CURRENT-DATE.
  5631     MOVE DC-GREG-DATE-1-MDY     TO WS-CURRENT-DATE-MDY.
  5632     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DATE-EDIT.
  5633
  5634     IF EIBCALEN = 0
  5635         GO TO 8800-UNAUTHORIZED-ACCESS.
  5636
  5637     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5638         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  5639
  5640     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5641         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5642             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5643             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5644             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5645             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5646             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5647             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5648             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5649             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5650             MOVE PI-CR-CONTROL-IN-PROGRESS TO W-TRANSFER-CONTROL
  5651             MOVE SPACES          TO PI-CR-CONTROL-IN-PROGRESS
  5652         ELSE
  5653             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5654             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5655             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5656             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5657             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5658             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5659             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5660             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5661
  5662     MOVE LOW-VALUES             TO EL640AI.
  5663
  5664     IF PI-AR-PROCESSING
  5665        MOVE XCTL-635            TO XCTL-PYAJ.
  5666
  5667     IF PI-COMPANY-ID = 'DMD'
  5668        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5669
  5670     IF RETURNED-FROM NOT = SPACES
  5671         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL640.cbl
  5672         IF RETURNED-FROM = XCTL-PYAJ AND NOT PI-VOID-BILL
  5673             MOVE ZEROS          TO PI-ADJUSTMENTS
  5674                                    PI-DISBURSED
  5675                                    PI-REMITTED
  5676             GO TO 1100-PYAJ-BILLING-PROCESS
  5677         ELSE
  5678             MOVE -1             TO APFNTERL
  5679             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5680             GO TO 8100-SEND-INITIAL-MAP.
  5681
  5682     IF EIBTRNID NOT = TRANS-ID
  5683         PERFORM 0400-CLEAR-PI  THRU  0499-EXIT
  5684         MOVE EL640A             TO PI-MAP-NAME
  5685         MOVE -1                 TO APFNTERL
  5686         GO TO 8100-SEND-INITIAL-MAP.
  5687
  5688
  5689* EXEC CICS HANDLE CONDITION
  5690*        PGMIDERR  (9600-PGMID-ERROR)
  5691*        ERROR     (9990-ABEND)
  5692*    END-EXEC.
  5693*    MOVE '"$L.                  ! " #00005684' TO DFHEIV0
  5694     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5696     MOVE X'2220233030303035363834' TO DFHEIV0(25:11)
  5697     CALL 'kxdfhei1' USING DFHEIV0
  5698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5699
  5700
  5701     IF EIBAID = DFHCLEAR
  5702         IF PI-MAP-NAME = EL640B
  5703             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5704             MOVE EL640A         TO PI-MAP-NAME
  5705             MOVE -1             TO APFNTERL
  5706             GO TO 8100-SEND-INITIAL-MAP
  5707         ELSE
  5708             GO TO 9400-CLEAR.
  5709
  5710     IF PI-PROCESSOR-ID = 'LGXX'
  5711         GO TO 0200-RECEIVE.
  5712
  5713
  5714* EXEC CICS READQ TS
  5715*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5716*        INTO   (SECURITY-CONTROL)
  5717*        LENGTH (SC-COMM-LENGTH)
  5718*        ITEM   (SC-ITEM)
  5719*    END-EXEC.
  5720*    MOVE '*$II   L              ''   #00005701' TO DFHEIV0
  5721     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5722     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5723     MOVE X'2020233030303035373031' TO DFHEIV0(25:11)
  5724     CALL 'kxdfhei1' USING DFHEIV0,
  5725           PI-SECURITY-TEMP-STORE-ID,
  5726           SECURITY-CONTROL,
  5727           SC-COMM-LENGTH,
  5728           SC-ITEM,
  5729           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL640.cbl
  5730           DFHEIV99
  5731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5732
  5733
  5734     MOVE SC-CREDIT-DISPLAY (18)  TO PI-DISPLAY-CAP.
  5735     MOVE SC-CREDIT-UPDATE  (18)  TO PI-MODIFY-CAP.
  5736
  5737     IF NOT DISPLAY-CAP
  5738         MOVE 'READ'          TO SM-READ
  5739         PERFORM 9995-SECURITY-VIOLATION
  5740         MOVE ER-0070         TO  EMI-ERROR
  5741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5742         GO TO 8100-SEND-INITIAL-MAP.
  5743
  5744 0200-RECEIVE.
  5745     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5746         MOVE ER-0008            TO EMI-ERROR
  5747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5748         IF PI-MAP-NAME = EL640A
  5749             MOVE -1             TO APFNTERL
  5750             GO TO 8200-SEND-DATAONLY
  5751         ELSE
  5752             MOVE -1             TO BPFNTERL
  5753             GO TO 8200-SEND-DATAONLY.
  5754
  5755
  5756* EXEC CICS RECEIVE
  5757*        MAP      (PI-MAP-NAME)
  5758*        MAPSET   (MAPSET-NAME)
  5759*        INTO     (EL640AI)
  5760*    END-EXEC.
  5761     MOVE LENGTH OF
  5762      EL640AI
  5763       TO DFHEIV11
  5764*    MOVE '8"T I  L              ''   #00005729' TO DFHEIV0
  5765     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5767     MOVE X'2020233030303035373239' TO DFHEIV0(25:11)
  5768     CALL 'kxdfhei1' USING DFHEIV0,
  5769           PI-MAP-NAME,
  5770           EL640AI,
  5771           DFHEIV11,
  5772           MAPSET-NAME,
  5773           DFHEIV99,
  5774           DFHEIV99
  5775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5776
  5777
  5778     IF PI-END-BAL NOT NUMERIC
  5779         MOVE ZEROS              TO PI-END-BAL.
  5780
  5781     IF PI-MAP-NAME = EL640A
  5782         IF APFNTERL > ZERO
  5783             IF EIBAID NOT = DFHENTER
  5784                 MOVE ER-0004    TO EMI-ERROR
  5785                 MOVE AL-UNBOF   TO APFNTERA
  5786                 MOVE -1         TO APFNTERL
  5787                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL640.cbl
  5788                 GO TO 8200-SEND-DATAONLY
  5789             ELSE
  5790                 IF APFNTERI NUMERIC AND
  5791                   (APFNTERI > 0 AND < 25)
  5792                     MOVE PF-VALUES (APFNTERI) TO EIBAID
  5793                 ELSE
  5794                     MOVE ER-0029  TO EMI-ERROR
  5795                     MOVE AL-UNBOF TO APFNTERA
  5796                     MOVE -1       TO APFNTERL
  5797                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5798                     GO TO 8200-SEND-DATAONLY
  5799         ELSE
  5800             NEXT SENTENCE
  5801     ELSE
  5802     IF PI-MAP-NAME = EL640B
  5803         IF BPFNTERL > ZERO
  5804             IF EIBAID NOT = DFHENTER
  5805                 MOVE ER-0004    TO EMI-ERROR
  5806                 MOVE AL-UNBOF   TO BPFNTERA
  5807                 MOVE -1         TO BPFNTERL
  5808                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5809                 GO TO 8200-SEND-DATAONLY
  5810             ELSE
  5811                 IF BPFNTERI NUMERIC AND
  5812                   (BPFNTERI > 0 AND < 25)
  5813                     MOVE PF-VALUES (BPFNTERI) TO EIBAID
  5814                 ELSE
  5815                     MOVE ER-0029  TO EMI-ERROR
  5816                     MOVE AL-UNBOF TO BPFNTERA
  5817                     MOVE -1       TO BPFNTERL
  5818                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5819                     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL640.cbl
  5821 0300-CHECK-PFKEYS.
  5822     IF EIBAID = DFHPF23
  5823         GO TO 8810-PF23.
  5824
  5825     IF EIBAID = DFHPF24
  5826         GO TO 9200-RETURN-MAIN-MENU.
  5827
  5828     IF EIBAID = DFHPF12
  5829         GO TO 9500-PF12.
  5830
  5831******************************************************************
  5832*       IF CARRIER OR ACCOUNT SECURITY ALLOW ONLY                *
  5833*            BILLING TYPE OPTION ONE OR TWO.                     *
  5834*                        04/27/84                                *
  5835******************************************************************
  5836
  5837     IF PI-NO-CARRIER-SECURITY OR
  5838        PI-NO-ACCOUNT-SECURITY
  5839          GO TO 0305-CHECK-PFKEYS.
  5840
  5841     IF EIBAID = DFHENTER OR DFHPF6
  5842        NEXT SENTENCE
  5843       ELSE
  5844        GO TO 0320-INPUT-ERROR.
  5845
  5846 0305-CHECK-PFKEYS.
  5847     IF EIBAID = DFHPF3
  5848       AND PI-MAP-NAME = EL640A
  5849         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5850         MOVE PI-CARRIER         TO PI-CR-CARRIER
  5851         MOVE PI-GROUPING        TO PI-CR-GROUPING
  5852         MOVE PI-STATE           TO PI-CR-STATE
  5853         MOVE PI-ACCOUNT         TO PI-CR-ACCOUNT
  5854         MOVE XCTL-650           TO PGM-NAME
  5855         GO TO 9300-XCTL.
  5856
  5857     IF EIBAID = DFHPF4
  5858       AND PI-MAP-NAME = EL640A
  5859        NEXT SENTENCE
  5860     ELSE
  5861        GO TO 0320-CONT-PFKEYS.
  5862
  5863     IF PI-CR-FIN-RESP NOT = SPACES
  5864         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5865         MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5866         MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5867         MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5868         MOVE XCTL-652           TO PGM-NAME
  5869         GO TO 9300-XCTL.
  5870
  5871     IF PI-SCR-FIN-RESP = SPACES OR LOW-VALUES
  5872         GO TO 0315-PF4-ERROR.
  5873
  5874     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5875
  5876     MOVE PI-SCR-CARRIER    TO PI-CR-CARRIER.
  5877     MOVE PI-SCR-GROUPING   TO PI-CR-GROUPING.
  5878     MOVE PI-SCR-FIN-RESP   TO PI-CR-FIN-RESP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL640.cbl
  5879     MOVE PI-SCR-ACCOUNT    TO PI-CR-ACCOUNT.
  5880     MOVE PI-SCR-TYPE       TO PI-CR-TYPE.
  5881     MOVE 'Y'               TO PI-TRANSFER-SW.
  5882
  5883     IF PI-ZERO-CARRIER  OR
  5884        PI-ZERO-CAR-GROUP
  5885         MOVE ZEROS              TO PI-CR-CARRIER.
  5886
  5887     IF PI-ZERO-GROUPING  OR
  5888        PI-ZERO-CAR-GROUP
  5889         MOVE ZEROS              TO PI-CR-GROUPING.
  5890
  5891     MOVE XCTL-652               TO PGM-NAME.
  5892
  5893     GO TO 9300-XCTL.
  5894
  5895 0315-PF4-ERROR.
  5896
  5897     MOVE ER-2407                TO EMI-ERROR.
  5898     MOVE -1                     TO APFNTERL.
  5899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5900     GO TO 8200-SEND-DATAONLY.
  5901
  5902 0320-CONT-PFKEYS.
  5903     IF EIBAID = DFHPF6
  5904       AND PI-MAP-NAME = EL640A
  5905         MOVE LOW-VALUES         TO EL640AO
  5906         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5907         MOVE XCTL-6401          TO PGM-NAME
  5908         GO TO 9300-XCTL.
  5909
  5910     IF EIBAID = DFHPF7
  5911       AND PI-MAP-NAME = EL640A
  5912         IF PI-CR-FIN-RESP NOT = SPACES
  5913             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5914             MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5915             MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5916             MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5917             MOVE XCTL-PYAJ          TO PGM-NAME
  5918             GO TO 9300-XCTL
  5919         ELSE
  5920             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5921                                       XCTL-633DMD
  5922                 GO TO 9400-CLEAR
  5923             ELSE
  5924                 MOVE ER-2411        TO EMI-ERROR
  5925                 MOVE -1             TO APFNTERL
  5926                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5927                 GO TO 8200-SEND-DATAONLY.
  5928
  5929     IF EIBAID = DFHPF8
  5930       AND PI-MAP-NAME = EL640A
  5931           PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5932           MOVE SPACES         TO PI-CR-CONTROL-IN-PROGRESS
  5933           MOVE XCTL-658       TO PGM-NAME
  5934           GO TO 9300-XCTL.
  5935
  5936     IF EIBAID = DFHPF1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL640.cbl
  5937       AND PI-MAP-NAME = EL640B
  5938         GO TO 7500-PRODUCE-CHECK.
  5939
  5940     IF EIBAID = DFHPF5
  5941       AND PI-AR-PROCESSING
  5942         MOVE ER-3188            TO EMI-ERROR
  5943         MOVE -1                 TO APFNTERL
  5944         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5945         GO TO 8200-SEND-DATAONLY.
  5946
  5947     IF PI-COMPANY-ID = 'DMD'
  5948       IF EIBAID = DFHPF5
  5949         GO TO 0320-INPUT-ERROR.
  5950
  5951     IF EIBAID = DFHPF5
  5952       AND PI-MAP-NAME = EL640A
  5953            MOVE EL640B     TO PI-MAP-NAME
  5954            GO TO 7000-PROCESS-CHECK.
  5955
  5956     IF PI-MAP-NAME = EL640A
  5957         IF EIBAID = DFHENTER OR DFHPF3
  5958             GO TO 0330-EDIT-DATA
  5959         ELSE
  5960             GO TO 0320-INPUT-ERROR
  5961     ELSE
  5962         IF PI-MAP-NAME = EL640B
  5963             IF EIBAID = DFHENTER
  5964
  5965* EXEC CICS BIF DEEDIT
  5966*                    FIELD  (BCHKAMTI)
  5967*                    LENGTH (11)
  5968*                END-EXEC
  5969     MOVE 11
  5970       TO DFHEIV11
  5971*    MOVE '@"L                   #   #00005921' TO DFHEIV0
  5972     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5973     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5974     MOVE X'2020233030303035393231' TO DFHEIV0(25:11)
  5975     CALL 'kxdfhei1' USING DFHEIV0,
  5976           BCHKAMTI,
  5977           DFHEIV11
  5978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5979                 MOVE BCHKAMTI   TO  WORK-CHECK-AMT
  5980                 MOVE 'B'        TO  WS-ENTERED-FROM-MAP
  5981                 GO TO 7000-PROCESS-CHECK.
  5982
  5983 0320-INPUT-ERROR.
  5984     MOVE ER-0029                TO EMI-ERROR.
  5985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5986
  5987     IF PI-MAP-NAME = EL640A
  5988         MOVE AL-UNBON           TO APFNTERA
  5989         MOVE -1                 TO APFNTERL
  5990     ELSE
  5991         MOVE AL-UNBON           TO BPFNTERA
  5992         MOVE -1                 TO BPFNTERL.
  5993
  5994     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL640.cbl
  5995
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL640.cbl
  5997 0330-EDIT-DATA.
  5998     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  5999
  6000     IF VALID-BILL-TYPE
  6001        IF NOT MODIFY-CAP
  6002           IF ABILTYPI = '1' OR '2'
  6003              NEXT SENTENCE
  6004           ELSE
  6005              MOVE 'UPDATE'         TO SM-READ
  6006              PERFORM 9995-SECURITY-VIOLATION
  6007              MOVE ER-0070          TO EMI-ERROR
  6008              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6009              GO TO 8100-SEND-INITIAL-MAP.
  6010
  6011     MOVE SPACES                 TO PI-BILLING-COUNTS
  6012                                    PI-LIMIT-BILLING-BTCHS.
  6013
  6014******************************************************************
  6015*         SECURITY CHECK FOR CARRIER AND ACCOUNT.                *
  6016*                     04/12/84                                   *
  6017******************************************************************
  6018
  6019     IF PI-CARRIER-SECURITY > SPACES
  6020        IF ACARIERL > ZEROS
  6021            IF PI-CARRIER-SECURITY = ACARIERI
  6022                MOVE AL-UANON    TO ACARIERA
  6023            ELSE
  6024                MOVE -1          TO ACARIERL
  6025                MOVE AL-UABON    TO ACARIERA
  6026                MOVE ER-2370     TO EMI-ERROR
  6027                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6028
  6029 350-ERROR-CHECK.
  6030     IF EMI-ERROR = ZEROS
  6031         NEXT SENTENCE
  6032     ELSE
  6033         GO TO 8200-SEND-DATAONLY.
  6034
  6035     IF AACCTL > ZEROS
  6036         MOVE AL-UANON           TO AACCTA
  6037         MOVE AACCTI             TO PI-SAV-ACCT
  6038                                    PI-CR-ACCOUNT
  6039     ELSE
  6040         MOVE -1                 TO AACCTL
  6041         MOVE AL-UABON           TO AACCTA
  6042         MOVE ER-0197            TO EMI-ERROR
  6043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6044
  6045     IF ACARIERL > ZEROS
  6046         MOVE AL-UANON           TO ACARIERA
  6047         MOVE ACARIERI           TO PI-SAV-CARR
  6048                                    WS-CARRIER
  6049     ELSE
  6050         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6051             MOVE -1             TO ACARIERL
  6052             MOVE AL-UABON       TO ACARIERA
  6053             MOVE ER-0194        TO EMI-ERROR
  6054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL640.cbl
  6055
  6056     IF AGROUPL > ZEROS
  6057         MOVE AL-UANON           TO AGROUPA
  6058         MOVE AGROUPI            TO PI-SAV-GROUP
  6059                                    WS-COMP
  6060     ELSE
  6061         IF CARR-GROUP-ST-ACCNT-CNTL
  6062             MOVE -1             TO AGROUPL
  6063             MOVE AL-UABON       TO AGROUPA
  6064             MOVE ER-0195        TO EMI-ERROR
  6065             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6066
  6067     IF ASTATEL > ZEROS
  6068         MOVE AL-UANON           TO ASTATEA
  6069         MOVE ASTATEI            TO PI-SAV-STATE
  6070     ELSE
  6071         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6072             MOVE -1             TO ASTATEL
  6073             MOVE AL-UABON       TO ASTATEA
  6074             MOVE ER-0196        TO EMI-ERROR
  6075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6076
  6077     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6078
  6079     IF VALID-BILL-TYPE
  6080         MOVE AL-UANON           TO ABILTYPA
  6081         MOVE ABILTYPI           TO PI-BILL-TYPE
  6082     ELSE
  6083         MOVE -1                 TO ABILTYPL
  6084         MOVE ER-2249            TO EMI-ERROR
  6085         MOVE AL-UABON           TO ABILTYPA
  6086         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6087
  6088     IF PI-AR-PROCESSING
  6089        IF PI-PREVIEW
  6090           NEXT SENTENCE
  6091        ELSE
  6092           MOVE -1               TO ABILTYPL
  6093           MOVE ER-3145          TO EMI-ERROR
  6094           MOVE AL-UABON         TO ABILTYPA
  6095           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6096
  6097     IF APRODSWL NOT = ZEROS
  6098         IF PI-PREVIEW
  6099             IF APRODSWI = 'Y' OR 'N'
  6100                 MOVE AL-UANON   TO APRODSWA
  6101             ELSE
  6102                 MOVE -1         TO APRODSWL
  6103                 MOVE ER-2436    TO EMI-ERROR
  6104                 MOVE AL-UABON   TO APRODSWA
  6105                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6106         ELSE
  6107             MOVE -1             TO APRODSWL
  6108             MOVE ER-2434        TO EMI-ERROR
  6109             MOVE AL-UABON       TO APRODSWA
  6110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6111     ELSE
  6112         IF PI-PREVIEW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL640.cbl
  6113             MOVE -1             TO APRODSWL
  6114             MOVE ER-2435        TO EMI-ERROR
  6115             MOVE AL-UABON       TO APRODSWA
  6116             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6117
  6118     IF ABILERRI = 'Y' OR 'N'
  6119         MOVE ABILERRI           TO PI-BILL-ERRS
  6120         MOVE AL-UANON           TO ABILERRA
  6121     ELSE
  6122         IF NOT PI-VOID-BILL
  6123             MOVE -1             TO ABILERRL
  6124             MOVE ER-2250        TO EMI-ERROR
  6125             MOVE AL-UABON       TO ABILERRA
  6126             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6127
  6128     IF ABTCH1L NOT = ZEROS
  6129         MOVE AL-UANON           TO ABTCH1A
  6130         MOVE 'Y'                TO LIMIT-BILLING-SW
  6131         MOVE ABTCH1I            TO PI-BILLING-BATCHES (1).
  6132
  6133     IF ABTCH2L NOT = ZEROS
  6134         MOVE AL-UANON           TO ABTCH2A
  6135         MOVE 'Y'                TO LIMIT-BILLING-SW
  6136         MOVE ABTCH2I            TO PI-BILLING-BATCHES (2).
  6137
  6138     IF ABTCH3L NOT = ZEROS
  6139         MOVE AL-UANON           TO ABTCH3A
  6140         MOVE 'Y'                TO LIMIT-BILLING-SW
  6141         MOVE ABTCH3I            TO PI-BILLING-BATCHES (3).
  6142
  6143     IF EMI-ERROR = ZEROS
  6144         GO TO 1000-BILLING-PROCESS.
  6145
  6146     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL640.cbl
  6148 0400-CLEAR-PI.
  6149     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  6150
  6151     MOVE ZEROS                  TO PI-BAL-FRWD-GA  PI-BAL-FRWD
  6152                                    PI-PREMIUM      PI-REMITTED
  6153                                    PI-TOT-ISS-COMP
  6154                                    PI-TOT-CAN-COMP
  6155                                    PI-ADJUSTMENTS  PI-DISBURSED
  6156                                    PI-END-BAL      PI-LF-ISS-COMP
  6157                                    PI-AH-ISS-COMP  PI-LF-CAN-COMP
  6158                                    PI-AH-CAN-COMP.
  6159
  6160     MOVE SPACES                 TO PI-BATCH (1)
  6161                                    PI-BATCH (2)
  6162                                    PI-BATCH (3)
  6163                                    PI-BATCH (4)
  6164                                    PI-BATCH (5)
  6165                                    PI-BATCH (6).
  6166
  6167     MOVE SPACES                 TO PI-BILLING-BATCHES (1)
  6168                                    PI-BILLING-BATCHES (2)
  6169                                    PI-BILLING-BATCHES (3).
  6170
  6171     MOVE ZEROS                  TO PI-BILLED (1) PI-PREV (1)
  6172                                    PI-NOBILL (1)
  6173                                    PI-PREM (1)   PI-COMM (1)
  6174                                    PI-NON-PREM (1)
  6175                                    PI-NON-COMM (1)
  6176                                    PI-BILLED (2) PI-PREV (2)
  6177                                    PI-NOBILL (2)
  6178                                    PI-PREM (2)   PI-COMM (2)
  6179                                    PI-NON-PREM (2)
  6180                                    PI-NON-COMM (2)
  6181                                    PI-BILLED (3) PI-PREV (3)
  6182                                    PI-NOBILL (3)
  6183                                    PI-PREM (3)   PI-COMM (3)
  6184                                    PI-NON-PREM (3)
  6185                                    PI-NON-COMM (3)
  6186                                    PI-BILLED (4) PI-PREV (4)
  6187                                    PI-NOBILL (4)
  6188                                    PI-PREM (4)   PI-COMM (4)
  6189                                    PI-NON-PREM (4)
  6190                                    PI-NON-COMM (4)
  6191                                    PI-BILLED (5) PI-PREV (5)
  6192                                    PI-NOBILL (5)
  6193                                    PI-PREM (5)   PI-COMM (5)
  6194                                    PI-NON-PREM (5)
  6195                                    PI-NON-COMM (5)
  6196                                    PI-BILLED (6) PI-PREV (6)
  6197                                    PI-NOBILL (6)
  6198                                    PI-PREM (6)   PI-COMM (6)
  6199                                    PI-NON-PREM (6)
  6200                                    PI-NON-COMM (6).
  6201
  6202 0499-EXIT.
  6203      EXIT.
  6204
  6205 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL640.cbl
  6206
  6207     IF PI-BAL-FRWD NOT NUMERIC
  6208         MOVE ZEROS              TO PI-BAL-FRWD
  6209                                    PI-PREMIUM
  6210                                    PI-REMITTED
  6211                                    PI-TOT-ISS-COMP
  6212                                    PI-TOT-CAN-COMP
  6213                                    PI-ADJUSTMENTS
  6214                                    PI-DISBURSED
  6215                                    PI-END-BAL.
  6216
  6217
  6218* EXEC CICS WRITEQ TS
  6219*        QUEUE  (QID)
  6220*        FROM   (PROGRAM-INTERFACE-BLOCK)
  6221*        LENGTH (PI-COMM-LENGTH)
  6222*    END-EXEC.
  6223*    MOVE '*"                    ''   #00006163' TO DFHEIV0
  6224     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  6225     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6226     MOVE X'2020233030303036313633' TO DFHEIV0(25:11)
  6227     CALL 'kxdfhei1' USING DFHEIV0,
  6228           QID,
  6229           PROGRAM-INTERFACE-BLOCK,
  6230           PI-COMM-LENGTH,
  6231           DFHEIV99,
  6232           DFHEIV99,
  6233           DFHEIV99
  6234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6235
  6236
  6237 0590-EXIT.
  6238      EXIT.
  6239
  6240 0600-RECOVER-TEMP-STORAGE.
  6241
  6242* EXEC CICS READQ TS
  6243*        QUEUE  (QID)
  6244*        INTO   (PROGRAM-INTERFACE-BLOCK)
  6245*        LENGTH (PI-COMM-LENGTH)
  6246*    END-EXEC.
  6247*    MOVE '*$I    L              ''   #00006173' TO DFHEIV0
  6248     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6249     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6250     MOVE X'2020233030303036313733' TO DFHEIV0(25:11)
  6251     CALL 'kxdfhei1' USING DFHEIV0,
  6252           QID,
  6253           PROGRAM-INTERFACE-BLOCK,
  6254           PI-COMM-LENGTH,
  6255           DFHEIV99,
  6256           DFHEIV99,
  6257           DFHEIV99
  6258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6259
  6260
  6261     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  6262
  6263     MOVE PI-CR-CARRIER    TO PI-SCR-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL640.cbl
  6264     MOVE PI-CR-GROUPING   TO PI-SCR-GROUPING.
  6265     MOVE PI-CR-FIN-RESP   TO PI-SCR-FIN-RESP.
  6266     MOVE PI-CR-ACCOUNT    TO PI-SCR-ACCOUNT.
  6267     MOVE PI-CR-TYPE       TO PI-SCR-TYPE.
  6268
  6269     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6270
  6271 0690-EXIT.
  6272      EXIT.
  6273
  6274 0800-DELETE-TS.
  6275
  6276* EXEC CICS HANDLE CONDITION
  6277*        QIDERR (0890-EXIT)
  6278*    END-EXEC.
  6279*    MOVE '"$N                   ! # #00006193' TO DFHEIV0
  6280     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6282     MOVE X'2320233030303036313933' TO DFHEIV0(25:11)
  6283     CALL 'kxdfhei1' USING DFHEIV0
  6284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6285
  6286
  6287
  6288* EXEC CICS DELETEQ TS
  6289*        QUEUE  (QID)
  6290*    END-EXEC.
  6291*    MOVE '*&                    #   #00006197' TO DFHEIV0
  6292     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6293     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6294     MOVE X'2020233030303036313937' TO DFHEIV0(25:11)
  6295     CALL 'kxdfhei1' USING DFHEIV0,
  6296           QID,
  6297           DFHEIV99
  6298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6299
  6300
  6301 0890-EXIT.
  6302      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL640.cbl
  6304 1000-BILLING-PROCESS.
  6305*                *******************************************
  6306*                *  THIS SECTION PROCESSES THE PENDING     *
  6307*                *  BUSINESS AND PAYMNTS/ADJMNTS FILES.    *
  6308*                *  THE PREMIUM AMT WRITTEN IS EXTRACTED   *
  6309*                *  FROM THE PENDING BUSINESS FILE.        *
  6310*                *******************************************
  6311
  6312     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD
  6313                                    ERPNDB-CO-CD-A1
  6314                                    ERCOMP-COMP-CD
  6315                                    ERPYAJ-COMP-CD
  6316                                    ERACCT-P-CO-CD
  6317                                    ERACCT-A-CO-CD.
  6318
  6319     MOVE WS-CURRENT-DATE-EDIT   TO BI-HD-RUN-DT.
  6320
  6321     MOVE ZEROS                  TO PI-BAL-FRWD
  6322                                    PI-PREMIUM
  6323                                    PI-REMITTED
  6324                                    PI-TOT-ISS-COMP
  6325                                    PI-TOT-CAN-COMP
  6326                                    PI-ADJUSTMENTS
  6327                                    PI-DISBURSED
  6328                                    PI-END-BAL.
  6329
  6330     IF PI-VOID-BILL
  6331         GO TO 2000-VOID-BILLING.
  6332
  6333     MOVE SPACES                 TO ELCNTL-KEY.
  6334     MOVE '1'                    TO ELCNTL-REC-TYPE.
  6335     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  6336
  6337     IF EMI-ERROR NOT = ZEROS
  6338         GO TO 8200-SEND-DATAONLY.
  6339
  6340     IF CF-ACCOUNT-MSTR-MAINT-DT      = LOW-VALUES  OR
  6341        CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES
  6342         MOVE ER-2571            TO EMI-ERROR
  6343         MOVE -1                 TO APFNTERL
  6344         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6345         GO TO 8200-SEND-DATAONLY.
  6346
  6347     IF CF-FORMS-PRINTER-ID = SPACES
  6348        IF ABILTYPI = '3' OR '4'
  6349          MOVE 2590               TO EMI-ERROR
  6350          MOVE -1                 TO ABILTYPL
  6351          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6352          GO TO 8200-SEND-DATAONLY.
  6353
  6354     MOVE CF-CL-MAIL-TO-NAME     TO BI-HD-CO.
  6355     MOVE CF-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  6356     MOVE SPACE                  TO DC-OPTION-CODE.
  6357     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6358     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  6359     MOVE DC-GREG-DATE-1-ALPHA   TO BI-HD-BILL-DT.
  6360     MOVE SPACE                  TO PI-DATA-BILLED-SW.
  6361
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL640.cbl
  6362     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  6363
  6364     IF PNDB-EOF
  6365         GO TO 1100-PYAJ-BILLING-PROCESS.
  6366
  6367 1010-PNDB-BILLING-PROCESS-LOOP.
  6368     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  6369
  6370     IF PNDB-EOF
  6371         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6372         GO TO 1100-PYAJ-BILLING-PROCESS.
  6373
  6374     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  6375        PB-CARRIER       = PI-SAV-CARR    AND
  6376        PB-GROUPING      = PI-SAV-GROUP   AND
  6377        PB-STATE         = PI-SAV-STATE   AND
  6378        PB-ACCOUNT       = PI-SAV-ACCT
  6379         NEXT SENTENCE
  6380     ELSE
  6381         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6382         GO TO 1100-PYAJ-BILLING-PROCESS.
  6383
  6384     IF (PB-ISSUE) AND
  6385        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6386         PB-I-POLICY-IS-MONTHLY OR
  6387         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6388         PB-I-UNDERWRITE-POLICY)
  6389          GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6390     ELSE
  6391        IF (PB-CANCELLATION)
  6392           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6393             OR  PB-CI-AH-POLICY-IS-REISSUE
  6394             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6395             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6396             OR  PB-CI-LF-POLICY-IS-DECLINED
  6397             OR  PB-CI-AH-POLICY-IS-VOID
  6398             OR  PB-CI-LF-REIN-ONLY
  6399             OR  PB-CI-AH-REIN-ONLY)
  6400             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6401
  6402     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6403         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6404
  6405     IF PB-RECORD-ON-HOLD OR
  6406        PB-RECORD-RETURNED
  6407         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6408         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6409
  6410     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6411         IF PB-ENTRY-REVERSED
  6412             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6413         ELSE
  6414             IF PI-REBILLING
  6415                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6416                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6417
  6418     IF PB-BILLED-DT = LOW-VALUES
  6419       OR PI-TOT-REBILL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL640.cbl
  6420       OR PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6421         NEXT SENTENCE
  6422     ELSE
  6423         IF NOT PB-BATCH-TRAILER
  6424             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6425             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6426         ELSE
  6427             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6428
  6429     IF LIMIT-BILLING
  6430         IF PB-ENTRY-BATCH = ABTCH1I OR
  6431                             ABTCH2I OR
  6432                             ABTCH3I
  6433             NEXT SENTENCE
  6434         ELSE
  6435             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6436
  6437     IF PB-FATAL-ERRORS  OR
  6438        PB-UNFORCED-ERRORS
  6439         IF ABILERRI = 'N'
  6440             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6441             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6442             MOVE ER-2570        TO EMI-ERROR
  6443             MOVE -1             TO ABILERRL
  6444             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6445             SET EMI-INDX TO 1
  6446             IF EMI-ERROR-NUMBER (EMI-INDX) = ER-2570
  6447                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6448                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6449                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6450                 GO TO 8200-SEND-DATAONLY
  6451             ELSE
  6452                 SET EMI-INDX    TO 2
  6453                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6454                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6455                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6456                 GO TO 8200-SEND-DATAONLY
  6457         ELSE
  6458             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6459             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6460
  6461     IF PB-BATCH-TRAILER
  6462         IF PI-UPDATE-FILES
  6463             PERFORM 1050-BILL-BATCH-TRAILER-CHK THRU 1059-EXIT
  6464             IF BILL-BATCH-TRAILER
  6465                 MOVE SPACE           TO BILL-BATCH-TRAILER-SW
  6466                 MOVE WS-CURRENT-DATE TO PB-BILLED-DT
  6467                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6468                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6469             ELSE
  6470                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6471         ELSE
  6472             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6473
  6474     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6475
  6476     PERFORM 1300-CHECK-OVERRIDE-PREM THRU 1399-EXIT.
  6477
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL640.cbl
  6478     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  6479         MOVE SPACE              TO WS-PROCESS-SW
  6480         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  6481         PERFORM 4300-READ-ACCOUNT-MASTER  THRU 4390-EXIT
  6482         PERFORM 1020-CHK-IF-AGENT-IS-SAME THRU 1029-EXIT
  6483         IF EMI-ERROR NOT = ZEROS
  6484             IF PI-UPDATE-FILES
  6485               OR (PI-PREVIEW AND APRODSWI = 'Y')
  6486                 PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6487                 IF EMI-ERROR NOT = '2403'
  6488                     PERFORM 3940-BILL-GENERIC-DELETE
  6489                             THRU 3940-EXIT
  6490                     GO TO 8200-SEND-DATAONLY
  6491                 ELSE
  6492                     GO TO 8200-SEND-DATAONLY
  6493             ELSE
  6494                 GO TO 8200-SEND-DATAONLY.
  6495
  6496     PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT.
  6497
  6498     IF DO-NOT-BILL-THIS-ACCT
  6499         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6500
  6501     PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  6502
  6503     IF EMI-ERROR NOT = ZEROS
  6504         IF PI-UPDATE-FILES
  6505           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6506             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6507             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6508             GO TO 8200-SEND-DATAONLY
  6509         ELSE
  6510             GO TO 8200-SEND-DATAONLY.
  6511
  6512     IF PI-UPDATE-FILES
  6513       OR (PI-PREVIEW AND APRODSWI = 'Y')
  6514         MOVE 'BD'               TO BILLING-DETAIL-TYPE
  6515         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6516
  6517     IF PI-BILL OR PI-REBILLING
  6518         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6519
  6520     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL640.cbl
  6522 1020-CHK-IF-AGENT-IS-SAME.
  6523     MOVE +1 TO ACCOM-SUB.
  6524
  6525 1025-FIND-AGENT-LOOP.
  6526     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6527         NEXT SENTENCE
  6528     ELSE
  6529         ADD +1 TO ACCOM-SUB
  6530         IF ACCOM-SUB > 10
  6531             MOVE -1             TO AACCTL
  6532             MOVE ER-2404        TO EMI-ERROR
  6533             MOVE AL-UABON       TO AACCTA
  6534             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6535         ELSE
  6536             GO TO 1025-FIND-AGENT-LOOP.
  6537
  6538     IF AM-AGT (ACCOM-SUB) NOT = PI-SAV-ACCT
  6539         IF FIRST-TIME
  6540             MOVE -1             TO AACCTL
  6541             MOVE ER-2405        TO EMI-ERROR
  6542             MOVE AL-UABON       TO AACCTA
  6543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6544             GO TO 1029-EXIT
  6545         ELSE
  6546             MOVE 'Y'            TO WS-PROCESS-SW
  6547             GO TO 1029-EXIT.
  6548
  6549     IF FIRST-TIME
  6550         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6551                                      PI-CR-FIN-RESP
  6552         MOVE 'A'                  TO PI-CR-TYPE
  6553         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6554         MOVE SPACE                TO FIRST-TIME-SW
  6555         IF EMI-ERROR NOT = ZEROS
  6556             GO TO 1029-EXIT.
  6557
  6558     IF AM-AGT (AM-REMIT-TO) = PI-SAV-REMIT-TO
  6559         NEXT SENTENCE
  6560     ELSE
  6561         MOVE 'Y'                TO WS-PROCESS-SW
  6562         MOVE ER-2408            TO EMI-ERROR
  6563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6564         PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6565         PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT
  6566         MOVE -1                 TO AACCTL
  6567         GO TO 8200-SEND-DATAONLY.
  6568
  6569     MOVE AM-NAME                TO PI-ACCT-NAME.
  6570
  6571     IF PI-BILL OR PI-REBILLING
  6572         PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  6573
  6574 1029-EXIT.
  6575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL640.cbl
  6577 1030-COMPUTE-COMMISSION-TOTALS.
  6578     IF PB-CANCELLATION
  6579         GO TO 1035-COMPUTE-CANCEL-COMM.
  6580
  6581     COMPUTE PI-PREMIUM = (WS-I-LF-PREMIUM-AMT +
  6582         WS-I-AH-PREMIUM-AMT) + PI-PREMIUM.
  6583     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6584         (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION).
  6585     MOVE SPACES                 TO WS-AH-CATEGORY
  6586     IF (PI-COMPANY-ID = 'DCC')
  6587        AND (NOT PB-INVALID-AH)
  6588        MOVE SPACES              TO ELCNTL-KEY
  6589        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6590        MOVE '5'                 TO ELCNTL-REC-TYPE
  6591        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6592                                    CLAS-LOOK
  6593        MOVE +0                  TO ELCNTL-SEQ-NO
  6594        PERFORM 6130-FIND-BENEFIT-CD
  6595                                 THRU 6140-EXIT
  6596     END-IF
  6597     IF WS-AH-CATEGORY = 'G' OR 'L'
  6598        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6599           WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6600              - PB-I-ADDL-CLP
  6601     ELSE
  6602        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6603            (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6604     END-IF
  6605     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6606                               PI-LF-ISS-COMP +
  6607                               PI-AH-ISS-COMP.
  6608     GO TO 1039-EXIT.
  6609
  6610 1035-COMPUTE-CANCEL-COMM.
  6611
  6612     MOVE SPACES                 TO WS-AH-CATEGORY
  6613     IF (PI-COMPANY-ID = 'DCC')
  6614        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6615        MOVE SPACES              TO ELCNTL-KEY
  6616        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6617        MOVE '5'                 TO ELCNTL-REC-TYPE
  6618        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6619                                    CLAS-LOOK
  6620        MOVE +0                  TO ELCNTL-SEQ-NO
  6621        PERFORM 6130-FIND-BENEFIT-CD
  6622                                 THRU 6140-EXIT
  6623     END-IF
  6624     IF WS-AH-CATEGORY = 'G' OR 'L'
  6625        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6626          WS-C-LF-CANCEL-AMT
  6627     ELSE
  6628        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6629         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6630     END-IF
  6631
  6632     COMPUTE PI-LF-CAN-COMP   ROUNDED =
  6633         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION) * -1.
  6634
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL640.cbl
  6635     IF WS-AH-CATEGORY = 'G' OR 'L'
  6636        COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6637           PB-CI-AH-PREMIUM-AMT
  6638           COMPUTE PI-AH-CAN-COMP ROUNDED =
  6639           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6640           PB-CI-LF-ALT-PREMIUM-AMT
  6641           - PB-CI-ADDL-CLP))
  6642*          - PB-CI-ADDL-CLP)) * -1
  6643     ELSE
  6644        COMPUTE PI-AH-CAN-COMP   ROUNDED =
  6645         (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION) * -1
  6646     END-IF
  6647     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6648     MOVE PB-C-LF-CANCEL-DT        TO  DC-BIN-DATE-2.
  6649     MOVE '1'                      TO  DC-OPTION-CODE.
  6650     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6651     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-LF.
  6652
  6653     IF DC-ODD-DAYS-OVER > ZEROS
  6654         ADD +1 TO MONTHS-DIFF-LF.
  6655
  6656     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6657     MOVE PB-C-AH-CANCEL-DT        TO  DC-BIN-DATE-2.
  6658     MOVE '1'                      TO  DC-OPTION-CODE.
  6659     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6660     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-AH.
  6661
  6662     IF DC-ODD-DAYS-OVER > ZEROS
  6663         ADD +1 TO MONTHS-DIFF-AH.
  6664
  6665     PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT.
  6666
  6667     MOVE  +0                       TO  SUB.
  6668     MOVE  'Y'                      TO  WS-CHARGEBACK-LF-SW
  6669                                        WS-CHARGEBACK-AH-SW.
  6670
  6671     MOVE ZEROS                     TO  WS-LF-CAN-COMP
  6672                                        WS-AH-CAN-COMP.
  6673 1035-ACCT-COMM-LOOP.
  6674
  6675     ADD +1 TO SUB.
  6676
  6677     IF SUB > +10
  6678         GO TO 1035-COMPUTE-TOT-CAN.
  6679
  6680     IF AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'F' AND 'S'
  6681         GO TO 1035-ACCT-COMM-LOOP.
  6682
  6683     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6684         MOVE  ZEROS            TO  AM-COMM-CHARGEBACK (SUB).
  6685
  6686     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6687         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6688         GO TO 1035-CHECK-AH-CHARGEBACK.
  6689
  6690     IF (MONTHS-DIFF-LF > AM-COMM-CHARGEBACK (SUB))
  6691                            AND
  6692        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL640.cbl
  6693         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6694     ELSE
  6695         COMPUTE WS-LF-CAN-COMP   ROUNDED =  WS-LF-CAN-COMP +
  6696            (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION).
  6697
  6698 1035-CHECK-AH-CHARGEBACK.
  6699
  6700     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6701         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6702         GO TO  1035-ACCT-COMM-LOOP.
  6703
  6704     IF (MONTHS-DIFF-AH > AM-COMM-CHARGEBACK (SUB))
  6705                            AND
  6706        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6707         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6708     ELSE
  6709        IF WS-AH-CATEGORY = 'G' OR 'L'
  6710           MOVE PI-AH-CAN-COMP   TO WS-AH-CAN-COMP
  6711        ELSE
  6712         COMPUTE WS-AH-CAN-COMP ROUNDED = WS-AH-CAN-COMP +
  6713            (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6714        END-IF
  6715     END-IF
  6716
  6717     GO TO 1035-ACCT-COMM-LOOP.
  6718
  6719 1035-COMPUTE-TOT-CAN.
  6720
  6721     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6722                               WS-LF-CAN-COMP +
  6723                               WS-AH-CAN-COMP.
  6724
  6725 1039-EXIT.
  6726     EXIT.
  6727
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL640.cbl
  6729 1040-UPDATE-BILLING-STATISTICS.
  6730     SET PINDX                   TO 1.
  6731
  6732 1041-SEARCH-LOOP.
  6733     IF PI-NON-PREM (PINDX) NOT NUMERIC
  6734        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  6735     IF WS-NON-PREM  NOT NUMERIC
  6736        MOVE ZEROS               TO WS-NON-PREM.
  6737     IF PI-NON-COMM (PINDX) NOT NUMERIC
  6738        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  6739     IF WS-NON-COMM  NOT NUMERIC
  6740        MOVE ZEROS               TO WS-NON-COMM.
  6741
  6742     IF PI-BATCH (PINDX) NOT = SPACES
  6743         GO TO 1042-CHECK-FOR-MATCH.
  6744
  6745     MOVE PB-ENTRY-BATCH         TO PI-BATCH (PINDX).
  6746
  6747     IF PI-COMPANY-ID = 'DMD'
  6748         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6749
  6750     IF DO-NOT-BILL-THIS-ACCT OR
  6751        PB-FATAL-ERRORS       OR
  6752        PB-UNFORCED-ERRORS    OR
  6753        PB-RECORD-ON-HOLD     OR
  6754        PB-RECORD-RETURNED    OR
  6755        PI-VOID-BILL
  6756         MOVE +1                 TO PI-NOBILL (PINDX)
  6757         MOVE ZEROS              TO PI-BILLED (PINDX)
  6758                                    PI-PREV   (PINDX)
  6759     ELSE
  6760         IF PB-BILLED-DT = LOW-VALUES
  6761           OR PI-TOT-REBILL
  6762             MOVE +1             TO PI-BILLED (PINDX)
  6763             MOVE ZEROS          TO PI-NOBILL (PINDX)
  6764                                    PI-PREV   (PINDX)
  6765         ELSE
  6766             MOVE +1             TO PI-PREV   (PINDX)
  6767             MOVE ZEROS          TO PI-BILLED (PINDX)
  6768                                    PI-NOBILL (PINDX).
  6769
  6770     GO TO 1049-EXIT.
  6771
  6772 1042-CHECK-FOR-MATCH.
  6773     IF PI-BATCH (PINDX) = PB-ENTRY-BATCH
  6774         NEXT SENTENCE
  6775     ELSE
  6776         GO TO 1043-SET-INDEX-UP.
  6777
  6778     IF PI-COMPANY-ID = 'DMD'
  6779         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6780
  6781     IF DO-NOT-BILL-THIS-ACCT OR
  6782        PB-FATAL-ERRORS       OR
  6783        PB-UNFORCED-ERRORS    OR
  6784        PB-RECORD-ON-HOLD     OR
  6785        PB-RECORD-RETURNED    OR
  6786        PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL640.cbl
  6787         ADD +1 TO PI-NOBILL (PINDX)
  6788     ELSE
  6789         IF PB-BILLED-DT = LOW-VALUES
  6790           OR PI-TOT-REBILL
  6791             ADD +1          TO PI-BILLED (PINDX)
  6792         ELSE
  6793             ADD +1          TO PI-PREV   (PINDX).
  6794
  6795     GO TO 1049-EXIT.
  6796
  6797 1043-SET-INDEX-UP.
  6798     SET PINDX UP BY 1.
  6799
  6800     IF PINDX > +6
  6801         MOVE 'Y'                TO BATCHES-PROCESSED-SW
  6802         GO TO 1049-EXIT
  6803     ELSE
  6804         GO TO 1041-SEARCH-LOOP.
  6805
  6806 1049-EXIT.
  6807     EXIT.
  6808
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL640.cbl
  6810 1050-BILL-BATCH-TRAILER-CHK.
  6811     SET PINDX                   TO 1.
  6812
  6813 1052-LOOP.
  6814     IF PI-BATCH (PINDX) = SPACES
  6815         GO TO 1059-EXIT.
  6816
  6817     IF PB-ENTRY-BATCH = PI-BATCH (PINDX)
  6818       AND PI-BILLED (PINDX) NOT = ZEROS
  6819         MOVE 'Y'                TO BILL-BATCH-TRAILER-SW
  6820         GO TO 1059-EXIT.
  6821
  6822     SET PINDX UP BY 1.
  6823     IF PINDX NOT > 6
  6824         GO TO 1052-LOOP.
  6825
  6826 1059-EXIT.
  6827     EXIT.
  6828
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL640.cbl
  6830 1060-DMD-ERROR-ROUTINE.
  6831     IF PB-FATAL-ERRORS OR PB-UNFORCED-ERRORS
  6832        IF ABILERRI = 'Y'
  6833           IF PB-ISSUE
  6834              COMPUTE WS-NON-PREM = PB-I-LF-PREMIUM-AMT
  6835                 + PB-I-LF-ALT-PREMIUM-AMT
  6836                 + PB-I-AH-PREMIUM-AMT
  6837              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6838              COMPUTE WS-NON-COMM ROUNDED =
  6839              ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
  6840                                    * PB-I-LIFE-COMMISSION)
  6841                                    +
  6842               (PB-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6843              ADD WS-NON-COMM TO PI-NON-COMM (PINDX)
  6844           ELSE
  6845           IF PB-CANCELLATION
  6846              COMPUTE WS-NON-PREM =
  6847              (PB-C-LF-CANCEL-AMT +  PB-C-AH-CANCEL-AMT) * -1
  6848              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6849              COMPUTE WS-NON-COMM ROUNDED =
  6850              ((PB-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6851                                   +
  6852               (PB-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION))
  6853                                   * -1
  6854              ADD WS-NON-COMM TO PI-NON-COMM (PINDX).
  6855
  6856 1060-EXIT.
  6857     EXIT.
  6858
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL640.cbl
  6860 1100-PYAJ-BILLING-PROCESS.
  6861*                *******************************************
  6862*                *  PROCESS THE PAYMENTS/ADJUSTMENTS FILE    *
  6863*                *******************************************
  6864
  6865     IF LIMIT-BILLING AND NOT PI-DATA-BILLED
  6866         MOVE ER-2443            TO EMI-ERROR
  6867         MOVE -1                 TO ABTCH1L
  6868         MOVE AL-UABON           TO ABTCH1A
  6869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6870         GO TO 8200-SEND-DATAONLY.
  6871
  6872     IF NOT PI-DATA-BILLED
  6873         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  6874         IF EMI-ERROR = ZEROS
  6875             MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6876                                          PI-CR-FIN-RESP
  6877             MOVE AM-REMIT-TO            TO ACCOM-SUB
  6878             MOVE 'A'                    TO PI-CR-TYPE
  6879             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6880             IF EMI-ERROR NOT = ZEROS
  6881                 GO TO 8200-SEND-DATAONLY
  6882             ELSE
  6883                 NEXT SENTENCE
  6884         ELSE
  6885             GO TO 8200-SEND-DATAONLY.
  6886
  6887 1105-PYAJ-BILLING-STARTBR-LOOP.
  6888     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  6889
  6890     IF PYAJ-EOF
  6891         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6892
  6893 1110-PYAJ-BILLING-READ-LOOP.
  6894     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  6895
  6896     IF PYAJ-EOF
  6897         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6898
  6899     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  6900        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  6901        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  6902        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  6903        PY-ACCOUNT    = PI-SAV-ACCT
  6904         NEXT SENTENCE
  6905     ELSE
  6906         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6907
  6908     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6909         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6910
  6911     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6912                         OR 'Z'
  6913         NEXT SENTENCE
  6914     ELSE
  6915         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6916
  6917     IF PY-VOID-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL640.cbl
  6918         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6919
  6920     IF PI-AR-PROCESSING
  6921        IF PY-AR-DATE = LOW-VALUES
  6922           OR PI-TOT-REBILL
  6923           OR RETURNED-FROM = XCTL-PYAJ
  6924           NEXT SENTENCE
  6925        ELSE
  6926           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6927     ELSE
  6928        IF (PY-BILLED-DATE = LOW-VALUES AND
  6929            PY-AR-DATE = LOW-VALUES)
  6930           OR PI-TOT-REBILL
  6931           OR RETURNED-FROM = XCTL-PYAJ
  6932           NEXT SENTENCE
  6933        ELSE
  6934           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6935
  6936     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6937
  6938     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6939         PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6940         PY-ADD-TO-BALANCE
  6941         ADD PY-ENTRY-AMT  TO  PI-REMITTED
  6942     ELSE
  6943         IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  6944            AND PY-BILLING-CHECK
  6945             ADD PY-ENTRY-AMT TO PI-DISBURSED
  6946         ELSE
  6947             ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS.
  6948
  6949     IF RETURNED-FROM = SPACES
  6950         IF PI-UPDATE-FILES
  6951           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6952             MOVE 'BP'           TO BILLING-DETAIL-TYPE
  6953             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6954
  6955     IF RETURNED-FROM = SPACES
  6956       AND (PI-BILL OR PI-REBILLING)
  6957         PERFORM 4800-PYAJ-END-BROWSE
  6958         PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT
  6959         ADD +1 TO ERPYAJ-FILE-SEQ-NO
  6960         GO TO 1105-PYAJ-BILLING-STARTBR-LOOP.
  6961
  6962     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6963
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL640.cbl
  6965 1200-PYAJ-BILLING-COMPLETE.
  6966     IF PI-DATA-BILLED
  6967       IF RETURNED-FROM = SPACES
  6968         IF PI-UPDATE-FILES
  6969            OR (PI-PREVIEW AND APRODSWI = 'Y')
  6970               MOVE 'TS'           TO BILLING-DETAIL-TYPE
  6971               PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6972
  6973     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
  6974
  6975     GO TO 8100-SEND-INITIAL-MAP.
  6976
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL640.cbl
  6978 1300-CHECK-OVERRIDE-PREM.
  6979     IF PB-CANCELLATION
  6980        IF PB-CI-CANCEL-FEE NOT NUMERIC
  6981           MOVE ZEROS  TO  PB-CI-CANCEL-FEE
  6982        END-IF
  6983     END-IF
  6984
  6985     MOVE ZEROS                  TO WS-I-LF-PREMIUM-AMT
  6986                                    WS-I-LF-BENEFIT-AMT
  6987     IF PB-OVERRIDE-LIFE  OR
  6988        PB-OVERRIDE-BOTH
  6989         GO TO 1310-LIFE-OVERRIDE.
  6990
  6991     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6992         IF PB-ISSUE
  6993           IF NOT PB-INVALID-LIFE
  6994            COMPUTE  WS-I-LF-PREMIUM-AMT =
  6995                    (PB-I-LF-PREMIUM-AMT +
  6996                     PB-I-LF-ALT-PREMIUM-AMT) * -1
  6997            COMPUTE  WS-I-LF-BENEFIT-AMT =
  6998                    (PB-I-LF-BENEFIT-AMT +
  6999                     PB-I-LF-ALT-BENEFIT-AMT) * -1
  7000           END-IF
  7001         ELSE
  7002             MULTIPLY PB-C-LF-CANCEL-AMT BY -1
  7003                            GIVING WS-C-LF-CANCEL-AMT
  7004             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7005                            GIVING WS-CI-LIFE-BENEFIT
  7006         END-IF
  7007     ELSE
  7008         IF PB-ISSUE
  7009           IF NOT PB-INVALID-LIFE
  7010            ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
  7011                GIVING WS-I-LF-PREMIUM-AMT
  7012            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7013                     PB-I-LF-BENEFIT-AMT +
  7014                     PB-I-LF-ALT-BENEFIT-AMT
  7015           END-IF
  7016         ELSE
  7017            MOVE PB-C-LF-CANCEL-AMT   TO WS-C-LF-CANCEL-AMT
  7018            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7019         END-IF
  7020     END-IF
  7021
  7022     GO TO 1320-CHECK-AH
  7023
  7024     .
  7025 1310-LIFE-OVERRIDE.
  7026     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7027         IF PB-ISSUE
  7028           IF NOT PB-INVALID-LIFE
  7029            COMPUTE WS-I-LF-PREMIUM-AMT =
  7030                   (PB-I-LF-PREM-CALC +
  7031                      PB-I-LF-ALT-PREM-CALC) * -1
  7032            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7033                     (PB-I-LF-BENEFIT-AMT +
  7034                      PB-I-LF-ALT-BENEFIT-AMT) * -1
  7035           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL640.cbl
  7036         ELSE
  7037             MULTIPLY PB-C-LF-REF-CALC BY -1
  7038                            GIVING WS-C-LF-CANCEL-AMT
  7039             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7040                            GIVING WS-CI-LIFE-BENEFIT
  7041         END-IF
  7042     ELSE
  7043         IF PB-ISSUE
  7044           IF NOT PB-INVALID-LIFE
  7045            ADD PB-I-LF-PREM-CALC   PB-I-LF-ALT-PREM-CALC
  7046                GIVING WS-I-LF-PREMIUM-AMT
  7047            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7048                     PB-I-LF-BENEFIT-AMT +
  7049                     PB-I-LF-ALT-BENEFIT-AMT
  7050           END-IF
  7051         ELSE
  7052            MOVE PB-C-LF-REF-CALC     TO WS-C-LF-CANCEL-AMT
  7053            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7054         END-IF
  7055     END-IF
  7056     .
  7057 1320-CHECK-AH.
  7058     IF PB-OVERRIDE-AH  OR
  7059        PB-OVERRIDE-BOTH
  7060         GO TO 1330-AH-OVERRIDE.
  7061
  7062     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7063         IF PB-ISSUE
  7064            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7065                            GIVING WS-I-AH-BENEFIT-AMT
  7066            MULTIPLY PB-I-AH-PREMIUM-AMT BY -1
  7067                            GIVING WS-I-AH-PREMIUM-AMT
  7068         ELSE
  7069             MULTIPLY PB-C-AH-CANCEL-AMT BY -1
  7070                            GIVING WS-C-AH-CANCEL-AMT
  7071     ELSE
  7072         IF PB-ISSUE
  7073            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7074            MOVE PB-I-AH-PREMIUM-AMT TO WS-I-AH-PREMIUM-AMT
  7075         ELSE
  7076            MOVE PB-C-AH-CANCEL-AMT TO WS-C-AH-CANCEL-AMT
  7077            IF  PB-CI-CANCEL-FEE > ZEROS
  7078                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7079                MULTIPLY WS-C-CANCEL-FEE BY -1
  7080                                          GIVING WORK-CANCEL-FEE
  7081                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7082
  7083     GO TO 1399-EXIT.
  7084
  7085 1330-AH-OVERRIDE.
  7086     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7087         IF PB-ISSUE
  7088            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7089                            GIVING WS-I-AH-BENEFIT-AMT
  7090            MULTIPLY PB-I-AH-PREM-CALC BY -1
  7091                            GIVING WS-I-AH-PREMIUM-AMT
  7092         ELSE
  7093             MULTIPLY PB-C-AH-REF-CALC BY -1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL640.cbl
  7094                            GIVING WS-C-AH-CANCEL-AMT
  7095     ELSE
  7096         IF PB-ISSUE
  7097            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7098            MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  7099         ELSE
  7100            MOVE PB-C-AH-REF-CALC    TO WS-C-AH-CANCEL-AMT
  7101            IF PB-CI-CANCEL-FEE > ZEROS
  7102                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7103                MULTIPLY WS-C-CANCEL-FEE BY -1
  7104                                          GIVING WORK-CANCEL-FEE
  7105                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7106
  7107 1399-EXIT.
  7108     EXIT.
  7109
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL640.cbl
  7111 2000-VOID-BILLING.
  7112
  7113*                *******************************************
  7114*                *  PROCESS VOID BILLING.  THIS SECTION    *
  7115*                *  WILL RESET THE FILES TO THE STATUS     *
  7116*                *  THEY WERE IN PRIOR TO THE LAST BILLING *
  7117*                *******************************************
  7118
  7119     MOVE SPACES                 TO WS-EXP-DATE
  7120                                    WS-REMIT-TO.
  7121     SET DTNDX  RTNDX            TO 1.
  7122     MOVE SPACES                 TO ELCNTL-KEY.
  7123     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7124
  7125     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  7126
  7127     IF EMI-ERROR NOT = ZEROS
  7128         GO TO 8200-SEND-DATAONLY.
  7129
  7130     MOVE CF-CURRENT-MONTH-END   TO DC-BIN-DATE-1.
  7131     MOVE SPACE                  TO DC-OPTION-CODE.
  7132     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7133     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  7134
  7135     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  7136
  7137     IF PNDB-EOF
  7138         GO TO 2100-VOID-PNDB-COMPLETE.
  7139
  7140 2010-VOID-PNDB-LOOP.
  7141     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  7142
  7143     IF PNDB-EOF
  7144         GO TO 2100-VOID-PNDB-COMPLETE.
  7145
  7146     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  7147        PB-CARRIER       = PI-SAV-CARR    AND
  7148        PB-GROUPING      = PI-SAV-GROUP   AND
  7149        PB-STATE         = PI-SAV-STATE   AND
  7150        PB-ACCOUNT       = PI-SAV-ACCT
  7151         NEXT SENTENCE
  7152     ELSE
  7153         GO TO 2100-VOID-PNDB-COMPLETE.
  7154
  7155     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7156         GO TO 2010-VOID-PNDB-LOOP.
  7157
  7158     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7159         MOVE PB-CONTROL-PRIMARY TO ERPNDB-PRIME-KEY
  7160
  7161* EXEC CICS ENDBR
  7162*             DATASET (ERPNDB-ALT-FILE-ID)
  7163*        END-EXEC
  7164     MOVE 0
  7165       TO DFHEIV11
  7166*    MOVE '&2                    $   #00007060' TO DFHEIV0
  7167     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7168     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL640.cbl
  7169     MOVE X'2020233030303037303630' TO DFHEIV0(25:11)
  7170     CALL 'kxdfhei1' USING DFHEIV0,
  7171           ERPNDB-ALT-FILE-ID,
  7172           DFHEIV11,
  7173           DFHEIV99
  7174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7175
  7176* EXEC CICS DELETE
  7177*            DATASET (ERPNDB-FILE-ID)
  7178*            RIDFLD  (ERPNDB-PRIME-KEY)
  7179*        END-EXEC
  7180*    MOVE '&(  R                 &   #00007063' TO DFHEIV0
  7181     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7182     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7183     MOVE X'2020233030303037303633' TO DFHEIV0(25:11)
  7184     CALL 'kxdfhei1' USING DFHEIV0,
  7185           ERPNDB-FILE-ID,
  7186           ERPNDB-PRIME-KEY,
  7187           DFHEIV99,
  7188           DFHEIV99,
  7189           DFHEIV99
  7190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7191         PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT
  7192         IF PNDB-EOF
  7193            GO TO 2100-VOID-PNDB-COMPLETE
  7194         ELSE
  7195            GO TO 2010-VOID-PNDB-LOOP.
  7196
  7197     IF PB-BILLED-DT = LOW-VALUES  AND
  7198        PB-CHG-COUNT = ZEROS
  7199         GO TO 2010-VOID-PNDB-LOOP.
  7200
  7201     IF PB-BATCH-TRAILER
  7202         GO TO 2115-CONT.
  7203
  7204     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  7205         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  7206         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7207         IF AM-AGT (AM-REMIT-TO) NOT = WORK-REMIT-TO
  7208             MOVE AM-AGT (AM-REMIT-TO) TO WORK-REMIT-TO
  7209                                          WS-SAV-REMIT-TO (RTNDX)
  7210             IF RTNDX < 10
  7211                 SET RTNDX UP BY 1.
  7212
  7213 2115-CONT.
  7214     IF NOT PB-BATCH-TRAILER
  7215         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  7216         PERFORM 1300-CHECK-OVERRIDE-PREM       THRU 1399-EXIT
  7217         PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  7218
  7219     PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  7220
  7221     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7222     GO TO 2010-VOID-PNDB-LOOP.
  7223
  7224 2100-VOID-PNDB-COMPLETE.
  7225     SET RTNDX                   TO 1.
  7226
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL640.cbl
  7227     IF NOT DATA-VOIDED
  7228         SET DTNDX TO RTNDX
  7229         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7230         MOVE AM-AGT (AM-REMIT-TO) TO WS-SAV-REMIT-TO (RTNDX).
  7231
  7232 2105-PYAJ-LOOP.
  7233     IF RTNDX > 10
  7234       OR WS-SAV-REMIT-TO (RTNDX) = SPACES
  7235         GO TO 2105-VOID-CONTINUE.
  7236
  7237     MOVE WS-SAV-REMIT-TO (RTNDX) TO PI-SAV-REMIT-TO.
  7238     PERFORM 2200-VOID-PYAJ THRU 2290-EXIT.
  7239
  7240     SET RTNDX UP BY 1.
  7241     GO TO 2105-PYAJ-LOOP.
  7242
  7243 2105-VOID-CONTINUE.
  7244     IF DATA-VOIDED
  7245         NEXT SENTENCE
  7246     ELSE
  7247         MOVE -1                 TO APFNTERL
  7248         MOVE ER-2401            TO EMI-ERROR
  7249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7250         GO TO 8100-SEND-INITIAL-MAP.
  7251
  7252     SET DTNDX                   TO 1.
  7253
  7254 2105-VOID-MASTERS-LOOP.
  7255     IF WS-SAV-EXP-DT (DTNDX) = SPACES
  7256       OR DTNDX > 10
  7257         GO TO 2105-VOID-COMPLETE.
  7258
  7259     MOVE WS-SAV-EXP-DT (DTNDX) TO PI-SAV-EXP-DT.
  7260
  7261     PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  7262
  7263     IF PI-SAV-REMIT-TO NOT = ERCOMP-FIN-RESP
  7264         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  7265         PERFORM 3930-BILL-READ        THRU 3930-EXIT
  7266         IF NOT NO-BILL-RECS
  7267             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT.
  7268
  7269     SET DTNDX UP BY 1.
  7270
  7271     GO TO 2105-VOID-MASTERS-LOOP.
  7272
  7273 2105-VOID-COMPLETE.
  7274     MOVE 0000                   TO EMI-ERROR.
  7275     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7276     SET PINDX ANDX TO 1.
  7277
  7278 2110-FORMAT-LOOP.
  7279     IF PI-BATCH (PINDX) NOT = SPACES
  7280         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  7281         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  7282         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  7283         SET ANDX PINDX UP BY 1
  7284         IF PINDX > 6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL640.cbl
  7285             NEXT SENTENCE
  7286         ELSE
  7287             GO TO 2110-FORMAT-LOOP.
  7288
  7289     MOVE -1                     TO AACCTL.
  7290
  7291     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL640.cbl
  7293 2200-VOID-PYAJ.
  7294     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  7295
  7296     IF PYAJ-EOF
  7297         GO TO 2290-EXIT.
  7298
  7299 2210-VOID-PYAJ-LOOP.
  7300     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  7301
  7302     IF PYAJ-EOF
  7303         PERFORM 4800-PYAJ-END-BROWSE
  7304         GO TO 2290-EXIT.
  7305
  7306     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  7307        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  7308        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  7309        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  7310        PY-ACCOUNT    = PI-SAV-ACCT
  7311         NEXT SENTENCE
  7312     ELSE
  7313         PERFORM 4800-PYAJ-END-BROWSE
  7314         GO TO 2290-EXIT.
  7315
  7316     IF (PY-BILLED-DATE = LOW-VALUES AND
  7317            PY-AR-DATE = LOW-VALUES)
  7318       OR PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7319         GO TO 2210-VOID-PYAJ-LOOP.
  7320
  7321     PERFORM 4800-PYAJ-END-BROWSE.
  7322
  7323     PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT.
  7324
  7325     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7326     ADD +1 TO ERPYAJ-FILE-SEQ-NO.
  7327
  7328     GO TO 2200-VOID-PYAJ.
  7329
  7330 2290-EXIT.
  7331     EXIT.
  7332
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL640.cbl
  7334
  7335 3000-WRITE-BILLING-DETAIL.
  7336
  7337*                *******************************************
  7338*                *  FORMATS THE BILLING DETAIL RECORDS.    *
  7339*                *  THESE RECORDS ARE CREATED IN THE       *
  7340*                *  SAME FORMAT THAT THEY WILL APPEAR      *
  7341*                *  WHEN PRINTED.                          *
  7342*                *******************************************
  7343
  7344     IF CARRIER-ADDRESS  OR
  7345        GEN-AGT-ADDRESS
  7346          PERFORM 3930-BILL-READ THRU 3930-EXIT
  7347         IF NO-BILL-RECS
  7348             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7349         ELSE
  7350             IF BI-PREVIEW-ONLY
  7351               OR BI-INITIAL-PRINT-DATE NOT = LOW-VALUES
  7352               OR PI-TOT-REBILL
  7353                 PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  7354                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7355             ELSE
  7356                 MOVE ER-2403    TO EMI-ERROR
  7357                 MOVE -1         TO ABILTYPL
  7358                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7359                 GO TO 3990-EXIT.
  7360
  7361     IF TOTAL-STATEMENT
  7362         GO TO 3400-FORMAT-TOTAL-LINES.
  7363
  7364 3100-FORMAT-DETAIL-LINES.
  7365     IF PI-PREM (PINDX) NOT NUMERIC
  7366        MOVE ZEROS               TO PI-PREM (PINDX).
  7367     IF PI-COMM (PINDX) NOT NUMERIC
  7368        MOVE ZEROS               TO PI-COMM (PINDX).
  7369
  7370     IF WS-LINECTR > 23
  7371         MOVE ZEROS              TO WS-LINECTR
  7372         MOVE '3'                TO BI-RECORD-TYPE
  7373         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7374         MOVE '          CONTINUED ON NEXT PAGE'
  7375                                 TO BI-TEXT-LINE
  7376         PERFORM 3920-BILL-WRITE
  7377         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7378
  7379     IF WS-LINECTR = ZEROS
  7380         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7381     ELSE
  7382         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL
  7383     END-IF.
  7384
  7385     MOVE '3'                    TO BI-RECORD-TYPE.
  7386
  7387     IF BILLING-DETAIL-TYPE = 'BP'
  7388        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7389             MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7390             MULTIPLY PY-ENTRY-AMT   BY -1
  7391                              GIVING BI-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL640.cbl
  7392             MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7393             ADD +1 TO WS-LINECTR
  7394             PERFORM 3920-BILL-WRITE
  7395             GO TO 3990-EXIT.
  7396
  7397     IF BILLING-DETAIL-TYPE = 'BP'
  7398         MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7399         MOVE PY-ENTRY-AMT       TO BI-TOT-PREM
  7400         MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7401         ADD +1 TO WS-LINECTR
  7402         PERFORM 3920-BILL-WRITE
  7403         GO TO 3990-EXIT.
  7404
  7405     MOVE SPACES                 TO BI-TEXT-LINE.
  7406
  7407     IF PB-ISSUE
  7408        NEXT SENTENCE
  7409     ELSE
  7410        GO TO 3110-FORMAT-DETAIL-CANCEL.
  7411
  7412     MOVE PB-I-INSURED-FIRST-NAME    TO BI-INS-1ST-NAME.
  7413     MOVE PB-I-INSURED-MIDDLE-INIT   TO BI-INS-INIT.
  7414
  7415     IF PI-COMPANY-ID = 'DMD' AND
  7416        PB-ISSUE
  7417        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7418
  7419     MOVE PB-I-INSURED-LAST-NAME     TO BI-INS-LAST-NAME.
  7420     MOVE PB-CERT-NO                 TO BI-CERT.
  7421     MOVE PB-I-LF-TERM               TO BI-ED-TERM  BI-TERM.
  7422     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7423     MOVE SPACE                      TO DC-OPTION-CODE.
  7424     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7425     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7426
  7427     IF PI-COMPANY-ID = 'DMD' AND
  7428        PB-ISSUE  AND
  7429        NOT PB-INVALID-LIFE
  7430          MOVE PB-I-LF-BENEFIT-CD    TO WS-BENE-CD
  7431          MOVE WS-BENEFIT            TO PB-I-LF-ABBR.
  7432
  7433     IF NOT PB-INVALID-LIFE
  7434        MOVE PB-I-LF-ABBR            TO BI-TYPE
  7435        MOVE WS-I-LF-PREMIUM-AMT     TO BI-PREM
  7436                                        BI-PREMIUM-AMT
  7437        ADD WS-I-LF-PREMIUM-AMT      TO TOT-REPT-LF-PREM
  7438        MULTIPLY PB-I-LIFE-COMMISSION BY 100 GIVING BI-ED-RATE
  7439        MOVE PB-I-LIFE-COMMISSION    TO BI-RATE
  7440        MOVE PI-LF-ISS-COMP          TO BI-COMM
  7441        ADD  PI-LF-ISS-COMP          TO TOT-REPT-LF-COMP
  7442        MOVE WS-I-LF-BENEFIT-AMT     TO BI-FACE-AMT
  7443                                        BI-BENEFIT-AMT
  7444        ADD WS-I-LF-BENEFIT-AMT      TO TOT-LF-REPT-FACE-AMT
  7445        ADD WS-I-LF-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7446        ADD PI-LF-ISS-COMP           TO  PI-COMM (PINDX)
  7447        PERFORM 3920-BILL-WRITE
  7448        ADD +1 TO WS-LINECTR
  7449        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL640.cbl
  7450        MOVE SPACES                  TO BI-TEXT-LINE.
  7451
  7452     IF PI-COMPANY-ID = 'DMD' AND
  7453        PB-ISSUE  AND
  7454        NOT PB-INVALID-AH
  7455          MOVE PB-I-AH-BENEFIT-CD    TO WS-BENE-CD
  7456          MOVE WS-BENEFIT            TO PB-I-AH-ABBR.
  7457
  7458     IF NOT PB-INVALID-AH
  7459        MOVE PB-I-AH-ABBR            TO BI-TYPE
  7460        MOVE WS-I-AH-PREMIUM-AMT     TO BI-PREM
  7461                                        BI-PREMIUM-AMT
  7462        ADD WS-I-AH-PREMIUM-AMT      TO TOT-REPT-AH-PREM
  7463        MULTIPLY PB-I-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7464        MOVE PB-I-AH-COMMISSION      TO BI-RATE
  7465        MOVE PI-AH-ISS-COMP          TO BI-COMM
  7466        ADD PI-AH-ISS-COMP           TO TOT-REPT-AH-COMP
  7467        MOVE WS-I-AH-BENEFIT-AMT     TO BI-FACE-AMT
  7468        ADD WS-I-AH-BENEFIT-AMT      TO TOT-AH-REPT-FACE-AMT
  7469        ADD WS-I-AH-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7470        ADD PI-AH-ISS-COMP           TO  PI-COMM (PINDX)
  7471        PERFORM 3920-BILL-WRITE
  7472        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
  7473        ADD +1                       TO WS-LINECTR.
  7474
  7475     GO TO 3990-EXIT.
  7476
  7477 3110-FORMAT-DETAIL-CANCEL.
  7478     MOVE PB-CI-LAST-NAME            TO BI-INS-LAST-NAME.
  7479     MOVE PB-CI-INITIALS             TO BI-INS-INITS.
  7480
  7481     IF PI-COMPANY-ID = 'DMD' AND
  7482        PB-CANCELLATION
  7483        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7484
  7485     MOVE PB-CERT-NO                 TO BI-CERT.
  7486     MOVE PB-CI-LF-TERM              TO BI-ED-TERM
  7487                                        BI-TERM.
  7488     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7489     MOVE SPACE                      TO DC-OPTION-CODE.
  7490     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7491     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7492
  7493     IF PI-COMPANY-ID = 'DMD' AND
  7494        PB-CANCELLATION AND
  7495        PB-CI-LF-ABBR > SPACES
  7496          MOVE PB-CI-LF-BENEFIT-CD   TO WS-BENE-CD
  7497          MOVE WS-BENEFIT            TO PB-CI-LF-ABBR.
  7498
  7499     IF PB-CI-LF-ABBR > SPACES
  7500         MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
  7501         MOVE SPACE                  TO DC-OPTION-CODE
  7502         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7503         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7504         MOVE PB-CI-LF-ABBR          TO BI-TYPE
  7505         MOVE WS-C-LF-CANCEL-AMT     TO BI-PREMIUM-AMT
  7506         MULTIPLY WS-C-LF-CANCEL-AMT BY -1 GIVING WORK-AMT
  7507         MOVE WORK-AMT               TO BI-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL640.cbl
  7508         ADD WS-C-LF-CANCEL-AMT      TO TOT-REPT-LF-REF
  7509         ADD WORK-AMT                TO TOT-REPT-LF-PREM
  7510                                        PI-PREM (PINDX)
  7511         MULTIPLY PB-CI-LIFE-COMMISSION
  7512                                     BY 100 GIVING BI-ED-RATE
  7513         MOVE PB-CI-LIFE-COMMISSION  TO BI-RATE
  7514         IF WS-CHARGEBACK-LF-SW = 'N'
  7515             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7516             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7517             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7518                                            PI-COMM (PINDX)
  7519             COMPUTE TOT-REPT-LF-COMP-R =
  7520               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7521             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7522             ADD +1                      TO WS-LINECTR
  7523             PERFORM 3920-BILL-WRITE
  7524             MOVE SPACES                 TO BI-TEXT-LINE
  7525         ELSE
  7526             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7527             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7528                                            PI-COMM (PINDX)
  7529             COMPUTE TOT-REPT-LF-COMP-R =
  7530               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7531             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7532             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7533             ADD +1                      TO WS-LINECTR
  7534             PERFORM 3920-BILL-WRITE
  7535             MOVE SPACES                 TO BI-TEXT-LINE.
  7536
  7537     IF PI-COMPANY-ID = 'DMD' AND
  7538        PB-CANCELLATION AND
  7539        PB-CI-AH-ABBR > SPACES
  7540          MOVE PB-CI-AH-BENEFIT-CD   TO WS-BENE-CD
  7541          MOVE WS-BENEFIT            TO PB-CI-AH-ABBR.
  7542
  7543     IF PB-CI-AH-ABBR > SPACES
  7544         MOVE PB-C-AH-CANCEL-DT      TO DC-BIN-DATE-1
  7545         MOVE SPACE                  TO DC-OPTION-CODE
  7546         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7547         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7548         MOVE PB-CI-AH-ABBR          TO BI-TYPE
  7549         MOVE WS-C-AH-CANCEL-AMT     TO BI-PREMIUM-AMT
  7550         MULTIPLY WS-C-AH-CANCEL-AMT BY -1 GIVING WORK-AMT
  7551         MOVE WORK-AMT               TO BI-PREM
  7552         ADD WS-C-AH-CANCEL-AMT      TO TOT-REPT-AH-REF
  7553         ADD WORK-AMT                TO TOT-REPT-AH-PREM
  7554                                        PI-PREM (PINDX)
  7555         MULTIPLY PB-CI-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7556         MOVE PB-CI-AH-COMMISSION    TO BI-RATE
  7557         IF WS-CHARGEBACK-AH-SW = 'N'
  7558             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7559             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7560             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7561                                            PI-COMM (PINDX)
  7562             COMPUTE TOT-REPT-AH-COMP-R =
  7563               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7564             ADD +1                      TO WS-LINECTR
  7565             PERFORM 3920-BILL-WRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL640.cbl
  7566         ELSE
  7567             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7568             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7569                                            PI-COMM (PINDX)
  7570             COMPUTE TOT-REPT-AH-COMP-R =
  7571               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7572             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7573             ADD +1                      TO WS-LINECTR
  7574             PERFORM 3920-BILL-WRITE.
  7575
  7576     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7577         MOVE ZEROS                      TO PB-CI-CANCEL-FEE.
  7578
  7579     IF PB-CI-CANCEL-FEE > ZEROS
  7580         MOVE SPACES                 TO BI-INS-LAST-NAME
  7581                                        BI-INS-INITS
  7582                                        BI-EFF-DT
  7583                                        BI-CAN-DT
  7584                                        BI-TYPE
  7585         MOVE 'CANCEL FEE'           TO BI-CERT
  7586         MOVE WORK-CANCEL-FEE        TO BI-PREM
  7587                                        BI-COMM
  7588         MOVE ZEROS                  TO BI-PREMIUM-AMT
  7589                                        BI-RATE
  7590                                        BI-ED-RATE
  7591                                        BI-ED-TERM
  7592                                        BI-TERM
  7593         ADD +1                      TO WS-LINECTR
  7594         PERFORM 3920-BILL-WRITE.
  7595
  7596     GO TO 3990-EXIT.
  7597
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL640.cbl
  7599
  7600 3200-FORMAT-HDR-ADDR-RECS.
  7601     PERFORM 3910-BILL-GETMAIN.
  7602
  7603     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7604     SET A-INDX  R-INDX          TO 1.
  7605     PERFORM 3210-FORMAT-ADDR-RECS  THRU 3210-EXIT 6 TIMES.
  7606     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7607     PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7608     GO TO 3990-EXIT.
  7609
  7610 3210-FORMAT-ADDR-RECS.
  7611     MOVE '2'                     TO BI-RECORD-TYPE.
  7612     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDRESS-LINE.
  7613     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDRESS-LINE.
  7614     PERFORM 3920-BILL-WRITE.
  7615     SET A-INDX  R-INDX         UP BY 1.
  7616
  7617 3210-EXIT.
  7618     EXIT.
  7619
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL640.cbl
  7621 3300-FORMAT-HEADINGS.
  7622     MOVE WS-PGECTR              TO BI-HD-PG.
  7623     ADD +1                      TO WS-PGECTR.
  7624     MOVE '3'                    TO BI-RECORD-TYPE.
  7625     MOVE TOP-OF-PAGE            TO BI-SKIP-CONTROL.
  7626
  7627     IF NOT PI-PREVIEW
  7628         MOVE BI-HD1             TO BI-TEXT-LINE
  7629     ELSE
  7630         MOVE BI-PREVIEW-HD      TO BI-TEXT-LINE
  7631         PERFORM 3920-BILL-WRITE
  7632         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7633         MOVE BI-HD1             TO BI-TEXT-LINE.
  7634
  7635     PERFORM 3920-BILL-WRITE.
  7636     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7637     MOVE BI-HD2                 TO BI-TEXT-LINE.
  7638     PERFORM 3920-BILL-WRITE.
  7639     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7640     MOVE BI-HD3                 TO BI-TEXT-LINE.
  7641     PERFORM 3920-BILL-WRITE.
  7642     SET A-INDX  R-INDX          TO 1.
  7643     PERFORM 3390-FORMAT-ADDR-TEXT-LINES THRU 3390-EXIT 5 TIMES.
  7644     MOVE '3'                    TO BI-RECORD-TYPE.
  7645     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7646     MOVE BI-HD4                 TO BI-TEXT-LINE.
  7647     PERFORM 3920-BILL-WRITE.
  7648     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7649     MOVE BI-HD5                 TO BI-TEXT-LINE.
  7650     PERFORM 3920-BILL-WRITE.
  7651
  7652 3380-EXIT.
  7653     EXIT.
  7654
  7655 3390-FORMAT-ADDR-TEXT-LINES.
  7656     MOVE '3'                    TO BI-RECORD-TYPE.
  7657     MOVE SPACES                 TO BI-TEXT-LINE.
  7658
  7659     IF A-INDX = 1
  7660         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7661         MOVE 'ACCOUNT NO. - '   TO BI-ADDR-LIT
  7662         MOVE WS-CARR-COMP       TO BI-CO
  7663         MOVE '-'                TO BI-DASH
  7664         MOVE PI-SAV-ACCT        TO BI-ACCT
  7665         MOVE 'REMIT TO - '      TO BI-REMIT-LIT
  7666     ELSE
  7667         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL.
  7668
  7669     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDR.
  7670     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDR.
  7671     PERFORM 3920-BILL-WRITE.
  7672     SET A-INDX  R-INDX  UP BY 1.
  7673
  7674 3390-EXIT.
  7675     EXIT.
  7676
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL640.cbl
  7678 3400-FORMAT-TOTAL-LINES.
  7679     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  7680                          PI-PREMIUM +
  7681                          TOT-REPT-CANCEL-FEE -
  7682                          PI-REMITTED -
  7683                          PI-TOT-ISS-COMP +
  7684                          PI-TOT-CAN-COMP +
  7685                          PI-ADJUSTMENTS +
  7686                          PI-DISBURSED.
  7687
  7688     MOVE SPACES                 TO BI-TEXT-LINE.
  7689
  7690     MOVE '1'                    TO BI-RECORD-TYPE.
  7691     MOVE PI-PROCESSOR-ID        TO BI-PROCESSOR-CD.
  7692
  7693     IF PI-PREV-BILL OR PI-PREV-REBILL
  7694         MOVE 'P'                TO BI-STATEMENT-TYPE.
  7695
  7696     MOVE +1                     TO BI-NO-OF-COPIES.
  7697     MOVE WS-CURRENT-DATE        TO BI-CREATION-DT.
  7698     MOVE LOW-VALUES             TO BI-INITIAL-PRINT-DATE.
  7699     MOVE PI-BAL-FRWD            TO BI-BAL-FRWD.
  7700     MOVE PI-PREMIUM             TO BI-PREMIUM.
  7701     MOVE PI-REMITTED            TO BI-REMITTED.
  7702     MOVE PI-TOT-ISS-COMP        TO BI-TOT-ISS-COMP.
  7703     MOVE PI-TOT-CAN-COMP        TO BI-TOT-CAN-COMP.
  7704     MOVE PI-ADJUSTMENTS         TO BI-ADJUSTMNTS.
  7705     MOVE PI-DISBURSED           TO BI-DISBURSED.
  7706     MOVE PI-END-BAL             TO BI-END-BAL.
  7707
  7708     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  7709         MOVE WS-ACCT-LINES (1)  TO BI-FIN-RESP-NAME
  7710     ELSE
  7711         MOVE WS-REMIT-LINES (1) TO BI-FIN-RESP-NAME.
  7712
  7713     PERFORM 3920-BILL-WRITE.
  7714
  7715     IF WS-LINECTR > 16
  7716         MOVE ZEROS              TO WS-LINECTR
  7717         MOVE '3'                TO BI-RECORD-TYPE
  7718         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7719         MOVE '          CONTINUED ON NEXT PAGE'
  7720                                 TO BI-TEXT-LINE
  7721         PERFORM 3920-BILL-WRITE
  7722         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7723
  7724     IF PI-BAL-FRWD NOT = ZERO
  7725         MOVE SPACES             TO BI-TEXT-LINE
  7726         MOVE '3'                TO BI-RECORD-TYPE
  7727         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7728         MOVE 'BALANCE FORWARD'  TO BI-TOT-DESC
  7729         MOVE PI-BAL-FRWD        TO BI-TOT-PREM
  7730         PERFORM 3920-BILL-WRITE.
  7731
  7732     IF PI-PREMIUM NOT = ZERO
  7733         MOVE SPACES             TO BI-TEXT-LINE
  7734         MOVE '3'                TO BI-RECORD-TYPE
  7735         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL640.cbl
  7736         MOVE 'THIS MONTHS PREMIUM'  TO BI-TOT-DESC
  7737         COMPUTE WORK-AMT  =  TOT-REPT-CANCEL-FEE + PI-PREMIUM
  7738         MOVE WORK-AMT           TO BI-TOT-PREM
  7739         PERFORM 3920-BILL-WRITE.
  7740
  7741     IF PI-TOT-ISS-COMP NOT = ZEROS  OR
  7742        PI-TOT-CAN-COMP NOT = ZEROS
  7743         MOVE SPACES             TO BI-TEXT-LINE
  7744         MOVE '3'                TO BI-RECORD-TYPE
  7745         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7746         MOVE 'LESS COMPENSATION' TO BI-TOT-DESC
  7747         SUBTRACT PI-TOT-CAN-COMP FROM PI-TOT-ISS-COMP
  7748                          GIVING BI-TOT-PREM
  7749         PERFORM 3920-BILL-WRITE.
  7750
  7751     IF PI-REMITTED  NOT = ZEROS  OR
  7752        PI-DISBURSED NOT = ZEROS
  7753         MOVE SPACES             TO BI-TEXT-LINE
  7754         MOVE '3'                TO BI-RECORD-TYPE
  7755         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7756         MOVE 'LESS PAYMENTS'    TO BI-TOT-DESC
  7757         IF PI-COMPANY-ID = 'UCL'
  7758             SUBTRACT PI-DISBURSED FROM PI-REMITTED
  7759                      GIVING BI-TOT-PREM
  7760             PERFORM 3920-BILL-WRITE
  7761           ELSE
  7762             MOVE PI-REMITTED        TO BI-TOT-PREM
  7763             PERFORM 3920-BILL-WRITE.
  7764
  7765     IF PI-ADJUSTMENTS NOT = ZERO
  7766         MOVE SPACES             TO BI-TEXT-LINE
  7767         MOVE '3'                TO BI-RECORD-TYPE
  7768         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7769         MOVE 'ADJUSTMENT'       TO BI-TOT-DESC
  7770         ADD PI-ADJUSTMENTS, PI-DISBURSED GIVING BI-TOT-PREM
  7771         PERFORM 3920-BILL-WRITE.
  7772
  7773     MOVE SPACES                 TO BI-TEXT-LINE.
  7774     MOVE '3'                    TO BI-RECORD-TYPE.
  7775     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7776     MOVE ALL '-'                TO BI-TOT-DASH.
  7777     PERFORM 3920-BILL-WRITE.
  7778
  7779     MOVE SPACES                 TO BI-TEXT-LINE.
  7780     MOVE '3'                    TO BI-RECORD-TYPE.
  7781     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7782
  7783     IF PI-END-BAL < +1.00 AND > -1.00
  7784         NEXT SENTENCE
  7785     ELSE
  7786         IF PI-END-BAL < +0
  7787             MOVE 'WE WILL REFUND' TO BI-TOT-DESC
  7788         ELSE
  7789             MOVE 'PLEASE REMIT' TO BI-TOT-DESC.
  7790
  7791     MOVE PI-END-BAL             TO BI-TOT-PREM.
  7792
  7793     PERFORM 3920-BILL-WRITE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL640.cbl
  7794
  7795     IF CO-CARRY-BALANCE
  7796         IF PI-END-BAL > +1.00
  7797             MOVE SPACES         TO BI-TEXT-LINE
  7798             MOVE '3'            TO BI-RECORD-TYPE
  7799             MOVE DOUBLE-SPACE   TO BI-SKIP-CONTROL
  7800             MOVE 'PLEASE RETURN ONE COPY WITH REMITTANCE'
  7801                                 TO BI-TEXT-LINE
  7802             PERFORM 3920-BILL-WRITE.
  7803
  7804     IF PI-COMPANY-ID = 'DMD'
  7805        MOVE SPACES                 TO BI-TEXT-LINE
  7806        MOVE '3'                    TO BI-RECORD-TYPE
  7807        MOVE '0'                    TO BI-SKIP-CONTROL
  7808        MOVE BI-HD6                 TO BI-TEXT-LINE
  7809        PERFORM 3920-BILL-WRITE
  7810        MOVE SPACES                 TO BI-TEXT-LINE
  7811        MOVE ' '                    TO BI-SKIP-CONTROL
  7812        MOVE BI-HD7                 TO BI-TEXT-LINE
  7813        PERFORM 3920-BILL-WRITE
  7814
  7815        PERFORM 3600-FIND-BATCH-NUMBER THRU 3699-EXIT
  7816          VARYING PINDX FROM 1 BY 1
  7817            UNTIL PINDX > +6.
  7818
  7819     MOVE ZEROS                  TO PI-PREM     (PINDX)
  7820                                    PI-COMM     (PINDX)
  7821                                    PI-NON-PREM (PINDX)
  7822                                    PI-NON-COMM (PINDX).
  7823
  7824     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL640.cbl
  7826
  7827 3500-TOTAL-OUT-DETAIL.
  7828     IF PI-DATA-BILLED AND
  7829        RETURNED-FROM = SPACES
  7830           NEXT SENTENCE
  7831       ELSE
  7832           GO TO 3599-EXIT.
  7833
  7834     IF PI-UPDATE-FILES  OR
  7835        (PI-PREVIEW AND APRODSWI = 'Y')
  7836           NEXT SENTENCE
  7837        ELSE
  7838           GO TO 3599-EXIT.
  7839
  7840     MOVE SPACES                 TO BI-TEXT-LINE.
  7841*    MOVE '3'                    TO BI-RECORD-TYPE.
  7842*    MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7843*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7844*    MOVE PI-LIFE-OVERRIDE-L6    TO BI-OVERRIDE-L6.
  7845*    MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM.
  7846*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7847*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7848*    PERFORM 3920-BILL-WRITE.
  7849*
  7850*    MOVE SPACES                 TO BI-TEXT-LINE.
  7851*    MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7852*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7853*    MOVE PI-AH-OVERRIDE-L6      TO BI-OVERRIDE-L6.
  7854*    MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7855*    MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7856*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7857*    PERFORM 3920-BILL-WRITE.
  7858
  7859     MOVE SPACES                 TO BI-TEXT-LINE.
  7860     MOVE '3'                    TO BI-RECORD-TYPE.
  7861     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7862     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7863     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7864     ADD TOT-REPT-LF-REF TOT-REPT-LF-PREM
  7865          GIVING BI-TOT-PREM
  7866     ADD TOT-REPT-LF-COMP TOT-REPT-LF-COMP-R
  7867          GIVING BI-COM-TOT
  7868*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7869*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7870     PERFORM 3920-BILL-WRITE.
  7871
  7872     MOVE SPACES                 TO BI-TEXT-LINE.
  7873     MOVE '3'                    TO BI-RECORD-TYPE.
  7874     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7875     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7876     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7877     MOVE TOT-REPT-LF-REF        TO BI-TOT-PREM.
  7878     MOVE TOT-REPT-LF-COMP-R     TO BI-COM-TOT
  7879     PERFORM 3920-BILL-WRITE.
  7880
  7881     MOVE SPACES                 TO BI-TEXT-LINE.
  7882     MOVE '3'                    TO BI-RECORD-TYPE.
  7883     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL640.cbl
  7884     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7885     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7886     MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM
  7887     MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT
  7888     MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7889     PERFORM 3920-BILL-WRITE.
  7890
  7891     MOVE SPACES                 TO BI-TEXT-LINE.
  7892     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7893     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7894     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7895     ADD TOT-REPT-AH-REF TOT-REPT-AH-PREM
  7896          GIVING BI-TOT-PREM
  7897     ADD TOT-REPT-AH-COMP TOT-REPT-AH-COMP-R
  7898          GIVING BI-COM-TOT
  7899*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7900     PERFORM 3920-BILL-WRITE.
  7901
  7902     MOVE SPACES                 TO BI-TEXT-LINE.
  7903     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7904     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7905     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7906     MOVE TOT-REPT-AH-REF        TO BI-TOT-PREM
  7907     MOVE TOT-REPT-AH-COMP-R     TO BI-COM-TOT.
  7908     PERFORM 3920-BILL-WRITE.
  7909
  7910     MOVE SPACES                 TO BI-TEXT-LINE.
  7911     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7912     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7913     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7914     MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7915     MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7916     MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7917     PERFORM 3920-BILL-WRITE.
  7918
  7919     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7920         MOVE ZEROS  TO  PB-CI-CANCEL-FEE.
  7921
  7922     IF PB-CI-CANCEL-FEE > ZEROS
  7923         MOVE SPACES                 TO BI-TEXT-LINE
  7924         MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL
  7925         MOVE 'TOTAL'                TO BI-TOT-LIT
  7926         MOVE 'CAN-FE'               TO BI-OVERRIDE-L6
  7927         MOVE TOT-REPT-CANCEL-FEE    TO BI-TOT-PREM
  7928                                        BI-COM-TOT
  7929         MOVE ZEROS                  TO BI-FACE-TOT
  7930         PERFORM 3920-BILL-WRITE.
  7931
  7932     MOVE SPACES                 TO BI-TEXT-LINE.
  7933     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7934     PERFORM 3920-BILL-WRITE.
  7935
  7936 3599-EXIT.
  7937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL640.cbl
  7939
  7940 3600-FIND-BATCH-NUMBER.
  7941     IF PI-PREM (PINDX) NOT NUMERIC
  7942        MOVE ZEROS               TO PI-PREM (PINDX).
  7943     IF PI-COMM (PINDX) NOT NUMERIC
  7944        MOVE ZEROS               TO PI-COMM (PINDX).
  7945     IF PI-NON-PREM (PINDX) NOT NUMERIC
  7946        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  7947     IF PI-NON-COMM (PINDX) NOT NUMERIC
  7948        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  7949
  7950     IF PI-PREM (PINDX)     = ZEROS   AND
  7951        PI-COMM (PINDX)     = ZEROS   AND
  7952        PI-NON-PREM (PINDX) = ZEROS   AND
  7953        PI-NON-COMM (PINDX) = ZEROS
  7954          GO TO 3699-EXIT.
  7955
  7956     MOVE SPACES                 TO BI-TEXT-LINE.
  7957     MOVE '3'                    TO BI-RECORD-TYPE.
  7958     MOVE ' '                    TO BI-SKIP-CONTROL.
  7959     MOVE 'BATCH NO. '           TO WS-BATCH-DESC.
  7960     MOVE PI-BATCH (PINDX)       TO WS-BATCH-NBR.
  7961     MOVE WS-DESC                TO BI-TOT-DESC5.
  7962     MOVE PI-PREM (PINDX)        TO BI-TOT-PREM5.
  7963     MOVE PI-COMM (PINDX)        TO BI-COM-TOT5.
  7964     MOVE PI-NON-PREM (PINDX)    TO BI-NON-PREM5.
  7965     MOVE PI-NON-COMM (PINDX)    TO BI-NON-COMM5.
  7966     PERFORM 3920-BILL-WRITE.
  7967
  7968 3699-EXIT.
  7969     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL640.cbl
  7971
  7972 3910-BILL-GETMAIN.
  7973
  7974* EXEC CICS GETMAIN
  7975*        SET     (ADDRESS OF BILLING-STATEMENT)
  7976*        LENGTH  (210)
  7977*        INITIMG (GETMAIN-SPACE)
  7978*    END-EXEC.
  7979     MOVE 210
  7980       TO DFHEIV11
  7981*    MOVE ',"IL                  $   #00007849' TO DFHEIV0
  7982     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7983     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7984     MOVE X'2020233030303037383439' TO DFHEIV0(25:11)
  7985     CALL 'kxdfhei1' USING DFHEIV0,
  7986           DFHEIV20,
  7987           DFHEIV11,
  7988           GETMAIN-SPACE
  7989     SET ADDRESS OF BILLING-STATEMENT TO
  7990         DFHEIV20
  7991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7992
  7993
  7994 3920-BILL-WRITE.
  7995     MOVE PI-COMPANY-CD          TO BI-COMPANY-CD.
  7996     MOVE PI-CR-CARRIER          TO BI-CARRIER.
  7997     MOVE PI-CR-GROUPING         TO BI-GROUPING
  7998     MOVE PI-SAV-ACCT            TO BI-ACCOUNT.
  7999     MOVE PI-SAV-REMIT-TO        TO BI-FIN-RESP.
  8000
  8001     MOVE 'BI'                   TO BI-RECORD-ID.
  8002     ADD +1                      TO WS-LINE-SEQ-NO.
  8003
  8004     IF BI-RECORD-TYPE = '1'
  8005         MOVE ZEROS              TO BI-LINE-SEQ-NO
  8006     ELSE
  8007         MOVE WS-LINE-SEQ-NO     TO BI-LINE-SEQ-NO.
  8008
  8009
  8010* EXEC CICS WRITE
  8011*        DATASET (ERBILL-FILE-ID)
  8012*        FROM    (BILLING-STATEMENT)
  8013*        RIDFLD  (BI-CONTROL-PRIMARY)
  8014*    END-EXEC.
  8015     MOVE LENGTH OF
  8016      BILLING-STATEMENT
  8017       TO DFHEIV11
  8018*    MOVE '&$ L                  ''   #00007870' TO DFHEIV0
  8019     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8020     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8021     MOVE X'2020233030303037383730' TO DFHEIV0(25:11)
  8022     CALL 'kxdfhei1' USING DFHEIV0,
  8023           ERBILL-FILE-ID,
  8024           BILLING-STATEMENT,
  8025           DFHEIV11,
  8026           BI-CONTROL-PRIMARY,
  8027           DFHEIV99,
  8028           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL640.cbl
  8029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8030
  8031
  8032 3930-BILL-READ.
  8033     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8034     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8035     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8036     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8037     MOVE PI-SAV-REMIT-TO        TO ERBILL-FIN-RESP.
  8038     MOVE '1'                    TO ERBILL-REC-TYPE.
  8039     MOVE ZEROS                  TO ERBILL-LINE-SEQ-NO.
  8040
  8041
  8042* EXEC CICS HANDLE CONDITION
  8043*        NOTFND  (3930-BILL-NOTFND)
  8044*        NOTOPEN (3930-BILL-NOTOPEN)
  8045*    END-EXEC.
  8046*    MOVE '"$IJ                  ! $ #00007885' TO DFHEIV0
  8047     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8049     MOVE X'2420233030303037383835' TO DFHEIV0(25:11)
  8050     CALL 'kxdfhei1' USING DFHEIV0
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054
  8055* EXEC CICS READ
  8056*        SET     (ADDRESS OF BILLING-STATEMENT)
  8057*        DATASET (ERBILL-FILE-ID)
  8058*        RIDFLD  (ERBILL-KEY)
  8059*        GTEQ
  8060*    END-EXEC.
  8061*    MOVE '&"S        G          (   #00007890' TO DFHEIV0
  8062     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8063     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8064     MOVE X'2020233030303037383930' TO DFHEIV0(25:11)
  8065     CALL 'kxdfhei1' USING DFHEIV0,
  8066           ERBILL-FILE-ID,
  8067           DFHEIV20,
  8068           DFHEIV99,
  8069           ERBILL-KEY,
  8070           DFHEIV99,
  8071           DFHEIV99,
  8072           DFHEIV99
  8073     SET ADDRESS OF BILLING-STATEMENT TO
  8074         DFHEIV20
  8075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8076
  8077
  8078     IF BI-COMPANY-CD = PI-COMPANY-CD  AND
  8079        BI-CARRIER    = ERBILL-CARRIER AND
  8080        BI-GROUPING   = ERBILL-GROUP   AND
  8081        BI-ACCOUNT    = ERBILL-ACCT    AND
  8082        BI-FIN-RESP   = ERBILL-FIN-RESP
  8083          MOVE SPACE              TO NO-BILL-REC-SW
  8084          GO TO 3930-EXIT
  8085      ELSE
  8086          GO TO 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL640.cbl
  8087
  8088 3930-BILL-NOTOPEN.
  8089     MOVE ER-2564                TO EMI-ERROR.
  8090     MOVE -1 TO APFNTERL.
  8091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8092     GO TO 8200-SEND-DATAONLY.
  8093
  8094 3930-BILL-NOTFND.
  8095     MOVE 'Y'                    TO NO-BILL-REC-SW.
  8096
  8097 3930-EXIT.
  8098     EXIT.
  8099
  8100 3940-BILL-GENERIC-DELETE.
  8101
  8102* EXEC CICS HANDLE CONDITION
  8103*        NOTFND (3940-EXIT)
  8104*    END-EXEC.
  8105*    MOVE '"$I                   ! % #00007920' TO DFHEIV0
  8106     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8108     MOVE X'2520233030303037393230' TO DFHEIV0(25:11)
  8109     CALL 'kxdfhei1' USING DFHEIV0
  8110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8111
  8112
  8113     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8114     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8115     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8116     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8117
  8118     IF ST-ACCNT-CNTL OR ACCNT-CNTL
  8119        MOVE ZEROS               TO ERBILL-CARRIER
  8120                                    ERBILL-GROUP.
  8121
  8122     IF CARR-ST-ACCNT-CNTL OR CARR-ACCNT-CNTL
  8123        MOVE ZEROS               TO ERBILL-GROUP.
  8124
  8125
  8126* EXEC CICS DELETE
  8127*        DATASET   (ERBILL-FILE-ID)
  8128*        RIDFLD    (ERBILL-KEY)
  8129*        KEYLENGTH (18)
  8130*        GENERIC
  8131*    END-EXEC.
  8132     MOVE 18
  8133       TO DFHEIV11
  8134*    MOVE '&(  RKG               &   #00007936' TO DFHEIV0
  8135     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8136     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8137     MOVE X'2020233030303037393336' TO DFHEIV0(25:11)
  8138     CALL 'kxdfhei1' USING DFHEIV0,
  8139           ERBILL-FILE-ID,
  8140           ERBILL-KEY,
  8141           DFHEIV11,
  8142           DFHEIV99,
  8143           DFHEIV99
  8144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL640.cbl
  8145
  8146
  8147 3940-EXIT.
  8148     EXIT.
  8149
  8150 3990-EXIT.
  8151     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL640.cbl
  8153******************************************************************
  8154*                                                                *
  8155*   ALL I/O FOR THE VARIOUS FILES OTHER THAN THE COMPENSATION    *
  8156*   MASTER IS DONE IN THE FOLLOWING SECTIONS BEGINNING WITH 4XXX *
  8157*   WERE THE XXX INDICATES NUMERIC VALUES.                       *
  8158*                                                                *
  8159******************************************************************
  8160 4000-PNDB-START-BROWSE.
  8161     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD-A1.
  8162     MOVE PI-SAV-CARR            TO ERPNDB-CARR
  8163     MOVE PI-SAV-GROUP           TO ERPNDB-GROUP.
  8164     MOVE PI-SAV-STATE           TO ERPNDB-STATE.
  8165     MOVE PI-SAV-ACCT            TO ERPNDB-ACCT.
  8166     MOVE LOW-VALUES             TO ERPNDB-CERT.
  8167
  8168
  8169* EXEC CICS HANDLE CONDITION
  8170*        NOTFND (4010-REC-NOT-FND)
  8171*    END-EXEC.
  8172*    MOVE '"$I                   ! & #00007964' TO DFHEIV0
  8173     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8175     MOVE X'2620233030303037393634' TO DFHEIV0(25:11)
  8176     CALL 'kxdfhei1' USING DFHEIV0
  8177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8178
  8179
  8180
  8181* EXEC CICS STARTBR
  8182*        DATASET(ERPNDB-ALT-FILE-ID)
  8183*        RIDFLD (ERPNDB-ALT-KEY)
  8184*        GTEQ
  8185*    END-EXEC.
  8186     MOVE 0
  8187       TO DFHEIV11
  8188*    MOVE '&,         G          &   #00007968' TO DFHEIV0
  8189     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8190     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8191     MOVE X'2020233030303037393638' TO DFHEIV0(25:11)
  8192     CALL 'kxdfhei1' USING DFHEIV0,
  8193           ERPNDB-ALT-FILE-ID,
  8194           ERPNDB-ALT-KEY,
  8195           DFHEIV99,
  8196           DFHEIV11,
  8197           DFHEIV99
  8198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8199
  8200
  8201     GO TO 4090-EXIT.
  8202
  8203 4010-REC-NOT-FND.
  8204     MOVE 'Y'                    TO PNDB-EOF-SW.
  8205
  8206 4090-EXIT.
  8207     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL640.cbl
  8209 4100-PNDB-READ-NEXT.
  8210
  8211* EXEC CICS HANDLE CONDITION
  8212*        ENDFILE (4110-END-OF-FILE)
  8213*    END-EXEC.
  8214*    MOVE '"$''                   ! '' #00007983' TO DFHEIV0
  8215     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8217     MOVE X'2720233030303037393833' TO DFHEIV0(25:11)
  8218     CALL 'kxdfhei1' USING DFHEIV0
  8219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8220
  8221
  8222
  8223* EXEC CICS READNEXT
  8224*        SET     (ADDRESS OF PENDING-BUSINESS)
  8225*        DATASET (ERPNDB-ALT-FILE-ID)
  8226*        RIDFLD  (ERPNDB-ALT-KEY)
  8227*    END-EXEC.
  8228     MOVE 0
  8229       TO DFHEIV11
  8230*    MOVE '&.S                   )   #00007987' TO DFHEIV0
  8231     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8232     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8233     MOVE X'2020233030303037393837' TO DFHEIV0(25:11)
  8234     CALL 'kxdfhei1' USING DFHEIV0,
  8235           ERPNDB-ALT-FILE-ID,
  8236           DFHEIV20,
  8237           DFHEIV99,
  8238           ERPNDB-ALT-KEY,
  8239           DFHEIV99,
  8240           DFHEIV11,
  8241           DFHEIV99,
  8242           DFHEIV99
  8243     SET ADDRESS OF PENDING-BUSINESS TO
  8244         DFHEIV20
  8245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8246
  8247
  8248     GO TO 4190-EXIT.
  8249
  8250 4110-END-OF-FILE.
  8251     MOVE 'Y'                    TO PNDB-EOF-SW.
  8252
  8253 4190-EXIT.
  8254     EXIT.
  8255
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL640.cbl
  8257 4200-PNDB-REWRITE.
  8258     MOVE PB-COMPANY-CD          TO ERPNDB-CO-CD.
  8259     MOVE PB-ENTRY-BATCH         TO ERPNDB-BATCH.
  8260     MOVE PB-BATCH-SEQ-NO        TO ERPNDB-SEQ-NO.
  8261     MOVE PB-BATCH-CHG-SEQ-NO    TO ERPNDB-CHG-SEQ-NO.
  8262
  8263
  8264* EXEC CICS ENDBR
  8265*        DATASET (ERPNDB-ALT-FILE-ID)
  8266*    END-EXEC.
  8267     MOVE 0
  8268       TO DFHEIV11
  8269*    MOVE '&2                    $   #00008008' TO DFHEIV0
  8270     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8272     MOVE X'2020233030303038303038' TO DFHEIV0(25:11)
  8273     CALL 'kxdfhei1' USING DFHEIV0,
  8274           ERPNDB-ALT-FILE-ID,
  8275           DFHEIV11,
  8276           DFHEIV99
  8277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8278
  8279
  8280
  8281* EXEC CICS HANDLE CONDITION
  8282*        NOTFND   (4270-PNDB-NOTFIND)
  8283*        NOTOPEN  (4280-PNDB-FILE-NOTOPEN)
  8284*    END-EXEC.
  8285*    MOVE '"$IJ                  ! ( #00008012' TO DFHEIV0
  8286     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8288     MOVE X'2820233030303038303132' TO DFHEIV0(25:11)
  8289     CALL 'kxdfhei1' USING DFHEIV0
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8291
  8292
  8293
  8294* EXEC CICS READ
  8295*        SET     (ADDRESS OF PENDING-BUSINESS)
  8296*        DATASET (ERPNDB-FILE-ID)
  8297*        RIDFLD  (ERPNDB-PRIME-KEY)
  8298*        UPDATE
  8299*    END-EXEC.
  8300*    MOVE '&"S        EU         (   #00008017' TO DFHEIV0
  8301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8302     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8303     MOVE X'2020233030303038303137' TO DFHEIV0(25:11)
  8304     CALL 'kxdfhei1' USING DFHEIV0,
  8305           ERPNDB-FILE-ID,
  8306           DFHEIV20,
  8307           DFHEIV99,
  8308           ERPNDB-PRIME-KEY,
  8309           DFHEIV99,
  8310           DFHEIV99,
  8311           DFHEIV99
  8312     SET ADDRESS OF PENDING-BUSINESS TO
  8313         DFHEIV20
  8314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL640.cbl
  8315
  8316
  8317     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  8318         MOVE 'R'                TO PB-BILLING-STATUS.
  8319
  8320     IF PI-VOID-BILL
  8321         MOVE LOW-VALUES         TO PB-BILLED-DT
  8322         MOVE ZEROS              TO PB-CHG-COUNT
  8323     ELSE
  8324         MOVE WS-CURRENT-DATE    TO PB-BILLED-DT.
  8325
  8326     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8327     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8328     MOVE WS-CURRENT-DATE        TO PB-LAST-MAINT-DT.
  8329
  8330
  8331* EXEC CICS REWRITE
  8332*        DATASET (ERPNDB-FILE-ID)
  8333*        FROM    (PENDING-BUSINESS)
  8334*    END-EXEC.
  8335     MOVE LENGTH OF
  8336      PENDING-BUSINESS
  8337       TO DFHEIV11
  8338*    MOVE '&& L                  %   #00008037' TO DFHEIV0
  8339     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8340     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8341     MOVE X'2020233030303038303337' TO DFHEIV0(25:11)
  8342     CALL 'kxdfhei1' USING DFHEIV0,
  8343           ERPNDB-FILE-ID,
  8344           PENDING-BUSINESS,
  8345           DFHEIV11,
  8346           DFHEIV99
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8348
  8349
  8350
  8351* EXEC CICS STARTBR
  8352*        DATASET (ERPNDB-ALT-FILE-ID)
  8353*        RIDFLD  (ERPNDB-ALT-KEY)
  8354*        GTEQ
  8355*    END-EXEC.
  8356     MOVE 0
  8357       TO DFHEIV11
  8358*    MOVE '&,         G          &   #00008042' TO DFHEIV0
  8359     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8361     MOVE X'2020233030303038303432' TO DFHEIV0(25:11)
  8362     CALL 'kxdfhei1' USING DFHEIV0,
  8363           ERPNDB-ALT-FILE-ID,
  8364           ERPNDB-ALT-KEY,
  8365           DFHEIV99,
  8366           DFHEIV11,
  8367           DFHEIV99
  8368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8369
  8370
  8371     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  8372
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL640.cbl
  8373     GO TO 4290-EXIT.
  8374
  8375 4270-PNDB-NOTFIND.
  8376     MOVE ER-2212                TO EMI-ERROR.
  8377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8378     GO TO 4290-EXIT.
  8379
  8380 4280-PNDB-FILE-NOTOPEN.
  8381     MOVE -1                     TO ACARIERL.
  8382     MOVE ER-2210                TO EMI-ERROR.
  8383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8384
  8385 4290-EXIT.
  8386     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL640.cbl
  8388 4300-READ-ACCOUNT-MASTER.
  8389     MOVE PI-COMPANY-CD          TO ERACCT-A-CO-CD.
  8390     MOVE PI-SAV-CARR            TO ERACCT-A-CARRIER.
  8391     MOVE PI-SAV-GROUP           TO ERACCT-A-GROUPING.
  8392     MOVE PI-SAV-STATE           TO ERACCT-A-STATE.
  8393     MOVE PI-SAV-ACCT            TO ERACCT-A-ACCOUNT.
  8394     MOVE PI-SAV-EXP-DT          TO ERACCT-A-EXP-DATE.
  8395
  8396     MOVE SPACES                 TO WS-AM-ZIP.
  8397
  8398
  8399* EXEC CICS HANDLE CONDITION
  8400*        NOTFND   (4370-ACCOUNT-INVALID)
  8401*        NOTOPEN  (4380-ACCT-FILE-NOTOPEN)
  8402*    END-EXEC.
  8403*    MOVE '"$IJ                  ! ) #00008075' TO DFHEIV0
  8404     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8406     MOVE X'2920233030303038303735' TO DFHEIV0(25:11)
  8407     CALL 'kxdfhei1' USING DFHEIV0
  8408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8409
  8410
  8411
  8412* EXEC CICS READ
  8413*        DATASET   (ERACCT-ALT-FILE-ID)
  8414*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8415*        RIDFLD    (ERACCT-ALT-KEY)
  8416*        GTEQ
  8417*    END-EXEC.
  8418*    MOVE '&"S        G          (   #00008080' TO DFHEIV0
  8419     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8421     MOVE X'2020233030303038303830' TO DFHEIV0(25:11)
  8422     CALL 'kxdfhei1' USING DFHEIV0,
  8423           ERACCT-ALT-FILE-ID,
  8424           DFHEIV20,
  8425           DFHEIV99,
  8426           ERACCT-ALT-KEY,
  8427           DFHEIV99,
  8428           DFHEIV99,
  8429           DFHEIV99
  8430     SET ADDRESS OF ACCOUNT-MASTER TO
  8431         DFHEIV20
  8432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8433
  8434
  8435     IF AM-CANADIAN-POST-CODE
  8436         MOVE AM-CAN-POSTAL-1    TO WS-AM-CAN-POST-1
  8437         MOVE AM-CAN-POSTAL-2    TO WS-AM-CAN-POST-2
  8438     ELSE
  8439         MOVE AM-ZIP-PRIME       TO WS-AM-ZIP-PRIME
  8440         IF AM-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  8441             MOVE '-'            TO WS-AM-ZIP-DASH
  8442             MOVE AM-ZIP-PLUS4   TO WS-AM-ZIP-PLUS4.
  8443
  8444     IF AM-REMIT-TO NOT NUMERIC
  8445         MOVE +00 TO AM-REMIT-TO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL640.cbl
  8446
  8447     IF AM-REMIT-TO = ZEROS
  8448         MOVE ER-2385            TO EMI-ERROR
  8449         MOVE -1                 TO AACCTL
  8450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8451
  8452     MOVE AM-CARRIER             TO PI-CARRIER.
  8453     MOVE AM-GROUPING            TO PI-GROUPING.
  8454     MOVE AM-STATE               TO PI-STATE.
  8455     MOVE AM-ACCOUNT             TO PI-ACCOUNT.
  8456
  8457     MOVE AM-AGT (AM-REMIT-TO)   TO PI-COMP-FIN-RESP.
  8458
  8459     IF PI-ZERO-CARRIER  OR
  8460        PI-ZERO-CAR-GROUP
  8461         MOVE ZEROS              TO PI-COMP-CARRIER
  8462     ELSE
  8463         MOVE AM-CARRIER         TO PI-COMP-CARRIER.
  8464
  8465     IF PI-ZERO-GROUPING  OR
  8466        PI-ZERO-CAR-GROUP
  8467         MOVE ZEROS              TO PI-COMP-GROUPING
  8468     ELSE
  8469         MOVE AM-GROUPING        TO PI-COMP-GROUPING.
  8470
  8471     IF CARR-GROUP-ST-ACCNT-CNTL
  8472         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8473         MOVE AM-GROUPING        TO PI-CR-GROUPING
  8474         MOVE AM-STATE           TO PI-CR-STATE.
  8475
  8476     IF ST-ACCNT-CNTL
  8477         MOVE ZEROS              TO PI-CR-CARRIER
  8478                                    PI-CR-GROUPING
  8479         MOVE AM-STATE           TO PI-CR-STATE.
  8480
  8481     IF CARR-ST-ACCNT-CNTL
  8482         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8483         MOVE ZEROS              TO PI-CR-GROUPING
  8484         MOVE AM-STATE           TO PI-CR-STATE.
  8485
  8486     IF ACCNT-CNTL
  8487         MOVE ZEROS              TO PI-CR-CARRIER
  8488                                    PI-CR-GROUPING
  8489                                    PI-CR-STATE.
  8490
  8491     IF CARR-ACCNT-CNTL
  8492         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8493         MOVE ZEROS              TO PI-CR-GROUPING
  8494                                    PI-CR-STATE.
  8495
  8496     MOVE AM-EXPIRATION-DT       TO ERACCT-A-EXP-DATE.
  8497
  8498     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8499         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8500     ELSE
  8501         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8502
  8503     IF PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL640.cbl
  8504         MOVE AM-EXPIRATION-DT   TO WS-SAV-EXP-DT (DTNDX)
  8505         IF DTNDX < 10
  8506             SET DTNDX UP BY 1
  8507             GO TO 4390-EXIT
  8508         ELSE
  8509             GO TO 4390-EXIT.
  8510
  8511     IF PI-COMPANY-CD = AM-COMPANY-CD-A1 AND
  8512        PI-SAV-CARR   = AM-VG-CARRIER    AND
  8513        PI-SAV-GROUP  = AM-VG-GROUPING   AND
  8514        PI-SAV-STATE  = AM-VG-STATE      AND
  8515        PI-SAV-ACCT   = AM-VG-ACCOUNT
  8516          NEXT SENTENCE
  8517     ELSE
  8518          GO TO 4370-ACCOUNT-INVALID.
  8519
  8520     IF PI-GA-BILLING
  8521         NEXT SENTENCE
  8522     ELSE
  8523         GO TO 4390-EXIT.
  8524
  8525     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8526         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8527     ELSE
  8528         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8529
  8530     GO TO 4390-EXIT.
  8531
  8532 4370-ACCOUNT-INVALID.
  8533     MOVE -1                     TO AACCTL.
  8534
  8535     MOVE SPACES                 TO PI-CARRIER
  8536                                    PI-GROUPING
  8537                                    PI-STATE
  8538                                    PI-ACCOUNT.
  8539
  8540     IF CARR-GROUP-ST-ACCNT-CNTL
  8541         MOVE AL-UABON           TO ACARIERA
  8542                                    AGROUPA
  8543                                    ASTATEA
  8544                                    AACCTA
  8545     ELSE
  8546         IF ST-ACCNT-CNTL
  8547             MOVE AL-UABON       TO ASTATEA
  8548                                    AACCTA
  8549         ELSE
  8550             IF CARR-ST-ACCNT-CNTL
  8551                 MOVE AL-UABON   TO ACARIERA
  8552                                    ASTATEA
  8553                                    AACCTA
  8554             ELSE
  8555                 IF ACCNT-CNTL
  8556                     MOVE AL-UABON
  8557                                 TO AACCTA
  8558                 ELSE
  8559                     MOVE AL-UABON
  8560                                 TO ACARIERA
  8561                                    AACCTA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL640.cbl
  8562
  8563     MOVE ER-2210                TO EMI-ERROR.
  8564     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8565     GO TO 4390-EXIT.
  8566
  8567 4380-ACCT-FILE-NOTOPEN.
  8568     MOVE -1                     TO ACARIERL.
  8569     MOVE ER-2215                TO EMI-ERROR.
  8570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8571
  8572 4390-EXIT.
  8573     EXIT.
  8574
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL640.cbl
  8576 4400-ERACCT-REWRITE.
  8577     IF NOT PI-VOID-BILL
  8578         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8579         MOVE AM-COMPANY-CD      TO ERACCT-P-CO-CD
  8580         MOVE AM-CARRIER         TO ERACCT-P-CARRIER
  8581         MOVE AM-GROUPING        TO ERACCT-P-GROUPING
  8582         MOVE AM-STATE           TO ERACCT-P-STATE
  8583         MOVE AM-ACCOUNT         TO ERACCT-P-ACCOUNT
  8584         MOVE AM-EXPIRATION-DT   TO ERACCT-P-EXP-DATE
  8585     ELSE
  8586         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8587         MOVE PI-COMPANY-CD      TO ERACCT-P-CO-CD
  8588         MOVE PI-CARRIER         TO ERACCT-P-CARRIER
  8589         MOVE PI-GROUPING        TO ERACCT-P-GROUPING
  8590         MOVE PI-STATE           TO ERACCT-P-STATE
  8591         MOVE PI-SAV-ACCT        TO ERACCT-P-ACCOUNT
  8592         MOVE PI-SAV-EXP-DT      TO ERACCT-P-EXP-DATE.
  8593
  8594
  8595* EXEC CICS HANDLE CONDITION
  8596*        NOTFND   (4470-ACCOUNT-INVALID)
  8597*        NOTOPEN  (4480-ACCT-FILE-NOTOPEN)
  8598*    END-EXEC.
  8599*    MOVE '"$IJ                  ! * #00008246' TO DFHEIV0
  8600     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8602     MOVE X'2A20233030303038323436' TO DFHEIV0(25:11)
  8603     CALL 'kxdfhei1' USING DFHEIV0
  8604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8605
  8606
  8607
  8608* EXEC CICS READ
  8609*        DATASET   (ERACCT-FILE-ID)
  8610*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8611*        RIDFLD    (ERACCT-PRIME-KEY)
  8612*        UPDATE
  8613*    END-EXEC.
  8614*    MOVE '&"S        EU         (   #00008251' TO DFHEIV0
  8615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8616     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8617     MOVE X'2020233030303038323531' TO DFHEIV0(25:11)
  8618     CALL 'kxdfhei1' USING DFHEIV0,
  8619           ERACCT-FILE-ID,
  8620           DFHEIV20,
  8621           DFHEIV99,
  8622           ERACCT-PRIME-KEY,
  8623           DFHEIV99,
  8624           DFHEIV99,
  8625           DFHEIV99
  8626     SET ADDRESS OF ACCOUNT-MASTER TO
  8627         DFHEIV20
  8628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8629
  8630
  8631     IF PI-VOID-BILL
  8632         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO.
  8633
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL640.cbl
  8634     IF PI-VOID-BILL
  8635         MOVE SPACE              TO AM-BILLING-STATUS
  8636     ELSE
  8637         MOVE 'B'                TO AM-BILLING-STATUS.
  8638
  8639     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  8640     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  8641     MOVE WS-CURRENT-DATE        TO AM-LAST-MAINT-DT.
  8642
  8643
  8644* EXEC CICS REWRITE
  8645*        DATASET (ERACCT-FILE-ID)
  8646*        FROM    (ACCOUNT-MASTER)
  8647*    END-EXEC.
  8648     MOVE LENGTH OF
  8649      ACCOUNT-MASTER
  8650       TO DFHEIV11
  8651*    MOVE '&& L                  %   #00008270' TO DFHEIV0
  8652     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8653     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8654     MOVE X'2020233030303038323730' TO DFHEIV0(25:11)
  8655     CALL 'kxdfhei1' USING DFHEIV0,
  8656           ERACCT-FILE-ID,
  8657           ACCOUNT-MASTER,
  8658           DFHEIV11,
  8659           DFHEIV99
  8660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8661
  8662
  8663     GO TO 4490-EXIT.
  8664
  8665 4470-ACCOUNT-INVALID.
  8666     MOVE -1                     TO AACCTL.
  8667
  8668     MOVE SPACES                 TO PI-CARRIER
  8669                                    PI-GROUPING
  8670                                    PI-STATE
  8671                                    PI-ACCOUNT.
  8672
  8673     IF CARR-GROUP-ST-ACCNT-CNTL
  8674         MOVE AL-UABON           TO ACARIERA
  8675                                    AGROUPA
  8676                                    ASTATEA
  8677                                    AACCTA
  8678     ELSE
  8679         IF ST-ACCNT-CNTL
  8680             MOVE AL-UABON       TO ASTATEA
  8681                                    AACCTA
  8682         ELSE
  8683             IF CARR-ST-ACCNT-CNTL
  8684                 MOVE AL-UABON   TO ACARIERA
  8685                                    ASTATEA
  8686                                    AACCTA
  8687             ELSE
  8688                 IF ACCNT-CNTL
  8689                     MOVE AL-UABON
  8690                                 TO AACCTA
  8691                 ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL640.cbl
  8692                     MOVE AL-UABON
  8693                                 TO ACARIERA
  8694                                    AACCTA.
  8695
  8696     MOVE ER-2210                TO EMI-ERROR.
  8697     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8698     GO TO 4490-EXIT.
  8699
  8700 4480-ACCT-FILE-NOTOPEN.
  8701     MOVE -1                     TO ACARIERL.
  8702     MOVE ER-2215                TO EMI-ERROR.
  8703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8704
  8705 4490-EXIT.
  8706     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL640.cbl
  8708
  8709 4500-PYAJ-START-BROWSE.
  8710     MOVE PI-COMPANY-CD          TO ERPYAJ-COMP-CD.
  8711
  8712     IF NOT PI-ZERO-CARRIER  AND
  8713        NOT PI-ZERO-CAR-GROUP
  8714         MOVE PI-COMP-CARRIER    TO ERPYAJ-CARRIER
  8715     ELSE
  8716         MOVE ZEROS              TO ERPYAJ-CARRIER.
  8717
  8718     IF NOT PI-ZERO-GROUPING  AND
  8719        NOT PI-ZERO-CAR-GROUP
  8720         MOVE PI-COMP-GROUPING   TO ERPYAJ-GROUPING
  8721     ELSE
  8722         MOVE ZEROS              TO ERPYAJ-GROUPING.
  8723
  8724     MOVE PI-SAV-REMIT-TO        TO ERPYAJ-FIN-RESP.
  8725     MOVE PI-SAV-ACCT            TO ERPYAJ-ACCOUNT.
  8726
  8727     IF PI-SAV-REMIT-TO = SPACES
  8728         MOVE PI-SAV-ACCT        TO PI-SAV-REMIT-TO
  8729                                    ERPYAJ-FIN-RESP.
  8730
  8731     MOVE LOW-VALUES             TO ERPYAJ-RECORD-TYPE.
  8732     MOVE ERPYAJ-KEY             TO ERPYAJ-BROWSE-COMP-KEY.
  8733
  8734
  8735* EXEC CICS HANDLE CONDITION
  8736*        NOTFND (4510-REC-NOT-FND)
  8737*    END-EXEC.
  8738*    MOVE '"$I                   ! + #00008346' TO DFHEIV0
  8739     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8741     MOVE X'2B20233030303038333436' TO DFHEIV0(25:11)
  8742     CALL 'kxdfhei1' USING DFHEIV0
  8743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8744
  8745
  8746
  8747* EXEC CICS STARTBR
  8748*        DATASET(ERPYAJ-FILE-ID)
  8749*        RIDFLD (ERPYAJ-KEY)
  8750*        GTEQ
  8751*    END-EXEC.
  8752     MOVE 0
  8753       TO DFHEIV11
  8754*    MOVE '&,         G          &   #00008350' TO DFHEIV0
  8755     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8756     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8757     MOVE X'2020233030303038333530' TO DFHEIV0(25:11)
  8758     CALL 'kxdfhei1' USING DFHEIV0,
  8759           ERPYAJ-FILE-ID,
  8760           ERPYAJ-KEY,
  8761           DFHEIV99,
  8762           DFHEIV11,
  8763           DFHEIV99
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8765
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL640.cbl
  8766
  8767     GO TO 4590-EXIT.
  8768
  8769 4510-REC-NOT-FND.
  8770     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8771
  8772 4590-EXIT.
  8773     EXIT.
  8774
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL640.cbl
  8776 4600-PYAJ-READ-NEXT.
  8777
  8778* EXEC CICS HANDLE CONDITION
  8779*        ENDFILE (4610-END-OF-FILE)
  8780*    END-EXEC.
  8781*    MOVE '"$''                   ! , #00008366' TO DFHEIV0
  8782     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8784     MOVE X'2C20233030303038333636' TO DFHEIV0(25:11)
  8785     CALL 'kxdfhei1' USING DFHEIV0
  8786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8787
  8788
  8789
  8790* EXEC CICS READNEXT
  8791*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8792*        DATASET (ERPYAJ-FILE-ID)
  8793*        RIDFLD  (ERPYAJ-KEY)
  8794*    END-EXEC.
  8795     MOVE 0
  8796       TO DFHEIV11
  8797*    MOVE '&.S                   )   #00008370' TO DFHEIV0
  8798     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8799     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8800     MOVE X'2020233030303038333730' TO DFHEIV0(25:11)
  8801     CALL 'kxdfhei1' USING DFHEIV0,
  8802           ERPYAJ-FILE-ID,
  8803           DFHEIV20,
  8804           DFHEIV99,
  8805           ERPYAJ-KEY,
  8806           DFHEIV99,
  8807           DFHEIV11,
  8808           DFHEIV99,
  8809           DFHEIV99
  8810     SET ADDRESS OF PENDING-PAY-ADJ TO
  8811         DFHEIV20
  8812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8813
  8814
  8815     GO TO 4690-EXIT.
  8816
  8817 4610-END-OF-FILE.
  8818     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8819
  8820 4690-EXIT.
  8821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL640.cbl
  8823 4700-PYAJ-REWRITE.
  8824
  8825* EXEC CICS READ
  8826*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8827*        DATASET (ERPYAJ-FILE-ID)
  8828*        RIDFLD  (ERPYAJ-KEY)
  8829*        UPDATE
  8830*    END-EXEC.
  8831*    MOVE '&"S        EU         (   #00008385' TO DFHEIV0
  8832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8833     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8834     MOVE X'2020233030303038333835' TO DFHEIV0(25:11)
  8835     CALL 'kxdfhei1' USING DFHEIV0,
  8836           ERPYAJ-FILE-ID,
  8837           DFHEIV20,
  8838           DFHEIV99,
  8839           ERPYAJ-KEY,
  8840           DFHEIV99,
  8841           DFHEIV99,
  8842           DFHEIV99
  8843     SET ADDRESS OF PENDING-PAY-ADJ TO
  8844         DFHEIV20
  8845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8846
  8847
  8848     IF PI-VOID-BILL
  8849         MOVE LOW-VALUES         TO PY-BILLED-DATE
  8850                                    PY-AR-DATE
  8851         IF ACCOUNT-NOT-FIN-RESP
  8852             IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  8853                 PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  8854                 PY-ADD-TO-BALANCE
  8855                 ADD PY-ENTRY-AMT  TO  PI-REMITTED
  8856             ELSE
  8857                 IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  8858                    AND PY-BILLING-CHECK
  8859                    ADD PY-ENTRY-AMT TO PI-DISBURSED
  8860                 ELSE
  8861                     ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS
  8862         ELSE
  8863             NEXT SENTENCE
  8864     ELSE
  8865         MOVE WS-CURRENT-DATE    TO PY-BILLED-DATE.
  8866
  8867     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8868     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8869     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT.
  8870
  8871
  8872* EXEC CICS REWRITE
  8873*        DATASET (ERPYAJ-FILE-ID)
  8874*        FROM    (PENDING-PAY-ADJ)
  8875*    END-EXEC.
  8876     MOVE LENGTH OF
  8877      PENDING-PAY-ADJ
  8878       TO DFHEIV11
  8879*    MOVE '&& L                  %   #00008415' TO DFHEIV0
  8880     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL640.cbl
  8881     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8882     MOVE X'2020233030303038343135' TO DFHEIV0(25:11)
  8883     CALL 'kxdfhei1' USING DFHEIV0,
  8884           ERPYAJ-FILE-ID,
  8885           PENDING-PAY-ADJ,
  8886           DFHEIV11,
  8887           DFHEIV99
  8888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8889
  8890
  8891 4790-EXIT.
  8892     EXIT.
  8893
  8894 4800-PYAJ-END-BROWSE.
  8895
  8896* EXEC CICS ENDBR
  8897*        DATASET (ERPYAJ-FILE-ID)
  8898*    END-EXEC.
  8899     MOVE 0
  8900       TO DFHEIV11
  8901*    MOVE '&2                    $   #00008424' TO DFHEIV0
  8902     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8904     MOVE X'2020233030303038343234' TO DFHEIV0(25:11)
  8905     CALL 'kxdfhei1' USING DFHEIV0,
  8906           ERPYAJ-FILE-ID,
  8907           DFHEIV11,
  8908           DFHEIV99
  8909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8910
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL640.cbl
  8912 5000-FORMAT-SCREEN.
  8913*                **********************************************
  8914*                *  FORMAT THE BILLING TOTALS SCREEN (EL640A) *
  8915*                **********************************************
  8916     MOVE LOW-VALUES             TO EL640AO.
  8917
  8918     IF PI-SAV-ACCT > SPACES
  8919        MOVE PI-SAV-ACCT         TO AACCTO
  8920        MOVE PI-SAV-CARR         TO ACARIERO
  8921        MOVE PI-SAV-GROUP        TO AGROUPO
  8922        MOVE PI-SAV-STATE        TO ASTATEO.
  8923
  8924     MOVE PI-BILL-TYPE           TO ABILTYPI.
  8925     MOVE PI-BILL-ERRS           TO ABILERRI.
  8926     MOVE AL-UANON               TO AACCTA
  8927                                    ACARIERA
  8928                                    AGROUPA
  8929                                    ASTATEA
  8930                                    ABILTYPA
  8931                                    ABILERRA.
  8932
  8933     IF ACCOUNT-NOT-FIN-RESP
  8934         MOVE ER-2539            TO EMI-ERROR
  8935         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8936
  8937     IF PI-BILLING-BATCHES (1) NOT = SPACES
  8938         MOVE PI-BILLING-BATCHES (1) TO ABTCH1I
  8939         MOVE AL-UANON               TO ABTCH1A.
  8940
  8941     IF PI-BILLING-BATCHES (2) NOT = SPACES
  8942         MOVE PI-BILLING-BATCHES (2) TO ABTCH2I
  8943         MOVE AL-UANON               TO ABTCH2A.
  8944
  8945     IF PI-BILLING-BATCHES (3) NOT = SPACES
  8946         MOVE PI-BILLING-BATCHES (3) TO ABTCH3I
  8947         MOVE AL-UANON               TO ABTCH3A.
  8948
  8949     SET ANDX  PINDX            TO 1.
  8950
  8951 5005-FORMAT-LOOP.
  8952     IF PI-BATCH (PINDX) NOT = SPACES
  8953         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  8954         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  8955         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  8956         MOVE PI-PREV   (PINDX)  TO PREV   (ANDX)
  8957         SET ANDX PINDX UP BY 1
  8958         IF ANDX > 6
  8959             NEXT SENTENCE
  8960         ELSE
  8961             GO TO 5005-FORMAT-LOOP.
  8962
  8963     IF MORE-THAN-6-BATCHES
  8964         MOVE ER-2472            TO EMI-ERROR
  8965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8966         MOVE ZEROS              TO EMI-ERROR.
  8967
  8968     IF NOT PI-DATA-BILLED
  8969         IF RETURNED-FROM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL640.cbl
  8970             GO TO 5080-CONT
  8971         ELSE
  8972             MOVE ER-2409        TO EMI-ERROR
  8973             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8974             GO TO 5090-EXIT.
  8975
  8976     MOVE PI-BAL-FRWD            TO ABALFWDO.
  8977     MOVE PI-PREMIUM             TO APREMUMO.
  8978     MOVE PI-REMITTED            TO AREMITO.
  8979     MOVE PI-TOT-ISS-COMP        TO ACOMPISO.
  8980     MOVE PI-TOT-CAN-COMP        TO ACOMCANO.
  8981     COMPUTE PI-ADJUSTMENTS  =   PI-ADJUSTMENTS  +
  8982                                 TOT-REPT-CANCEL-FEE.
  8983     MOVE PI-ADJUSTMENTS         TO AADJUSTO.
  8984     MOVE PI-DISBURSED           TO ADISBURO.
  8985
  8986     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  8987                          PI-PREMIUM -
  8988                          PI-REMITTED -
  8989                          PI-TOT-ISS-COMP +
  8990                          PI-TOT-CAN-COMP +
  8991                          PI-ADJUSTMENTS +
  8992                          PI-DISBURSED.
  8993
  8994     MOVE PI-END-BAL             TO ANETDUEO.
  8995
  8996     IF PI-END-BAL NEGATIVE
  8997         MOVE OWED-TO-AGENT      TO AENDHDGO
  8998     ELSE
  8999         IF PI-END-BAL > ZERO
  9000             MOVE AGENT-OWES     TO AENDHDGO
  9001         ELSE
  9002             MOVE 'BALANCE          =' TO AENDHDGO.
  9003
  9004 5080-CONT.
  9005     IF RETURNED-FROM NOT = SPACES
  9006         IF (RETURNED-FROM NOT = XCTL-6401)  AND
  9007             (PI-CR-FIN-RESP NOT = SPACES)
  9008               MOVE ER-2421        TO EMI-ERROR
  9009               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9010               MOVE ZEROS          TO EMI-ERROR
  9011         ELSE
  9012             NEXT SENTENCE
  9013     ELSE
  9014         IF PI-BILL OR PI-REBILLING
  9015             MOVE 'Y'            TO COMP-UPDATE-SW
  9016             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9017             MOVE 'Y'            TO ELCNTL-UPDATE-SW
  9018             MOVE SPACES         TO ELCNTL-KEY
  9019             MOVE '1'            TO ELCNTL-REC-TYPE
  9020             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9021             MOVE WS-CURRENT-DATE TO CF-ACCOUNT-MSTR-MAINT-DT
  9022                                     CF-COMPENSATION-MSTR-MAINT-DT
  9023             PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT.
  9024
  9025 5090-EXIT.
  9026     EXIT.
  9027
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL640.cbl
  9029 6000-READ-COMP-MASTER.
  9030
  9031* EXEC CICS HANDLE CONDITION
  9032*        NOTFND   (6070-NO-COMP-MSTR)
  9033*        NOTOPEN  (6080-COMP-FILE-NOTOPEN)
  9034*    END-EXEC.
  9035*    MOVE '"$IJ                  ! - #00008546' TO DFHEIV0
  9036     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9038     MOVE X'2D20233030303038353436' TO DFHEIV0(25:11)
  9039     CALL 'kxdfhei1' USING DFHEIV0
  9040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9041
  9042
  9043     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9044     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9045     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9046     MOVE PI-COMP-FIN-RESP       TO ERCOMP-FIN-RESP.
  9047
  9048     MOVE SPACES                 TO WS-CO-ZIP.
  9049
  9050     IF EIBAID = DFHPF5
  9051         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9052         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9053     ELSE
  9054         MOVE PI-SAV-ACCT        TO ERCOMP-ACCT
  9055         MOVE 'A'                TO ERCOMP-RECORD-TYPE.
  9056
  9057 6001-READ.
  9058     IF UPDATE-COMP-TOTALS OR PI-VOID-BILL
  9059
  9060* EXEC CICS READ
  9061*            DATASET   (ERCOMP-FILE-ID)
  9062*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9063*            RIDFLD    (ERCOMP-KEY)
  9064*            UPDATE
  9065*        END-EXEC
  9066*    MOVE '&"S        EU         (   #00008567' TO DFHEIV0
  9067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9068     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9069     MOVE X'2020233030303038353637' TO DFHEIV0(25:11)
  9070     CALL 'kxdfhei1' USING DFHEIV0,
  9071           ERCOMP-FILE-ID,
  9072           DFHEIV20,
  9073           DFHEIV99,
  9074           ERCOMP-KEY,
  9075           DFHEIV99,
  9076           DFHEIV99,
  9077           DFHEIV99
  9078     SET ADDRESS OF COMPENSATION-MASTER TO
  9079         DFHEIV20
  9080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9081     ELSE
  9082
  9083* EXEC CICS READ
  9084*            DATASET   (ERCOMP-FILE-ID)
  9085*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9086*            RIDFLD    (ERCOMP-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL640.cbl
  9087*        END-EXEC.
  9088*    MOVE '&"S        E          (   #00008574' TO DFHEIV0
  9089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9091     MOVE X'2020233030303038353734' TO DFHEIV0(25:11)
  9092     CALL 'kxdfhei1' USING DFHEIV0,
  9093           ERCOMP-FILE-ID,
  9094           DFHEIV20,
  9095           DFHEIV99,
  9096           ERCOMP-KEY,
  9097           DFHEIV99,
  9098           DFHEIV99,
  9099           DFHEIV99
  9100     SET ADDRESS OF COMPENSATION-MASTER TO
  9101         DFHEIV20
  9102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9103
  9104
  9105     IF CO-CANADIAN-POST-CODE
  9106         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9107         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9108     ELSE
  9109         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9110         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9111             MOVE '-'            TO WS-CO-ZIP-DASH
  9112             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9113
  9114 6002-CONTINUE.
  9115     IF EIBAID = DFHPF5
  9116         GO TO 6090-EXIT.
  9117
  9118     IF FIRST-TIME
  9119        MOVE CO-MAIL-NAME        TO WS-ACCT-LINES (1)
  9120        MOVE CO-ACCT-NAME        TO WS-ACCT-LINES (2)
  9121        MOVE CO-ADDR-1           TO WS-ACCT-LINES (3)
  9122        MOVE CO-ADDR-2           TO WS-ACCT-LINES (4)
  9123        MOVE CO-ADDR-3           TO WS-ACCT-LINES (5)
  9124        MOVE WS-CO-ZIP           TO WS-ACCT-LINES (6)
  9125        PERFORM 6400-FORMAT-ACCOUNT-ADDRS THRU 6490-EXIT.
  9126
  9127     IF PI-VOID-BILL
  9128         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9129         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9130         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9131         IF ACCOUNT-FIN-RESP
  9132             MOVE CO-MONTHLY-TOTALS TO CO-CURRENT-MONTHLY-TOTALS
  9133             MOVE CO-AGING-TOTALS   TO CO-CURRENT-AGING-TOTALS
  9134             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9135             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9136             PERFORM 6060-ERCOMP-REWRITE
  9137             GO TO 6090-EXIT
  9138         ELSE
  9139             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9140             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9141             PERFORM 6060-ERCOMP-REWRITE
  9142             MOVE LOW-VALUES        TO ERCOMP-ACCT
  9143             MOVE 'G'               TO ERCOMP-RECORD-TYPE
  9144             PERFORM 6001-READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL640.cbl
  9145             COMPUTE CO-CURRENT-CUR-CHG =
  9146                     CO-CURRENT-CUR-CHG - PI-PREMIUM
  9147             COMPUTE CO-CURRENT-CUR-COM =
  9148                     CO-CURRENT-CUR-COM - PI-TOT-ISS-COMP -
  9149                     PI-TOT-CAN-COMP
  9150             COMPUTE CO-CURRENT-CUR-PMT =
  9151                     CO-CURRENT-CUR-PMT - PI-REMITTED +
  9152                     PI-DISBURSED + PI-ADJUSTMENTS
  9153             COMPUTE CO-CURRENT-END-BAL =
  9154                     CO-CURRENT-BAL-FWD + CO-CURRENT-CUR-CHG -
  9155                     CO-CURRENT-CUR-COM - CO-CURRENT-CUR-PMT
  9156             MOVE CO-AGING-TOTALS   TO  CO-CURRENT-AGING-TOTALS
  9157             PERFORM 6050-AGING  THRU  6059-AGING-EXIT
  9158             IF CO-CURRENT-CUR-CHG = ZEROS AND
  9159                CO-CURRENT-CUR-COM = ZEROS AND
  9160                CO-CURRENT-CUR-PMT = ZEROS
  9161                 MOVE CO-LAST-STMT-DT TO CO-CURRENT-LAST-STMT-DT
  9162                 PERFORM 6060-ERCOMP-REWRITE
  9163                 GO TO 6090-EXIT
  9164             ELSE
  9165                 PERFORM 6060-ERCOMP-REWRITE
  9166                 GO TO 6090-EXIT.
  9167
  9168     IF UPDATE-COMP-TOTALS
  9169         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9170         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9171         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9172         IF ACCOUNT-FIN-RESP
  9173             IF NOT PI-CHECK-PRODUCED
  9174                 IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9175                     MOVE CO-CURRENT-END-BAL
  9176                                 TO CO-CURRENT-BAL-FWD
  9177                     COMPUTE CO-CURRENT-CUR-COM =
  9178                             CO-CURRENT-CUR-COM +
  9179                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9180                     COMPUTE CO-CURRENT-YTD-COM =
  9181                             CO-CURRENT-YTD-COM +
  9182                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9183                     COMPUTE CO-CURRENT-CUR-CHG =
  9184                             CO-CURRENT-CUR-CHG + PI-PREMIUM
  9185                     COMPUTE CO-CURRENT-CUR-PMT =
  9186                             CO-CURRENT-CUR-PMT +
  9187                             PI-REMITTED - PI-DISBURSED -
  9188                             PI-ADJUSTMENTS
  9189                     COMPUTE CO-CURRENT-END-BAL =
  9190                             CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9191                             PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9192                             PI-REMITTED + PI-DISBURSED +
  9193                             PI-ADJUSTMENTS
  9194                     PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9195                     PERFORM 6060-ERCOMP-REWRITE
  9196                     GO TO 6090-EXIT
  9197                ELSE
  9198                    MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9199                    MOVE PI-END-BAL         TO CO-CURRENT-END-BAL
  9200                    COMPUTE CO-CURRENT-CUR-COM =
  9201                            PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9202                    ADD CO-CURRENT-CUR-COM TO CO-CURRENT-YTD-COM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL640.cbl
  9203                    MOVE PI-PREMIUM        TO CO-CURRENT-CUR-CHG
  9204                    COMPUTE CO-CURRENT-CUR-PMT =
  9205                             PI-REMITTED - PI-DISBURSED -
  9206                             PI-ADJUSTMENTS
  9207                    PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9208                    MOVE WS-MONTH-END-DATE
  9209                                 TO CO-CURRENT-LAST-STMT-DT
  9210                    PERFORM 6060-ERCOMP-REWRITE
  9211                    GO TO 6090-EXIT
  9212             ELSE
  9213                 MOVE SPACE      TO PI-CHECK-SW
  9214                 MOVE PI-END-BAL TO CO-CURRENT-END-BAL
  9215                 COMPUTE CO-CURRENT-CUR-CHG = PI-PREMIUM +
  9216                         (PI-ADJUSTMENTS - PI-DISBURSED)
  9217                 PERFORM 6060-ERCOMP-REWRITE
  9218                 GO TO 6090-EXIT
  9219         ELSE
  9220             COMPUTE CO-CURRENT-YTD-COM =
  9221                     CO-CURRENT-YTD-COM + PI-TOT-ISS-COMP
  9222                                        - PI-TOT-CAN-COMP
  9223             PERFORM 6060-ERCOMP-REWRITE
  9224             MOVE LOW-VALUES    TO ERCOMP-ACCT
  9225             MOVE 'G'           TO ERCOMP-RECORD-TYPE
  9226             PERFORM 6001-READ
  9227             IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9228                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9229                 COMPUTE CO-CURRENT-CUR-COM =
  9230                         CO-CURRENT-CUR-COM +
  9231                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9232                 COMPUTE CO-CURRENT-CUR-CHG =
  9233                         CO-CURRENT-CUR-CHG + PI-PREMIUM
  9234                 COMPUTE CO-CURRENT-CUR-PMT =
  9235                         CO-CURRENT-CUR-PMT +
  9236                         PI-REMITTED - PI-DISBURSED -
  9237                         PI-ADJUSTMENTS
  9238                 COMPUTE CO-CURRENT-END-BAL =
  9239                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9240                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9241                         PI-REMITTED + PI-DISBURSED +
  9242                         PI-ADJUSTMENTS
  9243                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9244                 PERFORM 6060-ERCOMP-REWRITE
  9245                 GO TO 6090-EXIT
  9246             ELSE
  9247                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9248                 COMPUTE CO-CURRENT-CUR-COM =
  9249                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9250                 MOVE PI-PREMIUM         TO CO-CURRENT-CUR-CHG
  9251                 COMPUTE CO-CURRENT-CUR-PMT =
  9252                         PI-REMITTED - PI-DISBURSED -
  9253                         PI-ADJUSTMENTS
  9254                 COMPUTE CO-CURRENT-END-BAL =
  9255                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9256                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9257                         PI-REMITTED + PI-DISBURSED +
  9258                         PI-ADJUSTMENTS
  9259                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9260                 MOVE WS-MONTH-END-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL640.cbl
  9261                                      TO CO-CURRENT-LAST-STMT-DT
  9262                 PERFORM 6060-ERCOMP-REWRITE
  9263                 GO TO 6090-EXIT.
  9264
  9265     IF PI-TOT-REBILL
  9266         MOVE CO-END-BAL           TO PI-BAL-FRWD
  9267     ELSE
  9268         MOVE CO-CURRENT-END-BAL   TO PI-BAL-FRWD.
  9269
  9270     IF PI-UPDATE-FILES
  9271       OR (PI-PREVIEW AND APRODSWI = 'Y')
  9272         NEXT SENTENCE
  9273     ELSE
  9274         GO TO 6090-EXIT.
  9275
  9276     IF AM-AGT (ACCOM-SUB) = PI-SAV-REMIT-TO
  9277         PERFORM 6040-READ-COMP-MASTER THRU 6049-EXIT
  9278         IF C-RECORD-FOUND
  9279             MOVE CO-ACCT-NAME   TO WS-REMIT-LINES (1)
  9280             MOVE CO-MAIL-NAME   TO WS-REMIT-LINES (2)
  9281             MOVE CO-ADDR-1      TO WS-REMIT-LINES (3)
  9282             MOVE CO-ADDR-2      TO WS-REMIT-LINES (4)
  9283             MOVE CO-ADDR-3      TO WS-REMIT-LINES (5)
  9284             MOVE WS-CO-ZIP      TO WS-REMIT-LINES (6)
  9285             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9286             MOVE 'CA'           TO BILLING-DETAIL-TYPE
  9287             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9288         ELSE
  9289             MOVE SPACES         TO ELCNTL-KEY
  9290             MOVE '6'            TO ELCNTL-REC-TYPE
  9291             MOVE PI-CARRIER     TO ELCNTL-CARRIER
  9292             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9293             MOVE CF-MAIL-TO-NAME   TO WS-REMIT-LINES (1)
  9294             MOVE CF-IN-CARE-OF     TO WS-REMIT-LINES (2)
  9295             MOVE CF-ADDRESS-LINE-1 TO WS-REMIT-LINES (3)
  9296             MOVE CF-ADDRESS-LINE-2 TO WS-REMIT-LINES (4)
  9297             MOVE CF-CITY-STATE     TO WS-REMIT-LINES (5)
  9298             MOVE WS-CF-ZIP         TO WS-REMIT-LINES (6)
  9299             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9300             MOVE 'CA'              TO BILLING-DETAIL-TYPE
  9301             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9302     ELSE
  9303         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9304         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9305         PERFORM 6001-READ
  9306         MOVE CO-ACCT-NAME       TO WS-REMIT-LINES (1)
  9307         MOVE CO-MAIL-NAME       TO WS-REMIT-LINES (2)
  9308         MOVE CO-ADDR-1          TO WS-REMIT-LINES (3)
  9309         MOVE CO-ADDR-2          TO WS-REMIT-LINES (4)
  9310         MOVE CO-ADDR-3          TO WS-REMIT-LINES (5)
  9311         MOVE WS-CO-ZIP          TO WS-REMIT-LINES (6)
  9312         MOVE CO-CURRENT-END-BAL TO PI-BAL-FRWD-GA
  9313         PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9314         MOVE 'GA'               TO BILLING-DETAIL-TYPE
  9315         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  9316
  9317     GO TO 6090-EXIT.
  9318
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL640.cbl
  9319 6070-NO-COMP-MSTR.
  9320     MOVE ER-2230                TO EMI-ERROR.
  9321     MOVE -1                     TO AACCTL.
  9322     MOVE AL-UABON               TO ACARIERA
  9323                                    AGROUPA
  9324                                    AACCTA.
  9325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9326     GO TO 6090-EXIT.
  9327
  9328 6080-COMP-FILE-NOTOPEN.
  9329     MOVE -1                     TO APFNTERL
  9330     MOVE ER-2233                TO EMI-ERROR.
  9331     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9332
  9333 6090-EXIT.
  9334     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL640.cbl
  9336
  9337 6040-READ-COMP-MASTER.
  9338
  9339* EXEC CICS HANDLE CONDITION
  9340*        NOTFND   (6045-NO-COMP-MSTR)
  9341*        NOTOPEN  (6045-COMP-FILE-NOTOPEN)
  9342*    END-EXEC.
  9343*    MOVE '"$IJ                  ! . #00008813' TO DFHEIV0
  9344     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9346     MOVE X'2E20233030303038383133' TO DFHEIV0(25:11)
  9347     CALL 'kxdfhei1' USING DFHEIV0
  9348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9349
  9350
  9351     MOVE 'Y'                    TO C-RECORD-FOUND-SW.
  9352     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9353     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9354     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9355     MOVE LOW-VALUES             TO ERCOMP-FIN-RESP
  9356                                    ERCOMP-ACCT.
  9357     MOVE 'C'                    TO ERCOMP-RECORD-TYPE.
  9358
  9359     MOVE SPACES                 TO WS-CO-ZIP.
  9360
  9361
  9362* EXEC CICS READ
  9363*        DATASET   (ERCOMP-FILE-ID)
  9364*        SET       (ADDRESS OF COMPENSATION-MASTER)
  9365*        RIDFLD    (ERCOMP-KEY)
  9366*    END-EXEC.
  9367*    MOVE '&"S        E          (   #00008828' TO DFHEIV0
  9368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9370     MOVE X'2020233030303038383238' TO DFHEIV0(25:11)
  9371     CALL 'kxdfhei1' USING DFHEIV0,
  9372           ERCOMP-FILE-ID,
  9373           DFHEIV20,
  9374           DFHEIV99,
  9375           ERCOMP-KEY,
  9376           DFHEIV99,
  9377           DFHEIV99,
  9378           DFHEIV99
  9379     SET ADDRESS OF COMPENSATION-MASTER TO
  9380         DFHEIV20
  9381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9382
  9383
  9384     IF CO-CANADIAN-POST-CODE
  9385         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9386         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9387     ELSE
  9388         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9389         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9390             MOVE '-'            TO WS-CO-ZIP-DASH
  9391             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9392
  9393     GO TO 6049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL640.cbl
  9394
  9395 6045-COMP-FILE-NOTOPEN.
  9396     MOVE -1                     TO APFNTERL.
  9397     MOVE ER-2233                TO EMI-ERROR.
  9398     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9399
  9400     GO TO 6049-EXIT.
  9401
  9402 6045-NO-COMP-MSTR.
  9403     MOVE 'N'                    TO C-RECORD-FOUND-SW.
  9404
  9405 6049-EXIT.
  9406     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL640.cbl
  9408
  9409 6050-AGING.
  9410
  9411     IF NOT PI-VOID-BILL
  9412        IF CO-CURRENT-LAST-STMT-DT NOT = WS-MONTH-END-DATE
  9413           if pi-company-id = 'AHL'
  9414              add co-current-ov90
  9415                                 to co-current-ov120
  9416              move co-current-ov60
  9417                                 to co-current-ov90
  9418              move co-current-ov30
  9419                                 to co-current-ov60
  9420              move co-current-cur
  9421                                 to co-current-ov30
  9422           else
  9423              ADD CO-CURRENT-OV60
  9424                                 TO CO-CURRENT-OV90
  9425              MOVE CO-CURRENT-OV30
  9426                                 TO CO-CURRENT-OV60
  9427              MOVE CO-CURRENT-CUR
  9428                                 TO CO-CURRENT-OV30
  9429           end-if
  9430        end-if
  9431     end-if
  9432
  9433     COMPUTE CO-CURRENT-CUR =
  9434             CO-CURRENT-CUR-CHG - CO-CURRENT-CUR-COM.
  9435
  9436     COMPUTE WS-PAY-ADJ =
  9437             PI-REMITTED - PI-DISBURSED - PI-ADJUSTMENTS.
  9438
  9439     IF WS-PAY-ADJ NEGATIVE
  9440         SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-CUR
  9441     ELSE
  9442        if pi-company-id = 'AHL'
  9443           subtract ws-pay-adj from co-current-ov120
  9444        else
  9445           SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-OV90
  9446        end-if
  9447     end-if
  9448
  9449     IF CO-CURRENT-CUR NEGATIVE
  9450        if pi-company-id = 'AHL'
  9451           add co-current-cur to co-current-ov120
  9452        else
  9453           ADD CO-CURRENT-CUR  TO  CO-CURRENT-OV90
  9454        end-if
  9455        MOVE ZEROS              TO  CO-CURRENT-CUR
  9456     end-if
  9457
  9458     if pi-company-id = 'AHL'
  9459        if co-current-ov120 negative
  9460           add co-current-ov120 to co-current-ov90
  9461           move zeros           to co-current-ov120
  9462        end-if
  9463     end-if
  9464     IF CO-CURRENT-OV90 NEGATIVE
  9465         ADD CO-CURRENT-OV90  TO  CO-CURRENT-OV60
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL640.cbl
  9466         MOVE ZEROS              TO  CO-CURRENT-OV90.
  9467
  9468     IF CO-CURRENT-OV60 NEGATIVE
  9469         ADD CO-CURRENT-OV60  TO  CO-CURRENT-OV30
  9470         MOVE ZEROS              TO  CO-CURRENT-OV60.
  9471
  9472     IF CO-CURRENT-OV30 NEGATIVE
  9473         ADD CO-CURRENT-OV30  TO  CO-CURRENT-CUR
  9474         MOVE ZEROS              TO  CO-CURRENT-OV30.
  9475
  9476 6059-AGING-EXIT.
  9477     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL640.cbl
  9479
  9480 6060-ERCOMP-REWRITE.
  9481
  9482
  9483* EXEC CICS REWRITE
  9484*        DATASET (ERCOMP-FILE-ID)
  9485*        FROM    (COMPENSATION-MASTER)
  9486*    END-EXEC.
  9487     MOVE LENGTH OF
  9488      COMPENSATION-MASTER
  9489       TO DFHEIV11
  9490*    MOVE '&& L                  %   #00008932' TO DFHEIV0
  9491     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9492     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9493     MOVE X'2020233030303038393332' TO DFHEIV0(25:11)
  9494     CALL 'kxdfhei1' USING DFHEIV0,
  9495           ERCOMP-FILE-ID,
  9496           COMPENSATION-MASTER,
  9497           DFHEIV11,
  9498           DFHEIV99
  9499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9500
  9501
  9502 6100-READ-CONTROL-FILE.
  9503     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  9504     MOVE +0                     TO ELCNTL-SEQ-NO.
  9505
  9506     MOVE SPACES                 TO WS-CF-ZIP.
  9507
  9508
  9509* EXEC CICS HANDLE CONDITION
  9510*        NOTFND   (6110-NO-RECORD)
  9511*    END-EXEC.
  9512*    MOVE '"$I                   ! / #00008943' TO DFHEIV0
  9513     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9515     MOVE X'2F20233030303038393433' TO DFHEIV0(25:11)
  9516     CALL 'kxdfhei1' USING DFHEIV0
  9517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9518
  9519
  9520     IF NOT ELCNTL-UPDATE
  9521
  9522* EXEC CICS READ
  9523*            DATASET (ELCNTL-FILE-ID)
  9524*            SET     (ADDRESS OF CONTROL-FILE)
  9525*            RIDFLD  (ELCNTL-KEY)
  9526*        END-EXEC
  9527*    MOVE '&"S        E          (   #00008948' TO DFHEIV0
  9528     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9530     MOVE X'2020233030303038393438' TO DFHEIV0(25:11)
  9531     CALL 'kxdfhei1' USING DFHEIV0,
  9532           ELCNTL-FILE-ID,
  9533           DFHEIV20,
  9534           DFHEIV99,
  9535           ELCNTL-KEY,
  9536           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL640.cbl
  9537           DFHEIV99,
  9538           DFHEIV99
  9539     SET ADDRESS OF CONTROL-FILE TO
  9540         DFHEIV20
  9541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9542     ELSE
  9543         MOVE SPACE              TO ELCNTL-UPDATE-SW
  9544
  9545* EXEC CICS READ
  9546*            DATASET (ELCNTL-FILE-ID)
  9547*            SET     (ADDRESS OF CONTROL-FILE)
  9548*            RIDFLD  (ELCNTL-KEY)
  9549*            UPDATE
  9550*        END-EXEC.
  9551*    MOVE '&"S        EU         (   #00008955' TO DFHEIV0
  9552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9553     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9554     MOVE X'2020233030303038393535' TO DFHEIV0(25:11)
  9555     CALL 'kxdfhei1' USING DFHEIV0,
  9556           ELCNTL-FILE-ID,
  9557           DFHEIV20,
  9558           DFHEIV99,
  9559           ELCNTL-KEY,
  9560           DFHEIV99,
  9561           DFHEIV99,
  9562           DFHEIV99
  9563     SET ADDRESS OF CONTROL-FILE TO
  9564         DFHEIV20
  9565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9566
  9567
  9568     IF CF-ZIP-CODE-NUM NOT NUMERIC
  9569         MOVE ZEROS              TO CF-ZIP-CODE-NUM.
  9570
  9571     IF CF-ZIP-CODE-NUM NOT = ZEROS
  9572         MOVE CF-ZIP-CODE-NUM    TO WORK-ZIP
  9573         IF WORK-ZIPR1-4 = ZEROS
  9574             MOVE WORK-ZIPR1-5   TO WORK-ZIPR2-5
  9575             MOVE ZEROS          TO WORK-ZIPR2-4
  9576             MOVE WORK-ZIP       TO CF-ZIP-CODE
  9577         ELSE
  9578             MOVE WORK-ZIP       TO CF-ZIP-CODE.
  9579
  9580     IF CF-CANADIAN-POST-CODE
  9581         MOVE CF-CAN-POSTAL-1    TO WS-CF-CAN-POST-1
  9582         MOVE CF-CAN-POSTAL-2    TO WS-CF-CAN-POST-2
  9583     ELSE
  9584         MOVE CF-ZIP-PRIME       TO WS-CF-ZIP-PRIME
  9585         IF CF-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9586             MOVE '-'            TO WS-CF-ZIP-DASH
  9587             MOVE CF-ZIP-PLUS4   TO WS-CF-ZIP-PLUS4.
  9588
  9589     GO TO 6120-EXIT.
  9590
  9591 6110-NO-RECORD.
  9592     IF ELCNTL-REC-TYPE = 1
  9593         MOVE ER-0022            TO EMI-ERROR
  9594     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL640.cbl
  9595         MOVE ER-2208            TO EMI-ERROR
  9596         MOVE -1                 TO ACARIERL
  9597         MOVE AL-UABON           TO ACARIERA
  9598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9599
  9600 6120-EXIT.
  9601     EXIT.
  9602 6130-FIND-BENEFIT-CD.
  9603
  9604* EXEC CICS READ
  9605*       DATASET (ELCNTL-FILE-ID)
  9606*       SET     (ADDRESS OF CONTROL-FILE)
  9607*       RIDFLD  (ELCNTL-KEY)
  9608*       GTEQ
  9609*       RESP    (WS-RESPONSE)
  9610*    END-EXEC
  9611*    MOVE '&"S        G          (  N#00008997' TO DFHEIV0
  9612     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9614     MOVE X'204E233030303038393937' TO DFHEIV0(25:11)
  9615     CALL 'kxdfhei1' USING DFHEIV0,
  9616           ELCNTL-FILE-ID,
  9617           DFHEIV20,
  9618           DFHEIV99,
  9619           ELCNTL-KEY,
  9620           DFHEIV99,
  9621           DFHEIV99,
  9622           DFHEIV99
  9623     SET ADDRESS OF CONTROL-FILE TO
  9624         DFHEIV20
  9625     MOVE EIBRESP  TO WS-RESPONSE
  9626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9627     IF RESP-NORMAL
  9628        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9629           AND (CF-RECORD-TYPE = '5')
  9630           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9631              (S1 > +8)
  9632              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9633           END-PERFORM
  9634           IF S1 NOT > +8
  9635              MOVE CF-BENEFIT-CATEGORY (S1)
  9636                                 TO WS-AH-CATEGORY
  9637              GO TO 6140-EXIT
  9638           END-IF
  9639        END-IF
  9640     END-IF
  9641     .
  9642 6140-NO-RECORD.
  9643     MOVE ER-2208                TO EMI-ERROR
  9644     MOVE -1                     TO ACARIERL
  9645     MOVE AL-UABON               TO ACARIERA
  9646     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9647     .
  9648 6140-EXIT.
  9649     EXIT.
  9650 6200-REWRITE-CONTROL-FILE.
  9651
  9652
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL640.cbl
  9653* EXEC CICS REWRITE
  9654*        DATASET (ELCNTL-FILE-ID)
  9655*        FROM    (CONTROL-FILE)
  9656*    END-EXEC.
  9657     MOVE LENGTH OF
  9658      CONTROL-FILE
  9659       TO DFHEIV11
  9660*    MOVE '&& L                  %   #00009029' TO DFHEIV0
  9661     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9662     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9663     MOVE X'2020233030303039303239' TO DFHEIV0(25:11)
  9664     CALL 'kxdfhei1' USING DFHEIV0,
  9665           ELCNTL-FILE-ID,
  9666           CONTROL-FILE,
  9667           DFHEIV11,
  9668           DFHEIV99
  9669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9670
  9671
  9672 6290-EXIT.
  9673     EXIT.
  9674
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL640.cbl
  9676 6300-ELIMINATE-LINE-SPACES.
  9677     IF WS-REMIT-LINES (1) = SPACES
  9678         MOVE WS-REMIT-LINES (2)  TO WS-REMIT-LINES (1)
  9679         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9680         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9681         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9682         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9683         MOVE SPACES              TO WS-REMIT-LINES (6)
  9684         GO TO 6300-ELIMINATE-LINE-SPACES.
  9685
  9686     IF WS-REMIT-LINES (2) = SPACES AND
  9687        WS-REMIT-LINES (3) = SPACES AND
  9688        WS-REMIT-LINES (4) = SPACES AND
  9689        WS-REMIT-LINES (5) = SPACES AND
  9690        WS-REMIT-LINES (6) = SPACES
  9691          GO TO 6350-MOVE-ZIP.
  9692
  9693     IF WS-REMIT-LINES (2) = SPACES
  9694         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9695         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9696         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9697         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9698         MOVE SPACES              TO WS-REMIT-LINES (6)
  9699         GO TO 6300-ELIMINATE-LINE-SPACES.
  9700
  9701     IF WS-REMIT-LINES (3) = SPACES AND
  9702        WS-REMIT-LINES (4) = SPACES AND
  9703        WS-REMIT-LINES (5) = SPACES AND
  9704        WS-REMIT-LINES (6) = SPACES
  9705          GO TO 6350-MOVE-ZIP.
  9706
  9707     IF WS-REMIT-LINES (3) = SPACES
  9708         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9709         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9710         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9711         MOVE SPACES              TO WS-REMIT-LINES (6)
  9712         GO TO 6300-ELIMINATE-LINE-SPACES.
  9713
  9714     IF WS-REMIT-LINES (4) = SPACES AND
  9715        WS-REMIT-LINES (5) = SPACES AND
  9716        WS-REMIT-LINES (6) = SPACES
  9717          GO TO 6350-MOVE-ZIP.
  9718
  9719     IF WS-REMIT-LINES (4) = SPACES
  9720         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9721         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9722         MOVE SPACES              TO WS-REMIT-LINES (6)
  9723         GO TO 6300-ELIMINATE-LINE-SPACES.
  9724
  9725     IF WS-REMIT-LINES (5) = SPACES
  9726         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9727         MOVE SPACES              TO WS-REMIT-LINES (6).
  9728
  9729 6350-MOVE-ZIP.
  9730     IF WS-REMIT-LINES (6) NOT = SPACES
  9731         MOVE WS-REMIT-ZIP (6)        TO WS-R-LAST-ZIP (5)
  9732         MOVE SPACES                  TO WS-REMIT-LINES (6)
  9733     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL640.cbl
  9734         IF WS-REMIT-LINES (5) NOT = SPACES
  9735             MOVE WS-REMIT-ZIP (5)     TO WS-R-LAST-ZIP (5)
  9736             MOVE SPACES               TO WS-REMIT-ZIP (5)
  9737         ELSE
  9738             IF WS-REMIT-LINES (4) NOT = SPACES
  9739                 MOVE WS-REMIT-ZIP (4) TO WS-R-LAST-ZIP (4)
  9740                 MOVE SPACES           TO WS-REMIT-ZIP (4).
  9741
  9742 6390-EXIT.
  9743     EXIT.
  9744
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL640.cbl
  9746 6400-FORMAT-ACCOUNT-ADDRS.
  9747     IF WS-ACCT-ADDR-AREA = SPACES
  9748         GO TO 6490-EXIT.
  9749
  9750     IF WS-ACCT-LINES (1) = SPACES
  9751         MOVE WS-ACCT-LINES (2)  TO WS-ACCT-LINES (1)
  9752         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9753         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9754         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9755         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9756         MOVE SPACES              TO WS-ACCT-LINES (6)
  9757         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9758
  9759     IF WS-ACCT-LINES (2) = SPACES AND
  9760        WS-ACCT-LINES (3) = SPACES AND
  9761        WS-ACCT-LINES (4) = SPACES AND
  9762        WS-ACCT-LINES (5) = SPACES AND
  9763        WS-ACCT-LINES (6) = SPACES
  9764          GO TO 6450-MOVE-ZIP.
  9765
  9766     IF WS-ACCT-LINES (2) = SPACES
  9767         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9768         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9769         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9770         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9771         MOVE SPACES             TO WS-ACCT-LINES (6)
  9772         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9773
  9774     IF WS-ACCT-LINES (3) = SPACES AND
  9775        WS-ACCT-LINES (4) = SPACES AND
  9776        WS-ACCT-LINES (5) = SPACES AND
  9777        WS-ACCT-LINES (6) = SPACES
  9778          GO TO 6450-MOVE-ZIP.
  9779
  9780     IF WS-ACCT-LINES (3) = SPACES
  9781         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9782         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9783         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9784         MOVE SPACES             TO WS-ACCT-LINES (6)
  9785         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9786
  9787     IF WS-ACCT-LINES (4) = SPACES AND
  9788        WS-ACCT-LINES (5) = SPACES AND
  9789        WS-ACCT-LINES (6) = SPACES
  9790          GO TO 6450-MOVE-ZIP.
  9791
  9792     IF WS-ACCT-LINES (4) = SPACES
  9793         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9794         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9795         MOVE SPACES             TO WS-ACCT-LINES (6)
  9796         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9797
  9798     IF WS-ACCT-LINES (5) = SPACES
  9799         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9800         MOVE SPACES             TO WS-ACCT-LINES (6).
  9801
  9802 6450-MOVE-ZIP.
  9803     IF WS-ACCT-LINES (6) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL640.cbl
  9804         MOVE WS-ACCT-ZIP (6)         TO WS-A-LAST-ZIP (5)
  9805         MOVE SPACES                  TO WS-ACCT-LINES (6)
  9806     ELSE
  9807         IF WS-ACCT-LINES (5) NOT = SPACES
  9808             MOVE WS-ACCT-ZIP (5)      TO WS-A-LAST-ZIP (5)
  9809             MOVE SPACES               TO WS-ACCT-ZIP (5)
  9810         ELSE
  9811             IF WS-ACCT-LINES (4) NOT = SPACES
  9812                 MOVE WS-ACCT-ZIP (4)  TO WS-A-LAST-ZIP (4)
  9813                 MOVE SPACES           TO WS-ACCT-ZIP (4).
  9814
  9815 6490-EXIT.
  9816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL640.cbl
  9818 7000-PROCESS-CHECK.
  9819*                *******************************************
  9820*                *    FORMAT THE CHECK SCREEN (EL640D)     *
  9821*                *******************************************
  9822     MOVE LOW-VALUES             TO EL640BO.
  9823
  9824     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  9825         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  9826         IF EMI-ERROR = ZEROS
  9827             MOVE AM-NAME        TO BNAMEO
  9828             MOVE AM-PERSON      TO BADDR1O
  9829             MOVE AM-ADDRS       TO BADDR2O
  9830*            MOVE AM-CITY        TO BCITYSTO
  9831             STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  9832                DELIMITED BY '  ' INTO BCITYSTO
  9833             END-STRING
  9834             MOVE WS-AM-ZIP      TO BZIPO
  9835         ELSE
  9836             MOVE EL640A         TO PI-MAP-NAME
  9837             MOVE -1             TO BPFNTERL
  9838             GO TO 8200-SEND-DATAONLY
  9839     ELSE
  9840         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9841         IF EMI-ERROR = ZEROS
  9842             MOVE CO-ACCT-NAME   TO BNAMEO
  9843             MOVE CO-ADDR-1      TO BADDR1O
  9844             MOVE CO-ADDR-2      TO BADDR2O
  9845*            MOVE CO-ADDR-3      TO BCITYSTO
  9846             STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9847                DELIMITED BY '  ' INTO BCITYSTO
  9848             END-STRING
  9849             MOVE WS-CO-ZIP      TO BZIPO
  9850         ELSE
  9851             MOVE EL640A         TO PI-MAP-NAME
  9852             MOVE -1             TO BPFNTERL
  9853             GO TO 8200-SEND-DATAONLY.
  9854
  9855     MOVE AL-UNNON               TO BCHKAMTA.
  9856     MOVE PI-ACCT-NAME           TO BACCNAMO.
  9857     MOVE PI-SAV-ACCT            TO BACCTO.
  9858     MOVE PI-COMP-CARRIER        TO BCARIERO.
  9859     MOVE PI-COMP-GROUPING       TO BGROUPO.
  9860     MOVE PI-SAV-STATE           TO BSTATEO.
  9861     MOVE PI-MONTH-END-DATE      TO BPAYDT2O
  9862                                    WS-BEGIN-DATE.
  9863     MOVE '01'                   TO WS-BEGIN-DAY.
  9864     MOVE WS-BEGIN-DATE          TO BPAYDT1O.
  9865     MOVE -1                     TO BCHKNOL
  9866
  9867     IF WS-ENTERED-FROM-A
  9868         COMPUTE WORK-CHECK-AMT = PI-END-BAL * -1
  9869         MOVE WORK-CHECK-AMT     TO BCHKAMTO
  9870     ELSE
  9871         MOVE WORK-CHECK-AMT     TO BCHKAMTO.
  9872
  9873     IF WORK-CHECK-AMT NOT > ZEROS
  9874         MOVE ER-3165    TO  EMI-ERROR
  9875         MOVE -1         TO  BCHKAMTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL640.cbl
  9876         MOVE AL-UNBON   TO  BCHKAMTA
  9877         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9878
  9879     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL640.cbl
  9881
  9882 7500-PRODUCE-CHECK.
  9883*                *******************************************
  9884*                *   PRODUCES A CHECK FOR LATER PRINTING   *
  9885*                *******************************************
  9886     MOVE SPACES                 TO ELCNTL-KEY.
  9887     MOVE '1'                    TO ELCNTL-REC-TYPE.
  9888     MOVE 'Y'                    TO ELCNTL-UPDATE-SW.
  9889     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  9890
  9891     IF EMI-ERROR NOT = ZEROS
  9892         GO TO 8200-SEND-DATAONLY.
  9893
  9894     IF CR-CHECK-NO-AUTO-SEQ
  9895         IF CR-CHECK-CNT-RESET-VALUE
  9896             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9897             MOVE +1             TO CF-CR-CHECK-COUNTER
  9898             MOVE 6              TO BCHKNOL
  9899         ELSE
  9900             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9901             MOVE 6              TO BCHKNOL
  9902             ADD +1              TO CF-CR-CHECK-COUNTER.
  9903
  9904     IF CR-CHECK-NO-MANUAL
  9905         IF BCHKNOL = ZEROS
  9906             MOVE ER-2438        TO EMI-ERROR
  9907             MOVE -1             TO BCHKNOL
  9908             MOVE AL-UNBON       TO BCHKNOA
  9909             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9910             GO TO 8200-SEND-DATAONLY
  9911         ELSE
  9912             IF BCHKNOI NOT NUMERIC
  9913                 MOVE ER-2439    TO EMI-ERROR
  9914                 MOVE -1         TO BCHKNOL
  9915                 MOVE AL-UNBON   TO BCHKNOA
  9916                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9917                 GO TO 8200-SEND-DATAONLY.
  9918
  9919     PERFORM 7600-CHECK-FORMS THRU 7600-EXIT.
  9920
  9921
  9922* EXEC CICS GETMAIN
  9923*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  9924*        LENGTH  (ERPYAJ-LENGTH)
  9925*        INITIMG (GETMAIN-SPACE)
  9926*    END-EXEC.
  9927*    MOVE ',"IL                  $   #00009283' TO DFHEIV0
  9928     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9929     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9930     MOVE X'2020233030303039323833' TO DFHEIV0(25:11)
  9931     CALL 'kxdfhei1' USING DFHEIV0,
  9932           DFHEIV20,
  9933           ERPYAJ-LENGTH,
  9934           GETMAIN-SPACE
  9935     SET ADDRESS OF PENDING-PAY-ADJ TO
  9936         DFHEIV20
  9937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9938
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL640.cbl
  9939
  9940
  9941* EXEC CICS BIF DEEDIT
  9942*        FIELD  (BCHKAMTI)
  9943*        LENGTH (11)
  9944*    END-EXEC.
  9945     MOVE 11
  9946       TO DFHEIV11
  9947*    MOVE '@"L                   #   #00009289' TO DFHEIV0
  9948     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9949     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9950     MOVE X'2020233030303039323839' TO DFHEIV0(25:11)
  9951     CALL 'kxdfhei1' USING DFHEIV0,
  9952           BCHKAMTI,
  9953           DFHEIV11
  9954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9955
  9956
  9957     IF BCHKAMTI NOT > ZEROS
  9958         MOVE ER-3165    TO  EMI-ERROR
  9959         MOVE -1         TO  BCHKAMTL
  9960         MOVE AL-UNBON   TO  BCHKAMTA
  9961         MOVE BCHKAMTI   TO  BCHKAMTO
  9962         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9963         GO TO 8200-SEND-DATAONLY.
  9964
  9965     MOVE 'Y'                    TO PI-CHECK-SW.
  9966     MOVE 'PY'                   TO PY-RECORD-ID.
  9967     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  9968     MOVE PI-COMP-CARRIER        TO PY-CARRIER.
  9969     MOVE PI-COMP-GROUPING       TO PY-GROUPING.
  9970     MOVE PI-SAV-REMIT-TO        TO PY-FIN-RESP.
  9971     MOVE PI-SAV-ACCT            TO PY-ACCOUNT.
  9972     MOVE 'C'                    TO PY-RECORD-TYPE.
  9973     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  9974
  9975     IF PI-COMPANY-ID = CLIENT-ITY
  9976        MOVE PI-MONTH-END-DATE   TO WS-PY-END-DT
  9977                                    WS-BEGIN-DATE
  9978        MOVE '01'                TO WS-BEGIN-DAY
  9979        MOVE WS-BEGIN-DATE       TO WS-PY-BEGIN-DT
  9980        MOVE WS-ITY-COMMENT      TO PY-ENTRY-COMMENT
  9981     ELSE
  9982        MOVE WS-CURRENT-DATE-MDY TO WS-PY-CURRENT-DATE
  9983        MOVE WS-PY-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  9984
  9985     MOVE BCHKAMTI               TO PY-ENTRY-AMT.
  9986     ADD BCHKAMTI TO PI-DISBURSED.
  9987     MOVE BFORM1I                TO PY-LETTER (1).
  9988     MOVE BFORM2I                TO PY-LETTER (2).
  9989     MOVE BFORM3I                TO PY-LETTER (3).
  9990
  9991     IF NOT CR-CHECK-NO-AT-PRINT
  9992         MOVE BCHKNOI            TO PY-CHECK-NUMBER.
  9993
  9994     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  9995     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  9996     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL640.cbl
  9997                                    PY-INPUT-DT.
  9998     IF PI-BILL OR PI-REBILLING
  9999         MOVE DC-BIN-DATE-1      TO PY-BILLED-DATE
 10000     ELSE
 10001         MOVE LOW-VALUES         TO PY-BILLED-DATE
 10002                                    PY-AR-DATE.
 10003
 10004     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 10005                                    PY-CHECK-QUE-SEQUENCE.
 10006     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 10007                                    PY-REPORTED-DT
 10008                                    PY-CHECK-WRITTEN-DT.
 10009     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
 10010     MOVE 'B'                    TO PY-CHECK-ORIGIN-SW.
 10011
 10012
 10013* EXEC CICS WRITE
 10014*        DATASET (ERPYAJ-FILE-ID)
 10015*        FROM    (PENDING-PAY-ADJ)
 10016*        RIDFLD  (PY-CONTROL-PRIMARY)
 10017*    END-EXEC.
 10018     MOVE LENGTH OF
 10019      PENDING-PAY-ADJ
 10020       TO DFHEIV11
 10021*    MOVE '&$ L                  ''   #00009349' TO DFHEIV0
 10022     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10023     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10024     MOVE X'2020233030303039333439' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           ERPYAJ-FILE-ID,
 10027           PENDING-PAY-ADJ,
 10028           DFHEIV11,
 10029           PY-CONTROL-PRIMARY,
 10030           DFHEIV99,
 10031           DFHEIV99
 10032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10033
 10034
 10035     IF CR-CHECK-NO-AUTO-SEQ
 10036         PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT
 10037     ELSE
 10038
 10039* EXEC CICS UNLOCK
 10040*            DATASET (ELCNTL-FILE-ID)
 10041*        END-EXEC.
 10042*    MOVE '&*                    #   #00009358' TO DFHEIV0
 10043     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10044     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10045     MOVE X'2020233030303039333538' TO DFHEIV0(25:11)
 10046     CALL 'kxdfhei1' USING DFHEIV0,
 10047           ELCNTL-FILE-ID,
 10048           DFHEIV99
 10049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10050
 10051
 10052     MOVE EL640A                 TO PI-MAP-NAME.
 10053     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
 10054     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL640.cbl
 10055
 10056 7600-CHECK-FORMS.
 10057
 10058     IF BFORM1L NOT = ZEROS
 10059             AND
 10060        BFORM1I NOT = SPACES
 10061         MOVE BFORM1I            TO ELLETR-FORM-NO
 10062         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10063         IF W-LETTER-NOT-FOUND
 10064             MOVE ER-7389        TO EMI-ERROR
 10065             MOVE -1             TO BFORM1L
 10066             MOVE AL-UABON       TO BFORM1A
 10067             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10068             GO TO 8200-SEND-DATAONLY.
 10069
 10070     IF BFORM2L NOT = ZEROS
 10071             AND
 10072        BFORM2I NOT = SPACES
 10073         MOVE BFORM2I            TO ELLETR-FORM-NO
 10074         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10075
 10076         IF W-LETTER-NOT-FOUND
 10077             MOVE ER-7389        TO EMI-ERROR
 10078             MOVE -1             TO BFORM2L
 10079             MOVE AL-UABON       TO BFORM2A
 10080             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10081             GO TO 8200-SEND-DATAONLY.
 10082
 10083     IF BFORM3L NOT = ZEROS
 10084             AND
 10085        BFORM3I NOT = SPACES
 10086         MOVE BFORM3I            TO ELLETR-FORM-NO
 10087         IF  W-LETTER-NOT-FOUND
 10088             MOVE ER-7389        TO EMI-ERROR
 10089             MOVE -1             TO BFORM3L
 10090             MOVE AL-UABON       TO BFORM3A
 10091             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10092             GO TO 8200-SEND-DATAONLY.
 10093
 10094     IF BFORM1L = ZEROS
 10095         IF BFORM2L NOT = ZEROS
 10096             MOVE BFORM2L        TO BFORM1L
 10097             MOVE BFORM3L        TO BFORM2L
 10098             MOVE BFORM2A        TO BFORM1A
 10099             MOVE BFORM3A        TO BFORM2A
 10100             MOVE BFORM2I        TO BFORM1I
 10101             MOVE BFORM3I        TO BFORM2I
 10102             MOVE LOW-VALUES     TO BFORM3I
 10103                                    BFORM3A
 10104             MOVE ZEROS          TO BFORM3L
 10105         ELSE
 10106             IF BFORM3L NOT = ZEROS
 10107                 MOVE BFORM3L    TO BFORM1L
 10108                 MOVE BFORM3I    TO BFORM1I
 10109                 MOVE BFORM3A    TO BFORM1A
 10110                 MOVE LOW-VALUES TO BFORM3I
 10111                                    BFORM3A
 10112                 MOVE ZEROS      TO BFORM3L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL640.cbl
 10113             ELSE
 10114                 NEXT SENTENCE
 10115     ELSE
 10116         IF BFORM2L = ZEROS
 10117             IF BFORM3L NOT = ZEROS
 10118                 MOVE BFORM3L    TO BFORM2L
 10119                 MOVE BFORM3I    TO BFORM2I
 10120                 MOVE BFORM3A    TO BFORM2A
 10121                 MOVE LOW-VALUES TO BFORM3I
 10122                                    BFORM3A
 10123                 MOVE ZEROS      TO BFORM3L.
 10124
 10125 7600-EXIT.
 10126      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL640.cbl
 10128 7620-CHECK-ON-LETTER.
 10129
 10130     MOVE SPACES                 TO W-LETTER-IND.
 10131
 10132     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD.
 10133     MOVE +1                     TO ELLETR-LINE-SEQ.
 10134
 10135
 10136* EXEC CICS HANDLE CONDITION
 10137*        NOTFND   (7620-LETR-NOT-FOUND)
 10138*        ENDFILE  (7620-LETR-NOT-FOUND)
 10139*        NOTOPEN  (7620-LETR-NOT-OPEN)
 10140*    END-EXEC.
 10141*    MOVE '"$I''J                 ! 0 #00009445' TO DFHEIV0
 10142     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10144     MOVE X'3020233030303039343435' TO DFHEIV0(25:11)
 10145     CALL 'kxdfhei1' USING DFHEIV0
 10146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10147
 10148
 10149
 10150* EXEC CICS READ
 10151*        SET     (ADDRESS OF TEXT-FILES)
 10152*        DATASET (ELLETR-FILE-ID)
 10153*        RIDFLD  (ELLETR-KEY)
 10154*    END-EXEC.
 10155*    MOVE '&"S        E          (   #00009451' TO DFHEIV0
 10156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10158     MOVE X'2020233030303039343531' TO DFHEIV0(25:11)
 10159     CALL 'kxdfhei1' USING DFHEIV0,
 10160           ELLETR-FILE-ID,
 10161           DFHEIV20,
 10162           DFHEIV99,
 10163           ELLETR-KEY,
 10164           DFHEIV99,
 10165           DFHEIV99,
 10166           DFHEIV99
 10167     SET ADDRESS OF TEXT-FILES TO
 10168         DFHEIV20
 10169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10170
 10171
 10172     GO TO 7620-EXIT.
 10173
 10174 7620-LETR-NOT-FOUND.
 10175
 10176     MOVE 'Y'                    TO W-LETTER-IND.
 10177     GO TO 7620-EXIT.
 10178
 10179 7620-LETR-NOT-OPEN.
 10180
 10181     MOVE ER-0013                TO EMI-ERROR.
 10182     MOVE -1                     TO BFORM1L.
 10183     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10184     GO TO 8200-SEND-DATAONLY.
 10185
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL640.cbl
 10186 7620-EXIT.
 10187      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL640.cbl
 10189 8100-SEND-INITIAL-MAP.
 10190
 10191     MOVE SPACES TO PI-TRANSFER-SW.
 10192
 10193     IF PI-MAP-NAME = EL640A
 10194         NEXT SENTENCE
 10195     ELSE
 10196         GO TO 8110-SEND-INITIAL-CHECK-MAP.
 10197
 10198     IF PI-COMPANY-ID = 'DMD'
 10199        MOVE AL-SADOF            TO APF5HDGA.
 10200
 10201     IF NOT PI-GA-BILLING
 10202        MOVE AL-SADOF            TO AGAHDGA.
 10203
 10204     MOVE WS-CURRENT-DATE-EDIT   TO ADATEO.
 10205     MOVE EIBTIME                TO TIME-IN.
 10206     MOVE TIME-OUT               TO ATIMEO.
 10207     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10208     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10209
 10210     MOVE -1                     TO AACCTL.
 10211     MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O.
 10212     MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O.
 10213
 10214     IF CARR-GROUP-ST-ACCNT-CNTL
 10215         NEXT SENTENCE
 10216     ELSE
 10217         IF ST-ACCNT-CNTL
 10218             MOVE AL-SADOF       TO ACARHDGA
 10219                                    AGRPHDGA
 10220             MOVE AL-SANOF       TO ACARIERA
 10221                                    AGROUPA
 10222         ELSE
 10223             IF CARR-ST-ACCNT-CNTL
 10224                 MOVE AL-SADOF   TO AGRPHDGA
 10225                 MOVE AL-SANOF   TO AGROUPA
 10226             ELSE
 10227                 IF ACCNT-CNTL
 10228                     MOVE AL-SADOF TO ACARHDGA
 10229                                      AGRPHDGA
 10230                                      ASTHDGA
 10231                     MOVE AL-SANOF TO ACARIERA
 10232                                      AGROUPA
 10233                                      ASTATEA
 10234                 ELSE
 10235                     IF CARR-ACCNT-CNTL
 10236                         MOVE AL-SADOF TO AGRPHDGA
 10237                                          ASTHDGA
 10238                         MOVE AL-SANOF TO AGROUPA
 10239                                          ASTATEA.
 10240
 10241     IF (EIBTRNID = EL633-TRANS-ID  OR  EL635-TRANS-ID  OR
 10242                    EL633DMD-TRANS-ID  OR
 10243                    EL650-TRANS-ID  OR  EL652-TRANS-ID  OR
 10244                    EL658-TRANS-ID)  AND
 10245          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10246        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL640.cbl
 10247        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10248        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10249        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10250        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10251        IF CARR-GROUP-ST-ACCNT-CNTL
 10252            MOVE AL-UANON        TO ACARIERA
 10253                                    AGROUPA
 10254                                    ASTATEA
 10255                                    AACCTA
 10256            MOVE WT-CR-CARRIER   TO ACARIERI
 10257                                    PI-SCR-CARRIER
 10258            MOVE WT-CR-GROUPING  TO AGROUPI
 10259                                    PI-SCR-GROUPING
 10260            MOVE WT-CR-ACCOUNT   TO AACCTI
 10261                                    PI-SCR-ACCOUNT
 10262            MOVE 1               TO ACARIERL
 10263            MOVE 6               TO AGROUPL
 10264            MOVE 10              TO AACCTL
 10265            MOVE -1              TO ASTATEL
 10266        ELSE
 10267         IF ST-ACCNT-CNTL
 10268            MOVE AL-UANON        TO ASTATEA
 10269                                    AACCTA
 10270            MOVE WT-CR-ACCOUNT   TO AACCTI
 10271                                    PI-SCR-ACCOUNT
 10272            MOVE 10              TO AACCTL
 10273            MOVE -1              TO ASTATEL
 10274         ELSE
 10275            IF CARR-ST-ACCNT-CNTL
 10276                MOVE AL-UANON       TO ACARIERA
 10277                                       ASTATEA
 10278                                       AACCTA
 10279                MOVE WT-CR-CARRIER TO ACARIERI
 10280                                      PI-SCR-CARRIER
 10281                MOVE WT-CR-ACCOUNT TO AACCTI
 10282                                      PI-SCR-ACCOUNT
 10283                MOVE 1              TO ACARIERL
 10284                MOVE 10             TO AACCTL
 10285                MOVE -1             TO ASTATEL
 10286            ELSE
 10287                IF ACCNT-CNTL
 10288                    MOVE AL-UANON       TO AACCTA
 10289                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10290                                           PI-SCR-ACCOUNT
 10291                    MOVE 10             TO AACCTL
 10292                    MOVE -1             TO ABILTYPL
 10293                ELSE
 10294                    IF CARR-ACCNT-CNTL
 10295                        MOVE AL-UANON        TO ACARIERA
 10296                                                AACCTA
 10297                        MOVE WT-CR-CARRIER   TO ACARIERI
 10298                                                PI-SCR-CARRIER
 10299                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10300                                                PI-SCR-ACCOUNT
 10301                        MOVE 1               TO ACARIERL
 10302                        MOVE 10              TO AACCTL
 10303                        MOVE -1              TO ABILTYPL.
 10304
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL640.cbl
 10305     IF (EIBTRNID = EL6311-TRANS-ID) AND
 10306          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10307        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
 10308        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10309        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10310        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10311        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10312        MOVE SPACES              TO PI-SAV-CARR
 10313                                    PI-SAV-GROUP
 10314                                    PI-SAV-STATE
 10315                                    PI-SAV-ACCT
 10316        MOVE LOW-VALUES          TO PI-SAV-EXP-DT
 10317        IF CARR-GROUP-ST-ACCNT-CNTL
 10318            MOVE AL-UANON        TO ACARIERA
 10319                                    AGROUPA
 10320                                    ASTATEA
 10321                                    AACCTA
 10322            MOVE WT-CR-CARRIER   TO ACARIERI
 10323                                    PI-SCR-CARRIER
 10324                                    PI-SAV-CARR
 10325            MOVE WT-CR-GROUPING  TO AGROUPI
 10326                                    PI-SCR-GROUPING
 10327                                    PI-SAV-GROUP
 10328            MOVE WT-CR-STATE     TO ASTATEI
 10329                                    PI-SCR-STATE
 10330            MOVE WT-CR-ACCOUNT   TO AACCTI
 10331                                    PI-SCR-ACCOUNT
 10332            MOVE 1               TO ACARIERL
 10333            MOVE 6               TO AGROUPL
 10334            MOVE 10              TO AACCTL
 10335            MOVE 2               TO ASTATEL
 10336            MOVE -1              TO ABILTYPL
 10337        ELSE
 10338         IF ST-ACCNT-CNTL
 10339            MOVE AL-UANON        TO ASTATEA
 10340                                    AACCTA
 10341            MOVE WT-CR-STATE     TO ASTATEI
 10342                                    PI-SCR-STATE
 10343                                    PI-SAV-STATE
 10344            MOVE WT-CR-ACCOUNT   TO AACCTI
 10345                                    PI-SCR-ACCOUNT
 10346                                    PI-SAV-ACCT
 10347            MOVE 10              TO AACCTL
 10348            MOVE -1              TO ASTATEL
 10349         ELSE
 10350            IF CARR-ST-ACCNT-CNTL
 10351                MOVE AL-UANON      TO ACARIERA
 10352                                      ASTATEA
 10353                                      AACCTA
 10354                MOVE WT-CR-CARRIER TO ACARIERI
 10355                                      PI-SCR-CARRIER
 10356                                      PI-SAV-CARR
 10357                MOVE WT-CR-STATE   TO ASTATEI
 10358                                      PI-SCR-STATE
 10359                                      PI-SAV-STATE
 10360                MOVE WT-CR-ACCOUNT TO AACCTI
 10361                                      PI-SCR-ACCOUNT
 10362                                      PI-SAV-ACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL640.cbl
 10363                MOVE 1             TO ACARIERL
 10364                MOVE 10            TO AACCTL
 10365                MOVE 2             TO ASTATEL
 10366                MOVE -1            TO ABILTYPL
 10367            ELSE
 10368                IF ACCNT-CNTL
 10369                    MOVE AL-UANON       TO AACCTA
 10370                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10371                                           PI-SCR-ACCOUNT
 10372                                           PI-SAV-ACCT
 10373                    MOVE 10             TO AACCTL
 10374                    MOVE -1             TO ABILTYPL
 10375                ELSE
 10376                    IF CARR-ACCNT-CNTL
 10377                        MOVE AL-UANON        TO ACARIERA
 10378                                                AACCTA
 10379                        MOVE WT-CR-CARRIER   TO ACARIERI
 10380                                                PI-SCR-CARRIER
 10381                                                PI-SAV-CARR
 10382                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10383                                                PI-SCR-ACCOUNT
 10384                                                PI-SAV-ACCT
 10385                        MOVE 1               TO ACARIERL
 10386                        MOVE 10              TO AACCTL
 10387                        MOVE -1              TO ABILTYPL.
 10388
 10389
 10390* EXEC CICS SEND
 10391*        MAP      (PI-MAP-NAME)
 10392*        MAPSET   (MAPSET-NAME)
 10393*        FROM     (EL640AO)
 10394*        ERASE
 10395*        CURSOR
 10396*    END-EXEC.
 10397     MOVE LENGTH OF
 10398      EL640AO
 10399       TO DFHEIV12
 10400     MOVE -1
 10401       TO DFHEIV11
 10402*    MOVE '8$     CT  E    H L F ,   #00009674' TO DFHEIV0
 10403     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10404     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10405     MOVE X'2020233030303039363734' TO DFHEIV0(25:11)
 10406     CALL 'kxdfhei1' USING DFHEIV0,
 10407           PI-MAP-NAME,
 10408           EL640AO,
 10409           DFHEIV12,
 10410           MAPSET-NAME,
 10411           DFHEIV99,
 10412           DFHEIV99,
 10413           DFHEIV99,
 10414           DFHEIV11,
 10415           DFHEIV99,
 10416           DFHEIV99,
 10417           DFHEIV99
 10418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10419
 10420
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL640.cbl
 10421     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL640.cbl
 10423 8110-SEND-INITIAL-CHECK-MAP.
 10424     MOVE WS-CURRENT-DATE-EDIT   TO BDATEO.
 10425     MOVE EIBTIME                TO TIME-IN.
 10426     MOVE TIME-OUT               TO BTIMEO.
 10427     MOVE PI-COMPANY-ID          TO BCMPNYO.
 10428     MOVE PI-PROCESSOR-ID        TO BUSERIDO.
 10429     MOVE -1                     TO BPFNTERL.
 10430     MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO.
 10431
 10432
 10433* EXEC CICS SEND
 10434*        MAP      (PI-MAP-NAME)
 10435*        MAPSET   (MAPSET-NAME)
 10436*        FROM     (EL640BO)
 10437*        ERASE
 10438*        CURSOR
 10439*    END-EXEC.
 10440     MOVE LENGTH OF
 10441      EL640BO
 10442       TO DFHEIV12
 10443     MOVE -1
 10444       TO DFHEIV11
 10445*    MOVE '8$     CT  E    H L F ,   #00009693' TO DFHEIV0
 10446     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10447     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10448     MOVE X'2020233030303039363933' TO DFHEIV0(25:11)
 10449     CALL 'kxdfhei1' USING DFHEIV0,
 10450           PI-MAP-NAME,
 10451           EL640BO,
 10452           DFHEIV12,
 10453           MAPSET-NAME,
 10454           DFHEIV99,
 10455           DFHEIV99,
 10456           DFHEIV99,
 10457           DFHEIV11,
 10458           DFHEIV99,
 10459           DFHEIV99,
 10460           DFHEIV99
 10461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10462
 10463
 10464     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL640.cbl
 10466 8200-SEND-DATAONLY.
 10467     IF PI-MAP-NAME = EL640A
 10468         MOVE WS-CURRENT-DATE-EDIT   TO ADATEO
 10469         MOVE EIBTIME                TO TIME-IN
 10470         MOVE TIME-OUT               TO ATIMEO
 10471         MOVE PI-COMPANY-ID          TO CMPNYIDO
 10472         MOVE PI-PROCESSOR-ID        TO USERIDO
 10473         MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O
 10474         MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O
 10475
 10476* EXEC CICS SEND
 10477*            MAP      (PI-MAP-NAME)
 10478*            MAPSET   (MAPSET-NAME)
 10479*            FROM     (EL640AO)
 10480*            DATAONLY
 10481*            ERASEAUP
 10482*            CURSOR
 10483*        END-EXEC
 10484     MOVE LENGTH OF
 10485      EL640AO
 10486       TO DFHEIV12
 10487     MOVE -1
 10488       TO DFHEIV11
 10489*    MOVE '8$D    CT  A    H L F ,   #00009712' TO DFHEIV0
 10490     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10491     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10492     MOVE X'2020233030303039373132' TO DFHEIV0(25:11)
 10493     CALL 'kxdfhei1' USING DFHEIV0,
 10494           PI-MAP-NAME,
 10495           EL640AO,
 10496           DFHEIV12,
 10497           MAPSET-NAME,
 10498           DFHEIV99,
 10499           DFHEIV99,
 10500           DFHEIV99,
 10501           DFHEIV11,
 10502           DFHEIV99,
 10503           DFHEIV99,
 10504           DFHEIV99
 10505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10506     ELSE
 10507         MOVE WS-CURRENT-DATE-EDIT   TO BDATEO
 10508         MOVE EIBTIME                TO TIME-IN
 10509         MOVE TIME-OUT               TO BTIMEO
 10510         MOVE PI-COMPANY-ID          TO BCMPNYO
 10511         MOVE PI-PROCESSOR-ID        TO BUSERIDO
 10512         MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO
 10513
 10514* EXEC CICS SEND
 10515*            MAP      (PI-MAP-NAME)
 10516*            MAPSET   (MAPSET-NAME)
 10517*            FROM     (EL640BO)
 10518*            DATAONLY
 10519*            ERASEAUP
 10520*            CURSOR
 10521*        END-EXEC.
 10522     MOVE LENGTH OF
 10523      EL640BO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL640.cbl
 10524       TO DFHEIV12
 10525     MOVE -1
 10526       TO DFHEIV11
 10527*    MOVE '8$D    CT  A    H L F ,   #00009727' TO DFHEIV0
 10528     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10529     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10530     MOVE X'2020233030303039373237' TO DFHEIV0(25:11)
 10531     CALL 'kxdfhei1' USING DFHEIV0,
 10532           PI-MAP-NAME,
 10533           EL640BO,
 10534           DFHEIV12,
 10535           MAPSET-NAME,
 10536           DFHEIV99,
 10537           DFHEIV99,
 10538           DFHEIV99,
 10539           DFHEIV11,
 10540           DFHEIV99,
 10541           DFHEIV99,
 10542           DFHEIV99
 10543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10544
 10545
 10546     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL640.cbl
 10548 8300-SEND-TEXT.
 10549
 10550* EXEC CICS SEND TEXT
 10551*        FROM     (LOGOFF-TEXT)
 10552*        LENGTH   (LOGOFF-LENGTH)
 10553*        ERASE
 10554*        FREEKB
 10555*    END-EXEC.
 10556*    MOVE '8&      T  E F  H   F -   #00009739' TO DFHEIV0
 10557     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10558     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10559     MOVE X'2020233030303039373339' TO DFHEIV0(25:11)
 10560     CALL 'kxdfhei1' USING DFHEIV0,
 10561           LOGOFF-TEXT,
 10562           LOGOFF-LENGTH,
 10563           DFHEIV99,
 10564           DFHEIV99,
 10565           DFHEIV99,
 10566           DFHEIV99,
 10567           DFHEIV99,
 10568           DFHEIV99,
 10569           DFHEIV99,
 10570           DFHEIV99,
 10571           DFHEIV99,
 10572           DFHEIV99
 10573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10574
 10575
 10576
 10577* EXEC CICS RETURN
 10578*    END-EXEC.
 10579*    MOVE '.(                    &   #00009746' TO DFHEIV0
 10580     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10581     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10582     MOVE X'2020233030303039373436' TO DFHEIV0(25:11)
 10583     CALL 'kxdfhei1' USING DFHEIV0,
 10584           DFHEIV99,
 10585           DFHEIV99,
 10586           DFHEIV99,
 10587           DFHEIV99,
 10588           DFHEIV99
 10589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10590
 10591
 10592 8500-DATE-CONVERT.
 10593
 10594* EXEC CICS LINK
 10595*        PROGRAM  (LINK-ELDATCV)
 10596*        COMMAREA (DATE-CONVERSION-DATA)
 10597*        LENGTH   (DC-COMM-LENGTH)
 10598*    END-EXEC.
 10599*    MOVE '."C                   ''   #00009750' TO DFHEIV0
 10600     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10602     MOVE X'2020233030303039373530' TO DFHEIV0(25:11)
 10603     CALL 'kxdfhei1' USING DFHEIV0,
 10604           LINK-ELDATCV,
 10605           DATE-CONVERSION-DATA,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL640.cbl
 10606           DC-COMM-LENGTH,
 10607           DFHEIV99,
 10608           DFHEIV99,
 10609           DFHEIV99
 10610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10611
 10612
 10613 8500-EXIT.
 10614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL640.cbl
 10616 8800-UNAUTHORIZED-ACCESS.
 10617     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10618     GO TO 8300-SEND-TEXT.
 10619
 10620 8810-PF23.
 10621     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10622     MOVE XCTL-005               TO PGM-NAME.
 10623     GO TO 9300-XCTL.
 10624
 10625 8900-SYNCPOINT-ROLLBACK.
 10626
 10627* EXEC CICS SYNCPOINT
 10628*         ROLLBACK
 10629*    END-EXEC.
 10630*    MOVE '6"R                   !   #00009769' TO DFHEIV0
 10631     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10633     MOVE X'2020233030303039373639' TO DFHEIV0(25:11)
 10634     CALL 'kxdfhei1' USING DFHEIV0
 10635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10636
 10637
 10638 8900-EXIT.
 10639     EXIT.
 10640
 10641 9100-RETURN-TRAN.
 10642     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10643     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10644
 10645
 10646* EXEC CICS RETURN
 10647*        TRANSID    (TRANS-ID)
 10648*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10649*        LENGTH     (PI-COMM-LENGTH)
 10650*    END-EXEC.
 10651*    MOVE '.(CT                  &   #00009780' TO DFHEIV0
 10652     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10653     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10654     MOVE X'2020233030303039373830' TO DFHEIV0(25:11)
 10655     CALL 'kxdfhei1' USING DFHEIV0,
 10656           TRANS-ID,
 10657           PROGRAM-INTERFACE-BLOCK,
 10658           PI-COMM-LENGTH,
 10659           DFHEIV99,
 10660           DFHEIV99
 10661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10662
 10663
 10664 9200-RETURN-MAIN-MENU.
 10665     MOVE XCTL-626               TO PGM-NAME.
 10666     GO TO 9300-XCTL.
 10667
 10668 9300-XCTL.
 10669
 10670* EXEC CICS XCTL
 10671*        PROGRAM    (PGM-NAME)
 10672*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10673*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL640.cbl
 10674*    END-EXEC.
 10675*    MOVE '.$C                   $   #00009791' TO DFHEIV0
 10676     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10677     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10678     MOVE X'2020233030303039373931' TO DFHEIV0(25:11)
 10679     CALL 'kxdfhei1' USING DFHEIV0,
 10680           PGM-NAME,
 10681           PROGRAM-INTERFACE-BLOCK,
 10682           PI-COMM-LENGTH
 10683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10684
 10685
 10686 9400-CLEAR.
 10687     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 10688     GO TO 9300-XCTL.
 10689
 10690 9500-PF12.
 10691     MOVE XCTL-010               TO PGM-NAME.
 10692     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL640.cbl
 10694 9600-PGMID-ERROR.
 10695
 10696* EXEC CICS HANDLE CONDITION
 10697*        PGMIDERR    (8300-SEND-TEXT)
 10698*    END-EXEC.
 10699*    MOVE '"$L                   ! 1 #00009806' TO DFHEIV0
 10700     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10702     MOVE X'3120233030303039383036' TO DFHEIV0(25:11)
 10703     CALL 'kxdfhei1' USING DFHEIV0
 10704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10705
 10706
 10707     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10708     MOVE ' '                    TO PI-ENTRY-CD-1.
 10709     MOVE XCTL-005               TO PGM-NAME.
 10710     MOVE PGM-NAME               TO LOGOFF-PGM.
 10711     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10712     GO TO 9300-XCTL.
 10713
 10714 9900-ERROR-FORMAT.
 10715     IF NOT EMI-ERRORS-COMPLETE
 10716         MOVE LINK-001           TO PGM-NAME
 10717
 10718* EXEC CICS LINK
 10719*            PROGRAM    (PGM-NAME)
 10720*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10721*            LENGTH     (EMI-COMM-LENGTH)
 10722*        END-EXEC.
 10723*    MOVE '."C                   ''   #00009820' TO DFHEIV0
 10724     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10726     MOVE X'2020233030303039383230' TO DFHEIV0(25:11)
 10727     CALL 'kxdfhei1' USING DFHEIV0,
 10728           PGM-NAME,
 10729           ERROR-MESSAGE-INTERFACE-BLOCK,
 10730           EMI-COMM-LENGTH,
 10731           DFHEIV99,
 10732           DFHEIV99,
 10733           DFHEIV99
 10734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10735
 10736
 10737 9900-EXIT.
 10738     EXIT.
 10739
 10740 9990-ABEND.
 10741     MOVE LINK-004               TO PGM-NAME.
 10742     MOVE DFHEIBLK               TO EMI-LINE1.
 10743
 10744
 10745* EXEC CICS LINK
 10746*        PROGRAM   (PGM-NAME)
 10747*        COMMAREA  (EMI-LINE1)
 10748*        LENGTH    (72)
 10749*    END-EXEC.
 10750     MOVE 72
 10751       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL640.cbl
 10752*    MOVE '."C                   ''   #00009833' TO DFHEIV0
 10753     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10754     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10755     MOVE X'2020233030303039383333' TO DFHEIV0(25:11)
 10756     CALL 'kxdfhei1' USING DFHEIV0,
 10757           PGM-NAME,
 10758           EMI-LINE1,
 10759           DFHEIV11,
 10760           DFHEIV99,
 10761           DFHEIV99,
 10762           DFHEIV99
 10763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10764
 10765
 10766     IF PI-MAP-NAME = EL640A
 10767         MOVE -1 TO APFNTERL
 10768     ELSE
 10769         MOVE -1 TO BPFNTERL.
 10770
 10771     GO TO 8200-SEND-DATAONLY.
 10772
 10773 9995-SECURITY-VIOLATION.
 10774*                            COPY ELCSCTP.
 10775******************************************************************
 10776*                                                                *
 10777*                            ELCSCTP                             *
 10778*                            VMOD=2.001                          *
 10779*                                                                *
 10780*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10781******************************************************************
 10782
 10783
 10784     MOVE EIBDATE          TO SM-JUL-DATE.
 10785     MOVE EIBTRMID         TO SM-TERMID.
 10786     MOVE THIS-PGM         TO SM-PGM.
 10787     MOVE EIBTIME          TO TIME-IN.
 10788     MOVE TIME-OUT         TO SM-TIME.
 10789     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10790
 10791
 10792* EXEC CICS LINK
 10793*         PROGRAM  ('EL003')
 10794*         COMMAREA (SECURITY-MESSAGE)
 10795*         LENGTH   (80)
 10796*    END-EXEC.
 10797     MOVE 'EL003' TO DFHEIV1
 10798     MOVE 80
 10799       TO DFHEIV11
 10800*    MOVE '."C                   ''   #00009864' TO DFHEIV0
 10801     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10802     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10803     MOVE X'2020233030303039383634' TO DFHEIV0(25:11)
 10804     CALL 'kxdfhei1' USING DFHEIV0,
 10805           DFHEIV1,
 10806           SECURITY-MESSAGE,
 10807           DFHEIV11,
 10808           DFHEIV99,
 10809           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL640.cbl
 10810           DFHEIV99
 10811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10812
 10813
 10814******************************************************************
 10815
 10816
 10817
 10818 9999-DFHBACK SECTION.
 10819     MOVE '9%                    "   ' TO DFHEIV0
 10820     MOVE 'EL640' TO DFHEIV1
 10821     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10822     GOBACK.
 10823 9999-DFHEXIT.
 10824     IF DFHEIGDJ EQUAL 0001
 10825         NEXT SENTENCE
 10826     ELSE IF DFHEIGDJ EQUAL 2
 10827         GO TO 9600-PGMID-ERROR,
 10828               9990-ABEND
 10829         DEPENDING ON DFHEIGDI
 10830     ELSE IF DFHEIGDJ EQUAL 3
 10831         GO TO 0890-EXIT
 10832         DEPENDING ON DFHEIGDI
 10833     ELSE IF DFHEIGDJ EQUAL 4
 10834         GO TO 3930-BILL-NOTFND,
 10835               3930-BILL-NOTOPEN
 10836         DEPENDING ON DFHEIGDI
 10837     ELSE IF DFHEIGDJ EQUAL 5
 10838         GO TO 3940-EXIT
 10839         DEPENDING ON DFHEIGDI
 10840     ELSE IF DFHEIGDJ EQUAL 6
 10841         GO TO 4010-REC-NOT-FND
 10842         DEPENDING ON DFHEIGDI
 10843     ELSE IF DFHEIGDJ EQUAL 7
 10844         GO TO 4110-END-OF-FILE
 10845         DEPENDING ON DFHEIGDI
 10846     ELSE IF DFHEIGDJ EQUAL 8
 10847         GO TO 4270-PNDB-NOTFIND,
 10848               4280-PNDB-FILE-NOTOPEN
 10849         DEPENDING ON DFHEIGDI
 10850     ELSE IF DFHEIGDJ EQUAL 9
 10851         GO TO 4370-ACCOUNT-INVALID,
 10852               4380-ACCT-FILE-NOTOPEN
 10853         DEPENDING ON DFHEIGDI
 10854     ELSE IF DFHEIGDJ EQUAL 10
 10855         GO TO 4470-ACCOUNT-INVALID,
 10856               4480-ACCT-FILE-NOTOPEN
 10857         DEPENDING ON DFHEIGDI
 10858     ELSE IF DFHEIGDJ EQUAL 11
 10859         GO TO 4510-REC-NOT-FND
 10860         DEPENDING ON DFHEIGDI
 10861     ELSE IF DFHEIGDJ EQUAL 12
 10862         GO TO 4610-END-OF-FILE
 10863         DEPENDING ON DFHEIGDI
 10864     ELSE IF DFHEIGDJ EQUAL 13
 10865         GO TO 6070-NO-COMP-MSTR,
 10866               6080-COMP-FILE-NOTOPEN
 10867         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL640.cbl
 10868     ELSE IF DFHEIGDJ EQUAL 14
 10869         GO TO 6045-NO-COMP-MSTR,
 10870               6045-COMP-FILE-NOTOPEN
 10871         DEPENDING ON DFHEIGDI
 10872     ELSE IF DFHEIGDJ EQUAL 15
 10873         GO TO 6110-NO-RECORD
 10874         DEPENDING ON DFHEIGDI
 10875     ELSE IF DFHEIGDJ EQUAL 16
 10876         GO TO 7620-LETR-NOT-FOUND,
 10877               7620-LETR-NOT-FOUND,
 10878               7620-LETR-NOT-OPEN
 10879         DEPENDING ON DFHEIGDI
 10880     ELSE IF DFHEIGDJ EQUAL 17
 10881         GO TO 8300-SEND-TEXT
 10882         DEPENDING ON DFHEIGDI.
 10883     MOVE '9%                    "   ' TO DFHEIV0
 10884     MOVE 'EL640' TO DFHEIV1
 10885     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10886     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8572     Code:       34489
