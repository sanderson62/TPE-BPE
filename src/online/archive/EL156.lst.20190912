* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68* 082218  CR2018051400001  TANA  Hold and Pay
    69* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    70* 112018  CR2018102900001  TANA  REQUIRE EOB NOTE STARTING WITH F
    71* 040819  IR2019030400004  TANA  ADD EDITS FOR HOLD AND PAY
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   3
* EL156.cbl
    72* 043019  IR2019041900001  TANA  Correct total claim pymts msg
    73******************************************************************
    74
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   4
* EL156.cbl
    76 ENVIRONMENT DIVISION.
    77
    78 DATA DIVISION.
    79
    80 WORKING-STORAGE SECTION.
    81 01  DFH-START PIC X(04).
    82
    83 77  FILLER  PIC X(32)  VALUE '********************************'.
    84 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    85 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    86 77  WS-SSN  PIC X(9) VALUE ZEROS.
    87 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    88 77  C0                          PIC S999 COMP-3 VALUE +0.
    89 77  C1                          PIC S999 COMP-3 VALUE +0.
    90 77  C2                          PIC S999 COMP-3 VALUE +0.
    91 77  C3                          PIC S999 COMP-3 VALUE +0.
    92 77  s1                          PIC S999 COMP-3 VALUE +0.
    93 77  s2                          pic s999 comp-3 value +0.
    94 77  P1                          PIC S999 COMP-3 VALUE +0.
    95 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    98 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    99 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   100 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   101 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   102 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   103 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
   104 77  ws-max-bens                 pic s999 comp-3 value +0.
   105 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   106 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   107 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   108 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   109 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   110 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   111
   112*    COPY ELCSCTM.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCSCTM                             *
   117*                            VMOD=2.001                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   120*                                                                *
   121******************************************************************
   122 01  SECURITY-MESSAGE.
   123     12  FILLER                          PIC X(30)
   124            VALUE '** LOGIC SECURITY VIOLATION -'.
   125     12  SM-READ                         PIC X(6).
   126     12  FILLER                          PIC X(5)
   127            VALUE ' PGM='.
   128     12  SM-PGM                          PIC X(6).
   129     12  FILLER                          PIC X(5)
   130            VALUE ' OPR='.
   131     12  SM-PROCESSOR-ID                 PIC X(4).
   132     12  FILLER                          PIC X(6)
   133            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   5
* EL156.cbl
   134     12  SM-TERMID                       PIC X(4).
   135     12  FILLER                          PIC XX   VALUE SPACE.
   136     12  SM-JUL-DATE                     PIC 9(5).
   137     12  FILLER                          PIC X    VALUE SPACE.
   138     12  SM-TIME                         PIC 99.99.
   139
   140
   141*    COPY ELCSCRTY.
   142******************************************************************
   143*                                                                *
   144*                                                                *
   145*                            ELCSCRTY                            *
   146*                            VMOD=2.001                          *
   147*                                                                *
   148*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   149*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   150*        SAVED IN PI-SECURITY-ADDRESS.                           *
   151*                                                                *
   152******************************************************************
   153 01  SECURITY-CONTROL.
   154     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   155     12  FILLER                       PIC XX    VALUE 'SC'.
   156     12  SC-CREDIT-CODES.
   157         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   158             20  SC-CREDIT-DISPLAY    PIC X.
   159             20  SC-CREDIT-UPDATE     PIC X.
   160     12  SC-CLAIMS-CODES.
   161         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   162             20  SC-CLAIMS-DISPLAY    PIC X.
   163             20  SC-CLAIMS-UPDATE     PIC X.
   164
   165 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   166 01  WS-DATE-AREA.
   167     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   168     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   169     12  SAVE-DATE-CCYYMMDD.
   170         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   171         16  SAVE-DATE-YMD.
   172             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   173             20  FILLER              PIC X(04)   VALUE SPACES.
   174
   175 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   176 01  STANDARD-AREAS.
   177     12  WS-RESPONSE         PIC S9(8)   COMP.
   178         88  WS-RESP-NORMAL              VALUE +00.
   179         88  WS-RESP-ERROR               VALUE +01.
   180         88  WS-RESP-NOTFND              VALUE +13.
   181         88  WS-RESP-DUPREC              VALUE +14.
   182         88  WS-RESP-ENDFILE             VALUE +20.
   183     12  PMT-HEAD-A.
   184         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   185         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   186         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   187-        '     RESERVES  TYPE    AMOUNT'.
   188     12  PMT-HEAD-B.
   189         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   190         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   191         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   6
* EL156.cbl
   192     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   193     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   194     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   195     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   196     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   197     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   198     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   199     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   200     12  PGM-NAME            PIC X(8).
   201     12  TIME-IN             PIC S9(7).
   202     12  TIME-OUT-R  REDEFINES TIME-IN.
   203         16  FILLER          PIC X.
   204         16  TIME-OUT        PIC 99V99.
   205         16  FILLER          PIC XX.
   206     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   207     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   208     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   209     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   210     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   211     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   212     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   213     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   214     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   215     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   216     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   217     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   218     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   219     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   220     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   221     12  WS-BLANK            PIC X       VALUE ' '.
   222
   223 01  MISC-WORK-AREAS.
   224     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   225     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   226     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   227     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   228     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   229     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   230     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   231     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   232     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   233     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   234     12  W-CALLED-NAME           PIC X(08).
   235     12  W-EOB-CODES.
   236         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   237             20  W-EOB-CODE      PIC XXX.
   238             20  W-EOB-FILLER    PIC X.
   239     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   240     12  W-NAME-LAST             PIC X(15).
   241     12  W-NAME-FIRST            PIC X(15).
   242     12  W-NAME-MIDDLE.
   243         16  FILLER              PIC X.
   244         16  W-NAME-MIDDLE-2     PIC X.
   245         16  FILLER              PIC X(13).
   246     12  W-DMD-CHECK-NO.
   247         16  W-DMD-CHECK-NO-1    PIC X(4).
   248         16  W-DMD-CHECK-NO-2    PIC X.
   249         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   7
* EL156.cbl
   250
   251     12  WS-COMPUTE-FROM-DT  PIC XX.
   252     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   253     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   254     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   255     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   256     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   257     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   258         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   259         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   260     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   261         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   262     12  WS-UPDATE-SW        PIC X VALUE ' '.
   263     12  WS-GROUPING.
   264         16  WS-GROUP-1      PIC X VALUE SPACES.
   265         16  FILLER          PIC X(05) VALUE SPACES.
   266     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   267     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   268     12  WS-WORK-STATE-ACCT.
   269         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   270         16  FILLER          PIC X       VALUE '/'.
   271         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   272     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   273     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   274     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   275     12  QID.
   276         16  QID-TERM        PIC X(4)    VALUE SPACES.
   277         16  FILLER          PIC X(4)    VALUE '156A'.
   278     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   279     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   280     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   281     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   282     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   283     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   284     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   285     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   286     12  WS-STATUS           PIC X       VALUE SPACES.
   287     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   288     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   289     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   290     12  ws-extended-exp-dt  pic xx      value low-values.
   291     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   292     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   293     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   294     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   295     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   296     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   297     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   298     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   299     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   300     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   301     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   302     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   303     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   304     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   305     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   306     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   307     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   8
* EL156.cbl
   308     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   309     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   310     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   311     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   312     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   313     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   314     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   315     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   316     12  WORK-DATE-FROM.
   317         16  WDF-MONTH       PIC 99        VALUE ZERO.
   318         16  WDF-DAY         PIC 99        VALUE ZERO.
   319         16  WDF-YEAR        PIC 99        VALUE ZERO.
   320     12  WORK-DATE-THRU.
   321         16  WDT-MONTH       PIC 99        VALUE ZERO.
   322         16  WDT-DAY         PIC 99        VALUE ZERO.
   323         16  WDT-YEAR        PIC 99        VALUE ZERO.
   324     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   325     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   326     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   327     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   328     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   329     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   330     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   331     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   332     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   333     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   334     12  WS-PY-WK REDEFINES WS-PY-WORK.
   335         16  WS-PY-NUM       PIC S9(7)V99.
   336         16  WS-PY-SIGN      PIC X.
   337     12  WS-DY-WORK          PIC S9(5).
   338     12  WS-DY-WK REDEFINES WS-DY-WORK.
   339         16  WS-DY-NUM       PIC S9(4).
   340         16  WS-DY-SIGN      PIC X.
   341     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   342         88  COMP-REC-FOUND              VALUE 'Y'.
   343     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   344         88  BENEFIT-FOUND       VALUE 'Y'.
   345         88  NO-BENEFIT-FOUND    VALUE 'N'.
   346     12  WS-TERMS.
   347         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   348         16  FILLER          PIC X       VALUE '/'.
   349         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   350         16  WST-REM-DAYS-GRP.
   351             20  WST-SLASH   PIC X       VALUE '/'.
   352             20  WST-REM-DAYS
   353                             PIC --9.
   354     12  WS-ACCESS.
   355         16  FILLER          PIC XX      VALUE SPACES.
   356         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   357     12  WS-STATE-ACCESS.
   358         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   359         16  FILLER          PIC XX      VALUE SPACES.
   360     12  WS-CARR-ACCESS.
   361         16  FILLER          PIC X(3)    VALUE SPACES.
   362         16  WS-CARR         PIC X       VALUE SPACES.
   363     12  DATE-WORK.
   364         16  FILLER          PIC XX      VALUE SPACES.
   365         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page   9
* EL156.cbl
   366     12  WS-SAVE-INPUT.
   367         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   368         16  WS-PAYEE        PIC XX      VALUE SPACE.
   369         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   370         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   371         16  WS-OFFLINE      PIC X       VALUE SPACE.
   372         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   373         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   374         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   375         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   376         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   377         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   378         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   379         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   380         16  WS-ETYPE        PIC X       VALUE SPACE.
   381         16  WS-CASH         PIC X       VALUE SPACE.
   382         16  WS-GROUPED      PIC X       VALUE SPACE.
   383         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   384         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   385         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   386         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   387         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   388         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   389         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   390         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   391         16  ws-int-to-rem-borr pic x value spaces.
   392     12  LAST-ERROR-LINE.
   393         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   394         16  FILLER              PIC X(30)
   395             VALUE ' FATAL ERRORS ENCOUNTERED'.
   396         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   397         16  FILLER              PIC X(28)
   398             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   399     12  WS-CHECK-AREA.
   400         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   401         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   402     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   403     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   404         16  FILLER              PIC XX.
   405         16  WS-A-CHECK-NUM-5    PIC 9(5).
   406     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   407         16  FILLER              PIC X.
   408         16  WS-A-CHECK-NUM-6    PIC 9(6).
   409     12  OPTION-1-SAVE-AREA.
   410         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   411         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   412     12  WS-WORK-ZIP.
   413         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   414         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   415     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   416                                 PIC 9(9).
   417     12  WS-FLI-PMTNOTE.
   418         16  WS-PMTOPTION        PIC XX.
   419         16  WS-DOCNAME          PIC X(28).
   420         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   421             20  WS-AMOUNT       PIC X(8).
   422             20  FILLER          PIC X(20).
   423         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  10
* EL156.cbl
   424             20  WS-NUM-AMT      PIC 9(6)V99.
   425             20  FILLER          PIC X(20).
   426
   427     12  WS-HAN-PMTNOTE.
   428         16  WS-HAN-PMT-CODE     PIC X.
   429         16  WS-HAN-PMT-NOTE     PIC X(39).
   430
   431     12  WS-NCL-PMT-OPTION       PIC XX.
   432         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   433
   434     12  WS-CLAIM-SEQUENCE.
   435         16  FILLER              PIC X VALUE '('.
   436         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   437         16  FILLER              PIC X(04) VALUE ' OF '.
   438         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   439         16  FILLER              PIC X VALUE ')'.
   440
   441     12  WS-REFUND-AMT           PIC Z(7).99.
   442     12  WS-CALC-INT             PIC S9(7)V99.
   443     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   444
   445     12  SUB                     PIC 99 VALUE ZEROS.
   446
   447     12  WS-BOANOTE1.
   448         16  WS-BOANOTE1-DESC    PIC X(11).
   449         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   450         16  FILLER              PIC X(17).
   451     12  WS-BOANOTE2.
   452         16  WS-BOANOTE2-DESC    PIC X(11).
   453         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   454         16  FILLER              PIC X(17).
   455
   456     12  WS-NCLNOTE1.
   457         16  WS-NCLNOTE1-DESC    PIC X(11).
   458         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   459         16  FILLER              PIC X(17).
   460     12  WS-NCLNOTE2.
   461         16  WS-NCLNOTE2-DESC    PIC X(11).
   462         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   463         16  FILLER              PIC X(17).
   464
   465     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   466     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   467     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   468     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   469     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   470     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   471     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   472     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   473     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   474     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   475
   476     12  WS-AIG-WORK-AREAS.
   477         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   478             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   479         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   480             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   481         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  11
* EL156.cbl
   482             20  WS-FROM-MO      PIC 99.
   483             20  WS-FROM-DA      PIC 99.
   484             20  WS-FROM-YR      PIC 99.
   485         16  WS-TEMP-DATE-MDY.
   486             20  WS-TEMP-MO      PIC 99.
   487             20  WS-TEMP-DA      PIC 99.
   488             20  WS-TEMP-YR      PIC 99.
   489         16  WS-BIN-FROM-DT      PIC XX.
   490         16  WS-TEMP-INC-MDY.
   491             20  WS-TEMP-INC-MO  PIC 99.
   492             20  WS-TEMP-INC-DA  PIC 99.
   493             20  WS-TEMP-INC-YR  PIC 99.
   494         16  WS-PMT-DUE-MDY.
   495             20  WS-PMT-DUE-MO   PIC 99.
   496             20  WS-PMT-DUE-DA   PIC 99.
   497             20  WS-PMT-DUE-YR   PIC 99.
   498         16  WS-PMT-DUE-DT       PIC XX.
   499         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   500         16  WS-RETRO-ELIM-DT    PIC XX.
   501         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   502             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   503         16  WS-SAVE-DUE-DA      PIC 99.
   504         16  WS-CDAYS            PIC S9(05).
   505         16  WS-DAYS-OFF         PIC S9(05).
   506         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   507             88  ELIM-SATISFIED            VALUE 'Y'.
   508         16  WS-AIG-CHECKNO.
   509             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   510             20  WS-A-CHECKNO-3-7.
   511                 24  FILLER              PIC X(3)    VALUE SPACES.
   512                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   513                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   514         16  WS-AIG-GROUPING.
   515             20  WS-A-BENE               PIC XXX.
   516             20  FILLER                  PIC XXX.
   517         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   518             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   519             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   520         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   521                 VALUE 'UNEMPLOYMENT PAYMENT'.
   522         16  WS-CHK-THRU-DT              PIC XX.
   523         16  WS-HOLD-BIN-DATE-1          PIC XX.
   524
   525 01  MISC-CSO-AREA.
   526     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   527     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   528     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   529         88  APPROVAL-NEEDED                        VALUE 'Y'.
   530     12  WS-APPROV-NOTE                  PIC X(43)
   531         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   532     12  WS-3550-APPROV-NOTE             PIC X(43)
   533         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   534     12  WS-DUPE-APPROV-NOTE             PIC X(43)
   535         VALUE 'APPROVAL NEEDED - DUPLICATE PAYMENT EXISTS '.
   536     12  WS-REAUDIT-NOTE                 PIC X(43)
   537         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   538     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   539     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  12
* EL156.cbl
   540     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   541     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   542     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   543     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   544     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   545         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   546     12  WS-PAYEE-CITY-STATE     PIC X(30).
   547     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   548         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   549     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   550     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   551     12  WS-WORK-NAME            PIC X(30).
   552     12  FILLER  REDEFINES WS-WORK-NAME.
   553         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   554     12  WS-INSURED-NAME         PIC X(30).
   555     12  FILLER  REDEFINES WS-INSURED-NAME.
   556         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   557     12  WS-PAYEE-NAME           PIC X(30).
   558     12  FILLER  REDEFINES WS-PAYEE-NAME.
   559         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   560     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   561         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   562         88  HOLD-UNTIL-PMT            VALUE 'P'.
   563     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   564     12  WS-UNPAID-HOLD-UNTIL-SW PIC X VALUE SPACES.
   565         88  UNPAID-HOLD-UNTIL-EXISTS  VALUE 'Y'.
   566     12  WS-DUPE-VOID-PMT-SW     PIC X VALUE SPACES.
   567         88  DUPE-VOID-PMT-EXISTS      VALUE 'Y'.
   568     12  WS-CHECK-ALL-PMTS-SW    PIC X VALUE SPACES.
   569         88  CHECK-ALL-PMTS            VALUE 'Y'.
   570     12  WS-TOT-AMOUNT-PAID      PIC S9(7)V99  COMP-3 VALUE ZERO.
   571     12  WS-UNPD-HOLD-UNTIL-DT   PIC X(02) VALUE ZERO.
   572
   573 01  ERROR-MESSAGES.
   574     12  ER-0000                 PIC X(4)  VALUE '0000'.
   575     12  ER-0004                 PIC X(4)  VALUE '0004'.
   576     12  ER-0008                 PIC X(4)  VALUE '0008'.
   577     12  ER-0019                 PIC X(4)  VALUE '0019'.
   578     12  ER-0029                 PIC X(4)  VALUE '0029'.
   579     12  ER-0042                 PIC X(4)  VALUE '0042'.
   580     12  ER-0070                 PIC X(4)  VALUE '0070'.
   581     12  ER-0130                 PIC X(4)  VALUE '0130'.
   582     12  ER-0149                 PIC X(4)  VALUE '0149'.
   583     12  ER-0154                 PIC X(4)  VALUE '0154'.
   584     12  ER-0168                 PIC X(4)  VALUE '0168'.
   585     12  ER-0169                 PIC X(4)  VALUE '0169'.
   586     12  ER-0172                 PIC X(4)  VALUE '0174'.
   587     12  ER-0198                 PIC X(4)  VALUE '0198'.
   588     12  ER-0204                 PIC X(4)  VALUE '0204'.
   589     12  ER-0206                 PIC X(4)  VALUE '0206'.
   590     12  ER-0252                 PIC X(4)  VALUE '0252'.
   591     12  ER-0254                 PIC X(4)  VALUE '0254'.
   592     12  ER-0282                 PIC X(4)  VALUE '0282'.
   593     12  ER-0283                 PIC X(4)  VALUE '0283'.
   594     12  ER-0294                 PIC X(4)  VALUE '0294'.
   595     12  ER-0338                 PIC X(4)  VALUE '0338'.
   596     12  ER-0419                 PIC X(4)  VALUE '0419'.
   597     12  ER-0420                 PIC X(4)  VALUE '0420'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  13
* EL156.cbl
   598     12  ER-0421                 PIC X(4)  VALUE '0421'.
   599     12  ER-0422                 PIC X(4)  VALUE '0422'.
   600     12  ER-0433                 PIC X(4)  VALUE '0433'.
   601     12  ER-0436                 PIC X(4)  VALUE '0436'.
   602     12  ER-0437                 PIC X(4)  VALUE '0437'.
   603     12  ER-0438                 PIC X(4)  VALUE '0438'.
   604     12  ER-0439                 PIC X(4)  VALUE '0439'.
   605     12  ER-0440                 PIC X(4)  VALUE '0440'.
   606     12  ER-0441                 PIC X(4)  VALUE '0441'.
   607     12  ER-0442                 PIC X(4)  VALUE '0442'.
   608     12  ER-0443                 PIC X(4)  VALUE '0443'.
   609     12  ER-0444                 PIC X(4)  VALUE '0444'.
   610     12  ER-0445                 PIC X(4)  VALUE '0445'.
   611     12  ER-0446                 PIC X(4)  VALUE '0446'.
   612     12  ER-0447                 PIC X(4)  VALUE '0447'.
   613     12  ER-0448                 PIC X(4)  VALUE '0448'.
   614     12  ER-0449                 PIC X(4)  VALUE '0449'.
   615     12  ER-0452                 PIC X(4)  VALUE '0452'.
   616     12  ER-0458                 PIC X(4)  VALUE '0458'.
   617     12  ER-0459                 PIC X(4)  VALUE '0459'.
   618     12  ER-0460                 PIC X(4)  VALUE '0460'.
   619     12  ER-0461                 PIC X(4)  VALUE '0461'.
   620     12  ER-0462                 PIC X(4)  VALUE '0462'.
   621     12  ER-0463                 PIC X(4)  VALUE '0463'.
   622     12  ER-0464                 PIC X(4)  VALUE '0464'.
   623     12  ER-0465                 PIC X(4)  VALUE '0465'.
   624     12  ER-0466                 PIC X(4)  VALUE '0466'.
   625     12  ER-0467                 PIC X(4)  VALUE '0467'.
   626     12  ER-0468                 PIC X(4)  VALUE '0468'.
   627     12  ER-0469                 PIC X(4)  VALUE '0469'.
   628     12  ER-0473                 PIC X(4)  VALUE '0473'.
   629     12  ER-0474                 PIC X(4)  VALUE '0474'.
   630     12  ER-0475                 PIC X(4)  VALUE '0475'.
   631     12  ER-0476                 PIC X(4)  VALUE '0476'.
   632     12  ER-0477                 PIC X(4)  VALUE '0477'.
   633     12  ER-0478                 PIC X(4)  VALUE '0478'.
   634     12  ER-0479                 PIC X(4)  VALUE '0479'.
   635     12  ER-0481                 PIC X(4)  VALUE '0481'.
   636     12  ER-0491                 PIC X(4)  VALUE '0491'.
   637     12  ER-0492                 PIC X(4)  VALUE '0492'.
   638     12  ER-0493                 PIC X(4)  VALUE '0493'.
   639     12  ER-0494                 PIC X(4)  VALUE '0494'.
   640     12  ER-0495                 PIC X(4)  VALUE '0495'.
   641     12  ER-0499                 PIC X(4)  VALUE '0499'.
   642     12  ER-0500                 PIC X(4)  VALUE '0500'.
   643     12  ER-0501                 PIC X(4)  VALUE '0501'.
   644     12  ER-0502                 PIC X(4)  VALUE '0502'.
   645     12  ER-0508                 PIC X(4)  VALUE '0508'.
   646     12  ER-0513                 PIC X(4)  VALUE '0513'.
   647     12  ER-0518                 PIC X(4)  VALUE '0518'.
   648     12  ER-0524                 PIC X(4)  VALUE '0524'.
   649     12  ER-0525                 PIC X(4)  VALUE '0525'.
   650     12  ER-0526                 PIC X(4)  VALUE '0526'.
   651     12  ER-0530                 PIC X(4)  VALUE '0530'.
   652     12  ER-0540                 PIC X(4)  VALUE '0540'.
   653     12  ER-0541                 PIC X(4)  VALUE '0541'.
   654     12  ER-0542                 PIC X(4)  VALUE '0542'.
   655     12  ER-0543                 PIC X(4)  VALUE '0543'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  14
* EL156.cbl
   656     12  ER-0545                 PIC X(4)  VALUE '0545'.
   657     12  ER-0552                 PIC X(4)  VALUE '0552'.
   658     12  ER-0555                 PIC X(4)  VALUE '0555'.
   659     12  ER-0556                 PIC X(4)  VALUE '0556'.
   660     12  ER-0557                 PIC X(4)  VALUE '0557'.
   661     12  ER-0572                 PIC X(4)  VALUE '0572'.
   662     12  ER-0573                 PIC X(4)  VALUE '0573'.
   663     12  ER-0594                 PIC X(4)  VALUE '0594'.
   664     12  ER-0616                 PIC X(4)  VALUE '0616'.
   665     12  ER-0617                 PIC X(4)  VALUE '0617'.
   666     12  ER-0618                 PIC X(4)  VALUE '0618'.
   667     12  ER-0657                 PIC X(4)  VALUE '0657'.
   668     12  ER-0658                 PIC X(4)  VALUE '0658'.
   669     12  ER-0699                 PIC X(4)  VALUE '0699'.
   670     12  ER-0730                 PIC X(4)  VALUE '0730'.
   671     12  ER-0737                 PIC X(4)  VALUE '0737'.
   672     12  ER-0760                 PIC X(4)  VALUE '0760'.
   673     12  ER-0768                 PIC X(4)  VALUE '0768'.
   674     12  ER-0769                 PIC X(4)  VALUE '0769'.
   675     12  ER-0770                 PIC X(4)  VALUE '0770'.
   676     12  ER-0802                 PIC X(4)  VALUE '0802'.
   677     12  ER-0803                 PIC X(4)  VALUE '0803'.
   678     12  ER-0819                 PIC X(4)  VALUE '0819'.
   679     12  ER-0834                 PIC X(4)  VALUE '0834'.
   680     12  ER-0836                 PIC X(4)  VALUE '0836'.
   681     12  ER-0844                 PIC X(4)  VALUE '0844'.
   682     12  ER-0845                 PIC X(4)  VALUE '0845'.
   683     12  ER-0846                 PIC X(4)  VALUE '0846'.
   684     12  ER-0849                 PIC X(4)  VALUE '0849'.
   685     12  ER-0851                 PIC X(4)  VALUE '0851'.
   686     12  ER-0872                 PIC X(4)  VALUE '0872'.
   687     12  ER-0873                 PIC X(4)  VALUE '0873'.
   688     12  ER-0874                 PIC X(4)  VALUE '0874'.
   689     12  ER-0879                 PIC X(4)  VALUE '0879'.
   690     12  ER-0919                 PIC X(4)  VALUE '0919'.
   691     12  ER-0921                 PIC X(4)  VALUE '0921'.
   692     12  ER-0923                 PIC X(4)  VALUE '0923'.
   693     12  ER-0925                 PIC X(4)  VALUE '0925'.
   694     12  ER-0944                 PIC X(4)  VALUE '0944'.
   695     12  ER-0945                 PIC X(4)  VALUE '0945'.
   696     12  ER-0946                 PIC X(4)  VALUE '0946'.
   697     12  ER-0947                 PIC X(4)  VALUE '0947'.
   698     12  ER-0948                 PIC X(4)  VALUE '0948'.
   699     12  ER-0949                 PIC X(4)  VALUE '0949'.
   700     12  ER-0950                 PIC X(4)  VALUE '0950'.
   701     12  ER-0951                 PIC X(4)  VALUE '0951'.
   702     12  ER-0954                 PIC X(4)  VALUE '0954'.
   703     12  ER-0956                 PIC X(4)  VALUE '0956'.
   704     12  ER-0967                 PIC X(4)  VALUE '0967'.
   705     12  ER-0968                 PIC X(4)  VALUE '0968'.
   706     12  ER-0974                 PIC X(4)  VALUE '0974'.
   707     12  ER-0975                 PIC X(4)  VALUE '0975'.
   708     12  ER-1561                 PIC X(4)  VALUE '1561'.
   709     12  ER-1566                 PIC X(4)  VALUE '1566'.
   710     12  ER-1567                 PIC X(4)  VALUE '1567'.
   711     12  ER-1569                 PIC X(4)  VALUE '1569'.
   712     12  er-1582                 pic x(4)  value '1582'.
   713     12  er-1657                 pic x(4)  value '1657'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  15
* EL156.cbl
   714     12  er-1658                 pic x(4)  value '1658'.
   715     12  er-1667                 pic x(4)  value '1667'.
   716     12  er-1670                 pic x(4)  value '1670'.
   717     12  er-1671                 pic x(4)  value '1671'.
   718     12  er-1672                 pic x(4)  value '1672'.
   719     12  er-1673                 pic x(4)  value '1673'.
   720     12  er-1674                 pic x(4)  value '1674'.
   721     12  er-1677                 pic x(4)  value '1677'.
   722     12  ER-1775                 PIC X(4)  VALUE '1775'.
   723     12  ER-1880                 PIC X(4)  VALUE '1880'.
   724     12  ER-1930                 PIC X(4)  VALUE '1930'.
   725     12  ER-2044                 PIC X(4)  VALUE '2044'.
   726     12  ER-3140                 PIC X(4)  VALUE '3140'.
   727     12  ER-3141                 PIC X(4)  VALUE '3141'.
   728     12  ER-3255                 PIC X(4)  VALUE '3255'.
   729     12  ER-3272                 PIC X(4)  VALUE '3272'.
   730     12  ER-3276                 PIC X(4)  VALUE '3276'.
   731     12  ER-3277                 PIC X(4)  VALUE '3277'.
   732     12  ER-3278                 PIC X(4)  VALUE '3278'.
   733     12  ER-3279                 PIC X(4)  VALUE '3279'.
   734     12  ER-3280                 PIC X(4)  VALUE '3280'.
   735     12  ER-3516                 PIC X(4)  VALUE '3516'.
   736     12  ER-3527                 PIC X(4)  VALUE '3527'.
   737     12  ER-3528                 PIC X(4)  VALUE '3528'.
   738     12  ER-3529                 PIC X(4)  VALUE '3529'.
   739     12  ER-3530                 PIC X(4)  VALUE '3530'.
   740     12  ER-3531                 PIC X(4)  VALUE '3531'.
   741     12  ER-3532                 PIC X(4)  VALUE '3532'.
   742     12  ER-3533                 PIC X(4)  VALUE '3533'.
   743     12  ER-3534                 PIC X(4)  VALUE '3534'.
   744     12  ER-3535                 PIC X(4)  VALUE '3535'.
   745     12  ER-3536                 PIC X(4)  VALUE '3536'.
   746     12  ER-3537                 PIC X(4)  VALUE '3537'.
   747     12  ER-3538                 PIC X(4)  VALUE '3538'.
   748     12  ER-3539                 PIC X(4)  VALUE '3539'.
   749     12  ER-3540                 PIC X(4)  VALUE '3540'.
   750     12  ER-3541                 PIC X(4)  VALUE '3541'.
   751     12  ER-3542                 PIC X(4)  VALUE '3542'.
   752     12  ER-3543                 PIC X(4)  VALUE '3543'.
   753     12  ER-3546                 PIC X(4)  VALUE '3546'.
   754     12  ER-3549                 PIC X(4)  VALUE '3549'.
   755     12  ER-3551                 PIC X(4)  VALUE '3551'.
   756     12  ER-3818                 PIC X(4)  VALUE '3818'.
   757     12  ER-7540                 PIC X(4)  VALUE '7540'.
   758     12  ER-7576                 PIC X(4)  VALUE '7576'.
   759     12  ER-7579                 PIC X(4)  VALUE '7579'.
   760     12  ER-7580                 PIC X(4)  VALUE '7580'.
   761     12  ER-7583                 PIC X(4)  VALUE '7583'.
   762     12  ER-7585                 PIC X(4)  VALUE '7585'.
   763     12  ER-7830                 PIC X(4)  VALUE '7830'.
   764     12  ER-7831                 PIC X(4)  VALUE '7831'.
   765     12  ER-7832                 PIC X(4)  VALUE '7832'.
   766     12  ER-7833                 PIC X(4)  VALUE '7833'.
   767     12  ER-7834                 PIC X(4)  VALUE '7834'.
   768     12  ER-7835                 PIC X(4)  VALUE '7835'.
   769     12  ER-7836                 PIC X(4)  VALUE '7836'.
   770     12  ER-7837                 PIC X(4)  VALUE '7837'.
   771     12  ER-7838                 PIC X(4)  VALUE '7838'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  16
* EL156.cbl
   772     12  ER-7841                 PIC X(4)  VALUE '7841'.
   773     12  ER-7844                 PIC X(4)  VALUE '7844'.
   774     12  ER-7845                 PIC X(4)  VALUE '7845'.
   775     12  ER-8000                 PIC X(4)  VALUE '8000'.
   776     12  ER-8051                 PIC X(4)  VALUE '8051'.
   777     12  ER-8052                 PIC X(4)  VALUE '8052'.
   778     12  ER-8053                 PIC X(4)  VALUE '8053'.
   779     12  ER-8054                 PIC X(4)  VALUE '8054'.
   780     12  ER-8055                 PIC X(4)  VALUE '8055'.
   781     12  ER-8056                 PIC X(4)  VALUE '8056'.
   782     12  ER-8057                 PIC X(4)  VALUE '8057'.
   783     12  ER-8058                 PIC X(4)  VALUE '8058'.
   784     12  ER-8059                 PIC X(4)  VALUE '8059'.
   785     12  ER-8060                 PIC X(4)  VALUE '8060'.
   786     12  ER-8061                 PIC X(4)  VALUE '8061'.
   787     12  ER-8062                 PIC X(4)  VALUE '8062'.
   788     12  ER-8063                 PIC X(4)  VALUE '8063'.
   789     12  ER-8064                 PIC X(4)  VALUE '8064'.
   790     12  ER-8065                 PIC X(4)  VALUE '8065'.
   791     12  ER-8066                 PIC X(4)  VALUE '8066'.
   792     12  ER-8146                 PIC X(4)  VALUE '8146'.
   793     12  ER-8147                 PIC X(4)  VALUE '8147'.
   794     12  ER-8152                 PIC X(4)  VALUE '8152'.
   795     12  ER-8153                 PIC X(4)  VALUE '8153'.
   796     12  ER-8154                 PIC X(4)  VALUE '8154'.
   797     12  ER-8155                 PIC X(4)  VALUE '8155'.
   798     12  ER-8310                 PIC X(4)  VALUE '8310'.
   799     12  ER-8311                 PIC X(4)  VALUE '8311'.
   800     12  ER-8312                 PIC X(4)  VALUE '8312'.
   801     12  ER-8313                 PIC X(4)  VALUE '8313'.
   802     12  ER-8314                 PIC X(4)  VALUE '8314'.
   803     12  ER-8315                 PIC X(4)  VALUE '8315'.
   804     12  ER-8316                 PIC X(4)  VALUE '8316'.
   805     12  ER-8317                 PIC X(4)  VALUE '8317'.
   806
   807 01  CSO-WORK-FIELDS.
   808     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   809       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   810
   811     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   812     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   813         88  CERT-NOTE-ADDED           VALUE 'Y'.
   814     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   815         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   816     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   817
   818     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   819
   820 01  SC-NP6-CERT-NOTE.
   821     12  FILLER                  PIC X(12)
   822               VALUE 'REM BENEFIT '.
   823     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   824     12  SC-NP6-COMM             PIC X(8)
   825               VALUE ' + 6 MO '.
   826     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   827     12  FILLER                  PIC X(12)
   828               VALUE ' = AMT PAID '.
   829     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  17
* EL156.cbl
   830
   831 01  SC-NP6-ORIG-NOTE.
   832     12  FILLER                  PIC X(63)  VALUE
   833         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   834 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   835     88  PDEF-FOUND                   VALUE 'Y'.
   836 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   837     88  ACCT-FOUND                   VALUE 'Y'.
   838 01  CTBL-KEY-SAVE               PIC X(5).
   839 01  CTBL-KEY.
   840     05  CTBL-COMPANY-CD         PIC X.
   841     05  CTBL-TABLE              PIC XXX.
   842     05  CTBL-BEN-TYPE           PIC X.
   843     05  CTBL-BEN-CODE           PIC XX.
   844 01  ERPDEF-KEY-SAVE             PIC X(18).
   845 01  ERPDEF-KEY.
   846     12  ERPDEF-COMPANY-CD       PIC X.
   847     12  ERPDEF-STATE            PIC XX.
   848     12  ERPDEF-PROD-CD          PIC XXX.
   849     12  F                       PIC X(7).
   850     12  ERPDEF-BEN-TYPE         PIC X.
   851     12  ERPDEF-BEN-CODE         PIC XX.
   852     12  ERPDEF-EXP-DT           PIC XX.
   853 01  ELCRTT-KEY.
   854     05  CTRLR-COMP-CD       PIC X.
   855     05  CTRLR-CARRIER       PIC X.
   856     05  CTRLR-GROUPING      PIC X(6).
   857     05  CTRLR-STATE         PIC X(2).
   858     05  CTRLR-ACCOUNT       PIC X(10).
   859     05  CTRLR-EFF-DT        PIC XX.
   860     05  CTRLR-CERT-NO       PIC X(11).
   861     05  CTRLR-REC-TYPE      PIC X.
   862 01  ACCESS-KEYS.
   863     12  ELARCH-KEY.
   864         16  ARCH-CO             PIC X.
   865         16  ARCH-NUMBER         PIC S9(08) COMP.
   866         16  ARCH-REC-TYPE       PIC X.
   867         16  ARCH-SEQ            PIC S9(04) COMP.
   868     12  ELMSTR-KEY.
   869         16  MSTR-COMP-CD        PIC X.
   870         16  MSTR-CARRIER        PIC X.
   871         16  MSTR-CLAIM-NO       PIC X(7).
   872         16  MSTR-CERT-NO        PIC X(11).
   873     12  ELCNTL-KEY.
   874         16  CNTL-COMP-ID        PIC X(3).
   875         16  CNTL-REC-TYPE       PIC X.
   876         16  CNTL-ACCESS         PIC X(4).
   877         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   878     12  ELCERT-KEY.
   879         16  CERT-COMP-CD        PIC X.
   880         16  CERT-CARRIER        PIC X.
   881         16  CERT-GROUPING       PIC X(6).
   882         16  CERT-STATE          PIC XX.
   883         16  CERT-ACCOUNT        PIC X(10).
   884         16  CERT-EFF-DT         PIC XX.
   885         16  CERT-CERT-NO        PIC X(11).
   886     12  ELTRLR-KEY.
   887         16  TRLR-COMP-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  18
* EL156.cbl
   888         16  TRLR-CARRIER        PIC X.
   889         16  TRLR-CLAIM-NO       PIC X(7).
   890         16  TRLR-CERT-NO        PIC X(11).
   891         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   892     12  ELACTQ-KEY.
   893         16  ACTQ-COMP-CD        PIC X.
   894         16  ACTQ-CARRIER        PIC X.
   895         16  ACTQ-CLAIM-NO       PIC X(7).
   896         16  ACTQ-CERT-NO        PIC X(11).
   897     12  W-NOTE-KEY.
   898         16  W-NOTE-COMP-CD      PIC X.
   899         16  W-NOTE-CERT-KEY.
   900             20  W-NOTE-CARRIER  PIC X.
   901             20  W-NOTE-GROUPING PIC X(6).
   902             20  W-NOTE-STATE    PIC XX.
   903             20  W-NOTE-ACCOUNT  PIC X(10).
   904             20  W-NOTE-EFF-DT   PIC XX.
   905             20  W-NOTE-CERT-NO  PIC X(11).
   906     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   907     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   908     12  ERACCT-KEY.
   909         16  ERACCT-PARTIAL-KEY.
   910             20  ACCT-COMP-CD    PIC X.
   911             20  ACCT-CARRIER    PIC X.
   912             20  ACCT-GROUPING   PIC X(6).
   913             20  ACCT-STATE      PIC XX.
   914             20  ACCT-ACCOUNT    PIC X(10).
   915         16  ACCT-EXP-DT         PIC XX.
   916         16  FILLER              PIC X(4) VALUE SPACES.
   917     12  ELCHKQ-KEY.
   918         16  CHKQ-COMP-CD        PIC X.
   919         16  CHKQ-CONTROL        PIC S9(8) COMP.
   920         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   921     12  ELBENE-KEY.
   922         16  BENE-COMP-CD         PIC X.
   923         16  BENE-RECORD-TYPE     PIC X.
   924         16  BENE-NUMBER          PIC X(10).
   925     12  ERCOMP-KEY.
   926         16  COMP-COMP-CD        PIC X.
   927         16  COMP-CARRIER        PIC X.
   928         16  COMP-GROUP          PIC X(06).
   929         16  COMP-FIN-RESP       PIC X(10).
   930         16  COMP-ACCOUNT        PIC X(10).
   931         16  COMP-TYPE           PIC X.
   932
   933     12  DLO035-KEY.
   934         16  DL35-PROCESS-TYPE   PIC X.
   935         16  DL35-CREDIT-CARD    PIC X(20).
   936         16  DL35-BEN-TYPE       PIC XX.
   937         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   938         16  DL35-RETURN-CODE    PIC XX.
   939
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  19
* EL156.cbl
   941*    COPY ELCDATE.
   942******************************************************************
   943*                                                                *
   944*                                                                *
   945*                            ELCDATE.                            *
   946*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   947*                            VMOD=2.003
   948*                                                                *
   949*                                                                *
   950*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   951*                 LENGTH = 200                                   *
   952******************************************************************
   953
   954 01  DATE-CONVERSION-DATA.
   955     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   956     12  DC-OPTION-CODE                PIC X.
   957         88  BIN-TO-GREG                VALUE ' '.
   958         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   959         88  EDIT-GREG-TO-BIN           VALUE '2'.
   960         88  YMD-GREG-TO-BIN            VALUE '3'.
   961         88  MDY-GREG-TO-BIN            VALUE '4'.
   962         88  JULIAN-TO-BIN              VALUE '5'.
   963         88  BIN-PLUS-ELAPSED           VALUE '6'.
   964         88  FIND-CENTURY               VALUE '7'.
   965         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   966         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   967         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   968         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   969         88  JULIAN-TO-BIN-3            VALUE 'C'.
   970         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   971         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   972         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   973         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   974         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   975         88  CHECK-LEAP-YEAR            VALUE 'H'.
   976         88  BIN-3-TO-GREG              VALUE 'I'.
   977         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   978         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   979         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   980         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   981         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   982         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   983         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   984         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   985         88  THREE-CHARACTER-BIN
   986                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   987         88  GREGORIAN-TO-BIN
   988                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   989         88  BIN-TO-GREGORIAN
   990                  VALUES ' ' '1' 'I' '8' 'G'.
   991         88  JULIAN-TO-BINARY
   992                  VALUES '5' 'C' 'E' 'F'.
   993     12  DC-ERROR-CODE                 PIC X.
   994         88  NO-CONVERSION-ERROR        VALUE ' '.
   995         88  DATE-CONVERSION-ERROR
   996                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   997         88  DATE-IS-ZERO               VALUE '1'.
   998         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  20
* EL156.cbl
   999         88  DATE-IS-INVALID            VALUE '3'.
  1000         88  DATE1-GREATER-DATE2        VALUE '4'.
  1001         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1002         88  DATE-INVALID-OPTION        VALUE '9'.
  1003         88  INVALID-CENTURY            VALUE 'A'.
  1004         88  ONLY-CENTURY               VALUE 'B'.
  1005         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1006         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1007     12  DC-END-OF-MONTH               PIC X.
  1008         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1009     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1010         88  USE-NORMAL-PROCESS         VALUE ' '.
  1011         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1012         88  ADJUST-UP-100-YRS          VALUE '2'.
  1013     12  FILLER                        PIC X.
  1014     12  DC-CONVERSION-DATES.
  1015         16  DC-BIN-DATE-1             PIC XX.
  1016         16  DC-BIN-DATE-2             PIC XX.
  1017         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1018         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1019                       DC-GREG-DATE-1-EDIT.
  1020             20  DC-EDIT1-MONTH        PIC 99.
  1021             20  SLASH1-1              PIC X.
  1022             20  DC-EDIT1-DAY          PIC 99.
  1023             20  SLASH1-2              PIC X.
  1024             20  DC-EDIT1-YEAR         PIC 99.
  1025         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1026         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1027                     DC-GREG-DATE-2-EDIT.
  1028             20  DC-EDIT2-MONTH        PIC 99.
  1029             20  SLASH2-1              PIC X.
  1030             20  DC-EDIT2-DAY          PIC 99.
  1031             20  SLASH2-2              PIC X.
  1032             20  DC-EDIT2-YEAR         PIC 99.
  1033         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1034         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1035                     DC-GREG-DATE-1-YMD.
  1036             20  DC-YMD-YEAR           PIC 99.
  1037             20  DC-YMD-MONTH          PIC 99.
  1038             20  DC-YMD-DAY            PIC 99.
  1039         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1040         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1041                      DC-GREG-DATE-1-MDY.
  1042             20  DC-MDY-MONTH          PIC 99.
  1043             20  DC-MDY-DAY            PIC 99.
  1044             20  DC-MDY-YEAR           PIC 99.
  1045         16  DC-GREG-DATE-1-ALPHA.
  1046             20  DC-ALPHA-MONTH        PIC X(10).
  1047             20  DC-ALPHA-DAY          PIC 99.
  1048             20  FILLER                PIC XX.
  1049             20  DC-ALPHA-CENTURY.
  1050                 24 DC-ALPHA-CEN-N     PIC 99.
  1051             20  DC-ALPHA-YEAR         PIC 99.
  1052         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1053         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1054         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1055         16  DC-JULIAN-DATE            PIC 9(05).
  1056         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  21
* EL156.cbl
  1057                                       PIC 9(05).
  1058         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1059             20  DC-JULIAN-YEAR        PIC 99.
  1060             20  DC-JULIAN-DAYS        PIC 999.
  1061         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1062         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1063         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1064     12  DATE-CONVERSION-VARIBLES.
  1065         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1066         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1067             20  FILLER                PIC 9(3).
  1068             20  HOLD-CEN-1-CCYY.
  1069                 24  HOLD-CEN-1-CC     PIC 99.
  1070                 24  HOLD-CEN-1-YY     PIC 99.
  1071             20  HOLD-CEN-1-MO         PIC 99.
  1072             20  HOLD-CEN-1-DA         PIC 99.
  1073         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1074             20  HOLD-CEN-1-R-MO       PIC 99.
  1075             20  HOLD-CEN-1-R-DA       PIC 99.
  1076             20  HOLD-CEN-1-R-CCYY.
  1077                 24  HOLD-CEN-1-R-CC   PIC 99.
  1078                 24  HOLD-CEN-1-R-YY   PIC 99.
  1079             20  FILLER                PIC 9(3).
  1080         16  HOLD-CENTURY-1-X.
  1081             20  FILLER                PIC X(3)  VALUE SPACES.
  1082             20  HOLD-CEN-1-X-CCYY.
  1083                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1084                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1085             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1086             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1087         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1088             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1089             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1090             20  HOLD-CEN-1-R-X-CCYY.
  1091                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1092                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1093             20  FILLER                PIC XXX.
  1094         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1095         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1096         16  DC-JULIAN-DATE-1          PIC 9(07).
  1097         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1098             20  DC-JULIAN-1-CCYY.
  1099                 24  DC-JULIAN-1-CC    PIC 99.
  1100                 24  DC-JULIAN-1-YR    PIC 99.
  1101             20  DC-JULIAN-DA-1        PIC 999.
  1102         16  DC-JULIAN-DATE-2          PIC 9(07).
  1103         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1104             20  DC-JULIAN-2-CCYY.
  1105                 24  DC-JULIAN-2-CC    PIC 99.
  1106                 24  DC-JULIAN-2-YR    PIC 99.
  1107             20  DC-JULIAN-DA-2        PIC 999.
  1108         16  DC-GREG-DATE-A-EDIT.
  1109             20  DC-EDITA-MONTH        PIC 99.
  1110             20  SLASHA-1              PIC X VALUE '/'.
  1111             20  DC-EDITA-DAY          PIC 99.
  1112             20  SLASHA-2              PIC X VALUE '/'.
  1113             20  DC-EDITA-CCYY.
  1114                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  22
* EL156.cbl
  1115                 24  DC-EDITA-YEAR     PIC 99.
  1116         16  DC-GREG-DATE-B-EDIT.
  1117             20  DC-EDITB-MONTH        PIC 99.
  1118             20  SLASHB-1              PIC X VALUE '/'.
  1119             20  DC-EDITB-DAY          PIC 99.
  1120             20  SLASHB-2              PIC X VALUE '/'.
  1121             20  DC-EDITB-CCYY.
  1122                 24  DC-EDITB-CENT     PIC 99.
  1123                 24  DC-EDITB-YEAR     PIC 99.
  1124         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1125         16  DC-GREG-DATE-CYMD-R REDEFINES
  1126                              DC-GREG-DATE-CYMD.
  1127             20  DC-CYMD-CEN           PIC 99.
  1128             20  DC-CYMD-YEAR          PIC 99.
  1129             20  DC-CYMD-MONTH         PIC 99.
  1130             20  DC-CYMD-DAY           PIC 99.
  1131         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1132         16  DC-GREG-DATE-MDCY-R REDEFINES
  1133                              DC-GREG-DATE-MDCY.
  1134             20  DC-MDCY-MONTH         PIC 99.
  1135             20  DC-MDCY-DAY           PIC 99.
  1136             20  DC-MDCY-CEN           PIC 99.
  1137             20  DC-MDCY-YEAR          PIC 99.
  1138    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1139        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1140    12  DC-EL310-DATE                  PIC X(21).
  1141    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  23
* EL156.cbl
  1143*    COPY ELCLOGOF.
  1144******************************************************************
  1145*                                                                *
  1146*                                                                *
  1147*                            ELCLOGOF.                           *
  1148*                            VMOD=2.001                          *
  1149*                                                                *
  1150*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1151*                                                                *
  1152******************************************************************
  1153 01  CLASIC-LOGOFF.
  1154     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1155     12  LOGOFF-TEXT.
  1156         16  FILLER          PIC X(5)    VALUE SPACES.
  1157         16  LOGOFF-MSG.
  1158             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1159             20  FILLER      PIC X       VALUE SPACES.
  1160             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1161         16  FILLER          PIC X(80)
  1162           VALUE '* YOU ARE NOW LOGGED OFF'.
  1163         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1164         16  FILLER          PIC X       VALUE QUOTE.
  1165         16  LOGOFF-SYS-MSG  PIC X(17)
  1166           VALUE 'S CLAS-IC SYSTEM '.
  1167     12  TEXT-MESSAGES.
  1168         16  UNACCESS-MSG    PIC X(29)
  1169             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1170         16  PGMIDERR-MSG    PIC X(17)
  1171             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  24
* EL156.cbl
  1173*    COPY ELCCALC.
  1174******************************************************************
  1175*                                                                *
  1176*                           ELCCALC.                            *
  1177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1178*                            VMOD=2.025                          *
  1179*                                                                *
  1180*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1181*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1182*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1183*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1184*                                                                *
  1185*  PASSED TO ELRTRM                                              *
  1186*  -----------------                                             *
  1187*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1188*  ORIGINAL TERM                                                 *
  1189*  BEGINNING DATE                                                *
  1190*  ENDING DATE                                                   *
  1191*  COMPANY I.D.                                                  *
  1192*  ACCOUNT MASTER USER FIELD                                     *
  1193*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1194*  FREE LOOK DAYS                                                *
  1195*                                                                *
  1196*  RETURNED FROM ELRTRM                                          *
  1197*  ---------------------                                         *
  1198*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1199*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1200*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1201*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1202*----------------------------------------------------------------*
  1203*  PASSED TO ELRAMT                                              *
  1204*  ----------------                                              *
  1205*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1206*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1207*  ORIGINAL AMOUNT                                               *
  1208*  ALTERNATE BENEFIT (BALLON)                                    *
  1209*  A.P.R. - NET PAY ONLY                                         *
  1210*  METHOD
  1211*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1212*  COMPANY I.D.                                                  *
  1213*  BENEFIT TYPE                                                  *
  1214*                                                                *
  1215*  RETURNED FROM ELRAMT                                          *
  1216*  --------------------                                          *
  1217*  REMAINING AMOUNT 1 - CURRENT                                  *
  1218*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1219*  REMAINING AMOUNT FACTOR
  1220*----------------------------------------------------------------*
  1221*  PASSED TO ELRESV                                              *
  1222*  -----------------                                             *
  1223*  CERTIFICATE EFFECTIVE DATE                                    *
  1224*  VALUATION DATE                                                *
  1225*  PAID THRU DATE                                                *
  1226*  BENEFIT                                                       *
  1227*  INCURRED DATE                                                 *
  1228*  REPORTED DATE                                                 *
  1229*  ISSUE AGE                                                     *
  1230*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  25
* EL156.cbl
  1231*  CDT PERCENT                                                   *
  1232*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1233* *CLAIM TYPE (LIFE, A/H)                                        *
  1234* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1235* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1236*                                                                *
  1237*  RETURNED FROM ELRESV                                          *
  1238*  --------------------                                          *
  1239*  CDT TABLE USED                                                *
  1240*  CDT FACTOR USED                                               *
  1241*  PAY TO CURRENT RESERVE                                        *
  1242*  I.B.N.R. - A/H ONLY                                           *
  1243*  FUTURE (ACCRUED) AH ONLY                                      *
  1244*----------------------------------------------------------------*
  1245*  PASSED TO ELRATE                                              *
  1246*  ----------------                                              *
  1247*  CERT ISSUE DATE                                               *
  1248*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1249*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1250*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1251*  STATE CODE (CLIENT DEFINED)                                   *
  1252*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1253*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1254*  DEVIATION CODE                                                *
  1255*  ISSUE AGE                                                     *
  1256*  ORIGINAL BENEFIT AMOUNT                                       *
  1257*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1258*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1259*  BENEFIT KIND (LIFE OR A/H)                                    *
  1260*  A.P.R.                                                        *
  1261*  METHOD
  1262*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1263*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1264*  COMPANY I.D. (3 CHARACTER)                                    *
  1265*  BENEFIT CODE                                                  *
  1266*  BENEFIT OVERRIDE CODE                                         *
  1267*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1268*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1269*  JOINT INDICATOR (CSL ONLY)                                    *
  1270*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1271*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1272*                                                                *
  1273*  RETURNED FROM ELRATE                                          *
  1274*  --------------------                                          *
  1275*  CALCULATED PREMIUM                                            *
  1276*  PREMIUM RATE                                                  *
  1277*  MORTALITY CODE                                                *
  1278*  MAX ATTAINED AGE                                              *
  1279*  MAX AGE                                                       *
  1280*  MAX TERM                                                      *
  1281*  MAX MONTHLY BENEFIT                                           *
  1282*  MAX TOTAL BENIFIT                                             *
  1283*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1284*----------------------------------------------------------------*
  1285*  PASSED TO ELRFND                                              *
  1286*  ----------------                                              *
  1287*  CERT ISSUE DATE                                               *
  1288*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  26
* EL156.cbl
  1289*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1290*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1291*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1292*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1293*  STATE CODE (CLIENT DEFINED)                                   *
  1294*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1295*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1296*  DEVIATION CODE                                                *
  1297*  ISSUE AGE                                                     *
  1298*  ORIGINAL BENEFIT AMOUNT                                       *
  1299*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1300*  PROCESS TYPE (CANCEL)                                         *
  1301*  BENEFIT KIND (LIFE OR A/H)                                    *
  1302*  A.P.R.                                                        *
  1303*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1304*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1305*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1306*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1307*  COMPANY I.D. (3 CHARACTER)                                    *
  1308*  BENEFIT CODE                                                  *
  1309*  BENEFIT OVERRIDE CODE                                         *
  1310*                                                                *
  1311*  RETURNED FROM ELRFND                                          *
  1312*  --------------------                                          *
  1313*  CALCULATED REFUND                                             *
  1314*----------------------------------------------------------------*
  1315*  PASSED TO ELEARN                                              *
  1316*  ----------------                                              *
  1317*  CERT ISSUE DATE                                               *
  1318*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1319*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1320*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1321*  STATE CODE (CLIENT DEFINED)                                   *
  1322*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1323*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1324*  DEVIATION CODE                                                *
  1325*  ISSUE AGE                                                     *
  1326*  ORIGINAL BENEFIT AMOUNT                                       *
  1327*  BENEFIT KIND (LIFE OR A/H)                                    *
  1328*  A.P.R.                                                        *
  1329*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1330*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1331*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1332*  COMPANY I.D. (3 CHARACTER)                                    *
  1333*  BENEFIT CODE                                                  *
  1334*  BENEFIT OVERRIDE CODE                                         *
  1335*                                                                *
  1336*  RETURNED FROM ELEARN                                          *
  1337*  --------------------                                          *
  1338*  INDICATED  EARNINGS                                           *
  1339*----------------------------------------------------------------*
  1340*                 LENGTH = 450                                   *
  1341*                                                                *
  1342******************************************************************
  1343******************************************************************
  1344*                   C H A N G E   L O G
  1345*
  1346* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  27
* EL156.cbl
  1347*-----------------------------------------------------------------
  1348*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1349* EFFECTIVE    NUMBER
  1350*-----------------------------------------------------------------
  1351* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1352* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1353* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1354* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1355* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1356* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1357* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1358* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1359* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1360* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1361* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1362******************************************************************
  1363
  1364 01  CALCULATION-PASS-AREA.
  1365     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1366                                     COMP.
  1367
  1368     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1369       88  NO-CP-ERROR                             VALUE ZERO.
  1370       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1371                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1372       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1373       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1374       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1375       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1376       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1377       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1378       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1379       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1380       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1381       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1382       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1383       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1384       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1385       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1386       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1387       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1388       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1389
  1390     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1391       88  NO-CP-ERROR-2                           VALUE ZERO.
  1392***********************  INPUT AREAS ****************************
  1393
  1394     12  CP-CALCULATION-AREA.
  1395         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1396         16  CP-CERT-EFF-DT        PIC XX.
  1397         16  CP-VALUATION-DT       PIC XX.
  1398         16  CP-PAID-THRU-DT       PIC XX.
  1399         16  CP-BENEFIT-TYPE       PIC X.
  1400           88  CP-AH                               VALUE 'A' 'D'
  1401                                                   'I' 'U'.
  1402           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1403           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1404         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  28
* EL156.cbl
  1405         16  CP-REPORTED-DT        PIC XX.
  1406         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1407         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1408         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1409                                     COMP-3.
  1410         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1411                                     COMP-3.
  1412         16  CP-CDT-METHOD         PIC X.
  1413           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1414           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1415           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1416         16  CP-CLAIM-TYPE         PIC X.
  1417           88  CP-AH-CLAIM                         VALUE 'A'.
  1418           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1419         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1420                                     COMP-3.
  1421         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1422                                     COMP-3.
  1423         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1424                                     COMP-3.
  1425         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1426                                     COMP-3.
  1427         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1428                                     COMP-3.
  1429         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1430                                     COMP-3.
  1431         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1432                                     COMP-3.
  1433         16  CP-REM-TERM-METHOD    PIC X.
  1434           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1435           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1436           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1437           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1438           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1439           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1440           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1441         16  CP-EARNING-METHOD     PIC X.
  1442           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1443           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1444           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1445           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1446           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1447           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1448           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1449           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1450           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1451           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1452           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1453           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1454           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1455           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1456         16  CP-PROCESS-TYPE       PIC X.
  1457           88  CP-CLAIM                            VALUE '1'.
  1458           88  CP-CANCEL                           VALUE '2'.
  1459           88  CP-ISSUE                            VALUE '3'.
  1460         16  CP-SPECIAL-CALC-CD    PIC X.
  1461           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1462           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  29
* EL156.cbl
  1463           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1464           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1465           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1466           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1467           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1468           88  CP-FARM-PLAN                    VALUE 'F'.
  1469           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1470           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1471           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1472           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1473           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1474           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1475           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1476           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1477           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1478           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1479                                                     'W' 'X'.
  1480           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1481           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1482           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1483           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1484           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1485           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1486           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1487           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1488           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1489           88  CP-CSL-METH-1                   VALUE '5'.
  1490           88  CP-CSL-METH-2                   VALUE '6'.
  1491           88  CP-CSL-METH-3                   VALUE '7'.
  1492           88  CP-CSL-METH-4                   VALUE '8'.
  1493
  1494         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1495                                     COMP-3.
  1496         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1497         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1498         16  CP-STATE              PIC XX          VALUE SPACE.
  1499         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1500         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1501           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1502               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1503         16  CP-R78-OPTION         PIC X.
  1504           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1505           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1506
  1507         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1508         16  CP-IBNR-RESERVE-SW    PIC X.
  1509         16  CP-CLAIM-STATUS       PIC X.
  1510         16  CP-RATE-FILE          PIC X.
  1511         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1512                                     COMP-3.
  1513
  1514         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1515         16  CP-AH-OVERRIDE-CODE   PIC X.
  1516
  1517         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1518                                     COMP-3.
  1519         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1520                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  30
* EL156.cbl
  1521         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1522                                     COMP-3.
  1523         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1524                                     COMP-3.
  1525         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1526                                     COMP-3.
  1527         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1528                                  PIC S9(7)V99 COMP-3.
  1529
  1530         16  CP-PAID-FROM-DATE     PIC X(02).
  1531         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1532         16  CP-EXT-DAYS-CALC      PIC X.
  1533           88  CP-EXT-NO-CHG                   VALUE ' '.
  1534           88  CP-EXT-CHG-LF                   VALUE '1'.
  1535           88  CP-EXT-CHG-AH                   VALUE '2'.
  1536           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1537         16  CP-DOMICILE-STATE     PIC XX.
  1538         16  CP-CARRIER            PIC X.
  1539         16  CP-REIN-FLAG          PIC X.
  1540         16  CP-REM-TRM-CALC-OPTION PIC X.
  1541           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1542                      '2' '3' '4' '5'.
  1543           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1544           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1545           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1546           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1547           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1548           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1549           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1550           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1551         16  CP-SIG-SWITCH         PIC X.
  1552         16  CP-RATING-METHOD      PIC X.
  1553           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1554           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1555           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1556           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1557           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1558           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1559           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1560           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1561           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1562         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1563                                     COMP-3.
  1564         16  CP-BEN-CATEGORY       PIC X.
  1565         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1566         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1567                                   PIC S99V9(5) COMP-3.
  1568         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1569         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1570                                   PIC S99V9(5) COMP-3.
  1571         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1572         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1573         16  CP-EXPIRE-DT          PIC XX.
  1574         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1575         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1576         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1577         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1578         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  31
* EL156.cbl
  1579             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1580             88  CP-CALC-CLP              VALUE 'C'.
  1581         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1582         16  CP-CANCEL-REASON      PIC X.
  1583         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1584         16  CP-PMT-MODE           PIC X.
  1585         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1586         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1587         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1588         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1589         16  FILLER                PIC X.
  1590
  1591***************    OUTPUT FROM ELRESV   ************************
  1592
  1593         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1594
  1595         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1598                                     COMP-3.
  1599         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1600                                     COMP-3.
  1601         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  FILLER                PIC X(09).
  1604***************    OUTPUT FROM ELRTRM   *************************
  1605
  1606         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1607                                     COMP-3.
  1608         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1609                                     COMP-3.
  1610         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1611                                     COMP-3.
  1612         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1613                                     COMP-3.
  1614         16  FILLER                PIC X(12).
  1615
  1616***************    OUTPUT FROM ELRAMT   *************************
  1617
  1618         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1619                                     COMP-3.
  1620         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1621                                     COMP-3.
  1622         16  FILLER                PIC X(12).
  1623
  1624***************    OUTPUT FROM ELRATE   *************************
  1625
  1626         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1627                                     COMP-3.
  1628         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1629                                     COMP-3.
  1630         16  CP-MORTALITY-CODE     PIC X(4).
  1631         16  CP-RATE-EDIT-FLAG     PIC X.
  1632             88  CP-RATES-NEED-APR                  VALUE '1'.
  1633         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1636         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  32
* EL156.cbl
  1637         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1638                                   PIC S9(7)V99 COMP-3.
  1639         16  FILLER                PIC X(07).
  1640
  1641***************    OUTPUT FROM ELRFND   *************************
  1642
  1643         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1644                                     COMP-3.
  1645         16  CP-REFUND-TYPE-USED   PIC X.
  1646           88  CP-R-AS-R78                         VALUE '1'.
  1647           88  CP-R-AS-PRORATA                     VALUE '2'.
  1648           88  CP-R-AS-CALIF                       VALUE '3'.
  1649           88  CP-R-AS-TEXAS                       VALUE '4'.
  1650           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1651           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1652           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1653           88  CP-R-AS-MEAN                        VALUE '8'.
  1654           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1655           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1656           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1657           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1658           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1659           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1660         16  FILLER                PIC X(12).
  1661
  1662***************    OUTPUT FROM ELEARN   *************************
  1663
  1664         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1671                                     COMP-3.
  1672         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1673                                     COMP-3.
  1674         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1675                                     COMP-3.
  1676         16  CP-EARNING-TYPE-USED  PIC X.
  1677           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1678           88  CP-E-AS-R78                         VALUE '1'.
  1679           88  CP-E-AS-PRORATA                     VALUE '2'.
  1680           88  CP-E-AS-TEXAS                       VALUE '4'.
  1681           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1682           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1683           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1684           88  CP-E-AS-MEAN                        VALUE '8'.
  1685           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1686         16  FILLER                PIC X(12).
  1687
  1688***************    OUTPUT FROM ELPMNT   *************************
  1689
  1690         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1691                                     COMP-3.
  1692         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1693                                     COMP-3.
  1694         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  33
* EL156.cbl
  1695
  1696***************   MISC WORK AREAS    *****************************
  1697         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1698                                     COMP-3.
  1699         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1700                                     COMP-3.
  1701         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1702                                     COMP-3.
  1703         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1704                                     COMP-3.
  1705         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1706                                     COMP-3.
  1707         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1708                                     COMP-3.
  1709         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1710             88  OPEN-RATE-FILE                   VALUE 'O'.
  1711             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1712             88  IO-ERROR                         VALUE 'E'.
  1713
  1714         16  CP-FIRST-PAY-DATE     PIC XX.
  1715
  1716         16  CP-JOINT-INDICATOR    PIC X.
  1717
  1718         16  CP-RESERVE-REMAINING-TERM
  1719                                   PIC S9(4)V9    VALUE ZERO
  1720                                     COMP-3.
  1721
  1722         16  CP-INSURED-BIRTH-DT   PIC XX.
  1723
  1724         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1725                                     COMP-3.
  1726
  1727         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1728                                     COMP-3.
  1729
  1730         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1731                                     COMP-3.
  1732
  1733         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1734                                     COMP-3.
  1735
  1736         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1737                                     COMP-3.
  1738
  1739         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1740                                     COMP-3.
  1741
  1742         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1743                                     COMP-3.
  1744
  1745         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1746             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1747
  1748         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1749                                     COMP-3.
  1750         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1751                                     COMP-3.
  1752         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  34
* EL156.cbl
  1753         16  cp-extra-periods      pic 9 value zeros.
  1754         16  cp-net-only-state     pic x value spaces.
  1755         16  FILLER                PIC X(13).
  1756******************************************************************
  1757*    COPY ELCICALC.
  1758******************************************************************
  1759*                                                                *
  1760*                           ELCCICALC.                           *
  1761*                            VMOD=2.001                          *
  1762*                                                                *
  1763*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1764*                 CALCULATION MODULE                             *
  1765*                                                                *
  1766*  PASSED TO ELCLMI                                              *
  1767*  -----------------                                             *
  1768*  STATE                                                         *
  1769*  PRODUCT                                                       *
  1770*  COVERAGE                                                      *
  1771*  EFFECTIVE DATE                                                *
  1772*  INCURRED DATE                                                 *
  1773*  ESTABLISHED DATE                                              *
  1774*  LAST PAID DATE                                                *
  1775*  REPORTED DATE                                                 *
  1776*  CLAIM PAYMENT AMOUNT                                          *
  1777*                                                                *
  1778*  RETURNED FROM ELRTRM                                          *
  1779*  ---------------------                                         *
  1780*  RETURN CODE                                                   *
  1781*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1782*  CLAIM INTEREST AMOUNT                                         *
  1783*----------------------------------------------------------------*
  1784*----------------------------------------------------------------*
  1785*                 LENGTH = 100                                   *
  1786*                                                                *
  1787******************************************************************
  1788******************************************************************
  1789*                   C H A N G E   L O G
  1790*
  1791* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1792*-----------------------------------------------------------------
  1793*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1794* EFFECTIVE    NUMBER
  1795*-----------------------------------------------------------------
  1796* 120905    2004040700004  PEMA  NEW COPYBOOK
  1797* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1798******************************************************************
  1799
  1800 01  CLAIM-INT-PASS-AREA.
  1801     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1802                                     COMP.
  1803
  1804     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1805       88  NO-CI-ERROR                             VALUE ZERO.
  1806       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1807       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1808       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1809       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1810       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  35
* EL156.cbl
  1811       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1812       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1813       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1814       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1815***********************  INPUT AREAS ****************************
  1816
  1817     12  CP-CALCULATION-AREA.
  1818         16  CP-COMPANY-CD         PIC X.
  1819         16  CP-STATE              PIC XX.
  1820         16  CP-PRODUCT            PIC XX.
  1821         16  CP-COVERAGE           PIC XX.
  1822         16  CP-INC-DT             PIC XX.
  1823         16  CP-EST-DT             PIC XX.
  1824         16  CP-LSTPD-DT           PIC XX.
  1825         16  CP-RPT-DT             PIC XX.
  1826         16  CP-PRF-DT             PIC XX.
  1827         16  CP-EFF-DT             PIC XX.
  1828         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1829         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1830         16  FILLER                PIC X(37).
  1831
  1832***************    OUTPUT FROM ELCLMI   ************************
  1833
  1834         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1835
  1836         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1837         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1838         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1839         16  FILLER                PIC X(19).
  1840******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  36
* EL156.cbl
  1842*    COPY ELCATTR.
  1843******************************************************************
  1844*                                                                *
  1845*                            ELCATTR.                            *
  1846*                            VMOD=2.001                          *
  1847*                                                                *
  1848*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1849*                                                                *
  1850*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1851*                                                                *
  1852*                   POS 1   P=PROTECTED                          *
  1853*                           U=UNPROTECTED                        *
  1854*                           S=ASKIP                              *
  1855*                   POS 2   A=ALPHA/NUMERIC                      *
  1856*                           N=NUMERIC                            *
  1857*                   POS 3   N=NORMAL                             *
  1858*                           B=BRIGHT                             *
  1859*                           D=DARK                               *
  1860*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1861*                           OF=MODIFIED DATA TAG OFF             *
  1862*                                                                *
  1863*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1864******************************************************************
  1865 01  ATTRIBUTE-LIST.
  1866     12  AL-PABOF            PIC X       VALUE 'Y'.
  1867     12  AL-PABON            PIC X       VALUE 'Z'.
  1868     12  AL-PADOF            PIC X       VALUE '%'.
  1869     12  AL-PADON            PIC X       VALUE '_'.
  1870     12  AL-PANOF            PIC X       VALUE '-'.
  1871     12  AL-PANON            PIC X       VALUE '/'.
  1872     12  AL-SABOF            PIC X       VALUE '8'.
  1873     12  AL-SABON            PIC X       VALUE '9'.
  1874     12  AL-SADOF            PIC X       VALUE '@'.
  1875     12  AL-SADON            PIC X       VALUE QUOTE.
  1876     12  AL-SANOF            PIC X       VALUE '0'.
  1877     12  AL-SANON            PIC X       VALUE '1'.
  1878     12  AL-UABOF            PIC X       VALUE 'H'.
  1879     12  AL-UABON            PIC X       VALUE 'I'.
  1880     12  AL-UADOF            PIC X       VALUE '<'.
  1881     12  AL-UADON            PIC X       VALUE '('.
  1882     12  AL-UANOF            PIC X       VALUE ' '.
  1883     12  AL-UANON            PIC X       VALUE 'A'.
  1884     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1885     12  AL-UNBON            PIC X       VALUE 'R'.
  1886     12  AL-UNDOF            PIC X       VALUE '*'.
  1887     12  AL-UNDON            PIC X       VALUE ')'.
  1888     12  AL-UNNOF            PIC X       VALUE '&'.
  1889     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  37
* EL156.cbl
  1891*    COPY ELCEMIB.
  1892******************************************************************
  1893*                                                                *
  1894*                                                                *
  1895*                            ELCEMIB.                            *
  1896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1897*                            VMOD=2.005                          *
  1898*                                                                *
  1899*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1900*                                                                *
  1901******************************************************************
  1902 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1903     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1904     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1905     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1906     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1907     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1908     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1909     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1910     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1911     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1912         88  EMI-NO-ERRORS                    VALUE '1'.
  1913         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1914         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1915     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1916         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1917     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1918         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1919         88  EMI-AREA1-FULL                   VALUE '2'.
  1920     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1921         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1922         88  EMI-AREA2-FULL                   VALUE '2'.
  1923     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1924         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1925         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1926         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1927         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1928         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1929     12  EMI-ERROR-LINES.
  1930         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1931         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1932         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1933         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1934             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1935                 24  EMI-ERR-NUM         PIC X(4).
  1936                 24  EMI-FILLER          PIC X.
  1937                 24  EMI-SEV             PIC X.
  1938                 24  FILLER              PIC X.
  1939             20  FILLER                  PIC X(02).
  1940     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1941         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1942             20  EMI-ERROR-NUMBER    PIC X(4).
  1943             20  EMI-FILL            PIC X.
  1944             20  EMI-SEVERITY        PIC X.
  1945             20  FILLER              PIC X.
  1946             20  EMI-ERROR-TEXT.
  1947                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1948                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  38
* EL156.cbl
  1949     12  EMI-SEVERITY-SAVE           PIC X.
  1950         88  EMI-NOTE                    VALUE 'N'.
  1951         88  EMI-WARNING                 VALUE 'W'.
  1952         88  EMI-FORCABLE                VALUE 'F'.
  1953         88  EMI-FATAL                   VALUE 'X'.
  1954     12  EMI-MESSAGE-FLAG            PIC X.
  1955         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1956         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1957     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1958     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1959         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1960         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1961         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1962     12  emi-claim-no                pic x(7).
  1963     12  emi-claim-type              pic x(6).
  1964     12  FILLER                      PIC X(124)  VALUE SPACES.
  1965     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1966     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1967     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1968     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  39
* EL156.cbl
  1970*    COPY ELCLNKLT.
  1971******************************************************************
  1972*                                                                *
  1973*                                                                *
  1974*                           ELCLNKLT                             *
  1975*                            VMOD=2.003                          *
  1976*                                                                *
  1977*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1978*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1979*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1980*                                                                *
  1981*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1982*   COMPLETING THE REQUIRED FIELDS.                              *
  1983*                                                                *
  1984*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1985*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1986*                              9999 INDICATES AN UNKNOWN ABEND   *
  1987*                                   WAS DETECTED.                *
  1988*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1989*                              CODES FOUND IN THE ERROR FILE.    *
  1990******************************************************************
  1991 01  W-1523-LINKDATA.
  1992     12  W-1523-COMMON-PI-DATA.
  1993         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1994         16  FILLER              PIC  X(67).
  1995         16  W-1523-COMPANY-CD   PIC  X(01).
  1996         16  FILLER              PIC  X(10).
  1997         16  W-1523-CONTROL-IN-PROGRESS.
  1998             20  W-1523-CARRIER  PIC  X(01).
  1999             20  W-1523-GROUPING PIC  X(06).
  2000             20  W-1523-STATE    PIC  X(02).
  2001             20  W-1523-ACCOUNT  PIC  X(10).
  2002             20  W-1523-CLAIM-CERT-GRP.
  2003                 24  W-1523-CLAIM-NO
  2004                                 PIC  X(07).
  2005                 24  W-1523-CERT-NO.
  2006                     28  W-1523-CERT-PRIME
  2007                                 PIC  X(10).
  2008                     28  W-1523-CERT-SFX
  2009                                 PIC  X(01).
  2010                 24  W-1523-CERT-EFF-DT
  2011                                 PIC  X(02).
  2012         16  FILLER              PIC X(265).
  2013
  2014     12  W-1523-WORK-AREA.
  2015         16  W-1523-FORM-NUMBER  PIC  X(04).
  2016         16  W-1523-NUMBER-COPIES
  2017                                 PIC  9(01).
  2018         16  W-1523-ADDR-TYPE    PIC  X(02).
  2019         16  W-1523-FOLLOW-UP-DATE
  2020                                 PIC  X(02).
  2021         16  W-1523-RESEND-DATE  PIC  X(02).
  2022         16  W-1523-ERROR-CODE   PIC  9(04).
  2023             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2024             88  W-1523-FATAL-ERROR
  2025                                    VALUES  0006 0013 0042
  2026                                            0154 0168 0169
  2027                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  40
* EL156.cbl
  2028                                            0179 0186 0281
  2029                                            0332 2055 3697
  2030                                            3698 3699 3770
  2031                                            3771 3772 7675
  2032                                            9106 9808 9883
  2033                                            9887.
  2034             88  W-1523-STOP-ERRORS
  2035                                    VALUES  0013 0042 0154
  2036                                            0168 0169 0172
  2037                                            0281 0332 2055
  2038                                            3698 3699 7675
  2039                                            9106 9808 9883
  2040                                            9999.
  2041         16  W-1523-REASON       PIC  X(70).
  2042         16  W-1523-ARCHIVE-NUMBER
  2043                                 PIC  9(08).
  2044     12  W-1523-POINTER-AREA.
  2045         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2046         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2047         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2048         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2049         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  41
* EL156.cbl
  2051*    COPY ELCNWA.
  2052*****************************************************************
  2053*                                                               *
  2054*                                                               *
  2055*                            ELCNWA.                            *
  2056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2057*                            VMOD=2.003                         *
  2058*                                                               *
  2059*            M O V E   N A M E   W O R K   A R E A.             *
  2060*                                                               *
  2061*****************************************************************.
  2062
  2063 01  WS-NAME-WORK-AREA.
  2064     05  WS-INSURED-LAST-NAME        PIC X(15).
  2065     05  WS-INSURED-1ST-NAME         PIC X(12).
  2066     05  WS-INSURED-MID-INIT         PIC X.
  2067
  2068     05  WS-NAME-WORK.
  2069         10  WS-NW                   PIC X
  2070             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2071
  2072     05  WS-NAME-WORK2.
  2073         10  WS-NW2                  PIC X
  2074             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2075                                        NWA-INDEX0.
  2076
  2077     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2078                                     COMP-3.
  2079
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  42
* EL156.cbl
  2081*    COPY ELCDMO.
  2082******************************************************************
  2083*                                                                *
  2084*                                                                *
  2085*                            ELCDMO.                             *
  2086*                            VMOD=2.004                          *
  2087*                                                                *
  2088*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2089*        COMMUNICATION AREA                                      *
  2090*   FILE TYPE = NA                                               *
  2091*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2092*                                                                *
  2093******************************************************************
  2094 01  DMO-COMMUNICATION-AREA.
  2095     12  DM-RECORD-TYPE                  PIC  X(02).
  2096             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2097             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2098             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2099     12  DM-DIST-CODE                    PIC  X(04).
  2100     12  DM-MAIL-CODE                    PIC  X(05).
  2101     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2102     12  DM-INSURED-NAME                 PIC  X(30).
  2103     12  DM-CLAIM-NO                     PIC  X(07).
  2104     12  DM-CLAIM-TYPE                   PIC  X.
  2105
  2106     12  DM-STATUS-DATA-AREA.
  2107         16  DM-CLAIM-STATUS             PIC  X.
  2108             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2109             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2110             88  DM-CLOSED                        VALUE '3'.
  2111             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2112             88  DM-DEFAULT                       VALUE '9'.
  2113         16  DM-STATUS-DATE              PIC  X(08).
  2114******YYYYMMDD
  2115         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2116             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2117             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2118             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2119             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2120             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2121             88  DM-RE-OPENED                     VALUE 'R'.
  2122             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2123             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2124             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2125         16  DM-STAT-CARRIER             PIC X.
  2126
  2127     12  DM-DRAFT-DATA-AREA.
  2128         16  DM-PAYMENT-TYPE             PIC  X.
  2129             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2130         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2131         16  DM-PAYMENT-DATE             PIC  X(08).
  2132******YYYYMMDD
  2133         16  DM-CERT-NO                  PIC  X(11).
  2134         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2135         16  DM-CARRIER                  PIC  X.
  2136
  2137     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  43
* EL156.cbl
  2139*    COPY ELCDMDCD.
  2140******************************************************************
  2141*                                                                *
  2142*                                                                *
  2143*                            ELCDMDCD.                           *
  2144*                            VMOD=2.001                          *
  2145*                                                                *
  2146*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2147*       COMMUNICATIONS AREA                                      *
  2148*                                                                *
  2149******************************************************************
  2150 01  CD-COMMUNICATION-AREA.
  2151     12  CD-SYSTEM-ID            PIC  X(02).
  2152         88 CD-CLAIMS                      VALUE 'CL'.
  2153         88 CD-CREDIT                      VALUE 'CR'.
  2154     12  CD-RECORD-TYPE          PIC  X(02).
  2155         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2156         88 CD-EOB-CODE                    VALUE 'EO'.
  2157         88 CD-ICD9-CODE                   VALUE 'I9'.
  2158         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2159         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2160         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2161         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2162         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2163     12  CD-RECORD-KEY           PIC  X(06).
  2164         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2165     12  CD-RETURN-CODE          PIC  X(02).
  2166     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2167     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2168     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2169     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  44
* EL156.cbl
  2171*    COPY ELCDCTB.
  2172******************************************************************
  2173*                                                                *
  2174*                                                                *
  2175*                            ELCDCTB.                            *
  2176*                            VMOD=2.002                          *
  2177*                                                                *
  2178*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2179*       COMMUNICATIONS AREA                                      *
  2180*                                                                *
  2181******************************************************************
  2182 01  DCT-COMMUNICATION-AREA.
  2183     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2184     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2185     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2186     12  DCT-PRODUCT-CODE         PIC  X(02).
  2187     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2188     12  DCT-RETURN-CODE          PIC  X(02).
  2189     12  DCT-MAIL-CODE            PIC  X(05).
  2190     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2191     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  45
* EL156.cbl
  2193 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2194 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2195 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2196 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  46
* EL156.cbl
  2198*    COPY ELCINTF.
  2199******************************************************************
  2200*                                                                *
  2201*                                                                *
  2202*                            ELCINTF.                            *
  2203*                            VMOD=2.017                          *
  2204*                                                                *
  2205*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2206*                                                                *
  2207*       LENGTH = 1024                                            *
  2208*                                                                *
  2209******************************************************************
  2210*                   C H A N G E   L O G
  2211*
  2212* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2213*-----------------------------------------------------------------
  2214*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2215* EFFECTIVE    NUMBER
  2216*-----------------------------------------------------------------
  2217* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2218******************************************************************
  2219 01  PROGRAM-INTERFACE-BLOCK.
  2220     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2221     12  PI-CALLING-PROGRAM              PIC X(8).
  2222     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2223     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2224     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2225     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2226     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2227     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2228     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2229     12  PI-COMPANY-ID                   PIC XXX.
  2230     12  PI-COMPANY-CD                   PIC X.
  2231
  2232     12  PI-COMPANY-PASSWORD             PIC X(8).
  2233
  2234     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2235
  2236     12  PI-CONTROL-IN-PROGRESS.
  2237         16  PI-CARRIER                  PIC X.
  2238         16  PI-GROUPING                 PIC X(6).
  2239         16  PI-STATE                    PIC XX.
  2240         16  PI-ACCOUNT                  PIC X(10).
  2241         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2242                                         PIC X(10).
  2243         16  PI-CLAIM-CERT-GRP.
  2244             20  PI-CLAIM-NO             PIC X(7).
  2245             20  PI-CERT-NO.
  2246                 25  PI-CERT-PRIME       PIC X(10).
  2247                 25  PI-CERT-SFX         PIC X.
  2248             20  PI-CERT-EFF-DT          PIC XX.
  2249         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2250             20  PI-PLAN-CODE            PIC X(2).
  2251             20  PI-REVISION-NUMBER      PIC X(3).
  2252             20  PI-PLAN-EFF-DT          PIC X(2).
  2253             20  PI-PLAN-EXP-DT          PIC X(2).
  2254             20  FILLER                  PIC X(11).
  2255         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  47
* EL156.cbl
  2256             20  PI-OE-REFERENCE-1.
  2257                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2258                 25  PI-OE-REF-1-SUFF    PIC XX.
  2259
  2260     12  PI-SESSION-IN-PROGRESS          PIC X.
  2261         88  CLAIM-SESSION                   VALUE '1'.
  2262         88  CREDIT-SESSION                  VALUE '2'.
  2263         88  WARRANTY-SESSION                VALUE '3'.
  2264         88  MORTGAGE-SESSION                VALUE '4'.
  2265         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2266
  2267
  2268*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2269
  2270     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2271     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2272
  2273     12  PI-CREDIT-USER                  PIC X.
  2274         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2275         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2276
  2277     12  PI-CLAIM-USER                   PIC X.
  2278         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2279         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2280
  2281     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2282         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2283         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2284         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2285         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2286         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2287
  2288     12  PI-PROCESSOR-ID                 PIC X(4).
  2289
  2290     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2291
  2292     12  PI-MEMBER-CAPTION               PIC X(10).
  2293
  2294     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2295         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2296
  2297     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2298     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2299     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2300     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2301
  2302     12  PI-AH-OVERRIDE-L1               PIC X.
  2303     12  PI-AH-OVERRIDE-L2               PIC XX.
  2304     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2305     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2306
  2307     12  PI-NEW-SYSTEM                   PIC X(2).
  2308
  2309     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2310     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2311         88  PI-USES-PAID-TO                 VALUE '1'.
  2312     12  PI-CRDTCRD-SYSTEM.
  2313         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  48
* EL156.cbl
  2314             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2315             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2316         16  PI-CC-MONTH-END-DT          PIC XX.
  2317     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2318
  2319     12  PI-OE-REFERENCE-2.
  2320         16  PI-OE-REF-2-PRIME           PIC X(10).
  2321         16  PI-OE-REF-2-SUFF            PIC X.
  2322
  2323     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2324
  2325     12  PI-LANGUAGE-TYPE                PIC X.
  2326             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2327             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2328             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2329
  2330     12  PI-POLICY-LINKAGE-IND           PIC X.
  2331         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2332         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2333                                                   LOW-VALUES.
  2334
  2335     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2336     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2337         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2338         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2339
  2340     12  PI-PROCESSOR-CSR-IND            PIC X.
  2341         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2342         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2343
  2344     12  FILLER                          PIC X(3).
  2345
  2346     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2347
  2348     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2349         PI-SYSTEM-LEVEL.
  2350
  2351         16  PI-ENTRY-CODES.
  2352             20  PI-ENTRY-CD-1           PIC X.
  2353             20  PI-ENTRY-CD-2           PIC X.
  2354
  2355         16  PI-RETURN-CODES.
  2356             20  PI-RETURN-CD-1          PIC X.
  2357             20  PI-RETURN-CD-2          PIC X.
  2358
  2359         16  PI-UPDATE-STATUS-SAVE.
  2360             20  PI-UPDATE-BY            PIC X(4).
  2361             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2362
  2363         16  PI-LOWER-CASE-LETTERS       PIC X.
  2364             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2365
  2366*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2367*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2368*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2369
  2370         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2371             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  49
* EL156.cbl
  2372             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2373             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2374             88  ACCNT-CNTL                  VALUE '3'.
  2375             88  CARR-ACCNT-CNTL             VALUE '4'.
  2376
  2377         16  PI-PROCESSOR-CAP-LIST.
  2378             20  PI-SYSTEM-CONTROLS.
  2379                24 PI-SYSTEM-DISPLAY     PIC X.
  2380                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2381                24 PI-SYSTEM-MODIFY      PIC X.
  2382                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2383             20  FILLER                  PIC XX.
  2384             20  PI-DISPLAY-CAP          PIC X.
  2385                 88  DISPLAY-CAP             VALUE 'Y'.
  2386             20  PI-MODIFY-CAP           PIC X.
  2387                 88  MODIFY-CAP              VALUE 'Y'.
  2388             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2389                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2390             20  PI-FORCE-CAP            PIC X.
  2391                 88  FORCE-CAP               VALUE 'Y'.
  2392
  2393         16  PI-PROGRAM-CONTROLS.
  2394             20  PI-PGM-PRINT-OPT        PIC X.
  2395             20  PI-PGM-FORMAT-OPT       PIC X.
  2396             20  PI-PGM-PROCESS-OPT      PIC X.
  2397             20  PI-PGM-TOTALS-OPT       PIC X.
  2398
  2399         16  PI-HELP-INTERFACE.
  2400             20  PI-LAST-ERROR-NO        PIC X(4).
  2401             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2402
  2403         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2404             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2405
  2406         16  PI-CR-CONTROL-IN-PROGRESS.
  2407             20  PI-CR-CARRIER           PIC X.
  2408             20  PI-CR-GROUPING          PIC X(6).
  2409             20  PI-CR-STATE             PIC XX.
  2410             20  PI-CR-ACCOUNT           PIC X(10).
  2411             20  PI-CR-FIN-RESP          PIC X(10).
  2412             20  PI-CR-TYPE              PIC X.
  2413
  2414         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2415
  2416         16  PI-CR-MONTH-END-DT          PIC XX.
  2417
  2418         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2419             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2420             88  PI-ZERO-CARRIER             VALUE '1'.
  2421             88  PI-ZERO-GROUPING            VALUE '2'.
  2422             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2423
  2424         16  PI-CARRIER-SECURITY         PIC X.
  2425             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2426
  2427         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2428             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2429             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  50
* EL156.cbl
  2430
  2431         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2432             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2433                                         INDEXED BY PI-ACCESS-NDX
  2434                                         PIC X.
  2435
  2436         16  PI-GA-BILLING-CONTROL       PIC X.
  2437             88  PI-GA-BILLING               VALUE '1'.
  2438
  2439         16  PI-MAIL-PROCESSING          PIC X.
  2440             88  PI-MAIL-YES                 VALUE 'Y'.
  2441
  2442         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2443
  2444         16  PI-AR-SYSTEM.
  2445             20  PI-AR-PROCESSING-CNTL   PIC X.
  2446                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2447             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2448             20  PI-AR-MONTH-END-DT      PIC XX.
  2449
  2450         16  PI-MP-SYSTEM.
  2451             20  PI-MORTGAGE-USER            PIC X.
  2452                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2453                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2454             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2455                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2456                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2457                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2458                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2459                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2460             20  PI-MP-MONTH-END-DT          PIC XX.
  2461             20  PI-MP-REFERENCE-NO.
  2462                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2463                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2464
  2465         16  PI-LABEL-CONTROL            PIC X(01).
  2466             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2467             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2468
  2469         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2470             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2471
  2472         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2473             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2474             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2475
  2476         16  FILLER                      PIC X(14).
  2477
  2478     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2479******************************************************************
  2480     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2481         16  PI-SAVE-FORM        PIC X(12).
  2482         16  PI-ACCT-KEY         PIC X(26).
  2483         16  PI-PAYEE-NAME       PIC X(30).
  2484         16  PI-DAILY-RATE       PIC S9(3)V99.
  2485         16  PI-MONTH-END-SAVE   PIC XX.
  2486         16  PI-BENEFIT-SAVE.
  2487             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  51
* EL156.cbl
  2488             20  PI-BEN-TYPE     PIC X.
  2489         16  PI-MANUAL-SW        PIC 9.
  2490         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2491         16  PI-PASS-SW          PIC X.
  2492         16  PI-PFKEY-USED       PIC X.
  2493         16  PI-CK-ASSIGN        PIC X.
  2494         16  PI-FATAL-COUNT      PIC 99.
  2495         16  PI-FORCE-COUNT      PIC 99.
  2496         16  PI-SAVE-INPUT.
  2497             20  PI-PMTTYPE      PIC X.
  2498             20  PI-PAYEE.
  2499                 24  PI-PAYEE-TYPE PIC X.
  2500                 24  PI-PAYEE-SEQ  PIC X.
  2501                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2502                   PI-PAYEE-SEQ    PIC S9.
  2503             20  PI-PMTNOTE1     PIC X(60).
  2504             20  PI-PMTNOTE2     PIC X(60).
  2505             20  PI-OFFLINE      PIC X.
  2506             20  PI-ECHECKNO     PIC X(7).
  2507             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2508                 28  PI-ECHECKNO-N     PIC X.
  2509                 28  PI-ECHECKNO-6     PIC X(6).
  2510             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2511                 24  PI-ECHECKNO-CR    PIC XX.
  2512                 24  PI-ECHECKNO-5     PIC X(5).
  2513             20  PI-HOLDTIL      PIC 9(6).
  2514             20  PI-EPYFROM      PIC 9(6).
  2515             20  PI-EPYTHRU      PIC 9(6).
  2516             20  PI-EDAYS        PIC S9(5).
  2517             20  PI-EPYAMT       PIC S9(7)V99.
  2518             20  PI-ERESV        PIC S9(7)V99.
  2519             20  PI-EEXPENS      PIC 9(6)V99.
  2520             20  PI-ETYPE        PIC X.
  2521             20  PI-CASH         PIC X.
  2522             20  PI-GROUPED      PIC X.
  2523             20  PI-INT-RATE     PIC S99V9(5).
  2524             20  PI-AIGFROM      PIC 9(6).
  2525             20  PI-LOAN-NO      PIC X(20).
  2526             20  PI-PROOF-DATE   PIC 9(6).
  2527             20  PI-PRINT-EOB-YN PIC X.
  2528             20  PI-PRINT-CLM-FRM-YN PIC X.
  2529             20  PI-PRINT-SURVEY-YN PIC X.
  2530             20  PI-SPECIAL-RELEASE-YN PIC X.
  2531             20  pi-int-to-rem-borr pic x.
  2532         16  PI-SAVE-COMPUTED.
  2533             20  PI-CCHECKNO     PIC X(7).
  2534             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2535                 28  PI-CCHECKNO-N     PIC X.
  2536                 28  PI-CCHECKNO-6     PIC X(6).
  2537             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2538                 24  PI-CCHECKNO-CR    PIC XX.
  2539                 24  PI-CCHECKNO-5     PIC X(5).
  2540             20  PI-CPYFROM      PIC XX.
  2541             20  PI-CPYTHRU      PIC XX.
  2542             20  PI-CDAYS        PIC S9(5).
  2543             20  PI-CPYAMT       PIC S9(7)V99.
  2544             20  PI-CRESV        PIC 9(6)V99.
  2545             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  52
* EL156.cbl
  2546             20  PI-PMT-APPR-SW  PIC X.
  2547                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2548                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2549                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2550         16  PI-PREV-CLMNO       PIC X(7).
  2551         16  PI-LF-COVERAGE-TYPE PIC X.
  2552         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2553         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2554         16  PI-PROVISIONAL-IND  PIC X.
  2555             88 PI-PROV-PMT      VALUE 'P'.
  2556         16  PI-PREV-TRLR-KEY    PIC X(22).
  2557         16  PI-SPLIT-PMT-SW     PIC X.
  2558         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2559         16  PI-ACTIVITY-CODE    PIC 99.
  2560         16  PI-RESET-SW         PIC X.
  2561         16  PI-SPECIAL-BEN-SW   PIC X.
  2562             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2563         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2564         16  PI-EXP-DT           PIC XX.
  2565         16  PI-LOAN-DUE-DAY     PIC 99.
  2566         16  PI-3RD-PARTY-SW     PIC X.
  2567         16  PI-LOAN-UPDATE-SW   PIC X.
  2568
  2569         16  PI-DMD-DATA.
  2570             20  PI-SV-CERT-KEY       PIC X(21).
  2571             20  PI-SV-CERT-NO        PIC X(11).
  2572             20  PI-SV-BEN            PIC X(10).
  2573             20  PI-SV-CCN            PIC X(16).
  2574             20  PI-INTEREST-PAID-IND PIC X.
  2575                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2576             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2577             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2578             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2579             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2580         16  PI-AT-EOB-CODES.
  2581             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2582         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2583         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2584         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2585         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2586         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2587         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2588         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2589         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2590         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2591         16  PI-LF-BENEFIT-CD         PIC X(2).
  2592         16  PI-EOB-CODES-EXIST PIC X.
  2593         16  PI-SET-NOTE2-MDT   PIC X.
  2594         16  PI-VFY-2ND-BENE          PIC X.
  2595         16  PI-CLM-TYPE              PIC X.
  2596         16  PI-APPROVAL-LEVEL        PIC X.
  2597         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2598         16  PI-REAUDIT-NEEDED        PIC X.
  2599         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2600         16  PI-AH-BENEFIT-CD         PIC XX.
  2601         16  pi-ah-term               pic s999 comp-3.
  2602         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2603         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  53
* EL156.cbl
  2604         16  pi-max-ext-used          pic x.
  2605         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2606         16  PI-JOINT-COV-IND         PIC X.
  2607             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2608             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2609         16  PI-JOINT-INSURED-IND     PIC X.
  2610             88  PI-JOINT-INSURED        VALUE 'Y'.
  2611             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2612         16  pi-int-payees-name       pic x(30).
  2613         16  PI-RB-JOINT-COV-IND      PIC X.
  2614             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2615             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2616         16  pi-ach-payment           pic x.
  2617         16  PI-DUPE-APPROVAL-NEEDED  PIC X.
  2618*00781          16  FILLER                   PIC X(176).
  2619*052506         16  FILLER                   PIC X(161).
  2620*031808         16  FILLER                   PIC X(154).
  2621*091808         16  FILLER                   PIC X(152).
  2622*041710         16  FILLER                   PIC X(94).
  2623         16  FILLER                   PIC X(33).
  2624
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  54
* EL156.cbl
  2626*    COPY ELCJPFX.
  2627******************************************************************
  2628*                                                                *
  2629*                                                                *
  2630*                            ELCJPFX.                            *
  2631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2632*                            VMOD=2.002                          *
  2633*                                                                *
  2634*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2635*                                                                *
  2636*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2637*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2638*        ELCNTL - CONTROL FILE                                   *
  2639*        ELMSTR - CLAIM MASTERS                                  *
  2640*        ELTRLR - ACTIVITY TRAILERS                              *
  2641*        ELCHKQ - CHECK QUE                                      *
  2642******************************************************************
  2643 01  JOURNAL-RECORD.
  2644     12  jp-date                     pic s9(5) comp-3.
  2645     12  jp-time                     pic s9(7) comp-3.
  2646     12  JP-USER-ID                  PIC X(4).
  2647     12  JP-FILE-ID                  PIC X(8).
  2648     12  JP-PROGRAM-ID               PIC X(8).
  2649     12  JP-RECORD-TYPE              PIC X.
  2650         88 JP-ADD              VALUE 'A'.
  2651         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2652         88 JP-AFTER-CHANGE     VALUE 'C'.
  2653         88 JP-DELETE           VALUE 'D'.
  2654         88 JP-GENERIC-DELETE   VALUE 'G'.
  2655         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2656         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2657     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2658     12  JP-RECORD-AREA
  2659
  2660
  2661                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  55
* EL156.cbl
  2663*    COPY ELCAID.
  2664******************************************************************
  2665*                                                                *
  2666*                            ELCAID.                             *
  2667*                            VMOD=2.001                          *
  2668*                                                                *
  2669*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2670*                                                                *
  2671*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2672*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2673******************************************************************
  2674
  2675 01  DFHAID.
  2676   02  DFHNULL   PIC  X  VALUE  ' '.
  2677   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2678   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2679   02  DFHPEN    PIC  X  VALUE  '='.
  2680   02  DFHOPID   PIC  X  VALUE  'W'.
  2681   02  DFHPA1    PIC  X  VALUE  '%'.
  2682   02  DFHPA2    PIC  X  VALUE  '>'.
  2683   02  DFHPA3    PIC  X  VALUE  ','.
  2684   02  DFHPF1    PIC  X  VALUE  '1'.
  2685   02  DFHPF2    PIC  X  VALUE  '2'.
  2686   02  DFHPF3    PIC  X  VALUE  '3'.
  2687   02  DFHPF4    PIC  X  VALUE  '4'.
  2688   02  DFHPF5    PIC  X  VALUE  '5'.
  2689   02  DFHPF6    PIC  X  VALUE  '6'.
  2690   02  DFHPF7    PIC  X  VALUE  '7'.
  2691   02  DFHPF8    PIC  X  VALUE  '8'.
  2692   02  DFHPF9    PIC  X  VALUE  '9'.
  2693   02  DFHPF10   PIC  X  VALUE  ':'.
  2694   02  DFHPF11   PIC  X  VALUE  '#'.
  2695   02  DFHPF12   PIC  X  VALUE  '@'.
  2696   02  DFHPF13   PIC  X  VALUE  'A'.
  2697   02  DFHPF14   PIC  X  VALUE  'B'.
  2698   02  DFHPF15   PIC  X  VALUE  'C'.
  2699   02  DFHPF16   PIC  X  VALUE  'D'.
  2700   02  DFHPF17   PIC  X  VALUE  'E'.
  2701   02  DFHPF18   PIC  X  VALUE  'F'.
  2702   02  DFHPF19   PIC  X  VALUE  'G'.
  2703   02  DFHPF20   PIC  X  VALUE  'H'.
  2704   02  DFHPF21   PIC  X  VALUE  'I'.
  2705*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2706   02  DFHPF22   PIC  X  VALUE  '['.
  2707   02  DFHPF23   PIC  X  VALUE  '.'.
  2708   02  DFHPF24   PIC  X  VALUE  '<'.
  2709   02  DFHMSRE   PIC  X  VALUE  'X'.
  2710   02  DFHSTRF   PIC  X  VALUE  'h'.
  2711   02  DFHTRIG   PIC  X  VALUE  '"'.
  2712 01  FILLER    REDEFINES DFHAID.
  2713     12  FILLER              PIC X(8).
  2714     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  56
* EL156.cbl
  2716*    COPY EL156S.
  2717 01  EL156AI.
  2718     05  FILLER            PIC  X(0012).
  2719*    -------------------------------
  2720     05  RUNDTEAL PIC S9(0004) COMP.
  2721     05  RUNDTEAF PIC  X(0001).
  2722     05  FILLER REDEFINES RUNDTEAF.
  2723         10  RUNDTEAA PIC  X(0001).
  2724     05  RUNDTEAI PIC  X(0008).
  2725*    -------------------------------
  2726     05  RUNTIMAL PIC S9(0004) COMP.
  2727     05  RUNTIMAF PIC  X(0001).
  2728     05  FILLER REDEFINES RUNTIMAF.
  2729         10  RUNTIMAA PIC  X(0001).
  2730     05  RUNTIMAI PIC  X(0005).
  2731*    -------------------------------
  2732     05  SEQUL PIC S9(0004) COMP.
  2733     05  SEQUF PIC  X(0001).
  2734     05  FILLER REDEFINES SEQUF.
  2735         10  SEQUA PIC  X(0001).
  2736     05  SEQUI PIC  X(0010).
  2737*    -------------------------------
  2738     05  CLMNOL PIC S9(0004) COMP.
  2739     05  CLMNOF PIC  X(0001).
  2740     05  FILLER REDEFINES CLMNOF.
  2741         10  CLMNOA PIC  X(0001).
  2742     05  CLMNOI PIC  X(0007).
  2743*    -------------------------------
  2744     05  CARRL PIC S9(0004) COMP.
  2745     05  CARRF PIC  X(0001).
  2746     05  FILLER REDEFINES CARRF.
  2747         10  CARRA PIC  X(0001).
  2748     05  CARRI PIC  X(0001).
  2749*    -------------------------------
  2750     05  CERTNOL PIC S9(0004) COMP.
  2751     05  CERTNOF PIC  X(0001).
  2752     05  FILLER REDEFINES CERTNOF.
  2753         10  CERTNOA PIC  X(0001).
  2754     05  CERTNOI PIC  X(0010).
  2755*    -------------------------------
  2756     05  SUFXL PIC S9(0004) COMP.
  2757     05  SUFXF PIC  X(0001).
  2758     05  FILLER REDEFINES SUFXF.
  2759         10  SUFXA PIC  X(0001).
  2760     05  SUFXI PIC  X(0001).
  2761*    -------------------------------
  2762     05  CLMTYPL PIC S9(0004) COMP.
  2763     05  CLMTYPF PIC  X(0001).
  2764     05  FILLER REDEFINES CLMTYPF.
  2765         10  CLMTYPA PIC  X(0001).
  2766     05  CLMTYPI PIC  X(0006).
  2767*    -------------------------------
  2768     05  CLMSTATL PIC S9(0004) COMP.
  2769     05  CLMSTATF PIC  X(0001).
  2770     05  FILLER REDEFINES CLMSTATF.
  2771         10  CLMSTATA PIC  X(0001).
  2772     05  CLMSTATI PIC  X(0006).
  2773*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  57
* EL156.cbl
  2774     05  LSTNMEL PIC S9(0004) COMP.
  2775     05  LSTNMEF PIC  X(0001).
  2776     05  FILLER REDEFINES LSTNMEF.
  2777         10  LSTNMEA PIC  X(0001).
  2778     05  LSTNMEI PIC  X(0015).
  2779*    -------------------------------
  2780     05  FSTNMEL PIC S9(0004) COMP.
  2781     05  FSTNMEF PIC  X(0001).
  2782     05  FILLER REDEFINES FSTNMEF.
  2783         10  FSTNMEA PIC  X(0001).
  2784     05  FSTNMEI PIC  X(0012).
  2785*    -------------------------------
  2786     05  MINITL PIC S9(0004) COMP.
  2787     05  MINITF PIC  X(0001).
  2788     05  FILLER REDEFINES MINITF.
  2789         10  MINITA PIC  X(0001).
  2790     05  MINITI PIC  X(0001).
  2791*    -------------------------------
  2792     05  PRIMHDGL PIC S9(0004) COMP.
  2793     05  PRIMHDGF PIC  X(0001).
  2794     05  FILLER REDEFINES PRIMHDGF.
  2795         10  PRIMHDGA PIC  X(0001).
  2796     05  PRIMHDGI PIC  X(0012).
  2797*    -------------------------------
  2798     05  PCERTNOL PIC S9(0004) COMP.
  2799     05  PCERTNOF PIC  X(0001).
  2800     05  FILLER REDEFINES PCERTNOF.
  2801         10  PCERTNOA PIC  X(0001).
  2802     05  PCERTNOI PIC  X(0010).
  2803*    -------------------------------
  2804     05  PSUFXL PIC S9(0004) COMP.
  2805     05  PSUFXF PIC  X(0001).
  2806     05  FILLER REDEFINES PSUFXF.
  2807         10  PSUFXA PIC  X(0001).
  2808     05  PSUFXI PIC  X(0001).
  2809*    -------------------------------
  2810     05  STATUSL PIC S9(0004) COMP.
  2811     05  STATUSF PIC  X(0001).
  2812     05  FILLER REDEFINES STATUSF.
  2813         10  STATUSA PIC  X(0001).
  2814     05  STATUSI PIC  X(0010).
  2815*    -------------------------------
  2816     05  LOANHL PIC S9(0004) COMP.
  2817     05  LOANHF PIC  X(0001).
  2818     05  FILLER REDEFINES LOANHF.
  2819         10  LOANHA PIC  X(0001).
  2820     05  LOANHI PIC  X(0014).
  2821*    -------------------------------
  2822     05  LOANNOL PIC S9(0004) COMP.
  2823     05  LOANNOF PIC  X(0001).
  2824     05  FILLER REDEFINES LOANNOF.
  2825         10  LOANNOA PIC  X(0001).
  2826     05  LOANNOI PIC  X(0025).
  2827*    -------------------------------
  2828     05  DUEDAYHL PIC S9(0004) COMP.
  2829     05  DUEDAYHF PIC  X(0001).
  2830     05  FILLER REDEFINES DUEDAYHF.
  2831         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  58
* EL156.cbl
  2832     05  DUEDAYHI PIC  X(0008).
  2833*    -------------------------------
  2834     05  DUEDAYL PIC S9(0004) COMP.
  2835     05  DUEDAYF PIC  X(0001).
  2836     05  FILLER REDEFINES DUEDAYF.
  2837         10  DUEDAYA PIC  X(0001).
  2838     05  DUEDAYI PIC  X(0002).
  2839*    -------------------------------
  2840     05  ZINTHL PIC S9(0004) COMP.
  2841     05  ZINTHF PIC  X(0001).
  2842     05  FILLER REDEFINES ZINTHF.
  2843         10  ZINTHA PIC  X(0001).
  2844     05  ZINTHI PIC  X(0009).
  2845*    -------------------------------
  2846     05  ZINTL PIC S9(0004) COMP.
  2847     05  ZINTF PIC  X(0001).
  2848     05  FILLER REDEFINES ZINTF.
  2849         10  ZINTA PIC  X(0001).
  2850     05  ZINTI PIC  99V99999.
  2851*    -------------------------------
  2852     05  PTHRHDGL PIC S9(0004) COMP.
  2853     05  PTHRHDGF PIC  X(0001).
  2854     05  FILLER REDEFINES PTHRHDGF.
  2855         10  PTHRHDGA PIC  X(0001).
  2856     05  PTHRHDGI PIC  X(0014).
  2857*    -------------------------------
  2858     05  PDTHRUL PIC S9(0004) COMP.
  2859     05  PDTHRUF PIC  X(0001).
  2860     05  FILLER REDEFINES PDTHRUF.
  2861         10  PDTHRUA PIC  X(0001).
  2862     05  PDTHRUI PIC  X(0008).
  2863*    -------------------------------
  2864     05  TOTPAIDL PIC S9(0004) COMP.
  2865     05  TOTPAIDF PIC  X(0001).
  2866     05  FILLER REDEFINES TOTPAIDF.
  2867         10  TOTPAIDA PIC  X(0001).
  2868     05  TOTPAIDI PIC  X(0010).
  2869*    -------------------------------
  2870     05  COVERL PIC S9(0004) COMP.
  2871     05  COVERF PIC  X(0001).
  2872     05  FILLER REDEFINES COVERF.
  2873         10  COVERA PIC  X(0001).
  2874     05  COVERI PIC  X(0010).
  2875*    -------------------------------
  2876     05  INCURL PIC S9(0004) COMP.
  2877     05  INCURF PIC  X(0001).
  2878     05  FILLER REDEFINES INCURF.
  2879         10  INCURA PIC  X(0001).
  2880     05  INCURI PIC  X(0008).
  2881*    -------------------------------
  2882     05  LSTDTEL PIC S9(0004) COMP.
  2883     05  LSTDTEF PIC  X(0001).
  2884     05  FILLER REDEFINES LSTDTEF.
  2885         10  LSTDTEA PIC  X(0001).
  2886     05  LSTDTEI PIC  X(0008).
  2887*    -------------------------------
  2888     05  CRTSTATL PIC S9(0004) COMP.
  2889     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  59
* EL156.cbl
  2890     05  FILLER REDEFINES CRTSTATF.
  2891         10  CRTSTATA PIC  X(0001).
  2892     05  CRTSTATI PIC  X(0010).
  2893*    -------------------------------
  2894     05  EFFECTL PIC S9(0004) COMP.
  2895     05  EFFECTF PIC  X(0001).
  2896     05  FILLER REDEFINES EFFECTF.
  2897         10  EFFECTA PIC  X(0001).
  2898     05  EFFECTI PIC  X(0008).
  2899*    -------------------------------
  2900     05  TERMSL PIC S9(0004) COMP.
  2901     05  TERMSF PIC  X(0001).
  2902     05  FILLER REDEFINES TERMSF.
  2903         10  TERMSA PIC  X(0001).
  2904     05  TERMSI PIC  X(0011).
  2905*    -------------------------------
  2906     05  STACCTL PIC S9(0004) COMP.
  2907     05  STACCTF PIC  X(0001).
  2908     05  FILLER REDEFINES STACCTF.
  2909         10  STACCTA PIC  X(0001).
  2910     05  STACCTI PIC  X(0013).
  2911*    -------------------------------
  2912     05  EXPDTEHL PIC S9(0004) COMP.
  2913     05  EXPDTEHF PIC  X(0001).
  2914     05  FILLER REDEFINES EXPDTEHF.
  2915         10  EXPDTEHA PIC  X(0001).
  2916     05  EXPDTEHI PIC  X(0014).
  2917*    -------------------------------
  2918     05  EXPDTEL PIC S9(0004) COMP.
  2919     05  EXPDTEF PIC  X(0001).
  2920     05  FILLER REDEFINES EXPDTEF.
  2921         10  EXPDTEA PIC  X(0001).
  2922     05  EXPDTEI PIC  X(0008).
  2923*    -------------------------------
  2924     05  BENECAPL PIC S9(0004) COMP.
  2925     05  BENECAPF PIC  X(0001).
  2926     05  FILLER REDEFINES BENECAPF.
  2927         10  BENECAPA PIC  X(0001).
  2928     05  BENECAPI PIC  X(0013).
  2929*    -------------------------------
  2930     05  BENEL PIC S9(0004) COMP.
  2931     05  BENEF PIC  X(0001).
  2932     05  FILLER REDEFINES BENEF.
  2933         10  BENEA PIC  X(0001).
  2934     05  BENEI PIC  X(0009).
  2935*    -------------------------------
  2936     05  FORMTYPL PIC S9(0004) COMP.
  2937     05  FORMTYPF PIC  X(0001).
  2938     05  FILLER REDEFINES FORMTYPF.
  2939         10  FORMTYPA PIC  X(0001).
  2940     05  FORMTYPI PIC  X(0001).
  2941*    -------------------------------
  2942     05  PMTTYPEL PIC S9(0004) COMP.
  2943     05  PMTTYPEF PIC  X(0001).
  2944     05  FILLER REDEFINES PMTTYPEF.
  2945         10  PMTTYPEA PIC  X(0001).
  2946     05  PMTTYPEI PIC  X(0001).
  2947*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  60
* EL156.cbl
  2948     05  PAYEEL PIC S9(0004) COMP.
  2949     05  PAYEEF PIC  X(0001).
  2950     05  FILLER REDEFINES PAYEEF.
  2951         10  PAYEEA PIC  X(0001).
  2952     05  PAYEEI PIC  X(0002).
  2953*    -------------------------------
  2954     05  CHECKNOL PIC S9(0004) COMP.
  2955     05  CHECKNOF PIC  X(0001).
  2956     05  FILLER REDEFINES CHECKNOF.
  2957         10  CHECKNOA PIC  X(0001).
  2958     05  CHECKNOI PIC  X(0007).
  2959*    -------------------------------
  2960     05  OFFLINEL PIC S9(0004) COMP.
  2961     05  OFFLINEF PIC  X(0001).
  2962     05  FILLER REDEFINES OFFLINEF.
  2963         10  OFFLINEA PIC  X(0001).
  2964     05  OFFLINEI PIC  X(0001).
  2965*    -------------------------------
  2966     05  HOLDTILL PIC S9(0004) COMP.
  2967     05  HOLDTILF PIC  X(0001).
  2968     05  FILLER REDEFINES HOLDTILF.
  2969         10  HOLDTILA PIC  X(0001).
  2970     05  HOLDTILI PIC  X(0008).
  2971*    -------------------------------
  2972     05  NOTE1L PIC S9(0004) COMP.
  2973     05  NOTE1F PIC  X(0001).
  2974     05  FILLER REDEFINES NOTE1F.
  2975         10  NOTE1A PIC  X(0001).
  2976     05  NOTE1I PIC  X(0060).
  2977*    -------------------------------
  2978     05  ITRB1L PIC S9(0004) COMP.
  2979     05  ITRB1F PIC  X(0001).
  2980     05  FILLER REDEFINES ITRB1F.
  2981         10  ITRB1A PIC  X(0001).
  2982     05  ITRB1I PIC  X(0008).
  2983*    -------------------------------
  2984     05  NOTE2L PIC S9(0004) COMP.
  2985     05  NOTE2F PIC  X(0001).
  2986     05  FILLER REDEFINES NOTE2F.
  2987         10  NOTE2A PIC  X(0001).
  2988     05  NOTE2I PIC  X(0060).
  2989*    -------------------------------
  2990     05  ITRB2L PIC S9(0004) COMP.
  2991     05  ITRB2F PIC  X(0001).
  2992     05  FILLER REDEFINES ITRB2F.
  2993         10  ITRB2A PIC  X(0001).
  2994     05  ITRB2I PIC  X(0010).
  2995*    -------------------------------
  2996     05  EOBYNL PIC S9(0004) COMP.
  2997     05  EOBYNF PIC  X(0001).
  2998     05  FILLER REDEFINES EOBYNF.
  2999         10  EOBYNA PIC  X(0001).
  3000     05  EOBYNI PIC  X(0001).
  3001*    -------------------------------
  3002     05  CLMFMYNL PIC S9(0004) COMP.
  3003     05  CLMFMYNF PIC  X(0001).
  3004     05  FILLER REDEFINES CLMFMYNF.
  3005         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  61
* EL156.cbl
  3006     05  CLMFMYNI PIC  X(0001).
  3007*    -------------------------------
  3008     05  SURVYYNL PIC S9(0004) COMP.
  3009     05  SURVYYNF PIC  X(0001).
  3010     05  FILLER REDEFINES SURVYYNF.
  3011         10  SURVYYNA PIC  X(0001).
  3012     05  SURVYYNI PIC  X(0001).
  3013*    -------------------------------
  3014     05  SPRELYNL PIC S9(0004) COMP.
  3015     05  SPRELYNF PIC  X(0001).
  3016     05  FILLER REDEFINES SPRELYNF.
  3017         10  SPRELYNA PIC  X(0001).
  3018     05  SPRELYNI PIC  X(0001).
  3019*    -------------------------------
  3020     05  PINTHL PIC S9(0004) COMP.
  3021     05  PINTHF PIC  X(0001).
  3022     05  FILLER REDEFINES PINTHF.
  3023         10  PINTHA PIC  X(0001).
  3024     05  PINTHI PIC  X(0004).
  3025*    -------------------------------
  3026     05  PINTL PIC S9(0004) COMP.
  3027     05  PINTF PIC  X(0001).
  3028     05  FILLER REDEFINES PINTF.
  3029         10  PINTA PIC  X(0001).
  3030     05  PINTI PIC  X(0008).
  3031*    -------------------------------
  3032     05  ITRBYNL PIC S9(0004) COMP.
  3033     05  ITRBYNF PIC  X(0001).
  3034     05  FILLER REDEFINES ITRBYNF.
  3035         10  ITRBYNA PIC  X(0001).
  3036     05  ITRBYNI PIC  X(0001).
  3037*    -------------------------------
  3038     05  PROOFDTL PIC S9(0004) COMP.
  3039     05  PROOFDTF PIC  X(0001).
  3040     05  FILLER REDEFINES PROOFDTF.
  3041         10  PROOFDTA PIC  X(0001).
  3042     05  PROOFDTI PIC  X(0008).
  3043*    -------------------------------
  3044     05  AIGFRMHL PIC S9(0004) COMP.
  3045     05  AIGFRMHF PIC  X(0001).
  3046     05  FILLER REDEFINES AIGFRMHF.
  3047         10  AIGFRMHA PIC  X(0001).
  3048     05  AIGFRMHI PIC  X(0012).
  3049*    -------------------------------
  3050     05  AIGFROML PIC S9(0004) COMP.
  3051     05  AIGFROMF PIC  X(0001).
  3052     05  FILLER REDEFINES AIGFROMF.
  3053         10  AIGFROMA PIC  X(0001).
  3054     05  AIGFROMI PIC  X(0008).
  3055*    -------------------------------
  3056     05  PMTHDGAL PIC S9(0004) COMP.
  3057     05  PMTHDGAF PIC  X(0001).
  3058     05  FILLER REDEFINES PMTHDGAF.
  3059         10  PMTHDGAA PIC  X(0001).
  3060     05  PMTHDGAI PIC  X(0066).
  3061*    -------------------------------
  3062     05  EPYFROML PIC S9(0004) COMP.
  3063     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  62
* EL156.cbl
  3064     05  FILLER REDEFINES EPYFROMF.
  3065         10  EPYFROMA PIC  X(0001).
  3066     05  EPYFROMI PIC  X(0008).
  3067*    -------------------------------
  3068     05  EPYTHRUL PIC S9(0004) COMP.
  3069     05  EPYTHRUF PIC  X(0001).
  3070     05  FILLER REDEFINES EPYTHRUF.
  3071         10  EPYTHRUA PIC  X(0001).
  3072     05  EPYTHRUI PIC  X(0008).
  3073*    -------------------------------
  3074     05  EDAYSL PIC S9(0004) COMP.
  3075     05  EDAYSF PIC  X(0001).
  3076     05  FILLER REDEFINES EDAYSF.
  3077         10  EDAYSA PIC  X(0001).
  3078     05  EDAYSI PIC  S9(6).
  3079*    -------------------------------
  3080     05  EPYAMTL PIC S9(0004) COMP.
  3081     05  EPYAMTF PIC  X(0001).
  3082     05  FILLER REDEFINES EPYAMTF.
  3083         10  EPYAMTA PIC  X(0001).
  3084     05  EPYAMTI PIC  S9(8)V99.
  3085*    -------------------------------
  3086     05  ERESVL PIC S9(0004) COMP.
  3087     05  ERESVF PIC  X(0001).
  3088     05  FILLER REDEFINES ERESVF.
  3089         10  ERESVA PIC  X(0001).
  3090     05  ERESVI PIC  S9(7)V99.
  3091*    -------------------------------
  3092     05  ETYPEL PIC S9(0004) COMP.
  3093     05  ETYPEF PIC  X(0001).
  3094     05  FILLER REDEFINES ETYPEF.
  3095         10  ETYPEA PIC  X(0001).
  3096     05  ETYPEI PIC  X(0001).
  3097*    -------------------------------
  3098     05  EEXPENSL PIC S9(0004) COMP.
  3099     05  EEXPENSF PIC  X(0001).
  3100     05  FILLER REDEFINES EEXPENSF.
  3101         10  EEXPENSA PIC  X(0001).
  3102     05  EEXPENSI PIC  9(6)V99.
  3103*    -------------------------------
  3104     05  CPYFROML PIC S9(0004) COMP.
  3105     05  CPYFROMF PIC  X(0001).
  3106     05  FILLER REDEFINES CPYFROMF.
  3107         10  CPYFROMA PIC  X(0001).
  3108     05  CPYFROMI PIC  X(0008).
  3109*    -------------------------------
  3110     05  CPYTHRUL PIC S9(0004) COMP.
  3111     05  CPYTHRUF PIC  X(0001).
  3112     05  FILLER REDEFINES CPYTHRUF.
  3113         10  CPYTHRUA PIC  X(0001).
  3114     05  CPYTHRUI PIC  X(0008).
  3115*    -------------------------------
  3116     05  CDAYSL PIC S9(0004) COMP.
  3117     05  CDAYSF PIC  X(0001).
  3118     05  FILLER REDEFINES CDAYSF.
  3119         10  CDAYSA PIC  X(0001).
  3120     05  CDAYSI PIC  9(6).
  3121*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  63
* EL156.cbl
  3122     05  CPYAMTL PIC S9(0004) COMP.
  3123     05  CPYAMTF PIC  X(0001).
  3124     05  FILLER REDEFINES CPYAMTF.
  3125         10  CPYAMTA PIC  X(0001).
  3126     05  CPYAMTI PIC  S9(8)V99.
  3127*    -------------------------------
  3128     05  CRESVL PIC S9(0004) COMP.
  3129     05  CRESVF PIC  X(0001).
  3130     05  FILLER REDEFINES CRESVF.
  3131         10  CRESVA PIC  X(0001).
  3132     05  CRESVI PIC  9(6)V99.
  3133*    -------------------------------
  3134     05  CEXPENSL PIC S9(0004) COMP.
  3135     05  CEXPENSF PIC  X(0001).
  3136     05  FILLER REDEFINES CEXPENSF.
  3137         10  CEXPENSA PIC  X(0001).
  3138     05  CEXPENSI PIC  9(6)V99.
  3139*    -------------------------------
  3140     05  ERRMSG0L PIC S9(0004) COMP.
  3141     05  ERRMSG0F PIC  X(0001).
  3142     05  FILLER REDEFINES ERRMSG0F.
  3143         10  ERRMSG0A PIC  X(0001).
  3144     05  ERRMSG0I PIC  X(0072).
  3145*    -------------------------------
  3146     05  ERRMSG1L PIC S9(0004) COMP.
  3147     05  ERRMSG1F PIC  X(0001).
  3148     05  FILLER REDEFINES ERRMSG1F.
  3149         10  ERRMSG1A PIC  X(0001).
  3150     05  ERRMSG1I PIC  X(0072).
  3151*    -------------------------------
  3152     05  ERRMSG2L PIC S9(0004) COMP.
  3153     05  ERRMSG2F PIC  X(0001).
  3154     05  FILLER REDEFINES ERRMSG2F.
  3155         10  ERRMSG2A PIC  X(0001).
  3156     05  ERRMSG2I PIC  X(0072).
  3157*    -------------------------------
  3158     05  ENTERPFL PIC S9(0004) COMP.
  3159     05  ENTERPFF PIC  X(0001).
  3160     05  FILLER REDEFINES ENTERPFF.
  3161         10  ENTERPFA PIC  X(0001).
  3162     05  ENTERPFI PIC  99.
  3163*    -------------------------------
  3164     05  PF6TITL PIC S9(0004) COMP.
  3165     05  PF6TITF PIC  X(0001).
  3166     05  FILLER REDEFINES PF6TITF.
  3167         10  PF6TITA PIC  X(0001).
  3168     05  PF6TITI PIC  X(0016).
  3169 01  EL156AO REDEFINES EL156AI.
  3170     05  FILLER            PIC  X(0012).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  RUNDTEAO PIC  X(0008).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  RUNTIMAO PIC  99.99.
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  64
* EL156.cbl
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  CLMNOO PIC  X(0007).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  CARRO PIC  X(0001).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  CERTNOO PIC  X(0010).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  SUFXO PIC  X(0001).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  CLMTYPO PIC  X(0006).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  CLMSTATO PIC  X(0006).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  LSTNMEO PIC  X(0015).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  FSTNMEO PIC  X(0012).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  MINITO PIC  X(0001).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  PRIMHDGO PIC  X(0012).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PCERTNOO PIC  X(0010).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PSUFXO PIC  X(0001).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  STATUSO PIC  X(0010).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  LOANHO PIC  X(0014).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  LOANNOO PIC  X(0025).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  DUEDAYHO PIC  X(0008).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  DUEDAYO PIC  X(0002).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  ZINTHO PIC  X(0009).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  ZINTO PIC  9.99999.
  3237*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  65
* EL156.cbl
  3238     05  FILLER            PIC  X(0003).
  3239     05  PTHRHDGO PIC  X(0014).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  PDTHRUO PIC  X(0008).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  TOTPAIDO PIC  Z(6).99-.
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  COVERO PIC  X(0010).
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  INCURO PIC  X(0008).
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  LSTDTEO PIC  X(0008).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  CRTSTATO PIC  X(0010).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  EFFECTO PIC  X(0008).
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  TERMSO PIC  X(0011).
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  STACCTO PIC  X(0013).
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  EXPDTEHO PIC  X(0014).
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  EXPDTEO PIC  X(0008).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  BENECAPO PIC  X(0013).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  BENEO PIC  Z(6).99.
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  FORMTYPO PIC  X(0001).
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  PMTTYPEO PIC  X(0001).
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  PAYEEO PIC  X(0002).
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  CHECKNOO PIC  X(0007).
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  OFFLINEO PIC  X(0001).
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  66
* EL156.cbl
  3296     05  HOLDTILO PIC  99B99B99.
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  NOTE1O PIC  X(0060).
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  ITRB1O PIC  X(0008).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  NOTE2O PIC  X(0060).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  ITRB2O PIC  X(0010).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  EOBYNO PIC  X(0001).
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  CLMFMYNO PIC  X(0001).
  3315*    -------------------------------
  3316     05  FILLER            PIC  X(0003).
  3317     05  SURVYYNO PIC  X(0001).
  3318*    -------------------------------
  3319     05  FILLER            PIC  X(0003).
  3320     05  SPRELYNO PIC  X(0001).
  3321*    -------------------------------
  3322     05  FILLER            PIC  X(0003).
  3323     05  PINTHO PIC  X(0004).
  3324*    -------------------------------
  3325     05  FILLER            PIC  X(0003).
  3326     05  PINTO PIC  Z,ZZ9.99.
  3327*    -------------------------------
  3328     05  FILLER            PIC  X(0003).
  3329     05  ITRBYNO PIC  X(0001).
  3330*    -------------------------------
  3331     05  FILLER            PIC  X(0003).
  3332     05  PROOFDTO PIC  99B99B99.
  3333*    -------------------------------
  3334     05  FILLER            PIC  X(0003).
  3335     05  AIGFRMHO PIC  X(0012).
  3336*    -------------------------------
  3337     05  FILLER            PIC  X(0003).
  3338     05  AIGFROMO PIC  99B99B99.
  3339*    -------------------------------
  3340     05  FILLER            PIC  X(0003).
  3341     05  PMTHDGAO PIC  X(0066).
  3342*    -------------------------------
  3343     05  FILLER            PIC  X(0003).
  3344     05  EPYFROMO PIC  99B99B99.
  3345*    -------------------------------
  3346     05  FILLER            PIC  X(0003).
  3347     05  EPYTHRUO PIC  99B99B99.
  3348*    -------------------------------
  3349     05  FILLER            PIC  X(0003).
  3350     05  EDAYSO PIC  Z(4)9-.
  3351*    -------------------------------
  3352     05  FILLER            PIC  X(0003).
  3353     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  67
* EL156.cbl
  3354*    -------------------------------
  3355     05  FILLER            PIC  X(0003).
  3356     05  ERESVO PIC  Z(5).99-.
  3357*    -------------------------------
  3358     05  FILLER            PIC  X(0003).
  3359     05  ETYPEO PIC  X(0001).
  3360*    -------------------------------
  3361     05  FILLER            PIC  X(0003).
  3362     05  EEXPENSO PIC  Z(5).99.
  3363*    -------------------------------
  3364     05  FILLER            PIC  X(0003).
  3365     05  CPYFROMO PIC  99B99B99.
  3366*    -------------------------------
  3367     05  FILLER            PIC  X(0003).
  3368     05  CPYTHRUO PIC  99B99B99.
  3369*    -------------------------------
  3370     05  FILLER            PIC  X(0003).
  3371     05  CDAYSO PIC  Z(4)9-.
  3372*    -------------------------------
  3373     05  FILLER            PIC  X(0003).
  3374     05  CPYAMTO PIC  Z(6).99-.
  3375*    -------------------------------
  3376     05  FILLER            PIC  X(0003).
  3377     05  CRESVO PIC  Z(5).99.
  3378*    -------------------------------
  3379     05  FILLER            PIC  X(0003).
  3380     05  CEXPENSO PIC  Z(5).99.
  3381*    -------------------------------
  3382     05  FILLER            PIC  X(0003).
  3383     05  ERRMSG0O PIC  X(0072).
  3384*    -------------------------------
  3385     05  FILLER            PIC  X(0003).
  3386     05  ERRMSG1O PIC  X(0072).
  3387*    -------------------------------
  3388     05  FILLER            PIC  X(0003).
  3389     05  ERRMSG2O PIC  X(0072).
  3390*    -------------------------------
  3391     05  FILLER            PIC  X(0003).
  3392     05  ENTERPFO PIC  X(0002).
  3393*    -------------------------------
  3394     05  FILLER            PIC  X(0003).
  3395     05  PF6TITO PIC  X(0016).
  3396*    -------------------------------
  3397 01  EL156BI REDEFINES EL156AI.
  3398     05  FILLER            PIC  X(0012).
  3399*    -------------------------------
  3400     05  RUNDTEBL PIC S9(0004) COMP.
  3401     05  RUNDTEBF PIC  X(0001).
  3402     05  FILLER REDEFINES RUNDTEBF.
  3403         10  RUNDTEBA PIC  X(0001).
  3404     05  RUNDTEBI PIC  X(0008).
  3405*    -------------------------------
  3406     05  RUNTIMBL PIC S9(0004) COMP.
  3407     05  RUNTIMBF PIC  X(0001).
  3408     05  FILLER REDEFINES RUNTIMBF.
  3409         10  RUNTIMBA PIC  X(0001).
  3410     05  RUNTIMBI PIC  X(0005).
  3411*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  68
* EL156.cbl
  3412     05  PAYDTBL PIC S9(0004) COMP.
  3413     05  PAYDTBF PIC  X(0001).
  3414     05  FILLER REDEFINES PAYDTBF.
  3415         10  PAYDTBA PIC  X(0001).
  3416     05  PAYDTBI PIC  X(0008).
  3417*    -------------------------------
  3418     05  PAYTYPBL PIC S9(0004) COMP.
  3419     05  PAYTYPBF PIC  X(0001).
  3420     05  FILLER REDEFINES PAYTYPBF.
  3421         10  PAYTYPBA PIC  X(0001).
  3422     05  PAYTYPBI PIC  X(0015).
  3423*    -------------------------------
  3424     05  PAYAMTBL PIC S9(0004) COMP.
  3425     05  PAYAMTBF PIC  X(0001).
  3426     05  FILLER REDEFINES PAYAMTBF.
  3427         10  PAYAMTBA PIC  X(0001).
  3428     05  PAYAMTBI PIC  X(0011).
  3429*    -------------------------------
  3430     05  LOANHBL PIC S9(0004) COMP.
  3431     05  LOANHBF PIC  X(0001).
  3432     05  FILLER REDEFINES LOANHBF.
  3433         10  LOANHBA PIC  X(0001).
  3434     05  LOANHBI PIC  X(0012).
  3435*    -------------------------------
  3436     05  LOANNBL PIC S9(0004) COMP.
  3437     05  LOANNBF PIC  X(0001).
  3438     05  FILLER REDEFINES LOANNBF.
  3439         10  LOANNBA PIC  X(0001).
  3440     05  LOANNBI PIC  X(0025).
  3441*    -------------------------------
  3442     05  CKNUMHDL PIC S9(0004) COMP.
  3443     05  CKNUMHDF PIC  X(0001).
  3444     05  FILLER REDEFINES CKNUMHDF.
  3445         10  CKNUMHDA PIC  X(0001).
  3446     05  CKNUMHDI PIC  X(0012).
  3447*    -------------------------------
  3448     05  CKNUMBL PIC S9(0004) COMP.
  3449     05  CKNUMBF PIC  X(0001).
  3450     05  FILLER REDEFINES CKNUMBF.
  3451         10  CKNUMBA PIC  X(0001).
  3452     05  CKNUMBI PIC  X(0007).
  3453*    -------------------------------
  3454     05  AGTHDGL PIC S9(0004) COMP.
  3455     05  AGTHDGF PIC  X(0001).
  3456     05  FILLER REDEFINES AGTHDGF.
  3457         10  AGTHDGA PIC  X(0001).
  3458     05  AGTHDGI PIC  X(0016).
  3459*    -------------------------------
  3460     05  NAMEBL PIC S9(0004) COMP.
  3461     05  NAMEBF PIC  X(0001).
  3462     05  FILLER REDEFINES NAMEBF.
  3463         10  NAMEBA PIC  X(0001).
  3464     05  NAMEBI PIC  X(0030).
  3465*    -------------------------------
  3466     05  NAMEB2L PIC S9(0004) COMP.
  3467     05  NAMEB2F PIC  X(0001).
  3468     05  FILLER REDEFINES NAMEB2F.
  3469         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  69
* EL156.cbl
  3470     05  NAMEB2I PIC  X(0030).
  3471*    -------------------------------
  3472     05  ADDR1BL PIC S9(0004) COMP.
  3473     05  ADDR1BF PIC  X(0001).
  3474     05  FILLER REDEFINES ADDR1BF.
  3475         10  ADDR1BA PIC  X(0001).
  3476     05  ADDR1BI PIC  X(0030).
  3477*    -------------------------------
  3478     05  ADDR1B2L PIC S9(0004) COMP.
  3479     05  ADDR1B2F PIC  X(0001).
  3480     05  FILLER REDEFINES ADDR1B2F.
  3481         10  ADDR1B2A PIC  X(0001).
  3482     05  ADDR1B2I PIC  X(0030).
  3483*    -------------------------------
  3484     05  ADDR2BL PIC S9(0004) COMP.
  3485     05  ADDR2BF PIC  X(0001).
  3486     05  FILLER REDEFINES ADDR2BF.
  3487         10  ADDR2BA PIC  X(0001).
  3488     05  ADDR2BI PIC  X(0030).
  3489*    -------------------------------
  3490     05  ADDR2B2L PIC S9(0004) COMP.
  3491     05  ADDR2B2F PIC  X(0001).
  3492     05  FILLER REDEFINES ADDR2B2F.
  3493         10  ADDR2B2A PIC  X(0001).
  3494     05  ADDR2B2I PIC  X(0030).
  3495*    -------------------------------
  3496     05  CITYSTBL PIC S9(0004) COMP.
  3497     05  CITYSTBF PIC  X(0001).
  3498     05  FILLER REDEFINES CITYSTBF.
  3499         10  CITYSTBA PIC  X(0001).
  3500     05  CITYSTBI PIC  X(0030).
  3501*    -------------------------------
  3502     05  CITYST2L PIC S9(0004) COMP.
  3503     05  CITYST2F PIC  X(0001).
  3504     05  FILLER REDEFINES CITYST2F.
  3505         10  CITYST2A PIC  X(0001).
  3506     05  CITYST2I PIC  X(0030).
  3507*    -------------------------------
  3508     05  ZIPBL PIC S9(0004) COMP.
  3509     05  ZIPBF PIC  X(0001).
  3510     05  FILLER REDEFINES ZIPBF.
  3511         10  ZIPBA PIC  X(0001).
  3512     05  ZIPBI PIC  X(0009).
  3513*    -------------------------------
  3514     05  ZIPB2L PIC S9(0004) COMP.
  3515     05  ZIPB2F PIC  X(0001).
  3516     05  FILLER REDEFINES ZIPB2F.
  3517         10  ZIPB2A PIC  X(0001).
  3518     05  ZIPB2I PIC  X(0009).
  3519*    -------------------------------
  3520     05  INTHDBL PIC S9(0004) COMP.
  3521     05  INTHDBF PIC  X(0001).
  3522     05  FILLER REDEFINES INTHDBF.
  3523         10  INTHDBA PIC  X(0001).
  3524     05  INTHDBI PIC  X(0012).
  3525*    -------------------------------
  3526     05  INTAMTBL PIC S9(0004) COMP.
  3527     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  70
* EL156.cbl
  3528     05  FILLER REDEFINES INTAMTBF.
  3529         10  INTAMTBA PIC  X(0001).
  3530     05  INTAMTBI PIC  X(0011).
  3531*    -------------------------------
  3532     05  PMTHDGBL PIC S9(0004) COMP.
  3533     05  PMTHDGBF PIC  X(0001).
  3534     05  FILLER REDEFINES PMTHDGBF.
  3535         10  PMTHDGBA PIC  X(0001).
  3536     05  PMTHDGBI PIC  X(0034).
  3537*    -------------------------------
  3538     05  CLMNOBL PIC S9(0004) COMP.
  3539     05  CLMNOBF PIC  X(0001).
  3540     05  FILLER REDEFINES CLMNOBF.
  3541         10  CLMNOBA PIC  X(0001).
  3542     05  CLMNOBI PIC  X(0007).
  3543*    -------------------------------
  3544     05  CARRBL PIC S9(0004) COMP.
  3545     05  CARRBF PIC  X(0001).
  3546     05  FILLER REDEFINES CARRBF.
  3547         10  CARRBA PIC  X(0001).
  3548     05  CARRBI PIC  X(0001).
  3549*    -------------------------------
  3550     05  CERTNOBL PIC S9(0004) COMP.
  3551     05  CERTNOBF PIC  X(0001).
  3552     05  FILLER REDEFINES CERTNOBF.
  3553         10  CERTNOBA PIC  X(0001).
  3554     05  CERTNOBI PIC  X(0010).
  3555*    -------------------------------
  3556     05  SUFXBL PIC S9(0004) COMP.
  3557     05  SUFXBF PIC  X(0001).
  3558     05  FILLER REDEFINES SUFXBF.
  3559         10  SUFXBA PIC  X(0001).
  3560     05  SUFXBI PIC  X(0001).
  3561*    -------------------------------
  3562     05  CLMTYPBL PIC S9(0004) COMP.
  3563     05  CLMTYPBF PIC  X(0001).
  3564     05  FILLER REDEFINES CLMTYPBF.
  3565         10  CLMTYPBA PIC  X(0001).
  3566     05  CLMTYPBI PIC  X(0006).
  3567*    -------------------------------
  3568     05  INCURBL PIC S9(0004) COMP.
  3569     05  INCURBF PIC  X(0001).
  3570     05  FILLER REDEFINES INCURBF.
  3571         10  INCURBA PIC  X(0001).
  3572     05  INCURBI PIC  X(0008).
  3573*    -------------------------------
  3574     05  PYFROMBL PIC S9(0004) COMP.
  3575     05  PYFROMBF PIC  X(0001).
  3576     05  FILLER REDEFINES PYFROMBF.
  3577         10  PYFROMBA PIC  X(0001).
  3578     05  PYFROMBI PIC  X(0008).
  3579*    -------------------------------
  3580     05  PYTHRUBL PIC S9(0004) COMP.
  3581     05  PYTHRUBF PIC  X(0001).
  3582     05  FILLER REDEFINES PYTHRUBF.
  3583         10  PYTHRUBA PIC  X(0001).
  3584     05  PYTHRUBI PIC  X(0008).
  3585*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  71
* EL156.cbl
  3586     05  DAYSBL PIC S9(0004) COMP.
  3587     05  DAYSBF PIC  X(0001).
  3588     05  FILLER REDEFINES DAYSBF.
  3589         10  DAYSBA PIC  X(0001).
  3590     05  DAYSBI PIC  X(0005).
  3591*    -------------------------------
  3592     05  BYBL PIC S9(0004) COMP.
  3593     05  BYBF PIC  X(0001).
  3594     05  FILLER REDEFINES BYBF.
  3595         10  BYBA PIC  X(0001).
  3596     05  BYBI PIC  X(0004).
  3597*    -------------------------------
  3598     05  PROOFDBL PIC S9(0004) COMP.
  3599     05  PROOFDBF PIC  X(0001).
  3600     05  FILLER REDEFINES PROOFDBF.
  3601         10  PROOFDBA PIC  X(0001).
  3602     05  PROOFDBI PIC  X(0008).
  3603*    -------------------------------
  3604     05  ACCTBL PIC S9(0004) COMP.
  3605     05  ACCTBF PIC  X(0001).
  3606     05  FILLER REDEFINES ACCTBF.
  3607         10  ACCTBA PIC  X(0001).
  3608     05  ACCTBI PIC  X(0010).
  3609*    -------------------------------
  3610     05  STATEBL PIC S9(0004) COMP.
  3611     05  STATEBF PIC  X(0001).
  3612     05  FILLER REDEFINES STATEBF.
  3613         10  STATEBA PIC  X(0001).
  3614     05  STATEBI PIC  X(0002).
  3615*    -------------------------------
  3616     05  GROUPBL PIC S9(0004) COMP.
  3617     05  GROUPBF PIC  X(0001).
  3618     05  FILLER REDEFINES GROUPBF.
  3619         10  GROUPBA PIC  X(0001).
  3620     05  GROUPBI PIC  X(0006).
  3621*    -------------------------------
  3622     05  ACARRBL PIC S9(0004) COMP.
  3623     05  ACARRBF PIC  X(0001).
  3624     05  FILLER REDEFINES ACARRBF.
  3625         10  ACARRBA PIC  X(0001).
  3626     05  ACARRBI PIC  X(0001).
  3627*    -------------------------------
  3628     05  ACCTNMBL PIC S9(0004) COMP.
  3629     05  ACCTNMBF PIC  X(0001).
  3630     05  FILLER REDEFINES ACCTNMBF.
  3631         10  ACCTNMBA PIC  X(0001).
  3632     05  ACCTNMBI PIC  X(0030).
  3633*    -------------------------------
  3634     05  UNDISBL PIC S9(0004) COMP.
  3635     05  UNDISBF PIC  X(0001).
  3636     05  FILLER REDEFINES UNDISBF.
  3637         10  UNDISBA PIC  X(0001).
  3638     05  UNDISBI PIC  X(0010).
  3639*    -------------------------------
  3640     05  RATEBL PIC S9(0004) COMP.
  3641     05  RATEBF PIC  X(0001).
  3642     05  FILLER REDEFINES RATEBF.
  3643         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  72
* EL156.cbl
  3644     05  RATEBI PIC  X(0006).
  3645*    -------------------------------
  3646     05  ERMSG1BL PIC S9(0004) COMP.
  3647     05  ERMSG1BF PIC  X(0001).
  3648     05  FILLER REDEFINES ERMSG1BF.
  3649         10  ERMSG1BA PIC  X(0001).
  3650     05  ERMSG1BI PIC  X(0072).
  3651*    -------------------------------
  3652     05  ENTPFBL PIC S9(0004) COMP.
  3653     05  ENTPFBF PIC  X(0001).
  3654     05  FILLER REDEFINES ENTPFBF.
  3655         10  ENTPFBA PIC  X(0001).
  3656     05  ENTPFBI PIC  99.
  3657 01  EL156BO REDEFINES EL156AI.
  3658     05  FILLER            PIC  X(0012).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  RUNDTEBO PIC  X(0008).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  RUNTIMBO PIC  99.99.
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  PAYDTBO PIC  99B99B99.
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  PAYTYPBO PIC  X(0015).
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  LOANHBO PIC  X(0012).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  LOANNBO PIC  X(0025).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  CKNUMHDO PIC  X(0012).
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  CKNUMBO PIC  X(0007).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  AGTHDGO PIC  X(0016).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  NAMEBO PIC  X(0030).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  NAMEB2O PIC  X(0030).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  ADDR1BO PIC  X(0030).
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  ADDR1B2O PIC  X(0030).
  3701*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  73
* EL156.cbl
  3702     05  FILLER            PIC  X(0003).
  3703     05  ADDR2BO PIC  X(0030).
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
  3706     05  ADDR2B2O PIC  X(0030).
  3707*    -------------------------------
  3708     05  FILLER            PIC  X(0003).
  3709     05  CITYSTBO PIC  X(0030).
  3710*    -------------------------------
  3711     05  FILLER            PIC  X(0003).
  3712     05  CITYST2O PIC  X(0030).
  3713*    -------------------------------
  3714     05  FILLER            PIC  X(0003).
  3715     05  ZIPBO PIC  ZZZZ99999.
  3716*    -------------------------------
  3717     05  FILLER            PIC  X(0003).
  3718     05  ZIPB2O PIC  ZZZZZZZZZ.
  3719*    -------------------------------
  3720     05  FILLER            PIC  X(0003).
  3721     05  INTHDBO PIC  X(0012).
  3722*    -------------------------------
  3723     05  FILLER            PIC  X(0003).
  3724     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3725*    -------------------------------
  3726     05  FILLER            PIC  X(0003).
  3727     05  PMTHDGBO PIC  X(0034).
  3728*    -------------------------------
  3729     05  FILLER            PIC  X(0003).
  3730     05  CLMNOBO PIC  X(0007).
  3731*    -------------------------------
  3732     05  FILLER            PIC  X(0003).
  3733     05  CARRBO PIC  X(0001).
  3734*    -------------------------------
  3735     05  FILLER            PIC  X(0003).
  3736     05  CERTNOBO PIC  X(0010).
  3737*    -------------------------------
  3738     05  FILLER            PIC  X(0003).
  3739     05  SUFXBO PIC  X(0001).
  3740*    -------------------------------
  3741     05  FILLER            PIC  X(0003).
  3742     05  CLMTYPBO PIC  X(0006).
  3743*    -------------------------------
  3744     05  FILLER            PIC  X(0003).
  3745     05  INCURBO PIC  X(0008).
  3746*    -------------------------------
  3747     05  FILLER            PIC  X(0003).
  3748     05  PYFROMBO PIC  99B99B99.
  3749*    -------------------------------
  3750     05  FILLER            PIC  X(0003).
  3751     05  PYTHRUBO PIC  99B99B99.
  3752*    -------------------------------
  3753     05  FILLER            PIC  X(0003).
  3754     05  DAYSBO PIC  X(0005).
  3755*    -------------------------------
  3756     05  FILLER            PIC  X(0003).
  3757     05  BYBO PIC  X(0004).
  3758*    -------------------------------
  3759     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  74
* EL156.cbl
  3760     05  PROOFDBO PIC  99B99B99.
  3761*    -------------------------------
  3762     05  FILLER            PIC  X(0003).
  3763     05  ACCTBO PIC  X(0010).
  3764*    -------------------------------
  3765     05  FILLER            PIC  X(0003).
  3766     05  STATEBO PIC  X(0002).
  3767*    -------------------------------
  3768     05  FILLER            PIC  X(0003).
  3769     05  GROUPBO PIC  X(0006).
  3770*    -------------------------------
  3771     05  FILLER            PIC  X(0003).
  3772     05  ACARRBO PIC  X(0001).
  3773*    -------------------------------
  3774     05  FILLER            PIC  X(0003).
  3775     05  ACCTNMBO PIC  X(0030).
  3776*    -------------------------------
  3777     05  FILLER            PIC  X(0003).
  3778     05  UNDISBO PIC  ZZZ,Z99.99.
  3779*    -------------------------------
  3780     05  FILLER            PIC  X(0003).
  3781     05  RATEBO PIC  ZZZ.99.
  3782*    -------------------------------
  3783     05  FILLER            PIC  X(0003).
  3784     05  ERMSG1BO PIC  X(0072).
  3785*    -------------------------------
  3786     05  FILLER            PIC  X(0003).
  3787     05  ENTPFBO PIC  X(0002).
  3788*    -------------------------------
  3789****************************************************************
  3790*
  3791* Copyright (c) 2007-2013 Dell Inc.
  3792* All rights reserved.
  3793*
  3794****************************************************************
  3795 01  DFHEIV.
  3796   02  DFHEIV0               PIC X(35).
  3797   02  DFHEIV1               PIC X(08).
  3798   02  DFHEIV2               PIC X(08).
  3799   02  DFHEIV3               PIC X(08).
  3800   02  DFHEIV4               PIC X(06).
  3801   02  DFHEIV5               PIC X(04).
  3802   02  DFHEIV6               PIC X(04).
  3803   02  DFHEIV7               PIC X(02).
  3804   02  DFHEIV8               PIC X(02).
  3805   02  DFHEIV9               PIC X(01).
  3806   02  DFHEIV10              PIC S9(7) COMP-3.
  3807   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3808   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3809   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3810   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3811   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3812   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3813   02  DFHEIV17              PIC X(04).
  3814   02  DFHEIV18              PIC X(04).
  3815   02  DFHEIV19              PIC X(04).
  3816   02  DFHEIV20              USAGE IS POINTER.
  3817   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  75
* EL156.cbl
  3818   02  DFHEIV22              USAGE IS POINTER.
  3819   02  DFHEIV23              USAGE IS POINTER.
  3820   02  DFHEIV24              USAGE IS POINTER.
  3821   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3822   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3823   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3824   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3825   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3826   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3827   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3828   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3829   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3830   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3831   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3832   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3833   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3834   02  FILLER                PIC X(02).
  3835   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3836   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3837   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3838   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3839   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3840   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3841   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3842 LINKAGE  SECTION.
  3843*****************************************************************
  3844*                                                               *
  3845* Copyright (c) 2007-2013 Dell Inc.                             *
  3846* All rights reserved.                                          *
  3847*                                                               *
  3848*****************************************************************
  3849 01  dfheiblk.
  3850     02  eibtime          pic s9(7) comp-3.
  3851     02  eibdate          pic s9(7) comp-3.
  3852     02  eibtrnid         pic x(4).
  3853     02  eibtaskn         pic s9(7) comp-3.
  3854     02  eibtrmid         pic x(4).
  3855     02  dfheigdi         pic s9(4) comp.
  3856     02  eibcposn         pic s9(4) comp.
  3857     02  eibcalen         pic s9(4) comp.
  3858     02  eibaid           pic x(1).
  3859     02  eibfiller1       pic x(1).
  3860     02  eibfn            pic x(2).
  3861     02  eibfiller2       pic x(2).
  3862     02  eibrcode         pic x(6).
  3863     02  eibfiller3       pic x(2).
  3864     02  eibds            pic x(8).
  3865     02  eibreqid         pic x(8).
  3866     02  eibrsrce         pic x(8).
  3867     02  eibsync          pic x(1).
  3868     02  eibfree          pic x(1).
  3869     02  eibrecv          pic x(1).
  3870     02  eibsend          pic x(1).
  3871     02  eibatt           pic x(1).
  3872     02  eibeoc           pic x(1).
  3873     02  eibfmh           pic x(1).
  3874     02  eibcompl         pic x(1).
  3875     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  76
* EL156.cbl
  3876     02  eibconf          pic x(1).
  3877     02  eiberr           pic x(1).
  3878     02  eibrldbk         pic x(1).
  3879     02  eiberrcd         pic x(4).
  3880     02  eibsynrb         pic x(1).
  3881     02  eibnodat         pic x(1).
  3882     02  eibfiller5       pic x(2).
  3883     02  eibresp          pic s9(8) comp.
  3884     02  eibresp2         pic s9(8) comp.
  3885     02  dfheigdj         pic s9(4) comp.
  3886     02  dfheigdk         pic s9(4) comp.
  3887 01  DFHCOMMAREA             PIC X(1024).
  3888
  3889*    COPY ELCMSTR.
  3890******************************************************************
  3891*                                                                *
  3892*                            ELCMSTR.                            *
  3893*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3894*                            VMOD=2.012                          *
  3895*                                                                *
  3896*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3897*                                                                *
  3898*   FILE TYPE = VSAM,KSDS                                        *
  3899*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3900*                                                                *
  3901*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3902*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3903*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3904*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3905*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3906*                                                 RKP=75,LEN=21  *
  3907*                                                                *
  3908*   **** NOTE ****                                               *
  3909*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3910*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3911*                                                                *
  3912*   LOG = YES                                                    *
  3913*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3914******************************************************************
  3915*                   C H A N G E   L O G
  3916*
  3917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3918*-----------------------------------------------------------------
  3919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3920* EFFECTIVE    NUMBER
  3921*-----------------------------------------------------------------
  3922* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3923* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3924* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3925* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3926* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3927* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3928* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3929******************************************************************
  3930 01  CLAIM-MASTER.
  3931     12  CL-RECORD-ID                PIC XX.
  3932         88  VALID-CL-ID         VALUE 'CL'.
  3933
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  77
* EL156.cbl
  3934     12  CL-CONTROL-PRIMARY.
  3935         16  CL-COMPANY-CD           PIC X.
  3936         16  CL-CARRIER              PIC X.
  3937         16  CL-CLAIM-NO             PIC X(7).
  3938         16  CL-CERT-NO.
  3939             20  CL-CERT-PRIME       PIC X(10).
  3940             20  CL-CERT-SFX         PIC X.
  3941
  3942     12  CL-CONTROL-BY-NAME.
  3943         16  CL-COMPANY-CD-A1        PIC X.
  3944         16  CL-INSURED-LAST-NAME    PIC X(15).
  3945         16  CL-INSURED-NAME.
  3946             20  CL-INSURED-1ST-NAME PIC X(12).
  3947             20  CL-INSURED-MID-INIT PIC X.
  3948
  3949     12  CL-CONTROL-BY-SSN.
  3950         16  CL-COMPANY-CD-A2        PIC X.
  3951         16  CL-SOC-SEC-NO.
  3952             20  CL-SSN-STATE        PIC XX.
  3953             20  CL-SSN-ACCOUNT      PIC X(6).
  3954             20  CL-SSN-LN3          PIC X(3).
  3955
  3956     12  CL-CONTROL-BY-CERT-NO.
  3957         16  CL-COMPANY-CD-A4        PIC X.
  3958         16  CL-CERT-NO-A4.
  3959             20  CL-CERT-A4-PRIME    PIC X(10).
  3960             20  CL-CERT-A4-SFX      PIC X.
  3961
  3962     12  CL-CONTROL-BY-CCN.
  3963         16  CL-COMPANY-CD-A5        PIC X.
  3964         16  CL-CCN-A5.
  3965             20  CL-CCN.
  3966                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3967                 24  CL-CCN-PRIME-A5 PIC X(12).
  3968             20  CL-CCN-FILLER-A5    PIC X(4).
  3969
  3970     12  CL-INSURED-PROFILE-DATA.
  3971         16  CL-INSURED-BIRTH-DT     PIC XX.
  3972         16  CL-INSURED-SEX-CD       PIC X.
  3973             88  INSURED-IS-MALE        VALUE 'M'.
  3974             88  INSURED-IS-FEMALE      VALUE 'F'.
  3975             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3976         16  CL-INSURED-OCC-CD       PIC X(6).
  3977         16  FILLER                  PIC X(5).
  3978
  3979     12  CL-PROCESSING-INFO.
  3980         16  CL-PROCESSOR-ID         PIC X(4).
  3981         16  CL-CLAIM-STATUS         PIC X.
  3982             88  CLAIM-IS-OPEN          VALUE 'O'.
  3983             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3984         16  CL-CLAIM-TYPE           PIC X.
  3985*            88  AH-CLAIM               VALUE 'A'.
  3986*            88  LIFE-CLAIM             VALUE 'L'.
  3987*            88  PROPERTY-CLAIM         VALUE 'P'.
  3988*            88  IUI-CLAIM              VALUE 'I'.
  3989*            88  GAP-CLAIM              VALUE 'G'.
  3990*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3991*            88  OTHER-CLAIM            VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  78
* EL156.cbl
  3992         16  CL-CLAIM-PREM-TYPE      PIC X.
  3993             88  SINGLE-PREMIUM         VALUE '1'.
  3994             88  O-B-COVERAGE           VALUE '2'.
  3995             88  OPEN-END-COVERAGE      VALUE '3'.
  3996         16  CL-INCURRED-DT          PIC XX.
  3997         16  CL-REPORTED-DT          PIC XX.
  3998         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3999         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  4000         16  CL-LAST-PMT-DT          PIC XX.
  4001         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  4002         16  CL-PAID-THRU-DT         PIC XX.
  4003         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  4004         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  4005         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  4006         16  CL-PMT-CALC-METHOD      PIC X.
  4007             88  CL-360-DAY-YR          VALUE '1'.
  4008             88  CL-365-DAY-YR          VALUE '2'.
  4009             88  CL-FULL-MONTHS         VALUE '3'.
  4010         16  CL-CAUSE-CD             PIC X(6).
  4011
  4012         16  CL-PRIME-CERT-NO.
  4013             20  CL-PRIME-CERT-PRIME PIC X(10).
  4014             20  CL-PRIME-CERT-SFX   PIC X.
  4015
  4016         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  4017             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  4018             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  4019
  4020         16  CL-MICROFILM-NO         PIC X(10).
  4021         16  FILLER REDEFINES CL-MICROFILM-NO.
  4022             20  CL-BENEFIT-PERIOD   PIC 99.
  4023             20  FILLER              PIC X(8).
  4024         16  CL-PROG-FORM-TYPE       PIC X.
  4025         16  CL-LAST-ADD-ON-DT       PIC XX.
  4026
  4027         16  CL-LAST-REOPEN-DT       PIC XX.
  4028         16  CL-LAST-CLOSE-DT        PIC XX.
  4029         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4030             88  FINAL-PAID             VALUE '1'.
  4031             88  CLAIM-DENIED           VALUE '2'.
  4032             88  AUTO-CLOSE             VALUE '3'.
  4033             88  MANUAL-CLOSE           VALUE '4'.
  4034             88  BENEFITS-CHANGED       VALUE 'C'.
  4035             88  SETUP-ERRORS           VALUE 'E'.
  4036         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4037         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4038         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4039             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4040         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4041         16  FILLER                  PIC X.
  4042
  4043     12  CL-CERTIFICATE-DATA.
  4044         16  CL-CERT-ORIGIN          PIC X.
  4045             88  CERT-WAS-ONLINE        VALUE '1'.
  4046             88  CERT-WAS-CREATED       VALUE '2'.
  4047             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4048         16  CL-CERT-KEY-DATA.
  4049             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  79
* EL156.cbl
  4050             20  CL-CERT-GROUPING    PIC X(6).
  4051             20  CL-CERT-STATE       PIC XX.
  4052             20  CL-CERT-ACCOUNT.
  4053                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4054                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4055             20  CL-CERT-EFF-DT      PIC XX.
  4056
  4057     12  CL-STATUS-CONTROLS.
  4058         16  CL-PRIORITY-CD          PIC X.
  4059             88  CONFIDENTIAL-DATA      VALUE '8'.
  4060             88  HIGHEST-PRIORITY       VALUE '9'.
  4061         16  CL-SUPV-ATTN-CD         PIC X.
  4062             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4063             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4064         16  CL-PURGED-DT            PIC XX.
  4065         16  CL-RESTORED-DT          PIC XX.
  4066         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4067         16  CL-NEXT-RESEND-DT       PIC XX.
  4068         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4069         16  CL-CRITICAL-PERIOD      PIC 99.
  4070*        16  FILLER                  PIC XX.
  4071         16  CL-LAST-MAINT-DT        PIC XX.
  4072         16  CL-LAST-MAINT-USER      PIC X(4).
  4073         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4074         16  CL-LAST-MAINT-TYPE      PIC X.
  4075             88  CLAIM-SET-UP           VALUE ' '.
  4076             88  PAYMENT-MADE           VALUE '1'.
  4077             88  LETTER-SENT            VALUE '2'.
  4078             88  MASTER-WAS-ALTERED     VALUE '3'.
  4079             88  MASTER-WAS-RESTORED    VALUE '4'.
  4080             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4081             88  FILE-CONVERTED         VALUE '6'.
  4082             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4083             88  ERROR-CORRECTION       VALUE 'E'.
  4084         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4085         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4086         16  CL-BENEFICIARY          PIC X(10).
  4087         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4088         16  CL-DENIAL-TYPE          PIC X.
  4089             88  CL-TYPE-DENIAL          VALUE '1'.
  4090             88  CL-TYPE-RESCISSION      VALUE '2'.
  4091             88  CL-TYPE-REFORMATION     VALUE '3'.
  4092             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4093             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4094         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4095         16  filler                  pic x(3).
  4096*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4097*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4098*        16  CL-RTW-DT               PIC XX.
  4099
  4100     12  CL-TRAILER-CONTROLS.
  4101         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4102             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4103             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4104             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4105         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4106         16  FILLER                  PIC XX.
  4107         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  80
* EL156.cbl
  4108         16  CL-ADDRESS-TRAILER-CNT.
  4109             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4110                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4111             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4112                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4113             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4114                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4115             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4116                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4117             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4118                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4119             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4120                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4121             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4122                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4123
  4124     12  CL-CV-REFERENCE-NO.
  4125         16  CL-CV-REFNO-PRIME       PIC X(18).
  4126         16  CL-CV-REFNO-SFX         PIC XX.
  4127
  4128     12  CL-FILE-LOCATION            PIC X(4).
  4129
  4130     12  CL-PROCESS-ERRORS.
  4131         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4132             88  NO-FATAL-ERRORS        VALUE ZERO.
  4133         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4134             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4135
  4136     12  CL-PRODUCT-CD               PIC X.
  4137
  4138     12  CL-CURRENT-KEY-DATA.
  4139         16  CL-CURRENT-CARRIER      PIC X.
  4140         16  CL-CURRENT-GROUPING     PIC X(6).
  4141         16  CL-CURRENT-STATE        PIC XX.
  4142         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4143
  4144     12  CL-ASSOCIATES               PIC X.
  4145         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4146         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4147         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4148         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4149
  4150     12  CL-ACTIVITY-CODE            PIC 99.
  4151     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4152     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4153
  4154     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4155     12  CL-LAG-REPORT-CODE          PIC 9.
  4156     12  CL-LOAN-TYPE                PIC XX.
  4157     12  CL-LEGAL-STATE              PIC XX.
  4158
  4159     12  CL-YESNOSW                  PIC X.
  4160     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4161         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4162         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4163         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4164     12  cl-insured-type             pic x.
  4165         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  81
* EL156.cbl
  4166         88  cl-claim-on-co-borrower     value 'C'.
  4167     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  82
* EL156.cbl
  4169*    COPY ELCCNTL.
  4170******************************************************************
  4171*                                                                *
  4172*                                                                *
  4173*                            ELCCNTL.                            *
  4174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4175*                            VMOD=2.059                          *
  4176*                                                                *
  4177*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4178*                                                                *
  4179*   FILE TYPE = VSAM,KSDS                                        *
  4180*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4181*                                                                *
  4182*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4183*       ALTERNATE INDEX = NONE                                   *
  4184*                                                                *
  4185*   LOG = YES                                                    *
  4186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4187******************************************************************
  4188*                   C H A N G E   L O G
  4189*
  4190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4191*-----------------------------------------------------------------
  4192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4193* EFFECTIVE    NUMBER
  4194*-----------------------------------------------------------------
  4195* 082503                   PEMA  ADD BENEFIT GROUP
  4196* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4197* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4198* 092705    2005050300006  PEMA  ADD SPP LEASES
  4199* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4200* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4201* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4202* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4203* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4204* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4205* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4206* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4207* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4208* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4209* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4210******************************************************************
  4211*
  4212 01  CONTROL-FILE.
  4213     12  CF-RECORD-ID                       PIC XX.
  4214         88  VALID-CF-ID                        VALUE 'CF'.
  4215
  4216     12  CF-CONTROL-PRIMARY.
  4217         16  CF-COMPANY-ID                  PIC XXX.
  4218         16  CF-RECORD-TYPE                 PIC X.
  4219             88  CF-COMPANY-MASTER              VALUE '1'.
  4220             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4221             88  CF-STATE-MASTER                VALUE '3'.
  4222             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4223             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4224             88  CF-CARRIER-MASTER              VALUE '6'.
  4225             88  CF-MORTALITY-MASTER            VALUE '7'.
  4226             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  83
* EL156.cbl
  4227             88  CF-TERMINAL-MASTER             VALUE '9'.
  4228             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4229             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4230             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4231             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4232             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4233             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4234             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4235             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4236             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4237         16  CF-ACCESS-CD-GENL              PIC X(4).
  4238         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4239             20  CF-PROCESSOR               PIC X(4).
  4240         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4241             20  CF-STATE-CODE              PIC XX.
  4242             20  FILLER                     PIC XX.
  4243         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4244             20  FILLER                     PIC XX.
  4245             20  CF-HI-BEN-IN-REC           PIC XX.
  4246         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4247             20  FILLER                     PIC XXX.
  4248             20  CF-CARRIER-CNTL            PIC X.
  4249         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4250             20  FILLER                     PIC XX.
  4251             20  CF-HI-TYPE-IN-REC          PIC 99.
  4252         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4253             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4254                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4255             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4256             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4257         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4258             20  FILLER                     PIC X.
  4259             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4260         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4261             20  FILLER                     PIC XX.
  4262             20  CF-MORTGAGE-PLAN           PIC XX.
  4263         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4264
  4265     12  CF-LAST-MAINT-DT                   PIC XX.
  4266     12  CF-LAST-MAINT-BY                   PIC X(4).
  4267     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4268
  4269     12  CF-RECORD-BODY                     PIC X(728).
  4270
  4271
  4272****************************************************************
  4273*             COMPANY MASTER RECORD                            *
  4274****************************************************************
  4275
  4276     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4277         16  CF-COMPANY-ADDRESS.
  4278             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4279             20  CF-CL-IN-CARE-OF           PIC X(30).
  4280             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4281             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4282             20  CF-CL-CITY-STATE           PIC X(30).
  4283             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4284             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  84
* EL156.cbl
  4285         16  CF-COMPANY-CD                  PIC X.
  4286         16  CF-COMPANY-PASSWORD            PIC X(8).
  4287         16  CF-SECURITY-OPTION             PIC X.
  4288             88  ALL-SECURITY                   VALUE '1'.
  4289             88  COMPANY-VERIFY                 VALUE '2'.
  4290             88  PROCESSOR-VERIFY               VALUE '3'.
  4291             88  NO-SECURITY                    VALUE '4'.
  4292             88  ALL-BUT-TERM                   VALUE '5'.
  4293         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4294             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4295         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4296             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4297         16  CF-INFORCE-LOCATION            PIC X.
  4298             88  CERTS-ARE-ONLINE               VALUE '1'.
  4299             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4300             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4301         16  CF-LOWER-CASE-LETTERS          PIC X.
  4302         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4303             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4304             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4305             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4306             88  CF-ACCNT-CNTL                  VALUE '3'.
  4307             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4308
  4309         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4310         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4311
  4312         16  CF-LGX-CREDIT-USER             PIC X.
  4313             88  CO-IS-NOT-USER                 VALUE 'N'.
  4314             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4315
  4316         16 CF-CREDIT-CALC-CODES.
  4317             20  CF-CR-REM-TERM-CALC PIC X.
  4318               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4319               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4320               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4321               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4322               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4323               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4324               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4325             20  CF-CR-R78-METHOD           PIC X.
  4326               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4327               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4328
  4329         16  CF-CLAIM-CONTROL-COUNTS.
  4330             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4331                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4332
  4333             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4334                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4335
  4336             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4337                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4338
  4339             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4340                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4341
  4342         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  85
* EL156.cbl
  4343
  4344         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4345             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4346             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4347             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4348             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4349                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4350                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4351             20  CF-CO-PREM-REJECT-SW       PIC X.
  4352                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4353                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4354             20  CF-CO-REF-REJECT-SW        PIC X.
  4355                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4356                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4357
  4358         16  CF-CO-REPORTING-DT             PIC XX.
  4359         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4360         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4361           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4362           88  CF-CO-MONTH-END                  VALUE '1'.
  4363
  4364         16  CF-LGX-CLAIM-USER              PIC X.
  4365             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4366             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4367
  4368         16  CF-CREDIT-EDIT-CONTROLS.
  4369             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4370             20  CF-MIN-AGE                 PIC 99.
  4371             20  CF-DEFAULT-AGE             PIC 99.
  4372             20  CF-MIN-TERM                PIC S999      COMP-3.
  4373             20  CF-MAX-TERM                PIC S999      COMP-3.
  4374             20  CF-DEFAULT-SEX             PIC X.
  4375             20  CF-JOINT-AGE-INPUT         PIC X.
  4376                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4377             20  CF-BIRTH-DATE-INPUT        PIC X.
  4378                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4379             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4380                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4381                 88  CF-ZERO-CARRIER            VALUE '1'.
  4382                 88  CF-ZERO-GROUPING           VALUE '2'.
  4383                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4384             20  CF-EDIT-SW                 PIC X.
  4385                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4386             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4387             20  CF-CR-PR-METHOD            PIC X.
  4388               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4389               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4390             20  FILLER                     PIC X.
  4391
  4392         16  CF-CREDIT-MISC-CONTROLS.
  4393             20  CF-REIN-TABLE-SW           PIC X.
  4394                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4395             20  CF-COMP-TABLE-SW           PIC X.
  4396                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4397             20  CF-EXPERIENCE-RETENTION-AGE
  4398                                            PIC S9        COMP-3.
  4399             20  CF-CONVERSION-DT           PIC XX.
  4400             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  86
* EL156.cbl
  4401             20  CF-RUN-FREQUENCY-SW        PIC X.
  4402                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4403                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4404
  4405             20  CF-CR-CHECK-NO-CONTROL.
  4406                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4407                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4408                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4409                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4410                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4411                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4412
  4413                 24  CF-CR-CHECK-COUNT       REDEFINES
  4414                     CF-CR-CHECK-COUNTER      PIC X(4).
  4415
  4416                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4417                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4418
  4419                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4420                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4421                 24  CF-MAIL-PROCESSING       PIC X.
  4422                     88  MAIL-PROCESSING          VALUE 'Y'.
  4423
  4424         16  CF-MISC-SYSTEM-CONTROL.
  4425             20  CF-SYSTEM-C                 PIC X.
  4426                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4427             20  CF-SYSTEM-D                 PIC X.
  4428                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4429             20  CF-SOC-SEC-NO-SW            PIC X.
  4430                 88  SOC-SEC-NO-USED             VALUE '1'.
  4431             20  CF-MEMBER-NO-SW             PIC X.
  4432                 88  MEMBER-NO-USED              VALUE '1'.
  4433             20  CF-TAX-ID-NUMBER            PIC X(11).
  4434             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4435             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4436                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4437                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4438                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4439                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4440             20  CF-SYSTEM-E                 PIC X.
  4441                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4442
  4443         16  CF-LGX-LIFE-USER               PIC X.
  4444             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4445             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4446
  4447         16  CF-CR-MONTH-END-DT             PIC XX.
  4448
  4449         16  CF-FILE-MAINT-DATES.
  4450             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4451                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4452             20  CF-LAST-BATCH       REDEFINES
  4453                 CF-LAST-BATCH-NO               PIC X(4).
  4454             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4455             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4456             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4457             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4458             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  87
* EL156.cbl
  4459             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4460             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4461             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4462             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4463             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4464
  4465         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4466         16  FILLER                         PIC X.
  4467
  4468         16  CF-ALT-MORT-CODE               PIC X(4).
  4469         16  CF-MEMBER-CAPTION              PIC X(10).
  4470
  4471         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4472             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4473             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4474             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4475             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4476             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4477
  4478         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4479
  4480         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4481         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4482         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4483         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4484
  4485         16  CF-AH-OVERRIDE-L1              PIC X.
  4486         16  CF-AH-OVERRIDE-L2              PIC XX.
  4487         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4488         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4489
  4490         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4491         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4492
  4493         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4494         16  CF-AR-LAST-EL860-DT            PIC XX.
  4495         16  CF-MP-MONTH-END-DT             PIC XX.
  4496
  4497         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4498         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4499             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4500
  4501         16  CF-AR-MONTH-END-DT             PIC XX.
  4502
  4503         16  CF-CRDTCRD-USER                PIC X.
  4504             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4505             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4506
  4507         16  CF-CC-MONTH-END-DT             PIC XX.
  4508
  4509         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4510
  4511         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4512             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4513             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4514             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4515         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4516         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  88
* EL156.cbl
  4517         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4518         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4519             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4520             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4521         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4522         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4523         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4524             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4525         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4526
  4527         16  CF-CL-ZIP-CODE.
  4528             20  CF-CL-ZIP-PRIME.
  4529                 24  CF-CL-ZIP-1ST          PIC X.
  4530                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4531                 24  FILLER                 PIC X(4).
  4532             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4533         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4534             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4535             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4536             20  FILLER                     PIC XXX.
  4537
  4538         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4539         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4540         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4541         16  CF-CO-OPTION-START-DATE        PIC XX.
  4542         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4543           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4544                                                      '3' '4'.
  4545           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4546           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4547           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4548           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4549           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4550           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4551
  4552         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4553
  4554         16  CF-PAYMENT-APPROVAL-LEVELS.
  4555             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4556             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4557             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4558             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4559             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4560             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4561
  4562         16  CF-END-USER-REPORTING-USER     PIC X.
  4563             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4564             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4565
  4566         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4567             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4568             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4569
  4570         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4571
  4572         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4573         16  FILLER                         PIC X.
  4574
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  89
* EL156.cbl
  4575         16  CF-CREDIT-ARCHIVE-CNTL.
  4576             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4577             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4578             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4579
  4580         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4581
  4582         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4583             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4584             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4585
  4586         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4587             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4588             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4589
  4590         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4591
  4592         16  CF-CO-ACH-ID-CODE              PIC  X.
  4593             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4594             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4595             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4596         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4597         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4598         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4599         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4600         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4601         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4602         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4603         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4604         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4605                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4606         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4607                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4608
  4609         16  CF-CO-OVER-SHORT.
  4610             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4611             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4612
  4613*         16  FILLER                         PIC X(102).
  4614         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4615             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4616             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4617
  4618         16  CF-AH-APPROVAL-DAYS.
  4619             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4620             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4621             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4622             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4623
  4624         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4625
  4626         16  CF-APPROV-LEV-5.
  4627             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4628             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4629             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4630
  4631         16  FILLER                         PIC X(68).
  4632****************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  90
* EL156.cbl
  4633*             PROCESSOR/USER RECORD                            *
  4634****************************************************************
  4635
  4636     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4637         16  CF-PROCESSOR-NAME              PIC X(30).
  4638         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4639         16  CF-PROCESSOR-TITLE             PIC X(26).
  4640         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4641                 88  MESSAGE-YES                VALUE 'Y'.
  4642                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4643
  4644*****************************************************
  4645****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4646****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4647****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4648****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4649*****************************************************
  4650
  4651         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4652             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4653             20  CF-APPLICATION-FORCE       PIC X.
  4654             20  CF-INDIVIDUAL-APP.
  4655                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4656                     28  CF-BROWSE-APP      PIC X.
  4657                     28  CF-UPDATE-APP      PIC X.
  4658
  4659         16  CF-CURRENT-TERM-ON             PIC X(4).
  4660         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4661             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4662             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4663             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4664             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4665             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4666             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4667             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4668         16  CF-PROCESSOR-CARRIER           PIC X.
  4669             88  NO-CARRIER-SECURITY            VALUE ' '.
  4670         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4671             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4672         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4673             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4674         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4675             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4676
  4677         16  CF-PROC-SYS-ACCESS-SW.
  4678             20  CF-PROC-CREDIT-CLAIMS-SW.
  4679                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4680                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4681                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4682                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4683             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4684                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4685                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4686             20  CF-PROC-LIFE-GNRLDGR-SW.
  4687                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4688                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4689                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4690                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  91
* EL156.cbl
  4691             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4692                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4693                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4694         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4695             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4696             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4697         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4698
  4699         16  CF-APPROVAL-LEVEL                  PIC X.
  4700             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4701             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4702             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4703             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4704             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4705
  4706         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4707
  4708         16  CF-LANGUAGE-TYPE                   PIC X.
  4709             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4710             88  CF-LANG-IS-FR                      VALUE 'F'.
  4711
  4712         16  CF-CSR-IND                         PIC X.
  4713         16  FILLER                             PIC X(239).
  4714
  4715****************************************************************
  4716*             PROCESSOR/REMINDERS RECORD                       *
  4717****************************************************************
  4718
  4719     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4720         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4721             20  CF-START-REMIND-DT         PIC XX.
  4722             20  CF-END-REMIND-DT           PIC XX.
  4723             20  CF-REMINDER-TEXT           PIC X(50).
  4724         16  FILLER                         PIC X(296).
  4725
  4726
  4727****************************************************************
  4728*             STATE MASTER RECORD                              *
  4729****************************************************************
  4730
  4731     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4732         16  CF-STATE-ABBREVIATION          PIC XX.
  4733         16  CF-STATE-NAME                  PIC X(25).
  4734         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4735         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4736             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4737             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4738             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4739             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4740                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4741                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4742             20  CF-ST-PREM-REJECT-SW       PIC X.
  4743                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4744                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4745             20  CF-ST-REF-REJECT-SW        PIC X.
  4746                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4747                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4748         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  92
* EL156.cbl
  4749         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4750         16  CF-ST-REFUND-RULES.
  4751             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4752             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4753             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4754         16  CF-ST-FST-PMT-EXTENSION.
  4755             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4756             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4757                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4758                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4759                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4760                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4761         16  CF-ST-STATE-CALL.
  4762             20  CF-ST-CALL-UNEARNED        PIC X.
  4763             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4764             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4765         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4766             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4767             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4768         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4769         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4770         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4771         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4772         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4773         16  FILLER                         PIC X.
  4774         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4775             20  CF-ST-BENEFIT-CD           PIC XX.
  4776             20  CF-ST-BENEFIT-KIND         PIC X.
  4777                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4778                 88  CF-ST-AH-KIND              VALUE 'A'.
  4779             20  CF-ST-REM-TERM-CALC        PIC X.
  4780                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4781                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4782                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4783                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4784                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4785                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4786                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4787                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4788
  4789             20  CF-ST-REFUND-CALC          PIC X.
  4790                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4791                 88  ST-REFD-BY-R78             VALUE '1'.
  4792                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4793                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4794                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4795                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4796                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4797                 88  ST-REFD-UTAH               VALUE '7'.
  4798                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4799                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4800                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4801
  4802             20  CF-ST-EARNING-CALC         PIC X.
  4803                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4804                 88  ST-EARN-BY-R78             VALUE '1'.
  4805                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4806                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  93
* EL156.cbl
  4807                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4808                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4809                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4810                 88  ST-EARN-MEAN               VALUE '8'.
  4811                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4812
  4813             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4814                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4815                 88  ST-OVRD-BY-R78             VALUE '1'.
  4816                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4817                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4818                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4819                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4820                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4821                 88  ST-OVRD-MEAN               VALUE '8'.
  4822                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4823             20  cf-st-extra-periods        pic 9.
  4824*            20  FILLER                     PIC X.
  4825
  4826         16  CF-ST-COMMISSION-CAPS.
  4827             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4828             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4829             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4830             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4831         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4832                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4833                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4834                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4835
  4836         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4837
  4838         16  CF-ST-STATUTORY-INTEREST.
  4839             20  CF-ST-STAT-DATE-FROM       PIC X.
  4840                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4841                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4842             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4843             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4844             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4845             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4846             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4847
  4848         16  CF-ST-OVER-SHORT.
  4849             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4850             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4851
  4852         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4853
  4854         16  CF-ST-RT-CALC                  PIC X.
  4855
  4856         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4857         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4858         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4859         16  CF-ST-RF-LR-CALC               PIC X.
  4860         16  CF-ST-RF-LL-CALC               PIC X.
  4861         16  CF-ST-RF-LN-CALC               PIC X.
  4862         16  CF-ST-RF-AH-CALC               PIC X.
  4863         16  CF-ST-RF-CP-CALC               PIC X.
  4864*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  94
* EL156.cbl
  4865*CIDMOD         16  FILLER                         PIC X(192).
  4866         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4867             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4868         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4869         16  CF-ST-VFY-2ND-BENE             PIC X.
  4870         16  CF-ST-CAUSAL-STATE             PIC X.
  4871         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4872         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4873         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4874             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4875         16  CF-ST-NET-ONLY-STATE           PIC X.
  4876             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4877         16  cf-commission-cap-required     pic x.
  4878         16  CF-ST-GA-COMMISSION-CAPS.
  4879             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4880             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4881             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4882             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4883         16  CF-ST-TOT-COMMISSION-CAPS.
  4884             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4885             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4886             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4887             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4888         16  FILLER                         PIC X(156).
  4889
  4890****************************************************************
  4891*             BENEFIT MASTER RECORD                            *
  4892****************************************************************
  4893
  4894     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4895         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4896             20  CF-BENEFIT-CODE            PIC XX.
  4897             20  CF-BENEFIT-NUMERIC  REDEFINES
  4898                 CF-BENEFIT-CODE            PIC XX.
  4899             20  CF-BENEFIT-ALPHA           PIC XXX.
  4900             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4901             20  CF-BENEFIT-COMMENT         PIC X(10).
  4902
  4903             20  CF-LF-COVERAGE-TYPE        PIC X.
  4904                 88  CF-REDUCING                VALUE 'R'.
  4905                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4906
  4907             20  CF-SPECIAL-CALC-CD         PIC X.
  4908                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4909                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4910                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4911                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4912                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4913                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4914                 88  CF-FARM-PLAN               VALUE 'F'.
  4915                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4916                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4917                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4918                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4919                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4920                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4921                 88  CF-PRUDENTIAL              VALUE 'P'.
  4922                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  95
* EL156.cbl
  4923                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4924                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4925                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4926                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4927                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4928
  4929             20  CF-JOINT-INDICATOR         PIC X.
  4930                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4931
  4932*            20  FILLER                     PIC X(12).
  4933             20  cf-maximum-benefits        pic s999 comp-3.
  4934             20  FILLER                     PIC X(09).
  4935             20  CF-BENEFIT-CATEGORY        PIC X.
  4936             20  CF-LOAN-TYPE               PIC X(8).
  4937
  4938             20  CF-CO-REM-TERM-CALC        PIC X.
  4939                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4940                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4941                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4942                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4943                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4944
  4945             20  CF-CO-EARNINGS-CALC        PIC X.
  4946                 88  CO-EARN-BY-R78             VALUE '1'.
  4947                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4948                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4949                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4950                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4951                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4952                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4953                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4954
  4955             20  CF-CO-REFUND-CALC          PIC X.
  4956                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4957                 88  CO-REFD-BY-R78             VALUE '1'.
  4958                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4959                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4960                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4961                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4962                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4963                 88  CO-REFD-MEAN               VALUE '8'.
  4964                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4965                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4966                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4967
  4968             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4969                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4970                 88  CO-OVRD-BY-R78             VALUE '1'.
  4971                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4972                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4973                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4974                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4975                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4976                 88  CO-OVRD-MEAN               VALUE '8'.
  4977                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4978
  4979             20  CF-CO-BEN-I-G-CD           PIC X.
  4980                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  96
* EL156.cbl
  4981                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4982                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4983
  4984         16  FILLER                         PIC X(304).
  4985
  4986
  4987****************************************************************
  4988*             CARRIER MASTER RECORD                            *
  4989****************************************************************
  4990
  4991     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4992         16  CF-ADDRESS-DATA.
  4993             20  CF-MAIL-TO-NAME            PIC X(30).
  4994             20  CF-IN-CARE-OF              PIC X(30).
  4995             20  CF-ADDRESS-LINE-1          PIC X(30).
  4996             20  CF-ADDRESS-LINE-2          PIC X(30).
  4997             20  CF-CITY-STATE              PIC X(30).
  4998             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4999             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5000
  5001         16  CF-CLAIM-NO-CONTROL.
  5002             20  CF-CLAIM-NO-METHOD         PIC X.
  5003                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5004                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5005                 88  CLAIM-NO-SEQ               VALUE '3'.
  5006                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5007             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5008                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5009                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5010                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5011
  5012         16  CF-CHECK-NO-CONTROL.
  5013             20  CF-CHECK-NO-METHOD         PIC X.
  5014                 88  CHECK-NO-MANUAL            VALUE '1'.
  5015                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5016                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5017                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5018             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5019                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5020
  5021         16  CF-DOMICILE-STATE              PIC XX.
  5022
  5023         16  CF-EXPENSE-CONTROLS.
  5024             20  CF-EXPENSE-METHOD          PIC X.
  5025                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5026                 88  DOLLARS-PER-PMT            VALUE '2'.
  5027                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5028                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5029             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5030             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5031
  5032         16  CF-CORRESPONDENCE-CONTROL.
  5033             20  CF-LETTER-RESEND-OPT       PIC X.
  5034                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5035                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5036             20  FILLER                     PIC X(4).
  5037
  5038         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  97
* EL156.cbl
  5039             20  CF-MANUAL-SW               PIC X.
  5040                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5041             20  CF-FUTURE-SW               PIC X.
  5042                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5043             20  CF-PTC-SW                  PIC X.
  5044                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5045             20  CF-IBNR-SW                 PIC X.
  5046                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5047             20  CF-PTC-LF-SW               PIC X.
  5048                 88  CF-LF-PTC-USED             VALUE '1'.
  5049             20  CF-CDT-ACCESS-METHOD       PIC X.
  5050                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5051                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5052                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5053             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5054
  5055         16  CF-CLAIM-CALC-METHOD           PIC X.
  5056             88  360-PLUS-MONTHS                VALUE '1'.
  5057             88  365-PLUS-MONTHS                VALUE '2'.
  5058             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5059             88  360-DAILY                      VALUE '4'.
  5060             88  365-DAILY                      VALUE '5'.
  5061
  5062         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5063         16  FILLER                         PIC X(11).
  5064
  5065         16  CF-LIMIT-AMOUNTS.
  5066             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5067             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5068             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5069             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5070             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5071             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5072             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5073             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5074             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5075             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5076
  5077         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5078         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5079         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5080
  5081         16  CF-ZIP-CODE.
  5082             20  CF-ZIP-PRIME.
  5083                 24  CF-ZIP-1ST             PIC X.
  5084                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5085                 24  FILLER                 PIC X(4).
  5086             20  CF-ZIP-PLUS4               PIC X(4).
  5087         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5088             20  CF-CAN-POSTAL-1            PIC XXX.
  5089             20  CF-CAN-POSTAL-2            PIC XXX.
  5090             20  FILLER                     PIC XXX.
  5091
  5092         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5093         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5094         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5095
  5096         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  98
* EL156.cbl
  5097             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5098             88  CF-NO-RATING                   VALUE 'N'.
  5099
  5100         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5101
  5102         16  CF-CARRIER-OVER-SHORT.
  5103             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5104             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5105
  5106         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5107         16  CF-SECPAY-SWITCH               PIC X.
  5108             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5109             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5110         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5111         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5112         16  FILLER                         PIC X(444).
  5113*        16  FILLER                         PIC X(452).
  5114
  5115
  5116****************************************************************
  5117*             MORTALITY MASTER RECORD                          *
  5118****************************************************************
  5119
  5120     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5121         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5122                                INDEXED BY CF-MORT-NDX.
  5123             20  CF-MORT-TABLE              PIC X(5).
  5124             20  CF-MORT-TABLE-TYPE         PIC X.
  5125                 88  CF-MORT-JOINT              VALUE 'J'.
  5126                 88  CF-MORT-SINGLE             VALUE 'S'.
  5127                 88  CF-MORT-COMBINED           VALUE 'C'.
  5128                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5129                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5130             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5131             20  CF-MORT-AGE-METHOD         PIC XX.
  5132                 88  CF-AGE-LAST                VALUE 'AL'.
  5133                 88  CF-AGE-NEAR                VALUE 'AN'.
  5134             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5135             20  CF-MORT-ADJUSTMENT-DIRECTION
  5136                                            PIC X.
  5137                 88  CF-MINUS                   VALUE '-'.
  5138                 88  CF-PLUS                    VALUE '+'.
  5139             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5140             20  CF-MORT-JOINT-CODE         PIC X.
  5141                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5142             20  CF-MORT-PC-Q               PIC X.
  5143                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5144             20  CF-MORT-TABLE-CODE         PIC X(4).
  5145             20  CF-MORT-COMMENTS           PIC X(15).
  5146             20  FILLER                     PIC X(14).
  5147
  5148         16  FILLER                         PIC X(251).
  5149
  5150
  5151****************************************************************
  5152*             BUSSINESS TYPE MASTER RECORD                     *
  5153****************************************************************
  5154
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page  99
* EL156.cbl
  5155     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5156* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5157* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5158* AND RECORD 05 IS TYPES 81-99
  5159         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5160             20  CF-BUSINESS-TITLE          PIC  X(19).
  5161             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5162                                            PIC S9V9(4) COMP-3.
  5163             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5164             20  FILLER                     PIC  X.
  5165         16  FILLER                         PIC  X(248).
  5166
  5167
  5168****************************************************************
  5169*             TERMINAL MASTER RECORD                           *
  5170****************************************************************
  5171
  5172     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5173
  5174         16  CF-COMPANY-TERMINALS.
  5175             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5176                                  PIC X(4).
  5177         16  FILLER               PIC X(248).
  5178
  5179
  5180****************************************************************
  5181*             LIFE EDIT MASTER RECORD                          *
  5182****************************************************************
  5183
  5184     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5185         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5186             20  CF-LIFE-CODE-IN            PIC XX.
  5187             20  CF-LIFE-CODE-OUT           PIC XX.
  5188         16  FILLER                         PIC X(248).
  5189
  5190
  5191****************************************************************
  5192*             AH EDIT MASTER RECORD                            *
  5193****************************************************************
  5194
  5195     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5196         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5197             20  CF-AH-CODE-IN              PIC XXX.
  5198             20  CF-AH-CODE-OUT             PIC XX.
  5199         16  FILLER                         PIC X(248).
  5200
  5201
  5202****************************************************************
  5203*             CREDIBILITY TABLES                               *
  5204****************************************************************
  5205
  5206     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5207         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5208                             INDEXED BY CF-CRDB-NDX.
  5209             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5210             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5211             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5212         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 100
* EL156.cbl
  5213
  5214
  5215****************************************************************
  5216*             REPORT CUSTOMIZATION RECORD                      *
  5217****************************************************************
  5218
  5219     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5220         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5221             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5222             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5223             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5224**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5225****       A T-TRANSFER.                                   ****
  5226             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5227
  5228         16  FILLER                         PIC XX.
  5229
  5230         16  CF-CARRIER-CNTL-OPT.
  5231             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5232                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5233                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5234             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5235                                            PIC X.
  5236         16  CF-GROUP-CNTL-OPT.
  5237             20  CF-GROUP-OPT-SEQ           PIC 9.
  5238                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5239                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5240             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5241                                            PIC X(6).
  5242         16  CF-STATE-CNTL-OPT.
  5243             20  CF-STATE-OPT-SEQ           PIC 9.
  5244                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5245                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5246             20  CF-STATE-SELECT OCCURS 3 TIMES
  5247                                            PIC XX.
  5248         16  CF-ACCOUNT-CNTL-OPT.
  5249             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5250                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5251                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5252             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5253                                            PIC X(10).
  5254         16  CF-BUS-TYP-CNTL-OPT.
  5255             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5256                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5257                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5258             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5259                                            PIC XX.
  5260         16  CF-LF-TYP-CNTL-OPT.
  5261             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5262                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5263                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5264             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5265                                            PIC XX.
  5266         16  CF-AH-TYP-CNTL-OPT.
  5267             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5268                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5269                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5270             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 101
* EL156.cbl
  5271                                            PIC XX.
  5272         16  CF-REPTCD1-CNTL-OPT.
  5273             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5274                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5275                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5276             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5277                                            PIC X(10).
  5278         16  CF-REPTCD2-CNTL-OPT.
  5279             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5280                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5281                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5282             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5283                                            PIC X(10).
  5284         16  CF-USER1-CNTL-OPT.
  5285             20  CF-USER1-OPT-SEQ           PIC 9.
  5286                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5287                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5288             20  CF-USER1-SELECT OCCURS 3 TIMES
  5289                                            PIC X(10).
  5290         16  CF-USER2-CNTL-OPT.
  5291             20  CF-USER2-OPT-SEQ           PIC 9.
  5292                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5293                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5294             20  CF-USER2-SELECT OCCURS 3 TIMES
  5295                                            PIC X(10).
  5296         16  CF-USER3-CNTL-OPT.
  5297             20  CF-USER3-OPT-SEQ           PIC 9.
  5298                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5299                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5300             20  CF-USER3-SELECT OCCURS 3 TIMES
  5301                                            PIC X(10).
  5302         16  CF-USER4-CNTL-OPT.
  5303             20  CF-USER4-OPT-SEQ           PIC 9.
  5304                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5305                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5306             20  CF-USER4-SELECT OCCURS 3 TIMES
  5307                                            PIC X(10).
  5308         16  CF-USER5-CNTL-OPT.
  5309             20  CF-USER5-OPT-SEQ           PIC 9.
  5310                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5311                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5312             20  CF-USER5-SELECT OCCURS 3 TIMES
  5313                                            PIC X(10).
  5314         16  CF-REINS-CNTL-OPT.
  5315             20  CF-REINS-OPT-SEQ           PIC 9.
  5316                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5317                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5318             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5319                 24  CF-REINS-PRIME         PIC XXX.
  5320                 24  CF-REINS-SUB           PIC XXX.
  5321
  5322         16  CF-AGENT-CNTL-OPT.
  5323             20  CF-AGENT-OPT-SEQ           PIC 9.
  5324                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5325                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5326             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5327                                            PIC X(10).
  5328
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 102
* EL156.cbl
  5329         16  FILLER                         PIC X(43).
  5330
  5331         16  CF-LOSS-RATIO-SELECT.
  5332             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5333             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5334         16  CF-ENTRY-DATE-SELECT.
  5335             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5336             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5337         16  CF-EFFECTIVE-DATE-SELECT.
  5338             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5339             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5340
  5341         16  CF-EXCEPTION-LIST-IND          PIC X.
  5342             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5343
  5344         16  FILLER                         PIC X(318).
  5345
  5346****************************************************************
  5347*                  EXCEPTION REPORTING RECORD                  *
  5348****************************************************************
  5349
  5350     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5351         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5352             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5353
  5354         16  CF-COMBINED-LIFE-AH-OPT.
  5355             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5356             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5357             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5358             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5359
  5360         16  CF-LIFE-OPT.
  5361             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5362             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5363             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5364             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5365             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5366             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5367             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5368             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5369             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5370             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5371
  5372         16  CF-AH-OPT.
  5373             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5374             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5375             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5376             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5377             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5378             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5379             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5380             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5381             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5382             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5383
  5384         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5385             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5386             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 103
* EL156.cbl
  5387             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5388
  5389         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5390
  5391         16  FILLER                         PIC X(673).
  5392
  5393
  5394****************************************************************
  5395*             MORTGAGE SYSTEM PLAN RECORD                      *
  5396****************************************************************
  5397
  5398     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5399         16  CF-PLAN-TYPE                   PIC X.
  5400             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5401             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5402             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5403         16  CF-PLAN-ABBREV                 PIC XXX.
  5404         16  CF-PLAN-DESCRIPT               PIC X(10).
  5405         16  CF-PLAN-NOTES                  PIC X(20).
  5406         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5407         16  CF-PLAN-UNDERWRITING.
  5408             20  CF-PLAN-TERM-DATA.
  5409                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5410                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5411             20  CF-PLAN-AGE-DATA.
  5412                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5413                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5414                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5415             20  CF-PLAN-BENEFIT-DATA.
  5416                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5417                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5418                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5419                                            PIC S9(7)V99  COMP-3.
  5420         16  CF-PLAN-POLICY-FORMS.
  5421             20  CF-POLICY-FORM             PIC X(12).
  5422             20  CF-MASTER-APPLICATION      PIC X(12).
  5423             20  CF-MASTER-POLICY           PIC X(12).
  5424         16  CF-PLAN-RATING.
  5425             20  CF-RATE-CODE               PIC X(5).
  5426             20  CF-SEX-RATING              PIC X.
  5427                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5428                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5429             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5430             20  CF-SUB-STD-TYPE            PIC X.
  5431                 88  CF-PCT-OF-PREM            VALUE '1'.
  5432                 88  CF-PCT-OF-BENE            VALUE '2'.
  5433         16  CF-PLAN-PREM-TOLERANCES.
  5434             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5435             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5436         16  CF-PLAN-PYMT-TOLERANCES.
  5437             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5438             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5439         16  CF-PLAN-MISC-DATA.
  5440             20  FILLER                     PIC X.
  5441             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5442             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5443         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5444         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 104
* EL156.cbl
  5445             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5446                                                     '1'.
  5447             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5448                                                     '2'.
  5449         16  CF-MIB-SEARCH-SW               PIC X.
  5450             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5451             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5452             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5453             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5454         16  CF-ALPHA-SEARCH-SW             PIC X.
  5455             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5456             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5457             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5458             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5459             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5460             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5461             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5462             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5463             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5464             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5465                                                     'A' 'B' 'C'
  5466                                                     'X' 'Y' 'Z'.
  5467         16  CF-EFF-DT-RULE-SW              PIC X.
  5468             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5469             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5470             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5471             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5472             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5473         16  FILLER                         PIC X(4).
  5474         16  CF-HEALTH-QUESTIONS            PIC X.
  5475             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5476         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5477         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5478         16  CF-PLAN-SNGL-JNT               PIC X.
  5479             88  CF-COMBINED-PLAN              VALUE 'C'.
  5480             88  CF-JNT-PLAN                   VALUE 'J'.
  5481             88  CF-SNGL-PLAN                  VALUE 'S'.
  5482         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5483         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5484         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5485         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5486         16  CF-RERATE-CNTL                 PIC  X.
  5487             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5488             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5489             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5490             88  CF-AUTO-RECALC                 VALUE '4'.
  5491         16  CF-BENEFIT-TYPE                PIC  X.
  5492             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5493             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5494         16  CF-POLICY-FEE                  PIC S999V99
  5495                                                    COMP-3.
  5496         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5497         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5498         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5499         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5500         16  FILLER                         PIC  X(32).
  5501         16  CF-TERMINATION-FORM            PIC  X(04).
  5502         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 105
* EL156.cbl
  5503         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5504                                                       COMP-3.
  5505         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5506         16  CF-ISSUE-LETTER                PIC  X(4).
  5507         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5508         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5509             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5510             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5511         16  CF-MP-REFUND-CALC              PIC X.
  5512             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5513             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5514             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5515             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5516             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5517             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5518             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5519             88  CF-MP-REFD-MEAN                VALUE '8'.
  5520         16  CF-ALT-RATE-CODE               PIC  X(5).
  5521
  5522
  5523         16  FILLER                         PIC X(498).
  5524****************************************************************
  5525*             MORTGAGE COMPANY MASTER RECORD                   *
  5526****************************************************************
  5527
  5528     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5529         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5530         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5531             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5532             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5533             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5534             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5535             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5536
  5537         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5538         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5539         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5540         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5541         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5542
  5543         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5544             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5545         16  CF-MP-RECON-USE-IND            PIC X(1).
  5546             88  CF-MP-USE-RECON             VALUE 'Y'.
  5547         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5548             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5549         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5550             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5551             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5552         16  FILLER                         PIC X(1).
  5553         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5554             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5555         16  CF-MORTG-MIB-VERSION           PIC X.
  5556             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5557             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5558             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5559         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5560             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 106
* EL156.cbl
  5561                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5562             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5563                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5564             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5565                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5566             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5567                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5568             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5569                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5570             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5571                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5572         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5573         16  FILLER                         PIC X(7).
  5574         16  CF-MORTG-DESTINATION-SYMBOL.
  5575             20  CF-MORTG-MIB-COMM          PIC X(5).
  5576             20  CF-MORTG-MIB-TERM          PIC X(5).
  5577         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5578             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5579         16  FILLER                         PIC X(03).
  5580         16  CF-MP-CHECK-NO-CONTROL.
  5581             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5582                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5583                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5584                                                ' ' LOW-VALUES.
  5585                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5586                                               VALUE '3'.
  5587         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5588         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5589         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5590             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5591                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5592             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5593                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5594             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5595                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5596             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5597                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5598             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5599                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5600             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5601                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5602         16  CF-MORTG-BILLING-AREA.
  5603             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5604                                            PIC X.
  5605         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5606         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5607         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5608         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5609             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5610             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5611         16  FILLER                         PIC X.
  5612         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5613             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5614             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5615         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5616         16  FILLER                         PIC X(8).
  5617         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5618         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 107
* EL156.cbl
  5619         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5620         16  CF-ACH-COMPANY-ID.
  5621             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5622                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5623                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5624                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5625             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5626         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5627             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5628         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5629             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5630             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5631         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5632         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5633         16  FILLER                         PIC X(536).
  5634
  5635****************************************************************
  5636*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5637****************************************************************
  5638
  5639     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5640         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5641             20  CF-FEMALE-HEIGHT.
  5642                 24  CF-FEMALE-FT           PIC 99.
  5643                 24  CF-FEMALE-IN           PIC 99.
  5644             20  CF-FEMALE-MIN-WT           PIC 999.
  5645             20  CF-FEMALE-MAX-WT           PIC 999.
  5646         16  FILLER                         PIC X(428).
  5647
  5648     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5649         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5650             20  CF-MALE-HEIGHT.
  5651                 24  CF-MALE-FT             PIC 99.
  5652                 24  CF-MALE-IN             PIC 99.
  5653             20  CF-MALE-MIN-WT             PIC 999.
  5654             20  CF-MALE-MAX-WT             PIC 999.
  5655         16  FILLER                         PIC X(428).
  5656******************************************************************
  5657*             AUTOMATIC ACTIVITY RECORD                          *
  5658******************************************************************
  5659     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5660         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5661             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5662             20  CF-SYS-LETTER-ID           PIC X(04).
  5663             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5664             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5665             20  CF-SYS-RESET-SW            PIC X(01).
  5666             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5667             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5668
  5669         16  FILLER                         PIC X(50).
  5670
  5671         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5672             20  CF-USER-ACTIVE-SW          PIC X(01).
  5673             20  CF-USER-LETTER-ID          PIC X(04).
  5674             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5675             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5676             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 108
* EL156.cbl
  5677             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5678             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5679             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5680
  5681         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 109
* EL156.cbl
  5683*    COPY ELCCERT.
  5684******************************************************************
  5685*                                                                *
  5686*                            ELCCERT.                            *
  5687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5688*                            VMOD=2.013                          *
  5689*                                                                *
  5690*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5691*                                                                *
  5692*   FILE TYPE = VSAM,KSDS                                        *
  5693*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5694*                                                                *
  5695*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5696*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5697*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5698*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5699*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5700*                                                                *
  5701*   LOG = YES                                                    *
  5702*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5703******************************************************************
  5704*                   C H A N G E   L O G
  5705*
  5706* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5707*-----------------------------------------------------------------
  5708*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5709* EFFECTIVE    NUMBER
  5710*-----------------------------------------------------------------
  5711* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5712* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5713* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5714* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5715* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5716* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5717* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5718* 032612  CR2011110200001  PEMA  AHL CHANGES
  5719* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5720* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5721* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5722******************************************************************
  5723
  5724 01  CERTIFICATE-MASTER.
  5725     12  CM-RECORD-ID                      PIC XX.
  5726         88  VALID-CM-ID                      VALUE 'CM'.
  5727
  5728     12  CM-CONTROL-PRIMARY.
  5729         16  CM-COMPANY-CD                 PIC X.
  5730         16  CM-CARRIER                    PIC X.
  5731         16  CM-GROUPING.
  5732             20  CM-GROUPING-PREFIX        PIC X(3).
  5733             20  CM-GROUPING-PRIME         PIC X(3).
  5734         16  CM-STATE                      PIC XX.
  5735         16  CM-ACCOUNT.
  5736             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5737             20  CM-ACCOUNT-PRIME          PIC X(6).
  5738         16  CM-CERT-EFF-DT                PIC XX.
  5739         16  CM-CERT-NO.
  5740             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 110
* EL156.cbl
  5741             20  CM-CERT-SFX               PIC X.
  5742
  5743     12  CM-CONTROL-BY-NAME.
  5744         16  CM-COMPANY-CD-A1              PIC X.
  5745         16  CM-INSURED-LAST-NAME          PIC X(15).
  5746         16  CM-INSURED-INITIALS.
  5747             20  CM-INSURED-INITIAL1       PIC X.
  5748             20  CM-INSURED-INITIAL2       PIC X.
  5749
  5750     12  CM-CONTROL-BY-SSN.
  5751         16  CM-COMPANY-CD-A2              PIC X.
  5752         16  CM-SOC-SEC-NO.
  5753             20  CM-SSN-STATE              PIC XX.
  5754             20  CM-SSN-ACCOUNT            PIC X(6).
  5755             20  CM-SSN-LN3.
  5756                 25  CM-INSURED-INITIALS-A2.
  5757                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5758                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5759                 25 CM-PART-LAST-NAME-A2         PIC X.
  5760
  5761     12  CM-CONTROL-BY-CERT-NO.
  5762         16  CM-COMPANY-CD-A4              PIC X.
  5763         16  CM-CERT-NO-A4                 PIC X(11).
  5764
  5765     12  CM-CONTROL-BY-MEMB.
  5766         16  CM-COMPANY-CD-A5              PIC X.
  5767         16  CM-MEMBER-NO.
  5768             20  CM-MEMB-STATE             PIC XX.
  5769             20  CM-MEMB-ACCOUNT           PIC X(6).
  5770             20  CM-MEMB-LN4.
  5771                 25  CM-INSURED-INITIALS-A5.
  5772                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5773                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5774                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5775
  5776     12  CM-INSURED-PROFILE-DATA.
  5777         16  CM-INSURED-FIRST-NAME.
  5778             20  CM-INSURED-1ST-INIT       PIC X.
  5779             20  FILLER                    PIC X(9).
  5780         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5781         16  CM-INSURED-SEX                PIC X.
  5782             88  CM-SEX-MALE                  VALUE 'M'.
  5783             88  CM-SEX-FEMAL                 VALUE 'F'.
  5784         16  CM-INSURED-JOINT-AGE          PIC 99.
  5785         16  CM-JOINT-INSURED-NAME.
  5786             20  CM-JT-LAST-NAME           PIC X(15).
  5787             20  CM-JT-FIRST-NAME.
  5788                 24  CM-JT-1ST-INIT        PIC X.
  5789                 24  FILLER                PIC X(9).
  5790             20  CM-JT-INITIAL             PIC X.
  5791
  5792     12  CM-LIFE-DATA.
  5793         16  CM-LF-BENEFIT-CD              PIC XX.
  5794         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5795         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5796         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5797         16  CM-LF-DEV-CODE                PIC XXX.
  5798         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 111
* EL156.cbl
  5799         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5800         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5801         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5802         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5803         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5804         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5805         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5806         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5807         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5808         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5809         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5810         16  cm-temp-epiq                  pic xx.
  5811             88  EPIQ-CLASS                  value 'EQ'.
  5812*        16  FILLER                        PIC XX.
  5813
  5814     12  CM-AH-DATA.
  5815         16  CM-AH-BENEFIT-CD              PIC XX.
  5816         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5817         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5818         16  CM-AH-DEV-CODE                PIC XXX.
  5819         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5820         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5821         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5822         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5823         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5824         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5825         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5826         16  CM-AH-PAID-THRU-DT            PIC XX.
  5827             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5828         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5829         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5830         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5831         16  FILLER                        PIC X.
  5832
  5833     12  CM-LOAN-INFORMATION.
  5834         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5835         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5836                                           PIC S9(5)V99  COMP-3.
  5837         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5838         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5839         16  CM-PAY-FREQUENCY              PIC S99.
  5840         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5841         16  CM-RATE-CLASS                 PIC XX.
  5842         16  CM-BENEFICIARY                PIC X(25).
  5843         16  CM-POLICY-FORM-NO             PIC X(12).
  5844         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5845         16  CM-LAST-ADD-ON-DT             PIC XX.
  5846         16  CM-DEDUCTIBLE-AMOUNTS.
  5847             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5848             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5849         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5850             20  CM-RESIDENT-STATE         PIC XX.
  5851             20  CM-RATE-CODE              PIC X(4).
  5852             20  FILLER                    PIC XX.
  5853         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5854             20  CM-LOAN-OFFICER           PIC X(5).
  5855             20  FILLER                    PIC XXX.
  5856         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 112
* EL156.cbl
  5857         16  CM-UNDERWRITING-CODE          PIC X.
  5858             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5859         16  CM-POST-CARD-IND              PIC X.
  5860         16  CM-REF-INTERFACE-SW           PIC X.
  5861         16  CM-PREMIUM-TYPE               PIC X.
  5862             88  CM-SING-PRM                  VALUE '1'.
  5863             88  CM-O-B-COVERAGE              VALUE '2'.
  5864             88  CM-OPEN-END                  VALUE '3'.
  5865         16  CM-IND-GRP-TYPE               PIC X.
  5866             88  CM-INDIVIDUAL                VALUE 'I'.
  5867             88  CM-GROUP                     VALUE 'G'.
  5868         16  CM-SKIP-CODE                  PIC X.
  5869             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5870             88  SKIP-JULY                    VALUE '1'.
  5871             88  SKIP-AUGUST                  VALUE '2'.
  5872             88  SKIP-SEPTEMBER               VALUE '3'.
  5873             88  SKIP-JULY-AUG                VALUE '4'.
  5874             88  SKIP-AUG-SEPT                VALUE '5'.
  5875             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5876             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5877             88  SKIP-JUNE                    VALUE '8'.
  5878             88  SKIP-JUNE-JULY               VALUE '9'.
  5879             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5880             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5881         16  CM-PAYMENT-MODE               PIC X.
  5882             88  PAY-MONTHLY                  VALUE SPACE.
  5883             88  PAY-WEEKLY                   VALUE '1'.
  5884             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5885             88  PAY-BI-WEEKLY                VALUE '3'.
  5886             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5887         16  CM-LOAN-NUMBER                PIC X(8).
  5888         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5889         16  CM-OLD-LOF                    PIC XXX.
  5890*        16  CM-LOAN-OFFICER               PIC XXX.
  5891         16  CM-REIN-TABLE                 PIC XXX.
  5892         16  CM-SPECIAL-REIN-CODE          PIC X.
  5893         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5894         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5895         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5896
  5897     12  CM-STATUS-DATA.
  5898         16  CM-ENTRY-STATUS               PIC X.
  5899         16  CM-ENTRY-DT                   PIC XX.
  5900
  5901         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5902         16  CM-LF-CANCEL-DT               PIC XX.
  5903         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5904
  5905         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5906         16  CM-LF-DEATH-DT                PIC XX.
  5907         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5908
  5909         16  CM-LF-CURRENT-STATUS          PIC X.
  5910             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5911                                                'M' '4' '5' '9'.
  5912             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5913             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5914             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 113
* EL156.cbl
  5915             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5916             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5917             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5918             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5919             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5920             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5921             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5922             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5923             88  CM-LF-DECLINED               VALUE 'D'.
  5924             88  CM-LF-VOIDED                 VALUE 'V'.
  5925
  5926         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5927         16  CM-AH-CANCEL-DT               PIC XX.
  5928         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5929
  5930         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5931         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5932         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5933
  5934         16  CM-AH-CURRENT-STATUS          PIC X.
  5935             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5936                                                'M' '4' '5' '9'.
  5937             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5938             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5939             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5940             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5941             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5942             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5943             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5944             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5945             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5946             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5947             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5948             88  CM-AH-DECLINED               VALUE 'D'.
  5949             88  CM-AH-VOIDED                 VALUE 'V'.
  5950
  5951         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5952             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5953             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5954             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5955         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5956
  5957         16  CM-ENTRY-BATCH                PIC X(6).
  5958         16  CM-LF-EXIT-BATCH              PIC X(6).
  5959         16  CM-AH-EXIT-BATCH              PIC X(6).
  5960         16  CM-LAST-MONTH-END             PIC XX.
  5961
  5962     12  CM-NOTE-SW                        PIC X.
  5963         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5964         88  CERT-NOTES-PRESENT               VALUE '1'.
  5965         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5966         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5967         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5968         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5969         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5970         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5971     12  CM-COMP-EXCP-SW                   PIC X.
  5972         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 114
* EL156.cbl
  5973         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5974     12  CM-INSURED-ADDRESS-SW             PIC X.
  5975         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5976         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5977
  5978*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5979     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5980     12  FILLER                            PIC X.
  5981
  5982*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5983     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5984     12  FILLER                            PIC X.
  5985*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5986     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5987
  5988     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5989         88  CERT-ADDED-BATCH                 VALUE ' '.
  5990         88  CERT-ADDED-ONLINE                VALUE '1'.
  5991         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5992         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5993         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5994     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5995         88  CERT-AS-LOADED                   VALUE ' '.
  5996         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5997         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5998         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5999         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6000         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6001         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6002         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6003
  6004     12  CM-ACCOUNT-COMM-PCTS.
  6005         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6006         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6007
  6008     12  CM-USER-FIELD                     PIC X.
  6009     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6010     12  CM-CLP-STATE                      PIC XX.
  6011     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6012     12  CM-USER-RESERVED                  PIC XXX.
  6013     12  FILLER REDEFINES CM-USER-RESERVED.
  6014         16  CM-AH-CLASS-CD                PIC XX.
  6015         16  F                             PIC X.
  6016******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 115
* EL156.cbl
  6018*    COPY ELCTRLR.
  6019******************************************************************
  6020*                                                                *
  6021*                            ELCTRLR.                            *
  6022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6023*                            VMOD=2.014                          *
  6024*                                                                *
  6025*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  6026*                                                                *
  6027*   FILE TYPE = VSAM,KSDS                                        *
  6028*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6029*                                                                *
  6030*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6031*       ALTERNATE INDEX = NONE                                   *
  6032*                                                                *
  6033*   LOG = YES                                                    *
  6034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6035******************************************************************
  6036*                   C H A N G E   L O G
  6037*
  6038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6039*-----------------------------------------------------------------
  6040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6041* EFFECTIVE    NUMBER
  6042*-----------------------------------------------------------------
  6043* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6044* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6045* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6046* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6047* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6048* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6049* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6050* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6051* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6052* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6053* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6054* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6055* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6056* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6057* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6058* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6059* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6060* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6061* 040814    2014030500002  AJRA  ADD ICD CODES
  6062* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6063* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6064* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6065* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  6066* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  6067******************************************************************
  6068 01  ACTIVITY-TRAILERS.
  6069     12  AT-RECORD-ID                    PIC XX.
  6070         88  VALID-AT-ID                       VALUE 'AT'.
  6071
  6072     12  AT-CONTROL-PRIMARY.
  6073         16  AT-COMPANY-CD               PIC X.
  6074         16  AT-CARRIER                  PIC X.
  6075         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 116
* EL156.cbl
  6076         16  AT-CERT-NO.
  6077             20  AT-CERT-PRIME           PIC X(10).
  6078             20  AT-CERT-SFX             PIC X.
  6079         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6080             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6081             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6082             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6083             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6084             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6085             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6086             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6087             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6088             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6089             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6090             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6091             88  AT-BENEFICIARY-TRL           VALUE +91.
  6092             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6093             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6094             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6095             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6096
  6097     12  AT-TRAILER-TYPE                 PIC X.
  6098         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6099         88  PAYMENT-TR                       VALUE '2'.
  6100         88  AUTO-PAY-TR                      VALUE '3'.
  6101         88  CORRESPONDENCE-TR                VALUE '4'.
  6102         88  ADDRESS-TR                       VALUE '5'.
  6103         88  GENERAL-INFO-TR                  VALUE '6'.
  6104         88  AUTO-PROMPT-TR                   VALUE '7'.
  6105         88  DENIAL-TR                        VALUE '8'.
  6106         88  INCURRED-CHG-TR                  VALUE '9'.
  6107         88  FORM-CONTROL-TR                  VALUE 'A'.
  6108
  6109     12  AT-RECORDED-DT                  PIC XX.
  6110     12  AT-RECORDED-BY                  PIC X(4).
  6111     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6112
  6113     12  AT-TRAILER-BODY                 PIC X(165).
  6114
  6115     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6116         16  AT-RESERVE-CONTROLS.
  6117             20  AT-MANUAL-SW            PIC X.
  6118                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6119             20  AT-FUTURE-SW            PIC X.
  6120                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6121             20  AT-PTC-SW               PIC X.
  6122                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6123             20  AT-IBNR-SW              PIC X.
  6124                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6125             20  AT-PTC-LF-SW            PIC X.
  6126                 88  AT-LF-PTC-USED          VALUE '1'.
  6127             20  AT-CDT-ACCESS-METHOD    PIC X.
  6128                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6129                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6130                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6131             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6132         16  AT-LAST-COMPUTED-DT         PIC XX.
  6133         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 117
* EL156.cbl
  6134         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6135         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6136         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6137         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6138         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6139         16  AT-EXPENSE-CONTROLS.
  6140             20  AT-EXPENSE-METHOD       PIC X.
  6141                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6142                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6143                 88  PERCENT-OF-PMT           VALUE '3'.
  6144                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6145             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6146             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6147         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6148         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6149
  6150         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6151         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6152
  6153*        16  FILLER                      PIC X(53).
  6154         16  FILLER                      PIC X(47).
  6155
  6156         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6157         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6158
  6159         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6160             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6161             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6162*                    C = CLOSED
  6163*                    O = OPEN
  6164             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6165*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6166
  6167     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6168         16  AT-PAYMENT-TYPE             PIC X.
  6169             88  PARTIAL-PAYMENT                VALUE '1'.
  6170             88  FINAL-PAYMENT                  VALUE '2'.
  6171             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6172             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6173             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6174             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6175             88  VOIDED-PAYMENT                 VALUE '9'.
  6176             88  TRANSFER                       VALUE 'T'.
  6177             88  LIFE-INTEREST                  VALUE 'I'.
  6178
  6179         16  AT-CLAIM-TYPE               PIC X.
  6180             88  PAID-FOR-AH                    VALUE 'A'.
  6181             88  PAID-FOR-LIFE                  VALUE 'L'.
  6182             88  PAID-FOR-IUI                   VALUE 'I'.
  6183             88  PAID-FOR-GAP                   VALUE 'G'.
  6184             88  PAID-FOR-FAM                   VALUE 'F'.
  6185             88  PAID-FOR-OTH                   VALUE 'O'.
  6186         16  AT-CLAIM-PREM-TYPE          PIC X.
  6187             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6188             88  AT-O-B-COVERAGE                VALUE '2'.
  6189             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6190         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6191         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 118
* EL156.cbl
  6192         16  AT-PAID-FROM-DT             PIC XX.
  6193         16  AT-PAID-THRU-DT             PIC XX.
  6194         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6195         16  AT-ACH-PAYMENT              PIC X.
  6196*        16  FILLER                      PIC X.
  6197         16  AT-PAYEES-NAME              PIC X(30).
  6198         16  AT-PAYMENT-ORIGIN           PIC X.
  6199             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6200             88  ONLINE-AUTO-PMT                VALUE '2'.
  6201             88  OFFLINE-PMT                    VALUE '3'.
  6202         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6203         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6204         16  AT-VOID-DATA.
  6205             20  AT-VOID-DT              PIC XX.
  6206*00144       20  AT-VOID-REASON          PIC X(30).
  6207             20  AT-VOID-REASON          PIC X(26).
  6208         16  AT-PMT-APPROVED-BY          PIC X(04).
  6209         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6210         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6211         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6212                                         PIC S99V9(5)  COMP-3.
  6213         16  AT-CREDIT-INTERFACE.
  6214             20  AT-PMT-SELECT-DT        PIC XX.
  6215                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6216             20  AT-PMT-ACCEPT-DT        PIC XX.
  6217                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6218             20  AT-VOID-SELECT-DT       PIC XX.
  6219                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6220             20  AT-VOID-ACCEPT-DT       PIC XX.
  6221                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6222
  6223         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6224                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6225                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6226         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6227
  6228         16  AT-FORCE-CONTROL            PIC X.
  6229             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6230         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6231         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6232         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6233         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6234         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6235         16  AT-BENEFIT-TYPE             PIC X.
  6236
  6237         16  AT-EXPENSE-TYPE             PIC X.
  6238         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6239
  6240         16  AT-PAYEE-TYPE-CD.
  6241             20  AT-PAYEE-TYPE           PIC X.
  6242                 88  INSURED-PAID           VALUE 'I'.
  6243                 88  BENEFICIARY-PAID       VALUE 'B'.
  6244                 88  ACCOUNT-PAID           VALUE 'A'.
  6245                 88  OTHER-1-PAID           VALUE 'O'.
  6246                 88  OTHER-2-PAID           VALUE 'Q'.
  6247                 88  DOCTOR-PAID            VALUE 'P'.
  6248                 88  EMPLOYER-PAID          VALUE 'E'.
  6249             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 119
* EL156.cbl
  6250
  6251         16  AT-CASH-PAYMENT             PIC X.
  6252         16  AT-GROUPED-PAYMENT          PIC X.
  6253         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6254         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6255         16  AT-APPROVED-LEVEL           PIC X.
  6256         16  AT-VOID-TYPE                PIC X.
  6257             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6258             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6259         16  AT-AIG-UNEMP-IND            PIC X.
  6260             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6261         16  AT-ASSOCIATES               PIC X.
  6262             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6263             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6264
  6265         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6266         16  AT-CV-PMT-CODE              PIC X.
  6267             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6268             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6269             88  FULL-ADD-PAYMENT           VALUE '3'.
  6270             88  HALF-ADD-PAYMENT           VALUE '4'.
  6271             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6272             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6273             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6274             88  ADDL-PAYMENT               VALUE '8'.
  6275
  6276         16  AT-EOB-CODE1                PIC XXX.
  6277         16  AT-EOB-CODE2                PIC XXX.
  6278         16  AT-EOB-CODE3                PIC XXX.
  6279         16  FILLER REDEFINES AT-EOB-CODE3.
  6280             20  AT-PRINT-CLM-FORM       PIC X.
  6281             20  AT-PRINT-SURVEY         PIC X.
  6282             20  AT-SPECIAL-RELEASE      PIC X.
  6283         16  AT-EOB-CODE4                PIC XXX.
  6284         16  FILLER REDEFINES AT-EOB-CODE4.
  6285             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6286             20  FILLER                  PIC X.
  6287         16  AT-EOB-CODE5                PIC XXX.
  6288         16  FILLER REDEFINES AT-EOB-CODE5.
  6289             20  AT-PMT-PROOF-DT         PIC XX.
  6290             20  FILLER                  PIC X.
  6291
  6292         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6293             88  AT-PRINT-EOB            VALUE 'Y'.
  6294
  6295         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6296         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6297
  6298     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6299         16  AT-SCHEDULE-START-DT        PIC XX.
  6300         16  AT-SCHEDULE-END-DT          PIC XX.
  6301         16  AT-TERMINATED-DT            PIC XX.
  6302         16  AT-LAST-PMT-TYPE            PIC X.
  6303             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6304             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6305         16  AT-FIRST-PMT-DATA.
  6306             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6307             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 120
* EL156.cbl
  6308             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6309         16  AT-REGULAR-PMT-DATA.
  6310             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6311             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6312             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6313         16  AT-AUTO-PAYEE-CD.
  6314             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6315                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6316                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6317                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6318                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6319                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6320             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6321         16  AT-AUTO-PAY-DAY             PIC 99.
  6322         16  AT-AUTO-CASH                PIC X.
  6323             88  AT-CASH                      VALUE 'Y'.
  6324             88  AT-NON-CASH                  VALUE 'N'.
  6325*        16  FILLER                      PIC X(129).
  6326         16  AT-AUTO-END-LETTER          PIC X(4).
  6327         16  FILLER                      PIC X(125).
  6328
  6329         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6330         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6331
  6332     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6333         16  AT-LETTER-SENT-DT           PIC XX.
  6334         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6335         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6336         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6337         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6338         16  AT-LETTER-ORIGIN            PIC X.
  6339             88  ONLINE-CREATION              VALUE '1' '3'.
  6340             88  OFFLINE-CREATION             VALUE '2' '4'.
  6341             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6342             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6343         16  AT-STD-LETTER-FORM          PIC X(4).
  6344         16  AT-REASON-TEXT              PIC X(70).
  6345         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6346         16  AT-ADDRESEE-TYPE            PIC X.
  6347              88  INSURED-ADDRESEE            VALUE 'I'.
  6348              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6349              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6350              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6351              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6352              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6353              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6354         16  AT-ADDRESSEE-NAME           PIC X(30).
  6355         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6356         16  AT-RESEND-PRINT-DATE        PIC XX.
  6357         16  AT-CORR-SOL-UNSOL           PIC X.
  6358         16  AT-LETTER-PURGED-DT         PIC XX.
  6359*
  6360*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6361*
  6362         16  AT-CSO-REDEFINITION.
  6363             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6364             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6365             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 121
* EL156.cbl
  6366             20  AT-STOP-LETTER-DT       PIC X(2).
  6367             20  AT-AUTH-RCVD            PIC X(1).
  6368             20  FILLER                  PIC X(18).
  6369*             20  FILLER                  PIC X(27).
  6370             20  AT-CSO-LETTER-STATUS    PIC X.
  6371                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6372                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6373                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6374             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6375             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6376*
  6377*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6378*
  6379*        16  FILLER                      PIC X(26).
  6380*
  6381*        16  AT-DMD-BSR-CODE             PIC X.
  6382*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6383*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6384*
  6385*        16  AT-DMD-LETTER-STATUS        PIC X.
  6386*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6387*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6388*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6389*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6390*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6391
  6392         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6393         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6394
  6395     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6396         16  AT-ADDRESS-TYPE             PIC X.
  6397             88  INSURED-ADDRESS               VALUE 'I'.
  6398             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6399             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6400             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6401             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6402             88  OTHER-ADDRESS-1               VALUE 'O'.
  6403             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6404         16  AT-MAIL-TO-NAME             PIC X(30).
  6405         16  AT-ADDRESS-LINE-1           PIC X(30).
  6406         16  AT-ADDRESS-LINE-2           PIC X(30).
  6407         16  AT-CITY-STATE.
  6408             20  AT-CITY                 PIC X(28).
  6409             20  AT-STATE                PIC XX.
  6410         16  AT-ZIP.
  6411             20  AT-ZIP-CODE.
  6412                 24  AT-ZIP-1ST          PIC X.
  6413                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6414                 24  FILLER              PIC X(4).
  6415             20  AT-ZIP-PLUS4            PIC X(4).
  6416         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6417             20  AT-CAN-POSTAL-1         PIC XXX.
  6418             20  AT-CAN-POSTAL-2         PIC XXX.
  6419             20  FILLER                  PIC XXX.
  6420         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6421*         16  FILLER                      PIC X(23).
  6422         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6423         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 122
* EL156.cbl
  6424         16  FILLER                      PIC X(13).
  6425         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6426         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6427
  6428     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6429         16  AT-INFO-LINE-1              PIC X(60).
  6430         16  FILLER REDEFINES AT-INFO-LINE-1.
  6431             20  AT-NOTE-ERROR-NO OCCURS 15
  6432                                         PIC X(4).
  6433         16  AT-INFO-LINE-2              PIC X(60).
  6434         16  FILLER REDEFINES AT-INFO-LINE-2.
  6435             20  AT-ICD-CODE-1           PIC X(8).
  6436             20  AT-ICD-CODE-2           PIC X(8).
  6437             20  FILLER                  PIC X(44).
  6438         16  AT-INFO-TRAILER-TYPE        PIC X.
  6439             88  AT-ERRORS-NOTE          VALUE 'E'.
  6440             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6441             88  AT-CALL-NOTE            VALUE 'C'.
  6442             88  AT-MAINT-NOTE           VALUE 'M'.
  6443             88  AT-CERT-CHANGE          VALUE 'X'.
  6444             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6445             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6446             88  AT-CERT-CANCELLED       VALUE 'T'.
  6447         16  AT-CALL-TYPE                PIC X.
  6448             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6449             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6450             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6451         16  AT-NOTE-CONTINUATION        PIC X.
  6452             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6453         16  AT-EOB-CODES-EXIST          PIC X.
  6454             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6455         16  FILLER                      PIC X(35).
  6456         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6457         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6458
  6459     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6460         16  AT-PROMPT-LINE-1            PIC X(60).
  6461         16  AT-PROMPT-LINE-2            PIC X(60).
  6462         16  AT-PROMPT-START-DT          PIC XX.
  6463         16  AT-PROMPT-END-DT            PIC XX.
  6464         16  FILLER                      PIC X(35).
  6465         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6466         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6467
  6468     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6469         16  AT-DENIAL-INFO-1            PIC X(60).
  6470         16  AT-DENIAL-INFO-2            PIC X(60).
  6471         16  AT-DENIAL-DT                PIC XX.
  6472         16  AT-RETRACTION-DT            PIC XX.
  6473         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6474*         16  FILLER                      PIC X(31).
  6475         16  AT-DENIAL-PROOF-DT          PIC XX.
  6476         16  FILLER                      PIC X(29).
  6477         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6478         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6479
  6480     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6481         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 123
* EL156.cbl
  6482         16  AT-OLD-REPORTED-DT          PIC XX.
  6483         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6484         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6485         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6486         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6487         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6488         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6489         16  FILLER                      PIC X(26).
  6490         16  AT-OLD-DIAG-CODE            PIC X(6).
  6491         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6492         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6493         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6494         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6495         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6496         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6497         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6498         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6499         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6500         16  FILLER                      PIC X(9).
  6501         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6502
  6503     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6504         16  AT-FORM-SEND-ON-DT          PIC XX.
  6505         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6506         16  AT-FORM-RE-SEND-DT          PIC XX.
  6507         16  AT-FORM-ANSWERED-DT         PIC XX.
  6508         16  AT-FORM-PRINTED-DT          PIC XX.
  6509         16  AT-FORM-REPRINT-DT          PIC XX.
  6510         16  AT-FORM-TYPE                PIC X.
  6511             88  INITIAL-FORM                  VALUE '1'.
  6512             88  PROGRESS-FORM                 VALUE '2'.
  6513         16  AT-INSTRUCT-LN-1            PIC X(28).
  6514         16  AT-INSTRUCT-LN-2            PIC X(28).
  6515         16  AT-INSTRUCT-LN-3            PIC X(28).
  6516         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6517         16  AT-FORM-ADDRESS             PIC X.
  6518             88  FORM-TO-INSURED              VALUE 'I'.
  6519             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6520             88  FORM-TO-OTHER-1              VALUE 'O'.
  6521             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6522         16  AT-RELATED-1.
  6523             20 AT-REL-CARR-1            PIC X.
  6524             20 AT-REL-CLAIM-1           PIC X(7).
  6525             20 AT-REL-CERT-1            PIC X(11).
  6526         16  AT-RELATED-2.
  6527             20 AT-REL-CARR-2            PIC X.
  6528             20 AT-REL-CLAIM-2           PIC X(7).
  6529             20 AT-REL-CERT-2            PIC X(11).
  6530         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6531         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6532         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6533         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6534         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6535         16  AT-STOP-FORM-DT             PIC X(2).
  6536
  6537         16  FILLER                      PIC X(09).
  6538         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6539         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 124
* EL156.cbl
  6540******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 125
* EL156.cbl
  6542*    COPY ELCACTQ.
  6543******************************************************************
  6544*                                                                *
  6545*                            ELCACTQ.                            *
  6546*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6547*                            VMOD=2.004                          *
  6548*                                                                *
  6549*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6550*                                                                *
  6551*   FILE TYPE = VSAM,KSDS                                        *
  6552*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6553*                                                                *
  6554*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6555*       ALTERNATE INDEX = NONE                                   *
  6556*                                                                *
  6557*   LOG = YES                                                    *
  6558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6559*                                                                *
  6560*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6561******************************************************************
  6562
  6563 01  ACTIVITY-QUE.
  6564     12  AQ-RECORD-ID                PIC XX.
  6565         88  VALID-AQ-ID                VALUE 'AQ'.
  6566
  6567     12  AQ-CONTROL-PRIMARY.
  6568         16  AQ-COMPANY-CD           PIC X.
  6569         16  AQ-CARRIER              PIC X.
  6570         16  AQ-CLAIM-NO             PIC X(7).
  6571         16  AQ-CERT-NO.
  6572             20  AQ-CERT-PRIME       PIC X(10).
  6573             20  AQ-CERT-SFX         PIC X.
  6574
  6575     12  AQ-PENDING-ACTIVITY-FLAGS.
  6576         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6577         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6578             88  PENDING-PAYMENTS       VALUE '1'.
  6579         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6580             88  PENDING-FULL-PRINT     VALUE '1'.
  6581             88  PENDING-PART-PRINT     VALUE '2'.
  6582         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6583             88  PENDING-LETTERS        VALUE '1'.
  6584         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6585             88  PENDING-RESTORE        VALUE 'C'.
  6586             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6587
  6588     12  FILLER                      PIC X(20).
  6589
  6590     12  AQ-RESEND-DATE              PIC XX.
  6591     12  AQ-FOLLOWUP-DATE            PIC XX.
  6592     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6593     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6594     12  AQ-AUTO-LETTER              PIC X(4).
  6595     12  FILLER                      PIC XX.
  6596     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6597*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 126
* EL156.cbl
  6599*    COPY ERCACCT.
  6600******************************************************************
  6601*                                                                *
  6602*                                                                *
  6603*                            ERCACCT                             *
  6604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6605*                            VMOD=2.031                          *
  6606*                                                                *
  6607*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6608*                                                                *
  6609*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6610*   VSAM ACCOUNT MASTER FILES.                                   *
  6611*                                                                *
  6612*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6613*                                                                *
  6614*   FILE TYPE = VSAM,KSDS                                        *
  6615*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6616*                                                                *
  6617*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6618*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6619*                                                                *
  6620*   LOG = NO                                                     *
  6621*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6622*                                                                *
  6623*                                                                *
  6624******************************************************************
  6625*                   C H A N G E   L O G
  6626*
  6627* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6628*-----------------------------------------------------------------
  6629*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6630* EFFECTIVE    NUMBER
  6631*-----------------------------------------------------------------
  6632* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6633* 092705    2005050300006  PEMA  ADD SPP LEASES
  6634* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6635* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6636* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6637* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6638* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6639* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6640******************************************************************
  6641
  6642 01  ACCOUNT-MASTER.
  6643     12  AM-RECORD-ID                      PIC XX.
  6644         88  VALID-AM-ID                      VALUE 'AM'.
  6645
  6646     12  AM-CONTROL-PRIMARY.
  6647         16  AM-COMPANY-CD                 PIC X.
  6648         16  AM-MSTR-CNTRL.
  6649             20  AM-CONTROL-A.
  6650                 24  AM-CARRIER            PIC X.
  6651                 24  AM-GROUPING.
  6652                     28 AM-GROUPING-PREFIX PIC XXX.
  6653                     28 AM-GROUPING-PRIME  PIC XXX.
  6654                 24  AM-STATE              PIC XX.
  6655                 24  AM-ACCOUNT.
  6656                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 127
* EL156.cbl
  6657                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6658             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6659                                           PIC X(19).
  6660             20  AM-CNTRL-B.
  6661                 24  AM-EXPIRATION-DT      PIC XX.
  6662                 24  FILLER                PIC X(4).
  6663             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6664                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6665
  6666     12  AM-CONTROL-BY-VAR-GRP.
  6667         16  AM-COMPANY-CD-A1              PIC X.
  6668         16  AM-VG-CARRIER                 PIC X.
  6669         16  AM-VG-GROUPING                PIC X(6).
  6670         16  AM-VG-STATE                   PIC XX.
  6671         16  AM-VG-ACCOUNT                 PIC X(10).
  6672         16  AM-VG-DATE.
  6673             20  AM-VG-EXPIRATION-DT       PIC XX.
  6674             20  FILLER                    PIC X(4).
  6675         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6676                                           PIC 9(11)      COMP-3.
  6677     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6678         16  FILLER                        PIC X(10).
  6679         16  AM-VG-KEY3.
  6680             20  AM-VG3-ACCOUNT            PIC X(10).
  6681             20  AM-VG3-EXP-DT             PIC XX.
  6682         16  FILLER                        PIC X(4).
  6683     12  AM-MAINT-INFORMATION.
  6684         16  AM-LAST-MAINT-DT              PIC XX.
  6685         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6686         16  AM-LAST-MAINT-USER            PIC X(4).
  6687         16  FILLER                        PIC XX.
  6688
  6689     12  AM-EFFECTIVE-DT                   PIC XX.
  6690     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6691
  6692     12  AM-PREV-DATES  COMP-3.
  6693         16  AM-PREV-EXP-DT                PIC 9(11).
  6694         16  AM-PREV-EFF-DT                PIC 9(11).
  6695
  6696     12  AM-REPORT-CODE-1                  PIC X(10).
  6697     12  AM-REPORT-CODE-2                  PIC X(10).
  6698
  6699     12  AM-CITY-CODE                      PIC X(4).
  6700     12  AM-COUNTY-PARISH                  PIC X(6).
  6701
  6702     12  AM-NAME                           PIC X(30).
  6703     12  AM-PERSON                         PIC X(30).
  6704     12  AM-ADDRS                          PIC X(30).
  6705     12  AM-CITY.
  6706         16  AM-ADDR-CITY                  PIC X(28).
  6707         16  AM-ADDR-STATE                 PIC XX.
  6708     12  AM-ZIP.
  6709         16  AM-ZIP-PRIME.
  6710             20  AM-ZIP-PRI-1ST            PIC X.
  6711                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6712             20  FILLER                    PIC X(4).
  6713         16  AM-ZIP-PLUS4                  PIC X(4).
  6714     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 128
* EL156.cbl
  6715         16  AM-CAN-POSTAL-1               PIC XXX.
  6716         16  AM-CAN-POSTAL-2               PIC XXX.
  6717         16  FILLER                        PIC XXX.
  6718     12  AM-TEL-NO.
  6719         16  AM-AREA-CODE                  PIC 999.
  6720         16  AM-TEL-PRE                    PIC 999.
  6721         16  AM-TEL-NBR                    PIC 9(4).
  6722     12  AM-TEL-LOC                        PIC X.
  6723         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6724         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6725
  6726     12  AM-COMM-STRUCTURE.
  6727         16  AM-DEFN-1.
  6728             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6729                 24  AM-AGT.
  6730                     28  AM-AGT-PREFIX     PIC X(4).
  6731                     28  AM-AGT-PRIME      PIC X(6).
  6732                 24  AM-COM-TYP            PIC X.
  6733                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6734                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6735                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6736                 24  AM-RECALC-LV-INDIC    PIC X.
  6737                 24  AM-RETRO-LV-INDIC     PIC X.
  6738                 24  AM-GL-CODES           PIC X.
  6739                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6740                 24  FILLER                PIC X(01).
  6741         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6742             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6743                 24  FILLER                PIC X(11).
  6744                 24  AM-L-COMA             PIC XXX.
  6745                 24  AM-J-COMA             PIC XXX.
  6746                 24  AM-A-COMA             PIC XXX.
  6747                 24  FILLER                PIC X(6).
  6748
  6749     12  AM-COMM-CHANGE-STATUS             PIC X.
  6750         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6751
  6752     12  AM-CSR-CODE                       PIC X(4).
  6753
  6754     12  AM-BILLING-STATUS                 PIC X.
  6755         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6756         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6757     12  AM-AUTO-REFUND-SW                 PIC X.
  6758         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6759         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6760     12  AM-GPCD                           PIC 99.
  6761     12  AM-IG                             PIC X.
  6762         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6763         88  AM-HAS-GROUP                     VALUE '2'.
  6764     12  AM-STATUS                         PIC X.
  6765         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6766         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6767         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6768         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6769         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6770         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6771         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6772         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 129
* EL156.cbl
  6773         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6774         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6775     12  AM-REMIT-TO                       PIC 99.
  6776     12  AM-ID-NO                          PIC X(11).
  6777
  6778     12  AM-CAL-TABLE                      PIC XX.
  6779     12  AM-LF-DEVIATION                   PIC XXX.
  6780     12  AM-AH-DEVIATION                   PIC XXX.
  6781     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6782     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6783     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6784     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6785     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6786     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6787
  6788     12  AM-USER-FIELDS.
  6789         16  AM-FLD-1                      PIC XX.
  6790         16  AM-FLD-2                      PIC XX.
  6791         16  AM-FLD-3                      PIC XX.
  6792         16  AM-FLD-4                      PIC XX.
  6793         16  AM-FLD-5                      PIC XX.
  6794
  6795     12  AM-1ST-PROD-DATE.
  6796         16  AM-1ST-PROD-YR                PIC XX.
  6797         16  AM-1ST-PROD-MO                PIC XX.
  6798         16  AM-1ST-PROD-DA                PIC XX.
  6799     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6800     12  AM-CERTS-PURGED-DATE.
  6801         16  AM-PUR-YR                     PIC XX.
  6802         16  AM-PUR-MO                     PIC XX.
  6803         16  AM-PUR-DA                     PIC XX.
  6804     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6805     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6806     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6807     12  AM-INACTIVE-DATE.
  6808         16  AM-INA-MO                     PIC 99.
  6809         16  AM-INA-DA                     PIC 99.
  6810         16  AM-INA-YR                     PIC 99.
  6811     12  AM-AR-HI-CERT-DATE                PIC XX.
  6812
  6813     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6814     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6815
  6816     12  AM-OB-PAYMENT-MODE                PIC X.
  6817         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6818         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6819         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6820         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6821
  6822     12  AM-AH-ONLY-INDICATOR              PIC X.
  6823         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6824         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6825
  6826     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6827
  6828     12  AM-OVER-SHORT.
  6829         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6830         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 130
* EL156.cbl
  6831
  6832     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6833     12  AM-DCC-CLP-STATE                  PIC XX.
  6834
  6835     12  AM-RECALC-COMM                    PIC X.
  6836     12  AM-RECALC-REIN                    PIC X.
  6837
  6838     12  AM-REI-TABLE                      PIC XXX.
  6839     12  AM-REI-ET-LF                      PIC X.
  6840     12  AM-REI-ET-AH                      PIC X.
  6841     12  AM-REI-PE-LF                      PIC X.
  6842     12  AM-REI-PE-AH                      PIC X.
  6843     12  AM-REI-PRT-ST                     PIC X.
  6844     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6845     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6846     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6847     12  AM-REI-GROUP-A                    PIC X(6).
  6848     12  AM-REI-MORT                       PIC X(4).
  6849     12  AM-REI-PRT-OW                     PIC X.
  6850     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6851     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6852     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6853     12  AM-REI-GROUP-B                    PIC X(6).
  6854
  6855     12  AM-TRUST-TYPE                     PIC X(2).
  6856
  6857     12  AM-EMPLOYER-STMT-USED             PIC X.
  6858     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6859
  6860     12  AM-STD-AH-TYPE                    PIC XX.
  6861     12  AM-EARN-METHODS.
  6862         16  AM-EARN-METHOD-R              PIC X.
  6863             88 AM-REF-RL-R78                 VALUE 'R'.
  6864             88 AM-REF-RL-PR                  VALUE 'P'.
  6865             88 AM-REF-RL-MEAN                VALUE 'M'.
  6866             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6867         16  AM-EARN-METHOD-L              PIC X.
  6868             88 AM-REF-LL-R78                 VALUE 'R'.
  6869             88 AM-REF-LL-PR                  VALUE 'P'.
  6870             88 AM-REF-LL-MEAN                VALUE 'M'.
  6871             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6872         16  AM-EARN-METHOD-A              PIC X.
  6873             88 AM-REF-AH-R78                 VALUE 'R'.
  6874             88 AM-REF-AH-PR                  VALUE 'P'.
  6875             88 AM-REF-AH-MEAN                VALUE 'M'.
  6876             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6877             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6878             88 AM-REF-AH-NET                 VALUE 'N'.
  6879
  6880     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6881     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6882     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6883
  6884     12  AM-RET-Y-N                        PIC X.
  6885     12  AM-RET-P-E                        PIC X.
  6886     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6887     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6888     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 131
* EL156.cbl
  6889     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6890         16  AM-POOL-PRIME                 PIC XXX.
  6891         16  AM-POOL-SUB                   PIC XXX.
  6892     12  AM-RETRO-EARNINGS.
  6893         16  AM-RET-EARN-R                 PIC X.
  6894         16  AM-RET-EARN-L                 PIC X.
  6895         16  AM-RET-EARN-A                 PIC X.
  6896     12  AM-RET-ST-TAX-USE                 PIC X.
  6897         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6898         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6899     12  AM-RETRO-BEG-EARNINGS.
  6900         16  AM-RET-BEG-EARN-R             PIC X.
  6901         16  AM-RET-BEG-EARN-L             PIC X.
  6902         16  AM-RET-BEG-EARN-A             PIC X.
  6903     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6904     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6905
  6906     12  AM-USER-SELECT-OPTIONS.
  6907         16  AM-USER-SELECT-1              PIC X(10).
  6908         16  AM-USER-SELECT-2              PIC X(10).
  6909         16  AM-USER-SELECT-3              PIC X(10).
  6910         16  AM-USER-SELECT-4              PIC X(10).
  6911         16  AM-USER-SELECT-5              PIC X(10).
  6912
  6913     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6914
  6915     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6916
  6917     12  AM-RPT045A-SWITCH                 PIC X.
  6918         88  RPT045A-OFF                   VALUE 'N'.
  6919
  6920     12  AM-INSURANCE-LIMITS.
  6921         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6922         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6923
  6924     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6925         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6926
  6927     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6928         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6929         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6930
  6931     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6932
  6933     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6934     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6935     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6936     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6937     12  AM-DCC-UEF-STATE                  PIC XX.
  6938     12  FILLER                            PIC XXX.
  6939     12  AM-REPORT-CODE-3                  PIC X(10).
  6940*    12  FILLER                            PIC X(22).
  6941
  6942     12  AM-RESERVE-DATE.
  6943         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6944         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6945         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6946
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 132
* EL156.cbl
  6947     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6948     12  AM-NOTIFICATION-TYPES.
  6949         16  AM-NOTIF-OF-LETTERS           PIC X.
  6950         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6951         16  AM-NOTIF-OF-REPORTS           PIC X.
  6952         16  AM-NOTIF-OF-STATUS            PIC X.
  6953
  6954     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6955         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6956         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6957         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6958         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6959
  6960     12  AM-BENEFIT-CONTROLS.
  6961         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6962             20  AM-BENEFIT-CODE           PIC XX.
  6963             20  AM-BENEFIT-TYPE           PIC X.
  6964             20  AM-BENEFIT-REVISION       PIC XXX.
  6965             20  AM-BENEFIT-REM-TERM       PIC X.
  6966             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6967             20  FILLER                    PIC XX.
  6968         16  FILLER                        PIC X(80).
  6969
  6970     12  AM-TRANSFER-DATA.
  6971         16  AM-TRANSFERRED-FROM.
  6972             20  AM-TRNFROM-CARRIER        PIC X.
  6973             20  AM-TRNFROM-GROUPING.
  6974                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6975                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6976             20  AM-TRNFROM-STATE          PIC XX.
  6977             20  AM-TRNFROM-ACCOUNT.
  6978                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6979                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6980             20  AM-TRNFROM-DTE            PIC XX.
  6981         16  AM-TRANSFERRED-TO.
  6982             20  AM-TRNTO-CARRIER          PIC X.
  6983             20  AM-TRNTO-GROUPING.
  6984                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6985                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6986             20  AM-TRNTO-STATE            PIC XX.
  6987             20  AM-TRNTO-ACCOUNT.
  6988                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6989                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6990             20  AM-TRNTO-DTE              PIC XX.
  6991         16  FILLER                        PIC X(10).
  6992
  6993     12  AM-SAVED-REMIT-TO                 PIC 99.
  6994
  6995     12  AM-COMM-STRUCTURE-SAVED.
  6996         16  AM-DEFN-1-SAVED.
  6997             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6998                 24  AM-AGT-SV             PIC X(10).
  6999                 24  AM-COM-TYP-SV         PIC X.
  7000                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7001                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7002                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7003                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7004                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 133
* EL156.cbl
  7005                 24  AM-GL-CODES-SV        PIC X.
  7006                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7007                 24  FILLER                PIC X.
  7008         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7009             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7010                 24  FILLER                PIC X(11).
  7011                 24  AM-L-COMA-SV          PIC XXX.
  7012                 24  AM-J-COMA-SV          PIC XXX.
  7013                 24  AM-A-COMA-SV          PIC XXX.
  7014                 24  FILLER                PIC X(6).
  7015
  7016     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7017         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7018            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7019            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7020            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7021
  7022     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7023     12  FILLER                            PIC X(120).
  7024
  7025     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7026         16  AM-CONTROL-NAME               PIC X(30).
  7027         16  AM-EXECUTIVE-ONE.
  7028             20  AM-EXEC1-NAME             PIC X(15).
  7029             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7030                                                          COMP-3.
  7031             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7032                                                          COMP-3.
  7033         16  AM-EXECUTIVE-TWO.
  7034             20  AM-EXEC2-NAME             PIC X(15).
  7035             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7036                                                          COMP-3.
  7037             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7038                                                          COMP-3.
  7039
  7040     12  AM-RETRO-ADDITIONAL-DATA.
  7041         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7042         16  AM-RETRO-PREM-P-E             PIC X.
  7043         16  AM-RETRO-CLMS-P-I             PIC X.
  7044         16  AM-RETRO-RET-BRACKET-LF.
  7045             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7046                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7047                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7048             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7049                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7050                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7051             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7052                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7053                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7054         16  AM-RETRO-RET-BRACKET-AH.
  7055             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7056                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7057                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7058                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7059             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7060                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7061                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7062             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 134
* EL156.cbl
  7063                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7064                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7065
  7066     12  AM-COMMENTS.
  7067         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7068
  7069     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7070         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7071         16  AM-FLI-BILLING-CODE           PIC X.
  7072         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7073         16  AM-FLI-UNITED-IDENT           PIC X.
  7074         16  AM-FLI-INTEREST-LOST-DATA.
  7075             20  AM-FLI-BANK-NO            PIC X(5).
  7076             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7077             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7078             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7079         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7080             20  AM-FLI-AGT                PIC X(9).
  7081             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7082             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7083         16  FILLER                        PIC X(102).
  7084
  7085     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7086         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7087             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7088             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7089             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7090             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7091             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7092         16  FILLER                          PIC X(10).
  7093******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 135
* EL156.cbl
  7095*    COPY ELCCHKQ.
  7096******************************************************************
  7097*                                                                *
  7098*                                                                *
  7099*                            ELCCHKQ.                            *
  7100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7101*                            VMOD=2.007                          *
  7102*                                                                *
  7103*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7104*                                                                *
  7105*   FILE TYPE = VSAM,KSDS                                        *
  7106*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7107*                                                                *
  7108*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7109*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7110*                                                                *
  7111*   LOG = YES                                                    *
  7112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7113******************************************************************
  7114 01  CHECK-QUE.
  7115     12  CQ-RECORD-ID                PIC XX.
  7116         88  VALID-CQ-ID         VALUE 'CQ'.
  7117
  7118     12  CQ-CONTROL-PRIMARY.
  7119         16  CQ-COMPANY-CD           PIC X.
  7120         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7121         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7122
  7123     12  CQ-CONTROL-BY-PAYEE.
  7124         16  CQ-CONTROL-BY-NUMBER.
  7125             20  CQ-COMPANY-CD-A1     PIC X.
  7126             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7127         16  CQ-PAYEE-CARRIER        PIC X.
  7128         16  CQ-PAYEE-GROUPING       PIC X(6).
  7129         16  CQ-PAYEE-STATE          PIC XX.
  7130         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7131         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7132
  7133     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7134         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7135         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7136         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7137         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7138         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7139         16  FILLER                  PIC X(3).
  7140
  7141     12  CQ-ENTRY-TYPE               PIC X.
  7142             88  CHECK-ON-QUE           VALUE 'Q'.
  7143             88  ALIGNMENT-CHECK        VALUE 'A'.
  7144             88  SPOILED-CHECK          VALUE 'S'.
  7145             88  PAYMENT-ABORTED        VALUE 'X'.
  7146
  7147     12  CQ-CLAIM-MAST-CNTL.
  7148         16  CQ-CARRIER              PIC X.
  7149         16  CQ-CLAIM-NO             PIC X(7).
  7150         16  CQ-CERT-NO.
  7151             20  CQ-CERT-PRIME       PIC X(10).
  7152             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 136
* EL156.cbl
  7153         16  CQ-CLAIM-TYPE           PIC X.
  7154             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7155             88  CQ-AH-CLAIM            VALUE 'A'.
  7156         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7157             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7158             88  CQ-O-B-COVERAGE        VALUE '2'.
  7159             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7160
  7161     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7162     12  CQ-CHECK-NUMBER             PIC X(7).
  7163     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7164     12  CQ-PAYMENT-TYPE             PIC X.
  7165             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7166             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7167             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7168             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7169             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7170             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7171             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7172             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7173     12  CQ-VOID-INDICATOR           PIC X.
  7174             88  CHECK-IS-STOPPED          VALUE 'S'.
  7175             88  CHECK-IS-VOID             VALUE 'V'.
  7176     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7177     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7178     12  CQ-CHECK-BY-USER            PIC X(4).
  7179     12  CQ-PRE-NUMBERING-SW         PIC X.
  7180       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7181       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7182
  7183     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7184     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7185     12  CQ-LEDGER-FLAG              PIC X(01).
  7186     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7187     12  CQ-LAST-UPDATED-DT          PIC XX.
  7188     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7189     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7190
  7191     12  FILLER                      PIC X(04).
  7192
  7193******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 137
* EL156.cbl
  7195*    COPY ELCBENE.
  7196******************************************************************
  7197*                                                                *
  7198*                            ELCBENE.                            *
  7199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7200*                            VMOD=2.006                          *
  7201*                                                                *
  7202*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7203*                                                                *
  7204*   FILE TYPE = VSAM,KSDS                                        *
  7205*   RECORD SIZE = 500   RECFORM = FIX                            *
  7206*                                                                *
  7207*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7208*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7209*                                                                *
  7210*   LOG = YES                                                    *
  7211*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7212*                                                                *
  7213*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7214******************************************************************
  7215*                   C H A N G E   L O G
  7216*
  7217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7218*-----------------------------------------------------------------
  7219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7220* EFFECTIVE    NUMBER
  7221*-----------------------------------------------------------------
  7222* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7223* 082317  CR2017082100003  PEMA  Add sub type
  7224******************************************************************
  7225
  7226 01  BENEFICIARY-MASTER.
  7227     12  BE-RECORD-ID                PIC XX.
  7228         88  VALID-BE-ID                VALUE 'BE'.
  7229
  7230     12  BE-CONTROL-PRIMARY.
  7231         16  BE-COMPANY-CD           PIC X.
  7232         16  BE-RECORD-TYPE          PIC X.
  7233             88  BENEFICIARY-RECORD  VALUE 'B'.
  7234             88  ADJUSTOR-RECORD     VALUE 'A'.
  7235         16  BE-BENEFICIARY          PIC X(10).
  7236     12  BE-CONTROL-BY-NAME.
  7237         16  BE-COMPANY-CD-A1        PIC X.
  7238         16  BE-RECORD-TYPE-A1       PIC X.
  7239         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7240         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7241
  7242     12  BE-LAST-MAINT-DT            PIC XX.
  7243     12  BE-LAST-MAINT-BY            PIC X(4).
  7244     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7245
  7246     12  BE-ADDRESS-DATA.
  7247         16  BE-MAIL-TO-NAME         PIC X(30).
  7248         16  BE-ADDRESS-LINE-1       PIC X(30).
  7249         16  BE-ADDRESS-LINE-2       PIC X(30).
  7250         16  BE-ADDRESS-LINE-3       PIC X(30).
  7251         16  BE-CITY-STATE.
  7252             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 138
* EL156.cbl
  7253             20  BE-STATE            PIC XX.
  7254         16  BE-ZIP-CODE.
  7255             20  BE-ZIP-PRIME.
  7256                 24  BE-ZIP-1ST      PIC X.
  7257                     88  BE-CANADIAN-POST-CODE
  7258                                         VALUE 'A' THRU 'Z'.
  7259                 24  FILLER          PIC X(4).
  7260             20  BE-ZIP-PLUS4        PIC X(4).
  7261         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7262             20  BE-CAN-POSTAL-1     PIC XXX.
  7263             20  BE-CAN-POSTAL-2     PIC XXX.
  7264             20  FILLER              PIC XXX.
  7265         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7266         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7267
  7268******************************************************************
  7269*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7270*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7271******************************************************************
  7272     12  BE-CARRIER                  PIC X.
  7273
  7274     12  BE-ADDRESS-DATA2.
  7275         16  BE-MAIL-TO-NAME2        PIC X(30).
  7276         16  BE-ADDRESS-LINE-12      PIC X(30).
  7277         16  BE-ADDRESS-LINE-22      PIC X(30).
  7278         16  BE-ADDRESS-LINE-32      PIC X(30).
  7279         16  BE-CITY-STATE2.
  7280             20  BE-CITY2            PIC X(28).
  7281             20  BE-STATE2           PIC XX.
  7282         16  BE-ZIP-CODE2.
  7283             20  BE-ZIP-PRIME2.
  7284                 24  BE-ZIP-1ST2     PIC X.
  7285                     88  BE-CANADIAN-POST-CODE2
  7286                                         VALUE 'A' THRU 'Z'.
  7287                 24  FILLER          PIC X(4).
  7288             20  BE-ZIP-PLUS42       PIC X(4).
  7289         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7290             20  BE-CAN-POSTAL-12    PIC XXX.
  7291             20  BE-CAN-POSTAL-22    PIC XXX.
  7292             20  FILLER              PIC XXX.
  7293         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7294         16  BE-ACH-DATA.
  7295             20  BE-ACH-YES-OR-NO    PIC X.
  7296                 88  BE-ON-ACH       VALUE 'Y'.
  7297                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7298             20  BE-ACH-ABA-ROUTING-NUMBER
  7299                                     PIC X(15).
  7300             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7301                                     PIC X(20).
  7302             20  BE-ACH-SUB-TYPE     PIC XX.
  7303             20  FILLER              PIC X(23).
  7304         16  BE-BILLING-STMT-DATA.
  7305*            20  BE-BSR              PIC X.
  7306*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7307*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7308*            20  BE-BSR-FROM         PIC X(30).
  7309*            20  BE-BSR-DEPT         PIC X(30).
  7310             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 139
* EL156.cbl
  7311             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7312             20  BE-OUTPUT-TYPE      PIC X.
  7313                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7314                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7315
  7316     12  FILLER                      PIC X(28).
  7317******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 140
* EL156.cbl
  7319*    COPY ELCARCH.
  7320******************************************************************
  7321*                                                                *
  7322*                            ELCARCH.                            *
  7323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7324*                            VMOD=2.007                          *
  7325*                                                                *
  7326*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7327*                                                                *
  7328*   FILE TYPE = VSAM,KSDS                                        *
  7329*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7330*                                                                *
  7331*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7332*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7333*                                                                *
  7334*   LOG = NO                                                     *
  7335*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7336*                                                                *
  7337*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7338******************************************************************
  7339 01  LETTER-ARCHIVE.
  7340     12  LA-RECORD-ID                PIC XX.
  7341         88  VALID-LA-ID                VALUE 'LA'.
  7342
  7343     12  LA-CONTROL-PRIMARY.
  7344         16  LA-COMPANY-CD           PIC X.
  7345         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7346         16  LA-RECORD-TYPE          PIC X.
  7347             88  LA-HEADER-DATA         VALUE '1'.
  7348             88  LA-ADDRESS-DATA        VALUE '2'.
  7349             88  LA-TEXT-DATA           VALUE '3'.
  7350             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7351         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7352
  7353     12  LA-CONTROL-BY-TYPE.
  7354         16  LA-COMPANY-CD-A1        PIC X.
  7355         16  LA-RECORD-TYPE-A1       PIC X.
  7356         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7357         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7358
  7359     12  LA-TEXT-RECORD.
  7360         16  LA-SKIP-CONTROL         PIC XX.
  7361             88  NO-LINES-SKIPPED       VALUE SPACES.
  7362             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7363         16  LA-TEXT-LINE            PIC X(70).
  7364
  7365     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7366         16  FILLER                  PIC XX.
  7367         16  LA-ADDRESS-LINE         PIC X(30).
  7368         16  FILLER                  PIC X(40).
  7369
  7370     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7371         16  FILLER                  PIC XX.
  7372         16  LA-CARRIER              PIC X.
  7373         16  LA-CLAIM-NO             PIC X(7).
  7374         16  LA-CERT-NO.
  7375             20  LA-CERT-PRIME       PIC X(10).
  7376             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 141
* EL156.cbl
  7377         16  LA-NO-OF-COPIES         PIC S9.
  7378         16  LA-RESEND-DATE          PIC XX.
  7379         16  LA-PROCESSOR-CD         PIC X(4).
  7380         16  LA-CREATION-DT          PIC XX.
  7381         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7382         16  LA-RESEND-PRINT-DATE    PIC XX.
  7383         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7384         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7385*
  7386* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7387*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7388*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7389*   I        20  LA-DMD-RES-ST           PIC XX.
  7390*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7391*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7392*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7393*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7394*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7395*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7396*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7397*   I        20  LA-DMD-UND-CODE         PIC XX.
  7398*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7399*   V    16  FILLER                  PIC X(15).
  7400* -----
  7401*
  7402* REINSERTED  CSO  MODS
  7403*
  7404         16  FILLER.
  7405             20  FILLER                  PIC X(29).
  7406             20  LA-CSO-LETTER-STATUS    PIC X.
  7407                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7408                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7409                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7410             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7411             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7412*
  7413
  7414     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7415         16  FILLER                  PIC XX.
  7416         16  LA4-CARRIER             PIC X.
  7417         16  LA4-CLAIM-NO            PIC X(7).
  7418         16  LA4-CERT-NO.
  7419             20  LA4-CERT-PRIME      PIC X(10).
  7420             20  LA4-CERT-SFX        PIC X.
  7421         16  LA4-NO-OF-COPIES        PIC S9.
  7422         16  LA4-RESEND-DATE         PIC XX.
  7423         16  LA4-PROCESSOR-CD        PIC X(4).
  7424         16  LA4-CREATION-DT         PIC XX.
  7425         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7426         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7427         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7428         16  LA4-FORM-TYPE           PIC X.
  7429             88  LA4-INITIAL-FORM    VALUE '1'.
  7430             88  LA4-PROGRESS-FORM   VALUE '2'.
  7431         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7432         16  LA4-STATE               PIC X(02).
  7433         16  FILLER                  PIC X(31).
  7434******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 142
* EL156.cbl
  7436*    COPY ELCDAR.
  7437******************************************************************
  7438*                                                                *
  7439*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7440*   FILE TYPE = VSAM,KSDS                                        *
  7441*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7442*   BASE CLUSTER = DLYACTV                                       *
  7443*   LOG = YES                                                    *
  7444*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7445*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7446*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7447*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7448*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7449*               BY PROGRAM "LGINFCE".                            *
  7450*                                                                *
  7451******************************************************************
  7452 01  DAILY-ACTIVITY-RECORD.
  7453     05  DA-KEY.
  7454         10  DA-COMP-CD          PIC X.
  7455         10  DA-CARRIER          PIC X.
  7456         10  DA-CLAIM-NO         PIC X(7).
  7457         10  DA-CERT-NO.
  7458             15  DA-CERT-PRIME   PIC X(10).
  7459             15  DA-CERT-SFX     PIC X.
  7460     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7461     05  DA-RECORD-TYPE          PIC X.
  7462     05  FILLER                  PIC X(2).
  7463******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 143
* EL156.cbl
  7465*    COPY ERCCOMP.
  7466******************************************************************
  7467*                                                                *
  7468*                                                                *
  7469*                            ERCCOMP                             *
  7470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7471*                            VMOD=2.019                          *
  7472*                                                                *
  7473*   ONLINE CREDIT SYSTEM                                         *
  7474*                                                                *
  7475*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7476*                                                                *
  7477*   FILE TYPE = VSAM,KSDS                                        *
  7478*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7479*                                                                *
  7480*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7481*       ALTERNATE PATH = NONE                                    *
  7482*                                                                *
  7483*   LOG = NO                                                     *
  7484*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7485*                                                                *
  7486******************************************************************
  7487*                   C H A N G E   L O G
  7488*
  7489* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7490*-----------------------------------------------------------------
  7491*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7492* EFFECTIVE    NUMBER
  7493*-----------------------------------------------------------------
  7494* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7495* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7496* 092205    2005050300006  PEMA  ADD LEASE FEE
  7497* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7498* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7499* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7500* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7501* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7502* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7503******************************************************************
  7504
  7505 01  COMPENSATION-MASTER.
  7506     12  CO-RECORD-ID                          PIC XX.
  7507         88  VALID-CO-ID                          VALUE 'CO'.
  7508
  7509     12  CO-CONTROL-PRIMARY.
  7510         16  CO-COMPANY-CD                     PIC X.
  7511         16  CO-CONTROL.
  7512             20  CO-CTL-1.
  7513                 24  CO-CARR-GROUP.
  7514                     28  CO-CARRIER            PIC X.
  7515                     28  CO-GROUPING.
  7516                         32  CO-GROUP-PREFIX   PIC XXX.
  7517                         32  CO-GROUP-PRIME    PIC XXX.
  7518                 24  CO-RESP-NO.
  7519                     28  CO-RESP-PREFIX        PIC X(4).
  7520                     28  CO-RESP-PRIME         PIC X(6).
  7521             20  CO-CTL-2.
  7522                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 144
* EL156.cbl
  7523                     28  CO-ACCT-PREFIX        PIC X(4).
  7524                     28  CO-ACCT-PRIME         PIC X(6).
  7525         16  CO-TYPE                           PIC X.
  7526             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7527             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7528             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7529
  7530     12  CO-MAINT-INFORMATION.
  7531         16  CO-LAST-MAINT-DT                  PIC XX.
  7532         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7533         16  CO-LAST-MAINT-USER                PIC X(4).
  7534     12  FILLER                                PIC XX.
  7535     12  CO-STMT-TYPE                          PIC XXX.
  7536     12  CO-COMP-TYPE                          PIC X.
  7537         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7538     12  CO-STMT-OWNER                         PIC X(4).
  7539     12  CO-BALANCE-CONTROL                    PIC X.
  7540         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7541         88  CO-NO-BALANCE                        VALUE 'N'.
  7542
  7543     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7544         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7545         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7546         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7547
  7548     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7549         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7550         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7551
  7552     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7553     12  CO-GA-DIRECT-DEP                      PIC X.
  7554     12  CO-FUTURE-SPACE                       PIC X.
  7555         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7556
  7557     12  CO-ACCT-NAME                          PIC X(30).
  7558     12  CO-MAIL-NAME                          PIC X(30).
  7559     12  CO-ADDR-1                             PIC X(30).
  7560     12  CO-ADDR-2                             PIC X(30).
  7561     12  CO-ADDR-3.
  7562         16  CO-ADDR-CITY                      PIC X(27).
  7563         16  CO-ADDR-STATE                     PIC XX.
  7564     12  CO-CSO-1099                           PIC X.
  7565     12  CO-ZIP.
  7566         16  CO-ZIP-PRIME.
  7567             20  CO-ZIP-PRI-1ST                PIC X.
  7568                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7569             20  FILLER                        PIC X(4).
  7570         16  CO-ZIP-PLUS4                      PIC X(4).
  7571     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7572         16  CO-CAN-POSTAL-1                   PIC XXX.
  7573         16  CO-CAN-POSTAL-2                   PIC XXX.
  7574         16  FILLER                            PIC XXX.
  7575     12  CO-SOC-SEC                            PIC X(13).
  7576     12  CO-TELEPHONE.
  7577         16  CO-AREA-CODE                      PIC XXX.
  7578         16  CO-PREFIX                         PIC XXX.
  7579         16  CO-PHONE                          PIC X(4).
  7580
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 145
* EL156.cbl
  7581     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7582
  7583     12  CO-AR-BAL-LEVEL                       PIC X.
  7584         88  CO-AR-REF-LVL                        VALUE '1'.
  7585         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7586         88  CO-AR-BILL-LVL                       VALUE '2'.
  7587         88  CO-AR-AGT-LVL                        VALUE '3'.
  7588         88  CO-AR-FR-LVL                         VALUE '4'.
  7589
  7590     12  CO-AR-NORMAL-PRINT                    PIC X.
  7591         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7592         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7593
  7594     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7595
  7596     12  CO-AR-REPORTING                       PIC X.
  7597         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7598         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7599
  7600     12  CO-AR-PULL-CHECK                      PIC X.
  7601         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7602         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7603
  7604     12  CO-AR-BALANCE-PRINT                   PIC X.
  7605         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7606
  7607     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7608         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7609         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7610         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7611
  7612     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7613
  7614     12  CO-USER-CODE                          PIC X.
  7615     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7616
  7617******************************************************************
  7618*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7619*    THE LAST MONTH END RUN.
  7620******************************************************************
  7621
  7622     12  CO-LAST-ACTIVITY-DATE.
  7623         16  CO-ACT-YEAR                       PIC 99.
  7624         16  CO-ACT-MONTH                      PIC 99.
  7625         16  CO-ACT-DAY                        PIC 99.
  7626
  7627     12  CO-LAST-STMT-DT.
  7628         16  CO-LAST-STMT-YEAR                 PIC 99.
  7629         16  CO-LAST-STMT-MONTH                PIC 99.
  7630         16  CO-LAST-STMT-DAY                  PIC 99.
  7631
  7632     12  CO-MO-END-TOTALS.
  7633         16  CO-MONTHLY-TOTALS.
  7634             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7635             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7636             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7637             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7638             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 146
* EL156.cbl
  7639
  7640         16  CO-AGING-TOTALS.
  7641             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7642             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7643             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7644             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7645
  7646         16  CO-YTD-TOTALS.
  7647             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7648             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7649
  7650         16  CO-OVER-UNDER-TOTALS.
  7651             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7652             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7653
  7654     12  CO-MISCELLANEOUS-TOTALS.
  7655         16  CO-FICA-TOTALS.
  7656             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7657             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7658
  7659         16  CO-CLAIM-TOTALS.
  7660             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7661             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7662
  7663******************************************************************
  7664*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7665*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7666******************************************************************
  7667
  7668     12  CO-CURRENT-TOTALS.
  7669         16  CO-CURRENT-LAST-STMT-DT.
  7670             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7671             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7672             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7673
  7674         16  CO-CURRENT-MONTHLY-TOTALS.
  7675             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7676             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7677             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7678             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7679             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7680
  7681         16  CO-CURRENT-AGING-TOTALS.
  7682             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7683             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7684             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7685             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7686
  7687         16  CO-CURRENT-YTD-TOTALS.
  7688             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7689             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7690
  7691     12  CO-PAID-COMM-TOTALS.
  7692         16  CO-YTD-PAID-COMMS.
  7693             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7694             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7695
  7696     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 147
* EL156.cbl
  7697         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7698         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7699
  7700     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7701         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7702         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7703         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7704         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7705         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7706         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7707         88  CO-FINAL-LETTER                  VALUE 'F'.
  7708         88  CO-RECONCILING                   VALUE 'R'.
  7709         88  CO-PHONE-CALL                    VALUE 'P'.
  7710         88  CO-LEGAL                         VALUE 'L'.
  7711         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7712         88  CO-WRITE-OFF                     VALUE 'W'.
  7713         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7714
  7715     12  CO-CSR-CODE                       PIC X(4).
  7716
  7717     12  CO-GA-STATUS-INFO.
  7718         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7719         16  CO-GA-TERMINATION-DT          PIC XX.
  7720         16  CO-GA-STATUS-CODE             PIC X.
  7721             88  CO-GA-ACTIVE                 VALUE 'A'.
  7722             88  CO-GA-INACTIVE               VALUE 'I'.
  7723             88  CO-GA-PENDING                VALUE 'P'.
  7724         16  CO-GA-COMMENTS.
  7725             20  CO-GA-COMMENT-1           PIC X(40).
  7726             20  CO-GA-COMMENT-2           PIC X(40).
  7727             20  CO-GA-COMMENT-3           PIC X(40).
  7728             20  CO-GA-COMMENT-4           PIC X(40).
  7729
  7730     12  CO-RPTCD2                         PIC X(10).
  7731     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7732         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7733         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7734
  7735     12  CO-TYPE-AGENT                     PIC X(01).
  7736         88  CO-CORPORATION                   VALUE 'C'.
  7737         88  CO-PARTNERSHIP                   VALUE 'P'.
  7738         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7739         88  CO-TRUST                         VALUE 'T'.
  7740         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7741
  7742     12  CO-FAXNO.
  7743         16  CO-FAX-AREA-CODE                  PIC XXX.
  7744         16  CO-FAX-PREFIX                     PIC XXX.
  7745         16  CO-FAX-PHONE                      PIC X(4).
  7746
  7747     12  CO-BANK-INFORMATION.
  7748         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7749         16  CO-BANK-TRANSIT-NON REDEFINES
  7750             CO-BANK-TRANSIT-NO                PIC 9(8).
  7751
  7752         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7753     12  CO-MISC-DEDUCT-INFO REDEFINES
  7754                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 148
* EL156.cbl
  7755         16  CO-MD-GL-ACCT                     PIC X(10).
  7756         16  CO-MD-DIV                         PIC XX.
  7757         16  CO-MD-CENTER                      PIC X(4).
  7758         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7759         16  CO-CREATE-AP-CHECK                PIC X.
  7760         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7761         16  FILLER                            PIC XXX.
  7762     12  CO-ACH-STATUS                         PIC X.
  7763         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7764         88  CO-ACH-PENDING                        VALUE 'P'.
  7765
  7766     12  CO-BILL-SW                            PIC X.
  7767     12  CO-CONTROL-NAME                       PIC X(30).
  7768     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7769     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7770     12  CO-CLP-STATE                          PIC XX.
  7771     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7772     12  CO-SPP-REFUND-EDIT                    PIC X.
  7773
  7774******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 149
* EL156.cbl
  7776*    COPY ERCDMDNT.
  7777******************************************************************
  7778*                                                                *
  7779*                            ERCDMDNT                            *
  7780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7781*                            VMOD=2.005                          *
  7782*                                                                *
  7783*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7784*                                                                *
  7785*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7786*                                                                *
  7787*        FILE TYPE= VSAM,KSDS                                    *
  7788*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7789*                                                                *
  7790*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7791*                                                                *
  7792*        LOG = YES                                               *
  7793*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7794*                                                                *
  7795******************************************************************
  7796
  7797 01  CERTIFICATE-NOTE.
  7798     12  CN-RECORD-ID                     PIC  XX.
  7799         88  VALID-CN-ID                      VALUE 'CN'.
  7800
  7801     12  CN-CONTROL-PRIMARY.
  7802         16  CN-COMPANY-CD                PIC X.
  7803         16  CN-CERT-KEY.
  7804             20  CN-CARRIER               PIC X.
  7805             20  CN-GROUPING.
  7806                 24  CN-GROUPING-PREFIX   PIC XXX.
  7807                 24  CN-GROUPING-PRIME    PIC XXX.
  7808             20  CN-STATE                 PIC XX.
  7809             20  CN-ACCOUNT.
  7810                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7811                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7812             20  CN-CERT-EFF-DT           PIC XX.
  7813             20  CN-CERT-NO.
  7814                 24  CN-CERT-PRIME        PIC X(10).
  7815                 24  CN-CERT-SFX          PIC X.
  7816
  7817     12  CN-BILLING-START-LINE-NO         PIC 99.
  7818     12  CN-BILLING-END-LINE-NO           PIC 99.
  7819
  7820     12  CN-LINES.
  7821         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7822
  7823     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7824         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7825         16  CN-CSI-GENERAL-DATA-AREA.
  7826             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7827
  7828         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7829             CN-CSI-GENERAL-DATA-AREA.
  7830             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7831             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7832             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7833             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 150
* EL156.cbl
  7834             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7835             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7836             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7837             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7838             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7839             20  FILLER                       PIC XX.
  7840             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7841             20  FILLER                       PIC X(38).
  7842
  7843         16  CN-CSI-PRODUCT-DATA-AREA.
  7844             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7845
  7846         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7847             CN-CSI-PRODUCT-DATA-AREA.
  7848             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7849             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7850             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7851             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7852             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7853             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7854             20  FILLER                   PIC XX.
  7855             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7856             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7857             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7858             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7859             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7860             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7861             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7862             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7863             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7864             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7865             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7866             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7867             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7868             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7869             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7870             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7871             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7872             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7873             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7874             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7875             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7876             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7877             20  FILLER                   PIC X(25).
  7878
  7879         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7880             CN-CSI-CREDIT-CARD-DATA.
  7881             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7882             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7883             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7884             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7885             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7886             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7887             20  FILLER                   PIC XX.
  7888             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7889             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7890             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7891             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 151
* EL156.cbl
  7892             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7893             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7894             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7895             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7896             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7897             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7898             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7899             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7900             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7901             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7902             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7903             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7904             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7905             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7906             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7907             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7908             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7909             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7910             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7911             20  FILLER                   PIC X(17).
  7912
  7913         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7914             CN-CSI-FAMILY-LEAVE-DATA.
  7915             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7916             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7917             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7918             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7919             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7920             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7921             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7922             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7923             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7924             20  CN-CSI-SL-INT-ON-PROCEEDS
  7925                                          PIC S9(5)V99  COMP-3.
  7926             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7927             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7928             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7929             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7930             20  CN-CSI-SL-POLICY-BENEFITS
  7931                                          PIC S9(5)V99  COMP-3.
  7932             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7933             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7934             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7935             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7936             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7937             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7938             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7939             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7940             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7941             20  CN-CSI-SL-STATE-NOT      PIC X.
  7942             20  FILLER                   PIC XX.
  7943
  7944         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7945             CN-CSI-SENIOR-LIFE-DATA.
  7946             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7947             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7948             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7949                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 152
* EL156.cbl
  7950             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7951             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7952             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7953             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7954             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7955             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7956             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7957             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7958             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7959             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7960             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7961             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7962             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7963             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7964             20  CN-CSI-PP-REPAIR         PIC X.
  7965             20  CN-CSI-PP-REPLACE        PIC X.
  7966             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7967             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7968             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7969             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7970             20  FILLER                   PIC X(5).
  7971
  7972         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7973             CN-CSI-PURCH-PROP-DATA.
  7974             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7975             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7976             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7977             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7978             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7979             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7980             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7981             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7982             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7983             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7984             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7985             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7986             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7987             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7988             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7989             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7990             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7991             20  CN-CSI-EW-REPLACE        PIC X.
  7992             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7993             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7994             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7995             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7996             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7997             20  FILLER                   PIC X(4).
  7998
  7999     12  CN-LAST-MAINT-DT                 PIC XX.
  8000     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  8001     12  CN-LAST-MAINT-USER               PIC X(4).
  8002     12  FILLER                           PIC X(6).
  8003
  8004******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 153
* EL156.cbl
  8006*    COPY ERCCNOT.
  8007******************************************************************
  8008*                                                                *
  8009*                            ERCCNOT                             *
  8010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8011*                            VMOD=2.003                          *
  8012*                                                                *
  8013*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  8014*                                                                *
  8015*        FILE TYPE= VSAM,KSDS                                    *
  8016*        RECORD SIZE = 150    RECFORM = FIXED                    *
  8017*                                                                *
  8018*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  8019*                                                                *
  8020*        LOG = YES                                               *
  8021*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8022*                                                                *
  8023******************************************************************
  8024*                   C H A N G E   L O G
  8025*
  8026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8027*-----------------------------------------------------------------
  8028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8029* EFFECTIVE    NUMBER
  8030*-----------------------------------------------------------------
  8031* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8032******************************************************************
  8033
  8034 01  CERT-NOTE-FILE.
  8035     12  CZ-RECORD-ID                PIC  XX.
  8036         88  VALID-CZ-ID                  VALUE 'CZ'.
  8037
  8038     12  CZ-CONTROL-PRIMARY.
  8039         16  CZ-COMPANY-CD           PIC X.
  8040         16  CZ-CARRIER              PIC X.
  8041         16  CZ-GROUPING.
  8042             20 CZ-GROUPING-PREFIX   PIC XXX.
  8043             20 CZ-GROUPING-PRIME    PIC XXX.
  8044         16  CZ-STATE                PIC XX.
  8045         16  CZ-ACCOUNT.
  8046             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8047             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8048         16  CZ-CERT-EFF-DT          PIC XX.
  8049         16  CZ-CERT-NO.
  8050             20  CZ-CERT-PRIME       PIC X(10).
  8051             20  CZ-CERT-SFX         PIC X.
  8052         16  CZ-RECORD-TYPE          PIC X.
  8053             88  CERT-NOTE           VALUE '1'.
  8054             88  CLAIM-CERT-NOTE     VALUE '2'.
  8055         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8056
  8057     12  CZ-LAST-MAINT-DT            PIC XX.
  8058     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8059     12  CZ-LAST-MAINT-USER          PIC X(4).
  8060
  8061     12  CZ-NOTE-INFORMATION.
  8062         16  CZ-NOTE                 PIC X(63).
  8063         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 154
* EL156.cbl
  8064******************************************************************
  8065*                            COPY ERCPDEF.
  8066******************************************************************
  8067*                                                                *
  8068*                                                                *
  8069*                            ERCPDEF.                            *
  8070*                                                                *
  8071*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8072*                                                                *
  8073*    FILE TYPE = VSAM,KSDS                                       *
  8074*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8075*                                                                *
  8076*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8077*                                                                *
  8078*    LOG = YES                                                   *
  8079*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8080******************************************************************
  8081*                   C H A N G E   L O G
  8082*
  8083* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8084*-----------------------------------------------------------------
  8085*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8086* EFFECTIVE    NUMBER
  8087*-----------------------------------------------------------------
  8088* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8089* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8090* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8091* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8092******************************************************************
  8093 01  PRODUCT-MASTER.
  8094    12  PD-RECORD-ID                 PIC X(02).
  8095        88  VALID-PD-ID                  VALUE 'PD'.
  8096    12  PD-CONTROL-PRIMARY.
  8097        16  PD-COMPANY-CD            PIC X.
  8098        16  PD-STATE                 PIC XX.
  8099        16  PD-PRODUCT-CD            PIC XXX.
  8100        16  PD-FILLER                PIC X(7).
  8101        16  PD-BEN-TYPE              PIC X.
  8102        16  PD-BEN-CODE              PIC XX.
  8103        16  PD-PROD-EXP-DT           PIC XX.
  8104    12  FILLER                       PIC X(50).
  8105    12  PD-PRODUCT-DATA OCCURS 8.
  8106        16  PD-PROD-CODE             PIC X.
  8107            88  PD-PROD-LIFE           VALUE 'L'.
  8108            88  PD-PROD-PROP           VALUE 'P'.
  8109            88  PD-PROD-AH             VALUE 'A'.
  8110            88  PD-PROD-IU             VALUE 'I'.
  8111            88  PD-PROD-GAP            VALUE 'G'.
  8112            88  PD-PROD-FAML           VALUE 'F'.
  8113            88  PD-PROD-OTH            VALUE 'O'.
  8114        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8115        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8116        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8117        16  PD-MAX-TERM              PIC S999        COMP-3.
  8118        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8119        16  FILLER                   PIC X.
  8120        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8121        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 155
* EL156.cbl
  8122        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8123        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  8124        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8125        16  PD-REC-CRIT-PERIOD       PIC 99.
  8126        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8127            20  PD-RECURRING-YN      PIC X.
  8128            20  FILLER               PIC X.
  8129        16  PD-RTW-MOS               PIC 99.
  8130        16  PD-MAX-EXTENSION         PIC 99.
  8131        16  pd-ben-pct               pic sv999 comp-3.
  8132*       16  FILLER                   PIC XX.
  8133    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8134    12  PD-TERM-LIMITS OCCURS 15.
  8135        16  PD-LOW-TERM              PIC S999        COMP-3.
  8136        16  PD-HI-TERM               PIC S999        COMP-3.
  8137*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8138    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8139        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8140        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8141    12  PD-EARN-FACTORS.
  8142        16  FILLER OCCURS 15.
  8143            20  FILLER OCCURS 15.
  8144                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8145    12  PD-PRODUCT-DESC              PIC X(80).
  8146    12  PD-TRUNCATED                 PIC X.
  8147    12  FILLER                       PIC X(59).
  8148    12  PD-MAINT-INFORMATION.
  8149        16  PD-LAST-MAINT-DT         PIC X(02).
  8150        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8151        16  PD-LAST-MAINT-BY         PIC X(04).
  8152*                            COPY ELCCRTT.
  8153******************************************************************
  8154*                                                                *
  8155*                            ELCCRTT.                            *
  8156*                                                                *
  8157*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8158*                                                                *
  8159*   FILE TYPE = VSAM,KSDS                                        *
  8160*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8161*                                                                *
  8162*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8163*                                                                *
  8164*   LOG = YES                                                    *
  8165*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8166******************************************************************
  8167*                   C H A N G E   L O G
  8168*
  8169* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8170*-----------------------------------------------------------------
  8171*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8172* EFFECTIVE    NUMBER
  8173*-----------------------------------------------------------------
  8174* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8175* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8176* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8177* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8178* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8179* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 156
* EL156.cbl
  8180* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8181* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8182* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8183* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8184* 091318  CR2018073000001  PEMA  ADD Refund methods
  8185* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8186******************************************************************
  8187
  8188 01  CERTIFICATE-TRAILERS.
  8189     12  CS-RECORD-ID                      PIC XX.
  8190         88  VALID-CS-ID                      VALUE 'CS'.
  8191
  8192     12  CS-CONTROL-PRIMARY.
  8193         16  CS-COMPANY-CD                 PIC X.
  8194         16  CS-CARRIER                    PIC X.
  8195         16  CS-GROUPING                   PIC X(6).
  8196         16  CS-STATE                      PIC XX.
  8197         16  CS-ACCOUNT                    PIC X(10).
  8198         16  CS-CERT-EFF-DT                PIC XX.
  8199         16  CS-CERT-NO.
  8200             20  CS-CERT-PRIME             PIC X(10).
  8201             20  CS-CERT-SFX               PIC X.
  8202         16  CS-TRAILER-TYPE               PIC X.
  8203             88  COMM-TRLR           VALUE 'A'.
  8204             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8205             88  CERT-DATA-TRLR      VALUE 'C'.
  8206
  8207     12  CS-DATA-AREA                      PIC X(516).
  8208
  8209     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8210         16  CS-BANK-COMMISSION-AREA.
  8211             20  CS-BANK-COMMS       OCCURS 10.
  8212                 24  CS-AGT                PIC X(10).
  8213                 24  CS-COM-TYP            PIC X.
  8214                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8215                 24  CS-RECALC-LV-INDIC    PIC X.
  8216                 24  FILLER                PIC X(10).
  8217         16  FILLER                        PIC X(256).
  8218
  8219     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8220****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8221         16  CS-MB-CLAIM-DATA OCCURS 24.
  8222             20  CS-CLAIM-NO               PIC X(7).
  8223             20  CS-CLAIM-TYPE             PIC X.
  8224                 88  CS-AH-CLM               VALUE 'A'.
  8225                 88  CS-IU-CLM               VALUE 'I'.
  8226                 88  CS-GP-CLM               VALUE 'G'.
  8227                 88  CS-LF-CLM               VALUE 'L'.
  8228                 88  CS-PR-CLM               VALUE 'P'.
  8229                 88  CS-FL-CLM               VALUE 'F'.
  8230                 88  CS-OT-CLM               VALUE 'O'.
  8231             20  CS-INSURED-TYPE           PIC X.
  8232                 88  CS-PRIM-INSURED          VALUE 'P'.
  8233                 88  CS-CO-BORROWER           VALUE 'C'.
  8234             20  CS-BENEFIT-PERIOD         PIC 99.
  8235             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8236             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8237             20  CS-REMAINING-BENS         PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 157
* EL156.cbl
  8238         16  FILLER                        PIC X(12).
  8239     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8240         16  CS-VIN-NUMBER                 PIC X(17).
  8241         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8242         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8243         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8244         16  cs-agent-name.
  8245             20  cs-agent-fname            pic x(20).
  8246             20  cs-agent-mi               pic x.
  8247             20  cs-agent-lname            pic x(25).
  8248         16  cs-license-no                 pic x(15).
  8249         16  cs-npn-number                 pic x(10).
  8250         16  cs-agent-edit-status          pic x.
  8251             88  cs-ae-refer-to-manager      value 'M'.
  8252             88  cs-ae-cover-sheet           value 'C'.
  8253             88  cs-ae-sig-form              value 'S'.
  8254             88  cs-ae-verified              value 'V'.
  8255             88  cs-unidentified-signature   value 'U'.
  8256             88  cs-cert-returned            value 'R'.
  8257             88  cs-accept-no-commission     value 'N'.
  8258         16  cs-year                       pic 9999.
  8259         16  cs-make                       pic x(20).
  8260         16  cs-model                      pic x(20).
  8261         16  cs-future                     pic x(20).
  8262         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8263         16  cs-claim-verification-status  pic x.
  8264             88  cs-clm-ver-eligible         value 'A'.
  8265             88  cs-clm-ver-partial-elig     value 'B'.
  8266             88  cs-clm-ver-not-eligible     value 'C'.
  8267             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8268             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8269             88  cs-clm-ver-ND-CERT          value 'F'.
  8270             88  cs-clm-ver-spec-other       value 'G'.
  8271             88  cs-clam-ver-pratial-corrected
  8272                                             value 'H'.
  8273             88  cs-clm-ver-no-matches       value 'I'.
  8274             88  cs-clm-ver-not-elig-corrected
  8275                                             value 'J'.
  8276             88  cs-clm-ver-needs-review     value 'R'.
  8277             88  cs-clm-ver-sent-to-claims   value 'W'.
  8278         16  CS-LF-REFUND-METHOD           PIC X.
  8279         16  CS-AH-REFUND-METHOD           PIC X.
  8280         16  FILLER                        PIC X(353). *> was 420
  8281*        16  FILLER                        PIC X(496).
  8282 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8283                          CONTROL-FILE CERTIFICATE-MASTER
  8284                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8285                          ACCOUNT-MASTER CHECK-QUE
  8286                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8287                          DAILY-ACTIVITY-RECORD
  8288                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8289                          CERT-NOTE-FILE PRODUCT-MASTER
  8290                          CERTIFICATE-TRAILERS.
  8291 0000-DFHEXIT SECTION.
  8292     MOVE '9#                    $   ' TO DFHEIV0.
  8293     MOVE 'EL156' TO DFHEIV1.
  8294     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8295
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 158
* EL156.cbl
  8296     IF EIBCALEN = 0
  8297         GO TO 8800-UNAUTHORIZED-ACCESS.
  8298
  8299     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8300     MOVE EIBTRMID               TO QID-TERM.
  8301     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8302     MOVE '2'                    TO EMI-SWITCH2.
  8303     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8304     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8305
  8306     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8307     MOVE '5'                    TO DC-OPTION-CODE.
  8308     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8309     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8310                                    SAVE-BIN-DATE.
  8311     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8312     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8313
  8314     IF SAVE-DATE-YY > 70
  8315         MOVE 19                 TO SAVE-DATE-CC
  8316     ELSE
  8317         MOVE 20                 TO SAVE-DATE-CC.
  8318
  8319     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8320         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8321     END-IF.
  8322
  8323     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8324        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8325     ELSE
  8326        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8327     END-IF
  8328
  8329     IF PI-PRINT-CLM-FRM-YN = 'N'
  8330         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8331     ELSE
  8332         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8333     END-IF
  8334
  8335     IF PI-PRINT-SURVEY-YN = 'N'
  8336         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8337     ELSE
  8338         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8339     END-IF
  8340
  8341     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8342         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8343     ELSE
  8344         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8345     END-IF
  8346
  8347* EXEC CICS HANDLE CONDITION
  8348*        NOTOPEN   (9990-ABEND)
  8349*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8350*        MAPFAIL   (0400-FIRST-TIME)
  8351*        DUPREC    (6180-DUPREC)
  8352*        ERROR     (9990-ABEND)
  8353*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 159
* EL156.cbl
  8354*    MOVE '"$JL?%.               ! " #00008342' TO DFHEIV0
  8355     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8357     MOVE X'2220233030303038333432' TO DFHEIV0(25:11)
  8358     CALL 'kxdfhei1' USING DFHEIV0
  8359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8360
  8361
  8362     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8363         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8364
  8365     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8366         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8367             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8368             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8369             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8370             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8371             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8372             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8373             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8374             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8375             MOVE LOW-VALUES           TO EL156AI
  8376             MOVE 'Y'                  TO FIRST-ENTRY
  8377         ELSE
  8378             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8379             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8380             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8381             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8382             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8383             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8384             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8385             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8386
  8387     IF RETURNED-FROM NOT = SPACES
  8388        IF (RETURNED-FROM = 'EL614')
  8389           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8390           IF WS-SAVED-EOB-CODES NOT = SPACES
  8391              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8392           ELSE
  8393              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8394           END-IF
  8395        END-IF
  8396         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8397            MOVE 'Y'             TO FIRST-ENTRY
  8398            IF RETURNED-FROM = 'EL614'
  8399               AND (PI-PASS-SW NOT = 'C')
  8400               IF WS-SAVED-EOB-CODES NOT = SPACES
  8401                  MOVE WS-SAVED-EOB-CODES
  8402                                 TO PI-PMTNOTE2
  8403                                    WS-PMTNOTE2
  8404                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8405               ELSE
  8406                  MOVE SPACES    TO PI-PMTNOTE2
  8407                                    WS-PMTNOTE2
  8408                                    PI-EOB-CODES-EXIST
  8409               END-IF
  8410            END-IF
  8411            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 160
* EL156.cbl
  8412            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8413            IF RETURNED-FROM = 'EL614'
  8414               GO TO 1000-EDIT-DATA
  8415            END-IF
  8416            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8417               (PAYEEI   = LOW-VALUES OR SPACES)
  8418               GO TO 8100-SEND-INITIAL-MAP
  8419            ELSE
  8420               GO TO 1000-EDIT-DATA.
  8421
  8422     IF EIBTRNID NOT = TRANS-ID
  8423         GO TO 0400-FIRST-TIME.
  8424
  8425     IF EIBAID = DFHCLEAR
  8426        IF PI-PASS-SW = 'C'
  8427           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8428           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8429           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8430           MOVE 'Y'            TO RETURNED-FROM-B
  8431           GO TO 1000-EDIT-DATA
  8432        ELSE
  8433           GO TO 9400-CLEAR.
  8434
  8435     IF PI-PASS-SW = 'C'
  8436         MOVE MAP-NAMEB          TO MAP-NAME
  8437         IF EIBAID = DFHPF1 OR DFHPF13
  8438             GO TO 5000-UPDATE
  8439           ELSE
  8440             IF EIBAID NOT = DFHENTER
  8441                 MOVE LOW-VALUES TO EL156BI
  8442                 MOVE MAP-NAMEB  TO MAP-NAME
  8443                 MOVE ER-0029    TO EMI-ERROR
  8444                 MOVE -1         TO  ENTPFBL
  8445                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8446                 GO TO 8200-SEND-DATAONLY.
  8447
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 161
* EL156.cbl
  8449 0200-RECEIVE.
  8450     MOVE LOW-VALUES             TO EL156AI.
  8451     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8452         MOVE ER-0008            TO EMI-ERROR
  8453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8454         IF PI-PASS-SW = 'C'
  8455             MOVE -1             TO ENTPFBL
  8456             GO TO 8200-SEND-DATAONLY
  8457         ELSE
  8458             MOVE -1             TO PMTTYPEL
  8459             GO TO 8200-SEND-DATAONLY.
  8460
  8461     IF PI-COMPANY-ID = 'DMD'
  8462         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8463
  8464     IF PI-PASS-SW = 'C'
  8465         MOVE MAP-NAMEB          TO MAP-NAME.
  8466
  8467
  8468* EXEC CICS RECEIVE
  8469*        MAP   (MAP-NAME)
  8470*        MAPSET(MAPSET-NAME)
  8471*        ASIS
  8472*        INTO  (EL156AI)
  8473*    END-EXEC.
  8474     MOVE LENGTH OF
  8475      EL156AI
  8476       TO DFHEIV11
  8477*    MOVE '8"TAI  L              ''   #00008455' TO DFHEIV0
  8478     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8479     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8480     MOVE X'2020233030303038343535' TO DFHEIV0(25:11)
  8481     CALL 'kxdfhei1' USING DFHEIV0,
  8482           MAP-NAME,
  8483           EL156AI,
  8484           DFHEIV11,
  8485           MAPSET-NAME,
  8486           DFHEIV99,
  8487           DFHEIV99
  8488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8489
  8490
  8491     IF PI-PASS-SW NOT = 'C'
  8492         GO TO 0250-MAPA.
  8493
  8494     IF ENTPFBL NOT > ZERO
  8495         MOVE MAP-NAMEB          TO MAP-NAME
  8496         MOVE ER-0029            TO EMI-ERROR
  8497         MOVE -1                 TO  ENTPFBL
  8498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8499         GO TO 8200-SEND-DATAONLY.
  8500
  8501     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8502         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8503       ELSE
  8504         MOVE MAP-NAMEB           TO MAP-NAME
  8505         MOVE ER-0029             TO EMI-ERROR
  8506         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 162
* EL156.cbl
  8507         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8508         GO TO 8200-SEND-DATAONLY.
  8509
  8510     IF EIBAID = DFHPF1 OR DFHPF13
  8511         IF MODIFY-CAP
  8512            GO TO 5000-UPDATE
  8513          ELSE
  8514            MOVE 'UPDATE'           TO SM-READ
  8515            PERFORM 9995-SECURITY-VIOLATION
  8516            MOVE MAP-NAMEB          TO MAP-NAME
  8517            MOVE ER-0070            TO EMI-ERROR
  8518            MOVE -1                 TO  ENTPFBL
  8519            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8520            GO TO 8200-SEND-DATAONLY.
  8521
  8522 0250-MAPA.
  8523     IF ENTERPFL = 0
  8524         GO TO 0300-CHECK-PFKEYS.
  8525
  8526     IF EIBAID NOT = DFHENTER
  8527         MOVE ER-0004            TO EMI-ERROR
  8528         GO TO 0320-INPUT-ERROR.
  8529
  8530     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8531         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8532     ELSE
  8533         MOVE ER-0029            TO EMI-ERROR
  8534         GO TO 0320-INPUT-ERROR.
  8535
  8536 0300-CHECK-PFKEYS.
  8537     IF EIBAID = DFHPF7 OR DFHPF8
  8538         GO TO 8820-PF7-8.
  8539
  8540     IF EIBAID = DFHPF23
  8541         GO TO 8810-PF23.
  8542
  8543     IF EIBAID = DFHPF24
  8544         GO TO 9200-RETURN-MAIN-MENU.
  8545
  8546     IF EIBAID = DFHPF12
  8547         GO TO 9500-PF12.
  8548
  8549     IF EIBAID = DFHPF1
  8550        IF PI-PASS-SW = 'A' OR 'B'
  8551          GO TO 0330-BROWSE-FORWARD.
  8552
  8553     IF EIBAID = DFHPF2
  8554        IF PI-PASS-SW = 'A' OR 'B'
  8555          GO TO 0350-BROWSE-BACKWARD.
  8556
  8557     IF EIBAID = DFHPF6
  8558        IF PI-EOB-CODES-EXIST = 'Y'
  8559           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8560        ELSE
  8561           MOVE SPACES              TO WS-PMTNOTE2
  8562        END-IF
  8563         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8564         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 163
* EL156.cbl
  8565            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8566         END-IF
  8567         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8568         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8569             MOVE 'EL614'        TO PGM-NAME
  8570             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8571             GO TO 9300-XCTL
  8572         ELSE
  8573             MOVE XCTL-157       TO PGM-NAME
  8574             GO TO 9300-XCTL.
  8575
  8576     IF EIBAID = DFHPF9
  8577        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8578        MOVE XCTL-141            TO PGM-NAME
  8579        GO TO 9300-XCTL.
  8580
  8581     IF EIBAID = DFHPF10
  8582        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8583        MOVE XCTL-155            TO PGM-NAME
  8584        GO TO 9300-XCTL.
  8585
  8586     MOVE SPACES                 TO ERRMSG0O
  8587                                    ERRMSG1O
  8588                                    ERRMSG2O.
  8589
  8590     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8591         IF PI-PASS-SW NOT = 'B'
  8592             MOVE ER-0422        TO EMI-ERROR
  8593             GO TO 0320-INPUT-ERROR
  8594           ELSE
  8595             GO TO 0700-TEST-FOR-CHANGES.
  8596
  8597     IF EIBAID = DFHPF11
  8598        IF PI-PASS-SW = 'C'
  8599           MOVE ER-0029          TO EMI-ERROR
  8600           GO TO 0320-INPUT-ERROR.
  8601
  8602     IF EIBAID = DFHENTER OR DFHPF11
  8603        NEXT SENTENCE
  8604     ELSE
  8605        MOVE ER-0029             TO EMI-ERROR
  8606        GO TO 0320-INPUT-ERROR.
  8607
  8608     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8609
  8610     if pi-epyfrom not = zeros
  8611        if pi-epyfrom not = ws-epyfrom
  8612           move zeros        to ws-edays
  8613        end-if
  8614     end-if
  8615
  8616     if pi-epythru not = zeros
  8617        if pi-epythru not = ws-epythru
  8618           move zeros        to ws-edays
  8619        end-if
  8620     end-if
  8621
  8622     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 164
* EL156.cbl
  8623         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8624         GO TO 1000-EDIT-DATA
  8625     ELSE
  8626         IF PI-FATAL-COUNT NOT = 0 OR
  8627            PI-FORCE-COUNT NOT = 0
  8628             GO TO 1000-EDIT-DATA
  8629         ELSE
  8630             GO TO 2000-EDIT-DONE.
  8631
  8632 0320-INPUT-ERROR.
  8633     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8634
  8635     IF ENTERPFL = 0
  8636         MOVE -1                 TO PMTTYPEL
  8637     ELSE
  8638         MOVE AL-UNBON           TO ENTERPFA
  8639         MOVE -1                 TO ENTERPFL.
  8640
  8641     GO TO 8200-SEND-DATAONLY.
  8642
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 165
* EL156.cbl
  8644 0330-BROWSE-FORWARD.
  8645
  8646     MOVE CLMNOI            TO PI-CLAIM-NO.
  8647     MOVE CARRI             TO PI-CARRIER.
  8648     MOVE CERTNOI           TO PI-CERT-PRIME.
  8649     MOVE SUFXI             TO PI-CERT-SFX.
  8650
  8651     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8652     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8653     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8654     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8655
  8656     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8657
  8658
  8659* EXEC CICS HANDLE CONDITION
  8660*         NOTFND   (0380-CLAIM-END-FILE)
  8661*         ENDFILE  (0380-CLAIM-END-FILE)
  8662*    END-EXEC.
  8663*    MOVE '"$I''                  ! # #00008629' TO DFHEIV0
  8664     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8666     MOVE X'2320233030303038363239' TO DFHEIV0(25:11)
  8667     CALL 'kxdfhei1' USING DFHEIV0
  8668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8669
  8670
  8671
  8672* EXEC CICS STARTBR
  8673*         DATASET    ('ELMSTR')
  8674*         RIDFLD     (ELMSTR-KEY)
  8675*         GTEQ
  8676*    END-EXEC.
  8677     MOVE 'ELMSTR' TO DFHEIV1
  8678     MOVE 0
  8679       TO DFHEIV11
  8680*    MOVE '&,         G          &   #00008634' TO DFHEIV0
  8681     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8682     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8683     MOVE X'2020233030303038363334' TO DFHEIV0(25:11)
  8684     CALL 'kxdfhei1' USING DFHEIV0,
  8685           DFHEIV1,
  8686           ELMSTR-KEY,
  8687           DFHEIV99,
  8688           DFHEIV11,
  8689           DFHEIV99
  8690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8691
  8692
  8693     MOVE 'Y' TO WS-BROWSE-START-SW.
  8694
  8695 0335-READNEXT.
  8696
  8697
  8698* EXEC CICS READNEXT
  8699*         DATASET    ('ELMSTR')
  8700*         RIDFLD     (ELMSTR-KEY)
  8701*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 166
* EL156.cbl
  8702*    END-EXEC.
  8703     MOVE 'ELMSTR' TO DFHEIV1
  8704     MOVE 0
  8705       TO DFHEIV11
  8706*    MOVE '&.S                   )   #00008644' TO DFHEIV0
  8707     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8708     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8709     MOVE X'2020233030303038363434' TO DFHEIV0(25:11)
  8710     CALL 'kxdfhei1' USING DFHEIV0,
  8711           DFHEIV1,
  8712           DFHEIV20,
  8713           DFHEIV99,
  8714           ELMSTR-KEY,
  8715           DFHEIV99,
  8716           DFHEIV11,
  8717           DFHEIV99,
  8718           DFHEIV99
  8719     SET ADDRESS OF CLAIM-MASTER TO
  8720         DFHEIV20
  8721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8722
  8723
  8724     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8725        GO TO 0380-CLAIM-END-FILE.
  8726
  8727     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8728        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8729        GO TO 0335-READNEXT.
  8730
  8731     IF PI-COMPANY-ID = 'CRI'
  8732         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8733            GO TO 0380-CLAIM-END-FILE.
  8734
  8735     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8736         GO TO 0335-READNEXT.
  8737
  8738     IF PI-CARRIER-SECURITY > SPACES
  8739         IF CL-CARRIER = PI-CARRIER-SECURITY
  8740             NEXT SENTENCE
  8741         ELSE
  8742             GO TO 0335-READNEXT.
  8743
  8744     IF PI-ACCOUNT-SECURITY > SPACES
  8745         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8746             NEXT SENTENCE
  8747         ELSE
  8748             GO TO 0335-READNEXT.
  8749
  8750     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8751     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8752     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8753
  8754     GO TO 0400-FIRST-TIME.
  8755
  8756 0350-BROWSE-BACKWARD.
  8757
  8758     MOVE CLMNOI            TO PI-CLAIM-NO
  8759                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 167
* EL156.cbl
  8760     MOVE CARRI             TO PI-CARRIER.
  8761     MOVE CERTNOI           TO PI-CERT-PRIME.
  8762     MOVE SUFXI             TO PI-CERT-SFX.
  8763
  8764     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8765
  8766     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8767     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8768     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8769
  8770
  8771* EXEC CICS HANDLE CONDITION
  8772*         NOTFND   (0380-CLAIM-END-FILE)
  8773*         ENDFILE  (0380-CLAIM-END-FILE)
  8774*    END-EXEC.
  8775*    MOVE '"$I''                  ! $ #00008696' TO DFHEIV0
  8776     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8778     MOVE X'2420233030303038363936' TO DFHEIV0(25:11)
  8779     CALL 'kxdfhei1' USING DFHEIV0
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8781
  8782
  8783
  8784* EXEC CICS STARTBR
  8785*         DATASET    ('ELMSTR')
  8786*         RIDFLD     (ELMSTR-KEY)
  8787*         GTEQ
  8788*    END-EXEC.
  8789     MOVE 'ELMSTR' TO DFHEIV1
  8790     MOVE 0
  8791       TO DFHEIV11
  8792*    MOVE '&,         G          &   #00008701' TO DFHEIV0
  8793     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8794     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8795     MOVE X'2020233030303038373031' TO DFHEIV0(25:11)
  8796     CALL 'kxdfhei1' USING DFHEIV0,
  8797           DFHEIV1,
  8798           ELMSTR-KEY,
  8799           DFHEIV99,
  8800           DFHEIV11,
  8801           DFHEIV99
  8802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8803
  8804
  8805     MOVE 'Y' TO WS-BROWSE-START-SW.
  8806
  8807
  8808* EXEC CICS READNEXT
  8809*         DATASET    ('ELMSTR')
  8810*         RIDFLD     (ELMSTR-KEY)
  8811*         SET        (ADDRESS OF CLAIM-MASTER)
  8812*    END-EXEC.
  8813     MOVE 'ELMSTR' TO DFHEIV1
  8814     MOVE 0
  8815       TO DFHEIV11
  8816*    MOVE '&.S                   )   #00008709' TO DFHEIV0
  8817     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 168
* EL156.cbl
  8818     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8819     MOVE X'2020233030303038373039' TO DFHEIV0(25:11)
  8820     CALL 'kxdfhei1' USING DFHEIV0,
  8821           DFHEIV1,
  8822           DFHEIV20,
  8823           DFHEIV99,
  8824           ELMSTR-KEY,
  8825           DFHEIV99,
  8826           DFHEIV11,
  8827           DFHEIV99,
  8828           DFHEIV99
  8829     SET ADDRESS OF CLAIM-MASTER TO
  8830         DFHEIV20
  8831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8832
  8833
  8834
  8835* EXEC CICS READPREV
  8836*         DATASET    ('ELMSTR')
  8837*         RIDFLD     (ELMSTR-KEY)
  8838*         SET        (ADDRESS OF CLAIM-MASTER)
  8839*    END-EXEC.
  8840     MOVE 'ELMSTR' TO DFHEIV1
  8841     MOVE 0
  8842       TO DFHEIV11
  8843*    MOVE '&0S                   )   #00008715' TO DFHEIV0
  8844     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8845     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8846     MOVE X'2020233030303038373135' TO DFHEIV0(25:11)
  8847     CALL 'kxdfhei1' USING DFHEIV0,
  8848           DFHEIV1,
  8849           DFHEIV20,
  8850           DFHEIV99,
  8851           ELMSTR-KEY,
  8852           DFHEIV99,
  8853           DFHEIV11,
  8854           DFHEIV99,
  8855           DFHEIV99
  8856     SET ADDRESS OF CLAIM-MASTER TO
  8857         DFHEIV20
  8858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8859
  8860
  8861 0360-BROWSE-BACKWARD.
  8862
  8863
  8864* EXEC CICS READPREV
  8865*         DATASET    ('ELMSTR')
  8866*         RIDFLD     (ELMSTR-KEY)
  8867*         SET        (ADDRESS OF CLAIM-MASTER)
  8868*    END-EXEC.
  8869     MOVE 'ELMSTR' TO DFHEIV1
  8870     MOVE 0
  8871       TO DFHEIV11
  8872*    MOVE '&0S                   )   #00008723' TO DFHEIV0
  8873     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8874     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8875     MOVE X'2020233030303038373233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 169
* EL156.cbl
  8876     CALL 'kxdfhei1' USING DFHEIV0,
  8877           DFHEIV1,
  8878           DFHEIV20,
  8879           DFHEIV99,
  8880           ELMSTR-KEY,
  8881           DFHEIV99,
  8882           DFHEIV11,
  8883           DFHEIV99,
  8884           DFHEIV99
  8885     SET ADDRESS OF CLAIM-MASTER TO
  8886         DFHEIV20
  8887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8888
  8889
  8890     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8891        GO TO 0380-CLAIM-END-FILE.
  8892
  8893     IF PI-COMPANY-ID = 'CRI'
  8894         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8895            GO TO 0380-CLAIM-END-FILE.
  8896
  8897     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8898         GO TO 0360-BROWSE-BACKWARD.
  8899
  8900     IF PI-CARRIER-SECURITY > SPACES
  8901         IF CL-CARRIER = PI-CARRIER-SECURITY
  8902             NEXT SENTENCE
  8903         ELSE
  8904             GO TO 0360-BROWSE-BACKWARD.
  8905
  8906     IF PI-ACCOUNT-SECURITY > SPACES
  8907         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8908             NEXT SENTENCE
  8909         ELSE
  8910             GO TO 0360-BROWSE-BACKWARD.
  8911
  8912     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8913     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8914     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8915
  8916     GO TO 0400-FIRST-TIME.
  8917
  8918 0380-CLAIM-END-FILE.
  8919
  8920     MOVE ER-0130     TO EMI-ERROR.
  8921     MOVE -1          TO CLMNOL.
  8922     MOVE AL-UABON    TO CARRA
  8923                         CLMNOA
  8924                         CERTNOA
  8925                         SUFXA.
  8926
  8927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8928
  8929     GO TO 8200-SEND-DATAONLY.
  8930
  8931 0400-FIRST-TIME.
  8932
  8933     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 170
* EL156.cbl
  8934        MOVE 'N'         TO WS-BROWSE-START-SW
  8935
  8936* EXEC CICS ENDBR
  8937*            DATASET    ('ELMSTR')
  8938*       END-EXEC.
  8939     MOVE 'ELMSTR' TO DFHEIV1
  8940     MOVE 0
  8941       TO DFHEIV11
  8942*    MOVE '&2                    $   #00008774' TO DFHEIV0
  8943     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8944     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8945     MOVE X'2020233030303038373734' TO DFHEIV0(25:11)
  8946     CALL 'kxdfhei1' USING DFHEIV0,
  8947           DFHEIV1,
  8948           DFHEIV11,
  8949           DFHEIV99
  8950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8951
  8952
  8953     IF PI-PROCESSOR-ID = 'LGXX'
  8954         NEXT SENTENCE
  8955     ELSE
  8956
  8957* EXEC CICS READQ TS
  8958*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8959*            INTO    (SECURITY-CONTROL)
  8960*            LENGTH  (SC-COMM-LENGTH)
  8961*            ITEM    (SC-ITEM)
  8962*        END-EXEC
  8963*    MOVE '*$II   L              ''   #00008781' TO DFHEIV0
  8964     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8966     MOVE X'2020233030303038373831' TO DFHEIV0(25:11)
  8967     CALL 'kxdfhei1' USING DFHEIV0,
  8968           PI-SECURITY-TEMP-STORE-ID,
  8969           SECURITY-CONTROL,
  8970           SC-COMM-LENGTH,
  8971           SC-ITEM,
  8972           DFHEIV99,
  8973           DFHEIV99
  8974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8975         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8976         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8977
  8978     MOVE LOW-VALUES             TO EL156AI.
  8979     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8980     MOVE 'Y'                    TO FIRST-ENTRY.
  8981     GO TO 7000-SHOW-CLAIM.
  8982
  8983 0500-CREATE-TEMP-STORAGE.
  8984     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8985
  8986
  8987* EXEC CICS WRITEQ TS
  8988*        QUEUE (QID)
  8989*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8990*        LENGTH(PI-COMM-LENGTH)
  8991*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 171
* EL156.cbl
  8992*    MOVE '*"     L              ''   #00008798' TO DFHEIV0
  8993     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8994     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8995     MOVE X'2020233030303038373938' TO DFHEIV0(25:11)
  8996     CALL 'kxdfhei1' USING DFHEIV0,
  8997           QID,
  8998           PROGRAM-INTERFACE-BLOCK,
  8999           PI-COMM-LENGTH,
  9000           DFHEIV99,
  9001           DFHEIV99,
  9002           DFHEIV99
  9003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9004
  9005
  9006
  9007* EXEC CICS WRITEQ TS
  9008*        QUEUE (QID)
  9009*        FROM  (EL156AI)
  9010*        LENGTH(MAP-LENGTH)
  9011*    END-EXEC.
  9012*    MOVE '*"     L              ''   #00008804' TO DFHEIV0
  9013     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9014     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9015     MOVE X'2020233030303038383034' TO DFHEIV0(25:11)
  9016     CALL 'kxdfhei1' USING DFHEIV0,
  9017           QID,
  9018           EL156AI,
  9019           MAP-LENGTH,
  9020           DFHEIV99,
  9021           DFHEIV99,
  9022           DFHEIV99
  9023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9024
  9025
  9026 0599-EXIT.
  9027      EXIT.
  9028
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 172
* EL156.cbl
  9030 0600-RECOVER-TEMP-STORAGE.
  9031
  9032* EXEC CICS READQ TS
  9033*        QUEUE (QID)
  9034*        INTO  (PROGRAM-INTERFACE-BLOCK)
  9035*        LENGTH(PI-COMM-LENGTH)
  9036*    END-EXEC.
  9037*    MOVE '*$I    L              ''   #00008815' TO DFHEIV0
  9038     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9039     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9040     MOVE X'2020233030303038383135' TO DFHEIV0(25:11)
  9041     CALL 'kxdfhei1' USING DFHEIV0,
  9042           QID,
  9043           PROGRAM-INTERFACE-BLOCK,
  9044           PI-COMM-LENGTH,
  9045           DFHEIV99,
  9046           DFHEIV99,
  9047           DFHEIV99
  9048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9049
  9050
  9051
  9052* EXEC CICS READQ TS
  9053*        QUEUE (QID)
  9054*        INTO  (EL156AI)
  9055*        LENGTH(MAP-LENGTH)
  9056*    END-EXEC.
  9057*    MOVE '*$I    L              ''   #00008821' TO DFHEIV0
  9058     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9060     MOVE X'2020233030303038383231' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0,
  9062           QID,
  9063           EL156AI,
  9064           MAP-LENGTH,
  9065           DFHEIV99,
  9066           DFHEIV99,
  9067           DFHEIV99
  9068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9069
  9070
  9071     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9072
  9073     IF PMTTYPEI NOT = LOW-VALUES
  9074         MOVE AL-UANON           TO PMTTYPEA.
  9075
  9076     IF PAYEEI NOT = LOW-VALUES
  9077         MOVE AL-UANON           TO PAYEEA.
  9078
  9079     IF NOTE1I NOT = LOW-VALUES
  9080         MOVE AL-UANON           TO NOTE1A.
  9081
  9082     IF (RETURNED-FROM = 'EL614')
  9083        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9084     END-IF
  9085*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9086*       AND (PI-EOB-CODES-EXIST = 'Y')
  9087*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 173
* EL156.cbl
  9088*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9089     IF PI-SET-NOTE2-MDT = 'Y'
  9090         MOVE AL-SANON           TO NOTE2A
  9091     END-IF
  9092
  9093     IF OFFLINEI NOT = LOW-VALUES
  9094         MOVE AL-UANON           TO OFFLINEA.
  9095
  9096*    IF GROUPEDI NOT = LOW-VALUES
  9097*        MOVE AL-UANON           TO GROUPEDA.
  9098
  9099*    IF CASHI NOT = LOW-VALUES
  9100*        MOVE AL-UANON           TO CASHA.
  9101
  9102     IF CHECKNOI NOT = LOW-VALUES
  9103         MOVE AL-UANON           TO CHECKNOA.
  9104
  9105     IF HOLDTILI NOT = LOW-VALUES
  9106         MOVE AL-UANON           TO HOLDTILA.
  9107
  9108     IF EPYFROMI NOT = LOW-VALUES
  9109         MOVE AL-UANON           TO EPYFROMA.
  9110
  9111     IF AIGFROMI NOT = LOW-VALUES
  9112         MOVE AL-UANON           TO AIGFROMA.
  9113
  9114     IF EPYTHRUI NOT = LOW-VALUES
  9115         MOVE AL-UANON           TO EPYTHRUA.
  9116
  9117     IF EDAYSI NOT = LOW-VALUES
  9118         MOVE AL-UNNON           TO EDAYSA.
  9119
  9120     IF EPYAMTL NOT = +0
  9121         MOVE AL-UNNON           TO EPYAMTA.
  9122
  9123     IF ERESVL NOT = +0
  9124         MOVE AL-UNNON           TO ERESVA.
  9125
  9126     IF EEXPENSL NOT = +0
  9127         MOVE AL-UNNON           TO EEXPENSA.
  9128
  9129     IF ETYPEI NOT = LOW-VALUES
  9130         MOVE AL-UNNON           TO ETYPEA.
  9131
  9132     IF PROOFDTI NOT = 0
  9133         MOVE AL-UNNON           TO PROOFDTA.
  9134
  9135     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9136        MOVE AL-UANON            TO EOBYNA
  9137     END-IF
  9138     IF CLMFMYNI = 'Y' OR 'N'
  9139        MOVE AL-UANON            TO CLMFMYNA
  9140     END-IF
  9141
  9142     IF SURVYYNI = 'Y' OR 'N'
  9143        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9144           MOVE AL-UANON         TO SURVYYNA
  9145        END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 174
* EL156.cbl
  9146     END-IF
  9147
  9148     IF SPRELYNI = 'Y' OR 'N'
  9149        MOVE AL-UANON            TO SPRELYNA
  9150     END-IF
  9151
  9152     .
  9153 0699-EXIT.
  9154      EXIT.
  9155
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 175
* EL156.cbl
  9157 0700-TEST-FOR-CHANGES.
  9158     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9159         MOVE ER-0433            TO EMI-ERROR
  9160         GO TO 0750-FUNCTION-ERROR.
  9161
  9162     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9163
  9164     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9165         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9166         MOVE 'A'                TO PI-PASS-SW
  9167         GO TO 1000-EDIT-DATA.
  9168
  9169     IF PI-FATAL-COUNT NOT = 0
  9170         MOVE ER-0499            TO EMI-ERROR
  9171         GO TO 0750-FUNCTION-ERROR.
  9172
  9173     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9174         MOVE ER-0500            TO EMI-ERROR
  9175         GO TO 0750-FUNCTION-ERROR.
  9176
  9177     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9178        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9179           MOVE ER-0542          TO EMI-ERROR
  9180           MOVE -1               TO EPYAMTL
  9181           GO TO 0750-FUNCTION-ERROR.
  9182
  9183     IF PI-OFFLINE = 'Y'  OR
  9184        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9185        MOVE EIBAID              TO PI-PFKEY-USED
  9186        GO TO 5000-UPDATE.
  9187
  9188     GO TO 6000-BUILD-SCREEN-B.
  9189
  9190 0750-FUNCTION-ERROR.
  9191     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9192
  9193     IF ENTERPFL > 0
  9194         MOVE -1                 TO ENTERPFL
  9195         MOVE AL-UNBON           TO ENTERPFA
  9196         GO TO 8200-SEND-DATAONLY
  9197     ELSE
  9198         MOVE -1                 TO ENTERPFL
  9199         MOVE AL-UNNOF           TO ENTERPFA
  9200         GO TO 8200-SEND-DATAONLY.
  9201
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 176
* EL156.cbl
  9203 0800-DELETE-TS.
  9204
  9205* EXEC CICS HANDLE CONDITION
  9206*        QIDERR(0800-EXIT)
  9207*    END-EXEC.
  9208*    MOVE '"$N                   ! % #00008960' TO DFHEIV0
  9209     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9211     MOVE X'2520233030303038393630' TO DFHEIV0(25:11)
  9212     CALL 'kxdfhei1' USING DFHEIV0
  9213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9214
  9215
  9216
  9217* EXEC CICS DELETEQ TS
  9218*        QUEUE(QID)
  9219*    END-EXEC.
  9220*    MOVE '*&                    #   #00008964' TO DFHEIV0
  9221     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9222     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9223     MOVE X'2020233030303038393634' TO DFHEIV0(25:11)
  9224     CALL 'kxdfhei1' USING DFHEIV0,
  9225           QID,
  9226           DFHEIV99
  9227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9228
  9229
  9230 0800-EXIT.
  9231      EXIT.
  9232 0900-GET-DDF-LIMITS.
  9233
  9234     if cm-clp-state = zeros or spaces or low-values
  9235        move cm-state            to cm-clp-state
  9236     end-if
  9237     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9238     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9239     MOVE cm-clp-state           TO ERPDEF-STATE
  9240     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9241     evaluate true
  9242        when (cl-claim-type = 'L' or 'P')
  9243           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9244             and 'CU')
  9245           move 'L'              to erpdef-ben-type
  9246           move pi-lf-benefit-cd to erpdef-ben-code
  9247        when (cl-claim-type not = 'L' and 'P')
  9248           and (pi-ah-benefit-cd not = '00' and '  ')
  9249           move 'A'              to erpdef-ben-type
  9250           move pi-ah-benefit-cd to erpdef-ben-code
  9251        when (cl-claim-type not = 'L' and 'P')
  9252           and (pi-ah-benefit-cd = '00' or '  ')
  9253           move 'L'              to erpdef-ben-type
  9254           move pi-lf-benefit-cd to erpdef-ben-code
  9255        when (cl-claim-type = 'L' or 'P')
  9256           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9257           move 'A'              to erpdef-ben-type
  9258           move pi-ah-benefit-cd to erpdef-ben-code
  9259        when other
  9260           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 177
* EL156.cbl
  9261           move pi-ah-benefit-cd to erpdef-ben-code
  9262     end-evaluate
  9263*    if (cl-claim-type = 'L' or 'P')
  9264*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9265*          and 'CU')
  9266*       move 'L'                 to erpdef-ben-type
  9267*       move pi-lf-benefit-cd    to erpdef-ben-code
  9268*    else
  9269*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9270*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9271*    end-if
  9272     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9273
  9274     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9275
  9276
  9277* EXEC CICS STARTBR
  9278*        DATASET  ('ERPDEF')
  9279*        RIDFLD   (ERPDEF-KEY)
  9280*        GTEQ
  9281*        RESP     (WS-RESPONSE)
  9282*    END-EXEC
  9283     MOVE 'ERPDEF' TO DFHEIV1
  9284     MOVE 0
  9285       TO DFHEIV11
  9286*    MOVE '&,         G          &  N#00009014' TO DFHEIV0
  9287     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9288     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9289     MOVE X'204E233030303039303134' TO DFHEIV0(25:11)
  9290     CALL 'kxdfhei1' USING DFHEIV0,
  9291           DFHEIV1,
  9292           ERPDEF-KEY,
  9293           DFHEIV99,
  9294           DFHEIV11,
  9295           DFHEIV99
  9296     MOVE EIBRESP  TO WS-RESPONSE
  9297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9298
  9299     IF NOT WS-RESP-NORMAL
  9300        GO TO 0900-EXIT
  9301     END-IF
  9302
  9303     .
  9304 0900-READNEXT.
  9305
  9306
  9307* EXEC CICS READNEXT
  9308*       DATASET  ('ERPDEF')
  9309*       SET      (ADDRESS OF PRODUCT-MASTER)
  9310*       RIDFLD   (ERPDEF-KEY)
  9311*       RESP     (WS-RESPONSE)
  9312*    END-EXEC
  9313     MOVE 'ERPDEF' TO DFHEIV1
  9314     MOVE 0
  9315       TO DFHEIV11
  9316*    MOVE '&.S                   )  N#00009028' TO DFHEIV0
  9317     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9318     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 178
* EL156.cbl
  9319     MOVE X'204E233030303039303238' TO DFHEIV0(25:11)
  9320     CALL 'kxdfhei1' USING DFHEIV0,
  9321           DFHEIV1,
  9322           DFHEIV20,
  9323           DFHEIV99,
  9324           ERPDEF-KEY,
  9325           DFHEIV99,
  9326           DFHEIV11,
  9327           DFHEIV99,
  9328           DFHEIV99
  9329     SET ADDRESS OF PRODUCT-MASTER TO
  9330         DFHEIV20
  9331     MOVE EIBRESP  TO WS-RESPONSE
  9332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9333
  9334     IF NOT WS-RESP-NORMAL
  9335        GO TO 0900-ENDBR
  9336     END-IF
  9337
  9338     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9339        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9340           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9341        ELSE
  9342           GO TO 0900-READNEXT
  9343        END-IF
  9344     ELSE
  9345        GO TO 0900-ENDBR
  9346     END-IF
  9347
  9348     IF CM-LOAN-TERM = ZEROS
  9349        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9350     END-IF
  9351
  9352     .
  9353 0900-ENDBR.
  9354
  9355
  9356* EXEC CICS ENDBR
  9357*       DATASET  ('ERPDEF')
  9358*    END-EXEC
  9359     MOVE 'ERPDEF' TO DFHEIV1
  9360     MOVE 0
  9361       TO DFHEIV11
  9362*    MOVE '&2                    $   #00009056' TO DFHEIV0
  9363     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9365     MOVE X'2020233030303039303536' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0,
  9367           DFHEIV1,
  9368           DFHEIV11,
  9369           DFHEIV99
  9370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9371
  9372     .
  9373 0900-EXIT.
  9374     EXIT.
  9375 1000-EDIT-DATA.
  9376
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 179
* EL156.cbl
  9377     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9378         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9379         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9380
  9381     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9382
  9383     IF NOT MODIFY-CAP
  9384         MOVE ER-0070            TO EMI-ERROR
  9385         MOVE -1                 TO PMTTYPEL
  9386         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9387         GO TO 2000-EDIT-DONE.
  9388
  9389     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9390                         '5' AND '6'
  9391         MOVE ER-0420            TO EMI-ERROR
  9392         MOVE -1                 TO PMTTYPEL
  9393         MOVE AL-UABON           TO PMTTYPEA
  9394         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9395     ELSE
  9396         MOVE AL-UANON           TO PMTTYPEA.
  9397
  9398*    IF PI-OFFLINE = 'Y'
  9399*       IF PI-GROUPED = 'Y'
  9400*          MOVE ER-1880         TO EMI-ERROR
  9401*          MOVE -1              TO GROUPEDL
  9402*          MOVE AL-UABON        TO GROUPEDA
  9403*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9404*
  9405*    IF GROUPEDL > +0
  9406*       IF PI-GROUPED = 'Y' OR 'N'
  9407*          MOVE AL-UANON TO GROUPEDA
  9408*       ELSE
  9409*          MOVE ER-3140            TO EMI-ERROR
  9410*          MOVE -1                 TO GROUPEDL
  9411*          MOVE AL-UABON           TO GROUPEDA
  9412*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9413*
  9414*    IF CASHL > +0
  9415*       IF PI-CASH = 'Y' OR 'N'
  9416*          MOVE AL-UANON           TO CASHA
  9417*       ELSE
  9418*          MOVE ER-3141            TO EMI-ERROR
  9419*          MOVE -1                 TO CASHL
  9420*          MOVE AL-UABON           TO CASHA
  9421*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9422
  9423     IF LOANNOL > +0
  9424         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9425
  9426 1000-EDIT-PAYEE.
  9427
  9428     IF PI-PAYEE-SEQ NOT NUMERIC
  9429         MOVE ER-0294            TO  EMI-ERROR
  9430         MOVE -1                 TO  PAYEEL
  9431         MOVE AL-UABON           TO  PAYEEA
  9432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9433         GO TO 1000-CONT-EDIT.
  9434
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 180
* EL156.cbl
  9435     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9436                         'E' OR 'O' OR 'Q'
  9437         NEXT SENTENCE
  9438     ELSE
  9439         MOVE ER-0294            TO  EMI-ERROR
  9440         MOVE -1                 TO  PAYEEL
  9441         MOVE AL-UABON           TO  PAYEEA
  9442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9443         GO TO 1000-CONT-EDIT.
  9444
  9445     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9446        (PI-PAYEE-SEQ NOT < '1' AND
  9447         PI-PAYEE-SEQ NOT > '9'))
  9448      OR
  9449        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9450         (PI-PAYEE-SEQ NOT > '9'))
  9451         MOVE AL-UANON            TO PAYEEA
  9452     ELSE
  9453         MOVE ER-0294            TO EMI-ERROR
  9454         MOVE -1                 TO PAYEEL
  9455         MOVE AL-UABON           TO PAYEEA
  9456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9457
  9458     IF PI-COMPANY-ID = 'DMD'
  9459         IF PI-PAYEE-TYPE = 'B' AND
  9460            PI-PAYEE-SEQ NOT = '0'
  9461               MOVE ER-7841            TO EMI-ERROR
  9462               MOVE -1                 TO PAYEEL
  9463               MOVE AL-UABON           TO PAYEEA
  9464               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9465
  9466     IF PI-COMPANY-ID = 'JHL'
  9467         IF PI-PAYEE = 'B0'
  9468             NEXT SENTENCE
  9469           ELSE
  9470
  9471* EXEC CICS HANDLE CONDITION
  9472*            ENDFILE(1950-NOT-FOUND)
  9473*            NOTFND (1950-NOT-FOUND)
  9474*        END-EXEC
  9475*    MOVE '"$''I                  ! & #00009158' TO DFHEIV0
  9476     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9478     MOVE X'2620233030303039313538' TO DFHEIV0(25:11)
  9479     CALL 'kxdfhei1' USING DFHEIV0
  9480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9481         MOVE 'N'                    TO FOUND-TOL-SW
  9482         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9483         MOVE '2'                    TO CNTL-REC-TYPE
  9484         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9485         MOVE +0                     TO CNTL-SEQ-NO
  9486         MOVE 'PROC'                 TO FILE-SWITCH
  9487         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9488         IF PI-PAYEE = 'I1' AND
  9489            APPROVAL-LEVEL-2
  9490             NEXT SENTENCE
  9491           ELSE
  9492         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 181
* EL156.cbl
  9493             MOVE ER-3546        TO EMI-ERROR
  9494             MOVE -1             TO PAYEEL
  9495             MOVE AL-UABON       TO PAYEEA
  9496             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9497
  9498     IF PI-PAYEE-TYPE = 'E'
  9499        IF PI-PMTTYPE = '5' OR '6'
  9500            NEXT SENTENCE
  9501        ELSE
  9502            MOVE ER-3539            TO EMI-ERROR
  9503            MOVE -1                 TO PAYEEL
  9504            MOVE AL-UABON           TO PAYEEA
  9505            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9506
  9507 1000-CONT-EDIT.
  9508
  9509     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9510        IF PI-EPYAMT NOT NEGATIVE
  9511            MOVE ER-0421         TO EMI-ERROR
  9512            MOVE -1              TO OFFLINEL
  9513            MOVE AL-UABON        TO OFFLINEA
  9514            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9515        ELSE
  9516            MOVE AL-UANON        TO OFFLINEA.
  9517
  9518     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9519        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9520           CONTINUE
  9521        ELSE
  9522           IF PI-PRINT-EOB-YN = 'S' AND
  9523              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
  9524                CONTINUE
  9525           ELSE
  9526              MOVE ER-1561       TO EMI-ERROR
  9527              MOVE -1            TO EOBYNL
  9528              MOVE AL-UABON      TO EOBYNA
  9529              PERFORM 9900-ERROR-FORMAT
  9530                                 THRU 9900-EXIT
  9531           END-IF
  9532        END-IF
  9533
  9534        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9535            MOVE ER-1566        TO EMI-ERROR
  9536            MOVE -1             TO CLMFMYNL
  9537            MOVE AL-UABON       TO CLMFMYNA
  9538            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9539        END-IF
  9540
  9541        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9542            MOVE ER-1567        TO EMI-ERROR
  9543            MOVE -1             TO SURVYYNL
  9544            MOVE AL-UABON       TO SURVYYNA
  9545            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9546        END-IF
  9547
  9548        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9549            MOVE ER-1569        TO EMI-ERROR
  9550            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 182
* EL156.cbl
  9551            MOVE AL-UABON       TO SPRELYNA
  9552            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9553        END-IF
  9554
  9555     END-IF
  9556     IF PI-EPYAMT IS NEGATIVE
  9557         IF PI-OFFLINE NOT = 'Y'
  9558             MOVE ER-0836        TO  EMI-ERROR
  9559             MOVE -1             TO  OFFLINEL
  9560             MOVE AL-UABON       TO  OFFLINEA
  9561             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9562
  9563     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9564        MOVE ER-0872             TO EMI-ERROR
  9565        MOVE -1                  TO PROOFDTL
  9566        MOVE AL-UABON            TO PROOFDTA
  9567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9568     ELSE
  9569        MOVE '4'                TO DC-OPTION-CODE
  9570        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9571        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9572        IF DATE-CONVERSION-ERROR
  9573            MOVE ER-0873        TO EMI-ERROR
  9574            MOVE -1                  TO PROOFDTL
  9575            MOVE AL-UABON            TO PROOFDTA
  9576            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9577        ELSE
  9578            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9579            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9580                MOVE ER-0873    TO EMI-ERROR
  9581                MOVE -1                  TO PROOFDTL
  9582                MOVE AL-UABON            TO PROOFDTA
  9583                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9584            END-IF
  9585        END-IF
  9586     END-IF.
  9587
  9588     IF PI-COMPANY-ID = 'DMD'
  9589        IF NOTE1L NOT = ZEROS
  9590            MOVE ER-7844        TO  EMI-ERROR
  9591            MOVE -1             TO  NOTE1L
  9592            MOVE AL-UABON       TO  NOTE1A
  9593            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9594
  9595     IF PI-COMPANY-ID = 'DMD'
  9596        IF NOTE2L NOT = ZEROS
  9597          GO TO 1004-DMD-EOB-CHECKS.
  9598
  9599     IF NOTE1L NOT > +0
  9600         GO TO 1005-CHECK-ERRORS.
  9601
  9602     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9603         GO TO 1005-CHECK-ERRORS.
  9604
  9605     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9606         GO TO 1003-HAN-PMT-NOTES.
  9607
  9608     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 183
* EL156.cbl
  9609
  9610     IF WS-PMTOPTION NUMERIC
  9611        IF WS-PMTOPTION > '00' AND < '17'
  9612           NEXT SENTENCE
  9613        ELSE
  9614           MOVE ER-0618          TO EMI-ERROR
  9615           MOVE -1               TO NOTE1L
  9616           MOVE AL-UABON         TO NOTE1A
  9617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9618     ELSE
  9619        GO TO 1005-CHECK-ERRORS.
  9620
  9621     IF WS-PMTOPTION = '05' AND
  9622        WS-DOCNAME = SPACES
  9623          MOVE ER-0616             TO EMI-ERROR
  9624          MOVE -1                  TO NOTE1L
  9625          MOVE AL-UABON            TO NOTE1A
  9626          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9627
  9628     IF WS-PMTOPTION = '15' OR '16'
  9629
  9630* EXEC CICS BIF DEEDIT
  9631*            FIELD (WS-AMOUNT)
  9632*            LENGTH(08)
  9633*        END-EXEC
  9634     MOVE 08
  9635       TO DFHEIV11
  9636*    MOVE '@"L                   #   #00009310' TO DFHEIV0
  9637     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9638     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9639     MOVE X'2020233030303039333130' TO DFHEIV0(25:11)
  9640     CALL 'kxdfhei1' USING DFHEIV0,
  9641           WS-AMOUNT,
  9642           DFHEIV11
  9643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9644        IF (WS-NUM-AMT = ZEROS) OR
  9645           (WS-AMOUNT NOT NUMERIC)
  9646           MOVE ER-0617          TO EMI-ERROR
  9647           MOVE -1               TO NOTE1L
  9648           MOVE AL-UABON         TO NOTE1A
  9649           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9650
  9651     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9652
  9653     GO TO 1005-CHECK-ERRORS.
  9654
  9655 1003-HAN-PMT-NOTES.
  9656
  9657     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9658
  9659     IF WS-HAN-PMT-CODE = SPACE
  9660         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9661     ELSE
  9662     IF WS-HAN-PMT-CODE = 'A'
  9663         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9664                                 TO WS-HAN-PMT-NOTE
  9665     ELSE
  9666     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 184
* EL156.cbl
  9667         MOVE ':FINAL PAYMENT / DECEASED'
  9668                                 TO WS-HAN-PMT-NOTE
  9669     ELSE
  9670     IF WS-HAN-PMT-CODE = 'C'
  9671         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9672                                 TO WS-HAN-PMT-NOTE
  9673     ELSE
  9674     IF WS-HAN-PMT-CODE = 'D'
  9675         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9676                                 TO WS-HAN-PMT-NOTE
  9677     ELSE
  9678     IF WS-HAN-PMT-CODE = 'E'
  9679         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9680                                 TO WS-HAN-PMT-NOTE
  9681     ELSE
  9682     IF WS-HAN-PMT-CODE = 'F'
  9683         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9684                                 TO WS-HAN-PMT-NOTE
  9685     ELSE
  9686     IF WS-HAN-PMT-CODE = 'P'
  9687         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9688
  9689     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9690     GO TO 1005-CHECK-ERRORS.
  9691
  9692 1004-DMD-EOB-CHECKS.
  9693
  9694     INITIALIZE PI-AT-EOB-CODES.
  9695
  9696     IF NOTE2I (20:21) > SPACES
  9697         MOVE ER-7845          TO EMI-ERROR
  9698         MOVE -1               TO NOTE2L
  9699         MOVE AL-UABON         TO NOTE2A
  9700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9701         GO TO 1005-CHECK-ERRORS
  9702      ELSE
  9703         MOVE NOTE2I             TO W-EOB-CODES.
  9704
  9705     MOVE +1                     TO W-EOB-NDX.
  9706
  9707 1004-CHECK-EACH-EOB.
  9708
  9709     IF W-EOB-NDX > +5
  9710             OR
  9711        W-EOB-CODE (W-EOB-NDX) = SPACES
  9712         GO TO 1004-CHECK-DUP-EOB.
  9713
  9714     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9715         MOVE ER-0956            TO EMI-ERROR
  9716         MOVE -1                 TO NOTE2L
  9717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9718         GO TO 1005-CHECK-ERRORS.
  9719
  9720     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9721     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9722     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9723     MOVE 'DLO023'               TO PGM-NAME.
  9724
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 185
* EL156.cbl
  9725
  9726* EXEC CICS LINK
  9727*        PROGRAM    (PGM-NAME)
  9728*        COMMAREA   (CD-COMMUNICATION-AREA)
  9729*        LENGTH     (CD-RCRD-LENGTH)
  9730*    END-EXEC.
  9731*    MOVE '."C                   (   #00009395' TO DFHEIV0
  9732     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9733     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9734     MOVE X'2020233030303039333935' TO DFHEIV0(25:11)
  9735     CALL 'kxdfhei1' USING DFHEIV0,
  9736           PGM-NAME,
  9737           CD-COMMUNICATION-AREA,
  9738           CD-RCRD-LENGTH,
  9739           DFHEIV99,
  9740           DFHEIV99,
  9741           DFHEIV99,
  9742           DFHEIV99
  9743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9744
  9745
  9746     IF CD-RETURN-CODE = 'OK'
  9747         GO TO 1004-CONT.
  9748
  9749     MOVE -1                     TO NOTE2L.
  9750
  9751     IF CD-RETURN-CODE = '01'
  9752         MOVE ER-8310            TO EMI-ERROR
  9753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9754         GO TO 1005-CHECK-ERRORS.
  9755
  9756     IF CD-RETURN-CODE = '02'
  9757         MOVE ER-8311            TO EMI-ERROR
  9758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9759         GO TO 1005-CHECK-ERRORS.
  9760
  9761     IF CD-RETURN-CODE = '03'
  9762         MOVE ER-8312            TO EMI-ERROR
  9763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9764         GO TO 1005-CHECK-ERRORS.
  9765
  9766     IF CD-RETURN-CODE = '04'
  9767         MOVE ER-8313            TO EMI-ERROR
  9768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9769         GO TO 1005-CHECK-ERRORS.
  9770
  9771     IF CD-RETURN-CODE = '05'
  9772         MOVE ER-8314            TO EMI-ERROR
  9773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9774         GO TO 1005-CHECK-ERRORS.
  9775
  9776     IF CD-RETURN-CODE = '06'
  9777         MOVE ER-8315            TO EMI-ERROR
  9778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9779         GO TO 1005-CHECK-ERRORS.
  9780
  9781     IF CD-RETURN-CODE = 'E1'
  9782         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 186
* EL156.cbl
  9783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9784         GO TO 1005-CHECK-ERRORS.
  9785
  9786     IF CD-RETURN-CODE = 'N1'
  9787         MOVE ER-8317            TO EMI-ERROR
  9788         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9789         GO TO 1005-CHECK-ERRORS.
  9790
  9791 1004-CONT.
  9792     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9793
  9794     ADD +1 TO W-EOB-NDX.
  9795     GO TO 1004-CHECK-EACH-EOB.
  9796
  9797 1004-CHECK-DUP-EOB.
  9798     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9799         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9800                               PI-AT-EOB-CODE (3) OR
  9801                               PI-AT-EOB-CODE (4) OR
  9802                               PI-AT-EOB-CODE (5)))
  9803                  OR
  9804        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9805         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9806                               PI-AT-EOB-CODE (4) OR
  9807                               PI-AT-EOB-CODE (5)))
  9808                  OR
  9809        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9810         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9811                               PI-AT-EOB-CODE (5)))
  9812                  OR
  9813        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9814         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9815            MOVE ER-8000            TO EMI-ERROR
  9816            MOVE AL-UABON           TO NOTE2A
  9817            MOVE -1                 TO NOTE2L
  9818            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9819            GO TO 1005-CHECK-ERRORS.
  9820
  9821 1005-CHECK-ERRORS.
  9822*    IF PI-COMPANY-ID NOT = 'DMD'
  9823        GO TO 1006-CHECK-ERRORS.
  9824
  9825*********  DMD CODE START ******************
  9826*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9827*       GO TO 1006-CHECK-ERRORS.
  9828*
  9829*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9830*
  9831*    COMPUTE W-PAYMENT-TOTAL
  9832*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9833*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9834*               AND
  9835*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9836*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9837*          MOVE ER-0967    TO EMI-ERROR
  9838*          MOVE -1         TO PMTTYPEL
  9839*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9840*
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 187
* EL156.cbl
  9841*    GO TO 1006-CHECK-ERRORS.
  9842*********  DMD CODE END ******************
  9843
  9844 1006-CHECK-ERRORS.
  9845     if emi-forcable-ctr = zeros
  9846        and emi-fatal-ctr = zeros
  9847        continue
  9848     else
  9849        IF NOT EMI-NO-ERRORS
  9850           GO TO 2000-EDIT-DONE
  9851        end-if
  9852     end-if
  9853
  9854* EXEC CICS HANDLE CONDITION
  9855*        NOTFND(1950-NOT-FOUND)
  9856*    END-EXEC.
  9857*    MOVE '"$I                   ! '' #00009508' TO DFHEIV0
  9858     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9859     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9860     MOVE X'2720233030303039353038' TO DFHEIV0(25:11)
  9861     CALL 'kxdfhei1' USING DFHEIV0
  9862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9863
  9864
  9865     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9866     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9867     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9868     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9869     MOVE 'MSTR'                 TO FILE-SWITCH.
  9870
  9871     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9872
  9873     IF PI-COMPANY-ID = 'DMD'
  9874         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9875
  9876     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9877        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9878           MOVE ER-0873    TO EMI-ERROR
  9879           MOVE -1                  TO PROOFDTL
  9880           MOVE AL-UABON            TO PROOFDTA
  9881           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9882        END-IF
  9883     END-IF
  9884     if cl-benefit-period = zeros
  9885        move er-1667             to emi-error
  9886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9887     end-if
  9888     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9889     MOVE +95                    TO TRLR-SEQ-NO
  9890
  9891* EXEC CICS READ
  9892*       DATASET  ('ELTRLR')
  9893*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9894*       RIDFLD   (ELTRLR-KEY)
  9895*       RESP     (WS-RESPONSE)
  9896*    END-EXEC
  9897     MOVE 'ELTRLR' TO DFHEIV1
  9898*    MOVE '&"S        E          (  N#00009537' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 188
* EL156.cbl
  9899     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9901     MOVE X'204E233030303039353337' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0,
  9903           DFHEIV1,
  9904           DFHEIV20,
  9905           DFHEIV99,
  9906           ELTRLR-KEY,
  9907           DFHEIV99,
  9908           DFHEIV99,
  9909           DFHEIV99
  9910     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9911         DFHEIV20
  9912     MOVE EIBRESP  TO WS-RESPONSE
  9913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9914
  9915     if ws-resp-normal
  9916        perform varying s1 from +1 by +1 until
  9917           at-note-error-no (s1) = spaces
  9918           if at-note-error-no (s1) = '1662'
  9919              continue
  9920           else
  9921              move at-note-error-no (s1)
  9922                                 to emi-error
  9923              if at-note-error-no (s1) = '1653'
  9924                 evaluate true
  9925                    when cl-claim-type = 'L'
  9926                       move '  LF  '
  9927                                 to emi-claim-type
  9928                    when cl-claim-type = 'I'
  9929                       move '  IU  '
  9930                                 to emi-claim-type
  9931                    when cl-claim-type = 'A'
  9932                       move '  AH  '
  9933                                 to emi-claim-type
  9934                    when cl-claim-type = 'O'
  9935                       move '  OT  '
  9936                                 to emi-claim-type
  9937                    when other
  9938                       move ' FMLA '
  9939                                 to emi-claim-type
  9940                 end-evaluate
  9941              end-if
  9942              PERFORM 9900-ERROR-FORMAT
  9943                                 THRU 9900-EXIT
  9944           end-if
  9945        end-perform
  9946     end-if
  9947     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9948         IF PI-PMTTYPE = '5' OR '6'
  9949             NEXT SENTENCE
  9950         ELSE
  9951             MOVE ER-0555             TO EMI-ERROR
  9952             MOVE -1                  TO PMTTYPEL
  9953             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9954
  9955     IF CL-LAST-CLOSE-REASON = '2'
  9956         IF CL-CLAIM-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 189
* EL156.cbl
  9957             MOVE ER-0760        TO  EMI-ERROR
  9958             MOVE -1             TO  PMTTYPEL
  9959             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9960
  9961     IF PI-ACTIVITY-CODE = 9
  9962         MOVE ER-3538            TO  EMI-ERROR
  9963         MOVE -1                 TO  PMTTYPEL
  9964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9965
  9966     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9967         GO TO 1008-READ-CERT.
  9968**********************AIG LOGIC STARTS *********************
  9969     IF CL-CERT-PRIME = 'INCOMPLETE'
  9970         MOVE ER-3540            TO  EMI-ERROR
  9971         MOVE -1                 TO  PMTTYPEL
  9972         MOVE AL-UABON           TO  PMTTYPEA
  9973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9974         GO TO 2000-EDIT-DONE.
  9975
  9976     IF PI-PMTTYPE = '4'
  9977         IF PI-EPYAMT IS NEGATIVE
  9978             IF PI-ECHECKNO-CR = 'CR'
  9979                 NEXT SENTENCE
  9980             ELSE
  9981                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9982
  9983     IF PI-PMTTYPE = '4'
  9984         IF PI-ECHECKNO-CR = 'CR'
  9985             IF PI-EPYAMT IS NEGATIVE
  9986                 NEXT SENTENCE
  9987             ELSE
  9988                 MOVE ER-0834    TO  EMI-ERROR
  9989                 MOVE -1         TO  EPYAMTL
  9990                 MOVE AL-UNBON   TO  EPYAMTA
  9991                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9992
  9993     IF PI-PMTTYPE = '4'
  9994         IF PI-EPYAMT IS NEGATIVE
  9995             IF PI-OFFLINE = 'Y'
  9996                 NEXT SENTENCE
  9997             ELSE
  9998                 MOVE 'Y'        TO  PI-OFFLINE
  9999                                     WS-OFFLINE
 10000                                     OFFLINEO
 10001                 MOVE AL-UANON   TO  OFFLINEA.
 10002
 10003*    IF PI-PMTTYPE = '4'
 10004*        IF PI-EPYAMT IS NEGATIVE
 10005*            IF PI-CASH = 'Y'
 10006*                NEXT SENTENCE
 10007*            ELSE
 10008*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
 10009*                MOVE AL-UANON   TO  CASHA
 10010*                GO TO 1007-DEFAULT-AIG-CHECKNO.
 10011*
 10012*    IF PI-CASH NOT = 'Y' AND 'N'
 10013*         IF PI-OFFLINE = 'Y'  AND
 10014*            PI-ECHECKNO-CR = 'CR'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 190
* EL156.cbl
 10015*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
 10016*              MOVE AL-UANON     TO  CASHA
 10017*              GO TO 1007-DEFAULT-AIG-CHECKNO.
 10018*
 10019*    IF PI-CASH NOT = 'Y' AND 'N'
 10020*        IF PI-PMTTYPE = '5' OR '6'
 10021*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
 10022*            MOVE AL-UANON       TO  CASHA
 10023*            GO TO 1007-DEFAULT-AIG-CHECKNO.
 10024*
 10025*    IF PI-CASH NOT = 'Y' AND 'N'
 10026*       IF CL-ASSOCIATES = 'N' OR 'A'
 10027*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
 10028*           MOVE AL-UANON        TO  CASHA
 10029*       ELSE
 10030*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
 10031*           MOVE AL-UANON        TO  CASHA.
 10032*
 10033*    IF PI-PMTTYPE = '5' OR '6'
 10034*        IF PI-CASH = 'N'
 10035*            MOVE ER-0819        TO  EMI-ERROR
 10036*            MOVE AL-UANON       TO  CASHA
 10037*            MOVE -1             TO  CASHL
 10038*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10039*
 10040*    IF CL-ASSOCIATES = 'N' OR 'A'
 10041*       IF CASHI = 'N'
 10042*        MOVE ER-3537            TO  EMI-ERROR
 10043*        MOVE AL-UANON           TO  CASHA
 10044*        MOVE -1                 TO  CASHL
 10045*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10046
 10047 1007-DEFAULT-AIG-CHECKNO.
 10048
 10049     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
 10050         MOVE ER-3532            TO  EMI-ERROR
 10051         MOVE -1                 TO  PMTTYPEL
 10052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10053**********************AIG LOGIC ENDS ***********************
 10054
 10055 1008-READ-CERT.
 10056
 10057     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10058     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10059     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10060     MOVE CL-CERT-STATE          TO CERT-STATE.
 10061     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10062     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10063     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10064     MOVE 'CERT'                 TO FILE-SWITCH.
 10065
 10066     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10067
 10068     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10069        MOVE CM-LF-LOAN-EXPIRE-DT
 10070                                 TO WS-EXP-DT PI-EXP-DT
 10071                                    ws-extended-exp-dt
 10072     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 191
* EL156.cbl
 10073        MOVE CM-AH-LOAN-EXPIRE-DT
 10074                                 TO WS-EXP-DT PI-EXP-DT
 10075                                    ws-extended-exp-dt
 10076     end-if
 10077     MOVE '6'           TO DC-OPTION-CODE
 10078     if pi-dcc-product-code not = spaces
 10079        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10080        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10081        PERFORM 0900-GET-DDF-limits
 10082                                 THRU 0900-EXIT
 10083        IF PDEF-FOUND
 10084         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10085           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10086              (P1 > +8)
 10087              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10088           END-PERFORM
 10089           IF P1 < +9
 10090              MOVE '6'           TO DC-OPTION-CODE
 10091              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10092              IF CL-NO-OF-EXTENSIONS NUMERIC
 10093               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10094                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10095                                             PI-MAX-EXT
 10096              ELSE
 10097                 MOVE PD-MAX-EXTENSION (P1)
 10098                                 TO DC-ELAPSED-MONTHS
 10099              END-IF
 10100              PERFORM 9700-LINK-DATE-CONVERT
 10101                                 THRU 9700-EXIT
 10102              if no-conversion-error
 10103                 move dc-bin-date-2 to ws-extended-exp-dt
 10104              end-if
 10105           else
 10106              move er-1674       to emi-error
 10107              PERFORM 9900-ERROR-FORMAT
 10108                                 THRU 9900-EXIT
 10109           end-if
 10110        ELSE
 10111           IF CL-NO-OF-EXTENSIONS NUMERIC
 10112              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10113                                          PI-MAX-EXT
 10114           ELSE
 10115              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10116           END-IF
 10117           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10118           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10119           if no-conversion-error
 10120              move dc-bin-date-2 to ws-extended-exp-dt
 10121           end-if
 10122        end-if
 10123     ELSE
 10124        IF CL-NO-OF-EXTENSIONS NUMERIC
 10125           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10126                                       PI-MAX-EXT
 10127        ELSE
 10128           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10129        END-IF
 10130        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 192
* EL156.cbl
 10131        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10132        if no-conversion-error
 10133           move dc-bin-date-2 to ws-extended-exp-dt
 10134        end-if
 10135     end-if
 10136*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10137*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10138
 10139     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10140         MOVE ER-0458            TO EMI-ERROR
 10141         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10142
 10143     IF (CL-INCURRED-DT > WS-EXP-DT)
 10144        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10145        MOVE ER-1677             TO EMI-ERROR
 10146        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10147     END-IF
 10148     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10149     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10150         MOVE ER-0459            TO EMI-ERROR
 10151         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10152
 10153     IF CL-REPORTED-DT = LOW-VALUES
 10154        MOVE ER-0530             TO EMI-ERROR
 10155        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10156
 10157     IF PI-COMPANY-ID = 'NCL'
 10158        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10159            MOVE ER-0770            TO EMI-ERROR
 10160            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10161
 10162     IF PI-COMPANY-ID = 'NCL'
 10163        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10164            MOVE ER-0737            TO EMI-ERROR
 10165            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10166
 10167     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10168         MOVE ER-0768            TO  EMI-ERROR
 10169         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10170
 10171     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10172         MOVE ER-0769            TO  EMI-ERROR
 10173         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10174
 10175     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10176         GO TO 1020-DO-LIFE-EDITS
 10177     ELSE
 10178         GO TO 1030-DO-AH-EDITS.
 10179
 10180 1010-GENERAL-ERROR.
 10181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10182
 10183     IF EMI-MESSAGE-FORMATTED
 10184         MOVE -1                 TO PMTTYPEL.
 10185
 10186 1010-EXIT.
 10187     EXIT.
 10188
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 193
* EL156.cbl
 10190 1020-DO-LIFE-EDITS.
 10191     IF CM-LF-BENEFIT-CD = '00'
 10192         IF PI-PMTTYPE = '5' OR '6'
 10193             MOVE ER-0658        TO EMI-ERROR
 10194             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10195         ELSE
 10196            if (pi-company-id = 'DCC' or 'VPP')
 10197               and (pi-dcc-product-code not = spaces)
 10198               continue
 10199            else
 10200               MOVE ER-1775      TO EMI-ERROR
 10201               PERFORM 1040-PMTTYPE-ERROR
 10202                                 THRU 1040-EXIT
 10203            end-if
 10204         end-if
 10205     end-if
 10206
 10207     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10208     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10209         MOVE ER-0460            TO EMI-ERROR
 10210         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10211
 10212     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10213     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10214     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10215     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10216     MOVE '4'                    TO  CNTL-REC-TYPE.
 10217     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10218     MOVE 'BENE'                 TO  FILE-SWITCH.
 10219     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10220     IF NO-BENEFIT-FOUND
 10221         GO TO 1950-NOT-FOUND.
 10222
 10223     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10224
 10225     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10226       AND NOT CM-LF-LUMP-SUM-DISAB
 10227         IF PI-PMTTYPE = '4'
 10228             IF (PI-LIFE-OVERRIDE-L1 = 'P' OR
 10229                PI-LF-COVERAGE-TYPE = 'P')
 10230               AND NOT CM-LF-LUMP-SUM-DISAB
 10231                 NEXT SENTENCE
 10232             ELSE
 10233                 MOVE ER-0461        TO EMI-ERROR
 10234                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10235         ELSE
 10236            NEXT SENTENCE
 10237     ELSE
 10238         IF PI-PMTTYPE = '2'
 10239            IF NOT CM-O-B-COVERAGE
 10240              AND CM-LF-CURRENT-STATUS = '7'
 10241                MOVE ER-0462     TO EMI-ERROR
 10242                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10243
 10244     IF PI-PMTTYPE = '2'
 10245         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10246            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10247             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 194
* EL156.cbl
 10248             MOVE ER-0730            TO  EMI-ERROR
 10249             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10250             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10251
 10252     IF PI-PMTTYPE = '2'
 10253         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10254            PI-LF-COVERAGE-TYPE = 'P'
 10255             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10256                 MOVE ER-0462    TO  EMI-ERROR
 10257                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10258
 10259     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10260       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10261         MOVE ER-0466            TO EMI-ERROR
 10262         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10263
 10264     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10265         IF PI-PMTTYPE = '3'
 10266             MOVE 0436           TO EMI-ERROR
 10267             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10268             GO TO 1045-EDIT-PAYEE-ADDR
 10269         ELSE
 10270             GO TO 1045-EDIT-PAYEE-ADDR.
 10271
 10272     IF CL-CLAIM-TYPE = 'O'
 10273         IF PI-PMTTYPE = '1' OR '2'
 10274             MOVE ER-1930          TO EMI-ERROR
 10275             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10276         END-IF
 10277     ELSE
 10278     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10279        PI-LF-COVERAGE-TYPE = 'P'
 10280         IF PI-PMTTYPE = '3'
 10281             MOVE ER-0436          TO  EMI-ERROR
 10282             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10283         ELSE
 10284             NEXT SENTENCE
 10285     ELSE
 10286         IF PI-PMTTYPE = '1' OR '3'
 10287             MOVE ER-0436            TO EMI-ERROR
 10288             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10289*
 10290     IF PI-COMPANY-ID = 'CID' AND
 10291        CL-CERT-STATE = 'SC'  AND
 10292        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10293           MOVE ER-0879    TO  EMI-ERROR
 10294           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10295           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10296     END-IF.
 10297     IF PI-COMPANY-ID = 'AHL'
 10298        evaluate true
 10299           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10300              MOVE ER-0879       TO  EMI-ERROR
 10301              PERFORM 1040-PMTTYPE-ERROR
 10302                                 THRU 1040-EXIT
 10303              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10304           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10305                 '6D' OR '6H' OR '6R'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 195
* EL156.cbl
 10306              MOVE ER-0879       TO  EMI-ERROR
 10307              PERFORM 1040-PMTTYPE-ERROR
 10308                                 THRU 1040-EXIT
 10309              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10310           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10311              MOVE ER-0879       TO  EMI-ERROR
 10312              PERFORM 1040-PMTTYPE-ERROR
 10313                                 THRU 1040-EXIT
 10314              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10315        end-evaluate
 10316     END-IF
 10317     GO TO 1045-EDIT-PAYEE-ADDR.
 10318
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 196
* EL156.cbl
 10320 1030-DO-AH-EDITS.
 10321     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10322     IF CM-AH-BENEFIT-CD = '00'
 10323         IF PI-PMTTYPE = '5' OR '6'
 10324             MOVE ER-0658        TO EMI-ERROR
 10325             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10326         ELSE
 10327             MOVE ER-1775        TO EMI-ERROR
 10328             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10329
 10330     IF CL-TOTAL-PAID-AMT = ZEROS
 10331         IF PI-PMTTYPE = '4'
 10332             MOVE ER-0438        TO EMI-ERROR
 10333             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10334
 10335     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10336         IF PI-PMTTYPE = '3'
 10337             MOVE ER-0463        TO EMI-ERROR
 10338             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10339         ELSE
 10340             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10341              AND CM-LF-CURRENT-STATUS = '7'
 10342                 MOVE ER-0465    TO EMI-ERROR
 10343                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10344
 10345     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10346         IF PI-PMTTYPE = '3'
 10347             MOVE ER-0464        TO EMI-ERROR
 10348             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10349         ELSE
 10350             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10351                 MOVE ER-0469    TO EMI-ERROR
 10352                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10353
 10354     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10355         IF PI-PMTTYPE = '3'
 10356             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10357                 MOVE ER-0467    TO EMI-ERROR
 10358                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10359             ELSE
 10360                 NEXT SENTENCE
 10361         ELSE
 10362             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10363                 MOVE ER-0468    TO EMI-ERROR
 10364                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10365
 10366     IF PI-PMTTYPE = '2'
 10367        PERFORM WITH TEST AFTER
 10368         VARYING SUB FROM +1 BY +5
 10369          UNTIL SUB > +60
 10370            OR PI-PMTNOTE2(SUB:1) = 'F'
 10371            OR PI-PMTNOTE2(SUB:1) NOT > SPACES
 10372        END-PERFORM
 10373        IF PI-PMTNOTE2(SUB:1) NOT = 'F'
 10374           MOVE ER-3551    TO EMI-ERROR
 10375           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10376        END-IF
 10377     END-IF.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 197
* EL156.cbl
 10378     GO TO 1045-EDIT-PAYEE-ADDR.
 10379
 10380 1040-PMTTYPE-ERROR.
 10381     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10382
 10383     IF EMI-MESSAGE-FORMATTED
 10384         MOVE -1                 TO PMTTYPEL
 10385         MOVE AL-UABON           TO PMTTYPEA.
 10386
 10387 1040-EXIT.
 10388     EXIT.
 10389
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 198
* EL156.cbl
 10391 1045-EDIT-PAYEE-ADDR.
 10392
 10393     IF PI-OFFLINE = 'N' AND
 10394        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10395           < PI-PAYEE-SEQ-NUM)
 10396        OR
 10397         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10398         (PI-PAYEE-TYPE = 'B')                 AND
 10399         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10400        OR
 10401         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10402           < PI-PAYEE-SEQ-NUM)
 10403        OR
 10404         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10405           < PI-PAYEE-SEQ-NUM)
 10406        OR
 10407         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10408           < PI-PAYEE-SEQ-NUM)
 10409        OR
 10410         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10411           < PI-PAYEE-SEQ-NUM)
 10412        OR
 10413         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10414           < PI-PAYEE-SEQ-NUM))
 10415             MOVE ER-0437        TO EMI-ERROR
 10416             MOVE -1             TO PAYEEL
 10417             MOVE AL-UABON       TO PAYEEA
 10418             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10419
 10420     IF PI-OFFLINE    = 'N' AND
 10421        PI-PAYEE-TYPE = 'B' AND
 10422        PI-PAYEE-SEQ  = '0'
 10423         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10424         IF BENE-FOUND-SW = 'N'
 10425             MOVE ER-0437        TO EMI-ERROR
 10426             MOVE -1             TO PAYEEL
 10427             MOVE AL-UABON       TO PAYEEA
 10428             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10429
 10430     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10431        IF PI-OFFLINE    = 'N'  AND
 10432           PI-PAYEE-TYPE = 'B'  AND
 10433           PI-PAYEE-SEQ  = '9'
 10434             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10435             IF BENE-FOUND-SW = 'N'
 10436                MOVE ER-0437        TO EMI-ERROR
 10437                MOVE -1             TO PAYEEL
 10438                MOVE AL-UABON       TO PAYEEA
 10439                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10440
 10441*    IF PI-COMPANY-ID = 'CRI'
 10442*        IF CL-CLAIM-TYPE = 'L'
 10443*            MOVE 'N'                TO  WS-GROUPED
 10444*                                        PI-GROUPED
 10445*                                        GROUPEDI
 10446*            MOVE AL-UANON           TO  GROUPEDA
 10447*            GO TO 1050-EDIT-CHECK-NO
 10448*        ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 199
* EL156.cbl
 10449*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10450*            IF WS-GROUP-1 = 'C'
 10451*                NEXT SENTENCE
 10452*            ELSE
 10453*                MOVE 'N'            TO  WS-GROUPED
 10454*                                        PI-GROUPED
 10455*                                        GROUPEDI
 10456*                MOVE AL-UANON       TO  GROUPEDA
 10457*                GO TO 1050-EDIT-CHECK-NO.
 10458
 10459*     IF PI-GROUPED = 'Y'
 10460*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10461*           NEXT SENTENCE
 10462*        ELSE
 10463*           MOVE ER-0437        TO EMI-ERROR
 10464*           MOVE -1             TO PAYEEL
 10465**02180            MOVE AL-UABON       TO PAYEEA
 10466*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10467*
 10468*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10469*        (PI-GROUPED    = ' ')
 10470*        NEXT SENTENCE
 10471*     ELSE
 10472*
 10473     GO TO 1050-EDIT-CHECK-NO.
 10474*     IF PI-COMPANY-ID = 'CRI'
 10475*        MOVE 'N'           TO GROUPEDI
 10476*                              PI-GROUPED
 10477*                              WS-GROUPED
 10478*        MOVE AL-UANON      TO GROUPEDA.
 10479*
 10480*     IF PI-COMPANY-ID = 'CRI'
 10481*        IF PI-PAYEE-TYPE = 'B'
 10482*           IF BENE-FOUND-SW = 'Y'
 10483*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10484*                 MOVE 'Y'           TO GROUPEDI
 10485*                                       PI-GROUPED
 10486*                                       WS-GROUPED
 10487*                 MOVE AL-UANON      TO GROUPEDA
 10488*              ELSE
 10489*                 NEXT SENTENCE
 10490*           ELSE
 10491*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10492*              IF BENE-FOUND-SW = 'Y'
 10493*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10494*                    MOVE 'Y'      TO GROUPEDI
 10495*                                     PI-GROUPED
 10496*                                     WS-GROUPED
 10497*                    MOVE AL-UANON TO GROUPEDA.
 10498*
 10499
 10500     IF PI-COMPANY-ID NOT = 'CRI'
 10501        GO TO 1050-EDIT-CHECK-NO.
 10502
 10503*************** CRI CODE START ******************
 10504     IF PI-PAYEE-TYPE NOT = 'A'
 10505        GO TO 1050-EDIT-CHECK-NO.
 10506
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 200
* EL156.cbl
 10507     MOVE LOW-VALUES             TO ERACCT-KEY.
 10508     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10509     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10510     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10511     MOVE PI-STATE               TO ACCT-STATE.
 10512     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10513     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10514     MOVE 'ACCT'                 TO FILE-SWITCH.
 10515
 10516     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10517     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10518
 10519
 10520* EXEC CICS HANDLE CONDITION
 10521*         NOTFND   (1950-NOT-FOUND)
 10522*         ENDFILE  (1950-NOT-FOUND)
 10523*    END-EXEC.
 10524*    MOVE '"$I''                  ! ( #00010148' TO DFHEIV0
 10525     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10527     MOVE X'2820233030303130313438' TO DFHEIV0(25:11)
 10528     CALL 'kxdfhei1' USING DFHEIV0
 10529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10530
 10531
 10532
 10533* EXEC CICS STARTBR
 10534*         DATASET   ('ERACCT')
 10535*         RIDFLD    (ERACCT-KEY)
 10536*         GTEQ
 10537*    END-EXEC.
 10538     MOVE 'ERACCT' TO DFHEIV1
 10539     MOVE 0
 10540       TO DFHEIV11
 10541*    MOVE '&,         G          &   #00010153' TO DFHEIV0
 10542     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10544     MOVE X'2020233030303130313533' TO DFHEIV0(25:11)
 10545     CALL 'kxdfhei1' USING DFHEIV0,
 10546           DFHEIV1,
 10547           ERACCT-KEY,
 10548           DFHEIV99,
 10549           DFHEIV11,
 10550           DFHEIV99
 10551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10552
 10553
 10554 1046-READNEXT-ERACCT.
 10555
 10556
 10557* EXEC CICS READNEXT
 10558*         DATASET   ('ERACCT')
 10559*         RIDFLD    (ERACCT-KEY)
 10560*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10561*    END-EXEC.
 10562     MOVE 'ERACCT' TO DFHEIV1
 10563     MOVE 0
 10564       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 201
* EL156.cbl
 10565*    MOVE '&.S                   )   #00010161' TO DFHEIV0
 10566     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10567     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10568     MOVE X'2020233030303130313631' TO DFHEIV0(25:11)
 10569     CALL 'kxdfhei1' USING DFHEIV0,
 10570           DFHEIV1,
 10571           DFHEIV20,
 10572           DFHEIV99,
 10573           ERACCT-KEY,
 10574           DFHEIV99,
 10575           DFHEIV11,
 10576           DFHEIV99,
 10577           DFHEIV99
 10578     SET ADDRESS OF ACCOUNT-MASTER TO
 10579         DFHEIV20
 10580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10581
 10582
 10583     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10584        IF WS-ERACCT-HOLD-RECORD = SPACES
 10585           GO TO 1950-NOT-FOUND
 10586        ELSE
 10587           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10588           GO TO 1048-CONTINUE.
 10589
 10590     IF ACCT-EXP-DT = HIGH-VALUES
 10591        NEXT SENTENCE
 10592     ELSE
 10593        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10594        GO TO 1046-READNEXT-ERACCT.
 10595
 10596 1048-CONTINUE.
 10597
 10598*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10599*       MOVE 'Y'                 TO GROUPEDI
 10600*                                   PI-GROUPED
 10601*                                   WS-GROUPED
 10602*       MOVE AL-UANON            TO GROUPEDA.
 10603*************** CRI CODE END ******************
 10604
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 202
* EL156.cbl
 10606 1050-EDIT-CHECK-NO.
 10607
 10608     IF PI-OFFLINE = 'Y'
 10609         IF PI-ECHECKNO = SPACES
 10610              MOVE ER-0439        TO EMI-ERROR
 10611              GO TO 1090-CHECK-NO-ERROR
 10612           ELSE
 10613*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10614*           IF PI-ECHECKNO-N = 'N' AND
 10615*              PI-CASH       = 'Y'
 10616*                MOVE ER-3535        TO EMI-ERROR
 10617*                GO TO 1090-CHECK-NO-ERROR
 10618*             ELSE
 10619*                MOVE AL-UANON    TO CHECKNOA
 10620*                GO TO 1100-EDIT-HOLDTIL
 10621*         ELSE
 10622            MOVE AL-UANON    TO CHECKNOA
 10623            GO TO 1100-EDIT-HOLDTIL.
 10624
 10625     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10626     MOVE '6'                    TO CNTL-REC-TYPE.
 10627
 10628     IF CONTROL-IS-ACTUAL-CARRIER
 10629         MOVE PI-CARRIER         TO WS-CARR
 10630     ELSE
 10631         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10632
 10633     IF PI-COMPANY-ID = 'FIA'
 10634         MOVE PI-CARRIER         TO WS-CARR.
 10635
 10636     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10637     MOVE 0                      TO CNTL-SEQ-NO.
 10638     MOVE 'CARR'                 TO FILE-SWITCH.
 10639
 10640     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10641
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 203
* EL156.cbl
 10643     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10644         GO TO 1051-EDIT-CHECKNO-CONT.
 10645
 10646**********************AIG LOGIC STARTS**********************
 10647     IF PI-ECHECKNO = SPACES
 10648         IF CHECK-NO-MANUAL
 10649             MOVE ER-0441        TO EMI-ERROR
 10650             GO TO 1090-CHECK-NO-ERROR
 10651         ELSE
 10652             MOVE AL-UANOF       TO CHECKNOA
 10653             GO TO 1100-EDIT-HOLDTIL.
 10654
 10655     IF PI-ECHECKNO NOT = SPACES
 10656         IF CHECK-NO-MANUAL
 10657             MOVE AL-UANON       TO CHECKNOA
 10658             GO TO 1100-EDIT-HOLDTIL.
 10659
 10660     IF PI-ECHECKNO-CR = 'CR'
 10661        IF PI-OFFLINE = 'Y'
 10662            MOVE AL-UANON       TO CHECKNOA
 10663            GO TO 1100-EDIT-HOLDTIL
 10664        ELSE
 10665            MOVE ER-3534        TO EMI-ERROR
 10666            GO TO 1090-CHECK-NO-ERROR.
 10667
 10668     IF PI-ECHECKNO-N = 'N'
 10669        IF PI-CASH = 'N'
 10670            MOVE AL-UANON       TO CHECKNOA
 10671            GO TO 1100-EDIT-HOLDTIL
 10672        ELSE
 10673            MOVE ER-3535          TO EMI-ERROR
 10674            GO TO 1090-CHECK-NO-ERROR.
 10675
 10676     MOVE ER-0442        TO EMI-ERROR
 10677     GO TO 1090-CHECK-NO-ERROR.
 10678**********************AIG LOGIC ENDS************************
 10679
 10680 1051-EDIT-CHECKNO-CONT.
 10681
 10682     IF PI-COMPANY-ID = 'DMD'
 10683        IF PI-ECHECKNO NOT = SPACES
 10684           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10685              MOVE ER-0442        TO EMI-ERROR
 10686              GO TO 1090-CHECK-NO-ERROR
 10687            ELSE
 10688              GO TO 1100-EDIT-HOLDTIL
 10689          ELSE
 10690           GO TO 1100-EDIT-HOLDTIL.
 10691
 10692     IF PI-ECHECKNO = SPACES
 10693         IF CHECK-NO-MANUAL
 10694             MOVE ER-0441        TO EMI-ERROR
 10695             GO TO 1090-CHECK-NO-ERROR
 10696         ELSE
 10697             MOVE AL-UANOF       TO CHECKNOA
 10698             GO TO 1100-EDIT-HOLDTIL
 10699     ELSE
 10700         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 204
* EL156.cbl
 10701             MOVE AL-UANON       TO CHECKNOA
 10702             GO TO 1100-EDIT-HOLDTIL
 10703         ELSE
 10704             MOVE ER-0442        TO EMI-ERROR
 10705             GO TO 1090-CHECK-NO-ERROR.
 10706
 10707 1090-CHECK-NO-ERROR.
 10708     MOVE -1                     TO CHECKNOL.
 10709     MOVE AL-UABON               TO CHECKNOA.
 10710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10711
 10712     GO TO 2000-EDIT-DONE.
 10713
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 205
* EL156.cbl
 10715 1100-EDIT-HOLDTIL.
 10716     MOVE ZERO TO WS-TOT-AMOUNT-PAID
 10717                  WS-UNPD-HOLD-UNTIL-DT
 10718     SET HOLD-UNTIL-CHK TO TRUE
 10719     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10720     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10721     IF CL-TOTAL-PAID-AMT NOT = WS-TOT-AMOUNT-PAID
 10722         MOVE ER-3277            TO EMI-ERROR
 10723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10724     END-IF
 10725
 10726     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10727
 10728     MOVE AL-UANON               TO HOLDTILA.
 10729
 10730     IF PI-HOLDTIL = ZEROS
 10731        IF PI-OFFLINE = 'Y'
 10732           MOVE ER-0572          TO EMI-ERROR
 10733           GO TO 1105-HOLDTIL-ERROR
 10734        ELSE
 10735           GO TO 1110-EDIT-PAID-FROM.
 10736
 10737     MOVE '4'                    TO DC-OPTION-CODE.
 10738     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10739     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10740
 10741     IF DATE-CONVERSION-ERROR
 10742         MOVE ER-0446            TO EMI-ERROR
 10743         GO TO 1105-HOLDTIL-ERROR
 10744     END-IF
 10745     IF PI-OFFLINE = 'Y'
 10746        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10747           MOVE ER-0446            TO EMI-ERROR
 10748           GO TO 1105-HOLDTIL-ERROR
 10749        END-IF
 10750     END-IF
 10751
 10752     IF DC-BIN-DATE-1 < WS-UNPD-HOLD-UNTIL-DT
 10753        MOVE ER-3278          TO EMI-ERROR
 10754        GO TO 1105-HOLDTIL-ERROR
 10755     END-IF
 10756
 10757     IF PI-OFFLINE = 'Y'
 10758        GO TO 1110-EDIT-PAID-FROM.
 10759
 10760     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10761     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10762     MOVE '1'                    TO DC-OPTION-CODE.
 10763     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10764
 10765*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10766     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10767         MOVE ER-0447            TO EMI-ERROR
 10768         GO TO 1105-HOLDTIL-ERROR.
 10769
 10770     GO TO 1110-EDIT-PAID-FROM.
 10771
 10772 1105-HOLDTIL-ERROR.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 206
* EL156.cbl
 10773     MOVE -1                     TO HOLDTILL.
 10774     MOVE AL-UNBON               TO HOLDTILA.
 10775     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10776
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 207
* EL156.cbl
 10778 1110-EDIT-PAID-FROM.
 10779     MOVE AL-UANON               TO EPYFROMA.
 10780
 10781     IF PI-EPYFROM = ZEROS
 10782         GO TO 1120-CALCULATE-PAID-FROM.
 10783
 10784     IF PI-PMTTYPE = '5' OR '6'
 10785         MOVE ER-0448            TO EMI-ERROR
 10786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10787         MOVE AL-UNBON           TO EPYFROMA
 10788         MOVE -1                 TO EPYFROML
 10789         GO TO 1150-EDIT-PAID-THRU.
 10790
 10791     MOVE '4'                    TO DC-OPTION-CODE.
 10792     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10793     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10794
 10795     IF DATE-CONVERSION-ERROR
 10796         MOVE ER-0449            TO EMI-ERROR
 10797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10798         MOVE AL-UNBON           TO EPYFROMA
 10799         MOVE -1                 TO EPYFROML
 10800     ELSE
 10801         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10802
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 208
* EL156.cbl
 10804 1120-CALCULATE-PAID-FROM.
 10805     IF PI-PMTTYPE = '5' OR '6'
 10806         GO TO 1150-EDIT-PAID-THRU.
 10807
 10808*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10809*       IF PI-PMTTYPE = '4'
 10810*         GO TO 1150-EDIT-PAID-THRU.
 10811
 10812     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10813         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10814         MOVE ' '                TO DC-OPTION-CODE
 10815         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10816         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10817         GO TO 1145-TEST-PAID-FROM.
 10818
 10819     IF PI-PMTTYPE = '4'
 10820        GO TO 1150-EDIT-PAID-THRU.
 10821
 10822     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10823     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10824     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10825     MOVE '5'                    TO CNTL-REC-TYPE.
 10826     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10827     MOVE 'BENE'                 TO FILE-SWITCH.
 10828
 10829     IF WS-BEN-CD = ZEROS
 10830         GO TO 1950-NOT-FOUND.
 10831
 10832     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10833
 10834     IF NO-BENEFIT-FOUND
 10835         GO TO 1950-NOT-FOUND.
 10836
 10837     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10838     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10839
 10840     IF PI-BEN-DAYS NOT NUMERIC
 10841        MOVE ZEROS               TO PI-BEN-DAYS.
 10842
 10843     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10844
 10845     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10846         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10847         MOVE '6'                 TO DC-OPTION-CODE
 10848         MOVE +0                  TO DC-ELAPSED-MONTHS
 10849         MOVE +1                  TO DC-ELAPSED-DAYS
 10850         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10851         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10852         GO TO 1145-TEST-PAID-FROM.
 10853
 10854     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10855        (CL-TOTAL-PAID-AMT > ZEROS)
 10856         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10857         MOVE '6'                 TO DC-OPTION-CODE
 10858         MOVE +0                  TO DC-ELAPSED-MONTHS
 10859         MOVE +1                  TO DC-ELAPSED-DAYS
 10860         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10861         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 209
* EL156.cbl
 10862         GO TO 1145-TEST-PAID-FROM.
 10863
 10864******************************************************************
 10865****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10866****** SPECIAL ENTERED DATE.
 10867******************************************************************
 10868
 10869     IF PI-AIGFROM = ZEROS
 10870         GO TO 1130-CONTINUE-PAID-FROM.
 10871
 10872     MOVE AL-UANON TO AIGFROMA.
 10873
 10874     MOVE '4'                    TO DC-OPTION-CODE.
 10875     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10876     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10877
 10878     IF DATE-CONVERSION-ERROR
 10879         MOVE ER-0449            TO EMI-ERROR
 10880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10881         MOVE AL-UNBON           TO AIGFROMA
 10882         MOVE -1                 TO AIGFROML
 10883         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10884     ELSE
 10885         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10886         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10887
 10888     GO TO 1140-CONTINUE-PAID-FROM.
 10889
 10890 1130-CONTINUE-PAID-FROM.
 10891
 10892     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10893        (CL-TOTAL-PAID-AMT = ZEROS)
 10894           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10895
 10896 1140-CONTINUE-PAID-FROM.
 10897
 10898     IF PI-BEN-TYPE = 'R'
 10899         IF PI-BEN-DAYS = ZEROS
 10900             NEXT SENTENCE
 10901         ELSE
 10902         IF PI-COMPANY-ID NOT = 'DMD'
 10903             SUBTRACT 1 FROM PI-BEN-DAYS.
 10904
 10905     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10906
 10907     IF PI-COMPANY-ID = 'DMD'
 10908         MOVE -1                 TO DC-ELAPSED-DAYS
 10909         MOVE +0                 TO DC-ELAPSED-MONTHS
 10910         MOVE '6'                TO DC-OPTION-CODE
 10911         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10912         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10913         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10914                               REMAINDER DC-ELAPSED-DAYS
 10915      ELSE
 10916         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10917         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10918
 10919     MOVE '6'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 210
* EL156.cbl
 10920     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10921     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10922
 10923     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10924
 10925     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10926         MOVE ER-0541            TO EMI-ERROR
 10927         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10928         MOVE -1                 TO EPYFROML
 10929         MOVE AL-UNBON           TO EPYFROMA.
 10930
 10931     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10932        (PI-BENEFIT-SAVE = '60E')
 10933        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10934           (CL-TOTAL-PAID-AMT = ZEROS)
 10935             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10936             MOVE 30                  TO DC-ELAPSED-DAYS
 10937             MOVE +0                  TO DC-ELAPSED-MONTHS
 10938             MOVE '6'                 TO DC-OPTION-CODE
 10939             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10940
 10941     IF PI-BEN-TYPE = 'R'
 10942         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10943     ELSE
 10944         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10945         IF WS-SV-EPYFROM = LOW-VALUES
 10946            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10947
 10948     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10949         IF WS-USE-AIG-PAYFROM   OR
 10950            WS-AIG-RECALC-PAYFROM
 10951              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10952                                      DC-BIN-DATE-1
 10953              MOVE ' '            TO  DC-OPTION-CODE
 10954              MOVE +0             TO  DC-ELAPSED-MONTHS
 10955                                      DC-ELAPSED-DAYS
 10956              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10957              IF NO-CONVERSION-ERROR
 10958                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10959
 10960     IF PI-CPYFROM < CL-INCURRED-DT
 10961        MOVE -1                  TO EPYFROML
 10962        MOVE ER-3542             TO EMI-ERROR
 10963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10964
 10965     IF CM-ENTRY-DT < CL-INCURRED-DT
 10966        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10967        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10968        MOVE +0                     TO DC-ELAPSED-DAYS
 10969        MOVE +0                     TO DC-ELAPSED-MONTHS
 10970        MOVE '1'                    TO DC-OPTION-CODE
 10971        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10972        ELSE
 10973        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10974
 10975     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10976         NEXT SENTENCE
 10977     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 211
* EL156.cbl
 10978         IF DC-ELAPSED-MONTHS < 2
 10979             MOVE ER-3255        TO EMI-ERROR
 10980             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10981
 10982 1145-TEST-PAID-FROM.
 10983     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10984         GO TO 1150-EDIT-PAID-THRU.
 10985
 10986     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10987         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10988         MOVE ' '                TO DC-OPTION-CODE
 10989         MOVE +0                 TO DC-ELAPSED-MONTHS
 10990                                    DC-ELAPSED-DAYS
 10991         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10992         IF NO-CONVERSION-ERROR
 10993             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10994         ELSE
 10995             MOVE SPACES             TO EMI-DATE-FIELD.
 10996
 10997     IF PI-HOLDTIL NOT = ZEROS
 10998        CONTINUE
 10999     ELSE
 11000     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 11001         IF CL-TOTAL-PAID-AMT = ZEROS
 11002             MOVE ER-3543            TO EMI-ERROR
 11003             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 11004             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11005             IF EMI-MESSAGE-FORMATTED
 11006                MOVE -1             TO EPYFROML
 11007                MOVE AL-UNBON       TO EPYFROMA
 11008             ELSE
 11009                NEXT SENTENCE
 11010         ELSE
 11011             MOVE ER-0452            TO EMI-ERROR
 11012             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 11013             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11014             IF EMI-MESSAGE-FORMATTED
 11015                MOVE -1             TO EPYFROML
 11016                MOVE AL-UNBON       TO EPYFROMA.
 11017
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 212
* EL156.cbl
 11019 1150-EDIT-PAID-THRU.
 11020
 11021     MOVE AL-UANON               TO EPYTHRUA.
 11022
 11023     IF PI-EPYTHRU = ZEROS
 11024*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 11025         IF PI-PMTTYPE = '5' OR '6'
 11026           OR (CL-CLAIM-TYPE NOT = 'L' AND 'O'
 11027             AND PI-PMTTYPE = '4')
 11028             GO TO 1200-EDIT-FIND-TOLERANCES
 11029         ELSE
 11030            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 11031               (PI-PMTTYPE = '2' AND
 11032                 CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 11033               GO TO 1152-CHECK-TYPE
 11034            ELSE
 11035               MOVE ER-0473      TO EMI-ERROR
 11036               GO TO 1170-PAID-THRU-FATAL-ERROR
 11037     ELSE
 11038         IF PI-PMTTYPE = '5' OR '6'
 11039             MOVE ER-0474        TO EMI-ERROR
 11040             GO TO 1170-PAID-THRU-FATAL-ERROR.
 11041
 11042     MOVE '4'                    TO DC-OPTION-CODE.
 11043     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 11044     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11045
 11046     IF DATE-CONVERSION-ERROR
 11047         MOVE ER-0475            TO EMI-ERROR
 11048         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11049
 11050     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 11051
 11052     IF PI-COMPANY-ID = 'DMD'
 11053         IF PI-PMTTYPE NOT = '2'
 11054                 AND
 11055            WS-EXP-DT > WS-SV-EPYTHRU
 11056             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 11057             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 11058             MOVE '1'              TO DC-OPTION-CODE
 11059             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11060             IF DATE-CONVERSION-ERROR
 11061                 MOVE ER-0944      TO EMI-ERROR
 11062                 GO TO 1170-PAID-THRU-FATAL-ERROR
 11063             ELSE
 11064                 IF DC-ELAPSED-MONTHS = ZEROS AND
 11065                    DC-ELAPSED-DAYS   = 1
 11066                     MOVE ER-0945  TO EMI-ERROR
 11067                     MOVE -1       TO EPYTHRUL
 11068                     MOVE AL-UABON TO EPYTHRUA
 11069                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11070
 11071     IF PI-PMTTYPE = '4'
 11072         NEXT SENTENCE
 11073     ELSE
 11074         IF WS-SV-EPYTHRU = WS-EXP-DT
 11075             IF PI-PMTTYPE NOT = '2' AND '3'
 11076                 MOVE ER-3541    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 213
* EL156.cbl
 11077                 MOVE -1         TO PMTTYPEL
 11078                 MOVE AL-UABON   TO PMTTYPEA
 11079                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11080
 11081     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 11082         MOVE ER-0501            TO EMI-ERROR
 11083         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11084
 11085     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 11086        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 11087*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11088*              MOVE ER-0540         TO EMI-ERROR
 11089*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11090*              MOVE -1              TO EPYTHRUL
 11091*              MOVE AL-UNBON        TO EPYTHRUA
 11092*          ELSE
 11093*          IF PI-COMPANY-ID = 'DMD'
 11094*              MOVE ER-7540         TO EMI-ERROR
 11095*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11096*              MOVE -1              TO EPYTHRUL
 11097*              MOVE AL-UNBON        TO EPYTHRUA
 11098*          ELSE
 11099               IF PI-PMTTYPE NOT = '2' AND '3'
 11100                  IF PI-COMPANY-ID = '???'
 11101                      MOVE ER-7540  TO EMI-ERROR
 11102                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11103                      MOVE -1       TO EPYTHRUL
 11104                      MOVE AL-UNBON TO EPYTHRUA
 11105                  ELSE
 11106                      MOVE ER-0540  TO EMI-ERROR
 11107                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11108                      MOVE -1       TO EPYTHRUL
 11109                      MOVE AL-UNBON TO EPYTHRUA.
 11110
 11111     MOVE 'N' TO PI-DUPE-APPROVAL-NEEDED
 11112     IF ((WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11113            OR
 11114        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11115         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11116            OR
 11117        (PI-CPYFROM NOT = LOW-VALUES AND
 11118         PI-CPYFROM < CL-PAID-THRU-DT))
 11119       AND NOT PI-PMTTYPE = '4'
 11120        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT
 11121     ELSE
 11122     IF WS-SV-EPYTHRU NOT = LOW-VALUES
 11123       AND WS-SV-EPYFROM NOT = LOW-VALUES
 11124        SET CHECK-ALL-PMTS TO TRUE
 11125        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11126
 11127     IF PI-HOLDTIL = ZEROS
 11128       AND UNPAID-HOLD-UNTIL-EXISTS
 11129       AND NOT DUPE-VOID-PMT-EXISTS
 11130        MOVE ER-3276    TO EMI-ERROR
 11131        MOVE -1         TO HOLDTILL
 11132        MOVE AL-UABON   TO HOLDTILA
 11133        GO TO 1170-PAID-THRU-FATAL-ERROR
 11134     END-IF.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 214
* EL156.cbl
 11135
 11136 1152-CHECK-TYPE.
 11137     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11138        OR (PI-PMTTYPE = '5' OR '6')
 11139         GO TO 1160-EDIT-PAID-THRU-AH.
 11140
 11141 1155-EDIT-PAID-THRU-LIFE.
 11142     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11143     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11144     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11145     MOVE '4'                    TO CNTL-REC-TYPE.
 11146     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11147     MOVE 'BENE'                 TO FILE-SWITCH.
 11148
 11149     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11150
 11151     IF NO-BENEFIT-FOUND
 11152         GO TO 1950-NOT-FOUND.
 11153
 11154     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11155
 11156     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11157
 11158     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11159        PI-LF-COVERAGE-TYPE = 'P'
 11160         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11161         GO TO 1200-EDIT-FIND-TOLERANCES.
 11162
 11163     IF PI-EPYTHRU = ZEROS
 11164        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11165
 11166     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11167         MOVE ER-0476            TO EMI-ERROR
 11168         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11169
 11170     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11171*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11172     move cl-critical-period    to dc-elapsed-months
 11173     MOVE +0                    TO DC-ELAPSED-DAYS.
 11174     MOVE '6'                   TO DC-OPTION-CODE.
 11175     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11176
 11177     IF (NO-CONVERSION-ERROR AND
 11178         WS-SPECIAL-CALC-CD = 'C')
 11179        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11180            MOVE ER-0657 TO EMI-ERROR
 11181            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11182
 11183     IF PI-COMPANY-ID = 'NCL'
 11184         IF WS-SPECIAL-CALC-CD = 'C' AND
 11185            cl-critical-period = zeros
 11186*           CM-LF-CRITICAL-PERIOD = +0
 11187             MOVE ER-0844       TO EMI-ERROR
 11188             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11189
 11190     GO TO 1200-EDIT-FIND-TOLERANCES.
 11191
 11192 1160-EDIT-PAID-THRU-AH.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 215
* EL156.cbl
 11193     IF PI-EPYTHRU = ZEROS
 11194        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11195                                    WS-SV-EPYTHRU
 11196     ELSE
 11197        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11198
 11199     IF WS-SV-EPYTHRU < PI-CPYFROM
 11200         MOVE ER-0508            TO EMI-ERROR
 11201         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11202
 11203     perform 7975-read-acct      thru 7975-exit
 11204     move zeros                  to pi-max-ext
 11205     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11206        PERFORM 0900-GET-DDF-LIMITS
 11207                                 THRU 0900-EXIT
 11208        IF PDEF-FOUND
 11209           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11210              (P1 > +8)
 11211              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11212           END-PERFORM
 11213           IF P1 < +9
 11214              MOVE PD-MAX-extension (P1)
 11215                                 TO pi-max-ext
 11216           else
 11217              move er-1674       to emi-error
 11218              PERFORM 9900-ERROR-FORMAT
 11219                                 THRU 9900-EXIT
 11220           END-IF
 11221        else
 11222           move er-1672          to emi-error
 11223           PERFORM 9900-ERROR-FORMAT
 11224                                 THRU 9900-EXIT
 11225        END-IF
 11226     end-if
 11227     move spaces                 to pi-max-ext-used
 11228     IF PI-PMTTYPE = '3'
 11229        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11230        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11231           MOVE ER-0477          TO EMI-ERROR
 11232           PERFORM 1165-PAID-THRU-ERROR
 11233                                 THRU 1165-EXIT
 11234        ELSE
 11235           continue
 11236        end-if
 11237     ELSE
 11238        IF WS-SV-EPYTHRU > WS-EXP-DT
 11239         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11240           move ws-exp-dt        to dc-bin-date-1
 11241           move ws-sv-epythru    to dc-bin-date-2
 11242           MOVE '1'              TO DC-OPTION-CODE
 11243           MOVE +0               TO DC-ELAPSED-DAYS
 11244                                    DC-ELAPSED-MONTHS
 11245           PERFORM 9700-LINK-DATE-CONVERT
 11246                                 THRU 9700-EXIT
 11247           if no-conversion-error
 11248              if dc-elapsed-days > zeros
 11249                 add +1 to dc-elapsed-months
 11250              end-if
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 216
* EL156.cbl
 11251              if dc-elapsed-months > pi-max-ext
 11252                 MOVE ER-0557    TO EMI-ERROR
 11253                 PERFORM 1165-PAID-THRU-ERROR
 11254                                 THRU 1165-EXIT
 11255              else
 11256                 move 'Y'        to pi-max-ext-used
 11257                 move er-1670    to emi-error
 11258                 perform 9900-error-format
 11259                                 thru 9900-exit
 11260              end-if
 11261           end-if
 11262         ELSE
 11263            MOVE ER-0557    TO EMI-ERROR
 11264            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11265         END-IF
 11266        end-if
 11267     end-if
 11268
 11269     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11270         PI-PMTTYPE NOT = '3'
 11271         MOVE ER-0541        TO EMI-ERROR
 11272         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11273
 11274     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11275        (PI-PMTTYPE NOT = '3')
 11276         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11277             MOVE ER-0478        TO EMI-ERROR
 11278             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11279
 11280     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11281        (PI-PMTTYPE NOT = '4')
 11282         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11283             MOVE ER-0479        TO EMI-ERROR
 11284             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11285
 11286     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11287         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11288             MOVE ER-0545        TO EMI-ERROR
 11289             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11290
 11291     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11292         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11293             MOVE ER-0481        TO EMI-ERROR
 11294             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11295
 11296*    IF PI-COMPANY-ID = 'NCL'
 11297*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11298*           CM-AH-CRITICAL-PERIOD = +0
 11299*            MOVE ER-0844        TO  EMI-ERROR
 11300*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11301
 11302*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11303     if (cl-critical-period = zeros)
 11304        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11305          GO TO 1200-EDIT-FIND-TOLERANCES.
 11306
 11307     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11308     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 217
* EL156.cbl
 11309     MOVE '1'        TO DC-OPTION-CODE.
 11310     MOVE +0         TO DC-ELAPSED-DAYS
 11311                        DC-ELAPSED-MONTHS.
 11312     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11313
 11314*    IF NO-CONVERSION-ERROR
 11315*       COMPUTE ws-benefits-paid =
 11316*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11317*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11318*           MOVE ER-0657 TO EMI-ERROR
 11319*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11320
 11321     GO TO 1200-EDIT-FIND-TOLERANCES.
 11322
 11323 1165-PAID-THRU-ERROR.
 11324     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11325
 11326     IF EMI-MESSAGE-FORMATTED
 11327         MOVE -1                 TO EPYTHRUL
 11328         MOVE AL-UNBON           TO EPYTHRUA.
 11329
 11330 1165-EXIT.
 11331     EXIT.
 11332
 11333 1166-CHECK-ALL-TRLRS.
 11334
 11335     IF PI-PMTTYPE = '4'
 11336       AND NOT HOLD-UNTIL-CHK
 11337       AND NOT CHECK-ALL-PMTS
 11338        GO TO 1166-TRLR-EXIT.
 11339
 11340     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11341
 11342     IF HOLD-UNTIL-CHK
 11343        CONTINUE
 11344     ELSE
 11345     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11346        WS-SV-EPYFROM = LOW-VALUES
 11347          GO TO 1166-END-CHECK.
 11348
 11349
 11350* EXEC CICS HANDLE CONDITION
 11351*        ENDFILE   (1166-END-CHECK)
 11352*        NOTFND    (1166-END-CHECK)
 11353*    END-EXEC.
 11354*    MOVE '"$''I                  ! ) #00010933' TO DFHEIV0
 11355     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11357     MOVE X'2920233030303130393333' TO DFHEIV0(25:11)
 11358     CALL 'kxdfhei1' USING DFHEIV0
 11359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11360
 11361
 11362     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11363     MOVE +100                   TO TRLR-SEQ-NO.
 11364
 11365
 11366* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 218
* EL156.cbl
 11367*         DATASET    ('ELTRLR')
 11368*         RIDFLD     (ELTRLR-KEY)
 11369*         GTEQ
 11370*    END-EXEC.
 11371     MOVE 'ELTRLR' TO DFHEIV1
 11372     MOVE 0
 11373       TO DFHEIV11
 11374*    MOVE '&,         G          &   #00010941' TO DFHEIV0
 11375     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11377     MOVE X'2020233030303130393431' TO DFHEIV0(25:11)
 11378     CALL 'kxdfhei1' USING DFHEIV0,
 11379           DFHEIV1,
 11380           ELTRLR-KEY,
 11381           DFHEIV99,
 11382           DFHEIV11,
 11383           DFHEIV99
 11384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11385
 11386
 11387     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11388
 11389 1166-READ-TRLR-NEXT.
 11390
 11391
 11392* EXEC CICS READNEXT
 11393*         DATASET    ('ELTRLR')
 11394*         RIDFLD     (ELTRLR-KEY)
 11395*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11396*    END-EXEC.
 11397     MOVE 'ELTRLR' TO DFHEIV1
 11398     MOVE 0
 11399       TO DFHEIV11
 11400*    MOVE '&.S                   )   #00010951' TO DFHEIV0
 11401     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11402     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11403     MOVE X'2020233030303130393531' TO DFHEIV0(25:11)
 11404     CALL 'kxdfhei1' USING DFHEIV0,
 11405           DFHEIV1,
 11406           DFHEIV20,
 11407           DFHEIV99,
 11408           ELTRLR-KEY,
 11409           DFHEIV99,
 11410           DFHEIV11,
 11411           DFHEIV99,
 11412           DFHEIV99
 11413     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11414         DFHEIV20
 11415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11416
 11417
 11418     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11419        TRLR-CARRIER  = MSTR-CARRIER  AND
 11420        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11421        TRLR-CERT-NO  = MSTR-CERT-NO
 11422          NEXT SENTENCE
 11423      ELSE
 11424          GO TO 1166-END-CHECK.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 219
* EL156.cbl
 11425
 11426* **  BYPASS ALL NON-PAYMENT TRAILERS
 11427
 11428     IF AT-TRAILER-TYPE = '2'
 11429        NEXT SENTENCE
 11430     ELSE
 11431        GO TO 1166-READ-TRLR-NEXT.
 11432
 11433* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11434
 11435     IF (HOLD-UNTIL-CHK
 11436       OR CHECK-ALL-PMTS)
 11437       AND AT-PAYMENT-TYPE <= '4'
 11438        NEXT SENTENCE
 11439     ELSE
 11440     IF AT-PAYMENT-TYPE = '1' OR '2'
 11441        NEXT SENTENCE
 11442     ELSE
 11443        GO TO 1166-READ-TRLR-NEXT.
 11444
 11445     IF ((AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11446        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES))
 11447        AND NOT HOLD-UNTIL-CHK
 11448          GO TO 1166-READ-TRLR-NEXT.
 11449* **  BYPASS ALL VOID PAYMENTS
 11450
 11451     IF AT-VOID-DT NOT = LOW-VALUES
 11452        IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11453          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11454            SET DUPE-VOID-PMT-EXISTS TO TRUE
 11455        END-IF
 11456        GO TO 1166-READ-TRLR-NEXT.
 11457
 11458     IF HOLD-UNTIL-CHK
 11459        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11460          AND AT-TO-BE-WRITTEN-DT > ZERO
 11461           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11462        END-IF
 11463        IF AT-TO-BE-WRITTEN-DT > ZERO
 11464          AND AT-CHECK-WRITTEN-DT = LOW-VALUES
 11465           SET UNPAID-HOLD-UNTIL-EXISTS TO TRUE
 11466           IF AT-TO-BE-WRITTEN-DT > WS-UNPD-HOLD-UNTIL-DT
 11467              MOVE AT-TO-BE-WRITTEN-DT TO WS-UNPD-HOLD-UNTIL-DT
 11468           END-IF
 11469        END-IF
 11470        IF AT-AMOUNT-PAID NUMERIC
 11471          AND (AT-CHECK-WRITTEN-DT > LOW-VALUES
 11472             OR AT-TO-BE-WRITTEN-DT < ZERO)
 11473          AND AT-PAYMENT-TYPE  <= '4'
 11474           ADD AT-AMOUNT-PAID TO WS-TOT-AMOUNT-PAID
 11475        END-IF
 11476     END-IF
 11477
 11478     IF HOLD-UNTIL-CHK
 11479        CONTINUE
 11480     ELSE
 11481     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11482         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 220
* EL156.cbl
 11483            OR
 11484        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11485         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11486        NEXT SENTENCE
 11487     ELSE
 11488         IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11489          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11490          AND (PI-OFFLINE NOT EQUAL 'Y')
 11491          AND (CL-CLAIM-TYPE NOT = 'L' AND 'O')
 11492            IF PI-PMTTYPE = '4'
 11493               MOVE 'Y' TO PI-DUPE-APPROVAL-NEEDED
 11494               MOVE ER-3280            TO EMI-ERROR
 11495               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11496               MOVE -1                 TO EPYTHRUL
 11497               MOVE AL-UNBON           TO EPYTHRUA
 11498            ELSE
 11499               MOVE ER-3279            TO EMI-ERROR
 11500               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11501               MOVE -1                 TO EPYTHRUL
 11502               MOVE AL-UNBON           TO EPYTHRUA
 11503         ELSE
 11504         IF CL-TOTAL-PAID-AMT > ZEROS
 11505           AND NOT CHECK-ALL-PMTS
 11506             MOVE ER-0502            TO EMI-ERROR
 11507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11508             MOVE -1                 TO EPYTHRUL
 11509             MOVE AL-UNBON           TO EPYTHRUA.
 11510
 11511     GO TO 1166-READ-TRLR-NEXT.
 11512
 11513 1166-END-CHECK.
 11514
 11515     IF WS-BROWSE-TRLR-SW = 'Y'
 11516
 11517* EXEC CICS ENDBR
 11518*            DATASET   ('ELTRLR')
 11519*       END-EXEC.
 11520     MOVE 'ELTRLR' TO DFHEIV1
 11521     MOVE 0
 11522       TO DFHEIV11
 11523*    MOVE '&2                    $   #00011055' TO DFHEIV0
 11524     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11525     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11526     MOVE X'2020233030303131303535' TO DFHEIV0(25:11)
 11527     CALL 'kxdfhei1' USING DFHEIV0,
 11528           DFHEIV1,
 11529           DFHEIV11,
 11530           DFHEIV99
 11531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11532
 11533
 11534     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11535
 11536 1166-TRLR-EXIT.
 11537     EXIT.
 11538
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 221
* EL156.cbl
 11540 1170-PAID-THRU-FATAL-ERROR.
 11541     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11542
 11543     MOVE -1                     TO EPYTHRUL.
 11544     MOVE AL-UNBON               TO EPYTHRUA.
 11545
 11546 1200-EDIT-FIND-TOLERANCES.
 11547
 11548* EXEC CICS HANDLE CONDITION
 11549*        ENDFILE(1950-NOT-FOUND)
 11550*        NOTFND (1950-NOT-FOUND)
 11551*    END-EXEC.
 11552*    MOVE '"$''I                  ! * #00011072' TO DFHEIV0
 11553     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11555     MOVE X'2A20233030303131303732' TO DFHEIV0(25:11)
 11556     CALL 'kxdfhei1' USING DFHEIV0
 11557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11558
 11559
 11560     IF PI-PROCESSOR-ID = 'LGXX'
 11561        GO TO 1240-FIND-ACCT-TOLERANCES.
 11562
 11563     MOVE 'N'                    TO FOUND-TOL-SW.
 11564     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11565     MOVE '2'                    TO CNTL-REC-TYPE.
 11566     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11567     MOVE +0                     TO CNTL-SEQ-NO.
 11568     MOVE 'PROC'                 TO FILE-SWITCH.
 11569
 11570     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11571
 11572     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11573     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11574                                    PI-MAX-PMT-TOL.
 11575     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11576
 11577     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11578         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11579
 11580     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11581     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11582                                    PI-MAX-LF-PMT-TOL.
 11583
 11584     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11585         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11586
 11587     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11588                                    PI-MAX-EXP-PMT.
 11589
 11590 1240-FIND-ACCT-TOLERANCES.
 11591
 11592     IF WS-PMT-TOL NOT = +0
 11593         MOVE 'Y'                TO FOUND-TOL-SW.
 11594
 11595     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11596         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11597         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 222
* EL156.cbl
 11598         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11599         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11600         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11601         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11602     ELSE
 11603         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11604         MOVE PI-CARRIER             TO ACCT-CARRIER
 11605         MOVE PI-GROUPING            TO ACCT-GROUPING
 11606         MOVE PI-STATE               TO ACCT-STATE
 11607         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11608         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11609
 11610     MOVE 'ACCT'                 TO FILE-SWITCH.
 11611
 11612     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11613     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11614
 11615
 11616* EXEC CICS HANDLE CONDITION
 11617*         NOTFND   (1950-NOT-FOUND)
 11618*         ENDFILE  (1950-NOT-FOUND)
 11619*    END-EXEC.
 11620*    MOVE '"$I''                  ! + #00011132' TO DFHEIV0
 11621     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11623     MOVE X'2B20233030303131313332' TO DFHEIV0(25:11)
 11624     CALL 'kxdfhei1' USING DFHEIV0
 11625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11626
 11627
 11628
 11629* EXEC CICS STARTBR
 11630*        DATASET('ERACCT')
 11631*        RIDFLD (ERACCT-KEY)
 11632*        GTEQ
 11633*    END-EXEC.
 11634     MOVE 'ERACCT' TO DFHEIV1
 11635     MOVE 0
 11636       TO DFHEIV11
 11637*    MOVE '&,         G          &   #00011137' TO DFHEIV0
 11638     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11639     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11640     MOVE X'2020233030303131313337' TO DFHEIV0(25:11)
 11641     CALL 'kxdfhei1' USING DFHEIV0,
 11642           DFHEIV1,
 11643           ERACCT-KEY,
 11644           DFHEIV99,
 11645           DFHEIV11,
 11646           DFHEIV99
 11647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11648
 11649
 11650 1245-FIND-ACCT-TOLERANCES-LOOP.
 11651
 11652
 11653* EXEC CICS READNEXT
 11654*        DATASET('ERACCT')
 11655*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 223
* EL156.cbl
 11656*        RIDFLD (ERACCT-KEY)
 11657*    END-EXEC.
 11658     MOVE 'ERACCT' TO DFHEIV1
 11659     MOVE 0
 11660       TO DFHEIV11
 11661*    MOVE '&.S                   )   #00011145' TO DFHEIV0
 11662     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11663     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11664     MOVE X'2020233030303131313435' TO DFHEIV0(25:11)
 11665     CALL 'kxdfhei1' USING DFHEIV0,
 11666           DFHEIV1,
 11667           DFHEIV20,
 11668           DFHEIV99,
 11669           ERACCT-KEY,
 11670           DFHEIV99,
 11671           DFHEIV11,
 11672           DFHEIV99,
 11673           DFHEIV99
 11674     SET ADDRESS OF ACCOUNT-MASTER TO
 11675         DFHEIV20
 11676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11677
 11678
 11679     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11680        IF WS-ERACCT-HOLD-RECORD = SPACES
 11681           GO TO 1950-NOT-FOUND
 11682        ELSE
 11683           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11684           GO TO 1250-CONTINUE.
 11685
 11686     IF ACCT-EXP-DT = HIGH-VALUES
 11687        NEXT SENTENCE
 11688     ELSE
 11689        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11690        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11691
 11692 1250-CONTINUE.
 11693
 11694     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11695
 11696     IF FOUND-TOL-SW = 'N'
 11697         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11698
 11699********* 1260-FIND-STATE-TOLERANCES.
 11700
 11701     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11702     MOVE PI-STATE               TO WS-ST-ACCESS.
 11703     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11704     MOVE '3'                    TO CNTL-REC-TYPE.
 11705     MOVE +0                     TO CNTL-SEQ-NO.
 11706     MOVE 'STAT'                 TO FILE-SWITCH.
 11707
 11708     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11709
 11710     IF WS-PMT-TOL = +0
 11711         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11712
 11713     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 224
* EL156.cbl
 11714     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11715     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11716     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11717     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11718
 11719****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11720****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11721     IF PI-PAYEE-TYPE <> 'B'
 11722           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11723     END-IF.
 11724
 11725     IF PI-PMTTYPE      = '2'  AND
 11726        PI-SPLIT-PMT-SW = 'Y'  AND
 11727        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 11728          MOVE ER-3530                TO EMI-ERROR
 11729          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11730
 11731********* 1280-FIND-BENEFIT-TOLERANCES.
 11732
 11733     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11734        OR (PI-PMTTYPE = '5' OR '6')
 11735         GO TO 1300-FIND-CARR-TOLERANCES.
 11736
 11737     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11738     MOVE '4'                    TO CNTL-REC-TYPE.
 11739     MOVE +0                     TO CNTL-SEQ-NO.
 11740     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11741     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11742     MOVE 'BENE'                 TO FILE-SWITCH.
 11743
 11744     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11745
 11746     IF NO-BENEFIT-FOUND
 11747         GO TO 1950-NOT-FOUND.
 11748
 11749     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11750     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11751     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11752
 11753
 11754* EXEC CICS HANDLE CONDITION
 11755*        NOTFND(1950-NOT-FOUND)
 11756*    END-EXEC.
 11757*    MOVE '"$I                   ! , #00011225' TO DFHEIV0
 11758     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11760     MOVE X'2C20233030303131323235' TO DFHEIV0(25:11)
 11761     CALL 'kxdfhei1' USING DFHEIV0
 11762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11763
 11764
 11765 1300-FIND-CARR-TOLERANCES.
 11766     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11767     MOVE '6'                    TO CNTL-REC-TYPE.
 11768
 11769     IF CONTROL-IS-ACTUAL-CARRIER
 11770         MOVE PI-CARRIER               TO WS-CARR
 11771     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 225
* EL156.cbl
 11772         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11773
 11774     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11775     MOVE +0                     TO CNTL-SEQ-NO.
 11776     MOVE 'CARR'                 TO FILE-SWITCH.
 11777
 11778     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11779
 11780     IF WS-DAYS-TOL = +0
 11781         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11782
 11783     IF WS-PMT-TOL = +0
 11784         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11785
 11786     IF WS-MAX-DAYS-TOL = +0
 11787         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11788
 11789     IF WS-MAX-PMT-TOL = +0
 11790         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11791                                    PI-MAX-PMT-TOL.
 11792
 11793     IF WS-MAX-LF-PMT-TOL = +0
 11794        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11795                                    PI-MAX-LF-PMT-TOL.
 11796
 11797     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11798
 11799********* 1320-FIND-COMP-TOLERANCES.
 11800
 11801     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11802     MOVE '1'                    TO CNTL-REC-TYPE.
 11803     MOVE SPACES                 TO CNTL-ACCESS.
 11804     MOVE +0                     TO CNTL-SEQ-NO.
 11805     MOVE 'COMP'                 TO FILE-SWITCH.
 11806
 11807     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11808
 11809     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11810     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11811
 11812     IF WS-PMT-TOL NOT = +0
 11813        IF WS-TOL-SEVERITY NOT = ' '
 11814         GO TO 1360-EDIT-DAYS.
 11815
 11816     IF WS-PMT-TOL = +0
 11817         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11818
 11819     IF WS-TOL-SEVERITY = ' '
 11820         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11821
 11822 1360-EDIT-DAYS.
 11823     IF PI-PMTTYPE NOT = '4'
 11824        IF PI-EDAYS NEGATIVE OR
 11825           PI-EPYAMT NEGATIVE
 11826          MOVE ER-0513             TO EMI-ERROR
 11827          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11828          MOVE -1                  TO PMTTYPEL.
 11829
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 226
* EL156.cbl
 11830     IF PI-PMTTYPE = '5' OR '6'
 11831        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11832
 11833     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11834        IF PI-PMTTYPE = '4'
 11835          MOVE PI-EDAYS          TO PI-CDAYS.
 11836
 11837     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 11838         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11839
 11840     IF PI-PMTTYPE = '4'
 11841        MOVE PI-EDAYS            TO PI-CDAYS
 11842        GO TO 1400-EDIT-PAYMENT.
 11843
 11844     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11845        GO TO 1500-EDIT-EXPENSES.
 11846
 11847*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11848*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11849*          CM-AH-BENEFIT-CD = '23'              AND
 11850*          CL-CERT-STATE    = '04'              AND
 11851*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11852*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11853*            GO TO 1362-CHECK-MAX-DAYS.
 11854
 11855     IF PI-EDAYS = ZEROS
 11856*        IF PI-COMPANY-ID = 'DMD'
 11857*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11858*            MOVE -1             TO DC-ELAPSED-DAYS
 11859*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11860*            MOVE '6'            TO DC-OPTION-CODE
 11861*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11862*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11863*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11864*            MOVE '1'            TO DC-OPTION-CODE
 11865*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11866*            IF NO-CONVERSION-ERROR
 11867*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11868*                                 + DC-ODD-DAYS-OVER
 11869*               MOVE 6           TO EDAYSL
 11870*               MOVE AL-UNNON    TO EDAYSA
 11871*            ELSE
 11872*                NEXT SENTENCE
 11873*       ELSE
 11874            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11875            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11876            MOVE '1'             TO DC-OPTION-CODE
 11877            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11878            IF NO-CONVERSION-ERROR
 11879                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11880                ADD 1                 TO PI-EDAYS
 11881                MOVE AL-UNNON         TO EDAYSA.
 11882
 11883*    IF PI-COMPANY-ID = 'DMD'
 11884*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11885*        MOVE -1                 TO DC-ELAPSED-DAYS
 11886*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11887*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 227
* EL156.cbl
 11888*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11889*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11890*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11891*        MOVE '1'                TO DC-OPTION-CODE
 11892*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11893*    ELSE
 11894         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11895         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11896         MOVE '1'                TO DC-OPTION-CODE.
 11897         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11898
 11899     IF NO-CONVERSION-ERROR
 11900        IF PI-COMPANY-ID = 'DMD'
 11901            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11902                             + DC-ODD-DAYS-OVER
 11903        ELSE
 11904            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11905            ADD 1                TO PI-CDAYS.
 11906
 11907     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11908        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11909        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11910
 11911     IF PI-EDAYS NOT NUMERIC
 11912         MOVE ER-0491            TO EMI-ERROR
 11913         GO TO 1370-DAYS-ERROR.
 11914
 11915     IF CL-NO-OF-PMTS-MADE = 0
 11916        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11917        AND CL-CERT-STATE = 'MI'
 11918        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11919            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11920     END-IF.
 11921
 11922 1362-CHECK-MAX-DAYS.
 11923
 11924     IF WS-MAX-DAYS-TOL = +999
 11925         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11926
 11927     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11928         IF PI-EDAYS = ZEROS
 11929             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11930         ELSE
 11931             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11932
 11933     IF WS-MAX-DAYS-TOL NOT = ZERO
 11934        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11935           PI-CDAYS > WS-MAX-DAYS-TOL
 11936             MOVE ER-0492          TO EMI-ERROR
 11937             GO TO 1370-DAYS-ERROR.
 11938
 11939 1365-SKIP-MAX-DAYS-EDIT.
 11940     IF PI-EDAYS = ZEROS
 11941        GO TO 1400-EDIT-PAYMENT.
 11942
 11943     IF WS-DAYS-TOL NOT = ZERO
 11944        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11945           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 228
* EL156.cbl
 11946                MOVE ER-0493     TO EMI-ERROR
 11947                GO TO 1370-DAYS-ERROR.
 11948
 11949     GO TO 1400-EDIT-PAYMENT.
 11950
 11951 1370-DAYS-ERROR.
 11952     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11953
 11954     IF EMI-MESSAGE-FORMATTED
 11955         MOVE -1                 TO EDAYSL
 11956         MOVE AL-UABON           TO EDAYSA.
 11957
 11958     GO TO 1400-EDIT-PAYMENT.
 11959
 11960 1380-EDIT-EXPENSE-PMT-AMT.
 11961     IF PI-PMTTYPE = '5' OR '6'
 11962         NEXT SENTENCE
 11963     ELSE
 11964         GO TO 1400-EDIT-PAYMENT.
 11965
 11966     IF WS-MAX-EXP-PMT NOT = ZEROS
 11967        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11968            MOVE ER-3529            TO EMI-ERROR
 11969            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11970
 11971     GO TO 1500-EDIT-EXPENSES.
 11972
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 229
* EL156.cbl
 11974
 11975 1390-CHECK-PAYMENT-DAYS.
 11976
 11977     IF PI-EDAYS = 0
 11978         MOVE PI-CDAYS TO WS-PD-DAYS
 11979     ELSE
 11980         MOVE PI-EDAYS TO WS-PD-DAYS
 11981     END-IF.
 11982
 11983     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11984         IF WS-PD-DAYS = 14
 11985            GO TO 1390-EXIT
 11986         END-IF
 11987     END-IF.
 11988
 11989     IF PI-COMPANY-ID = 'AHL'  AND
 11990        CM-AH-BENEFIT-CD = '1K'
 11991         IF WS-PD-DAYS = 14
 11992            GO TO 1390-EXIT
 11993         END-IF
 11994     END-IF.
 11995
 11996     IF WS-PD-DAYS < 30
 11997         MOVE ER-3549              TO EMI-ERROR
 11998         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11999     END-IF.
 12000
 12001 1390-EXIT.
 12002      EXIT.
 12003
 12004 1400-EDIT-PAYMENT.
 12005*    IF PI-COMPANY-ID = 'DMD'
 12006*       IF CL-CERT-NO (5:2) = '69' OR '70'
 12007*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 12008
 12009     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12010        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12011        MOVE PI-CARRIER          TO ACCT-CARRIER
 12012        MOVE PI-GROUPING         TO ACCT-GROUPING
 12013        MOVE PI-STATE            TO ACCT-STATE
 12014        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12015        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12016        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12017        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12018
 12019
 12020* EXEC CICS READ
 12021*          DATASET ('ERACCT')
 12022*          RIDFLD  (ERACCT-KEY)
 12023*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12024*          GTEQ
 12025*          resp    (WS-RESPONSE)
 12026*       END-EXEC
 12027     MOVE 'ERACCT' TO DFHEIV1
 12028*    MOVE '&"S        G          (  N#00011483' TO DFHEIV0
 12029     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12031     MOVE X'204E233030303131343833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 230
* EL156.cbl
 12032     CALL 'kxdfhei1' USING DFHEIV0,
 12033           DFHEIV1,
 12034           DFHEIV20,
 12035           DFHEIV99,
 12036           ERACCT-KEY,
 12037           DFHEIV99,
 12038           DFHEIV99,
 12039           DFHEIV99
 12040     SET ADDRESS OF ACCOUNT-MASTER TO
 12041         DFHEIV20
 12042     MOVE EIBRESP  TO WS-RESPONSE
 12043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12044        IF WS-RESP-NORMAL
 12045           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 12046           and pi-cert-eff-dt < am-expiration-dt
 12047           and pi-cert-eff-dt >= am-effective-dt
 12048           move am-dcc-product-code to pi-dcc-product-code
 12049        else
 12050           move spaces           to pi-dcc-product-code
 12051        end-if
 12052        if PI-DCC-PRODUCT-CODE NOT = SPACES
 12053           PERFORM 0900-GET-DDF-LIMITS
 12054                                 THRU 0900-EXIT
 12055           IF PDEF-FOUND
 12056              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12057                 (P1 > +8)
 12058                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 12059              END-PERFORM
 12060              IF P1 < +9
 12061                 if pd-ben-pct (p1) not numeric
 12062                    move zeros   to pd-ben-pct (p1)
 12063                 end-if
 12064                 if pd-ben-pct (p1) = zeros
 12065                    move +1      to ws-work-ben-pct
 12066                 else
 12067                    move pd-ben-pct (p1)
 12068                                 to ws-work-ben-pct
 12069                 end-if
 12070                 compute cm-ah-benefit-amt =
 12071                    cm-ah-benefit-amt * ws-work-ben-pct
 12072                 if cm-ah-benefit-amt > pd-max-amt (p1)
 12073                    move pd-max-amt (p1) to cm-ah-benefit-amt
 12074                 end-if
 12075              else
 12076                 move er-1674    to emi-error
 12077                 PERFORM 9900-ERROR-FORMAT
 12078                                 THRU 9900-EXIT
 12079              END-IF
 12080           else
 12081              move er-1672       to emi-error
 12082              PERFORM 9900-ERROR-FORMAT
 12083                                 THRU 9900-EXIT
 12084           END-IF
 12085        end-if
 12086     END-IF
 12087     IF PI-PMTTYPE NOT = '4'
 12088        GO TO 1405-CALC-PAYMENT.
 12089     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 231
* EL156.cbl
 12090         MOVE PI-EPYAMT           TO PI-CPYAMT
 12091         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 12092         GO TO 1430-CHECK-AH-TOLERANCE.
 12093
 12094*    IF PI-COMPANY-ID = 'FIA'
 12095*       IF CERT-ACCOUNT = '0000011043'
 12096*        COMPUTE PI-DAILY-RATE ROUNDED =
 12097*                      (CM-AH-BENEFIT-AMT * 13) / 365
 12098*        COMPUTE PI-CPYAMT ROUNDED =
 12099*                          PI-DAILY-RATE * PI-EDAYS
 12100*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 12101*        GO TO 1430-CHECK-AH-TOLERANCE.
 12102
 12103     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 12104         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12105         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 12106         GO TO 1420-CHECK-AIG-BENEFIT.
 12107
 12108     IF WS-CALC-METHOD = '2' OR  '5'
 12109         COMPUTE PI-DAILY-RATE ROUNDED =
 12110                        (CM-AH-BENEFIT-AMT * 12) / 365
 12111         COMPUTE PI-CPYAMT ROUNDED =
 12112                           PI-DAILY-RATE * PI-EDAYS
 12113        GO TO 1420-CHECK-AIG-BENEFIT.
 12114
 12115     IF WS-CALC-METHOD = '3'
 12116         COMPUTE PI-DAILY-RATE =
 12117                         (CM-AH-BENEFIT-AMT * 12) / 365
 12118         COMPUTE PI-CPYAMT ROUNDED =
 12119                           PI-DAILY-RATE * PI-EDAYS
 12120        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 232
* EL156.cbl
 12122*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 12123
 12124****************************************************************
 12125****************************************************************
 12126*                  CALCULATED FROM      PAYMENT      PAYMENT
 12127*   DATES           DATE ROUTINE        OPT  1       OPT  6
 12128* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 12129*1-01-83  1-15-83    0    15     15        15           15
 12130*1-01-83  1-30-83    0    30     30        30           30
 12131*1-01-83  1-31-83    1     0     31        30           30
 12132*1-01-83  2-01-83    1     1     32        31           31
 12133*1-01-83  2-15-83    1    15     46        45           45
 12134*1-01-83  2-28-83    2     0     59        60           60
 12135*1-01-83  3-01-83    2     1     60        61           61
 12136*1-01-83  3-31-83    3     0     90        90           90
 12137*1-15-83  1-31-83    0    17     17        17           16
 12138*1-15-83  2-01-83    0    18     18        18           17
 12139*1-15-83  2-28-83    1    14     45        44           46
 12140*1-21-83  3-09-83    1    20     48        50           49
 12141*2-05-83  3-06-83    1     2     30        32           32
 12142*2-05-83  3-23-83    1    19     47        49           49
 12143*2-15-83  2-28-83    0    14     14        14           16
 12144*2-15-83  3-01-83    0    15     15        15           17
 12145*2-21-83  3-19-83    0    27     27        27           29
 12146*2-21-83  3-20-83    1     0     28        30           30
 12147*2-21-83  4-10-83    1    18     49        30           50
 12148*2-21-83  5-19-83    2    27     88        87           89
 12149*2-21-83  5-22-83    3     2     91        92           92
 12150*3-21-83  5-19-83    1    30     60        60           59
 12151****************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 233
* EL156.cbl
 12153 1405-CALC-PAYMENT.
 12154     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12155     MOVE ' '                    TO DC-OPTION-CODE.
 12156     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12157     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12158     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12159
 12160     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12161     MOVE ' '                    TO DC-OPTION-CODE.
 12162     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12163     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12164     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12165
 12166     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12167     MOVE -1                     TO DC-ELAPSED-DAYS.
 12168     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12169     MOVE '6'                    TO DC-OPTION-CODE.
 12170     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12171     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12172
 12173     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12174     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12175     MOVE '1'                    TO DC-OPTION-CODE.
 12176     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12177
 12178     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12179     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12180     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12181
 12182******************************************************************
 12183*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12184*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12185*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12186******************************************************************
 12187
 12188     IF WS-CALC-METHOD = '1'           AND
 12189        DC-ELAPSED-MONTHS > ZERO AND
 12190        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12191        WDF-DAY > WDT-DAY
 12192          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12193          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12194          MOVE -1                  TO DC-ELAPSED-MONTHS
 12195          MOVE '6'                 TO DC-OPTION-CODE
 12196          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12197          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12198          COMPUTE WS-SAVE-ODD-DAYS =
 12199          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12200          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12201
 12202     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12203     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12204     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12205
 12206     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12207     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12208
 12209*    IF PI-COMPANY-ID = 'FIA'
 12210*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 234
* EL156.cbl
 12211*        COMPUTE PI-DAILY-RATE ROUNDED =
 12212*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12213*        COMPUTE PI-CPYAMT ROUNDED =
 12214*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12215*        GO TO 1420-CHECK-AIG-BENEFIT.
 12216
 12217*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12218*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12219*          CM-AH-BENEFIT-CD = '23'               AND
 12220*          CL-CERT-STATE    = '04'               AND
 12221*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12222*            COMPUTE WS-DAILY-RATE ROUNDED =
 12223*                               CM-AH-BENEFIT-AMT / 30
 12224*            COMPUTE PI-CPYAMT ROUNDED =
 12225*                               (WS-DAILY-RATE * PI-CDAYS)
 12226*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12227*            GO TO 1420-CHECK-AIG-BENEFIT.
 12228
 12229     IF WS-CALC-METHOD = '1'
 12230         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12231         COMPUTE PI-CPYAMT ROUNDED =
 12232             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12233             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12234         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12235         GO TO 1420-CHECK-AIG-BENEFIT.
 12236
 12237     IF WS-CALC-METHOD = '2'
 12238         COMPUTE PI-DAILY-RATE ROUNDED =
 12239                          (CM-AH-BENEFIT-AMT * 12) / 365
 12240         COMPUTE PI-CPYAMT ROUNDED =
 12241             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12242             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12243         GO TO 1420-CHECK-AIG-BENEFIT.
 12244
 12245     IF WS-CALC-METHOD = '4'
 12246         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12247         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12248         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12249         COMPUTE PI-CPYAMT ROUNDED =
 12250                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12251         GO TO 1420-CHECK-AIG-BENEFIT.
 12252
 12253     IF WS-CALC-METHOD = '5'
 12254         COMPUTE PI-DAILY-RATE ROUNDED =
 12255                            (CM-AH-BENEFIT-AMT * 12) / 365
 12256         COMPUTE PI-CPYAMT ROUNDED =
 12257                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12258         GO TO 1420-CHECK-AIG-BENEFIT.
 12259
 12260     IF WS-CALC-METHOD NOT = '3'
 12261        GO TO 1410-CHECK-PAYMENT.
 12262
 12263******   CALCULATION METHOD  3  ROUTINE
 12264     COMPUTE PI-DAILY-RATE =
 12265                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12266
 12267******CHECK TO SEE IF WITHIN SAME MONTH
 12268     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 235
* EL156.cbl
 12269        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12270                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12271         GO TO 1420-CHECK-AIG-BENEFIT.
 12272
 12273******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12274     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12275             SAVE-ODD-DAYS-OVER = ZEROS
 12276      COMPUTE PI-CPYAMT  ROUNDED =
 12277                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12278      GO TO 1420-CHECK-AIG-BENEFIT.
 12279
 12280******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12281******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12282     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12283        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12284        IF WDF-MONTH > 12
 12285           ADD 1                 TO WDF-YEAR
 12286           SUBTRACT 12         FROM WDF-MONTH.
 12287
 12288******CONVERT THE NEW FROM MONTH TO BINARY
 12289     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12290        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12291        MOVE '4'              TO DC-OPTION-CODE
 12292        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12293        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12294
 12295     IF WDF-MONTH = WDT-MONTH AND
 12296        WDF-YEAR  = WDT-YEAR
 12297          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12298                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12299                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12300        ELSE
 12301          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12302          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12303          COMPUTE PI-CPYAMT ROUNDED =
 12304       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12305       +
 12306       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12307       +
 12308       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12309
 12310     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 236
* EL156.cbl
 12312 1410-CHECK-PAYMENT.
 12313******PAYMENT OPTION 6
 12314******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12315     IF SAVE-ELAPSED-MONTHS > ZERO
 12316        IF SAVE-ODD-DAYS-OVER = ZEROS
 12317           GO TO 1412-CHECK-TO-DAY
 12318        ELSE
 12319           IF WDF-DAY > WDT-DAY
 12320              IF WDF-MONTH = 02
 12321                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12322                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12323                  GO TO 1412-CHECK-TO-DAY
 12324              ELSE
 12325                  IF FROM-DAYS-IN-MONTH = 31
 12326                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12327                     GO TO 1412-CHECK-TO-DAY
 12328                  ELSE
 12329                     GO TO 1412-CHECK-TO-DAY
 12330           ELSE
 12331               GO TO 1412-CHECK-TO-DAY.
 12332
 12333     IF WDF-MONTH NOT = WDT-MONTH
 12334        IF WDF-MONTH = 02
 12335           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12336           IF WDF-DAY = 29
 12337              ADD 1              TO SAVE-ODD-DAYS-OVER
 12338           ELSE
 12339              ADD 2              TO SAVE-ODD-DAYS-OVER
 12340        ELSE
 12341           IF FROM-DAYS-IN-MONTH = 31
 12342              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12343
 12344 1412-CHECK-TO-DAY.
 12345        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12346           IF WDT-DAY = 28
 12347              ADD 2              TO SAVE-ODD-DAYS-OVER
 12348           ELSE
 12349              IF WDT-DAY = 29
 12350                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12351              ELSE
 12352                 NEXT SENTENCE
 12353        ELSE
 12354           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12355              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12356
 12357     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12358     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12359     COMPUTE PI-CPYAMT ROUNDED =
 12360         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12361         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12362
 12363     GO TO 1420-CHECK-AIG-BENEFIT.
 12364
 12365 1415-CHECK-LEAP-YEAR.
 12366     IF FROM-DAYS-IN-MONTH = 29
 12367        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12368
 12369 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 237
* EL156.cbl
 12370     EXIT.
 12371
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 238
* EL156.cbl
 12373 1420-CHECK-AIG-BENEFIT.
 12374
 12375     IF WS-SPECIAL-CALC-CD = 'Q'
 12376         GO TO 1425-CHECK-WHOLE-MONTH.
 12377
 12378*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12379*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12380*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12381*       (PI-PMTTYPE = '1' OR '2')
 12382*        NEXT SENTENCE
 12383*    ELSE
 12384         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12385         GO TO 1430-CHECK-AH-TOLERANCE.
 12386
 12387******************AIG LOGIC STARTS**********************
 12388*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12389*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12390*    MOVE ER-3533      TO EMI-ERROR.
 12391*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12392*    GO TO 1430-CHECK-AH-TOLERANCE.
 12393******************AIG LOGIC ENDS************************
 12394
 12395 1425-CHECK-WHOLE-MONTH.
 12396******************************************************************
 12397****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12398****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12399****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12400****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12401****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12402****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12403****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12404****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12405****          PAID * MONTHLY BENEFIT.                         ****
 12406******************************************************************
 12407
 12408     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12409
 12410     IF CL-NO-OF-PMTS-MADE > +0
 12411         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12412
 12413     IF PI-CDAYS < WS-BEN-DAYS
 12414         GO TO 1430-CHECK-AH-TOLERANCE.
 12415
 12416     IF PI-CDAYS = WS-BEN-DAYS
 12417         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12418         GO TO 1430-CHECK-AH-TOLERANCE.
 12419
 12420*    IF PI-COMPANY-ID = 'ACM'
 12421*       NEXT SENTENCE
 12422*    ELSE
 12423        GO TO 1425-NOT-ACM-W15C.
 12424
 12425*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12426*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12427*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12428*    MOVE '6'                    TO  DC-OPTION-CODE.
 12429*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12430*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 239
* EL156.cbl
 12431*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12432*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12433*       MOVE '1'                 TO  DC-OPTION-CODE
 12434*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12435*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12436*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12437*       IF NO-CONVERSION-ERROR
 12438*          IF (DC-ELAPSED-MONTHS > +0) OR
 12439*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12440*             NEXT SENTENCE
 12441*          ELSE
 12442*             MOVE +0            TO  PI-CPYAMT
 12443*             MOVE ER-0846       TO  EMI-ERROR
 12444*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12445*             GO TO 1430-CHECK-AH-TOLERANCE
 12446*       ELSE
 12447*           MOVE ER-0846         TO  EMI-ERROR
 12448*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12449*           GO TO 1430-CHECK-AH-TOLERANCE.
 12450*
 12451*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12452*       ADD +1 TO DC-ELAPSED-MONTHS.
 12453*
 12454*    COMPUTE PI-CPYAMT ROUNDED =
 12455*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12456*
 12457*    GO TO 1430-CHECK-AH-TOLERANCE.
 12458
 12459 1425-NOT-ACM-W15C.
 12460
 12461     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12462     MOVE '6'                        TO  DC-OPTION-CODE.
 12463     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12464     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12465
 12466     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12467     IF NO-CONVERSION-ERROR
 12468         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12469     ELSE
 12470         MOVE ER-0846                TO  EMI-ERROR
 12471         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12472         GO TO 1430-CHECK-AH-TOLERANCE.
 12473
 12474     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12475     MOVE '1'                        TO  DC-OPTION-CODE.
 12476     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12477     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12478     IF NO-CONVERSION-ERROR
 12479         IF DC-ODD-DAYS-OVER = +0
 12480             NEXT SENTENCE
 12481         ELSE
 12482             MOVE ER-0846            TO  EMI-ERROR
 12483             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12484             GO TO 1430-CHECK-AH-TOLERANCE
 12485     ELSE
 12486         MOVE ER-0846                TO  EMI-ERROR
 12487         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12488         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 240
* EL156.cbl
 12489
 12490     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12491         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12492
 12493     GO TO 1430-CHECK-AH-TOLERANCE.
 12494
 12495 1425-CONT-WHOLE-MONTH-PMTS.
 12496******************************************************************
 12497****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12498****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12499****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12500******************************************************************
 12501
 12502     IF PI-COMPANY-ID = 'ACM'
 12503        NEXT SENTENCE
 12504     ELSE
 12505        IF DC-ODD-DAYS-OVER = +0
 12506            NEXT SENTENCE
 12507        ELSE
 12508            MOVE ER-0845            TO  EMI-ERROR
 12509            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12510            GO TO 1430-CHECK-AH-TOLERANCE.
 12511
 12512     COMPUTE PI-CPYAMT ROUNDED =
 12513                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12514
 12515 1430-CHECK-AH-TOLERANCE.
 12516     IF PI-PMT-APPR-SW = 'G'
 12517         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12518
 12519*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12520*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12521*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12522*
 12523*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12524*      IF WDF-MONTH = 02
 12525*        IF SAVE-ELAPSED-MONTHS = 0
 12526*          NEXT SENTENCE
 12527*        ELSE
 12528*          IF SAVE-ODD-DAYS-OVER > 0
 12529*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12530*            COMPUTE WS-PMT-MOS ROUNDED =
 12531*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12532*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12533*                                     WS-PMT-MOS
 12534*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12535*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12536*          ELSE
 12537*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12538*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12539*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12540*                                     WS-PMT-MOS.
 12541
 12542     IF WS-MAX-PMT-TOL NOT = ZERO
 12543        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12544           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12545            MOVE ER-0494         TO  EMI-ERROR
 12546            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 241
* EL156.cbl
 12547            GO TO 1500-EDIT-EXPENSES.
 12548
 12549 1430-CONT-CHECK-AH-TOLERANCE.
 12550
 12551     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12552        GO TO 1500-EDIT-EXPENSES.
 12553
 12554     IF CM-O-B-COVERAGE
 12555        GO TO 1500-EDIT-EXPENSES.
 12556
 12557     IF PI-COMPANY-ID = 'NCL'
 12558       IF FOUND-TOL-SW = 'Y'
 12559         IF WS-PMT-TOL NOT = ZERO
 12560           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12561              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12562                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12563                  IF WS-NCL-PMT-OPTION = SPACES
 12564                      MOVE ER-0699 TO EMI-ERROR
 12565                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12566                  ELSE
 12567                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12568                      NEXT SENTENCE
 12569                  ELSE
 12570                  IF NOT WS-VALID-NCL-OPTION
 12571                      MOVE ER-0699 TO EMI-ERROR
 12572                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12573
 12574     IF WS-PMT-TOL NOT = ZERO
 12575        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12576           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12577           MOVE ER-0495          TO EMI-ERROR
 12578           PERFORM 1490-PAYMENT-ERROR
 12579                                 THRU 1490-EXIT
 12580        end-if
 12581     end-if
 12582
 12583     GO TO 1500-EDIT-EXPENSES.
 12584
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 242
* EL156.cbl
 12586 1440-COMPUTE-LIFE-REMAINING.
 12587
 12588     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12589        IF PI-PMTTYPE = '4'
 12590          MOVE PI-EPYAMT TO PI-CPYAMT
 12591          GO TO 1460-TEST-TYPE.
 12592
 12593     IF WS-LF-COVERAGE-TYPE = 'L'
 12594        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12595                          - CL-TOTAL-PAID-AMT
 12596        GO TO 1450-CHECK-MAX.
 12597
 12598     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12599        PI-LF-COVERAGE-TYPE = 'P'
 12600          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12601                              CM-LF-ITD-DEATH-AMT
 12602          GO TO 1450-CHECK-MAX.
 12603
 12604     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12605     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12606     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12607     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12608     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12609     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12610     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12611     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12612     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12613
 12614     PERFORM 9800-LINK-REM-TERM.
 12615
 12616     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12617     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12618     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12619     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12620     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12621     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12622     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12623     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12624     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12625     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12626     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12627     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12628     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12629     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12630     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12631     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12632     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12633        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12634        MOVE PI-CARRIER          TO ACCT-CARRIER
 12635        MOVE PI-GROUPING         TO ACCT-GROUPING
 12636        MOVE PI-STATE            TO ACCT-STATE
 12637        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12638        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12639        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12640        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12641
 12642
 12643* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 243
* EL156.cbl
 12644*          DATASET ('ERACCT')
 12645*          RIDFLD  (ERACCT-KEY)
 12646*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12647*          GTEQ
 12648*          resp    (WS-RESPONSE)
 12649*       END-EXEC
 12650     MOVE 'ERACCT' TO DFHEIV1
 12651*    MOVE '&"S        G          (  N#00012088' TO DFHEIV0
 12652     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12653     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12654     MOVE X'204E233030303132303838' TO DFHEIV0(25:11)
 12655     CALL 'kxdfhei1' USING DFHEIV0,
 12656           DFHEIV1,
 12657           DFHEIV20,
 12658           DFHEIV99,
 12659           ERACCT-KEY,
 12660           DFHEIV99,
 12661           DFHEIV99,
 12662           DFHEIV99
 12663     SET ADDRESS OF ACCOUNT-MASTER TO
 12664         DFHEIV20
 12665     MOVE EIBRESP  TO WS-RESPONSE
 12666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12667        IF WS-RESP-NORMAL
 12668           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12669           and (pi-cert-eff-dt < am-expiration-dt)
 12670           and (pi-cert-eff-dt >= am-effective-dt)
 12671           move am-dcc-product-code to pi-dcc-product-code
 12672        else
 12673           move spaces           to pi-dcc-product-code
 12674        end-if
 12675        if pi-dcc-product-code not = spaces
 12676           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12677           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12678           PERFORM 0900-GET-DDF-limits
 12679                                 THRU 0900-EXIT
 12680           IF PDEF-FOUND
 12681              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12682                 (P1 > +8)
 12683                 OR (PD-PROD-CODE (P1) = 'L')
 12684              END-PERFORM
 12685              IF P1 < +9
 12686                 MOVE PD-MAX-AMT (P1)
 12687                                 TO CP-R-MAX-TOT-BEN
 12688              else
 12689                 move er-1674    to emi-error
 12690                 PERFORM 9900-ERROR-FORMAT
 12691                                 THRU 9900-EXIT
 12692              END-IF
 12693           else
 12694              move er-1672       to emi-error
 12695              PERFORM 9900-ERROR-FORMAT
 12696                                 THRU 9900-EXIT
 12697           END-IF
 12698        end-if
 12699     END-IF
 12700
 12701* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 244
* EL156.cbl
 12702*       PROGRAM  (LINK-REMAMT)
 12703*       COMMAREA (CALCULATION-PASS-AREA)
 12704*       LENGTH   (CP-COMM-LENGTH)
 12705*    END-EXEC.
 12706*    MOVE '."C                   (   #00012128' TO DFHEIV0
 12707     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12708     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12709     MOVE X'2020233030303132313238' TO DFHEIV0(25:11)
 12710     CALL 'kxdfhei1' USING DFHEIV0,
 12711           LINK-REMAMT,
 12712           CALCULATION-PASS-AREA,
 12713           CP-COMM-LENGTH,
 12714           DFHEIV99,
 12715           DFHEIV99,
 12716           DFHEIV99,
 12717           DFHEIV99
 12718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12719
 12720
 12721     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12722
 12723     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12724     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12725
 12726     IF PI-COMPANY-ID = 'BOA' AND
 12727        PI-PMTTYPE    = '2'   AND
 12728        PI-OFFLINE    = 'N'
 12729           GO TO 1441-COMPUTE-BOA-INTEREST.
 12730
 12731     IF PI-COMPANY-ID = 'NCL' AND
 12732        PI-PMTTYPE    = '2'   AND
 12733        PI-OFFLINE    = 'N'
 12734          GO TO 1442-COMPUTE-NCL-INTEREST
 12735       ELSE
 12736          GO TO 1445-CONTINUE.
 12737
 12738 1441-COMPUTE-BOA-INTEREST.
 12739     MOVE +0             TO WS-CALC-INT.
 12740
 12741     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12742     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12743     MOVE +0             TO DC-ELAPSED-MONTHS
 12744                            DC-ELAPSED-DAYS.
 12745     MOVE '1'            TO DC-OPTION-CODE.
 12746     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12747     IF NO-CONVERSION-ERROR
 12748         NEXT SENTENCE
 12749     ELSE
 12750         GO TO 1445-CONTINUE.
 12751
 12752     IF (PI-INT-RATE NOT > ZEROS)  AND
 12753        (DC-ELAPSED-DAYS > +30)
 12754         MOVE ER-3531            TO EMI-ERROR
 12755         MOVE -1                 TO PINTL
 12756         MOVE AL-UNBON           TO PINTA
 12757         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12758
 12759     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 245
* EL156.cbl
 12760         GO TO 1445-CONTINUE.
 12761
 12762     IF (PI-INT-RATE NOT > ZEROS)  OR
 12763        (DC-ELAPSED-DAYS NOT > +30)
 12764         MOVE PI-EPYAMT TO PI-CPYAMT
 12765         GO TO 1441-FORMAT-NOTE.
 12766
 12767     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12768                                 *  PI-INT-RATE
 12769                                 *  DC-ELAPSED-DAYS
 12770                                 /  365
 12771                                 /  100.
 12772
 12773     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12774
 12775 1441-FORMAT-NOTE.
 12776
 12777     MOVE SPACES        TO WS-BOANOTE1.
 12778     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12779     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12780     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12781     MOVE AL-UANON      TO NOTE1A.
 12782
 12783     IF WS-CALC-INT > ZEROS
 12784         MOVE SPACES        TO WS-BOANOTE2
 12785         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12786         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12787         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12788         MOVE AL-UANON      TO NOTE2A.
 12789
 12790     GO TO 1445-CONTINUE.
 12791
 12792 1442-COMPUTE-NCL-INTEREST.
 12793     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12794     MOVE PI-STATE               TO WS-ST-ACCESS.
 12795     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12796     MOVE '3'                    TO CNTL-REC-TYPE.
 12797     MOVE +0                     TO CNTL-SEQ-NO.
 12798     MOVE 'STAT'                 TO FILE-SWITCH.
 12799
 12800     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12801
 12802     MOVE +0                 TO WS-CALC-INT.
 12803
 12804     IF ST-STAT-FROM-INCURRED
 12805         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12806       ELSE
 12807     IF ST-STAT-FROM-REPORTED
 12808         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12809       ELSE
 12810         GO TO 1445-CONTINUE.
 12811
 12812     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12813     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12814     MOVE +0                 TO DC-ELAPSED-MONTHS
 12815                                DC-ELAPSED-DAYS.
 12816     MOVE '1'                TO DC-OPTION-CODE.
 12817     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 246
* EL156.cbl
 12818     IF NO-CONVERSION-ERROR
 12819         NEXT SENTENCE
 12820     ELSE
 12821         GO TO 1445-CONTINUE.
 12822
 12823     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12824        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12825         GO TO 1445-CONTINUE.
 12826
 12827     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12828                                 *  CF-ST-STAT-INTEREST.
 12829
 12830     MOVE SPACES              TO WS-NCLNOTE1.
 12831     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12832     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12833     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12834                                 PI-PMTNOTE1
 12835                                 NOTE1I.
 12836     MOVE AL-UANON            TO NOTE1A.
 12837
 12838     IF WS-CALC-INT > ZEROS
 12839         MOVE SPACES          TO WS-NCLNOTE2
 12840         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12841         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12842         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12843                                 PI-PMTNOTE2
 12844                                 NOTE2I
 12845         MOVE AL-UANON        TO NOTE2A.
 12846
 12847     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12848
 12849 1445-CONTINUE.
 12850
 12851     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12852        GO TO 1460-TEST-TYPE.
 12853
 12854     IF CM-O-B-COVERAGE
 12855        GO TO 1460-TEST-TYPE.
 12856
 12857     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12858         GO TO 1450-CHECK-MAX.
 12859
 12860     if (pi-company-id = 'DCC' or 'VPP')
 12861        and (pdef-found)
 12862        if pi-epyamt > pd-max-amt (p1)
 12863           move er-1657          to emi-error
 12864           perform 1490-payment-error
 12865                                 thru 1490-exit
 12866           go to 1460-test-type
 12867        end-if
 12868     else
 12869        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12870           > PI-EPYAMT)
 12871                         OR
 12872           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12873           < PI-EPYAMT)
 12874           MOVE ER-0594          TO EMI-ERROR
 12875           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 247
* EL156.cbl
 12876                                 THRU 1490-EXIT
 12877           GO TO 1460-TEST-TYPE
 12878        end-if
 12879     end-if
 12880     .
 12881 1450-CHECK-MAX.
 12882
 12883     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12884        PI-LF-COVERAGE-TYPE = 'P'
 12885         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12886                                   CM-LF-ITD-DEATH-AMT
 12887     ELSE
 12888         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12889                                   CL-TOTAL-PAID-AMT.
 12890
 12891     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12892          MOVE ER-0543           TO EMI-ERROR
 12893          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12894
 12895 1460-TEST-TYPE.
 12896
 12897     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12898        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 12899           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12900                                   CM-LF-ALT-BENEFIT-AMT -
 12901                                   CL-TOTAL-PAID-AMT
 12902           IF PI-EPYAMT > WS-LF-BEN-AMT
 12903               MOVE ER-0543      TO EMI-ERROR
 12904               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12905           END-IF
 12906        END-IF
 12907     END-IF
 12908
 12909     IF PI-PMT-APPR-SW = 'G'
 12910       NEXT SENTENCE
 12911     ELSE
 12912       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12913         IF PI-EPYAMT = ZERO
 12914             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12915                 MOVE ER-0494    TO  EMI-ERROR
 12916                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12917                 GO TO 1500-EDIT-EXPENSES
 12918             ELSE
 12919                 NEXT SENTENCE
 12920         ELSE
 12921             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12922                 MOVE ER-0494    TO  EMI-ERROR
 12923                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12924                 GO TO 1500-EDIT-EXPENSES.
 12925
 12926     IF PI-PMTTYPE NOT = '2' OR
 12927        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12928         GO TO 1500-EDIT-EXPENSES.
 12929
 12930     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12931     MOVE ER-0526                TO EMI-ERROR.
 12932     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12933
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 248
* EL156.cbl
 12934     IF EMI-ERROR-NUMBER (1) = '0526'
 12935        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12936
 12937     IF EMI-ERROR-NUMBER (2) = '0526'
 12938        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12939
 12940     GO TO 1500-EDIT-EXPENSES.
 12941
 12942 1490-PAYMENT-ERROR.
 12943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12944
 12945     IF EMI-MESSAGE-FORMATTED
 12946         MOVE -1                 TO EPYAMTL
 12947         MOVE AL-UNBON           TO EPYAMTA.
 12948
 12949 1490-EXIT.
 12950      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 249
* EL156.cbl
 12952 1500-EDIT-EXPENSES.
 12953     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12954         GO TO 1500-SKIP-ERROR-0556.
 12955
 12956 1500-CONTINUE-ON.
 12957
 12958     IF CM-O-B-COVERAGE
 12959        MOVE ER-0556             TO EMI-ERROR
 12960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12961
 12962 1500-SKIP-ERROR-0556.
 12963     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12964        IF PI-EEXPENS NOT = ZEROS
 12965           MOVE ER-0524          TO EMI-ERROR
 12966           GO TO 1590-EXPENSE-ERROR
 12967        ELSE
 12968           GO TO 1600-EDIT-RESERVES.
 12969
 12970     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12971     MOVE '6'                    TO CNTL-REC-TYPE.
 12972
 12973     IF CONTROL-IS-ACTUAL-CARRIER
 12974         MOVE PI-CARRIER         TO WS-CARR
 12975     ELSE
 12976         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12977
 12978     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12979     MOVE +0                     TO CNTL-SEQ-NO.
 12980     MOVE 'CARR'                 TO FILE-SWITCH.
 12981
 12982     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12983
 12984     IF EXPENSE-CALC-MANUAL
 12985        GO TO 1600-EDIT-RESERVES.
 12986
 12987     IF DOLLARS-PER-PMT
 12988        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12989        GO TO 1600-EDIT-RESERVES.
 12990
 12991     IF DOLLARS-PER-MONTH AND
 12992        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12993       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12994       GO TO 1600-EDIT-RESERVES.
 12995
 12996     IF PERCENT-OF-PAYMENT
 12997        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12998
 12999     GO TO 1600-EDIT-RESERVES.
 13000
 13001 1590-EXPENSE-ERROR.
 13002     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13003
 13004     IF EMI-MESSAGE-FORMATTED
 13005        MOVE -1                  TO EEXPENSL
 13006        MOVE AL-UNBON            TO EEXPENSA.
 13007
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 250
* EL156.cbl
 13009 1600-EDIT-RESERVES.
 13010     IF PI-PMTTYPE = '4' OR '5' OR '6'
 13011        IF PI-ERESV = ZEROS
 13012           GO TO 1700-EDIT-EXPENSE-TYPE
 13013        ELSE
 13014           MOVE ER-0525          TO EMI-ERROR
 13015           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 13016           GO TO 1700-EDIT-EXPENSE-TYPE.
 13017
 13018     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13019     MOVE ZEROS                  TO TRLR-SEQ-NO.
 13020     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13021
 13022     IF NOT AT-MANUAL-RESERVES-USED
 13023        IF PI-ERESV NOT = ZEROS
 13024           MOVE ER-0518          TO EMI-ERROR
 13025           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 13026
 13027     IF AT-MANUAL-RESERVES-USED
 13028        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 13029        GO TO 1700-EDIT-EXPENSE-TYPE.
 13030
 13031     IF AT-FUTURE-RESERVES-USED
 13032        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 13033
 13034     IF AT-FUTURE-RESERVES-USED
 13035        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 13036
 13037     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 13038        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 13039
 13040     IF AT-IBNR-RESERVES-USED
 13041        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 13042
 13043     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 13044     GO TO 1700-EDIT-EXPENSE-TYPE.
 13045
 13046 1690-RESERVE-ERROR.
 13047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13048
 13049     IF EMI-MESSAGE-FORMATTED
 13050        MOVE AL-UNBON            TO ERESVA
 13051        MOVE -1                  TO ERESVL.
 13052
 13053 1690-EXIT.
 13054      EXIT.
 13055
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 251
* EL156.cbl
 13057 1700-EDIT-EXPENSE-TYPE.
 13058     IF PI-PMTTYPE NOT = '5' AND '6'
 13059        GO TO 2000-EDIT-DONE.
 13060
 13061     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 13062                   '6' OR '7' OR '8' OR '9'
 13063        GO TO 2000-EDIT-DONE.
 13064
 13065 1705-EXPENSE-ERROR.
 13066     MOVE ER-0573                TO EMI-ERROR.
 13067     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13068
 13069     IF EMI-MESSAGE-FORMATTED
 13070        MOVE AL-UABON            TO ETYPEA
 13071        MOVE -1                  TO ETYPEL.
 13072
 13073     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 252
* EL156.cbl
 13075 1950-NOT-FOUND.
 13076     IF FILE-SWITCH = 'MSTR'
 13077        MOVE ER-0204             TO EMI-ERROR.
 13078
 13079     IF FILE-SWITCH = 'CARR'
 13080        MOVE ER-0252             TO EMI-ERROR.
 13081
 13082     IF FILE-SWITCH = 'COMP'
 13083        MOVE ER-0254             TO EMI-ERROR.
 13084
 13085     IF FILE-SWITCH = 'STAT'
 13086        MOVE ER-0149             TO EMI-ERROR.
 13087
 13088     IF FILE-SWITCH = 'PROC'
 13089        MOVE ER-0019             TO EMI-ERROR.
 13090
 13091     IF FILE-SWITCH = 'ACCT'
 13092        MOVE ER-0198             TO EMI-ERROR.
 13093
 13094     IF FILE-SWITCH = 'BENE'
 13095        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 13096           MOVE ER-0282          TO EMI-ERROR
 13097        ELSE
 13098           MOVE ER-0283          TO EMI-ERROR.
 13099
 13100     MOVE -1                     TO PMTTYPEL.
 13101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13102
 13103     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 13104                                     WS-FORCE-CTR.
 13105
 13106     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 13107                                     WS-FATAL-CTR.
 13108
 13109     GO TO 8200-SEND-DATAONLY.
 13110
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 253
* EL156.cbl
 13112 2000-EDIT-DONE.
 13113     perform 2210-dcc-max-benes thru 2210-exit
 13114     if pi-company-id not = 'DCC' and 'VPP'
 13115        IF (WS-SPECIAL-CALC-CD = 'C')
 13116           and (cl-critical-period > 0)
 13117           IF CM-AH-BENEFIT-AMT NOT = ZERO
 13118              IF PI-EPYAMT > ZEROS
 13119                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13120                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 13121              ELSE
 13122                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13123                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 13124              END-IF
 13125              if ws-benefits-paid > cl-critical-period
 13126                 MOVE ER-0657          TO EMI-ERROR
 13127                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13128              END-IF
 13129           END-IF
 13130        END-IF
 13131     end-if
 13132     IF PI-HOLDTIL NOT = ZEROS
 13133        MOVE PI-HOLDTIL          TO HOLDTILO
 13134        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'
 13135        MOVE ER-3272          TO EMI-ERROR
 13136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13137     END-IF
 13138
 13139     IF PI-EPYFROM NOT = ZEROS
 13140        MOVE PI-EPYFROM          TO EPYFROMO
 13141        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 13142
 13143     IF PI-EPYTHRU NOT = ZEROS
 13144        MOVE PI-EPYTHRU            TO EPYTHRUO
 13145        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 13146        IF PI-USES-PAID-TO
 13147           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13148           MOVE '4'                TO DC-OPTION-CODE
 13149           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13150           IF NO-CONVERSION-ERROR
 13151              MOVE +1              TO DC-ELAPSED-DAYS
 13152              MOVE +0              TO DC-ELAPSED-MONTHS
 13153              MOVE '6'             TO DC-OPTION-CODE
 13154              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13155              IF NO-CONVERSION-ERROR
 13156                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13157
 13158     MOVE PI-EDAYS               TO EDAYSO.
 13159
 13160     IF PI-AIGFROM NOT = ZEROS
 13161        MOVE PI-AIGFROM          TO AIGFROMO
 13162        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13163
 13164     MOVE PI-EPYAMT              TO EPYAMTO.
 13165     MOVE PI-ERESV               TO ERESVO.
 13166     MOVE PI-EEXPENS             TO EEXPENSO.
 13167
 13168     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13169     MOVE SPACES                 TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 254
* EL156.cbl
 13170     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13171
 13172     IF DATE-CONVERSION-ERROR
 13173        MOVE SPACES              TO CPYFROMI
 13174     ELSE
 13175        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13176        IF PI-EPYFROM = ZEROS
 13177           MOVE AL-UANON             TO EPYFROMA
 13178           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13179           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13180
 13181     IF PI-USES-PAID-TO
 13182        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13183        MOVE +1                            TO DC-ELAPSED-DAYS
 13184        MOVE +0                            TO DC-ELAPSED-MONTHS
 13185        MOVE '6'                           TO DC-OPTION-CODE
 13186        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13187        IF NO-CONVERSION-ERROR
 13188           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13189           IF PI-EPYTHRU = ZEROS
 13190              MOVE AL-UANON                TO EPYTHRUA
 13191              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13192              MOVE ' '                     TO DC-OPTION-CODE
 13193              MOVE +0                      TO DC-ELAPSED-DAYS
 13194                                              DC-ELAPSED-MONTHS
 13195              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13196              IF NO-CONVERSION-ERROR
 13197                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13198                  GO TO 2001-CONTINUE
 13199              ELSE
 13200                  GO TO 2001-CONTINUE
 13201           ELSE
 13202              GO TO 2001-CONTINUE.
 13203
 13204     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13205     MOVE SPACES                 TO DC-OPTION-CODE.
 13206     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13207
 13208     IF DATE-CONVERSION-ERROR
 13209        MOVE SPACES              TO CPYTHRUI
 13210     ELSE
 13211        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13212        IF PI-EPYTHRU = ZEROS
 13213           MOVE AL-UANON TO EPYTHRUA
 13214           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13215           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13216
 13217 2001-CONTINUE.
 13218
 13219     MOVE PI-CDAYS               TO CDAYSO.
 13220
 13221     IF PI-EDAYS = ZEROS
 13222        MOVE AL-UNNON TO EDAYSA
 13223        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13224
 13225     MOVE PI-CPYAMT              TO CPYAMTO.
 13226
 13227     IF PI-EPYAMT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 255
* EL156.cbl
 13228        MOVE AL-UNNON            TO EPYAMTA
 13229        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13230
 13231     MOVE PI-CRESV               TO CRESVO.
 13232     MOVE PI-CEXPENS             TO CEXPENSO.
 13233
 13234     IF PI-EEXPENS = ZEROS
 13235        MOVE AL-UNNON TO EEXPENSA
 13236        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13237
 13238     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13239        AND (CL-CLAIM-TYPE = 'L')
 13240        AND (PI-OFFLINE NOT EQUAL 'Y')
 13241        IF PI-PMTTYPE = '2' OR '4'
 13242           PERFORM 2200-CALC-INTEREST
 13243                                 THRU 2200-EXIT
 13244        END-IF
 13245     END-IF
 13246     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13247     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13248     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13249
 13250     IF EMI-FATAL-CTR = ZEROS
 13251        MOVE 'B'                 TO PI-PASS-SW.
 13252
 13253     IF NOT EMI-MESSAGE-FORMATTED
 13254         MOVE -1                 TO EPYFROML
 13255     ELSE
 13256         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13257            EMI-ERROR-NUMBER (2) = SPACES
 13258             MOVE -1             TO EPYFROML.
 13259
 13260     GO TO 8200-SEND-DATAONLY.
 13261
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 256
* EL156.cbl
 13263 2200-CALC-INTEREST.
 13264     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13265        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13266        MOVE '4'                 TO DC-OPTION-CODE
 13267        PERFORM 9700-LINK-DATE-CONVERT
 13268        IF DATE-CONVERSION-ERROR
 13269            MOVE LOW-VALUES      TO CP-PRF-DT
 13270        ELSE
 13271           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13272        END-IF
 13273     END-IF
 13274     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13275        if pi-rb-joint-coverage
 13276           move 'Y'              to pi-int-to-rem-borr
 13277        end-if
 13278     end-if
 13279     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13280        IN CLAIM-INT-PASS-AREA
 13281     MOVE CL-CERT-STATE          TO CP-STATE
 13282        IN CLAIM-INT-PASS-AREA
 13283     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13284     MOVE 'LF'                   TO CP-COVERAGE
 13285     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13286     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13287     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13288     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13289     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13290     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13291
 13292* EXEC CICS LINK
 13293*       PROGRAM   ('ELCLMI')
 13294*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13295*       LENGTH    (CP-CLAIM-LENGTH)
 13296*    END-EXEC
 13297     MOVE 'ELCLMI' TO DFHEIV1
 13298*    MOVE '."C                   (   #00012704' TO DFHEIV0
 13299     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13301     MOVE X'2020233030303132373034' TO DFHEIV0(25:11)
 13302     CALL 'kxdfhei1' USING DFHEIV0,
 13303           DFHEIV1,
 13304           CLAIM-INT-PASS-AREA,
 13305           CP-CLAIM-LENGTH,
 13306           DFHEIV99,
 13307           DFHEIV99,
 13308           DFHEIV99,
 13309           DFHEIV99
 13310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13311     MOVE AL-PANOF               TO PINTHA
 13312                                    PINTA
 13313     if cp-clm-int-amt = zeros
 13314        move ' ' to pi-int-to-rem-borr
 13315     end-if
 13316     IF NO-CI-ERROR
 13317        MOVE CP-CLM-INT-AMT      TO PINTO
 13318                                    PI-INT-AMT
 13319        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13320        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 257
* EL156.cbl
 13321        MOVE AL-PANOF            TO PINTHA
 13322                                    PINTA
 13323        if pi-rb-joint-coverage
 13324           and pi-int-amt > zeros
 13325           move '  INT TO'       to itrb1o
 13326           move ' REM BORR?'     to itrb2o
 13327           move pi-int-to-rem-borr
 13328                                 to itrbyno
 13329           move al-uanon         to itrbyna
 13330           move +1               to itrbynl
 13331        else
 13332           move ' '              to pi-int-to-rem-borr
 13333        end-if
 13334     ELSE
 13335        IF CI-RETURN-CODE = '8'
 13336           MOVE ER-3818          TO EMI-ERROR
 13337           MOVE -1               TO ZINTL
 13338           PERFORM 9900-ERROR-FORMAT
 13339                                 THRU 9900-EXIT
 13340           GO TO 2200-EXIT
 13341        ELSE
 13342           MOVE ZEROS            TO PINTO
 13343                                    PI-INT-AMT
 13344                                    PI-INT-DAYS
 13345                                    PI-INT-RATE-USED
 13346        END-IF
 13347     END-IF
 13348     IF PI-INT-AMT NOT = ZEROS
 13349        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13350           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13351           CONTINUE
 13352        ELSE
 13353           MOVE CL-SOC-SEC-NO (1:3)
 13354                                 TO WS-SSN (1:3)
 13355           MOVE CL-SOC-SEC-NO (5:2)
 13356                                 TO WS-SSN (4:2)
 13357           MOVE CL-SOC-SEC-NO (8:4)
 13358                                 TO WS-SSN (6:4)
 13359           IF (WS-SSN NUMERIC)
 13360              AND (WS-SSN NOT = ZEROS)
 13361              CONTINUE
 13362           ELSE
 13363              MOVE ER-2044       TO EMI-ERROR
 13364              PERFORM 9900-ERROR-FORMAT
 13365                                 THRU 9900-EXIT
 13366           END-IF
 13367        END-IF
 13368        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13369        if pi-int-to-rem-borr = 'Y'
 13370           move +61              to trlr-seq-no
 13371        else
 13372           MOVE +51              TO TRLR-SEQ-NO
 13373        end-if
 13374
 13375* EXEC CICS READ
 13376*          DATASET  ('ELTRLR')
 13377*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13378*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 258
* EL156.cbl
 13379*          RESP     (WS-RESPONSE)
 13380*       END-EXEC
 13381     MOVE 'ELTRLR' TO DFHEIV1
 13382*    MOVE '&"S        E          (  N#00012772' TO DFHEIV0
 13383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13385     MOVE X'204E233030303132373732' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0,
 13387           DFHEIV1,
 13388           DFHEIV20,
 13389           DFHEIV99,
 13390           ELTRLR-KEY,
 13391           DFHEIV99,
 13392           DFHEIV99,
 13393           DFHEIV99
 13394     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13395         DFHEIV20
 13396     MOVE EIBRESP  TO WS-RESPONSE
 13397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13398        IF (NOT WS-RESP-NORMAL)
 13399                    OR
 13400           ((WS-RESP-NORMAL)
 13401           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13402           OR (AT-CITY-STATE = SPACES)))
 13403           MOVE ER-0874          TO EMI-ERROR
 13404           if pi-rb-joint-coverage
 13405              move -1            to itrbynl
 13406           end-if
 13407           PERFORM 9900-ERROR-FORMAT
 13408                                 THRU 9900-EXIT
 13409        else
 13410           move at-mail-to-name  to pi-int-payees-name
 13411        END-IF
 13412     END-IF
 13413     .
 13414 2200-EXIT.
 13415     EXIT.
 13416 2210-dcc-max-benes.
 13417
 13418     move pi-ah-term             to ws-max-bens
 13419     if cl-critical-period not = zeros and spaces
 13420        move cl-critical-period  to ws-max-bens
 13421     end-if
 13422     move cm-ah-benefit-amt      to ws-monthly-benefit
 13423     if pdef-found
 13424        and (pd-max-amt (p1) not = zeros)
 13425        if pd-ben-pct (p1) not numeric
 13426           move zeros            to pd-ben-pct (p1)
 13427        end-if
 13428        if pd-ben-pct (p1) = zeros
 13429           move +1               to ws-work-ben-pct
 13430        else
 13431           move pd-ben-pct (p1)  to ws-work-ben-pct
 13432        end-if
 13433*       compute ws-monthly-benefit =
 13434*          ws-monthly-benefit * ws-work-ben-pct
 13435*       if ws-monthly-benefit > pd-max-amt (p1)
 13436*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 259
* EL156.cbl
 13437*       end-if
 13438     end-if
 13439
 13440     move cl-cert-key-data       to elcrtt-key (2:21)
 13441     move cl-company-cd          to ctrlr-comp-cd
 13442     move cl-cert-no             to ctrlr-cert-no
 13443     move 'B'                    to ctrlr-rec-type
 13444
 13445
 13446* EXEC CICS READ
 13447*       DATASET  ('ELCRTT')
 13448*       set      (address of CERTIFICATE-TRAILERS)
 13449*       RIDFLD   (ELCRTT-KEY)
 13450*       RESP     (WS-RESPONSE)
 13451*    END-EXEC
 13452     MOVE 'ELCRTT' TO DFHEIV1
 13453*    MOVE '&"S        E          (  N#00012825' TO DFHEIV0
 13454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13456     MOVE X'204E233030303132383235' TO DFHEIV0(25:11)
 13457     CALL 'kxdfhei1' USING DFHEIV0,
 13458           DFHEIV1,
 13459           DFHEIV20,
 13460           DFHEIV99,
 13461           ELCRTT-KEY,
 13462           DFHEIV99,
 13463           DFHEIV99,
 13464           DFHEIV99
 13465     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13466         DFHEIV20
 13467     MOVE EIBRESP  TO WS-RESPONSE
 13468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13469     IF not WS-RESP-NORMAL
 13470        go to 2210-exit
 13471     end-if
 13472
 13473*    if instypei = 'P'
 13474*       move +1 to s1
 13475*    else
 13476*       MOVE +2 to s1
 13477*    end-if
 13478
 13479*    move +1 to s1
 13480*    evaluate cl-claim-type
 13481*       when 'A'
 13482*          move +1 to s2
 13483*       when 'I'
 13484*          move +2 to s2
 13485*       when 'G'
 13486*          move +3 to s2
 13487*       when 'L'
 13488*          move +4 to s2
 13489*       when 'P'
 13490*          move +5 to s2
 13491*    end-evaluate
 13492
 13493     move zeros                  to ws-prev-days-paid
 13494                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 260
* EL156.cbl
 13495                                    ws-prev-amt-paid
 13496     perform varying s1 from +1 by +1 until
 13497        (s1 > +24)
 13498        or (cs-claim-type (s1) = spaces)
 13499        if pi-company-id not = 'DCC' and 'VPP'
 13500           if cs-claim-type (s1) = cl-claim-type
 13501              compute ws-prev-days-paid =
 13502                 ws-prev-days-paid + cs-days-paid (s1)
 13503              compute ws-prev-amt-paid =
 13504                 ws-prev-amt-paid + cs-total-paid (s1)
 13505           end-if
 13506        else
 13507           if (cs-claim-type (s1) = cl-claim-type)
 13508              and (cs-benefit-period (s1) = cl-benefit-period)
 13509              and (cs-insured-type (s1) = cl-insured-type)
 13510              compute ws-prev-days-paid =
 13511                 ws-prev-days-paid + cs-days-paid (s1)
 13512              compute ws-prev-amt-paid =
 13513                 ws-prev-amt-paid + cs-total-paid (s1)
 13514           end-if
 13515        end-if
 13516     end-perform
 13517     if pi-epyamt > zeros
 13518        compute ws-benefits-paid =
 13519           (ws-prev-amt-paid + pi-epyamt)
 13520           / ws-monthly-benefit
 13521     else
 13522        compute ws-benefits-paid =
 13523           (ws-prev-amt-paid + pi-cpyamt)
 13524           / ws-monthly-benefit
 13525     end-if
 13526*    if pi-company-id = 'DCC'
 13527     if cl-claim-type not = 'L' and 'O' and 'P'
 13528        if ws-benefits-paid > ws-max-bens
 13529           move er-1658          to emi-error
 13530           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13531        end-if
 13532     end-if
 13533*    end-if
 13534*     if s1 < +25
 13535*        if pi-epyamt > zeros
 13536*           compute ws-benefits-paid =
 13537*              (cs-total-paid (s1) + PI-EPYAMT)
 13538*              / ws-monthly-benefit
 13539*        else
 13540*           compute ws-benefits-paid =
 13541*              (cs-total-paid (s1) + PI-CPYAMT)
 13542*              / ws-monthly-benefit
 13543*        end-if
 13544
 13545*       if ws-benefits-paid > pd-crit-period (p1)
 13546*        if ws-benefits-paid > ws-max-bens
 13547*           move er-1658          to emi-error
 13548*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13549*        end-if
 13550*     end-if
 13551     .
 13552 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 261
* EL156.cbl
 13553     exit.
 13554
 13555 2220-update-elcrtt.
 13556
 13557
 13558* EXEC CICS GETMAIN
 13559*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13560*       LENGTH   (ELCRTT-LENGTH)
 13561*       INITIMG  (GETMAIN-SPACE)
 13562*    END-EXEC
 13563*    MOVE ',"IL                  $   #00012919' TO DFHEIV0
 13564     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13565     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13566     MOVE X'2020233030303132393139' TO DFHEIV0(25:11)
 13567     CALL 'kxdfhei1' USING DFHEIV0,
 13568           DFHEIV20,
 13569           ELCRTT-LENGTH,
 13570           GETMAIN-SPACE
 13571     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13572         DFHEIV20
 13573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13574
 13575     move cl-cert-key-data       to elcrtt-key (2:21)
 13576     move cl-company-cd          to ctrlr-comp-cd
 13577     move cl-cert-no             to ctrlr-cert-no
 13578     move 'B'                    to ctrlr-rec-type
 13579
 13580
 13581* EXEC CICS READ
 13582*       UPDATE
 13583*       DATASET  (ELCRTT-DSID)
 13584*       into     (CERTIFICATE-TRAILERS)
 13585*       RIDFLD   (ELCRTT-KEY)
 13586*       RESP     (WS-RESPONSE)
 13587*    END-EXEC
 13588     MOVE LENGTH OF
 13589      CERTIFICATE-TRAILERS
 13590       TO DFHEIV11
 13591*    MOVE '&"IL       EU         (  N#00012930' TO DFHEIV0
 13592     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13593     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13594     MOVE X'204E233030303132393330' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0,
 13596           ELCRTT-DSID,
 13597           CERTIFICATE-TRAILERS,
 13598           DFHEIV11,
 13599           ELCRTT-KEY,
 13600           DFHEIV99,
 13601           DFHEIV99,
 13602           DFHEIV99
 13603     MOVE EIBRESP  TO WS-RESPONSE
 13604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13605
 13606     IF WS-RESP-NORMAL
 13607        perform 2225-upd-crt-trlr thru 2225-exit
 13608
 13609* EXEC CICS REWRITE
 13610*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 262
* EL156.cbl
 13611*          from     (CERTIFICATE-TRAILERS)
 13612*          RESP     (WS-RESPONSE)
 13613*       END-EXEC
 13614     MOVE LENGTH OF
 13615      CERTIFICATE-TRAILERS
 13616       TO DFHEIV11
 13617*    MOVE '&& L                  %  N#00012940' TO DFHEIV0
 13618     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13619     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13620     MOVE X'204E233030303132393430' TO DFHEIV0(25:11)
 13621     CALL 'kxdfhei1' USING DFHEIV0,
 13622           ELCRTT-DSID,
 13623           CERTIFICATE-TRAILERS,
 13624           DFHEIV11,
 13625           DFHEIV99
 13626     MOVE EIBRESP  TO WS-RESPONSE
 13627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13628     else
 13629        if ws-resp-notfnd
 13630           move 'CS'             to certificate-trailers
 13631           move cl-company-cd    to cs-company-cd
 13632           move cl-cert-key-data to cs-control-primary (2:21)
 13633           move cl-cert-no       to cs-cert-no
 13634           move 'B'              to cs-trailer-type
 13635           perform varying s1 from +1 by +1 until s1 > +24
 13636              move zeros         to cs-benefit-period (s1)
 13637                                    cs-days-paid (s1)
 13638                                    cs-total-paid (s1)
 13639                                    cs-remaining-bens (s1)
 13640           end-perform
 13641           perform 2225-upd-crt-trlr
 13642                                 thru 2225-exit
 13643
 13644* EXEC CICS WRITE
 13645*             DATASET  (ELCRTT-DSID)
 13646*             from     (CERTIFICATE-TRAILERS)
 13647*             RIDFLD   (cs-control-primary)
 13648*             RESP     (WS-RESPONSE)
 13649*          END-EXEC
 13650     MOVE LENGTH OF
 13651      CERTIFICATE-TRAILERS
 13652       TO DFHEIV11
 13653*    MOVE '&$ L                  ''  N#00012960' TO DFHEIV0
 13654     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13655     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13656     MOVE X'204E233030303132393630' TO DFHEIV0(25:11)
 13657     CALL 'kxdfhei1' USING DFHEIV0,
 13658           ELCRTT-DSID,
 13659           CERTIFICATE-TRAILERS,
 13660           DFHEIV11,
 13661           cs-control-primary,
 13662           DFHEIV99,
 13663           DFHEIV99
 13664     MOVE EIBRESP  TO WS-RESPONSE
 13665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13666        end-if
 13667     END-IF
 13668
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 263
* EL156.cbl
 13669     .
 13670 2220-exit.
 13671     exit.
 13672
 13673 2225-upd-crt-trlr.
 13674
 13675*    if instypei = 'P'
 13676*       move +1 to s1
 13677*    else
 13678*       MOVE +2 to s1
 13679*    end-if
 13680
 13681*    move +1 to s1
 13682*    evaluate cl-claim-type
 13683*       when 'A'
 13684*          move +1 to s2
 13685*       when 'I'
 13686*          move +2 to s2
 13687*       when 'G'
 13688*          move +3 to s2
 13689*       when 'L'
 13690*          move +4 to s2
 13691*       when 'P'
 13692*          move +5 to s2
 13693*    end-evaluate
 13694     perform varying s1 from +1 by +1 until
 13695        (s1 > +24)
 13696        or (cl-claim-no = cs-claim-no (s1))
 13697     end-perform
 13698     if s1 < +25
 13699        compute cs-total-paid (s1) =
 13700           cs-total-paid (s1) + at-amount-paid
 13701        compute cs-days-paid (s1) =
 13702           cs-days-paid (s1) +  at-days-in-period
 13703*       compute cs-remaining-bens (s1) =
 13704*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13705        perform 2230-accum-bens-paid thru 2230-exit
 13706     end-if
 13707
 13708     .
 13709 2225-exit.
 13710     exit.
 13711 2230-accum-bens-paid.
 13712     if cl-claim-type not = 'L' and 'O' and 'P'
 13713        move pi-ah-term          to ws-max-bens
 13714        if cl-critical-period not = zeros and spaces
 13715           move cl-critical-period
 13716                                 to ws-max-bens
 13717        end-if
 13718     else
 13719        move 01                  to ws-max-bens
 13720     end-if
 13721     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13722     perform varying s2 from +1 by +1 until
 13723        (s2 > +24)
 13724        or (cs-claim-no (s2) = spaces)
 13725        if pi-company-id not = 'DCC' and 'VPP'
 13726           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 264
* EL156.cbl
 13727              compute ws-tot-days-paid =
 13728                 ws-tot-days-paid + cs-days-paid (s2)
 13729              compute ws-tot-amt-paid =
 13730                 ws-tot-amt-paid + cs-total-paid (s2)
 13731           end-if
 13732        else
 13733           if (cs-benefit-period (s2) = cl-benefit-period)
 13734              and (cs-claim-type (s2) = cl-claim-type)
 13735              and (cs-insured-type (s2) = cl-insured-type)
 13736              compute ws-tot-days-paid =
 13737                 ws-tot-days-paid + cs-days-paid (s2)
 13738              compute ws-tot-amt-paid =
 13739                 ws-tot-amt-paid + cs-total-paid (s2)
 13740           end-if
 13741        end-if
 13742     end-perform
 13743     if cl-claim-type = 'L' or 'P' or 'O'
 13744        if ws-tot-amt-paid > zeros
 13745           move zeros            to cs-remaining-bens (s1)
 13746        else
 13747           move 01               to cs-remaining-bens (s1)
 13748        end-if
 13749     else
 13750        compute ws-pd-bens rounded =
 13751           ws-tot-amt-paid / pi-ah-benefit-amt
 13752        compute cs-remaining-bens (s1) =
 13753           ws-max-bens - ws-pd-bens
 13754        if cs-remaining-bens (s1) < zeros
 13755           move zeros            to cs-remaining-bens (s1)
 13756        end-if
 13757     end-if
 13758     .
 13759 2230-exit.
 13760     exit.
 13761 3000-MOVE-INPUT-TO-SAVE-AREA.
 13762     IF PMTTYPEL > 0
 13763         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13764
 13765     if ws-pmttype = '4'
 13766        if pi-rb-joint-coverage
 13767           if payeel = +0
 13768              move +2            to payeel
 13769              move al-uanon      to payeea
 13770              move 'Q1'          to payeeo
 13771           else
 13772              if payeei not = 'Q1' and 'q1'
 13773                 move er-1582    to emi-error
 13774                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13775              end-if
 13776           end-if
 13777        end-if
 13778     end-if
 13779     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13780
 13781     IF WS-PMTTYPE = '9'
 13782         MOVE 'P'                TO PI-PROVISIONAL-IND
 13783         MOVE '1'                TO WS-PMTTYPE.
 13784
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 265
* EL156.cbl
 13785     IF PAYEEL > 0
 13786         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13787         MOVE PAYEEI             TO WS-PAYEE.
 13788
 13789     IF NOTE1L > +0
 13790         MOVE NOTE1I             TO WS-PMTNOTE1
 13791                                    WS-FLI-PMTNOTE
 13792                                    WS-HAN-PMTNOTE.
 13793
 13794     IF NOTE2L > +0
 13795         MOVE NOTE2I             TO WS-PMTNOTE2.
 13796
 13797     IF OFFLINEL > 0
 13798         MOVE OFFLINEI           TO WS-OFFLINE.
 13799
 13800     IF PROOFDTL > 0
 13801         MOVE PROOFDTI            TO DATE-WORK
 13802         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13803         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13804         MOVE '4'                 TO DC-OPTION-CODE
 13805         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13806         IF NO-CONVERSION-ERROR
 13807            MOVE NUM-WORK         TO PROOFDTO
 13808            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13809            MOVE NUM-WORK         TO WS-PROOF-DATE
 13810         ELSE
 13811            MOVE ZEROS            TO WS-PROOF-DATE
 13812         END-IF
 13813     END-IF.
 13814
 13815     IF EOBYNL > +0
 13816         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13817         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13818     END-IF
 13819
 13820     IF CLMFMYNL > +0
 13821         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13822         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13823     END-IF
 13824
 13825     IF SURVYYNL > +0
 13826         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13827         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13828     END-IF
 13829
 13830     IF SPRELYNL > +0
 13831         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13832         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13833     END-IF
 13834     if itrbynl <> +0
 13835        move function upper-case(itrbyni) to itrbyni
 13836        move itrbyni             to ws-int-to-rem-borr
 13837     end-if
 13838*    IF GROUPEDL > +0
 13839*        MOVE GROUPEDI           TO WS-GROUPED.
 13840*
 13841*    IF CASHL > +0
 13842*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 266
* EL156.cbl
 13843     IF LOANNOL > +0
 13844         MOVE LOANNOI            TO WS-LOAN-NO.
 13845
 13846     IF CHECKNOL > 0
 13847         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13848
 13849     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13850         IF WS-AIG-CREDIT-ENTERED
 13851             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13852             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13853             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13854             MOVE AL-UANON         TO CHECKNOA.
 13855
 13856     IF HOLDTILL > 0
 13857         MOVE HOLDTILI           TO DATE-WORK
 13858         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13859         MOVE NUM-WORK           TO WS-HOLDTIL.
 13860
 13861     IF ZINTL > +0
 13862
 13863* EXEC CICS BIF DEEDIT
 13864*           FIELD   (ZINTI)
 13865*           LENGTH  (07)
 13866*       END-EXEC
 13867     MOVE 07
 13868       TO DFHEIV11
 13869*    MOVE '@"L                   #   #00013162' TO DFHEIV0
 13870     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13872     MOVE X'2020233030303133313632' TO DFHEIV0(25:11)
 13873     CALL 'kxdfhei1' USING DFHEIV0,
 13874           ZINTI,
 13875           DFHEIV11
 13876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13877        IF ZINTI NOT NUMERIC
 13878           MOVE ER-0419          TO EMI-ERROR
 13879           PERFORM 9900-ERROR-FORMAT
 13880           MOVE AL-UABON         TO ZINTA
 13881           MOVE -1               TO ZINTL
 13882        ELSE
 13883           MOVE ZINTI            TO CP-INT-RATE
 13884                                    WS-INT-RATE
 13885           MOVE CP-INT-RATE      TO ZINTO
 13886           MOVE AL-UNNON         TO ZINTA
 13887        END-IF
 13888     ELSE
 13889        MOVE ZEROS               TO CP-INT-RATE
 13890     END-IF
 13891     IF EPYFROML > 0
 13892         MOVE EPYFROMI           TO DATE-WORK
 13893         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13894         MOVE NUM-WORK           TO WS-EPYFROM.
 13895
 13896     IF AIGFROML > 0
 13897         MOVE AIGFROMI           TO DATE-WORK
 13898         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13899         MOVE NUM-WORK           TO WS-AIGFROM
 13900     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 267
* EL156.cbl
 13901         IF (AIGFROMI = LOW-VALUES) AND
 13902            (PI-AIGFROM NOT = ZEROS)
 13903              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13904
 13905     IF EPYTHRUL > +0
 13906        MOVE EPYTHRUI           TO DATE-WORK
 13907        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13908        MOVE NUM-WORK           TO WS-EPYTHRU
 13909        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13910        MOVE '4'                TO DC-OPTION-CODE
 13911        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13912        IF NO-CONVERSION-ERROR
 13913           IF PI-USES-PAID-TO
 13914              MOVE '6'                TO DC-OPTION-CODE
 13915              MOVE -1                 TO DC-ELAPSED-DAYS
 13916              MOVE +0                 TO DC-ELAPSED-MONTHS
 13917              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13918              IF NO-CONVERSION-ERROR
 13919                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13920                 MOVE ' '             TO DC-OPTION-CODE
 13921                 MOVE +0              TO DC-ELAPSED-DAYS
 13922                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13923              IF NO-CONVERSION-ERROR
 13924                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13925
 13926*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13927*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13928     IF EDAYSL > 0
 13929
 13930* EXEC CICS BIF DEEDIT
 13931*            FIELD(EDAYSI)
 13932*            LENGTH(6)
 13933*        END-EXEC
 13934     MOVE 6
 13935       TO DFHEIV11
 13936*    MOVE '@"L                   #   #00013218' TO DFHEIV0
 13937     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13938     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13939     MOVE X'2020233030303133323138' TO DFHEIV0(25:11)
 13940     CALL 'kxdfhei1' USING DFHEIV0,
 13941           EDAYSI,
 13942           DFHEIV11
 13943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13944         MOVE EDAYSI             TO WS-DY-WORK
 13945         IF WS-DY-SIGN = SPACES
 13946            MOVE WS-DY-NUM       TO WS-EDAYS
 13947            ADD 0                TO WS-EDAYS
 13948         ELSE
 13949            MOVE EDAYSI          TO WS-EDAYS
 13950            ADD 0                TO WS-EDAYS.
 13951
 13952*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13953*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13954     IF EPYAMTL > 0
 13955
 13956* EXEC CICS BIF DEEDIT
 13957*            FIELD(EPYAMTI)
 13958*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 268
* EL156.cbl
 13959*        END-EXEC
 13960     MOVE 10
 13961       TO DFHEIV11
 13962*    MOVE '@"L                   #   #00013233' TO DFHEIV0
 13963     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13964     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13965     MOVE X'2020233030303133323333' TO DFHEIV0(25:11)
 13966     CALL 'kxdfhei1' USING DFHEIV0,
 13967           EPYAMTI,
 13968           DFHEIV11
 13969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13970         MOVE EPYAMTI            TO WS-PY-WORK
 13971         IF WS-PY-SIGN = SPACES
 13972            MOVE WS-PY-NUM       TO WS-EPYAMT
 13973            ADD 0                TO WS-EPYAMT
 13974         ELSE
 13975            MOVE EPYAMTI         TO WS-EPYAMT
 13976            ADD 0                TO WS-EPYAMT.
 13977
 13978     IF ERESVL > 0
 13979
 13980* EXEC CICS BIF DEEDIT
 13981*            FIELD(ERESVI)
 13982*            LENGTH(9)
 13983*        END-EXEC
 13984     MOVE 9
 13985       TO DFHEIV11
 13986*    MOVE '@"L                   #   #00013246' TO DFHEIV0
 13987     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13988     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13989     MOVE X'2020233030303133323436' TO DFHEIV0(25:11)
 13990     CALL 'kxdfhei1' USING DFHEIV0,
 13991           ERESVI,
 13992           DFHEIV11
 13993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13994         MOVE ERESVI TO WS-ERESV.
 13995
 13996     IF EEXPENSL > 0
 13997
 13998* EXEC CICS BIF DEEDIT
 13999*            FIELD(EEXPENSI)
 14000*            LENGTH(8)
 14001*        END-EXEC
 14002     MOVE 8
 14003       TO DFHEIV11
 14004*    MOVE '@"L                   #   #00013253' TO DFHEIV0
 14005     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14006     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14007     MOVE X'2020233030303133323533' TO DFHEIV0(25:11)
 14008     CALL 'kxdfhei1' USING DFHEIV0,
 14009           EEXPENSI,
 14010           DFHEIV11
 14011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14012         MOVE EEXPENSI           TO WS-EEXPENS.
 14013
 14014     IF ETYPEL > ZEROS
 14015         MOVE ETYPEI             TO WS-ETYPE.
 14016
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 269
* EL156.cbl
 14017     IF PI-COMPANY-ID = 'BOA'
 14018        IF PINTL > ZEROS
 14019
 14020* EXEC CICS BIF DEEDIT
 14021*            FIELD (PINTI)
 14022*            LENGTH(05)
 14023*          END-EXEC
 14024     MOVE 05
 14025       TO DFHEIV11
 14026*    MOVE '@"L                   #   #00013264' TO DFHEIV0
 14027     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14028     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14029     MOVE X'2020233030303133323634' TO DFHEIV0(25:11)
 14030     CALL 'kxdfhei1' USING DFHEIV0,
 14031           PINTI,
 14032           DFHEIV11
 14033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14034           IF PINTI NUMERIC
 14035               MOVE AL-UNNON     TO PINTA
 14036               MOVE PINTI        TO WS-INT-RATE
 14037               MOVE WS-INT-RATE  TO PINTO.
 14038
 14039 3000-EXIT.
 14040     EXIT.
 14041
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 270
* EL156.cbl
 14043 3050-REBUILD-ENTERED.
 14044
 14045     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 14046
 14047     IF PI-PROV-PMT
 14048         MOVE '9'           TO PMTTYPEO
 14049     ELSE
 14050         MOVE PI-PMTTYPE    TO PMTTYPEO.
 14051
 14052     MOVE PI-PAYEE          TO PAYEEO.
 14053     MOVE PI-PMTNOTE1       TO NOTE1O.
 14054     MOVE PI-PMTNOTE2       TO NOTE2O.
 14055     MOVE PI-OFFLINE        TO OFFLINEO.
 14056     IF PI-PROOF-DATE NOT = ZEROS
 14057         MOVE PI-PROOF-DATE TO PROOFDTO
 14058         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 14059     END-IF.
 14060*    MOVE PI-GROUPED        TO GROUPEDO.
 14061
 14062*    MOVE PI-CASH           TO CASHO.
 14063
 14064     IF PI-INT-RATE > ZEROS
 14065        MOVE PI-INT-RATE         TO PINTO
 14066     end-if
 14067     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14068        IF PI-INT-AMT > ZEROS
 14069           MOVE PI-INT-AMT       TO PINTO
 14070           MOVE AL-PANOF         TO PINTA
 14071                                    PINTHA
 14072           if pi-rb-joint-coverage
 14073              move '  INT TO'    to itrb1o
 14074              move ' REM BORR?'  to itrb2o
 14075              move 'Y'           to itrbyno
 14076              move al-uanon      to itrbyna
 14077              move +1            to itrbynl
 14078           end-if
 14079        END-IF
 14080     END-IF
 14081     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 14082     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 14083     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 14084     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 14085     IF PI-HOLDTIL NOT = ZEROS
 14086        MOVE PI-HOLDTIL          TO HOLDTILO
 14087        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 14088
 14089     IF PI-EPYFROM NOT = ZEROS
 14090        MOVE PI-EPYFROM          TO EPYFROMO
 14091        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 14092
 14093     IF PI-AIGFROM NOT = ZEROS
 14094        MOVE PI-AIGFROM          TO AIGFROMO
 14095        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 14096
 14097     IF PI-EPYTHRU NOT = ZEROS
 14098        MOVE PI-EPYTHRU          TO EPYTHRUO
 14099        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 14100        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 271
* EL156.cbl
 14101           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 14102           MOVE '4'                TO DC-OPTION-CODE
 14103           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14104           IF NO-CONVERSION-ERROR
 14105              MOVE +1 TO DC-ELAPSED-DAYS
 14106              MOVE +0 TO DC-ELAPSED-MONTHS
 14107              MOVE '6' TO DC-OPTION-CODE
 14108              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14109              IF NO-CONVERSION-ERROR
 14110                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 14111
 14112     IF PI-EDAYS NOT = ZEROS
 14113        MOVE PI-EDAYS TO EDAYSO.
 14114
 14115     IF PI-EPYAMT NOT = ZEROS
 14116        MOVE PI-EPYAMT TO EPYAMTO.
 14117
 14118     IF PI-ERESV NOT = ZEROS
 14119        MOVE PI-ERESV TO ERESVO.
 14120
 14121     IF PI-EEXPENS NOT = ZEROS
 14122        MOVE PI-EEXPENS TO EEXPENSO.
 14123
 14124     MOVE PI-ETYPE TO ETYPEO.
 14125
 14126     IF PI-ECHECKNO NOT = SPACES
 14127        MOVE PI-ECHECKNO         TO CHECKNOO
 14128     ELSE
 14129        MOVE PI-CCHECKNO         TO CHECKNOO.
 14130
 14131     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 14132     MOVE SPACES                 TO DC-OPTION-CODE.
 14133     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14134
 14135     IF DATE-CONVERSION-ERROR
 14136        MOVE SPACES              TO CPYFROMI
 14137     ELSE
 14138        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 14139
 14140     IF PI-USES-PAID-TO
 14141        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 14142        MOVE +1                  TO DC-ELAPSED-DAYS
 14143        MOVE +0                  TO DC-ELAPSED-MONTHS
 14144        MOVE '6'                 TO DC-OPTION-CODE
 14145        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14146        IF NO-CONVERSION-ERROR
 14147           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 14148           GO TO 3051-CONTINUE.
 14149
 14150     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 14151     MOVE SPACES                 TO DC-OPTION-CODE.
 14152     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14153
 14154     IF DATE-CONVERSION-ERROR
 14155        MOVE SPACES              TO CPYTHRUI
 14156     ELSE
 14157        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14158
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 272
* EL156.cbl
 14159 3051-CONTINUE.
 14160
 14161     IF PI-CDAYS NOT = ZEROS
 14162        MOVE PI-CDAYS TO CDAYSO.
 14163
 14164     IF PI-CPYAMT NOT = ZEROS
 14165        MOVE PI-CPYAMT TO CPYAMTO.
 14166
 14167     IF PI-CRESV NOT = ZEROS
 14168        MOVE PI-CRESV TO CRESVO.
 14169
 14170     IF PI-CEXPENS NOT = ZEROS
 14171        MOVE PI-CEXPENS TO CEXPENSO.
 14172
 14173 3059-EXIT.
 14174     EXIT.
 14175
 14176 3100-DEEDIT-DATE.
 14177
 14178* EXEC CICS BIF DEEDIT
 14179*        FIELD(DATE-WORK)
 14180*        LENGTH(8)
 14181*    END-EXEC.
 14182     MOVE 8
 14183       TO DFHEIV11
 14184*    MOVE '@"L                   #   #00013411' TO DFHEIV0
 14185     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14186     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14187     MOVE X'2020233030303133343131' TO DFHEIV0(25:11)
 14188     CALL 'kxdfhei1' USING DFHEIV0,
 14189           DATE-WORK,
 14190           DFHEIV11
 14191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14192
 14193
 14194 3100-EXIT.
 14195     EXIT.
 14196
 14197 3200-CALC-AIG-DAYS.
 14198
 14199     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14200
 14201     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14202     MOVE ' '                    TO DC-OPTION-CODE.
 14203     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14204     IF NO-CONVERSION-ERROR
 14205         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14206     ELSE
 14207         GO TO 3290-ERROR.
 14208
 14209     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14210         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14211                                WS-BIN-FROM-DT
 14212     ELSE
 14213         IF CL-TOTAL-PAID-AMT > ZEROS
 14214             IF WS-SV-EPYFROM = LOW-VALUES
 14215                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14216                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 273
* EL156.cbl
 14217             ELSE
 14218                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14219                                        WS-BIN-FROM-DT
 14220         ELSE
 14221             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14222                                        WS-BIN-FROM-DT.
 14223
 14224 3210-CONTINUE.
 14225
 14226     MOVE ' '                    TO DC-OPTION-CODE.
 14227     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14228     IF DATE-CONVERSION-ERROR
 14229         GO TO 3290-ERROR.
 14230
 14231     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14232
 14233     IF PI-LOAN-DUE-DAY = 31
 14234         MOVE 30              TO WS-PMT-DUE-DA
 14235                                 WS-SAVE-DUE-DA
 14236     ELSE
 14237         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14238                                 WS-SAVE-DUE-DA.
 14239
 14240     IF (PI-LOAN-DUE-DAY > 28) AND
 14241        (WS-PMT-DUE-MO = 2)
 14242         MOVE 'Y'                TO WS-DUE-DAY-SW
 14243         MOVE 28                 TO WS-PMT-DUE-DA.
 14244
 14245     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14246     MOVE '4'                    TO DC-OPTION-CODE.
 14247     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14248     IF NO-CONVERSION-ERROR
 14249         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14250     ELSE
 14251         GO TO 3290-ERROR.
 14252
 14253*--------------------------------------------------------------*
 14254*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14255*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14256*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14257*                                                              *
 14258*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14259*             INCURRED DATE      - 04/15/91                    *
 14260*             PMT DUE DATE       - 04/03/91                    *
 14261*             PMT DUE DATE       - 05/03/91                    *
 14262*--------------------------------------------------------------*
 14263
 14264     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14265        (WS-SV-AIGFROM = LOW-VALUES)
 14266         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14267            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14268             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14269             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14270             IF NO-CONVERSION-ERROR
 14271                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14272                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14273             ELSE
 14274                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 274
* EL156.cbl
 14275
 14276     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14277        (WS-SV-AIGFROM = LOW-VALUES)
 14278         GO TO 3205-CONT-CALC-PMT.
 14279
 14280     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14281     MOVE ' '                    TO DC-OPTION-CODE.
 14282     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14283     IF NO-CONVERSION-ERROR
 14284         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14285     ELSE
 14286         GO TO 3290-ERROR.
 14287
 14288     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14289        (WS-PMT-DUE-DA < WS-FROM-DA)
 14290          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14291          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14292          IF NO-CONVERSION-ERROR
 14293              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14294              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14295          ELSE
 14296              GO TO 3290-ERROR.
 14297
 14298 3205-CONT-CALC-PMT.
 14299
 14300*--------------------------------------------------------------*
 14301*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14302*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14303*--------------------------------------------------------------*
 14304
 14305     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14306        PI-PMTTYPE = '2'
 14307          NEXT SENTENCE
 14308     ELSE
 14309        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14310           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14311             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14312             MOVE ER-3527            TO EMI-ERROR
 14313             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14314             MOVE -1                 TO EPYTHRUL
 14315             MOVE AL-UNBON           TO EPYTHRUA
 14316                                        EPYFROMA
 14317             GO TO 3299-EXIT.
 14318
 14319*--------------------------------------------------------------*
 14320*    CALCULATE RETRO ELIMINATION DATE                          *
 14321*--------------------------------------------------------------*
 14322
 14323     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14324         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14325     ELSE
 14326         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14327
 14328     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14329     MOVE +0             TO DC-ELAPSED-MONTHS.
 14330     MOVE '6'            TO DC-OPTION-CODE.
 14331     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14332     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 275
* EL156.cbl
 14333         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14334     ELSE
 14335         GO TO 3290-ERROR.
 14336
 14337 3210-CHECK-PMT-DATE.
 14338
 14339*--------------------------------------------------------------*
 14340*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14341*    THE ENTERED PAY FROM DATE                                 *
 14342*--------------------------------------------------------------*
 14343
 14344     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14345         NEXT SENTENCE
 14346     ELSE
 14347         GO TO 3220-COMPUTE-DAYS.
 14348
 14349     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14350     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14351     IF NO-CONVERSION-ERROR
 14352         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14353         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14354         GO TO 3210-CHECK-PMT-DATE
 14355     ELSE
 14356         GO TO 3290-ERROR.
 14357
 14358 3220-COMPUTE-DAYS.
 14359
 14360     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14361     MOVE ZEROS         TO WS-CDAYS.
 14362     MOVE 'N'           TO WS-ELIMINATION-SW.
 14363
 14364*--------------------------------------------------------------*
 14365*    COMPUTE CALIFORNIA DUE DAYS                               *
 14366*--------------------------------------------------------------*
 14367
 14368     IF CL-TOTAL-PAID-AMT > ZEROS
 14369         MOVE 'Y' TO WS-ELIMINATION-SW
 14370         GO TO 3240-FIRST-PMT-DUE
 14371     ELSE
 14372        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14373            NEXT SENTENCE
 14374        ELSE
 14375            GO TO 3240-FIRST-PMT-DUE.
 14376
 14377 3230-NEXT-PMT-DUE.
 14378
 14379     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14380     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14381     IF NO-CONVERSION-ERROR
 14382         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14383         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14384     ELSE
 14385         GO TO 3290-ERROR.
 14386
 14387 3240-FIRST-PMT-DUE.
 14388
 14389     IF CL-TOTAL-PAID-AMT > ZEROS
 14390         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 276
* EL156.cbl
 14391     ELSE
 14392        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14393            GO TO 3230-NEXT-PMT-DUE.
 14394
 14395     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14396         GO TO 3250-VERIFY-ELIMINATION.
 14397
 14398     ADD +30 TO WS-CDAYS.
 14399     MOVE 'Y' TO WS-ELIMINATION-SW.
 14400     GO TO 3230-NEXT-PMT-DUE.
 14401
 14402 3250-VERIFY-ELIMINATION.
 14403
 14404     IF ELIM-SATISFIED
 14405         GO TO 3260-END-CALC.
 14406
 14407     IF PI-PMTTYPE = '1'
 14408         MOVE ZEROS TO WS-CDAYS
 14409         GO TO 3260-END-CALC.
 14410
 14411     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14412         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14413     ELSE
 14414         IF CL-TOTAL-PAID-AMT > ZEROS
 14415             IF WS-SV-EPYFROM = LOW-VALUES
 14416                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14417             ELSE
 14418                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14419         ELSE
 14420             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14421
 14422     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14423     MOVE '1'                    TO DC-OPTION-CODE.
 14424     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14425     IF NO-CONVERSION-ERROR
 14426         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14427     ELSE
 14428         GO TO 3290-ERROR.
 14429
 14430     IF CL-TOTAL-PAID-AMT > ZEROS
 14431         MOVE WS-DAYS-OFF TO WS-CDAYS
 14432     ELSE
 14433         IF PI-BEN-DAYS > WS-DAYS-OFF
 14434             MOVE ZEROS TO WS-CDAYS
 14435         ELSE
 14436             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14437
 14438 3260-END-CALC.
 14439
 14440     MOVE WS-CDAYS TO PI-CDAYS.
 14441
 14442     IF PI-EDAYS = ZEROS
 14443         MOVE PI-CDAYS TO PI-EDAYS
 14444         MOVE AL-UNNON TO EDAYSA.
 14445
 14446     GO TO 3299-EXIT.
 14447
 14448 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 277
* EL156.cbl
 14449
 14450     MOVE ER-3528            TO EMI-ERROR.
 14451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14452     MOVE -1                 TO CDAYSL.
 14453     MOVE AL-UNBON           TO CDAYSA.
 14454
 14455 3299-EXIT.
 14456     EXIT.
 14457
 14458 3300-BUMP-DATE.
 14459
 14460     IF WS-RESTORE-DUE-DAY
 14461         MOVE 'N'              TO WS-DUE-DAY-SW
 14462         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14463         ADD 1                 TO WS-PMT-DUE-MO
 14464         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14465         MOVE '4'              TO DC-OPTION-CODE
 14466         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14467         IF NO-CONVERSION-ERROR
 14468             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14469             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14470             GO TO 3399-EXIT
 14471         ELSE
 14472             MOVE '9'          TO DC-ERROR-CODE
 14473             GO TO 3399-EXIT.
 14474
 14475     IF (WS-PMT-DUE-MO = 1) AND
 14476        (WS-SAVE-DUE-DA > 28)
 14477           MOVE 'Y' TO WS-DUE-DAY-SW.
 14478
 14479     MOVE +0                 TO DC-ELAPSED-DAYS.
 14480     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14481     MOVE '6'                TO DC-OPTION-CODE.
 14482     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14483
 14484 3399-EXIT.
 14485     EXIT.
 14486
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 278
* EL156.cbl
 14488 3400-COMPUTE-EXPIRY.
 14489
 14490     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14491     MOVE +0                    TO DC-ELAPSED-DAYS
 14492                                   DC-ODD-DAYS-OVER.
 14493     MOVE '1'                   TO DC-END-OF-MONTH.
 14494     MOVE '6'                   TO DC-OPTION-CODE.
 14495
 14496     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 14497         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14498     ELSE
 14499         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14500
 14501     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14502     IF NO-CONVERSION-ERROR
 14503         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14504     ELSE
 14505         GO TO 3390-CONTINUE.
 14506
 14507     IF CL-CLAIM-TYPE NOT = (PI-LIFE-OVERRIDE-L1 OR 'O')
 14508         GO TO 3390-CONTINUE.
 14509
 14510     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14511     MOVE '4'                    TO CNTL-REC-TYPE.
 14512     MOVE +0                     TO CNTL-SEQ-NO.
 14513     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14514     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14515     MOVE 'BENE'                 TO FILE-SWITCH.
 14516
 14517     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14518
 14519     IF NO-BENEFIT-FOUND
 14520         GO TO 3390-CONTINUE.
 14521
 14522     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14523        IF (PI-OFFLINE = 'Y') OR
 14524           (PI-PMTTYPE = '7')
 14525           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14526                                     THRU 9870-EXIT
 14527           IF ERROR-ON-OUTPUT
 14528             MOVE -1                 TO ENTERPFL
 14529             MOVE AL-UANON           TO ENTERPFA
 14530             MOVE MAP-NAMEA          TO MAP-NAME
 14531             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14532             GO TO 8200-SEND-DATAONLY.
 14533
 14534     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')  AND
 14535        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14536        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14537          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14538          MOVE +0        TO DC-ELAPSED-DAYS
 14539          MOVE +1        TO DC-ELAPSED-MONTHS
 14540          MOVE 6         TO DC-OPTION-CODE
 14541          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14542          IF NO-CONVERSION-ERROR
 14543              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14544
 14545 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 279
* EL156.cbl
 14546
 14547      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14548         MOVE CM-AH-LOAN-EXPIRE-DT
 14549                                 TO DC-BIN-DATE-1
 14550      ELSE
 14551         MOVE CM-LF-LOAN-EXPIRE-DT
 14552                                 TO DC-BIN-DATE-1
 14553      END-IF
 14554
 14555      MOVE ' '                    TO DC-OPTION-CODE.
 14556      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14557      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14558      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14559
 14560 3499-EXIT.
 14561     EXIT.
 14562
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 280
* EL156.cbl
 14564
 14565 3600-CHECK-VERIFICATION.
 14566
 14567     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14568
 14569     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14570
 14571     IF PI-PAYEE-TYPE = 'I'
 14572        GO TO 3600-READ-TRAILER.
 14573
 14574     IF PI-PAYEE-TYPE = 'B'
 14575        ADD +10                  TO TRLR-SEQ-NO
 14576        GO TO 3600-READ-TRAILER.
 14577
 14578     IF PI-PAYEE-TYPE = 'A'
 14579        ADD +20                  TO TRLR-SEQ-NO
 14580        GO TO 3600-READ-TRAILER.
 14581
 14582     IF PI-PAYEE-TYPE = 'O'
 14583        ADD +50                  TO TRLR-SEQ-NO
 14584        GO TO 3600-READ-TRAILER.
 14585
 14586     IF PI-PAYEE-TYPE = 'Q'
 14587        ADD +60                  TO TRLR-SEQ-NO
 14588        GO TO 3600-READ-TRAILER.
 14589
 14590     IF PI-PAYEE-TYPE = 'P'
 14591        ADD +30                  TO TRLR-SEQ-NO
 14592        GO TO 3600-READ-TRAILER.
 14593
 14594     IF PI-PAYEE-TYPE = 'E'
 14595        ADD +40                  TO TRLR-SEQ-NO.
 14596
 14597 3600-READ-TRAILER.
 14598
 14599
 14600* EXEC CICS HANDLE CONDITION
 14601*         NOTFND(3600-CONTINUE)
 14602*    END-EXEC.
 14603*    MOVE '"$I                   ! - #00013821' TO DFHEIV0
 14604     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14606     MOVE X'2D20233030303133383231' TO DFHEIV0(25:11)
 14607     CALL 'kxdfhei1' USING DFHEIV0
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
 14611     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14612
 14613 3600-CONTINUE.
 14614
 14615     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 14616         GO TO 3600-AH-VERIFY
 14617     END-IF.
 14618
 14619     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14620       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14621         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 281
* EL156.cbl
 14622           MOVE ER-7576            TO EMI-ERROR
 14623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14624           MOVE -1                 TO PAYEEL
 14625           MOVE AL-UABON           TO PAYEEA
 14626           GO TO 3600-EXIT
 14627         END-IF
 14628       END-IF
 14629     END-IF.
 14630
 14631     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14632     MOVE 1 TO WS-SUB2
 14633     MOVE SPACES TO WS-PAYEE-NAME
 14634     PERFORM VARYING WS-SUB FROM 1 BY 1
 14635             UNTIL WS-SUB > 30
 14636         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14637            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14638                 WS-PAYEE-NAME-X (WS-SUB2)
 14639            ADD +1 TO WS-SUB2
 14640         END-IF
 14641     END-PERFORM.
 14642
 14643     STRING CL-INSURED-1ST-NAME
 14644            CL-INSURED-MID-INIT
 14645            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14646     MOVE 1 TO WS-SUB2
 14647     MOVE SPACES TO WS-INSURED-NAME
 14648     PERFORM VARYING WS-SUB FROM 1 BY 1
 14649             UNTIL WS-SUB > 30
 14650         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14651            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14652                 WS-INSURED-NAME-X (WS-SUB2)
 14653            ADD +1 TO WS-SUB2
 14654         END-IF
 14655     END-PERFORM.
 14656
 14657     IF CL-CLAIM-TYPE = 'O'
 14658        IF WS-PAYEE-NAME (1:6) = 'ESTATE'
 14659           MOVE ER-7585            TO EMI-ERROR
 14660           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14661           MOVE -1                 TO PAYEEL
 14662           MOVE AL-UABON           TO PAYEEA
 14663        ELSE
 14664           GO TO 3600-EXIT
 14665        END-IF
 14666     END-IF.
 14667     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14668        MOVE ER-7579            TO EMI-ERROR
 14669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14670        MOVE -1                 TO PAYEEL
 14671        MOVE AL-UABON           TO PAYEEA
 14672     END-IF.
 14673
 14674     IF PI-PMTTYPE = '4'  AND
 14675        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14676        PI-PAYEE-TYPE <> 'I'
 14677          MOVE ER-7580          TO EMI-ERROR
 14678          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14679          MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 282
* EL156.cbl
 14680          MOVE AL-UABON         TO PAYEEA
 14681     END-IF.
 14682
 14683     GO TO 3600-EXIT.
 14684
 14685 3600-AH-VERIFY.
 14686
 14687     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14688        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14689           MOVE ER-7583            TO EMI-ERROR
 14690           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14691           MOVE -1                 TO PAYEEL
 14692           MOVE AL-UABON           TO PAYEEA
 14693        END-IF
 14694     END-IF.
 14695
 14696
 14697 3600-EXIT.
 14698     EXIT.
 14699
 14700 5000-UPDATE.
 14701
 14702     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14703
 14704     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14705
 14706     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14707        PI-OFFLINE = 'Y'
 14708        NEXT SENTENCE
 14709     ELSE
 14710        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14711
 14712*    IF PI-COMPANY-ID = 'CRI'
 14713*       IF PI-PMTTYPE = '1' OR  '2'
 14714*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14715*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14716*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14717
 14718*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14719*       IF PI-PMTTYPE = '1'
 14720*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14721*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14722
 14723     IF PI-PMTTYPE      = '2' AND
 14724        PI-SPLIT-PMT-SW = 'Y' AND
 14725        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 14726          MOVE ER-3530                TO EMI-ERROR
 14727          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14728
 14729     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14730        AND (CL-CLAIM-TYPE = 'L' OR 'O')
 14731        IF PI-PMTTYPE = '2' OR '4'
 14732           IF PI-INT-AMT NOT = ZEROS
 14733              PERFORM 7110-BUILD-PMT-TRLR
 14734                                 THRU 7130-EXIT
 14735           ELSE
 14736              IF PI-PMTTYPE = '2'
 14737                 PERFORM 7140-BUILD-NOTE-TRLR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 283
* EL156.cbl
 14738                                 THRU 7170-EXIT
 14739              END-IF
 14740           END-IF
 14741        END-IF
 14742     END-IF
 14743*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14744*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14745*            MOVE 'N'                 TO  WS-LETTER-SW.
 14746
 14747*    IF PI-COMPANY-ID = 'DMD'
 14748*        IF CL-NO-OF-PMTS-MADE = +1
 14749*                OR
 14750*           PI-PMTTYPE = '2'
 14751*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14752
 14753     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14754
 14755*    IF PI-COMPANY-ID = 'DMD'
 14756*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14757*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14758
 14759
 14760* EXEC CICS REWRITE
 14761*         DATASET('ELMSTR')
 14762*         FROM(CLAIM-MASTER)
 14763*     END-EXEC.
 14764     MOVE LENGTH OF
 14765      CLAIM-MASTER
 14766       TO DFHEIV11
 14767     MOVE 'ELMSTR' TO DFHEIV1
 14768*    MOVE '&& L                  %   #00013973' TO DFHEIV0
 14769     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14770     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14771     MOVE X'2020233030303133393733' TO DFHEIV0(25:11)
 14772     CALL 'kxdfhei1' USING DFHEIV0,
 14773           DFHEIV1,
 14774           CLAIM-MASTER,
 14775           DFHEIV11,
 14776           DFHEIV99
 14777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14778
 14779
 14780     IF WS-LETTER-SW = 'N'
 14781         GO TO 5000-END-UPDATE.
 14782
 14783 5000-GENERATE-AUTO-LETTER.
 14784
 14785
 14786* EXEC CICS LINK
 14787*        PROGRAM    (LINK-1523)
 14788*        COMMAREA   (W-1523-LINKDATA)
 14789*        LENGTH     (W-1523-COMM-LENGTH)
 14790*    END-EXEC.
 14791*    MOVE '."C                   (   #00013983' TO DFHEIV0
 14792     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14793     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14794     MOVE X'2020233030303133393833' TO DFHEIV0(25:11)
 14795     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 284
* EL156.cbl
 14796           LINK-1523,
 14797           W-1523-LINKDATA,
 14798           W-1523-COMM-LENGTH,
 14799           DFHEIV99,
 14800           DFHEIV99,
 14801           DFHEIV99,
 14802           DFHEIV99
 14803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14804
 14805
 14806     IF W-1523-FATAL-ERROR
 14807         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14809         MOVE ER-0802                TO  EMI-ERROR
 14810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14811
 14812     IF W-1523-ERROR-CODE = 0191
 14813         MOVE ER-0803                TO  EMI-ERROR
 14814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14815
 14816     IF PI-COMPANY-ID      = 'HAN' AND
 14817        PI-PMTTYPE         = '1'   AND
 14818        PI-3RD-PARTY-SW    = 'Y'   AND
 14819        W-1523-FORM-NUMBER = 'EOB1'
 14820           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14821           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14822           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14823           GO TO 5000-GENERATE-AUTO-LETTER.
 14824
 14825 5000-END-UPDATE.
 14826
 14827     MOVE ER-0000                TO EMI-ERROR.
 14828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14829     GO TO 7000-SHOW-CLAIM.
 14830
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 285
* EL156.cbl
 14832 5000-MOVE-NAME.
 14833     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14834     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14835     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14836
 14837 5000-EXIT.
 14838     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 286
* EL156.cbl
 14840 5300-CREATE-DMO.
 14841
 14842     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14843     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14844     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14845
 14846
 14847* EXEC CICS HANDLE CONDITION
 14848*         NOTFND   (5300-NOTE-NOT-FOUND)
 14849*    END-EXEC.
 14850*    MOVE '"$I                   ! . #00014029' TO DFHEIV0
 14851     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14853     MOVE X'2E20233030303134303239' TO DFHEIV0(25:11)
 14854     CALL 'kxdfhei1' USING DFHEIV0
 14855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14856
 14857
 14858
 14859* EXEC CICS READ
 14860*         DATASET('ERNOTE')
 14861*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14862*         RIDFLD (W-NOTE-KEY)
 14863*    END-EXEC.
 14864     MOVE 'ERNOTE' TO DFHEIV1
 14865*    MOVE '&"S        E          (   #00014033' TO DFHEIV0
 14866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14868     MOVE X'2020233030303134303333' TO DFHEIV0(25:11)
 14869     CALL 'kxdfhei1' USING DFHEIV0,
 14870           DFHEIV1,
 14871           DFHEIV20,
 14872           DFHEIV99,
 14873           W-NOTE-KEY,
 14874           DFHEIV99,
 14875           DFHEIV99,
 14876           DFHEIV99
 14877     SET ADDRESS OF CERTIFICATE-NOTE TO
 14878         DFHEIV20
 14879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14880
 14881
 14882     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14883     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14884     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14885
 14886     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14887         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14888     ELSE
 14889         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14890
 14891     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14892     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14893     MOVE 'DLO006'               TO PGM-NAME.
 14894
 14895
 14896* EXEC CICS LINK
 14897*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 287
* EL156.cbl
 14898*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14899*        LENGTH     (DCT-RCRD-LENGTH)
 14900*    END-EXEC.
 14901*    MOVE '."C                   (   #00014052' TO DFHEIV0
 14902     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14904     MOVE X'2020233030303134303532' TO DFHEIV0(25:11)
 14905     CALL 'kxdfhei1' USING DFHEIV0,
 14906           PGM-NAME,
 14907           DCT-COMMUNICATION-AREA,
 14908           DCT-RCRD-LENGTH,
 14909           DFHEIV99,
 14910           DFHEIV99,
 14911           DFHEIV99,
 14912           DFHEIV99
 14913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14914
 14915
 14916     IF DCT-RETURN-CODE = 'OK'
 14917         GO TO 5300-CONT.
 14918
 14919     IF DCT-RETURN-CODE = '01' OR '02'
 14920         GO TO 5300-EXIT.
 14921
 14922     IF DCT-RETURN-CODE = '03'
 14923         MOVE ER-0951            TO EMI-ERROR
 14924         GO TO 5300-BAD-EXIT.
 14925
 14926     IF DCT-RETURN-CODE = '04'
 14927         MOVE ER-0946            TO EMI-ERROR
 14928         GO TO 5300-BAD-EXIT.
 14929
 14930     IF DCT-RETURN-CODE = '05'
 14931         MOVE ER-0947            TO EMI-ERROR
 14932         GO TO 5300-BAD-EXIT.
 14933
 14934     IF DCT-RETURN-CODE = '06'
 14935         MOVE ER-0921            TO EMI-ERROR
 14936         GO TO 5300-BAD-EXIT.
 14937
 14938     IF DCT-RETURN-CODE = '07'
 14939         MOVE ER-0849            TO EMI-ERROR
 14940         GO TO 5300-BAD-EXIT.
 14941
 14942     IF DCT-RETURN-CODE = '08'
 14943         MOVE ER-0948            TO EMI-ERROR
 14944         GO TO 5300-BAD-EXIT.
 14945
 14946     IF DCT-RETURN-CODE = 'N1'
 14947         MOVE ER-0950            TO EMI-ERROR
 14948         GO TO 5300-BAD-EXIT.
 14949
 14950     IF DCT-RETURN-CODE = 'E1'
 14951         MOVE ER-0974            TO EMI-ERROR
 14952         GO TO 5300-BAD-EXIT.
 14953
 14954     IF DCT-RETURN-CODE = 'E2'
 14955         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 288
* EL156.cbl
 14956         GO TO 5300-BAD-EXIT.
 14957
 14958     IF DCT-RETURN-CODE NOT = 'OK'
 14959         MOVE ER-0949            TO EMI-ERROR
 14960         GO TO 5300-BAD-EXIT.
 14961
 14962 5300-CONT.
 14963
 14964     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14965     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14966     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14967     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14968     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14969     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14970     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14971     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14972
 14973     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14974     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14975     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14976     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14977     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14978
 14979     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14980
 14981     IF PI-PMTTYPE = '2'
 14982         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14983         MOVE '4'                TO DM-CLAIM-STATUS
 14984     ELSE
 14985         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14986         MOVE '2'                TO DM-CLAIM-STATUS.
 14987
 14988     MOVE 'DLO025'               TO PGM-NAME.
 14989
 14990
 14991* EXEC CICS LINK
 14992*        PROGRAM    (PGM-NAME)
 14993*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14994*        LENGTH     (DM-DMO-LENGTH)
 14995*    END-EXEC.
 14996*    MOVE '."C                   (   #00014132' TO DFHEIV0
 14997     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14999     MOVE X'2020233030303134313332' TO DFHEIV0(25:11)
 15000     CALL 'kxdfhei1' USING DFHEIV0,
 15001           PGM-NAME,
 15002           DMO-COMMUNICATION-AREA,
 15003           DM-DMO-LENGTH,
 15004           DFHEIV99,
 15005           DFHEIV99,
 15006           DFHEIV99,
 15007           DFHEIV99
 15008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15009
 15010
 15011     IF DM-RETURN-CODE = 'OK'
 15012         GO TO 5300-EXIT.
 15013
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 289
* EL156.cbl
 15014     IF DM-RETURN-CODE = '01'
 15015         MOVE ER-8051            TO EMI-ERROR
 15016         GO TO 5300-BAD-EXIT.
 15017
 15018     IF DM-RETURN-CODE = '02'
 15019         MOVE ER-8052            TO EMI-ERROR
 15020         GO TO 5300-BAD-EXIT.
 15021
 15022     IF DM-RETURN-CODE = '03'
 15023         MOVE ER-8053            TO EMI-ERROR
 15024         GO TO 5300-BAD-EXIT.
 15025
 15026     IF DM-RETURN-CODE = '04'
 15027         MOVE ER-8054            TO EMI-ERROR
 15028         GO TO 5300-BAD-EXIT.
 15029
 15030     IF DM-RETURN-CODE = '05'
 15031         MOVE ER-8055            TO EMI-ERROR
 15032         GO TO 5300-BAD-EXIT.
 15033
 15034     IF DM-RETURN-CODE = '06'
 15035         MOVE ER-8056            TO EMI-ERROR
 15036         GO TO 5300-BAD-EXIT.
 15037
 15038     IF DM-RETURN-CODE = '07'
 15039         MOVE ER-8057            TO EMI-ERROR
 15040         GO TO 5300-BAD-EXIT.
 15041
 15042     IF DM-RETURN-CODE = '08'
 15043         MOVE ER-8058            TO EMI-ERROR
 15044         GO TO 5300-BAD-EXIT.
 15045
 15046     IF DM-RETURN-CODE = '09'
 15047         MOVE ER-8059            TO EMI-ERROR
 15048         GO TO 5300-BAD-EXIT.
 15049
 15050     IF DM-RETURN-CODE = '10'
 15051         MOVE ER-8060            TO EMI-ERROR
 15052         GO TO 5300-BAD-EXIT.
 15053
 15054     IF DM-RETURN-CODE = '11'
 15055         MOVE ER-8061            TO EMI-ERROR
 15056         GO TO 5300-BAD-EXIT.
 15057
 15058     IF DM-RETURN-CODE = '12'
 15059         MOVE ER-8062            TO EMI-ERROR
 15060         GO TO 5300-BAD-EXIT.
 15061
 15062     IF DM-RETURN-CODE = '13'
 15063         MOVE ER-8063            TO EMI-ERROR
 15064         GO TO 5300-BAD-EXIT.
 15065
 15066     IF DM-RETURN-CODE = '14'
 15067         MOVE ER-8064            TO EMI-ERROR
 15068         GO TO 5300-BAD-EXIT.
 15069
 15070     IF DM-RETURN-CODE = '15'
 15071         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 290
* EL156.cbl
 15072         GO TO 5300-BAD-EXIT.
 15073
 15074     IF DM-RETURN-CODE = '16'
 15075         MOVE ER-8154            TO EMI-ERROR
 15076         GO TO 5300-BAD-EXIT.
 15077
 15078     IF DM-RETURN-CODE = '17'
 15079         MOVE ER-8155            TO EMI-ERROR
 15080         GO TO 5300-BAD-EXIT.
 15081
 15082     IF DM-RETURN-CODE = 'N1'
 15083         MOVE ER-8152            TO EMI-ERROR
 15084         GO TO 5300-BAD-EXIT.
 15085
 15086     IF DM-RETURN-CODE = 'E1'
 15087         MOVE ER-8153            TO EMI-ERROR
 15088         GO TO 5300-BAD-EXIT.
 15089
 15090     MOVE ER-8066            TO EMI-ERROR.
 15091     GO TO 5300-BAD-EXIT.
 15092
 15093 5300-NOTE-NOT-FOUND.
 15094
 15095     MOVE ER-0954                TO EMI-ERROR.
 15096     GO TO 5300-BAD-EXIT.
 15097
 15098 5300-BAD-EXIT.
 15099
 15100* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15101*    MOVE '6"R                   !   #00014226' TO DFHEIV0
 15102     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15104     MOVE X'2020233030303134323236' TO DFHEIV0(25:11)
 15105     CALL 'kxdfhei1' USING DFHEIV0
 15106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15107
 15108     IF MAP-NAME = 'EL156A'
 15109         MOVE -1             TO ENTERPFL
 15110       ELSE
 15111         MOVE LOW-VALUES     TO EL156BI
 15112         MOVE -1             TO ENTPFBL.
 15113
 15114     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15115     GO TO 8200-SEND-DATAONLY.
 15116
 15117 5300-EXIT.
 15118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 291
* EL156.cbl
 15120 5350-FORMAT-LAST-NAME-1ST.
 15121*****************************************************************
 15122*             M O V E   N A M E   R O U T I N E                 *
 15123*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15124*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15125*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15126*                  FIELD                   VALUE                *
 15127*           W-NAME-LAST    (CL15)      SMITH                    *
 15128*           W-NAME-FIRST   (CL15)      JOHN                     *
 15129*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 15130*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15131*     CONTAIN                                                   *
 15132*                SMITH, JOHN ALLEN                              *
 15133*     OR                                                        *
 15134*                SMITH, JOHN A.                                 *
 15135*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15136*     COPYBOOK, ELCNWA.                                         *
 15137*****************************************************************.
 15138
 15139     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 15140     MOVE ZERO                   TO  WS-NAME-SW.
 15141     SET NWA-INDEX               TO +1.
 15142
 15143     IF W-NAME-LAST   = SPACES AND
 15144        W-NAME-MIDDLE = SPACES
 15145         MOVE +1                 TO WS-NAME-SW.
 15146
 15147     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15148     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15149
 15150     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15151     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15152
 15153     SET NWA-INDEX UP BY +1.
 15154
 15155     IF W-NAME-MIDDLE NOT = SPACES
 15156         IF W-NAME-MIDDLE-2 = SPACES
 15157             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15158             SET NWA-INDEX UP BY +1
 15159             MOVE '.'            TO WS-NW (NWA-INDEX)
 15160             SET NWA-INDEX UP BY +2
 15161         ELSE
 15162             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15163             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15164
 15165 5350-EXIT.
 15166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 292
* EL156.cbl
 15168 5360-MOVE-NAME.
 15169
 15170     IF WS-NAME-SW > +1
 15171         GO TO 5360-EXIT.
 15172
 15173     IF WS-NAME-WORK2 = SPACES
 15174         GO TO 5360-EXIT.
 15175
 15176     SET NWA-INDEX2            TO +1.
 15177     SET NWA-INDEX3            TO +2.
 15178
 15179 5360-MOVE-NAME-CYCLE.
 15180
 15181     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15182
 15183     IF NWA-INDEX < +30
 15184         SET NWA-INDEX UP BY +1
 15185     ELSE
 15186         ADD +2                TO  WS-NAME-SW
 15187         GO TO 5360-EXIT.
 15188
 15189     IF NWA-INDEX2 < +20
 15190         SET NWA-INDEX3 UP BY +1
 15191         SET NWA-INDEX2 UP BY +1.
 15192
 15193     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15194        WS-NW2 (NWA-INDEX3) = SPACES
 15195         IF WS-NAME-SW = ZERO
 15196             MOVE ','            TO  WS-NW (NWA-INDEX)
 15197             SET NWA-INDEX UP BY +2
 15198             MOVE +1             TO  WS-NAME-SW
 15199             GO TO 5360-EXIT
 15200         ELSE
 15201             GO TO 5360-EXIT.
 15202
 15203     GO TO 5360-MOVE-NAME-CYCLE.
 15204
 15205 5360-EXIT.
 15206     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 293
* EL156.cbl
 15208 6000-BUILD-SCREEN-B.
 15209     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15210     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15211     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15212     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15213
 15214     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15215
 15216 6050-BUILD-SCREEN.
 15217     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15218     MOVE LOW-VALUES             TO EL156BI.
 15219     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15220
 15221     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15222
 15223     IF PI-PAYEE-TYPE = 'I'
 15224        GO TO 6060-READ-TRAILER.
 15225
 15226     IF PI-PAYEE-TYPE = 'B'
 15227        ADD +10                  TO TRLR-SEQ-NO
 15228        GO TO 6060-READ-TRAILER.
 15229
 15230     IF PI-PAYEE-TYPE = 'A'
 15231        ADD +20                  TO TRLR-SEQ-NO
 15232        GO TO 6060-READ-TRAILER.
 15233
 15234     IF PI-PAYEE-TYPE = 'O'
 15235        ADD +50                  TO TRLR-SEQ-NO
 15236        GO TO 6060-READ-TRAILER.
 15237
 15238     IF PI-PAYEE-TYPE = 'Q'
 15239        ADD +60                  TO TRLR-SEQ-NO
 15240        GO TO 6060-READ-TRAILER.
 15241
 15242     IF PI-PAYEE-TYPE = 'P'
 15243        ADD +30                  TO TRLR-SEQ-NO
 15244        GO TO 6060-READ-TRAILER.
 15245
 15246     IF PI-PAYEE-TYPE = 'E'
 15247        ADD +40                  TO TRLR-SEQ-NO.
 15248
 15249 6060-READ-TRAILER.
 15250
 15251     IF PI-PAYEE-TYPE    = 'A' AND
 15252        PI-PAYEE-SEQ-NUM = 0
 15253          GO TO 6061-READ-ACCOUNT.
 15254
 15255     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15256        (PI-PAYEE-TYPE    = 'B')             AND
 15257        (PI-PAYEE-SEQ-NUM = 9)
 15258          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15259          IF BENE-FOUND-SW = 'N'
 15260            GO TO 6065-NOT-FOUND
 15261          ELSE
 15262            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15263            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15264            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15265*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 294
* EL156.cbl
 15266            STRING BE-CITY ' ' BE-STATE
 15267               DELIMITED BY '  ' INTO CITYSTBO
 15268            END-STRING
 15269            MOVE BE-ZIP-CODE       TO ZIPBO
 15270            GO TO 6061-READ-ACCOUNT.
 15271
 15272     IF PI-PAYEE-TYPE    = 'B' AND
 15273        PI-PAYEE-SEQ-NUM = 0
 15274          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15275          IF BENE-FOUND-SW = 'N'
 15276            GO TO 6065-NOT-FOUND
 15277          ELSE
 15278            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15279            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15280            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15281*           MOVE BE-CITY-STATE     TO CITYSTBO
 15282            STRING BE-CITY ' ' BE-STATE
 15283               DELIMITED BY '  ' INTO CITYSTBO
 15284            END-STRING
 15285            MOVE BE-ZIP-CODE       TO ZIPBO
 15286            if be-ach-yes-or-no = 'Y'
 15287               move 'Y'          to pi-ach-payment
 15288            else
 15289               move 'N'          to pi-ach-payment
 15290            end-if
 15291            GO TO 6061-READ-ACCOUNT.
 15292
 15293
 15294* EXEC CICS HANDLE CONDITION
 15295*         NOTFND(6065-NOT-FOUND)
 15296*     END-EXEC.
 15297*    MOVE '"$I                   ! / #00014412' TO DFHEIV0
 15298     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15300     MOVE X'2F20233030303134343132' TO DFHEIV0(25:11)
 15301     CALL 'kxdfhei1' USING DFHEIV0
 15302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15303
 15304
 15305     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15306
 15307     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15308     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15309     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15310     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15311*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15312     STRING AT-CITY ' ' AT-STATE
 15313        DELIMITED BY '  ' INTO CITYSTBO
 15314     END-STRING
 15315     MOVE AT-ZIP-CODE            TO ZIPBO.
 15316
 15317 6061-READ-ACCOUNT.
 15318
 15319* EXEC CICS HANDLE CONDITION
 15320*         NOTFND(6068-ACCT-NOT-FND)
 15321*     END-EXEC.
 15322*    MOVE '"$I                   ! 0 #00014429' TO DFHEIV0
 15323     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 295
* EL156.cbl
 15324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15325     MOVE X'3020233030303134343239' TO DFHEIV0(25:11)
 15326     CALL 'kxdfhei1' USING DFHEIV0
 15327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15328
 15329
 15330
 15331* EXEC CICS READ
 15332*         DATASET('ERACCT')
 15333*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15334*         RIDFLD (PI-ACCT-KEY)
 15335*     END-EXEC.
 15336     MOVE 'ERACCT' TO DFHEIV1
 15337*    MOVE '&"S        E          (   #00014433' TO DFHEIV0
 15338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15340     MOVE X'2020233030303134343333' TO DFHEIV0(25:11)
 15341     CALL 'kxdfhei1' USING DFHEIV0,
 15342           DFHEIV1,
 15343           DFHEIV20,
 15344           DFHEIV99,
 15345           PI-ACCT-KEY,
 15346           DFHEIV99,
 15347           DFHEIV99,
 15348           DFHEIV99
 15349     SET ADDRESS OF ACCOUNT-MASTER TO
 15350         DFHEIV20
 15351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15352
 15353
 15354     MOVE AM-CARRIER             TO ACARRBO.
 15355     MOVE AM-GROUPING            TO GROUPBO.
 15356     MOVE AM-STATE               TO STATEBO.
 15357     MOVE AM-ACCOUNT             TO ACCTBO.
 15358     MOVE AM-NAME                TO ACCTNMBO.
 15359
 15360     IF PI-PAYEE-TYPE = 'A' AND
 15361        PI-PAYEE-SEQ-NUM = 0
 15362          MOVE AM-NAME             TO NAMEBO
 15363                                      PI-PAYEE-NAME
 15364          MOVE AM-ADDRS            TO ADDR1BO
 15365          MOVE SPACES              TO ADDR2BO
 15366*         MOVE AM-CITY             TO CITYSTBO
 15367          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15368             DELIMITED BY '  ' INTO CITYSTBO
 15369          END-STRING
 15370          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15371          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15372          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15373          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15374
 15375***  We don't really need the code below because we don't do the
 15376***  AK thing anymore.  However, we may have a state special
 15377***  of some sort in the future so why not just leave it??
 15378     IF CITYSTBO EQUAL SPACES
 15379         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15380         GO TO 6070-FORMAT-DATA
 15381     END-IF.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 296
* EL156.cbl
 15382
 15383     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15384     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15385     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15386     PERFORM VARYING WS-SUB FROM 30 BY -1
 15387          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15388        IF WS-END-SUB = 0  AND
 15389           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15390              OR LOW-VALUES  OR '.')
 15391            CONTINUE
 15392        ELSE
 15393            IF WS-END-SUB = 0
 15394                MOVE WS-SUB TO WS-END-SUB
 15395            ELSE
 15396                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15397                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15398                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15399                END-IF
 15400            END-IF
 15401        END-IF
 15402        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15403            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15404            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15405        END-IF
 15406     END-PERFORM.
 15407
 15408     IF WS-BEG-SUB > 0
 15409         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15410         IF WS-STATE-LENGTH = 2
 15411             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15412                  TO PI-CHECK-STATE-FOR-AK
 15413         ELSE
 15414             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15415                'ALASKA'
 15416                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15417             ELSE
 15418                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15419             END-IF
 15420         END-IF
 15421     ELSE
 15422         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15423     END-IF.
 15424
 15425     GO TO 6070-FORMAT-DATA.
 15426
 15427 6065-NOT-FOUND.
 15428     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15429     GO TO 6061-READ-ACCOUNT.
 15430
 15431 6068-ACCT-NOT-FND.
 15432     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15433
 15434 6070-FORMAT-DATA.
 15435     IF PI-HOLDTIL = ZEROS
 15436        MOVE SAVE-DATE           TO PAYDTBI
 15437       ELSE
 15438        MOVE PI-HOLDTIL          TO PAYDTBO
 15439        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 297
* EL156.cbl
 15440
 15441     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15442     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15443
 15444     IF EIBAID = DFHPF3 OR DFHPF4
 15445        NEXT SENTENCE
 15446     ELSE
 15447       GO TO 6071-CONTINUE.
 15448
 15449     MOVE PI-EPYFROM          TO PYFROMBO.
 15450     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15451
 15452     IF NOT PI-USES-PAID-TO
 15453        MOVE PI-EPYTHRU          TO PYTHRUBO
 15454        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15455     ELSE
 15456        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15457        MOVE '4'              TO DC-OPTION-CODE
 15458        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15459        IF NO-CONVERSION-ERROR
 15460           MOVE +1            TO DC-ELAPSED-DAYS
 15461           MOVE +0            TO DC-ELAPSED-MONTHS
 15462           MOVE '6'           TO DC-OPTION-CODE
 15463           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15464           IF NO-CONVERSION-ERROR
 15465              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15466
 15467     MOVE PI-EDAYS            TO DAYSBO.
 15468     MOVE PI-EPYAMT           TO PAYAMTBO.
 15469     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15470        IF PI-INT-AMT > ZEROS
 15471           MOVE PI-INT-AMT       TO INTAMTBO
 15472        END-IF
 15473     END-IF
 15474     GO TO 6072-SET-TYPE.
 15475
 15476 6071-CONTINUE.
 15477
 15478     IF PI-CPYFROM NOT = LOW-VALUES
 15479        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15480        MOVE SPACES              TO DC-OPTION-CODE
 15481        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15482        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15483
 15484     IF PI-CPYTHRU NOT = LOW-VALUES
 15485        IF NOT PI-USES-PAID-TO
 15486           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15487           MOVE SPACES             TO DC-OPTION-CODE
 15488           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15489           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15490        ELSE
 15491           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15492           MOVE '6'                TO DC-OPTION-CODE
 15493           MOVE +1                 TO DC-ELAPSED-DAYS
 15494           MOVE +0                 TO DC-ELAPSED-MONTHS
 15495           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15496           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15497
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 298
* EL156.cbl
 15498     MOVE PI-CDAYS               TO DAYSBO.
 15499     MOVE PI-CPYAMT              TO PAYAMTBO.
 15500     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15501        IF PI-INT-AMT > ZEROS
 15502           MOVE PI-INT-AMT       TO INTAMTBO
 15503        END-IF
 15504     END-IF
 15505     .
 15506 6072-SET-TYPE.
 15507     IF PI-PMTTYPE = '1'
 15508        MOVE 'PARTIAL'           TO PAYTYPBO.
 15509
 15510     IF PI-PMTTYPE = '2'
 15511        MOVE 'FINAL'             TO PAYTYPBO.
 15512
 15513     IF PI-PMTTYPE = '3'
 15514        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15515
 15516     IF PI-PMTTYPE = '4'
 15517        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15518
 15519     IF PI-PMTTYPE = '5'
 15520        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15521
 15522     IF PI-PMTTYPE = '6'
 15523        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15524
 15525     IF PI-PROV-PMT
 15526        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15527
 15528     IF PI-ECHECKNO NOT = SPACES
 15529        MOVE PI-ECHECKNO         TO CKNUMBO
 15530     ELSE
 15531        MOVE PI-CCHECKNO         TO CKNUMBO.
 15532
 15533     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15534        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15535        MOVE +91                 TO  TRLR-SEQ-NO
 15536
 15537* EXEC CICS READ
 15538*           DATASET  ('ELTRLR')
 15539*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15540*           RIDFLD   (ELTRLR-KEY)
 15541*           RESP     (WS-RESPONSE)
 15542*       END-EXEC
 15543     MOVE 'ELTRLR' TO DFHEIV1
 15544*    MOVE '&"S        E          (  N#00014621' TO DFHEIV0
 15545     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15546     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15547     MOVE X'204E233030303134363231' TO DFHEIV0(25:11)
 15548     CALL 'kxdfhei1' USING DFHEIV0,
 15549           DFHEIV1,
 15550           DFHEIV20,
 15551           DFHEIV99,
 15552           ELTRLR-KEY,
 15553           DFHEIV99,
 15554           DFHEIV99,
 15555           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 299
* EL156.cbl
 15556     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15557         DFHEIV20
 15558     MOVE EIBRESP  TO WS-RESPONSE
 15559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15560
 15561        IF WS-RESP-NORMAL
 15562           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15563        ELSE
 15564           MOVE SPACES           TO  LOANNBO
 15565        END-IF
 15566     END-IF
 15567
 15568*       MOVE PI-LOAN-NO          TO LOANNBO
 15569
 15570     IF CKNUMBO = SPACES
 15571         MOVE SPACES             TO CKNUMHDO.
 15572
 15573     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15574     MOVE CL-CARRIER             TO CARRBO.
 15575     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15576     MOVE CL-CERT-SFX            TO SUFXBO.
 15577
 15578     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15579        EVALUATE CL-CLAIM-TYPE
 15580           WHEN 'I'
 15581              MOVE '  IU  '      TO CLMTYPBO
 15582           WHEN 'G'
 15583              MOVE ' GAP  '      TO CLMTYPBO
 15584           WHEN 'F'
 15585              MOVE ' FMLA '      TO CLMTYPBO
 15586           WHEN OTHER
 15587              MOVE PI-AH-OVERRIDE-L6
 15588                                 TO CLMTYPBO
 15589        END-EVALUATE
 15590        MOVE ZEROS               TO UNDISBO
 15591*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15592        IF PI-PMTTYPE = '5' OR '6'
 15593           GO TO 6073-GET-NOTIFY-DATA
 15594        ELSE
 15595           MOVE PI-DAILY-RATE    TO RATEBO
 15596           GO TO 6073-GET-NOTIFY-DATA.
 15597
 15598     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15599
 15600     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15601        MOVE ZEROS               TO UNDISBO
 15602     ELSE
 15603        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15604
 15605 6073-GET-NOTIFY-DATA.
 15606
 15607     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15608
 15609     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15610         MOVE SPACES             TO  NAMEB2O
 15611                                     ADDR1B2O
 15612                                     ADDR2B2O
 15613                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 300
* EL156.cbl
 15614                                     AGTHDGO
 15615         MOVE ZEROS              TO  ZIPB2O
 15616         GO TO 6080-SET-INCURRED.
 15617
 15618     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15619     MOVE +29                    TO  TRLR-SEQ-NO.
 15620
 15621
 15622* EXEC CICS HANDLE CONDITION
 15623*        NOTFND   (6074-GET-COMP-DATA)
 15624*    END-EXEC.
 15625*    MOVE '"$I                   ! 1 #00014688' TO DFHEIV0
 15626     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15628     MOVE X'3120233030303134363838' TO DFHEIV0(25:11)
 15629     CALL 'kxdfhei1' USING DFHEIV0
 15630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15631
 15632
 15633     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15634
 15635     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15636     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15637     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15638*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15639     STRING AT-CITY ' ' AT-STATE
 15640        DELIMITED BY '  ' INTO CITYST2O
 15641     END-STRING
 15642     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15643     GO TO 6080-SET-INCURRED.
 15644
 15645 6074-GET-COMP-DATA.
 15646
 15647     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15648         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15649
 15650     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15651         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15652                                         ADDR1B2O
 15653                                         ADDR2B2O
 15654                                         CITYST2O
 15655         MOVE ZEROS                  TO  ZIPB2O
 15656         GO TO 6080-SET-INCURRED.
 15657
 15658     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15659     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15660     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15661     MOVE AM-GROUPING            TO  COMP-GROUP.
 15662     MOVE 'A'                    TO  COMP-TYPE.
 15663     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15664                                 TO  COMP-FIN-RESP.
 15665
 15666     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15667         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15668                                       'G' OR 'B' or 'S'
 15669             MOVE 'G'            TO  COMP-TYPE
 15670             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15671         ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 301
* EL156.cbl
 15672             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15673                                 TO  COMP-ACCOUNT
 15674     ELSE
 15675         MOVE 'G'                TO  COMP-TYPE
 15676         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15677
 15678     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15679
 15680     IF COMP-REC-FOUND
 15681         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15682         MOVE CO-ADDR-1          TO  ADDR1B2O
 15683         MOVE CO-ADDR-2          TO  ADDR2B2O
 15684*        MOVE CO-ADDR-3          TO  CITYST2O
 15685         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15686            DELIMITED BY '  ' INTO CITYST2O
 15687         END-STRING
 15688         MOVE CO-ZIP             TO  ZIPB2O
 15689     ELSE
 15690         MOVE 'NO COMP ADDRESS AVAILABLE'
 15691                                 TO  NAMEB2O
 15692                                     ADDR1B2O
 15693                                     ADDR2B2O
 15694                                     CITYST2O
 15695         MOVE ZEROS               TO ZIPB2O.
 15696
 15697 6080-SET-INCURRED.
 15698     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15699     MOVE SPACES                 TO DC-OPTION-CODE.
 15700     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15701     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15702     MOVE PI-PROCESSOR-ID        TO BYBO.
 15703     MOVE MAP-NAMEB              TO MAP-NAME.
 15704     MOVE 'C'                    TO PI-PASS-SW.
 15705     MOVE EIBAID                 TO PI-PFKEY-USED.
 15706     MOVE -1                     TO ENTPFBL.
 15707     GO TO 8100-SEND-INITIAL-MAP.
 15708
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 302
* EL156.cbl
 15710 6100-BUILD-PAYMENT-TRAILER.
 15711
 15712     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15713     MOVE '6'                    TO CNTL-REC-TYPE.
 15714
 15715     IF CONTROL-IS-ACTUAL-CARRIER
 15716         MOVE PI-CARRIER         TO WS-CARR
 15717     ELSE
 15718         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15719
 15720     IF PI-COMPANY-ID = 'FIA'
 15721         MOVE PI-CARRIER         TO  WS-CARR.
 15722
 15723     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15724     MOVE 0                      TO CNTL-SEQ-NO.
 15725     MOVE 'CARR'                 TO FILE-SWITCH.
 15726
 15727     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15728
 15729     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15730         IF PI-OFFLINE     = 'Y' AND
 15731            PI-ECHECKNO-CR = 'CR'
 15732              GO TO 6110-READ-CONTROL
 15733         ELSE
 15734            IF PI-CASH = 'N'
 15735                GO TO 6110-READ-CONTROL.
 15736
 15737     IF CHECK-NO-MANUAL    OR
 15738        CHECK-NO-AT-PRINT  OR
 15739        PI-OFFLINE = 'Y'
 15740          GO TO 6130-BUILD-TRAILER.
 15741     IF PI-COMPANY-ID = 'FIA'
 15742         NEXT SENTENCE
 15743     ELSE
 15744         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15745             GO TO 6110-READ-CONTROL.
 15746
 15747     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15748
 15749     IF CHECK-CNT-RESET-VALUE
 15750        MOVE +1                  TO CF-CHECK-COUNTER
 15751     ELSE
 15752        ADD +1                   TO CF-CHECK-COUNTER.
 15753
 15754     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15755
 15756     IF CHECK-NO-CARR-SEQ
 15757        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15758
 15759     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15760
 15761     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15762     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15763        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15764         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15765         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15766            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15767         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 303
* EL156.cbl
 15768                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15769     END-IF.
 15770
 15771     GO TO 6120-REWRITE.
 15772
 15773 6105-STATE-CHECK-NUMBER.
 15774     IF CHECK-NO-MANUAL    OR
 15775        CHECK-NO-AT-PRINT  OR
 15776        PI-OFFLINE = 'Y'
 15777           GO TO 6130-BUILD-TRAILER
 15778     END-IF.
 15779
 15780     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15781     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15782     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15783     MOVE '3'                TO CNTL-REC-TYPE.
 15784     MOVE +0                 TO CNTL-SEQ-NO.
 15785     MOVE 'STAT'             TO FILE-SWITCH.
 15786     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15787
 15788     IF CF-ST-CHECK-CNT-RESET
 15789         MOVE +1             TO CF-ST-CHECK-COUNTER
 15790     ELSE
 15791         ADD +1              TO CF-ST-CHECK-COUNTER
 15792     END-IF.
 15793
 15794     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15795     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15796     GO TO 6120-REWRITE.
 15797
 15798 6110-READ-CONTROL.
 15799     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15800     MOVE '1'                    TO CNTL-REC-TYPE.
 15801     MOVE SPACES                 TO CNTL-ACCESS.
 15802     MOVE 0                      TO CNTL-SEQ-NO.
 15803
 15804     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15805
 15806     IF CO-CHECK-COUNT-RESET
 15807        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15808     ELSE
 15809        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15810
 15811     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15812
 15813     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15814         IF PI-OFFLINE     = 'Y'  AND
 15815            PI-ECHECKNO-CR = 'CR'
 15816              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15817              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15818              MOVE AL-UANON           TO CHECKNOA
 15819              GO TO 6120-REWRITE
 15820         ELSE
 15821         IF PI-CASH = 'N'
 15822             MOVE 'N'                TO PI-ECHECKNO-N
 15823             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15824             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15825             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 304
* EL156.cbl
 15826             GO TO 6120-REWRITE.
 15827
 15828     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15829
 15830 6120-REWRITE.
 15831
 15832* EXEC CICS REWRITE
 15833*         DATASET('ELCNTL')
 15834*         FROM(CONTROL-FILE)
 15835*     END-EXEC.
 15836     MOVE LENGTH OF
 15837      CONTROL-FILE
 15838       TO DFHEIV11
 15839     MOVE 'ELCNTL' TO DFHEIV1
 15840*    MOVE '&& L                  %   #00014890' TO DFHEIV0
 15841     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15842     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15843     MOVE X'2020233030303134383930' TO DFHEIV0(25:11)
 15844     CALL 'kxdfhei1' USING DFHEIV0,
 15845           DFHEIV1,
 15846           CONTROL-FILE,
 15847           DFHEIV11,
 15848           DFHEIV99
 15849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15850
 15851
 15852     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15853
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 305
* EL156.cbl
 15855 6130-BUILD-TRAILER.
 15856
 15857
 15858* EXEC CICS GETMAIN
 15859*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15860*         LENGTH    (200)
 15861*         INITIMG   (GETMAIN-SPACE)
 15862*     END-EXEC.
 15863     MOVE 200
 15864       TO DFHEIV11
 15865*    MOVE ',"IL                  $   #00014900' TO DFHEIV0
 15866     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15867     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15868     MOVE X'2020233030303134393030' TO DFHEIV0(25:11)
 15869     CALL 'kxdfhei1' USING DFHEIV0,
 15870           DFHEIV20,
 15871           DFHEIV11,
 15872           GETMAIN-SPACE
 15873     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15874         DFHEIV20
 15875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15876
 15877
 15878     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15879                                    AT-PREV-PAID-THRU-DT.
 15880     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15881     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15882     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15883     MOVE 'AT'                   TO AT-RECORD-ID.
 15884     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15885
 15886     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15887        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15888           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15889     ELSE
 15890           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15891           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15892
 15893     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15894         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15895             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15896             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15897           ELSE
 15898             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15899             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15900
 15901     MOVE '2'                    TO AT-TRAILER-TYPE.
 15902     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15903                                    AT-PAYMENT-LAST-MAINT-DT.
 15904     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15905                                    AT-PAYMENT-LAST-UPDATED-BY.
 15906     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15907     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15908     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15909     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15910
 15911     IF PI-PMT-APPROVED
 15912        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 306
* EL156.cbl
 15913           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15914
 15915     IF PI-PFKEY-USED = DFHPF5
 15916        GO TO 6140-PF5-ENTERED.
 15917
 15918     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15919     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15920
 15921     IF PI-AIG-SPECIAL-BENEFIT
 15922         IF WS-1ST-SPECIAL-PMT
 15923             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15924             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15925                                        AT-AMOUNT-PAID
 15926         ELSE
 15927             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15928
 15929     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15930
 15931     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15932     MOVE '4'                    TO DC-OPTION-CODE.
 15933     PERFORM 9700-LINK-DATE-CONVERT.
 15934
 15935     IF DATE-CONVERSION-ERROR
 15936        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15937     ELSE
 15938        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15939
 15940     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15941     MOVE '4'                    TO DC-OPTION-CODE.
 15942     PERFORM 9700-LINK-DATE-CONVERT.
 15943
 15944     IF DATE-CONVERSION-ERROR
 15945        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15946     ELSE
 15947        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15948
 15949     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15950     move pi-ach-payment         to at-ach-payment
 15951     GO TO 6150-FINISH-MOVE.
 15952
 15953 6140-PF5-ENTERED.
 15954     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15955     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15956
 15957     IF PI-AIG-SPECIAL-BENEFIT
 15958         IF WS-1ST-SPECIAL-PMT
 15959             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15960             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15961                                        AT-AMOUNT-PAID
 15962         ELSE
 15963             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15964
 15965     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15966     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15967     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15968
 15969 6150-FINISH-MOVE.
 15970
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 307
* EL156.cbl
 15971     IF PI-ECHECKNO = SPACES
 15972         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15973     ELSE
 15974         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15975
 15976     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15977     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15978
 15979*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15980*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15981
 15982     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15983         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15984
 15985     IF PI-OFFLINE = 'N'
 15986        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15987        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15988     ELSE
 15989        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15990        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15991
 15992     move pi-ach-payment         to at-ach-payment
 15993     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15994
 15995     IF WS-2ND-SPECIAL-PMT
 15996         MOVE 'Y'                TO AT-CASH-PAYMENT
 15997         MOVE SPACES             TO AT-CHECK-NO
 15998         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15999         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 16000         MOVE 'U'                TO AT-AIG-UNEMP-IND
 16001         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 16002
 16003     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16004                                    AT-TO-BE-WRITTEN-DT.
 16005
 16006     IF PI-HOLDTIL NOT = ZEROS
 16007        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 16008        MOVE '4'                 TO DC-OPTION-CODE
 16009        PERFORM 9700-LINK-DATE-CONVERT
 16010        IF PI-OFFLINE = 'N'
 16011           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 16012           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 16013        ELSE
 16014           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 16015
 16016     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 16017     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16018                                    AT-CHECK-QUE-SEQUENCE.
 16019
 16020     IF PI-PFKEY-USED = DFHPF4
 16021        MOVE '1'                 TO AT-FORCE-CONTROL.
 16022
 16023     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 16024        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 16025        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 16026        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 16027
 16028     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 308
* EL156.cbl
 16029                                    AT-VOID-SELECT-DT
 16030                                    AT-VOID-ACCEPT-DT
 16031                                    AT-VOID-DT.
 16032     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 16033        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 16034        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 16035        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 16036        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 16037     ELSE
 16038        MOVE ZEROS               TO AT-DAILY-RATE
 16039                                    AT-ELIMINATION-DAYS
 16040        MOVE SPACES              TO AT-BENEFIT-TYPE
 16041     END-IF
 16042     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 16043     MOVE '4'                    TO DC-OPTION-CODE.
 16044     PERFORM 9700-LINK-DATE-CONVERT.
 16045     IF DATE-CONVERSION-ERROR
 16046         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 16047     ELSE
 16048         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 16049     END-IF.
 16050     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 16051     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 16052     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 16053     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 16054     IF (PI-REAUDIT-NEEDED = 'Y')
 16055        or (pi-max-ext-used = 'Y')
 16056        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 16057        OR PI-DUPE-APPROVAL-NEEDED = 'Y'
 16058         PERFORM 6155-READ-CONTROL
 16059         PERFORM 6157-SET-APP-LEVEL
 16060         IF AT-APPROVAL-LEVEL-REQD < '4'
 16061            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 16062         END-IF
 16063         MOVE 'Y' TO WS-NEED-APPROVAL
 16064         GO TO 6170-WRITE
 16065     END-IF.
 16066*******************************************************
 16067     IF NOT PI-PMT-GRADUATED
 16068         GO TO 6170-WRITE.
 16069     PERFORM 6155-READ-CONTROL.
 16070
 16071     IF PAID-FOR-LIFE
 16072         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 16073             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16074                                     WS-PMT-APPROVAL-SW
 16075             GO TO 6170-WRITE.
 16076
 16077*05999      IF PAID-FOR-AH
 16078     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 16079         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 16080             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16081                                     WS-PMT-APPROVAL-SW
 16082             GO TO 6170-WRITE.
 16083
 16084     MOVE '1'                    TO AT-APPROVED-LEVEL.
 16085
 16086     PERFORM 6157-SET-APP-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 309
* EL156.cbl
 16087
 16088     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 16089
 16090     IF NOT PI-PMT-GRADUATED
 16091         GO TO 6170-WRITE.
 16092
 16093
 16094* EXEC CICS HANDLE CONDITION
 16095*        NOTFND   (6170-WRITE)
 16096*    END-EXEC.
 16097*    MOVE '"$I                   ! 2 #00015121' TO DFHEIV0
 16098     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16100     MOVE X'3220233030303135313231' TO DFHEIV0(25:11)
 16101     CALL 'kxdfhei1' USING DFHEIV0
 16102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16103
 16104
 16105     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16106     MOVE '2'                    TO CNTL-REC-TYPE.
 16107     MOVE +0                     TO CNTL-SEQ-NO.
 16108     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16109
 16110
 16111* EXEC CICS READ
 16112*         DATASET  ('ELCNTL')
 16113*         SET      (ADDRESS OF CONTROL-FILE)
 16114*         RIDFLD   (ELCNTL-KEY)
 16115*    END-EXEC.
 16116     MOVE 'ELCNTL' TO DFHEIV1
 16117*    MOVE '&"S        E          (   #00015130' TO DFHEIV0
 16118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16120     MOVE X'2020233030303135313330' TO DFHEIV0(25:11)
 16121     CALL 'kxdfhei1' USING DFHEIV0,
 16122           DFHEIV1,
 16123           DFHEIV20,
 16124           DFHEIV99,
 16125           ELCNTL-KEY,
 16126           DFHEIV99,
 16127           DFHEIV99,
 16128           DFHEIV99
 16129     SET ADDRESS OF CONTROL-FILE TO
 16130         DFHEIV20
 16131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16132
 16133
 16134     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 16135
 16136     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 16137                         OR '4' OR '5'
 16138         NEXT SENTENCE
 16139     ELSE
 16140         MOVE 'Y' TO WS-NEED-APPROVAL
 16141         GO TO 6170-WRITE.
 16142
 16143     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 16144         MOVE 'Y' TO WS-NEED-APPROVAL
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 310
* EL156.cbl
 16145         IF WS-APPROVAL-LEVEL = '1'
 16146             MOVE '2'        TO  AT-APPROVED-LEVEL
 16147                            WS-SAVE-APPROVED-LEVEL
 16148             GO TO 6170-WRITE
 16149         ELSE
 16150             IF WS-APPROVAL-LEVEL = '2'
 16151                 MOVE '3'        TO  AT-APPROVED-LEVEL
 16152                                WS-SAVE-APPROVED-LEVEL
 16153                 GO TO 6170-WRITE
 16154             ELSE IF WS-APPROVAL-LEVEL = '3'
 16155                 MOVE '4'        TO  AT-APPROVED-LEVEL
 16156                                WS-SAVE-APPROVED-LEVEL
 16157                 GO TO 6170-WRITE
 16158             ELSE IF WS-APPROVAL-LEVEL = '4'
 16159                 MOVE '5'        TO  AT-APPROVED-LEVEL
 16160                                WS-SAVE-APPROVED-LEVEL
 16161                 GO TO 6170-WRITE.
 16162
 16163     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16164                             WS-PMT-APPROVAL-SW.
 16165     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16166                             AT-APPROVAL-LEVEL-REQD.
 16167
 16168*******************************************************
 16169 6155-READ-CONTROL.
 16170     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16171     MOVE '1'                    TO CNTL-REC-TYPE.
 16172     MOVE SPACES                 TO CNTL-ACCESS.
 16173     MOVE +0                     TO CNTL-SEQ-NO.
 16174     MOVE 'COMP'                 TO FILE-SWITCH.
 16175
 16176     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16177 6157-SET-APP-LEVEL.
 16178******A&H Limits are set as a monthly payment.  Calculate the mont
 16179******equivalent of the amount paid today
 16180     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16181        PI-SAVE-ODD-DAYS-OVER > 0
 16182           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16183                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16184           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16185                                  WS-CALC-PMT-MONTHS
 16186     ELSE
 16187           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16188     END-IF.
 16189*06007      IF ((PAID-FOR-AH) AND
 16190     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16191           OR PAID-FOR-FAM) AND
 16192*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16193        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16194              OR
 16195        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16196        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16197            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16198       ELSE
 16199*06014      IF ((PAID-FOR-AH)  AND
 16200         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16201           OR PAID-FOR-FAM) AND
 16202*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 311
* EL156.cbl
 16203           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 16204              OR
 16205        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16206        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16207            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16208         ELSE
 16209*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16210           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16211                OR PAID-FOR-FAM) AND
 16212               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16213              OR
 16214          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16215          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16216            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16217       ELSE
 16218           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16219                OR PAID-FOR-FAM) AND
 16220               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16221              OR
 16222          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16223          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16224            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16225       ELSE
 16226            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16227
 16228     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16229           OR PAID-FOR-FAM) AND
 16230        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16231        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16232            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16233        END-IF
 16234     ELSE
 16235     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16236           OR PAID-FOR-FAM) AND
 16237        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16238        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16239            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16240        END-IF
 16241     ELSE
 16242     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16243           OR PAID-FOR-FAM) AND
 16244        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16245        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16246            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16247        END-IF
 16248     ELSE
 16249     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16250           OR PAID-FOR-FAM) AND
 16251        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16252        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16253            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16254        END-IF
 16255     ELSE
 16256     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16257           OR PAID-FOR-FAM)
 16258            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16259
 16260 6170-WRITE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 312
* EL156.cbl
 16261
 16262     if pi-company-id = 'DCC' or 'VPP'
 16263        PERFORM 0900-GET-DDF-limits
 16264                                 THRU 0900-EXIT
 16265     end-if
 16266     perform 2220-update-elcrtt  thru 2220-exit
 16267     IF PI-COMPANY-ID = 'DMD'
 16268        IF PI-AT-EOB-CODES NOT = SPACES
 16269           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16270           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16271           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16272           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16273           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16274
 16275
 16276* EXEC CICS HANDLE CONDITION
 16277*        DUPREC    (6180-DUPREC)
 16278*    END-EXEC.
 16279*    MOVE '"$%                   ! 3 #00015277' TO DFHEIV0
 16280     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16282     MOVE X'3320233030303135323737' TO DFHEIV0(25:11)
 16283     CALL 'kxdfhei1' USING DFHEIV0
 16284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16285
 16286
 16287
 16288* EXEC CICS WRITE
 16289*         DATASET       ('ELTRLR')
 16290*         FROM          (ACTIVITY-TRAILERS)
 16291*         RIDFLD        (AT-CONTROL-PRIMARY)
 16292*     END-EXEC.
 16293     MOVE LENGTH OF
 16294      ACTIVITY-TRAILERS
 16295       TO DFHEIV11
 16296     MOVE 'ELTRLR' TO DFHEIV1
 16297*    MOVE '&$ L                  ''   #00015281' TO DFHEIV0
 16298     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16299     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16300     MOVE X'2020233030303135323831' TO DFHEIV0(25:11)
 16301     CALL 'kxdfhei1' USING DFHEIV0,
 16302           DFHEIV1,
 16303           ACTIVITY-TRAILERS,
 16304           DFHEIV11,
 16305           AT-CONTROL-PRIMARY,
 16306           DFHEIV99,
 16307           DFHEIV99
 16308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16309
 16310
 16311     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16312        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16313*06088           GO TO 6199-EXIT.
 16314           GO TO 6176-APPROVAL-NOTE.
 16315
 16316
 16317* EXEC CICS GETMAIN
 16318*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 313
* EL156.cbl
 16319*         LENGTH    (200)
 16320*         INITIMG   (GETMAIN-SPACE)
 16321*     END-EXEC.
 16322     MOVE 200
 16323       TO DFHEIV11
 16324*    MOVE ',"IL                  $   #00015292' TO DFHEIV0
 16325     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16326     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16327     MOVE X'2020233030303135323932' TO DFHEIV0(25:11)
 16328     CALL 'kxdfhei1' USING DFHEIV0,
 16329           DFHEIV20,
 16330           DFHEIV11,
 16331           GETMAIN-SPACE
 16332     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16333         DFHEIV20
 16334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16335
 16336
 16337     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16338
 16339     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16340     MOVE 'AT'                   TO AT-RECORD-ID.
 16341     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16342     MOVE '6'                    TO AT-TRAILER-TYPE.
 16343     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16344                                    AT-GEN-INFO-LAST-MAINT-DT
 16345     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16346                                    AT-GEN-INFO-LAST-UPDATED-BY
 16347     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16348
 16349     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16350     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16351     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16352
 16353     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16354
 16355 6175-WRITE.
 16356
 16357
 16358* EXEC CICS HANDLE CONDITION
 16359*        DUPREC    (6190-DUPREC)
 16360*    END-EXEC.
 16361*    MOVE '"$%                   ! 4 #00015318' TO DFHEIV0
 16362     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16364     MOVE X'3420233030303135333138' TO DFHEIV0(25:11)
 16365     CALL 'kxdfhei1' USING DFHEIV0
 16366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16367
 16368
 16369
 16370* EXEC CICS WRITE
 16371*         DATASET     ('ELTRLR')
 16372*         FROM        (ACTIVITY-TRAILERS)
 16373*         RIDFLD      (AT-CONTROL-PRIMARY)
 16374*     END-EXEC.
 16375     MOVE LENGTH OF
 16376      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 314
* EL156.cbl
 16377       TO DFHEIV11
 16378     MOVE 'ELTRLR' TO DFHEIV1
 16379*    MOVE '&$ L                  ''   #00015322' TO DFHEIV0
 16380     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16382     MOVE X'2020233030303135333232' TO DFHEIV0(25:11)
 16383     CALL 'kxdfhei1' USING DFHEIV0,
 16384           DFHEIV1,
 16385           ACTIVITY-TRAILERS,
 16386           DFHEIV11,
 16387           AT-CONTROL-PRIMARY,
 16388           DFHEIV99,
 16389           DFHEIV99
 16390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16391
 16392
 16393 6176-APPROVAL-NOTE.
 16394
 16395     IF NOT APPROVAL-NEEDED
 16396         GO TO 6199-EXIT.
 16397
 16398
 16399* EXEC CICS GETMAIN
 16400*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16401*        LENGTH    (200)
 16402*        INITIMG   (GETMAIN-SPACE)
 16403*    END-EXEC.
 16404     MOVE 200
 16405       TO DFHEIV11
 16406*    MOVE ',"IL                  $   #00015333' TO DFHEIV0
 16407     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16409     MOVE X'2020233030303135333333' TO DFHEIV0(25:11)
 16410     CALL 'kxdfhei1' USING DFHEIV0,
 16411           DFHEIV20,
 16412           DFHEIV11,
 16413           GETMAIN-SPACE
 16414     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16415         DFHEIV20
 16416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16417
 16418
 16419     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16420
 16421     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16422     MOVE 'AT'               TO AT-RECORD-ID
 16423     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16424     MOVE '6'                TO AT-TRAILER-TYPE
 16425     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16426                                AT-GEN-INFO-LAST-MAINT-DT
 16427     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16428                                AT-GEN-INFO-LAST-UPDATED-BY
 16429     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16430
 16431     IF PI-REAUDIT-NEEDED = 'Y'
 16432         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16433     ELSE
 16434         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 315
* EL156.cbl
 16435     END-IF
 16436     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16437         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16438     END-IF
 16439     IF PI-DUPE-APPROVAL-NEEDED = 'Y'
 16440         MOVE WS-DUPE-APPROV-NOTE TO AT-INFO-LINE-1
 16441     END-IF
 16442
 16443     MOVE SPACES             TO AT-INFO-LINE-2
 16444
 16445     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16446 6177-WRITE.
 16447
 16448
 16449* EXEC CICS HANDLE CONDITION
 16450*        DUPREC    (6185-DUPREC)
 16451*    END-EXEC.
 16452*    MOVE '"$%                   ! 5 #00015368' TO DFHEIV0
 16453     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16455     MOVE X'3520233030303135333638' TO DFHEIV0(25:11)
 16456     CALL 'kxdfhei1' USING DFHEIV0
 16457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16458
 16459
 16460
 16461* EXEC CICS WRITE
 16462*         DATASET     ('ELTRLR')
 16463*         FROM        (ACTIVITY-TRAILERS)
 16464*         RIDFLD      (AT-CONTROL-PRIMARY)
 16465*     END-EXEC.
 16466     MOVE LENGTH OF
 16467      ACTIVITY-TRAILERS
 16468       TO DFHEIV11
 16469     MOVE 'ELTRLR' TO DFHEIV1
 16470*    MOVE '&$ L                  ''   #00015372' TO DFHEIV0
 16471     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16472     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16473     MOVE X'2020233030303135333732' TO DFHEIV0(25:11)
 16474     CALL 'kxdfhei1' USING DFHEIV0,
 16475           DFHEIV1,
 16476           ACTIVITY-TRAILERS,
 16477           DFHEIV11,
 16478           AT-CONTROL-PRIMARY,
 16479           DFHEIV99,
 16480           DFHEIV99
 16481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16482
 16483
 16484
 16485     GO TO 6199-EXIT.
 16486
 16487 6180-DUPREC.
 16488
 16489     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16490     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16491     GO TO 6170-WRITE.
 16492
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 316
* EL156.cbl
 16493 6185-DUPREC.
 16494     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16495     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16496     GO TO 6177-WRITE.
 16497
 16498 6190-DUPREC.
 16499     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16500     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16501     GO TO 6175-WRITE.
 16502
 16503 6199-EXIT.
 16504      EXIT.
 16505
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 317
* EL156.cbl
 16507 6200-UPDATE-CLAIM-MSTR.
 16508     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16509     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16510     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16511     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16512
 16513     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16514
 16515     MOVE ZEROS                  TO W-INTEREST.
 16516
 16517     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16518        IF (PI-OFFLINE = 'Y') OR
 16519           (PI-PMTTYPE = '7')
 16520           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16521                                 THRU 9870-EXIT
 16522        END-IF
 16523     END-IF
 16524     IF NOT ERROR-ON-OUTPUT
 16525        CONTINUE
 16526     ELSE
 16527
 16528* EXEC CICS REWRITE
 16529*          DATASET('ELMSTR')
 16530*          FROM(CLAIM-MASTER)
 16531*       END-EXEC
 16532     MOVE LENGTH OF
 16533      CLAIM-MASTER
 16534       TO DFHEIV11
 16535     MOVE 'ELMSTR' TO DFHEIV1
 16536*    MOVE '&& L                  %   #00015421' TO DFHEIV0
 16537     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16538     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16539     MOVE X'2020233030303135343231' TO DFHEIV0(25:11)
 16540     CALL 'kxdfhei1' USING DFHEIV0,
 16541           DFHEIV1,
 16542           CLAIM-MASTER,
 16543           DFHEIV11,
 16544           DFHEIV99
 16545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16546
 16547        MOVE -1                  TO ENTPFBL
 16548        MOVE AL-UANON            TO ENTPFBA
 16549        MOVE MAP-NAMEB           TO MAP-NAME
 16550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16551        GO TO 8200-SEND-DATAONLY
 16552     END-IF
 16553
 16554     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16555
 16556     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16557
 16558     IF PI-AIG-SPECIAL-BENEFIT
 16559         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16560
 16561     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16562
 16563     IF PI-SPECIAL-BEN-SW = 'Y'
 16564         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 318
* EL156.cbl
 16565         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16566
 16567     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16568         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16569     ELSE
 16570         IF PI-PMTTYPE NOT = '4'
 16571            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16572
 16573     IF PI-PMTTYPE = '5' OR '6'
 16574        GO TO  6250-SET-MAINT.
 16575
 16576     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16577                                         CL-LAG-REPORT-CODE.
 16578
 16579     IF CL-ACTIVITY-CODE = 09
 16580         GO TO 6200-CONT-UPDATE.
 16581
 16582     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16583         IF CL-ACTIVITY-CODE = 11
 16584             GO TO 6200-CONT-UPDATE.
 16585
 16586     IF WS-ACT-REC-FOUND-SW = 'N'
 16587         GO TO 6200-CONT-UPDATE.
 16588
 16589     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16590         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16591         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16592         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16593
 16594     IF WS-UPDATE-SW = 'Y'
 16595         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16596                                         CL-NEXT-FOLLOWUP-DT.
 16597
 16598 6200-CONT-UPDATE.
 16599
 16600     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16601       IF CLAIM-IS-CLOSED
 16602         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16603           IF WS-OPEN-CLOSE-SW = '2'
 16604             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16605                                        CL-LAST-CLOSE-DT.
 16606
 16607     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16608        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16609        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16610
 16611     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16612        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16613        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16614        MOVE 'C'                 TO CL-CLAIM-STATUS
 16615        IF PI-PMTTYPE = '2'
 16616           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16617              or 'F')
 16618           CONTINUE
 16619        ELSE
 16620           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16621        END-IF
 16622     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 319
* EL156.cbl
 16623        IF PI-PMTTYPE = '2' OR '3'
 16624           IF PI-PMTTYPE = '2' AND
 16625              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16626                 or 'F')
 16627              CONTINUE
 16628           ELSE
 16629              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16630           END-IF
 16631        END-IF
 16632     END-IF
 16633
 16634     IF PI-PMTTYPE = '4'
 16635        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16636
 16637     IF PI-COMPANY-ID = 'CVL'
 16638         IF PI-LOAN-UPDATE-SW = 'Y'
 16639             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16640             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16641             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16642             MOVE CL-CERT-STATE      TO  CERT-STATE
 16643             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16644             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16645             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16646             MOVE 'CERT'             TO  FILE-SWITCH
 16647             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16648             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16649             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16650
 16651     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16652        GO TO 6220-USE-COMPUTED.
 16653
 16654     IF (PI-PMTTYPE = '4')  AND
 16655        (PI-EPYAMT < ZEROS)
 16656          COMPUTE CL-NO-OF-DAYS-PAID =
 16657                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16658          IF CL-NO-OF-DAYS-PAID < +0
 16659              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16660          ELSE
 16661              NEXT SENTENCE
 16662     ELSE
 16663          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16664
 16665     IF HOLD-UNTIL-PMT
 16666        CONTINUE
 16667     ELSE
 16668     IF PI-PROCESSOR-ID = 'FIX '
 16669        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16670           NEXT SENTENCE
 16671        ELSE
 16672           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16673     ELSE
 16674        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16675
 16676     IF PI-PMTTYPE = '4'
 16677        GO TO 6250-SET-MAINT.
 16678
 16679     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16680     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 320
* EL156.cbl
 16681     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16682     IF HOLD-UNTIL-PMT
 16683        CONTINUE
 16684     ELSE
 16685     IF DATE-CONVERSION-ERROR
 16686        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16687     ELSE
 16688        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16689        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16690           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16691           IF PI-AIG-SPECIAL-BENEFIT
 16692               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16693           ELSE
 16694               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16695
 16696     GO TO 6250-SET-MAINT.
 16697
 16698 6220-USE-COMPUTED.
 16699
 16700     IF (PI-PMTTYPE = '4')  AND
 16701        (PI-CPYAMT < ZEROS)
 16702          COMPUTE CL-NO-OF-DAYS-PAID =
 16703                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16704          IF CL-NO-OF-DAYS-PAID < +0
 16705              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16706          ELSE
 16707              NEXT SENTENCE
 16708     ELSE
 16709          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16710
 16711     IF NOT HOLD-UNTIL-PMT
 16712        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16713        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16714
 16715     IF PI-PMTTYPE = '4'
 16716        GO TO 6250-SET-MAINT.
 16717
 16718     IF PI-AIG-SPECIAL-BENEFIT
 16719         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16720     ELSE
 16721         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16722
 16723     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16724       AND NOT HOLD-UNTIL-PMT
 16725        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16726
 16727 6250-SET-MAINT.
 16728     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16729
 16730     IF PI-PROCESSOR-ID = 'FIX '
 16731        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16732           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16733        ELSE
 16734           NEXT SENTENCE
 16735     ELSE
 16736        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16737
 16738     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 321
* EL156.cbl
 16739     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16740     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16741
 16742 6299-EXIT.
 16743      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 322
* EL156.cbl
 16745 6300-UPDATE-CERT.
 16746
 16747*  ADD CERTNOTE FOR SC NP+6
 16748     IF PI-COMPANY-ID = 'CID' AND
 16749       (PI-PMTTYPE = '2' OR '3') AND
 16750        CL-CERT-STATE = 'SC'  AND
 16751        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16752           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16753     END-IF.
 16754
 16755     IF PI-COMPANY-ID = 'AHL' AND
 16756       (PI-PMTTYPE = '2' OR '3') AND
 16757        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16758           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16759           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16760     END-IF.
 16761
 16762     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16763     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16764     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16765     MOVE CL-CERT-STATE    TO CERT-STATE.
 16766     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16767     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16768     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16769     MOVE 'CERT'           TO FILE-SWITCH.
 16770
 16771     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16772
 16773     IF CERT-NOTE-ADDED
 16774        IF CM-NOTE-SW = ' '
 16775           MOVE '4'             TO CM-NOTE-SW
 16776        ELSE
 16777           IF CM-NOTE-SW = '1'
 16778               MOVE '5'           TO CM-NOTE-SW
 16779           ELSE
 16780              IF CM-NOTE-SW = '2'
 16781                 MOVE '6'         TO CM-NOTE-SW
 16782              ELSE
 16783                 IF CM-NOTE-SW = '3'
 16784                    MOVE '7'      TO CM-NOTE-SW
 16785                 END-IF
 16786              END-IF
 16787           END-IF
 16788        END-IF
 16789     END-IF.
 16790
 16791     IF PI-COMPANY-ID = 'CVL'
 16792         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16793         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16794
 16795     IF PI-PMTTYPE NOT = '4'
 16796        GO TO 6340-UPDATE-CERT.
 16797
 16798     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16799        IF PI-PFKEY-USED = DFHPF5
 16800           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16801        ELSE
 16802           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 323
* EL156.cbl
 16803
 16804*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16805*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16806*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16807*               PI-LF-COVERAGE-TYPE = 'P'
 16808*                GO TO 6350-REWRITE-CERT.
 16809
 16810     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16811       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16812          PI-LF-COVERAGE-TYPE = 'P'
 16813           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16814                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16815                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16816                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16817                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16818                GO TO 6350-REWRITE-CERT
 16819            ELSE
 16820                GO TO 6350-REWRITE-CERT.
 16821
 16822     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16823         GO TO 6350-REWRITE-CERT.
 16824
 16825     IF NOT CM-AH-LUMP-SUM-DISAB
 16826        GO TO 6380-UNLOCK-CERT.
 16827
 16828     IF PI-PFKEY-USED = DFHPF5
 16829        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16830                                    CM-AH-ITD-AH-PMT
 16831        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16832        GO TO 6350-REWRITE-CERT
 16833     ELSE
 16834        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16835                                    CM-AH-ITD-AH-PMT
 16836        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16837        GO TO 6350-REWRITE-CERT.
 16838
 16839 6340-UPDATE-CERT.
 16840
 16841     IF CL-CLAIM-TYPE = 'L' OR 'O'
 16842         IF PI-PFKEY-USED = DFHPF5
 16843             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16844         ELSE
 16845             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16846
 16847     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16848         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16849             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16850                PI-LF-COVERAGE-TYPE = 'P'
 16851                 GO TO 6350-REWRITE-CERT.
 16852
 16853     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16854       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16855          PI-LF-COVERAGE-TYPE = 'P'
 16856           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16857                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16858                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16859                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16860                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 324
* EL156.cbl
 16861                GO TO 6350-REWRITE-CERT.
 16862
 16863     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16864         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16865            PI-LF-COVERAGE-TYPE NOT = 'P'
 16866             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16867             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16868             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16869             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16870             GO TO 6350-REWRITE-CERT.
 16871
 16872     IF CL-CLAIM-TYPE = 'O'
 16873         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16874            PI-LF-COVERAGE-TYPE NOT = 'P'
 16875             MOVE CL-INCURRED-DT         TO CM-LF-CANCEL-DT
 16876             MOVE PI-MONTH-END-SAVE      TO CM-LF-CANCEL-EXIT-DT
 16877             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-CANCEL
 16878             MOVE '6'            TO CM-LF-CURRENT-STATUS
 16879             GO TO 6350-REWRITE-CERT.
 16880
 16881     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16882         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16883         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16884         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16885         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16886         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16887         IF PI-PFKEY-USED = DFHPF5
 16888             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16889                                        CM-AH-ITD-AH-PMT
 16890             GO TO 6350-REWRITE-CERT
 16891         ELSE
 16892             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16893                                        CM-AH-ITD-AH-PMT
 16894             GO TO 6350-REWRITE-CERT.
 16895
 16896 6350-REWRITE-CERT.
 16897
 16898
 16899* EXEC CICS REWRITE
 16900*         DATASET  ('ELCERT')
 16901*         FROM(CERTIFICATE-MASTER)
 16902*     END-EXEC.
 16903     MOVE LENGTH OF
 16904      CERTIFICATE-MASTER
 16905       TO DFHEIV11
 16906     MOVE 'ELCERT' TO DFHEIV1
 16907*    MOVE '&& L                  %   #00015777' TO DFHEIV0
 16908     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16909     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16910     MOVE X'2020233030303135373737' TO DFHEIV0(25:11)
 16911     CALL 'kxdfhei1' USING DFHEIV0,
 16912           DFHEIV1,
 16913           CERTIFICATE-MASTER,
 16914           DFHEIV11,
 16915           DFHEIV99
 16916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16917
 16918
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 325
* EL156.cbl
 16919     GO TO 6399-EXIT.
 16920
 16921 6380-UNLOCK-CERT.
 16922
 16923* EXEC CICS UNLOCK
 16924*         DATASET  ('ELCERT')
 16925*     END-EXEC.
 16926     MOVE 'ELCERT' TO DFHEIV1
 16927*    MOVE '&*                    #   #00015785' TO DFHEIV0
 16928     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16929     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16930     MOVE X'2020233030303135373835' TO DFHEIV0(25:11)
 16931     CALL 'kxdfhei1' USING DFHEIV0,
 16932           DFHEIV1,
 16933           DFHEIV99
 16934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16935
 16936
 16937 6399-EXIT.
 16938      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 326
* EL156.cbl
 16940 6400-UPDATE-ZERO-TRAILER.
 16941     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16942     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16943
 16944     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16945
 16946     IF PI-EPYAMT NOT = ZEROS
 16947         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16948     ELSE
 16949         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16950
 16951     IF PI-ERESV NOT = ZEROS
 16952        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16953
 16954     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16955        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16956
 16957     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16958        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16959     ELSE
 16960        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16961
 16962     IF PI-PMTTYPE = '5'
 16963        IF PI-EPYAMT = ZEROS
 16964           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16965        ELSE
 16966           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16967
 16968     IF PI-PMTTYPE = '6'
 16969        IF PI-EPYAMT = ZEROS
 16970           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16971        ELSE
 16972           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16973
 16974 6420-CHECK-OPEN-CLOSE.
 16975     IF PI-PMTTYPE = '5' OR '6'
 16976        GO TO 6450-REWRITE.
 16977
 16978     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16979         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16980             IF CLAIM-IS-CLOSED
 16981                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16982                 MOVE 1          TO  SUB-1
 16983                 GO TO 6440-AIG-LOOP.
 16984
 16985     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16986        GO TO 6450-REWRITE.
 16987
 16988     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16989        GO TO 6450-REWRITE.
 16990
 16991     MOVE 1                      TO SUB-1.
 16992
 16993 6430-LOOP.
 16994     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16995        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16996        IF PI-PMTTYPE = '1' OR '4'
 16997           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 327
* EL156.cbl
 16998           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16999           GO TO 6450-REWRITE
 17000        ELSE
 17001           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 17002           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 17003           GO TO 6450-REWRITE.
 17004
 17005     IF SUB-1 = 6
 17006      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 17007      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 17008      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 17009      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 17010      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 17011      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 17012      GO TO 6430-LOOP.
 17013
 17014     ADD 1                       TO SUB-1.
 17015     GO TO 6430-LOOP.
 17016
 17017
 17018 6440-AIG-LOOP.
 17019
 17020     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 17021       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 17022       IF WS-OPEN-CLOSE-SW = '1'
 17023         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 17024         IF PI-PMTTYPE = '2'
 17025           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17026           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 17027         ELSE
 17028           IF PI-PMTTYPE = '3'
 17029             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17030             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 17031           ELSE
 17032             IF PI-PMTTYPE = '4'
 17033               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17034               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17035             ELSE
 17036               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17037               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17038       ELSE
 17039         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 17040         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17041         GO TO 6450-REWRITE.
 17042
 17043     IF SUB-1 = 6
 17044      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 17045      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 17046      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 17047      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 17048      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 17049      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 17050      GO TO 6440-AIG-LOOP.
 17051
 17052     ADD 1                       TO SUB-1.
 17053     GO TO 6440-AIG-LOOP.
 17054
 17055 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 328
* EL156.cbl
 17056     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 17057     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 17058     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 17059
 17060     IF PI-COMPANY-ID = 'DMD'
 17061         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 17062         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 17063         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 17064         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 17065         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 17066
 17067
 17068* EXEC CICS REWRITE
 17069*         DATASET  ('ELTRLR')
 17070*         FROM     (ACTIVITY-TRAILERS)
 17071*     END-EXEC.
 17072     MOVE LENGTH OF
 17073      ACTIVITY-TRAILERS
 17074       TO DFHEIV11
 17075     MOVE 'ELTRLR' TO DFHEIV1
 17076*    MOVE '&& L                  %   #00015919' TO DFHEIV0
 17077     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17078     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17079     MOVE X'2020233030303135393139' TO DFHEIV0(25:11)
 17080     CALL 'kxdfhei1' USING DFHEIV0,
 17081           DFHEIV1,
 17082           ACTIVITY-TRAILERS,
 17083           DFHEIV11,
 17084           DFHEIV99
 17085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17086
 17087
 17088 6499-EXIT.
 17089      EXIT.
 17090
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 329
* EL156.cbl
 17092 6500-READ-DLO035.
 17093     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 17094     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17095     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17096     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17097
 17098
 17099* EXEC CICS LINK
 17100*        PROGRAM    ('DLO035')
 17101*        COMMAREA   (DLO035-KEY)
 17102*        LENGTH     (DL35-LENGTH)
 17103*    END-EXEC.
 17104     MOVE 'DLO035' TO DFHEIV1
 17105*    MOVE '."C                   (   #00015934' TO DFHEIV0
 17106     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17108     MOVE X'2020233030303135393334' TO DFHEIV0(25:11)
 17109     CALL 'kxdfhei1' USING DFHEIV0,
 17110           DFHEIV1,
 17111           DLO035-KEY,
 17112           DL35-LENGTH,
 17113           DFHEIV99,
 17114           DFHEIV99,
 17115           DFHEIV99,
 17116           DFHEIV99
 17117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17118
 17119
 17120     IF DL35-RETURN-CODE = 'OK'
 17121         GO TO 6500-EXIT.
 17122
 17123     IF DL35-RETURN-CODE = '01'
 17124         MOVE ER-7830            TO EMI-ERROR
 17125         GO TO 6500-BAD-EXIT.
 17126
 17127     IF DL35-RETURN-CODE = '02'
 17128         MOVE ER-7831            TO EMI-ERROR
 17129         GO TO 6500-BAD-EXIT.
 17130
 17131     IF DL35-RETURN-CODE = '03'
 17132         MOVE ER-7832            TO EMI-ERROR
 17133         GO TO 6500-BAD-EXIT.
 17134
 17135     IF DL35-RETURN-CODE = '04'
 17136         MOVE ER-7833            TO EMI-ERROR
 17137         GO TO 6500-BAD-EXIT.
 17138
 17139     IF DL35-RETURN-CODE = '05'
 17140         MOVE ER-7834            TO EMI-ERROR
 17141         GO TO 6500-BAD-EXIT.
 17142
 17143     IF DL35-RETURN-CODE = '06'
 17144         MOVE ER-7835            TO EMI-ERROR
 17145         GO TO 6500-BAD-EXIT.
 17146
 17147     IF DL35-RETURN-CODE = '07'
 17148         MOVE ER-7836            TO EMI-ERROR
 17149         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 330
* EL156.cbl
 17150
 17151     IF DL35-RETURN-CODE = 'E1'
 17152         MOVE ER-7837            TO EMI-ERROR
 17153         GO TO 6500-BAD-EXIT.
 17154
 17155     IF DL35-RETURN-CODE NOT = 'OK'
 17156         MOVE ER-7838            TO EMI-ERROR
 17157         GO TO 6500-BAD-EXIT.
 17158
 17159 6500-EXIT.
 17160      EXIT.
 17161
 17162 6500-BAD-EXIT.
 17163
 17164* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17165*    MOVE '6"R                   !   #00015983' TO DFHEIV0
 17166     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17168     MOVE X'2020233030303135393833' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0
 17170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17171
 17172     MOVE -1                 TO PMTTYPEL.
 17173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17174     GO TO 8200-SEND-DATAONLY.
 17175
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 331
* EL156.cbl
 17177 6600-UPDATE-DLO035.
 17178     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17179     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17180     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17181     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17182
 17183
 17184* EXEC CICS LINK
 17185*        PROGRAM    ('DLO035')
 17186*        COMMAREA   (DLO035-KEY)
 17187*        LENGTH     (DL35-LENGTH)
 17188*    END-EXEC.
 17189     MOVE 'DLO035' TO DFHEIV1
 17190*    MOVE '."C                   (   #00015995' TO DFHEIV0
 17191     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17192     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17193     MOVE X'2020233030303135393935' TO DFHEIV0(25:11)
 17194     CALL 'kxdfhei1' USING DFHEIV0,
 17195           DFHEIV1,
 17196           DLO035-KEY,
 17197           DL35-LENGTH,
 17198           DFHEIV99,
 17199           DFHEIV99,
 17200           DFHEIV99,
 17201           DFHEIV99
 17202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17203
 17204
 17205     IF DL35-RETURN-CODE = 'OK'
 17206         GO TO 6600-EXIT.
 17207
 17208     IF DL35-RETURN-CODE = '01'
 17209         MOVE ER-7830            TO EMI-ERROR
 17210         GO TO 6500-BAD-EXIT.
 17211
 17212     IF DL35-RETURN-CODE = '02'
 17213         MOVE ER-7831            TO EMI-ERROR
 17214         GO TO 6500-BAD-EXIT.
 17215
 17216     IF DL35-RETURN-CODE = '03'
 17217         MOVE ER-7832            TO EMI-ERROR
 17218         GO TO 6500-BAD-EXIT.
 17219
 17220     IF DL35-RETURN-CODE = '04'
 17221         MOVE ER-7833            TO EMI-ERROR
 17222         GO TO 6500-BAD-EXIT.
 17223
 17224     IF DL35-RETURN-CODE = '05'
 17225         MOVE ER-7834            TO EMI-ERROR
 17226         GO TO 6500-BAD-EXIT.
 17227
 17228     IF DL35-RETURN-CODE = '06'
 17229         MOVE ER-7835            TO EMI-ERROR
 17230         GO TO 6500-BAD-EXIT.
 17231
 17232     IF DL35-RETURN-CODE = '07'
 17233         MOVE ER-7836            TO EMI-ERROR
 17234         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 332
* EL156.cbl
 17235
 17236     IF DL35-RETURN-CODE = 'E1'
 17237         MOVE ER-7837            TO EMI-ERROR
 17238         GO TO 6500-BAD-EXIT.
 17239
 17240     IF DL35-RETURN-CODE NOT = 'OK'
 17241         MOVE ER-7838            TO EMI-ERROR
 17242         GO TO 6500-BAD-EXIT.
 17243
 17244 6600-EXIT.
 17245      EXIT.
 17246
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 333
* EL156.cbl
 17248 6700-UPDATE-ACTQ.
 17249***************************************************************
 17250*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17251*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17252*    ONE ALREADY THERE.                                       *
 17253***************************************************************
 17254
 17255
 17256* EXEC CICS HANDLE CONDITION
 17257*         NOTFND(6720-BUILD-NEW-RECORD)
 17258*     END-EXEC.
 17259*    MOVE '"$I                   ! 6 #00016051' TO DFHEIV0
 17260     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17262     MOVE X'3620233030303136303531' TO DFHEIV0(25:11)
 17263     CALL 'kxdfhei1' USING DFHEIV0
 17264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17265
 17266
 17267
 17268* EXEC CICS READ
 17269*         DATASET('ELACTQ')
 17270*         RIDFLD (ELMSTR-KEY)
 17271*         SET    (ADDRESS OF ACTIVITY-QUE)
 17272*         UPDATE
 17273*     END-EXEC.
 17274     MOVE 'ELACTQ' TO DFHEIV1
 17275*    MOVE '&"S        EU         (   #00016055' TO DFHEIV0
 17276     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17277     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17278     MOVE X'2020233030303136303535' TO DFHEIV0(25:11)
 17279     CALL 'kxdfhei1' USING DFHEIV0,
 17280           DFHEIV1,
 17281           DFHEIV20,
 17282           DFHEIV99,
 17283           ELMSTR-KEY,
 17284           DFHEIV99,
 17285           DFHEIV99,
 17286           DFHEIV99
 17287     SET ADDRESS OF ACTIVITY-QUE TO
 17288         DFHEIV20
 17289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17290
 17291
 17292     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17293
 17294     IF PI-AIG-SPECIAL-BENEFIT AND
 17295        PI-CASH = 'Y'
 17296         ADD 2                   TO AQ-PAYMENT-COUNTER
 17297     ELSE
 17298         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17299
 17300     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17301         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17302
 17303     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17304
 17305     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 334
* EL156.cbl
 17306         IF WS-PMT-APPROVAL-SW = 'A'
 17307             NEXT SENTENCE
 17308         ELSE
 17309            IF PI-AIG-SPECIAL-BENEFIT AND
 17310               PI-CASH = 'Y'
 17311                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17312                                     WS-PMT-UNAPPROVED-CNT
 17313            ELSE
 17314                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17315                                     WS-PMT-UNAPPROVED-CNT
 17316     ELSE
 17317         IF PI-PMT-APPR-SW = 'Y'
 17318            IF PI-AIG-SPECIAL-BENEFIT AND
 17319               PI-CASH = 'Y'
 17320                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17321                                     WS-PMT-UNAPPROVED-CNT
 17322            ELSE
 17323                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17324                                     WS-PMT-UNAPPROVED-CNT.
 17325
 17326     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17327         MOVE ER-3536 TO EMI-ERROR
 17328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17329
 17330     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17331
 17332
 17333* EXEC CICS REWRITE
 17334*         DATASET('ELACTQ')
 17335*         FROM   (ACTIVITY-QUE)
 17336*     END-EXEC.
 17337     MOVE LENGTH OF
 17338      ACTIVITY-QUE
 17339       TO DFHEIV11
 17340     MOVE 'ELACTQ' TO DFHEIV1
 17341*    MOVE '&& L                  %   #00016102' TO DFHEIV0
 17342     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17343     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17344     MOVE X'2020233030303136313032' TO DFHEIV0(25:11)
 17345     CALL 'kxdfhei1' USING DFHEIV0,
 17346           DFHEIV1,
 17347           ACTIVITY-QUE,
 17348           DFHEIV11,
 17349           DFHEIV99
 17350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17351
 17352
 17353     GO TO 6799-EXIT.
 17354
 17355 6720-BUILD-NEW-RECORD.
 17356
 17357* EXEC CICS GETMAIN
 17358*         SET    (ADDRESS OF ACTIVITY-QUE)
 17359*         LENGTH (60)
 17360*         INITIMG(GETMAIN-SPACE)
 17361*     END-EXEC.
 17362     MOVE 60
 17363       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 335
* EL156.cbl
 17364*    MOVE ',"IL                  $   #00016110' TO DFHEIV0
 17365     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17367     MOVE X'2020233030303136313130' TO DFHEIV0(25:11)
 17368     CALL 'kxdfhei1' USING DFHEIV0,
 17369           DFHEIV20,
 17370           DFHEIV11,
 17371           GETMAIN-SPACE
 17372     SET ADDRESS OF ACTIVITY-QUE TO
 17373         DFHEIV20
 17374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17375
 17376
 17377     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17378
 17379     IF PI-AIG-SPECIAL-BENEFIT AND
 17380        PI-CASH = 'Y'
 17381         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17382     ELSE
 17383         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17384
 17385     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17386     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17387     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17388     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17389                                    AQ-FOLLOWUP-DATE.
 17390     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17391     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17392
 17393     IF PI-PMT-GRADUATED
 17394         IF WS-PMT-APPROVAL-SW = 'A'
 17395             NEXT SENTENCE
 17396         ELSE
 17397            IF PI-AIG-SPECIAL-BENEFIT AND
 17398               PI-CASH = 'Y'
 17399                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17400            ELSE
 17401                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17402     ELSE
 17403         IF PI-PMT-APPR-SW = 'Y'
 17404            IF PI-AIG-SPECIAL-BENEFIT AND
 17405               PI-CASH = 'Y'
 17406                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17407            ELSE
 17408                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17409
 17410     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17411         MOVE ER-3536 TO EMI-ERROR
 17412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17413
 17414
 17415* EXEC CICS WRITE
 17416*         DATASET('ELACTQ')
 17417*         RIDFLD (ELMSTR-KEY)
 17418*         FROM   (ACTIVITY-QUE)
 17419*     END-EXEC.
 17420     MOVE LENGTH OF
 17421      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 336
* EL156.cbl
 17422       TO DFHEIV11
 17423     MOVE 'ELACTQ' TO DFHEIV1
 17424*    MOVE '&$ L                  ''   #00016153' TO DFHEIV0
 17425     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17426     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17427     MOVE X'2020233030303136313533' TO DFHEIV0(25:11)
 17428     CALL 'kxdfhei1' USING DFHEIV0,
 17429           DFHEIV1,
 17430           ACTIVITY-QUE,
 17431           DFHEIV11,
 17432           ELMSTR-KEY,
 17433           DFHEIV99,
 17434           DFHEIV99
 17435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17436
 17437
 17438 6799-EXIT.
 17439      EXIT.
 17440
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 337
* EL156.cbl
 17442 6800-BUILD-FORM-TRAILER.
 17443
 17444
 17445* EXEC CICS GETMAIN
 17446*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17447*         LENGTH   (200)
 17448*         INITIMG  (GETMAIN-SPACE)
 17449*    END-EXEC.
 17450     MOVE 200
 17451       TO DFHEIV11
 17452*    MOVE ',"IL                  $   #00016165' TO DFHEIV0
 17453     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17454     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17455     MOVE X'2020233030303136313635' TO DFHEIV0(25:11)
 17456     CALL 'kxdfhei1' USING DFHEIV0,
 17457           DFHEIV20,
 17458           DFHEIV11,
 17459           GETMAIN-SPACE
 17460     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17461         DFHEIV20
 17462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17463
 17464
 17465     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17466
 17467     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17468     MOVE 'AT'                   TO AT-RECORD-ID.
 17469     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17470
 17471     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17472     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17473                                    AT-FORM-LAST-MAINT-DT
 17474                                    AT-FORM-SEND-ON-DT.
 17475     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17476                                    AT-FORM-LAST-UPDATED-BY.
 17477     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17478     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17479     MOVE '6'                    TO DC-OPTION-CODE.
 17480     MOVE +29                    TO DC-ELAPSED-DAYS.
 17481     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17482     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17483     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17484
 17485     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17486         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17487
 17488     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17489                                    AT-FORM-RE-SEND-DT
 17490                                    AT-EMP-FORM-ANSWERED-DT
 17491                                    AT-PHY-FORM-ANSWERED-DT
 17492                                    AT-EMP-FORM-SEND-ON-DT
 17493                                    AT-PHY-FORM-SEND-ON-DT
 17494                                    AT-FORM-PRINTED-DT
 17495                                    AT-FORM-REPRINT-DT.
 17496     MOVE '2'                    TO AT-FORM-TYPE.
 17497
 17498     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17499     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 338
* EL156.cbl
 17500
 17501     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17502         NEXT SENTENCE
 17503     ELSE
 17504         IF CL-PROG-FORM-TYPE NOT = 'S'
 17505            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17506
 17507
 17508* EXEC CICS WRITE
 17509*         DATASET  ('ELTRLR')
 17510*         FROM     (ACTIVITY-TRAILERS)
 17511*         RIDFLD   (AT-CONTROL-PRIMARY)
 17512*     END-EXEC.
 17513     MOVE LENGTH OF
 17514      ACTIVITY-TRAILERS
 17515       TO DFHEIV11
 17516     MOVE 'ELTRLR' TO DFHEIV1
 17517*    MOVE '&$ L                  ''   #00016213' TO DFHEIV0
 17518     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17520     MOVE X'2020233030303136323133' TO DFHEIV0(25:11)
 17521     CALL 'kxdfhei1' USING DFHEIV0,
 17522           DFHEIV1,
 17523           ACTIVITY-TRAILERS,
 17524           DFHEIV11,
 17525           AT-CONTROL-PRIMARY,
 17526           DFHEIV99,
 17527           DFHEIV99
 17528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17529
 17530
 17531 6899-EXIT.
 17532      EXIT.
 17533
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 339
* EL156.cbl
 17535 6900-BUILD-ARCHIVE-HEADER.
 17536
 17537     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17538     MOVE '1'                    TO CNTL-REC-TYPE.
 17539     MOVE +0                     TO CNTL-SEQ-NO.
 17540     MOVE SPACES                 TO CNTL-ACCESS.
 17541
 17542
 17543* EXEC CICS READ
 17544*         DATASET  ('ELCNTL')
 17545*         SET      (ADDRESS OF CONTROL-FILE)
 17546*         RIDFLD   (ELCNTL-KEY)
 17547*         UPDATE
 17548*    END-EXEC.
 17549     MOVE 'ELCNTL' TO DFHEIV1
 17550*    MOVE '&"S        EU         (   #00016230' TO DFHEIV0
 17551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17552     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17553     MOVE X'2020233030303136323330' TO DFHEIV0(25:11)
 17554     CALL 'kxdfhei1' USING DFHEIV0,
 17555           DFHEIV1,
 17556           DFHEIV20,
 17557           DFHEIV99,
 17558           ELCNTL-KEY,
 17559           DFHEIV99,
 17560           DFHEIV99,
 17561           DFHEIV99
 17562     SET ADDRESS OF CONTROL-FILE TO
 17563         DFHEIV20
 17564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17565
 17566
 17567     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17568     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17569
 17570
 17571* EXEC CICS REWRITE
 17572*         FROM     (CONTROL-FILE)
 17573*         DATASET  ('ELCNTL')
 17574*    END-EXEC.
 17575     MOVE LENGTH OF
 17576      CONTROL-FILE
 17577       TO DFHEIV11
 17578     MOVE 'ELCNTL' TO DFHEIV1
 17579*    MOVE '&& L                  %   #00016240' TO DFHEIV0
 17580     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17581     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17582     MOVE X'2020233030303136323430' TO DFHEIV0(25:11)
 17583     CALL 'kxdfhei1' USING DFHEIV0,
 17584           DFHEIV1,
 17585           CONTROL-FILE,
 17586           DFHEIV11,
 17587           DFHEIV99
 17588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17589
 17590
 17591
 17592* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 340
* EL156.cbl
 17593*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17594*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17595*    END-EXEC.
 17596*    MOVE '"$$%                  ! 7 #00016245' TO DFHEIV0
 17597     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17599     MOVE X'3720233030303136323435' TO DFHEIV0(25:11)
 17600     CALL 'kxdfhei1' USING DFHEIV0
 17601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17602
 17603
 17604
 17605* EXEC CICS GETMAIN
 17606*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17607*         LENGTH  (ELARCH-LENGTH)
 17608*         INITIMG (GETMAIN-SPACE)
 17609*    END-EXEC.
 17610*    MOVE ',"IL                  $   #00016250' TO DFHEIV0
 17611     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17612     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17613     MOVE X'2020233030303136323530' TO DFHEIV0(25:11)
 17614     CALL 'kxdfhei1' USING DFHEIV0,
 17615           DFHEIV20,
 17616           ELARCH-LENGTH,
 17617           GETMAIN-SPACE
 17618     SET ADDRESS OF LETTER-ARCHIVE TO
 17619         DFHEIV20
 17620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17621
 17622
 17623     MOVE 'LA'                   TO LA-RECORD-ID.
 17624     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17625                                    LA-ARCHIVE-NO-A1.
 17626     MOVE '4'                    TO LA-RECORD-TYPE
 17627                                    LA-RECORD-TYPE-A1.
 17628     MOVE +0                     TO LA-LINE-SEQ-NO
 17629                                    LA-LINE-SEQ-NO-A1.
 17630     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17631                                    LA-COMPANY-CD-A1.
 17632     MOVE CL-CARRIER             TO LA4-CARRIER.
 17633     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17634     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17635     MOVE CL-CERT-STATE          TO LA4-STATE.
 17636     MOVE +0                     TO LA4-NO-OF-COPIES.
 17637     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17638     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17639     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17640                                    LA4-INITIAL-PRINT-DATE
 17641                                    LA4-RESEND-PRINT-DATE
 17642                                    LA4-FORM-REM-PRINT-DT.
 17643     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17644     MOVE '2'                    TO LA4-FORM-TYPE.
 17645
 17646
 17647* EXEC CICS WRITE
 17648*         DATASET  ('ELARCH')
 17649*         FROM     (LETTER-ARCHIVE)
 17650*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 341
* EL156.cbl
 17651*    END-EXEC.
 17652     MOVE LENGTH OF
 17653      LETTER-ARCHIVE
 17654       TO DFHEIV11
 17655     MOVE 'ELARCH' TO DFHEIV1
 17656*    MOVE '&$ L                  ''   #00016279' TO DFHEIV0
 17657     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17659     MOVE X'2020233030303136323739' TO DFHEIV0(25:11)
 17660     CALL 'kxdfhei1' USING DFHEIV0,
 17661           DFHEIV1,
 17662           LETTER-ARCHIVE,
 17663           DFHEIV11,
 17664           LA-CONTROL-PRIMARY,
 17665           DFHEIV99,
 17666           DFHEIV99
 17667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17668
 17669
 17670 6999-EXIT.
 17671      EXIT.
 17672
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 342
* EL156.cbl
 17674 7000-SHOW-CLAIM.
 17675     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17676     MOVE 'A'                    TO PI-PASS-SW.
 17677     MOVE LOW-VALUES             TO PI-CPYFROM
 17678                                    PI-MONTH-END-SAVE
 17679                                    PI-CPYTHRU.
 17680
 17681     MOVE ZEROS                  TO PI-FATAL-COUNT
 17682                                    PI-DAILY-RATE
 17683                                    PI-BEN-DAYS
 17684                                    PI-MANUAL-SW
 17685                                    PI-SAVE-CURSOR
 17686                                    PI-FORCE-COUNT
 17687                                    PI-HOLDTIL
 17688                                    PI-EPYFROM
 17689                                    PI-EPYTHRU
 17690                                    PI-EDAYS
 17691                                    PI-EPYAMT
 17692                                    PI-ERESV
 17693                                    PI-EEXPENS
 17694                                    PI-CDAYS
 17695                                    PI-CPYAMT
 17696                                    PI-CRESV
 17697                                    PI-CEXPENS
 17698                                    PI-INT-RATE
 17699                                    PI-AIGFROM.
 17700     MOVE ZEROS                  TO PI-PROOF-DATE.
 17701     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17702                                    PI-REM-BEN-AMT
 17703                                    PI-MO-BEN-AMT
 17704                                    pi-ah-term.
 17705
 17706     MOVE LOW-VALUES             TO EL156AI.
 17707     MOVE MAP-NAMEA              TO MAP-NAME.
 17708
 17709* EXEC CICS HANDLE CONDITION
 17710*        NOTFND   (7010-BUILD-MAP)
 17711*    END-EXEC.
 17712*    MOVE '"$I                   ! 8 #00016323' TO DFHEIV0
 17713     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17715     MOVE X'3820233030303136333233' TO DFHEIV0(25:11)
 17716     CALL 'kxdfhei1' USING DFHEIV0
 17717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17718
 17719
 17720     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17721     MOVE '2'                    TO CNTL-REC-TYPE.
 17722     MOVE +0                     TO CNTL-SEQ-NO.
 17723     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17724
 17725
 17726* EXEC CICS READ
 17727*         DATASET  ('ELCNTL')
 17728*         SET      (ADDRESS OF CONTROL-FILE)
 17729*         RIDFLD   (ELCNTL-KEY)
 17730*    END-EXEC.
 17731     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 343
* EL156.cbl
 17732*    MOVE '&"S        E          (   #00016332' TO DFHEIV0
 17733     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17735     MOVE X'2020233030303136333332' TO DFHEIV0(25:11)
 17736     CALL 'kxdfhei1' USING DFHEIV0,
 17737           DFHEIV1,
 17738           DFHEIV20,
 17739           DFHEIV99,
 17740           ELCNTL-KEY,
 17741           DFHEIV99,
 17742           DFHEIV99,
 17743           DFHEIV99
 17744     SET ADDRESS OF CONTROL-FILE TO
 17745         DFHEIV20
 17746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17747
 17748
 17749     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17750
 17751     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17752         MOVE AL-UANON      TO SURVYYNA
 17753     END-IF.
 17754
 17755
 17756     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17757     MOVE '1'                    TO CNTL-REC-TYPE.
 17758     MOVE SPACES                 TO CNTL-ACCESS.
 17759     MOVE +0                     TO CNTL-SEQ-NO.
 17760
 17761
 17762* EXEC CICS READ
 17763*         DATASET  ('ELCNTL')
 17764*         SET      (ADDRESS OF CONTROL-FILE)
 17765*         RIDFLD   (ELCNTL-KEY)
 17766*    END-EXEC.
 17767     MOVE 'ELCNTL' TO DFHEIV1
 17768*    MOVE '&"S        E          (   #00016350' TO DFHEIV0
 17769     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17771     MOVE X'2020233030303136333530' TO DFHEIV0(25:11)
 17772     CALL 'kxdfhei1' USING DFHEIV0,
 17773           DFHEIV1,
 17774           DFHEIV20,
 17775           DFHEIV99,
 17776           ELCNTL-KEY,
 17777           DFHEIV99,
 17778           DFHEIV99,
 17779           DFHEIV99
 17780     SET ADDRESS OF CONTROL-FILE TO
 17781         DFHEIV20
 17782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17783
 17784
 17785     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17786
 17787 7010-BUILD-MAP.
 17788
 17789
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 344
* EL156.cbl
 17790* EXEC CICS HANDLE CONDITION
 17791*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17792*    END-EXEC.
 17793*    MOVE '"$I                   ! 9 #00016360' TO DFHEIV0
 17794     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17796     MOVE X'3920233030303136333630' TO DFHEIV0(25:11)
 17797     CALL 'kxdfhei1' USING DFHEIV0
 17798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17799
 17800
 17801     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17802     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17803     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17804     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17805     MOVE 'MSTR'                 TO FILE-SWITCH.
 17806
 17807     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17808
 17809     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17810     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17811     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17812     MOVE CL-CCN                 TO PI-SV-CCN.
 17813
 17814     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17815     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17816     MOVE CL-CLAIM-NO            TO CLMNOO.
 17817     MOVE CL-CARRIER             TO CARRO.
 17818     MOVE CL-CERT-PRIME          TO CERTNOO.
 17819     MOVE CL-CERT-SFX            TO SUFXO.
 17820
 17821     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17822        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 17823        CONTINUE
 17824     ELSE
 17825        MOVE AL-SADOF            TO ZINTHA
 17826                                    ZINTA
 17827                                    PINTHA
 17828                                    PINTA
 17829     END-IF
 17830     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17831     EVALUATE TRUE
 17832     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17833         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17834     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17835         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17836
 17837     WHEN CL-CLAIM-TYPE = 'I'
 17838         MOVE '  IU  '           TO CLMTYPO
 17839     WHEN CL-CLAIM-TYPE = 'G'
 17840         MOVE ' GAP  '           TO CLMTYPO
 17841     WHEN CL-CLAIM-TYPE = 'F'
 17842         MOVE ' FMLA '           TO CLMTYPO
 17843     WHEN CL-CLAIM-TYPE = 'O'
 17844         MOVE ' OTH '           TO CLMTYPO
 17845     END-EVALUATE.
 17846     IF CL-CLAIM-TYPE = 'O'
 17847        MOVE 'S' TO EOBYNO
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 345
* EL156.cbl
 17848                    PI-PRINT-EOB-YN
 17849                    WS-PRINT-EOB-YN
 17850     END-IF
 17851     IF CLAIM-IS-OPEN
 17852         MOVE ' OPEN'            TO CLMSTATO
 17853     ELSE
 17854         MOVE 'CLOSED'           TO CLMSTATO.
 17855
 17856     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17857
 17858     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17859         MOVE SPACES             TO  PCERTNOO
 17860                                     PSUFXO
 17861                                     PRIMHDGO
 17862                                     SEQUO
 17863         MOVE AL-SADOF           TO  PCERTNOA
 17864                                     PSUFXA
 17865                                     PRIMHDGA
 17866                                     SEQUA
 17867     ELSE
 17868         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17869         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17870         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17871         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17872         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17873         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17874         MOVE AL-SANON               TO  PCERTNOA
 17875                                         PSUFXA
 17876                                         PRIMHDGA
 17877         MOVE AL-SABON               TO  SEQUA.
 17878
 17879     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17880
 17881     IF CL-NO-OF-PMTS-MADE = 0 AND
 17882        CL-TOTAL-PAID-AMT = 0
 17883         NEXT SENTENCE
 17884     ELSE
 17885         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17886             IF NOT PI-USES-PAID-TO
 17887                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17888                 MOVE ' '                 TO DC-OPTION-CODE
 17889                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17890                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17891             ELSE
 17892                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17893                 MOVE '6'                 TO DC-OPTION-CODE
 17894                 MOVE +1                  TO DC-ELAPSED-DAYS
 17895                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17896                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17897                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17898
 17899     IF MAP-NAME = 'EL156A'
 17900        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17901           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17902             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17903           end-if
 17904        end-if
 17905     end-if
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 346
* EL156.cbl
 17906     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17907         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17908         MOVE ' '                TO DC-OPTION-CODE
 17909         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17910         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17911
 17912     IF CL-INCURRED-DT NOT = LOW-VALUES
 17913         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17914         MOVE ' '                TO DC-OPTION-CODE
 17915         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17916         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17917
 17918     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17919
 17920     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17921         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17922         MOVE ' '                TO DC-OPTION-CODE
 17923         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17924         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17925
 17926     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17927         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17928         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17929     ELSE
 17930         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17931         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17932
 17933     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17934     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17935     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17936     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17937                                    PI-GROUPING.
 17938     MOVE CL-CERT-STATE          TO CERT-STATE
 17939                                    PI-STATE.
 17940     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17941                                    PI-ACCOUNT.
 17942     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17943     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17944     MOVE 'CERT'                 TO FILE-SWITCH.
 17945
 17946     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17947     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17948        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17949        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17950            MOVE 'N' TO PI-JOINT-INSURED-IND
 17951     ELSE
 17952            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17953     END-IF.
 17954
 17955     perform 7975-read-acct      thru 7975-exit
 17956     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17957     MOVE PI-STATE               TO WS-ST-ACCESS.
 17958     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17959     MOVE '3'                    TO CNTL-REC-TYPE.
 17960     MOVE +0                     TO CNTL-SEQ-NO.
 17961     MOVE 'STAT'                 TO FILE-SWITCH.
 17962
 17963     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 347
* EL156.cbl
 17964
 17965     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17966     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17967
 17968     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17969        GO TO 7020-BYPASS-BENEFIT.
 17970
 17971     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17972     MOVE '4'                    TO CNTL-REC-TYPE.
 17973     MOVE +0                     TO CNTL-SEQ-NO.
 17974     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17975     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17976     MOVE 'BENE'                 TO FILE-SWITCH.
 17977
 17978     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17979
 17980     IF NO-BENEFIT-FOUND
 17981        GO TO 7020-BYPASS-BENEFIT.
 17982
 17983     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17984     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17985     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17986
 17987 7020-BYPASS-BENEFIT.
 17988
 17989*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17990*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17991*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17992
 17993     move zeros                  to PI-MAX-BENEFIT-AMT
 17994     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17995     move cm-ah-orig-term        to pi-ah-term
 17996     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17997     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17998          'G' and 'F'
 17999         GO TO 7021-GO-TO-LIFE.
 18000
 18001     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18002        and (acct-found)
 18003        AND (PI-DCC-PRODUCT-CODE not = '   ')
 18004        PERFORM 0900-GET-DDF-limits
 18005                                 THRU 0900-EXIT
 18006        IF PDEF-FOUND
 18007           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18008              (P1 > +8)
 18009              OR (PD-PROD-CODE (P1) = cl-claim-type)
 18010           END-PERFORM
 18011           IF P1 < +9
 18012              if pd-ben-pct (p1) not numeric
 18013                 move zeros      to pd-ben-pct (p1)
 18014              end-if
 18015              if pd-ben-pct (p1) = zeros
 18016                 move +1         to ws-work-ben-pct
 18017              else
 18018                 move pd-ben-pct (p1)
 18019                                 to ws-work-ben-pct
 18020              end-if
 18021              compute cm-ah-benefit-amt =
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 348
* EL156.cbl
 18022                 cm-ah-benefit-amt * ws-work-ben-pct
 18023              move pd-max-amt (p1) to pi-max-benefit-amt
 18024           END-IF
 18025        END-IF
 18026     end-if
 18027     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 18028     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 18029     if (pi-max-benefit-amt not = zeros)
 18030        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 18031        move pi-max-benefit-amt  to beneo
 18032     else
 18033        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 18034     end-if
 18035     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18036     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 18037                                    CP-ORIGINAL-TERM.
 18038     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 18039
 18040*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18041*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18042*    ELSE
 18043         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18044
 18045     MOVE ' '                    TO DC-OPTION-CODE.
 18046     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18047     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18048
 18049     IF PI-COMPANY-ID = 'DMD'
 18050         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 18051         GO TO 7023-BYPASS-REMAINING-TERM.
 18052
 18053     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18054     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 18055     GO TO 7022-AROUND-LIFE.
 18056
 18057 7021-GO-TO-LIFE.
 18058
 18059     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 18060     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18061     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 18062                                    CP-ORIGINAL-TERM.
 18063     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 18064     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 18065     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 18066     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 18067
 18068     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18069         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18070     ELSE
 18071         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18072
 18073     MOVE ' '                    TO DC-OPTION-CODE.
 18074     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18075     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18076
 18077 7022-AROUND-LIFE.
 18078
 18079     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 349
* EL156.cbl
 18080     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 18081     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 18082     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 18083     MOVE '4'                    TO CP-REM-TERM-METHOD.
 18084     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 18085     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 18086
 18087     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18088
 18089     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18090        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 18091           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 18092
 18093     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18094        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 18095           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 18096
 18097 7023-BYPASS-REMAINING-TERM.
 18098     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18099       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 18100          MOVE ZEROS                  TO BENEO
 18101       ELSE
 18102          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 18103          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 18104          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 18105          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 18106          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 18107          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 18108          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 18109          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 18110          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 18111          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 18112          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 18113          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 18114          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18115             AND (PI-DCC-PRODUCT-CODE not = '   ')
 18116             PERFORM 0900-GET-DDF-limits
 18117                                 THRU 0900-EXIT
 18118             IF PDEF-FOUND
 18119                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18120                   (P1 > +8)
 18121                   OR (PD-PROD-CODE (P1) = 'L')
 18122                END-PERFORM
 18123                IF P1 < +9
 18124                   MOVE PD-MAX-AMT (P1)
 18125                                 TO CP-R-MAX-TOT-BEN
 18126                END-IF
 18127             END-IF
 18128          END-IF
 18129
 18130* EXEC CICS LINK
 18131*            PROGRAM  (LINK-REMAMT)
 18132*            COMMAREA (CALCULATION-PASS-AREA)
 18133*            LENGTH   (CP-COMM-LENGTH)
 18134*         END-EXEC
 18135*    MOVE '."C                   (   #00016692' TO DFHEIV0
 18136     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 350
* EL156.cbl
 18138     MOVE X'2020233030303136363932' TO DFHEIV0(25:11)
 18139     CALL 'kxdfhei1' USING DFHEIV0,
 18140           LINK-REMAMT,
 18141           CALCULATION-PASS-AREA,
 18142           CP-COMM-LENGTH,
 18143           DFHEIV99,
 18144           DFHEIV99,
 18145           DFHEIV99,
 18146           DFHEIV99
 18147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18148          MOVE CP-REMAINING-AMT       TO BENEO
 18149       end-if
 18150     end-if
 18151     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18152     MOVE +95                    TO TRLR-SEQ-NO
 18153
 18154* EXEC CICS READ
 18155*       DATASET  ('ELTRLR')
 18156*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18157*       RIDFLD   (ELTRLR-KEY)
 18158*       RESP     (WS-RESPONSE)
 18159*    END-EXEC
 18160     MOVE 'ELTRLR' TO DFHEIV1
 18161*    MOVE '&"S        E          (  N#00016702' TO DFHEIV0
 18162     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18164     MOVE X'204E233030303136373032' TO DFHEIV0(25:11)
 18165     CALL 'kxdfhei1' USING DFHEIV0,
 18166           DFHEIV1,
 18167           DFHEIV20,
 18168           DFHEIV99,
 18169           ELTRLR-KEY,
 18170           DFHEIV99,
 18171           DFHEIV99,
 18172           DFHEIV99
 18173     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18174         DFHEIV20
 18175     MOVE EIBRESP  TO WS-RESPONSE
 18176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18177
 18178     if ws-resp-normal
 18179        perform varying s1 from +1 by +1 until
 18180           at-note-error-no (s1) = spaces
 18181           move at-note-error-no (s1)
 18182                                 to emi-error
 18183           if at-note-error-no (s1) = '1653'
 18184              evaluate true
 18185                 when cl-claim-type = 'L'
 18186                    move '  LF  '
 18187                                 to emi-claim-type
 18188                 when cl-claim-type = 'I'
 18189                    move '  IU  '
 18190                                 to emi-claim-type
 18191                 when cl-claim-type = 'F'
 18192                    move ' FMLA '
 18193                                 to emi-claim-type
 18194                 when cl-claim-type = 'O'
 18195                    move ' OTH '
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 351
* EL156.cbl
 18196                                 to emi-claim-type
 18197                 when other
 18198                    move '  AH  '
 18199                                 to emi-claim-type
 18200              end-evaluate
 18201           end-if
 18202           PERFORM 9900-ERROR-FORMAT
 18203                                 THRU 9900-EXIT
 18204        end-perform
 18205     end-if
 18206    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18207         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18208            WS-LF-COVERAGE-TYPE = 'P'
 18209             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18210                                        CM-LF-ITD-DEATH-AMT
 18211             MOVE WS-REMAINING-AMT  TO  BENEO.
 18212
 18213     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18214     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18215     MOVE WS-TERMS               TO TERMSO.
 18216
 18217     IF WS-STATUS = '6' OR '7' OR '8'
 18218         MOVE AL-SABOF           TO CRTSTATA.
 18219
 18220     IF WS-STATUS = '1' OR '4'
 18221        IF CP-REMAINING-TERM-3 = ZEROS
 18222           MOVE 'EXPIRED'        TO CRTSTATO
 18223        ELSE
 18224           MOVE 'ACTIVE  '       TO CRTSTATO.
 18225
 18226     IF WS-STATUS = '2'
 18227         MOVE 'PEND    '         TO CRTSTATO.
 18228
 18229     IF WS-STATUS = '3'
 18230         MOVE 'RESTORE '         TO CRTSTATO.
 18231
 18232     IF WS-STATUS = '5'
 18233         MOVE 'REISSUE '         TO CRTSTATO.
 18234
 18235     IF WS-STATUS = '6'
 18236         MOVE 'LMP DIS'          TO CRTSTATO.
 18237
 18238     IF WS-STATUS = '7'
 18239         MOVE 'DEATH'            TO CRTSTATO.
 18240
 18241     IF WS-STATUS = '8'
 18242         MOVE 'CANCEL'           TO CRTSTATO.
 18243
 18244     IF WS-STATUS = '9'
 18245         MOVE 'RE-ONLY '         TO CRTSTATO.
 18246
 18247     IF WS-STATUS = 'V'
 18248         MOVE 'VOID  '           TO CRTSTATO.
 18249
 18250     IF WS-STATUS = 'D'
 18251         MOVE 'DECLINE '         TO CRTSTATO.
 18252
 18253     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 352
* EL156.cbl
 18254         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18255         MOVE '5'                TO CNTL-REC-TYPE
 18256     ELSE
 18257         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18258         MOVE '4'                TO CNTL-REC-TYPE.
 18259
 18260     MOVE '** NONE **'           TO COVERO.
 18261     MOVE AL-SABON               TO COVERA.
 18262
 18263     IF PI-COMPANY-ID = 'CVL'
 18264         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18265             MOVE CM-BENEFICIARY TO LOANNOO
 18266             MOVE AL-UANON       TO LOANNOA.
 18267
 18268     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18269        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18270        MOVE +91                 TO  TRLR-SEQ-NO
 18271
 18272* EXEC CICS READ
 18273*           DATASET  ('ELTRLR')
 18274*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18275*           RIDFLD   (ELTRLR-KEY)
 18276*           RESP     (WS-RESPONSE)
 18277*       END-EXEC
 18278     MOVE 'ELTRLR' TO DFHEIV1
 18279*    MOVE '&"S        E          (  N#00016802' TO DFHEIV0
 18280     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18282     MOVE X'204E233030303136383032' TO DFHEIV0(25:11)
 18283     CALL 'kxdfhei1' USING DFHEIV0,
 18284           DFHEIV1,
 18285           DFHEIV20,
 18286           DFHEIV99,
 18287           ELTRLR-KEY,
 18288           DFHEIV99,
 18289           DFHEIV99,
 18290           DFHEIV99
 18291     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18292         DFHEIV20
 18293     MOVE EIBRESP  TO WS-RESPONSE
 18294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18295
 18296        IF WS-RESP-NORMAL
 18297           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18298        ELSE
 18299           MOVE SPACES           TO  LOANNOO
 18300        END-IF
 18301*052506
 18302*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18303*052506
 18304     END-IF
 18305
 18306     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18307        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18308
 18309     IF WS-BEN-CD = ZEROS
 18310         GO TO 7050-SHOW-CONTINUE.
 18311
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 353
* EL156.cbl
 18312     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18313     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18314     MOVE +0                     TO CNTL-SEQ-NO.
 18315     MOVE 'BENE'                 TO FILE-SWITCH.
 18316
 18317     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18318     IF BENEFIT-FOUND
 18319        MOVE CF-JOINT-INDICATOR (SUB-1)
 18320                                 TO PI-JOINT-COV-IND
 18321                                    PI-RB-JOINT-COV-IND
 18322        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18323                                 TO COVERO
 18324        MOVE AL-SANON            TO COVERA
 18325     END-IF
 18326     if (cntl-rec-type = '4')   *> Life claim
 18327        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18328        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18329        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18330        MOVE '5'              TO CNTL-REC-TYPE
 18331        MOVE WS-ACCESS        TO CNTL-ACCESS
 18332        MOVE +0               TO CNTL-SEQ-NO
 18333        MOVE 'BENE'           TO FILE-SWITCH
 18334        PERFORM 7200-FIND-BENEFIT
 18335                              THRU 7200-EXIT
 18336        IF (BENEFIT-FOUND)
 18337           and (pi-rb-joint-cov-ind) not = 'J'
 18338           MOVE CF-JOINT-INDICATOR (SUB-1)
 18339                              TO PI-rb-JOINT-COV-IND
 18340        end-if
 18341     end-if
 18342     .
 18343 7050-SHOW-CONTINUE.
 18344
 18345     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18346        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18347            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18348     END-IF
 18349
 18350     IF PI-COMPANY-ID = 'DMD'
 18351         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18352
 18353     MOVE -1                     TO PMTTYPEL.
 18354     GO TO 8100-SEND-INITIAL-MAP.
 18355
 18356 7100-SHOW-RECORD-NOT-FOUND.
 18357     IF FILE-SWITCH = 'MSTR'
 18358         MOVE ER-0204            TO EMI-ERROR.
 18359
 18360     IF FILE-SWITCH = 'CERT'
 18361         MOVE ER-0206            TO EMI-ERROR.
 18362
 18363     IF FILE-SWITCH = 'STAT'
 18364         MOVE ER-0149            TO EMI-ERROR.
 18365
 18366     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18367
 18368     MOVE -1                     TO PMTTYPEL.
 18369     GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 354
* EL156.cbl
 18370
 18371     .
 18372 7110-BUILD-PMT-TRLR.
 18373     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18374     MOVE +51                    TO TRLR-SEQ-NO
 18375
 18376* EXEC CICS READ
 18377*        DATASET  ('ELTRLR')
 18378*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18379*        RIDFLD   (ELTRLR-KEY)
 18380*        RESP     (WS-RESPONSE)
 18381*    END-EXEC
 18382     MOVE 'ELTRLR' TO DFHEIV1
 18383*    MOVE '&"S        E          (  N#00016888' TO DFHEIV0
 18384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18386     MOVE X'204E233030303136383838' TO DFHEIV0(25:11)
 18387     CALL 'kxdfhei1' USING DFHEIV0,
 18388           DFHEIV1,
 18389           DFHEIV20,
 18390           DFHEIV99,
 18391           ELTRLR-KEY,
 18392           DFHEIV99,
 18393           DFHEIV99,
 18394           DFHEIV99
 18395     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18396         DFHEIV20
 18397     MOVE EIBRESP  TO WS-RESPONSE
 18398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18399     IF WS-RESP-NORMAL
 18400        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18401     END-IF
 18402     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18403
 18404* EXEC CICS GETMAIN
 18405*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18406*         LENGTH    (200)
 18407*         INITIMG   (GETMAIN-SPACE)
 18408*     END-EXEC
 18409     MOVE 200
 18410       TO DFHEIV11
 18411*    MOVE ',"IL                  $   #00016898' TO DFHEIV0
 18412     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18414     MOVE X'2020233030303136383938' TO DFHEIV0(25:11)
 18415     CALL 'kxdfhei1' USING DFHEIV0,
 18416           DFHEIV20,
 18417           DFHEIV11,
 18418           GETMAIN-SPACE
 18419     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18420         DFHEIV20
 18421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18422     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18423                                    AT-PREV-PAID-THRU-DT
 18424     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18425     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18426     MOVE 'AT'                   TO AT-RECORD-ID
 18427     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 355
* EL156.cbl
 18428     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18429     MOVE '2'                    TO AT-TRAILER-TYPE
 18430     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18431                                    AT-PAYMENT-LAST-MAINT-DT
 18432     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18433                                    AT-PAYMENT-LAST-UPDATED-BY
 18434     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18435     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18436     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18437     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 18438     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18439     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18440     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18441     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18442     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18443     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18444     if pi-int-to-rem-borr = 'Y'
 18445        move 'Q1'                to at-payee-type-cd
 18446     else
 18447        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18448     end-if
 18449     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18450     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18451     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18452     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18453     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18454                                    AT-TO-BE-WRITTEN-DT
 18455     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18456                                    AT-CHECK-QUE-SEQUENCE
 18457                                    AT-ADDL-RESERVE
 18458     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18459                                    AT-VOID-SELECT-DT
 18460                                    AT-VOID-ACCEPT-DT
 18461                                    AT-VOID-DT
 18462                                    AT-PMT-PROOF-DT
 18463                                    AT-INT-PMT-SELECT-DT
 18464     MOVE ZEROS                  TO AT-DAILY-RATE
 18465                                    AT-ELIMINATION-DAYS
 18466     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18467*    EXEC CICS HANDLE CONDITION
 18468*        DUPREC    (7120-DUPREC)
 18469*    END-EXEC
 18470     .
 18471 7115-WRITE-INT-TRLR.
 18472
 18473* EXEC CICS WRITE
 18474*         DATASET       ('ELTRLR')
 18475*         FROM          (ACTIVITY-TRAILERS)
 18476*         RIDFLD        (AT-CONTROL-PRIMARY)
 18477*         RESP          (WS-RESPONSE)
 18478*     END-EXEC
 18479     MOVE LENGTH OF
 18480      ACTIVITY-TRAILERS
 18481       TO DFHEIV11
 18482     MOVE 'ELTRLR' TO DFHEIV1
 18483*    MOVE '&$ L                  ''  N#00016953' TO DFHEIV0
 18484     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18485     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 356
* EL156.cbl
 18486     MOVE X'204E233030303136393533' TO DFHEIV0(25:11)
 18487     CALL 'kxdfhei1' USING DFHEIV0,
 18488           DFHEIV1,
 18489           ACTIVITY-TRAILERS,
 18490           DFHEIV11,
 18491           AT-CONTROL-PRIMARY,
 18492           DFHEIV99,
 18493           DFHEIV99
 18494     MOVE EIBRESP  TO WS-RESPONSE
 18495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18496      IF WS-RESP-DUPREC
 18497         GO TO 7120-DUPREC
 18498      END-IF
 18499     GO TO 7130-EXIT
 18500     .
 18501 7120-DUPREC.
 18502     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18503     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18504     GO TO 7115-WRITE-INT-TRLR
 18505     .
 18506 7130-EXIT.
 18507      EXIT.
 18508 7140-BUILD-NOTE-TRLR.
 18509
 18510
 18511* EXEC CICS GETMAIN
 18512*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18513*         LENGTH    (200)
 18514*         INITIMG   (GETMAIN-SPACE)
 18515*     END-EXEC
 18516     MOVE 200
 18517       TO DFHEIV11
 18518*    MOVE ',"IL                  $   #00016973' TO DFHEIV0
 18519     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18520     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18521     MOVE X'2020233030303136393733' TO DFHEIV0(25:11)
 18522     CALL 'kxdfhei1' USING DFHEIV0,
 18523           DFHEIV20,
 18524           DFHEIV11,
 18525           GETMAIN-SPACE
 18526     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18527         DFHEIV20
 18528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18529     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18530     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18531     MOVE 'AT'                   TO AT-RECORD-ID
 18532     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18533     MOVE '6'                    TO AT-TRAILER-TYPE
 18534     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18535                                    AT-GEN-INFO-LAST-MAINT-DT
 18536     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18537                                    AT-GEN-INFO-LAST-UPDATED-BY
 18538     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18539     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18540     .
 18541 7150-WRITE.
 18542
 18543* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 357
* EL156.cbl
 18544*        DUPREC    (7160-DUPREC)
 18545*    END-EXEC
 18546*    MOVE '"$%                   ! : #00016991' TO DFHEIV0
 18547     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18549     MOVE X'3A20233030303136393931' TO DFHEIV0(25:11)
 18550     CALL 'kxdfhei1' USING DFHEIV0
 18551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18552
 18553* EXEC CICS WRITE
 18554*         DATASET     ('ELTRLR')
 18555*         FROM        (ACTIVITY-TRAILERS)
 18556*         RIDFLD      (AT-CONTROL-PRIMARY)
 18557*         RESP        (WS-RESPONSE)
 18558*     END-EXEC
 18559     MOVE LENGTH OF
 18560      ACTIVITY-TRAILERS
 18561       TO DFHEIV11
 18562     MOVE 'ELTRLR' TO DFHEIV1
 18563*    MOVE '&$ L                  ''  N#00016994' TO DFHEIV0
 18564     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18565     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18566     MOVE X'204E233030303136393934' TO DFHEIV0(25:11)
 18567     CALL 'kxdfhei1' USING DFHEIV0,
 18568           DFHEIV1,
 18569           ACTIVITY-TRAILERS,
 18570           DFHEIV11,
 18571           AT-CONTROL-PRIMARY,
 18572           DFHEIV99,
 18573           DFHEIV99
 18574     MOVE EIBRESP  TO WS-RESPONSE
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18576      IF WS-RESP-DUPREC
 18577         GO TO 7160-DUPREC
 18578      END-IF
 18579     GO TO 7170-EXIT
 18580     .
 18581 7160-DUPREC.
 18582     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18583     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18584     GO TO 7150-WRITE
 18585     .
 18586 7170-EXIT.
 18587      EXIT.
 18588
 18589 7180-ADD-CERT-NOTE.
 18590*ADD CERT NOTE FOR SC NP+6
 18591
 18592
 18593* EXEC CICS GETMAIN
 18594*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18595*         LENGTH    (150)
 18596*         INITIMG   (GETMAIN-SPACE)
 18597*     END-EXEC.
 18598     MOVE 150
 18599       TO DFHEIV11
 18600*    MOVE ',"IL                  $   #00017016' TO DFHEIV0
 18601     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 358
* EL156.cbl
 18602     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18603     MOVE X'2020233030303137303136' TO DFHEIV0(25:11)
 18604     CALL 'kxdfhei1' USING DFHEIV0,
 18605           DFHEIV20,
 18606           DFHEIV11,
 18607           GETMAIN-SPACE
 18608     SET ADDRESS OF CERT-NOTE-FILE TO
 18609         DFHEIV20
 18610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18611
 18612
 18613     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18614     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18615     MOVE +1                     TO WRK-NOTE-SEQ.
 18616     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18617     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18618     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18619     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18620     MOVE CL-CERT-STATE          TO CZ-STATE.
 18621     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18622     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18623     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18624     MOVE '2'                    TO CZ-RECORD-TYPE.
 18625     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18626     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18627     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18628     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18629     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18630     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18631     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18632     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18633     IF PI-COMPANY-ID = 'AHL'
 18634        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18635           CONTINUE
 18636        ELSE
 18637           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18638              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18639           ELSE
 18640              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18641           END-IF
 18642        END-IF
 18643     END-IF
 18644     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18645     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18646
 18647 7181-WRITE.
 18648
 18649
 18650* EXEC CICS WRITE
 18651*         DATASET     ('ERCNOT')
 18652*         FROM        (CERT-NOTE-FILE)
 18653*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18654*         RESP        (WS-RESPONSE)
 18655*    END-EXEC.
 18656     MOVE LENGTH OF
 18657      CERT-NOTE-FILE
 18658       TO DFHEIV11
 18659     MOVE 'ERCNOT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 359
* EL156.cbl
 18660*    MOVE '&$ L                  ''  N#00017058' TO DFHEIV0
 18661     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18662     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18663     MOVE X'204E233030303137303538' TO DFHEIV0(25:11)
 18664     CALL 'kxdfhei1' USING DFHEIV0,
 18665           DFHEIV1,
 18666           CERT-NOTE-FILE,
 18667           DFHEIV11,
 18668           CZ-CONTROL-PRIMARY,
 18669           DFHEIV99,
 18670           DFHEIV99
 18671     MOVE EIBRESP  TO WS-RESPONSE
 18672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18673
 18674
 18675     IF WS-RESP-DUPREC
 18676         GO TO 7182-DUPREC
 18677     END-IF.
 18678
 18679     SET CERT-NOTE-ADDED TO TRUE.
 18680
 18681     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18682         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18683     END-IF.
 18684
 18685     GO TO 7189-EXIT.
 18686
 18687 7182-DUPREC.
 18688
 18689     ADD +1                      TO  WRK-NOTE-SEQ.
 18690     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18691     GO TO 7181-WRITE.
 18692
 18693 7189-EXIT.
 18694      EXIT.
 18695
 18696 7190-ADD-ORIG-NOTE.
 18697
 18698
 18699* EXEC CICS GETMAIN
 18700*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18701*         LENGTH    (150)
 18702*         INITIMG   (GETMAIN-SPACE)
 18703*     END-EXEC.
 18704     MOVE 150
 18705       TO DFHEIV11
 18706*    MOVE ',"IL                  $   #00017088' TO DFHEIV0
 18707     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18708     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18709     MOVE X'2020233030303137303838' TO DFHEIV0(25:11)
 18710     CALL 'kxdfhei1' USING DFHEIV0,
 18711           DFHEIV20,
 18712           DFHEIV11,
 18713           GETMAIN-SPACE
 18714     SET ADDRESS OF CERT-NOTE-FILE TO
 18715         DFHEIV20
 18716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18717
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 360
* EL156.cbl
 18718
 18719     ADD +1                      TO WRK-NOTE-SEQ.
 18720     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18721     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18722     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18723     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18724     MOVE CL-CERT-STATE          TO CZ-STATE.
 18725     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18726     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18727     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18728     MOVE '2'                    TO CZ-RECORD-TYPE.
 18729     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18730     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18731     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18732     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18733     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18734     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18735
 18736 7191-WRITE.
 18737
 18738
 18739* EXEC CICS WRITE
 18740*         DATASET     ('ERCNOT')
 18741*         FROM        (CERT-NOTE-FILE)
 18742*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18743*         RESP        (WS-RESPONSE)
 18744*    END-EXEC.
 18745     MOVE LENGTH OF
 18746      CERT-NOTE-FILE
 18747       TO DFHEIV11
 18748     MOVE 'ERCNOT' TO DFHEIV1
 18749*    MOVE '&$ L                  ''  N#00017113' TO DFHEIV0
 18750     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18751     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18752     MOVE X'204E233030303137313133' TO DFHEIV0(25:11)
 18753     CALL 'kxdfhei1' USING DFHEIV0,
 18754           DFHEIV1,
 18755           CERT-NOTE-FILE,
 18756           DFHEIV11,
 18757           CZ-CONTROL-PRIMARY,
 18758           DFHEIV99,
 18759           DFHEIV99
 18760     MOVE EIBRESP  TO WS-RESPONSE
 18761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18762
 18763
 18764     IF WS-RESP-DUPREC
 18765         GO TO 7192-DUPREC
 18766     END-IF.
 18767
 18768     GO TO 7199-EXIT.
 18769
 18770 7192-DUPREC.
 18771
 18772     ADD +1                      TO  WRK-NOTE-SEQ.
 18773     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18774     GO TO 7191-WRITE.
 18775
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 361
* EL156.cbl
 18776 7199-EXIT.
 18777      EXIT.
 18778 7200-FIND-BENEFIT.
 18779     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18780
 18781
 18782* EXEC CICS HANDLE CONDITION
 18783*        ENDFILE(7200-EXIT)
 18784*        NOTFND(7200-EXIT)
 18785*    END-EXEC.
 18786*    MOVE '"$''I                  ! ; #00017137' TO DFHEIV0
 18787     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18789     MOVE X'3B20233030303137313337' TO DFHEIV0(25:11)
 18790     CALL 'kxdfhei1' USING DFHEIV0
 18791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18792
 18793
 18794
 18795* EXEC CICS READ
 18796*        DATASET('ELCNTL')
 18797*        SET(ADDRESS OF CONTROL-FILE)
 18798*        RIDFLD(ELCNTL-KEY)
 18799*        GTEQ
 18800*    END-EXEC.
 18801     MOVE 'ELCNTL' TO DFHEIV1
 18802*    MOVE '&"S        G          (   #00017142' TO DFHEIV0
 18803     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18805     MOVE X'2020233030303137313432' TO DFHEIV0(25:11)
 18806     CALL 'kxdfhei1' USING DFHEIV0,
 18807           DFHEIV1,
 18808           DFHEIV20,
 18809           DFHEIV99,
 18810           ELCNTL-KEY,
 18811           DFHEIV99,
 18812           DFHEIV99,
 18813           DFHEIV99
 18814     SET ADDRESS OF CONTROL-FILE TO
 18815         DFHEIV20
 18816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18817
 18818
 18819     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18820        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18821           GO TO 7200-EXIT.
 18822
 18823     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18824         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18825            ((SUB-1 > 8) OR
 18826            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18827
 18828     IF SUB-1 NOT = 9
 18829         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18830
 18831     GO TO 7200-EXIT.
 18832
 18833 7200-BENEFIT-DUMMY.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 362
* EL156.cbl
 18834
 18835 7200-DUMMY-EXIT.
 18836     EXIT.
 18837
 18838 7200-EXIT.
 18839     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 363
* EL156.cbl
 18841*052506
 18842*052506 7250-FIND-LETTER-TRLR.
 18843*052506     EXEC CICS HANDLE CONDITION
 18844*052506         ENDFILE  (7250-END)
 18845*052506         NOTFND   (7250-END)
 18846*052506     END-EXEC.
 18847*052506
 18848*052506     EXEC CICS STARTBR
 18849*052506         DATASET   ('ELTRLR')
 18850*052506         RIDFLD    (ELTRLR-KEY)
 18851*052506         GTEQ
 18852*052506     END-EXEC.
 18853*052506
 18854*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18855*052506
 18856*052506 7250-FIND-LOOP.
 18857*052506     EXEC CICS READNEXT
 18858*052506         DATASET   ('ELTRLR')
 18859*052506         RIDFLD    (ELTRLR-KEY)
 18860*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18861*052506     END-EXEC.
 18862*052506
 18863*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18864*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18865*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18866*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18867*052506        GO TO 7250-END
 18868*052506     END-IF.
 18869*052506
 18870*052506     IF AT-TRAILER-TYPE NOT = '4'
 18871*052506         GO TO 7250-FIND-LOOP
 18872*052506     END-IF.
 18873*052506
 18874*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18875*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18876*052506     END-IF.
 18877*052506
 18878*052506     GO TO 7250-FIND-LOOP.
 18879*052506
 18880*052506 7250-END.
 18881*052506
 18882*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18883*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18884*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18885*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18886*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18887*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18888*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18889*052506     END-IF.
 18890*052506
 18891*052506     EXEC CICS ENDBR
 18892*052506          DATASET    ('ELTRLR')
 18893*052506     END-EXEC.
 18894*052506
 18895*052506 7250-EXIT.
 18896*052506     EXIT.
 18897*052506     EJECT
 18898*052506
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 364
* EL156.cbl
 18899 7300-CHECK-AUTO-ACTIVITY.
 18900
 18901     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18902         NEXT SENTENCE
 18903     ELSE
 18904         GO TO 7399-EXIT.
 18905
 18906     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18907
 18908     IF WS-ACT-REC-FOUND-SW = 'N'
 18909         GO TO 7399-EXIT.
 18910
 18911     IF PI-ACTIVITY-CODE = 09
 18912         GO TO 7300-CONT-AUTO-ACTIVITY.
 18913
 18914     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18915        (PI-ACTIVITY-CODE = 11)
 18916         GO TO 7300-CONT-AUTO-ACTIVITY.
 18917
 18918     IF PI-PROVISIONAL-IND = 'P'
 18919         IF PI-PMTTYPE = '1'
 18920             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18921                 MOVE 'N'    TO  PI-RESET-SW
 18922                 GO TO 7399-EXIT.
 18923
 18924     IF PI-PMTTYPE = '1'
 18925         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18926             MOVE 'N'        TO  PI-RESET-SW
 18927             GO TO 7399-EXIT.
 18928
 18929     IF PI-PMTTYPE = '2' OR '3'
 18930         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18931             MOVE 'N'        TO  PI-RESET-SW
 18932             GO TO 7399-EXIT.
 18933
 18934     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18935         IF PI-PROVISIONAL-IND = 'P'
 18936             NEXT SENTENCE
 18937         ELSE
 18938             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18939
 18940 7300-CONT-AUTO-ACTIVITY.
 18941
 18942     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18943         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18944         MOVE '4'            TO DC-OPTION-CODE
 18945         MOVE +0             TO DC-ELAPSED-DAYS
 18946                                DC-ELAPSED-MONTHS
 18947         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18948         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18949         IF PI-USES-PAID-TO
 18950             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18951             IF NO-CONVERSION-ERROR
 18952                 MOVE +1     TO DC-ELAPSED-DAYS
 18953                 MOVE +0     TO DC-ELAPSED-MONTHS
 18954                 MOVE '6'    TO DC-OPTION-CODE
 18955                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18956                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 365
* EL156.cbl
 18957                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18958
 18959     IF PI-PFKEY-USED = DFHPF5
 18960         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18961         IF PI-USES-PAID-TO
 18962             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18963             MOVE +1                  TO DC-ELAPSED-DAYS
 18964             MOVE +0                  TO DC-ELAPSED-MONTHS
 18965             MOVE '6'                 TO DC-OPTION-CODE
 18966             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18967             IF NO-CONVERSION-ERROR
 18968                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18969
 18970     IF WS-CHK-THRU-DT < PI-EXP-DT
 18971         NEXT SENTENCE
 18972     ELSE
 18973         MOVE 03                     TO  WS-ACTIVITY-CODE
 18974         GO TO 7390-PROCESS-ACTIVITY.
 18975
 18976     IF PI-PROV-PMT
 18977         MOVE 09                     TO  WS-ACTIVITY-CODE
 18978     ELSE
 18979        IF PI-PMTTYPE = '1'
 18980            MOVE 02                  TO  WS-ACTIVITY-CODE
 18981        ELSE
 18982        IF PI-PMTTYPE = '2' OR '3'
 18983            MOVE 07                  TO  WS-ACTIVITY-CODE
 18984        ELSE
 18985        IF PI-PMTTYPE = '4'
 18986            MOVE 00                  TO  WS-ACTIVITY-CODE
 18987        ELSE
 18988            MOVE 'N'                 TO  PI-RESET-SW
 18989            GO TO 7399-EXIT.
 18990
 18991 7390-PROCESS-ACTIVITY.
 18992
 18993     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18994
 18995 7399-EXIT.
 18996     EXIT.
 18997
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 366
* EL156.cbl
 18999 7400-CHECK-AUTO-ACTIVITY.
 19000
 19001
 19002* EXEC CICS HANDLE CONDITION
 19003*        NOTFND   (7400-NOT-FOUND)
 19004*    END-EXEC.
 19005*    MOVE '"$I                   ! < #00017331' TO DFHEIV0
 19006     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19008     MOVE X'3C20233030303137333331' TO DFHEIV0(25:11)
 19009     CALL 'kxdfhei1' USING DFHEIV0
 19010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19011
 19012
 19013     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 19014     MOVE 'T'                    TO  CNTL-REC-TYPE.
 19015     MOVE SPACES                 TO  CNTL-ACCESS.
 19016     MOVE +0                     TO  CNTL-SEQ-NO.
 19017
 19018
 19019* EXEC CICS READ
 19020*        DATASET   ('ELCNTL')
 19021*        RIDFLD    (ELCNTL-KEY)
 19022*        SET       (ADDRESS OF CONTROL-FILE)
 19023*    END-EXEC.
 19024     MOVE 'ELCNTL' TO DFHEIV1
 19025*    MOVE '&"S        E          (   #00017340' TO DFHEIV0
 19026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19028     MOVE X'2020233030303137333430' TO DFHEIV0(25:11)
 19029     CALL 'kxdfhei1' USING DFHEIV0,
 19030           DFHEIV1,
 19031           DFHEIV20,
 19032           DFHEIV99,
 19033           ELCNTL-KEY,
 19034           DFHEIV99,
 19035           DFHEIV99,
 19036           DFHEIV99
 19037     SET ADDRESS OF CONTROL-FILE TO
 19038         DFHEIV20
 19039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19040
 19041
 19042     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 19043     GO TO 7400-EXIT.
 19044
 19045 7400-NOT-FOUND.
 19046     MOVE 'N'                        TO  PI-RESET-SW
 19047                                         WS-LETTER-SW
 19048                                         WS-ACT-REC-FOUND-SW.
 19049
 19050     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19051
 19052 7400-EXIT.
 19053     EXIT.
 19054
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 367
* EL156.cbl
 19056 7450-FORMAT-AUTO-LETTER.
 19057
 19058     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 19059         MOVE 'Y'                    TO PI-RESET-SW
 19060         GO TO 7450-CONTINUE-PROCESS.
 19061
 19062     MOVE PI-ACTIVITY-CODE           TO  SUB.
 19063
 19064     IF SUB > 9
 19065         SUBTRACT 9 FROM SUB
 19066         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 19067     ELSE
 19068         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 19069
 19070 7450-CONTINUE-PROCESS.
 19071
 19072     IF WS-ACTIVITY-CODE = ZEROS
 19073         MOVE 'N'                    TO  WS-LETTER-SW
 19074         GO TO 7450-EXIT.
 19075
 19076     MOVE WS-ACTIVITY-CODE           TO  SUB.
 19077
 19078     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 19079         MOVE 'N'                    TO  PI-RESET-SW
 19080                                         WS-LETTER-SW
 19081         GO TO 7450-EXIT.
 19082
 19083     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 19084         MOVE 'N'                    TO  WS-LETTER-SW
 19085         GO TO 7450-EXIT.
 19086
 19087     MOVE 'Y'                        TO  WS-LETTER-SW.
 19088     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 19089     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 19090
 19091     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 19092
 19093     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 19094         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19095         MOVE '6'                    TO  DC-OPTION-CODE
 19096         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 19097         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19098         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19099         IF NO-CONVERSION-ERROR
 19100             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 19101         ELSE
 19102              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 19103
 19104     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 19105         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19106         MOVE '6'                    TO  DC-OPTION-CODE
 19107         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 19108         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19109         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19110         IF NO-CONVERSION-ERROR
 19111             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 19112         ELSE
 19113             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 368
* EL156.cbl
 19114
 19115 7450-EXIT.
 19116     EXIT.
 19117
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 369
* EL156.cbl
 19119 7500-RESET-AUTO-ACTIVITY.
 19120
 19121     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 19122     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 19123     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 19124     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 19125     MOVE +100                   TO  TRLR-SEQ-NO.
 19126
 19127 7500-STARTBR-TRLR.
 19128
 19129
 19130* EXEC CICS HANDLE CONDITION
 19131*        ENDFILE  (7590-END)
 19132*        NOTFND   (7590-END)
 19133*    END-EXEC.
 19134*    MOVE '"$''I                  ! = #00017433' TO DFHEIV0
 19135     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19136     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19137     MOVE X'3D20233030303137343333' TO DFHEIV0(25:11)
 19138     CALL 'kxdfhei1' USING DFHEIV0
 19139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19140
 19141
 19142
 19143* EXEC CICS STARTBR
 19144*        DATASET   ('ELTRLR')
 19145*        RIDFLD    (ELTRLR-KEY)
 19146*        GTEQ
 19147*    END-EXEC.
 19148     MOVE 'ELTRLR' TO DFHEIV1
 19149     MOVE 0
 19150       TO DFHEIV11
 19151*    MOVE '&,         G          &   #00017438' TO DFHEIV0
 19152     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19153     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19154     MOVE X'2020233030303137343338' TO DFHEIV0(25:11)
 19155     CALL 'kxdfhei1' USING DFHEIV0,
 19156           DFHEIV1,
 19157           ELTRLR-KEY,
 19158           DFHEIV99,
 19159           DFHEIV11,
 19160           DFHEIV99
 19161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19162
 19163
 19164     MOVE 'Y'                        TO  WS-BROWSE-SW.
 19165
 19166 7500-READ-NEXT.
 19167
 19168
 19169* EXEC CICS READNEXT
 19170*        DATASET   ('ELTRLR')
 19171*        RIDFLD    (ELTRLR-KEY)
 19172*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19173*    END-EXEC.
 19174     MOVE 'ELTRLR' TO DFHEIV1
 19175     MOVE 0
 19176       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 370
* EL156.cbl
 19177*    MOVE '&.S                   )   #00017448' TO DFHEIV0
 19178     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19179     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19180     MOVE X'2020233030303137343438' TO DFHEIV0(25:11)
 19181     CALL 'kxdfhei1' USING DFHEIV0,
 19182           DFHEIV1,
 19183           DFHEIV20,
 19184           DFHEIV99,
 19185           ELTRLR-KEY,
 19186           DFHEIV99,
 19187           DFHEIV11,
 19188           DFHEIV99,
 19189           DFHEIV99
 19190     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19191         DFHEIV20
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19193
 19194
 19195     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19196        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19197        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19198        PI-CERT-NO    NOT = TRLR-CERT-NO
 19199         GO TO 7590-END.
 19200
 19201     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19202         GO TO 7500-READ-NEXT.
 19203
 19204     IF AT-TRAILER-TYPE NOT = '4'
 19205         GO TO 7500-READ-NEXT.
 19206
 19207     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19208         GO TO 7500-READ-NEXT.
 19209
 19210     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19211        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19212         GO TO 7500-READ-NEXT.
 19213
 19214     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19215        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19216        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19217         GO TO 7500-READ-NEXT.
 19218
 19219     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19220                         AND
 19221        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19222                         AND
 19223        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19224            GO TO 7500-READ-NEXT.
 19225
 19226     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19227
 19228
 19229* EXEC CICS ENDBR
 19230*        DATASET   ('ELTRLR')
 19231*    END-EXEC.
 19232     MOVE 'ELTRLR' TO DFHEIV1
 19233     MOVE 0
 19234       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 371
* EL156.cbl
 19235*    MOVE '&2                    $   #00017487' TO DFHEIV0
 19236     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19237     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19238     MOVE X'2020233030303137343837' TO DFHEIV0(25:11)
 19239     CALL 'kxdfhei1' USING DFHEIV0,
 19240           DFHEIV1,
 19241           DFHEIV11,
 19242           DFHEIV99
 19243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19244
 19245
 19246     MOVE 'N'                        TO  WS-BROWSE-SW.
 19247
 19248
 19249* EXEC CICS READ
 19250*        DATASET   ('ELTRLR')
 19251*        RIDFLD    (ELTRLR-KEY)
 19252*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19253*        UPDATE
 19254*    END-EXEC.
 19255     MOVE 'ELTRLR' TO DFHEIV1
 19256*    MOVE '&"S        EU         (   #00017493' TO DFHEIV0
 19257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19258     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303137343933' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           DFHEIV1,
 19262           DFHEIV20,
 19263           DFHEIV99,
 19264           ELTRLR-KEY,
 19265           DFHEIV99,
 19266           DFHEIV99,
 19267           DFHEIV99
 19268     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19269         DFHEIV20
 19270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19271
 19272
 19273     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19274
 19275     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19276         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19277     ELSE
 19278         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19279             NEXT SENTENCE
 19280         ELSE
 19281             GO TO 7500-REWRITE-TRLR.
 19282
 19283     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19284
 19285     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19286     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19287     MOVE '1'                        TO  ARCH-REC-TYPE.
 19288     MOVE +0                         TO  ARCH-SEQ.
 19289
 19290     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19291
 19292 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 372
* EL156.cbl
 19293
 19294
 19295* EXEC CICS REWRITE
 19296*        DATASET   ('ELTRLR')
 19297*        FROM      (ACTIVITY-TRAILERS)
 19298*    END-EXEC.
 19299     MOVE LENGTH OF
 19300      ACTIVITY-TRAILERS
 19301       TO DFHEIV11
 19302     MOVE 'ELTRLR' TO DFHEIV1
 19303*    MOVE '&& L                  %   #00017521' TO DFHEIV0
 19304     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19305     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19306     MOVE X'2020233030303137353231' TO DFHEIV0(25:11)
 19307     CALL 'kxdfhei1' USING DFHEIV0,
 19308           DFHEIV1,
 19309           ACTIVITY-TRAILERS,
 19310           DFHEIV11,
 19311           DFHEIV99
 19312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19313
 19314
 19315     GO TO 7500-STARTBR-TRLR.
 19316
 19317 7590-END.
 19318
 19319     IF WS-BROWSE-SW = 'Y'
 19320         MOVE 'N'                    TO  WS-BROWSE-SW
 19321
 19322* EXEC CICS ENDBR
 19323*            DATASET   ('ELTRLR')
 19324*        END-EXEC.
 19325     MOVE 'ELTRLR' TO DFHEIV1
 19326     MOVE 0
 19327       TO DFHEIV11
 19328*    MOVE '&2                    $   #00017532' TO DFHEIV0
 19329     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19331     MOVE X'2020233030303137353332' TO DFHEIV0(25:11)
 19332     CALL 'kxdfhei1' USING DFHEIV0,
 19333           DFHEIV1,
 19334           DFHEIV11,
 19335           DFHEIV99
 19336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19337
 19338
 19339 7599-EXIT.
 19340     EXIT.
 19341
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 373
* EL156.cbl
 19343 7600-READ-ARCH-UPDATE.
 19344
 19345
 19346* EXEC CICS HANDLE CONDITION
 19347*        NOTFND   (7699-EXIT)
 19348*    END-EXEC.
 19349*    MOVE '"$I                   ! > #00017542' TO DFHEIV0
 19350     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19352     MOVE X'3E20233030303137353432' TO DFHEIV0(25:11)
 19353     CALL 'kxdfhei1' USING DFHEIV0
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357
 19358* EXEC CICS READ
 19359*        DATASET   ('ELARCH')
 19360*        RIDFLD    (ELARCH-KEY)
 19361*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19362*        UPDATE
 19363*    END-EXEC.
 19364     MOVE 'ELARCH' TO DFHEIV1
 19365*    MOVE '&"S        EU         (   #00017546' TO DFHEIV0
 19366     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19367     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19368     MOVE X'2020233030303137353436' TO DFHEIV0(25:11)
 19369     CALL 'kxdfhei1' USING DFHEIV0,
 19370           DFHEIV1,
 19371           DFHEIV20,
 19372           DFHEIV99,
 19373           ELARCH-KEY,
 19374           DFHEIV99,
 19375           DFHEIV99,
 19376           DFHEIV99
 19377     SET ADDRESS OF LETTER-ARCHIVE TO
 19378         DFHEIV20
 19379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19380
 19381
 19382     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19383
 19384
 19385* EXEC CICS REWRITE
 19386*        DATASET   ('ELARCH')
 19387*        FROM      (LETTER-ARCHIVE)
 19388*    END-EXEC.
 19389     MOVE LENGTH OF
 19390      LETTER-ARCHIVE
 19391       TO DFHEIV11
 19392     MOVE 'ELARCH' TO DFHEIV1
 19393*    MOVE '&& L                  %   #00017555' TO DFHEIV0
 19394     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19395     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19396     MOVE X'2020233030303137353535' TO DFHEIV0(25:11)
 19397     CALL 'kxdfhei1' USING DFHEIV0,
 19398           DFHEIV1,
 19399           LETTER-ARCHIVE,
 19400           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 374
* EL156.cbl
 19401           DFHEIV99
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19403
 19404
 19405 7699-EXIT.
 19406     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 375
* EL156.cbl
 19408 7700-GET-DCT.
 19409
 19410     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19411     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19412     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19413     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19414                                    PI-MAX-BENEFIT-AMT
 19415                                    PI-MAX-BENEFIT-PYMT
 19416                                    PI-MIN-PAYMENT-AMT
 19417                                    PI-TIME-OF-LOSS-BAL.
 19418
 19419
 19420* EXEC CICS HANDLE CONDITION
 19421*         NOTFND (5300-NOTE-NOT-FOUND)
 19422*     END-EXEC.
 19423*    MOVE '"$I                   ! ? #00017574' TO DFHEIV0
 19424     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19426     MOVE X'3F20233030303137353734' TO DFHEIV0(25:11)
 19427     CALL 'kxdfhei1' USING DFHEIV0
 19428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19429
 19430
 19431
 19432* EXEC CICS READ
 19433*         DATASET('ERNOTE')
 19434*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19435*         RIDFLD (W-NOTE-KEY)
 19436*     END-EXEC.
 19437     MOVE 'ERNOTE' TO DFHEIV1
 19438*    MOVE '&"S        E          (   #00017578' TO DFHEIV0
 19439     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19441     MOVE X'2020233030303137353738' TO DFHEIV0(25:11)
 19442     CALL 'kxdfhei1' USING DFHEIV0,
 19443           DFHEIV1,
 19444           DFHEIV20,
 19445           DFHEIV99,
 19446           W-NOTE-KEY,
 19447           DFHEIV99,
 19448           DFHEIV99,
 19449           DFHEIV99
 19450     SET ADDRESS OF CERTIFICATE-NOTE TO
 19451         DFHEIV20
 19452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19453
 19454
 19455     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19456     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19457     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19458     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19459     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19460
 19461     IF PI-PAYEE-TYPE NOT = 'B'
 19462         GO TO 7700-EXIT.
 19463
 19464     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19465     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 376
* EL156.cbl
 19466     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19467
 19468     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19469         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19470     ELSE
 19471         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19472
 19473     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19474     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19475     MOVE 'DLO006'               TO PGM-NAME.
 19476
 19477
 19478* EXEC CICS LINK
 19479*        PROGRAM    (PGM-NAME)
 19480*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19481*        LENGTH     (DCT-RCRD-LENGTH)
 19482*    END-EXEC.
 19483*    MOVE '."C                   (   #00017606' TO DFHEIV0
 19484     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19486     MOVE X'2020233030303137363036' TO DFHEIV0(25:11)
 19487     CALL 'kxdfhei1' USING DFHEIV0,
 19488           PGM-NAME,
 19489           DCT-COMMUNICATION-AREA,
 19490           DCT-RCRD-LENGTH,
 19491           DFHEIV99,
 19492           DFHEIV99,
 19493           DFHEIV99,
 19494           DFHEIV99
 19495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19496
 19497
 19498     IF DCT-RETURN-CODE = 'OK'
 19499         GO TO 7700-CONT.
 19500
 19501     IF DCT-RETURN-CODE = '01' OR '02'
 19502         GO TO 7700-SET-TO-YES.
 19503
 19504     IF DCT-RETURN-CODE = '03'
 19505
 19506* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19507*    MOVE '6"R                   !   #00017619' TO DFHEIV0
 19508     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19510     MOVE X'2020233030303137363139' TO DFHEIV0(25:11)
 19511     CALL 'kxdfhei1' USING DFHEIV0
 19512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19513         MOVE ER-0951            TO EMI-ERROR
 19514         MOVE -1                 TO PMTTYPEL
 19515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19516         GO TO 8200-SEND-DATAONLY.
 19517
 19518     IF DCT-RETURN-CODE = '04'
 19519
 19520* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19521*    MOVE '6"R                   !   #00017626' TO DFHEIV0
 19522     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 377
* EL156.cbl
 19524     MOVE X'2020233030303137363236' TO DFHEIV0(25:11)
 19525     CALL 'kxdfhei1' USING DFHEIV0
 19526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19527         MOVE ER-0946            TO EMI-ERROR
 19528         MOVE -1                 TO PMTTYPEL
 19529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19530         GO TO 8200-SEND-DATAONLY.
 19531
 19532     IF DCT-RETURN-CODE = '05'
 19533
 19534* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19535*    MOVE '6"R                   !   #00017633' TO DFHEIV0
 19536     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19538     MOVE X'2020233030303137363333' TO DFHEIV0(25:11)
 19539     CALL 'kxdfhei1' USING DFHEIV0
 19540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19541         MOVE ER-0947            TO EMI-ERROR
 19542         MOVE -1                 TO PMTTYPEL
 19543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19544         GO TO 8200-SEND-DATAONLY.
 19545
 19546     IF DCT-RETURN-CODE = '06'
 19547
 19548* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19549*    MOVE '6"R                   !   #00017640' TO DFHEIV0
 19550     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19552     MOVE X'2020233030303137363430' TO DFHEIV0(25:11)
 19553     CALL 'kxdfhei1' USING DFHEIV0
 19554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19555         MOVE ER-0921            TO EMI-ERROR
 19556         MOVE -1                 TO PMTTYPEL
 19557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19558         GO TO 8200-SEND-DATAONLY.
 19559
 19560     IF DCT-RETURN-CODE = '07'
 19561
 19562* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19563*    MOVE '6"R                   !   #00017647' TO DFHEIV0
 19564     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19566     MOVE X'2020233030303137363437' TO DFHEIV0(25:11)
 19567     CALL 'kxdfhei1' USING DFHEIV0
 19568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19569         MOVE ER-0919            TO EMI-ERROR
 19570         MOVE -1                 TO PMTTYPEL
 19571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19572         GO TO 8200-SEND-DATAONLY.
 19573
 19574     IF DCT-RETURN-CODE = '08'
 19575
 19576* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19577*    MOVE '6"R                   !   #00017654' TO DFHEIV0
 19578     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19580     MOVE X'2020233030303137363534' TO DFHEIV0(25:11)
 19581     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 378
* EL156.cbl
 19582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19583         MOVE ER-0948            TO EMI-ERROR
 19584         MOVE -1                 TO PMTTYPEL
 19585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19586         GO TO 8200-SEND-DATAONLY.
 19587
 19588     IF DCT-RETURN-CODE = 'N1'
 19589
 19590* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19591*    MOVE '6"R                   !   #00017661' TO DFHEIV0
 19592     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19593     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19594     MOVE X'2020233030303137363631' TO DFHEIV0(25:11)
 19595     CALL 'kxdfhei1' USING DFHEIV0
 19596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19597         MOVE ER-0950            TO EMI-ERROR
 19598         MOVE -1                 TO PMTTYPEL
 19599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19600         GO TO 8200-SEND-DATAONLY.
 19601
 19602     IF DCT-RETURN-CODE = 'E1'
 19603
 19604* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19605*    MOVE '6"R                   !   #00017668' TO DFHEIV0
 19606     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19608     MOVE X'2020233030303137363638' TO DFHEIV0(25:11)
 19609     CALL 'kxdfhei1' USING DFHEIV0
 19610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19611         MOVE ER-0974            TO EMI-ERROR
 19612         MOVE -1                 TO PMTTYPEL
 19613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19614         GO TO 8200-SEND-DATAONLY.
 19615
 19616     IF DCT-RETURN-CODE = 'E2'
 19617
 19618* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19619*    MOVE '6"R                   !   #00017675' TO DFHEIV0
 19620     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19622     MOVE X'2020233030303137363735' TO DFHEIV0(25:11)
 19623     CALL 'kxdfhei1' USING DFHEIV0
 19624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19625         MOVE ER-0975            TO EMI-ERROR
 19626         MOVE -1                 TO PMTTYPEL
 19627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19628         GO TO 8200-SEND-DATAONLY.
 19629
 19630     IF DCT-RETURN-CODE NOT = 'OK'
 19631
 19632* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19633*    MOVE '6"R                   !   #00017682' TO DFHEIV0
 19634     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19636     MOVE X'2020233030303137363832' TO DFHEIV0(25:11)
 19637     CALL 'kxdfhei1' USING DFHEIV0
 19638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19639         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 379
* EL156.cbl
 19640         MOVE -1                 TO PMTTYPEL
 19641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19642         GO TO 8200-SEND-DATAONLY.
 19643
 19644 7700-CONT.
 19645
 19646*    MOVE 'N'                    TO CASHO.
 19647*    MOVE +1                     TO CASHL.
 19648*    MOVE AL-UANON               TO CASHA.
 19649
 19650     IF PI-OFFLINE = 'Y'
 19651         GO TO 7700-EXIT.
 19652
 19653     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19654     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19655     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19656     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19657     MOVE +7                     TO CHECKNOL.
 19658     MOVE AL-UANON               TO CHECKNOA.
 19659     GO TO 7700-EXIT.
 19660
 19661 7700-SET-TO-YES.
 19662
 19663*    MOVE 'Y'                    TO CASHO.
 19664*    MOVE +1                     TO CASHL.
 19665*    MOVE AL-UANON               TO CASHA.
 19666
 19667 7700-EXIT.
 19668     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 380
* EL156.cbl
 19670 7800-READ-COMP-MSTR.
 19671
 19672
 19673* EXEC CICS HANDLE CONDITION
 19674*        NOTFND   (7800-COMP-NOTFND)
 19675*    END-EXEC.
 19676*    MOVE '"$I                   ! @ #00017716' TO DFHEIV0
 19677     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19679     MOVE X'4020233030303137373136' TO DFHEIV0(25:11)
 19680     CALL 'kxdfhei1' USING DFHEIV0
 19681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19682
 19683
 19684
 19685* EXEC CICS READ
 19686*        DATASET   ('ERCOMP')
 19687*        RIDFLD    (ERCOMP-KEY)
 19688*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19689*    END-EXEC.
 19690     MOVE 'ERCOMP' TO DFHEIV1
 19691*    MOVE '&"S        E          (   #00017720' TO DFHEIV0
 19692     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19694     MOVE X'2020233030303137373230' TO DFHEIV0(25:11)
 19695     CALL 'kxdfhei1' USING DFHEIV0,
 19696           DFHEIV1,
 19697           DFHEIV20,
 19698           DFHEIV99,
 19699           ERCOMP-KEY,
 19700           DFHEIV99,
 19701           DFHEIV99,
 19702           DFHEIV99
 19703     SET ADDRESS OF COMPENSATION-MASTER TO
 19704         DFHEIV20
 19705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19706
 19707
 19708     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19709     GO TO 7800-COMP-EXIT.
 19710
 19711 7800-COMP-NOTFND.
 19712     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19713
 19714 7800-COMP-EXIT.
 19715     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 381
* EL156.cbl
 19717 7900-READ-CLAIM.
 19718
 19719* EXEC CICS READ
 19720*        DATASET  ('ELMSTR')
 19721*        SET      (ADDRESS OF CLAIM-MASTER)
 19722*        RIDFLD   (ELMSTR-KEY)
 19723*    END-EXEC.
 19724     MOVE 'ELMSTR' TO DFHEIV1
 19725*    MOVE '&"S        E          (   #00017736' TO DFHEIV0
 19726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19728     MOVE X'2020233030303137373336' TO DFHEIV0(25:11)
 19729     CALL 'kxdfhei1' USING DFHEIV0,
 19730           DFHEIV1,
 19731           DFHEIV20,
 19732           DFHEIV99,
 19733           ELMSTR-KEY,
 19734           DFHEIV99,
 19735           DFHEIV99,
 19736           DFHEIV99
 19737     SET ADDRESS OF CLAIM-MASTER TO
 19738         DFHEIV20
 19739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19740
 19741
 19742 7900-EXIT.
 19743      EXIT.
 19744
 19745 7910-READ-CLAIM-UPDATE.
 19746
 19747* EXEC CICS READ
 19748*        DATASET  ('ELMSTR')
 19749*        SET      (ADDRESS OF CLAIM-MASTER)
 19750*        RIDFLD   (ELMSTR-KEY)
 19751*        UPDATE
 19752*    END-EXEC.
 19753     MOVE 'ELMSTR' TO DFHEIV1
 19754*    MOVE '&"S        EU         (   #00017746' TO DFHEIV0
 19755     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19756     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19757     MOVE X'2020233030303137373436' TO DFHEIV0(25:11)
 19758     CALL 'kxdfhei1' USING DFHEIV0,
 19759           DFHEIV1,
 19760           DFHEIV20,
 19761           DFHEIV99,
 19762           ELMSTR-KEY,
 19763           DFHEIV99,
 19764           DFHEIV99,
 19765           DFHEIV99
 19766     SET ADDRESS OF CLAIM-MASTER TO
 19767         DFHEIV20
 19768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19769
 19770
 19771 7910-EXIT.
 19772      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 382
* EL156.cbl
 19774 7920-READ-BENE.
 19775     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19776     MOVE 'B'                TO BENE-RECORD-TYPE.
 19777     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19778
 19779     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19780        IF PI-PAYEE-TYPE    = 'B' AND
 19781           PI-PAYEE-SEQ-NUM = 9
 19782             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19783             MOVE WS-A-BENE           TO BENE-NUMBER.
 19784
 19785
 19786* EXEC CICS HANDLE CONDITION
 19787*        NOTFND   (7920-NOT-FOUND)
 19788*    END-EXEC.
 19789*    MOVE '"$I                   ! A #00017767' TO DFHEIV0
 19790     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19792     MOVE X'4120233030303137373637' TO DFHEIV0(25:11)
 19793     CALL 'kxdfhei1' USING DFHEIV0
 19794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19795
 19796
 19797
 19798* EXEC CICS READ
 19799*        DATASET  ('ELBENE')
 19800*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19801*        RIDFLD   (ELBENE-KEY)
 19802*    END-EXEC.
 19803     MOVE 'ELBENE' TO DFHEIV1
 19804*    MOVE '&"S        E          (   #00017771' TO DFHEIV0
 19805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19807     MOVE X'2020233030303137373731' TO DFHEIV0(25:11)
 19808     CALL 'kxdfhei1' USING DFHEIV0,
 19809           DFHEIV1,
 19810           DFHEIV20,
 19811           DFHEIV99,
 19812           ELBENE-KEY,
 19813           DFHEIV99,
 19814           DFHEIV99,
 19815           DFHEIV99
 19816     SET ADDRESS OF BENEFICIARY-MASTER TO
 19817         DFHEIV20
 19818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19819
 19820
 19821     MOVE 'Y' TO BENE-FOUND-SW.
 19822     GO TO 7920-EXIT.
 19823
 19824 7920-NOT-FOUND.
 19825     MOVE 'N'                    TO BENE-FOUND-SW.
 19826
 19827 7920-EXIT.
 19828      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 383
* EL156.cbl
 19830 7930-READ-CONTROL.
 19831
 19832* EXEC CICS READ
 19833*        DATASET  ('ELCNTL')
 19834*        SET      (ADDRESS OF CONTROL-FILE)
 19835*        RIDFLD   (ELCNTL-KEY)
 19836*    END-EXEC.
 19837     MOVE 'ELCNTL' TO DFHEIV1
 19838*    MOVE '&"S        E          (   #00017787' TO DFHEIV0
 19839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303137373837' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           DFHEIV1,
 19844           DFHEIV20,
 19845           DFHEIV99,
 19846           ELCNTL-KEY,
 19847           DFHEIV99,
 19848           DFHEIV99,
 19849           DFHEIV99
 19850     SET ADDRESS OF CONTROL-FILE TO
 19851         DFHEIV20
 19852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19853
 19854
 19855 7930-EXIT.
 19856      EXIT.
 19857
 19858 7940-READ-CONTROL-UPDATE.
 19859
 19860* EXEC CICS READ
 19861*        DATASET  ('ELCNTL')
 19862*        SET      (ADDRESS OF CONTROL-FILE)
 19863*        RIDFLD   (ELCNTL-KEY)
 19864*        UPDATE
 19865*    END-EXEC.
 19866     MOVE 'ELCNTL' TO DFHEIV1
 19867*    MOVE '&"S        EU         (   #00017797' TO DFHEIV0
 19868     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19869     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19870     MOVE X'2020233030303137373937' TO DFHEIV0(25:11)
 19871     CALL 'kxdfhei1' USING DFHEIV0,
 19872           DFHEIV1,
 19873           DFHEIV20,
 19874           DFHEIV99,
 19875           ELCNTL-KEY,
 19876           DFHEIV99,
 19877           DFHEIV99,
 19878           DFHEIV99
 19879     SET ADDRESS OF CONTROL-FILE TO
 19880         DFHEIV20
 19881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19882
 19883
 19884 7940-EXIT.
 19885      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 384
* EL156.cbl
 19887 7950-READ-TRAILER.
 19888
 19889* EXEC CICS READ
 19890*        DATASET  ('ELTRLR')
 19891*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19892*        RIDFLD   (ELTRLR-KEY)
 19893*    END-EXEC.
 19894     MOVE 'ELTRLR' TO DFHEIV1
 19895*    MOVE '&"S        E          (   #00017808' TO DFHEIV0
 19896     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19898     MOVE X'2020233030303137383038' TO DFHEIV0(25:11)
 19899     CALL 'kxdfhei1' USING DFHEIV0,
 19900           DFHEIV1,
 19901           DFHEIV20,
 19902           DFHEIV99,
 19903           ELTRLR-KEY,
 19904           DFHEIV99,
 19905           DFHEIV99,
 19906           DFHEIV99
 19907     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19908         DFHEIV20
 19909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19910
 19911
 19912 7950-EXIT.
 19913      EXIT.
 19914
 19915 7960-READ-TRAILER-UPDATE.
 19916
 19917* EXEC CICS READ
 19918*        DATASET  ('ELTRLR')
 19919*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19920*        RIDFLD   (ELTRLR-KEY)
 19921*        UPDATE
 19922*    END-EXEC.
 19923     MOVE 'ELTRLR' TO DFHEIV1
 19924*    MOVE '&"S        EU         (   #00017818' TO DFHEIV0
 19925     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19926     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19927     MOVE X'2020233030303137383138' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0,
 19929           DFHEIV1,
 19930           DFHEIV20,
 19931           DFHEIV99,
 19932           ELTRLR-KEY,
 19933           DFHEIV99,
 19934           DFHEIV99,
 19935           DFHEIV99
 19936     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19937         DFHEIV20
 19938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19939
 19940
 19941 7960-EXIT.
 19942      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 385
* EL156.cbl
 19944 7970-READ-CERT.
 19945
 19946* EXEC CICS READ
 19947*        DATASET  ('ELCERT')
 19948*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19949*        RIDFLD   (ELCERT-KEY)
 19950*    END-EXEC.
 19951     MOVE 'ELCERT' TO DFHEIV1
 19952*    MOVE '&"S        E          (   #00017829' TO DFHEIV0
 19953     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19955     MOVE X'2020233030303137383239' TO DFHEIV0(25:11)
 19956     CALL 'kxdfhei1' USING DFHEIV0,
 19957           DFHEIV1,
 19958           DFHEIV20,
 19959           DFHEIV99,
 19960           ELCERT-KEY,
 19961           DFHEIV99,
 19962           DFHEIV99,
 19963           DFHEIV99
 19964     SET ADDRESS OF CERTIFICATE-MASTER TO
 19965         DFHEIV20
 19966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19967
 19968
 19969 7970-EXIT.
 19970      EXIT.
 19971 7975-read-acct.
 19972
 19973     move spaces              to WS-ACCT-RECORD-SW
 19974                                 pi-dcc-product-code
 19975
 19976     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19977     MOVE PI-CARRIER          TO ACCT-CARRIER
 19978     MOVE PI-GROUPING         TO ACCT-GROUPING
 19979     MOVE PI-STATE            TO ACCT-STATE
 19980     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19981     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19982     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19983     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19984
 19985
 19986* EXEC CICS READ
 19987*       DATASET ('ERACCT')
 19988*       RIDFLD  (ERACCT-KEY)
 19989*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19990*       GTEQ
 19991*       resp    (WS-RESPONSE)
 19992*    END-EXEC
 19993     MOVE 'ERACCT' TO DFHEIV1
 19994*    MOVE '&"S        G          (  N#00017851' TO DFHEIV0
 19995     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19997     MOVE X'204E233030303137383531' TO DFHEIV0(25:11)
 19998     CALL 'kxdfhei1' USING DFHEIV0,
 19999           DFHEIV1,
 20000           DFHEIV20,
 20001           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 386
* EL156.cbl
 20002           ERACCT-KEY,
 20003           DFHEIV99,
 20004           DFHEIV99,
 20005           DFHEIV99
 20006     SET ADDRESS OF ACCOUNT-MASTER TO
 20007         DFHEIV20
 20008     MOVE EIBRESP  TO WS-RESPONSE
 20009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20010     IF WS-RESP-NORMAL
 20011        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 20012        and pi-cert-eff-dt < am-expiration-dt
 20013        and pi-cert-eff-dt >= am-effective-dt
 20014        move am-dcc-product-code to pi-dcc-product-code
 20015        set acct-found to true
 20016     end-if
 20017
 20018     .
 20019 7975-exit.
 20020     exit.
 20021 7980-READ-CERT-UPDATE.
 20022
 20023* EXEC CICS READ
 20024*        DATASET  ('ELCERT')
 20025*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 20026*        RIDFLD   (ELCERT-KEY)
 20027*        UPDATE
 20028*    END-EXEC.
 20029     MOVE 'ELCERT' TO DFHEIV1
 20030*    MOVE '&"S        EU         (   #00017870' TO DFHEIV0
 20031     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20032     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20033     MOVE X'2020233030303137383730' TO DFHEIV0(25:11)
 20034     CALL 'kxdfhei1' USING DFHEIV0,
 20035           DFHEIV1,
 20036           DFHEIV20,
 20037           DFHEIV99,
 20038           ELCERT-KEY,
 20039           DFHEIV99,
 20040           DFHEIV99,
 20041           DFHEIV99
 20042     SET ADDRESS OF CERTIFICATE-MASTER TO
 20043         DFHEIV20
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20045
 20046
 20047 7980-EXIT.
 20048      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 387
* EL156.cbl
 20050 8000-LOAD-ERROR-MESSAGES.
 20051     IF PI-PASS-SW = 'C'
 20052        MOVE EMI-LINE1           TO ERMSG1BO
 20053     ELSE
 20054        MOVE EMI-LINE1           TO ERRMSG1O
 20055        MOVE EMI-LINE2           TO ERRMSG2O.
 20056
 20057 8000-EXIT.
 20058     EXIT.
 20059
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 388
* EL156.cbl
 20061
 20062 8010-DMD-ERROR-CHECKS.
 20063     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 20064
 20065     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 20066         GO TO 8051-ISSUE-ERROR.
 20067
 20068     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 20069     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 20070     MOVE '3'                    TO DC-OPTION-CODE.
 20071     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 20072     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 20073         GO TO 8051-ISSUE-ERROR.
 20074
 20075     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 20076       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 20077                           OR
 20078          (CL-SSN-STATE   = CL-CERT-STATE  AND
 20079           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 20080             MOVE ER-0851         TO EMI-ERROR
 20081             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20082       END-IF
 20083       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 20084             MOVE ER-8147         TO EMI-ERROR
 20085             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20086
 20087     GO TO 8090-EXIT.
 20088
 20089 8051-ISSUE-ERROR.
 20090     MOVE ER-8146            TO EMI-ERROR.
 20091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20092     GO TO 8090-EXIT.
 20093
 20094 8090-EXIT.
 20095      EXIT.
 20096
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 389
* EL156.cbl
 20098 8100-SEND-INITIAL-MAP.
 20099
 20100     MOVE SAVE-DATE              TO RUNDTEAO.
 20101     MOVE EIBTIME                TO TIME-IN.
 20102     MOVE TIME-OUT               TO RUNTIMAO.
 20103     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 20104
 20105     IF MAP-NAME = 'EL156A'
 20106        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20107           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20108        END-IF
 20109        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 20110           MOVE 'N'     TO SURVYYNO
 20111        END-IF
 20112     END-IF
 20113*    IF MAP-NAME = 'EL156A'
 20114*       IF PI-COMPANY-ID = 'CRI'
 20115*          NEXT SENTENCE
 20116*       ELSE
 20117*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 20118
 20119     IF MAP-NAME = 'EL156A'
 20120        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 20121           NEXT SENTENCE
 20122        ELSE
 20123           MOVE AL-SADOF TO  PINTA    PINTHA.
 20124
 20125     IF MAP-NAME = 'EL156A'
 20126        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 20127            NEXT SENTENCE
 20128        ELSE
 20129           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 20130
 20131*    IF MAP-NAME = 'EL156A'
 20132*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 20133*          NEXT SENTENCE
 20134*       ELSE
 20135*          MOVE AL-SADOF TO CASHHA CASHA.
 20136
 20137     IF MAP-NAME = 'EL156A'
 20138        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 20139                        or 'VPP'
 20140           NEXT SENTENCE
 20141        ELSE
 20142           MOVE AL-SADOF        TO  LOANHA
 20143                                    LOANNOA.
 20144
 20145     IF MAP-NAME = 'EL156A'
 20146        MOVE -1                 TO  ENTERPFL
 20147        IF PI-USES-PAID-TO
 20148           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20149           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20150           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20151        ELSE
 20152           NEXT SENTENCE
 20153     ELSE
 20154        IF MAP-NAME = 'EL156B'
 20155           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 390
* EL156.cbl
 20156              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20157              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20158
 20159
 20160* EXEC CICS SEND
 20161*        MAP   (MAP-NAME)
 20162*        MAPSET(MAPSET-NAME)
 20163*        FROM  (EL156AI)
 20164*        ERASE
 20165*        CURSOR
 20166*    END-EXEC.
 20167     MOVE LENGTH OF
 20168      EL156AI
 20169       TO DFHEIV12
 20170     MOVE -1
 20171       TO DFHEIV11
 20172*    MOVE '8$     CT  E    H L F ,   #00017989' TO DFHEIV0
 20173     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20174     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20175     MOVE X'2020233030303137393839' TO DFHEIV0(25:11)
 20176     CALL 'kxdfhei1' USING DFHEIV0,
 20177           MAP-NAME,
 20178           EL156AI,
 20179           DFHEIV12,
 20180           MAPSET-NAME,
 20181           DFHEIV99,
 20182           DFHEIV99,
 20183           DFHEIV99,
 20184           DFHEIV11,
 20185           DFHEIV99,
 20186           DFHEIV99,
 20187           DFHEIV99
 20188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20189
 20190
 20191     GO TO 9100-RETURN-TRAN.
 20192
 20193 8200-SEND-DATAONLY.
 20194
 20195     IF FIRST-ENTRY = 'Y'
 20196         GO TO 8100-SEND-INITIAL-MAP.
 20197
 20198     IF RETURNED-FROM-B = 'Y'
 20199         GO TO 8100-SEND-INITIAL-MAP.
 20200
 20201     MOVE SAVE-DATE              TO RUNDTEAO.
 20202     MOVE EIBTIME                TO TIME-IN.
 20203     MOVE TIME-OUT               TO RUNTIMAO.
 20204
 20205     IF EIBAID = DFHPF11
 20206        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20208        MOVE 'EL001   '          TO RETURNED-FROM
 20209        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20210        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20211        GO TO 8100-SEND-INITIAL-MAP.
 20212
 20213     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 391
* EL156.cbl
 20214
 20215     IF MAP-NAME =  'EL156A'
 20216        MOVE -1                 TO  ENTERPFL
 20217        IF PI-USES-PAID-TO
 20218           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20219           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20220           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20221        ELSE
 20222           NEXT SENTENCE
 20223     ELSE
 20224        IF MAP-NAME = 'EL156B'
 20225           IF PI-USES-PAID-TO
 20226              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20227              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20228
 20229     IF MAP-NAME =  'EL156A'
 20230        IF PI-COMPANY-ID = 'BOA'
 20231            IF PI-INT-RATE NUMERIC
 20232                MOVE PI-INT-RATE TO PINTO.
 20233     IF MAP-NAME = 'EL156A'
 20234        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20235           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20236*          MOVE 'Y'              TO EOBYNO
 20237        END-IF
 20238     END-IF
 20239
 20240
 20241* EXEC CICS SEND
 20242*        MAP   (MAP-NAME)
 20243*        MAPSET(MAPSET-NAME)
 20244*        FROM  (EL156AI)
 20245*        DATAONLY
 20246*        CURSOR
 20247*    END-EXEC.
 20248     MOVE LENGTH OF
 20249      EL156AI
 20250       TO DFHEIV12
 20251     MOVE -1
 20252       TO DFHEIV11
 20253*    MOVE '8$D    CT       H L F ,   #00018046' TO DFHEIV0
 20254     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20255     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20256     MOVE X'2020233030303138303436' TO DFHEIV0(25:11)
 20257     CALL 'kxdfhei1' USING DFHEIV0,
 20258           MAP-NAME,
 20259           EL156AI,
 20260           DFHEIV12,
 20261           MAPSET-NAME,
 20262           DFHEIV99,
 20263           DFHEIV99,
 20264           DFHEIV99,
 20265           DFHEIV11,
 20266           DFHEIV99,
 20267           DFHEIV99,
 20268           DFHEIV99
 20269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20270
 20271
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 392
* EL156.cbl
 20272     GO TO 9100-RETURN-TRAN.
 20273
 20274 8300-SEND-TEXT.
 20275
 20276* EXEC CICS SEND TEXT
 20277*        FROM(LOGOFF-TEXT)
 20278*        LENGTH(LOGOFF-LENGTH)
 20279*        ERASE
 20280*        FREEKB
 20281*    END-EXEC.
 20282*    MOVE '8&      T  E F  H   F -   #00018057' TO DFHEIV0
 20283     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20284     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20285     MOVE X'2020233030303138303537' TO DFHEIV0(25:11)
 20286     CALL 'kxdfhei1' USING DFHEIV0,
 20287           LOGOFF-TEXT,
 20288           LOGOFF-LENGTH,
 20289           DFHEIV99,
 20290           DFHEIV99,
 20291           DFHEIV99,
 20292           DFHEIV99,
 20293           DFHEIV99,
 20294           DFHEIV99,
 20295           DFHEIV99,
 20296           DFHEIV99,
 20297           DFHEIV99,
 20298           DFHEIV99
 20299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20300
 20301
 20302
 20303* EXEC CICS RETURN
 20304*    END-EXEC.
 20305*    MOVE '.(                    ''   #00018064' TO DFHEIV0
 20306     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20307     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20308     MOVE X'2020233030303138303634' TO DFHEIV0(25:11)
 20309     CALL 'kxdfhei1' USING DFHEIV0,
 20310           DFHEIV99,
 20311           DFHEIV99,
 20312           DFHEIV99,
 20313           DFHEIV99,
 20314           DFHEIV99,
 20315           DFHEIV99
 20316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20317
 20318
 20319 8500-FILE-NOTOPEN.
 20320     IF FILE-SWITCH = 'MSTR'
 20321         MOVE ER-0154            TO EMI-ERROR.
 20322     IF FILE-SWITCH = 'TRLR'
 20323         MOVE ER-0172            TO EMI-ERROR.
 20324     IF FILE-SWITCH = 'CERT'
 20325         MOVE ER-0169            TO EMI-ERROR.
 20326     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20327                      'PROC' OR 'STAT'
 20328         MOVE ER-0042            TO EMI-ERROR.
 20329     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 393
* EL156.cbl
 20330         MOVE ER-0338            TO EMI-ERROR.
 20331     IF FILE-SWITCH = 'ACCT'
 20332         MOVE ER-0168            TO EMI-ERROR.
 20333
 20334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20335     MOVE -1                     TO PMTTYPEL.
 20336
 20337     IF FIRST-ENTRY = 'Y'
 20338         GO TO 8100-SEND-INITIAL-MAP.
 20339
 20340     GO TO 8200-SEND-DATAONLY.
 20341
 20342 8600-PGRM-NOT-FOUND.
 20343
 20344     MOVE ER-0923                TO EMI-ERROR.
 20345     MOVE -1                     TO ENTPFBL.
 20346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20347
 20348     IF FIRST-ENTRY = 'Y'
 20349         GO TO 8100-SEND-INITIAL-MAP
 20350     ELSE
 20351         GO TO 8200-SEND-DATAONLY.
 20352
 20353 8800-UNAUTHORIZED-ACCESS.
 20354     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20355     GO TO 8300-SEND-TEXT.
 20356
 20357 8810-PF23.
 20358     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20359     MOVE XCTL-005               TO PGM-NAME.
 20360     GO TO 9300-XCTL.
 20361
 20362 8820-PF7-8.
 20363     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20364     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20365                                    PI-SAVED-PROGRAM-2
 20366                                    PI-SAVED-PROGRAM-3
 20367                                    PI-SAVED-PROGRAM-4
 20368                                    PI-SAVED-PROGRAM-5
 20369                                    PI-SAVED-PROGRAM-6
 20370                                    PI-RETURN-TO-PROGRAM.
 20371     IF EIBAID = DFHPF8
 20372        MOVE XCTL-132            TO PGM-NAME
 20373     ELSE
 20374        MOVE XCTL-130            TO PGM-NAME.
 20375
 20376     GO TO 9300-XCTL.
 20377
 20378 9100-RETURN-TRAN.
 20379     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20380     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20381
 20382
 20383* EXEC CICS RETURN
 20384*        TRANSID(TRANS-ID)
 20385*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20386*        LENGTH(PI-COMM-LENGTH)
 20387*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 394
* EL156.cbl
 20388*    MOVE '.(CT                  ''   #00018130' TO DFHEIV0
 20389     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20391     MOVE X'2020233030303138313330' TO DFHEIV0(25:11)
 20392     CALL 'kxdfhei1' USING DFHEIV0,
 20393           TRANS-ID,
 20394           PROGRAM-INTERFACE-BLOCK,
 20395           PI-COMM-LENGTH,
 20396           DFHEIV99,
 20397           DFHEIV99,
 20398           DFHEIV99
 20399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20400
 20401
 20402 9200-RETURN-MAIN-MENU.
 20403     MOVE XCTL-126               TO PGM-NAME.
 20404     GO TO 9300-XCTL.
 20405
 20406 9300-XCTL.
 20407
 20408* EXEC CICS XCTL
 20409*        PROGRAM(PGM-NAME)
 20410*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20411*        LENGTH(PI-COMM-LENGTH)
 20412*    END-EXEC.
 20413*    MOVE '.$C                   %   #00018141' TO DFHEIV0
 20414     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20415     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20416     MOVE X'2020233030303138313431' TO DFHEIV0(25:11)
 20417     CALL 'kxdfhei1' USING DFHEIV0,
 20418           PGM-NAME,
 20419           PROGRAM-INTERFACE-BLOCK,
 20420           PI-COMM-LENGTH,
 20421           DFHEIV99
 20422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20423
 20424
 20425 9400-CLEAR.
 20426     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20427     GO TO 9300-XCTL.
 20428
 20429 9500-PF12.
 20430     MOVE XCTL-010               TO PGM-NAME.
 20431     GO TO 9300-XCTL.
 20432
 20433 9700-LINK-DATE-CONVERT.
 20434     MOVE LINK-ELDATCV           TO PGM-NAME.
 20435
 20436* EXEC CICS LINK
 20437*        PROGRAM   (PGM-NAME)
 20438*        COMMAREA  (DATE-CONVERSION-DATA)
 20439*        LENGTH    (DC-COMM-LENGTH)
 20440*    END-EXEC.
 20441*    MOVE '."C                   (   #00018157' TO DFHEIV0
 20442     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20444     MOVE X'2020233030303138313537' TO DFHEIV0(25:11)
 20445     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 395
* EL156.cbl
 20446           PGM-NAME,
 20447           DATE-CONVERSION-DATA,
 20448           DC-COMM-LENGTH,
 20449           DFHEIV99,
 20450           DFHEIV99,
 20451           DFHEIV99,
 20452           DFHEIV99
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456 9700-EXIT.
 20457     EXIT.
 20458
 20459 9800-LINK-REM-TERM.
 20460     MOVE LINK-REMTERM TO PGM-NAME.
 20461
 20462
 20463* EXEC CICS LINK
 20464*        PROGRAM   (PGM-NAME)
 20465*        COMMAREA  (CALCULATION-PASS-AREA)
 20466*        LENGTH    (CP-COMM-LENGTH)
 20467*    END-EXEC.
 20468*    MOVE '."C                   (   #00018169' TO DFHEIV0
 20469     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20471     MOVE X'2020233030303138313639' TO DFHEIV0(25:11)
 20472     CALL 'kxdfhei1' USING DFHEIV0,
 20473           PGM-NAME,
 20474           CALCULATION-PASS-AREA,
 20475           CP-COMM-LENGTH,
 20476           DFHEIV99,
 20477           DFHEIV99,
 20478           DFHEIV99,
 20479           DFHEIV99
 20480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20481
 20482
 20483 9800-EXIT.
 20484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 396
* EL156.cbl
 20486 9830-DMD-REMAINING-TERM.
 20487
 20488     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20489         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20490
 20491     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20492                              CM-PMT-EXTENSION-DAYS.
 20493
 20494     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20495                                  CL-NO-OF-DAYS-PAID.
 20496
 20497     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20498         GIVING W-REM REMAINDER W-REM-DAYS.
 20499
 20500     MOVE W-REM                  TO WST-REM.
 20501
 20502     IF W-REM-DAYS > ZEROS
 20503         MOVE '/'                TO WST-SLASH
 20504         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20505     ELSE
 20506         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20507
 20508 9830-EXIT.
 20509     EXIT.
 20510
 20511 9870-OUTPUT-ACTIVITY-RECORD.
 20512
 20513
 20514* EXEC CICS GETMAIN
 20515*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20516*         LENGTH(25)
 20517*         INITIMG(WS-BLANK)
 20518*    END-EXEC.
 20519     MOVE 25
 20520       TO DFHEIV11
 20521*    MOVE ',"IL                  $   #00018205' TO DFHEIV0
 20522     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20524     MOVE X'2020233030303138323035' TO DFHEIV0(25:11)
 20525     CALL 'kxdfhei1' USING DFHEIV0,
 20526           DFHEIV20,
 20527           DFHEIV11,
 20528           WS-BLANK
 20529     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20530         DFHEIV20
 20531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20532
 20533
 20534     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20535     MOVE ELMSTR-KEY             TO DA-KEY.
 20536     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20537
 20538     IF PI-PMTTYPE EQUAL '7'
 20539         MOVE 'V'                TO DA-RECORD-TYPE
 20540     ELSE
 20541         MOVE 'P'                TO DA-RECORD-TYPE.
 20542
 20543
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 397
* EL156.cbl
 20544* EXEC CICS HANDLE CONDITION
 20545*         NOTOPEN(9870-NOTOPEN)
 20546*         DUPREC(9870-EXIT)
 20547*    END-EXEC.
 20548*    MOVE '"$J%                  ! B #00018220' TO DFHEIV0
 20549     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20551     MOVE X'4220233030303138323230' TO DFHEIV0(25:11)
 20552     CALL 'kxdfhei1' USING DFHEIV0
 20553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20554
 20555
 20556
 20557* EXEC CICS WRITE
 20558*         DATASET('DLYACTV')
 20559*         RIDFLD(DA-KEY)
 20560*         FROM(DAILY-ACTIVITY-RECORD)
 20561*         LENGTH(25)
 20562*    END-EXEC.
 20563     MOVE 'DLYACTV' TO DFHEIV1
 20564     MOVE 25
 20565       TO DFHEIV11
 20566*    MOVE '&$ L                  ''   #00018225' TO DFHEIV0
 20567     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20568     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20569     MOVE X'2020233030303138323235' TO DFHEIV0(25:11)
 20570     CALL 'kxdfhei1' USING DFHEIV0,
 20571           DFHEIV1,
 20572           DAILY-ACTIVITY-RECORD,
 20573           DFHEIV11,
 20574           DA-KEY,
 20575           DFHEIV99,
 20576           DFHEIV99
 20577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20578
 20579     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20580     GO TO 9870-EXIT.
 20581
 20582 9870-NOTOPEN.
 20583
 20584     MOVE '2955'                 TO EMI-ERROR.
 20585     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20586
 20587 9870-EXIT.
 20588     EXIT.
 20589
 20590 9900-ERROR-FORMAT.
 20591
 20592     IF EMI-ERROR = ER-0923
 20593         MOVE PGM-NAME           TO W-CALLED-NAME.
 20594
 20595     MOVE LINK-001      TO PGM-NAME.
 20596     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20597
 20598
 20599* EXEC CICS LINK
 20600*        PROGRAM (PGM-NAME)
 20601*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 398
* EL156.cbl
 20602*        LENGTH  (EMI-COMM-LENGTH)
 20603*    END-EXEC.
 20604*    MOVE '."C                   (   #00018250' TO DFHEIV0
 20605     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20607     MOVE X'2020233030303138323530' TO DFHEIV0(25:11)
 20608     CALL 'kxdfhei1' USING DFHEIV0,
 20609           PGM-NAME,
 20610           ERROR-MESSAGE-INTERFACE-BLOCK,
 20611           EMI-COMM-LENGTH,
 20612           DFHEIV99,
 20613           DFHEIV99,
 20614           DFHEIV99,
 20615           DFHEIV99
 20616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20617
 20618
 20619     IF EMI-ERROR = ER-0923
 20620         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20621
 20622 9900-EXIT.
 20623     EXIT.
 20624
 20625 9990-ABEND.
 20626     MOVE LINK-004               TO PGM-NAME.
 20627     MOVE DFHEIBLK               TO EMI-LINE1.
 20628
 20629* EXEC CICS LINK
 20630*        PROGRAM   (PGM-NAME)
 20631*        COMMAREA  (EMI-LINE1)
 20632*        LENGTH    (64)
 20633*    END-EXEC.
 20634     MOVE 64
 20635       TO DFHEIV11
 20636*    MOVE '."C                   (   #00018265' TO DFHEIV0
 20637     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20639     MOVE X'2020233030303138323635' TO DFHEIV0(25:11)
 20640     CALL 'kxdfhei1' USING DFHEIV0,
 20641           PGM-NAME,
 20642           EMI-LINE1,
 20643           DFHEIV11,
 20644           DFHEIV99,
 20645           DFHEIV99,
 20646           DFHEIV99,
 20647           DFHEIV99
 20648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20649
 20650
 20651     MOVE 'EL156A'               TO  MAP-NAME.
 20652     MOVE LOW-VALUES             TO  EL156AO.
 20653     GO TO 8100-SEND-INITIAL-MAP.
 20654
 20655 9995-SECURITY-VIOLATION.
 20656*    COPY ELCSCTP.
 20657******************************************************************
 20658*                                                                *
 20659*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 399
* EL156.cbl
 20660*                            VMOD=2.001                          *
 20661*                                                                *
 20662*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20663******************************************************************
 20664
 20665
 20666     MOVE EIBDATE          TO SM-JUL-DATE.
 20667     MOVE EIBTRMID         TO SM-TERMID.
 20668     MOVE THIS-PGM         TO SM-PGM.
 20669     MOVE EIBTIME          TO TIME-IN.
 20670     MOVE TIME-OUT         TO SM-TIME.
 20671     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20672
 20673
 20674* EXEC CICS LINK
 20675*         PROGRAM  ('EL003')
 20676*         COMMAREA (SECURITY-MESSAGE)
 20677*         LENGTH   (80)
 20678*    END-EXEC.
 20679     MOVE 'EL003' TO DFHEIV1
 20680     MOVE 80
 20681       TO DFHEIV11
 20682*    MOVE '."C                   (   #00018293' TO DFHEIV0
 20683     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20685     MOVE X'2020233030303138323933' TO DFHEIV0(25:11)
 20686     CALL 'kxdfhei1' USING DFHEIV0,
 20687           DFHEIV1,
 20688           SECURITY-MESSAGE,
 20689           DFHEIV11,
 20690           DFHEIV99,
 20691           DFHEIV99,
 20692           DFHEIV99,
 20693           DFHEIV99
 20694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20695
 20696
 20697******************************************************************
 20698
 20699
 20700
 20701 9999-DFHBACK SECTION.
 20702     MOVE '9%                    "   ' TO DFHEIV0
 20703     MOVE 'EL156' TO DFHEIV1
 20704     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20705     GOBACK.
 20706 9999-DFHEXIT.
 20707     IF DFHEIGDJ EQUAL 0001
 20708         NEXT SENTENCE
 20709     ELSE IF DFHEIGDJ EQUAL 2
 20710         GO TO 9990-ABEND,
 20711               8600-PGRM-NOT-FOUND,
 20712               0400-FIRST-TIME,
 20713               6180-DUPREC,
 20714               9990-ABEND
 20715         DEPENDING ON DFHEIGDI
 20716     ELSE IF DFHEIGDJ EQUAL 3
 20717         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 400
* EL156.cbl
 20718               0380-CLAIM-END-FILE
 20719         DEPENDING ON DFHEIGDI
 20720     ELSE IF DFHEIGDJ EQUAL 4
 20721         GO TO 0380-CLAIM-END-FILE,
 20722               0380-CLAIM-END-FILE
 20723         DEPENDING ON DFHEIGDI
 20724     ELSE IF DFHEIGDJ EQUAL 5
 20725         GO TO 0800-EXIT
 20726         DEPENDING ON DFHEIGDI
 20727     ELSE IF DFHEIGDJ EQUAL 6
 20728         GO TO 1950-NOT-FOUND,
 20729               1950-NOT-FOUND
 20730         DEPENDING ON DFHEIGDI
 20731     ELSE IF DFHEIGDJ EQUAL 7
 20732         GO TO 1950-NOT-FOUND
 20733         DEPENDING ON DFHEIGDI
 20734     ELSE IF DFHEIGDJ EQUAL 8
 20735         GO TO 1950-NOT-FOUND,
 20736               1950-NOT-FOUND
 20737         DEPENDING ON DFHEIGDI
 20738     ELSE IF DFHEIGDJ EQUAL 9
 20739         GO TO 1166-END-CHECK,
 20740               1166-END-CHECK
 20741         DEPENDING ON DFHEIGDI
 20742     ELSE IF DFHEIGDJ EQUAL 10
 20743         GO TO 1950-NOT-FOUND,
 20744               1950-NOT-FOUND
 20745         DEPENDING ON DFHEIGDI
 20746     ELSE IF DFHEIGDJ EQUAL 11
 20747         GO TO 1950-NOT-FOUND,
 20748               1950-NOT-FOUND
 20749         DEPENDING ON DFHEIGDI
 20750     ELSE IF DFHEIGDJ EQUAL 12
 20751         GO TO 1950-NOT-FOUND
 20752         DEPENDING ON DFHEIGDI
 20753     ELSE IF DFHEIGDJ EQUAL 13
 20754         GO TO 3600-CONTINUE
 20755         DEPENDING ON DFHEIGDI
 20756     ELSE IF DFHEIGDJ EQUAL 14
 20757         GO TO 5300-NOTE-NOT-FOUND
 20758         DEPENDING ON DFHEIGDI
 20759     ELSE IF DFHEIGDJ EQUAL 15
 20760         GO TO 6065-NOT-FOUND
 20761         DEPENDING ON DFHEIGDI
 20762     ELSE IF DFHEIGDJ EQUAL 16
 20763         GO TO 6068-ACCT-NOT-FND
 20764         DEPENDING ON DFHEIGDI
 20765     ELSE IF DFHEIGDJ EQUAL 17
 20766         GO TO 6074-GET-COMP-DATA
 20767         DEPENDING ON DFHEIGDI
 20768     ELSE IF DFHEIGDJ EQUAL 18
 20769         GO TO 6170-WRITE
 20770         DEPENDING ON DFHEIGDI
 20771     ELSE IF DFHEIGDJ EQUAL 19
 20772         GO TO 6180-DUPREC
 20773         DEPENDING ON DFHEIGDI
 20774     ELSE IF DFHEIGDJ EQUAL 20
 20775         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 30-Apr-19 13:22 Page 401
* EL156.cbl
 20776         DEPENDING ON DFHEIGDI
 20777     ELSE IF DFHEIGDJ EQUAL 21
 20778         GO TO 6185-DUPREC
 20779         DEPENDING ON DFHEIGDI
 20780     ELSE IF DFHEIGDJ EQUAL 22
 20781         GO TO 6720-BUILD-NEW-RECORD
 20782         DEPENDING ON DFHEIGDI
 20783     ELSE IF DFHEIGDJ EQUAL 23
 20784         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20785               6900-BUILD-ARCHIVE-HEADER
 20786         DEPENDING ON DFHEIGDI
 20787     ELSE IF DFHEIGDJ EQUAL 24
 20788         GO TO 7010-BUILD-MAP
 20789         DEPENDING ON DFHEIGDI
 20790     ELSE IF DFHEIGDJ EQUAL 25
 20791         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20792         DEPENDING ON DFHEIGDI
 20793     ELSE IF DFHEIGDJ EQUAL 26
 20794         GO TO 7160-DUPREC
 20795         DEPENDING ON DFHEIGDI
 20796     ELSE IF DFHEIGDJ EQUAL 27
 20797         GO TO 7200-EXIT,
 20798               7200-EXIT
 20799         DEPENDING ON DFHEIGDI
 20800     ELSE IF DFHEIGDJ EQUAL 28
 20801         GO TO 7400-NOT-FOUND
 20802         DEPENDING ON DFHEIGDI
 20803     ELSE IF DFHEIGDJ EQUAL 29
 20804         GO TO 7590-END,
 20805               7590-END
 20806         DEPENDING ON DFHEIGDI
 20807     ELSE IF DFHEIGDJ EQUAL 30
 20808         GO TO 7699-EXIT
 20809         DEPENDING ON DFHEIGDI
 20810     ELSE IF DFHEIGDJ EQUAL 31
 20811         GO TO 5300-NOTE-NOT-FOUND
 20812         DEPENDING ON DFHEIGDI
 20813     ELSE IF DFHEIGDJ EQUAL 32
 20814         GO TO 7800-COMP-NOTFND
 20815         DEPENDING ON DFHEIGDI
 20816     ELSE IF DFHEIGDJ EQUAL 33
 20817         GO TO 7920-NOT-FOUND
 20818         DEPENDING ON DFHEIGDI
 20819     ELSE IF DFHEIGDJ EQUAL 34
 20820         GO TO 9870-NOTOPEN,
 20821               9870-EXIT
 20822         DEPENDING ON DFHEIGDI.
 20823     MOVE '9%                    "   ' TO DFHEIV0
 20824     MOVE 'EL156' TO DFHEIV1
 20825     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20826     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12852     Code:       77851
