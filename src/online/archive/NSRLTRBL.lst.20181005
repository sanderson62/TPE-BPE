* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   1
* NSRLTRBL.cbl
* Options: int("NSRLTRBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRLTRBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRLTRBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRLTRBL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRLTRBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSREQLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   2
* NSRLTRBL.cbl
    14* 121802    2009122800001  PEMA  NEW PROGRAM
    15* 022212    2011120900003  AJRA  ADD AHL
    16* 031912    2011120900003  AJRA  ADD AHL CLAIM NO TO EXTRACT
    17* 020513    2011090100001  PEMA  CORRECT ISS WITH MULT &
    18* 020613    2012110800002  AJRA  ADD BUS TYPE (GPCD) TO NAPERSOFT
    19* 031116    2015110400001  TANA  ADD EL150D FIELDS
    20******************************************************************
    21 ENVIRONMENT DIVISION.
    22 DATA DIVISION.
    23 working-storage section.
    24 01  DFH-START PIC X(04).
    25 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    26 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    27 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    28 77  S1                          PIC S999 COMP-3 VALUE +0.
    29 77  S2                          PIC S999 COMP-3 VALUE +0.
    30 77  S3                          PIC S999 COMP-3 VALUE +0.
    31 77  E1                          PIC S999 COMP-3 VALUE +0.
    32 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    33 77  M1                          PIC S999 COMP-3 VALUE +0.
    34 77  P1                          PIC S999 COMP-3 VALUE +0.
    35 77  WS-HOLD-KEY                 PIC X(20).
    36 77  WS-HOLD-S1                  PIC S999 COMP-3 VALUE +0.
    37 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    38 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    39 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    40 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    41 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    42 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    43 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    44 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    45 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    46 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    47     88  FOUND-BENE                  VALUE 'Y'.
    48 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    49 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    50 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    51 77  WS-CNTR                     pic s999 comp-3 value +0.
    52 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    53 77  WS-ACCUM-DAYS               PIC S9(5) COMP-3 VALUE +0.
    54 77  WS-ACCUM-AMT                PIC S9(9)V99 COMP-3 VALUE +0.
    55 77  WS-ACCUM-PD-BENS            PIC S999 COMP-3 VALUE +0.
    56 77  WS-PREV-CLM-TYPE            PIC X   VALUE ' '.
    57 77  WS-PREV-INS-TYPE            PIC X   VALUE ' '.
    58 77  WS-PREV-BEN-PER             PIC 99 VALUE ZEROS.
    59 77  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
    60     88  PDEF-FOUND                   VALUE 'Y'.
    61 77  wk1                         pic 999 value zeros.
    62 77  wk2                         pic 999 value zeros.
    63 77  WS-WORK-BEN-PCT             PIC S9V999 COMP-3 VALUE +0.
    64 77  WS-MAX-SUB                  PIC 9(4)    VALUE ZEROS.
    65 01  output-screen-work-area.
    66     05  os-prev-key.
    67         10  os-prev-clm-type        pic x.
    68         10  os-prev-ins-type        pic x.
    69     05  ws-pd-bens                  pic 999 value zeros.
    70     05  ws-cov-rem-bens             pic s999 value zeros.
    71 01  WS-XML-WORK                 PIC X(2500)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   3
* NSRLTRBL.cbl
    72 01 response-code         pic s9(8) comp.
    73 01 display-response      pic 9(8).
    74 01 bl-index              pic 9(8) comp.
    75 01 max-last-name         pic x(18).
    76 01 first-initial         pic x.
    77 01 name-in-range-flag    pic 9.
    78 01 max-entries           pic s9(8) comp value 100.
    79 01 lower-case    pic x(26) value
    80            "abcdefghijklmnopqrstuvwxyz".
    81 01 upper-case    pic x(26) value
    82            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    83 01  W-Z-CONTROL-DATA.
    84     05  W-NUMBER-OF-COPIES  PIC  9(01).
    85     05  FILLER              PIC  X(01).
    86     05  W-DAYS-TO-FOLLOW-UP PIC  9(03).
    87     05  FILLER              PIC  X(01).
    88     05  W-DAYS-TO-RESEND-1  PIC  9(03).
    89     05  FILLER              PIC  X(01).
    90     05  W-FORM-TO-RESEND    PIC  X(04).
    91     05  FILLER              PIC  X(01).
    92     05  W-PROMPT-LETTER     PIC  X(01).
    93     05  FILLER              PIC  X(01).
    94     05  W-ENCLOSURE-CD      PIC  X(03).
    95     05  FILLER              PIC  X(1).
    96     05  W-AUTO-CLOSE-IND    PIC  X(1).
    97     05  FILLER              PIC  X(1).
    98     05  W-LETTER-TO-BENE    PIC  X(1).
    99 01  MISC.
   100     12  WS-RESPONSE             PIC S9(8)   COMP.
   101         88  RESP-NORMAL                  VALUE +00.
   102         88  RESP-NOTFND                  VALUE +13.
   103         88  RESP-DUPREC                  VALUE +14.
   104         88  RESP-DUPKEY                  VALUE +15.
   105         88  RESP-NOTOPEN                 VALUE +19.
   106         88  RESP-ENDFILE                 VALUE +20.
   107 01  WS-ELENCC-KEY.
   108     05  WS-ELENCC-COMPANY-CD    PIC X.
   109     05  WS-ELENCC-REC-TYPE      PIC X.
   110     05  WS-ELENCC-ENC-CODE      PIC X(5).
   111     05  F                       PIC X(09).
   112 01  WS-ELMSTR-KEY.
   113     05  WS-ELMSTR-COMPANY-CD    PIC X.
   114     05  WS-ELMSTR-CARRIER       PIC X.
   115     05  WS-ELMSTR-CLAIM-NO      PIC X(7).
   116     05  WS-ELMSTR-CERT-NO       PIC X(11).
   117 01  WS-ELTRLR-KEY.
   118     05  WS-ELTRLR-COMPANY-CD    PIC X.
   119     05  WS-ELTRLR-CARRIER       PIC X.
   120     05  WS-ELTRLR-CLAIM-NO      PIC X(7).
   121     05  WS-ELTRLR-CERT-NO       PIC X(11).
   122     05  WS-ELTRLR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   123 01  WS-ELCERT-KEY.
   124     05  WS-ELCERT-COMPANY-CD    PIC X.
   125     05  WS-ELCERT-CARRIER       PIC X.
   126     05  WS-ELCERT-GROUP         PIC X(6).
   127     05  WS-ELCERT-STATE         PIC XX.
   128     05  WS-ELCERT-ACCOUNT       PIC X(10).
   129     05  WS-ELCERT-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   4
* NSRLTRBL.cbl
   130     05  WS-ELCERT-CERT-NO       PIC X(11).
   131 01  WS-ERACCT-KEY.
   132     05  WS-ERACCT-COMPANY-CD    PIC X.
   133     05  WS-ERACCT-CARRIER       PIC X.
   134     05  WS-ERACCT-GROUP         PIC X(6).
   135     05  WS-ERACCT-STATE         PIC XX.
   136     05  WS-ERACCT-ACCOUNT       PIC X(10).
   137     05  WS-ERACCT-EXP-DT        PIC XX.
   138     05  FILLER                  PIC XXXX.
   139 01  WS-ELBENE-KEY.
   140     05  WS-ELBENE-COMPANY-CD    PIC X.
   141     05  WS-ELBENE-REC-TYPE      PIC X.
   142     05  WS-ELBENE-BENE          PIC X(10).
   143 01  WS-ELLETR-KEY.
   144     05  WS-ELLETR-COMPANY-CD    PIC X.
   145     05  WS-ELLETR-LETTER-ID     PIC X(12).
   146     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   147 01  WS-ELCNTL-KEY.
   148     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   149     05  WS-ELCNTL-REC-TYPE      PIC X.
   150     05  WS-ELCNTL-GENL.
   151         10  FILLER              PIC XX  VALUE SPACES.
   152         10  WS-ELCNTL-BEN-CD    PIC XX.
   153     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   154 01  ACCESS-KEYS.
   155     12  ELCRTT-KEY.
   156         16  CRTT-COMP-CD            PIC X.
   157         16  CRTT-CARRIER            PIC X.
   158         16  CRTT-GROUPING           PIC X(6).
   159         16  CRTT-STATE              PIC XX.
   160         16  CRTT-ACCOUNT            PIC X(10).
   161         16  CRTT-EFF-DT             PIC XX.
   162         16  CRTT-CERT-NO            PIC X(11).
   163         16  CRTT-REC-TYPE           PIC X.
   164
   165 01  ERPDEF-KEY-SAVE             PIC X(18).
   166 01  ERPDEF-KEY.
   167     12  ERPDEF-COMPANY-CD       PIC X.
   168     12  ERPDEF-STATE            PIC XX.
   169     12  ERPDEF-PROD-CD          PIC XXX.
   170     12  F                       PIC X(7).
   171     12  ERPDEF-BEN-TYPE         PIC X.
   172     12  ERPDEF-BEN-CODE         PIC XX.
   173     12  ERPDEF-EXP-DT           PIC XX.
   174 01  TEXT-WORK-AREAS.
   175     05  WS-COV-TYPE             PIC X(4) VALUE SPACES.
   176 01  WS-UNSORTED-TABLE.
   177     12  WS-UNSRTD-TABLE   OCCURS 25 TIMES.
   178         16  WS-KEY.
   179             20  WS-CLM-TYPE     PIC X.
   180             20  WS-INS-TYPE     PIC X.
   181             20  WS-BEN-PER      PIC 99.
   182             20  WS-INC-DT       PIC XX.
   183         16  WS-EXCL-PER         PIC 999.
   184         16  WS-COV-ENDS         PIC 999.
   185         16  WS-ACC-PER          PIC 999.
   186         16  WS-MAX-BENS         PIC 999.
   187         16  WS-REC-MOS          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   5
* NSRLTRBL.cbl
   188         16  WS-MAX-EXTEN        PIC 99.
   189         16  WS-STATUS           PIC X.
   190         16  WS-PD-THRU-DT       PIC XX.
   191         16  WS-CLAIM-NO         PIC X(7).
   192         16  WS-MAX-MOBEN        PIC S9(7)V99 COMP-3.
   193         16  WS-TOTAL-PAID       PIC S9(7)V99 COMP-3.
   194         16  WS-REM-BENS         PIC 999.
   195         16  WS-SORTED-SW        PIC X.
   196 01  WS-SORTED-TABLE.
   197     12  WS-SRTD-TABLE OCCURS 25 TIMES.
   198         16  WS-SRTD-KEY.
   199             20  WS-SRTD-CLM-TYPE PIC X.
   200             20  WS-SRTD-INS-TYPE PIC X.
   201             20  WS-SRTD-BEN-PER PIC 99.
   202             20  WS-SRTD-INC-DT  PIC XX.
   203         16  WS-SRTD-EXCL-PER    PIC 999.
   204         16  WS-SRTD-COV-ENDS    PIC 999.
   205         16  WS-SRTD-ACC-PER     PIC 999.
   206         16  WS-SRTD-MAX-BENS    PIC 999.
   207         16  WS-SRTD-REC-MOS     PIC 99.
   208         16  WS-SRTD-MAX-EXTEN   PIC 99.
   209         16  WS-SRTD-STATUS      PIC X.
   210         16  WS-SRTD-PD-THRU-DT  PIC XX.
   211         16  WS-SRTD-CLAIM-NO    PIC X(7).
   212         16  WS-SRTD-MAX-MOBEN   PIC S9(7)V99 COMP-3.
   213         16  WS-SRTD-TOTAL-PAID  PIC S9(7)V99 COMP-3.
   214         16  WS-SRTD-REM-BENS    PIC 999.
   215         16  WS-SRTD-SW          PIC X.
   216 01  SAVE-ACCOUNT-MASTER         PIC X(2000) VALUE SPACES.
   217*                                COPY ELCDATE.
   218******************************************************************
   219*                                                                *
   220*                                                                *
   221*                            ELCDATE.                            *
   222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   223*                            VMOD=2.003
   224*                                                                *
   225*                                                                *
   226*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   227*                 LENGTH = 200                                   *
   228******************************************************************
   229
   230 01  DATE-CONVERSION-DATA.
   231     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   232     12  DC-OPTION-CODE                PIC X.
   233         88  BIN-TO-GREG                VALUE ' '.
   234         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   235         88  EDIT-GREG-TO-BIN           VALUE '2'.
   236         88  YMD-GREG-TO-BIN            VALUE '3'.
   237         88  MDY-GREG-TO-BIN            VALUE '4'.
   238         88  JULIAN-TO-BIN              VALUE '5'.
   239         88  BIN-PLUS-ELAPSED           VALUE '6'.
   240         88  FIND-CENTURY               VALUE '7'.
   241         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   242         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   243         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   244         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   245         88  JULIAN-TO-BIN-3            VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   6
* NSRLTRBL.cbl
   246         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   247         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   248         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   249         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   250         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   251         88  CHECK-LEAP-YEAR            VALUE 'H'.
   252         88  BIN-3-TO-GREG              VALUE 'I'.
   253         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   254         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   255         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   256         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   257         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   258         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   259         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   260         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   261         88  THREE-CHARACTER-BIN
   262                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   263         88  GREGORIAN-TO-BIN
   264                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   265         88  BIN-TO-GREGORIAN
   266                  VALUES ' ' '1' 'I' '8' 'G'.
   267         88  JULIAN-TO-BINARY
   268                  VALUES '5' 'C' 'E' 'F'.
   269     12  DC-ERROR-CODE                 PIC X.
   270         88  NO-CONVERSION-ERROR        VALUE ' '.
   271         88  DATE-CONVERSION-ERROR
   272                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   273         88  DATE-IS-ZERO               VALUE '1'.
   274         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   275         88  DATE-IS-INVALID            VALUE '3'.
   276         88  DATE1-GREATER-DATE2        VALUE '4'.
   277         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   278         88  DATE-INVALID-OPTION        VALUE '9'.
   279         88  INVALID-CENTURY            VALUE 'A'.
   280         88  ONLY-CENTURY               VALUE 'B'.
   281         88  ONLY-LEAP-YEAR             VALUE 'C'.
   282         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   283     12  DC-END-OF-MONTH               PIC X.
   284         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   285     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   286         88  USE-NORMAL-PROCESS         VALUE ' '.
   287         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   288         88  ADJUST-UP-100-YRS          VALUE '2'.
   289     12  FILLER                        PIC X.
   290     12  DC-CONVERSION-DATES.
   291         16  DC-BIN-DATE-1             PIC XX.
   292         16  DC-BIN-DATE-2             PIC XX.
   293         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   294         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   295                       DC-GREG-DATE-1-EDIT.
   296             20  DC-EDIT1-MONTH        PIC 99.
   297             20  SLASH1-1              PIC X.
   298             20  DC-EDIT1-DAY          PIC 99.
   299             20  SLASH1-2              PIC X.
   300             20  DC-EDIT1-YEAR         PIC 99.
   301         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   302         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   303                     DC-GREG-DATE-2-EDIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   7
* NSRLTRBL.cbl
   304             20  DC-EDIT2-MONTH        PIC 99.
   305             20  SLASH2-1              PIC X.
   306             20  DC-EDIT2-DAY          PIC 99.
   307             20  SLASH2-2              PIC X.
   308             20  DC-EDIT2-YEAR         PIC 99.
   309         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   310         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   311                     DC-GREG-DATE-1-YMD.
   312             20  DC-YMD-YEAR           PIC 99.
   313             20  DC-YMD-MONTH          PIC 99.
   314             20  DC-YMD-DAY            PIC 99.
   315         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   316         16  DC-GREG-DATE-1-MDY-R REDEFINES
   317                      DC-GREG-DATE-1-MDY.
   318             20  DC-MDY-MONTH          PIC 99.
   319             20  DC-MDY-DAY            PIC 99.
   320             20  DC-MDY-YEAR           PIC 99.
   321         16  DC-GREG-DATE-1-ALPHA.
   322             20  DC-ALPHA-MONTH        PIC X(10).
   323             20  DC-ALPHA-DAY          PIC 99.
   324             20  FILLER                PIC XX.
   325             20  DC-ALPHA-CENTURY.
   326                 24 DC-ALPHA-CEN-N     PIC 99.
   327             20  DC-ALPHA-YEAR         PIC 99.
   328         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   329         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   330         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   331         16  DC-JULIAN-DATE            PIC 9(05).
   332         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   333                                       PIC 9(05).
   334         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   335             20  DC-JULIAN-YEAR        PIC 99.
   336             20  DC-JULIAN-DAYS        PIC 999.
   337         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   338         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   339         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   340     12  DATE-CONVERSION-VARIBLES.
   341         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   342         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   343             20  FILLER                PIC 9(3).
   344             20  HOLD-CEN-1-CCYY.
   345                 24  HOLD-CEN-1-CC     PIC 99.
   346                 24  HOLD-CEN-1-YY     PIC 99.
   347             20  HOLD-CEN-1-MO         PIC 99.
   348             20  HOLD-CEN-1-DA         PIC 99.
   349         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   350             20  HOLD-CEN-1-R-MO       PIC 99.
   351             20  HOLD-CEN-1-R-DA       PIC 99.
   352             20  HOLD-CEN-1-R-CCYY.
   353                 24  HOLD-CEN-1-R-CC   PIC 99.
   354                 24  HOLD-CEN-1-R-YY   PIC 99.
   355             20  FILLER                PIC 9(3).
   356         16  HOLD-CENTURY-1-X.
   357             20  FILLER                PIC X(3)  VALUE SPACES.
   358             20  HOLD-CEN-1-X-CCYY.
   359                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   360                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   361             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   8
* NSRLTRBL.cbl
   362             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   363         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   364             20  HOLD-CEN-1-R-X-MO     PIC XX.
   365             20  HOLD-CEN-1-R-X-DA     PIC XX.
   366             20  HOLD-CEN-1-R-X-CCYY.
   367                 24  HOLD-CEN-1-R-X-CC PIC XX.
   368                 24  HOLD-CEN-1-R-X-YY PIC XX.
   369             20  FILLER                PIC XXX.
   370         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   371         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   372         16  DC-JULIAN-DATE-1          PIC 9(07).
   373         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   374             20  DC-JULIAN-1-CCYY.
   375                 24  DC-JULIAN-1-CC    PIC 99.
   376                 24  DC-JULIAN-1-YR    PIC 99.
   377             20  DC-JULIAN-DA-1        PIC 999.
   378         16  DC-JULIAN-DATE-2          PIC 9(07).
   379         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   380             20  DC-JULIAN-2-CCYY.
   381                 24  DC-JULIAN-2-CC    PIC 99.
   382                 24  DC-JULIAN-2-YR    PIC 99.
   383             20  DC-JULIAN-DA-2        PIC 999.
   384         16  DC-GREG-DATE-A-EDIT.
   385             20  DC-EDITA-MONTH        PIC 99.
   386             20  SLASHA-1              PIC X VALUE '/'.
   387             20  DC-EDITA-DAY          PIC 99.
   388             20  SLASHA-2              PIC X VALUE '/'.
   389             20  DC-EDITA-CCYY.
   390                 24  DC-EDITA-CENT     PIC 99.
   391                 24  DC-EDITA-YEAR     PIC 99.
   392         16  DC-GREG-DATE-B-EDIT.
   393             20  DC-EDITB-MONTH        PIC 99.
   394             20  SLASHB-1              PIC X VALUE '/'.
   395             20  DC-EDITB-DAY          PIC 99.
   396             20  SLASHB-2              PIC X VALUE '/'.
   397             20  DC-EDITB-CCYY.
   398                 24  DC-EDITB-CENT     PIC 99.
   399                 24  DC-EDITB-YEAR     PIC 99.
   400         16  DC-GREG-DATE-CYMD         PIC 9(08).
   401         16  DC-GREG-DATE-CYMD-R REDEFINES
   402                              DC-GREG-DATE-CYMD.
   403             20  DC-CYMD-CEN           PIC 99.
   404             20  DC-CYMD-YEAR          PIC 99.
   405             20  DC-CYMD-MONTH         PIC 99.
   406             20  DC-CYMD-DAY           PIC 99.
   407         16  DC-GREG-DATE-MDCY         PIC 9(08).
   408         16  DC-GREG-DATE-MDCY-R REDEFINES
   409                              DC-GREG-DATE-MDCY.
   410             20  DC-MDCY-MONTH         PIC 99.
   411             20  DC-MDCY-DAY           PIC 99.
   412             20  DC-MDCY-CEN           PIC 99.
   413             20  DC-MDCY-YEAR          PIC 99.
   414    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   415        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   416    12  DC-EL310-DATE                  PIC X(21).
   417    12  FILLER                         PIC X(28).
   418*                                COPY ELCMSTR.
   419******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page   9
* NSRLTRBL.cbl
   420*                                                                *
   421*                            ELCMSTR.                            *
   422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   423*                            VMOD=2.012                          *
   424*                                                                *
   425*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   426*                                                                *
   427*   FILE TYPE = VSAM,KSDS                                        *
   428*   RECORD SIZE = 350  RECFORM = FIXED                           *
   429*                                                                *
   430*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   431*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   432*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   433*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   434*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   435*                                                 RKP=75,LEN=21  *
   436*                                                                *
   437*   **** NOTE ****                                               *
   438*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   439*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   440*                                                                *
   441*   LOG = YES                                                    *
   442*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   443******************************************************************
   444*                   C H A N G E   L O G
   445*
   446* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   447*-----------------------------------------------------------------
   448*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   449* EFFECTIVE    NUMBER
   450*-----------------------------------------------------------------
   451* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   452* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   453* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   454* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   455* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   456******************************************************************
   457 01  CLAIM-MASTER.
   458     12  CL-RECORD-ID                PIC XX.
   459         88  VALID-CL-ID         VALUE 'CL'.
   460
   461     12  CL-CONTROL-PRIMARY.
   462         16  CL-COMPANY-CD           PIC X.
   463         16  CL-CARRIER              PIC X.
   464         16  CL-CLAIM-NO             PIC X(7).
   465         16  CL-CERT-NO.
   466             20  CL-CERT-PRIME       PIC X(10).
   467             20  CL-CERT-SFX         PIC X.
   468
   469     12  CL-CONTROL-BY-NAME.
   470         16  CL-COMPANY-CD-A1        PIC X.
   471         16  CL-INSURED-LAST-NAME    PIC X(15).
   472         16  CL-INSURED-NAME.
   473             20  CL-INSURED-1ST-NAME PIC X(12).
   474             20  CL-INSURED-MID-INIT PIC X.
   475
   476     12  CL-CONTROL-BY-SSN.
   477         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  10
* NSRLTRBL.cbl
   478         16  CL-SOC-SEC-NO.
   479             20  CL-SSN-STATE        PIC XX.
   480             20  CL-SSN-ACCOUNT      PIC X(6).
   481             20  CL-SSN-LN3          PIC X(3).
   482
   483     12  CL-CONTROL-BY-CERT-NO.
   484         16  CL-COMPANY-CD-A4        PIC X.
   485         16  CL-CERT-NO-A4.
   486             20  CL-CERT-A4-PRIME    PIC X(10).
   487             20  CL-CERT-A4-SFX      PIC X.
   488
   489     12  CL-CONTROL-BY-CCN.
   490         16  CL-COMPANY-CD-A5        PIC X.
   491         16  CL-CCN-A5.
   492             20  CL-CCN.
   493                 24  CL-CCN-PREFIX-A5 PIC X(4).
   494                 24  CL-CCN-PRIME-A5 PIC X(12).
   495             20  CL-CCN-FILLER-A5    PIC X(4).
   496
   497     12  CL-INSURED-PROFILE-DATA.
   498         16  CL-INSURED-BIRTH-DT     PIC XX.
   499         16  CL-INSURED-SEX-CD       PIC X.
   500             88  INSURED-IS-MALE        VALUE 'M'.
   501             88  INSURED-IS-FEMALE      VALUE 'F'.
   502             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   503         16  CL-INSURED-OCC-CD       PIC X(6).
   504         16  FILLER                  PIC X(5).
   505
   506     12  CL-PROCESSING-INFO.
   507         16  CL-PROCESSOR-ID         PIC X(4).
   508         16  CL-CLAIM-STATUS         PIC X.
   509             88  CLAIM-IS-OPEN          VALUE 'O'.
   510             88  CLAIM-IS-CLOSED        VALUE 'C'.
   511         16  CL-CLAIM-TYPE           PIC X.
   512*            88  AH-CLAIM               VALUE 'A'.
   513*            88  LIFE-CLAIM             VALUE 'L'.
   514*            88  PROPERTY-CLAIM         VALUE 'P'.
   515*            88  IUI-CLAIM              VALUE 'I'.
   516*            88  GAP-CLAIM              VALUE 'G'.
   517*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   518         16  CL-CLAIM-PREM-TYPE      PIC X.
   519             88  SINGLE-PREMIUM         VALUE '1'.
   520             88  O-B-COVERAGE           VALUE '2'.
   521             88  OPEN-END-COVERAGE      VALUE '3'.
   522         16  CL-INCURRED-DT          PIC XX.
   523         16  CL-REPORTED-DT          PIC XX.
   524         16  CL-FILE-ESTABLISH-DT    PIC XX.
   525         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   526         16  CL-LAST-PMT-DT          PIC XX.
   527         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   528         16  CL-PAID-THRU-DT         PIC XX.
   529         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   530         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   531         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   532         16  CL-PMT-CALC-METHOD      PIC X.
   533             88  CL-360-DAY-YR          VALUE '1'.
   534             88  CL-365-DAY-YR          VALUE '2'.
   535             88  CL-FULL-MONTHS         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  11
* NSRLTRBL.cbl
   536         16  CL-CAUSE-CD             PIC X(6).
   537
   538         16  CL-PRIME-CERT-NO.
   539             20  CL-PRIME-CERT-PRIME PIC X(10).
   540             20  CL-PRIME-CERT-SFX   PIC X.
   541
   542         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   543             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   544             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   545
   546         16  CL-MICROFILM-NO         PIC X(10).
   547         16  FILLER REDEFINES CL-MICROFILM-NO.
   548             20  CL-BENEFIT-PERIOD   PIC 99.
   549             20  FILLER              PIC X(8).
   550         16  CL-PROG-FORM-TYPE       PIC X.
   551         16  CL-LAST-ADD-ON-DT       PIC XX.
   552
   553         16  CL-LAST-REOPEN-DT       PIC XX.
   554         16  CL-LAST-CLOSE-DT        PIC XX.
   555         16  CL-LAST-CLOSE-REASON    PIC X(01).
   556             88  FINAL-PAID             VALUE '1'.
   557             88  CLAIM-DENIED           VALUE '2'.
   558             88  AUTO-CLOSE             VALUE '3'.
   559             88  MANUAL-CLOSE           VALUE '4'.
   560             88  BENEFITS-CHANGED       VALUE 'C'.
   561             88  SETUP-ERRORS           VALUE 'E'.
   562         16  CL-ASSOC-CERT-SEQU      PIC S99.
   563         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   564         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   565             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   566         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   567         16  FILLER                  PIC X.
   568
   569     12  CL-CERTIFICATE-DATA.
   570         16  CL-CERT-ORIGIN          PIC X.
   571             88  CERT-WAS-ONLINE        VALUE '1'.
   572             88  CERT-WAS-CREATED       VALUE '2'.
   573             88  COVERAGE-WAS-ADDED     VALUE '3'.
   574         16  CL-CERT-KEY-DATA.
   575             20  CL-CERT-CARRIER     PIC X.
   576             20  CL-CERT-GROUPING    PIC X(6).
   577             20  CL-CERT-STATE       PIC XX.
   578             20  CL-CERT-ACCOUNT.
   579                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   580                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   581             20  CL-CERT-EFF-DT      PIC XX.
   582
   583     12  CL-STATUS-CONTROLS.
   584         16  CL-PRIORITY-CD          PIC X.
   585             88  CONFIDENTIAL-DATA      VALUE '8'.
   586             88  HIGHEST-PRIORITY       VALUE '9'.
   587         16  CL-SUPV-ATTN-CD         PIC X.
   588             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   589             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   590         16  CL-PURGED-DT            PIC XX.
   591         16  CL-RESTORED-DT          PIC XX.
   592         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   593         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  12
* NSRLTRBL.cbl
   594         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   595         16  CL-CRITICAL-PERIOD      PIC 99.
   596*        16  FILLER                  PIC XX.
   597         16  CL-LAST-MAINT-DT        PIC XX.
   598         16  CL-LAST-MAINT-USER      PIC X(4).
   599         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   600         16  CL-LAST-MAINT-TYPE      PIC X.
   601             88  CLAIM-SET-UP           VALUE ' '.
   602             88  PAYMENT-MADE           VALUE '1'.
   603             88  LETTER-SENT            VALUE '2'.
   604             88  MASTER-WAS-ALTERED     VALUE '3'.
   605             88  MASTER-WAS-RESTORED    VALUE '4'.
   606             88  INCURRED-DATE-CHANGED  VALUE '5'.
   607             88  FILE-CONVERTED         VALUE '6'.
   608             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   609             88  ERROR-CORRECTION       VALUE 'E'.
   610         16  CL-RELATED-CLAIM-NO     PIC X(7).
   611         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   612         16  CL-BENEFICIARY          PIC X(10).
   613         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   614         16  CL-DENIAL-TYPE          PIC X.
   615             88  CL-TYPE-DENIAL          VALUE '1'.
   616             88  CL-TYPE-RESCISSION      VALUE '2'.
   617             88  CL-TYPE-REFORMATION     VALUE '3'.
   618             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   619             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   620         16  filler                  pic x(5).
   621*        16  CL-CRIT-PER-RECURRENT   PIC X.
   622*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   623*        16  CL-RTW-DT               PIC XX.
   624
   625     12  CL-TRAILER-CONTROLS.
   626         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   627             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   628             88  CL-LAST-TRL-AVAIL      VALUE +100.
   629             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   630         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   631         16  FILLER                  PIC XX.
   632         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   633         16  CL-ADDRESS-TRAILER-CNT.
   634             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   635                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   636             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   637                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   638             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   639                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   640             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   641                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   642             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   643                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   644             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   645                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   646             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   647                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   648
   649     12  CL-CV-REFERENCE-NO.
   650         16  CL-CV-REFNO-PRIME       PIC X(18).
   651         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  13
* NSRLTRBL.cbl
   652
   653     12  CL-FILE-LOCATION            PIC X(4).
   654
   655     12  CL-PROCESS-ERRORS.
   656         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   657             88  NO-FATAL-ERRORS        VALUE ZERO.
   658         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   659             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   660
   661     12  CL-PRODUCT-CD               PIC X.
   662
   663     12  CL-CURRENT-KEY-DATA.
   664         16  CL-CURRENT-CARRIER      PIC X.
   665         16  CL-CURRENT-GROUPING     PIC X(6).
   666         16  CL-CURRENT-STATE        PIC XX.
   667         16  CL-CURRENT-ACCOUNT      PIC X(10).
   668
   669     12  CL-ASSOCIATES               PIC X.
   670         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   671         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   672         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   673         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   674
   675     12  CL-ACTIVITY-CODE            PIC 99.
   676     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   677     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   678
   679     12  CL-LAPSE-REPORT-CODE        PIC 9.
   680     12  CL-LAG-REPORT-CODE          PIC 9.
   681     12  CL-LOAN-TYPE                PIC XX.
   682     12  CL-LEGAL-STATE              PIC XX.
   683
   684     12  CL-YESNOSW                  PIC X.
   685     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   686         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   687         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   688         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   689     12  cl-insured-type             pic x.
   690         88  cl-claim-on-primary         value 'P'.
   691         88  cl-claim-on-co-borrower     value 'C'.
   692     12  cl-benefit-expiration-dt    PIC XX.
   693*                                COPY ELCTRLR.
   694******************************************************************
   695*                                                                *
   696*                            ELCTRLR.                            *
   697*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   698*                            VMOD=2.014                          *
   699*                                                                *
   700*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
   701*                                                                *
   702*   FILE TYPE = VSAM,KSDS                                        *
   703*   RECORD SIZE = 200    RECFORM = FIXED                         *
   704*                                                                *
   705*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
   706*       ALTERNATE INDEX = NONE                                   *
   707*                                                                *
   708*   LOG = YES                                                    *
   709*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  14
* NSRLTRBL.cbl
   710******************************************************************
   711*                   C H A N G E   L O G
   712*
   713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   714*-----------------------------------------------------------------
   715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   716* EFFECTIVE    NUMBER
   717*-----------------------------------------------------------------
   718* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   719* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   720* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   721* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   722* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   723* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   724* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   725* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   726* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   727* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   728* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   729* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   730* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
   731* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
   732* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   733* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   734* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   735* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   736* 040814    2014030500002  AJRA  ADD ICD CODES
   737* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   738* 013017  CR2016053100001  PEMA  ACH PROCESSING
   739******************************************************************
   740 01  ACTIVITY-TRAILERS.
   741     12  AT-RECORD-ID                    PIC XX.
   742         88  VALID-AT-ID                       VALUE 'AT'.
   743
   744     12  AT-CONTROL-PRIMARY.
   745         16  AT-COMPANY-CD               PIC X.
   746         16  AT-CARRIER                  PIC X.
   747         16  AT-CLAIM-NO                 PIC X(7).
   748         16  AT-CERT-NO.
   749             20  AT-CERT-PRIME           PIC X(10).
   750             20  AT-CERT-SFX             PIC X.
   751         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
   752             88  AT-1ST-TRL-AVAIL             VALUE +4095.
   753             88  AT-LAST-TRL-AVAIL            VALUE +100.
   754             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
   755             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
   756             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
   757             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
   758             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
   759             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
   760             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
   761             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
   762             88  AT-DIAGNOSIS-TRL             VALUE +90.
   763             88  AT-BENEFICIARY-TRL           VALUE +91.
   764             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   765             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   766             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   767             88  AT-ERROR-MSGS-TRL            VALUE +95.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  15
* NSRLTRBL.cbl
   768
   769     12  AT-TRAILER-TYPE                 PIC X.
   770         88  RESERVE-EXPENSE-TR               VALUE '1'.
   771         88  PAYMENT-TR                       VALUE '2'.
   772         88  AUTO-PAY-TR                      VALUE '3'.
   773         88  CORRESPONDENCE-TR                VALUE '4'.
   774         88  ADDRESS-TR                       VALUE '5'.
   775         88  GENERAL-INFO-TR                  VALUE '6'.
   776         88  AUTO-PROMPT-TR                   VALUE '7'.
   777         88  DENIAL-TR                        VALUE '8'.
   778         88  INCURRED-CHG-TR                  VALUE '9'.
   779         88  FORM-CONTROL-TR                  VALUE 'A'.
   780
   781     12  AT-RECORDED-DT                  PIC XX.
   782     12  AT-RECORDED-BY                  PIC X(4).
   783     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
   784
   785     12  AT-TRAILER-BODY                 PIC X(165).
   786
   787     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
   788         16  AT-RESERVE-CONTROLS.
   789             20  AT-MANUAL-SW            PIC X.
   790                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
   791             20  AT-FUTURE-SW            PIC X.
   792                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
   793             20  AT-PTC-SW               PIC X.
   794                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
   795             20  AT-IBNR-SW              PIC X.
   796                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
   797             20  AT-PTC-LF-SW            PIC X.
   798                 88  AT-LF-PTC-USED          VALUE '1'.
   799             20  AT-CDT-ACCESS-METHOD    PIC X.
   800                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
   801                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
   802                 88  AT-CDT-INTERPOLATED     VALUE '3'.
   803             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
   804         16  AT-LAST-COMPUTED-DT         PIC XX.
   805         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
   806         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
   807         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
   808         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   809         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   810         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
   811         16  AT-EXPENSE-CONTROLS.
   812             20  AT-EXPENSE-METHOD       PIC X.
   813                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
   814                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
   815                 88  PERCENT-OF-PMT           VALUE '3'.
   816                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
   817             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
   818             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
   819         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
   820         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
   821
   822         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
   823         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
   824
   825*        16  FILLER                      PIC X(53).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  16
* NSRLTRBL.cbl
   826         16  FILLER                      PIC X(47).
   827
   828         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
   829         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
   830
   831         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
   832             20  AT-OPEN-CLOSE-DATE      PIC XX.
   833             20  AT-OPEN-CLOSE-TYPE      PIC X.
   834*                    C = CLOSED
   835*                    O = OPEN
   836             20  AT-OPEN-CLOSE-REASON    PIC X(5).
   837*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
   838
   839     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
   840         16  AT-PAYMENT-TYPE             PIC X.
   841             88  PARTIAL-PAYMENT                VALUE '1'.
   842             88  FINAL-PAYMENT                  VALUE '2'.
   843             88  LUMP-SUM-PAYMENT               VALUE '3'.
   844             88  ADDITIONAL-PAYMENT             VALUE '4'.
   845             88  CHARGEABLE-EXPENSE             VALUE '5'.
   846             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
   847             88  VOIDED-PAYMENT                 VALUE '9'.
   848             88  TRANSFER                       VALUE 'T'.
   849             88  LIFE-INTEREST                  VALUE 'I'.
   850
   851         16  AT-CLAIM-TYPE               PIC X.
   852             88  PAID-FOR-AH                    VALUE 'A'.
   853             88  PAID-FOR-LIFE                  VALUE 'L'.
   854             88  PAID-FOR-IUI                   VALUE 'I'.
   855             88  PAID-FOR-GAP                   VALUE 'G'.
   856             88  PAID-FOR-FAM                   VALUE 'F'.
   857         16  AT-CLAIM-PREM-TYPE          PIC X.
   858             88  AT-SINGLE-PREMIUM              VALUE '1'.
   859             88  AT-O-B-COVERAGE                VALUE '2'.
   860             88  AT-OPEN-END-COVERAGE           VALUE '3'.
   861         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
   862         16  AT-CHECK-NO                 PIC X(7).
   863         16  AT-PAID-FROM-DT             PIC XX.
   864         16  AT-PAID-THRU-DT             PIC XX.
   865         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
   866         16  AT-ACH-PAYMENT              PIC X.
   867*        16  FILLER                      PIC X.
   868         16  AT-PAYEES-NAME              PIC X(30).
   869         16  AT-PAYMENT-ORIGIN           PIC X.
   870             88  ONLINE-MANUAL-PMT              VALUE '1'.
   871             88  ONLINE-AUTO-PMT                VALUE '2'.
   872             88  OFFLINE-PMT                    VALUE '3'.
   873         16  AT-CHECK-WRITTEN-DT         PIC XX.
   874         16  AT-TO-BE-WRITTEN-DT         PIC XX.
   875         16  AT-VOID-DATA.
   876             20  AT-VOID-DT              PIC XX.
   877*00144       20  AT-VOID-REASON          PIC X(30).
   878             20  AT-VOID-REASON          PIC X(26).
   879         16  AT-PMT-APPROVED-BY          PIC X(04).
   880         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
   881         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
   882         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   883                                         PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  17
* NSRLTRBL.cbl
   884         16  AT-CREDIT-INTERFACE.
   885             20  AT-PMT-SELECT-DT        PIC XX.
   886                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
   887             20  AT-PMT-ACCEPT-DT        PIC XX.
   888                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
   889             20  AT-VOID-SELECT-DT       PIC XX.
   890                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
   891             20  AT-VOID-ACCEPT-DT       PIC XX.
   892                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
   893
   894         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
   895                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   896                 88  CONVERSION-PAYMENT           VALUE +99999999.
   897         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
   898
   899         16  AT-FORCE-CONTROL            PIC X.
   900             88  PAYMENT-WAS-FORCED           VALUE '1'.
   901         16  AT-PREV-LAST-PMT-DT         PIC XX.
   902         16  AT-PREV-PAID-THRU-DT        PIC XX.
   903         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
   904         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
   905         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
   906         16  AT-BENEFIT-TYPE             PIC X.
   907
   908         16  AT-EXPENSE-TYPE             PIC X.
   909         16  AT-PAYMENT-APPROVAL-SW      PIC X.
   910
   911         16  AT-PAYEE-TYPE-CD.
   912             20  AT-PAYEE-TYPE           PIC X.
   913                 88  INSURED-PAID           VALUE 'I'.
   914                 88  BENEFICIARY-PAID       VALUE 'B'.
   915                 88  ACCOUNT-PAID           VALUE 'A'.
   916                 88  OTHER-1-PAID           VALUE 'O'.
   917                 88  OTHER-2-PAID           VALUE 'Q'.
   918                 88  DOCTOR-PAID            VALUE 'P'.
   919                 88  EMPLOYER-PAID          VALUE 'E'.
   920             20  AT-PAYEE-SEQ            PIC X.
   921
   922         16  AT-CASH-PAYMENT             PIC X.
   923         16  AT-GROUPED-PAYMENT          PIC X.
   924         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
   925         16  AT-APPROVAL-LEVEL-REQD      PIC X.
   926         16  AT-APPROVED-LEVEL           PIC X.
   927         16  AT-VOID-TYPE                PIC X.
   928             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
   929             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
   930         16  AT-AIG-UNEMP-IND            PIC X.
   931             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
   932         16  AT-ASSOCIATES               PIC X.
   933             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
   934             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
   935
   936         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
   937         16  AT-CV-PMT-CODE              PIC X.
   938             88  FULL-DEATH-PAYMENT         VALUE '1'.
   939             88  HALF-DEATH-PAYMENT         VALUE '2'.
   940             88  FULL-ADD-PAYMENT           VALUE '3'.
   941             88  HALF-ADD-PAYMENT           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  18
* NSRLTRBL.cbl
   942             88  FULL-RIDER-PAYMENT         VALUE '5'.
   943             88  HALF-RIDER-PAYMENT         VALUE '6'.
   944             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
   945             88  ADDL-PAYMENT               VALUE '8'.
   946
   947         16  AT-EOB-CODE1                PIC XXX.
   948         16  AT-EOB-CODE2                PIC XXX.
   949         16  AT-EOB-CODE3                PIC XXX.
   950         16  FILLER REDEFINES AT-EOB-CODE3.
   951             20  AT-PRINT-CLM-FORM       PIC X.
   952             20  AT-PRINT-SURVEY         PIC X.
   953             20  AT-SPECIAL-RELEASE      PIC X.
   954         16  AT-EOB-CODE4                PIC XXX.
   955         16  FILLER REDEFINES AT-EOB-CODE4.
   956             20  AT-INT-PMT-SELECT-DT    PIC XX.
   957             20  FILLER                  PIC X.
   958         16  AT-EOB-CODE5                PIC XXX.
   959         16  FILLER REDEFINES AT-EOB-CODE5.
   960             20  AT-PMT-PROOF-DT         PIC XX.
   961             20  FILLER                  PIC X.
   962
   963         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   964             88  AT-PRINT-EOB            VALUE 'Y'.
   965
   966         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
   967         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
   968
   969     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
   970         16  AT-SCHEDULE-START-DT        PIC XX.
   971         16  AT-SCHEDULE-END-DT          PIC XX.
   972         16  AT-TERMINATED-DT            PIC XX.
   973         16  AT-LAST-PMT-TYPE            PIC X.
   974             88  LAST-PMT-IS-FINAL              VALUE 'F'.
   975             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
   976         16  AT-FIRST-PMT-DATA.
   977             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
   978             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
   979             20  AT-1ST-PAY-THRU-DT      PIC XX.
   980         16  AT-REGULAR-PMT-DATA.
   981             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
   982             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
   983             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
   984         16  AT-AUTO-PAYEE-CD.
   985             20  AT-AUTO-PAYEE-TYPE      PIC X.
   986                 88  INSURED-PAID-AUTO      VALUE 'I'.
   987                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
   988                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
   989                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
   990                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
   991             20  AT-AUTO-PAYEE-SEQ       PIC X.
   992         16  AT-AUTO-PAY-DAY             PIC 99.
   993         16  AT-AUTO-CASH                PIC X.
   994             88  AT-CASH                      VALUE 'Y'.
   995             88  AT-NON-CASH                  VALUE 'N'.
   996*        16  FILLER                      PIC X(129).
   997         16  AT-AUTO-END-LETTER          PIC X(4).
   998         16  FILLER                      PIC X(125).
   999
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  19
* NSRLTRBL.cbl
  1000         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1001         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1002
  1003     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1004         16  AT-LETTER-SENT-DT           PIC XX.
  1005         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1006         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1007         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1008         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1009         16  AT-LETTER-ORIGIN            PIC X.
  1010             88  ONLINE-CREATION              VALUE '1' '3'.
  1011             88  OFFLINE-CREATION             VALUE '2' '4'.
  1012             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1013             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1014         16  AT-STD-LETTER-FORM          PIC X(4).
  1015         16  AT-REASON-TEXT              PIC X(70).
  1016         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1017         16  AT-ADDRESEE-TYPE            PIC X.
  1018              88  INSURED-ADDRESEE            VALUE 'I'.
  1019              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1020              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1021              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1022              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1023              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1024              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1025         16  AT-ADDRESSEE-NAME           PIC X(30).
  1026         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1027         16  AT-RESEND-PRINT-DATE        PIC XX.
  1028         16  AT-CORR-SOL-UNSOL           PIC X.
  1029         16  AT-LETTER-PURGED-DT         PIC XX.
  1030*
  1031*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1032*
  1033         16  AT-CSO-REDEFINITION.
  1034             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1035             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1036             20  AT-LETTER-TO-BENE       PIC X(1).
  1037             20  AT-STOP-LETTER-DT       PIC X(2).
  1038             20  FILLER                  PIC X(19).
  1039*             20  FILLER                  PIC X(27).
  1040             20  AT-CSO-LETTER-STATUS    PIC X.
  1041                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1042                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1043                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1044             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1045             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1046*
  1047*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1048*
  1049*        16  FILLER                      PIC X(26).
  1050*
  1051*        16  AT-DMD-BSR-CODE             PIC X.
  1052*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1053*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1054*
  1055*        16  AT-DMD-LETTER-STATUS        PIC X.
  1056*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1057*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  20
* NSRLTRBL.cbl
  1058*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1059*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1060*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1061
  1062         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1063         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1064
  1065     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1066         16  AT-ADDRESS-TYPE             PIC X.
  1067             88  INSURED-ADDRESS               VALUE 'I'.
  1068             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1069             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1070             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1071             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1072             88  OTHER-ADDRESS-1               VALUE 'O'.
  1073             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1074         16  AT-MAIL-TO-NAME             PIC X(30).
  1075         16  AT-ADDRESS-LINE-1           PIC X(30).
  1076         16  AT-ADDRESS-LINE-2           PIC X(30).
  1077         16  AT-CITY-STATE.
  1078             20  AT-CITY                 PIC X(28).
  1079             20  AT-STATE                PIC XX.
  1080         16  AT-ZIP.
  1081             20  AT-ZIP-CODE.
  1082                 24  AT-ZIP-1ST          PIC X.
  1083                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1084                 24  FILLER              PIC X(4).
  1085             20  AT-ZIP-PLUS4            PIC X(4).
  1086         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1087             20  AT-CAN-POSTAL-1         PIC XXX.
  1088             20  AT-CAN-POSTAL-2         PIC XXX.
  1089             20  FILLER                  PIC XXX.
  1090         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1091*         16  FILLER                      PIC X(23).
  1092         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1093         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  1094         16  FILLER                      PIC X(13).
  1095         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1096         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1097
  1098     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1099         16  AT-INFO-LINE-1              PIC X(60).
  1100         16  FILLER REDEFINES AT-INFO-LINE-1.
  1101             20  AT-NOTE-ERROR-NO OCCURS 15
  1102                                         PIC X(4).
  1103         16  AT-INFO-LINE-2              PIC X(60).
  1104         16  FILLER REDEFINES AT-INFO-LINE-2.
  1105             20  AT-ICD-CODE-1           PIC X(8).
  1106             20  AT-ICD-CODE-2           PIC X(8).
  1107             20  FILLER                  PIC X(44).
  1108         16  AT-INFO-TRAILER-TYPE        PIC X.
  1109             88  AT-ERRORS-NOTE          VALUE 'E'.
  1110             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1111             88  AT-CALL-NOTE            VALUE 'C'.
  1112             88  AT-MAINT-NOTE           VALUE 'M'.
  1113             88  AT-CERT-CHANGE          VALUE 'X'.
  1114             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1115             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  21
* NSRLTRBL.cbl
  1116             88  AT-CERT-CANCELLED       VALUE 'T'.
  1117         16  AT-CALL-TYPE                PIC X.
  1118             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1119             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1120         16  AT-NOTE-CONTINUATION        PIC X.
  1121             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1122         16  AT-EOB-CODES-EXIST          PIC X.
  1123             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1124         16  FILLER                      PIC X(35).
  1125         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1126         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1127
  1128     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1129         16  AT-PROMPT-LINE-1            PIC X(60).
  1130         16  AT-PROMPT-LINE-2            PIC X(60).
  1131         16  AT-PROMPT-START-DT          PIC XX.
  1132         16  AT-PROMPT-END-DT            PIC XX.
  1133         16  FILLER                      PIC X(35).
  1134         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1135         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1136
  1137     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1138         16  AT-DENIAL-INFO-1            PIC X(60).
  1139         16  AT-DENIAL-INFO-2            PIC X(60).
  1140         16  AT-DENIAL-DT                PIC XX.
  1141         16  AT-RETRACTION-DT            PIC XX.
  1142         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1143*         16  FILLER                      PIC X(31).
  1144         16  AT-DENIAL-PROOF-DT          PIC XX.
  1145         16  FILLER                      PIC X(29).
  1146         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  1147         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  1148
  1149     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  1150         16  AT-OLD-INCURRED-DT          PIC XX.
  1151         16  AT-OLD-REPORTED-DT          PIC XX.
  1152         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  1153         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  1154         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  1155         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  1156         16  AT-OLD-PAID-THRU-DT         PIC XX.
  1157         16  AT-LAST-PMT-MADE-DT         PIC XX.
  1158         16  FILLER                      PIC X(26).
  1159         16  AT-OLD-DIAG-CODE            PIC X(6).
  1160         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  1161         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  1162         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  1163         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  1164         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  1165         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  1166         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  1167         16  AT-OLD-ICD-CODE-1           PIC X(8).
  1168         16  AT-OLD-ICD-CODE-2           PIC X(8).
  1169         16  FILLER                      PIC X(9).
  1170         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  1171
  1172     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  1173         16  AT-FORM-SEND-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  22
* NSRLTRBL.cbl
  1174         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  1175         16  AT-FORM-RE-SEND-DT          PIC XX.
  1176         16  AT-FORM-ANSWERED-DT         PIC XX.
  1177         16  AT-FORM-PRINTED-DT          PIC XX.
  1178         16  AT-FORM-REPRINT-DT          PIC XX.
  1179         16  AT-FORM-TYPE                PIC X.
  1180             88  INITIAL-FORM                  VALUE '1'.
  1181             88  PROGRESS-FORM                 VALUE '2'.
  1182         16  AT-INSTRUCT-LN-1            PIC X(28).
  1183         16  AT-INSTRUCT-LN-2            PIC X(28).
  1184         16  AT-INSTRUCT-LN-3            PIC X(28).
  1185         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  1186         16  AT-FORM-ADDRESS             PIC X.
  1187             88  FORM-TO-INSURED              VALUE 'I'.
  1188             88  FORM-TO-ACCOUNT              VALUE 'A'.
  1189             88  FORM-TO-OTHER-1              VALUE 'O'.
  1190             88  FORM-TO-OTHER-2              VALUE 'Q'.
  1191         16  AT-RELATED-1.
  1192             20 AT-REL-CARR-1            PIC X.
  1193             20 AT-REL-CLAIM-1           PIC X(7).
  1194             20 AT-REL-CERT-1            PIC X(11).
  1195         16  AT-RELATED-2.
  1196             20 AT-REL-CARR-2            PIC X.
  1197             20 AT-REL-CLAIM-2           PIC X(7).
  1198             20 AT-REL-CERT-2            PIC X(11).
  1199         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  1200         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  1201         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  1202         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  1203         16  AT-FORM-REM-PRINT-DT        PIC XX.
  1204         16  AT-STOP-FORM-DT             PIC X(2).
  1205
  1206         16  FILLER                      PIC X(09).
  1207         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  1208         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  1209******************************************************************
  1210*                                COPY ELCCERT.
  1211******************************************************************
  1212*                                                                *
  1213*                            ELCCERT.                            *
  1214*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1215*                            VMOD=2.013                          *
  1216*                                                                *
  1217*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1218*                                                                *
  1219*   FILE TYPE = VSAM,KSDS                                        *
  1220*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1221*                                                                *
  1222*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1223*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1224*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1225*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1226*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1227*                                                                *
  1228*   LOG = YES                                                    *
  1229*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1230******************************************************************
  1231*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  23
* NSRLTRBL.cbl
  1232*
  1233* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1234*-----------------------------------------------------------------
  1235*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1236* EFFECTIVE    NUMBER
  1237*-----------------------------------------------------------------
  1238* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1239* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1240* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1241* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1242* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1243* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1244* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1245* 032612  CR2011110200001  PEMA  AHL CHANGES
  1246* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1247* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1248******************************************************************
  1249
  1250 01  CERTIFICATE-MASTER.
  1251     12  CM-RECORD-ID                      PIC XX.
  1252         88  VALID-CM-ID                      VALUE 'CM'.
  1253
  1254     12  CM-CONTROL-PRIMARY.
  1255         16  CM-COMPANY-CD                 PIC X.
  1256         16  CM-CARRIER                    PIC X.
  1257         16  CM-GROUPING.
  1258             20  CM-GROUPING-PREFIX        PIC X(3).
  1259             20  CM-GROUPING-PRIME         PIC X(3).
  1260         16  CM-STATE                      PIC XX.
  1261         16  CM-ACCOUNT.
  1262             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1263             20  CM-ACCOUNT-PRIME          PIC X(6).
  1264         16  CM-CERT-EFF-DT                PIC XX.
  1265         16  CM-CERT-NO.
  1266             20  CM-CERT-PRIME             PIC X(10).
  1267             20  CM-CERT-SFX               PIC X.
  1268
  1269     12  CM-CONTROL-BY-NAME.
  1270         16  CM-COMPANY-CD-A1              PIC X.
  1271         16  CM-INSURED-LAST-NAME          PIC X(15).
  1272         16  CM-INSURED-INITIALS.
  1273             20  CM-INSURED-INITIAL1       PIC X.
  1274             20  CM-INSURED-INITIAL2       PIC X.
  1275
  1276     12  CM-CONTROL-BY-SSN.
  1277         16  CM-COMPANY-CD-A2              PIC X.
  1278         16  CM-SOC-SEC-NO.
  1279             20  CM-SSN-STATE              PIC XX.
  1280             20  CM-SSN-ACCOUNT            PIC X(6).
  1281             20  CM-SSN-LN3.
  1282                 25  CM-INSURED-INITIALS-A2.
  1283                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1284                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1285                 25 CM-PART-LAST-NAME-A2         PIC X.
  1286
  1287     12  CM-CONTROL-BY-CERT-NO.
  1288         16  CM-COMPANY-CD-A4              PIC X.
  1289         16  CM-CERT-NO-A4                 PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  24
* NSRLTRBL.cbl
  1290
  1291     12  CM-CONTROL-BY-MEMB.
  1292         16  CM-COMPANY-CD-A5              PIC X.
  1293         16  CM-MEMBER-NO.
  1294             20  CM-MEMB-STATE             PIC XX.
  1295             20  CM-MEMB-ACCOUNT           PIC X(6).
  1296             20  CM-MEMB-LN4.
  1297                 25  CM-INSURED-INITIALS-A5.
  1298                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1299                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1300                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1301
  1302     12  CM-INSURED-PROFILE-DATA.
  1303         16  CM-INSURED-FIRST-NAME.
  1304             20  CM-INSURED-1ST-INIT       PIC X.
  1305             20  FILLER                    PIC X(9).
  1306         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1307         16  CM-INSURED-SEX                PIC X.
  1308             88  CM-SEX-MALE                  VALUE 'M'.
  1309             88  CM-SEX-FEMAL                 VALUE 'F'.
  1310         16  CM-INSURED-JOINT-AGE          PIC 99.
  1311         16  CM-JOINT-INSURED-NAME.
  1312             20  CM-JT-LAST-NAME           PIC X(15).
  1313             20  CM-JT-FIRST-NAME.
  1314                 24  CM-JT-1ST-INIT        PIC X.
  1315                 24  FILLER                PIC X(9).
  1316             20  CM-JT-INITIAL             PIC X.
  1317
  1318     12  CM-LIFE-DATA.
  1319         16  CM-LF-BENEFIT-CD              PIC XX.
  1320         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1321         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1322         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1323         16  CM-LF-DEV-CODE                PIC XXX.
  1324         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1325         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1326         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1327         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1328         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1329         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1330         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1331         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1332         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1333         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1334         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1335         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1336         16  cm-temp-epiq                  pic xx.
  1337             88  EPIQ-CLASS                  value 'EQ'.
  1338*        16  FILLER                        PIC XX.
  1339
  1340     12  CM-AH-DATA.
  1341         16  CM-AH-BENEFIT-CD              PIC XX.
  1342         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1343         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1344         16  CM-AH-DEV-CODE                PIC XXX.
  1345         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1346         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1347         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  25
* NSRLTRBL.cbl
  1348         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1349         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1350         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1351         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1352         16  CM-AH-PAID-THRU-DT            PIC XX.
  1353             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1354         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1355         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1356         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1357         16  FILLER                        PIC X.
  1358
  1359     12  CM-LOAN-INFORMATION.
  1360         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1361         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1362                                           PIC S9(5)V99  COMP-3.
  1363         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1364         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1365         16  CM-PAY-FREQUENCY              PIC S99.
  1366         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1367         16  CM-RATE-CLASS                 PIC XX.
  1368         16  CM-BENEFICIARY                PIC X(25).
  1369         16  CM-POLICY-FORM-NO             PIC X(12).
  1370         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1371         16  CM-LAST-ADD-ON-DT             PIC XX.
  1372         16  CM-DEDUCTIBLE-AMOUNTS.
  1373             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1374             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1375         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1376             20  CM-RESIDENT-STATE         PIC XX.
  1377             20  CM-RATE-CODE              PIC X(4).
  1378             20  FILLER                    PIC XX.
  1379         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1380             20  CM-LOAN-OFFICER           PIC X(5).
  1381             20  FILLER                    PIC XXX.
  1382         16  CM-CSR-CODE                   PIC XXX.
  1383         16  CM-UNDERWRITING-CODE          PIC X.
  1384             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1385         16  CM-POST-CARD-IND              PIC X.
  1386         16  CM-NH-INTERFACE-SW            PIC X.
  1387         16  CM-PREMIUM-TYPE               PIC X.
  1388             88  CM-SING-PRM                  VALUE '1'.
  1389             88  CM-O-B-COVERAGE              VALUE '2'.
  1390             88  CM-OPEN-END                  VALUE '3'.
  1391         16  CM-IND-GRP-TYPE               PIC X.
  1392             88  CM-INDIVIDUAL                VALUE 'I'.
  1393             88  CM-GROUP                     VALUE 'G'.
  1394         16  CM-SKIP-CODE                  PIC X.
  1395             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1396             88  SKIP-JULY                    VALUE '1'.
  1397             88  SKIP-AUGUST                  VALUE '2'.
  1398             88  SKIP-SEPTEMBER               VALUE '3'.
  1399             88  SKIP-JULY-AUG                VALUE '4'.
  1400             88  SKIP-AUG-SEPT                VALUE '5'.
  1401             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1402             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1403             88  SKIP-JUNE                    VALUE '8'.
  1404             88  SKIP-JUNE-JULY               VALUE '9'.
  1405             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  26
* NSRLTRBL.cbl
  1406             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1407         16  CM-PAYMENT-MODE               PIC X.
  1408             88  PAY-MONTHLY                  VALUE SPACE.
  1409             88  PAY-WEEKLY                   VALUE '1'.
  1410             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1411             88  PAY-BI-WEEKLY                VALUE '3'.
  1412             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1413         16  CM-LOAN-NUMBER                PIC X(8).
  1414         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1415         16  CM-OLD-LOF                    PIC XXX.
  1416*        16  CM-LOAN-OFFICER               PIC XXX.
  1417         16  CM-REIN-TABLE                 PIC XXX.
  1418         16  CM-SPECIAL-REIN-CODE          PIC X.
  1419         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1420         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1421         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1422
  1423     12  CM-STATUS-DATA.
  1424         16  CM-ENTRY-STATUS               PIC X.
  1425         16  CM-ENTRY-DT                   PIC XX.
  1426
  1427         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1428         16  CM-LF-CANCEL-DT               PIC XX.
  1429         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1430
  1431         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1432         16  CM-LF-DEATH-DT                PIC XX.
  1433         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1434
  1435         16  CM-LF-CURRENT-STATUS          PIC X.
  1436             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1437                                                'M' '4' '5' '9'.
  1438             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1439             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1440             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1441             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1442             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1443             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1444             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1445             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1446             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1447             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1448             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1449             88  CM-LF-DECLINED               VALUE 'D'.
  1450             88  CM-LF-VOIDED                 VALUE 'V'.
  1451
  1452         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1453         16  CM-AH-CANCEL-DT               PIC XX.
  1454         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1455
  1456         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1457         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1458         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1459
  1460         16  CM-AH-CURRENT-STATUS          PIC X.
  1461             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1462                                                'M' '4' '5' '9'.
  1463             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  27
* NSRLTRBL.cbl
  1464             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1465             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1466             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1467             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1468             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1469             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1470             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1471             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1472             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1473             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1474             88  CM-AH-DECLINED               VALUE 'D'.
  1475             88  CM-AH-VOIDED                 VALUE 'V'.
  1476
  1477         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1478             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1479             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1480             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1481         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1482
  1483         16  CM-ENTRY-BATCH                PIC X(6).
  1484         16  CM-LF-EXIT-BATCH              PIC X(6).
  1485         16  CM-AH-EXIT-BATCH              PIC X(6).
  1486         16  CM-LAST-MONTH-END             PIC XX.
  1487
  1488     12  CM-NOTE-SW                        PIC X.
  1489         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1490         88  CERT-NOTES-PRESENT               VALUE '1'.
  1491         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1492         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1493         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1494         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1495         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1496         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1497     12  CM-COMP-EXCP-SW                   PIC X.
  1498         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1499         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1500     12  CM-INSURED-ADDRESS-SW             PIC X.
  1501         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1502         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1503
  1504*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1505     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1506     12  FILLER                            PIC X.
  1507
  1508*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1509     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1510     12  FILLER                            PIC X.
  1511*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1512     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1513
  1514     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1515         88  CERT-ADDED-BATCH                 VALUE ' '.
  1516         88  CERT-ADDED-ONLINE                VALUE '1'.
  1517         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1518         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1519         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1520     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1521         88  CERT-AS-LOADED                   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  28
* NSRLTRBL.cbl
  1522         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1523         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1524         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1525         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1526         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1527         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1528         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1529
  1530     12  CM-ACCOUNT-COMM-PCTS.
  1531         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1532         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1533
  1534     12  CM-USER-FIELD                     PIC X.
  1535     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1536     12  CM-CLP-STATE                      PIC XX.
  1537     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1538     12  CM-USER-RESERVED                  PIC XXX.
  1539     12  FILLER REDEFINES CM-USER-RESERVED.
  1540         16  CM-AH-CLASS-CD                PIC XX.
  1541         16  F                             PIC X.
  1542******************************************************************
  1543*                                COPY ERCACCT.
  1544******************************************************************
  1545*                                                                *
  1546*                                                                *
  1547*                            ERCACCT                             *
  1548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1549*                            VMOD=2.031                          *
  1550*                                                                *
  1551*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1552*                                                                *
  1553*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1554*   VSAM ACCOUNT MASTER FILES.                                   *
  1555*                                                                *
  1556*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1557*                                                                *
  1558*   FILE TYPE = VSAM,KSDS                                        *
  1559*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1560*                                                                *
  1561*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1562*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1563*                                                                *
  1564*   LOG = NO                                                     *
  1565*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1566*                                                                *
  1567*                                                                *
  1568******************************************************************
  1569*                   C H A N G E   L O G
  1570*
  1571* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1572*-----------------------------------------------------------------
  1573*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1574* EFFECTIVE    NUMBER
  1575*-----------------------------------------------------------------
  1576* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1577* 092705    2005050300006  PEMA  ADD SPP LEASES
  1578* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1579* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  29
* NSRLTRBL.cbl
  1580* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1581* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1582* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1583* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1584******************************************************************
  1585
  1586 01  ACCOUNT-MASTER.
  1587     12  AM-RECORD-ID                      PIC XX.
  1588         88  VALID-AM-ID                      VALUE 'AM'.
  1589
  1590     12  AM-CONTROL-PRIMARY.
  1591         16  AM-COMPANY-CD                 PIC X.
  1592         16  AM-MSTR-CNTRL.
  1593             20  AM-CONTROL-A.
  1594                 24  AM-CARRIER            PIC X.
  1595                 24  AM-GROUPING.
  1596                     28 AM-GROUPING-PREFIX PIC XXX.
  1597                     28 AM-GROUPING-PRIME  PIC XXX.
  1598                 24  AM-STATE              PIC XX.
  1599                 24  AM-ACCOUNT.
  1600                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1601                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1602             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1603                                           PIC X(19).
  1604             20  AM-CNTRL-B.
  1605                 24  AM-EXPIRATION-DT      PIC XX.
  1606                 24  FILLER                PIC X(4).
  1607             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1608                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1609
  1610     12  AM-CONTROL-BY-VAR-GRP.
  1611         16  AM-COMPANY-CD-A1              PIC X.
  1612         16  AM-VG-CARRIER                 PIC X.
  1613         16  AM-VG-GROUPING                PIC X(6).
  1614         16  AM-VG-STATE                   PIC XX.
  1615         16  AM-VG-ACCOUNT                 PIC X(10).
  1616         16  AM-VG-DATE.
  1617             20  AM-VG-EXPIRATION-DT       PIC XX.
  1618             20  FILLER                    PIC X(4).
  1619         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1620                                           PIC 9(11)      COMP-3.
  1621     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1622         16  FILLER                        PIC X(10).
  1623         16  AM-VG-KEY3.
  1624             20  AM-VG3-ACCOUNT            PIC X(10).
  1625             20  AM-VG3-EXP-DT             PIC XX.
  1626         16  FILLER                        PIC X(4).
  1627     12  AM-MAINT-INFORMATION.
  1628         16  AM-LAST-MAINT-DT              PIC XX.
  1629         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1630         16  AM-LAST-MAINT-USER            PIC X(4).
  1631         16  FILLER                        PIC XX.
  1632
  1633     12  AM-EFFECTIVE-DT                   PIC XX.
  1634     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1635
  1636     12  AM-PREV-DATES  COMP-3.
  1637         16  AM-PREV-EXP-DT                PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  30
* NSRLTRBL.cbl
  1638         16  AM-PREV-EFF-DT                PIC 9(11).
  1639
  1640     12  AM-REPORT-CODE-1                  PIC X(10).
  1641     12  AM-REPORT-CODE-2                  PIC X(10).
  1642
  1643     12  AM-CITY-CODE                      PIC X(4).
  1644     12  AM-COUNTY-PARISH                  PIC X(6).
  1645
  1646     12  AM-NAME                           PIC X(30).
  1647     12  AM-PERSON                         PIC X(30).
  1648     12  AM-ADDRS                          PIC X(30).
  1649     12  AM-CITY.
  1650         16  AM-ADDR-CITY                  PIC X(28).
  1651         16  AM-ADDR-STATE                 PIC XX.
  1652     12  AM-ZIP.
  1653         16  AM-ZIP-PRIME.
  1654             20  AM-ZIP-PRI-1ST            PIC X.
  1655                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1656             20  FILLER                    PIC X(4).
  1657         16  AM-ZIP-PLUS4                  PIC X(4).
  1658     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1659         16  AM-CAN-POSTAL-1               PIC XXX.
  1660         16  AM-CAN-POSTAL-2               PIC XXX.
  1661         16  FILLER                        PIC XXX.
  1662     12  AM-TEL-NO.
  1663         16  AM-AREA-CODE                  PIC 999.
  1664         16  AM-TEL-PRE                    PIC 999.
  1665         16  AM-TEL-NBR                    PIC 9(4).
  1666     12  AM-TEL-LOC                        PIC X.
  1667         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1668         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1669
  1670     12  AM-COMM-STRUCTURE.
  1671         16  AM-DEFN-1.
  1672             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1673                 24  AM-AGT.
  1674                     28  AM-AGT-PREFIX     PIC X(4).
  1675                     28  AM-AGT-PRIME      PIC X(6).
  1676                 24  AM-COM-TYP            PIC X.
  1677                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1678                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1679                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1680                 24  AM-RECALC-LV-INDIC    PIC X.
  1681                 24  AM-RETRO-LV-INDIC     PIC X.
  1682                 24  AM-GL-CODES           PIC X.
  1683                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1684                 24  FILLER                PIC X(01).
  1685         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1686             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1687                 24  FILLER                PIC X(11).
  1688                 24  AM-L-COMA             PIC XXX.
  1689                 24  AM-J-COMA             PIC XXX.
  1690                 24  AM-A-COMA             PIC XXX.
  1691                 24  FILLER                PIC X(6).
  1692
  1693     12  AM-COMM-CHANGE-STATUS             PIC X.
  1694         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1695
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  31
* NSRLTRBL.cbl
  1696     12  AM-CSR-CODE                       PIC X(4).
  1697
  1698     12  AM-BILLING-STATUS                 PIC X.
  1699         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1700         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1701     12  AM-AUTO-REFUND-SW                 PIC X.
  1702         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1703         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1704     12  AM-GPCD                           PIC 99.
  1705     12  AM-IG                             PIC X.
  1706         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1707         88  AM-HAS-GROUP                     VALUE '2'.
  1708     12  AM-STATUS                         PIC X.
  1709         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1710         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1711         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1712         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1713         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1714         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1715         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1716         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1717         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1718         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1719     12  AM-REMIT-TO                       PIC 99.
  1720     12  AM-ID-NO                          PIC X(11).
  1721
  1722     12  AM-CAL-TABLE                      PIC XX.
  1723     12  AM-LF-DEVIATION                   PIC XXX.
  1724     12  AM-AH-DEVIATION                   PIC XXX.
  1725     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1726     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1727     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1728     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1729     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1730     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1731
  1732     12  AM-USER-FIELDS.
  1733         16  AM-FLD-1                      PIC XX.
  1734         16  AM-FLD-2                      PIC XX.
  1735         16  AM-FLD-3                      PIC XX.
  1736         16  AM-FLD-4                      PIC XX.
  1737         16  AM-FLD-5                      PIC XX.
  1738
  1739     12  AM-1ST-PROD-DATE.
  1740         16  AM-1ST-PROD-YR                PIC XX.
  1741         16  AM-1ST-PROD-MO                PIC XX.
  1742         16  AM-1ST-PROD-DA                PIC XX.
  1743     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1744     12  AM-CERTS-PURGED-DATE.
  1745         16  AM-PUR-YR                     PIC XX.
  1746         16  AM-PUR-MO                     PIC XX.
  1747         16  AM-PUR-DA                     PIC XX.
  1748     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1749     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1750     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1751     12  AM-INACTIVE-DATE.
  1752         16  AM-INA-MO                     PIC 99.
  1753         16  AM-INA-DA                     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  32
* NSRLTRBL.cbl
  1754         16  AM-INA-YR                     PIC 99.
  1755     12  AM-AR-HI-CERT-DATE                PIC XX.
  1756
  1757     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1758     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1759
  1760     12  AM-OB-PAYMENT-MODE                PIC X.
  1761         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1762         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1763         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1764         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1765
  1766     12  AM-AH-ONLY-INDICATOR              PIC X.
  1767         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1768         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1769
  1770     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1771
  1772     12  AM-OVER-SHORT.
  1773         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1774         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1775
  1776     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1777     12  AM-DCC-CLP-STATE                  PIC XX.
  1778
  1779     12  AM-RECALC-COMM                    PIC X.
  1780     12  AM-RECALC-REIN                    PIC X.
  1781
  1782     12  AM-REI-TABLE                      PIC XXX.
  1783     12  AM-REI-ET-LF                      PIC X.
  1784     12  AM-REI-ET-AH                      PIC X.
  1785     12  AM-REI-PE-LF                      PIC X.
  1786     12  AM-REI-PE-AH                      PIC X.
  1787     12  AM-REI-PRT-ST                     PIC X.
  1788     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1789     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1790     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1791     12  AM-REI-GROUP-A                    PIC X(6).
  1792     12  AM-REI-MORT                       PIC X(4).
  1793     12  AM-REI-PRT-OW                     PIC X.
  1794     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1795     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1796     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1797     12  AM-REI-GROUP-B                    PIC X(6).
  1798
  1799     12  AM-TRUST-TYPE                     PIC X(2).
  1800
  1801     12  AM-EMPLOYER-STMT-USED             PIC X.
  1802     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1803
  1804     12  AM-STD-AH-TYPE                    PIC XX.
  1805     12  AM-EARN-METHODS.
  1806         16  AM-EARN-METHOD-R              PIC X.
  1807             88 AM-REF-RL-R78                 VALUE 'R'.
  1808             88 AM-REF-RL-PR                  VALUE 'P'.
  1809             88 AM-REF-RL-MEAN                VALUE 'M'.
  1810             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1811         16  AM-EARN-METHOD-L              PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  33
* NSRLTRBL.cbl
  1812             88 AM-REF-LL-R78                 VALUE 'R'.
  1813             88 AM-REF-LL-PR                  VALUE 'P'.
  1814             88 AM-REF-LL-MEAN                VALUE 'M'.
  1815             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1816         16  AM-EARN-METHOD-A              PIC X.
  1817             88 AM-REF-AH-R78                 VALUE 'R'.
  1818             88 AM-REF-AH-PR                  VALUE 'P'.
  1819             88 AM-REF-AH-MEAN                VALUE 'M'.
  1820             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1821             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1822             88 AM-REF-AH-NET                 VALUE 'N'.
  1823
  1824     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1825     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1826     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1827
  1828     12  AM-RET-Y-N                        PIC X.
  1829     12  AM-RET-P-E                        PIC X.
  1830     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1831     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1832     12  AM-RET-GRP                        PIC X(6).
  1833     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1834         16  AM-POOL-PRIME                 PIC XXX.
  1835         16  AM-POOL-SUB                   PIC XXX.
  1836     12  AM-RETRO-EARNINGS.
  1837         16  AM-RET-EARN-R                 PIC X.
  1838         16  AM-RET-EARN-L                 PIC X.
  1839         16  AM-RET-EARN-A                 PIC X.
  1840     12  AM-RET-ST-TAX-USE                 PIC X.
  1841         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1842         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1843     12  AM-RETRO-BEG-EARNINGS.
  1844         16  AM-RET-BEG-EARN-R             PIC X.
  1845         16  AM-RET-BEG-EARN-L             PIC X.
  1846         16  AM-RET-BEG-EARN-A             PIC X.
  1847     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1848     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1849
  1850     12  AM-USER-SELECT-OPTIONS.
  1851         16  AM-USER-SELECT-1              PIC X(10).
  1852         16  AM-USER-SELECT-2              PIC X(10).
  1853         16  AM-USER-SELECT-3              PIC X(10).
  1854         16  AM-USER-SELECT-4              PIC X(10).
  1855         16  AM-USER-SELECT-5              PIC X(10).
  1856
  1857     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1858
  1859     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1860
  1861     12  AM-RPT045A-SWITCH                 PIC X.
  1862         88  RPT045A-OFF                   VALUE 'N'.
  1863
  1864     12  AM-INSURANCE-LIMITS.
  1865         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1866         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1867
  1868     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1869         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  34
* NSRLTRBL.cbl
  1870
  1871     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1872         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1873         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1874
  1875     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1876
  1877     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1878     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1879     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1880     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1881     12  AM-DCC-UEF-STATE                  PIC XX.
  1882     12  FILLER                            PIC XXX.
  1883     12  AM-REPORT-CODE-3                  PIC X(10).
  1884*    12  FILLER                            PIC X(22).
  1885
  1886     12  AM-RESERVE-DATE.
  1887         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1888         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1889         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1890
  1891     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1892     12  AM-NOTIFICATION-TYPES.
  1893         16  AM-NOTIF-OF-LETTERS           PIC X.
  1894         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1895         16  AM-NOTIF-OF-REPORTS           PIC X.
  1896         16  AM-NOTIF-OF-STATUS            PIC X.
  1897
  1898     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1899         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1900         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1901         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1902         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1903
  1904     12  AM-BENEFIT-CONTROLS.
  1905         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1906             20  AM-BENEFIT-CODE           PIC XX.
  1907             20  AM-BENEFIT-TYPE           PIC X.
  1908             20  AM-BENEFIT-REVISION       PIC XXX.
  1909             20  AM-BENEFIT-REM-TERM       PIC X.
  1910             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1911             20  FILLER                    PIC XX.
  1912         16  FILLER                        PIC X(80).
  1913
  1914     12  AM-TRANSFER-DATA.
  1915         16  AM-TRANSFERRED-FROM.
  1916             20  AM-TRNFROM-CARRIER        PIC X.
  1917             20  AM-TRNFROM-GROUPING.
  1918                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1919                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1920             20  AM-TRNFROM-STATE          PIC XX.
  1921             20  AM-TRNFROM-ACCOUNT.
  1922                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1923                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1924             20  AM-TRNFROM-DTE            PIC XX.
  1925         16  AM-TRANSFERRED-TO.
  1926             20  AM-TRNTO-CARRIER          PIC X.
  1927             20  AM-TRNTO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  35
* NSRLTRBL.cbl
  1928                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1929                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1930             20  AM-TRNTO-STATE            PIC XX.
  1931             20  AM-TRNTO-ACCOUNT.
  1932                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1933                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1934             20  AM-TRNTO-DTE              PIC XX.
  1935         16  FILLER                        PIC X(10).
  1936
  1937     12  AM-SAVED-REMIT-TO                 PIC 99.
  1938
  1939     12  AM-COMM-STRUCTURE-SAVED.
  1940         16  AM-DEFN-1-SAVED.
  1941             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1942                 24  AM-AGT-SV             PIC X(10).
  1943                 24  AM-COM-TYP-SV         PIC X.
  1944                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1945                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1946                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1947                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1948                 24  FILLER                PIC X.
  1949                 24  AM-GL-CODES-SV        PIC X.
  1950                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1951                 24  FILLER                PIC X.
  1952         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1953             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1954                 24  FILLER                PIC X(11).
  1955                 24  AM-L-COMA-SV          PIC XXX.
  1956                 24  AM-J-COMA-SV          PIC XXX.
  1957                 24  AM-A-COMA-SV          PIC XXX.
  1958                 24  FILLER                PIC X(6).
  1959
  1960     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1961         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1962            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1963            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1964            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1965
  1966     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1967     12  FILLER                            PIC X(120).
  1968
  1969     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1970         16  AM-CONTROL-NAME               PIC X(30).
  1971         16  AM-EXECUTIVE-ONE.
  1972             20  AM-EXEC1-NAME             PIC X(15).
  1973             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1974                                                          COMP-3.
  1975             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1976                                                          COMP-3.
  1977         16  AM-EXECUTIVE-TWO.
  1978             20  AM-EXEC2-NAME             PIC X(15).
  1979             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1980                                                          COMP-3.
  1981             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1982                                                          COMP-3.
  1983
  1984     12  AM-RETRO-ADDITIONAL-DATA.
  1985         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  36
* NSRLTRBL.cbl
  1986         16  AM-RETRO-PREM-P-E             PIC X.
  1987         16  AM-RETRO-CLMS-P-I             PIC X.
  1988         16  AM-RETRO-RET-BRACKET-LF.
  1989             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1990                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1991                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1992             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1993                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1994                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1995             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1996                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1997                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1998         16  AM-RETRO-RET-BRACKET-AH.
  1999             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2000                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2001                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2002                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2003             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2004                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2005                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2006             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2007                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2008                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2009
  2010     12  AM-COMMENTS.
  2011         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2012
  2013     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2014         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2015         16  AM-FLI-BILLING-CODE           PIC X.
  2016         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2017         16  AM-FLI-UNITED-IDENT           PIC X.
  2018         16  AM-FLI-INTEREST-LOST-DATA.
  2019             20  AM-FLI-BANK-NO            PIC X(5).
  2020             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2021             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2022             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2023         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2024             20  AM-FLI-AGT                PIC X(9).
  2025             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2026             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2027         16  FILLER                        PIC X(102).
  2028
  2029     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2030         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2031             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2032             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2033             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2034             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2035             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2036         16  FILLER                          PIC X(10).
  2037******************************************************************
  2038*                                COPY ELCBENE.
  2039******************************************************************
  2040*                                                                *
  2041*                            ELCBENE.                            *
  2042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2043*                            VMOD=2.006                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  37
* NSRLTRBL.cbl
  2044*                                                                *
  2045*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  2046*                                                                *
  2047*   FILE TYPE = VSAM,KSDS                                        *
  2048*   RECORD SIZE = 500   RECFORM = FIX                            *
  2049*                                                                *
  2050*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  2051*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  2052*                                                                *
  2053*   LOG = YES                                                    *
  2054*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2055*                                                                *
  2056*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  2057******************************************************************
  2058*                   C H A N G E   L O G
  2059*
  2060* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2061*-----------------------------------------------------------------
  2062*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2063* EFFECTIVE    NUMBER
  2064*-----------------------------------------------------------------
  2065* 013017  CR2016053100001  PEMA  ACH PROCESSING
  2066******************************************************************
  2067
  2068 01  BENEFICIARY-MASTER.
  2069     12  BE-RECORD-ID                PIC XX.
  2070         88  VALID-BE-ID                VALUE 'BE'.
  2071
  2072     12  BE-CONTROL-PRIMARY.
  2073         16  BE-COMPANY-CD           PIC X.
  2074         16  BE-RECORD-TYPE          PIC X.
  2075             88  BENEFICIARY-RECORD  VALUE 'B'.
  2076             88  ADJUSTOR-RECORD     VALUE 'A'.
  2077         16  BE-BENEFICIARY          PIC X(10).
  2078     12  BE-CONTROL-BY-NAME.
  2079         16  BE-COMPANY-CD-A1        PIC X.
  2080         16  BE-RECORD-TYPE-A1       PIC X.
  2081         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  2082         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  2083
  2084     12  BE-LAST-MAINT-DT            PIC XX.
  2085     12  BE-LAST-MAINT-BY            PIC X(4).
  2086     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  2087
  2088     12  BE-ADDRESS-DATA.
  2089         16  BE-MAIL-TO-NAME         PIC X(30).
  2090         16  BE-ADDRESS-LINE-1       PIC X(30).
  2091         16  BE-ADDRESS-LINE-2       PIC X(30).
  2092         16  BE-ADDRESS-LINE-3       PIC X(30).
  2093         16  BE-CITY-STATE.
  2094             20  BE-CITY             PIC X(28).
  2095             20  BE-STATE            PIC XX.
  2096         16  BE-ZIP-CODE.
  2097             20  BE-ZIP-PRIME.
  2098                 24  BE-ZIP-1ST      PIC X.
  2099                     88  BE-CANADIAN-POST-CODE
  2100                                         VALUE 'A' THRU 'Z'.
  2101                 24  FILLER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  38
* NSRLTRBL.cbl
  2102             20  BE-ZIP-PLUS4        PIC X(4).
  2103         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  2104             20  BE-CAN-POSTAL-1     PIC XXX.
  2105             20  BE-CAN-POSTAL-2     PIC XXX.
  2106             20  FILLER              PIC XXX.
  2107         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  2108         16  BE-GROUP-CHECKS-Y-N     PIC X.
  2109
  2110******************************************************************
  2111*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  2112*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  2113******************************************************************
  2114     12  BE-CARRIER                  PIC X.
  2115
  2116     12  BE-ADDRESS-DATA2.
  2117         16  BE-MAIL-TO-NAME2        PIC X(30).
  2118         16  BE-ADDRESS-LINE-12      PIC X(30).
  2119         16  BE-ADDRESS-LINE-22      PIC X(30).
  2120         16  BE-ADDRESS-LINE-32      PIC X(30).
  2121         16  BE-CITY-STATE2.
  2122             20  BE-CITY2            PIC X(28).
  2123             20  BE-STATE2           PIC XX.
  2124         16  BE-ZIP-CODE2.
  2125             20  BE-ZIP-PRIME2.
  2126                 24  BE-ZIP-1ST2     PIC X.
  2127                     88  BE-CANADIAN-POST-CODE2
  2128                                         VALUE 'A' THRU 'Z'.
  2129                 24  FILLER          PIC X(4).
  2130             20  BE-ZIP-PLUS42       PIC X(4).
  2131         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  2132             20  BE-CAN-POSTAL-12    PIC XXX.
  2133             20  BE-CAN-POSTAL-22    PIC XXX.
  2134             20  FILLER              PIC XXX.
  2135         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  2136         16  BE-ACH-DATA.
  2137             20  BE-ACH-YES-OR-NO    PIC X.
  2138                 88  BE-ON-ACH       VALUE 'Y'.
  2139                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  2140             20  BE-ACH-ABA-ROUTING-NUMBER
  2141                                     PIC X(15).
  2142             20  BE-ACH-BANK-ACCOUNT-NUMBER
  2143                                     PIC X(20).
  2144             20  FILLER              PIC X(25).
  2145         16  BE-BILLING-STMT-DATA.
  2146*            20  BE-BSR              PIC X.
  2147*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  2148*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  2149*            20  BE-BSR-FROM         PIC X(30).
  2150*            20  BE-BSR-DEPT         PIC X(30).
  2151             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  2152             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  2153             20  BE-OUTPUT-TYPE      PIC X.
  2154                 88  BE-FAX-OUTPUT         VALUE 'F'.
  2155                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  2156
  2157     12  FILLER                      PIC X(28).
  2158******************************************************************
  2159*                                COPY ELCTEXT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  39
* NSRLTRBL.cbl
  2160******************************************************************
  2161*                                                                *
  2162*                                                                *
  2163*                            ELCTEXT.                            *
  2164*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2165*                            VMOD=2.008                          *
  2166*                                                                *
  2167*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2168*                                     FORM LETTERS,              *
  2169*                                     CERT FORM DISPLAY.
  2170*                                                                *
  2171*   FILE TYPE = VSAM,KSDS                                        *
  2172*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2173*                                                                *
  2174*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2175*       ALTERNATE INDEX = NONE                                   *
  2176*                                                                *
  2177*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2178*       ALTERNATE INDEX = NONE                                   *
  2179*                                                                *
  2180*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2181*       ALTERNATE INDEX = NONE                                   *
  2182*                                                                *
  2183*   LOG = NO                                                     *
  2184*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2185******************************************************************
  2186 01  TEXT-FILES.
  2187     12  TEXT-FILE-ID                PIC XX.
  2188         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2189         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2190         88  HELP-FILE-TEXT             VALUE 'TH'.
  2191
  2192     12  TX-CONTROL-PRIMARY.
  2193         16  TX-COMPANY-CD           PIC X.
  2194             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2195         16  TX-ACCESS-CD-GENL       PIC X(12).
  2196
  2197         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2198             20  TX-LETTER-NO        PIC X(4).
  2199             20  FILLER              PIC X(8).
  2200
  2201         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2202             20  TX-FORM-NO          PIC X(12).
  2203
  2204         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2205             20  TX-HELP-TYPE        PIC X.
  2206                 88  HELP-FOR-GENERAL   VALUE ' '.
  2207                 88  HELP-BY-SCREEN     VALUE 'S'.
  2208                 88  HELP-BY-ERROR      VALUE 'E'.
  2209             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2210                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2211             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2212                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2213             20  FILLER              PIC X(4).
  2214
  2215         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2216
  2217     12  TX-PROCESS-CONTROL          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  40
* NSRLTRBL.cbl
  2218         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2219
  2220     12  TX-TEXT-LINE                PIC X(70).
  2221
  2222     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2223         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2224         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2225         88  TX-VALID-FORM-SQUEEZE-VALUE
  2226                                        VALUE 'Y' ' '.
  2227
  2228     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2229         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2230         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2231         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2232         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2233         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2234         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2235         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2236                                              'K' 'N' ' '
  2237                                              'Z'.
  2238
  2239     12  TX-ARCHIVE-SW               PIC X.
  2240         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2241         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2242         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2243
  2244     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2245     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2246
  2247     12  TX-BSR-CODE                 PIC X.
  2248         88  TX-BSR-LETTER              VALUE 'B'.
  2249         88  TX-NON-BSR-LETTER          VALUE ' '.
  2250
  2251     12  FILLER                      PIC X.
  2252*****************************************************************
  2253*                                COPY ELCCNTL.
  2254******************************************************************
  2255*                                                                *
  2256*                                                                *
  2257*                            ELCCNTL.                            *
  2258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2259*                            VMOD=2.059                          *
  2260*                                                                *
  2261*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2262*                                                                *
  2263*   FILE TYPE = VSAM,KSDS                                        *
  2264*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2265*                                                                *
  2266*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2267*       ALTERNATE INDEX = NONE                                   *
  2268*                                                                *
  2269*   LOG = YES                                                    *
  2270*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2271******************************************************************
  2272*                   C H A N G E   L O G
  2273*
  2274* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2275*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  41
* NSRLTRBL.cbl
  2276*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2277* EFFECTIVE    NUMBER
  2278*-----------------------------------------------------------------
  2279* 082503                   PEMA  ADD BENEFIT GROUP
  2280* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2281* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2282* 092705    2005050300006  PEMA  ADD SPP LEASES
  2283* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2284* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2285* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2286* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2287* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2288* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2289* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2290* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2291* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2292* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2293******************************************************************
  2294*
  2295 01  CONTROL-FILE.
  2296     12  CF-RECORD-ID                       PIC XX.
  2297         88  VALID-CF-ID                        VALUE 'CF'.
  2298
  2299     12  CF-CONTROL-PRIMARY.
  2300         16  CF-COMPANY-ID                  PIC XXX.
  2301         16  CF-RECORD-TYPE                 PIC X.
  2302             88  CF-COMPANY-MASTER              VALUE '1'.
  2303             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2304             88  CF-STATE-MASTER                VALUE '3'.
  2305             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2306             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2307             88  CF-CARRIER-MASTER              VALUE '6'.
  2308             88  CF-MORTALITY-MASTER            VALUE '7'.
  2309             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2310             88  CF-TERMINAL-MASTER             VALUE '9'.
  2311             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2312             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2313             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2314             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2315             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2316             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2317             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2318             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2319             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2320         16  CF-ACCESS-CD-GENL              PIC X(4).
  2321         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2322             20  CF-PROCESSOR               PIC X(4).
  2323         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2324             20  CF-STATE-CODE              PIC XX.
  2325             20  FILLER                     PIC XX.
  2326         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2327             20  FILLER                     PIC XX.
  2328             20  CF-HI-BEN-IN-REC           PIC XX.
  2329         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2330             20  FILLER                     PIC XXX.
  2331             20  CF-CARRIER-CNTL            PIC X.
  2332         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2333             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  42
* NSRLTRBL.cbl
  2334             20  CF-HI-TYPE-IN-REC          PIC 99.
  2335         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2336             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2337                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2338             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2339             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2340         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2341             20  FILLER                     PIC X.
  2342             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2343         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2344             20  FILLER                     PIC XX.
  2345             20  CF-MORTGAGE-PLAN           PIC XX.
  2346         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2347
  2348     12  CF-LAST-MAINT-DT                   PIC XX.
  2349     12  CF-LAST-MAINT-BY                   PIC X(4).
  2350     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2351
  2352     12  CF-RECORD-BODY                     PIC X(728).
  2353
  2354
  2355****************************************************************
  2356*             COMPANY MASTER RECORD                            *
  2357****************************************************************
  2358
  2359     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2360         16  CF-COMPANY-ADDRESS.
  2361             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2362             20  CF-CL-IN-CARE-OF           PIC X(30).
  2363             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2364             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2365             20  CF-CL-CITY-STATE           PIC X(30).
  2366             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2367             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2368         16  CF-COMPANY-CD                  PIC X.
  2369         16  CF-COMPANY-PASSWORD            PIC X(8).
  2370         16  CF-SECURITY-OPTION             PIC X.
  2371             88  ALL-SECURITY                   VALUE '1'.
  2372             88  COMPANY-VERIFY                 VALUE '2'.
  2373             88  PROCESSOR-VERIFY               VALUE '3'.
  2374             88  NO-SECURITY                    VALUE '4'.
  2375             88  ALL-BUT-TERM                   VALUE '5'.
  2376         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2377             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2378         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2379             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2380         16  CF-INFORCE-LOCATION            PIC X.
  2381             88  CERTS-ARE-ONLINE               VALUE '1'.
  2382             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2383             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2384         16  CF-LOWER-CASE-LETTERS          PIC X.
  2385         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2386             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2387             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2388             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2389             88  CF-ACCNT-CNTL                  VALUE '3'.
  2390             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2391
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  43
* NSRLTRBL.cbl
  2392         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2393         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2394
  2395         16  CF-LGX-CREDIT-USER             PIC X.
  2396             88  CO-IS-NOT-USER                 VALUE 'N'.
  2397             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2398
  2399         16 CF-CREDIT-CALC-CODES.
  2400             20  CF-CR-REM-TERM-CALC PIC X.
  2401               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2402               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2403               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2404               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2405               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2406               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2407               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2408             20  CF-CR-R78-METHOD           PIC X.
  2409               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2410               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2411
  2412         16  CF-CLAIM-CONTROL-COUNTS.
  2413             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2414                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2415
  2416             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2417                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2418
  2419             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2420                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2421
  2422             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2423                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2424
  2425         16  CF-CURRENT-MONTH-END           PIC XX.
  2426
  2427         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2428             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2429             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2430             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2431             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2432                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2433                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2434             20  CF-CO-PREM-REJECT-SW       PIC X.
  2435                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2436                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2437             20  CF-CO-REF-REJECT-SW        PIC X.
  2438                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2439                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2440
  2441         16  CF-CO-REPORTING-DT             PIC XX.
  2442         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2443         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2444           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2445           88  CF-CO-MONTH-END                  VALUE '1'.
  2446
  2447         16  CF-LGX-CLAIM-USER              PIC X.
  2448             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2449             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  44
* NSRLTRBL.cbl
  2450
  2451         16  CF-CREDIT-EDIT-CONTROLS.
  2452             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2453             20  CF-MIN-AGE                 PIC 99.
  2454             20  CF-DEFAULT-AGE             PIC 99.
  2455             20  CF-MIN-TERM                PIC S999      COMP-3.
  2456             20  CF-MAX-TERM                PIC S999      COMP-3.
  2457             20  CF-DEFAULT-SEX             PIC X.
  2458             20  CF-JOINT-AGE-INPUT         PIC X.
  2459                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2460             20  CF-BIRTH-DATE-INPUT        PIC X.
  2461                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2462             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2463                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2464                 88  CF-ZERO-CARRIER            VALUE '1'.
  2465                 88  CF-ZERO-GROUPING           VALUE '2'.
  2466                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2467             20  CF-EDIT-SW                 PIC X.
  2468                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2469             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2470             20  CF-CR-PR-METHOD            PIC X.
  2471               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2472               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2473             20  FILLER                     PIC X.
  2474
  2475         16  CF-CREDIT-MISC-CONTROLS.
  2476             20  CF-REIN-TABLE-SW           PIC X.
  2477                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2478             20  CF-COMP-TABLE-SW           PIC X.
  2479                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2480             20  CF-EXPERIENCE-RETENTION-AGE
  2481                                            PIC S9        COMP-3.
  2482             20  CF-CONVERSION-DT           PIC XX.
  2483             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2484             20  CF-RUN-FREQUENCY-SW        PIC X.
  2485                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2486                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2487
  2488             20  CF-CR-CHECK-NO-CONTROL.
  2489                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2490                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2491                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2492                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2493                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2494                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2495
  2496                 24  CF-CR-CHECK-COUNT       REDEFINES
  2497                     CF-CR-CHECK-COUNTER      PIC X(4).
  2498
  2499                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2500                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2501
  2502                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2503                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2504                 24  CF-MAIL-PROCESSING       PIC X.
  2505                     88  MAIL-PROCESSING          VALUE 'Y'.
  2506
  2507         16  CF-MISC-SYSTEM-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  45
* NSRLTRBL.cbl
  2508             20  CF-SYSTEM-C                 PIC X.
  2509                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2510             20  CF-SYSTEM-D                 PIC X.
  2511                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2512             20  CF-SOC-SEC-NO-SW            PIC X.
  2513                 88  SOC-SEC-NO-USED             VALUE '1'.
  2514             20  CF-MEMBER-NO-SW             PIC X.
  2515                 88  MEMBER-NO-USED              VALUE '1'.
  2516             20  CF-TAX-ID-NUMBER            PIC X(11).
  2517             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2518             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2519                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2520                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2521                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2522                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2523             20  CF-SYSTEM-E                 PIC X.
  2524                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2525
  2526         16  CF-LGX-LIFE-USER               PIC X.
  2527             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2528             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2529
  2530         16  CF-CR-MONTH-END-DT             PIC XX.
  2531
  2532         16  CF-FILE-MAINT-DATES.
  2533             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2534                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2535             20  CF-LAST-BATCH       REDEFINES
  2536                 CF-LAST-BATCH-NO               PIC X(4).
  2537             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2538             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2539             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2540             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2541             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2542             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2543             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2544             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2545             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2546             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2547
  2548         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2549         16  FILLER                         PIC X.
  2550
  2551         16  CF-ALT-MORT-CODE               PIC X(4).
  2552         16  CF-MEMBER-CAPTION              PIC X(10).
  2553
  2554         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2555             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2556             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2557             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2558             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2559             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2560
  2561         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2562
  2563         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2564         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2565         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  46
* NSRLTRBL.cbl
  2566         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2567
  2568         16  CF-AH-OVERRIDE-L1              PIC X.
  2569         16  CF-AH-OVERRIDE-L2              PIC XX.
  2570         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2571         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2572
  2573         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2574         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2575
  2576         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2577         16  CF-AR-LAST-EL860-DT            PIC XX.
  2578         16  CF-MP-MONTH-END-DT             PIC XX.
  2579
  2580         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2581         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2582             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2583
  2584         16  CF-AR-MONTH-END-DT             PIC XX.
  2585
  2586         16  CF-CRDTCRD-USER                PIC X.
  2587             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2588             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2589
  2590         16  CF-CC-MONTH-END-DT             PIC XX.
  2591
  2592         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2593
  2594         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2595             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2596             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2597             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2598         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2599         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2600         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2601         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2602             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2603             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2604         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2605         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2606         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2607             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2608         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2609
  2610         16  CF-CL-ZIP-CODE.
  2611             20  CF-CL-ZIP-PRIME.
  2612                 24  CF-CL-ZIP-1ST          PIC X.
  2613                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2614                 24  FILLER                 PIC X(4).
  2615             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2616         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2617             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2618             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2619             20  FILLER                     PIC XXX.
  2620
  2621         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2622         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2623         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  47
* NSRLTRBL.cbl
  2624         16  CF-CO-OPTION-START-DATE        PIC XX.
  2625         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2626           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2627                                                      '3' '4'.
  2628           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2629           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2630           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2631           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2632           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2633           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2634
  2635         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2636
  2637         16  CF-PAYMENT-APPROVAL-LEVELS.
  2638             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2639             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2640             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2641             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2642             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2643             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2644
  2645         16  CF-END-USER-REPORTING-USER     PIC X.
  2646             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2647             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2648
  2649         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2650             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2651             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2652
  2653         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2654
  2655         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2656         16  FILLER                         PIC X.
  2657
  2658         16  CF-CREDIT-ARCHIVE-CNTL.
  2659             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2660             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2661             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2662
  2663         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2664
  2665         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2666             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2667             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2668
  2669         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2670             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2671             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2672
  2673         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2674
  2675         16  CF-CO-ACH-ID-CODE              PIC  X.
  2676             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2677             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2678             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2679         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2680         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2681         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  48
* NSRLTRBL.cbl
  2682         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2683         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2684         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2685         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2686         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2687         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2688                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2689         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2690                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2691
  2692         16  CF-CO-OVER-SHORT.
  2693             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2694             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2695
  2696*         16  FILLER                         PIC X(102).
  2697         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2698             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2699             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2700
  2701         16  CF-AH-APPROVAL-DAYS.
  2702             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2703             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2704             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2705             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2706
  2707         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2708
  2709         16  CF-APPROV-LEV-5.
  2710             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2711             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2712             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2713
  2714         16  FILLER                         PIC X(68).
  2715****************************************************************
  2716*             PROCESSOR/USER RECORD                            *
  2717****************************************************************
  2718
  2719     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2720         16  CF-PROCESSOR-NAME              PIC X(30).
  2721         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2722         16  CF-PROCESSOR-TITLE             PIC X(26).
  2723         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2724                 88  MESSAGE-YES                VALUE 'Y'.
  2725                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2726
  2727*****************************************************
  2728****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2729****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2730****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2731****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2732*****************************************************
  2733
  2734         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2735             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2736             20  CF-APPLICATION-FORCE       PIC X.
  2737             20  CF-INDIVIDUAL-APP.
  2738                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2739                     28  CF-BROWSE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  49
* NSRLTRBL.cbl
  2740                     28  CF-UPDATE-APP      PIC X.
  2741
  2742         16  CF-CURRENT-TERM-ON             PIC X(4).
  2743         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2744             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2745             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2746             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2747             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2748             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2749             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2750             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2751         16  CF-PROCESSOR-CARRIER           PIC X.
  2752             88  NO-CARRIER-SECURITY            VALUE ' '.
  2753         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2754             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2755         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2756             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2757         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2758             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2759
  2760         16  CF-PROC-SYS-ACCESS-SW.
  2761             20  CF-PROC-CREDIT-CLAIMS-SW.
  2762                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2763                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2764                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2765                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2766             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2767                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2768                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2769             20  CF-PROC-LIFE-GNRLDGR-SW.
  2770                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2771                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2772                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2773                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2774             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2775                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2776                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2777         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2778             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2779             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2780         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2781
  2782         16  CF-APPROVAL-LEVEL                  PIC X.
  2783             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2784             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2785             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2786             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2787             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2788
  2789         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2790
  2791         16  CF-LANGUAGE-TYPE                   PIC X.
  2792             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2793             88  CF-LANG-IS-FR                      VALUE 'F'.
  2794
  2795         16  CF-CSR-IND                         PIC X.
  2796         16  FILLER                             PIC X(239).
  2797
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  50
* NSRLTRBL.cbl
  2798****************************************************************
  2799*             PROCESSOR/REMINDERS RECORD                       *
  2800****************************************************************
  2801
  2802     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2803         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2804             20  CF-START-REMIND-DT         PIC XX.
  2805             20  CF-END-REMIND-DT           PIC XX.
  2806             20  CF-REMINDER-TEXT           PIC X(50).
  2807         16  FILLER                         PIC X(296).
  2808
  2809
  2810****************************************************************
  2811*             STATE MASTER RECORD                              *
  2812****************************************************************
  2813
  2814     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2815         16  CF-STATE-ABBREVIATION          PIC XX.
  2816         16  CF-STATE-NAME                  PIC X(25).
  2817         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2818         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2819             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2820             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2821             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2822             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2823                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2824                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2825             20  CF-ST-PREM-REJECT-SW       PIC X.
  2826                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2827                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2828             20  CF-ST-REF-REJECT-SW        PIC X.
  2829                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2830                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2831         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2832         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2833         16  CF-ST-REFUND-RULES.
  2834             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2835             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2836             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2837         16  CF-ST-FST-PMT-EXTENSION.
  2838             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2839             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2840                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2841                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2842                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2843                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2844         16  CF-ST-STATE-CALL.
  2845             20  CF-ST-CALL-UNEARNED        PIC X.
  2846             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2847             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2848         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2849             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2850             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2851         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2852         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2853         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2854         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2855         16  CF-ST-SPLIT-PAYMENT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  51
* NSRLTRBL.cbl
  2856         16  FILLER                         PIC X.
  2857         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2858             20  CF-ST-BENEFIT-CD           PIC XX.
  2859             20  CF-ST-BENEFIT-KIND         PIC X.
  2860                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2861                 88  CF-ST-AH-KIND              VALUE 'A'.
  2862             20  CF-ST-REM-TERM-CALC        PIC X.
  2863                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2864                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2865                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2866                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2867                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2868                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2869                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2870                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2871
  2872             20  CF-ST-REFUND-CALC          PIC X.
  2873                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2874                 88  ST-REFD-BY-R78             VALUE '1'.
  2875                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2876                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2877                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2878                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2879                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2880                 88  ST-REFD-UTAH               VALUE '7'.
  2881                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2882                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2883                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2884
  2885             20  CF-ST-EARNING-CALC         PIC X.
  2886                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2887                 88  ST-EARN-BY-R78             VALUE '1'.
  2888                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2889                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2890                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2891                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2892                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2893                 88  ST-EARN-MEAN               VALUE '8'.
  2894                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2895
  2896             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2897                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2898                 88  ST-OVRD-BY-R78             VALUE '1'.
  2899                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2900                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2901                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2902                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2903                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2904                 88  ST-OVRD-MEAN               VALUE '8'.
  2905                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2906             20  cf-st-extra-periods        pic 9.
  2907*            20  FILLER                     PIC X.
  2908
  2909         16  CF-ST-COMMISSION-CAPS.
  2910             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2911             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2912             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2913             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  52
* NSRLTRBL.cbl
  2914         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2915                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2916
  2917         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2918
  2919         16  CF-ST-STATUTORY-INTEREST.
  2920             20  CF-ST-STAT-DATE-FROM       PIC X.
  2921                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2922                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2923             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2924             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2925             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2926             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2927             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2928
  2929         16  CF-ST-OVER-SHORT.
  2930             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2931             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2932
  2933         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2934
  2935         16  CF-ST-RT-CALC                  PIC X.
  2936
  2937         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2938         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2939         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2940         16  CF-ST-RF-LR-CALC               PIC X.
  2941         16  CF-ST-RF-LL-CALC               PIC X.
  2942         16  CF-ST-RF-LN-CALC               PIC X.
  2943         16  CF-ST-RF-AH-CALC               PIC X.
  2944         16  CF-ST-RF-CP-CALC               PIC X.
  2945*        16  FILLER                         PIC X(206).
  2946*CIDMOD         16  FILLER                         PIC X(192).
  2947         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2948             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2949         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2950         16  CF-ST-VFY-2ND-BENE             PIC X.
  2951         16  CF-ST-CAUSAL-STATE             PIC X.
  2952         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2953         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2954         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2955             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2956         16  CF-ST-NET-ONLY-STATE           PIC X.
  2957             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2958         16  FILLER                         PIC X(181).
  2959
  2960****************************************************************
  2961*             BENEFIT MASTER RECORD                            *
  2962****************************************************************
  2963
  2964     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2965         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2966             20  CF-BENEFIT-CODE            PIC XX.
  2967             20  CF-BENEFIT-NUMERIC  REDEFINES
  2968                 CF-BENEFIT-CODE            PIC XX.
  2969             20  CF-BENEFIT-ALPHA           PIC XXX.
  2970             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2971             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  53
* NSRLTRBL.cbl
  2972
  2973             20  CF-LF-COVERAGE-TYPE        PIC X.
  2974                 88  CF-REDUCING                VALUE 'R'.
  2975                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2976
  2977             20  CF-SPECIAL-CALC-CD         PIC X.
  2978                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2979                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2980                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2981                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2982                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2983                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2984                 88  CF-FARM-PLAN               VALUE 'F'.
  2985                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2986                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2987                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2988                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2989                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2990                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2991                 88  CF-PRUDENTIAL              VALUE 'P'.
  2992                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2993                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2994                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2995                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2996                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2997                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2998
  2999             20  CF-JOINT-INDICATOR         PIC X.
  3000                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3001
  3002*            20  FILLER                     PIC X(12).
  3003             20  cf-maximum-benefits        pic s999 comp-3.
  3004             20  FILLER                     PIC X(09).
  3005             20  CF-BENEFIT-CATEGORY        PIC X.
  3006             20  CF-LOAN-TYPE               PIC X(8).
  3007
  3008             20  CF-CO-REM-TERM-CALC        PIC X.
  3009                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3010                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3011                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3012                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3013                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3014
  3015             20  CF-CO-EARNINGS-CALC        PIC X.
  3016                 88  CO-EARN-BY-R78             VALUE '1'.
  3017                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3018                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3019                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3020                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3021                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3022                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3023                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3024
  3025             20  CF-CO-REFUND-CALC          PIC X.
  3026                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3027                 88  CO-REFD-BY-R78             VALUE '1'.
  3028                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3029                 88  CO-REFD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  54
* NSRLTRBL.cbl
  3030                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3031                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3032                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3033                 88  CO-REFD-MEAN               VALUE '8'.
  3034                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3035                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3036                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3037
  3038             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3039                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3040                 88  CO-OVRD-BY-R78             VALUE '1'.
  3041                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3042                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3043                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3044                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3045                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3046                 88  CO-OVRD-MEAN               VALUE '8'.
  3047                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3048
  3049             20  CF-CO-BEN-I-G-CD           PIC X.
  3050                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3051                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3052                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3053
  3054         16  FILLER                         PIC X(304).
  3055
  3056
  3057****************************************************************
  3058*             CARRIER MASTER RECORD                            *
  3059****************************************************************
  3060
  3061     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3062         16  CF-ADDRESS-DATA.
  3063             20  CF-MAIL-TO-NAME            PIC X(30).
  3064             20  CF-IN-CARE-OF              PIC X(30).
  3065             20  CF-ADDRESS-LINE-1          PIC X(30).
  3066             20  CF-ADDRESS-LINE-2          PIC X(30).
  3067             20  CF-CITY-STATE              PIC X(30).
  3068             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3069             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3070
  3071         16  CF-CLAIM-NO-CONTROL.
  3072             20  CF-CLAIM-NO-METHOD         PIC X.
  3073                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3074                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3075                 88  CLAIM-NO-SEQ               VALUE '3'.
  3076                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3077             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3078                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3079                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3080                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3081
  3082         16  CF-CHECK-NO-CONTROL.
  3083             20  CF-CHECK-NO-METHOD         PIC X.
  3084                 88  CHECK-NO-MANUAL            VALUE '1'.
  3085                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3086                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3087                 88  CHECK-NO-AT-PRINT          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  55
* NSRLTRBL.cbl
  3088             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3089                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3090
  3091         16  CF-DOMICILE-STATE              PIC XX.
  3092
  3093         16  CF-EXPENSE-CONTROLS.
  3094             20  CF-EXPENSE-METHOD          PIC X.
  3095                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3096                 88  DOLLARS-PER-PMT            VALUE '2'.
  3097                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3098                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3099             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3100             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3101
  3102         16  CF-CORRESPONDENCE-CONTROL.
  3103             20  CF-LETTER-RESEND-OPT       PIC X.
  3104                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3105                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3106             20  FILLER                     PIC X(4).
  3107
  3108         16  CF-RESERVE-CONTROLS.
  3109             20  CF-MANUAL-SW               PIC X.
  3110                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3111             20  CF-FUTURE-SW               PIC X.
  3112                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3113             20  CF-PTC-SW                  PIC X.
  3114                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3115             20  CF-IBNR-SW                 PIC X.
  3116                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3117             20  CF-PTC-LF-SW               PIC X.
  3118                 88  CF-LF-PTC-USED             VALUE '1'.
  3119             20  CF-CDT-ACCESS-METHOD       PIC X.
  3120                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3121                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3122                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3123             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3124
  3125         16  CF-CLAIM-CALC-METHOD           PIC X.
  3126             88  360-PLUS-MONTHS                VALUE '1'.
  3127             88  365-PLUS-MONTHS                VALUE '2'.
  3128             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3129             88  360-DAILY                      VALUE '4'.
  3130             88  365-DAILY                      VALUE '5'.
  3131
  3132         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3133         16  FILLER                         PIC X(11).
  3134
  3135         16  CF-LIMIT-AMOUNTS.
  3136             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3137             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3138             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3139             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3140             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3141             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3142             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3143             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3144             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3145             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  56
* NSRLTRBL.cbl
  3146
  3147         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3148         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3149         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3150
  3151         16  CF-ZIP-CODE.
  3152             20  CF-ZIP-PRIME.
  3153                 24  CF-ZIP-1ST             PIC X.
  3154                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3155                 24  FILLER                 PIC X(4).
  3156             20  CF-ZIP-PLUS4               PIC X(4).
  3157         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3158             20  CF-CAN-POSTAL-1            PIC XXX.
  3159             20  CF-CAN-POSTAL-2            PIC XXX.
  3160             20  FILLER                     PIC XXX.
  3161
  3162         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3163         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3164         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3165
  3166         16  CF-RATING-SWITCH               PIC X.
  3167             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3168             88  CF-NO-RATING                   VALUE 'N'.
  3169
  3170         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3171
  3172         16  CF-CARRIER-OVER-SHORT.
  3173             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3174             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3175
  3176         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3177         16  CF-SECPAY-SWITCH               PIC X.
  3178             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3179             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3180         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3181         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3182         16  FILLER                         PIC X(444).
  3183*        16  FILLER                         PIC X(452).
  3184
  3185
  3186****************************************************************
  3187*             MORTALITY MASTER RECORD                          *
  3188****************************************************************
  3189
  3190     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3191         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3192                                INDEXED BY CF-MORT-NDX.
  3193             20  CF-MORT-TABLE              PIC X(5).
  3194             20  CF-MORT-TABLE-TYPE         PIC X.
  3195                 88  CF-MORT-JOINT              VALUE 'J'.
  3196                 88  CF-MORT-SINGLE             VALUE 'S'.
  3197                 88  CF-MORT-COMBINED           VALUE 'C'.
  3198                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3199                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3200             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3201             20  CF-MORT-AGE-METHOD         PIC XX.
  3202                 88  CF-AGE-LAST                VALUE 'AL'.
  3203                 88  CF-AGE-NEAR                VALUE 'AN'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  57
* NSRLTRBL.cbl
  3204             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3205             20  CF-MORT-ADJUSTMENT-DIRECTION
  3206                                            PIC X.
  3207                 88  CF-MINUS                   VALUE '-'.
  3208                 88  CF-PLUS                    VALUE '+'.
  3209             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3210             20  CF-MORT-JOINT-CODE         PIC X.
  3211                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3212             20  CF-MORT-PC-Q               PIC X.
  3213                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3214             20  CF-MORT-TABLE-CODE         PIC X(4).
  3215             20  CF-MORT-COMMENTS           PIC X(15).
  3216             20  FILLER                     PIC X(14).
  3217
  3218         16  FILLER                         PIC X(251).
  3219
  3220
  3221****************************************************************
  3222*             BUSSINESS TYPE MASTER RECORD                     *
  3223****************************************************************
  3224
  3225     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3226* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3227* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3228* AND RECORD 05 IS TYPES 81-99
  3229         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3230             20  CF-BUSINESS-TITLE          PIC  X(19).
  3231             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3232                                            PIC S9V9(4) COMP-3.
  3233             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3234             20  FILLER                     PIC  X.
  3235         16  FILLER                         PIC  X(248).
  3236
  3237
  3238****************************************************************
  3239*             TERMINAL MASTER RECORD                           *
  3240****************************************************************
  3241
  3242     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3243
  3244         16  CF-COMPANY-TERMINALS.
  3245             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3246                                  PIC X(4).
  3247         16  FILLER               PIC X(248).
  3248
  3249
  3250****************************************************************
  3251*             LIFE EDIT MASTER RECORD                          *
  3252****************************************************************
  3253
  3254     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3255         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3256             20  CF-LIFE-CODE-IN            PIC XX.
  3257             20  CF-LIFE-CODE-OUT           PIC XX.
  3258         16  FILLER                         PIC X(248).
  3259
  3260
  3261****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  58
* NSRLTRBL.cbl
  3262*             AH EDIT MASTER RECORD                            *
  3263****************************************************************
  3264
  3265     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3266         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3267             20  CF-AH-CODE-IN              PIC XXX.
  3268             20  CF-AH-CODE-OUT             PIC XX.
  3269         16  FILLER                         PIC X(248).
  3270
  3271
  3272****************************************************************
  3273*             CREDIBILITY TABLES                               *
  3274****************************************************************
  3275
  3276     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3277         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3278                             INDEXED BY CF-CRDB-NDX.
  3279             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3280             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3281             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3282         16  FILLER                         PIC  X(332).
  3283
  3284
  3285****************************************************************
  3286*             REPORT CUSTOMIZATION RECORD                      *
  3287****************************************************************
  3288
  3289     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3290         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3291             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3292             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3293             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3294**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3295****       A T-TRANSFER.                                   ****
  3296             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3297
  3298         16  FILLER                         PIC XX.
  3299
  3300         16  CF-CARRIER-CNTL-OPT.
  3301             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3302                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3303                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3304             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3305                                            PIC X.
  3306         16  CF-GROUP-CNTL-OPT.
  3307             20  CF-GROUP-OPT-SEQ           PIC 9.
  3308                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3309                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3310             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3311                                            PIC X(6).
  3312         16  CF-STATE-CNTL-OPT.
  3313             20  CF-STATE-OPT-SEQ           PIC 9.
  3314                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3315                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3316             20  CF-STATE-SELECT OCCURS 3 TIMES
  3317                                            PIC XX.
  3318         16  CF-ACCOUNT-CNTL-OPT.
  3319             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  59
* NSRLTRBL.cbl
  3320                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3321                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3322             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3323                                            PIC X(10).
  3324         16  CF-BUS-TYP-CNTL-OPT.
  3325             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3326                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3327                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3328             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3329                                            PIC XX.
  3330         16  CF-LF-TYP-CNTL-OPT.
  3331             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3332                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3333                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3334             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3335                                            PIC XX.
  3336         16  CF-AH-TYP-CNTL-OPT.
  3337             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3338                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3339                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3340             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3341                                            PIC XX.
  3342         16  CF-REPTCD1-CNTL-OPT.
  3343             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3344                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3345                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3346             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3347                                            PIC X(10).
  3348         16  CF-REPTCD2-CNTL-OPT.
  3349             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3350                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3351                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3352             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3353                                            PIC X(10).
  3354         16  CF-USER1-CNTL-OPT.
  3355             20  CF-USER1-OPT-SEQ           PIC 9.
  3356                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3357                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3358             20  CF-USER1-SELECT OCCURS 3 TIMES
  3359                                            PIC X(10).
  3360         16  CF-USER2-CNTL-OPT.
  3361             20  CF-USER2-OPT-SEQ           PIC 9.
  3362                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3363                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3364             20  CF-USER2-SELECT OCCURS 3 TIMES
  3365                                            PIC X(10).
  3366         16  CF-USER3-CNTL-OPT.
  3367             20  CF-USER3-OPT-SEQ           PIC 9.
  3368                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3369                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3370             20  CF-USER3-SELECT OCCURS 3 TIMES
  3371                                            PIC X(10).
  3372         16  CF-USER4-CNTL-OPT.
  3373             20  CF-USER4-OPT-SEQ           PIC 9.
  3374                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3375                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3376             20  CF-USER4-SELECT OCCURS 3 TIMES
  3377                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  60
* NSRLTRBL.cbl
  3378         16  CF-USER5-CNTL-OPT.
  3379             20  CF-USER5-OPT-SEQ           PIC 9.
  3380                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3381                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3382             20  CF-USER5-SELECT OCCURS 3 TIMES
  3383                                            PIC X(10).
  3384         16  CF-REINS-CNTL-OPT.
  3385             20  CF-REINS-OPT-SEQ           PIC 9.
  3386                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3387                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3388             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3389                 24  CF-REINS-PRIME         PIC XXX.
  3390                 24  CF-REINS-SUB           PIC XXX.
  3391
  3392         16  CF-AGENT-CNTL-OPT.
  3393             20  CF-AGENT-OPT-SEQ           PIC 9.
  3394                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3395                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3396             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3397                                            PIC X(10).
  3398
  3399         16  FILLER                         PIC X(43).
  3400
  3401         16  CF-LOSS-RATIO-SELECT.
  3402             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3403             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3404         16  CF-ENTRY-DATE-SELECT.
  3405             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3406             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3407         16  CF-EFFECTIVE-DATE-SELECT.
  3408             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3409             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3410
  3411         16  CF-EXCEPTION-LIST-IND          PIC X.
  3412             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3413
  3414         16  FILLER                         PIC X(318).
  3415
  3416****************************************************************
  3417*                  EXCEPTION REPORTING RECORD                  *
  3418****************************************************************
  3419
  3420     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3421         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3422             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3423
  3424         16  CF-COMBINED-LIFE-AH-OPT.
  3425             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3426             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3427             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3428             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3429
  3430         16  CF-LIFE-OPT.
  3431             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3432             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3433             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3434             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3435             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  61
* NSRLTRBL.cbl
  3436             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3437             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3438             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3439             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3440             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3441
  3442         16  CF-AH-OPT.
  3443             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3444             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3445             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3446             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3447             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3448             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3449             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3450             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3451             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3452             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3453
  3454         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3455             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3456             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3457             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3458
  3459         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3460
  3461         16  FILLER                         PIC X(673).
  3462
  3463
  3464****************************************************************
  3465*             MORTGAGE SYSTEM PLAN RECORD                      *
  3466****************************************************************
  3467
  3468     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3469         16  CF-PLAN-TYPE                   PIC X.
  3470             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3471             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3472             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3473         16  CF-PLAN-ABBREV                 PIC XXX.
  3474         16  CF-PLAN-DESCRIPT               PIC X(10).
  3475         16  CF-PLAN-NOTES                  PIC X(20).
  3476         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3477         16  CF-PLAN-UNDERWRITING.
  3478             20  CF-PLAN-TERM-DATA.
  3479                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3480                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3481             20  CF-PLAN-AGE-DATA.
  3482                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3483                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3484                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3485             20  CF-PLAN-BENEFIT-DATA.
  3486                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3487                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3488                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3489                                            PIC S9(7)V99  COMP-3.
  3490         16  CF-PLAN-POLICY-FORMS.
  3491             20  CF-POLICY-FORM             PIC X(12).
  3492             20  CF-MASTER-APPLICATION      PIC X(12).
  3493             20  CF-MASTER-POLICY           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  62
* NSRLTRBL.cbl
  3494         16  CF-PLAN-RATING.
  3495             20  CF-RATE-CODE               PIC X(5).
  3496             20  CF-SEX-RATING              PIC X.
  3497                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3498                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3499             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3500             20  CF-SUB-STD-TYPE            PIC X.
  3501                 88  CF-PCT-OF-PREM            VALUE '1'.
  3502                 88  CF-PCT-OF-BENE            VALUE '2'.
  3503         16  CF-PLAN-PREM-TOLERANCES.
  3504             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3505             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3506         16  CF-PLAN-PYMT-TOLERANCES.
  3507             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3508             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3509         16  CF-PLAN-MISC-DATA.
  3510             20  FILLER                     PIC X.
  3511             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3512             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3513         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3514         16  CF-PLAN-IND-GRP                PIC X.
  3515             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3516                                                     '1'.
  3517             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3518                                                     '2'.
  3519         16  CF-MIB-SEARCH-SW               PIC X.
  3520             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3521             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3522             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3523             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3524         16  CF-ALPHA-SEARCH-SW             PIC X.
  3525             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3526             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3527             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3528             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3529             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3530             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3531             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3532             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3533             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3534             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3535                                                     'A' 'B' 'C'
  3536                                                     'X' 'Y' 'Z'.
  3537         16  CF-EFF-DT-RULE-SW              PIC X.
  3538             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3539             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3540             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3541             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3542             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3543         16  FILLER                         PIC X(4).
  3544         16  CF-HEALTH-QUESTIONS            PIC X.
  3545             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3546         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3547         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3548         16  CF-PLAN-SNGL-JNT               PIC X.
  3549             88  CF-COMBINED-PLAN              VALUE 'C'.
  3550             88  CF-JNT-PLAN                   VALUE 'J'.
  3551             88  CF-SNGL-PLAN                  VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  63
* NSRLTRBL.cbl
  3552         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3553         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3554         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3555         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3556         16  CF-RERATE-CNTL                 PIC  X.
  3557             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3558             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3559             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3560             88  CF-AUTO-RECALC                 VALUE '4'.
  3561         16  CF-BENEFIT-TYPE                PIC  X.
  3562             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3563             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3564         16  CF-POLICY-FEE                  PIC S999V99
  3565                                                    COMP-3.
  3566         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3567         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3568         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3569         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3570         16  FILLER                         PIC  X(32).
  3571         16  CF-TERMINATION-FORM            PIC  X(04).
  3572         16  FILLER                         PIC  X(08).
  3573         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3574                                                       COMP-3.
  3575         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3576         16  CF-ISSUE-LETTER                PIC  X(4).
  3577         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3578         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3579             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3580             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3581         16  CF-MP-REFUND-CALC              PIC X.
  3582             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3583             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3584             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3585             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3586             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3587             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3588             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3589             88  CF-MP-REFD-MEAN                VALUE '8'.
  3590         16  CF-ALT-RATE-CODE               PIC  X(5).
  3591
  3592
  3593         16  FILLER                         PIC X(498).
  3594****************************************************************
  3595*             MORTGAGE COMPANY MASTER RECORD                   *
  3596****************************************************************
  3597
  3598     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3599         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3600         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3601             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3602             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3603             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3604             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3605             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3606
  3607         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3608         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3609         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  64
* NSRLTRBL.cbl
  3610         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3611         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3612
  3613         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3614             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3615         16  CF-MP-RECON-USE-IND            PIC X(1).
  3616             88  CF-MP-USE-RECON             VALUE 'Y'.
  3617         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3618             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3619         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3620             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3621             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3622         16  FILLER                         PIC X(1).
  3623         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3624             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3625         16  CF-MORTG-MIB-VERSION           PIC X.
  3626             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3627             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3628             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3629         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3630             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3631                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3632             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3633                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3634             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3635                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3636             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3637                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3638             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3639                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3640             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3641                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3642         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3643         16  FILLER                         PIC X(7).
  3644         16  CF-MORTG-DESTINATION-SYMBOL.
  3645             20  CF-MORTG-MIB-COMM          PIC X(5).
  3646             20  CF-MORTG-MIB-TERM          PIC X(5).
  3647         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3648             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3649         16  FILLER                         PIC X(03).
  3650         16  CF-MP-CHECK-NO-CONTROL.
  3651             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3652                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3653                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3654                                                ' ' LOW-VALUES.
  3655                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3656                                               VALUE '3'.
  3657         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3658         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3659         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3660             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3661                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3662             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3663                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3664             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3665                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3666             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3667                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  65
* NSRLTRBL.cbl
  3668             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3669                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3670             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3671                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3672         16  CF-MORTG-BILLING-AREA.
  3673             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3674                                            PIC X.
  3675         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3676         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3677         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3678         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3679             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3680             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3681         16  FILLER                         PIC X.
  3682         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3683             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3684             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3685         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3686         16  FILLER                         PIC X(8).
  3687         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3688         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3689         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3690         16  CF-ACH-COMPANY-ID.
  3691             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3692                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3693                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3694                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3695             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3696         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3697             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3698         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3699             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3700             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3701         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3702         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3703         16  FILLER                         PIC X(536).
  3704
  3705****************************************************************
  3706*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3707****************************************************************
  3708
  3709     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3710         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3711             20  CF-FEMALE-HEIGHT.
  3712                 24  CF-FEMALE-FT           PIC 99.
  3713                 24  CF-FEMALE-IN           PIC 99.
  3714             20  CF-FEMALE-MIN-WT           PIC 999.
  3715             20  CF-FEMALE-MAX-WT           PIC 999.
  3716         16  FILLER                         PIC X(428).
  3717
  3718     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3719         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3720             20  CF-MALE-HEIGHT.
  3721                 24  CF-MALE-FT             PIC 99.
  3722                 24  CF-MALE-IN             PIC 99.
  3723             20  CF-MALE-MIN-WT             PIC 999.
  3724             20  CF-MALE-MAX-WT             PIC 999.
  3725         16  FILLER                         PIC X(428).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  66
* NSRLTRBL.cbl
  3726******************************************************************
  3727*             AUTOMATIC ACTIVITY RECORD                          *
  3728******************************************************************
  3729     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3730         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3731             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3732             20  CF-SYS-LETTER-ID           PIC X(04).
  3733             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3734             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3735             20  CF-SYS-RESET-SW            PIC X(01).
  3736             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3737             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3738
  3739         16  FILLER                         PIC X(50).
  3740
  3741         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3742             20  CF-USER-ACTIVE-SW          PIC X(01).
  3743             20  CF-USER-LETTER-ID          PIC X(04).
  3744             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3745             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3746             20  CF-USER-RESET-SW           PIC X(01).
  3747             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3748             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3749             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3750
  3751         16  FILLER                         PIC X(246).
  3752*                                COPY NSCVARS.
  3753******************************************************************
  3754*                   C H A N G E   L O G
  3755*
  3756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3757*-----------------------------------------------------------------
  3758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3759* EFFECTIVE    NUMBER
  3760*-----------------------------------------------------------------
  3761* 031912    2011110200002  AJRA  AHL CLAIM NUM
  3762* 013013    2012110080002  AJRA  ADD ACCOUNT GPCD
  3763* 031116    2015110400001  TANA  ADD EL150D FIELDS
  3764* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  3765******************************************************************
  3766 01 NAPER-OUTPUT-DATA.
  3767    05 FILLER              PIC X(6) VALUE "TEMPL=".
  3768    05 OUT-TEMP            PIC X(4).
  3769    05 FILLER              PIC X(8) VALUE "&LETTER=".
  3770    05 OUT-LETTER          PIC X(4).
  3771    05 FILLER              PIC X(6) VALUE "&CARR=".
  3772    05 OUT-CARR            PIC X.
  3773    05 FILLER              PIC X(7) VALUE "&CLMNO=".
  3774    05 OUT-CLMNO           PIC X(7).
  3775    05 FILLER              PIC X(7) VALUE "&CRTNO=".
  3776    05 OUT-CRTNO           PIC X(11).
  3777    05 FILLER              PIC X(7) VALUE "&ACTNO=".
  3778    05 OUT-ACTNO           PIC X(10).
  3779    05 FILLER              PIC X(8) VALUE "&ILNAME=".
  3780    05 OUT-ILNAME          PIC X(15).
  3781    05 FILLER              PIC X(8) VALUE "&IFNAME=".
  3782    05 OUT-IFNAME          PIC X(10).
  3783    05 FILLER              PIC X(7) VALUE "&SEXCD=".
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  67
* NSRLTRBL.cbl
  3784    05 OUT-SEX-CD          PIC X.
  3785    05 FILLER              PIC X(5) VALUE "&SSN=".
  3786    05 OUT-SSN             PIC X(11).
  3787    05 FILLER              PIC X(9) VALUE "&CLMSTAT=".
  3788    05 OUT-CLMSTAT         PIC X.
  3789    05 FILLER              PIC X(8) VALUE "&CLMTYP=".
  3790    05 OUT-CLMTYPE         PIC X.
  3791    05 FILLER              PIC X(7) VALUE "&ESTDT=".
  3792    05 OUT-EST-DT          PIC X(21).
  3793    05 FILLER              PIC X(7) VALUE "&INCDT=".
  3794    05 OUT-INC-DT          PIC X(21).
  3795    05 FILLER              PIC X(7) VALUE "&RPTDT=".
  3796    05 OUT-RPT-DT          PIC X(21).
  3797    05 FILLER              PIC X(10) VALUE "&PDTHRUDT=".
  3798    05 OUT-PD-THRU-DT      PIC X(21).
  3799    05 FILLER              PIC X(11) VALUE "&FORMDUEDT=".
  3800    05 OUT-FORM-DUE-DT     PIC X(21).
  3801    05 FILLER              PIC X(8) VALUE "&LPMTDT=".
  3802    05 OUT-LST-PMT-DT      PIC X(21).
  3803    05 FILLER              PIC X(8) VALUE "&NOPMTS=".
  3804    05 OUT-NO-OF-PMTS      PIC X(10).
  3805    05 FILLER              PIC X(9) VALUE "&TOTPAID=".
  3806    05 OUT-TOT-PAID        PIC 9999999.99.
  3807    05 FILLER              PIC X(8) VALUE "&LPDAMT=".
  3808    05 OUT-LST-PD-AMT      PIC 9999999.99.
  3809    05 FILLER              PIC X(9) VALUE "&ADDRCNT=".
  3810    05 OUT-ADDR-CNT        PIC 9.
  3811    05 FILLER              PIC X(7) VALUE "&CRTST=".
  3812    05 OUT-CRT-ST          PIC XX.
  3813    05 FILLER              PIC X(10) VALUE "&CERTACCT=".
  3814    05 OUT-CERTACCT        PIC X(10).
  3815    05 FILLER              PIC X(7) VALUE "&EFFDT=".
  3816    05 OUT-EFF-DT          PIC X(21).
  3817    05 FILLER              PIC X(8) VALUE "&LMNTDT=".
  3818    05 OUT-LST-MAINT-DT    PIC X(21).
  3819    05 FILLER              PIC X(10) VALUE "&LMNTUSER=".
  3820    05 OUT-LST-MAINT-USER  PIC X(10).
  3821    05 FILLER              PIC X(10) VALUE "&LMNTTYPE=".
  3822    05 OUT-LST-MAINT-TYPE  PIC X(10).
  3823    05 FILLER              PIC X(6) VALUE "&DIAG=".
  3824    05 OUT-DIAG            PIC X(66).
  3825    05 FILLER              PIC X(7) VALUE "&EXPDT=".
  3826    05 OUT-EXP-DT          PIC X(21).
  3827    05 FILLER              PIC X(12) VALUE "&LCLSREASON=".
  3828    05 OUT-LST-CLS-REA     PIC X(10).
  3829    05 FILLER              PIC X(8) VALUE "&BRTHDT=".
  3830    05 OUT-BIRTH-DT        PIC X(21).
  3831    05 FILLER              PIC X(6) VALUE "&TERM=".
  3832    05 OUT-TERM            PIC 999.
  3833    05 FILLER              PIC X(7) VALUE "&BENCD=".
  3834    05 OUT-BEN-CD          PIC XX.
  3835    05 FILLER              PIC X(8) VALUE "&BENAMT=".
  3836    05 OUT-BENAMT          PIC 9999999.99.
  3837    05 FILLER              PIC X(9) VALUE "&CRITPER=".
  3838    05 OUT-CRIT-PER        PIC 999.
  3839    05 FILLER              PIC X(9) VALUE "&WAITPER=".
  3840    05 OUT-WAIT-PER        PIC XX.
  3841    05 FILLER              PIC X(11)  VALUE "&LFINTRATE=".
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  68
* NSRLTRBL.cbl
  3842    05 OUT-LF-INT-RATE     PIC 99.99999.
  3843    05 FILLER              PIC X(10) VALUE "&AUTOPYDT=".
  3844    05 OUT-AUTO-PY-DT      PIC X(21).
  3845    05 FILLER              PIC X(12) VALUE "&AUTOSCHEND=".
  3846    05 OUT-AUTO-SCHD-END   PIC X(21).
  3847    05 FILLER              PIC X(8) VALUE "&LOANNO=".
  3848    05 OUT-LOAN-NO         PIC X(25).
  3849    05 FILLER              PIC X(5) VALUE "&APR=".
  3850    05 OUT-APR             PIC 99.99999.
  3851    05 FILLER              PIC X(8) VALUE "&LACTDT=".
  3852    05 OUT-LST-ACT-DT      PIC X(21).
  3853    05 FILLER              PIC X(7) VALUE "&ACTDT=".
  3854    05 OUT-ACT-DT          PIC X(21).
  3855    05 FILLER              PIC X(10) VALUE "&LACTTYPE=".
  3856    05 OUT-LST-ACT-TYPE    PIC X(15).
  3857    05 FILLER              PIC X(9) VALUE "&ACTTYPE=".
  3858    05 OUT-ACT-TYPE        PIC X(15).
  3859    05 FILLER              PIC X(6) VALUE "&FORM=".
  3860    05 OUT-FORM            PIC X(4).
  3861    05 FILLER              PIC X(9) VALUE "&INSNAME=".
  3862    05 OUT-INS-NAME        PIC X(36).
  3863    05 FILLER              PIC X(10) VALUE "&INSADDR1=".
  3864    05 OUT-INS-ADDR1       PIC X(36).
  3865    05 FILLER              PIC X(10) VALUE "&INSADDR2=".
  3866    05 OUT-INS-ADDR2       PIC X(36).
  3867    05 FILLER              PIC X(9) VALUE "&INSCITY=".
  3868    05 OUT-INS-CITY        PIC X(28).
  3869    05 FILLER              PIC X(10) VALUE "&INSSTATE=".
  3870    05 OUT-INS-STATE       PIC XX.
  3871    05 FILLER              PIC X(8) VALUE "&INSZIP=".
  3872    05 OUT-INS-ZIP         PIC X(10).
  3873    05 FILLER              PIC X(10) VALUE "&INSPHONE=".
  3874    05 OUT-INS-PHONE       PIC X(13).
  3875    05 FILLER              PIC X(10) VALUE "&BENENAME=".
  3876    05 OUT-BEN-NAME        PIC X(32).
  3877    05 FILLER              PIC X(11) VALUE "&BENEADDR1=".
  3878    05 OUT-BEN-ADDR1       PIC X(36).
  3879    05 FILLER              PIC X(11) VALUE "&BENEADDR2=".
  3880    05 OUT-BEN-ADDR2       PIC X(32).
  3881    05 FILLER              PIC X(10) VALUE "&BENECITY=".
  3882    05 OUT-BEN-CITY        PIC X(28).
  3883    05 FILLER              PIC X(11) VALUE "&BENESTATE=".
  3884    05 OUT-BEN-STATE       PIC XX.
  3885    05 FILLER              PIC X(9) VALUE "&BENEZIP=".
  3886    05 OUT-BEN-ZIP         PIC X(10).
  3887    05 FILLER              PIC X(11) VALUE "&BENEPHONE=".
  3888    05 OUT-BEN-PHONE       PIC X(13).
  3889    05 FILLER              PIC X(8) VALUE "&OANAME=".
  3890    05 OUT-ORIG-NAME       PIC X(32).
  3891    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
  3892    05 OUT-ACCT-NAME       PIC X(32).
  3893    05 FILLER              PIC X(11) VALUE "&ACCTADDR1=".
  3894    05 OUT-ACCT-ADDR1      PIC X(36).
  3895    05 FILLER              PIC X(11) VALUE "&ACCTADDR2=".
  3896    05 OUT-ACCT-ADDR2      PIC X(32).
  3897    05 FILLER              PIC X(10) VALUE "&ACCTCITY=".
  3898    05 OUT-ACCT-CITY       PIC X(30).
  3899    05 FILLER              PIC X(11) VALUE "&ACCTSTATE=".
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  69
* NSRLTRBL.cbl
  3900    05 OUT-ACCT-STATE      PIC XX.
  3901    05 FILLER              PIC X(9)  VALUE "&ACCTZIP=".
  3902    05 OUT-ACCT-ZIP        PIC X(10).
  3903    05 FILLER              PIC X(11) VALUE "&ACCTPHONE=".
  3904    05 OUT-ACCT-PHONE      PIC X(13).
  3905    05 FILLER              PIC X(7) VALUE "&ENCCD=".
  3906    05 OUT-ENC-CODE        PIC XXX.
  3907    05 FILLER              PIC X(7) VALUE "&ENCST=".
  3908    05 OUT-ENC-ST          PIC XX.
  3909    05 FILLER              PIC X(8) VALUE "&ARCHNO=".
  3910    05 OUT-ARCHNO          PIC 999999999.
  3911    05 FILLER              PIC X(11) VALUE "&FLTRPRTDT=".
  3912    05 OUT-1ST-LTR-PRT-DT  PIC X(21).
  3913    05 FILLER              PIC X(11) VALUE "&NEXTDUEDT=".
  3914    05 OUT-NEXT-DUE-DT     PIC X(21).
  3915    05 FILLER              PIC X(8) VALUE "&JLNAME=".
  3916    05 OUT-JLNAME          PIC X(15).
  3917    05 FILLER              PIC X(8) VALUE "&JFNAME=".
  3918    05 OUT-JFNAME          PIC X(10).
  3919    05 FILLER              PIC X(9)  VALUE "&ENCLINE=".
  3920    05 OUT-ENCLINE         PIC X(100).
  3921    05 FILLER              PIC X(9) VALUE "&ENCATTS=".
  3922    05 OUT-ENCATTS         PIC X(255).
  3923    05 FILLER              PIC X(10) VALUE "&OUTSTACK=".
  3924    05 OUT-OUTSTACK        PIC X.
  3925    05 FILLER              PIC X(8) VALUE "&PROCID=".
  3926    05 OUT-PROCID          PIC XXXX.
  3927    05 FILLER              PIC X(8) VALUE "&COMPID=".
  3928    05 OUT-COMPID          PIC XXX.
  3929    05 FILLER              PIC X(8) VALUE "&PRTNOW=".
  3930    05 OUT-PRINT-NOW-SW    PIC X.
  3931    05 FILLER              PIC X(11) VALUE "&CYCLEDATE=".
  3932    05 OUT-CYCLE-DATE      PIC X(8).
  3933    05 FILLER              PIC X(11) VALUE "&ENCSTNAME=".
  3934    05 OUT-ENC-ST-NAME     PIC XX.
  3935    05 FILLER              PIC X(10) VALUE "&CARRIDLU=".
  3936    05 OUT-CARR-LU         PIC X.
  3937    05 FILLER              PIC X(5)  VALUE "&CCN=".
  3938    05 OUT-AHL-CLAIM-NO    PIC X(9).
  3939    05 FILLER              PIC X(4) VALUE "&GP=".
  3940    05 OUT-ACCT-GPCD       PIC 99.
  3941    05 FILLER              PIC X(9) VALUE "&MAXBENS=".
  3942    05 OUT-MAX-BENS        PIC 9(3).
  3943    05 FILLER              PIC X(10) VALUE "&PAIDBENS=".
  3944    05 OUT-PAID-BENS       PIC 9(3).
  3945    05 FILLER              PIC X(9) VALUE "&REMBENS=".
  3946    05 OUT-REM-BENS        PIC 9(3).
  3947    05 FILLER              PIC X(9) VALUE "&EXCLPER=".
  3948    05 OUT-EXCL-PER        PIC 9(3).
  3949    05 FILLER              PIC X(8) VALUE "&RECMOS=".
  3950    05 OUT-REC-MOS         PIC 9(2).
  3951    05 FILLER              PIC X(8) VALUE "&INSTYP=".
  3952    05 OUT-INS-TYP         PIC X(4).
  3953    05 FILLER              PIC X(8) VALUE "&BENPER=".
  3954    05 OUT-BEN-PER         PIC 9(2).
  3955    05 FILLER              PIC X(7) VALUE "&ACCSW=".
  3956    05 OUT-ACC-SW          PIC X.
  3957 01  FILLER                      PIC X(500)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  70
* NSRLTRBL.cbl
  3958*                                COPY ELCNAPS.
  3959******************************************************************
  3960*                                                                *
  3961*                            ELCNAPS                             *
  3962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3963*                            VMOD=2.003                          *
  3964*                                                                *
  3965*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  3966*                                                                *
  3967*        FILE TYPE= VSAM,KSDS                                    *
  3968*        RECORD SIZE = 150    RECFORM = FIXED                    *
  3969*                                                                *
  3970*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  3971*                                                                *
  3972*        LOG = YES                                               *
  3973*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3974*                                                                *
  3975******************************************************************
  3976*                   C H A N G E   L O G
  3977*
  3978* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3979*-----------------------------------------------------------------
  3980*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3981* EFFECTIVE    NUMBER
  3982*-----------------------------------------------------------------
  3983* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  3984******************************************************************
  3985
  3986 01  NAPERSOFT-FILE.
  3987     12  NA-RECORD-ID                PIC  XX.
  3988         88  VALID-NA-ID                  VALUE 'NA'.
  3989
  3990     12  NA-CONTROL-PRIMARY.
  3991         16  NA-COMPANY-CD           PIC X.
  3992         16  NA-CARRIER              PIC X.
  3993         16  NA-CLAIM-NO             PIC X(7).
  3994         16  NA-CERT-NO.
  3995             20  NA-CERT-PRIME       PIC X(10).
  3996             20  NA-CERT-SFX         PIC X.
  3997         16  NA-ARCHIVE-NO           PIC 9(8).
  3998
  3999     12  NA-LETTER-INFORMATION.
  4000         16  NA-LETTER-ID            PIC X(4).
  4001         16  NA-PROCESSOR-ID         PIC X(4).
  4002         16  NA-CREATION-DT          PIC X(2).
  4003         16  NA-INITIAL-PRINT-DT     PIC X(2).
  4004         16  NA-FOLLOW-UP-DT         PIC X(2).
  4005         16  NA-RESEND-DT            PIC X(2).
  4006         16  NA-RESEND-LETTER-ID     PIC X(4).
  4007         16  NA-NO-OF-COPIES         PIC 9(2).
  4008         16  NA-ADDRESS-TYPE         PIC X(2).
  4009         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  4010         16  NA-RESEND-PRINT-DT      PIC X(2).
  4011         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  4012         16  NA-NEXT-DUE-DT          PIC X(2).
  4013         16  NA-AUTOPYDT             PIC X(2).
  4014         16  NA-ENCLOSURE-CD         PIC X(3).
  4015         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  71
* NSRLTRBL.cbl
  4016         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  4017         16  NA-RESEND-PROMPT-IND    PIC X(1).
  4018         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  4019         16  FILLER                  PIC X(67).
  4020******************************************************************
  4021*                                COPY ELCENCC.
  4022******************************************************************
  4023*                                                                *
  4024*                                                                *
  4025*                            ELCENCC                             *
  4026*                            VMOD=2.001                          *
  4027*                                                                *
  4028*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  4029*                                                                *
  4030*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  4031*   A NAPERSOFT DOCUMENT                                         *
  4032*                                                                *
  4033*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  4034*                                                                *
  4035*   FILE TYPE = VSAM,KSDS                                        *
  4036*   RECORD SIZE = 400   RECFORM = FIX                            *
  4037*                                                                *
  4038*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  4039*                                                                *
  4040*   LOG = NO                                                     *
  4041*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4042*                                                                *
  4043*                                                                *
  4044******************************************************************
  4045*                   C H A N G E   L O G
  4046*
  4047* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4048*-----------------------------------------------------------------
  4049*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4050* EFFECTIVE    NUMBER
  4051*-----------------------------------------------------------------
  4052* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  4053* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  4054******************************************************************
  4055 01  ENCLOSURE-CODES.
  4056     12  NC-RECORD-ID                      PIC XX.
  4057         88  VALID-NC-ID                      VALUE 'NC'.
  4058     12  NC-CONTROL-PRIMARY.
  4059         16  NC-COMPANY-CD                 PIC X.
  4060         16  NC-REC-TYPE                   PIC X.
  4061             88  NC-CLAIMS                   VALUE '1'.
  4062             88  NC-ADMIN                    VALUE '2'.
  4063         16  NC-ENC-CODE                   PIC X(5).
  4064         16  FILLER                        PIC X(09).
  4065     12  NC-MAINT-INFORMATION.
  4066         16  NC-LAST-MAINT-DT              PIC XX.
  4067         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4068         16  NC-LAST-MAINT-USER            PIC X(4).
  4069         16  FILLER                        PIC XX.
  4070     12  NC-OUTPUT-STACK                   PIC XXX.
  4071     12  NC-ENCLOSURE-LINE                 PIC X(100).
  4072     12  NC-ATTACHMENTS                    PIC X(255).
  4073     12  NC-FUTURE                         PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  72
* NSRLTRBL.cbl
  4074******************************************************************
  4075*                                COPY ELCCRTT.
  4076******************************************************************
  4077*                                                                *
  4078*                            ELCCRTT.                            *
  4079*                                                                *
  4080*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  4081*                                                                *
  4082*   FILE TYPE = VSAM,KSDS                                        *
  4083*   RECORD SIZE = 552  RECFORM = FIXED                           *
  4084*                                                                *
  4085*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  4086*                                                                *
  4087*   LOG = YES                                                    *
  4088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4089******************************************************************
  4090*                   C H A N G E   L O G
  4091*
  4092* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4093*-----------------------------------------------------------------
  4094*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4095* EFFECTIVE    NUMBER
  4096*-----------------------------------------------------------------
  4097* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4098* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  4099* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  4100* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4101* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4102* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4103* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4104* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  4105* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  4106******************************************************************
  4107
  4108 01  CERTIFICATE-TRAILERS.
  4109     12  CS-RECORD-ID                      PIC XX.
  4110         88  VALID-CS-ID                      VALUE 'CS'.
  4111
  4112     12  CS-CONTROL-PRIMARY.
  4113         16  CS-COMPANY-CD                 PIC X.
  4114         16  CS-CARRIER                    PIC X.
  4115         16  CS-GROUPING                   PIC X(6).
  4116         16  CS-STATE                      PIC XX.
  4117         16  CS-ACCOUNT                    PIC X(10).
  4118         16  CS-CERT-EFF-DT                PIC XX.
  4119         16  CS-CERT-NO.
  4120             20  CS-CERT-PRIME             PIC X(10).
  4121             20  CS-CERT-SFX               PIC X.
  4122         16  CS-TRAILER-TYPE               PIC X.
  4123             88  COMM-TRLR           VALUE 'A'.
  4124             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  4125             88  CERT-DATA-TRLR      VALUE 'C'.
  4126
  4127     12  CS-DATA-AREA                      PIC X(516).
  4128
  4129     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4130         16  CS-BANK-COMMISSION-AREA.
  4131             20  CS-BANK-COMMS       OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  73
* NSRLTRBL.cbl
  4132                 24  CS-AGT                PIC X(10).
  4133                 24  CS-COM-TYP            PIC X.
  4134                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4135                 24  CS-RECALC-LV-INDIC    PIC X.
  4136                 24  FILLER                PIC X(10).
  4137         16  FILLER                        PIC X(256).
  4138
  4139     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  4140****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  4141         16  CS-MB-CLAIM-DATA OCCURS 24.
  4142             20  CS-CLAIM-NO               PIC X(7).
  4143             20  CS-CLAIM-TYPE             PIC X.
  4144                 88  CS-AH-CLM               VALUE 'A'.
  4145                 88  CS-IU-CLM               VALUE 'I'.
  4146                 88  CS-GP-CLM               VALUE 'G'.
  4147                 88  CS-LF-CLM               VALUE 'L'.
  4148                 88  CS-PR-CLM               VALUE 'P'.
  4149                 88  CS-FL-CLM               VALUE 'F'.
  4150             20  CS-INSURED-TYPE           PIC X.
  4151                 88  CS-PRIM-INSURED          VALUE 'P'.
  4152                 88  CS-CO-BORROWER           VALUE 'C'.
  4153             20  CS-BENEFIT-PERIOD         PIC 99.
  4154             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  4155             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  4156             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  4157         16  FILLER                        PIC X(12).
  4158     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4159         16  CS-VIN-NUMBER                 PIC X(17).
  4160         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  4161         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  4162         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  4163         16  cs-agent-name.
  4164             20  cs-agent-fname            pic x(20).
  4165             20  cs-agent-mi               pic x.
  4166             20  cs-agent-lname            pic x(25).
  4167         16  cs-license-no                 pic x(15).
  4168         16  cs-npn-number                 pic x(10).
  4169         16  cs-agent-edit-status          pic x.
  4170             88  cs-ae-refer-to-manager      value 'M'.
  4171             88  cs-ae-cover-sheet           value 'C'.
  4172             88  cs-ae-sig-form              value 'S'.
  4173             88  cs-ae-verified              value 'V'.
  4174             88  cs-unidentified-signature   value 'U'.
  4175             88  cs-cert-returned            value 'R'.
  4176             88  cs-accept-no-commission     value 'N'.
  4177         16  cs-year                       pic 9999.
  4178         16  cs-make                       pic x(20).
  4179         16  cs-model                      pic x(20).
  4180         16  cs-future                     pic x(20).
  4181         16  cs-vehicle-odometer           pic s9(7) comp-3.
  4182         16  FILLER                        PIC X(356). *> was 420
  4183*        16  FILLER                        PIC X(496).
  4184*                                COPY ERCPDEF.
  4185******************************************************************
  4186*                                                                *
  4187*                                                                *
  4188*                            ERCPDEF.                            *
  4189*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  74
* NSRLTRBL.cbl
  4190*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  4191*                                                                *
  4192*    FILE TYPE = VSAM,KSDS                                       *
  4193*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  4194*                                                                *
  4195*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  4196*                                                                *
  4197*    LOG = YES                                                   *
  4198*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4199******************************************************************
  4200*                   C H A N G E   L O G
  4201*
  4202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4203*-----------------------------------------------------------------
  4204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4205* EFFECTIVE    NUMBER
  4206*-----------------------------------------------------------------
  4207* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4208* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4209* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  4210******************************************************************
  4211 01  PRODUCT-MASTER.
  4212    12  PD-RECORD-ID                 PIC X(02).
  4213        88  VALID-PD-ID                  VALUE 'PD'.
  4214    12  PD-CONTROL-PRIMARY.
  4215        16  PD-COMPANY-CD            PIC X.
  4216        16  PD-STATE                 PIC XX.
  4217        16  PD-PRODUCT-CD            PIC XXX.
  4218        16  PD-FILLER                PIC X(7).
  4219        16  PD-BEN-TYPE              PIC X.
  4220        16  PD-BEN-CODE              PIC XX.
  4221        16  PD-PROD-EXP-DT           PIC XX.
  4222    12  FILLER                       PIC X(50).
  4223    12  PD-PRODUCT-DATA OCCURS 8.
  4224        16  PD-PROD-CODE             PIC X.
  4225            88  PD-PROD-LIFE           VALUE 'L'.
  4226            88  PD-PROD-PROP           VALUE 'P'.
  4227            88  PD-PROD-AH             VALUE 'A'.
  4228            88  PD-PROD-IU             VALUE 'I'.
  4229            88  PD-PROD-GAP            VALUE 'G'.
  4230            88  PD-PROD-FAML           VALUE 'F'.
  4231        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  4232        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  4233        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  4234        16  PD-MAX-TERM              PIC S999        COMP-3.
  4235        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  4236        16  FILLER                   PIC X.
  4237        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  4238        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  4239        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  4240        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  4241        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  4242        16  PD-REC-CRIT-PERIOD       PIC 99.
  4243        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  4244            20  PD-RECURRING-YN      PIC X.
  4245            20  FILLER               PIC X.
  4246        16  PD-RTW-MOS               PIC 99.
  4247        16  PD-MAX-EXTENSION         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  75
* NSRLTRBL.cbl
  4248        16  pd-ben-pct               pic sv999 comp-3.
  4249*       16  FILLER                   PIC XX.
  4250    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  4251    12  PD-TERM-LIMITS OCCURS 15.
  4252        16  PD-LOW-TERM              PIC S999        COMP-3.
  4253        16  PD-HI-TERM               PIC S999        COMP-3.
  4254*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  4255    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  4256        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  4257        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  4258    12  PD-EARN-FACTORS.
  4259        16  FILLER OCCURS 15.
  4260            20  FILLER OCCURS 15.
  4261                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  4262    12  PD-PRODUCT-DESC              PIC X(80).
  4263    12  PD-TRUNCATED                 PIC X.
  4264    12  FILLER                       PIC X(59).
  4265    12  PD-MAINT-INFORMATION.
  4266        16  PD-LAST-MAINT-DT         PIC X(02).
  4267        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4268        16  PD-LAST-MAINT-BY         PIC X(04).
  4269****************************************************************
  4270*
  4271* Copyright (c) 2007-2013 Dell Inc.
  4272* All rights reserved.
  4273*
  4274****************************************************************
  4275 01  DFHEIV.
  4276   02  DFHEIV0               PIC X(35).
  4277   02  DFHEIV1               PIC X(08).
  4278   02  DFHEIV2               PIC X(08).
  4279   02  DFHEIV3               PIC X(08).
  4280   02  DFHEIV4               PIC X(06).
  4281   02  DFHEIV5               PIC X(04).
  4282   02  DFHEIV6               PIC X(04).
  4283   02  DFHEIV7               PIC X(02).
  4284   02  DFHEIV8               PIC X(02).
  4285   02  DFHEIV9               PIC X(01).
  4286   02  DFHEIV10              PIC S9(7) COMP-3.
  4287   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4288   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4289   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4290   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4291   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4292   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4293   02  DFHEIV17              PIC X(04).
  4294   02  DFHEIV18              PIC X(04).
  4295   02  DFHEIV19              PIC X(04).
  4296   02  DFHEIV20              USAGE IS POINTER.
  4297   02  DFHEIV21              USAGE IS POINTER.
  4298   02  DFHEIV22              USAGE IS POINTER.
  4299   02  DFHEIV23              USAGE IS POINTER.
  4300   02  DFHEIV24              USAGE IS POINTER.
  4301   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4302   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4303   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4304   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4305   02  DFHEIV29              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  76
* NSRLTRBL.cbl
  4306   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4307   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4308   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4309   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4310   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4311   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4312   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4313   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4314   02  FILLER                PIC X(02).
  4315   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4316   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4317   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4318   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4319   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4320   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4321   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4322 LINKAGE  SECTION.
  4323*****************************************************************
  4324*                                                               *
  4325* Copyright (c) 2007-2013 Dell Inc.                             *
  4326* All rights reserved.                                          *
  4327*                                                               *
  4328*****************************************************************
  4329 01  dfheiblk.
  4330     02  eibtime          pic s9(7) comp-3.
  4331     02  eibdate          pic s9(7) comp-3.
  4332     02  eibtrnid         pic x(4).
  4333     02  eibtaskn         pic s9(7) comp-3.
  4334     02  eibtrmid         pic x(4).
  4335     02  dfheigdi         pic s9(4) comp.
  4336     02  eibcposn         pic s9(4) comp.
  4337     02  eibcalen         pic s9(4) comp.
  4338     02  eibaid           pic x(1).
  4339     02  eibfiller1       pic x(1).
  4340     02  eibfn            pic x(2).
  4341     02  eibfiller2       pic x(2).
  4342     02  eibrcode         pic x(6).
  4343     02  eibfiller3       pic x(2).
  4344     02  eibds            pic x(8).
  4345     02  eibreqid         pic x(8).
  4346     02  eibrsrce         pic x(8).
  4347     02  eibsync          pic x(1).
  4348     02  eibfree          pic x(1).
  4349     02  eibrecv          pic x(1).
  4350     02  eibsend          pic x(1).
  4351     02  eibatt           pic x(1).
  4352     02  eibeoc           pic x(1).
  4353     02  eibfmh           pic x(1).
  4354     02  eibcompl         pic x(1).
  4355     02  eibsig           pic x(1).
  4356     02  eibconf          pic x(1).
  4357     02  eiberr           pic x(1).
  4358     02  eibrldbk         pic x(1).
  4359     02  eiberrcd         pic x(4).
  4360     02  eibsynrb         pic x(1).
  4361     02  eibnodat         pic x(1).
  4362     02  eibfiller5       pic x(2).
  4363     02  eibresp          pic s9(8) comp.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  77
* NSRLTRBL.cbl
  4364     02  eibresp2         pic s9(8) comp.
  4365     02  dfheigdj         pic s9(4) comp.
  4366     02  dfheigdk         pic s9(4) comp.
  4367 01 dfhcommarea.
  4368*                                copy ELCLTRSPI.
  4369******************************************************************
  4370*                   C H A N G E   L O G
  4371*
  4372* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4373*-----------------------------------------------------------------
  4374*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4375* EFFECTIVE    NUMBER
  4376*-----------------------------------------------------------------
  4377* 121802    2009122800001  PEMA  NEW COPYBOOK
  4378******************************************************************
  4379****************************************
  4380*  commarea for NaperSoft On Demand Claim letters
  4381*  (business logic input & output)
  4382****************************************
  4383     03  BL-INPUT.
  4384         05  BL-CARRIER          PIC X.
  4385         05  BL-CLAIM-NO         PIC X(7).
  4386         05  BL-CERT-NO          PIC X(11).
  4387         05  BL-LETTER-ID        PIC XXXX.
  4388         05  BL-FOLLOW-UP-DT     PIC X(10).
  4389         05  BL-RESEND-DT        PIC X(10).
  4390         05  BL-NO-OF-COPIES     PIC 99.
  4391         05  BL-PROC-ID          PIC XXXX.
  4392         05  BL-COMP-ID          PIC XXX.
  4393         05  BL-PRINT-NOW-SW     PIC X.
  4394         05  BL-ENC-CD           PIC XXX.
  4395         05  BL-ARCHIVE-NO       PIC 9(8).
  4396         05  BL-REGARDING        PIC X(70).
  4397     03  BL-OUTPUT.
  4398         05  BL-STATUS                   PIC X.
  4399             88  BL-OK                      VALUE "P".
  4400             88  BL-FAIL                  VALUE "F".
  4401         05  BL-MESSAGE          PIC X(50).
  4402     03  BL-RECORD-PASSED-DATA   PIC X(2500).
  4403 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4404 0000-DFHEXIT SECTION.
  4405     MOVE '9#                    $   ' TO DFHEIV0.
  4406     MOVE 'NSRLTRBL' TO DFHEIV1.
  4407     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4408     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4409     MOVE '5'                    TO DC-OPTION-CODE
  4410     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4411     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  4412     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  4413     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  4414*****************************************************
  4415* The full claim key has been established and passed
  4416* to this program via NSREQLTR
  4417*****************************************************
  4418     IF BL-COMP-ID = 'DCC'
  4419        MOVE X'05'               TO WS-ELMSTR-COMPANY-CD
  4420     ELSE
  4421       IF BL-COMP-ID = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  78
* NSRLTRBL.cbl
  4422        MOVE X'06'               TO WS-ELMSTR-COMPANY-CD
  4423       ELSE
  4424        MOVE X'04'               TO WS-ELMSTR-COMPANY-CD
  4425       END-IF
  4426     END-IF
  4427     MOVE BL-CARRIER             TO WS-ELMSTR-CARRIER
  4428     MOVE BL-CLAIM-NO            TO WS-ELMSTR-CLAIM-NO
  4429     MOVE BL-CERT-NO             TO WS-ELMSTR-CERT-NO
  4430     SET BL-FAIL TO TRUE
  4431
  4432* EXEC CICS READ
  4433*         DATASET    ('ELMSTR')
  4434*         INTO       (CLAIM-MASTER)
  4435*         RIDFLD     (WS-ELMSTR-KEY)
  4436*         RESP       (WS-RESPONSE)
  4437*    END-EXEC.
  4438     MOVE LENGTH OF
  4439      CLAIM-MASTER
  4440       TO DFHEIV11
  4441     MOVE 'ELMSTR' TO DFHEIV1
  4442*    MOVE '&"IL       E          (  N#00004427' TO DFHEIV0
  4443     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4445     MOVE X'204E233030303034343237' TO DFHEIV0(25:11)
  4446     CALL 'kxdfhei1' USING DFHEIV0,
  4447           DFHEIV1,
  4448           CLAIM-MASTER,
  4449           DFHEIV11,
  4450           WS-ELMSTR-KEY,
  4451           DFHEIV99,
  4452           DFHEIV99,
  4453           DFHEIV99
  4454     MOVE EIBRESP  TO WS-RESPONSE
  4455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4456
  4457     IF RESP-NORMAL
  4458        MOVE BL-LETTER-ID        TO OUT-TEMP
  4459                                    OUT-LETTER
  4460        MOVE BL-PROC-ID          TO OUT-PROCID
  4461        MOVE BL-COMP-ID          TO OUT-COMPID
  4462        MOVE BL-PRINT-NOW-SW     TO OUT-PRINT-NOW-SW
  4463        MOVE CL-CARRIER          TO OUT-CARR
  4464                                    OUT-CARR-LU
  4465        MOVE CL-INSURED-LAST-NAME
  4466                                 TO OUT-ILNAME
  4467        MOVE CL-INSURED-1ST-NAME TO OUT-IFNAME
  4468        MOVE CL-CLAIM-NO         TO OUT-CLMNO
  4469        MOVE CL-CERT-NO          TO OUT-CRTNO
  4470        MOVE CL-CERT-ACCOUNT     TO OUT-ACTNO
  4471        MOVE CL-SOC-SEC-NO       TO OUT-SSN
  4472        MOVE CL-CLAIM-STATUS     TO OUT-CLMSTAT
  4473        MOVE CL-CCN (1:9)        TO OUT-AHL-CLAIM-NO
  4474        MOVE WS-SAVE-EDIT-A-DATE TO DC-GREG-DATE-A-EDIT
  4475        STRING DC-EDITA-CCYY  DC-EDITA-MONTH DC-EDITA-DAY
  4476          DELIMITED BY SIZE INTO OUT-CYCLE-DATE
  4477        END-STRING
  4478*       IF CLAIM-IS-CLOSED
  4479*          MOVE 'CLOSED'         TO OUT-CLMSTAT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  79
* NSRLTRBL.cbl
  4480*       ELSE
  4481*          MOVE 'OPEN'           TO OUT-CLMSTAT
  4482*       END-IF
  4483        MOVE CL-CLAIM-TYPE       TO OUT-CLMTYPE
  4484        MOVE CL-FILE-ESTABLISH-DT
  4485                                 TO DC-BIN-DATE-1
  4486        MOVE ' '                 TO DC-OPTION-CODE
  4487        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4488        IF NO-CONVERSION-ERROR
  4489           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4490              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4491              INTO OUT-EST-DT
  4492           END-STRING
  4493        ELSE
  4494           MOVE SPACES           TO OUT-EST-DT
  4495        END-IF
  4496        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4497        MOVE ' '                 TO DC-OPTION-CODE
  4498        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4499        IF NO-CONVERSION-ERROR
  4500           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4501              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4502              INTO OUT-PD-THRU-DT
  4503           END-STRING
  4504        ELSE
  4505           MOVE SPACES           TO OUT-PD-THRU-DT
  4506        END-IF
  4507        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4508        MOVE +0                  TO DC-ELAPSED-MONTHS
  4509        MOVE +30                 TO DC-ELAPSED-DAYS
  4510        MOVE '6'                 TO DC-OPTION-CODE
  4511        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4512        IF NO-CONVERSION-ERROR
  4513           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4514              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4515              INTO OUT-FORM-DUE-DT
  4516           END-STRING
  4517        ELSE
  4518           MOVE SPACES           TO OUT-FORM-DUE-DT
  4519        END-IF
  4520        MOVE CL-TOTAL-PAID-AMT   TO OUT-TOT-PAID
  4521        MOVE CL-INSURED-SEX-CD   TO OUT-SEX-CD
  4522        MOVE CL-CERT-STATE       TO OUT-CRT-ST
  4523                                    OUT-ENC-ST
  4524                                    OUT-ENC-ST-NAME
  4525        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
  4526        MOVE ' '                 TO DC-OPTION-CODE
  4527        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4528        IF NO-CONVERSION-ERROR
  4529           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4530              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4531              INTO OUT-EFF-DT
  4532           END-STRING
  4533        ELSE
  4534           MOVE SPACES           TO OUT-EFF-DT
  4535        END-IF
  4536        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  4537        MOVE ' '                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  80
* NSRLTRBL.cbl
  4538        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4539        IF NO-CONVERSION-ERROR
  4540           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4541              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4542              INTO OUT-INC-DT
  4543           END-STRING
  4544        ELSE
  4545           MOVE SPACES           TO OUT-INC-DT
  4546        END-IF
  4547        MOVE CL-REPORTED-DT      TO DC-BIN-DATE-1
  4548        MOVE ' '                 TO DC-OPTION-CODE
  4549        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4550        IF NO-CONVERSION-ERROR
  4551           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4552              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4553              INTO OUT-RPT-DT
  4554           END-STRING
  4555        ELSE
  4556           MOVE SPACES           TO OUT-RPT-DT
  4557        END-IF
  4558        MOVE CL-LAST-PMT-DT      TO DC-BIN-DATE-1
  4559        MOVE ' '                 TO DC-OPTION-CODE
  4560        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4561        IF NO-CONVERSION-ERROR
  4562           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4563              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4564              INTO OUT-LST-PMT-DT
  4565           END-STRING
  4566        ELSE
  4567           MOVE SPACES           TO OUT-LST-PMT-DT
  4568        END-IF
  4569        MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
  4570        MOVE ' '                 TO DC-OPTION-CODE
  4571        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4572        IF NO-CONVERSION-ERROR
  4573           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4574              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4575              INTO OUT-BIRTH-DT
  4576           END-STRING
  4577        ELSE
  4578           MOVE SPACES           TO OUT-BIRTH-DT
  4579        END-IF
  4580        MOVE CL-LAST-MAINT-DT    TO DC-BIN-DATE-1
  4581        MOVE ' '                 TO DC-OPTION-CODE
  4582        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4583        IF NO-CONVERSION-ERROR
  4584           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4585              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4586              INTO OUT-LST-MAINT-DT
  4587           END-STRING
  4588        ELSE
  4589           MOVE SPACES           TO OUT-LST-MAINT-DT
  4590        END-IF
  4591        MOVE CL-LAST-MAINT-USER  TO OUT-LST-MAINT-USER
  4592        MOVE CL-LAST-MAINT-TYPE  TO OUT-LST-MAINT-TYPE
  4593        MOVE CL-NO-OF-PMTS-MADE  TO OUT-NO-OF-PMTS
  4594        MOVE CL-LAST-PMT-AMT     TO OUT-LST-PD-AMT
  4595        MOVE CL-ACCOUNT-ADDR-CNT TO OUT-ADDR-CNT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  81
* NSRLTRBL.cbl
  4596        MOVE CL-LAST-CLOSE-REASON TO OUT-LST-CLS-REA
  4597        MOVE BL-ENC-CD           TO OUT-ENC-CODE
  4598        PERFORM 1000-GET-FILES   THRU 1000-EXIT
  4599        PERFORM 1800-SET-EL150D-FIELDS THRU 1800-EXIT
  4600        SET BL-OK TO TRUE
  4601     END-IF
  4602     IF BL-OK
  4603        PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  4604        MOVE WS-ARCHIVE-NO       TO OUT-ARCHNO
  4605        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  4606        MOVE NAPER-OUTPUT-DATA   TO BL-RECORD-PASSED-DATA
  4607*       PERFORM 1600-ADD-CORR-TRLR
  4608*                                THRU 1600-EXIT
  4609     END-IF
  4610
  4611* exec cics return end-exec.
  4612*    MOVE '.(                    ''   #00004586' TO DFHEIV0
  4613     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4614     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4615     MOVE X'2020233030303034353836' TO DFHEIV0(25:11)
  4616     CALL 'kxdfhei1' USING DFHEIV0,
  4617           DFHEIV99,
  4618           DFHEIV99,
  4619           DFHEIV99,
  4620           DFHEIV99,
  4621           DFHEIV99,
  4622           DFHEIV99
  4623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4624
  4625 0500-SCRUB-DATA.
  4626*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  4627*   A DIFFERENT DELIMITER IN PROGRAM NSREQLTR BUT
  4628*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  4629*   TO A HEX 26 TO GET BY THE DECODER
  4630     MOVE FUNCTION LENGTH(OUT-ILNAME)
  4631                                 TO M1
  4632     MOVE SPACES                 TO WS-WORK-FIELD
  4633     perform varying a1 from +1 by +1 until a1 > m1
  4634        if out-ilname (a1:1) = '&'
  4635           MOVE OUT-ILNAME (1:A1 - 1)
  4636                                 TO WS-WORK-FIELD (1:A1 - 1)
  4637           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4638           MOVE OUT-ILNAME (A1 + 1:M1 - A1)
  4639                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4640           MOVE WS-WORK-FIELD    TO OUT-ILNAME
  4641           add +2 to a1
  4642        end-if
  4643     end-perform
  4644     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR1)
  4645                                 TO M1
  4646     MOVE SPACES                 TO WS-WORK-FIELD
  4647     perform varying a1 from +1 by +1 until a1 > m1
  4648        if out-acct-addr1 (a1:1) = '&'
  4649           MOVE out-acct-addr1 (1:A1 - 1)
  4650                                 TO WS-WORK-FIELD (1:A1 - 1)
  4651           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4652           MOVE out-acct-addr1 (A1 + 1:M1 - A1)
  4653                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  82
* NSRLTRBL.cbl
  4654           MOVE WS-WORK-FIELD    TO out-acct-addr1
  4655           add +2 to a1
  4656        end-if
  4657     end-perform
  4658     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR2)
  4659                                 TO M1
  4660     MOVE SPACES                 TO WS-WORK-FIELD
  4661     perform varying a1 from +1 by +1 until a1 > m1
  4662        if out-acct-addr2 (a1:1) = '&'
  4663           MOVE out-acct-addr2 (1:A1 - 1)
  4664                                 TO WS-WORK-FIELD (1:A1 - 1)
  4665           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4666           MOVE out-acct-addr2 (A1 + 1:M1 - A1)
  4667                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4668           MOVE WS-WORK-FIELD    TO out-acct-addr2
  4669           add +2 to a1
  4670        end-if
  4671     end-perform
  4672     MOVE FUNCTION LENGTH(OUT-ACCT-CITY)
  4673                                 TO M1
  4674     MOVE SPACES                 TO WS-WORK-FIELD
  4675     perform varying a1 from +1 by +1 until a1 > m1
  4676        if out-acct-city (a1:1) = '&'
  4677           MOVE out-acct-city (1:A1 - 1)
  4678                                 TO WS-WORK-FIELD (1:A1 - 1)
  4679           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4680           MOVE out-acct-city (A1 + 1:M1 - A1)
  4681                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4682           MOVE WS-WORK-FIELD    TO out-acct-city
  4683           add +2 to a1
  4684        end-if
  4685     end-perform
  4686     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  4687                                 TO M1
  4688     MOVE SPACES                 TO WS-WORK-FIELD
  4689     perform varying a1 from +1 by +1 until a1 > m1
  4690        if out-acct-name (a1:1) = '&'
  4691           MOVE out-acct-name (1:A1 - 1)
  4692                                 TO WS-WORK-FIELD (1:A1 - 1)
  4693           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4694           MOVE out-acct-name (A1 + 1:M1 - A1)
  4695                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4696           MOVE WS-WORK-FIELD    TO out-acct-name
  4697           add +2 to a1
  4698        end-if
  4699     end-perform
  4700     MOVE FUNCTION LENGTH(OUT-ORIG-NAME)
  4701                                 TO M1
  4702     MOVE SPACES                 TO WS-WORK-FIELD
  4703     perform varying a1 from +1 by +1 until a1 > m1
  4704        if out-orig-name (a1:1) = '&'
  4705           MOVE out-orig-name (1:A1 - 1)
  4706                                 TO WS-WORK-FIELD (1:A1 - 1)
  4707           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4708           MOVE out-orig-name (A1 + 1:M1 - A1)
  4709                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4710           MOVE WS-WORK-FIELD    TO out-orig-name
  4711           add +2 to a1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  83
* NSRLTRBL.cbl
  4712        end-if
  4713     end-perform
  4714     MOVE FUNCTION LENGTH(OUT-INS-NAME)
  4715                                 TO M1
  4716     MOVE SPACES                 TO WS-WORK-FIELD
  4717     perform varying a1 from +1 by +1 until a1 > m1
  4718        if out-ins-name (a1:1) = '&'
  4719           MOVE out-ins-name (1:A1 - 1)
  4720                                 TO WS-WORK-FIELD (1:A1 - 1)
  4721           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4722           MOVE out-ins-name (A1 + 1:M1 - A1)
  4723                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4724           MOVE WS-WORK-FIELD    TO out-ins-name
  4725           add +2 to a1
  4726        end-if
  4727     end-perform
  4728     MOVE FUNCTION LENGTH(OUT-INS-ADDR1)
  4729                                 TO M1
  4730     MOVE SPACES                 TO WS-WORK-FIELD
  4731     perform varying a1 from +1 by +1 until a1 > m1
  4732        if out-ins-addr1 (a1:1) = '&'
  4733           MOVE out-ins-addr1 (1:A1 - 1)
  4734                                 TO WS-WORK-FIELD (1:A1 - 1)
  4735           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4736           MOVE out-ins-addr1 (A1 + 1:M1 - A1)
  4737                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4738           MOVE WS-WORK-FIELD    TO out-ins-addr1
  4739           add +2 to a1
  4740        end-if
  4741     end-perform
  4742     MOVE FUNCTION LENGTH(OUT-INS-ADDR2)
  4743                                 TO M1
  4744     MOVE SPACES                 TO WS-WORK-FIELD
  4745     perform varying a1 from +1 by +1 until a1 > m1
  4746        if out-ins-addr2 (a1:1) = '&'
  4747           MOVE out-ins-addr2 (1:A1 - 1)
  4748                                 TO WS-WORK-FIELD (1:A1 - 1)
  4749           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4750           MOVE out-ins-addr2 (A1 + 1:M1 - A1)
  4751                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4752           MOVE WS-WORK-FIELD    TO out-ins-addr2
  4753           add +2 to a1
  4754        end-if
  4755     end-perform
  4756     MOVE FUNCTION LENGTH(OUT-BEN-NAME)   TO M1
  4757     MOVE SPACES                 TO WS-WORK-FIELD
  4758     perform varying a1 from +1 by +1 until a1 > m1
  4759        if out-ben-name (a1:1) = '&'
  4760           MOVE out-ben-name (1:A1 - 1)
  4761                                 TO WS-WORK-FIELD (1:A1 - 1)
  4762           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4763           MOVE out-ben-name (A1 + 1:M1 - A1)
  4764                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4765           MOVE WS-WORK-FIELD    TO out-ben-name
  4766           add +2 to a1
  4767        end-if
  4768     end-perform
  4769     MOVE FUNCTION LENGTH(OUT-BEN-ADDR1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  84
* NSRLTRBL.cbl
  4770                                 TO M1
  4771     MOVE SPACES                 TO WS-WORK-FIELD
  4772     perform varying a1 from +1 by +1 until a1 > m1
  4773        if out-ben-addr1 (a1:1) = '&'
  4774           MOVE out-ben-addr1 (1:A1 - 1)
  4775                                 TO WS-WORK-FIELD (1:A1 - 1)
  4776           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4777           MOVE out-ben-addr1 (A1 + 1:M1 - A1)
  4778                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4779           MOVE WS-WORK-FIELD    TO out-ben-addr1
  4780           add +2 to a1
  4781        end-if
  4782     end-perform
  4783     MOVE FUNCTION LENGTH(OUT-BEN-ADDR2)
  4784                                 TO M1
  4785     MOVE SPACES                 TO WS-WORK-FIELD
  4786     perform varying a1 from +1 by +1 until a1 > m1
  4787        if out-ben-addr2 (a1:1) = '&'
  4788           MOVE out-ben-addr2 (1:A1 - 1)
  4789                                 TO WS-WORK-FIELD (1:A1 - 1)
  4790           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4791           MOVE out-ben-addr2 (A1 + 1:M1 - A1)
  4792                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4793           MOVE WS-WORK-FIELD    TO out-ben-addr2
  4794           add +2 to a1
  4795        end-if
  4796     end-perform
  4797     MOVE FUNCTION LENGTH(OUT-DIAG)       TO M1
  4798     MOVE SPACES                 TO WS-WORK-FIELD
  4799     perform varying a1 from +1 by +1 until a1 > m1
  4800        if out-diag (a1:1) = '&'
  4801           MOVE out-diag (1:A1 - 1)
  4802                                 TO WS-WORK-FIELD (1:A1 - 1)
  4803           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4804           MOVE out-diag (A1 + 1:M1 - A1)
  4805                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4806           MOVE WS-WORK-FIELD    TO out-diag
  4807           add +2 to a1
  4808        end-if
  4809     end-perform
  4810     MOVE ZEROS TO WS-TALLY WS-TALLY1
  4811     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY
  4812        FOR ALL '%'
  4813     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY1
  4814        FOR ALL '%26'
  4815     IF (WS-TALLY > 0)
  4816        AND (WS-TALLY NOT = WS-TALLY1)
  4817        MOVE +1                  TO A1
  4818        MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  4819                                 TO NS-LEN
  4820        PERFORM WS-TALLY TIMES
  4821           PERFORM VARYING A1 FROM A1 BY +1 UNTIL
  4822              (A1 > NS-LEN)
  4823              OR (NAPER-OUTPUT-DATA (A1:1) = '%')
  4824           END-PERFORM
  4825           IF A1 > NS-LEN
  4826              CONTINUE
  4827           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  85
* NSRLTRBL.cbl
  4828              IF NAPER-OUTPUT-DATA (A1:3) = '%26'
  4829                 ADD +1 TO A1
  4830              ELSE
  4831                 MOVE NAPER-OUTPUT-DATA (1:A1 - 1)
  4832                                 TO WS-XML-WORK
  4833                 MOVE '%25'      TO WS-XML-WORK (A1:3)
  4834                 MOVE NAPER-OUTPUT-DATA (A1 + 1:NS-LEN - A1)
  4835                              TO WS-XML-WORK (A1 + 3:NS-LEN - A1)
  4836                 MOVE WS-XML-WORK TO NAPER-OUTPUT-DATA
  4837                 ADD +3 TO A1
  4838              END-IF
  4839           END-IF
  4840        END-PERFORM
  4841     END-IF
  4842     .
  4843 0500-EXIT.
  4844     EXIT.
  4845 1000-GET-FILES.
  4846     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  4847     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  4848     MOVE ' '                    TO WS-FOUND-BENE-SW
  4849     PERFORM 1250-GET-ELLETR     THRU 1250-EXIT
  4850     PERFORM 1300-GET-ELTRLRS    THRU 1300-EXIT
  4851     PERFORM 1700-GET-ELENCC     THRU 1700-EXIT
  4852     IF CL-CLAIM-TYPE NOT = 'L' AND 'P'
  4853        PERFORM 1400-GET-WAIT-PER THRU 1400-EXIT
  4854     END-IF
  4855     IF NOT FOUND-BENE
  4856        MOVE CL-COMPANY-CD       TO WS-ELBENE-COMPANY-CD
  4857        MOVE 'B'                 TO WS-ELBENE-REC-TYPE
  4858        MOVE CL-BENEFICIARY      TO WS-ELBENE-BENE
  4859
  4860* EXEC CICS READ
  4861*            DATASET    ('ELBENE')
  4862*            INTO       (BENEFICIARY-MASTER)
  4863*            RIDFLD     (WS-ELBENE-KEY)
  4864*            RESP       (WS-RESPONSE)
  4865*       END-EXEC
  4866     MOVE LENGTH OF
  4867      BENEFICIARY-MASTER
  4868       TO DFHEIV11
  4869     MOVE 'ELBENE' TO DFHEIV1
  4870*    MOVE '&"IL       E          (  N#00004821' TO DFHEIV0
  4871     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4873     MOVE X'204E233030303034383231' TO DFHEIV0(25:11)
  4874     CALL 'kxdfhei1' USING DFHEIV0,
  4875           DFHEIV1,
  4876           BENEFICIARY-MASTER,
  4877           DFHEIV11,
  4878           WS-ELBENE-KEY,
  4879           DFHEIV99,
  4880           DFHEIV99,
  4881           DFHEIV99
  4882     MOVE EIBRESP  TO WS-RESPONSE
  4883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4884        IF RESP-NORMAL
  4885           MOVE BE-MAIL-TO-NAME   TO OUT-BEN-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  86
* NSRLTRBL.cbl
  4886           MOVE BE-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  4887           MOVE BE-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  4888           MOVE BE-CITY           TO OUT-BEN-CITY
  4889           MOVE BE-STATE          TO OUT-BEN-STATE
  4890           MOVE BE-ZIP-PRIME      TO OUT-BEN-ZIP
  4891           IF BE-ZIP-PLUS4 NOT = SPACES AND ZEROS
  4892              STRING '-' BE-ZIP-PLUS4 DELIMITED BY SIZE
  4893                 INTO OUT-BEN-ZIP (6:5)
  4894              END-STRING
  4895           END-IF
  4896           MOVE BE-PHONE-NO       TO OUT-BEN-PHONE
  4897        END-IF
  4898     END-IF
  4899     .
  4900 1000-EXIT.
  4901     EXIT.
  4902 1100-GET-ELCERT.
  4903     MOVE CL-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  4904     MOVE CL-CERT-KEY-DATA       TO WS-ELCERT-KEY (2:21)
  4905     MOVE CL-CERT-NO             TO WS-ELCERT-CERT-NO
  4906
  4907* EXEC CICS READ
  4908*         DATASET    ('ELCERT')
  4909*         INTO       (CERTIFICATE-MASTER)
  4910*         RIDFLD     (WS-ELCERT-KEY)
  4911*         RESP       (WS-RESPONSE)
  4912*    END-EXEC.
  4913     MOVE LENGTH OF
  4914      CERTIFICATE-MASTER
  4915       TO DFHEIV11
  4916     MOVE 'ELCERT' TO DFHEIV1
  4917*    MOVE '&"IL       E          (  N#00004849' TO DFHEIV0
  4918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4920     MOVE X'204E233030303034383439' TO DFHEIV0(25:11)
  4921     CALL 'kxdfhei1' USING DFHEIV0,
  4922           DFHEIV1,
  4923           CERTIFICATE-MASTER,
  4924           DFHEIV11,
  4925           WS-ELCERT-KEY,
  4926           DFHEIV99,
  4927           DFHEIV99,
  4928           DFHEIV99
  4929     MOVE EIBRESP  TO WS-RESPONSE
  4930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4931
  4932     IF RESP-NORMAL
  4933        IF CL-CLAIM-TYPE = 'L' OR 'P'
  4934           MOVE CM-LF-BENEFIT-AMT TO OUT-BENAMT
  4935           MOVE CM-LF-ORIG-TERM  TO OUT-TERM
  4936           MOVE CM-LF-BENEFIT-CD TO OUT-BEN-CD
  4937           MOVE CM-LF-CRITICAL-PERIOD
  4938                                 TO OUT-CRIT-PER
  4939           MOVE CM-LF-LOAN-EXPIRE-DT
  4940                                 TO DC-BIN-DATE-1
  4941           MOVE ' '              TO DC-OPTION-CODE
  4942           PERFORM 9700-DATE-LINK
  4943                                 THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  87
* NSRLTRBL.cbl
  4944           IF NO-CONVERSION-ERROR
  4945              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4946                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4947                 INTO OUT-EXP-DT
  4948              END-STRING
  4949           ELSE
  4950              MOVE SPACES        TO OUT-EXP-DT
  4951           END-IF
  4952        ELSE
  4953           MOVE CM-AH-BENEFIT-AMT TO OUT-BENAMT
  4954           MOVE CM-AH-ORIG-TERM  TO OUT-TERM
  4955           MOVE CM-AH-BENEFIT-CD TO OUT-BEN-CD
  4956           MOVE CM-AH-CRITICAL-PERIOD
  4957                                 TO OUT-CRIT-PER
  4958           MOVE CM-AH-LOAN-EXPIRE-DT
  4959                                 TO DC-BIN-DATE-1
  4960           MOVE ' '              TO DC-OPTION-CODE
  4961           PERFORM 9700-DATE-LINK
  4962                                 THRU 9700-EXIT
  4963           IF NO-CONVERSION-ERROR
  4964              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4965                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4966                 INTO OUT-EXP-DT
  4967              END-STRING
  4968           ELSE
  4969              MOVE SPACES        TO OUT-EXP-DT
  4970           END-IF
  4971        END-IF
  4972        MOVE CM-ACCOUNT          TO OUT-CERTACCT
  4973        IF CL-INSURED-1ST-NAME = CM-INSURED-FIRST-NAME
  4974            MOVE CM-JT-FIRST-NAME TO OUT-JFNAME
  4975            MOVE CM-JT-LAST-NAME  TO OUT-JLNAME
  4976        ELSE
  4977            MOVE CM-INSURED-FIRST-NAME TO OUT-JFNAME
  4978            MOVE CM-INSURED-LAST-NAME TO OUT-JLNAME
  4979        END-IF
  4980        MOVE CM-LOAN-APR         TO OUT-APR
  4981     END-IF
  4982     .
  4983 1100-EXIT.
  4984     EXIT.
  4985 1200-GET-ERACCT.
  4986    MOVE LOW-VALUES              TO WS-ERACCT-KEY
  4987    MOVE WS-ELCERT-KEY (1:22)    TO WS-ERACCT-KEY (1:22)
  4988
  4989* EXEC CICS STARTBR
  4990*        DATASET   ('ERACCT')
  4991*        RIDFLD    (WS-ERACCT-KEY)
  4992*        GTEQ
  4993*        RESP      (WS-RESPONSE)
  4994*    END-EXEC
  4995     MOVE 'ERACCT' TO DFHEIV1
  4996     MOVE 0
  4997       TO DFHEIV11
  4998*    MOVE '&,         G          &  N#00004911' TO DFHEIV0
  4999     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5000     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5001     MOVE X'204E233030303034393131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  88
* NSRLTRBL.cbl
  5002     CALL 'kxdfhei1' USING DFHEIV0,
  5003           DFHEIV1,
  5004           WS-ERACCT-KEY,
  5005           DFHEIV99,
  5006           DFHEIV11,
  5007           DFHEIV99
  5008     MOVE EIBRESP  TO WS-RESPONSE
  5009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5010     IF RESP-NORMAL
  5011
  5012* EXEC CICS READNEXT
  5013*          INTO    (ACCOUNT-MASTER)
  5014*          DATASET ('ERACCT')
  5015*          RIDFLD  (WS-ERACCT-KEY)
  5016*          RESP    (WS-RESPONSE)
  5017*       END-EXEC
  5018     MOVE LENGTH OF
  5019      ACCOUNT-MASTER
  5020       TO DFHEIV12
  5021     MOVE 'ERACCT' TO DFHEIV1
  5022     MOVE 0
  5023       TO DFHEIV11
  5024*    MOVE '&.IL                  )  N#00004918' TO DFHEIV0
  5025     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5026     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5027     MOVE X'204E233030303034393138' TO DFHEIV0(25:11)
  5028     CALL 'kxdfhei1' USING DFHEIV0,
  5029           DFHEIV1,
  5030           ACCOUNT-MASTER,
  5031           DFHEIV12,
  5032           WS-ERACCT-KEY,
  5033           DFHEIV99,
  5034           DFHEIV11,
  5035           DFHEIV99,
  5036           DFHEIV99
  5037     MOVE EIBRESP  TO WS-RESPONSE
  5038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5039     END-IF
  5040     IF RESP-NORMAL
  5041        PERFORM WITH TEST AFTER UNTIL
  5042           NOT (RESP-NORMAL)
  5043           OR (CM-CONTROL-PRIMARY (1:20) NOT =
  5044                        AM-CONTROL-PRIMARY (1:20))
  5045           IF (CM-CONTROL-PRIMARY (1:20)
  5046              = AM-CONTROL-PRIMARY (1:20))
  5047              IF (CL-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5048                 AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5049                 MOVE AM-NAME    TO OUT-ORIG-NAME
  5050                 MOVE ACCOUNT-MASTER TO SAVE-ACCOUNT-MASTER
  5051              END-IF
  5052              MOVE AM-NAME       TO OUT-ACCT-NAME
  5053              MOVE AM-ADDRS      TO OUT-ACCT-ADDR1
  5054              MOVE SPACES        TO OUT-ACCT-ADDR2
  5055              MOVE AM-ADDR-CITY  TO OUT-ACCT-CITY
  5056              MOVE AM-ADDR-STATE TO OUT-ACCT-STATE
  5057              MOVE AM-ZIP-PRIME  TO OUT-ACCT-ZIP
  5058              IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5059                 STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  89
* NSRLTRBL.cbl
  5060                    INTO OUT-ACCT-ZIP (6:5)
  5061                 END-STRING
  5062              END-IF
  5063              MOVE AM-TEL-NO     TO OUT-ACCT-PHONE
  5064              MOVE AM-GPCD       TO OUT-ACCT-GPCD
  5065
  5066* EXEC CICS READNEXT
  5067*                INTO    (ACCOUNT-MASTER)
  5068*                DATASET ('ERACCT')
  5069*                RIDFLD  (WS-ERACCT-KEY)
  5070*                RESP    (WS-RESPONSE)
  5071*             END-EXEC
  5072     MOVE LENGTH OF
  5073      ACCOUNT-MASTER
  5074       TO DFHEIV12
  5075     MOVE 'ERACCT' TO DFHEIV1
  5076     MOVE 0
  5077       TO DFHEIV11
  5078*    MOVE '&.IL                  )  N#00004950' TO DFHEIV0
  5079     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5080     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5081     MOVE X'204E233030303034393530' TO DFHEIV0(25:11)
  5082     CALL 'kxdfhei1' USING DFHEIV0,
  5083           DFHEIV1,
  5084           ACCOUNT-MASTER,
  5085           DFHEIV12,
  5086           WS-ERACCT-KEY,
  5087           DFHEIV99,
  5088           DFHEIV11,
  5089           DFHEIV99,
  5090           DFHEIV99
  5091     MOVE EIBRESP  TO WS-RESPONSE
  5092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5093           END-IF
  5094        END-PERFORM
  5095     END-IF
  5096     MOVE SAVE-ACCOUNT-MASTER  TO ACCOUNT-MASTER
  5097    .
  5098 1200-EXIT.
  5099     EXIT.
  5100 1250-GET-ELLETR.
  5101     MOVE CL-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  5102     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  5103     MOVE +0                     TO WS-ELLETR-SEQ-NO
  5104
  5105* EXEC CICS READ
  5106*         DATASET    ('ELLETR')
  5107*         INTO       (TEXT-FILES)
  5108*         RIDFLD     (WS-ELLETR-KEY)
  5109*         RESP       (WS-RESPONSE)
  5110*         GTEQ
  5111*    END-EXEC
  5112     MOVE LENGTH OF
  5113      TEXT-FILES
  5114       TO DFHEIV11
  5115     MOVE 'ELLETR' TO DFHEIV1
  5116*    MOVE '&"IL       G          (  N#00004967' TO DFHEIV0
  5117     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  90
* NSRLTRBL.cbl
  5118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5119     MOVE X'204E233030303034393637' TO DFHEIV0(25:11)
  5120     CALL 'kxdfhei1' USING DFHEIV0,
  5121           DFHEIV1,
  5122           TEXT-FILES,
  5123           DFHEIV11,
  5124           WS-ELLETR-KEY,
  5125           DFHEIV99,
  5126           DFHEIV99,
  5127           DFHEIV99
  5128     MOVE EIBRESP  TO WS-RESPONSE
  5129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5130     IF RESP-NORMAL
  5131        IF (LETTER-FILE-TEXT)
  5132           AND (BL-LETTER-ID = TX-LETTER-NO)
  5133           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  5134           PERFORM 1280-PROCESS-Z-CONTROLS
  5135                                 THRU 1280-EXIT
  5136        END-IF
  5137     END-IF
  5138     .
  5139 1250-EXIT.
  5140     EXIT.
  5141 1280-PROCESS-Z-CONTROLS.
  5142     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  5143     IF W-FORM-TO-RESEND > SPACES
  5144        MOVE W-FORM-TO-RESEND    TO OUT-FORM
  5145     ELSE
  5146        MOVE SPACES              TO OUT-FORM
  5147     END-IF.
  5148*    MOVE W-ENCLOSURE-CD         TO OUT-ENC-CODE
  5149     .
  5150 1280-EXIT.
  5151     EXIT.
  5152 1300-GET-ELTRLRS.
  5153     MOVE CL-CONTROL-PRIMARY     TO WS-ELTRLR-KEY
  5154     MOVE +0                     TO WS-ELTRLR-SEQ-NO
  5155
  5156* EXEC CICS STARTBR
  5157*        DATASET   ('ELTRLR')
  5158*        RIDFLD    (WS-ELTRLR-KEY)
  5159*        GTEQ
  5160*        RESP      (WS-RESPONSE)
  5161*    END-EXEC
  5162     MOVE 'ELTRLR' TO DFHEIV1
  5163     MOVE 0
  5164       TO DFHEIV11
  5165*    MOVE '&,         G          &  N#00004999' TO DFHEIV0
  5166     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5167     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5168     MOVE X'204E233030303034393939' TO DFHEIV0(25:11)
  5169     CALL 'kxdfhei1' USING DFHEIV0,
  5170           DFHEIV1,
  5171           WS-ELTRLR-KEY,
  5172           DFHEIV99,
  5173           DFHEIV11,
  5174           DFHEIV99
  5175     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  91
* NSRLTRBL.cbl
  5176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5177    IF RESP-NORMAL
  5178
  5179* EXEC CICS READNEXT
  5180*         INTO    (ACTIVITY-TRAILERS)
  5181*         DATASET ('ELTRLR')
  5182*         RIDFLD  (WS-ELTRLR-KEY)
  5183*         RESP    (WS-RESPONSE)
  5184*      END-EXEC
  5185     MOVE LENGTH OF
  5186      ACTIVITY-TRAILERS
  5187       TO DFHEIV12
  5188     MOVE 'ELTRLR' TO DFHEIV1
  5189     MOVE 0
  5190       TO DFHEIV11
  5191*    MOVE '&.IL                  )  N#00005006' TO DFHEIV0
  5192     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5193     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5194     MOVE X'204E233030303035303036' TO DFHEIV0(25:11)
  5195     CALL 'kxdfhei1' USING DFHEIV0,
  5196           DFHEIV1,
  5197           ACTIVITY-TRAILERS,
  5198           DFHEIV12,
  5199           WS-ELTRLR-KEY,
  5200           DFHEIV99,
  5201           DFHEIV11,
  5202           DFHEIV99,
  5203           DFHEIV99
  5204     MOVE EIBRESP  TO WS-RESPONSE
  5205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5206       PERFORM 1310-GET-ELTRLRS THRU 1310-EXIT
  5207    END-IF
  5208     .
  5209 1300-EXIT.
  5210     EXIT.
  5211 1310-GET-ELTRLRS.
  5212     IF RESP-NORMAL
  5213     IF CL-CONTROL-PRIMARY = AT-CONTROL-PRIMARY (1:20)
  5214        EVALUATE TRUE
  5215           WHEN AT-INSURED-ADDR-TRL
  5216              MOVE AT-MAIL-TO-NAME   TO OUT-INS-NAME
  5217              MOVE AT-ADDRESS-LINE-1 TO OUT-INS-ADDR1
  5218              MOVE AT-ADDRESS-LINE-2 TO OUT-INS-ADDR2
  5219              MOVE AT-CITY           TO OUT-INS-CITY
  5220              MOVE AT-STATE          TO OUT-INS-STATE
  5221              MOVE AT-ZIP-CODE       TO OUT-INS-ZIP
  5222              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5223                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5224                    INTO OUT-INS-ZIP (6:5)
  5225                 END-STRING
  5226              END-IF
  5227              MOVE AT-PHONE-NO       TO OUT-INS-PHONE
  5228           WHEN AT-BENEFICIARY-ADDR-TRL
  5229              SET FOUND-BENE TO TRUE
  5230              MOVE AT-MAIL-TO-NAME   TO OUT-BEN-NAME
  5231              MOVE AT-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  5232              MOVE AT-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  5233              MOVE AT-CITY           TO OUT-BEN-CITY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  92
* NSRLTRBL.cbl
  5234              MOVE AT-STATE          TO OUT-BEN-STATE
  5235              MOVE AT-ZIP-CODE       TO OUT-BEN-ZIP
  5236              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5237                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5238                    INTO OUT-BEN-ZIP (6:5)
  5239                 END-STRING
  5240              END-IF
  5241              MOVE AT-PHONE-NO       TO OUT-BEN-PHONE
  5242           WHEN AT-ACCOUNT-ADDR-TRL
  5243              MOVE AT-MAIL-TO-NAME   TO OUT-ACCT-NAME
  5244              MOVE AT-ADDRESS-LINE-1 TO OUT-ACCT-ADDR1
  5245              MOVE AT-ADDRESS-LINE-2 TO OUT-ACCT-ADDR2
  5246              MOVE AT-CITY           TO OUT-ACCT-CITY
  5247              MOVE AT-STATE          TO OUT-ACCT-STATE
  5248              MOVE AT-ZIP-CODE       TO OUT-ACCT-ZIP
  5249              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5250                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5251                    INTO OUT-ACCT-ZIP (6:5)
  5252                 END-STRING
  5253              END-IF
  5254              MOVE AT-PHONE-NO       TO OUT-ACCT-PHONE
  5255           WHEN AT-SEQUENCE-NO = +90
  5256              MOVE AT-INFO-LINE-1   TO OUT-DIAG
  5257           WHEN AT-SEQUENCE-NO = +91
  5258              MOVE AT-INFO-LINE-1 TO OUT-LOAN-NO
  5259           WHEN AT-TRAILER-TYPE = '2' AND AT-PAYMENT-TYPE = 'I'
  5260              IF AT-INT-RATE NUMERIC AND
  5261                 AT-INT-RATE NOT EQUAL ZEROS
  5262                    COMPUTE OUT-LF-INT-RATE = AT-INT-RATE * 100
  5263              END-IF
  5264           WHEN AT-TRAILER-TYPE = '3'
  5265              IF (SAVE-BIN-DATE >= AT-SCHEDULE-START-DT)
  5266                 AND (SAVE-BIN-DATE <= AT-SCHEDULE-END-DT)
  5267                 AND (AT-TERMINATED-DT = LOW-VALUES OR SPACES)
  5268                 MOVE AT-SCHEDULE-END-DT TO WS-AUTO-LAST-SCHED-DT
  5269              END-IF
  5270           WHEN AT-TRAILER-TYPE = '8'
  5271              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5272                 MOVE AT-RECORDED-DT
  5273                              TO WS-LAST-ACT-DT
  5274                 MOVE 'DENIAL'
  5275                              TO WS-LAST-ACT-TYPE
  5276              END-IF
  5277           WHEN AT-TRAILER-TYPE = 'A'
  5278              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5279                 MOVE AT-RECORDED-DT
  5280                              TO WS-LAST-ACT-DT
  5281                 MOVE 'FORMS' TO WS-LAST-ACT-TYPE
  5282                 IF INITIAL-FORM
  5283                    MOVE 'INIT'
  5284                              TO WS-FORM
  5285                 END-IF
  5286                 IF PROGRESS-FORM
  5287                    MOVE 'PROG'
  5288                              TO WS-FORM
  5289                 END-IF
  5290              END-IF
  5291              IF AT-FORM-SEND-ON-DT > WS-ACTIVITY-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  93
* NSRLTRBL.cbl
  5292                 MOVE AT-FORM-SEND-ON-DT
  5293                              TO WS-ACTIVITY-DT
  5294              END-IF
  5295              IF AT-FORM-REPRINT-DT > WS-ACTIVITY-DT
  5296                 MOVE AT-FORM-REPRINT-DT
  5297                              TO WS-ACTIVITY-DT
  5298              END-IF
  5299              IF AT-FORM-ANSWERED-DT > WS-ACTIVITY-DT
  5300                 MOVE AT-FORM-ANSWERED-DT
  5301                              TO WS-ACTIVITY-DT
  5302              END-IF
  5303        END-EVALUATE
  5304
  5305* EXEC CICS READNEXT
  5306*         INTO    (ACTIVITY-TRAILERS)
  5307*         DATASET ('ELTRLR')
  5308*         RIDFLD  (WS-ELTRLR-KEY)
  5309*         RESP    (WS-RESPONSE)
  5310*       END-EXEC
  5311     MOVE LENGTH OF
  5312      ACTIVITY-TRAILERS
  5313       TO DFHEIV12
  5314     MOVE 'ELTRLR' TO DFHEIV1
  5315     MOVE 0
  5316       TO DFHEIV11
  5317*    MOVE '&.IL                  )  N#00005110' TO DFHEIV0
  5318     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5319     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5320     MOVE X'204E233030303035313130' TO DFHEIV0(25:11)
  5321     CALL 'kxdfhei1' USING DFHEIV0,
  5322           DFHEIV1,
  5323           ACTIVITY-TRAILERS,
  5324           DFHEIV12,
  5325           WS-ELTRLR-KEY,
  5326           DFHEIV99,
  5327           DFHEIV11,
  5328           DFHEIV99,
  5329           DFHEIV99
  5330     MOVE EIBRESP  TO WS-RESPONSE
  5331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5332        GO TO 1310-GET-ELTRLRS
  5333     END-IF
  5334     END-IF
  5335     .
  5336 1310-EXIT.
  5337     EXIT.
  5338 1400-GET-WAIT-PER.
  5339     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5340     MOVE CM-AH-BENEFIT-CD       TO WS-ELCNTL-BEN-CD
  5341     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  5342     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5343
  5344* EXEC CICS READ
  5345*       INTO    (CONTROL-FILE)
  5346*       DATASET ('ELCNTL')
  5347*       RIDFLD  (WS-ELCNTL-KEY)
  5348*       GTEQ
  5349*       RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  94
* NSRLTRBL.cbl
  5350*    END-EXEC
  5351     MOVE LENGTH OF
  5352      CONTROL-FILE
  5353       TO DFHEIV11
  5354     MOVE 'ELCNTL' TO DFHEIV1
  5355*    MOVE '&"IL       G          (  N#00005127' TO DFHEIV0
  5356     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5358     MOVE X'204E233030303035313237' TO DFHEIV0(25:11)
  5359     CALL 'kxdfhei1' USING DFHEIV0,
  5360           DFHEIV1,
  5361           CONTROL-FILE,
  5362           DFHEIV11,
  5363           WS-ELCNTL-KEY,
  5364           DFHEIV99,
  5365           DFHEIV99,
  5366           DFHEIV99
  5367     MOVE EIBRESP  TO WS-RESPONSE
  5368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5369     IF RESP-NORMAL
  5370        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5371        AND (CF-RECORD-TYPE = '5')
  5372        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5373           (S1 > +8)
  5374           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5375        END-PERFORM
  5376        IF S1 > +8
  5377           MOVE '**'             TO OUT-WAIT-PER
  5378        ELSE
  5379           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  5380                                 TO OUT-WAIT-PER
  5381        END-IF
  5382     ELSE
  5383        MOVE '**'                TO OUT-WAIT-PER
  5384     END-IF
  5385    .
  5386 1400-EXIT.
  5387     EXIT.
  5388 1500-GET-ARCH-NO.
  5389     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5390     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  5391     MOVE SPACES                 TO WS-ELCNTL-GENL
  5392     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5393
  5394* EXEC CICS READ
  5395*       INTO    (CONTROL-FILE)
  5396*       DATASET ('ELCNTL')
  5397*       RIDFLD  (WS-ELCNTL-KEY)
  5398*       UPDATE
  5399*       RESP    (WS-RESPONSE)
  5400*    END-EXEC
  5401     MOVE LENGTH OF
  5402      CONTROL-FILE
  5403       TO DFHEIV11
  5404     MOVE 'ELCNTL' TO DFHEIV1
  5405*    MOVE '&"IL       EU         (  N#00005159' TO DFHEIV0
  5406     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5407     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  95
* NSRLTRBL.cbl
  5408     MOVE X'204E233030303035313539' TO DFHEIV0(25:11)
  5409     CALL 'kxdfhei1' USING DFHEIV0,
  5410           DFHEIV1,
  5411           CONTROL-FILE,
  5412           DFHEIV11,
  5413           WS-ELCNTL-KEY,
  5414           DFHEIV99,
  5415           DFHEIV99,
  5416           DFHEIV99
  5417     MOVE EIBRESP  TO WS-RESPONSE
  5418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5419     IF RESP-NORMAL
  5420        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5421        AND (CF-RECORD-TYPE = '1')
  5422        ADD +1                   TO CF-CO-ARCHIVE-COUNTER
  5423        MOVE CF-CO-ARCHIVE-COUNTER TO WS-ARCHIVE-NO
  5424        MOVE WS-ARCHIVE-NO       TO BL-ARCHIVE-NO
  5425
  5426* EXEC CICS REWRITE
  5427*          FROM    (CONTROL-FILE)
  5428*          DATASET ('ELCNTL')
  5429*       END-EXEC
  5430     MOVE LENGTH OF
  5431      CONTROL-FILE
  5432       TO DFHEIV11
  5433     MOVE 'ELCNTL' TO DFHEIV1
  5434*    MOVE '&& L                  %   #00005172' TO DFHEIV0
  5435     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5436     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5437     MOVE X'2020233030303035313732' TO DFHEIV0(25:11)
  5438     CALL 'kxdfhei1' USING DFHEIV0,
  5439           DFHEIV1,
  5440           CONTROL-FILE,
  5441           DFHEIV11,
  5442           DFHEIV99
  5443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5444     ELSE
  5445        MOVE +0                  TO WS-ARCHIVE-NO
  5446     END-IF
  5447    .
  5448 1500-EXIT.
  5449     EXIT.
  5450 1600-ADD-CORR-TRLR.
  5451
  5452* EXEC CICS READ
  5453*         DATASET    ('ELMSTR')
  5454*         INTO       (CLAIM-MASTER)
  5455*         RIDFLD     (WS-ELMSTR-KEY)
  5456*         UPDATE
  5457*         RESP       (WS-RESPONSE)
  5458*    END-EXEC
  5459     MOVE LENGTH OF
  5460      CLAIM-MASTER
  5461       TO DFHEIV11
  5462     MOVE 'ELMSTR' TO DFHEIV1
  5463*    MOVE '&"IL       EU         (  N#00005183' TO DFHEIV0
  5464     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5465     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  96
* NSRLTRBL.cbl
  5466     MOVE X'204E233030303035313833' TO DFHEIV0(25:11)
  5467     CALL 'kxdfhei1' USING DFHEIV0,
  5468           DFHEIV1,
  5469           CLAIM-MASTER,
  5470           DFHEIV11,
  5471           WS-ELMSTR-KEY,
  5472           DFHEIV99,
  5473           DFHEIV99,
  5474           DFHEIV99
  5475     MOVE EIBRESP  TO WS-RESPONSE
  5476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5477     IF NOT RESP-NORMAL
  5478        DISPLAY ' 1600 READ UPD MSTR ' WS-RESPONSE
  5479        GO TO 1600-EXIT
  5480     END-IF
  5481     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
  5482     PERFORM 2000-BUILD-ELNAPS   THRU 2000-EXIT
  5483     IF WS-FOLLOW-UP-DT > CL-NEXT-FOLLOWUP-DT
  5484        MOVE WS-FOLLOW-UP-DT     TO CL-NEXT-FOLLOWUP-DT
  5485     END-IF
  5486     IF WS-RESEND-DT > CL-NEXT-FOLLOWUP-DT
  5487        MOVE WS-RESEND-DT        TO CL-NEXT-FOLLOWUP-DT
  5488     END-IF
  5489     MOVE '2'                    TO CL-LAST-MAINT-TYPE
  5490     MOVE 'AT'                   TO ACTIVITY-TRAILERS
  5491     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY
  5492     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  5493     MOVE  4                     TO AT-TRAILER-TYPE
  5494     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  5495                                    CL-LAST-MAINT-DT
  5496                                    AT-CORR-LAST-MAINT-DT
  5497     MOVE BL-PROC-ID             TO AT-RECORDED-BY
  5498                                    CL-LAST-MAINT-USER
  5499                                    AT-CORR-LAST-UPDATED-BY
  5500     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  5501                                    CL-LAST-MAINT-HHMMSS.
  5502     MOVE SAVE-BIN-DATE          TO AT-LETTER-SENT-DT.
  5503     MOVE WS-FOLLOW-UP-DT        TO AT-RECEIPT-FOLLOW-UP.
  5504     MOVE WS-RESEND-DT           TO AT-AUTO-RE-SEND-DT.
  5505     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  5506                                    AT-LETTER-PURGED-DT.
  5507     MOVE WS-ARCHIVE-NO          TO AT-LETTER-ARCHIVE-NO.
  5508     MOVE '3'                    TO AT-LETTER-ORIGIN
  5509     MOVE BL-LETTER-ID           TO AT-STD-LETTER-FORM
  5510     MOVE SAVE-BIN-DATE          TO AT-INITIAL-PRINT-DATE
  5511     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE
  5512
  5513* EXEC CICS WRITE
  5514*         DATASET    ('ELTRLR')
  5515*         FROM       (ACTIVITY-TRAILERS)
  5516*         RIDFLD     (AT-CONTROL-PRIMARY)
  5517*         RESP       (WS-RESPONSE)
  5518*    END-EXEC
  5519     MOVE LENGTH OF
  5520      ACTIVITY-TRAILERS
  5521       TO DFHEIV11
  5522     MOVE 'ELTRLR' TO DFHEIV1
  5523*    MOVE '&$ L                  ''  N#00005225' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  97
* NSRLTRBL.cbl
  5524     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5525     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5526     MOVE X'204E233030303035323235' TO DFHEIV0(25:11)
  5527     CALL 'kxdfhei1' USING DFHEIV0,
  5528           DFHEIV1,
  5529           ACTIVITY-TRAILERS,
  5530           DFHEIV11,
  5531           AT-CONTROL-PRIMARY,
  5532           DFHEIV99,
  5533           DFHEIV99
  5534     MOVE EIBRESP  TO WS-RESPONSE
  5535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5536     IF NOT RESP-NORMAL
  5537        DISPLAY ' 1600 WRITE TRLR ' WS-RESPONSE
  5538        GO TO 1600-EXIT
  5539     END-IF
  5540
  5541* EXEC CICS REWRITE
  5542*         DATASET    ('ELMSTR')
  5543*         FROM       (CLAIM-MASTER)
  5544*         RESP       (WS-RESPONSE)
  5545*    END-EXEC
  5546     MOVE LENGTH OF
  5547      CLAIM-MASTER
  5548       TO DFHEIV11
  5549     MOVE 'ELMSTR' TO DFHEIV1
  5550*    MOVE '&& L                  %  N#00005235' TO DFHEIV0
  5551     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5552     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5553     MOVE X'204E233030303035323335' TO DFHEIV0(25:11)
  5554     CALL 'kxdfhei1' USING DFHEIV0,
  5555           DFHEIV1,
  5556           CLAIM-MASTER,
  5557           DFHEIV11,
  5558           DFHEIV99
  5559     MOVE EIBRESP  TO WS-RESPONSE
  5560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5561     IF NOT RESP-NORMAL
  5562        DISPLAY ' 1600 REWRITE MSTR ' WS-RESPONSE
  5563     END-IF
  5564     .
  5565 1600-EXIT.
  5566     EXIT.
  5567 1700-GET-ELENCC.
  5568     MOVE CL-COMPANY-CD          TO WS-ELENCC-KEY
  5569     MOVE '1'                    TO WS-ELENCC-REC-TYPE
  5570     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  5571     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  5572        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  5573        OR (E1 > +5)
  5574     END-PERFORM
  5575     IF E1 < +5
  5576        MOVE CL-CERT-STATE       TO WS-ELENCC-ENC-CODE (E1:2)
  5577     END-IF
  5578
  5579* EXEC CICS READ
  5580*        DATASET   ('ELENCC')
  5581*        INTO      (ENCLOSURE-CODES)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  98
* NSRLTRBL.cbl
  5582*        RIDFLD    (WS-ELENCC-KEY)
  5583*        RESP      (WS-RESPONSE)
  5584*    END-EXEC
  5585     MOVE LENGTH OF
  5586      ENCLOSURE-CODES
  5587       TO DFHEIV11
  5588     MOVE 'ELENCC' TO DFHEIV1
  5589*    MOVE '&"IL       E          (  N#00005257' TO DFHEIV0
  5590     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5592     MOVE X'204E233030303035323537' TO DFHEIV0(25:11)
  5593     CALL 'kxdfhei1' USING DFHEIV0,
  5594           DFHEIV1,
  5595           ENCLOSURE-CODES,
  5596           DFHEIV11,
  5597           WS-ELENCC-KEY,
  5598           DFHEIV99,
  5599           DFHEIV99,
  5600           DFHEIV99
  5601     MOVE EIBRESP  TO WS-RESPONSE
  5602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5603     IF NOT RESP-NORMAL
  5604        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  5605
  5606* EXEC CICS READ
  5607*           DATASET   ('ELENCC')
  5608*           INTO      (ENCLOSURE-CODES)
  5609*           RIDFLD    (WS-ELENCC-KEY)
  5610*           RESP      (WS-RESPONSE)
  5611*       END-EXEC
  5612     MOVE LENGTH OF
  5613      ENCLOSURE-CODES
  5614       TO DFHEIV11
  5615     MOVE 'ELENCC' TO DFHEIV1
  5616*    MOVE '&"IL       E          (  N#00005265' TO DFHEIV0
  5617     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5619     MOVE X'204E233030303035323635' TO DFHEIV0(25:11)
  5620     CALL 'kxdfhei1' USING DFHEIV0,
  5621           DFHEIV1,
  5622           ENCLOSURE-CODES,
  5623           DFHEIV11,
  5624           WS-ELENCC-KEY,
  5625           DFHEIV99,
  5626           DFHEIV99,
  5627           DFHEIV99
  5628     MOVE EIBRESP  TO WS-RESPONSE
  5629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5630     END-IF
  5631     IF RESP-NORMAL
  5632        MOVE NC-OUTPUT-STACK     TO OUT-OUTSTACK
  5633        MOVE NC-ENCLOSURE-LINE   TO OUT-ENCLINE
  5634        MOVE NC-ATTACHMENTS      TO OUT-ENCATTS
  5635     END-IF
  5636     .
  5637 1700-EXIT.
  5638     EXIT.
  5639 1800-SET-EL150D-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page  99
* NSRLTRBL.cbl
  5640     MOVE SPACES TO WS-UNSORTED-TABLE
  5641                    WS-SORTED-TABLE
  5642
  5643*    move cm-ah-benefit-amt      to pi-mo-ben
  5644
  5645     MOVE ' '                    TO WS-PDEF-RECORD-SW
  5646
  5647     MOVE CM-CONTROL-PRIMARY     TO ELCRTT-KEY
  5648     MOVE 'B'                    TO CRTT-REC-TYPE
  5649
  5650
  5651* EXEC CICS READ
  5652*       DATASET   ('ELCRTT')
  5653*       INTO      (CERTIFICATE-TRAILERS)
  5654*       RIDFLD    (ELCRTT-KEY)
  5655*       RESP      (WS-RESPONSE)
  5656*    END-EXEC
  5657     MOVE LENGTH OF
  5658      CERTIFICATE-TRAILERS
  5659       TO DFHEIV11
  5660     MOVE 'ELCRTT' TO DFHEIV1
  5661*    MOVE '&"IL       E          (  N#00005291' TO DFHEIV0
  5662     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5663     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5664     MOVE X'204E233030303035323931' TO DFHEIV0(25:11)
  5665     CALL 'kxdfhei1' USING DFHEIV0,
  5666           DFHEIV1,
  5667           CERTIFICATE-TRAILERS,
  5668           DFHEIV11,
  5669           ELCRTT-KEY,
  5670           DFHEIV99,
  5671           DFHEIV99,
  5672           DFHEIV99
  5673     MOVE EIBRESP  TO WS-RESPONSE
  5674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5675
  5676     IF NOT RESP-NORMAL
  5677        DISPLAY ' NSRLTRBL- NO TRLRS ' CL-CERT-NO
  5678        GO TO 1800-EXIT
  5679     END-IF
  5680
  5681     DISPLAY ' NSRLTRBL- GOOD READ ON ELCRTT '
  5682     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5683       (S1 > +24)
  5684       OR (CS-CLAIM-NO (S1) = SPACES)
  5685        MOVE CS-CLAIM-NO (S1)    TO WS-CLAIM-NO (S1)
  5686        MOVE CS-CLAIM-TYPE (S1)  TO WS-CLM-TYPE (S1)
  5687        IF CS-INSURED-TYPE (S1) = 'C'
  5688           MOVE '2'              TO WS-INS-TYPE (S1)
  5689        ELSE
  5690           MOVE '1'              TO WS-INS-TYPE (S1)
  5691        END-IF
  5692        MOVE CS-BENEFIT-PERIOD (S1)
  5693                                 TO WS-BEN-PER (S1)
  5694*       MOVE CS-DAYS-PAID (S1)   TO WS-DAYS-PAID (S1)
  5695        MOVE CS-TOTAL-PAID (S1)  TO WS-TOTAL-PAID (S1)
  5696        MOVE ' '                 TO WS-SORTED-SW (S1)
  5697
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 100
* NSRLTRBL.cbl
  5698        MOVE CS-COMPANY-CD          TO WS-ELMSTR-COMPANY-CD
  5699        MOVE CS-CARRIER             TO WS-ELMSTR-CARRIER
  5700        MOVE CS-CLAIM-NO (S1)       TO WS-ELMSTR-CLAIM-NO
  5701        MOVE CS-CERT-NO             TO WS-ELMSTR-CERT-NO
  5702
  5703
  5704* EXEC CICS READ
  5705*          DATASET        ('ELMSTR')
  5706*          RIDFLD         (WS-ELMSTR-KEY)
  5707*          INTO           (CLAIM-MASTER)
  5708*          RESP           (WS-RESPONSE)
  5709*       END-EXEC
  5710     MOVE LENGTH OF
  5711      CLAIM-MASTER
  5712       TO DFHEIV11
  5713     MOVE 'ELMSTR' TO DFHEIV1
  5714*    MOVE '&"IL       E          (  N#00005325' TO DFHEIV0
  5715     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5717     MOVE X'204E233030303035333235' TO DFHEIV0(25:11)
  5718     CALL 'kxdfhei1' USING DFHEIV0,
  5719           DFHEIV1,
  5720           CLAIM-MASTER,
  5721           DFHEIV11,
  5722           WS-ELMSTR-KEY,
  5723           DFHEIV99,
  5724           DFHEIV99,
  5725           DFHEIV99
  5726     MOVE EIBRESP  TO WS-RESPONSE
  5727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5728        IF RESP-NORMAL
  5729           MOVE CL-INCURRED-DT   TO WS-INC-DT (S1)
  5730           MOVE CL-PAID-THRU-DT  TO WS-PD-THRU-DT (S1)
  5731           MOVE CL-CLAIM-STATUS  TO WS-STATUS (S1)
  5732           IF CL-CRITICAL-PERIOD NOT NUMERIC
  5733              MOVE ZEROS TO CL-CRITICAL-PERIOD
  5734           END-IF
  5735           MOVE CL-CRITICAL-PERIOD
  5736                                 TO WS-MAX-BENS (S1)
  5737           IF CL-CRITICAL-PERIOD = ZEROS
  5738              IF CL-CLAIM-TYPE = 'L' OR 'P'
  5739                 MOVE 01         TO WS-MAX-BENS (S1)
  5740              ELSE
  5741                 MOVE CM-AH-ORIG-TERM
  5742                                 TO WS-MAX-BENS (S1)
  5743              END-IF
  5744           END-IF
  5745           IF CL-DENIAL-TYPE = '1' OR '2' OR '3' OR '4'
  5746              MOVE 'D'           TO WS-STATUS (S1)
  5747           END-IF
  5748           IF CS-CLAIM-NO (S1) = BL-CLAIM-NO
  5749              MOVE CL-ACCIDENT-CLAIM-SW TO OUT-ACC-SW
  5750           END-IF
  5751
  5752           MOVE ' '                    TO WS-PDEF-RECORD-SW
  5753           IF (AM-DCC-PRODUCT-CODE NOT = SPACES)
  5754              PERFORM 1850-GET-DDF-LIMITS
  5755                                 THRU 1850-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 101
* NSRLTRBL.cbl
  5756           END-IF
  5757           IF PDEF-FOUND
  5758              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5759                 (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  5760                 OR (P1 > +8)
  5761              END-PERFORM
  5762              IF P1 < +9
  5763                 IF CL-CLAIM-TYPE = 'L' OR 'P'
  5764                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5765                       AND (PD-MAX-AMT (P1) < CM-LF-BENEFIT-AMT)
  5766                       MOVE PD-MAX-AMT (P1)
  5767                                 TO WS-MAX-MOBEN (S1)
  5768                    ELSE
  5769                       MOVE CM-LF-BENEFIT-AMT
  5770                                 TO WS-MAX-MOBEN (S1)
  5771                    END-IF
  5772                 ELSE
  5773                    IF PD-BEN-PCT (P1) NOT NUMERIC
  5774                       MOVE ZEROS   TO PD-BEN-PCT (P1)
  5775                    END-IF
  5776                    IF PD-BEN-PCT (P1) = ZEROS
  5777                       MOVE +1      TO WS-WORK-BEN-PCT
  5778                    ELSE
  5779                       MOVE PD-BEN-PCT (P1)
  5780                                    TO WS-WORK-BEN-PCT
  5781                    END-IF
  5782                    COMPUTE WS-MAX-MOBEN (S1) =
  5783                       CM-AH-BENEFIT-AMT * WS-WORK-BEN-PCT
  5784                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5785                       AND (PD-MAX-AMT (P1) < WS-MAX-MOBEN (S1))
  5786                       MOVE PD-MAX-AMT (P1)
  5787                                 TO WS-MAX-MOBEN (S1)
  5788                    END-IF
  5789                 END-IF
  5790*                IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5791*                   AND (PD-MAX-AMT (P1) < CM-AH-BENEFIT-AMT)
  5792*                   MOVE PD-MAX-AMT (P1) TO WS-MAX-MOBEN (S1)
  5793*                ELSE
  5794*                   MOVE CM-AH-BENEFIT-AMT TO WS-MAX-MOBEN (S1)
  5795*                END-IF
  5796                 MOVE PD-EXCLUSION-PERIOD-DAYS (P1)
  5797                                 TO WS-EXCL-PER (S1)
  5798                 MOVE PD-COVERAGE-ENDS-MOS (P1)
  5799                                 TO WS-COV-ENDS (S1)
  5800                 MOVE PD-ACCIDENT-ONLY-MOS (P1)
  5801                                 TO WS-ACC-PER (S1)
  5802                 MOVE PD-MAX-EXTENSION (P1)
  5803                                 TO WS-MAX-EXTEN (S1)
  5804                 EVALUATE TRUE
  5805                    WHEN PD-RECURRING-YN (P1) = 'N'
  5806                       MOVE 00   TO WS-REC-MOS (S1)
  5807                    WHEN PD-RECURRING-YN (P1) = 'Y'
  5808                       MOVE 99   TO WS-REC-MOS (S1)
  5809                    WHEN PD-REC-CRIT-PERIOD (P1) NUMERIC
  5810                       MOVE PD-REC-CRIT-PERIOD (P1)
  5811                                 TO WS-REC-MOS (S1)
  5812                    WHEN OTHER
  5813                       MOVE ZEROS TO WS-REC-MOS (S1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 102
* NSRLTRBL.cbl
  5814                 END-EVALUATE
  5815                 IF WS-REC-MOS (S1) = ZEROS
  5816                    MOVE 01      TO WS-REC-MOS (S1)
  5817                 END-IF
  5818                 DISPLAY ' NSRLTRBL- PDEF FOUND ' WS-EXCL-PER (S1)
  5819              END-IF
  5820           ELSE
  5821              IF CL-CLAIM-TYPE NOT = 'L' AND 'P'
  5822                 MOVE CM-AH-BENEFIT-AMT
  5823                                 TO WS-MAX-MOBEN (S1)
  5824              ELSE
  5825                 MOVE ZEROS      TO WS-MAX-MOBEN (S1)
  5826              END-IF
  5827              MOVE ZEROS         TO WS-EXCL-PER (S1)
  5828                                    WS-MAX-EXTEN (S1)
  5829                                    WS-ACC-PER  (S1)
  5830              MOVE 999           TO WS-COV-ENDS (S1)
  5831              MOVE 01            TO WS-REC-MOS  (S1)
  5832           END-IF
  5833        END-IF
  5834     END-PERFORM
  5835
  5836*      SORT THE TABLE
  5837     MOVE HIGH-VALUES            TO WS-KEY (S1)
  5838     COMPUTE WS-MAX-SUB = S1 - +1
  5839     DISPLAY ' NSRLTRBL- JUST BUILT TABLE '   WS-MAX-SUB
  5840
  5841     MOVE WS-MAX-SUB             TO WS-CNTR
  5842
  5843     MOVE +1                     TO S2
  5844     MOVE +0                     TO S3
  5845     PERFORM UNTIL (WS-CNTR = ZERO) OR (S3 > 700)
  5846        MOVE +0 TO WS-HOLD-S1
  5847        MOVE HIGH-VALUES TO WS-HOLD-KEY
  5848        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5849           (S1 > WS-MAX-SUB)
  5850           IF (WS-SORTED-SW (S1) NOT = 'Y')
  5851              AND (WS-KEY (S1) <= WS-HOLD-KEY)
  5852              MOVE WS-KEY (S1)   TO WS-HOLD-KEY
  5853              MOVE S1            TO WS-HOLD-S1
  5854           END-IF
  5855        END-PERFORM
  5856        IF WS-HOLD-S1 NOT = ZEROS
  5857           MOVE WS-HOLD-S1         TO S1
  5858           MOVE WS-KEY        (S1) TO WS-SRTD-KEY        (S2)
  5859           MOVE WS-STATUS     (S1) TO WS-SRTD-STATUS     (S2)
  5860           MOVE WS-MAX-BENS   (S1) TO WS-SRTD-MAX-BENS   (S2)
  5861           MOVE WS-EXCL-PER   (S1) TO WS-SRTD-EXCL-PER   (S2)
  5862           MOVE WS-COV-ENDS   (S1) TO WS-SRTD-COV-ENDS   (S2)
  5863           MOVE WS-ACC-PER    (S1) TO WS-SRTD-ACC-PER    (S2)
  5864           MOVE WS-REC-MOS    (S1) TO WS-SRTD-REC-MOS    (S2)
  5865           MOVE WS-MAX-EXTEN  (S1) TO WS-SRTD-MAX-EXTEN  (S2)
  5866           MOVE WS-PD-THRU-DT (S1) TO WS-SRTD-PD-THRU-DT (S2)
  5867           MOVE WS-CLAIM-NO   (S1) TO WS-SRTD-CLAIM-NO   (S2)
  5868           MOVE WS-MAX-MOBEN  (S1) TO WS-SRTD-MAX-MOBEN  (S2)
  5869           MOVE WS-TOTAL-PAID (S1) TO WS-SRTD-TOTAL-PAID (S2)
  5870*          MOVE WS-REM-BENS   (S1) TO WS-SRTD-REM-BENS   (S2)
  5871           MOVE 'Y'                TO WS-SORTED-SW       (S1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 103
* NSRLTRBL.cbl
  5872           SUBTRACT 1 FROM WS-CNTR
  5873           ADD +1 TO S2
  5874        END-IF
  5875        ADD 1 TO S3
  5876     END-PERFORM
  5877
  5878     DISPLAY ' NSRLTRBL- JUST SORTED TABLE '
  5879
  5880***  -----------------------
  5881     IF BL-COMP-ID NOT = 'DCC' AND 'VPP'
  5882        PERFORM 1900-BUILD-NON-DCC
  5883        GO TO 1800-EXIT
  5884     END-IF
  5885
  5886     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  5887                                    WS-PREV-INS-TYPE
  5888     MOVE ZEROS                  TO WS-PREV-BEN-PER
  5889                                    WS-ACCUM-DAYS
  5890                                    WS-ACCUM-AMT
  5891                                    WS-ACCUM-PD-BENS
  5892
  5893     MOVE +1                     TO M1
  5894     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5895        S1 > WS-MAX-SUB
  5896        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5897           AND (WS-SRTD-BEN-PER (S1) = WS-PREV-BEN-PER)
  5898           AND (WS-SRTD-INS-TYPE (S1) NOT = WS-PREV-INS-TYPE)
  5899           MOVE ZEROS            TO WS-ACCUM-DAYS
  5900                                    WS-ACCUM-AMT
  5901                                    WS-ACCUM-PD-BENS
  5902        END-IF
  5903        MOVE WS-SRTD-INS-TYPE (S1) TO WS-PREV-INS-TYPE
  5904        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5905           AND (WS-SRTD-BEN-PER (S1) NOT = WS-PREV-BEN-PER)
  5906           MOVE ZEROS            TO WS-ACCUM-DAYS
  5907                                    WS-ACCUM-AMT
  5908                                    WS-ACCUM-PD-BENS
  5909        END-IF
  5910        MOVE WS-SRTD-BEN-PER (S1) TO WS-PREV-BEN-PER
  5911        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  5912           PERFORM 1810-SET-NEW-HEAD
  5913                                 THRU 1810-EXIT
  5914           MOVE WS-SRTD-CLM-TYPE (S1)
  5915                                 TO WS-PREV-CLM-TYPE
  5916           ADD +1                TO M1
  5917        END-IF
  5918
  5919        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  5920        IF WS-SRTD-INS-TYPE (S1) = '1'
  5921           MOVE 'PRIM'             TO OUT-INS-TYP
  5922        ELSE
  5923           MOVE 'COBO'             TO OUT-INS-TYP
  5924        END-IF
  5925*       EVALUATE WS-SRTD-STATUS (S1)
  5926*          WHEN 'C'
  5927*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  5928*          WHEN 'D'
  5929*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 104
* NSRLTRBL.cbl
  5930*          WHEN 'O'
  5931*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  5932*          WHEN OTHER
  5933*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  5934*       END-EVALUATE
  5935*       MOVE WS-SRTD-CLAIM-NO (S1) TO WSM-CLAIM-NO (M1)
  5936*                                     PI-WSM-CLAIM-NOS (S1)
  5937*       MOVE WS-SRTD-TOTAL-PAID (S1) TO WSM-TOTAL-PAID (M1)
  5938
  5939        COMPUTE OUT-MAX-BENS =
  5940           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  5941
  5942        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  5943           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  5944
  5945        MOVE ZEROS TO WK1 WK2
  5946        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  5947           COMPUTE WS-PD-BENS ROUNDED =
  5948              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  5949           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  5950              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  5951                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  5952                 REMAINDER WK2
  5953           END-IF
  5954        ELSE
  5955           MOVE ZEROS            TO WS-PD-BENS
  5956        END-IF
  5957        IF (WS-PD-BENS = ZEROS)
  5958           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  5959           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  5960           MOVE 1                TO WS-PD-BENS
  5961        END-IF
  5962        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  5963*       if wk2 not = zeros
  5964*          move '*'              to wsm-part (m1)
  5965*       end-if
  5966*       compute ws-accum-days =
  5967*          ws-accum-days + ws-srtd-days-paid (s1)
  5968        COMPUTE WS-ACCUM-AMT =
  5969           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  5970        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  5971           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  5972        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  5973           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  5974              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  5975        ELSE
  5976           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  5977        END-IF
  5978        IF (WS-ACCUM-PD-BENS = ZEROS)
  5979           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  5980           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  5981           MOVE 1                TO WS-ACCUM-PD-BENS
  5982        END-IF
  5983        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  5984           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  5985        COMPUTE OUT-REM-BENS =
  5986           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  5987        PERFORM 1820-FIND-QUALIFY THRU 1820-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 105
* NSRLTRBL.cbl
  5988
  5989*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  5990*       MOVE ' '                    TO DC-OPTION-CODE
  5991*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5992*       IF NO-CONVERSION-ERROR
  5993*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  5994*       ELSE
  5995*          MOVE SPACES              TO wsm-inc-date (m1)
  5996*       END-IF
  5997*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  5998*       MOVE ' '                     TO DC-OPTION-CODE
  5999*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6000*       IF NO-CONVERSION-ERROR
  6001*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6002*       ELSE
  6003*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6004*       END-IF
  6005        ADD +1                   TO M1
  6006        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6007           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6008           MOVE 26 TO S1
  6009        END-IF
  6010
  6011     END-PERFORM
  6012
  6013    DISPLAY ' NSRLTRBL- 1800 end MAX BENS '  OUT-MAX-BENS
  6014    display  ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6015    display  ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6016    display  ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6017    display  ' ACC SW ' OUT-ACC-SW
  6018
  6019     .
  6020 1800-EXIT.
  6021     EXIT.
  6022
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 106
* NSRLTRBL.cbl
  6024
  6025 1810-SET-NEW-HEAD.
  6026     MOVE ZEROS                  TO WS-ACCUM-DAYS
  6027                                    WS-ACCUM-AMT
  6028                                    WS-ACCUM-PD-BENS
  6029     EVALUATE WS-SRTD-CLM-TYPE (S1)
  6030        WHEN 'A'
  6031           MOVE 'A&H'            TO WS-COV-TYPE
  6032        WHEN 'F'
  6033           MOVE 'FAM '           TO WS-COV-TYPE
  6034        WHEN 'I'
  6035           MOVE ' IU '           TO WS-COV-TYPE
  6036        WHEN 'L'
  6037           MOVE 'LIFE'           TO WS-COV-TYPE
  6038        WHEN OTHER
  6039           MOVE WS-SRTD-CLM-TYPE (S1)
  6040                                 TO WS-COV-TYPE
  6041     END-EVALUATE
  6042
  6043     MOVE WS-SRTD-REC-MOS (S1) TO OUT-REC-MOS
  6044     MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6045
  6046*    string '  ' ws-cov-type ' ExPer ' OUT-EXCL-PER
  6047*       ' CovEnd ' ws-srtd-cov-ends (s1)
  6048*       ' MaxBens ' ws-srtd-max-bens (s1)
  6049*       ' Recurring ' OUT-REC-MOS
  6050*       delimited by size into ws-map-output (m1)
  6051*    end-string
  6052
  6053     .
  6054 1810-EXIT.
  6055     EXIT.
  6056
  6057 1820-FIND-QUALIFY.
  6058     IF NOT PDEF-FOUND
  6059        GO TO 1820-EXIT
  6060     END-IF
  6061
  6062     DISPLAY ' NSRLTRBL- MAX BENS 2 ' OUT-MAX-BENS ' '
  6063        WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6064
  6065     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  6066     MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-2
  6067     MOVE '1'                    TO DC-OPTION-CODE
  6068     MOVE +0                     TO DC-ELAPSED-MONTHS
  6069                                    DC-ELAPSED-DAYS
  6070     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6071
  6072     IF NO-CONVERSION-ERROR
  6073        DISPLAY ' NSRLTRBL- GOOD DATE CONVERT '
  6074        MOVE DC-ELAPSED-MONTHS   TO WS-MONTHS-BETWEEN
  6075        IF DC-ELAPSED-DAYS > 1
  6076           ADD 1 TO WS-MONTHS-BETWEEN
  6077        END-IF
  6078     ELSE
  6079        MOVE ZEROS               TO WS-MONTHS-BETWEEN
  6080     END-IF
  6081
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 107
* NSRLTRBL.cbl
  6082     DISPLAY ' NSRLTRBL- DISPLAY 3 ' OUT-EXCL-PER
  6083        ' ' WS-SRTD-COV-ENDS (S1) ' ' WS-MONTHS-BETWEEN
  6084
  6085     EVALUATE TRUE
  6086        WHEN (OUT-EXCL-PER NOT = ZEROS)
  6087           AND (WS-MONTHS-BETWEEN <= OUT-EXCL-PER)
  6088           DISPLAY ' NSRLTRBL- ZERO 1 '
  6089           MOVE ZEROS TO OUT-MAX-BENS
  6090                         OUT-REM-BENS
  6091        WHEN (WS-SRTD-COV-ENDS (S1) NOT = ZEROS)
  6092           AND (WS-MONTHS-BETWEEN > WS-SRTD-COV-ENDS (S1))
  6093           DISPLAY ' NSRLTRBL- ZERO 2 '
  6094           MOVE ZEROS TO OUT-MAX-BENS
  6095     END-EVALUATE
  6096     IF OUT-REC-MOS < WS-SRTD-BEN-PER (S1)
  6097        MOVE ZEROS               TO OUT-REM-BENS
  6098     END-IF
  6099
  6100     .
  6101 1820-EXIT.
  6102     EXIT.
  6103
  6104 1850-GET-DDF-LIMITS.
  6105
  6106     IF CM-CLP-STATE = SPACES OR LOW-VALUES OR ZEROS
  6107        MOVE CM-STATE            TO CM-CLP-STATE
  6108     END-IF
  6109
  6110     MOVE CL-COMPANY-CD          TO ERPDEF-KEY
  6111     MOVE CM-CLP-STATE           TO ERPDEF-STATE
  6112     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6113
  6114     IF (CL-CLAIM-TYPE = 'L' OR 'P')
  6115        AND (CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD')
  6116        MOVE 'L'                 TO ERPDEF-BEN-TYPE
  6117        MOVE CM-LF-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6118     ELSE
  6119        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  6120        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6121     END-IF
  6122
  6123     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6124
  6125     DISPLAY ' NSRLTRBL- MADE 1850 ' ERPDEF-KEY (2:15)
  6126     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6127
  6128
  6129* EXEC CICS STARTBR
  6130*        DATASET  ('ERPDEF')
  6131*        RIDFLD   (ERPDEF-KEY)
  6132*        GTEQ
  6133*        RESP     (WS-RESPONSE)
  6134*    END-EXEC
  6135     MOVE 'ERPDEF' TO DFHEIV1
  6136     MOVE 0
  6137       TO DFHEIV11
  6138*    MOVE '&,         G          &  N#00005731' TO DFHEIV0
  6139     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 108
* NSRLTRBL.cbl
  6140     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6141     MOVE X'204E233030303035373331' TO DFHEIV0(25:11)
  6142     CALL 'kxdfhei1' USING DFHEIV0,
  6143           DFHEIV1,
  6144           ERPDEF-KEY,
  6145           DFHEIV99,
  6146           DFHEIV11,
  6147           DFHEIV99
  6148     MOVE EIBRESP  TO WS-RESPONSE
  6149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6150
  6151     IF NOT RESP-NORMAL
  6152        GO TO 1850-EXIT
  6153     END-IF
  6154
  6155     .
  6156 1850-READNEXT.
  6157
  6158
  6159* EXEC CICS READNEXT
  6160*       DATASET  ('ERPDEF')
  6161*       INTO     (PRODUCT-MASTER)
  6162*       RIDFLD   (ERPDEF-KEY)
  6163*       RESP     (WS-RESPONSE)
  6164*    END-EXEC
  6165     MOVE LENGTH OF
  6166      PRODUCT-MASTER
  6167       TO DFHEIV12
  6168     MOVE 'ERPDEF' TO DFHEIV1
  6169     MOVE 0
  6170       TO DFHEIV11
  6171*    MOVE '&.IL                  )  N#00005745' TO DFHEIV0
  6172     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6173     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6174     MOVE X'204E233030303035373435' TO DFHEIV0(25:11)
  6175     CALL 'kxdfhei1' USING DFHEIV0,
  6176           DFHEIV1,
  6177           PRODUCT-MASTER,
  6178           DFHEIV12,
  6179           ERPDEF-KEY,
  6180           DFHEIV99,
  6181           DFHEIV11,
  6182           DFHEIV99,
  6183           DFHEIV99
  6184     MOVE EIBRESP  TO WS-RESPONSE
  6185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6186
  6187     IF NOT RESP-NORMAL
  6188        GO TO 1850-ENDBR
  6189     END-IF
  6190
  6191     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6192        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6193           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6194           DISPLAY ' NSRLTRBL- SETTING PDEF FOUND TO TRUE '
  6195        ELSE
  6196           GO TO 1850-READNEXT
  6197        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 109
* NSRLTRBL.cbl
  6198     ELSE
  6199        GO TO 1850-ENDBR
  6200     END-IF
  6201
  6202     .
  6203 1850-ENDBR.
  6204
  6205
  6206* EXEC CICS ENDBR
  6207*       DATASET  ('ERPDEF')
  6208*    END-EXEC
  6209     MOVE 'ERPDEF' TO DFHEIV1
  6210     MOVE 0
  6211       TO DFHEIV11
  6212*    MOVE '&2                    $   #00005770' TO DFHEIV0
  6213     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6214     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6215     MOVE X'2020233030303035373730' TO DFHEIV0(25:11)
  6216     CALL 'kxdfhei1' USING DFHEIV0,
  6217           DFHEIV1,
  6218           DFHEIV11,
  6219           DFHEIV99
  6220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6221
  6222     .
  6223 1850-EXIT.
  6224     EXIT.
  6225
  6226 1900-BUILD-NON-DCC.
  6227
  6228     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  6229                                    WS-PREV-INS-TYPE
  6230     MOVE ZEROS                  TO WS-PREV-BEN-PER
  6231                                    WS-ACCUM-DAYS
  6232                                    WS-ACCUM-AMT
  6233                                    WS-ACCUM-PD-BENS
  6234
  6235     MOVE +1                     TO M1
  6236     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6237        S1 > WS-MAX-SUB
  6238        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  6239           PERFORM 1810-SET-NEW-HEAD
  6240                                 THRU 1810-EXIT
  6241           MOVE WS-SRTD-CLM-TYPE (S1)
  6242                                 TO WS-PREV-CLM-TYPE
  6243           ADD +1                TO M1
  6244        END-IF
  6245        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  6246        IF WS-SRTD-INS-TYPE (S1) = '1'
  6247           MOVE 'PRIM'             TO OUT-INS-TYP
  6248        ELSE
  6249           MOVE 'COBO'             TO OUT-INS-TYP
  6250        END-IF
  6251*       evaluate ws-srtd-status (s1)
  6252*          when 'C'
  6253*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  6254*          WHEN 'D'
  6255*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 110
* NSRLTRBL.cbl
  6256*          WHEN 'O'
  6257*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  6258*          WHEN OTHER
  6259*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  6260*       END-EVALUATE
  6261*       move ws-srtd-claim-no (s1) to wsm-claim-no (m1)
  6262*                                     pi-wsm-claim-nos (s1)
  6263*       move ws-srtd-total-paid (s1) to wsm-total-paid (m1)
  6264
  6265        COMPUTE OUT-MAX-BENS =
  6266           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6267
  6268        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  6269           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6270
  6271        MOVE ZEROS TO WK1 WK2
  6272        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6273           COMPUTE WS-PD-BENS ROUNDED =
  6274              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6275           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6276              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6277                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6278                 REMAINDER WK2
  6279           END-IF
  6280        ELSE
  6281           MOVE ZEROS            TO WS-PD-BENS
  6282        END-IF
  6283        IF (WS-PD-BENS = ZEROS)
  6284           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6285           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6286           MOVE 1                TO WS-PD-BENS
  6287        END-IF
  6288        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6289*       IF WK2 NOT = ZEROS
  6290*          MOVE '*'              TO WSM-PART (M1)
  6291*       END-IF
  6292        COMPUTE WS-ACCUM-AMT =
  6293           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6294        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6295           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6296        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6297           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6298              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6299        ELSE
  6300           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6301        END-IF
  6302        IF (WS-ACCUM-PD-BENS = ZEROS)
  6303           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6304           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6305           MOVE 1                TO WS-ACCUM-PD-BENS
  6306        END-IF
  6307        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6308           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6309        COMPUTE OUT-REM-BENS =
  6310           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6311
  6312*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6313*       MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 111
* NSRLTRBL.cbl
  6314*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6315*       IF NO-CONVERSION-ERROR
  6316*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6317*       ELSE
  6318*          MOVE SPACES              TO wsm-inc-date (m1)
  6319*       END-IF
  6320*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6321*       MOVE ' '                     TO DC-OPTION-CODE
  6322*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6323*       IF NO-CONVERSION-ERROR
  6324*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6325*       ELSE
  6326*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6327*       END-IF
  6328*       move WS-MAP-OUTPUT (m1)  to replineo (m1)
  6329        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6330           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6331           MOVE 26 TO S1
  6332        END-IF
  6333
  6334        ADD +1                   TO M1
  6335     END-PERFORM
  6336     DISPLAY ' NSRLTRBL- 1900 end MAX BENS '  OUT-MAX-BENS
  6337     display ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6338     display ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6339     display ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6340     display ' ACC SW ' OUT-ACC-SW
  6341     .
  6342 2000-BUILD-ELNAPS.
  6343     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6344     MOVE 'NA'                   TO NAPERSOFT-FILE
  6345     MOVE CL-COMPANY-CD          TO NA-COMPANY-CD
  6346     MOVE BL-CARRIER             TO NA-CARRIER
  6347     MOVE BL-CLAIM-NO            TO NA-CLAIM-NO
  6348     MOVE BL-CERT-NO             TO NA-CERT-NO
  6349     MOVE WS-ARCHIVE-NO          TO NA-ARCHIVE-NO
  6350                                    BL-ARCHIVE-NO
  6351     MOVE BL-LETTER-ID           TO NA-LETTER-ID
  6352     MOVE BL-NO-OF-COPIES        TO NA-NO-OF-COPIES
  6353     MOVE SAVE-BIN-DATE          TO NA-CREATION-DT
  6354                                    NA-INITIAL-PRINT-DT
  6355     MOVE LOW-VALUES             TO NA-FOLLOW-UP-DT
  6356                                    NA-RESEND-DT
  6357                                    NA-RESEND-PRINT-DT
  6358                                    NA-1ST-LTR-PRINT-DT
  6359                                    NA-NEXT-DUE-DT
  6360                                    NA-AUTOPYDT
  6361     MOVE CL-TRAILER-SEQ-CNT     TO NA-CORR-TRLR-SEQ
  6362     IF BL-FOLLOW-UP-DT NOT = SPACES AND LOW-VALUES
  6363        STRING BL-FOLLOW-UP-DT (7:2) BL-FOLLOW-UP-DT (1:2)
  6364           BL-FOLLOW-UP-DT (4:2) DELIMITED BY SIZE
  6365             INTO DC-GREG-DATE-1-YMD-R
  6366        END-STRING
  6367        MOVE '3'                 TO DC-OPTION-CODE
  6368        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6369        IF NO-CONVERSION-ERROR
  6370           MOVE DC-BIN-DATE-1    TO NA-FOLLOW-UP-DT
  6371                                    WS-FOLLOW-UP-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 112
* NSRLTRBL.cbl
  6372        ELSE
  6373           MOVE LOW-VALUES       TO NA-FOLLOW-UP-DT
  6374                                    WS-FOLLOW-UP-DT
  6375        END-IF
  6376     END-IF
  6377     IF BL-RESEND-DT NOT = SPACES AND LOW-VALUES
  6378        STRING BL-RESEND-DT (7:2) BL-RESEND-DT (1:2)
  6379           BL-RESEND-DT (4:2) DELIMITED BY SIZE
  6380             INTO DC-GREG-DATE-1-YMD-R
  6381        END-STRING
  6382        MOVE '3'                 TO DC-OPTION-CODE
  6383        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6384        IF NO-CONVERSION-ERROR
  6385           MOVE DC-BIN-DATE-1    TO NA-RESEND-DT
  6386                                    WS-RESEND-DT
  6387        ELSE
  6388           MOVE LOW-VALUES       TO NA-RESEND-DT
  6389                                    WS-RESEND-DT
  6390        END-IF
  6391     END-IF
  6392     PERFORM WITH TEST AFTER UNTIL RESP-NORMAL
  6393
  6394* EXEC CICS WRITE
  6395*          DATASET   ('ELNAPS')
  6396*          FROM      (NAPERSOFT-FILE)
  6397*          RIDFLD    (NA-CONTROL-PRIMARY)
  6398*          RESP      (WS-RESPONSE)
  6399*       END-EXEC
  6400     MOVE LENGTH OF
  6401      NAPERSOFT-FILE
  6402       TO DFHEIV11
  6403     MOVE 'ELNAPS' TO DFHEIV1
  6404*    MOVE '&$ L                  ''  N#00005945' TO DFHEIV0
  6405     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6406     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6407     MOVE X'204E233030303035393435' TO DFHEIV0(25:11)
  6408     CALL 'kxdfhei1' USING DFHEIV0,
  6409           DFHEIV1,
  6410           NAPERSOFT-FILE,
  6411           DFHEIV11,
  6412           NA-CONTROL-PRIMARY,
  6413           DFHEIV99,
  6414           DFHEIV99
  6415     MOVE EIBRESP  TO WS-RESPONSE
  6416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6417        IF RESP-NORMAL
  6418           CONTINUE
  6419        ELSE
  6420           IF RESP-DUPREC OR RESP-DUPKEY
  6421              ADD +1 TO NA-ARCHIVE-NO
  6422           ELSE
  6423              DISPLAY ' BAD WRITE ELNAPS ' WS-RESPONSE
  6424                 ' ' NA-CONTROL-PRIMARY (2:19)
  6425              SET RESP-NORMAL TO TRUE
  6426           END-IF
  6427        END-IF
  6428     END-PERFORM
  6429    .
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:45 Page 113
* NSRLTRBL.cbl
  6430 2000-EXIT.
  6431     EXIT.
  6432 9700-DATE-LINK.
  6433
  6434* EXEC CICS LINK
  6435*        PROGRAM   ('ELDATCV')
  6436*        COMMAREA  (DATE-CONVERSION-DATA)
  6437*        LENGTH    (DC-COMM-LENGTH)
  6438*    END-EXEC.
  6439     MOVE 'ELDATCV' TO DFHEIV1
  6440*    MOVE '."C                   (   #00005967' TO DFHEIV0
  6441     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6443     MOVE X'2020233030303035393637' TO DFHEIV0(25:11)
  6444     CALL 'kxdfhei1' USING DFHEIV0,
  6445           DFHEIV1,
  6446           DATE-CONVERSION-DATA,
  6447           DC-COMM-LENGTH,
  6448           DFHEIV99,
  6449           DFHEIV99,
  6450           DFHEIV99,
  6451           DFHEIV99
  6452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6453
  6454 9700-EXIT.
  6455      EXIT.
  6456
  6457 9999-DFHBACK SECTION.
  6458     MOVE '9%                    "   ' TO DFHEIV0
  6459     MOVE 'NSRLTRBL' TO DFHEIV1
  6460     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6461     GOBACK.
  6462 9999-DFHEXIT.
  6463     IF DFHEIGDJ EQUAL 0001
  6464         NEXT SENTENCE.
  6465     MOVE '9%                    "   ' TO DFHEIV0
  6466     MOVE 'NSRLTRBL' TO DFHEIV1
  6467     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6468     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19080     Code:       16248
