* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 020317  IR2016110900001  PEMA  FIXED MISC PROBLEMS
    37* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    38* 111418  CR2018103100001  PEMA  ADD REISSUE CAPABILITY
    39* 040919  CR2019040900001  PEMA  FIX RETURN TO ON REISSUES
    40* 111219  CR2019110700001  PEMA  ALLOW REVERSAL OF VOID ON SAME DA
    41******************************************************************
    42 ENVIRONMENT DIVISION.
    43
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    50 77  s1                          pic s999 comp-3 value +0.
    51 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    53 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    54 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    55 77  ws-pyaj-browse-sw           pic x value spaces.
    56     88  pyaj-browse-started        value 'Y'.
    57 77  ws-browse-sw                pic x value spaces.
    58     88  i-say-when                 value 'Y'.
    59 77  ws-delete-sw                pic x value ' '.
    60     88  row-deleted                 value 'Y'.
    61 77  ws-sql-code                 pic s9(7) value zeros.
    62 77  ws-dis-sql-code             pic -9999999 value zeros.
    63 77  ws-match-sw                 pic x  value ' '.
    64     88  found-a-match             value 'Y'.
    65 77  ws-commit-sw                pic x value ' '.
    66     88  tbl-commited                value 'Y'.
    67 01  P pointer.
    68 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    69 01  var-ptr pointer.
    70 01  env-var-len                 pic 9(4)  binary.
    71
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   3
* EL677.cbl
    72 01  WS-KIXSYS.
    73     05  WS-KIX-FIL1             PIC X(10).
    74     05  WS-KIX-APPS             PIC X(10).
    75     05  WS-KIX-ENV              PIC X(10).
    76     05  WS-KIX-MYENV            PIC X(10).
    77     05  WS-KIX-SYS              PIC X(10).
*   78 EXEC SQL
*   79    INCLUDE SQLDA
*   80 END-EXEC
    81 01 SQLDA sync.
    82    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    83    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    84    05 SQLN                  PIC S9(4) COMP-5 value 0.
    85    05 SQLD                  PIC S9(4) COMP-5 value 0.
    86    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    87       10 SQLTYPE            PIC S9(4) COMP-5.
    88       10 SQLLEN             PIC S9(4) COMP-5.
    89$IF P64 SET
    90X      *> For 64-bit environments, ensure that SQLDATA is
    91X      *> aligned on an 8-byte boundary.
    92X      10 FILLER             PIC S9(9) COMP-5.
    93$END
    94       10 SQLDATA            USAGE POINTER.
    95       10 SQLIND             USAGE POINTER.
    96       10 SQLNAME.
    97          15 SQLNAMEL        PIC S9(4) COMP-5.
    98          15 SQLNAMEC        PIC X(30).
    99
   100* Values for SQLTYPE
   101
   102 78  ESQL-DATE-CHAR              VALUE 384.
   103 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   104 78  ESQL-DATE-REC               VALUE 386.
   105 78  ESQL-DATE-REC-NULL          VALUE 387.
   106 78  ESQL-TIME-CHAR              VALUE 388.
   107 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   108 78  ESQL-TIME-REC               VALUE 390.
   109 78  ESQL-TIME-REC-NULL          VALUE 391.
   110 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   111 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   112 78  ESQL-TIMESTAMP-REC          VALUE 394.
   113 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   114 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   115 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   116 78  ESQL-TS-OFFSET-REC          VALUE 398.
   117 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   118 78  ESQL-LONGVARBINARY          VALUE 404.
   119 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   120 78  ESQL-LONGVARCHAR            VALUE 408.
   121 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   122 78  ESQL-BINARY                 VALUE 444.
   123 78  ESQL-BINARY-NULL            VALUE 445.
   124 78  ESQL-VARBINARY              VALUE 446.
   125 78  ESQL-VARBINARY-NULL         VALUE 447.
   126 78  ESQL-VARCHAR                VALUE 448.
   127 78  ESQL-VARCHAR-NULL           VALUE 449.
   128
   129 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   131
   132 78  ESQL-CHAR                   VALUE 452.
   133 78  ESQL-CHAR-NULL              VALUE 453.
   134
   135 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   136 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   137
   138 78  ESQL-DOUBLE                 VALUE 480.
   139 78  ESQL-DOUBLE-NULL            VALUE 481.
   140 78  ESQL-REAL                   VALUE 482.
   141 78  ESQL-REAL-NULL              VALUE 483.
   142 78  ESQL-DECIMAL                VALUE 484.
   143 78  ESQL-DECIMAL-NULL           VALUE 485.
   144 78  ESQL-INTEGER                VALUE 496.
   145 78  ESQL-INTEGER-NULL           VALUE 497.
   146 78  ESQL-SMALLINT               VALUE 500.
   147 78  ESQL-SMALLINT-NULL          VALUE 501.
   148 78  ESQL-TINYINT                VALUE 502.
   149 78  ESQL-TINYINT-NULL           VALUE 503.
*  150 EXEC SQL
*  151    INCLUDE SQLCA
*  152 END-EXEC
   153 01 SQLCA.
   154     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   155     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   156     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   157     05  SQLERRM.
   158         49  SQLERRML    PIC S9(4) COMP-5.
   159         49  SQLERRMC    PIC X(70).
   160     05  SQLERRP         PIC X(8).
   161     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   162     05  SQLWARN.
   163         10  SQLWARN0    PIC X.
   164         10  SQLWARN1    PIC X.
   165         10  SQLWARN2    PIC X.
   166         10  SQLWARN3    PIC X.
   167         10  SQLWARN4    PIC X.
   168         10  SQLWARN5    PIC X.
   169         10  SQLWARN6    PIC X.
   170         10  SQLWARN7    PIC X.
   171     05  SQLEXT.
   172         10  SQLWARN8    PIC X.
   173         10  SQLWARN9    PIC X.
   174         10  SQLWARN10   PIC X.
   175         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   176     05  SQLSTATE    PIC X(5).
   177 EXEC SQL
   178    BEGIN DECLARE SECTION
   179 END-EXEC
   180 01  ws-paid-bank-work-area.
   181     05  ws-pb-compid            pic x(9).
   182     05  ws-pb-check-no          pic x(10).
   183     05  ws-pb-bad-check-no      pic x(10).
   184     05  ws-check-amount         pic x(10).
   185 01  Paid-Bank-Info.
   186     05  pb-check-no             pic 9(10).
   187     05  pb-tran-type            pic x.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   5
* EL677.cbl
   188     05  pb-bank-acct-desc       pic x(50).
   189     05  pb-amount               pic x(12).
   190     05  pb-paid-date            pic x(25).
   191 01  ws-key-stuff.
   192     05  ws-compid               pic xxx.
   193     05  ws-carrier              pic x.
   194     05  ws-grouping             pic x(6).
   195     05  ws-state                pic xx.
   196     05  ws-account              pic x(10).
   197     05  ws-eff-date             pic x(10).
   198     05  ws-certificate          pic x(10).
   199     05  ws-cert-sfx             pic x.
   200     05  ws-seq-no               pic 999.
   201     05  ws-type                 pic x.
   202     05  ws-check-sub-type       pic x.
   203 01  svr                         pic x(32).
   204 01  usr                         pic x(32).
   205 01  pass                        pic x(32).
   206 01  usr-pass                    pic x(64).
   207 01  ws-disp-code                pic s9(11).
   208***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   209***                                                            ***
   210***  These indicators are used to determine if a variable      ***
   211***  is passed nulls from sql. The indicator will be -1        ***
   212***  if the value on sql is nulls and +0 if the value is       ***
   213***  something other than nulls. Here is an example on how     ***
   214***  to use the indicator variables.                           ***
   215***                                                            ***
   216***     EXEC SQL                                               ***
   217***        fetch checkapp into                                 ***
   218***           :db-app-status :nu-app-status,                   ***
   219***           :db-app-by     :nu-app-by,                       ***
   220***           :db-app-date   :nu-app-date,                     ***
   221***           :db-app-batch  :nu-app-batch                     ***
   222***     END-EXEC                                               ***
   223***                                                            ***
   224***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   225 01  indicator-vaiables-for-nulls.
   226     05  nu-app-status           pic s9(4) comp value +0.
   227     05  nu-app-by               pic s9(4) comp value +0.
   228     05  nu-app-date             pic s9(4) comp value +0.
   229     05  nu-app-batch            pic s9(4) comp value +0.
   230 01  daily-check-request-rec.
   231     05  db-compid               pic xxx.
   232     05  db-carrier              pic x.
   233     05  db-grouping             pic x(6).
   234     05  db-state                pic xx.
   235     05  db-account              pic x(10).
   236     05  db-effdate              pic x(10).
   237     05  db-certificate          pic x(10).
   238     05  db-cert-sfx             pic x.
   239     05  db-seq-no               pic 999.
   240     05  db-type                 pic x.
   241     05  db-amount-n             pic 9(7).99.
   242     05  db-amount redefines db-amount-n
   243                                 pic x(10).
   244     05  db-checkno              pic x(15).
   245     05  db-checkdate            pic x(10).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   6
* EL677.cbl
   246     05  db-checkstatus          pic 9(5).
   247     05  db-releasebatch         pic 9(5).
   248     05  db-releasedt            pic x(10).
   249     05  db-releaseby            pic x(4).
   250     05  db-payeename1           pic x(30).
   251     05  db-payeename2           pic x(30).
   252     05  db-payeeaddr1           pic x(30).
   253     05  db-payeeaddr2           pic x(30).
   254     05  db-payeecity            pic x(30).
   255     05  db-payeest              pic xx.
   256     05  db-payeezip             pic x(10).
   257     05  db-fincar               pic x.
   258     05  db-fingrp               pic x(6).
   259     05  db-finresp              pic x(10).
   260     05  db-finacct              pic x(10).
   261     05  db-preparer             pic x(4).
   262     05  db-app-status           pic x(9).
   263     05  dp-app-status-n redefines db-app-status
   264                                 pic 9(9).
   265     05  db-app-by               pic x(20).
   266     05  db-app-date             pic x(30).
   267     05  db-app-batch            pic x(10).
   268     05  db-return-to            pic x(30).
   269     05  db-insured-name         pic x(30).
   270     05  db-check-sub-type       pic x.
   271 EXEC SQL
   272    END DECLARE SECTION
   273 END-EXEC
   274*                            COPY ELCSCTM.
   275******************************************************************
   276*                                                                *
   277*                                                                *
   278*                            ELCSCTM                             *
   279*                            VMOD=2.001                          *
   280*                                                                *
   281*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   282*                                                                *
   283******************************************************************
   284 01  SECURITY-MESSAGE.
   285     12  FILLER                          PIC X(30)
   286            VALUE '** LOGIC SECURITY VIOLATION -'.
   287     12  SM-READ                         PIC X(6).
   288     12  FILLER                          PIC X(5)
   289            VALUE ' PGM='.
   290     12  SM-PGM                          PIC X(6).
   291     12  FILLER                          PIC X(5)
   292            VALUE ' OPR='.
   293     12  SM-PROCESSOR-ID                 PIC X(4).
   294     12  FILLER                          PIC X(6)
   295            VALUE ' TERM='.
   296     12  SM-TERMID                       PIC X(4).
   297     12  FILLER                          PIC XX   VALUE SPACE.
   298     12  SM-JUL-DATE                     PIC 9(5).
   299     12  FILLER                          PIC X    VALUE SPACE.
   300     12  SM-TIME                         PIC 99.99.
   301
   302*                            COPY ELCSCRTY.
   303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   7
* EL677.cbl
   304*                                                                *
   305*                                                                *
   306*                            ELCSCRTY                            *
   307*                            VMOD=2.001                          *
   308*                                                                *
   309*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   310*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   311*        SAVED IN PI-SECURITY-ADDRESS.                           *
   312*                                                                *
   313******************************************************************
   314 01  SECURITY-CONTROL.
   315     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   316     12  FILLER                       PIC XX    VALUE 'SC'.
   317     12  SC-CREDIT-CODES.
   318         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   319             20  SC-CREDIT-DISPLAY    PIC X.
   320             20  SC-CREDIT-UPDATE     PIC X.
   321     12  SC-CLAIMS-CODES.
   322         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   323             20  SC-CLAIMS-DISPLAY    PIC X.
   324             20  SC-CLAIMS-UPDATE     PIC X.
   325 01  ws-dummy-erchek             pic x(600).
   326 01  filler.
   327     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   328     05  WS-CHECK-AMT-TMPX REDEFINES
   329         WS-CHECK-AMT-TMP        PIC X(10).
   330 01  ws-compare-erchek-key          pic x(33) value low-values.
   331 01  ws-eracct-sw                   pic x value ' '.
   332     88  eracct-found                 value 'Y'.
   333 01  ws-eracct-start-sw             pic x value ' '.
   334     88  eracct-start                 value 'Y'.
   335 01  WS-MISC-AREA.
   336     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   337     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   338     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   339
   340 01  ws-user-defined.
   341     05  ws-user-reason         pic xxx.
   342     05  ws-user-cert-no        pic x(11).
   343     05  ws-user-name           pic x(28).
   344 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   345 01  STANDARD-AREAS.
   346     12  ws-connect-sw               pic x  value ' '.
   347         88  connected-to-db             value 'Y'.
   348     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   349     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   350     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   351     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   352     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   353     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   354     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   355     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   356     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   357     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   358     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   359     12  TIME-OUT-R  REDEFINES TIME-IN.
   360         16  FILLER                  PIC X.
   361         16  TIME-OUT                PIC 99V99.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   8
* EL677.cbl
   362         16  FILLER                  PIC XX.
   363     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   364     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   365     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   366     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   367     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   368     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   369     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   370     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   371     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   372     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   373     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   374     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   375     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   376     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   377     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   378     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   379     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   380     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   381     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   382     12  QID.
   383         16  QID-TERM                PIC X(4)    VALUE SPACES.
   384         16  FILLER                  PIC X(4)    VALUE '677A'.
   385
   386 01  WORK-AREAS.
   387     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   388     12  WS-AM-WK REDEFINES WS-AM-WORK.
   389         16  WS-AM-NUM               PIC S9(7)V99.
   390         16  WS-AM-SIGN              PIC X.
   391     12  WS-CHECK-WORK.
   392         16  FILLER                  PIC X        VALUE SPACE.
   393         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   394     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   395     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   396     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   397     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   398     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   399     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   400     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   401         WS-DT-DEEDIT-FIELD.
   402         16  FILLER                  PIC X(4).
   403         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   404     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   405     12  WS-DEEDIT-FIELD-V0          REDEFINES
   406         WS-DEEDIT-FIELD-A           PIC S9(15).
   407
   408     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   409     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   410         88 WS-CERT-FOUND                        VALUE 'Y'.
   411         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   412     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   413         88 WS-PNDB-FOUND                        VALUE 'Y'.
   414         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   415     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   416         88  WS-PROCESS-CERT                     VALUE 'Y'.
   417     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   418         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   419     12  WS-TMS-ENTRY-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page   9
* EL677.cbl
   420         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   421         16  FILLER                  PIC XX      VALUE SPACES.
   422         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   423     12  WS-ZIP-CODE.
   424         16  WS-ZIP-PRIME.
   425             20  WS-ZIP-PRI-1ST      PIC X.
   426                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   427             20  FILLER              PIC X(4).
   428         16  WS-ZIP-PLUS4            PIC X(4).
   429     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   430         16  WS-CAN-POST1-1          PIC XXX.
   431         16  WS-CAN-POST1-2.
   432             20  WS-CAN-POST-4TH     PIC X.
   433             20  FILLER              PIC XX.
   434         16  FILLER                  PIC XXX.
   435     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   436         16  WS-CAN-POST2-1          PIC XXX.
   437         16  FILLER                  PIC X.
   438         16  WS-CAN-POST2-2          PIC XXX.
   439         16  FILLER                  PIC XX.
   440
   441*                                    COPY ELCNWA.
   442*****************************************************************
   443*                                                               *
   444*                                                               *
   445*                            ELCNWA.                            *
   446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   447*                            VMOD=2.003                         *
   448*                                                               *
   449*            M O V E   N A M E   W O R K   A R E A.             *
   450*                                                               *
   451*****************************************************************.
   452
   453 01  WS-NAME-WORK-AREA.
   454     05  WS-INSURED-LAST-NAME        PIC X(15).
   455     05  WS-INSURED-1ST-NAME         PIC X(12).
   456     05  WS-INSURED-MID-INIT         PIC X.
   457
   458     05  WS-NAME-WORK.
   459         10  WS-NW                   PIC X
   460             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   461
   462     05  WS-NAME-WORK2.
   463         10  WS-NW2                  PIC X
   464             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   465                                        NWA-INDEX0.
   466
   467     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   468                                     COMP-3.
   469
   470 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   471     88  RESP-NORMAL                    VALUE +0.
   472     88  resp-file-notfnd               value +12.
   473     88  RESP-NOTFND                    VALUE +13.
   474     88  resp-duprec                    value +14.
   475     88  resp-dupkey                    value +15.
   476     88  resp-invreq                    value +16.
   477     88  RESP-NOTOPEN                   VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  10
* EL677.cbl
   478     88  RESP-ENDFILE                   VALUE +20.
   479     88  resp-lengtherr                 value +22.
   480 01  ACCESS-KEYS.
   481     12  ELCNTL-KEY.
   482         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   483         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   484         16 ELCNTL-ACCESS.
   485             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   486             20  FILLER              PIC X       VALUE SPACES.
   487             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   488         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   489
   490     12  ERACCT-KEY.
   491         16  ERACCT-CO               PIC X       VALUE SPACES.
   492         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   493         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   494         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   495         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   496         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   497         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   498
   499     12  SAVE-ERACCT-KEY.
   500         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   501         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   502         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   503         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   504         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   505         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   506         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   507
   508     12  ERCOMP-KEY.
   509         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   510         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   511         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   512         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   513         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   514         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   515
   516     12  ELCERT-KEY.
   517         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   518         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   519         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   520         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   521         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   522         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   523         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   524         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   525
   526     12  ERPNDB-PRIMARY-KEY.
   527         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   528         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   529         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   530         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   531
   532     12  ERPNDB-ALT-KEY.
   533         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   534         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   535         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  11
* EL677.cbl
   536         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   537         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   538         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   539         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   540         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   541         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   542         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   543
   544     12  ERCHEK-KEY.
   545         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   546         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   547         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   548         16  CHEK-STATE              PIC XX      VALUE SPACES.
   549         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   550         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   551         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   552         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   553         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   554
   555     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   556     12  ERPYAJ-KEY.
   557         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   558         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   559         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   560         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   561         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   562         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   563         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   564
   565 01  ERROR-NUMBERS.
   566     12  ER-0000                 PIC X(4)    VALUE '0000'.
   567     12  ER-0004                 PIC X(4)    VALUE '0004'.
   568     12  ER-0013                 PIC X(4)    VALUE '0013'.
   569     12  ER-0022                 PIC X(4)    VALUE '0022'.
   570     12  ER-0023                 PIC X(4)    VALUE '0023'.
   571     12  ER-0029                 PIC X(4)    VALUE '0029'.
   572     12  ER-0070                 PIC X(4)    VALUE '0070'.
   573     12  ER-0194                 PIC X(4)    VALUE '0194'.
   574     12  ER-0195                 PIC X(4)    VALUE '0195'.
   575     12  ER-0196                 PIC X(4)    VALUE '0196'.
   576     12  ER-0197                 PIC X(4)    VALUE '0197'.
   577     12  ER-0203                 PIC X(4)    VALUE '0203'.
   578     12  ER-0215                 PIC X(4)    VALUE '0215'.
   579     12  ER-0216                 PIC X(4)    VALUE '0216'.
   580     12  ER-0433                 PIC X(4)    VALUE '0433'.
   581     12  ER-1159                 PIC X(4)    VALUE '1159'.
   582     12  ER-1162                 PIC X(4)    VALUE '1162'.
   583     12  ER-2056                 PIC X(4)    VALUE '2056'.
   584     12  ER-2208                 PIC X(4)    VALUE '2208'.
   585     12  ER-2209                 PIC X(4)    VALUE '2209'.
   586     12  ER-2210                 PIC X(4)    VALUE '2210'.
   587     12  ER-2230                 PIC X(4)    VALUE '2230'.
   588     12  ER-2237                 PIC X(4)    VALUE '2237'.
   589     12  ER-2238                 PIC X(4)    VALUE '2238'.
   590     12  ER-2394                 PIC X(4)    VALUE '2394'.
   591     12  ER-2583                 PIC X(4)    VALUE '2583'.
   592     12  ER-2600                 PIC X(4)    VALUE '2600'.
   593     12  ER-2726                 PIC X(4)    VALUE '2726'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  12
* EL677.cbl
   594     12  ER-2907                 PIC X(4)    VALUE '2907'.
   595     12  ER-2908                 PIC X(4)    VALUE '2908'.
   596     12  ER-3044                 PIC X(4)    VALUE '3044'.
   597     12  ER-3046                 PIC X(4)    VALUE '3046'.
   598     12  er-3274                 pic x(4)    value '3274'.
   599     12  er-3450                 pic x(4)    value '3450'.
   600     12  er-3451                 pic x(4)    value '3451'.
   601     12  er-3452                 pic x(4)    value '3452'.
   602     12  er-3453                 pic x(4)    value '3453'.
   603     12  er-3454                 pic x(4)    value '3454'.
   604     12  er-3455                 pic x(4)    value '3455'.
   605     12  er-3459                 pic x(4)    value '3459'.
   606     12  er-3460                 pic x(4)    value '3460'.
   607     12  er-3461                 pic x(4)    value '3461'.
   608     12  er-3462                 pic x(4)    value '3462'.
   609     12  er-3463                 pic x(4)    value '3463'.
   610     12  er-9999                 pic x(4)    value '9999'.
   611*                                COPY ELCLOGOF.
   612******************************************************************
   613*                                                                *
   614*                                                                *
   615*                            ELCLOGOF.                           *
   616*                            VMOD=2.001                          *
   617*                                                                *
   618*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   619*                                                                *
   620******************************************************************
   621 01  CLASIC-LOGOFF.
   622     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   623     12  LOGOFF-TEXT.
   624         16  FILLER          PIC X(5)    VALUE SPACES.
   625         16  LOGOFF-MSG.
   626             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   627             20  FILLER      PIC X       VALUE SPACES.
   628             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   629         16  FILLER          PIC X(80)
   630           VALUE '* YOU ARE NOW LOGGED OFF'.
   631         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   632         16  FILLER          PIC X       VALUE QUOTE.
   633         16  LOGOFF-SYS-MSG  PIC X(17)
   634           VALUE 'S CLAS-IC SYSTEM '.
   635     12  TEXT-MESSAGES.
   636         16  UNACCESS-MSG    PIC X(29)
   637             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   638         16  PGMIDERR-MSG    PIC X(17)
   639             VALUE 'PROGRAM NOT FOUND'.
   640*                                COPY ELCDATE.
   641******************************************************************
   642*                                                                *
   643*                                                                *
   644*                            ELCDATE.                            *
   645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   646*                            VMOD=2.003
   647*                                                                *
   648*                                                                *
   649*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   650*                 LENGTH = 200                                   *
   651******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  13
* EL677.cbl
   652
   653 01  DATE-CONVERSION-DATA.
   654     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   655     12  DC-OPTION-CODE                PIC X.
   656         88  BIN-TO-GREG                VALUE ' '.
   657         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   658         88  EDIT-GREG-TO-BIN           VALUE '2'.
   659         88  YMD-GREG-TO-BIN            VALUE '3'.
   660         88  MDY-GREG-TO-BIN            VALUE '4'.
   661         88  JULIAN-TO-BIN              VALUE '5'.
   662         88  BIN-PLUS-ELAPSED           VALUE '6'.
   663         88  FIND-CENTURY               VALUE '7'.
   664         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   665         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   666         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   667         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   668         88  JULIAN-TO-BIN-3            VALUE 'C'.
   669         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   670         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   671         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   672         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   673         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   674         88  CHECK-LEAP-YEAR            VALUE 'H'.
   675         88  BIN-3-TO-GREG              VALUE 'I'.
   676         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   677         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   678         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   679         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   680         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   681         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   682         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   683         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   684         88  THREE-CHARACTER-BIN
   685                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   686         88  GREGORIAN-TO-BIN
   687                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   688         88  BIN-TO-GREGORIAN
   689                  VALUES ' ' '1' 'I' '8' 'G'.
   690         88  JULIAN-TO-BINARY
   691                  VALUES '5' 'C' 'E' 'F'.
   692     12  DC-ERROR-CODE                 PIC X.
   693         88  NO-CONVERSION-ERROR        VALUE ' '.
   694         88  DATE-CONVERSION-ERROR
   695                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   696         88  DATE-IS-ZERO               VALUE '1'.
   697         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   698         88  DATE-IS-INVALID            VALUE '3'.
   699         88  DATE1-GREATER-DATE2        VALUE '4'.
   700         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   701         88  DATE-INVALID-OPTION        VALUE '9'.
   702         88  INVALID-CENTURY            VALUE 'A'.
   703         88  ONLY-CENTURY               VALUE 'B'.
   704         88  ONLY-LEAP-YEAR             VALUE 'C'.
   705         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   706     12  DC-END-OF-MONTH               PIC X.
   707         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   708     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   709         88  USE-NORMAL-PROCESS         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  14
* EL677.cbl
   710         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   711         88  ADJUST-UP-100-YRS          VALUE '2'.
   712     12  FILLER                        PIC X.
   713     12  DC-CONVERSION-DATES.
   714         16  DC-BIN-DATE-1             PIC XX.
   715         16  DC-BIN-DATE-2             PIC XX.
   716         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   717         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   718                       DC-GREG-DATE-1-EDIT.
   719             20  DC-EDIT1-MONTH        PIC 99.
   720             20  SLASH1-1              PIC X.
   721             20  DC-EDIT1-DAY          PIC 99.
   722             20  SLASH1-2              PIC X.
   723             20  DC-EDIT1-YEAR         PIC 99.
   724         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   725         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   726                     DC-GREG-DATE-2-EDIT.
   727             20  DC-EDIT2-MONTH        PIC 99.
   728             20  SLASH2-1              PIC X.
   729             20  DC-EDIT2-DAY          PIC 99.
   730             20  SLASH2-2              PIC X.
   731             20  DC-EDIT2-YEAR         PIC 99.
   732         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   733         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   734                     DC-GREG-DATE-1-YMD.
   735             20  DC-YMD-YEAR           PIC 99.
   736             20  DC-YMD-MONTH          PIC 99.
   737             20  DC-YMD-DAY            PIC 99.
   738         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   739         16  DC-GREG-DATE-1-MDY-R REDEFINES
   740                      DC-GREG-DATE-1-MDY.
   741             20  DC-MDY-MONTH          PIC 99.
   742             20  DC-MDY-DAY            PIC 99.
   743             20  DC-MDY-YEAR           PIC 99.
   744         16  DC-GREG-DATE-1-ALPHA.
   745             20  DC-ALPHA-MONTH        PIC X(10).
   746             20  DC-ALPHA-DAY          PIC 99.
   747             20  FILLER                PIC XX.
   748             20  DC-ALPHA-CENTURY.
   749                 24 DC-ALPHA-CEN-N     PIC 99.
   750             20  DC-ALPHA-YEAR         PIC 99.
   751         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   752         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   753         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   754         16  DC-JULIAN-DATE            PIC 9(05).
   755         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   756                                       PIC 9(05).
   757         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   758             20  DC-JULIAN-YEAR        PIC 99.
   759             20  DC-JULIAN-DAYS        PIC 999.
   760         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   761         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   762         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   763     12  DATE-CONVERSION-VARIBLES.
   764         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   765         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   766             20  FILLER                PIC 9(3).
   767             20  HOLD-CEN-1-CCYY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  15
* EL677.cbl
   768                 24  HOLD-CEN-1-CC     PIC 99.
   769                 24  HOLD-CEN-1-YY     PIC 99.
   770             20  HOLD-CEN-1-MO         PIC 99.
   771             20  HOLD-CEN-1-DA         PIC 99.
   772         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   773             20  HOLD-CEN-1-R-MO       PIC 99.
   774             20  HOLD-CEN-1-R-DA       PIC 99.
   775             20  HOLD-CEN-1-R-CCYY.
   776                 24  HOLD-CEN-1-R-CC   PIC 99.
   777                 24  HOLD-CEN-1-R-YY   PIC 99.
   778             20  FILLER                PIC 9(3).
   779         16  HOLD-CENTURY-1-X.
   780             20  FILLER                PIC X(3)  VALUE SPACES.
   781             20  HOLD-CEN-1-X-CCYY.
   782                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   783                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   784             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   785             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   786         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   787             20  HOLD-CEN-1-R-X-MO     PIC XX.
   788             20  HOLD-CEN-1-R-X-DA     PIC XX.
   789             20  HOLD-CEN-1-R-X-CCYY.
   790                 24  HOLD-CEN-1-R-X-CC PIC XX.
   791                 24  HOLD-CEN-1-R-X-YY PIC XX.
   792             20  FILLER                PIC XXX.
   793         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   794         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   795         16  DC-JULIAN-DATE-1          PIC 9(07).
   796         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   797             20  DC-JULIAN-1-CCYY.
   798                 24  DC-JULIAN-1-CC    PIC 99.
   799                 24  DC-JULIAN-1-YR    PIC 99.
   800             20  DC-JULIAN-DA-1        PIC 999.
   801         16  DC-JULIAN-DATE-2          PIC 9(07).
   802         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   803             20  DC-JULIAN-2-CCYY.
   804                 24  DC-JULIAN-2-CC    PIC 99.
   805                 24  DC-JULIAN-2-YR    PIC 99.
   806             20  DC-JULIAN-DA-2        PIC 999.
   807         16  DC-GREG-DATE-A-EDIT.
   808             20  DC-EDITA-MONTH        PIC 99.
   809             20  SLASHA-1              PIC X VALUE '/'.
   810             20  DC-EDITA-DAY          PIC 99.
   811             20  SLASHA-2              PIC X VALUE '/'.
   812             20  DC-EDITA-CCYY.
   813                 24  DC-EDITA-CENT     PIC 99.
   814                 24  DC-EDITA-YEAR     PIC 99.
   815         16  DC-GREG-DATE-B-EDIT.
   816             20  DC-EDITB-MONTH        PIC 99.
   817             20  SLASHB-1              PIC X VALUE '/'.
   818             20  DC-EDITB-DAY          PIC 99.
   819             20  SLASHB-2              PIC X VALUE '/'.
   820             20  DC-EDITB-CCYY.
   821                 24  DC-EDITB-CENT     PIC 99.
   822                 24  DC-EDITB-YEAR     PIC 99.
   823         16  DC-GREG-DATE-CYMD         PIC 9(08).
   824         16  DC-GREG-DATE-CYMD-R REDEFINES
   825                              DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  16
* EL677.cbl
   826             20  DC-CYMD-CEN           PIC 99.
   827             20  DC-CYMD-YEAR          PIC 99.
   828             20  DC-CYMD-MONTH         PIC 99.
   829             20  DC-CYMD-DAY           PIC 99.
   830         16  DC-GREG-DATE-MDCY         PIC 9(08).
   831         16  DC-GREG-DATE-MDCY-R REDEFINES
   832                              DC-GREG-DATE-MDCY.
   833             20  DC-MDCY-MONTH         PIC 99.
   834             20  DC-MDCY-DAY           PIC 99.
   835             20  DC-MDCY-CEN           PIC 99.
   836             20  DC-MDCY-YEAR          PIC 99.
   837    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   838        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   839    12  DC-EL310-DATE                  PIC X(21).
   840    12  FILLER                         PIC X(28).
   841*                                COPY ELCATTR.
   842******************************************************************
   843*                                                                *
   844*                            ELCATTR.                            *
   845*                            VMOD=2.001                          *
   846*                                                                *
   847*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   848*                                                                *
   849*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   850*                                                                *
   851*                   POS 1   P=PROTECTED                          *
   852*                           U=UNPROTECTED                        *
   853*                           S=ASKIP                              *
   854*                   POS 2   A=ALPHA/NUMERIC                      *
   855*                           N=NUMERIC                            *
   856*                   POS 3   N=NORMAL                             *
   857*                           B=BRIGHT                             *
   858*                           D=DARK                               *
   859*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   860*                           OF=MODIFIED DATA TAG OFF             *
   861*                                                                *
   862*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   863******************************************************************
   864 01  ATTRIBUTE-LIST.
   865     12  AL-PABOF            PIC X       VALUE 'Y'.
   866     12  AL-PABON            PIC X       VALUE 'Z'.
   867     12  AL-PADOF            PIC X       VALUE '%'.
   868     12  AL-PADON            PIC X       VALUE '_'.
   869     12  AL-PANOF            PIC X       VALUE '-'.
   870     12  AL-PANON            PIC X       VALUE '/'.
   871     12  AL-SABOF            PIC X       VALUE '8'.
   872     12  AL-SABON            PIC X       VALUE '9'.
   873     12  AL-SADOF            PIC X       VALUE '@'.
   874     12  AL-SADON            PIC X       VALUE QUOTE.
   875     12  AL-SANOF            PIC X       VALUE '0'.
   876     12  AL-SANON            PIC X       VALUE '1'.
   877     12  AL-UABOF            PIC X       VALUE 'H'.
   878     12  AL-UABON            PIC X       VALUE 'I'.
   879     12  AL-UADOF            PIC X       VALUE '<'.
   880     12  AL-UADON            PIC X       VALUE '('.
   881     12  AL-UANOF            PIC X       VALUE ' '.
   882     12  AL-UANON            PIC X       VALUE 'A'.
   883     12  AL-UNBOF            PIC X       VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  17
* EL677.cbl
   884     12  AL-UNBON            PIC X       VALUE 'R'.
   885     12  AL-UNDOF            PIC X       VALUE '*'.
   886     12  AL-UNDON            PIC X       VALUE ')'.
   887     12  AL-UNNOF            PIC X       VALUE '&'.
   888     12  AL-UNNON            PIC X       VALUE 'J'.
   889*                                COPY ELCEMIB.
   890******************************************************************
   891*                                                                *
   892*                                                                *
   893*                            ELCEMIB.                            *
   894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   895*                            VMOD=2.005                          *
   896*                                                                *
   897*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   898*                                                                *
   899******************************************************************
   900 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   901     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   902     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   903     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   904     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   905     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   906     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   907     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   908     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   909     12  EMI-SWITCH1             PIC X        VALUE '1'.
   910         88  EMI-NO-ERRORS                    VALUE '1'.
   911         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   912         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   913     12  EMI-SWITCH2             PIC X        VALUE '1'.
   914         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   915     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   916         88  EMI-AREA1-EMPTY                  VALUE '1'.
   917         88  EMI-AREA1-FULL                   VALUE '2'.
   918     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   919         88  EMI-AREA2-EMPTY                  VALUE '1'.
   920         88  EMI-AREA2-FULL                   VALUE '2'.
   921     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   922         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   923         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   924         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   925         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   926         88  EMI-BYPASS-FATALS                VALUE 'X'.
   927     12  EMI-ERROR-LINES.
   928         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   929         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   930         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   931         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   932             20  EMI-ERR-CODES OCCURS 10 TIMES.
   933                 24  EMI-ERR-NUM         PIC X(4).
   934                 24  EMI-FILLER          PIC X.
   935                 24  EMI-SEV             PIC X.
   936                 24  FILLER              PIC X.
   937             20  FILLER                  PIC X(02).
   938     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   939         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   940             20  EMI-ERROR-NUMBER    PIC X(4).
   941             20  EMI-FILL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  18
* EL677.cbl
   942             20  EMI-SEVERITY        PIC X.
   943             20  FILLER              PIC X.
   944             20  EMI-ERROR-TEXT.
   945                 24  EMI-TEXT-VARIABLE   PIC X(10).
   946                 24  FILLER          PIC X(55).
   947     12  EMI-SEVERITY-SAVE           PIC X.
   948         88  EMI-NOTE                    VALUE 'N'.
   949         88  EMI-WARNING                 VALUE 'W'.
   950         88  EMI-FORCABLE                VALUE 'F'.
   951         88  EMI-FATAL                   VALUE 'X'.
   952     12  EMI-MESSAGE-FLAG            PIC X.
   953         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   954         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   955     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   956     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   957         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   958         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   959         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   960     12  emi-claim-no                pic x(7).
   961     12  emi-claim-type              pic x(6).
   962     12  FILLER                      PIC X(124)  VALUE SPACES.
   963     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   964     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   965     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   966     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   967*                                COPY ELCINTF.
   968******************************************************************
   969*                                                                *
   970*                                                                *
   971*                            ELCINTF.                            *
   972*                            VMOD=2.017                          *
   973*                                                                *
   974*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   975*                                                                *
   976*       LENGTH = 1024                                            *
   977*                                                                *
   978******************************************************************
   979*                   C H A N G E   L O G
   980*
   981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   982*-----------------------------------------------------------------
   983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   984* EFFECTIVE    NUMBER
   985*-----------------------------------------------------------------
   986* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   987******************************************************************
   988 01  PROGRAM-INTERFACE-BLOCK.
   989     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   990     12  PI-CALLING-PROGRAM              PIC X(8).
   991     12  PI-SAVED-PROGRAM-1              PIC X(8).
   992     12  PI-SAVED-PROGRAM-2              PIC X(8).
   993     12  PI-SAVED-PROGRAM-3              PIC X(8).
   994     12  PI-SAVED-PROGRAM-4              PIC X(8).
   995     12  PI-SAVED-PROGRAM-5              PIC X(8).
   996     12  PI-SAVED-PROGRAM-6              PIC X(8).
   997     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   998     12  PI-COMPANY-ID                   PIC XXX.
   999     12  PI-COMPANY-CD                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  19
* EL677.cbl
  1000
  1001     12  PI-COMPANY-PASSWORD             PIC X(8).
  1002
  1003     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1004
  1005     12  PI-CONTROL-IN-PROGRESS.
  1006         16  PI-CARRIER                  PIC X.
  1007         16  PI-GROUPING                 PIC X(6).
  1008         16  PI-STATE                    PIC XX.
  1009         16  PI-ACCOUNT                  PIC X(10).
  1010         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1011                                         PIC X(10).
  1012         16  PI-CLAIM-CERT-GRP.
  1013             20  PI-CLAIM-NO             PIC X(7).
  1014             20  PI-CERT-NO.
  1015                 25  PI-CERT-PRIME       PIC X(10).
  1016                 25  PI-CERT-SFX         PIC X.
  1017             20  PI-CERT-EFF-DT          PIC XX.
  1018         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1019             20  PI-PLAN-CODE            PIC X(2).
  1020             20  PI-REVISION-NUMBER      PIC X(3).
  1021             20  PI-PLAN-EFF-DT          PIC X(2).
  1022             20  PI-PLAN-EXP-DT          PIC X(2).
  1023             20  FILLER                  PIC X(11).
  1024         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1025             20  PI-OE-REFERENCE-1.
  1026                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1027                 25  PI-OE-REF-1-SUFF    PIC XX.
  1028
  1029     12  PI-SESSION-IN-PROGRESS          PIC X.
  1030         88  CLAIM-SESSION                   VALUE '1'.
  1031         88  CREDIT-SESSION                  VALUE '2'.
  1032         88  WARRANTY-SESSION                VALUE '3'.
  1033         88  MORTGAGE-SESSION                VALUE '4'.
  1034         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1035
  1036
  1037*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1038
  1039     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1040     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1041
  1042     12  PI-CREDIT-USER                  PIC X.
  1043         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1044         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1045
  1046     12  PI-CLAIM-USER                   PIC X.
  1047         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1048         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1049
  1050     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1051         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1052         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1053         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1054         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1055         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1056
  1057     12  PI-PROCESSOR-ID                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  20
* EL677.cbl
  1058
  1059     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1060
  1061     12  PI-MEMBER-CAPTION               PIC X(10).
  1062
  1063     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1064         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1065
  1066     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1067     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1068     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1069     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1070
  1071     12  PI-AH-OVERRIDE-L1               PIC X.
  1072     12  PI-AH-OVERRIDE-L2               PIC XX.
  1073     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1074     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1075
  1076     12  PI-NEW-SYSTEM                   PIC X(2).
  1077
  1078     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1079     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1080         88  PI-USES-PAID-TO                 VALUE '1'.
  1081     12  PI-CRDTCRD-SYSTEM.
  1082         16  PI-CRDTCRD-USER             PIC X.
  1083             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1084             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1085         16  PI-CC-MONTH-END-DT          PIC XX.
  1086     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1087
  1088     12  PI-OE-REFERENCE-2.
  1089         16  PI-OE-REF-2-PRIME           PIC X(10).
  1090         16  PI-OE-REF-2-SUFF            PIC X.
  1091
  1092     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1093
  1094     12  PI-LANGUAGE-TYPE                PIC X.
  1095             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1096             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1097             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1098
  1099     12  PI-POLICY-LINKAGE-IND           PIC X.
  1100         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1101         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1102                                                   LOW-VALUES.
  1103
  1104     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1105     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1106         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1107         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1108
  1109     12  PI-PROCESSOR-CSR-IND            PIC X.
  1110         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1111         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1112
  1113     12  FILLER                          PIC X(3).
  1114
  1115     12  PI-SYSTEM-LEVEL                 PIC X(145).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  21
* EL677.cbl
  1116
  1117     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1118         PI-SYSTEM-LEVEL.
  1119
  1120         16  PI-ENTRY-CODES.
  1121             20  PI-ENTRY-CD-1           PIC X.
  1122             20  PI-ENTRY-CD-2           PIC X.
  1123
  1124         16  PI-RETURN-CODES.
  1125             20  PI-RETURN-CD-1          PIC X.
  1126             20  PI-RETURN-CD-2          PIC X.
  1127
  1128         16  PI-UPDATE-STATUS-SAVE.
  1129             20  PI-UPDATE-BY            PIC X(4).
  1130             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1131
  1132         16  PI-LOWER-CASE-LETTERS       PIC X.
  1133             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1134
  1135*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1136*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1137*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1138
  1139         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1140             88  ST-ACCNT-CNTL               VALUE ' '.
  1141             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1142             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1143             88  ACCNT-CNTL                  VALUE '3'.
  1144             88  CARR-ACCNT-CNTL             VALUE '4'.
  1145
  1146         16  PI-PROCESSOR-CAP-LIST.
  1147             20  PI-SYSTEM-CONTROLS.
  1148                24 PI-SYSTEM-DISPLAY     PIC X.
  1149                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1150                24 PI-SYSTEM-MODIFY      PIC X.
  1151                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1152             20  FILLER                  PIC XX.
  1153             20  PI-DISPLAY-CAP          PIC X.
  1154                 88  DISPLAY-CAP             VALUE 'Y'.
  1155             20  PI-MODIFY-CAP           PIC X.
  1156                 88  MODIFY-CAP              VALUE 'Y'.
  1157             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1158                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1159             20  PI-FORCE-CAP            PIC X.
  1160                 88  FORCE-CAP               VALUE 'Y'.
  1161
  1162         16  PI-PROGRAM-CONTROLS.
  1163             20  PI-PGM-PRINT-OPT        PIC X.
  1164             20  PI-PGM-FORMAT-OPT       PIC X.
  1165             20  PI-PGM-PROCESS-OPT      PIC X.
  1166             20  PI-PGM-TOTALS-OPT       PIC X.
  1167
  1168         16  PI-HELP-INTERFACE.
  1169             20  PI-LAST-ERROR-NO        PIC X(4).
  1170             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1171
  1172         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1173             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  22
* EL677.cbl
  1174
  1175         16  PI-CR-CONTROL-IN-PROGRESS.
  1176             20  PI-CR-CARRIER           PIC X.
  1177             20  PI-CR-GROUPING          PIC X(6).
  1178             20  PI-CR-STATE             PIC XX.
  1179             20  PI-CR-ACCOUNT           PIC X(10).
  1180             20  PI-CR-FIN-RESP          PIC X(10).
  1181             20  PI-CR-TYPE              PIC X.
  1182
  1183         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1184
  1185         16  PI-CR-MONTH-END-DT          PIC XX.
  1186
  1187         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1188             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1189             88  PI-ZERO-CARRIER             VALUE '1'.
  1190             88  PI-ZERO-GROUPING            VALUE '2'.
  1191             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1192
  1193         16  PI-CARRIER-SECURITY         PIC X.
  1194             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1195
  1196         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1197             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1198             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1199
  1200         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1201             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1202                                         INDEXED BY PI-ACCESS-NDX
  1203                                         PIC X.
  1204
  1205         16  PI-GA-BILLING-CONTROL       PIC X.
  1206             88  PI-GA-BILLING               VALUE '1'.
  1207
  1208         16  PI-MAIL-PROCESSING          PIC X.
  1209             88  PI-MAIL-YES                 VALUE 'Y'.
  1210
  1211         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1212
  1213         16  PI-AR-SYSTEM.
  1214             20  PI-AR-PROCESSING-CNTL   PIC X.
  1215                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1216             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1217             20  PI-AR-MONTH-END-DT      PIC XX.
  1218
  1219         16  PI-MP-SYSTEM.
  1220             20  PI-MORTGAGE-USER            PIC X.
  1221                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1222                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1223             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1224                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1225                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1226                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1227                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1228                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1229             20  PI-MP-MONTH-END-DT          PIC XX.
  1230             20  PI-MP-REFERENCE-NO.
  1231                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  23
* EL677.cbl
  1232                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1233
  1234         16  PI-LABEL-CONTROL            PIC X(01).
  1235             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1236             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1237
  1238         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1239             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1240
  1241         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1242             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1243             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1244
  1245         16  FILLER                      PIC X(14).
  1246
  1247     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1248******************************************************************
  1249     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1250         16  PI-EOF-SW               PIC X.
  1251             88  PI-FILE-EOF                     VALUE 'Y'.
  1252         16  PI-PREV-MAINT           PIC X.
  1253         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1254         16  PI-ERCHEK-KEY.
  1255             20  PI-CHEK-COMP-CD     PIC X.
  1256             20  PI-CHEK-CARRIER     PIC X.
  1257             20  PI-CHEK-GROUPING    PIC X(6).
  1258             20  PI-CHEK-STATE       PIC XX.
  1259             20  PI-CHEK-ACCOUNT     PIC X(10).
  1260             20  PI-CHEK-EFF-DT      PIC XX.
  1261             20  PI-CHEK-CERT-NO     PIC X(10).
  1262             20  PI-CHEK-SUF-NO      PIC X.
  1263             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1264         16  PI-ACCOUNT-ADDRESS.
  1265             20  PI-AM-NAME          PIC X(30).
  1266             20  PI-AM-ADDRS         PIC X(30).
  1267             20  PI-AM-CITY-st.
  1268                 24  pi-am-city      PIC X(28).
  1269                 24  pi-am-st        pic xx.
  1270             20  PI-AM-ZIP-CODE.
  1271                 24  PI-AM-ZIP-PRIME PIC X(5).
  1272                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1273         16  PI-PROCESS-CERT-SW          PIC X.
  1274             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1275         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1276             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1277         16  PI-PAYTO1                   PIC X(30).
  1278         16  PI-REFERENCE                PIC X(12).
  1279         16  PI-CANC-DT                  PIC XX.
  1280         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1281         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1282         16  PI-INSURED-NAME             PIC X(28).
  1283         16  PI-PFKEY                    PIC XXX.
  1284             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1285             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1286         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1287         16  PI-TYPE                     PIC X.
  1288         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1289         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  24
* EL677.cbl
  1290         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1291         16  pi-chek-rec-cnt             pic s999 comp-3.
  1292         16  pi-am-csr                   pic x(4).
  1293         16  pi-return-to                pic x(30).
  1294         16  pi-prev-ded-comm            pic x.
  1295         16  pi-table-name               pic x(30).
  1296         16  pi-check-cashed             pic x.
  1297         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1298         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1299         16  pi-check-type               pic x.
  1300             88  pi-corr-check              value 'C'.
  1301             88  pi-ref-check               value 'R'.
  1302         16  pi-check-cut                pic x.
  1303         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1304         16  pi-previous-deduct-comm     pic x.
  1305         16  pi-void-reissue-pass        pic x.
  1306             88  pi-void-complete           value '1'.
  1307             88  pi-address-selected        value '2'.
  1308         16  pi-void-reissue-amt         pic s9(7)v99 comp-3.
  1309         16  FILLER                      PIC X(304). *> wass 311
  1310*                                    COPY ELCAID.
  1311******************************************************************
  1312*                                                                *
  1313*                            ELCAID.                             *
  1314*                            VMOD=2.001                          *
  1315*                                                                *
  1316*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1317*                                                                *
  1318*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1319*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1320******************************************************************
  1321
  1322 01  DFHAID.
  1323   02  DFHNULL   PIC  X  VALUE  ' '.
  1324   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1325   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1326   02  DFHPEN    PIC  X  VALUE  '='.
  1327   02  DFHOPID   PIC  X  VALUE  'W'.
  1328   02  DFHPA1    PIC  X  VALUE  '%'.
  1329   02  DFHPA2    PIC  X  VALUE  '>'.
  1330   02  DFHPA3    PIC  X  VALUE  ','.
  1331   02  DFHPF1    PIC  X  VALUE  '1'.
  1332   02  DFHPF2    PIC  X  VALUE  '2'.
  1333   02  DFHPF3    PIC  X  VALUE  '3'.
  1334   02  DFHPF4    PIC  X  VALUE  '4'.
  1335   02  DFHPF5    PIC  X  VALUE  '5'.
  1336   02  DFHPF6    PIC  X  VALUE  '6'.
  1337   02  DFHPF7    PIC  X  VALUE  '7'.
  1338   02  DFHPF8    PIC  X  VALUE  '8'.
  1339   02  DFHPF9    PIC  X  VALUE  '9'.
  1340   02  DFHPF10   PIC  X  VALUE  ':'.
  1341   02  DFHPF11   PIC  X  VALUE  '#'.
  1342   02  DFHPF12   PIC  X  VALUE  '@'.
  1343   02  DFHPF13   PIC  X  VALUE  'A'.
  1344   02  DFHPF14   PIC  X  VALUE  'B'.
  1345   02  DFHPF15   PIC  X  VALUE  'C'.
  1346   02  DFHPF16   PIC  X  VALUE  'D'.
  1347   02  DFHPF17   PIC  X  VALUE  'E'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  25
* EL677.cbl
  1348   02  DFHPF18   PIC  X  VALUE  'F'.
  1349   02  DFHPF19   PIC  X  VALUE  'G'.
  1350   02  DFHPF20   PIC  X  VALUE  'H'.
  1351   02  DFHPF21   PIC  X  VALUE  'I'.
  1352*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1353   02  DFHPF22   PIC  X  VALUE  '['.
  1354   02  DFHPF23   PIC  X  VALUE  '.'.
  1355   02  DFHPF24   PIC  X  VALUE  '<'.
  1356   02  DFHMSRE   PIC  X  VALUE  'X'.
  1357   02  DFHSTRF   PIC  X  VALUE  'h'.
  1358   02  DFHTRIG   PIC  X  VALUE  '"'.
  1359 01  FILLER    REDEFINES DFHAID.
  1360     12  FILLER                      PIC X(8).
  1361     12  PF-VALUES                   PIC X       OCCURS 24.
  1362     12  FILLER                      PIC X(3).
  1363*                                    COPY EL677S.
  1364 01  EL677AI.
  1365     05  FILLER            PIC  X(0012).
  1366*    -------------------------------
  1367     05  DATEL PIC S9(0004) COMP.
  1368     05  DATEF PIC  X(0001).
  1369     05  FILLER REDEFINES DATEF.
  1370         10  DATEA PIC  X(0001).
  1371     05  DATEI PIC  X(0008).
  1372*    -------------------------------
  1373     05  TIMEL PIC S9(0004) COMP.
  1374     05  TIMEF PIC  X(0001).
  1375     05  FILLER REDEFINES TIMEF.
  1376         10  TIMEA PIC  X(0001).
  1377     05  TIMEI PIC  X(0005).
  1378*    -------------------------------
  1379     05  MAINTL PIC S9(0004) COMP.
  1380     05  MAINTF PIC  X(0001).
  1381     05  FILLER REDEFINES MAINTF.
  1382         10  MAINTA PIC  X(0001).
  1383     05  MAINTI PIC  X(0001).
  1384*    -------------------------------
  1385     05  DMAINT1L PIC S9(0004) COMP.
  1386     05  DMAINT1F PIC  X(0001).
  1387     05  FILLER REDEFINES DMAINT1F.
  1388         10  DMAINT1A PIC  X(0001).
  1389     05  DMAINT1I PIC  X(0009).
  1390*    -------------------------------
  1391     05  DMAINT2L PIC S9(0004) COMP.
  1392     05  DMAINT2F PIC  X(0001).
  1393     05  FILLER REDEFINES DMAINT2F.
  1394         10  DMAINT2A PIC  X(0001).
  1395     05  DMAINT2I PIC  X(0029).
  1396*    -------------------------------
  1397     05  CARRIERL PIC S9(0004) COMP.
  1398     05  CARRIERF PIC  X(0001).
  1399     05  FILLER REDEFINES CARRIERF.
  1400         10  CARRIERA PIC  X(0001).
  1401     05  CARRIERI PIC  X(0001).
  1402*    -------------------------------
  1403     05  GROUPL PIC S9(0004) COMP.
  1404     05  GROUPF PIC  X(0001).
  1405     05  FILLER REDEFINES GROUPF.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  26
* EL677.cbl
  1406         10  GROUPA PIC  X(0001).
  1407     05  GROUPI PIC  X(0006).
  1408*    -------------------------------
  1409     05  STATEL PIC S9(0004) COMP.
  1410     05  STATEF PIC  X(0001).
  1411     05  FILLER REDEFINES STATEF.
  1412         10  STATEA PIC  X(0001).
  1413     05  STATEI PIC  X(0002).
  1414*    -------------------------------
  1415     05  ACCTL PIC S9(0004) COMP.
  1416     05  ACCTF PIC  X(0001).
  1417     05  FILLER REDEFINES ACCTF.
  1418         10  ACCTA PIC  X(0001).
  1419     05  ACCTI PIC  X(0010).
  1420*    -------------------------------
  1421     05  EFFDTL PIC S9(0004) COMP.
  1422     05  EFFDTF PIC  X(0001).
  1423     05  FILLER REDEFINES EFFDTF.
  1424         10  EFFDTA PIC  X(0001).
  1425     05  EFFDTI PIC  X(0008).
  1426*    -------------------------------
  1427     05  CERTNOL PIC S9(0004) COMP.
  1428     05  CERTNOF PIC  X(0001).
  1429     05  FILLER REDEFINES CERTNOF.
  1430         10  CERTNOA PIC  X(0001).
  1431     05  CERTNOI PIC  X(0010).
  1432*    -------------------------------
  1433     05  SFXL PIC S9(0004) COMP.
  1434     05  SFXF PIC  X(0001).
  1435     05  FILLER REDEFINES SFXF.
  1436         10  SFXA PIC  X(0001).
  1437     05  SFXI PIC  X(0001).
  1438*    -------------------------------
  1439     05  SEQL PIC S9(0004) COMP.
  1440     05  SEQF PIC  X(0001).
  1441     05  FILLER REDEFINES SEQF.
  1442         10  SEQA PIC  X(0001).
  1443     05  SEQI PIC  99.
  1444*    -------------------------------
  1445     05  PAYTO1L PIC S9(0004) COMP.
  1446     05  PAYTO1F PIC  X(0001).
  1447     05  FILLER REDEFINES PAYTO1F.
  1448         10  PAYTO1A PIC  X(0001).
  1449     05  PAYTO1I PIC  X(0030).
  1450*    -------------------------------
  1451     05  CREATEDL PIC S9(0004) COMP.
  1452     05  CREATEDF PIC  X(0001).
  1453     05  FILLER REDEFINES CREATEDF.
  1454         10  CREATEDA PIC  X(0001).
  1455     05  CREATEDI PIC  X(0008).
  1456*    -------------------------------
  1457     05  CBYL PIC S9(0004) COMP.
  1458     05  CBYF PIC  X(0001).
  1459     05  FILLER REDEFINES CBYF.
  1460         10  CBYA PIC  X(0001).
  1461     05  CBYI PIC  X(0004).
  1462*    -------------------------------
  1463     05  PAYTO2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  27
* EL677.cbl
  1464     05  PAYTO2F PIC  X(0001).
  1465     05  FILLER REDEFINES PAYTO2F.
  1466         10  PAYTO2A PIC  X(0001).
  1467     05  PAYTO2I PIC  X(0030).
  1468*    -------------------------------
  1469     05  PAYEEL PIC S9(0004) COMP.
  1470     05  PAYEEF PIC  X(0001).
  1471     05  FILLER REDEFINES PAYEEF.
  1472         10  PAYEEA PIC  X(0001).
  1473     05  PAYEEI PIC  X(0006).
  1474*    -------------------------------
  1475     05  APVSTATL PIC S9(0004) COMP.
  1476     05  APVSTATF PIC  X(0001).
  1477     05  FILLER REDEFINES APVSTATF.
  1478         10  APVSTATA PIC  X(0001).
  1479     05  APVSTATI PIC  X(0009).
  1480*    -------------------------------
  1481     05  PAYAD1L PIC S9(0004) COMP.
  1482     05  PAYAD1F PIC  X(0001).
  1483     05  FILLER REDEFINES PAYAD1F.
  1484         10  PAYAD1A PIC  X(0001).
  1485     05  PAYAD1I PIC  X(0030).
  1486*    -------------------------------
  1487     05  APVDTL PIC S9(0004) COMP.
  1488     05  APVDTF PIC  X(0001).
  1489     05  FILLER REDEFINES APVDTF.
  1490         10  APVDTA PIC  X(0001).
  1491     05  APVDTI PIC  X(0008).
  1492*    -------------------------------
  1493     05  APVBYL PIC S9(0004) COMP.
  1494     05  APVBYF PIC  X(0001).
  1495     05  FILLER REDEFINES APVBYF.
  1496         10  APVBYA PIC  X(0001).
  1497     05  APVBYI PIC  X(0004).
  1498*    -------------------------------
  1499     05  PAYAD2L PIC S9(0004) COMP.
  1500     05  PAYAD2F PIC  X(0001).
  1501     05  FILLER REDEFINES PAYAD2F.
  1502         10  PAYAD2A PIC  X(0001).
  1503     05  PAYAD2I PIC  X(0030).
  1504*    -------------------------------
  1505     05  VOIDEDL PIC S9(0004) COMP.
  1506     05  VOIDEDF PIC  X(0001).
  1507     05  FILLER REDEFINES VOIDEDF.
  1508         10  VOIDEDA PIC  X(0001).
  1509     05  VOIDEDI PIC  X(0008).
  1510*    -------------------------------
  1511     05  VBYL PIC S9(0004) COMP.
  1512     05  VBYF PIC  X(0001).
  1513     05  FILLER REDEFINES VBYF.
  1514         10  VBYA PIC  X(0001).
  1515     05  VBYI PIC  X(0004).
  1516*    -------------------------------
  1517     05  PAYCTYL PIC S9(0004) COMP.
  1518     05  PAYCTYF PIC  X(0001).
  1519     05  FILLER REDEFINES PAYCTYF.
  1520         10  PAYCTYA PIC  X(0001).
  1521     05  PAYCTYI PIC  X(0028).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  28
* EL677.cbl
  1522*    -------------------------------
  1523     05  PAYSTL PIC S9(0004) COMP.
  1524     05  PAYSTF PIC  X(0001).
  1525     05  FILLER REDEFINES PAYSTF.
  1526         10  PAYSTA PIC  X(0001).
  1527     05  PAYSTI PIC  X(0002).
  1528*    -------------------------------
  1529     05  PRINTEDL PIC S9(0004) COMP.
  1530     05  PRINTEDF PIC  X(0001).
  1531     05  FILLER REDEFINES PRINTEDF.
  1532         10  PRINTEDA PIC  X(0001).
  1533     05  PRINTEDI PIC  X(0008).
  1534*    -------------------------------
  1535     05  PTOZIPL PIC S9(0004) COMP.
  1536     05  PTOZIPF PIC  X(0001).
  1537     05  FILLER REDEFINES PTOZIPF.
  1538         10  PTOZIPA PIC  X(0001).
  1539     05  PTOZIPI PIC  X(0009).
  1540*    -------------------------------
  1541     05  DEDCYNL PIC S9(0004) COMP.
  1542     05  DEDCYNF PIC  X(0001).
  1543     05  FILLER REDEFINES DEDCYNF.
  1544         10  DEDCYNA PIC  X(0001).
  1545     05  DEDCYNI PIC  X(0001).
  1546*    -------------------------------
  1547     05  CASHEDL PIC S9(0004) COMP.
  1548     05  CASHEDF PIC  X(0001).
  1549     05  FILLER REDEFINES CASHEDF.
  1550         10  CASHEDA PIC  X(0001).
  1551     05  CASHEDI PIC  X(0008).
  1552*    -------------------------------
  1553     05  RETTOL PIC S9(0004) COMP.
  1554     05  RETTOF PIC  X(0001).
  1555     05  FILLER REDEFINES RETTOF.
  1556         10  RETTOA PIC  X(0001).
  1557     05  RETTOI PIC  X(0030).
  1558*    -------------------------------
  1559     05  DPREML PIC S9(0004) COMP.
  1560     05  DPREMF PIC  X(0001).
  1561     05  FILLER REDEFINES DPREMF.
  1562         10  DPREMA PIC  X(0001).
  1563     05  DPREMI PIC  X(0005).
  1564*    -------------------------------
  1565     05  PREML PIC S9(0004) COMP.
  1566     05  PREMF PIC  X(0001).
  1567     05  FILLER REDEFINES PREMF.
  1568         10  PREMA PIC  X(0001).
  1569     05  PREMI PIC  X(0008).
  1570*    -------------------------------
  1571     05  DCOMML PIC S9(0004) COMP.
  1572     05  DCOMMF PIC  X(0001).
  1573     05  FILLER REDEFINES DCOMMF.
  1574         10  DCOMMA PIC  X(0001).
  1575     05  DCOMMI PIC  X(0005).
  1576*    -------------------------------
  1577     05  ISSCOMML PIC S9(0004) COMP.
  1578     05  ISSCOMMF PIC  X(0001).
  1579     05  FILLER REDEFINES ISSCOMMF.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  29
* EL677.cbl
  1580         10  ISSCOMMA PIC  X(0001).
  1581     05  ISSCOMMI PIC  X(0008).
  1582*    -------------------------------
  1583     05  DREFL PIC S9(0004) COMP.
  1584     05  DREFF PIC  X(0001).
  1585     05  FILLER REDEFINES DREFF.
  1586         10  DREFA PIC  X(0001).
  1587     05  DREFI PIC  X(0004).
  1588*    -------------------------------
  1589     05  REFL PIC S9(0004) COMP.
  1590     05  REFF PIC  X(0001).
  1591     05  FILLER REDEFINES REFF.
  1592         10  REFA PIC  X(0001).
  1593     05  REFI PIC  X(0008).
  1594*    -------------------------------
  1595     05  DUECOMML PIC S9(0004) COMP.
  1596     05  DUECOMMF PIC  X(0001).
  1597     05  FILLER REDEFINES DUECOMMF.
  1598         10  DUECOMMA PIC  X(0001).
  1599     05  DUECOMMI PIC  X(0007).
  1600*    -------------------------------
  1601     05  UECOMML PIC S9(0004) COMP.
  1602     05  UECOMMF PIC  X(0001).
  1603     05  FILLER REDEFINES UECOMMF.
  1604         10  UECOMMA PIC  X(0001).
  1605     05  UECOMMI PIC  X(0008).
  1606*    -------------------------------
  1607     05  DPREPDL PIC S9(0004) COMP.
  1608     05  DPREPDF PIC  X(0001).
  1609     05  FILLER REDEFINES DPREPDF.
  1610         10  DPREPDA PIC  X(0001).
  1611     05  DPREPDI PIC  X(0006).
  1612*    -------------------------------
  1613     05  PREPDL PIC S9(0004) COMP.
  1614     05  PREPDF PIC  X(0001).
  1615     05  FILLER REDEFINES PREPDF.
  1616         10  PREPDA PIC  X(0001).
  1617     05  PREPDI PIC  X(0008).
  1618*    -------------------------------
  1619     05  AMOUNTL PIC S9(0004) COMP.
  1620     05  AMOUNTF PIC  X(0001).
  1621     05  FILLER REDEFINES AMOUNTF.
  1622         10  AMOUNTA PIC  X(0001).
  1623     05  AMOUNTI PIC  S9(9)V99.
  1624*    -------------------------------
  1625     05  CHECKL PIC S9(0004) COMP.
  1626     05  CHECKF PIC  X(0001).
  1627     05  FILLER REDEFINES CHECKF.
  1628         10  CHECKA PIC  X(0001).
  1629     05  CHECKI PIC  X(0007).
  1630*    -------------------------------
  1631     05  TYPEL PIC S9(0004) COMP.
  1632     05  TYPEF PIC  X(0001).
  1633     05  FILLER REDEFINES TYPEF.
  1634         10  TYPEA PIC  X(0001).
  1635     05  TYPEI PIC  X(0001).
  1636*    -------------------------------
  1637     05  REASONL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  30
* EL677.cbl
  1638     05  REASONF PIC  X(0001).
  1639     05  FILLER REDEFINES REASONF.
  1640         10  REASONA PIC  X(0001).
  1641     05  REASONI PIC  X(0025).
  1642*    -------------------------------
  1643     05  VREASONL PIC S9(0004) COMP.
  1644     05  VREASONF PIC  X(0001).
  1645     05  FILLER REDEFINES VREASONF.
  1646         10  VREASONA PIC  X(0001).
  1647     05  VREASONI PIC  X(0024).
  1648*    -------------------------------
  1649     05  STUBL PIC S9(0004) COMP.
  1650     05  STUBF PIC  X(0001).
  1651     05  FILLER REDEFINES STUBF.
  1652         10  STUBA PIC  X(0001).
  1653     05  STUBI PIC  X(0030).
  1654*    -------------------------------
  1655     05  TEXT1L PIC S9(0004) COMP.
  1656     05  TEXT1F PIC  X(0001).
  1657     05  FILLER REDEFINES TEXT1F.
  1658         10  TEXT1A PIC  X(0001).
  1659     05  TEXT1I PIC  X(0050).
  1660*    -------------------------------
  1661     05  TEXT2L PIC S9(0004) COMP.
  1662     05  TEXT2F PIC  X(0001).
  1663     05  FILLER REDEFINES TEXT2F.
  1664         10  TEXT2A PIC  X(0001).
  1665     05  TEXT2I PIC  X(0050).
  1666*    -------------------------------
  1667     05  TEXT3L PIC S9(0004) COMP.
  1668     05  TEXT3F PIC  X(0001).
  1669     05  FILLER REDEFINES TEXT3F.
  1670         10  TEXT3A PIC  X(0001).
  1671     05  TEXT3I PIC  X(0040).
  1672*    -------------------------------
  1673     05  ERRMSG1L PIC S9(0004) COMP.
  1674     05  ERRMSG1F PIC  X(0001).
  1675     05  FILLER REDEFINES ERRMSG1F.
  1676         10  ERRMSG1A PIC  X(0001).
  1677     05  ERRMSG1I PIC  X(0079).
  1678*    -------------------------------
  1679     05  ERRMSG2L PIC S9(0004) COMP.
  1680     05  ERRMSG2F PIC  X(0001).
  1681     05  FILLER REDEFINES ERRMSG2F.
  1682         10  ERRMSG2A PIC  X(0001).
  1683     05  ERRMSG2I PIC  X(0079).
  1684*    -------------------------------
  1685     05  PFENTERL PIC S9(0004) COMP.
  1686     05  PFENTERF PIC  X(0001).
  1687     05  FILLER REDEFINES PFENTERF.
  1688         10  PFENTERA PIC  X(0001).
  1689     05  PFENTERI PIC  9(2).
  1690*    -------------------------------
  1691     05  PF3L PIC S9(0004) COMP.
  1692     05  PF3F PIC  X(0001).
  1693     05  FILLER REDEFINES PF3F.
  1694         10  PF3A PIC  X(0001).
  1695     05  PF3I PIC  X(0016).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  31
* EL677.cbl
  1696*    -------------------------------
  1697     05  PF57L PIC S9(0004) COMP.
  1698     05  PF57F PIC  X(0001).
  1699     05  FILLER REDEFINES PF57F.
  1700         10  PF57A PIC  X(0001).
  1701     05  PF57I PIC  X(0030).
  1702*    -------------------------------
  1703     05  PF4L PIC S9(0004) COMP.
  1704     05  PF4F PIC  X(0001).
  1705     05  FILLER REDEFINES PF4F.
  1706         10  PF4A PIC  X(0001).
  1707     05  PF4I PIC  X(0018).
  1708*    -------------------------------
  1709     05  PF6L PIC S9(0004) COMP.
  1710     05  PF6F PIC  X(0001).
  1711     05  FILLER REDEFINES PF6F.
  1712         10  PF6A PIC  X(0001).
  1713     05  PF6I PIC  X(0013).
  1714 01  EL677AO REDEFINES EL677AI.
  1715     05  FILLER            PIC  X(0012).
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  DATEO PIC  X(0008).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  TIMEO PIC  99.99.
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  MAINTO PIC  X(0001).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  DMAINT1O PIC  X(0009).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  DMAINT2O PIC  X(0029).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  CARRIERO PIC  X(0001).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  GROUPO PIC  X(0006).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  STATEO PIC  X(0002).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  ACCTO PIC  X(0010).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  EFFDTO PIC  99B99B99.
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  CERTNOO PIC  X(0010).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  SFXO PIC  X(0001).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  32
* EL677.cbl
  1754     05  SEQO PIC  99.
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  PAYTO1O PIC  X(0030).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  CREATEDO PIC  X(0008).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  CBYO PIC  X(0004).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  PAYTO2O PIC  X(0030).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  PAYEEO PIC  X(0006).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  APVSTATO PIC  X(0009).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  PAYAD1O PIC  X(0030).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  APVDTO PIC  X(0008).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  APVBYO PIC  X(0004).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  PAYAD2O PIC  X(0030).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  VOIDEDO PIC  X(0008).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  VBYO PIC  X(0004).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  PAYCTYO PIC  X(0028).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  PAYSTO PIC  X(0002).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  PRINTEDO PIC  99B99B99.
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  PTOZIPO PIC  X(0009).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  DEDCYNO PIC  X(0001).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  CASHEDO PIC  X(0008).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  RETTOO PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  33
* EL677.cbl
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  DPREMO PIC  X(0005).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  PREMO PIC  Z(5).99.
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  DCOMMO PIC  X(0005).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  ISSCOMMO PIC  Z(5).99.
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  DREFO PIC  X(0004).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  REFO PIC  Z(5).99.
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  DUECOMMO PIC  X(0007).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  UECOMMO PIC  Z(5).99.
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  DPREPDO PIC  X(0006).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  PREPDO PIC  Z(5).99.
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  AMOUNTO PIC  Z(7).ZZ-.
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  CHECKO PIC  X(0007).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  TYPEO PIC  X(0001).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  REASONO PIC  X(0025).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  VREASONO PIC  X(0024).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  STUBO PIC  X(0030).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  TEXT1O PIC  X(0050).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  TEXT2O PIC  X(0050).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  TEXT3O PIC  X(0040).
  1869*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  34
* EL677.cbl
  1870     05  FILLER            PIC  X(0003).
  1871     05  ERRMSG1O PIC  X(0079).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  ERRMSG2O PIC  X(0079).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  PFENTERO PIC  99.
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  PF3O PIC  X(0016).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  PF57O PIC  X(0030).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  PF4O PIC  X(0018).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  PF6O PIC  X(0013).
  1890*    -------------------------------
  1891****************************************************************
  1892*
  1893* Copyright (c) 2007-2013 Dell Inc.
  1894* All rights reserved.
  1895*
  1896****************************************************************
  1897 01  DFHEIV.
  1898   02  DFHEIV0               PIC X(35).
  1899   02  DFHEIV1               PIC X(08).
  1900   02  DFHEIV2               PIC X(08).
  1901   02  DFHEIV3               PIC X(08).
  1902   02  DFHEIV4               PIC X(06).
  1903   02  DFHEIV5               PIC X(04).
  1904   02  DFHEIV6               PIC X(04).
  1905   02  DFHEIV7               PIC X(02).
  1906   02  DFHEIV8               PIC X(02).
  1907   02  DFHEIV9               PIC X(01).
  1908   02  DFHEIV10              PIC S9(7) COMP-3.
  1909   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1910   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1911   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1912   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1913   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1914   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1915   02  DFHEIV17              PIC X(04).
  1916   02  DFHEIV18              PIC X(04).
  1917   02  DFHEIV19              PIC X(04).
  1918   02  DFHEIV20              USAGE IS POINTER.
  1919   02  DFHEIV21              USAGE IS POINTER.
  1920   02  DFHEIV22              USAGE IS POINTER.
  1921   02  DFHEIV23              USAGE IS POINTER.
  1922   02  DFHEIV24              USAGE IS POINTER.
  1923   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1924   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1925   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1926   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1927   02  DFHEIV29              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  35
* EL677.cbl
  1928   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1929   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1930   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1931   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1932   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1933   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1934   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1935   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1936   02  FILLER                PIC X(02).
  1937   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1938   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1939   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1940   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1941   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1942   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1943   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1944 LINKAGE  SECTION.
  1945*****************************************************************
  1946*                                                               *
  1947* Copyright (c) 2007-2013 Dell Inc.                             *
  1948* All rights reserved.                                          *
  1949*                                                               *
  1950*****************************************************************
  1951 01  dfheiblk.
  1952     02  eibtime          pic s9(7) comp-3.
  1953     02  eibdate          pic s9(7) comp-3.
  1954     02  eibtrnid         pic x(4).
  1955     02  eibtaskn         pic s9(7) comp-3.
  1956     02  eibtrmid         pic x(4).
  1957     02  dfheigdi         pic s9(4) comp.
  1958     02  eibcposn         pic s9(4) comp.
  1959     02  eibcalen         pic s9(4) comp.
  1960     02  eibaid           pic x(1).
  1961     02  eibfiller1       pic x(1).
  1962     02  eibfn            pic x(2).
  1963     02  eibfiller2       pic x(2).
  1964     02  eibrcode         pic x(6).
  1965     02  eibfiller3       pic x(2).
  1966     02  eibds            pic x(8).
  1967     02  eibreqid         pic x(8).
  1968     02  eibrsrce         pic x(8).
  1969     02  eibsync          pic x(1).
  1970     02  eibfree          pic x(1).
  1971     02  eibrecv          pic x(1).
  1972     02  eibsend          pic x(1).
  1973     02  eibatt           pic x(1).
  1974     02  eibeoc           pic x(1).
  1975     02  eibfmh           pic x(1).
  1976     02  eibcompl         pic x(1).
  1977     02  eibsig           pic x(1).
  1978     02  eibconf          pic x(1).
  1979     02  eiberr           pic x(1).
  1980     02  eibrldbk         pic x(1).
  1981     02  eiberrcd         pic x(4).
  1982     02  eibsynrb         pic x(1).
  1983     02  eibnodat         pic x(1).
  1984     02  eibfiller5       pic x(2).
  1985     02  eibresp          pic s9(8) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  36
* EL677.cbl
  1986     02  eibresp2         pic s9(8) comp.
  1987     02  dfheigdj         pic s9(4) comp.
  1988     02  dfheigdk         pic s9(4) comp.
  1989 01  DFHCOMMAREA.
  1990     05  filler                  PIC X(1024).
  1991 01  var  pic x(30).
  1992*                                COPY ELCCNTL.
  1993******************************************************************
  1994*                                                                *
  1995*                                                                *
  1996*                            ELCCNTL.                            *
  1997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1998*                            VMOD=2.059                          *
  1999*                                                                *
  2000*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2001*                                                                *
  2002*   FILE TYPE = VSAM,KSDS                                        *
  2003*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2004*                                                                *
  2005*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2006*       ALTERNATE INDEX = NONE                                   *
  2007*                                                                *
  2008*   LOG = YES                                                    *
  2009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2010******************************************************************
  2011*                   C H A N G E   L O G
  2012*
  2013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2014*-----------------------------------------------------------------
  2015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2016* EFFECTIVE    NUMBER
  2017*-----------------------------------------------------------------
  2018* 082503                   PEMA  ADD BENEFIT GROUP
  2019* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2020* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2021* 092705    2005050300006  PEMA  ADD SPP LEASES
  2022* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2023* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2024* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2025* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2026* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2027* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2028* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2029* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2030* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2031* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2032* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2033******************************************************************
  2034*
  2035 01  CONTROL-FILE.
  2036     12  CF-RECORD-ID                       PIC XX.
  2037         88  VALID-CF-ID                        VALUE 'CF'.
  2038
  2039     12  CF-CONTROL-PRIMARY.
  2040         16  CF-COMPANY-ID                  PIC XXX.
  2041         16  CF-RECORD-TYPE                 PIC X.
  2042             88  CF-COMPANY-MASTER              VALUE '1'.
  2043             88  CF-PROCESSOR-MASTER            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  37
* EL677.cbl
  2044             88  CF-STATE-MASTER                VALUE '3'.
  2045             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2046             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2047             88  CF-CARRIER-MASTER              VALUE '6'.
  2048             88  CF-MORTALITY-MASTER            VALUE '7'.
  2049             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2050             88  CF-TERMINAL-MASTER             VALUE '9'.
  2051             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2052             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2053             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2054             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2055             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2056             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2057             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2058             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2059             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2060         16  CF-ACCESS-CD-GENL              PIC X(4).
  2061         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2062             20  CF-PROCESSOR               PIC X(4).
  2063         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2064             20  CF-STATE-CODE              PIC XX.
  2065             20  FILLER                     PIC XX.
  2066         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2067             20  FILLER                     PIC XX.
  2068             20  CF-HI-BEN-IN-REC           PIC XX.
  2069         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2070             20  FILLER                     PIC XXX.
  2071             20  CF-CARRIER-CNTL            PIC X.
  2072         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2073             20  FILLER                     PIC XX.
  2074             20  CF-HI-TYPE-IN-REC          PIC 99.
  2075         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2076             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2077                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2078             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2079             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2080         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2081             20  FILLER                     PIC X.
  2082             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2083         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2084             20  FILLER                     PIC XX.
  2085             20  CF-MORTGAGE-PLAN           PIC XX.
  2086         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2087
  2088     12  CF-LAST-MAINT-DT                   PIC XX.
  2089     12  CF-LAST-MAINT-BY                   PIC X(4).
  2090     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2091
  2092     12  CF-RECORD-BODY                     PIC X(728).
  2093
  2094
  2095****************************************************************
  2096*             COMPANY MASTER RECORD                            *
  2097****************************************************************
  2098
  2099     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2100         16  CF-COMPANY-ADDRESS.
  2101             20  CF-CL-MAIL-TO-NAME         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  38
* EL677.cbl
  2102             20  CF-CL-IN-CARE-OF           PIC X(30).
  2103             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2104             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2105             20  CF-CL-CITY-STATE           PIC X(30).
  2106             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2107             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2108         16  CF-COMPANY-CD                  PIC X.
  2109         16  CF-COMPANY-PASSWORD            PIC X(8).
  2110         16  CF-SECURITY-OPTION             PIC X.
  2111             88  ALL-SECURITY                   VALUE '1'.
  2112             88  COMPANY-VERIFY                 VALUE '2'.
  2113             88  PROCESSOR-VERIFY               VALUE '3'.
  2114             88  NO-SECURITY                    VALUE '4'.
  2115             88  ALL-BUT-TERM                   VALUE '5'.
  2116         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2117             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2118         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2119             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2120         16  CF-INFORCE-LOCATION            PIC X.
  2121             88  CERTS-ARE-ONLINE               VALUE '1'.
  2122             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2123             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2124         16  CF-LOWER-CASE-LETTERS          PIC X.
  2125         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2126             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2127             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2128             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2129             88  CF-ACCNT-CNTL                  VALUE '3'.
  2130             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2131
  2132         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2133         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2134
  2135         16  CF-LGX-CREDIT-USER             PIC X.
  2136             88  CO-IS-NOT-USER                 VALUE 'N'.
  2137             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2138
  2139         16 CF-CREDIT-CALC-CODES.
  2140             20  CF-CR-REM-TERM-CALC PIC X.
  2141               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2142               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2143               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2144               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2145               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2146               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2147               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2148             20  CF-CR-R78-METHOD           PIC X.
  2149               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2150               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2151
  2152         16  CF-CLAIM-CONTROL-COUNTS.
  2153             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2154                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2155
  2156             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2157                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2158
  2159             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  39
* EL677.cbl
  2160                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2161
  2162             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2163                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2164
  2165         16  CF-CURRENT-MONTH-END           PIC XX.
  2166
  2167         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2168             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2169             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2170             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2171             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2172                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2173                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2174             20  CF-CO-PREM-REJECT-SW       PIC X.
  2175                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2176                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2177             20  CF-CO-REF-REJECT-SW        PIC X.
  2178                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2179                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2180
  2181         16  CF-CO-REPORTING-DT             PIC XX.
  2182         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2183         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2184           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2185           88  CF-CO-MONTH-END                  VALUE '1'.
  2186
  2187         16  CF-LGX-CLAIM-USER              PIC X.
  2188             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2189             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2190
  2191         16  CF-CREDIT-EDIT-CONTROLS.
  2192             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2193             20  CF-MIN-AGE                 PIC 99.
  2194             20  CF-DEFAULT-AGE             PIC 99.
  2195             20  CF-MIN-TERM                PIC S999      COMP-3.
  2196             20  CF-MAX-TERM                PIC S999      COMP-3.
  2197             20  CF-DEFAULT-SEX             PIC X.
  2198             20  CF-JOINT-AGE-INPUT         PIC X.
  2199                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2200             20  CF-BIRTH-DATE-INPUT        PIC X.
  2201                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2202             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2203                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2204                 88  CF-ZERO-CARRIER            VALUE '1'.
  2205                 88  CF-ZERO-GROUPING           VALUE '2'.
  2206                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2207             20  CF-EDIT-SW                 PIC X.
  2208                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2209             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2210             20  CF-CR-PR-METHOD            PIC X.
  2211               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2212               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2213             20  FILLER                     PIC X.
  2214
  2215         16  CF-CREDIT-MISC-CONTROLS.
  2216             20  CF-REIN-TABLE-SW           PIC X.
  2217                 88 REIN-TABLES-ARE-USED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  40
* EL677.cbl
  2218             20  CF-COMP-TABLE-SW           PIC X.
  2219                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2220             20  CF-EXPERIENCE-RETENTION-AGE
  2221                                            PIC S9        COMP-3.
  2222             20  CF-CONVERSION-DT           PIC XX.
  2223             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2224             20  CF-RUN-FREQUENCY-SW        PIC X.
  2225                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2226                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2227
  2228             20  CF-CR-CHECK-NO-CONTROL.
  2229                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2230                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2231                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2232                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2233                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2234                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2235
  2236                 24  CF-CR-CHECK-COUNT       REDEFINES
  2237                     CF-CR-CHECK-COUNTER      PIC X(4).
  2238
  2239                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2240                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2241
  2242                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2243                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2244                 24  CF-MAIL-PROCESSING       PIC X.
  2245                     88  MAIL-PROCESSING          VALUE 'Y'.
  2246
  2247         16  CF-MISC-SYSTEM-CONTROL.
  2248             20  CF-SYSTEM-C                 PIC X.
  2249                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2250             20  CF-SYSTEM-D                 PIC X.
  2251                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2252             20  CF-SOC-SEC-NO-SW            PIC X.
  2253                 88  SOC-SEC-NO-USED             VALUE '1'.
  2254             20  CF-MEMBER-NO-SW             PIC X.
  2255                 88  MEMBER-NO-USED              VALUE '1'.
  2256             20  CF-TAX-ID-NUMBER            PIC X(11).
  2257             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2258             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2259                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2260                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2261                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2262                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2263             20  CF-SYSTEM-E                 PIC X.
  2264                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2265
  2266         16  CF-LGX-LIFE-USER               PIC X.
  2267             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2268             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2269
  2270         16  CF-CR-MONTH-END-DT             PIC XX.
  2271
  2272         16  CF-FILE-MAINT-DATES.
  2273             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2274                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2275             20  CF-LAST-BATCH       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  41
* EL677.cbl
  2276                 CF-LAST-BATCH-NO               PIC X(4).
  2277             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2278             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2279             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2280             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2281             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2282             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2283             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2284             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2285             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2286             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2287
  2288         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2289         16  FILLER                         PIC X.
  2290
  2291         16  CF-ALT-MORT-CODE               PIC X(4).
  2292         16  CF-MEMBER-CAPTION              PIC X(10).
  2293
  2294         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2295             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2296             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2297             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2298             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2299             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2300
  2301         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2302
  2303         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2304         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2305         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2306         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2307
  2308         16  CF-AH-OVERRIDE-L1              PIC X.
  2309         16  CF-AH-OVERRIDE-L2              PIC XX.
  2310         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2311         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2312
  2313         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2314         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2315
  2316         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2317         16  CF-AR-LAST-EL860-DT            PIC XX.
  2318         16  CF-MP-MONTH-END-DT             PIC XX.
  2319
  2320         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2321         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2322             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2323
  2324         16  CF-AR-MONTH-END-DT             PIC XX.
  2325
  2326         16  CF-CRDTCRD-USER                PIC X.
  2327             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2328             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2329
  2330         16  CF-CC-MONTH-END-DT             PIC XX.
  2331
  2332         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2333
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  42
* EL677.cbl
  2334         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2335             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2336             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2337             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2338         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2339         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2340         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2341         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2342             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2343             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2344         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2345         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2346         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2347             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2348         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2349
  2350         16  CF-CL-ZIP-CODE.
  2351             20  CF-CL-ZIP-PRIME.
  2352                 24  CF-CL-ZIP-1ST          PIC X.
  2353                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2354                 24  FILLER                 PIC X(4).
  2355             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2356         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2357             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2358             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2359             20  FILLER                     PIC XXX.
  2360
  2361         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2362         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2363         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2364         16  CF-CO-OPTION-START-DATE        PIC XX.
  2365         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2366           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2367                                                      '3' '4'.
  2368           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2369           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2370           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2371           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2372           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2373           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2374
  2375         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2376
  2377         16  CF-PAYMENT-APPROVAL-LEVELS.
  2378             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2379             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2380             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2381             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2382             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2383             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2384
  2385         16  CF-END-USER-REPORTING-USER     PIC X.
  2386             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2387             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2388
  2389         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2390             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2391             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  43
* EL677.cbl
  2392
  2393         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2394
  2395         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2396         16  FILLER                         PIC X.
  2397
  2398         16  CF-CREDIT-ARCHIVE-CNTL.
  2399             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2400             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2401             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2402
  2403         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2404
  2405         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2406             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2407             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2408
  2409         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2410             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2411             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2412
  2413         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2414
  2415         16  CF-CO-ACH-ID-CODE              PIC  X.
  2416             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2417             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2418             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2419         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2420         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2421         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2422         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2423         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2424         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2425         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2426         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2427         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2428                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2429         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2430                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2431
  2432         16  CF-CO-OVER-SHORT.
  2433             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2434             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2435
  2436*         16  FILLER                         PIC X(102).
  2437         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2438             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2439             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2440
  2441         16  CF-AH-APPROVAL-DAYS.
  2442             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2443             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2444             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2445             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2446
  2447         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2448
  2449         16  CF-APPROV-LEV-5.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  44
* EL677.cbl
  2450             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2451             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2452             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2453
  2454         16  FILLER                         PIC X(68).
  2455****************************************************************
  2456*             PROCESSOR/USER RECORD                            *
  2457****************************************************************
  2458
  2459     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2460         16  CF-PROCESSOR-NAME              PIC X(30).
  2461         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2462         16  CF-PROCESSOR-TITLE             PIC X(26).
  2463         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2464                 88  MESSAGE-YES                VALUE 'Y'.
  2465                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2466
  2467*****************************************************
  2468****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2469****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2470****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2471****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2472*****************************************************
  2473
  2474         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2475             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2476             20  CF-APPLICATION-FORCE       PIC X.
  2477             20  CF-INDIVIDUAL-APP.
  2478                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2479                     28  CF-BROWSE-APP      PIC X.
  2480                     28  CF-UPDATE-APP      PIC X.
  2481
  2482         16  CF-CURRENT-TERM-ON             PIC X(4).
  2483         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2484             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2485             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2486             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2487             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2488             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2489             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2490             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2491         16  CF-PROCESSOR-CARRIER           PIC X.
  2492             88  NO-CARRIER-SECURITY            VALUE ' '.
  2493         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2494             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2495         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2496             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2497         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2498             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2499
  2500         16  CF-PROC-SYS-ACCESS-SW.
  2501             20  CF-PROC-CREDIT-CLAIMS-SW.
  2502                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2503                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2504                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2505                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2506             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2507                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  45
* EL677.cbl
  2508                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2509             20  CF-PROC-LIFE-GNRLDGR-SW.
  2510                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2511                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2512                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2513                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2514             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2515                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2516                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2517         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2518             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2519             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2520         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2521
  2522         16  CF-APPROVAL-LEVEL                  PIC X.
  2523             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2524             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2525             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2526             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2527             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2528
  2529         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2530
  2531         16  CF-LANGUAGE-TYPE                   PIC X.
  2532             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2533             88  CF-LANG-IS-FR                      VALUE 'F'.
  2534
  2535         16  CF-CSR-IND                         PIC X.
  2536         16  FILLER                             PIC X(239).
  2537
  2538****************************************************************
  2539*             PROCESSOR/REMINDERS RECORD                       *
  2540****************************************************************
  2541
  2542     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2543         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2544             20  CF-START-REMIND-DT         PIC XX.
  2545             20  CF-END-REMIND-DT           PIC XX.
  2546             20  CF-REMINDER-TEXT           PIC X(50).
  2547         16  FILLER                         PIC X(296).
  2548
  2549
  2550****************************************************************
  2551*             STATE MASTER RECORD                              *
  2552****************************************************************
  2553
  2554     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2555         16  CF-STATE-ABBREVIATION          PIC XX.
  2556         16  CF-STATE-NAME                  PIC X(25).
  2557         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2558         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2559             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2560             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2561             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2562             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2563                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2564                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2565             20  CF-ST-PREM-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  46
* EL677.cbl
  2566                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2567                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2568             20  CF-ST-REF-REJECT-SW        PIC X.
  2569                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2570                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2571         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2572         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2573         16  CF-ST-REFUND-RULES.
  2574             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2575             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2576             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2577         16  CF-ST-FST-PMT-EXTENSION.
  2578             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2579             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2580                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2581                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2582                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2583                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2584         16  CF-ST-STATE-CALL.
  2585             20  CF-ST-CALL-UNEARNED        PIC X.
  2586             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2587             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2588         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2589             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2590             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2591         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2592         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2593         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2594         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2595         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2596         16  FILLER                         PIC X.
  2597         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2598             20  CF-ST-BENEFIT-CD           PIC XX.
  2599             20  CF-ST-BENEFIT-KIND         PIC X.
  2600                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2601                 88  CF-ST-AH-KIND              VALUE 'A'.
  2602             20  CF-ST-REM-TERM-CALC        PIC X.
  2603                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2604                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2605                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2606                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2607                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2608                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2609                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2610                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2611
  2612             20  CF-ST-REFUND-CALC          PIC X.
  2613                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2614                 88  ST-REFD-BY-R78             VALUE '1'.
  2615                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2616                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2617                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2618                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2619                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2620                 88  ST-REFD-UTAH               VALUE '7'.
  2621                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2622                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2623                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  47
* EL677.cbl
  2624
  2625             20  CF-ST-EARNING-CALC         PIC X.
  2626                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2627                 88  ST-EARN-BY-R78             VALUE '1'.
  2628                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2629                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2630                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2631                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2632                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2633                 88  ST-EARN-MEAN               VALUE '8'.
  2634                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2635
  2636             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2637                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2638                 88  ST-OVRD-BY-R78             VALUE '1'.
  2639                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2640                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2641                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2642                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2643                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2644                 88  ST-OVRD-MEAN               VALUE '8'.
  2645                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2646             20  cf-st-extra-periods        pic 9.
  2647*            20  FILLER                     PIC X.
  2648
  2649         16  CF-ST-COMMISSION-CAPS.
  2650             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2651             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2652             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2653             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2654         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2655                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2656                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2657                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2658
  2659         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2660
  2661         16  CF-ST-STATUTORY-INTEREST.
  2662             20  CF-ST-STAT-DATE-FROM       PIC X.
  2663                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2664                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2665             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2666             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2667             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2668             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2669             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2670
  2671         16  CF-ST-OVER-SHORT.
  2672             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2673             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2674
  2675         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2676
  2677         16  CF-ST-RT-CALC                  PIC X.
  2678
  2679         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2680         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2681         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  48
* EL677.cbl
  2682         16  CF-ST-RF-LR-CALC               PIC X.
  2683         16  CF-ST-RF-LL-CALC               PIC X.
  2684         16  CF-ST-RF-LN-CALC               PIC X.
  2685         16  CF-ST-RF-AH-CALC               PIC X.
  2686         16  CF-ST-RF-CP-CALC               PIC X.
  2687*        16  FILLER                         PIC X(206).
  2688*CIDMOD         16  FILLER                         PIC X(192).
  2689         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2690             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2691         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2692         16  CF-ST-VFY-2ND-BENE             PIC X.
  2693         16  CF-ST-CAUSAL-STATE             PIC X.
  2694         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2695         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2696         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2697             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2698         16  CF-ST-NET-ONLY-STATE           PIC X.
  2699             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2700         16  cf-commission-cap-required     pic x.
  2701         16  CF-ST-GA-COMMISSION-CAPS.
  2702             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2703             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2704             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2705             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2706         16  CF-ST-TOT-COMMISSION-CAPS.
  2707             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2708             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2709             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2710             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2711         16  FILLER                         PIC X(156).
  2712
  2713****************************************************************
  2714*             BENEFIT MASTER RECORD                            *
  2715****************************************************************
  2716
  2717     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2718         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2719             20  CF-BENEFIT-CODE            PIC XX.
  2720             20  CF-BENEFIT-NUMERIC  REDEFINES
  2721                 CF-BENEFIT-CODE            PIC XX.
  2722             20  CF-BENEFIT-ALPHA           PIC XXX.
  2723             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2724             20  CF-BENEFIT-COMMENT         PIC X(10).
  2725
  2726             20  CF-LF-COVERAGE-TYPE        PIC X.
  2727                 88  CF-REDUCING                VALUE 'R'.
  2728                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2729
  2730             20  CF-SPECIAL-CALC-CD         PIC X.
  2731                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2732                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2733                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2734                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2735                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2736                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2737                 88  CF-FARM-PLAN               VALUE 'F'.
  2738                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2739                 88  CF-2-MTH-INTEREST          VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  49
* EL677.cbl
  2740                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2741                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2742                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2743                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2744                 88  CF-PRUDENTIAL              VALUE 'P'.
  2745                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2746                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2747                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2748                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2749                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2750                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2751
  2752             20  CF-JOINT-INDICATOR         PIC X.
  2753                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2754
  2755*            20  FILLER                     PIC X(12).
  2756             20  cf-maximum-benefits        pic s999 comp-3.
  2757             20  FILLER                     PIC X(09).
  2758             20  CF-BENEFIT-CATEGORY        PIC X.
  2759             20  CF-LOAN-TYPE               PIC X(8).
  2760
  2761             20  CF-CO-REM-TERM-CALC        PIC X.
  2762                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2763                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2764                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2765                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2766                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2767
  2768             20  CF-CO-EARNINGS-CALC        PIC X.
  2769                 88  CO-EARN-BY-R78             VALUE '1'.
  2770                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2771                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2772                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2773                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2774                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2775                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2776                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2777
  2778             20  CF-CO-REFUND-CALC          PIC X.
  2779                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2780                 88  CO-REFD-BY-R78             VALUE '1'.
  2781                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2782                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2783                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2784                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2785                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2786                 88  CO-REFD-MEAN               VALUE '8'.
  2787                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2788                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2789                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2790
  2791             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2792                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2793                 88  CO-OVRD-BY-R78             VALUE '1'.
  2794                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2795                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2796                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2797                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  50
* EL677.cbl
  2798                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2799                 88  CO-OVRD-MEAN               VALUE '8'.
  2800                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2801
  2802             20  CF-CO-BEN-I-G-CD           PIC X.
  2803                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2804                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2805                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2806
  2807         16  FILLER                         PIC X(304).
  2808
  2809
  2810****************************************************************
  2811*             CARRIER MASTER RECORD                            *
  2812****************************************************************
  2813
  2814     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2815         16  CF-ADDRESS-DATA.
  2816             20  CF-MAIL-TO-NAME            PIC X(30).
  2817             20  CF-IN-CARE-OF              PIC X(30).
  2818             20  CF-ADDRESS-LINE-1          PIC X(30).
  2819             20  CF-ADDRESS-LINE-2          PIC X(30).
  2820             20  CF-CITY-STATE              PIC X(30).
  2821             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2822             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2823
  2824         16  CF-CLAIM-NO-CONTROL.
  2825             20  CF-CLAIM-NO-METHOD         PIC X.
  2826                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2827                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2828                 88  CLAIM-NO-SEQ               VALUE '3'.
  2829                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2830             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2831                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2832                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2833                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2834
  2835         16  CF-CHECK-NO-CONTROL.
  2836             20  CF-CHECK-NO-METHOD         PIC X.
  2837                 88  CHECK-NO-MANUAL            VALUE '1'.
  2838                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2839                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2840                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2841             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2842                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2843
  2844         16  CF-DOMICILE-STATE              PIC XX.
  2845
  2846         16  CF-EXPENSE-CONTROLS.
  2847             20  CF-EXPENSE-METHOD          PIC X.
  2848                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2849                 88  DOLLARS-PER-PMT            VALUE '2'.
  2850                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2851                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2852             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2853             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2854
  2855         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  51
* EL677.cbl
  2856             20  CF-LETTER-RESEND-OPT       PIC X.
  2857                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2858                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2859             20  FILLER                     PIC X(4).
  2860
  2861         16  CF-RESERVE-CONTROLS.
  2862             20  CF-MANUAL-SW               PIC X.
  2863                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2864             20  CF-FUTURE-SW               PIC X.
  2865                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2866             20  CF-PTC-SW                  PIC X.
  2867                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2868             20  CF-IBNR-SW                 PIC X.
  2869                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2870             20  CF-PTC-LF-SW               PIC X.
  2871                 88  CF-LF-PTC-USED             VALUE '1'.
  2872             20  CF-CDT-ACCESS-METHOD       PIC X.
  2873                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2874                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2875                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2876             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2877
  2878         16  CF-CLAIM-CALC-METHOD           PIC X.
  2879             88  360-PLUS-MONTHS                VALUE '1'.
  2880             88  365-PLUS-MONTHS                VALUE '2'.
  2881             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2882             88  360-DAILY                      VALUE '4'.
  2883             88  365-DAILY                      VALUE '5'.
  2884
  2885         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2886         16  FILLER                         PIC X(11).
  2887
  2888         16  CF-LIMIT-AMOUNTS.
  2889             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2890             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2891             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2892             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2893             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2894             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2895             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2896             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2897             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2898             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2899
  2900         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2901         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2902         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2903
  2904         16  CF-ZIP-CODE.
  2905             20  CF-ZIP-PRIME.
  2906                 24  CF-ZIP-1ST             PIC X.
  2907                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2908                 24  FILLER                 PIC X(4).
  2909             20  CF-ZIP-PLUS4               PIC X(4).
  2910         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2911             20  CF-CAN-POSTAL-1            PIC XXX.
  2912             20  CF-CAN-POSTAL-2            PIC XXX.
  2913             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  52
* EL677.cbl
  2914
  2915         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2916         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2917         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2918
  2919         16  CF-RATING-SWITCH               PIC X.
  2920             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2921             88  CF-NO-RATING                   VALUE 'N'.
  2922
  2923         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2924
  2925         16  CF-CARRIER-OVER-SHORT.
  2926             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2927             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2928
  2929         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2930         16  CF-SECPAY-SWITCH               PIC X.
  2931             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2932             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2933         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2934         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2935         16  FILLER                         PIC X(444).
  2936*        16  FILLER                         PIC X(452).
  2937
  2938
  2939****************************************************************
  2940*             MORTALITY MASTER RECORD                          *
  2941****************************************************************
  2942
  2943     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2944         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2945                                INDEXED BY CF-MORT-NDX.
  2946             20  CF-MORT-TABLE              PIC X(5).
  2947             20  CF-MORT-TABLE-TYPE         PIC X.
  2948                 88  CF-MORT-JOINT              VALUE 'J'.
  2949                 88  CF-MORT-SINGLE             VALUE 'S'.
  2950                 88  CF-MORT-COMBINED           VALUE 'C'.
  2951                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2952                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2953             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2954             20  CF-MORT-AGE-METHOD         PIC XX.
  2955                 88  CF-AGE-LAST                VALUE 'AL'.
  2956                 88  CF-AGE-NEAR                VALUE 'AN'.
  2957             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2958             20  CF-MORT-ADJUSTMENT-DIRECTION
  2959                                            PIC X.
  2960                 88  CF-MINUS                   VALUE '-'.
  2961                 88  CF-PLUS                    VALUE '+'.
  2962             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2963             20  CF-MORT-JOINT-CODE         PIC X.
  2964                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2965             20  CF-MORT-PC-Q               PIC X.
  2966                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2967             20  CF-MORT-TABLE-CODE         PIC X(4).
  2968             20  CF-MORT-COMMENTS           PIC X(15).
  2969             20  FILLER                     PIC X(14).
  2970
  2971         16  FILLER                         PIC X(251).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  53
* EL677.cbl
  2972
  2973
  2974****************************************************************
  2975*             BUSSINESS TYPE MASTER RECORD                     *
  2976****************************************************************
  2977
  2978     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2979* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2980* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2981* AND RECORD 05 IS TYPES 81-99
  2982         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2983             20  CF-BUSINESS-TITLE          PIC  X(19).
  2984             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2985                                            PIC S9V9(4) COMP-3.
  2986             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2987             20  FILLER                     PIC  X.
  2988         16  FILLER                         PIC  X(248).
  2989
  2990
  2991****************************************************************
  2992*             TERMINAL MASTER RECORD                           *
  2993****************************************************************
  2994
  2995     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2996
  2997         16  CF-COMPANY-TERMINALS.
  2998             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2999                                  PIC X(4).
  3000         16  FILLER               PIC X(248).
  3001
  3002
  3003****************************************************************
  3004*             LIFE EDIT MASTER RECORD                          *
  3005****************************************************************
  3006
  3007     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3008         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3009             20  CF-LIFE-CODE-IN            PIC XX.
  3010             20  CF-LIFE-CODE-OUT           PIC XX.
  3011         16  FILLER                         PIC X(248).
  3012
  3013
  3014****************************************************************
  3015*             AH EDIT MASTER RECORD                            *
  3016****************************************************************
  3017
  3018     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3019         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3020             20  CF-AH-CODE-IN              PIC XXX.
  3021             20  CF-AH-CODE-OUT             PIC XX.
  3022         16  FILLER                         PIC X(248).
  3023
  3024
  3025****************************************************************
  3026*             CREDIBILITY TABLES                               *
  3027****************************************************************
  3028
  3029     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  54
* EL677.cbl
  3030         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3031                             INDEXED BY CF-CRDB-NDX.
  3032             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3033             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3034             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3035         16  FILLER                         PIC  X(332).
  3036
  3037
  3038****************************************************************
  3039*             REPORT CUSTOMIZATION RECORD                      *
  3040****************************************************************
  3041
  3042     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3043         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3044             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3045             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3046             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3047**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3048****       A T-TRANSFER.                                   ****
  3049             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3050
  3051         16  FILLER                         PIC XX.
  3052
  3053         16  CF-CARRIER-CNTL-OPT.
  3054             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3055                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3056                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3057             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3058                                            PIC X.
  3059         16  CF-GROUP-CNTL-OPT.
  3060             20  CF-GROUP-OPT-SEQ           PIC 9.
  3061                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3062                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3063             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3064                                            PIC X(6).
  3065         16  CF-STATE-CNTL-OPT.
  3066             20  CF-STATE-OPT-SEQ           PIC 9.
  3067                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3068                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3069             20  CF-STATE-SELECT OCCURS 3 TIMES
  3070                                            PIC XX.
  3071         16  CF-ACCOUNT-CNTL-OPT.
  3072             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3073                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3074                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3075             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3076                                            PIC X(10).
  3077         16  CF-BUS-TYP-CNTL-OPT.
  3078             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3079                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3080                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3081             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3082                                            PIC XX.
  3083         16  CF-LF-TYP-CNTL-OPT.
  3084             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3085                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3086                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3087             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  55
* EL677.cbl
  3088                                            PIC XX.
  3089         16  CF-AH-TYP-CNTL-OPT.
  3090             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3091                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3092                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3093             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3094                                            PIC XX.
  3095         16  CF-REPTCD1-CNTL-OPT.
  3096             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3097                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3098                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3099             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3100                                            PIC X(10).
  3101         16  CF-REPTCD2-CNTL-OPT.
  3102             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3103                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3104                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3105             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3106                                            PIC X(10).
  3107         16  CF-USER1-CNTL-OPT.
  3108             20  CF-USER1-OPT-SEQ           PIC 9.
  3109                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3110                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3111             20  CF-USER1-SELECT OCCURS 3 TIMES
  3112                                            PIC X(10).
  3113         16  CF-USER2-CNTL-OPT.
  3114             20  CF-USER2-OPT-SEQ           PIC 9.
  3115                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3116                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3117             20  CF-USER2-SELECT OCCURS 3 TIMES
  3118                                            PIC X(10).
  3119         16  CF-USER3-CNTL-OPT.
  3120             20  CF-USER3-OPT-SEQ           PIC 9.
  3121                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3122                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3123             20  CF-USER3-SELECT OCCURS 3 TIMES
  3124                                            PIC X(10).
  3125         16  CF-USER4-CNTL-OPT.
  3126             20  CF-USER4-OPT-SEQ           PIC 9.
  3127                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3128                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3129             20  CF-USER4-SELECT OCCURS 3 TIMES
  3130                                            PIC X(10).
  3131         16  CF-USER5-CNTL-OPT.
  3132             20  CF-USER5-OPT-SEQ           PIC 9.
  3133                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3134                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3135             20  CF-USER5-SELECT OCCURS 3 TIMES
  3136                                            PIC X(10).
  3137         16  CF-REINS-CNTL-OPT.
  3138             20  CF-REINS-OPT-SEQ           PIC 9.
  3139                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3140                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3141             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3142                 24  CF-REINS-PRIME         PIC XXX.
  3143                 24  CF-REINS-SUB           PIC XXX.
  3144
  3145         16  CF-AGENT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  56
* EL677.cbl
  3146             20  CF-AGENT-OPT-SEQ           PIC 9.
  3147                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3148                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3149             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3150                                            PIC X(10).
  3151
  3152         16  FILLER                         PIC X(43).
  3153
  3154         16  CF-LOSS-RATIO-SELECT.
  3155             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3156             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3157         16  CF-ENTRY-DATE-SELECT.
  3158             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3159             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3160         16  CF-EFFECTIVE-DATE-SELECT.
  3161             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3162             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3163
  3164         16  CF-EXCEPTION-LIST-IND          PIC X.
  3165             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3166
  3167         16  FILLER                         PIC X(318).
  3168
  3169****************************************************************
  3170*                  EXCEPTION REPORTING RECORD                  *
  3171****************************************************************
  3172
  3173     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3174         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3175             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3176
  3177         16  CF-COMBINED-LIFE-AH-OPT.
  3178             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3179             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3180             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3181             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3182
  3183         16  CF-LIFE-OPT.
  3184             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3185             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3186             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3187             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3188             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3189             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3190             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3191             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3192             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3193             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3194
  3195         16  CF-AH-OPT.
  3196             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3197             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3198             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3199             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3200             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3201             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3202             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3203             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  57
* EL677.cbl
  3204             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3205             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3206
  3207         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3208             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3209             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3210             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3211
  3212         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3213
  3214         16  FILLER                         PIC X(673).
  3215
  3216
  3217****************************************************************
  3218*             MORTGAGE SYSTEM PLAN RECORD                      *
  3219****************************************************************
  3220
  3221     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3222         16  CF-PLAN-TYPE                   PIC X.
  3223             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3224             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3225             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3226         16  CF-PLAN-ABBREV                 PIC XXX.
  3227         16  CF-PLAN-DESCRIPT               PIC X(10).
  3228         16  CF-PLAN-NOTES                  PIC X(20).
  3229         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3230         16  CF-PLAN-UNDERWRITING.
  3231             20  CF-PLAN-TERM-DATA.
  3232                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3233                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3234             20  CF-PLAN-AGE-DATA.
  3235                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3236                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3237                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3238             20  CF-PLAN-BENEFIT-DATA.
  3239                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3240                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3241                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3242                                            PIC S9(7)V99  COMP-3.
  3243         16  CF-PLAN-POLICY-FORMS.
  3244             20  CF-POLICY-FORM             PIC X(12).
  3245             20  CF-MASTER-APPLICATION      PIC X(12).
  3246             20  CF-MASTER-POLICY           PIC X(12).
  3247         16  CF-PLAN-RATING.
  3248             20  CF-RATE-CODE               PIC X(5).
  3249             20  CF-SEX-RATING              PIC X.
  3250                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3251                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3252             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3253             20  CF-SUB-STD-TYPE            PIC X.
  3254                 88  CF-PCT-OF-PREM            VALUE '1'.
  3255                 88  CF-PCT-OF-BENE            VALUE '2'.
  3256         16  CF-PLAN-PREM-TOLERANCES.
  3257             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3258             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3259         16  CF-PLAN-PYMT-TOLERANCES.
  3260             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3261             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  58
* EL677.cbl
  3262         16  CF-PLAN-MISC-DATA.
  3263             20  FILLER                     PIC X.
  3264             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3265             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3266         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3267         16  CF-PLAN-IND-GRP                PIC X.
  3268             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3269                                                     '1'.
  3270             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3271                                                     '2'.
  3272         16  CF-MIB-SEARCH-SW               PIC X.
  3273             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3274             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3275             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3276             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3277         16  CF-ALPHA-SEARCH-SW             PIC X.
  3278             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3279             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3280             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3281             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3282             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3283             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3284             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3285             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3286             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3287             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3288                                                     'A' 'B' 'C'
  3289                                                     'X' 'Y' 'Z'.
  3290         16  CF-EFF-DT-RULE-SW              PIC X.
  3291             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3292             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3293             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3294             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3295             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3296         16  FILLER                         PIC X(4).
  3297         16  CF-HEALTH-QUESTIONS            PIC X.
  3298             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3299         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3300         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3301         16  CF-PLAN-SNGL-JNT               PIC X.
  3302             88  CF-COMBINED-PLAN              VALUE 'C'.
  3303             88  CF-JNT-PLAN                   VALUE 'J'.
  3304             88  CF-SNGL-PLAN                  VALUE 'S'.
  3305         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3306         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3307         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3308         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3309         16  CF-RERATE-CNTL                 PIC  X.
  3310             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3311             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3312             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3313             88  CF-AUTO-RECALC                 VALUE '4'.
  3314         16  CF-BENEFIT-TYPE                PIC  X.
  3315             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3316             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3317         16  CF-POLICY-FEE                  PIC S999V99
  3318                                                    COMP-3.
  3319         16  CF-1ST-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  59
* EL677.cbl
  3320         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3321         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3322         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3323         16  FILLER                         PIC  X(32).
  3324         16  CF-TERMINATION-FORM            PIC  X(04).
  3325         16  FILLER                         PIC  X(08).
  3326         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3327                                                       COMP-3.
  3328         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3329         16  CF-ISSUE-LETTER                PIC  X(4).
  3330         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3331         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3332             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3333             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3334         16  CF-MP-REFUND-CALC              PIC X.
  3335             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3336             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3337             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3338             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3339             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3340             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3341             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3342             88  CF-MP-REFD-MEAN                VALUE '8'.
  3343         16  CF-ALT-RATE-CODE               PIC  X(5).
  3344
  3345
  3346         16  FILLER                         PIC X(498).
  3347****************************************************************
  3348*             MORTGAGE COMPANY MASTER RECORD                   *
  3349****************************************************************
  3350
  3351     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3352         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3353         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3354             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3355             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3356             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3357             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3358             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3359
  3360         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3361         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3362         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3363         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3364         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3365
  3366         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3367             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3368         16  CF-MP-RECON-USE-IND            PIC X(1).
  3369             88  CF-MP-USE-RECON             VALUE 'Y'.
  3370         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3371             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3372         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3373             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3374             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3375         16  FILLER                         PIC X(1).
  3376         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3377             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  60
* EL677.cbl
  3378         16  CF-MORTG-MIB-VERSION           PIC X.
  3379             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3380             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3381             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3382         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3383             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3384                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3385             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3386                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3387             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3388                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3389             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3390                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3391             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3392                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3393             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3394                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3395         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3396         16  FILLER                         PIC X(7).
  3397         16  CF-MORTG-DESTINATION-SYMBOL.
  3398             20  CF-MORTG-MIB-COMM          PIC X(5).
  3399             20  CF-MORTG-MIB-TERM          PIC X(5).
  3400         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3401             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3402         16  FILLER                         PIC X(03).
  3403         16  CF-MP-CHECK-NO-CONTROL.
  3404             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3405                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3406                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3407                                                ' ' LOW-VALUES.
  3408                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3409                                               VALUE '3'.
  3410         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3411         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3412         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3413             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3414                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3415             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3416                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3417             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3418                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3419             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3420                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3421             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3422                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3423             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3424                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3425         16  CF-MORTG-BILLING-AREA.
  3426             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3427                                            PIC X.
  3428         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3429         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3430         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3431         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3432             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3433             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3434         16  FILLER                         PIC X.
  3435         16  CF-MORTG-LABEL-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  61
* EL677.cbl
  3436             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3437             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3438         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3439         16  FILLER                         PIC X(8).
  3440         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3441         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3442         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3443         16  CF-ACH-COMPANY-ID.
  3444             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3445                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3446                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3447                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3448             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3449         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3450             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3451         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3452             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3453             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3454         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3455         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3456         16  FILLER                         PIC X(536).
  3457
  3458****************************************************************
  3459*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3460****************************************************************
  3461
  3462     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3463         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3464             20  CF-FEMALE-HEIGHT.
  3465                 24  CF-FEMALE-FT           PIC 99.
  3466                 24  CF-FEMALE-IN           PIC 99.
  3467             20  CF-FEMALE-MIN-WT           PIC 999.
  3468             20  CF-FEMALE-MAX-WT           PIC 999.
  3469         16  FILLER                         PIC X(428).
  3470
  3471     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3472         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3473             20  CF-MALE-HEIGHT.
  3474                 24  CF-MALE-FT             PIC 99.
  3475                 24  CF-MALE-IN             PIC 99.
  3476             20  CF-MALE-MIN-WT             PIC 999.
  3477             20  CF-MALE-MAX-WT             PIC 999.
  3478         16  FILLER                         PIC X(428).
  3479******************************************************************
  3480*             AUTOMATIC ACTIVITY RECORD                          *
  3481******************************************************************
  3482     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3483         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3484             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3485             20  CF-SYS-LETTER-ID           PIC X(04).
  3486             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3487             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3488             20  CF-SYS-RESET-SW            PIC X(01).
  3489             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3490             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3491
  3492         16  FILLER                         PIC X(50).
  3493
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  62
* EL677.cbl
  3494         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3495             20  CF-USER-ACTIVE-SW          PIC X(01).
  3496             20  CF-USER-LETTER-ID          PIC X(04).
  3497             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3498             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3499             20  CF-USER-RESET-SW           PIC X(01).
  3500             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3501             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3502             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3503
  3504         16  FILLER                         PIC X(246).
  3505*                                COPY ERCCHEK.
  3506******************************************************************
  3507*                                                                *
  3508*                                                                *
  3509*                            ERCCHEK                             *
  3510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3511*                            VMOD=2.008                          *
  3512*                                                                *
  3513*   FILE DESCRIPTION = CHECK RECORDS                             *
  3514*                                                                *
  3515*   FILE TYPE = VSAM,KSDS                                        *
  3516*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3517*                                                                *
  3518*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3519*       ALTERNATE INDEX = NONE                                   *
  3520*                                                                *
  3521*   LOG = YES                                                    *
  3522*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3523******************************************************************
  3524*                   C H A N G E   L O G
  3525*
  3526* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3527*-----------------------------------------------------------------
  3528*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3529* EFFECTIVE    NUMBER
  3530*-----------------------------------------------------------------
  3531* 021414    2003053000001  PEMA  changes for auto chk request
  3532******************************************************************
  3533 01  CHECK-RECORDS.
  3534     12  CH-RECORD-ID                      PIC XX.
  3535         88  VALID-CH-ID                      VALUE 'CH'.
  3536
  3537     12  CH-CONTROL-PRIMARY.
  3538         16  CH-COMPANY-CD                 PIC X.
  3539         16  CH-CARRIER                    PIC X.
  3540         16  CH-GROUPING                   PIC X(6).
  3541         16  CH-STATE                      PIC XX.
  3542         16  CH-ACCOUNT                    PIC X(10).
  3543         16  CH-CERT-EFF-DT                PIC XX.
  3544         16  CH-CERT-NO.
  3545             20  CH-CERT-PRIME             PIC X(10).
  3546             20  CH-CERT-SFX               PIC X.
  3547         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3548
  3549     12  CH-RECORDED-DT                    PIC XX.
  3550     12  CH-RECORDED-BY                    PIC X(4).
  3551     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  63
* EL677.cbl
  3552
  3553     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3554     12  CH-CHECK-NO                       PIC X(7).
  3555     12  CH-REASON-FOR-CHECK               PIC X(25).
  3556     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3557     12  FILLER                            PIC X.
  3558
  3559     12  CH-PAYEE-INFO.
  3560         16  CH-PAYEE-NAME-1               PIC X(30).
  3561         16  CH-PAYEE-NAME-2               PIC X(30).
  3562         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3563         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3564         16  CH-PAYEE-CITY-ST.
  3565             20  CH-PAYEE-CITY             PIC X(28).
  3566             20  CH-PAYEE-STATE            PIC XX.
  3567         16  CH-PAYEE-ZIP-CODE.
  3568             20  CH-PAYEE-ZIP.
  3569                 24  CH-ZIP-PRI-1ST        PIC X.
  3570                     88  CH-CANADIAN-POST-CODE
  3571                                           VALUES 'A' THRU 'Z'.
  3572                 24  FILLER                PIC X(4).
  3573             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3574         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3575             20  CH-CAN-POSTAL-1           PIC XXX.
  3576             20  CH-CAN-POSTAL-2           PIC XXX.
  3577             20  FILLER                    PIC XXX.
  3578
  3579     12  CH-CHECK-STUB-TEXT.
  3580         16  CH-STUB-LINE-1                PIC X(30).
  3581         16  CH-TEXT-LINE-1                PIC X(50).
  3582         16  CH-TEXT-LINE-2                PIC X(50).
  3583         16  CH-TEXT-LINE-3                PIC X(40).
  3584     12  CH-RETURN-TO                      PIC X(30).
  3585
  3586     12  CH-COMPENSATION-CONTROL.
  3587         16  CH-COMP-CARRIER               PIC X.
  3588         16  CH-COMP-GROUPING              PIC X(6).
  3589         16  CH-COMP-FIN-RESP              PIC X(10).
  3590         16  CH-COMP-ACCOUNT               PIC X(10).
  3591
  3592     12  CH-CREDIT-SELECT-DT               PIC XX.
  3593     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3594     12  CH-PAYEE-CODE                     PIC X(6).
  3595
  3596     12  CH-VOID-DATA.
  3597         20  CH-VOID-DT                    PIC XX.
  3598         20  CH-VOID-BY                    PIC X(4).
  3599         20  CH-VOID-REASON                PIC X(25).
  3600
  3601     12  CH-APPROVAL-DATA.
  3602         20  CH-APPROVAL-DT                PIC XX.
  3603         20  CH-APPROVAL-STATUS            PIC X.
  3604             88  CH-IN-LIMBO                  VALUE ' '.
  3605             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3606             88  CH-APPROVED                  VALUE 'A'.
  3607             88  CH-DENIED                    VALUE 'D'.
  3608         20  CH-APPROVED-BY                PIC XXXX.
  3609     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  64
* EL677.cbl
  3610             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3611     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3612
  3613     12  ch-released-dt                    pic xx.
  3614     12  ch-check-cashed-dt                pic xx.
  3615     12  FILLER                            PIC X.
  3616*    12  CH-CHECK-REFERENCE                PIC X(12).
  3617     12  CH-CHECK-ORIGIN-SW                PIC X.
  3618             88  CH-REFUND-CHECK              VALUE 'R'.
  3619             88  CH-MAINT-CHECK               VALUE 'M'.
  3620
  3621     12  CH-CANC-DT                        PIC XX.
  3622     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3623     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3624
  3625     12  CH-INSURED-NAME                   PIC X(28).
  3626
  3627     12  ch-released-by                    pic x(4).
  3628     12  ch-csr                            pic x(4).
  3629     12  ch-deduct-commission              pic x.
  3630         88  ch-deduct-comm                  value 'Y'.
  3631         88  ch-do-not-deduct-comm           value 'N'.
  3632
  3633     12  FILLER                            PIC X(11).
  3634*    12  CH-LETTER-TABLE.
  3635*        16  CH-LETTERS OCCURS 3 TIMES
  3636*                       INDEXED BY CH-LT-NDX
  3637*                                          PIC X(04).
  3638
  3639     12  FILLER                            PIC X(07).
  3640
  3641*                                COPY ERCACCT.
  3642******************************************************************
  3643*                                                                *
  3644*                                                                *
  3645*                            ERCACCT                             *
  3646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3647*                            VMOD=2.031                          *
  3648*                                                                *
  3649*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3650*                                                                *
  3651*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3652*   VSAM ACCOUNT MASTER FILES.                                   *
  3653*                                                                *
  3654*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3655*                                                                *
  3656*   FILE TYPE = VSAM,KSDS                                        *
  3657*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3658*                                                                *
  3659*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3660*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3661*                                                                *
  3662*   LOG = NO                                                     *
  3663*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3664*                                                                *
  3665*                                                                *
  3666******************************************************************
  3667*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  65
* EL677.cbl
  3668*
  3669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3670*-----------------------------------------------------------------
  3671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3672* EFFECTIVE    NUMBER
  3673*-----------------------------------------------------------------
  3674* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3675* 092705    2005050300006  PEMA  ADD SPP LEASES
  3676* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3677* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3678* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3679* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3680* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3681* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3682******************************************************************
  3683
  3684 01  ACCOUNT-MASTER.
  3685     12  AM-RECORD-ID                      PIC XX.
  3686         88  VALID-AM-ID                      VALUE 'AM'.
  3687
  3688     12  AM-CONTROL-PRIMARY.
  3689         16  AM-COMPANY-CD                 PIC X.
  3690         16  AM-MSTR-CNTRL.
  3691             20  AM-CONTROL-A.
  3692                 24  AM-CARRIER            PIC X.
  3693                 24  AM-GROUPING.
  3694                     28 AM-GROUPING-PREFIX PIC XXX.
  3695                     28 AM-GROUPING-PRIME  PIC XXX.
  3696                 24  AM-STATE              PIC XX.
  3697                 24  AM-ACCOUNT.
  3698                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3699                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3700             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3701                                           PIC X(19).
  3702             20  AM-CNTRL-B.
  3703                 24  AM-EXPIRATION-DT      PIC XX.
  3704                 24  FILLER                PIC X(4).
  3705             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3706                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3707
  3708     12  AM-CONTROL-BY-VAR-GRP.
  3709         16  AM-COMPANY-CD-A1              PIC X.
  3710         16  AM-VG-CARRIER                 PIC X.
  3711         16  AM-VG-GROUPING                PIC X(6).
  3712         16  AM-VG-STATE                   PIC XX.
  3713         16  AM-VG-ACCOUNT                 PIC X(10).
  3714         16  AM-VG-DATE.
  3715             20  AM-VG-EXPIRATION-DT       PIC XX.
  3716             20  FILLER                    PIC X(4).
  3717         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3718                                           PIC 9(11)      COMP-3.
  3719     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3720         16  FILLER                        PIC X(10).
  3721         16  AM-VG-KEY3.
  3722             20  AM-VG3-ACCOUNT            PIC X(10).
  3723             20  AM-VG3-EXP-DT             PIC XX.
  3724         16  FILLER                        PIC X(4).
  3725     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  66
* EL677.cbl
  3726         16  AM-LAST-MAINT-DT              PIC XX.
  3727         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3728         16  AM-LAST-MAINT-USER            PIC X(4).
  3729         16  FILLER                        PIC XX.
  3730
  3731     12  AM-EFFECTIVE-DT                   PIC XX.
  3732     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3733
  3734     12  AM-PREV-DATES  COMP-3.
  3735         16  AM-PREV-EXP-DT                PIC 9(11).
  3736         16  AM-PREV-EFF-DT                PIC 9(11).
  3737
  3738     12  AM-REPORT-CODE-1                  PIC X(10).
  3739     12  AM-REPORT-CODE-2                  PIC X(10).
  3740
  3741     12  AM-CITY-CODE                      PIC X(4).
  3742     12  AM-COUNTY-PARISH                  PIC X(6).
  3743
  3744     12  AM-NAME                           PIC X(30).
  3745     12  AM-PERSON                         PIC X(30).
  3746     12  AM-ADDRS                          PIC X(30).
  3747     12  AM-CITY.
  3748         16  AM-ADDR-CITY                  PIC X(28).
  3749         16  AM-ADDR-STATE                 PIC XX.
  3750     12  AM-ZIP.
  3751         16  AM-ZIP-PRIME.
  3752             20  AM-ZIP-PRI-1ST            PIC X.
  3753                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3754             20  FILLER                    PIC X(4).
  3755         16  AM-ZIP-PLUS4                  PIC X(4).
  3756     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3757         16  AM-CAN-POSTAL-1               PIC XXX.
  3758         16  AM-CAN-POSTAL-2               PIC XXX.
  3759         16  FILLER                        PIC XXX.
  3760     12  AM-TEL-NO.
  3761         16  AM-AREA-CODE                  PIC 999.
  3762         16  AM-TEL-PRE                    PIC 999.
  3763         16  AM-TEL-NBR                    PIC 9(4).
  3764     12  AM-TEL-LOC                        PIC X.
  3765         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3766         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3767
  3768     12  AM-COMM-STRUCTURE.
  3769         16  AM-DEFN-1.
  3770             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3771                 24  AM-AGT.
  3772                     28  AM-AGT-PREFIX     PIC X(4).
  3773                     28  AM-AGT-PRIME      PIC X(6).
  3774                 24  AM-COM-TYP            PIC X.
  3775                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3776                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3777                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3778                 24  AM-RECALC-LV-INDIC    PIC X.
  3779                 24  AM-RETRO-LV-INDIC     PIC X.
  3780                 24  AM-GL-CODES           PIC X.
  3781                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3782                 24  FILLER                PIC X(01).
  3783         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  67
* EL677.cbl
  3784             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3785                 24  FILLER                PIC X(11).
  3786                 24  AM-L-COMA             PIC XXX.
  3787                 24  AM-J-COMA             PIC XXX.
  3788                 24  AM-A-COMA             PIC XXX.
  3789                 24  FILLER                PIC X(6).
  3790
  3791     12  AM-COMM-CHANGE-STATUS             PIC X.
  3792         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3793
  3794     12  AM-CSR-CODE                       PIC X(4).
  3795
  3796     12  AM-BILLING-STATUS                 PIC X.
  3797         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3798         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3799     12  AM-AUTO-REFUND-SW                 PIC X.
  3800         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3801         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3802     12  AM-GPCD                           PIC 99.
  3803     12  AM-IG                             PIC X.
  3804         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3805         88  AM-HAS-GROUP                     VALUE '2'.
  3806     12  AM-STATUS                         PIC X.
  3807         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3808         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3809         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3810         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3811         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3812         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3813         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3814         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3815         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3816         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3817     12  AM-REMIT-TO                       PIC 99.
  3818     12  AM-ID-NO                          PIC X(11).
  3819
  3820     12  AM-CAL-TABLE                      PIC XX.
  3821     12  AM-LF-DEVIATION                   PIC XXX.
  3822     12  AM-AH-DEVIATION                   PIC XXX.
  3823     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3824     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3825     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3826     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3827     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3828     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3829
  3830     12  AM-USER-FIELDS.
  3831         16  AM-FLD-1                      PIC XX.
  3832         16  AM-FLD-2                      PIC XX.
  3833         16  AM-FLD-3                      PIC XX.
  3834         16  AM-FLD-4                      PIC XX.
  3835         16  AM-FLD-5                      PIC XX.
  3836
  3837     12  AM-1ST-PROD-DATE.
  3838         16  AM-1ST-PROD-YR                PIC XX.
  3839         16  AM-1ST-PROD-MO                PIC XX.
  3840         16  AM-1ST-PROD-DA                PIC XX.
  3841     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  68
* EL677.cbl
  3842     12  AM-CERTS-PURGED-DATE.
  3843         16  AM-PUR-YR                     PIC XX.
  3844         16  AM-PUR-MO                     PIC XX.
  3845         16  AM-PUR-DA                     PIC XX.
  3846     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3847     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3848     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3849     12  AM-INACTIVE-DATE.
  3850         16  AM-INA-MO                     PIC 99.
  3851         16  AM-INA-DA                     PIC 99.
  3852         16  AM-INA-YR                     PIC 99.
  3853     12  AM-AR-HI-CERT-DATE                PIC XX.
  3854
  3855     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3856     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3857
  3858     12  AM-OB-PAYMENT-MODE                PIC X.
  3859         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3860         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3861         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3862         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3863
  3864     12  AM-AH-ONLY-INDICATOR              PIC X.
  3865         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3866         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3867
  3868     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3869
  3870     12  AM-OVER-SHORT.
  3871         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3872         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3873
  3874     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3875     12  AM-DCC-CLP-STATE                  PIC XX.
  3876
  3877     12  AM-RECALC-COMM                    PIC X.
  3878     12  AM-RECALC-REIN                    PIC X.
  3879
  3880     12  AM-REI-TABLE                      PIC XXX.
  3881     12  AM-REI-ET-LF                      PIC X.
  3882     12  AM-REI-ET-AH                      PIC X.
  3883     12  AM-REI-PE-LF                      PIC X.
  3884     12  AM-REI-PE-AH                      PIC X.
  3885     12  AM-REI-PRT-ST                     PIC X.
  3886     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3887     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3888     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3889     12  AM-REI-GROUP-A                    PIC X(6).
  3890     12  AM-REI-MORT                       PIC X(4).
  3891     12  AM-REI-PRT-OW                     PIC X.
  3892     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3893     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3894     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3895     12  AM-REI-GROUP-B                    PIC X(6).
  3896
  3897     12  AM-TRUST-TYPE                     PIC X(2).
  3898
  3899     12  AM-EMPLOYER-STMT-USED             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  69
* EL677.cbl
  3900     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3901
  3902     12  AM-STD-AH-TYPE                    PIC XX.
  3903     12  AM-EARN-METHODS.
  3904         16  AM-EARN-METHOD-R              PIC X.
  3905             88 AM-REF-RL-R78                 VALUE 'R'.
  3906             88 AM-REF-RL-PR                  VALUE 'P'.
  3907             88 AM-REF-RL-MEAN                VALUE 'M'.
  3908             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3909         16  AM-EARN-METHOD-L              PIC X.
  3910             88 AM-REF-LL-R78                 VALUE 'R'.
  3911             88 AM-REF-LL-PR                  VALUE 'P'.
  3912             88 AM-REF-LL-MEAN                VALUE 'M'.
  3913             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3914         16  AM-EARN-METHOD-A              PIC X.
  3915             88 AM-REF-AH-R78                 VALUE 'R'.
  3916             88 AM-REF-AH-PR                  VALUE 'P'.
  3917             88 AM-REF-AH-MEAN                VALUE 'M'.
  3918             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3919             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3920             88 AM-REF-AH-NET                 VALUE 'N'.
  3921
  3922     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3923     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3924     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3925
  3926     12  AM-RET-Y-N                        PIC X.
  3927     12  AM-RET-P-E                        PIC X.
  3928     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3929     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3930     12  AM-RET-GRP                        PIC X(6).
  3931     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3932         16  AM-POOL-PRIME                 PIC XXX.
  3933         16  AM-POOL-SUB                   PIC XXX.
  3934     12  AM-RETRO-EARNINGS.
  3935         16  AM-RET-EARN-R                 PIC X.
  3936         16  AM-RET-EARN-L                 PIC X.
  3937         16  AM-RET-EARN-A                 PIC X.
  3938     12  AM-RET-ST-TAX-USE                 PIC X.
  3939         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3940         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3941     12  AM-RETRO-BEG-EARNINGS.
  3942         16  AM-RET-BEG-EARN-R             PIC X.
  3943         16  AM-RET-BEG-EARN-L             PIC X.
  3944         16  AM-RET-BEG-EARN-A             PIC X.
  3945     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3946     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3947
  3948     12  AM-USER-SELECT-OPTIONS.
  3949         16  AM-USER-SELECT-1              PIC X(10).
  3950         16  AM-USER-SELECT-2              PIC X(10).
  3951         16  AM-USER-SELECT-3              PIC X(10).
  3952         16  AM-USER-SELECT-4              PIC X(10).
  3953         16  AM-USER-SELECT-5              PIC X(10).
  3954
  3955     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3956
  3957     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  70
* EL677.cbl
  3958
  3959     12  AM-RPT045A-SWITCH                 PIC X.
  3960         88  RPT045A-OFF                   VALUE 'N'.
  3961
  3962     12  AM-INSURANCE-LIMITS.
  3963         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3964         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3965
  3966     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3967         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3968
  3969     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3970         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3971         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3972
  3973     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3974
  3975     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3976     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3977     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3978     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3979     12  AM-DCC-UEF-STATE                  PIC XX.
  3980     12  FILLER                            PIC XXX.
  3981     12  AM-REPORT-CODE-3                  PIC X(10).
  3982*    12  FILLER                            PIC X(22).
  3983
  3984     12  AM-RESERVE-DATE.
  3985         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3986         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3987         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3988
  3989     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3990     12  AM-NOTIFICATION-TYPES.
  3991         16  AM-NOTIF-OF-LETTERS           PIC X.
  3992         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3993         16  AM-NOTIF-OF-REPORTS           PIC X.
  3994         16  AM-NOTIF-OF-STATUS            PIC X.
  3995
  3996     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3997         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3998         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3999         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4000         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4001
  4002     12  AM-BENEFIT-CONTROLS.
  4003         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4004             20  AM-BENEFIT-CODE           PIC XX.
  4005             20  AM-BENEFIT-TYPE           PIC X.
  4006             20  AM-BENEFIT-REVISION       PIC XXX.
  4007             20  AM-BENEFIT-REM-TERM       PIC X.
  4008             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4009             20  FILLER                    PIC XX.
  4010         16  FILLER                        PIC X(80).
  4011
  4012     12  AM-TRANSFER-DATA.
  4013         16  AM-TRANSFERRED-FROM.
  4014             20  AM-TRNFROM-CARRIER        PIC X.
  4015             20  AM-TRNFROM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  71
* EL677.cbl
  4016                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4017                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4018             20  AM-TRNFROM-STATE          PIC XX.
  4019             20  AM-TRNFROM-ACCOUNT.
  4020                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4021                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4022             20  AM-TRNFROM-DTE            PIC XX.
  4023         16  AM-TRANSFERRED-TO.
  4024             20  AM-TRNTO-CARRIER          PIC X.
  4025             20  AM-TRNTO-GROUPING.
  4026                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4027                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4028             20  AM-TRNTO-STATE            PIC XX.
  4029             20  AM-TRNTO-ACCOUNT.
  4030                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4031                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4032             20  AM-TRNTO-DTE              PIC XX.
  4033         16  FILLER                        PIC X(10).
  4034
  4035     12  AM-SAVED-REMIT-TO                 PIC 99.
  4036
  4037     12  AM-COMM-STRUCTURE-SAVED.
  4038         16  AM-DEFN-1-SAVED.
  4039             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4040                 24  AM-AGT-SV             PIC X(10).
  4041                 24  AM-COM-TYP-SV         PIC X.
  4042                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4043                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4044                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4045                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4046                 24  FILLER                PIC X.
  4047                 24  AM-GL-CODES-SV        PIC X.
  4048                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4049                 24  FILLER                PIC X.
  4050         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4051             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4052                 24  FILLER                PIC X(11).
  4053                 24  AM-L-COMA-SV          PIC XXX.
  4054                 24  AM-J-COMA-SV          PIC XXX.
  4055                 24  AM-A-COMA-SV          PIC XXX.
  4056                 24  FILLER                PIC X(6).
  4057
  4058     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4059         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4060            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4061            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4062            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4063
  4064     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4065     12  FILLER                            PIC X(120).
  4066
  4067     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4068         16  AM-CONTROL-NAME               PIC X(30).
  4069         16  AM-EXECUTIVE-ONE.
  4070             20  AM-EXEC1-NAME             PIC X(15).
  4071             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4072                                                          COMP-3.
  4073             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  72
* EL677.cbl
  4074                                                          COMP-3.
  4075         16  AM-EXECUTIVE-TWO.
  4076             20  AM-EXEC2-NAME             PIC X(15).
  4077             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4078                                                          COMP-3.
  4079             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4080                                                          COMP-3.
  4081
  4082     12  AM-RETRO-ADDITIONAL-DATA.
  4083         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4084         16  AM-RETRO-PREM-P-E             PIC X.
  4085         16  AM-RETRO-CLMS-P-I             PIC X.
  4086         16  AM-RETRO-RET-BRACKET-LF.
  4087             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4088                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4089                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4090             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4091                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4092                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4093             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4094                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4095                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4096         16  AM-RETRO-RET-BRACKET-AH.
  4097             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4098                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4099                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4100                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4101             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4102                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4103                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4104             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4105                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4106                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4107
  4108     12  AM-COMMENTS.
  4109         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4110
  4111     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4112         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4113         16  AM-FLI-BILLING-CODE           PIC X.
  4114         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4115         16  AM-FLI-UNITED-IDENT           PIC X.
  4116         16  AM-FLI-INTEREST-LOST-DATA.
  4117             20  AM-FLI-BANK-NO            PIC X(5).
  4118             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4119             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4120             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4121         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4122             20  AM-FLI-AGT                PIC X(9).
  4123             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4124             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4125         16  FILLER                        PIC X(102).
  4126
  4127     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4128         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4129             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4130             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4131             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  73
* EL677.cbl
  4132             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4133             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4134         16  FILLER                          PIC X(10).
  4135******************************************************************
  4136*                                COPY ERCCOMP.
  4137******************************************************************
  4138*                                                                *
  4139*                                                                *
  4140*                            ERCCOMP                             *
  4141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4142*                            VMOD=2.019                          *
  4143*                                                                *
  4144*   ONLINE CREDIT SYSTEM                                         *
  4145*                                                                *
  4146*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4147*                                                                *
  4148*   FILE TYPE = VSAM,KSDS                                        *
  4149*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4150*                                                                *
  4151*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4152*       ALTERNATE PATH = NONE                                    *
  4153*                                                                *
  4154*   LOG = NO                                                     *
  4155*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4156*                                                                *
  4157******************************************************************
  4158*                   C H A N G E   L O G
  4159*
  4160* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4161*-----------------------------------------------------------------
  4162*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4163* EFFECTIVE    NUMBER
  4164*-----------------------------------------------------------------
  4165* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4166* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4167* 092205    2005050300006  PEMA  ADD LEASE FEE
  4168* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4169* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4170* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4171* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4172* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4173* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4174******************************************************************
  4175
  4176 01  COMPENSATION-MASTER.
  4177     12  CO-RECORD-ID                          PIC XX.
  4178         88  VALID-CO-ID                          VALUE 'CO'.
  4179
  4180     12  CO-CONTROL-PRIMARY.
  4181         16  CO-COMPANY-CD                     PIC X.
  4182         16  CO-CONTROL.
  4183             20  CO-CTL-1.
  4184                 24  CO-CARR-GROUP.
  4185                     28  CO-CARRIER            PIC X.
  4186                     28  CO-GROUPING.
  4187                         32  CO-GROUP-PREFIX   PIC XXX.
  4188                         32  CO-GROUP-PRIME    PIC XXX.
  4189                 24  CO-RESP-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  74
* EL677.cbl
  4190                     28  CO-RESP-PREFIX        PIC X(4).
  4191                     28  CO-RESP-PRIME         PIC X(6).
  4192             20  CO-CTL-2.
  4193                 24  CO-ACCOUNT.
  4194                     28  CO-ACCT-PREFIX        PIC X(4).
  4195                     28  CO-ACCT-PRIME         PIC X(6).
  4196         16  CO-TYPE                           PIC X.
  4197             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4198             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4199             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4200
  4201     12  CO-MAINT-INFORMATION.
  4202         16  CO-LAST-MAINT-DT                  PIC XX.
  4203         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4204         16  CO-LAST-MAINT-USER                PIC X(4).
  4205     12  FILLER                                PIC XX.
  4206     12  CO-STMT-TYPE                          PIC XXX.
  4207     12  CO-COMP-TYPE                          PIC X.
  4208         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4209     12  CO-STMT-OWNER                         PIC X(4).
  4210     12  CO-BALANCE-CONTROL                    PIC X.
  4211         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4212         88  CO-NO-BALANCE                        VALUE 'N'.
  4213
  4214     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4215         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4216         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4217         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4218
  4219     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4220         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4221         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4222
  4223     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4224     12  CO-GA-DIRECT-DEP                      PIC X.
  4225     12  CO-FUTURE-SPACE                       PIC X.
  4226         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4227
  4228     12  CO-ACCT-NAME                          PIC X(30).
  4229     12  CO-MAIL-NAME                          PIC X(30).
  4230     12  CO-ADDR-1                             PIC X(30).
  4231     12  CO-ADDR-2                             PIC X(30).
  4232     12  CO-ADDR-3.
  4233         16  CO-ADDR-CITY                      PIC X(27).
  4234         16  CO-ADDR-STATE                     PIC XX.
  4235     12  CO-CSO-1099                           PIC X.
  4236     12  CO-ZIP.
  4237         16  CO-ZIP-PRIME.
  4238             20  CO-ZIP-PRI-1ST                PIC X.
  4239                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4240             20  FILLER                        PIC X(4).
  4241         16  CO-ZIP-PLUS4                      PIC X(4).
  4242     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4243         16  CO-CAN-POSTAL-1                   PIC XXX.
  4244         16  CO-CAN-POSTAL-2                   PIC XXX.
  4245         16  FILLER                            PIC XXX.
  4246     12  CO-SOC-SEC                            PIC X(13).
  4247     12  CO-TELEPHONE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  75
* EL677.cbl
  4248         16  CO-AREA-CODE                      PIC XXX.
  4249         16  CO-PREFIX                         PIC XXX.
  4250         16  CO-PHONE                          PIC X(4).
  4251
  4252     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4253
  4254     12  CO-AR-BAL-LEVEL                       PIC X.
  4255         88  CO-AR-REF-LVL                        VALUE '1'.
  4256         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4257         88  CO-AR-BILL-LVL                       VALUE '2'.
  4258         88  CO-AR-AGT-LVL                        VALUE '3'.
  4259         88  CO-AR-FR-LVL                         VALUE '4'.
  4260
  4261     12  CO-AR-NORMAL-PRINT                    PIC X.
  4262         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4263         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4264
  4265     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4266
  4267     12  CO-AR-REPORTING                       PIC X.
  4268         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4269         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4270
  4271     12  CO-AR-PULL-CHECK                      PIC X.
  4272         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4273         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4274
  4275     12  CO-AR-BALANCE-PRINT                   PIC X.
  4276         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4277
  4278     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4279         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4280         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4281         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4282
  4283     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4284
  4285     12  CO-USER-CODE                          PIC X.
  4286     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4287
  4288******************************************************************
  4289*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4290*    THE LAST MONTH END RUN.
  4291******************************************************************
  4292
  4293     12  CO-LAST-ACTIVITY-DATE.
  4294         16  CO-ACT-YEAR                       PIC 99.
  4295         16  CO-ACT-MONTH                      PIC 99.
  4296         16  CO-ACT-DAY                        PIC 99.
  4297
  4298     12  CO-LAST-STMT-DT.
  4299         16  CO-LAST-STMT-YEAR                 PIC 99.
  4300         16  CO-LAST-STMT-MONTH                PIC 99.
  4301         16  CO-LAST-STMT-DAY                  PIC 99.
  4302
  4303     12  CO-MO-END-TOTALS.
  4304         16  CO-MONTHLY-TOTALS.
  4305             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  76
* EL677.cbl
  4306             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4307             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4308             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4309             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4310
  4311         16  CO-AGING-TOTALS.
  4312             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4313             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4314             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4315             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4316
  4317         16  CO-YTD-TOTALS.
  4318             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4319             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4320
  4321         16  CO-OVER-UNDER-TOTALS.
  4322             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4323             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4324
  4325     12  CO-MISCELLANEOUS-TOTALS.
  4326         16  CO-FICA-TOTALS.
  4327             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4328             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4329
  4330         16  CO-CLAIM-TOTALS.
  4331             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4332             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4333
  4334******************************************************************
  4335*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4336*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4337******************************************************************
  4338
  4339     12  CO-CURRENT-TOTALS.
  4340         16  CO-CURRENT-LAST-STMT-DT.
  4341             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4342             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4343             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4344
  4345         16  CO-CURRENT-MONTHLY-TOTALS.
  4346             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4347             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4348             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4349             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4350             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4351
  4352         16  CO-CURRENT-AGING-TOTALS.
  4353             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4354             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4355             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4356             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4357
  4358         16  CO-CURRENT-YTD-TOTALS.
  4359             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4360             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4361
  4362     12  CO-PAID-COMM-TOTALS.
  4363         16  CO-YTD-PAID-COMMS.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  77
* EL677.cbl
  4364             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4365             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4366
  4367     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4368         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4369         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4370
  4371     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4372         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4373         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4374         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4375         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4376         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4377         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4378         88  CO-FINAL-LETTER                  VALUE 'F'.
  4379         88  CO-RECONCILING                   VALUE 'R'.
  4380         88  CO-PHONE-CALL                    VALUE 'P'.
  4381         88  CO-LEGAL                         VALUE 'L'.
  4382         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4383         88  CO-WRITE-OFF                     VALUE 'W'.
  4384         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4385
  4386     12  CO-CSR-CODE                       PIC X(4).
  4387
  4388     12  CO-GA-STATUS-INFO.
  4389         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4390         16  CO-GA-TERMINATION-DT          PIC XX.
  4391         16  CO-GA-STATUS-CODE             PIC X.
  4392             88  CO-GA-ACTIVE                 VALUE 'A'.
  4393             88  CO-GA-INACTIVE               VALUE 'I'.
  4394             88  CO-GA-PENDING                VALUE 'P'.
  4395         16  CO-GA-COMMENTS.
  4396             20  CO-GA-COMMENT-1           PIC X(40).
  4397             20  CO-GA-COMMENT-2           PIC X(40).
  4398             20  CO-GA-COMMENT-3           PIC X(40).
  4399             20  CO-GA-COMMENT-4           PIC X(40).
  4400
  4401     12  CO-RPTCD2                         PIC X(10).
  4402     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4403         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4404         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4405
  4406     12  CO-TYPE-AGENT                     PIC X(01).
  4407         88  CO-CORPORATION                   VALUE 'C'.
  4408         88  CO-PARTNERSHIP                   VALUE 'P'.
  4409         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4410         88  CO-TRUST                         VALUE 'T'.
  4411         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4412
  4413     12  CO-FAXNO.
  4414         16  CO-FAX-AREA-CODE                  PIC XXX.
  4415         16  CO-FAX-PREFIX                     PIC XXX.
  4416         16  CO-FAX-PHONE                      PIC X(4).
  4417
  4418     12  CO-BANK-INFORMATION.
  4419         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4420         16  CO-BANK-TRANSIT-NON REDEFINES
  4421             CO-BANK-TRANSIT-NO                PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  78
* EL677.cbl
  4422
  4423         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4424     12  CO-MISC-DEDUCT-INFO REDEFINES
  4425                  CO-BANK-INFORMATION.
  4426         16  CO-MD-GL-ACCT                     PIC X(10).
  4427         16  CO-MD-DIV                         PIC XX.
  4428         16  CO-MD-CENTER                      PIC X(4).
  4429         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4430         16  CO-CREATE-AP-CHECK                PIC X.
  4431         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4432         16  FILLER                            PIC XXX.
  4433     12  CO-ACH-STATUS                         PIC X.
  4434         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4435         88  CO-ACH-PENDING                        VALUE 'P'.
  4436
  4437     12  CO-BILL-SW                            PIC X.
  4438     12  CO-CONTROL-NAME                       PIC X(30).
  4439     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4440     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4441     12  CO-CLP-STATE                          PIC XX.
  4442     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4443     12  CO-SPP-REFUND-EDIT                    PIC X.
  4444
  4445******************************************************************
  4446*                                COPY ELCCERT.
  4447******************************************************************
  4448*                                                                *
  4449*                            ELCCERT.                            *
  4450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4451*                            VMOD=2.013                          *
  4452*                                                                *
  4453*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4454*                                                                *
  4455*   FILE TYPE = VSAM,KSDS                                        *
  4456*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4457*                                                                *
  4458*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4459*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4460*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4461*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4462*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4463*                                                                *
  4464*   LOG = YES                                                    *
  4465*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4466******************************************************************
  4467*                   C H A N G E   L O G
  4468*
  4469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4470*-----------------------------------------------------------------
  4471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4472* EFFECTIVE    NUMBER
  4473*-----------------------------------------------------------------
  4474* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4475* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4476* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4477* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4478* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4479* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  79
* EL677.cbl
  4480* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4481* 032612  CR2011110200001  PEMA  AHL CHANGES
  4482* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4483* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4484* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4485******************************************************************
  4486
  4487 01  CERTIFICATE-MASTER.
  4488     12  CM-RECORD-ID                      PIC XX.
  4489         88  VALID-CM-ID                      VALUE 'CM'.
  4490
  4491     12  CM-CONTROL-PRIMARY.
  4492         16  CM-COMPANY-CD                 PIC X.
  4493         16  CM-CARRIER                    PIC X.
  4494         16  CM-GROUPING.
  4495             20  CM-GROUPING-PREFIX        PIC X(3).
  4496             20  CM-GROUPING-PRIME         PIC X(3).
  4497         16  CM-STATE                      PIC XX.
  4498         16  CM-ACCOUNT.
  4499             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4500             20  CM-ACCOUNT-PRIME          PIC X(6).
  4501         16  CM-CERT-EFF-DT                PIC XX.
  4502         16  CM-CERT-NO.
  4503             20  CM-CERT-PRIME             PIC X(10).
  4504             20  CM-CERT-SFX               PIC X.
  4505
  4506     12  CM-CONTROL-BY-NAME.
  4507         16  CM-COMPANY-CD-A1              PIC X.
  4508         16  CM-INSURED-LAST-NAME          PIC X(15).
  4509         16  CM-INSURED-INITIALS.
  4510             20  CM-INSURED-INITIAL1       PIC X.
  4511             20  CM-INSURED-INITIAL2       PIC X.
  4512
  4513     12  CM-CONTROL-BY-SSN.
  4514         16  CM-COMPANY-CD-A2              PIC X.
  4515         16  CM-SOC-SEC-NO.
  4516             20  CM-SSN-STATE              PIC XX.
  4517             20  CM-SSN-ACCOUNT            PIC X(6).
  4518             20  CM-SSN-LN3.
  4519                 25  CM-INSURED-INITIALS-A2.
  4520                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4521                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4522                 25 CM-PART-LAST-NAME-A2         PIC X.
  4523
  4524     12  CM-CONTROL-BY-CERT-NO.
  4525         16  CM-COMPANY-CD-A4              PIC X.
  4526         16  CM-CERT-NO-A4                 PIC X(11).
  4527
  4528     12  CM-CONTROL-BY-MEMB.
  4529         16  CM-COMPANY-CD-A5              PIC X.
  4530         16  CM-MEMBER-NO.
  4531             20  CM-MEMB-STATE             PIC XX.
  4532             20  CM-MEMB-ACCOUNT           PIC X(6).
  4533             20  CM-MEMB-LN4.
  4534                 25  CM-INSURED-INITIALS-A5.
  4535                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4536                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4537                 25 CM-PART-LAST-NAME-A5         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  80
* EL677.cbl
  4538
  4539     12  CM-INSURED-PROFILE-DATA.
  4540         16  CM-INSURED-FIRST-NAME.
  4541             20  CM-INSURED-1ST-INIT       PIC X.
  4542             20  FILLER                    PIC X(9).
  4543         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4544         16  CM-INSURED-SEX                PIC X.
  4545             88  CM-SEX-MALE                  VALUE 'M'.
  4546             88  CM-SEX-FEMAL                 VALUE 'F'.
  4547         16  CM-INSURED-JOINT-AGE          PIC 99.
  4548         16  CM-JOINT-INSURED-NAME.
  4549             20  CM-JT-LAST-NAME           PIC X(15).
  4550             20  CM-JT-FIRST-NAME.
  4551                 24  CM-JT-1ST-INIT        PIC X.
  4552                 24  FILLER                PIC X(9).
  4553             20  CM-JT-INITIAL             PIC X.
  4554
  4555     12  CM-LIFE-DATA.
  4556         16  CM-LF-BENEFIT-CD              PIC XX.
  4557         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4558         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4559         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4560         16  CM-LF-DEV-CODE                PIC XXX.
  4561         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4562         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4563         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4564         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4565         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4566         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4567         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4568         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4569         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4570         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4571         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4572         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4573         16  cm-temp-epiq                  pic xx.
  4574             88  EPIQ-CLASS                  value 'EQ'.
  4575*        16  FILLER                        PIC XX.
  4576
  4577     12  CM-AH-DATA.
  4578         16  CM-AH-BENEFIT-CD              PIC XX.
  4579         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4580         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4581         16  CM-AH-DEV-CODE                PIC XXX.
  4582         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4583         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4584         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4585         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4586         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4587         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4588         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4589         16  CM-AH-PAID-THRU-DT            PIC XX.
  4590             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4591         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4592         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4593         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4594         16  FILLER                        PIC X.
  4595
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  81
* EL677.cbl
  4596     12  CM-LOAN-INFORMATION.
  4597         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4598         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4599                                           PIC S9(5)V99  COMP-3.
  4600         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4601         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4602         16  CM-PAY-FREQUENCY              PIC S99.
  4603         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4604         16  CM-RATE-CLASS                 PIC XX.
  4605         16  CM-BENEFICIARY                PIC X(25).
  4606         16  CM-POLICY-FORM-NO             PIC X(12).
  4607         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4608         16  CM-LAST-ADD-ON-DT             PIC XX.
  4609         16  CM-DEDUCTIBLE-AMOUNTS.
  4610             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4611             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4612         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4613             20  CM-RESIDENT-STATE         PIC XX.
  4614             20  CM-RATE-CODE              PIC X(4).
  4615             20  FILLER                    PIC XX.
  4616         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4617             20  CM-LOAN-OFFICER           PIC X(5).
  4618             20  FILLER                    PIC XXX.
  4619         16  CM-CSR-CODE                   PIC XXX.
  4620         16  CM-UNDERWRITING-CODE          PIC X.
  4621             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4622         16  CM-POST-CARD-IND              PIC X.
  4623         16  CM-REF-INTERFACE-SW           PIC X.
  4624         16  CM-PREMIUM-TYPE               PIC X.
  4625             88  CM-SING-PRM                  VALUE '1'.
  4626             88  CM-O-B-COVERAGE              VALUE '2'.
  4627             88  CM-OPEN-END                  VALUE '3'.
  4628         16  CM-IND-GRP-TYPE               PIC X.
  4629             88  CM-INDIVIDUAL                VALUE 'I'.
  4630             88  CM-GROUP                     VALUE 'G'.
  4631         16  CM-SKIP-CODE                  PIC X.
  4632             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4633             88  SKIP-JULY                    VALUE '1'.
  4634             88  SKIP-AUGUST                  VALUE '2'.
  4635             88  SKIP-SEPTEMBER               VALUE '3'.
  4636             88  SKIP-JULY-AUG                VALUE '4'.
  4637             88  SKIP-AUG-SEPT                VALUE '5'.
  4638             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4639             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4640             88  SKIP-JUNE                    VALUE '8'.
  4641             88  SKIP-JUNE-JULY               VALUE '9'.
  4642             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4643             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4644         16  CM-PAYMENT-MODE               PIC X.
  4645             88  PAY-MONTHLY                  VALUE SPACE.
  4646             88  PAY-WEEKLY                   VALUE '1'.
  4647             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4648             88  PAY-BI-WEEKLY                VALUE '3'.
  4649             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4650         16  CM-LOAN-NUMBER                PIC X(8).
  4651         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4652         16  CM-OLD-LOF                    PIC XXX.
  4653*        16  CM-LOAN-OFFICER               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  82
* EL677.cbl
  4654         16  CM-REIN-TABLE                 PIC XXX.
  4655         16  CM-SPECIAL-REIN-CODE          PIC X.
  4656         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4657         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4658         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4659
  4660     12  CM-STATUS-DATA.
  4661         16  CM-ENTRY-STATUS               PIC X.
  4662         16  CM-ENTRY-DT                   PIC XX.
  4663
  4664         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4665         16  CM-LF-CANCEL-DT               PIC XX.
  4666         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4667
  4668         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4669         16  CM-LF-DEATH-DT                PIC XX.
  4670         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4671
  4672         16  CM-LF-CURRENT-STATUS          PIC X.
  4673             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4674                                                'M' '4' '5' '9'.
  4675             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4676             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4677             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4678             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4679             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4680             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4681             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4682             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4683             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4684             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4685             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4686             88  CM-LF-DECLINED               VALUE 'D'.
  4687             88  CM-LF-VOIDED                 VALUE 'V'.
  4688
  4689         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4690         16  CM-AH-CANCEL-DT               PIC XX.
  4691         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4692
  4693         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4694         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4695         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4696
  4697         16  CM-AH-CURRENT-STATUS          PIC X.
  4698             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4699                                                'M' '4' '5' '9'.
  4700             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4701             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4702             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4703             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4704             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4705             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4706             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4707             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4708             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4709             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4710             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4711             88  CM-AH-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  83
* EL677.cbl
  4712             88  CM-AH-VOIDED                 VALUE 'V'.
  4713
  4714         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4715             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4716             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4717             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4718         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4719
  4720         16  CM-ENTRY-BATCH                PIC X(6).
  4721         16  CM-LF-EXIT-BATCH              PIC X(6).
  4722         16  CM-AH-EXIT-BATCH              PIC X(6).
  4723         16  CM-LAST-MONTH-END             PIC XX.
  4724
  4725     12  CM-NOTE-SW                        PIC X.
  4726         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4727         88  CERT-NOTES-PRESENT               VALUE '1'.
  4728         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4729         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4730         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4731         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4732         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4733         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4734     12  CM-COMP-EXCP-SW                   PIC X.
  4735         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4736         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4737     12  CM-INSURED-ADDRESS-SW             PIC X.
  4738         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4739         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4740
  4741*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4742     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4743     12  FILLER                            PIC X.
  4744
  4745*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4746     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4747     12  FILLER                            PIC X.
  4748*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4749     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4750
  4751     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4752         88  CERT-ADDED-BATCH                 VALUE ' '.
  4753         88  CERT-ADDED-ONLINE                VALUE '1'.
  4754         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4755         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4756         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4757     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4758         88  CERT-AS-LOADED                   VALUE ' '.
  4759         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4760         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4761         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4762         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4763         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4764         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4765         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4766
  4767     12  CM-ACCOUNT-COMM-PCTS.
  4768         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4769         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  84
* EL677.cbl
  4770
  4771     12  CM-USER-FIELD                     PIC X.
  4772     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4773     12  CM-CLP-STATE                      PIC XX.
  4774     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4775     12  CM-USER-RESERVED                  PIC XXX.
  4776     12  FILLER REDEFINES CM-USER-RESERVED.
  4777         16  CM-AH-CLASS-CD                PIC XX.
  4778         16  F                             PIC X.
  4779******************************************************************
  4780*                                COPY ERCPNDB.
  4781******************************************************************
  4782*                                                                *
  4783*                                                                *
  4784*                            ERCPNDB.                            *
  4785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4786*                            VMOD=2.025                          *
  4787*                                                                *
  4788*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4789*                                                                *
  4790******************************************************************
  4791*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4792*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4793******************************************************************
  4794*                                                                *
  4795*                                                                *
  4796*   FILE TYPE = VSAM,KSDS                                        *
  4797*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4798*                                                                *
  4799*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4800*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4801*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4802*                                                 RKP=13,LEN=36  *
  4803*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4804*                                      AND CHG-SEQ.)             *
  4805*                                                RKP=49,LEN=11   *
  4806*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4807*                                      AND CHG-SEQ.)             *
  4808*                                                RKP=60,LEN=15   *
  4809*                                                                *
  4810*   LOG = NO                                                     *
  4811*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4812******************************************************************
  4813******************************************************************
  4814*                   C H A N G E   L O G
  4815*
  4816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4817*-----------------------------------------------------------------
  4818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4819* EFFECTIVE    NUMBER
  4820*-----------------------------------------------------------------
  4821* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4822* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4823* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4824* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4825* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4826* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4827* 032306                   PEMA  ADD BOW LOAN NUMBER
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  85
* EL677.cbl
  4828* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4829* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4830* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4831* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4832* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4833* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4834* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4835* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4836* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4837* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4838* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4839* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4840******************************************************************
  4841
  4842 01  PENDING-BUSINESS.
  4843     12  PB-RECORD-ID                     PIC XX.
  4844         88  VALID-PB-ID                        VALUE 'PB'.
  4845
  4846     12  PB-CONTROL-PRIMARY.
  4847         16  PB-COMPANY-CD                PIC X.
  4848         16  PB-ENTRY-BATCH               PIC X(6).
  4849         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4850         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4851
  4852     12  PB-CONTROL-BY-ACCOUNT.
  4853         16  PB-COMPANY-CD-A1             PIC X.
  4854         16  PB-CARRIER                   PIC X.
  4855         16  PB-GROUPING.
  4856             20  PB-GROUPING-PREFIX       PIC XXX.
  4857             20  PB-GROUPING-PRIME        PIC XXX.
  4858         16  PB-STATE                     PIC XX.
  4859         16  PB-ACCOUNT.
  4860             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4861             20  PB-ACCOUNT-PRIME         PIC X(6).
  4862         16  PB-CERT-EFF-DT               PIC XX.
  4863         16  PB-CERT-NO.
  4864             20  PB-CERT-PRIME            PIC X(10).
  4865             20  PB-CERT-SFX              PIC X.
  4866         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4867
  4868         16  PB-RECORD-TYPE               PIC X.
  4869             88  PB-MAILING-DATA                VALUE '0'.
  4870             88  PB-ISSUE                       VALUE '1'.
  4871             88  PB-CANCELLATION                VALUE '2'.
  4872             88  PB-BATCH-TRAILER               VALUE '9'.
  4873
  4874     12  PB-CONTROL-BY-ORIG-BATCH.
  4875         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4876         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4877         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4878         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4879
  4880     12  PB-CONTROL-BY-CSR.
  4881         16  PB-CSR-COMPANY-CD            PIC X.
  4882         16  PB-CSR-ID                    PIC X(4).
  4883         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4884         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4885         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  86
* EL677.cbl
  4886******************************************************************
  4887*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4888******************************************************************
  4889
  4890     12  PB-LAST-MAINT-DT                 PIC XX.
  4891     12  PB-LAST-MAINT-BY                 PIC X(4).
  4892     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4893
  4894     12  PB-RECORD-BODY                   PIC X(375).
  4895
  4896     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4897         16  PB-CERT-ORIGIN               PIC X.
  4898             88  CLASIC-CREATED-CERT         VALUE '1'.
  4899         16  PB-I-NAME.
  4900             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4901             20  PB-I-INSURED-FIRST-NAME.
  4902                 24  PB-I-INSURED-1ST-INIT PIC X.
  4903                 24  FILLER                PIC X(9).
  4904             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4905         16  PB-I-AGE                     PIC S99   COMP-3.
  4906         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4907         16  PB-I-BIRTHDAY                PIC XX.
  4908         16  PB-I-INSURED-SEX             PIC X.
  4909             88  PB-SEX-MALE     VALUE 'M'.
  4910             88  PB-SEX-FEMALE   VALUE 'F'.
  4911
  4912         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4913         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4914         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4915         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4916         16  PB-I-SKIP-CODE               PIC X.
  4917             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4918             88  PB-SKIP-JULY              VALUE '1'.
  4919             88  PB-SKIP-AUGUST            VALUE '2'.
  4920             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4921             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4922             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4923             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4924             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4925             88  PB-SKIP-JUNE              VALUE '8'.
  4926             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4927             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4928             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4929         16  PB-I-TERM-TYPE               PIC X.
  4930             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4931             88  PB-PAID-WEEKLY            VALUE 'W'.
  4932             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4933             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4934             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4935         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4936         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4937         16  PB-I-DATA-ENTRY-SW           PIC X.
  4938             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4939             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4940             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4941             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4942         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4943         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  87
* EL677.cbl
  4944*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4945         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4946         16  FILLER                       PIC X.
  4947
  4948         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4949             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4950             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4951                                                   '90' THRU '99'.
  4952         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4953                                          PIC XX.
  4954         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4955         16  PB-I-AMOUNT-FINANCED REDEFINES
  4956                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4957         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4958         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4959                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4960         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4961         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4962         16  PB-I-CLP-AMOUNT REDEFINES
  4963                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4964         16  PB-I-LF-CALC-FLAG            PIC X.
  4965             88 PB-COMP-LF-PREM               VALUE '?'.
  4966         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4967         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4968         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4969         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4970         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4971         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4972         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4973         16  PB-I-LF-ABBR                 PIC XXX.
  4974         16  PB-I-LF-INPUT-CD             PIC XX.
  4975
  4976         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4977             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4978             88  PB-INVALID-AH               VALUE '  ' '00'
  4979                                                   '90' THRU '99'.
  4980         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4981         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4982         16  PB-I-AH-CALC-FLAG            PIC X.
  4983             88 PB-COMP-AH-PREM                  VALUE '?'.
  4984         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4985         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4986         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4987         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4988         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4989         16  PB-I-AH-ABBR                 PIC XXX.
  4990         16  PB-I-AH-INPUT-CD             PIC XXX.
  4991
  4992         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4993         16  PB-I-REIN-TABLE              PIC XXX.
  4994         16  PB-I-BUSINESS-TYPE           PIC 99.
  4995         16  PB-I-INDV-GRP-CD             PIC X.
  4996         16  PB-I-MORT-CODE.
  4997             20  PB-I-TABLE               PIC X.
  4998             20  PB-I-INTEREST            PIC XX.
  4999             20  PB-I-MORT-TYP            PIC X.
  5000         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5001         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  88
* EL677.cbl
  5002         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5003         16  PB-I-INDV-GRP-OVRD           PIC X.
  5004         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5005         16  PB-I-SIG-SW                  PIC X.
  5006             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5007         16  PB-I-RATE-CLASS              PIC XX.
  5008         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5009         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5010         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5011         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5012         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5013         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5014         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5015         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5016         16  PB-I-OB-FLAG                 PIC X.
  5017             88  PB-I-OB                      VALUE 'B'.
  5018             88  PB-I-SUMMARY                 VALUE 'Z'.
  5019         16  PB-I-ENTRY-STATUS            PIC X.
  5020             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5021                                              'M' '5' '9' '2'.
  5022             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5023             88  PB-I-POLICY-PENDING          VALUE '2'.
  5024             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5025             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5026             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5027             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5028             88  PB-I-REIN-ONLY               VALUE '9'.
  5029             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5030             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5031             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5032             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5033         16  PB-I-INT-CODE                PIC X.
  5034             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5035             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5036         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5037         16  PB-I-SOC-SEC-NO              PIC X(11).
  5038         16  PB-I-MEMBER-NO               PIC X(12).
  5039         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5040*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5041         16  PB-I-OLD-LOF                 PIC XXX.
  5042         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5043         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5044         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5045         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5046         16  PB-I-LIFE-INDICATOR          PIC X.
  5047             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5048         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5049         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5050                                          PIC S9(5)V99    COMP-3.
  5051         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5052             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5053             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5054         16  PB-I-1ST-PMT-DT              PIC XX.
  5055         16  PB-I-JOINT-INSURED.
  5056             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5057             20 PB-I-JOINT-FIRST-NAME.
  5058                24  PB-I-JOINT-FIRST-INIT PIC X.
  5059                24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  89
* EL677.cbl
  5060             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5061*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5062         16  PB-I-BENEFICIARY-NAME.
  5063             20  PB-I-BANK-NUMBER         PIC X(10).
  5064             20  FILLER                   PIC X(15).
  5065         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5066         16  PB-I-REFERENCE               PIC X(12).
  5067         16  FILLER REDEFINES PB-I-REFERENCE.
  5068             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5069             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5070             20  PB-I-CLP-STATE           PIC XX.
  5071         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5072             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5073             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5074             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5075         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5076         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5077         16  PB-I-RESIDENT-STATE          PIC XX.
  5078         16  PB-I-RATE-CODE               PIC X(4).
  5079         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5080         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5081         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5082         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5083         16  PB-I-BANK-NOCHRGB            PIC 99.
  5084         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5085         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5086
  5087     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5088         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5089             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5090         16  PB-C-CANCEL-ORIGIN           PIC X.
  5091             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5092         16  PB-C-LF-CANCEL-DT            PIC XX.
  5093         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5094         16  PB-C-LF-CALC-REQ             PIC X.
  5095             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5096         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5097         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5098         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5099             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5100         16  PB-C-AH-CANCEL-DT            PIC XX.
  5101         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5102         16  PB-C-AH-CALC-REQ             PIC X.
  5103             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5104         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5105         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5106         16  PB-C-LAST-NAME               PIC X(15).
  5107         16  PB-C-REFUND-SW               PIC X.
  5108             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5109             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5110         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5111         16  PB-C-PAYEE-CODE              PIC X(6).
  5112         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5113         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5114         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5115         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5116         16  PB-C-REFERENCE               PIC X(12).
  5117         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  90
* EL677.cbl
  5118         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5119         16  PB-C-POST-CARD-IND           PIC X.
  5120         16  PB-C-CANCEL-REASON           PIC X.
  5121         16  PB-C-REF-INTERFACE-SW        PIC X.
  5122         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5123         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5124         16  FILLER                       PIC X(01).
  5125*        16  FILLER                       PIC X(18).
  5126         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5127*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5128         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  5129         16  PB-CANCELED-CERT-DATA.
  5130             20  PB-CI-INSURED-NAME.
  5131                 24  PB-CI-LAST-NAME      PIC X(15).
  5132                 24  PB-CI-INITIALS       PIC XX.
  5133             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5134             20  PB-CI-INSURED-SEX        PIC X.
  5135             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5136             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5137             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5138             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5139             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5140             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5141             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5142             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5143             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5144             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5145             20  PB-CI-RATE-CLASS         PIC XX.
  5146             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5147             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5148             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5149             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5150             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5151             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5152             20  PB-CI-LF-ABBR            PIC X(3).
  5153             20  PB-CI-AH-ABBR            PIC X(3).
  5154             20  PB-CI-OB-FLAG            PIC X.
  5155                 88  PB-CI-OB                VALUE 'B'.
  5156             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5157                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5158                                           'M' '4' '5' '9' '2'.
  5159                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5160                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5161                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5162                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5163                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5164                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5165                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5166                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5167                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5168                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5169                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5170                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5171                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5172             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5173                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5174                                           'M' '4' '5' '9' '2'.
  5175                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  91
* EL677.cbl
  5176                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5177                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5178                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5179                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5180                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5181                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5182                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5183                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5184                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5185                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5186                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5187                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5188             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5189             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5190             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5191             20  PB-CI-MEMBER-NO          PIC X(12).
  5192             20  PB-CI-INT-CODE           PIC X.
  5193                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5194                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5195             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5196             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5197             20  PB-CI-COMP-EXCP-SW       PIC X.
  5198                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5199                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5200             20  PB-CI-ENTRY-STATUS       PIC X.
  5201             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5202             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5203             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5204             20  PB-CI-DEATH-DT           PIC XX.
  5205             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5206             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5207             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5208             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5209             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5210             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5211             20  PB-CI-ENTRY-DT              PIC XX.
  5212             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5213             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5214             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5215             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5216             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5217             20  PB-CI-OLD-LOF               PIC XXX.
  5218*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5219             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5220             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5221             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5222             20  PB-CI-INDV-GRP-CD           PIC X.
  5223             20  PB-CI-BENEFICIARY-NAME.
  5224                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5225                 24  FILLER                  PIC X(15).
  5226             20  PB-CI-NOTE-SW               PIC X.
  5227             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5228             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5229             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5230             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5231             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5232             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5233             20  PB-CI-FIRST-NAME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  92
* EL677.cbl
  5234             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5235
  5236         16  FILLER                       PIC X(13).
  5237*032306  16  FILLER                       PIC X(27).
  5238*        16  FILLER                       PIC X(46).
  5239
  5240     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5241         16  FILLER                       PIC X(10).
  5242         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5243         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5244         16  PB-M-INSURED-MID-INIT        PIC X.
  5245         16  PB-M-INSURED-AGE             PIC 99.
  5246         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5247         16  PB-M-INSURED-SEX             PIC X.
  5248         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5249         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5250         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5251         16  PB-M-INSURED-CITY-STATE.
  5252             20  PB-M-INSURED-CITY        PIC X(28).
  5253             20  PB-M-INSURED-STATE       PIC XX.
  5254         16  PB-M-INSURED-ZIP-CODE.
  5255             20  PB-M-INSURED-ZIP-PRIME.
  5256                 24  PB-M-INSURED-ZIP-1   PIC X.
  5257                     88  PB-M-CANADIAN-POST-CODE
  5258                                             VALUE 'A' THRU 'Z'.
  5259                 24  FILLER               PIC X(4).
  5260             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5261         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5262                                        PB-M-INSURED-ZIP-CODE.
  5263             20  PM-M-INS-CAN-POST1       PIC XXX.
  5264             20  PM-M-INS-CAN-POST2       PIC XXX.
  5265             20  FILLER                   PIC XXX.
  5266         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5267         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5268         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5269         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5270         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5271         16  PB-M-CRED-BENE-CITYST.
  5272             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5273             20  PB-M-CRED-BENE-STATE     PIC XX.
  5274         16  FILLER                       PIC X(92).
  5275
  5276     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5277         16  FILLER                       PIC X(10).
  5278         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5279         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5280         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5281         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5282         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5283         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5284         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5285         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5286         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5287         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5288         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5289         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5290         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5291         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  93
* EL677.cbl
  5292         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5293         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5294         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5295         16  PB-ACCOUNT-NAME              PIC X(30).
  5296         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5297         16  PB-REFERENCE                 PIC X(12).
  5298         16  PB-B-RECEIVED-DT             PIC XX.
  5299         16  FILLER                       PIC X(234).
  5300
  5301     12  PB-RECORD-STATUS.
  5302         16  PB-CREDIT-SELECT-DT          PIC XX.
  5303         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5304         16  PB-BILLED-DT                 PIC XX.
  5305         16  PB-BILLING-STATUS            PIC X.
  5306             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5307             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5308             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5309         16  PB-RECORD-BILL               PIC X.
  5310             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5311             88  PB-RECORD-RETURNED           VALUE 'R'.
  5312             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5313             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5314             88  PB-OVERRIDE-AH               VALUE 'A'.
  5315             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5316         16  PB-BATCH-ENTRY               PIC X.
  5317             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5318             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5319             88  PB-REISSUED-CERT             VALUE 'E'.
  5320             88  PB-CASH-CERT                 VALUE 'C'.
  5321             88  PB-MONTHLY-CERT              VALUE 'M'.
  5322             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5323             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5324             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5325         16  PB-FORCE-CODE                PIC X.
  5326             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5327             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5328             88  PB-CANCEL-FORCE              VALUE '8'.
  5329             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5330             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5331             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5332             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5333             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5334             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5335             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  5336             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5337         16  PB-FATAL-FLAG                PIC X.
  5338             88  PB-FATAL-ERRORS              VALUE 'X'.
  5339         16  PB-FORCE-ER-CD               PIC X.
  5340             88  PB-FORCE-ERRORS              VALUE 'F'.
  5341             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5342         16  PB-WARN-ER-CD                PIC X.
  5343             88  PB-WARNING-ERRORS            VALUE 'W'.
  5344         16  FILLER                       PIC X.
  5345         16  PB-OUT-BAL-CD                PIC X.
  5346             88  PB-OUT-OF-BAL                VALUE 'O'.
  5347         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5348         16  PB-AH-OVERRIDE-L1            PIC X.
  5349         16  PB-INPUT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  94
* EL677.cbl
  5350         16  PB-INPUT-BY                  PIC X(4).
  5351         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5352         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5353         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5354         16  PB-LF-EARNING-METHOD         PIC X.
  5355         16  PB-AH-EARNING-METHOD         PIC X.
  5356         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5357         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5358         16  PB-REIN-CD                   PIC XXX.
  5359         16  PB-LF-REFUND-TYPE            PIC X.
  5360         16  PB-AH-REFUND-TYPE            PIC X.
  5361         16  PB-ACCT-EFF-DT               PIC XX.
  5362         16  PB-ACCT-EXP-DT               PIC XX.
  5363         16  PB-COMPANY-ID                PIC X(3).
  5364         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5365         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5366         16  PB-SV-CARRIER                PIC X.
  5367         16  PB-SV-GROUPING               PIC X(6).
  5368         16  PB-SV-STATE                  PIC XX.
  5369         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5370         16  PB-GA-BILLING-INFO.
  5371             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5372                                          PIC XX.
  5373         16  PB-SV-REMIT-TO  REDEFINES
  5374             PB-GA-BILLING-INFO           PIC X(10).
  5375         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5376         16  PB-I-LOAN-OFFICER            PIC X(5).
  5377         16  PB-I-VIN                     PIC X(17).
  5378
  5379         16  FILLER                       PIC X(04).
  5380         16  IMNET-BYPASS-SW              PIC X.
  5381
  5382******************************************************************
  5383*                COMMON EDIT ERRORS                              *
  5384******************************************************************
  5385
  5386     12  PB-COMMON-ERRORS.
  5387         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5388                                           PIC S9(4)     COMP.
  5389
  5390******************************************************************
  5391*                                COPY ERCPNDM.
  5392******************************************************************
  5393*                                                                *
  5394*                                                                *
  5395*                            ERCPNDM                             *
  5396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5397*                            VMOD=2.003                          *
  5398*                                                                *
  5399*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5400*                                                                *
  5401*   FILE TYPE = VSAM,KSDS                                        *
  5402*   RECORD SIZE = 374   RECFORM = FIX                            *
  5403*                                                                *
  5404*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5405*   ALTERNATE PATH    = NOT USED                                 *
  5406*                                                                *
  5407*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  95
* EL677.cbl
  5408*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5409******************************************************************
  5410*                   C H A N G E   L O G
  5411*
  5412* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5413*-----------------------------------------------------------------
  5414*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5415* EFFECTIVE    NUMBER
  5416*-----------------------------------------------------------------
  5417* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5418* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5419* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5420* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  5421******************************************************************
  5422
  5423 01  PENDING-MAILING-DATA.
  5424     12  PM-RECORD-ID                      PIC XX.
  5425         88  VALID-MA-ID                       VALUE 'PM'.
  5426
  5427     12  PM-CONTROL-PRIMARY.
  5428         16  PM-COMPANY-CD                 PIC X.
  5429         16  PM-ENTRY-BATCH                PIC X(6).
  5430         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5431         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5432
  5433     12  FILLER                            PIC X(14).
  5434
  5435     12  PM-ACCESS-CONTROL.
  5436         16  PM-SOURCE-SYSTEM              PIC XX.
  5437             88  PM-FROM-CREDIT                VALUE 'CR'.
  5438             88  PM-FROM-VSI                   VALUE 'VS'.
  5439             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5440             88  PM-FROM-OTHER                 VALUE 'OT'.
  5441         16  PM-RECORD-ADD-DT              PIC XX.
  5442         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5443         16  PM-LAST-MAINT-DT              PIC XX.
  5444         16  PM-LAST-MAINT-BY              PIC XXXX.
  5445         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5446
  5447     12  PM-PROFILE-INFO.
  5448         16  PM-QUALIFY-CODE-1             PIC XX.
  5449         16  PM-QUALIFY-CODE-2             PIC XX.
  5450         16  PM-QUALIFY-CODE-3             PIC XX.
  5451         16  PM-QUALIFY-CODE-4             PIC XX.
  5452         16  PM-QUALIFY-CODE-5             PIC XX.
  5453
  5454         16  PM-INSURED-LAST-NAME          PIC X(15).
  5455         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5456         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5457         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5458         16  PM-INSURED-BIRTH-DT           PIC XX.
  5459         16  PM-INSURED-SEX                PIC X.
  5460             88  PM-SEX-MALE                   VALUE 'M'.
  5461             88  PM-SEX-FEMALE                 VALUE 'F'.
  5462         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5463
  5464         16  PM-ADDRESS-CORRECTED          PIC X.
  5465         16  PM-JOINT-BIRTH-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  96
* EL677.cbl
  5466*        16  FILLER                        PIC X(12).
  5467
  5468         16  PM-ADDRESS-LINE-1             PIC X(30).
  5469         16  PM-ADDRESS-LINE-2             PIC X(30).
  5470         16  PM-CITY-STATE.
  5471             20  PM-CITY                   PIC X(28).
  5472             20  PM-STATE                  PIC XX.
  5473         16  PM-ZIP.
  5474             20  PM-ZIP-CODE.
  5475                 24  PM-ZIP-1              PIC X.
  5476                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5477                 24  FILLER                PIC X(4).
  5478             20  PM-ZIP-PLUS4              PIC X(4).
  5479         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5480             20  PM-CAN-POST1              PIC XXX.
  5481             20  PM-CAN-POST2              PIC XXX.
  5482             20  FILLER                    PIC XXX.
  5483
  5484         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5485         16  pm-city-st-zip-verified       pic x.
  5486         16  FILLER                        PIC XX.
  5487
  5488     12  PM-CRED-BENE-INFO.
  5489         16  PM-CRED-BENE-NAME             PIC X(25).
  5490         16  PM-CRED-BENE-ADDR             PIC X(30).
  5491         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5492         16  PM-CRED-BENE-CTYST.
  5493             20  PM-CRED-BENE-CITY         PIC X(28).
  5494             20  PM-CRED-BENE-STATE        PIC XX.
  5495         16  PM-CRED-BENE-ZIP.
  5496             20  PM-CB-ZIP-CODE.
  5497                 24  PM-CB-ZIP-1           PIC X.
  5498                     88  PM-CB-CANADIAN-POST-CODE
  5499                                  VALUE 'A' THRU 'Z'.
  5500                 24  FILLER                PIC X(4).
  5501             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5502         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5503             20  PM-CB-CAN-POST1           PIC XXX.
  5504             20  PM-CB-CAN-POST2           PIC XXX.
  5505             20  FILLER                    PIC XXX.
  5506     12  PM-POST-CARD-MAIL-DATA.
  5507         16  PM-MAIL-DATA OCCURS 7.
  5508             20  PM-MAIL-TYPE              PIC X.
  5509                 88  PM-12MO-MAILING           VALUE '1'.
  5510                 88  PM-EXP-MAILING            VALUE '2'.
  5511             20  PM-MAIL-STATUS            PIC X.
  5512                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5513                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5514                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5515             20  PM-MAIL-DATE              PIC XX.
  5516     12  FILLER                            PIC XX.
  5517     12  FILLER                            PIC X(12).
  5518*    12  FILLER                            PIC X(30).
  5519
  5520******************************************************************
  5521*                                COPY ERCMAIL.
  5522******************************************************************
  5523*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  97
* EL677.cbl
  5524*                                                                *
  5525*                            ERCMAIL                             *
  5526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5527*                            VMOD=2.003                          *
  5528*                                                                *
  5529*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5530*                                                                *
  5531*   FILE TYPE = VSAM,KSDS                                        *
  5532*   RECORD SIZE = 374   RECFORM = FIX                            *
  5533*                                                                *
  5534*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5535*   ALTERNATE PATH    = NOT USED                                 *
  5536*                                                                *
  5537*   LOG = YES                                                    *
  5538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5539******************************************************************
  5540*                   C H A N G E   L O G
  5541*
  5542* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5543*-----------------------------------------------------------------
  5544*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5545* EFFECTIVE    NUMBER
  5546*-----------------------------------------------------------------
  5547* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5548* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5549* 111108                   PEMA  ADD CRED BENE ADDR2
  5550******************************************************************
  5551
  5552 01  MAILING-DATA.
  5553     12  MA-RECORD-ID                      PIC XX.
  5554         88  VALID-MA-ID                       VALUE 'MA'.
  5555
  5556     12  MA-CONTROL-PRIMARY.
  5557         16  MA-COMPANY-CD                 PIC X.
  5558         16  MA-CARRIER                    PIC X.
  5559         16  MA-GROUPING.
  5560             20  MA-GROUPING-PREFIX        PIC XXX.
  5561             20  MA-GROUPING-PRIME         PIC XXX.
  5562         16  MA-STATE                      PIC XX.
  5563         16  MA-ACCOUNT.
  5564             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5565             20  MA-ACCOUNT-PRIME          PIC X(6).
  5566         16  MA-CERT-EFF-DT                PIC XX.
  5567         16  MA-CERT-NO.
  5568             20  MA-CERT-PRIME             PIC X(10).
  5569             20  MA-CERT-SFX               PIC X.
  5570
  5571     12  FILLER                            PIC XX.
  5572
  5573     12  MA-ACCESS-CONTROL.
  5574         16  MA-SOURCE-SYSTEM              PIC XX.
  5575             88  MA-FROM-CREDIT                VALUE 'CR'.
  5576             88  MA-FROM-VSI                   VALUE 'VS'.
  5577             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5578             88  MA-FROM-OTHER                 VALUE 'OT'.
  5579         16  MA-RECORD-ADD-DT              PIC XX.
  5580         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5581         16  MA-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  98
* EL677.cbl
  5582         16  MA-LAST-MAINT-BY              PIC XXXX.
  5583         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5584
  5585     12  MA-PROFILE-INFO.
  5586         16  MA-QUALIFY-CODE-1             PIC XX.
  5587         16  MA-QUALIFY-CODE-2             PIC XX.
  5588         16  MA-QUALIFY-CODE-3             PIC XX.
  5589         16  MA-QUALIFY-CODE-4             PIC XX.
  5590         16  MA-QUALIFY-CODE-5             PIC XX.
  5591
  5592         16  MA-INSURED-LAST-NAME          PIC X(15).
  5593         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5594         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5595         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5596         16  MA-INSURED-BIRTH-DT           PIC XX.
  5597         16  MA-INSURED-SEX                PIC X.
  5598             88  MA-SEX-MALE                   VALUE 'M'.
  5599             88  MA-SEX-FEMALE                 VALUE 'F'.
  5600         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5601
  5602         16  MA-ADDRESS-CORRECTED          PIC X.
  5603         16  MA-JOINT-BIRTH-DT             PIC XX.
  5604*        16  FILLER                        PIC X(12).
  5605
  5606         16  MA-ADDRESS-LINE-1             PIC X(30).
  5607         16  MA-ADDRESS-LINE-2             PIC X(30).
  5608         16  MA-CITY-STATE.
  5609             20  MA-CITY                   PIC X(28).
  5610             20  MA-ADDR-STATE             PIC XX.
  5611         16  MA-ZIP.
  5612             20  MA-ZIP-CODE.
  5613                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5614                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5615                 24  FILLER                PIC X(4).
  5616             20  MA-ZIP-PLUS4              PIC X(4).
  5617         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5618             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5619             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5620             20  FILLER                    PIC X(3).
  5621
  5622         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5623
  5624         16  FILLER                        PIC XXX.
  5625*        16  FILLER                        PIC X(10).
  5626
  5627     12  MA-CRED-BENE-INFO.
  5628         16  MA-CRED-BENE-NAME                 PIC X(25).
  5629         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5630         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5631         16  MA-CRED-BENE-CTYST.
  5632             20  MA-CRED-BENE-CITY             PIC X(28).
  5633             20  MA-CRED-BENE-STATE            PIC XX.
  5634         16  MA-CRED-BENE-ZIP.
  5635             20  MA-CB-ZIP-CODE.
  5636                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5637                     88  MA-CB-CANADIAN-POST-CODE
  5638                                           VALUE 'A' THRU 'Z'.
  5639                 24  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page  99
* EL677.cbl
  5640             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5641         16  MA-CB-CANADIAN-POSTAL-CODE
  5642                            REDEFINES MA-CRED-BENE-ZIP.
  5643             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5644             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5645             20  FILLER                        PIC X(3).
  5646     12  MA-POST-CARD-MAIL-DATA.
  5647         16  MA-MAIL-DATA OCCURS 7.
  5648             20  MA-MAIL-TYPE              PIC X.
  5649                 88  MA-12MO-MAILING           VALUE '1'.
  5650                 88  MA-EXP-MAILING            VALUE '2'.
  5651             20  MA-MAIL-STATUS            PIC X.
  5652                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5653                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5654                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5655             20  MA-MAIL-DATE              PIC XX.
  5656     12  FILLER                            PIC XX.
  5657     12  FILLER                            PIC XX.
  5658*    12  FILLER                            PIC X(30).
  5659******************************************************************
  5660*                                COPY ERCPYAJ.
  5661******************************************************************
  5662*                                                                *
  5663*                            ERCPYAJ                             *
  5664*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5665*                            VMOD=2.015                          *
  5666*                                                                *
  5667*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5668*                                                                *
  5669*                                                                *
  5670*   FILE TYPE = VSAM,KSDS                                        *
  5671*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5672*                                                                *
  5673*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5674*       ALTERNATE PATHS = NONE                                   *
  5675*                                                                *
  5676*   LOG = YES                                                    *
  5677*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5678******************************************************************
  5679******************************************************************
  5680*                   C H A N G E   L O G
  5681*
  5682* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5683*-----------------------------------------------------------------
  5684*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5685* EFFECTIVE    NUMBER
  5686*-----------------------------------------------------------------
  5687* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5688* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5689******************************************************************
  5690
  5691 01  PENDING-PAY-ADJ.
  5692     12  PY-RECORD-ID                     PIC XX.
  5693         88  VALID-PY-ID                        VALUE 'PY'.
  5694
  5695     12  PY-CONTROL-PRIMARY.
  5696         16  PY-COMPANY-CD                PIC X.
  5697         16  PY-CARRIER                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 100
* EL677.cbl
  5698         16  PY-GROUPING                  PIC X(6).
  5699         16  PY-FIN-RESP                  PIC X(10).
  5700         16  PY-ACCOUNT                   PIC X(10).
  5701         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5702                                          PIC X(10).
  5703         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5704         16  PY-RECORD-TYPE               PIC X.
  5705             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5706             88  PY-DEPOSIT                   VALUE 'D'.
  5707             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5708             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5709             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5710             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5711             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5712             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5713             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5714             88  PY-FICA-ENTRY                VALUE 'F'.
  5715             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5716             88  PY-POLICY-FEE                VALUE 'W'.
  5717             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5718
  5719     12  PY-PYMT-TYPE                     PIC X.
  5720             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5721             88  PY-REINS-PYMT                VALUE 'R'.
  5722             88  PY-EXP-PYMT                  VALUE 'E'.
  5723
  5724     12  PY-BIL-INV                       PIC X(6).
  5725     12  PY-REF-NO                        PIC X(12).
  5726
  5727     12  PY-LAST-MAINT-DT                 PIC XX.
  5728     12  PY-LAST-MAINT-BY                 PIC X(4).
  5729     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5730
  5731     12  PY-PYADJ-RECORD.
  5732         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5733         16  PY-ENTRY-COMMENT             PIC X(30).
  5734         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5735             20  PY-GL-ACCOUNT            PIC X(10).
  5736             20  PY-GL-STATE              PIC X(02).
  5737             20  PY-GL-CANC-SW            PIC X(01).
  5738                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5739                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5740             20  PY-GL-COMMENT            PIC X(10).
  5741             20  FILLER      REDEFINES PY-GL-COMMENT.
  5742                 24  PY-GL-CHECK-NO       PIC 9(06).
  5743                 24  FILLER               PIC X(04).
  5744             20  FILLER                   PIC X(07).
  5745         16  PY-SAVE-ACCOUNT              PIC X(10).
  5746         16  PY-SAVE-TYPE                 PIC X(01).
  5747
  5748         16  PY-LETTERS.
  5749             20  PY-LETTER OCCURS 3 TIMES
  5750                           INDEXED BY PY-LET-NDX
  5751                                          PIC X(04).
  5752
  5753         16  PY-ERCOMP-TYPE               PIC X.
  5754             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5755             88  PY-GA-TYPE                   VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 101
* EL677.cbl
  5756             88  PY-BANK-TYPE                 VALUE 'B'.
  5757         16  FILLER                       PIC X(05).
  5758
  5759     12  PY-RECORD-STATUS.
  5760         16  PY-CREDIT-SELECT-DT          PIC XX.
  5761         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5762         16  PY-BILLED-DATE               PIC XX.
  5763         16  PY-REPORTED-DT               PIC XX.
  5764         16  PY-PMT-APPLIED               PIC X.
  5765             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5766             88  PY-GA-PMT                    VALUE 'G'.
  5767             88  PY-OVWRITE-PMT               VALUE 'O'.
  5768             88  PY-NON-AR-PMT                VALUE 'N'.
  5769         16  FILLER                       PIC X(5).
  5770         16  PY-INPUT-DT                  PIC XX.
  5771         16  PY-CHECK-NUMBER              PIC X(6).
  5772         16  PY-VOID-SW                   PIC X.
  5773             88  PY-CHECK-VOIDED              VALUE 'V'.
  5774         16  PY-CHECK-ORIGIN-SW           PIC X.
  5775             88  PY-BILLING-CHECK             VALUE 'B'.
  5776             88  PY-REFUND-CHECK              VALUE 'R'.
  5777             88  PY-GA-CHECK                  VALUE 'G'.
  5778             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5779             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5780         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5781         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5782         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5783         16  PY-BILL-FLAG                 PIC X.
  5784             88  PY-BILLED                    VALUE 'B'.
  5785         16  PY-AR-FLAG                   PIC X.
  5786             88  PY-AR-CYCLE                  VALUE 'C'.
  5787             88  PY-AR-MONTH-END              VALUE 'M'.
  5788         16  PY-AR-DATE                   PIC XX.
  5789
  5790     12  PY-GL-CODES.
  5791         16  PY-GL-DB                     PIC X(14).
  5792         16  PY-GL-CR                     PIC X(14).
  5793         16  PY-GL-FLAG                   PIC X.
  5794         16  PY-GL-DATE                   PIC XX.
  5795
  5796     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5797     12  FILLER                           PIC X(3).
  5798******************************************************************
  5799 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5800                          CHECK-RECORDS ACCOUNT-MASTER
  5801                          COMPENSATION-MASTER
  5802                          CERTIFICATE-MASTER PENDING-BUSINESS
  5803                          PENDING-MAILING-DATA MAILING-DATA
  5804                          PENDING-PAY-ADJ.
  5805 0000-DFHEXIT SECTION.
  5806     MOVE '9#                    $   ' TO DFHEIV0.
  5807     MOVE 'EL677' TO DFHEIV1.
  5808     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5809
  5810     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5811     MOVE '5'                    TO  DC-OPTION-CODE.
  5812     PERFORM 8500-DATE-CONVERT.
  5813     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 102
* EL677.cbl
  5814     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5815     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5816
  5817     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5818
  5819     IF PI-AMOUNT NOT NUMERIC
  5820         MOVE ZEROS              TO  PI-AMOUNT.
  5821
  5822     IF EIBCALEN = 0
  5823         GO TO 8800-UNAUTHORIZED-ACCESS.
  5824     set P to address of KIXSYS
  5825     CALL "getenv" using by value P returning var-ptr
  5826     if var-ptr = null then
  5827        display ' kixsys not set '
  5828     else
  5829        set address of var to var-ptr
  5830        move 0 to env-var-len
  5831        inspect var tallying env-var-len
  5832          for characters before X'00'
  5833        unstring var (1:env-var-len) delimited by '/'
  5834           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5835              WS-KIX-SYS
  5836        end-unstring
  5837     end-if
  5838     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5839     MOVE 2                      TO  EMI-SWITCH2.
  5840     MOVE EIBTRMID               TO  QID-TERM.
  5841
  5842     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5843         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5844
  5845     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5846         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5847             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5848             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5849             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5850             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5851             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5852             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5853             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5854             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5855         ELSE
  5856             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5857             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5858             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5859             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5860             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5861             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5862             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5863             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5864
  5865     MOVE LOW-VALUES             TO  EL677AI.
  5866
  5867     if eibtrnid not = trans-id
  5868        evaluate true
  5869           when pi-return-to-program = 'EL6315'
  5870              move pi-company-cd to pi-chek-comp-cd
  5871              move pi-carrier    to pi-chek-carrier
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 103
* EL677.cbl
  5872              move pi-grouping   to pi-chek-grouping
  5873              move pi-state      to pi-chek-state
  5874              move pi-account    to pi-chek-account
  5875              move pi-cert-eff-dt to pi-chek-eff-dt
  5876              move pi-cert-prime to pi-chek-cert-no
  5877              move pi-cert-sfx   to pi-chek-suf-no
  5878              move +1            to pi-chek-sequence
  5879              move 'C'           to pi-check-type *> Correction
  5880              move 'S'           to mainti
  5881              move +1            to maintl
  5882              move al-uanon      to mainta
  5883              move dfhenter      to eibaid
  5884              go to 5000-browse-file
  5885           when pi-return-to-program = 'EL6318'
  5886              move 'C'           to pi-check-type *> Correction
  5887           when other
  5888              move 'R'           to pi-check-type *> Refund
  5889        end-evaluate
  5890     end-if
  5891     IF EIBTRNID NOT = TRANS-ID
  5892         move pi-processor-id    to pi-return-to
  5893         move +1                 to dedcynl
  5894         move 'N'                to dedcyno
  5895         move al-uanon           to dedcyna
  5896         move dfhpf7             to eibaid
  5897         move ' '                to pi-void-reissue-pass
  5898         move zeros              to pi-void-reissue-amt
  5899         perform 6800-browse-previous-chek-recs *> totals up prev
  5900                                 thru 6800-exit
  5901         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5902                                                *> pending record
  5903         IF PI-TO-EL677-FROM-EL1273
  5904             MOVE 'S'            TO MAINTI
  5905             MOVE 1              TO MAINTL
  5906             MOVE AL-UABON       TO MAINTA
  5907             MOVE DFHENTER       TO EIBAID
  5908             GO TO 5000-BROWSE-FILE.
  5909
  5910     IF EIBTRNID NOT = TRANS-ID
  5911        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5912           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5913           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5914           IF PI-PROCESS-BENEFICIARY
  5915              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5916           ELSE
  5917              GO TO 6300-BUILD-CERT-SCREEN
  5918           end-if
  5919        ELSE
  5920           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5921              GO TO 8100-SEND-INITIAL-MAP
  5922           ELSE
  5923              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5924              IF PI-PROCESS-BENEFICIARY
  5925                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5926              ELSE
  5927                 GO TO 6300-BUILD-CERT-SCREEN
  5928              end-if
  5929           end-if
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 104
* EL677.cbl
  5930        end-if
  5931      end-if
  5932
  5933     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5934                                     PI-CHEK-COMP-CD.
  5935
  5936
  5937* EXEC CICS HANDLE CONDITION
  5938*        PGMIDERR  (9600-PGMID-ERROR)
  5939*        ERROR     (9990-ABEND)
  5940*    END-EXEC.
  5941*    MOVE '"$L.                  ! " #00005839' TO DFHEIV0
  5942     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5944     MOVE X'2220233030303035383339' TO DFHEIV0(25:11)
  5945     CALL 'kxdfhei1' USING DFHEIV0
  5946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5947
  5948
  5949     IF EIBAID = DFHCLEAR
  5950         GO TO 9400-CLEAR.
  5951
  5952     IF PI-PROCESSOR-ID = 'LGXX'
  5953         GO TO 0200-RECEIVE.
  5954
  5955
  5956* EXEC CICS READQ TS
  5957*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5958*        INTO   (SECURITY-CONTROL)
  5959*        LENGTH (SC-COMM-LENGTH)
  5960*        ITEM   (SC-ITEM)
  5961*    END-EXEC.
  5962*    MOVE '*$II   L              ''   #00005850' TO DFHEIV0
  5963     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5965     MOVE X'2020233030303035383530' TO DFHEIV0(25:11)
  5966     CALL 'kxdfhei1' USING DFHEIV0,
  5967           PI-SECURITY-TEMP-STORE-ID,
  5968           SECURITY-CONTROL,
  5969           SC-COMM-LENGTH,
  5970           SC-ITEM,
  5971           DFHEIV99,
  5972           DFHEIV99
  5973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5974
  5975
  5976     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5977     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5978
  5979     IF NOT DISPLAY-CAP
  5980         MOVE 'READ'          TO SM-READ
  5981         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5982         MOVE ER-0070         TO  EMI-ERROR
  5983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5984         GO TO 8100-SEND-INITIAL-MAP.
  5985
  5986 0200-RECEIVE.
  5987     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 105
* EL677.cbl
  5988         MOVE ER-1159            TO  EMI-ERROR
  5989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5990         MOVE -1                 TO  PFENTERL
  5991         GO TO 8200-SEND-DATAONLY.
  5992
  5993
  5994* EXEC CICS HANDLE CONDITION
  5995*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5996*    END-EXEC.
  5997*    MOVE '"$?                   ! # #00005874' TO DFHEIV0
  5998     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6000     MOVE X'2320233030303035383734' TO DFHEIV0(25:11)
  6001     CALL 'kxdfhei1' USING DFHEIV0
  6002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6003
  6004
  6005
  6006* EXEC CICS RECEIVE
  6007*        MAP      (EL677A)
  6008*        MAPSET   (MAPSET-NAME)
  6009*        INTO     (EL677AI)
  6010*    END-EXEC.
  6011     MOVE LENGTH OF
  6012      EL677AI
  6013       TO DFHEIV11
  6014*    MOVE '8"T I  L              ''   #00005878' TO DFHEIV0
  6015     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6017     MOVE X'2020233030303035383738' TO DFHEIV0(25:11)
  6018     CALL 'kxdfhei1' USING DFHEIV0,
  6019           EL677A,
  6020           EL677AI,
  6021           DFHEIV11,
  6022           MAPSET-NAME,
  6023           DFHEIV99,
  6024           DFHEIV99
  6025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6026
  6027
  6028     IF PFENTERL GREATER ZERO
  6029         IF EIBAID NOT = DFHENTER
  6030             MOVE ER-0004        TO  EMI-ERROR
  6031             MOVE AL-UNBOF       TO  PFENTERA
  6032             MOVE -1             TO  PFENTERL
  6033             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6034             GO TO 8200-SEND-DATAONLY
  6035         ELSE
  6036             IF (PFENTERI NUMERIC) AND
  6037                (PFENTERI GREATER 0 AND LESS 25)
  6038                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6039             ELSE
  6040                 MOVE ER-0029    TO  EMI-ERROR
  6041                 MOVE AL-UNBOF   TO  PFENTERA
  6042                 MOVE -1         TO  PFENTERL
  6043                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6044                 GO TO 8200-SEND-DATAONLY.
  6045 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 106
* EL677.cbl
  6046     IF EIBAID = DFHPF23
  6047         GO TO 8810-PF23.
  6048
  6049     IF EIBAID = DFHPF24
  6050         GO TO 9200-RETURN-MAIN-MENU.
  6051
  6052     IF EIBAID = DFHPF12
  6053         GO TO 9500-PF12.
  6054
  6055     IF EIBAID = DFHPF1 OR DFHPF2
  6056         GO TO 5000-BROWSE-FILE.
  6057
  6058     if PI-TO-EL677-FROM-EL1273
  6059        and (eibaid not = dfhenter)
  6060        and (pi-void-reissue-pass not = '1' and '2')
  6061        go to 0320-input-error
  6062     end-if
  6063     IF EIBAID = DFHPF3
  6064         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6065         MOVE 'PF3'              TO  PI-PFKEY
  6066         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6067         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6068             GO TO 9400-CLEAR
  6069         ELSE
  6070             MOVE XCTL-1273      TO  PGM-NAME
  6071             GO TO 9300-XCTL.
  6072
  6073     IF EIBAID = DFHPF4
  6074         IF NOT FORCE-CAP
  6075             MOVE ER-0433        TO EMI-ERROR
  6076             MOVE -1             TO PFENTERL
  6077             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6078             GO TO 8200-SEND-DATAONLY.
  6079
  6080     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6081                             DFHPF5 OR DFHPF6 or dfhpf7
  6082         GO TO 1000-EDIT-DATA.
  6083
  6084*    IF EIBAID = DFHPF7
  6085*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6086*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6087*        MOVE XCTL-114           TO  PGM-NAME
  6088*        GO TO 9300-XCTL.
  6089
  6090 0320-INPUT-ERROR.
  6091     MOVE ER-0029                TO  EMI-ERROR.
  6092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6093     MOVE -1                     TO  PFENTERL.
  6094     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 107
* EL677.cbl
  6096
  6097 1000-EDIT-DATA.
  6098     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D' or 'R' or 'X'
  6099         MOVE AL-UANON           TO MAINTA
  6100         IF MAINTI = 'C' OR 'V' OR 'R'
  6101             IF PI-PREV-MAINT = 'S'  OR  'C' or 'R'
  6102                 NEXT SENTENCE
  6103             ELSE
  6104                 MOVE ER-2056    TO  EMI-ERROR
  6105                 MOVE -1         TO  MAINTL
  6106                 MOVE AL-UABON   TO  MAINTA
  6107                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6108                 GO TO 1100-EDIT-COMPLETE
  6109         ELSE
  6110             NEXT SENTENCE
  6111     ELSE
  6112         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6113            NEXT SENTENCE
  6114         ELSE
  6115            MOVE ER-0023            TO  EMI-ERROR
  6116            MOVE -1                 TO  MAINTL
  6117            MOVE AL-UABON           TO  MAINTA
  6118            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6119
  6120     IF MODIFY-CAP
  6121         NEXT SENTENCE
  6122       ELSE
  6123         IF MAINTI NOT = 'S'
  6124            MOVE 'UPDATE'       TO SM-READ
  6125            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6126            MOVE ER-0070        TO EMI-ERROR
  6127            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6128            GO TO 8100-SEND-INITIAL-MAP.
  6129
  6130     if (pi-return-to-program = 'EL1273')
  6131        and (MAINTI not = 'S' and 'V' and 'R' and 'D' and 'X')
  6132        move 'S'                 to mainti
  6133        move +1                  to maintl
  6134        move al-uanon            to mainta
  6135     end-if
  6136     IF CARRIERI NOT = LOW-VALUES
  6137         MOVE AL-UANON           TO  CARRIERA
  6138         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6139         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6140                                     PI-CARRIER
  6141     ELSE
  6142         MOVE -1                 TO  CARRIERL
  6143         MOVE AL-UABON           TO  CARRIERA
  6144         MOVE ER-0194            TO  EMI-ERROR
  6145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6146
  6147     IF GROUPI NOT = LOW-VALUES
  6148         MOVE AL-UANON           TO  GROUPA
  6149         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6150                                     PI-GROUPING
  6151     ELSE
  6152         MOVE -1                 TO  GROUPL
  6153         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 108
* EL677.cbl
  6154         MOVE ER-0195            TO  EMI-ERROR
  6155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6156
  6157     IF STATEI NOT = LOW-VALUES
  6158         MOVE AL-UANON           TO  STATEA
  6159         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6160         MOVE STATEI             TO  PI-CHEK-STATE
  6161                                     PI-STATE
  6162     ELSE
  6163         MOVE -1                 TO  STATEL
  6164         MOVE AL-UABON           TO  STATEA
  6165         MOVE ER-0196            TO  EMI-ERROR
  6166         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6167
  6168     IF EFFDTL GREATER ZERO
  6169         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6170         PERFORM 8700-DEEDIT
  6171         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6172             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6173             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6174             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6175             MOVE '4'                TO  DC-OPTION-CODE
  6176             PERFORM 8500-DATE-CONVERT
  6177             IF DC-ERROR-CODE NOT = SPACES
  6178                 MOVE ER-0215        TO  EMI-ERROR
  6179                 PERFORM 9900-ERROR-FORMAT
  6180                 MOVE -1             TO  EFFDTL
  6181                 MOVE AL-UABON       TO  EFFDTA
  6182               ELSE
  6183                 MOVE AL-UANON       TO  EFFDTA
  6184                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6185                                         PI-CERT-EFF-DT
  6186           ELSE
  6187             MOVE ER-0215        TO  EMI-ERROR
  6188             PERFORM 9900-ERROR-FORMAT
  6189             MOVE -1             TO  EFFDTL
  6190             MOVE AL-UABON       TO  EFFDTA
  6191       ELSE
  6192         MOVE ER-0216            TO  EMI-ERROR
  6193         PERFORM 9900-ERROR-FORMAT
  6194         MOVE -1                 TO  EFFDTL
  6195         MOVE AL-UABOF           TO  EFFDTA.
  6196
  6197     IF ACCTI NOT = LOW-VALUES
  6198         MOVE AL-UANON           TO  ACCTA
  6199         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6200         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6201                                     PI-ACCOUNT
  6202     ELSE
  6203         MOVE -1                 TO  ACCTL
  6204         MOVE AL-UABON           TO  ACCTA
  6205         MOVE ER-0197            TO  EMI-ERROR
  6206         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6207
  6208     IF CERTNOI NOT = LOW-VALUES
  6209         MOVE AL-UANON           TO  CERTNOA
  6210         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6211                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 109
* EL677.cbl
  6212     ELSE
  6213         MOVE -1                 TO  CERTNOL
  6214         MOVE AL-UABON           TO  CERTNOA
  6215         MOVE ER-0203            TO  EMI-ERROR
  6216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6217
  6218     IF SFXI  = LOW-VALUES
  6219         MOVE SPACE              TO  SFXI.
  6220
  6221     MOVE AL-UANON               TO  SFXA.
  6222
  6223     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6224                                     PI-CERT-SFX.
  6225     IF SEQI = LOW-VALUES
  6226         MOVE +1                 TO  SEQI.
  6227
  6228     MOVE AL-UNNON               TO  SEQA.
  6229     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6230
  6231     IF PAYTO1L > 0
  6232         MOVE PAYTO1I            TO  PI-PAYTO1
  6233     ELSE
  6234         MOVE SPACES             TO  PI-PAYTO1.
  6235
  6236     IF AMOUNTL > 0
  6237
  6238* EXEC CICS BIF DEEDIT
  6239*            FIELD   (AMOUNTI)
  6240*            LENGTH  (11)
  6241*        END-EXEC
  6242     MOVE 11
  6243       TO DFHEIV11
  6244*    MOVE '@"L                   #   #00006093' TO DFHEIV0
  6245     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6246     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6247     MOVE X'2020233030303036303933' TO DFHEIV0(25:11)
  6248     CALL 'kxdfhei1' USING DFHEIV0,
  6249           AMOUNTI,
  6250           DFHEIV11
  6251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6252         MOVE AMOUNTI            TO  PI-AMOUNT
  6253     ELSE
  6254         MOVE ZEROS              TO  PI-AMOUNT.
  6255
  6256     IF TYPEL > 0
  6257         MOVE TYPEI              TO  PI-TYPE
  6258     ELSE
  6259         MOVE SPACE              TO  PI-TYPE.
  6260
  6261*    IF REFL > 0
  6262*        MOVE REFI               TO  PI-REFERENCE
  6263*    ELSE
  6264*        MOVE SPACES             TO  PI-REFERENCE.
  6265     if rettol not = zeros
  6266        move rettoi              to pi-return-to
  6267        MOVE AL-UANON            TO  RETTOA
  6268     end-if
  6269     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 110
* EL677.cbl
  6270        if dedcyni = 'Y' OR 'N'
  6271           move al-uanon         to dedcyna
  6272           continue
  6273        else
  6274           move er-3451          to emi-error
  6275           move -1               to dedcynl
  6276           move al-uabon         to dedcyna
  6277           perform 9900-error-format
  6278                                 thru 9900-exit
  6279        end-if
  6280     end-if
  6281
  6282     if mainti = 'V' or 'R'
  6283        if ((vreasonl > zeros)
  6284           and (vreasoni (1:2) not = spaces))
  6285             or (pi-void-reissue-pass = '1' or '2')
  6286           continue
  6287        else
  6288           move er-3454          to emi-error
  6289           move -1               to vreasonl
  6290           move al-uabon         to vreasona
  6291           perform 9900-error-format
  6292                                 thru 9900-exit
  6293        end-if
  6294     end-if
  6295     if (mainti = 'A')
  6296        and (pi-prev-paid > zeros)
  6297        and (pi-check-type = 'C')
  6298        move er-3459             to emi-error
  6299        move -1                  to maintl
  6300        move al-uabon            to mainta
  6301        perform 9900-error-format
  6302                                 thru 9900-exit
  6303     end-if
  6304     if mainti = 'A'
  6305        continue
  6306     else
  6307        IF MAINTI = 'S'
  6308           or pi-prev-maint = 'S'
  6309           GO TO 1100-EDIT-COMPLETE
  6310        end-if
  6311     end-if
  6312     if (pi-void-reissue-pass = '1')
  6313        and (mainti = 'R')
  6314        if emi-error = zeros
  6315           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6316              go to 7500-reissue-pass-1
  6317           else
  6318              if eibaid = dfhenter
  6319                 move er-3460    to emi-error
  6320                 move -1         to maintl
  6321                 move al-uabon   to mainta
  6322                 perform 9900-error-format
  6323                                 thru 9900-exit
  6324              end-if
  6325           end-if
  6326        end-if
  6327     end-if
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 111
* EL677.cbl
  6328
  6329     if (pi-void-reissue-pass = '2')
  6330        and (mainti = 'R')
  6331        if emi-error = zeros
  6332           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6333              go to 7500-reissue-pass-1
  6334           else
  6335              if eibaid = dfhenter
  6336                 go to 7510-reissue-pass-2
  6337              end-if
  6338           end-if
  6339        end-if
  6340     end-if
  6341*    if (pi-void-reissue-pass = '1')
  6342*       and (mainti = 'R')
  6343*       if emi-error = zeros
  6344*          if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6345*             go to 7500-reissue-pass-1
  6346*          else
  6347*             if eibaid = dfhenter
  6348*                go to 7510-reissue-pass-2
  6349*                move '2'        to pi-void-reissue-pass
  6350*             end-if
  6351*          end-if
  6352*       end-if
  6353*    end-if
  6354     IF EIBAID = DFHPF5
  6355        IF EMI-ERROR = ZEROS
  6356          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6357        ELSE
  6358          GO TO 1100-EDIT-COMPLETE.
  6359
  6360     IF EIBAID = DFHPF6
  6361        IF EMI-ERROR = ZEROS
  6362           GO TO 6300-BUILD-CERT-SCREEN
  6363         ELSE
  6364           GO TO 1100-EDIT-COMPLETE.
  6365
  6366     IF EIBAID = DFHPF7
  6367        IF EMI-ERROR = ZEROS
  6368           GO TO 6600-build-beneficiary-screen
  6369         ELSE
  6370           GO TO 1100-EDIT-COMPLETE.
  6371     if mainti = 'A'
  6372        if dedcynl not = zeros
  6373           if dedcyni <> pi-previous-deduct-comm
  6374              perform 6700-build-common
  6375                                 thru 6700-exit
  6376              MOVE WS-REFUND-AMOUNT
  6377                                 TO AMOUNTO
  6378              MOVE AL-UANON      TO PAYTO1A
  6379                                    PAYTO2A
  6380                                    PAYAD1A
  6381                                    PAYCTYA
  6382                                    paysta
  6383                                    PTOZIPA
  6384              GO TO 8100-send-initial-map
  6385           end-if
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 112
* EL677.cbl
  6386        end-if
  6387     end-if
  6388*    if mainti = 'V'
  6389*       if (vreasonl > zeros)
  6390*          and (vreasoni (1:2) not = spaces)
  6391*          continue
  6392*       else
  6393*          move er-3454          to emi-error
  6394*          move -1               to vreasonl
  6395*          move al-uabon         to vreasona
  6396*          perform 9900-error-format
  6397*                                thru 9900-exit
  6398*       end-if
  6399*    end-if
  6400     IF MAINTI = 'A'
  6401        if (payto1i not = spaces and low-values)
  6402           and (payad1i not = spaces and low-values)
  6403           and (payctyi not = spaces and low-values)
  6404           and (paysti not = spaces and low-values)
  6405           and (ptozipi not = spaces and low-values)
  6406           continue
  6407        else
  6408           MOVE -1               TO PAYTO1L
  6409           MOVE ER-2907          TO EMI-ERROR
  6410           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6411        end-if
  6412     end-if
  6413
  6414     IF MAINTI = 'A'
  6415         IF EIBAID NOT = DFHPF4
  6416             MOVE DFHENTER       TO  EIBAID
  6417             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6418
  6419     IF MAINTI = 'S' OR 'V' or 'R' or 'D' or 'X'
  6420         GO TO 1100-EDIT-COMPLETE.
  6421
  6422     IF PRINTEDL GREATER THAN +0
  6423         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6424         PERFORM 8700-DEEDIT
  6425         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6426             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6427             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6428             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6429             MOVE '4'                TO  DC-OPTION-CODE
  6430             PERFORM 8500-DATE-CONVERT
  6431             IF DC-ERROR-CODE NOT = SPACES
  6432                 MOVE ER-3046        TO  EMI-ERROR
  6433                 PERFORM 9900-ERROR-FORMAT
  6434                 MOVE -1             TO  PRINTEDL
  6435                 MOVE AL-UABON       TO  PRINTEDA
  6436                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6437             ELSE
  6438                 MOVE AL-UANON       TO  PRINTEDA
  6439                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6440         ELSE
  6441             MOVE ER-3046        TO  EMI-ERROR
  6442             PERFORM 9900-ERROR-FORMAT
  6443             MOVE -1             TO  PRINTEDL
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 113
* EL677.cbl
  6444             MOVE AL-UABON       TO  PRINTEDA
  6445             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6446
  6447     IF AMOUNTL = ZEROS
  6448         GO TO 1050-CK-AMT.
  6449
  6450*    EXEC CICS BIF DEEDIT
  6451*        FIELD   (AMOUNTI)
  6452*        LENGTH  (11)
  6453*    END-EXEC.
  6454
  6455     IF AMOUNTI NOT NUMERIC     OR
  6456        AMOUNTI LESS THAN ZERO  OR
  6457       (AMOUNTI = ZEROS  AND
  6458               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6459          MOVE ER-1159            TO  EMI-ERROR
  6460          MOVE -1                 TO  AMOUNTL
  6461          MOVE AL-UNBON           TO  AMOUNTA
  6462          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6463          GO TO 1100-EDIT-COMPLETE.
  6464
  6465     MOVE AMOUNTI                TO  WS-AM-WORK.
  6466
  6467     IF WS-AM-SIGN = SPACES
  6468         MOVE WS-AM-NUM          TO  WS-AMT
  6469         ADD 0                   TO  WS-AMT
  6470       ELSE
  6471         MOVE AMOUNTI            TO  WS-AMT
  6472         ADD 0                   TO  WS-AMT.
  6473
  6474     IF MAINTI = 'A'
  6475        IF EIBAID = DFHENTER
  6476           if (ws-amt + pi-prev-paid) >
  6477              (cm-lf-premium-amt + cm-lf-alt-premium-amt +
  6478                 cm-ah-premium-amt)
  6479              move zeros to ws-amt
  6480           end-if
  6481        end-if
  6482     end-if
  6483      MOVE WS-AMT                TO  AMOUNTO.
  6484      MOVE AL-UNNON              TO  AMOUNTA.
  6485
  6486 1050-CK-AMT.
  6487     IF AMOUNTL = ZEROS AND
  6488        MAINTI  = 'A'
  6489         MOVE ER-1159            TO  EMI-ERROR
  6490         MOVE -1                 TO  AMOUNTL
  6491         MOVE AL-UNBON           TO  AMOUNTA
  6492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6493
  6494*    MOVE AL-UANON              TO  TYPEA.
  6495     if (amountl <> zeros)
  6496        if (ws-amt <= zeros)
  6497           and (pi-check-type <> 'C')
  6498           MOVE ER-9999          TO EMI-ERROR
  6499           MOVE -1               TO AMOUNTL
  6500           MOVE AL-UNBON         TO AMOUNTA
  6501           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 114
* EL677.cbl
  6502                                 THRU 9900-EXIT
  6503        end-if
  6504     end-if
  6505     IF TYPEL GREATER THAN ZEROS
  6506         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6507             NEXT SENTENCE
  6508         ELSE
  6509             MOVE ER-3044    TO  EMI-ERROR
  6510             MOVE -1         TO  TYPEL
  6511             MOVE AL-PABON   TO  TYPEA
  6512             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6513     ELSE
  6514         IF MAINTI  = 'A'
  6515             MOVE ER-3044    TO  EMI-ERROR
  6516             MOVE -1         TO  TYPEL
  6517             MOVE AL-PABON   TO  TYPEA
  6518             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6519
  6520
  6521 1100-EDIT-COMPLETE.
  6522
  6523     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6524       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6525        EIBAID NOT = DFHPF4)
  6526         GO TO 8200-SEND-DATAONLY.
  6527
  6528     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6529
  6530     IF MAINTI = 'A'
  6531         GO TO 2000-ADD-RECORD.
  6532
  6533*    IF MAINTI = 'C' OR 'V'
  6534     IF MAINTI = 'V' or 'R' or 'X'
  6535         GO TO 3000-CHANGE-RECORD.
  6536
  6537     IF MAINTI = 'S' or 'C'
  6538         GO TO 5000-BROWSE-FILE.
  6539
  6540     if mainti = 'D'
  6541        go to 3400-delete-record
  6542     end-if
  6543     .
  6544 1200-VERIFY-CARRIER-ID.
  6545     MOVE SPACES                 TO ELCNTL-KEY.
  6546     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6547     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6548     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6549     MOVE +0                     TO ELCNTL-SEQ.
  6550
  6551
  6552* EXEC CICS HANDLE CONDITION
  6553*        NOTFND   (1290-NO-CARRIER)
  6554*    END-EXEC.
  6555*    MOVE '"$I                   ! $ #00006396' TO DFHEIV0
  6556     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6558     MOVE X'2420233030303036333936' TO DFHEIV0(25:11)
  6559     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 115
* EL677.cbl
  6560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6561
  6562
  6563
  6564* EXEC CICS READ
  6565*        DATASET   (ELCNTL-FILE-ID)
  6566*        SET       (ADDRESS OF CONTROL-FILE)
  6567*        RIDFLD    (ELCNTL-KEY)
  6568*    END-EXEC.
  6569*    MOVE '&"S        E          (   #00006400' TO DFHEIV0
  6570     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6572     MOVE X'2020233030303036343030' TO DFHEIV0(25:11)
  6573     CALL 'kxdfhei1' USING DFHEIV0,
  6574           ELCNTL-FILE-ID,
  6575           DFHEIV20,
  6576           DFHEIV99,
  6577           ELCNTL-KEY,
  6578           DFHEIV99,
  6579           DFHEIV99,
  6580           DFHEIV99
  6581     SET ADDRESS OF CONTROL-FILE TO
  6582         DFHEIV20
  6583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6584
  6585
  6586     GO TO 1200-EXIT.
  6587
  6588 1290-NO-CARRIER.
  6589     MOVE ER-2208                TO EMI-ERROR.
  6590     MOVE -1                     TO CARRIERL.
  6591     MOVE AL-UABON               TO CARRIERA.
  6592     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6593
  6594 1200-EXIT.
  6595      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 116
* EL677.cbl
  6597 1300-VERIFY-STATE-ID.
  6598     MOVE SPACES                 TO ELCNTL-KEY.
  6599     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6600     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6601     MOVE STATEI                 TO ELCNTL-STATE.
  6602     MOVE +0                     TO ELCNTL-SEQ.
  6603
  6604
  6605* EXEC CICS HANDLE CONDITION
  6606*        NOTFND   (1380-NO-STATE)
  6607*    END-EXEC.
  6608*    MOVE '"$I                   ! % #00006424' TO DFHEIV0
  6609     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6611     MOVE X'2520233030303036343234' TO DFHEIV0(25:11)
  6612     CALL 'kxdfhei1' USING DFHEIV0
  6613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6614
  6615
  6616
  6617* EXEC CICS READ
  6618*        DATASET   (ELCNTL-FILE-ID)
  6619*        SET       (ADDRESS OF CONTROL-FILE)
  6620*        RIDFLD    (ELCNTL-KEY)
  6621*    END-EXEC.
  6622*    MOVE '&"S        E          (   #00006428' TO DFHEIV0
  6623     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6625     MOVE X'2020233030303036343238' TO DFHEIV0(25:11)
  6626     CALL 'kxdfhei1' USING DFHEIV0,
  6627           ELCNTL-FILE-ID,
  6628           DFHEIV20,
  6629           DFHEIV99,
  6630           ELCNTL-KEY,
  6631           DFHEIV99,
  6632           DFHEIV99,
  6633           DFHEIV99
  6634     SET ADDRESS OF CONTROL-FILE TO
  6635         DFHEIV20
  6636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6637
  6638
  6639     GO TO 1390-EXIT.
  6640
  6641 1380-NO-STATE.
  6642     MOVE ER-2209                TO EMI-ERROR.
  6643     MOVE -1                     TO STATEL.
  6644     MOVE AL-UABON               TO STATEA.
  6645     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6646
  6647 1390-EXIT.
  6648      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 117
* EL677.cbl
  6650
  6651 1400-VERIFY-ACCOUNT.
  6652     IF EIBAID = DFHPF5
  6653         GO TO 1410-BUILD-ACCOUNT-KEY.
  6654
  6655     IF MAINTL GREATER +0
  6656         NEXT SENTENCE
  6657       ELSE
  6658         GO TO 1490-EXIT.
  6659
  6660*    IF MAINTI = 'A' OR 'C' OR 'V'
  6661     IF MAINTI = 'A' OR 'V' or 'R'
  6662         NEXT SENTENCE
  6663       ELSE
  6664         GO TO 1490-EXIT.
  6665
  6666 1410-BUILD-ACCOUNT-KEY.
  6667     MOVE CARRIERI               TO ERACCT-CARRIER.
  6668     MOVE GROUPI                 TO ERACCT-GROUPING
  6669     MOVE STATEI                 TO ERACCT-STATE.
  6670     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6671     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6672
  6673     MOVE '2'                    TO DC-OPTION-CODE.
  6674     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6675
  6676     PERFORM 8500-DATE-CONVERT.
  6677     IF DATE-CONVERSION-ERROR
  6678        GO TO 1480-ACCOUNT-INVALID.
  6679
  6680     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6681    .
  6682 1420-get-eracct.
  6683     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6684
  6685
  6686* EXEC CICS HANDLE CONDITION
  6687*        NOTFND   (1480-ACCOUNT-INVALID)
  6688*        ENDFILE  (1480-ACCOUNT-INVALID)
  6689*    END-EXEC.
  6690*    MOVE '"$I''                  ! & #00006480' TO DFHEIV0
  6691     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6692     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6693     MOVE X'2620233030303036343830' TO DFHEIV0(25:11)
  6694     CALL 'kxdfhei1' USING DFHEIV0
  6695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6696
  6697
  6698
  6699* EXEC CICS STARTBR
  6700*        DATASET   (ERACCT-FILE-ID)
  6701*        RIDFLD    (ERACCT-KEY)
  6702*    END-EXEC.
  6703     MOVE 0
  6704       TO DFHEIV11
  6705*    MOVE '&,         G          &   #00006485' TO DFHEIV0
  6706     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6707     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 118
* EL677.cbl
  6708     MOVE X'2020233030303036343835' TO DFHEIV0(25:11)
  6709     CALL 'kxdfhei1' USING DFHEIV0,
  6710           ERACCT-FILE-ID,
  6711           ERACCT-KEY,
  6712           DFHEIV99,
  6713           DFHEIV11,
  6714           DFHEIV99
  6715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6716
  6717
  6718     set eracct-start to true
  6719     .
  6720 1420-READNEXT-ACCOUNT-MASTER.
  6721
  6722* EXEC CICS READNEXT
  6723*        DATASET   (ERACCT-FILE-ID)
  6724*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6725*        RIDFLD    (ERACCT-KEY)
  6726*    END-EXEC.
  6727     MOVE 0
  6728       TO DFHEIV11
  6729*    MOVE '&.S                   )   #00006493' TO DFHEIV0
  6730     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6731     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6732     MOVE X'2020233030303036343933' TO DFHEIV0(25:11)
  6733     CALL 'kxdfhei1' USING DFHEIV0,
  6734           ERACCT-FILE-ID,
  6735           DFHEIV20,
  6736           DFHEIV99,
  6737           ERACCT-KEY,
  6738           DFHEIV99,
  6739           DFHEIV11,
  6740           DFHEIV99,
  6741           DFHEIV99
  6742     SET ADDRESS OF ACCOUNT-MASTER TO
  6743         DFHEIV20
  6744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6745
  6746
  6747*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6748*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6749*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6750*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6751*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6752*         GO TO 1480-ACCOUNT-INVALID.
  6753*
  6754*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6755*        GO TO 1480-ACCOUNT-INVALID.
  6756*
  6757*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6758*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6759
  6760     evaluate true
  6761        when (save-eracct-key (1:20) not =
  6762           am-control-primary (1:20))
  6763           and (not eracct-found)
  6764           go to 1480-account-invalid
  6765        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 119
* EL677.cbl
  6766           am-control-primary (1:20))
  6767           and (eracct-found)
  6768           move ws-hold-eracct-record
  6769                                 to account-master
  6770        when (sv-acct-exp-date < am-effective-dt)
  6771           and (not eracct-found)
  6772           go to 1480-account-invalid
  6773        when sv-acct-exp-date >= am-expiration-dt
  6774           go to 1420-readnext-account-master
  6775        when am-expiration-dt = high-values
  6776           continue
  6777        when other
  6778           set eracct-found to true
  6779           move account-master   to ws-hold-eracct-record
  6780           go to 1420-readnext-account-master
  6781     end-evaluate
  6782     if eracct-start
  6783
  6784* exec cics endbr
  6785*          dataset  (eracct-file-id)
  6786*       end-exec
  6787     MOVE 0
  6788       TO DFHEIV11
  6789*    MOVE '&2                    $   #00006535' TO DFHEIV0
  6790     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6791     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6792     MOVE X'2020233030303036353335' TO DFHEIV0(25:11)
  6793     CALL 'kxdfhei1' USING DFHEIV0,
  6794           eracct-file-id,
  6795           DFHEIV11,
  6796           DFHEIV99
  6797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6798     end-if
  6799*    if am-expiration-dt = high-values
  6800*       continue
  6801*    else
  6802*       move account-master      to ws-hold-eracct-record
  6803*       go to 1420-readnext-account-master
  6804*    end-if
  6805     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6806     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6807     MOVE AM-STATE               TO PI-CR-STATE.
  6808     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6809
  6810     MOVE AM-NAME                TO PI-AM-NAME.
  6811     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6812     MOVE AM-CITY                TO PI-AM-CITY-st
  6813     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6814     move am-csr-code            to pi-am-csr
  6815
  6816     MOVE +0                     TO WS-SUB.
  6817
  6818 1430-FIND-ACC-AGT.
  6819     ADD +1                      TO WS-SUB.
  6820
  6821     IF  WS-SUB GREATER +10
  6822         GO TO 1480-ACCOUNT-INVALID.
  6823
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 120
* EL677.cbl
  6824     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6825         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6826       ELSE
  6827         GO TO 1430-FIND-ACC-AGT.
  6828
  6829     MOVE AL-UANON               TO CARRIERA
  6830                                    GROUPA
  6831                                    STATEA.
  6832
  6833     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6834
  6835     GO TO 1490-EXIT.
  6836
  6837 1480-ACCOUNT-INVALID.
  6838     MOVE -1                     TO CARRIERL
  6839     MOVE AL-UANON               TO CARRIERA
  6840                                    GROUPA
  6841                                    STATEA
  6842                                    ACCTA.
  6843     MOVE ER-2210                TO EMI-ERROR.
  6844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6845     GO TO 8200-SEND-DATAONLY.
  6846
  6847 1490-EXIT.
  6848      EXIT.
  6849
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 121
* EL677.cbl
  6851 1500-VERIFY-PENDING-BUS-REC.
  6852     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6853     if pi-corr-check
  6854        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6855        go to 1590-exit
  6856     end-if
  6857
  6858* EXEC CICS HANDLE CONDITION
  6859*        NOTFND   (1590-EXIT)
  6860*    END-EXEC.
  6861*    MOVE '"$I                   ! '' #00006597' TO DFHEIV0
  6862     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6864     MOVE X'2720233030303036353937' TO DFHEIV0(25:11)
  6865     CALL 'kxdfhei1' USING DFHEIV0
  6866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6867
  6868
  6869
  6870     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6871     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6872     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6873     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6874     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6875     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6876     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6877     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6878     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6879     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6880
  6881     IF ST-ACCNT-CNTL  OR
  6882        ACCNT-CNTL
  6883          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6884
  6885     IF ST-ACCNT-CNTL      OR
  6886        CARR-ST-ACCNT-CNTL OR
  6887        ACCNT-CNTL         OR
  6888        CARR-ACCNT-CNTL
  6889          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6890
  6891     IF ACCNT-CNTL OR
  6892        CARR-ACCNT-CNTL
  6893          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6894
  6895
  6896* EXEC CICS READ
  6897*         DATASET   (ERPNDB-ALT-FILE-ID)
  6898*         SET       (ADDRESS OF PENDING-BUSINESS)
  6899*         RIDFLD    (ERPNDB-ALT-KEY)
  6900*     END-EXEC.
  6901*    MOVE '&"S        E          (   #00006627' TO DFHEIV0
  6902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6904     MOVE X'2020233030303036363237' TO DFHEIV0(25:11)
  6905     CALL 'kxdfhei1' USING DFHEIV0,
  6906           ERPNDB-ALT-FILE-ID,
  6907           DFHEIV20,
  6908           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 122
* EL677.cbl
  6909           ERPNDB-ALT-KEY,
  6910           DFHEIV99,
  6911           DFHEIV99,
  6912           DFHEIV99
  6913     SET ADDRESS OF PENDING-BUSINESS TO
  6914         DFHEIV20
  6915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6916
  6917
  6918     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6919
  6920     IF PB-C-PAYEE-CODE GREATER SPACES
  6921        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6922
  6923     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6924*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6925
  6926     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6927     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6928
  6929     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6930         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6931     ELSE
  6932         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6933
  6934*    IF MAINTI = 'A' OR 'C'
  6935*      IF PB-C-REFUND-CREATED
  6936*          MOVE -1               TO  MAINTL
  6937*          MOVE ER-3445          TO  EMI-ERROR
  6938*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6939
  6940 1590-EXIT.
  6941      EXIT.
  6942
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 123
* EL677.cbl
  6944 2000-ADD-RECORD.
  6945
  6946* EXEC CICS GETMAIN
  6947*        SET      (ADDRESS OF CHECK-RECORDS)
  6948*        LENGTH   (600)
  6949*        INITIMG  (GETMAIN-SPACE)
  6950*    END-EXEC.
  6951     MOVE 600
  6952       TO DFHEIV11
  6953*    MOVE ',"IL                  $   #00006660' TO DFHEIV0
  6954     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6955     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6956     MOVE X'2020233030303036363630' TO DFHEIV0(25:11)
  6957     CALL 'kxdfhei1' USING DFHEIV0,
  6958           DFHEIV20,
  6959           DFHEIV11,
  6960           GETMAIN-SPACE
  6961     SET ADDRESS OF CHECK-RECORDS TO
  6962         DFHEIV20
  6963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6964
  6965
  6966     MOVE 'CH'                   TO CH-RECORD-ID.
  6967     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6968     MOVE CARRIERI               TO CH-CARRIER.
  6969     MOVE GROUPI                 TO CH-GROUPING.
  6970     MOVE STATEI                 TO CH-STATE.
  6971     MOVE ACCTI                  TO CH-ACCOUNT.
  6972
  6973     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6974     MOVE '2'                    TO DC-OPTION-CODE.
  6975     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6976     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6977
  6978     MOVE CERTNOI                TO CH-CERT-PRIME.
  6979     MOVE SFXI                   TO CH-CERT-SFX.
  6980
  6981     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6982
  6983     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6984                                    ch-released-by
  6985     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6986
  6987     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6988     MOVE '5'                    TO DC-OPTION-CODE.
  6989     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6990     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6991                                    ch-released-dt
  6992
  6993     move 'P'                    to ch-approval-status
  6994
  6995     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6996                                    CH-VOID-DT
  6997                                    CH-CREDIT-ACCEPT-DT
  6998                                    CH-CANC-DT
  6999                                    ch-approval-dt
  7000                                    ch-check-cashed-dt
  7001     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 124
* EL677.cbl
  7002                                    CH-AH-REFUND
  7003*                                   CH-DEDUCT-WITHHELD
  7004*                                   CH-ADDITIONAL-CHARGE.
  7005
  7006     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7007
  7008     if pi-prev-paid not numeric
  7009        move zeros               to pi-prev-paid
  7010     end-if
  7011     if pi-prev-paid-this-month not numeric
  7012        move zeros               to pi-prev-paid-this-month
  7013     end-if
  7014     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7015       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7016        EIBAID NOT = DFHPF4)
  7017         GO TO 8200-SEND-DATAONLY.
  7018
  7019     add ch-amount-paid to pi-prev-paid
  7020     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  7021     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  7022     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  7023     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  7024     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  7025     move pi-am-csr              to ch-csr
  7026     .
  7027 2100-WRITE-RECORD.
  7028
  7029* exec cics read
  7030*       dataset    (erchek-file-id)
  7031*       into       (ws-dummy-erchek)
  7032*       ridfld     (ch-control-primary)
  7033*       resp       (ws-response)
  7034*    end-exec
  7035     MOVE LENGTH OF
  7036      ws-dummy-erchek
  7037       TO DFHEIV11
  7038*    MOVE '&"IL       E          (  N#00006728' TO DFHEIV0
  7039     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7041     MOVE X'204E233030303036373238' TO DFHEIV0(25:11)
  7042     CALL 'kxdfhei1' USING DFHEIV0,
  7043           erchek-file-id,
  7044           ws-dummy-erchek,
  7045           DFHEIV11,
  7046           ch-control-primary,
  7047           DFHEIV99,
  7048           DFHEIV99,
  7049           DFHEIV99
  7050     MOVE EIBRESP  TO ws-response
  7051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7052     if RESP-NOTFND
  7053        continue
  7054     else
  7055        add +1 to ch-sequence-no
  7056        add 1 to seqi
  7057        go to 2100-write-record
  7058     end-if
  7059     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 125
* EL677.cbl
  7060
  7061* EXEC CICS HANDLE CONDITION
  7062*        DUPREC (2200-DUPREC)
  7063*    END-EXEC.
  7064*    MOVE '"$%                   ! ( #00006742' TO DFHEIV0
  7065     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7067     MOVE X'2820233030303036373432' TO DFHEIV0(25:11)
  7068     CALL 'kxdfhei1' USING DFHEIV0
  7069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7070
  7071
  7072     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7073     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7074                                    CH-CHECK-QUE-SEQUENCE
  7075
  7076
  7077* EXEC CICS WRITE
  7078*        DATASET  (ERCHEK-FILE-ID)
  7079*        FROM     (CHECK-RECORDS)
  7080*        RIDFLD   (CH-CONTROL-PRIMARY)
  7081*        resp     (ws-response)
  7082*    END-EXEC.
  7083     MOVE LENGTH OF
  7084      CHECK-RECORDS
  7085       TO DFHEIV11
  7086*    MOVE '&$ L                  ''  N#00006750' TO DFHEIV0
  7087     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7088     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7089     MOVE X'204E233030303036373530' TO DFHEIV0(25:11)
  7090     CALL 'kxdfhei1' USING DFHEIV0,
  7091           ERCHEK-FILE-ID,
  7092           CHECK-RECORDS,
  7093           DFHEIV11,
  7094           CH-CONTROL-PRIMARY,
  7095           DFHEIV99,
  7096           DFHEIV99
  7097     MOVE EIBRESP  TO ws-response
  7098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7099
  7100     if resp-normal and pi-check-type = 'C'
  7101        move 'Y'                 to pi-check-cut
  7102     end-if
  7103     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7104             ERCHEK-RECORD-LENGTH + 23.
  7105
  7106     if pi-check-type not = 'C'
  7107        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7108                                 THRU 6200-EXIT
  7109        if resp-normal
  7110           MOVE 'Y'              TO PB-C-REFUND-SW
  7111           add +1 to pi-chek-rec-cnt
  7112           perform 6210-rewrite-pndb
  7113                                 thru 6210-exit
  7114*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7115        end-if
  7116     end-if
  7117     IF EMI-NO-ERRORS
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 126
* EL677.cbl
  7118         MOVE ER-0000            TO EMI-ERROR
  7119     ELSE
  7120         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7121            EIBAID = DFHPF4
  7122             MOVE ER-2600        TO EMI-ERROR.
  7123
  7124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7125
  7126     MOVE LOW-VALUES             TO EL677AI.
  7127
  7128     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7129     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7130     MOVE PI-CHEK-STATE          TO STATEO.
  7131     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7132
  7133     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7134     MOVE SPACE                  TO DC-OPTION-CODE.
  7135     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7136     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7137
  7138     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7139     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7140     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7141
  7142     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7143                                    ACCTA     EFFDTA  CERTNOA
  7144                                    SFXA.
  7145     MOVE AL-UNNON               TO SEQA.
  7146     go to 5000-browse-file
  7147     GO TO 8100-SEND-INITIAL-MAP.
  7148
  7149 2200-DUPREC.
  7150     ADD +1 TO CH-SEQUENCE-NO.
  7151     MOVE CH-SEQUENCE-NO         TO SEQO
  7152                                    PI-CHEK-SEQUENCE
  7153                                    CHEK-RECORD-SEQ.
  7154     GO TO 2100-WRITE-RECORD.
  7155 2700-WRITE-SQL.
  7156     perform 2710-build-rec      thru 2710-exit
  7157     perform 2720-insert-row     thru 2720-exit
  7158     perform 4300-FINISH-UP-DB   thru 4300-exit
  7159     .
  7160 2700-EXIT.
  7161     EXIT.
  7162 2710-BUILD-REC.
  7163     move spaces                 to daily-check-request-rec
  7164     move pi-company-id          to db-compid
  7165     move ch-carrier             to db-carrier
  7166                                    db-fincar
  7167     move ch-grouping            to db-grouping
  7168                                    db-fingrp
  7169     move ch-state               to db-state
  7170     move ch-account             to db-account
  7171     move ch-cert-eff-dt         to dc-bin-date-1
  7172     move ' '                    to dc-option-code
  7173     perform 8500-date-convert   thru 8500-exit
  7174     if no-conversion-error
  7175        move dc-greg-date-a-edit to db-effdate
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 127
* EL677.cbl
  7176     else
  7177        move spaces              to db-effdate
  7178     end-if
  7179     move ch-cert-prime          to db-certificate
  7180     move ch-cert-sfx            to db-cert-sfx
  7181     move ch-sequence-no         to db-seq-no
  7182     move '1'                    to db-type
  7183                                    db-check-sub-type
  7184     if pi-check-type = 'C'
  7185        move '2'                 to db-check-sub-type
  7186     end-if
  7187     move ch-amount-paid         to db-amount-n
  7188     move zeros                  to db-checkstatus
  7189     move ch-check-que-control   to db-releasebatch
  7190     move save-bin-date          to dc-bin-date-1
  7191     move ' '                    to dc-option-code
  7192     perform 8500-date-convert   thru 8500-exit
  7193     if no-conversion-error
  7194        move dc-greg-date-a-edit to db-releasedt
  7195     else
  7196        move spaces              to db-releasedt
  7197     end-if
  7198     move pi-processor-id        to db-releaseby
  7199     move ch-payee-name-1        to db-payeename1
  7200     move ch-payee-name-2        to db-payeename2
  7201     move ch-payee-address-1     to db-payeeaddr1
  7202     move ch-payee-address-2     to db-payeeaddr2
  7203     move ch-payee-city          to db-payeecity
  7204     move ch-payee-state         to db-payeest
  7205     move ch-payee-zip-code      to db-payeezip
  7206     move ch-comp-fin-resp       to db-finresp
  7207     move ch-comp-account        to db-finacct
  7208     move ch-recorded-by         to db-preparer
  7209     move ch-return-to           to db-return-to
  7210     move pi-table-name          to db-insured-name
  7211     .
  7212 2710-EXIT.
  7213     EXIT.
  7214 2720-INSERT-ROW.
  7215     if not connected-to-db
  7216        perform 4100-CONNECT-TO-DB
  7217                                 thru 4100-exit
  7218     end-if
  7219     EXEC SQL
  7220        INSERT into ChkApp_Check (
  7221           Company,
  7222           CertCarrier,
  7223           CertGroup,
  7224           CertState,
  7225           CertAccount,
  7226           CertEffDate,
  7227           CertNumber,
  7228           CertNumberSuf,
  7229           CheckSeqNbr,
  7230           CheckType,
  7231           CheckAmount,
  7232           ReleaseBatchNbr,
  7233           ReleaseDate,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 128
* EL677.cbl
  7234           ReleasedBy,
  7235           PayeeName1,
  7236           PayeeName2,
  7237           PayeeAddress1,
  7238           PayeeAddress2,
  7239           PayeeCity,
  7240           PayeeState,
  7241           PayeeZip,
  7242           CompCarrier,
  7243           CompGroup,
  7244           CompFinResp,
  7245           CompAccount,
  7246           Preparer,
  7247           ReturnTo,
  7248           InsuredName,
  7249           CheckSubType)
  7250         VALUES (
  7251           :DB-CompId,
  7252           :DB-Carrier,
  7253           :DB-Grouping,
  7254           :DB-State,
  7255           :DB-Account,
  7256           :DB-EffDate,
  7257           :DB-Certificate,
  7258           :db-cert-sfx,
  7259           :DB-Seq-No,
  7260           :DB-Type,
  7261           :db-amount,
  7262           :db-releasebatch,
  7263           :db-releasedt,
  7264           :db-releaseby,
  7265           :db-payeename1,
  7266           :db-payeename2,
  7267           :db-payeeaddr1,
  7268           :db-payeeaddr2,
  7269           :db-payeecity,
  7270           :db-payeest,
  7271           :db-payeezip,
  7272           :db-fincar,
  7273           :db-fingrp,
  7274           :db-finresp,
  7275           :db-finacct,
  7276           :db-preparer,
  7277           :db-return-to,
  7278           :db-insured-name,
  7279           :db-check-sub-type)
  7280     END-EXEC
  7281*    display ' db-compid     ' db-compid
  7282*    display ' db-carrier    ' db-carrier
  7283*    display ' db-group      ' db-grouping
  7284*    display ' db state      ' db-state
  7285*    display ' accounbt      ' db-account
  7286*    display ' effdt         ' db-effdate
  7287*    display ' cert          ' db-certificate
  7288*    display ' suffix        ' db-cert-sfx
  7289*    display ' seq no        ' db-seq-no
  7290*    display ' type          ' db-type
  7291     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 129
* EL677.cbl
  7292        add +1                   to ch-sequence-no
  7293        move ch-sequence-no      to DB-Seq-No
  7294        go to 2720-insert-row
  7295     end-if
  7296     if sqlcode not = 0
  7297        display "Error: cannot insert row "
  7298        display ' sql return code ' sqlcode
  7299        move sqlcode to ws-sql-code
  7300        move ws-sql-code to ws-dis-sql-code
  7301        display ' dis sql code ' ws-dis-sql-code
  7302        display ' sql err mess    ' sqlerrmc
  7303        move sqlcode to ws-sql-code
  7304        move ws-sql-code to ws-dis-sql-code
  7305        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7306           into EMI-MESSAGE-AREA (1)
  7307        end-string
  7308        display ' msga1 ' emi-message-area (1)
  7309        perform 4300-FINISH-UP-DB thru 4300-exit
  7310        go to 8200-send-dataonly
  7311*       goback
  7312     end-if
  7313     .
  7314 2720-EXIT.
  7315     EXIT.
  7316 3000-CHANGE-RECORD.
  7317
  7318* EXEC CICS HANDLE CONDITION
  7319*        NOTFND (3900-RECORD-NOTFND)
  7320*    END-EXEC.
  7321*    MOVE '"$I                   ! ) #00006974' TO DFHEIV0
  7322     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7324     MOVE X'2920233030303036393734' TO DFHEIV0(25:11)
  7325     CALL 'kxdfhei1' USING DFHEIV0
  7326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7327
  7328     if mainti <> 'X'
  7329        go to 3000-continue
  7330     end-if
  7331
  7332     move pi-erchek-key          to erchek-key
  7333
  7334
  7335* exec cics startbr
  7336*        dataset     ('ERCHEK')
  7337*        ridfld      (erchek-key)
  7338*        resp        (ws-response)
  7339*    end-exec
  7340     MOVE 'ERCHEK' TO DFHEIV1
  7341     MOVE 0
  7342       TO DFHEIV11
  7343*    MOVE '&,         G          &  N#00006983' TO DFHEIV0
  7344     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7345     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7346     MOVE X'204E233030303036393833' TO DFHEIV0(25:11)
  7347     CALL 'kxdfhei1' USING DFHEIV0,
  7348           DFHEIV1,
  7349           erchek-key,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 130
* EL677.cbl
  7350           DFHEIV99,
  7351           DFHEIV11,
  7352           DFHEIV99
  7353     MOVE EIBRESP  TO ws-response
  7354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7355
  7356     if not resp-normal
  7357        display ' bad startbr ' ws-response
  7358        go to 3000-continue
  7359     end-if
  7360
  7361     .
  7362 3000-readnext.
  7363
  7364
  7365* exec cics readnext
  7366*       dataset    ('ERCHEK')
  7367*       ridfld  (erchek-key)
  7368*       set     (address of check-records)
  7369*       resp    (ws-response)
  7370*    end-exec
  7371     MOVE 'ERCHEK' TO DFHEIV1
  7372     MOVE 0
  7373       TO DFHEIV11
  7374*    MOVE '&.S                   )  N#00006997' TO DFHEIV0
  7375     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7376     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7377     MOVE X'204E233030303036393937' TO DFHEIV0(25:11)
  7378     CALL 'kxdfhei1' USING DFHEIV0,
  7379           DFHEIV1,
  7380           DFHEIV20,
  7381           DFHEIV99,
  7382           erchek-key,
  7383           DFHEIV99,
  7384           DFHEIV11,
  7385           DFHEIV99,
  7386           DFHEIV99
  7387     SET ADDRESS OF check-records TO
  7388         DFHEIV20
  7389     MOVE EIBRESP  TO ws-response
  7390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7391
  7392     if not resp-normal
  7393        display ' bad readnext ' ws-response
  7394        go to 3000-endbr
  7395     end-if
  7396
  7397     if ch-company-cd = pi-company-cd and
  7398        ch-carrier    = pi-chek-carrier and
  7399        ch-state      = pi-chek-state and
  7400        ch-account    = pi-chek-account and
  7401        ch-cert-eff-dt = pi-chek-eff-dt and
  7402        ch-cert-prime = pi-chek-cert-no and
  7403        ch-cert-sfx   = pi-chek-suf-no
  7404        continue
  7405     else
  7406        go to 3000-endbr
  7407     end-if
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 131
* EL677.cbl
  7408
  7409     if ch-amount-paid = pi-void-reissue-amt and
  7410        ch-void-dt = low-values and
  7411        ch-recorded-dt = save-bin-date
  7412        move er-3463             to emi-error
  7413        move -1                  to maintl
  7414        move al-uabon            to mainta
  7415        perform 9900-error-format
  7416                                 thru 9900-exit
  7417        go to 8200-send-dataonly
  7418     else
  7419        go to 3000-readnext
  7420     end-if
  7421
  7422     .
  7423 3000-endbr.
  7424
  7425
  7426* exec cics endbr
  7427*       dataset   ('ERCHEK')
  7428*    end-exec
  7429     MOVE 'ERCHEK' TO DFHEIV1
  7430     MOVE 0
  7431       TO DFHEIV11
  7432*    MOVE '&2                    $   #00007037' TO DFHEIV0
  7433     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7434     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7435     MOVE X'2020233030303037303337' TO DFHEIV0(25:11)
  7436     CALL 'kxdfhei1' USING DFHEIV0,
  7437           DFHEIV1,
  7438           DFHEIV11,
  7439           DFHEIV99
  7440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7441
  7442     .
  7443 3000-continue.
  7444
  7445
  7446* EXEC CICS READ
  7447*        DATASET  (ERCHEK-FILE-ID)
  7448*        SET      (ADDRESS OF CHECK-RECORDS)
  7449*        RIDFLD   (PI-ERCHEK-KEY)
  7450*        UPDATE
  7451*    END-EXEC.
  7452*    MOVE '&"S        EU         (   #00007044' TO DFHEIV0
  7453     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7454     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7455     MOVE X'2020233030303037303434' TO DFHEIV0(25:11)
  7456     CALL 'kxdfhei1' USING DFHEIV0,
  7457           ERCHEK-FILE-ID,
  7458           DFHEIV20,
  7459           DFHEIV99,
  7460           PI-ERCHEK-KEY,
  7461           DFHEIV99,
  7462           DFHEIV99,
  7463           DFHEIV99
  7464     SET ADDRESS OF CHECK-RECORDS TO
  7465         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 132
* EL677.cbl
  7466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7467
  7468
  7469     IF CH-LF-REFUND NOT NUMERIC
  7470         MOVE ZEROS              TO CH-LF-REFUND.
  7471     IF CH-AH-REFUND NOT NUMERIC
  7472         MOVE ZEROS              TO CH-AH-REFUND.
  7473*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7474*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7475*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7476*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7477
  7478     IF VREASONL NOT = ZEROS
  7479         MOVE VREASONI           TO  CH-VOID-REASON.
  7480
  7481     IF MAINTI = 'V' or 'R'
  7482        GO TO 3050-void-processing
  7483     end-if
  7484     .
  7485 3010-VOID-REVERSAL.  *>  Mainti of X only
  7486
  7487     if ch-void-dt = low-values
  7488        move er-3462             to emi-error
  7489        move -1                  to maintl
  7490        move al-uabon            to mainta
  7491
  7492* exec cics unlock
  7493*          dataset    (ERCHEK-FILE-ID)
  7494*       end-exec
  7495*    MOVE '&*                    #   #00007073' TO DFHEIV0
  7496     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7498     MOVE X'2020233030303037303733' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0,
  7500           ERCHEK-FILE-ID,
  7501           DFHEIV99
  7502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7503        perform 9900-error-format
  7504                                 thru 9900-exit
  7505        go to 8200-send-dataonly
  7506     end-if
  7507
  7508     if ch-void-dt <> SAVE-BIN-DATE
  7509        move er-3461             to emi-error
  7510        move -1                  to maintl
  7511        move al-uabon            to mainta
  7512
  7513* exec cics unlock
  7514*          dataset    (ERCHEK-FILE-ID)
  7515*       end-exec
  7516*    MOVE '&*                    #   #00007085' TO DFHEIV0
  7517     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7519     MOVE X'2020233030303037303835' TO DFHEIV0(25:11)
  7520     CALL 'kxdfhei1' USING DFHEIV0,
  7521           ERCHEK-FILE-ID,
  7522           DFHEIV99
  7523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 133
* EL677.cbl
  7524        perform 9900-error-format
  7525                                 thru 9900-exit
  7526        go to 8200-send-dataonly
  7527     end-if
  7528
  7529     move low-values             to ch-void-dt
  7530     move spaces                 to ch-void-by
  7531                                    ch-void-reason
  7532
  7533     go to 3100-rewrite-record
  7534     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7535
  7536     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7537
  7538     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7539       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7540        EIBAID NOT = DFHPF4)
  7541         GO TO 8200-SEND-DATAONLY.
  7542     go to 3100-rewrite-record
  7543     .
  7544 3050-void-processing.
  7545     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7546     if sqlcode = 0
  7547        perform 4200-get-tbl-row thru 4200-exit
  7548        if sqlcode = 0
  7549           if nu-app-date = -1
  7550              move -1            to maintl
  7551              move er-3453       to emi-error
  7552              move al-uabon      to mainta
  7553              perform 9900-error-format
  7554                                 thru 9900-exit
  7555              perform 4300-FINISH-UP-DB thru 4300-exit
  7556              go to 8200-send-dataonly
  7557           end-if
  7558        end-if
  7559        if connected-to-db
  7560           perform 4300-FINISH-UP-DB thru 4300-exit
  7561        end-if
  7562     end-if
  7563     if (ch-check-written-dt = low-values)
  7564        or (ch-check-no = spaces)
  7565        move -1                  to maintl
  7566        move er-3455             to emi-error
  7567        move al-uabon            to mainta
  7568        perform 9900-error-format
  7569                                 thru 9900-exit
  7570        perform 4300-FINISH-UP-DB thru 4300-exit
  7571        go to 8200-send-dataonly
  7572     end-if
  7573     .
  7574 3100-REWRITE-RECORD.
  7575     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7576
  7577     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7578     MOVE '5'                    TO DC-OPTION-CODE.
  7579     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7580
  7581     IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 134
* EL677.cbl
  7582       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7583     end-if
  7584     IF MAINTI = 'V' or 'R'
  7585        IF (CH-VOID-DT = LOW-VALUES)
  7586           and (pi-check-cashed = spaces)
  7587           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7588           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7589           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7590           if pi-chek-rec-cnt = +1
  7591              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7592                                 THRU 6200-EXIT
  7593              if resp-normal
  7594                 MOVE ' '        TO PB-C-REFUND-SW
  7595                 perform 6210-rewrite-pndb
  7596                                 thru 6210-exit
  7597              end-if
  7598           end-if
  7599        ELSE
  7600           MOVE -1               TO MAINTL
  7601           MOVE ER-2583          TO EMI-ERROR
  7602           MOVE AL-UABON         TO MAINTA
  7603           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7604           GO TO 8200-SEND-DATAONLY
  7605        end-if
  7606     end-if
  7607
  7608     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7609
  7610
  7611* EXEC CICS REWRITE
  7612*        DATASET  (ERCHEK-FILE-ID)
  7613*        FROM     (CHECK-RECORDS)
  7614*    END-EXEC.
  7615     MOVE LENGTH OF
  7616      CHECK-RECORDS
  7617       TO DFHEIV11
  7618*    MOVE '&& L                  %   #00007174' TO DFHEIV0
  7619     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7620     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7621     MOVE X'2020233030303037313734' TO DFHEIV0(25:11)
  7622     CALL 'kxdfhei1' USING DFHEIV0,
  7623           ERCHEK-FILE-ID,
  7624           CHECK-RECORDS,
  7625           DFHEIV11,
  7626           DFHEIV99
  7627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7628
  7629
  7630     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7631        (MAINTI EQUAL 'C')          AND
  7632        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7633            PERFORM 3300-UPDATE-ERPYAJ THRU 3300-EXIT.
  7634     if mainti = 'X'
  7635        perform 3320-remove-rev-erpyaj-rec
  7636                                 thru 3320-exit
  7637     end-if
  7638     IF EMI-NO-ERRORS
  7639         MOVE ER-0000            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 135
* EL677.cbl
  7640     ELSE
  7641         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7642            EIBAID = DFHPF4
  7643             MOVE ER-2600        TO EMI-ERROR.
  7644     if mainti = 'R'
  7645        if pi-void-reissue-pass = ' '
  7646           move '1'              to pi-void-reissue-pass
  7647        MOVE ER-3274             TO EMI-ERROR
  7648        end-if
  7649     end-if
  7650     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7651
  7652     MOVE LOW-VALUES             TO EL677AI.
  7653
  7654     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7655     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7656     MOVE PI-CHEK-STATE          TO STATEO.
  7657     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7658
  7659     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7660     MOVE SPACE                  TO DC-OPTION-CODE.
  7661     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7662     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7663
  7664     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7665     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7666     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7667
  7668     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7669                                     ACCTA   EFFDTA
  7670                                    CERTNOA   SFXA.
  7671
  7672     MOVE AL-UNNON               TO SEQA.
  7673     go to 5000-browse-file
  7674*    GO TO 8100-SEND-INITIAL-MAP.
  7675
  7676     .
  7677 3200-PAY-ADJS-REVERSAL.
  7678
  7679     IF CH-AMOUNT-PAID NOT = ZEROS
  7680         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7681         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7682
  7683     GO TO 3290-EXIT
  7684     .
  7685 3250-BUILD-ERPYAJ-REVERSAL.
  7686
  7687
  7688* EXEC CICS GETMAIN
  7689*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7690*        LENGTH  (200)
  7691*        INITIMG (GETMAIN-SPACE)
  7692*    END-EXEC.
  7693     MOVE 200
  7694       TO DFHEIV11
  7695*    MOVE ',"IL                  $   #00007236' TO DFHEIV0
  7696     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7697     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 136
* EL677.cbl
  7698     MOVE X'2020233030303037323336' TO DFHEIV0(25:11)
  7699     CALL 'kxdfhei1' USING DFHEIV0,
  7700           DFHEIV20,
  7701           DFHEIV11,
  7702           GETMAIN-SPACE
  7703     SET ADDRESS OF PENDING-PAY-ADJ TO
  7704         DFHEIV20
  7705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7706
  7707
  7708     MOVE 'PY'                   TO PY-RECORD-ID.
  7709     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7710
  7711     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7712     IF PI-ZERO-CARRIER  OR
  7713        PI-ZERO-CAR-GROUP
  7714         MOVE ZERO               TO PY-CARRIER.
  7715
  7716     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7717     IF PI-ZERO-GROUPING  OR
  7718        PI-ZERO-CAR-GROUP
  7719         MOVE ZERO               TO PY-GROUPING.
  7720
  7721     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7722     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7723     MOVE 'R'                    TO PY-RECORD-TYPE.
  7724     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7725     move '1825011300'           to py-gl-account
  7726     move 'VOID REFCK'           TO py-gl-comment
  7727     move ch-amount-paid         to py-entry-amt
  7728*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7729
  7730     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7731     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7732
  7733     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7734     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7735     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7736                                    PY-INPUT-DT.
  7737*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7738*                                   PY-CHECK-QUE-SEQUENCE.
  7739     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7740                                    PY-BILLED-DATE
  7741                                    PY-REPORTED-DT
  7742                                    PY-CHECK-WRITTEN-DT
  7743                                    PY-AR-DATE
  7744                                    PY-GL-DATE.
  7745     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7746     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7747*    MOVE 'V'                    TO PY-VOID-SW.
  7748*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7749
  7750     IF PI-AR-PROCESSING
  7751         MOVE 'B'                TO PY-PYMT-TYPE
  7752         MOVE 'A'                TO PY-PMT-APPLIED.
  7753
  7754 3259-BUILD-EXIT.
  7755     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 137
* EL677.cbl
  7756
  7757 3280-WRITE-ERPYAJ-REVERSAL.
  7758
  7759
  7760* EXEC CICS HANDLE CONDITION
  7761*        DUPREC (3287-DUPREC)
  7762*    END-EXEC.
  7763*    MOVE '"$%                   ! * #00007293' TO DFHEIV0
  7764     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7766     MOVE X'2A20233030303037323933' TO DFHEIV0(25:11)
  7767     CALL 'kxdfhei1' USING DFHEIV0
  7768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7769
  7770
  7771
  7772* EXEC CICS WRITE
  7773*        DATASET (ERPYAJ-FILE-ID)
  7774*        FROM    (PENDING-PAY-ADJ)
  7775*        RIDFLD  (PY-CONTROL-PRIMARY)
  7776*    END-EXEC.
  7777     MOVE LENGTH OF
  7778      PENDING-PAY-ADJ
  7779       TO DFHEIV11
  7780*    MOVE '&$ L                  ''   #00007297' TO DFHEIV0
  7781     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7782     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7783     MOVE X'2020233030303037323937' TO DFHEIV0(25:11)
  7784     CALL 'kxdfhei1' USING DFHEIV0,
  7785           ERPYAJ-FILE-ID,
  7786           PENDING-PAY-ADJ,
  7787           DFHEIV11,
  7788           PY-CONTROL-PRIMARY,
  7789           DFHEIV99,
  7790           DFHEIV99
  7791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7792
  7793
  7794     GO TO 3289-WRITE-EXIT.
  7795
  7796 3287-DUPREC.
  7797     ADD +1 TO PY-FILE-SEQ-NO.
  7798
  7799     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7800
  7801 3289-WRITE-EXIT.
  7802     EXIT.
  7803
  7804 3290-EXIT.
  7805      EXIT.
  7806
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 138
* EL677.cbl
  7808 3300-UPDATE-ERPYAJ.
  7809
  7810
  7811* EXEC CICS GETMAIN
  7812*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7813*        LENGTH  (200)
  7814*        INITIMG (GETMAIN-SPACE)
  7815*    END-EXEC.
  7816     MOVE 200
  7817       TO DFHEIV11
  7818*    MOVE ',"IL                  $   #00007319' TO DFHEIV0
  7819     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7820     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7821     MOVE X'2020233030303037333139' TO DFHEIV0(25:11)
  7822     CALL 'kxdfhei1' USING DFHEIV0,
  7823           DFHEIV20,
  7824           DFHEIV11,
  7825           GETMAIN-SPACE
  7826     SET ADDRESS OF PENDING-PAY-ADJ TO
  7827         DFHEIV20
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7829
  7830
  7831     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7832     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7833     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7834     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7835     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7836     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7837     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7838
  7839
  7840* EXEC CICS HANDLE CONDITION
  7841*        NOTFND   (3300-EXIT)
  7842*        ENDFILE  (3300-EXIT)
  7843*    END-EXEC.
  7844*    MOVE '"$I''                  ! + #00007333' TO DFHEIV0
  7845     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7847     MOVE X'2B20233030303037333333' TO DFHEIV0(25:11)
  7848     CALL 'kxdfhei1' USING DFHEIV0
  7849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7850
  7851
  7852 3300-READNEXT-ERPYAJ.
  7853
  7854
  7855* EXEC CICS READ
  7856*        DATASET  (ERPYAJ-FILE-ID)
  7857*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7858*        RIDFLD   (ERPYAJ-KEY)
  7859*        GTEQ
  7860*    END-EXEC.
  7861*    MOVE '&"S        G          (   #00007340' TO DFHEIV0
  7862     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7863     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7864     MOVE X'2020233030303037333430' TO DFHEIV0(25:11)
  7865     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 139
* EL677.cbl
  7866           ERPYAJ-FILE-ID,
  7867           DFHEIV20,
  7868           DFHEIV99,
  7869           ERPYAJ-KEY,
  7870           DFHEIV99,
  7871           DFHEIV99,
  7872           DFHEIV99
  7873     SET ADDRESS OF PENDING-PAY-ADJ TO
  7874         DFHEIV20
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7876
  7877
  7878     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7879
  7880     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7881        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7882        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7883        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7884        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7885        (PY-RECORD-TYPE   NOT = 'C')
  7886          GO TO 3300-EXIT.
  7887
  7888     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7889         ADD +1 TO PYAJ-FILE-SEQ-NO
  7890         GO TO 3300-READNEXT-ERPYAJ.
  7891
  7892
  7893* EXEC CICS READ UPDATE
  7894*        DATASET   (ERPYAJ-FILE-ID)
  7895*        RIDFLD    (ERPYAJ-KEY)
  7896*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7897*    END-EXEC.
  7898*    MOVE '&"S        EU         (   #00007361' TO DFHEIV0
  7899     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7900     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7901     MOVE X'2020233030303037333631' TO DFHEIV0(25:11)
  7902     CALL 'kxdfhei1' USING DFHEIV0,
  7903           ERPYAJ-FILE-ID,
  7904           DFHEIV20,
  7905           DFHEIV99,
  7906           ERPYAJ-KEY,
  7907           DFHEIV99,
  7908           DFHEIV99,
  7909           DFHEIV99
  7910     SET ADDRESS OF PENDING-PAY-ADJ TO
  7911         DFHEIV20
  7912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7913
  7914
  7915     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7916     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7917
  7918     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7919
  7920     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7921     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7922     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7923
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 140
* EL677.cbl
  7924
  7925* EXEC CICS REWRITE
  7926*        DATASET  (ERPYAJ-FILE-ID)
  7927*        FROM     (PENDING-PAY-ADJ)
  7928*    END-EXEC.
  7929     MOVE LENGTH OF
  7930      PENDING-PAY-ADJ
  7931       TO DFHEIV11
  7932*    MOVE '&& L                  %   #00007376' TO DFHEIV0
  7933     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7934     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7935     MOVE X'2020233030303037333736' TO DFHEIV0(25:11)
  7936     CALL 'kxdfhei1' USING DFHEIV0,
  7937           ERPYAJ-FILE-ID,
  7938           PENDING-PAY-ADJ,
  7939           DFHEIV11,
  7940           DFHEIV99
  7941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7942
  7943
  7944 3300-EXIT.
  7945      EXIT.
  7946
  7947 3320-remove-rev-erpyaj-rec.
  7948
  7949
  7950* EXEC CICS GETMAIN
  7951*       SET     (ADDRESS OF PENDING-PAY-ADJ)
  7952*       LENGTH  (200)
  7953*       INITIMG (GETMAIN-SPACE)
  7954*    END-EXEC
  7955     MOVE 200
  7956       TO DFHEIV11
  7957*    MOVE ',"IL                  $   #00007386' TO DFHEIV0
  7958     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7959     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7960     MOVE X'2020233030303037333836' TO DFHEIV0(25:11)
  7961     CALL 'kxdfhei1' USING DFHEIV0,
  7962           DFHEIV20,
  7963           DFHEIV11,
  7964           GETMAIN-SPACE
  7965     SET ADDRESS OF PENDING-PAY-ADJ TO
  7966         DFHEIV20
  7967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7968
  7969     MOVE PI-COMPANY-CD          TO erpyaj-key
  7970     MOVE ch-comp-CARRIER        TO PYAJ-CARRIER
  7971     MOVE ch-comp-grouping       TO PYAJ-GROUPING
  7972     MOVE ch-comp-fin-resp       TO PYAJ-FIN-RESP
  7973     MOVE ch-comp-account        TO PYAJ-ACCOUNT
  7974     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO
  7975
  7976     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7977     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7978
  7979* exec cics startbr
  7980*       dataset    ('ERPYAJ')
  7981*       ridfld     (erpyaj-key)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 141
* EL677.cbl
  7982*       resp       (ws-response)
  7983*    end-exec
  7984     MOVE 'ERPYAJ' TO DFHEIV1
  7985     MOVE 0
  7986       TO DFHEIV11
  7987*    MOVE '&,         G          &  N#00007401' TO DFHEIV0
  7988     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7989     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7990     MOVE X'204E233030303037343031' TO DFHEIV0(25:11)
  7991     CALL 'kxdfhei1' USING DFHEIV0,
  7992           DFHEIV1,
  7993           erpyaj-key,
  7994           DFHEIV99,
  7995           DFHEIV11,
  7996           DFHEIV99
  7997     MOVE EIBRESP  TO ws-response
  7998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7999
  8000     if not resp-normal
  8001        display ' no erpyaj found ' pyaj-carrier ' '
  8002        pyaj-fin-resp ' ' pyaj-account
  8003        go to 3320-exit
  8004     end-if
  8005
  8006     set pyaj-browse-started to true
  8007
  8008     .
  8009 3320-readnext.
  8010
  8011
  8012* exec cics readnext
  8013*       dataset     ('ERPYAJ')
  8014*       set         (address of pending-pay-adj)
  8015*       ridfld      (erpyaj-key)
  8016*       resp        (ws-response)
  8017*    end-exec
  8018     MOVE 'ERPYAJ' TO DFHEIV1
  8019     MOVE 0
  8020       TO DFHEIV11
  8021*    MOVE '&.S                   )  N#00007418' TO DFHEIV0
  8022     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8023     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8024     MOVE X'204E233030303037343138' TO DFHEIV0(25:11)
  8025     CALL 'kxdfhei1' USING DFHEIV0,
  8026           DFHEIV1,
  8027           DFHEIV20,
  8028           DFHEIV99,
  8029           erpyaj-key,
  8030           DFHEIV99,
  8031           DFHEIV11,
  8032           DFHEIV99,
  8033           DFHEIV99
  8034     SET ADDRESS OF pending-pay-adj TO
  8035         DFHEIV20
  8036     MOVE EIBRESP  TO ws-response
  8037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8038
  8039     if not resp-normal
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 142
* EL677.cbl
  8040        display ' error 3320-readnext ' ws-response
  8041        go to 3320-exit
  8042     end-if
  8043
  8044     if ch-comp-carrier = py-carrier and
  8045        ch-comp-fin-resp  = py-fin-resp and
  8046        ch-comp-account = py-account
  8047        if py-record-type = 'R' and
  8048           ch-amount-paid = py-entry-amt and
  8049           py-last-maint-dt = save-bin-date and
  8050           py-gl-comment = 'VOID REFCK' and
  8051           py-check-number = ch-check-no(2:6) and
  8052           py-gl-account = '1825011300'
  8053
  8054* exec cics delete
  8055*             dataset     ('ERPYAJ')
  8056*             ridfld      (erpyaj-key)
  8057*             resp        (ws-response)
  8058*          end-exec
  8059     MOVE 'ERPYAJ' TO DFHEIV1
  8060*    MOVE '&(  R                 &  N#00007439' TO DFHEIV0
  8061     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8062     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8063     MOVE X'204E233030303037343339' TO DFHEIV0(25:11)
  8064     CALL 'kxdfhei1' USING DFHEIV0,
  8065           DFHEIV1,
  8066           erpyaj-key,
  8067           DFHEIV99,
  8068           DFHEIV99,
  8069           DFHEIV99
  8070     MOVE EIBRESP  TO ws-response
  8071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8072           if not resp-normal
  8073              display ' bad delete ' ws-response ' ' pyaj-account
  8074           end-if
  8075        else
  8076           go to 3320-readnext
  8077        end-if
  8078     end-if
  8079
  8080     .
  8081 3320-end-browse.
  8082
  8083     if pyaj-browse-started
  8084
  8085* exec cics endbr
  8086*           dataset    ('ERPYAJ')
  8087*       end-exec
  8088     MOVE 'ERPYAJ' TO DFHEIV1
  8089     MOVE 0
  8090       TO DFHEIV11
  8091*    MOVE '&2                    $   #00007456' TO DFHEIV0
  8092     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8093     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8094     MOVE X'2020233030303037343536' TO DFHEIV0(25:11)
  8095     CALL 'kxdfhei1' USING DFHEIV0,
  8096           DFHEIV1,
  8097           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 143
* EL677.cbl
  8098           DFHEIV99
  8099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8100     end-if
  8101     .
  8102 3320-exit.
  8103     exit.
  8104 3400-delete-record.
  8105
  8106* EXEC CICS READ
  8107*        DATASET  (ERCHEK-FILE-ID)
  8108*        SET      (ADDRESS OF CHECK-RECORDS)
  8109*        RIDFLD   (PI-ERCHEK-KEY)
  8110*        UPDATE
  8111*        resp     (ws-response)
  8112*    END-EXEC
  8113*    MOVE '&"S        EU         (  N#00007464' TO DFHEIV0
  8114     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8115     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8116     MOVE X'204E233030303037343634' TO DFHEIV0(25:11)
  8117     CALL 'kxdfhei1' USING DFHEIV0,
  8118           ERCHEK-FILE-ID,
  8119           DFHEIV20,
  8120           DFHEIV99,
  8121           PI-ERCHEK-KEY,
  8122           DFHEIV99,
  8123           DFHEIV99,
  8124           DFHEIV99
  8125     SET ADDRESS OF CHECK-RECORDS TO
  8126         DFHEIV20
  8127     MOVE EIBRESP  TO ws-response
  8128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8129     if (ch-in-limbo or ch-approv-pending)
  8130        and (ch-void-dt = low-values)
  8131        and (ch-check-written-dt = low-values)
  8132        and (ch-credit-accept-dt = low-values)
  8133        perform 3500-check-tbl   thru 3500-exit
  8134        if (row-deleted and tbl-commited)
  8135*          or (emi-error = er-3450)
  8136
  8137* exec cics delete
  8138*             dataset   (erchek-file-id)
  8139*          end-exec
  8140*    MOVE '&(                    &   #00007478' TO DFHEIV0
  8141     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8142     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8143     MOVE X'2020233030303037343738' TO DFHEIV0(25:11)
  8144     CALL 'kxdfhei1' USING DFHEIV0,
  8145           erchek-file-id,
  8146           DFHEIV99,
  8147           DFHEIV99,
  8148           DFHEIV99,
  8149           DFHEIV99
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8151           move spaces to pi-check-cut
  8152        end-if
  8153     else
  8154        move -1               to maintl
  8155        move er-3452          to emi-error
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 144
* EL677.cbl
  8156        move al-uabon         to mainta
  8157        perform 9900-error-format
  8158                                 thru 9900-exit
  8159        go to 8200-send-dataonly
  8160     end-if
  8161     if pi-chek-rec-cnt = +1
  8162        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8163                                 THRU 6200-EXIT
  8164        if resp-normal
  8165           MOVE ' '              TO PB-C-REFUND-SW
  8166           perform 6210-rewrite-pndb
  8167                                 thru 6210-exit
  8168        end-if
  8169     end-if
  8170     MOVE ER-0000            TO EMI-ERROR
  8171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8172     MOVE LOW-VALUES             TO EL677AI.
  8173     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8174     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8175     MOVE PI-CHEK-STATE          TO STATEO.
  8176     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8177     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8178     MOVE SPACE                  TO DC-OPTION-CODE.
  8179     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8180     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8181     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8182     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8183     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8184     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8185                                    ACCTA   EFFDTA
  8186                                    CERTNOA   SFXA.
  8187     MOVE AL-UNNON               TO SEQA.
  8188     GO TO 8100-SEND-INITIAL-MAP
  8189     .
  8190 3400-exit.
  8191     exit.
  8192 3500-check-tbl.
  8193     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8194     if sqlcode = 0
  8195        perform 4200-get-tbl-row thru 4200-exit
  8196     end-if
  8197      if sqlcode = 0
  8198         if (nu-app-date = -1)
  8199            or (db-app-status = '2')
  8200            perform 4250-delete-row thru 4250-exit
  8201         else
  8202           MOVE ER-3452            TO  EMI-ERROR
  8203           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8204           MOVE -1                 TO  PFENTERL
  8205           GO TO 8200-SEND-DATAONLY
  8206        end-if
  8207      else
  8208         MOVE ER-3450            TO  EMI-ERROR
  8209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8210         MOVE -1                 TO  PFENTERL
  8211*        GO TO 8200-SEND-DATAONLY
  8212      end-if
  8213     if connected-to-db
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 145
* EL677.cbl
  8214        perform 4300-FINISH-UP-DB thru 4300-exit
  8215     end-if
  8216     .
  8217 3500-exit.
  8218     exit.
  8219 3900-RECORD-NOTFND.
  8220     MOVE ER-2908                TO EMI-ERROR.
  8221     MOVE -1                     TO CARRIERL
  8222     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8223                                    ACCTA     EFFDTA  CERTNOA
  8224                                    SFXA      SEQA.
  8225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8226     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 146
* EL677.cbl
  8228 4000-ADD-CHANGE.
  8229     IF PAYTO1L NOT = ZEROS
  8230        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8231     END-IF
  8232
  8233     IF PAYTO2L NOT = ZEROS
  8234         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8235
  8236     IF PAYAD1L NOT = ZEROS
  8237         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8238
  8239     IF PAYAD2L NOT = ZEROS
  8240         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8241
  8242     IF PAYctyL NOT = ZEROS
  8243         MOVE payctyi            TO CH-PAYEE-CITY.
  8244
  8245     IF PAYstL NOT = ZEROS
  8246         MOVE paysti            TO CH-PAYEE-state.
  8247
  8248     IF PAYEEI GREATER SPACES
  8249        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8250
  8251     IF PTOZIPL  =  ZEROS
  8252         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8253         GO TO 4000-CK-REST.
  8254
  8255     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8256
  8257     IF NOT WS-CANADIAN-POST-CODE
  8258         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8259         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8260         GO TO 4000-CK-REST.
  8261
  8262     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8263     IF WS-CAN-POST-4TH = SPACE OR '-'
  8264         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8265         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8266     ELSE
  8267         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8268         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8269
  8270 4000-CK-REST.
  8271
  8272     IF RETTOL NOT = ZEROS
  8273        MOVE RETTOI TO CH-RETURN-TO.
  8274     if dedcynl not = zeros
  8275        move dedcyni             to ch-deduct-commission
  8276     end-if
  8277*    if dedcynl not = zeros
  8278*       if (dedcyni = 'Y')
  8279*          or (pi-prev-ded-comm = 'Y')
  8280*          compute ws-amt =
  8281*             pi-refund-on-pending-rec -
  8282*                pi-prev-paid - pi-ue-comm
  8283*       else
  8284*          if dedcyni = 'N'
  8285*             compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 147
* EL677.cbl
  8286*                pi-refund-on-pending-rec -
  8287*                   pi-prev-paid-this-month
  8288*          end-if
  8289*       end-if
  8290*    end-if
  8291     if pi-check-type = 'C'
  8292        compute ws-amt =
  8293           pi-endt-prm-diff - pi-prev-paid
  8294        if (dedcyni = 'Y')
  8295           or (pi-prev-ded-comm = 'Y')
  8296           compute ws-amt =
  8297              ws-amt - pi-ue-comm
  8298        end-if
  8299        if ws-amt <= zeros
  8300           move pi-endt-prm-diff to ws-amt
  8301        end-if
  8302     end-if
  8303     IF AMOUNTL NOT = ZEROS
  8304         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8305         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8306
  8307     IF CHECKL NOT = ZEROS
  8308         MOVE CHECKI             TO CH-CHECK-NO.
  8309
  8310     IF REASONL NOT = ZEROS
  8311         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8312
  8313*    IF DEDAMTL NOT = ZEROS
  8314*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8315*                                   DEDAMTO.
  8316
  8317*    IF ADDLCHGL NOT = ZEROS
  8318*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8319*                                   ADDLCHGO.
  8320
  8321     IF STUBL NOT = ZEROS
  8322         MOVE STUBI              TO CH-STUB-LINE-1.
  8323
  8324     IF TEXT1L NOT = ZEROS
  8325         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8326
  8327     IF TEXT2L NOT = ZEROS
  8328         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8329
  8330     IF TEXT3L NOT = ZEROS
  8331         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8332
  8333     IF TYPEL NOT = ZEROS
  8334         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8335
  8336*    MOVE LETTER1I               TO CH-LETTERS (1).
  8337*    MOVE LETTER2I               TO CH-LETTERS (2).
  8338*    MOVE LETTER3I               TO CH-LETTERS (3).
  8339
  8340*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8341     IF CH-CHECK-ORIGIN-SW = 'R'
  8342         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8343*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 148
* EL677.cbl
  8344         MOVE PI-CANC-DT             TO CH-CANC-DT
  8345         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8346         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8347     end-if
  8348     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8349*    IF PI-AR-PROCESSING AND
  8350*       REFL NOT = ZERO
  8351*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8352
  8353 4000-EXIT.
  8354      EXIT.
  8355 4100-CONNECT-TO-DB.
  8356     move 'NTSQLTST2_ChkApprv'   to svr
  8357     move 'sa'                   to usr
  8358     move 'sql2008r2'            to pass
  8359
  8360     if ws-kix-myenv = 'cid1p'
  8361        move 'NTCSO2_ChkApprv'   to svr
  8362        move 'sa'                to usr
  8363        move 'ntcso2'            to pass
  8364     end-if
  8365     string
  8366         usr delimited space
  8367         "." delimited size
  8368         pass delimited space into usr-pass
  8369     end-string
  8370     EXEC SQL
  8371        CONNECT TO :svr USER :usr-pass
  8372     END-EXEC
  8373     if sqlcode not = 0
  8374        display "Error: cannot connect "
  8375        display sqlcode
  8376        display sqlerrmc
  8377     end-if
  8378     set connected-to-db to true
  8379     .
  8380 4100-EXIT.
  8381     EXIT.
  8382 4200-get-tbl-row.
  8383***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8384***                                                            ***
  8385***  I'm only expecting one row so no cursor is declared       ***
  8386***                                                            ***
  8387***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8388     move pi-company-id          to ws-compid
  8389     move ch-carrier             to ws-carrier
  8390     move ch-grouping            to ws-grouping
  8391     move ch-state               to ws-state
  8392     move ch-account             to ws-account
  8393     move ch-cert-eff-dt         to dc-bin-date-1
  8394     move ' '                    to dc-option-code
  8395     perform 8500-date-convert   thru 8500-exit
  8396     if no-conversion-error
  8397        move dc-greg-date-a-edit to ws-eff-date
  8398     end-if
  8399     move ch-cert-prime          to ws-certificate
  8400     move ch-cert-sfx            to ws-cert-sfx
  8401     move ch-sequence-no         to ws-seq-no
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 149
* EL677.cbl
  8402     move '1'                    to ws-type
  8403                                    ws-check-sub-type
  8404     if pi-check-type = 'C'
  8405        move '2'                 to ws-check-sub-type
  8406     end-if
  8407     exec sql
  8408        SELECT
  8409           ApprovalStatus,
  8410           MaintainedBy,
  8411           MaintainedDate,
  8412           ApprovalBatch
  8413        INTO
  8414           :db-app-status :nu-app-status,
  8415           :db-app-by :nu-app-by,
  8416           :db-app-date :nu-app-date,
  8417           :db-app-batch :nu-app-batch
  8418        FROM
  8419           ChkApp_Check
  8420        WHERE
  8421           Company           = :ws-compid
  8422           and CertCarrier   = :ws-carrier
  8423           and CertGroup     = :ws-grouping
  8424           and CertState     = :ws-state
  8425           and CertAccount   = :ws-account
  8426           and CertEffDate   = :ws-eff-date
  8427           and CertNumber    = :ws-certificate
  8428           and CertNumberSuf = :ws-cert-sfx
  8429           and CheckSeqNbr   = :ws-seq-no
  8430           and CheckType     = :ws-type
  8431           and CheckSubType  = :ws-check-sub-type
  8432     end-exec
  8433     if sqlcode not = 0
  8434        display "Error: cannot read row "
  8435        display ' sql return code ' sqlcode
  8436        display ' sql err mess    ' sqlerrmc
  8437        go to 4200-exit
  8438     end-if
  8439*    display ' status ' db-app-status
  8440*    display ' by     ' db-app-by
  8441*    display ' date   ' db-app-date
  8442*    display ' batch  ' db-app-batch
  8443*    if nu-app-date = -1
  8444*       display ' approval date is low-values '
  8445*    else
  8446*       display ' approval date is NOT low values '
  8447*    end-if
  8448     .
  8449 4200-exit.
  8450     exit.
  8451 4250-delete-row.
  8452     EXEC SQL
  8453        DELETE
  8454           from ChkApp_Check
  8455        WHERE
  8456           Company           = :ws-compid
  8457           and CertCarrier   = :ws-carrier
  8458           and CertGroup     = :ws-grouping
  8459           and CertState     = :ws-state
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 150
* EL677.cbl
  8460           and CertAccount   = :ws-account
  8461           and CertEffDate   = :ws-eff-date
  8462           and CertNumber    = :ws-certificate
  8463           and CertNumberSuf = :ws-cert-sfx
  8464           and CheckSeqNbr   = :ws-seq-no
  8465           and CheckType     = :ws-type
  8466           and CheckSubType  = :ws-check-sub-type
  8467     END-EXEC
  8468     if sqlcode not = 0
  8469        display "Error: cannot delete row  "
  8470        display ' sql retrun code ' sqlcode
  8471        display ' sql err mess    ' sqlerrmc
  8472        go to 4250-exit
  8473     end-if
  8474     set row-deleted         to true
  8475     EXEC SQL
  8476         commit transaction
  8477     END-EXEC
  8478     if sqlcode not = 0
  8479        display "Error: commit "
  8480        display ' sql return code ' sqlcode
  8481        display ' sql err mess    ' sqlerrmc
  8482        go to 4250-exit
  8483     end-if
  8484     set tbl-commited to true
  8485     .
  8486 4250-exit.
  8487     exit.
  8488 4300-FINISH-UP-DB.
  8489     EXEC SQL
  8490         commit work release
  8491     END-EXEC
  8492     if sqlcode not = 0
  8493        display "Error: commit release "
  8494        display ' sql return code ' sqlcode
  8495        display ' sql err mess    ' sqlerrmc
  8496     end-if
  8497     .
  8498 4300-EXIT.
  8499     EXIT.
  8500 5000-BROWSE-FILE.
  8501
  8502* EXEC CICS HANDLE CONDITION
  8503*        NOTFND   (5560-END-OF-FILE)
  8504*        ENDFILE  (5560-END-OF-FILE)
  8505*    END-EXEC.
  8506*    MOVE '"$I''                  ! , #00007831' TO DFHEIV0
  8507     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8509     MOVE X'2C20233030303037383331' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8512
  8513
  8514     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8515
  8516     IF SEQI = LOW-VALUES
  8517         MOVE +1                 TO CHEK-RECORD-SEQ.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 151
* EL677.cbl
  8518
  8519     IF EIBAID = DFHPF2
  8520         GO TO 5100-BROWSE-BKWD.
  8521
  8522 5010-READ-LOOP.
  8523     IF EIBAID = DFHPF1
  8524         ADD +1                  TO CHEK-RECORD-SEQ.
  8525
  8526
  8527* EXEC CICS READ
  8528*        DATASET  (ERCHEK-FILE-ID)
  8529*        SET      (ADDRESS OF CHECK-RECORDS)
  8530*        RIDFLD   (ERCHEK-KEY)
  8531*        GTEQ
  8532*    END-EXEC.
  8533*    MOVE '&"S        G          (   #00007848' TO DFHEIV0
  8534     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8536     MOVE X'2020233030303037383438' TO DFHEIV0(25:11)
  8537     CALL 'kxdfhei1' USING DFHEIV0,
  8538           ERCHEK-FILE-ID,
  8539           DFHEIV20,
  8540           DFHEIV99,
  8541           ERCHEK-KEY,
  8542           DFHEIV99,
  8543           DFHEIV99,
  8544           DFHEIV99
  8545     SET ADDRESS OF CHECK-RECORDS TO
  8546         DFHEIV20
  8547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8548
  8549
  8550     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8551         IF EIBAID = DFHENTER
  8552             GO TO 5550-NO-RECORD
  8553         ELSE
  8554             GO TO 5560-END-OF-FILE.
  8555
  8556        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8557           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8558           PI-CHEK-STATE      = CH-STATE       AND
  8559           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8560           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8561           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8562           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8563              GO TO 5500-FORMAT-SCREEN
  8564            ELSE
  8565              IF EIBAID = DFHPF1
  8566                  GO TO 5560-END-OF-FILE
  8567                ELSE
  8568                  GO TO 5550-NO-RECORD.
  8569
  8570     IF EIBAID = DFHENTER
  8571        IF CHEK-CARRIER    = CH-CARRIER     AND
  8572           CHEK-GROUPING   = CH-GROUPING    AND
  8573           CHEK-STATE      = CH-STATE       AND
  8574           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8575           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 152
* EL677.cbl
  8576           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8577           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8578           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8579              GO TO 5500-FORMAT-SCREEN
  8580        ELSE
  8581              GO TO 5550-NO-RECORD.
  8582
  8583     GO TO 5500-FORMAT-SCREEN.
  8584
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 153
* EL677.cbl
  8586
  8587 5100-BROWSE-BKWD.
  8588
  8589* EXEC CICS STARTBR
  8590*        DATASET  (ERCHEK-FILE-ID)
  8591*        RIDFLD   (ERCHEK-KEY)
  8592*    END-EXEC.
  8593     MOVE 0
  8594       TO DFHEIV11
  8595*    MOVE '&,         G          &   #00007893' TO DFHEIV0
  8596     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8597     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8598     MOVE X'2020233030303037383933' TO DFHEIV0(25:11)
  8599     CALL 'kxdfhei1' USING DFHEIV0,
  8600           ERCHEK-FILE-ID,
  8601           ERCHEK-KEY,
  8602           DFHEIV99,
  8603           DFHEIV11,
  8604           DFHEIV99
  8605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8606
  8607
  8608
  8609* EXEC CICS READPREV
  8610*        DATASET  (ERCHEK-FILE-ID)
  8611*        SET      (ADDRESS OF CHECK-RECORDS)
  8612*        RIDFLD   (ERCHEK-KEY)
  8613*    END-EXEC.
  8614     MOVE 0
  8615       TO DFHEIV11
  8616*    MOVE '&0S                   )   #00007898' TO DFHEIV0
  8617     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8618     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8619     MOVE X'2020233030303037383938' TO DFHEIV0(25:11)
  8620     CALL 'kxdfhei1' USING DFHEIV0,
  8621           ERCHEK-FILE-ID,
  8622           DFHEIV20,
  8623           DFHEIV99,
  8624           ERCHEK-KEY,
  8625           DFHEIV99,
  8626           DFHEIV11,
  8627           DFHEIV99,
  8628           DFHEIV99
  8629     SET ADDRESS OF CHECK-RECORDS TO
  8630         DFHEIV20
  8631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8632
  8633
  8634 5110-READ-LOOP.
  8635     IF PI-FILE-EOF
  8636         MOVE SPACE              TO PI-EOF-SW
  8637     ELSE
  8638
  8639* EXEC CICS READPREV
  8640*            DATASET  (ERCHEK-FILE-ID)
  8641*            SET      (ADDRESS OF CHECK-RECORDS)
  8642*            RIDFLD   (ERCHEK-KEY)
  8643*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 154
* EL677.cbl
  8644     MOVE 0
  8645       TO DFHEIV11
  8646*    MOVE '&0S                   )   #00007908' TO DFHEIV0
  8647     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8648     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8649     MOVE X'2020233030303037393038' TO DFHEIV0(25:11)
  8650     CALL 'kxdfhei1' USING DFHEIV0,
  8651           ERCHEK-FILE-ID,
  8652           DFHEIV20,
  8653           DFHEIV99,
  8654           ERCHEK-KEY,
  8655           DFHEIV99,
  8656           DFHEIV11,
  8657           DFHEIV99,
  8658           DFHEIV99
  8659     SET ADDRESS OF CHECK-RECORDS TO
  8660         DFHEIV20
  8661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8662
  8663
  8664     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8665         GO TO 5560-END-OF-FILE.
  8666
  8667        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8668           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8669           PI-CHEK-STATE      = CH-STATE       AND
  8670           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8671           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8672           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8673           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8674              GO TO 5500-FORMAT-SCREEN
  8675            ELSE
  8676              GO TO 5560-END-OF-FILE.
  8677
  8678     GO TO 5500-FORMAT-SCREEN.
  8679
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 155
* EL677.cbl
  8681*                          COPY ELCNPD.
  8682*****************************************************************
  8683*                                                               *
  8684*                                                               *
  8685*                            ELCNPD                             *
  8686*                            VMOD=2.001                         *
  8687*****************************************************************
  8688
  8689 5200-MOVE-NAME.
  8690*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8691*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8692*            BLANKS.                                            *
  8693*                                                               *
  8694*                  FIELD               VALUE                    *
  8695*                                                               *
  8696*                LAST NAME (CL15)      SMITH                    *
  8697*                1ST NAME  (CL12)      JOHN                     *
  8698*                MID NAME  (CL1)       A                        *
  8699*                                                               *
  8700*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8701*         *                                                     *
  8702*         *              JOHN A. SMITH                          *
  8703*         *                                                     *
  8704*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8705*         *  STORAGE COPYBOOK:                                  *
  8706*         *                                                     *
  8707*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8708*         *******************************************************.
  8709
  8710     MOVE SPACES                 TO  WS-NAME-WORK
  8711                                     WS-NAME-WORK2.
  8712     MOVE ZERO                   TO  WS-NAME-SW.
  8713     SET NWA-INDEX TO +1.
  8714
  8715     IF WS-INSURED-1ST-NAME = SPACES  AND
  8716        WS-INSURED-MID-INIT = SPACES
  8717         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8718         GO TO 5200-EXIT.
  8719
  8720     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8721     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8722
  8723     SET NWA-INDEX UP BY +1
  8724     IF WS-INSURED-MID-INIT NOT = SPACES
  8725        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8726        SET NWA-INDEX UP BY +1
  8727        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8728        SET NWA-INDEX UP BY +2.
  8729
  8730     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8731     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8732
  8733
  8734 5200-EXIT.
  8735     EXIT.
  8736
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 156
* EL677.cbl
  8738 5300-MOVE-NAME SECTION.
  8739     IF WS-NAME-SW GREATER THAN +1
  8740         GO TO 5390-EXIT.
  8741
  8742     IF WS-NAME-WORK2 = SPACES
  8743         GO TO 5390-EXIT.
  8744
  8745     SET NWA-INDEX2 TO +1.
  8746     SET NWA-INDEX3 TO +2.
  8747
  8748 5310-MOVE-NAME.
  8749     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8750
  8751     IF NWA-INDEX LESS THAN +30
  8752        SET NWA-INDEX UP BY +1
  8753     ELSE
  8754        ADD +2  TO  WS-NAME-SW
  8755        GO TO 5390-EXIT.
  8756
  8757     IF NWA-INDEX2 LESS THAN +20
  8758         SET NWA-INDEX2 UP BY +1
  8759         SET NWA-INDEX3 UP BY +1.
  8760
  8761     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8762        WS-NW2 (NWA-INDEX3) = SPACES
  8763        GO TO 5390-EXIT.
  8764
  8765     GO TO 5310-MOVE-NAME.
  8766
  8767 5390-EXIT.
  8768     EXIT.
  8769
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 157
* EL677.cbl
  8772 5500-FORMAT-SCREEN.
  8773     MOVE LOW-VALUES             TO  EL677AI.
  8774     if pi-void-reissue-pass = '1'
  8775        move 'R'                 to mainti
  8776                                    pi-prev-maint
  8777     else
  8778        MOVE 'S'                 TO MAINTI
  8779                                    PI-PREV-MAINT
  8780     end-if
  8781     MOVE +1                     TO  MAINTL.
  8782     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8783     MOVE CH-CARRIER             TO  CARRIERO.
  8784     MOVE CH-GROUPING            TO  GROUPO.
  8785     MOVE CH-STATE               TO  STATEO.
  8786     MOVE CH-ACCOUNT             TO  ACCTO.
  8787
  8788     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8789     MOVE SPACE                  TO  DC-OPTION-CODE.
  8790     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8791     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8792
  8793     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8794     MOVE CH-CERT-SFX            TO  SFXO.
  8795     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8796
  8797     MOVE AL-UANON               TO  CARRIERA
  8798                                     GROUPA
  8799                                     STATEA
  8800                                     ACCTA
  8801                                     EFFDTA
  8802                                     CERTNOA
  8803                                     SFXA.
  8804     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8805
  8806     if ch-approval-dt not = low-values
  8807        move ch-approval-dt      to dc-bin-date-1
  8808        move ' '                 to dc-option-code
  8809        perform 8500-date-convert thru 8500-exit
  8810        move dc-greg-date-1-edit to apvdto
  8811     end-if
  8812     evaluate ch-approval-status
  8813        when '2'
  8814           move 'PENDING '       TO APVSTATO
  8815        when 'P'
  8816           move 'PENDING '       TO APVSTATO
  8817        when 'A'
  8818           move 'APPROVED'       to apvstato
  8819        when 'D'
  8820           move 'DENIED'         to apvstato
  8821     end-evaluate
  8822     move ch-approved-by         to apvbyo
  8823*    IF PI-COMPANY-ID = 'TMS'
  8824*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8825*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8826*    ELSE
  8827         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8828         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8829
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 158
* EL677.cbl
  8830     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8831     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8832     move ch-payee-city          to payctyo
  8833     move ch-payee-state         to paysto
  8834     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8835
  8836     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8837         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8838         MOVE AL-UANON           TO  PTOZIPA.
  8839
  8840     MOVE CH-RETURN-TO           TO  RETTOO
  8841*    if ch-check-cashed-dt not = spaces and low-values
  8842*       move ch-check-cashed-dt  to dc-bin-date-1
  8843*       MOVE SPACE               TO  DC-OPTION-CODE
  8844*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8845*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8846*    end-if
  8847     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8848     MOVE SPACE                  TO  DC-OPTION-CODE.
  8849     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8850     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8851
  8852     MOVE CH-RECORDED-BY         TO  CBYO.
  8853
  8854     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8855         NEXT SENTENCE
  8856     ELSE
  8857         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8858         MOVE SPACE                  TO  DC-OPTION-CODE
  8859         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8860         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8861         MOVE CH-VOID-BY             TO  VBYO.
  8862
  8863     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8864         NEXT SENTENCE
  8865     ELSE
  8866         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8867         MOVE SPACE                  TO  DC-OPTION-CODE
  8868         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8869         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8870
  8871     MOVE CH-AMOUNT-PAID         TO  AMOUNTO
  8872                                     pi-void-reissue-amt
  8873     MOVE AL-SANOF               TO  AMOUNTA.
  8874     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8875     MOVE AL-SANOF               TO  TYPEA.
  8876     MOVE CH-CHECK-NO            TO  CHECKO.
  8877     move ch-deduct-commission   to dedcyno
  8878     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8879     MOVE CH-VOID-REASON         TO  VREASONO.
  8880
  8881     MOVE CH-STUB-LINE-1         TO  STUBO.
  8882     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8883     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8884     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8885     IF CH-LF-REFUND NOT NUMERIC
  8886         MOVE ZEROS              TO CH-LF-REFUND.
  8887     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 159
* EL677.cbl
  8888         MOVE ZEROS              TO CH-AH-REFUND.
  8889     if (ch-check-no not = spaces and low-values)
  8890        and (ch-check-written-dt not = low-values)
  8891        perform 5800-fetch-check-cashed-dt
  8892                                 thru 5800-exit
  8893     end-if
  8894     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
  8895        CH-VOID-DT          GREATER LOW-VALUES
  8896        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8897                                     STUBA     TEXT1A   TEXT2A
  8898                                     TEXT3A    PAYTO1A  SFXA
  8899                                     PAYTO2A   PAYAD1A  PAYctyA
  8900                                     paysta    RETTOA   PAYAD2A
  8901                                     PTOZIPA
  8902                                     PRINTEDA
  8903     ELSE
  8904        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8905                                     ACCTA     EFFDTA   CERTNOA
  8906                                     CHECKA    REASONA  VREASONA
  8907                                     STUBA     TEXT1A   TEXT2A
  8908                                     TEXT3A    PAYTO1A  SFXA
  8909                                     PAYTO2A   PAYAD1A  PAYctyA
  8910                                     paysta    RETTOA   PAYAD2A
  8911                                     PRINTEDA.
  8912
  8913     MOVE AL-UNNON               TO SEQA.
  8914     perform 5600-get-erpndb     thru 5600-exit
  8915     perform 5700-get-elcert     thru 5700-exit
  8916*    move pi-prev-paid           to prepdo
  8917     move al-sadof               to drefa
  8918*    if WS-PNDB-FOUND
  8919*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8920*    end-if
  8921     if WS-CERT-FOUND
  8922        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8923           cm-lf-alt-premium-amt
  8924        compute ws-tot-iss-prem  =
  8925           cm-ah-premium-amt + ws-tot-lf-prem
  8926        compute ws-tot-iss-comm =
  8927           (ws-tot-lf-prem * cm-life-comm-pct) +
  8928           (cm-ah-premium-amt * cm-ah-comm-pct)
  8929        compute ws-tot-ref-comm =
  8930           (pi-lf-refund * cm-life-comm-pct) +
  8931           (pi-ah-refund * cm-ah-comm-pct)
  8932        move ws-tot-iss-prem     to premo
  8933        move ws-tot-iss-comm     to isscommo
  8934*       move ws-tot-ref-comm     to uecommo
  8935     end-if
  8936     if PI-TO-EL677-FROM-EL1273
  8937        move zeros               to premo
  8938                                    isscommo
  8939                                    uecommo
  8940                                    prepdo
  8941                                    refo
  8942     end-if
  8943     GO TO 8100-SEND-INITIAL-MAP
  8944     .
  8945 5550-NO-RECORD.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 160
* EL677.cbl
  8946     MOVE ER-1162                TO  EMI-ERROR.
  8947     MOVE -1                     TO  CARRIERL.
  8948     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8949                                     ACCTA     EFFDTA  CERTNOA
  8950                                     SFXA      SEQA.
  8951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8952
  8953     IF (NOT PI-TO-EL677-FROM-EL1273)
  8954        and (pi-return-to-program not = 'EL6315')
  8955         GO TO 8200-SEND-DATAONLY.
  8956
  8957     MOVE CHEK-CARRIER           TO  CARRIERO.
  8958     MOVE CHEK-GROUPING          TO  GROUPO.
  8959     MOVE CHEK-STATE             TO  STATEO.
  8960     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8961
  8962     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8963     MOVE SPACE                  TO  DC-OPTION-CODE.
  8964     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8965     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8966
  8967     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8968     MOVE CHEK-SUF-NO            TO  SFXO.
  8969     GO TO 8100-SEND-INITIAL-MAP.
  8970
  8971 5560-END-OF-FILE.
  8972     IF EIBAID = DFHPF1
  8973         MOVE 'Y'                TO  PI-EOF-SW
  8974         MOVE ER-2237            TO  EMI-ERROR
  8975     ELSE
  8976     IF EIBAID = DFHENTER
  8977        GO TO 5550-NO-RECORD
  8978     ELSE
  8979*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8980         MOVE ER-2238            TO  EMI-ERROR.
  8981
  8982     MOVE -1                     TO  MAINTL.
  8983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8984     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 161
* EL677.cbl
  8986 5600-get-erpndb.
  8987     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8988     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8989     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8990     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8991     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8992     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8993     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8994     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8995     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8996     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8997     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  8998     IF ST-ACCNT-CNTL  OR
  8999        ACCNT-CNTL
  9000          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9001     IF ST-ACCNT-CNTL      OR
  9002        CARR-ST-ACCNT-CNTL OR
  9003        ACCNT-CNTL         OR
  9004        CARR-ACCNT-CNTL
  9005          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9006     IF ACCNT-CNTL OR
  9007        CARR-ACCNT-CNTL
  9008          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9009
  9010* EXEC CICS READ
  9011*         DATASET   (ERPNDB-ALT-FILE-ID)
  9012*         SET       (ADDRESS OF PENDING-BUSINESS)
  9013*         RIDFLD    (ERPNDB-ALT-KEY)
  9014*         resp      (ws-response)
  9015*    END-EXEC
  9016*    MOVE '&"S        E          (  N#00008259' TO DFHEIV0
  9017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9019     MOVE X'204E233030303038323539' TO DFHEIV0(25:11)
  9020     CALL 'kxdfhei1' USING DFHEIV0,
  9021           ERPNDB-ALT-FILE-ID,
  9022           DFHEIV20,
  9023           DFHEIV99,
  9024           ERPNDB-ALT-KEY,
  9025           DFHEIV99,
  9026           DFHEIV99,
  9027           DFHEIV99
  9028     SET ADDRESS OF PENDING-BUSINESS TO
  9029         DFHEIV20
  9030     MOVE EIBRESP  TO ws-response
  9031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9032     if resp-normal
  9033        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9034        compute pi-refund-on-pending-rec =
  9035           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9036     end-if
  9037     .
  9038 5600-exit.
  9039     exit.
  9040 5700-get-elcert.
  9041     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9042     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9043     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 162
* EL677.cbl
  9044     MOVE PI-STATE               TO  ELCERT-STATE.
  9045     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9046     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9047     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9048     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9049     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9050
  9051* EXEC CICS READ
  9052*         DATASET   (ELCERT-FILE-ID)
  9053*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9054*         RIDFLD    (ELCERT-KEY)
  9055*         resp      (ws-response)
  9056*    END-EXEC
  9057*    MOVE '&"S        E          (  N#00008283' TO DFHEIV0
  9058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9060     MOVE X'204E233030303038323833' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0,
  9062           ELCERT-FILE-ID,
  9063           DFHEIV20,
  9064           DFHEIV99,
  9065           ELCERT-KEY,
  9066           DFHEIV99,
  9067           DFHEIV99,
  9068           DFHEIV99
  9069     SET ADDRESS OF CERTIFICATE-MASTER TO
  9070         DFHEIV20
  9071     MOVE EIBRESP  TO ws-response
  9072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9073     if resp-normal
  9074        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9075     end-if
  9076     .
  9077 5700-exit.
  9078     exit.
  9079 5800-fetch-check-cashed-dt.
  9080     move ' '                    to ws-connect-sw
  9081                                    ws-match-sw
  9082                                    pi-check-cashed
  9083     move 'NTCSO2_PdBnkInfo'     to svr
  9084     move 'sa'                   to usr
  9085     move 'ntcso2'               to pass
  9086     string
  9087         usr delimited space
  9088         "." delimited size
  9089         pass delimited space into usr-pass
  9090     end-string
  9091     EXEC SQL
  9092        CONNECT TO :svr USER :usr-pass
  9093     END-EXEC
  9094     if sqlcode not = 0
  9095        display "Error: cannot connect to pdbnkinfo "
  9096        display sqlcode
  9097        display sqlerrmc
  9098        go to 5800-exit
  9099     end-if
  9100     set connected-to-db to true
  9101     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 163
* EL677.cbl
  9102        move 'CSO - AP%'         to ws-pb-compid
  9103     else
  9104        move 'AHL - AP%'         to ws-pb-compid
  9105     end-if
  9106     move '000'                  to ws-pb-check-no (1:3)
  9107     move ch-check-no            to ws-pb-check-no (4:7)
  9108     move spaces                 to ws-pb-bad-check-no
  9109     perform varying s1 from +1 by +1 until
  9110        (s1 > +10)
  9111        or (ws-pb-check-no (s1:1) not = '0')
  9112     end-perform
  9113     if s1 < +11
  9114        move ws-pb-check-no (s1:11 - s1)
  9115                            to ws-pb-bad-check-no (1: 11 - s1)
  9116     end-if
  9117*    display ' compid **' ws-pb-compid '**'
  9118*    display ' ckno  **' ws-pb-check-no '**'
  9119     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9120     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9121     MOVE SPACES              TO pb-paid-date
  9122
  9123     EXEC SQL
  9124        CALL pbi_GetCashDate_by_TransactionNbr
  9125           @compid          = :ws-pb-compid,
  9126           @checkno         = :ws-pb-check-no,
  9127           @badcheckno      = :ws-pb-bad-check-no,
  9128           @checkamount     = :ws-check-amount,
  9129           @checkcasheddate = :pb-paid-date :nu-app-date OUT
  9130     END-EXEC
  9131     if sqlcode not = 0
  9132        display "Error: cannot run stor proc  "
  9133        move sqlcode            to ws-sql-code
  9134        move ws-sql-code to ws-dis-sql-code
  9135        display ' dis sql code ' ws-dis-sql-code
  9136        display ' sql return code ' sqlcode
  9137        display ' sql err mess    ' sqlerrmc
  9138        go to 5800-disconnect
  9139     end-if
  9140     if nu-app-date = -1 *> no check cashed date
  9141        go to 5800-disconnect
  9142     end-if
  9143***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9144***                                                            ***
  9145***  The following code works just as well as the above        ***
  9146***  stored procedure and just as fast.                        ***
  9147***  Originally, I had declared a cursor and fetched through   ***
  9148***  the record set to find the correct check and that REALLY  ***
  9149***  slowed the response down to ~ 3/4 second.                 ***
  9150***                                                            ***
  9151***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9152*     EXEC SQL
  9153*        SELECT
  9154*           PaidDate
  9155*        INTO
  9156*           :pb-paid-date
  9157*        FROM
  9158*           dbo.cso_pbi_TransactionLookup
  9159*        WHERE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 164
* EL677.cbl
  9160*           (BankAcctDescr like :ws-pb-compid)
  9161*           and (Amount = :ws-check-amount)
  9162*           and ((transactionNbr = :ws-pb-check-no)
  9163*                  or
  9164*               (transactionnbr = :ws-pb-bad-check-no))
  9165**          and (CAST(TransactionNbr AS INT) =
  9166**             :ws-pb-check-no-num)
  9167**          and (right('00000' + rtrim(TransactionNbr),10)
  9168**             = :ws-pb-check-no)
  9169**          and (TransactionNbr  = :ws-pb-check-no)
  9170*     END-EXEC
  9171*    display ' chkno  ' pb-check-no
  9172*    display ' desc   ' pb-bank-acct-desc
  9173*    display ' trn typ' pb-tran-type
  9174*    display ' amt   *' pb-amount '**'
  9175*    display ' pd dte ' pb-paid-date
  9176     string pb-paid-date (1:4)
  9177            pb-paid-date (6:2)
  9178            pb-paid-date (9:2)
  9179        delimited by size into dc-greg-date-cymd-r
  9180     end-string
  9181     move 'L'                    to dc-option-code
  9182     perform 8500-date-convert   thru 8500-exit
  9183     if no-conversion-error
  9184*       move dc-bin-date-1       to ws-bin-cashed-dt
  9185        move dc-greg-date-1-edit to cashedo
  9186        move 'Y' to pi-check-cashed
  9187     else
  9188        display ' error cvtdte cash dt ' pb-paid-date ' '
  9189           dc-error-code
  9190     end-if
  9191     .
  9192 5800-disconnect.
  9193     EXEC SQL
  9194        DISCONNECT ALL
  9195     END-EXEC
  9196     if sqlcode not = 0
  9197        display "Error: cannot disconnect pdbnk "
  9198        display ' sql return code ' sqlcode
  9199        display ' sql err mess    ' sqlerrmc
  9200     end-if
  9201     .
  9202 5800-exit.
  9203     exit.
  9204 6000-VERIFY-COMP-MASTER.
  9205
  9206* EXEC CICS HANDLE CONDITION
  9207*        NOTFND   (6070-NO-COMP-MSTR)
  9208*    END-EXEC.
  9209*    MOVE '"$I                   ! - #00008421' TO DFHEIV0
  9210     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9212     MOVE X'2D20233030303038343231' TO DFHEIV0(25:11)
  9213     CALL 'kxdfhei1' USING DFHEIV0
  9214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9215
  9216
  9217     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 165
* EL677.cbl
  9218
  9219     IF NOT PI-ZERO-CARRIER AND
  9220        NOT PI-ZERO-CAR-GROUP
  9221         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9222     ELSE
  9223         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9224
  9225     IF NOT PI-ZERO-GROUPING  AND
  9226        NOT PI-ZERO-CAR-GROUP
  9227         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9228     ELSE
  9229         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9230
  9231     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9232     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9233     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9234
  9235
  9236* EXEC CICS READ
  9237*         DATASET   (ERCOMP-FILE-ID)
  9238*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9239*         RIDFLD    (ERCOMP-KEY)
  9240*     END-EXEC.
  9241*    MOVE '&"S        E          (   #00008443' TO DFHEIV0
  9242     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9244     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  9245     CALL 'kxdfhei1' USING DFHEIV0,
  9246           ERCOMP-FILE-ID,
  9247           DFHEIV20,
  9248           DFHEIV99,
  9249           ERCOMP-KEY,
  9250           DFHEIV99,
  9251           DFHEIV99,
  9252           DFHEIV99
  9253     SET ADDRESS OF COMPENSATION-MASTER TO
  9254         DFHEIV20
  9255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9256
  9257
  9258     GO TO 6090-EXIT.
  9259
  9260 6070-NO-COMP-MSTR.
  9261     MOVE -1                     TO  CARRIERL.
  9262     MOVE ER-2230                TO  EMI-ERROR.
  9263     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9264     GO TO 8200-SEND-DATAONLY.
  9265
  9266 6090-EXIT.
  9267      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 166
* EL677.cbl
  9269 6100-VERIFY-CERTIFICATE.
  9270
  9271* EXEC CICS HANDLE CONDITION
  9272*        NOTFND   (6170-NO-CERTIFICATE)
  9273*    END-EXEC.
  9274*    MOVE '"$I                   ! . #00008461' TO DFHEIV0
  9275     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9277     MOVE X'2E20233030303038343631' TO DFHEIV0(25:11)
  9278     CALL 'kxdfhei1' USING DFHEIV0
  9279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9280
  9281
  9282     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9283     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9284     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9285     MOVE PI-STATE               TO  ELCERT-STATE.
  9286     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9287     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9288     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9289     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9290
  9291     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9292
  9293     MOVE SPACES                 TO  PI-REFERENCE
  9294*                                    PI-INSURED-NAME.
  9295     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9296*    MOVE ZEROS                  TO  PI-LF-REFUND
  9297*                                    PI-AH-REFUND.
  9298
  9299
  9300* EXEC CICS READ
  9301*         DATASET   (ELCERT-FILE-ID)
  9302*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9303*         RIDFLD    (ELCERT-KEY)
  9304*     END-EXEC.
  9305*    MOVE '&"S        E          (   #00008482' TO DFHEIV0
  9306     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9308     MOVE X'2020233030303038343832' TO DFHEIV0(25:11)
  9309     CALL 'kxdfhei1' USING DFHEIV0,
  9310           ELCERT-FILE-ID,
  9311           DFHEIV20,
  9312           DFHEIV99,
  9313           ELCERT-KEY,
  9314           DFHEIV99,
  9315           DFHEIV99,
  9316           DFHEIV99
  9317     SET ADDRESS OF CERTIFICATE-MASTER TO
  9318         DFHEIV20
  9319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9320
  9321
  9322     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9323
  9324*    MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9325*    MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9326     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 167
* EL677.cbl
  9327         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9328     ELSE
  9329         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9330             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9331*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9332
  9333     GO TO 6190-EXIT.
  9334
  9335 6170-NO-CERTIFICATE.
  9336     MOVE -1                     TO  CARRIERL.
  9337     MOVE ER-2726                TO  EMI-ERROR.
  9338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9339
  9340 6190-EXIT.
  9341      EXIT.
  9342
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 168
* EL677.cbl
  9344 6200-UPDATE-PENDING-BUS-REC.
  9345     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9346     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9347     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9348     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9349     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9350     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9351     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9352     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9353     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9354     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9355
  9356     IF ST-ACCNT-CNTL  OR
  9357        ACCNT-CNTL
  9358          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9359
  9360     IF ST-ACCNT-CNTL      OR
  9361        CARR-ST-ACCNT-CNTL OR
  9362        ACCNT-CNTL         OR
  9363        CARR-ACCNT-CNTL
  9364          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9365
  9366     IF ACCNT-CNTL OR
  9367        CARR-ACCNT-CNTL
  9368          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9369
  9370
  9371* EXEC CICS READ
  9372*         DATASET   (ERPNDB-ALT-FILE-ID)
  9373*         SET       (ADDRESS OF PENDING-BUSINESS)
  9374*         RIDFLD    (ERPNDB-ALT-KEY)
  9375*         resp      (ws-response)
  9376*     END-EXEC.
  9377*    MOVE '&"S        E          (  N#00008536' TO DFHEIV0
  9378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9380     MOVE X'204E233030303038353336' TO DFHEIV0(25:11)
  9381     CALL 'kxdfhei1' USING DFHEIV0,
  9382           ERPNDB-ALT-FILE-ID,
  9383           DFHEIV20,
  9384           DFHEIV99,
  9385           ERPNDB-ALT-KEY,
  9386           DFHEIV99,
  9387           DFHEIV99,
  9388           DFHEIV99
  9389     SET ADDRESS OF PENDING-BUSINESS TO
  9390         DFHEIV20
  9391     MOVE EIBRESP  TO ws-response
  9392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9393
  9394
  9395     if not resp-normal
  9396        go to 6200-exit
  9397     end-if
  9398     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9399
  9400
  9401* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 169
* EL677.cbl
  9402*         DATASET   (ERPNDB-FILE-ID)
  9403*         SET       (ADDRESS OF PENDING-BUSINESS)
  9404*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9405*         UPDATE
  9406*         resp      (ws-response)
  9407*     END-EXEC.
  9408*    MOVE '&"S        EU         (  N#00008548' TO DFHEIV0
  9409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9410     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9411     MOVE X'204E233030303038353438' TO DFHEIV0(25:11)
  9412     CALL 'kxdfhei1' USING DFHEIV0,
  9413           ERPNDB-FILE-ID,
  9414           DFHEIV20,
  9415           DFHEIV99,
  9416           ERPNDB-PRIMARY-KEY,
  9417           DFHEIV99,
  9418           DFHEIV99,
  9419           DFHEIV99
  9420     SET ADDRESS OF PENDING-BUSINESS TO
  9421         DFHEIV20
  9422     MOVE EIBRESP  TO ws-response
  9423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9424
  9425
  9426 6200-EXIT.
  9427      EXIT.
  9428 6210-rewrite-pndb.
  9429
  9430* EXEC CICS REWRITE
  9431*        DATASET  (ERPNDB-FILE-ID)
  9432*        FROM     (PENDING-BUSINESS)
  9433*    END-EXEC
  9434     MOVE LENGTH OF
  9435      PENDING-BUSINESS
  9436       TO DFHEIV11
  9437*    MOVE '&& L                  %   #00008559' TO DFHEIV0
  9438     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9439     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9440     MOVE X'2020233030303038353539' TO DFHEIV0(25:11)
  9441     CALL 'kxdfhei1' USING DFHEIV0,
  9442           ERPNDB-FILE-ID,
  9443           PENDING-BUSINESS,
  9444           DFHEIV11,
  9445           DFHEIV99
  9446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9447     .
  9448 6210-exit.
  9449     exit.
  9450 6300-BUILD-CERT-SCREEN.
  9451*    move 'N'                    to dedcyni
  9452*                                   pi-prev-ded-comm
  9453     MOVE LOW-VALUES             TO  EL677AI.
  9454     perform 6700-build-common   thru 6700-exit
  9455     if ws-refund-amount = zeros
  9456        move pi-company-cd       to pi-chek-comp-cd
  9457        move pi-carrier          to pi-chek-carrier
  9458        move pi-grouping         to pi-chek-grouping
  9459        move pi-state            to pi-chek-state
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 170
* EL677.cbl
  9460        move pi-account          to pi-chek-account
  9461        move pi-cert-eff-dt      to pi-chek-eff-dt
  9462        move pi-cert-prime       to pi-chek-cert-no
  9463        move pi-cert-sfx         to pi-chek-suf-no
  9464        move +1                  to pi-chek-sequence
  9465             MOVE 'S'            TO MAINTI
  9466             MOVE 1              TO MAINTL
  9467             MOVE AL-UABON       TO MAINTA
  9468             MOVE DFHENTER       TO EIBAID
  9469        go to 5000-browse-file
  9470     end-if
  9471     IF WS-CERT-NOT-FOUND
  9472         GO TO 8100-SEND-INITIAL-MAP.
  9473
  9474*    IF WS-PNDB-FOUND
  9475*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9476*                                   PB-C-AH-CANCEL-AMT
  9477*        MOVE 'R'                TO  TYPEO
  9478*        IF PI-AR-PROCESSING
  9479*            MOVE AL-UANON       TO  REFA
  9480*            MOVE PB-C-REFERENCE TO  REFO
  9481*        END-IF
  9482*    ELSE
  9483*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9484*                                   CM-AH-ITD-CANCEL-AMT.
  9485     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9486     MOVE pi-check-type           TO TYPEO
  9487
  9488     IF PI-COMPANY-ID = 'TMS'
  9489         MOVE WS-NAME-WORK         TO PAYTO1I
  9490                                      PI-PAYTO1
  9491         MOVE AL-UANON             TO PAYTO1A
  9492     ELSE
  9493         MOVE WS-NAME-WORK         TO PAYTO1I
  9494                                      PI-PAYTO1
  9495         MOVE AL-UANON             TO PAYTO1A.
  9496
  9497*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9498*    MOVE AL-UANON                 TO PAYTO1AA.
  9499     move 'N'                    to dedcyni
  9500     move al-uanon               to dedcyna
  9501     move 'INS'                  to payeeo
  9502     move al-panon               to payeea
  9503     IF PI-MAIL-YES
  9504         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9505
  9506     GO TO 8100-SEND-INITIAL-MAP.
  9507
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 171
* EL677.cbl
  9509
  9510 6400-MAILING-ADDRESS.
  9511
  9512* EXEC CICS HANDLE CONDITION
  9513*        NOTFND   (6470-NO-ADDRESS)
  9514*    END-EXEC.
  9515*    MOVE '"$I                   ! / #00008627' TO DFHEIV0
  9516     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9518     MOVE X'2F20233030303038363237' TO DFHEIV0(25:11)
  9519     CALL 'kxdfhei1' USING DFHEIV0
  9520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9521
  9522
  9523
  9524* EXEC CICS READ
  9525*        DATASET   (ERMAIL-FILE-ID)
  9526*        SET       (ADDRESS OF MAILING-DATA)
  9527*        RIDFLD    (ELCERT-KEY)
  9528*    END-EXEC.
  9529*    MOVE '&"S        E          (   #00008631' TO DFHEIV0
  9530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9532     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  9533     CALL 'kxdfhei1' USING DFHEIV0,
  9534           ERMAIL-FILE-ID,
  9535           DFHEIV20,
  9536           DFHEIV99,
  9537           ELCERT-KEY,
  9538           DFHEIV99,
  9539           DFHEIV99,
  9540           DFHEIV99
  9541     SET ADDRESS OF MAILING-DATA TO
  9542         DFHEIV20
  9543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9544
  9545
  9546     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9547     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9548     move ma-city                to payctyi
  9549     move ma-addr-state          to paysti
  9550     MOVE MA-ZIP                 TO PTOZIPI.
  9551     MOVE AL-UANON               TO PAYAD1A
  9552                                    PAYAD2A
  9553                                    PAYctyA
  9554                                    paysta
  9555                                    PTOZIPA.
  9556
  9557     GO TO 6490-EXIT.
  9558
  9559 6470-NO-ADDRESS.
  9560     MOVE -1                     TO  PAYAD1L.
  9561     MOVE ER-2394                TO  EMI-ERROR.
  9562     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9563
  9564 6490-EXIT.
  9565      EXIT.
  9566
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 172
* EL677.cbl
  9568
  9569 6500-BUILD-ACCOUNT-SCREEN.
  9570     MOVE LOW-VALUES             TO  EL677AI.
  9571     perform 6700-build-common   thru 6700-exit
  9572     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9573     MOVE PI-AM-NAME             TO PAYTO1I
  9574     MOVE SPACES                 TO PAYTO2I
  9575     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9576     MOVE PI-AM-CITY             TO PAYCTYI
  9577     move pi-am-st               to paysti
  9578     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9579     move 'ACCT'                 to payeeo
  9580     move al-panon               to payeea
  9581     MOVE AL-UANON               TO PAYTO1A
  9582                                    PAYTO2A
  9583                                    PAYAD1A
  9584                                    PAYCTYA
  9585                                    paysta
  9586                                    PTOZIPA
  9587     GO TO 8100-SEND-INITIAL-MAP
  9588     .
  9589 6600-BUILD-BENEFICIARY-SCREEN.
  9590     MOVE LOW-VALUES             TO  EL677AI.
  9591     perform 6700-build-common   thru 6700-exit
  9592     IF WS-CERT-NOT-FOUND
  9593         GO TO 8100-SEND-INITIAL-MAP.
  9594
  9595*    IF WS-PNDB-FOUND
  9596*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9597*                                   PB-C-AH-CANCEL-AMT
  9598*        MOVE 'R'                TO  TYPEO
  9599*        IF PI-AR-PROCESSING
  9600*            MOVE AL-UANON       TO  REFA
  9601*            MOVE PB-C-REFERENCE TO  REFO
  9602*        END-IF
  9603*    ELSE
  9604*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9605*                                   CM-AH-ITD-CANCEL-AMT.
  9606
  9607     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9608     MOVE pi-check-type           TO  TYPEO.
  9609
  9610     IF PI-COMPANY-ID = 'TMS'
  9611         MOVE WS-NAME-WORK         TO PAYTO1I
  9612                                      PI-PAYTO1
  9613         MOVE AL-UANON             TO PAYTO1A
  9614     ELSE
  9615         MOVE WS-NAME-WORK         TO PAYTO1I
  9616                                      PI-PAYTO1
  9617         MOVE AL-UANON             TO PAYTO1A.
  9618
  9619*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9620*    MOVE AL-UANON                 TO PAYTO1AA.
  9621
  9622     move 'N'                    to dedcyni
  9623     move al-uanon               to dedcyna
  9624     move 'BENE'                 to payeeo
  9625     move al-panon               to payeea
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 173
* EL677.cbl
  9626     IF PI-MAIL-YES
  9627         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
  9628
  9629     GO TO 8100-SEND-INITIAL-MAP.
  9630
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 174
* EL677.cbl
  9632
  9633 6620-MAILING-ADDRESS.
  9634
  9635* EXEC CICS HANDLE CONDITION
  9636*        NOTFND   (6670-NO-beneficiary)
  9637*    END-EXEC.
  9638*    MOVE '"$I                   ! 0 #00008725' TO DFHEIV0
  9639     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9641     MOVE X'3020233030303038373235' TO DFHEIV0(25:11)
  9642     CALL 'kxdfhei1' USING DFHEIV0
  9643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9644
  9645
  9646
  9647* EXEC CICS READ
  9648*        DATASET   (ERMAIL-FILE-ID)
  9649*        SET       (ADDRESS OF MAILING-DATA)
  9650*        RIDFLD    (ELCERT-KEY)
  9651*    END-EXEC.
  9652*    MOVE '&"S        E          (   #00008729' TO DFHEIV0
  9653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9655     MOVE X'2020233030303038373239' TO DFHEIV0(25:11)
  9656     CALL 'kxdfhei1' USING DFHEIV0,
  9657           ERMAIL-FILE-ID,
  9658           DFHEIV20,
  9659           DFHEIV99,
  9660           ELCERT-KEY,
  9661           DFHEIV99,
  9662           DFHEIV99,
  9663           DFHEIV99
  9664     SET ADDRESS OF MAILING-DATA TO
  9665         DFHEIV20
  9666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9667
  9668
  9669     move spaces                 to payto2i
  9670     move ma-cred-bene-name      to payto1i
  9671     MOVE MA-cred-bene-addr      TO PAYad1I.
  9672     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9673     move ma-cred-bene-city      to payctyi
  9674     move ma-cred-bene-state     to paysti
  9675     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9676     MOVE AL-UANON               TO payto1a
  9677                                    PAYTO2A
  9678                                    PAYad1A
  9679                                    payad2a
  9680                                    PAYctyA
  9681                                    paysta
  9682                                    PTOZIPA.
  9683
  9684     GO TO 6690-EXIT.
  9685
  9686 6670-NO-BENEFICIARY.
  9687     MOVE -1                     TO  PAYTO1L.
  9688     MOVE ER-2394                TO  EMI-ERROR.
  9689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 175
* EL677.cbl
  9690
  9691 6690-EXIT.
  9692      EXIT.
  9693 6700-build-common.
  9694     if not eracct-found
  9695        move pi-company-cd       to eracct-co
  9696        move pi-carrier          to eracct-carrier
  9697        move pi-grouping         to eracct-grouping
  9698        move pi-state            to eracct-state
  9699        move pi-account          to eracct-account
  9700        move pi-cert-eff-dt      to eracct-exp-date
  9701        perform 1420-get-eracct  thru 1490-exit
  9702     end-if
  9703*    if WS-PNDB-NOT-FOUND
  9704*       perform 5600-get-erpndb thru 5600-exit
  9705*    end-if
  9706*    MOVE LOW-VALUES             TO  EL677AI.
  9707     MOVE 'A'                    TO  MAINTI.
  9708     MOVE AL-UANON               TO  MAINTA.
  9709     MOVE +1                     TO  MAINTL.
  9710     MOVE PI-CARRIER             TO  CARRIERO.
  9711     MOVE PI-GROUPING            TO  GROUPO.
  9712     MOVE PI-STATE               TO  STATEO.
  9713     MOVE PI-ACCOUNT             TO  ACCTO.
  9714     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9715     MOVE PI-CERT-SFX            TO  SFXO.
  9716     MOVE PI-AMOUNT              TO  AMOUNTO.
  9717*    MOVE PI-TYPE                TO  TYPEO.
  9718     move pi-check-type          to  typeo
  9719     move pi-return-to           to  rettoo
  9720*    MOVE PI-REFERENCE           TO  REFO.
  9721     MOVE PI-PAYTO1              TO  PAYTO1O.
  9722     MOVE AL-UANON               TO  CARRIERA
  9723                                     GROUPA
  9724                                     STATEA
  9725                                     ACCTA
  9726                                     CERTNOA
  9727                                     SFXA
  9728                                     PAYTO1A
  9729                                     PAYTO2A
  9730*                                    AMOUNTA
  9731*                                    TYPEA
  9732                                     rettoa
  9733                                     payeea.
  9734     move al-panon               to typea
  9735     move al-panon               to amounta
  9736     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9737     MOVE ' '                    TO  DC-OPTION-CODE.
  9738     PERFORM 8500-DATE-CONVERT.
  9739     IF NO-CONVERSION-ERROR
  9740         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9741         MOVE AL-UANON            TO  EFFDTA
  9742         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9743         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9744     ELSE
  9745         GO TO 8200-SEND-DATAONLY.
  9746     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9747         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 176
* EL677.cbl
  9748         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9749     ELSE
  9750         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9751         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9752     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9753     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9754     move spaces to pi-insured-name
  9755     string cm-insured-last-name ' '
  9756            cm-insured-first-name delimited by '  '
  9757        into pi-insured-name
  9758     end-string
  9759     move spaces                 to pi-table-name
  9760     string cm-insured-last-name ', '
  9761            cm-insured-first-name ' '
  9762            cm-insured-initial2
  9763        delimited by '  '
  9764        into
  9765           pi-table-name
  9766     end-string
  9767*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9768     if eibaid = dfhpf5
  9769        move 'Y'                 to dedcyni
  9770        move al-uanon            to dedcyna
  9771     end-if
  9772    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9773       cm-lf-alt-premium-amt
  9774    compute ws-tot-iss-prem  =
  9775       cm-ah-premium-amt + ws-tot-lf-prem
  9776    compute ws-tot-iss-comm =
  9777       (ws-tot-lf-prem * cm-life-comm-pct) +
  9778       (cm-ah-premium-amt * cm-ah-comm-pct)
  9779    compute ws-tot-ref-comm =
  9780       (pi-lf-refund * cm-life-comm-pct) +
  9781       (pi-ah-refund * cm-ah-comm-pct)
  9782     move ws-tot-iss-prem        to premo
  9783     move ws-tot-iss-comm        to isscommo
  9784     move al-sadof               to drefa
  9785                                    refa
  9786*    compute refo = pi-lf-refund + pi-ah-refund
  9787     move pi-prev-paid            to prepdo
  9788     move ws-tot-ref-comm         to uecommo
  9789                                     pi-ue-comm
  9790***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9791***     pi-prev-paid
  9792     compute ws-refund-amount =
  9793        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9794     if (pi-refund-on-pending-rec + pi-prev-paid) >
  9795        ws-tot-iss-prem
  9796        move zeros               to ws-refund-amount
  9797     end-if
  9798     if ((dedcyni = 'Y')
  9799        or (pi-prev-ded-comm = 'Y'))
  9800        and (ws-refund-amount >= ws-tot-ref-comm)
  9801        compute ws-refund-amount = ws-refund-amount -
  9802           ws-tot-ref-comm
  9803     end-if
  9804     if pi-check-type = 'C'
  9805*       move pi-endt-prm-diff    to refo
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 177
* EL677.cbl
  9806        move pi-endt-com-diff    to uecommo
  9807                                    pi-ue-comm
  9808        compute ws-refund-amount =
  9809           pi-endt-prm-diff - pi-prev-paid
  9810        if (dedcyni = 'Y')
  9811           or (pi-prev-ded-comm = 'Y')
  9812           compute ws-refund-amount = ws-refund-amount -
  9813              pi-endt-com-diff
  9814        end-if
  9815        if ws-refund-amount <= zeros
  9816           move pi-endt-prm-diff to ws-refund-amount
  9817        end-if
  9818     end-if
  9819     if not WS-CERT-NOT-FOUND
  9820        string
  9821           pi-cert-prime         ' : '
  9822           cm-insured-last-name  ', '
  9823           cm-insured-first-name ' : '
  9824           pi-account            ' : '
  9825           pi-am-csr delimited by '  ' into text1o
  9826        end-string
  9827        move al-uanon            to text1a
  9828        MOVE 'REF'               TO WS-USER-REASON
  9829        if pi-check-type = 'C'
  9830           move 'COR'            to ws-user-reason
  9831        end-if
  9832        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9833        inspect ws-user-cert-no replacing leading zeros
  9834           by spaces
  9835        move pi-insured-name     to ws-user-name
  9836        perform varying s1 from +1 by +1 until
  9837           (s1 > +11)
  9838           or (ws-user-cert-no (s1:1)) <> ' '
  9839        end-perform
  9840        string ws-user-reason  ' ' delimited by size
  9841               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9842                  delimited by size
  9843               cm-insured-last-name ' '
  9844               cm-insured-first-name delimited by '  '
  9845           into stubo
  9846        end-string
  9847        move al-uanon            to stuba
  9848     end-if
  9849     .
  9850 6700-exit.
  9851     exit.
  9852 6800-browse-previous-chek-recs.
  9853***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9854***                                                            ***
  9855**** this should be the first time through, we need to gather  ***
  9856**** all the erchek records for this pending record, add the   ***
  9857**** amounts and make sure this check request will not exceed  ***
  9858**** the collected premium                                     ***
  9859***                                                            ***
  9860***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9861     move zeros                  to pi-prev-paid
  9862                                    pi-prev-paid-this-month
  9863                                    ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 178
* EL677.cbl
  9864                                    pi-chek-rec-cnt
  9865     move spaces                 to pi-prev-ded-comm
  9866     move pi-company-cd          to chek-company-cd
  9867     move pi-carrier             to chek-carrier
  9868     move pi-grouping            to chek-grouping
  9869     move pi-state               to chek-state
  9870     move pi-account             to chek-account
  9871     move pi-cert-prime          to chek-cert-no
  9872     move pi-cert-sfx            to chek-suf-no
  9873     move pi-cert-eff-dt         to chek-eff-dt
  9874     move +0                     to chek-record-seq
  9875     move erchek-key             to ws-compare-erchek-key
  9876
  9877* EXEC CICS STARTBR
  9878*       DATASET  (ERCHEK-FILE-ID)
  9879*       RIDFLD   (ERCHEK-KEY)
  9880*       resp     (ws-response)
  9881*    END-EXEC
  9882     MOVE 0
  9883       TO DFHEIV11
  9884*    MOVE '&,         G          &  N#00008942' TO DFHEIV0
  9885     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9887     MOVE X'204E233030303038393432' TO DFHEIV0(25:11)
  9888     CALL 'kxdfhei1' USING DFHEIV0,
  9889           ERCHEK-FILE-ID,
  9890           ERCHEK-KEY,
  9891           DFHEIV99,
  9892           DFHEIV11,
  9893           DFHEIV99
  9894     MOVE EIBRESP  TO ws-response
  9895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9896     if not resp-normal
  9897        go to 6800-exit
  9898     end-if
  9899     perform until i-say-when
  9900
  9901* EXEC CICS READNEXT
  9902*          DATASET   (ERCHEK-FILE-ID)
  9903*          SET       (ADDRESS OF CHECK-RECORDS)
  9904*          RIDFLD    (ERCHEK-KEY)
  9905*          resp      (ws-response)
  9906*       END-EXEC
  9907     MOVE 0
  9908       TO DFHEIV11
  9909*    MOVE '&.S                   )  N#00008951' TO DFHEIV0
  9910     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9911     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9912     MOVE X'204E233030303038393531' TO DFHEIV0(25:11)
  9913     CALL 'kxdfhei1' USING DFHEIV0,
  9914           ERCHEK-FILE-ID,
  9915           DFHEIV20,
  9916           DFHEIV99,
  9917           ERCHEK-KEY,
  9918           DFHEIV99,
  9919           DFHEIV11,
  9920           DFHEIV99,
  9921           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 179
* EL677.cbl
  9922     SET ADDRESS OF CHECK-RECORDS TO
  9923         DFHEIV20
  9924     MOVE EIBRESP  TO ws-response
  9925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9926        if resp-normal
  9927           and erchek-key (1:33) = ws-compare-erchek-key
  9928           if (ch-void-dt = low-values)
  9929              and (not ch-denied)
  9930              if pi-check-type = 'R'
  9931                 and ch-check-origin-sw = 'C'
  9932                 continue
  9933              else
  9934                 compute pi-prev-paid = pi-prev-paid +
  9935                    ch-amount-paid
  9936                 add +1 to pi-chek-rec-cnt
  9937                 move ch-deduct-commission
  9938                                 to pi-prev-ded-comm
  9939                 if ch-credit-select-dt = pi-cr-month-end-dt
  9940                    compute pi-prev-paid-this-month =
  9941                       pi-prev-paid-this-month + ch-amount-paid
  9942                 end-if
  9943              end-if
  9944           end-if
  9945        else
  9946           set i-say-when to true
  9947        end-if
  9948     end-perform
  9949     .
  9950 6800-exit.
  9951     exit.
  9952 7000-SET-PI-AREA.
  9953     MOVE CARRIERI               TO  PI-CARRIER
  9954                                     PI-CHEK-CARRIER.
  9955     MOVE GROUPI                 TO  PI-GROUPING
  9956                                     PI-CHEK-GROUPING.
  9957     MOVE STATEI                 TO  PI-STATE
  9958                                     PI-CHEK-STATE.
  9959     MOVE ACCTI                  TO  PI-ACCOUNT
  9960                                     PI-CHEK-ACCOUNT.
  9961     MOVE CERTNOI                TO  PI-CERT-PRIME
  9962                                     PI-CHEK-CERT-NO.
  9963     IF SFXI NOT = LOW-VALUES
  9964         MOVE SFXI               TO  PI-CERT-SFX
  9965                                     PI-CHEK-SUF-NO
  9966     ELSE
  9967         MOVE SPACE              TO  PI-CERT-SFX
  9968                                     PI-CHEK-SUF-NO.
  9969
  9970     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9971     MOVE '2'                    TO  DC-OPTION-CODE.
  9972     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9973     IF DATE-CONVERSION-ERROR
  9974         MOVE ER-0215            TO  EMI-ERROR
  9975         MOVE -1                 TO  EFFDTL
  9976         MOVE AL-UNBON           TO  EFFDTA
  9977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9978         GO TO 8200-SEND-DATAONLY
  9979     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 180
* EL677.cbl
  9980         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9981                                     PI-CHEK-EFF-DT.
  9982
  9983 7090-EXIT.
  9984      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 181
* EL677.cbl
  9986 7100-CREATE-TEMP-STORAGE.
  9987     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9988
  9989
  9990* EXEC CICS WRITEQ TS
  9991*        QUEUE   (QID)
  9992*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9993*        LENGTH  (PI-COMM-LENGTH)
  9994*    END-EXEC.
  9995*    MOVE '*"     L              ''   #00009020' TO DFHEIV0
  9996     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9998     MOVE X'2020233030303039303230' TO DFHEIV0(25:11)
  9999     CALL 'kxdfhei1' USING DFHEIV0,
 10000           QID,
 10001           PROGRAM-INTERFACE-BLOCK,
 10002           PI-COMM-LENGTH,
 10003           DFHEIV99,
 10004           DFHEIV99,
 10005           DFHEIV99
 10006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10007
 10008
 10009 7100-EXIT.
 10010      EXIT.
 10011
 10012 7200-RECOVER-TEMP-STORAGE.
 10013
 10014* EXEC CICS READQ TS
 10015*        QUEUE   (QID)
 10016*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10017*        LENGTH  (PI-COMM-LENGTH)
 10018*    END-EXEC.
 10019*    MOVE '*$I    L              ''   #00009030' TO DFHEIV0
 10020     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10022     MOVE X'2020233030303039303330' TO DFHEIV0(25:11)
 10023     CALL 'kxdfhei1' USING DFHEIV0,
 10024           QID,
 10025           PROGRAM-INTERFACE-BLOCK,
 10026           PI-COMM-LENGTH,
 10027           DFHEIV99,
 10028           DFHEIV99,
 10029           DFHEIV99
 10030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10031
 10032
 10033     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10034
 10035 7200-EXIT.
 10036      EXIT.
 10037
 10038 7300-DELETE-TEMP-STORAGE.
 10039
 10040* EXEC CICS HANDLE CONDITION
 10041*        QIDERR  (7300-EXIT)
 10042*    END-EXEC.
 10043*    MOVE '"$N                   ! 1 #00009042' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 182
* EL677.cbl
 10044     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10046     MOVE X'3120233030303039303432' TO DFHEIV0(25:11)
 10047     CALL 'kxdfhei1' USING DFHEIV0
 10048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10049
 10050
 10051
 10052* EXEC CICS DELETEQ TS
 10053*        QUEUE  (QID)
 10054*    END-EXEC.
 10055*    MOVE '*&                    #   #00009046' TO DFHEIV0
 10056     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10057     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10058     MOVE X'2020233030303039303436' TO DFHEIV0(25:11)
 10059     CALL 'kxdfhei1' USING DFHEIV0,
 10060           QID,
 10061           DFHEIV99
 10062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10063
 10064
 10065 7300-EXIT.
 10066      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 183
* EL677.cbl
 10068 7500-reissue-pass-1.
 10069
 10070     move '2'                    to pi-void-reissue-pass
 10071
 10072     move pi-void-reissue-amt    to amounto
 10073
 10074     if eibaid = dfhpf5
 10075        MOVE PI-AM-NAME          TO PAYTO1I
 10076        MOVE SPACES              TO PAYTO2I
 10077        MOVE PI-AM-ADDRS         TO PAYAD1I
 10078        MOVE PI-AM-CITY          TO PAYCTYI
 10079        move pi-am-st            to paysti
 10080        MOVE PI-AM-ZIP-CODE      TO PTOZIPI
 10081        move 'ACCT'              to payeeo
 10082        move al-panon            to payeea
 10083
 10084        MOVE AL-UANON            TO PAYTO1A
 10085                                    PAYTO2A
 10086                                    PAYAD1A
 10087                                    PAYCTYA
 10088                                    paysta
 10089                                    PTOZIPA
 10090                                    payeea
 10091        GO TO 8100-SEND-INITIAL-MAP
 10092     end-if
 10093
 10094     perform 5700-get-elcert     thru 5700-exit
 10095     move spaces                 to pi-table-name
 10096     string cm-insured-last-name ', '
 10097            cm-insured-first-name ' '
 10098            cm-insured-initial2
 10099        delimited by '  '
 10100        into
 10101           pi-table-name
 10102     end-string
 10103
 10104     IF CM-INSURED-FIRST-NAME GREATER SPACES
 10105         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
 10106         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
 10107     ELSE
 10108         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
 10109         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
 10110
 10111     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
 10112
 10113     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10114
 10115     if eibaid = dfhpf7
 10116
 10117* EXEC CICS READ
 10118*           DATASET   (ERMAIL-FILE-ID)
 10119*           SET       (ADDRESS OF MAILING-DATA)
 10120*           RIDFLD    (ELCERT-KEY)
 10121*           resp      (ws-response)
 10122*       END-EXEC
 10123*    MOVE '&"S        E          (  N#00009101' TO DFHEIV0
 10124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 184
* EL677.cbl
 10126     MOVE X'204E233030303039313031' TO DFHEIV0(25:11)
 10127     CALL 'kxdfhei1' USING DFHEIV0,
 10128           ERMAIL-FILE-ID,
 10129           DFHEIV20,
 10130           DFHEIV99,
 10131           ELCERT-KEY,
 10132           DFHEIV99,
 10133           DFHEIV99,
 10134           DFHEIV99
 10135     SET ADDRESS OF MAILING-DATA TO
 10136         DFHEIV20
 10137     MOVE EIBRESP  TO ws-response
 10138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10139        if resp-normal
 10140           move spaces             to payto2i
 10141           move ma-cred-bene-name  to payto1i
 10142           MOVE MA-cred-bene-addr  TO PAYad1I
 10143           MOVE MA-cred-bene-addr2 TO PAYad2I
 10144           move ma-cred-bene-city  to payctyi
 10145           move ma-cred-bene-state to paysti
 10146           MOVE MA-cred-bene-zip   TO PTOZIPI
 10147           move 'BENE'              to payeeo
 10148           MOVE AL-UANON           TO payto1a
 10149                                      PAYTO2A
 10150                                      PAYad1A
 10151                                      payad2a
 10152                                      PAYctyA
 10153                                      paysta
 10154                                      PTOZIPA
 10155                                      payeea
 10156        end-if
 10157     end-if
 10158
 10159     if eibaid = dfhpf6
 10160
 10161* EXEC CICS READ
 10162*           DATASET   (ERMAIL-FILE-ID)
 10163*           SET       (ADDRESS OF MAILING-DATA)
 10164*           RIDFLD    (ELCERT-KEY)
 10165*           resp      (ws-response)
 10166*       END-EXEC
 10167*    MOVE '&"S        E          (  N#00009128' TO DFHEIV0
 10168     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10169     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10170     MOVE X'204E233030303039313238' TO DFHEIV0(25:11)
 10171     CALL 'kxdfhei1' USING DFHEIV0,
 10172           ERMAIL-FILE-ID,
 10173           DFHEIV20,
 10174           DFHEIV99,
 10175           ELCERT-KEY,
 10176           DFHEIV99,
 10177           DFHEIV99,
 10178           DFHEIV99
 10179     SET ADDRESS OF MAILING-DATA TO
 10180         DFHEIV20
 10181     MOVE EIBRESP  TO ws-response
 10182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10183        if resp-normal
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 185
* EL677.cbl
 10184           move spaces            to payto2i
 10185           move ws-name-work      to payto1i
 10186           MOVE MA-ADDRESS-LINE-1 TO PAYAD1I
 10187           MOVE MA-ADDRESS-LINE-2 TO PAYAD2I
 10188           move ma-city           to payctyi
 10189           move ma-addr-state     to paysti
 10190           move 'INS'             to payeeo
 10191           MOVE MA-ZIP            TO PTOZIPI
 10192           MOVE AL-UANON          TO PAYAD1A
 10193                                     PAYAD2A
 10194                                     PAYctyA
 10195                                     paysta
 10196                                     PTOZIPA
 10197                                     payto1a
 10198                                     payeea
 10199        end-if
 10200     end-if
 10201
 10202     GO TO 8100-SEND-INITIAL-MAP
 10203
 10204     .
 10205 7500-exit.
 10206     exit.
 10207
 10208 7510-reissue-pass-2.
 10209
 10210
 10211* EXEC CICS READ
 10212*        DATASET  (ERCHEK-FILE-ID)
 10213*        SET      (ADDRESS OF CHECK-RECORDS)
 10214*        RIDFLD   (PI-ERCHEK-KEY)
 10215*        resp     (ws-response)
 10216*    END-EXEC
 10217*    MOVE '&"S        E          (  N#00009161' TO DFHEIV0
 10218     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10220     MOVE X'204E233030303039313631' TO DFHEIV0(25:11)
 10221     CALL 'kxdfhei1' USING DFHEIV0,
 10222           ERCHEK-FILE-ID,
 10223           DFHEIV20,
 10224           DFHEIV99,
 10225           PI-ERCHEK-KEY,
 10226           DFHEIV99,
 10227           DFHEIV99,
 10228           DFHEIV99
 10229     SET ADDRESS OF CHECK-RECORDS TO
 10230         DFHEIV20
 10231     MOVE EIBRESP  TO ws-response
 10232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10233
 10234     if not resp-normal
 10235        go to 7510-exit
 10236     end-if
 10237
 10238     if ch-void-dt not = save-bin-date
 10239        display ' something went wrong here '
 10240        go to 7510-exit
 10241     end-if
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 186
* EL677.cbl
 10242
 10243     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS
 10244     MOVE save-bin-date          TO CH-RECORDED-DT
 10245                                    ch-released-dt
 10246     move pi-processor-id        to ch-recorded-by
 10247                                    ch-released-by
 10248                                    ch-return-to
 10249     move spaces                 to ch-check-no
 10250                                    ch-void-by
 10251                                    ch-void-reason
 10252                                    ch-approved-by
 10253
 10254
 10255     move 'P'                    to ch-approval-status
 10256
 10257     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
 10258                                    CH-VOID-DT
 10259                                    CH-CREDIT-ACCEPT-DT
 10260                                    ch-approval-dt
 10261                                    ch-check-cashed-dt
 10262     add +1 to ch-sequence-no
 10263     if ch-check-origin-sw = 'R'
 10264        move 'R'                 to pi-check-type
 10265     else
 10266        move 'C'                 to pi-check-type
 10267     end-if
 10268
 10269     .
 10270 7510-WRITE-RECORD.
 10271
 10272
 10273* exec cics read
 10274*       dataset    (erchek-file-id)
 10275*       into       (ws-dummy-erchek)
 10276*       ridfld     (ch-control-primary)
 10277*       resp       (ws-response)
 10278*    end-exec
 10279     MOVE LENGTH OF
 10280      ws-dummy-erchek
 10281       TO DFHEIV11
 10282*    MOVE '&"IL       E          (  N#00009206' TO DFHEIV0
 10283     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10285     MOVE X'204E233030303039323036' TO DFHEIV0(25:11)
 10286     CALL 'kxdfhei1' USING DFHEIV0,
 10287           erchek-file-id,
 10288           ws-dummy-erchek,
 10289           DFHEIV11,
 10290           ch-control-primary,
 10291           DFHEIV99,
 10292           DFHEIV99,
 10293           DFHEIV99
 10294     MOVE EIBRESP  TO ws-response
 10295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10296     if RESP-NOTFND
 10297        continue
 10298     else
 10299        add +1                   to ch-sequence-no
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 187
* EL677.cbl
 10300        add 1                    to seqi
 10301        go to 7510-write-record
 10302     end-if
 10303
 10304     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
 10305     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
 10306                                    CH-CHECK-QUE-SEQUENCE
 10307
 10308     IF PAYTO1L NOT = ZEROS
 10309        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
 10310     END-IF
 10311     IF PAYTO2L NOT = ZEROS
 10312        MOVE PAYTO2I             TO CH-PAYEE-NAME-2
 10313     end-if
 10314     IF PAYAD1L NOT = ZEROS
 10315        MOVE PAYAD1I             TO CH-PAYEE-ADDRESS-1
 10316     end-if
 10317     IF PAYAD2L NOT = ZEROS
 10318        MOVE PAYAD2I             TO CH-PAYEE-ADDRESS-2
 10319     end-if
 10320     IF PAYctyL NOT = ZEROS
 10321        MOVE payctyi             TO CH-PAYEE-CITY
 10322     end-if
 10323     IF PAYstL NOT = ZEROS
 10324        MOVE paysti              TO CH-PAYEE-state
 10325     end-if
 10326     IF PAYEEI GREATER SPACES
 10327        mOVE PAYEEI               TO CH-PAYEE-CODE
 10328     end-if
 10329     IF PTOZIPL  =  ZEROS
 10330        MOVE ZEROS               TO CH-PAYEE-ZIP-CODE
 10331     else
 10332        MOVE PTOZIPI             TO WS-ZIP-CODE
 10333        IF NOT WS-CANADIAN-POST-CODE
 10334           MOVE WS-ZIP-PRIME     TO CH-PAYEE-ZIP
 10335           MOVE WS-ZIP-PLUS4     TO CH-PAYEE-ZIP-EXT
 10336        end-if
 10337     end-if
 10338
 10339     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
 10340
 10341
 10342* EXEC CICS WRITE
 10343*        DATASET  (ERCHEK-FILE-ID)
 10344*        FROM     (CHECK-RECORDS)
 10345*        RIDFLD   (CH-CONTROL-PRIMARY)
 10346*        resp     (ws-response)
 10347*    END-EXEC.
 10348     MOVE LENGTH OF
 10349      CHECK-RECORDS
 10350       TO DFHEIV11
 10351*    MOVE '&$ L                  ''  N#00009257' TO DFHEIV0
 10352     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10353     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10354     MOVE X'204E233030303039323537' TO DFHEIV0(25:11)
 10355     CALL 'kxdfhei1' USING DFHEIV0,
 10356           ERCHEK-FILE-ID,
 10357           CHECK-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 188
* EL677.cbl
 10358           DFHEIV11,
 10359           CH-CONTROL-PRIMARY,
 10360           DFHEIV99,
 10361           DFHEIV99
 10362     MOVE EIBRESP  TO ws-response
 10363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10364
 10365     COMPUTE WS-JOURNAL-RECORD-LENGTH =
 10366             ERCHEK-RECORD-LENGTH + 23.
 10367
 10368     IF EMI-NO-ERRORS
 10369        MOVE ER-0000             TO EMI-ERROR
 10370     ELSE
 10371        IF EMI-FORCABLE-CTR GREATER THAN +0  AND
 10372           EIBAID = DFHPF4
 10373           MOVE ER-2600          TO EMI-ERROR
 10374        end-if
 10375     end-if
 10376
 10377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10378
 10379     MOVE LOW-VALUES             TO EL677AI.
 10380
 10381     MOVE PI-CHEK-CARRIER        TO CARRIERO.
 10382     MOVE PI-CHEK-GROUPING       TO GROUPO.
 10383     MOVE PI-CHEK-STATE          TO STATEO.
 10384     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
 10385
 10386     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
 10387     MOVE SPACE                  TO DC-OPTION-CODE.
 10388     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10389     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
 10390
 10391     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
 10392     MOVE PI-CHEK-SUF-NO         TO SFXO.
 10393     MOVE PI-CHEK-SEQUENCE       TO SEQO.
 10394
 10395     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
 10396                                    ACCTA     EFFDTA  CERTNOA
 10397                                    SFXA.
 10398     MOVE AL-UNNON               TO SEQA
 10399     move ' ' to pi-void-reissue-pass
 10400     go to 5000-browse-file
 10401
 10402     .
 10403 7510-exit.
 10404     exit.
 10405 8100-SEND-INITIAL-MAP.
 10406     MOVE SAVE-DATE              TO  DATEO.
 10407     MOVE EIBTIME                TO  TIME-IN.
 10408     MOVE TIME-OUT               TO  TIMEO.
 10409     MOVE -1                     TO  MAINTL
 10410     move al-uanon               to mainta
 10411     move dedcyni                to pi-previous-deduct-comm
 10412     if (PI-TO-EL677-FROM-EL1273)
 10413        and (pi-void-reissue-pass = ' ')
 10414        move al-sadof            to pf3a
 10415                                    pf4a
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 189
* EL677.cbl
 10416                                    pf57a
 10417                                    pf6a
 10418                                    dprema
 10419                                    dcomma
 10420                                    drefa
 10421                                    duecomma
 10422                                    dprepda
 10423                                    prema
 10424                                    isscomma
 10425                                    refa
 10426                                    uecomma
 10427                                    prepda
 10428        move ', VOID(V)'         to dmaint1o
 10429        move 'VOID & REISSUE(R), DELETE(D)'
 10430                                 TO dmaint2o
 10431     end-if
 10432     if (pi-to-el677-from-el1273)
 10433        and (pi-void-reissue-pass = '1')
 10434        move al-sadof            to pf3a
 10435                                    pf4a
 10436                                    dprema
 10437                                    dcomma
 10438                                    drefa
 10439                                    duecomma
 10440                                    dprepda
 10441                                    prema
 10442                                    isscomma
 10443                                    refa
 10444                                    uecomma
 10445                                    prepda
 10446        move ', VOID(V)'         to dmaint1o
 10447        move 'VOID AND REISSUE(R)'
 10448                                 TO dmaint2o
 10449     end-if
 10450     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10451     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10452
 10453
 10454* EXEC CICS SEND
 10455*        MAP      (EL677A)
 10456*        MAPSET   (MAPSET-NAME)
 10457*        FROM     (EL677AO)
 10458*        ERASE
 10459*        CURSOR
 10460*    END-EXEC.
 10461     MOVE LENGTH OF
 10462      EL677AO
 10463       TO DFHEIV12
 10464     MOVE -1
 10465       TO DFHEIV11
 10466*    MOVE '8$     CT  E    H L F ,   #00009351' TO DFHEIV0
 10467     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10468     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10469     MOVE X'2020233030303039333531' TO DFHEIV0(25:11)
 10470     CALL 'kxdfhei1' USING DFHEIV0,
 10471           EL677A,
 10472           EL677AO,
 10473           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 190
* EL677.cbl
 10474           MAPSET-NAME,
 10475           DFHEIV99,
 10476           DFHEIV99,
 10477           DFHEIV99,
 10478           DFHEIV11,
 10479           DFHEIV99,
 10480           DFHEIV99,
 10481           DFHEIV99
 10482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10483
 10484
 10485     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 191
* EL677.cbl
 10487 8200-SEND-DATAONLY.
 10488     if connected-to-db
 10489        perform 4300-FINISH-UP-DB thru 4300-exit
 10490     end-if
 10491     MOVE SAVE-DATE              TO  DATEO.
 10492     MOVE EIBTIME                TO  TIME-IN.
 10493     MOVE TIME-OUT               TO  TIMEO.
 10494     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10495     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10496
 10497
 10498* EXEC CICS SEND
 10499*        MAP     (EL677A)
 10500*        MAPSET  (MAPSET-NAME)
 10501*        FROM    (EL677AO)
 10502*        DATAONLY
 10503*        CURSOR
 10504*    END-EXEC.
 10505     MOVE LENGTH OF
 10506      EL677AO
 10507       TO DFHEIV12
 10508     MOVE -1
 10509       TO DFHEIV11
 10510*    MOVE '8$D    CT       H L F ,   #00009371' TO DFHEIV0
 10511     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10512     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10513     MOVE X'2020233030303039333731' TO DFHEIV0(25:11)
 10514     CALL 'kxdfhei1' USING DFHEIV0,
 10515           EL677A,
 10516           EL677AO,
 10517           DFHEIV12,
 10518           MAPSET-NAME,
 10519           DFHEIV99,
 10520           DFHEIV99,
 10521           DFHEIV99,
 10522           DFHEIV11,
 10523           DFHEIV99,
 10524           DFHEIV99,
 10525           DFHEIV99
 10526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10527
 10528
 10529     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 192
* EL677.cbl
 10531 8300-SEND-TEXT.
 10532
 10533* EXEC CICS SEND TEXT
 10534*        FROM     (LOGOFF-TEXT)
 10535*        LENGTH   (LOGOFF-LENGTH)
 10536*        ERASE
 10537*        FREEKB
 10538*    END-EXEC.
 10539*    MOVE '8&      T  E F  H   F -   #00009382' TO DFHEIV0
 10540     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10541     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10542     MOVE X'2020233030303039333832' TO DFHEIV0(25:11)
 10543     CALL 'kxdfhei1' USING DFHEIV0,
 10544           LOGOFF-TEXT,
 10545           LOGOFF-LENGTH,
 10546           DFHEIV99,
 10547           DFHEIV99,
 10548           DFHEIV99,
 10549           DFHEIV99,
 10550           DFHEIV99,
 10551           DFHEIV99,
 10552           DFHEIV99,
 10553           DFHEIV99,
 10554           DFHEIV99,
 10555           DFHEIV99
 10556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10557
 10558
 10559
 10560* EXEC CICS RETURN
 10561*    END-EXEC.
 10562*    MOVE '.(                    ''   #00009389' TO DFHEIV0
 10563     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10565     MOVE X'2020233030303039333839' TO DFHEIV0(25:11)
 10566     CALL 'kxdfhei1' USING DFHEIV0,
 10567           DFHEIV99,
 10568           DFHEIV99,
 10569           DFHEIV99,
 10570           DFHEIV99,
 10571           DFHEIV99,
 10572           DFHEIV99
 10573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10574
 10575
 10576 8500-DATE-CONVERT.
 10577     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10578
 10579
 10580* EXEC CICS LINK
 10581*        PROGRAM    (PGM-NAME)
 10582*        COMMAREA   (DATE-CONVERSION-DATA)
 10583*        LENGTH     (DC-COMM-LENGTH)
 10584*    END-EXEC.
 10585*    MOVE '."C                   (   #00009395' TO DFHEIV0
 10586     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10587     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10588     MOVE X'2020233030303039333935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 193
* EL677.cbl
 10589     CALL 'kxdfhei1' USING DFHEIV0,
 10590           PGM-NAME,
 10591           DATE-CONVERSION-DATA,
 10592           DC-COMM-LENGTH,
 10593           DFHEIV99,
 10594           DFHEIV99,
 10595           DFHEIV99,
 10596           DFHEIV99
 10597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10598
 10599
 10600 8500-EXIT.
 10601      EXIT.
 10602
 10603 8600-DEEDIT.
 10604
 10605* EXEC CICS BIF DEEDIT
 10606*        FIELD   (WS-DEEDIT-FIELD)
 10607*        LENGTH  (10)
 10608*    END-EXEC.
 10609     MOVE 10
 10610       TO DFHEIV11
 10611*    MOVE '@"L                   #   #00009405' TO DFHEIV0
 10612     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10613     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10614     MOVE X'2020233030303039343035' TO DFHEIV0(25:11)
 10615     CALL 'kxdfhei1' USING DFHEIV0,
 10616           WS-DEEDIT-FIELD,
 10617           DFHEIV11
 10618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10619
 10620
 10621 8600-EXIT.
 10622      EXIT.
 10623
 10624 8700-DEEDIT.
 10625
 10626* EXEC CICS BIF DEEDIT
 10627*        FIELD   (WS-DT-DEEDIT-FIELD)
 10628*        LENGTH  (10)
 10629*    END-EXEC.
 10630     MOVE 10
 10631       TO DFHEIV11
 10632*    MOVE '@"L                   #   #00009414' TO DFHEIV0
 10633     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10634     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10635     MOVE X'2020233030303039343134' TO DFHEIV0(25:11)
 10636     CALL 'kxdfhei1' USING DFHEIV0,
 10637           WS-DT-DEEDIT-FIELD,
 10638           DFHEIV11
 10639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10640
 10641
 10642 8700-EXIT.
 10643      EXIT.
 10644
 10645 8800-UNAUTHORIZED-ACCESS.
 10646     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 194
* EL677.cbl
 10647     GO TO 8300-SEND-TEXT.
 10648
 10649 8810-PF23.
 10650     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10651     MOVE XCTL-005               TO  PGM-NAME.
 10652     GO TO 9300-XCTL.
 10653
 10654
 10655 9100-RETURN-TRAN.
 10656     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10657     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10658
 10659* EXEC CICS RETURN
 10660*        TRANSID  (TRANS-ID)
 10661*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10662*        LENGTH   (PI-COMM-LENGTH)
 10663*    END-EXEC.
 10664*    MOVE '.(CT                  ''   #00009435' TO DFHEIV0
 10665     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10666     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10667     MOVE X'2020233030303039343335' TO DFHEIV0(25:11)
 10668     CALL 'kxdfhei1' USING DFHEIV0,
 10669           TRANS-ID,
 10670           PROGRAM-INTERFACE-BLOCK,
 10671           PI-COMM-LENGTH,
 10672           DFHEIV99,
 10673           DFHEIV99,
 10674           DFHEIV99
 10675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10676
 10677
 10678
 10679* GOBACK.
 10680     MOVE '9%                    "   ' TO DFHEIV0
 10681     MOVE 'EL677' TO DFHEIV1
 10682     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10683     GOBACK.
 10684
 10685 9200-RETURN-MAIN-MENU.
 10686     MOVE XCTL-626               TO  PGM-NAME.
 10687     GO TO 9300-XCTL.
 10688
 10689 9300-XCTL.
 10690
 10691* EXEC CICS XCTL
 10692*        PROGRAM    (PGM-NAME)
 10693*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10694*        LENGTH     (PI-COMM-LENGTH)
 10695*    END-EXEC.
 10696*    MOVE '.$C                   %   #00009448' TO DFHEIV0
 10697     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10698     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10699     MOVE X'2020233030303039343438' TO DFHEIV0(25:11)
 10700     CALL 'kxdfhei1' USING DFHEIV0,
 10701           PGM-NAME,
 10702           PROGRAM-INTERFACE-BLOCK,
 10703           PI-COMM-LENGTH,
 10704           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 195
* EL677.cbl
 10705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10706
 10707
 10708 9400-CLEAR.
 10709     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10710     MOVE SPACES                 TO  PI-PFKEY.
 10711     GO TO 9300-XCTL.
 10712
 10713 9500-PF12.
 10714     MOVE XCTL-010               TO  PGM-NAME.
 10715     GO TO 9300-XCTL.
 10716
 10717 9600-PGMID-ERROR.
 10718
 10719* EXEC CICS HANDLE CONDITION
 10720*        PGMIDERR    (8300-SEND-TEXT)
 10721*    END-EXEC.
 10722*    MOVE '"$L                   ! 2 #00009464' TO DFHEIV0
 10723     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10725     MOVE X'3220233030303039343634' TO DFHEIV0(25:11)
 10726     CALL 'kxdfhei1' USING DFHEIV0
 10727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10728
 10729
 10730     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10731     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10732     MOVE XCTL-005               TO  PGM-NAME.
 10733     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10734     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10735
 10736     GO TO 9300-XCTL.
 10737
 10738 9900-ERROR-FORMAT.
 10739     IF NOT EMI-ERRORS-COMPLETE
 10740         MOVE LINK-001           TO  PGM-NAME
 10741
 10742* EXEC CICS LINK
 10743*            PROGRAM    (PGM-NAME)
 10744*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10745*            LENGTH     (EMI-COMM-LENGTH)
 10746*        END-EXEC.
 10747*    MOVE '."C                   (   #00009479' TO DFHEIV0
 10748     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10750     MOVE X'2020233030303039343739' TO DFHEIV0(25:11)
 10751     CALL 'kxdfhei1' USING DFHEIV0,
 10752           PGM-NAME,
 10753           ERROR-MESSAGE-INTERFACE-BLOCK,
 10754           EMI-COMM-LENGTH,
 10755           DFHEIV99,
 10756           DFHEIV99,
 10757           DFHEIV99,
 10758           DFHEIV99
 10759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10760
 10761
 10762 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 196
* EL677.cbl
 10763      EXIT.
 10764
 10765 9990-ABEND.
 10766     MOVE LINK-004               TO  PGM-NAME.
 10767     MOVE DFHEIBLK               TO  EMI-LINE1.
 10768
 10769* EXEC CICS LINK
 10770*        PROGRAM   (PGM-NAME)
 10771*        COMMAREA  (EMI-LINE1)
 10772*        LENGTH    (72)
 10773*    END-EXEC.
 10774     MOVE 72
 10775       TO DFHEIV11
 10776*    MOVE '."C                   (   #00009491' TO DFHEIV0
 10777     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10779     MOVE X'2020233030303039343931' TO DFHEIV0(25:11)
 10780     CALL 'kxdfhei1' USING DFHEIV0,
 10781           PGM-NAME,
 10782           EMI-LINE1,
 10783           DFHEIV11,
 10784           DFHEIV99,
 10785           DFHEIV99,
 10786           DFHEIV99,
 10787           DFHEIV99
 10788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10789
 10790
 10791     GO TO 8200-SEND-DATAONLY.
 10792
 10793 9995-SECURITY-VIOLATION.
 10794*                            COPY ELCSCTP.
 10795******************************************************************
 10796*                                                                *
 10797*                            ELCSCTP                             *
 10798*                            VMOD=2.001                          *
 10799*                                                                *
 10800*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10801******************************************************************
 10802
 10803
 10804     MOVE EIBDATE          TO SM-JUL-DATE.
 10805     MOVE EIBTRMID         TO SM-TERMID.
 10806     MOVE THIS-PGM         TO SM-PGM.
 10807     MOVE EIBTIME          TO TIME-IN.
 10808     MOVE TIME-OUT         TO SM-TIME.
 10809     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10810
 10811
 10812* EXEC CICS LINK
 10813*         PROGRAM  ('EL003')
 10814*         COMMAREA (SECURITY-MESSAGE)
 10815*         LENGTH   (80)
 10816*    END-EXEC.
 10817     MOVE 'EL003' TO DFHEIV1
 10818     MOVE 80
 10819       TO DFHEIV11
 10820*    MOVE '."C                   (   #00009517' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 197
* EL677.cbl
 10821     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10823     MOVE X'2020233030303039353137' TO DFHEIV0(25:11)
 10824     CALL 'kxdfhei1' USING DFHEIV0,
 10825           DFHEIV1,
 10826           SECURITY-MESSAGE,
 10827           DFHEIV11,
 10828           DFHEIV99,
 10829           DFHEIV99,
 10830           DFHEIV99,
 10831           DFHEIV99
 10832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10833
 10834
 10835******************************************************************
 10836
 10837
 10838 9995-EXIT.
 10839     EXIT.
 10840
 10841
 10842 9999-DFHBACK SECTION.
 10843     MOVE '9%                    "   ' TO DFHEIV0
 10844     MOVE 'EL677' TO DFHEIV1
 10845     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10846     GOBACK.
 10847 9999-DFHEXIT.
 10848     IF DFHEIGDJ EQUAL 0001
 10849         NEXT SENTENCE
 10850     ELSE IF DFHEIGDJ EQUAL 2
 10851         GO TO 9600-PGMID-ERROR,
 10852               9990-ABEND
 10853         DEPENDING ON DFHEIGDI
 10854     ELSE IF DFHEIGDJ EQUAL 3
 10855         GO TO 8100-SEND-INITIAL-MAP
 10856         DEPENDING ON DFHEIGDI
 10857     ELSE IF DFHEIGDJ EQUAL 4
 10858         GO TO 1290-NO-CARRIER
 10859         DEPENDING ON DFHEIGDI
 10860     ELSE IF DFHEIGDJ EQUAL 5
 10861         GO TO 1380-NO-STATE
 10862         DEPENDING ON DFHEIGDI
 10863     ELSE IF DFHEIGDJ EQUAL 6
 10864         GO TO 1480-ACCOUNT-INVALID,
 10865               1480-ACCOUNT-INVALID
 10866         DEPENDING ON DFHEIGDI
 10867     ELSE IF DFHEIGDJ EQUAL 7
 10868         GO TO 1590-EXIT
 10869         DEPENDING ON DFHEIGDI
 10870     ELSE IF DFHEIGDJ EQUAL 8
 10871         GO TO 2200-DUPREC
 10872         DEPENDING ON DFHEIGDI
 10873     ELSE IF DFHEIGDJ EQUAL 9
 10874         GO TO 3900-RECORD-NOTFND
 10875         DEPENDING ON DFHEIGDI
 10876     ELSE IF DFHEIGDJ EQUAL 10
 10877         GO TO 3287-DUPREC
 10878         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 20-Nov-19 08:04 Page 198
* EL677.cbl
 10879     ELSE IF DFHEIGDJ EQUAL 11
 10880         GO TO 3300-EXIT,
 10881               3300-EXIT
 10882         DEPENDING ON DFHEIGDI
 10883     ELSE IF DFHEIGDJ EQUAL 12
 10884         GO TO 5560-END-OF-FILE,
 10885               5560-END-OF-FILE
 10886         DEPENDING ON DFHEIGDI
 10887     ELSE IF DFHEIGDJ EQUAL 13
 10888         GO TO 6070-NO-COMP-MSTR
 10889         DEPENDING ON DFHEIGDI
 10890     ELSE IF DFHEIGDJ EQUAL 14
 10891         GO TO 6170-NO-CERTIFICATE
 10892         DEPENDING ON DFHEIGDI
 10893     ELSE IF DFHEIGDJ EQUAL 15
 10894         GO TO 6470-NO-ADDRESS
 10895         DEPENDING ON DFHEIGDI
 10896     ELSE IF DFHEIGDJ EQUAL 16
 10897         GO TO 6670-NO-beneficiary
 10898         DEPENDING ON DFHEIGDI
 10899     ELSE IF DFHEIGDJ EQUAL 17
 10900         GO TO 7300-EXIT
 10901         DEPENDING ON DFHEIGDI
 10902     ELSE IF DFHEIGDJ EQUAL 18
 10903         GO TO 8300-SEND-TEXT
 10904         DEPENDING ON DFHEIGDI.
 10905     MOVE '9%                    "   ' TO DFHEIV0
 10906     MOVE 'EL677' TO DFHEIV1
 10907     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10908     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      141524     Code:       40770
