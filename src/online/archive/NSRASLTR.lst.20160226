* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   1
* NSRASLTR.cbl
* Options: int("NSRASLTR.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASLTR.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASLTR.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRASLTR.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASLTR.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM INDEX.HTML
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   2
* NSRASLTR.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 080612    2011022800001  AJRA  ADD AHL
    16* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    17******************************************************************
    18 ENVIRONMENT DIVISION.
    19 DATA DIVISION.
    20 working-storage section.
    21 01  DFH-START PIC X(04).
    22 77  ws-comm-length      pic 9(4) BINARY.
    23 01  P pointer.
    24 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    25 01  WS-KIXHOST                  PIC X(10).
    26 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    27 01  var-ptr pointer.
    28 01  env-var-len                 pic 9(4)  binary.
    29 01  rc                          pic 9(9)  binary.
    30 01  bl-length                   pic s9(5) value +0 comp-3.
    31 01  sl-length                   pic 9(8) binary.
    32 01  WS-KIXSYS.
    33     05  WS-KIX-FIL1             PIC X(10).
    34     05  WS-KIX-APPS             PIC X(10).
    35     05  WS-KIX-ENV              PIC X(10).
    36     05  WS-KIX-MYENV            PIC X(10).
    37     05  WS-KIX-SYS              PIC X(10).
    38************************************************
    39* commarea passed to the business logic
    40************************************************
    41 01 srch-commarea.
    42*                                copy ELCADLTRSPI.
    43******************************************************************
    44*                   C H A N G E   L O G
    45*
    46* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    47*-----------------------------------------------------------------
    48*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    49* EFFECTIVE    NUMBER
    50*-----------------------------------------------------------------
    51* 060611    2011022800001  PEMA  NEW COPYBOOK
    52* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
    53* 110612    2012101700002  AJRA  EXPAND PASSED DATA
    54******************************************************************
    55****************************************
    56*  commarea for NaperSoft On Demand Admin services letters
    57*  (business logic input & output)
    58****************************************
    59     03  BL-INPUT.
    60         05  BL-DATA-SRCE        PIC X.
    61         05  BL-LETTER-ID        PIC XXXX.
    62         05  BL-CARRIER          PIC X.
    63         05  BL-GROUP            PIC X(6).
    64         05  BL-STATE            PIC XX.
    65         05  BL-ACCOUNT          PIC X(10).
    66         05  BL-EFF-DT           PIC X(10).
    67         05  BL-CERT-NO          PIC X(11).
    68         05  BL-BATCH-NO         PIC X(6).
    69         05  BL-BATCH-SEQ        PIC 9(8).
    70         05  BL-RESP-NO          PIC X(10).
    71         05  BL-NO-OF-COPIES     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   3
* NSRASLTR.cbl
    72         05  BL-PROC-ID          PIC XXXX.
    73         05  BL-COMP-ID          PIC XXX.
    74         05  BL-PRINT-NOW-SW     PIC X.
    75         05  BL-ENC-CD           PIC XXX.
    76         05  BL-RESEND-DT        PIC X(10).
    77         05  BL-FOLLOW-UP-DT     PIC X(10).
    78         05  BL-ARCHIVE-NO       PIC 9(8).
    79         05  BL-FUNC             PIC X(8).
    80         05  BL-COMMENTS         PIC X(100).
    81         05  FILLER REDEFINES BL-COMMENTS.
    82             10  BL-REASON-CODE OCCURS 12 PIC X(4).
    83             10  BL-LETTER-TO-ACCT PIC X.
    84             10  BL-LETTER-TO-BENE PIC X.
    85             10  BL-WRITE-ERARCH   PIC X.
    86                 88  ERARCH-QWS      VALUE 'Q'.
    87                 88  ERARCH-BATCH    VALUE 'B'.
    88                 88  ERARCH-TEMP     VALUE 'T'.
    89             10  BL-PROCESS-TYPE PIC X(07).
    90             10  BL-CERT-FORM-ID PIC X(05).
    91             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
    92             10  BL-SOURCE-SCREEN PIC X(8).
    93             10  FILLER          PIC X(25).
    94     03  BL-OUTPUT.
    95         05  BL-STATUS                   PIC X.
    96             88  BL-OK                      VALUE "P".
    97             88  BL-FAIL                  VALUE "F".
    98         05  BL-MESSAGE          PIC X(50).
    99     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   100     03  FILLER                  PIC X(31).
   101 01  INPUT-FROM-FORM.
   102     05  IFF-DATA-SRCE           PIC X.
   103     05  IFF-LETTER-ID           PIC XXXX.
   104     05  IFF-CARRIER             PIC X.
   105     05  IFF-GROUP               PIC X(6).
   106     05  IFF-STATE               PIC XX.
   107     05  IFF-ACCOUNT             PIC X(10).
   108     05  IFF-EFF-DT              PIC X(10).
   109     05  IFF-CERT-NO             PIC X(11).
   110     05  IFF-BATCH-NO            PIC X(6).
   111     05  IFF-BATCH-SEQ           PIC 9(8).
   112     05  IFF-RESP-NO             PIC X(10).
   113     05  IFF-NO-OF-COPIES        PIC 99.
   114     05  IFF-PROC-ID             PIC XXXX.
   115     05  IFF-COMP-ID             PIC XXX.
   116     05  IFF-PRINT-NOW-SW        PIC X.
   117     05  IFF-ENC-CD              PIC XXX.
   118     05  IFF-RESEND-DT           PIC X(10).
   119     05  IFF-FOLLOW-UP-DT        PIC X(10).
   120     05  IFF-ARCHIVE-NO          PIC 9(08).
   121     05  IFF-FUNC                PIC X(08).
   122*    05  IFF-COMMENTS            PIC X(70).
   123     05  IFF-ENDT-ARCH-NO        PIC 9(08).
   124************************************
   125* fields used to read web data
   126************************************
   127 01  w-form-name       pic x(80).
   128 01  w-form-value      pic x(80).
   129 01  w-form-name-len   pic s9(8) comp.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   4
* NSRASLTR.cbl
   130 01  w-form-value-len  pic s9(8) comp.
   131 01  w-resp            pic s9(8) comp.
   132 01  w-doctoken        pic x(16).
   133* COMP ID TPE REGION   GROUP NAME       HOST          HTTP PORT
   134*
   135*  CID      CID1P      AcctServCID     ntcso3            7001
   136*  CID      MDOFF      AcctServCID     ntnapersofttst    7003
   137*  CID      CID1T      AcctServCID     ntnapersofttst    6002
   138*  CID      PAUL       AcctServCID     ntnapersofttst    5002
   139*  CID      TONY       AcctServCID     ntnapersofttst    6003
   140*  DCC      CID1P      AcctServDCC     ntcso3            7001
   141*  DCC      MDOFF      AcctServDCC     ntnapersofttst    7003
   142*  DCC      CID1T      AcctServDCC     ntnapersofttst    6002
   143*  DCC      PAUL       AcctServDCC     ntnapersofttst    5002
   144*  DCC      TONY       AcctServDCC     ntnapersofttst    6003
   145*  AHL      CID1P      AcctServAHL     ntcso3            7001
   146*  AHL      MDOFF      AcctServAHL     ntnapersofttst    7003
   147*  AHL      CID1T      AcctServAHL     ntnapersofttst    6002
   148*  AHL      PAUL       AcctServAHL     ntnapersofttst    5002
   149*  AHL      TONY       AcctServAHL     ntnapersofttst    6003
   150******************************************
   151* symbol list text for ASERR template
   152******************************************
   153 01  WS-ASERR.
   154     05  F                       PIC X(6)  VALUE "PGMDT=".
   155     05  ASERR-DT                PIC X(12) VALUE ' '.
   156     05  F                       PIC X(5)  VALUE '&MSG='.
   157     05  ASERR-MESS              PIC X(50) VALUE ' '.
   158******************************************
   159* symbol list text for ASHDR template
   160******************************************
   161 01  WS-PROD-CID-ASHDR.
   162     05  F                       PIC X(7)  VALUE "SERVER=".
   163     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   164     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   165     05  F                       PIC X(11) VALUE 'AcctServCID'.
   166     05  F                       PIC X(7)  VALUE '&UNAME='.
   167     05  F                       PIC X(8)  VALUE 'batchjob'.
   168     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   169     05  F                       PIC X(8)  VALUE 'batchjob'.
   170 01  WS-PROD-DCC-ASHDR.
   171     05  F                       PIC X(7)  VALUE "SERVER=".
   172     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   173     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   174     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   175     05  F                       PIC X(7)  VALUE '&UNAME='.
   176     05  F                       PIC X(8)  VALUE 'batchjob'.
   177     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   178     05  F                       PIC X(8)  VALUE 'batchjob'.
   179 01  WS-PROD-AHL-ASHDR.
   180     05  F                       PIC X(7)  VALUE "SERVER=".
   181     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   182     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   183     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   184     05  F                       PIC X(7)  VALUE '&UNAME='.
   185     05  F                       PIC X(8)  VALUE 'batchjob'.
   186     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   187     05  F                       PIC X(8)  VALUE 'batchjob'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   5
* NSRASLTR.cbl
   188 01  WS-TEST-CID-ASHDR.
   189     05  F                       PIC X(7)  VALUE "SERVER=".
   190     05  F                       PIC X(19) VALUE
   191                          'ntnapersofttst:8080'.
   192     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   193     05  F                       PIC X(11) VALUE 'AcctServCID'.
   194     05  F                       PIC X(7)  VALUE '&UNAME='.
   195     05  F                       PIC X(8)  VALUE 'batchjob'.
   196     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   197     05  F                       PIC X(8)  VALUE 'batchjob'.
   198 01  WS-TEST-DCC-ASHDR.
   199     05  F                       PIC X(7)  VALUE "SERVER=".
   200     05  F                       PIC X(19) VALUE
   201                            'ntnapersofttst:8080'.
   202     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   203     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   204     05  F                       PIC X(7)  VALUE '&UNAME='.
   205     05  F                       PIC X(8)  VALUE 'batchjob'.
   206     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   207     05  F                       PIC X(8)  VALUE 'batchjob'.
   208
   209 01  WS-TEST-AHL-ASHDR.
   210     05  F                       PIC X(7)  VALUE "SERVER=".
   211     05  F                       PIC X(19) VALUE
   212                            'ntnapersofttst:8080'.
   213     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   214     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   215     05  F                       PIC X(7)  VALUE '&UNAME='.
   216     05  F                       PIC X(8)  VALUE 'batchjob'.
   217     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   218     05  F                       PIC X(8)  VALUE 'batchjob'.
   219******************************************
   220* symbol list text for ASFTR template
   221******************************************
   222 01  WS-VAR-SLUNIKIX.
   223     05  FILLER                  PIC X(18) VALUE
   224                                 "HOSTINFO=slunikix:".
   225     05  WS-SL-PORT              PIC XXXX  VALUE '7001'.
   226     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   227     05  WS-SL-KEY               PIC X(20)  VALUE SPACES.
   228*    05  FILLER                  PIC X(20) VALUE
   229*                                "&HOSTINFO2=slunikix:".
   230*    05  WS-SL-PORT2             PIC XXXX  VALUE '7001'.
   231*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   232*    05  WS-SL-KEY2              PIC X(12)  VALUE SPACES.
   233 01  WS-VAR-LOGICTEST.
   234     05  FILLER                  PIC X(19) VALUE
   235                                 "HOSTINFO=logictest:".
   236     05  WS-LT-PORT              PIC XXXX  VALUE '6002'.
   237     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   238     05  WS-LT-KEY               PIC X(20)  VALUE SPACES.
   239*    05  FILLER                  PIC X(21) VALUE
   240*                                "&HOSTINFO2=logictest:".
   241*    05  WS-LT-PORT2             PIC XXXX  VALUE '6002'.
   242*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   243*    05  WS-LT-KEY2              PIC X(12)  VALUE SPACES.
   244 01 WS-ASFTR.
   245    05  OT-COMP-ID           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   6
* NSRASLTR.cbl
   246    05  OT-PRINT-NOW-SW      PIC X.
   247    05  OT-ARCHIVE-NO        PIC 9(08).
   248    05  OT-FUNC              PIC X(08).
   249 01 output-msg.
   250    05 filler              pic x(4) value "MSG=".
   251    05 out-msg-text        pic x(50).
   252 01  MISC.
   253     12  WS-RESPONSE             PIC S9(8)   COMP.
   254         88  RESP-NORMAL                  VALUE +00.
   255         88  RESP-NOTFND                  VALUE +13.
   256         88  RESP-DUPREC                  VALUE +14.
   257         88  RESP-DUPKEY                  VALUE +15.
   258         88  RESP-NOTOPEN                 VALUE +19.
   259         88  RESP-ENDFILE                 VALUE +20.
   260*                                COPY ELCDATE.
   261******************************************************************
   262*                                                                *
   263*                                                                *
   264*                            ELCDATE.                            *
   265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   266*                            VMOD=2.003
   267*                                                                *
   268*                                                                *
   269*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   270*                 LENGTH = 200                                   *
   271******************************************************************
   272
   273 01  DATE-CONVERSION-DATA.
   274     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   275     12  DC-OPTION-CODE                PIC X.
   276         88  BIN-TO-GREG                VALUE ' '.
   277         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   278         88  EDIT-GREG-TO-BIN           VALUE '2'.
   279         88  YMD-GREG-TO-BIN            VALUE '3'.
   280         88  MDY-GREG-TO-BIN            VALUE '4'.
   281         88  JULIAN-TO-BIN              VALUE '5'.
   282         88  BIN-PLUS-ELAPSED           VALUE '6'.
   283         88  FIND-CENTURY               VALUE '7'.
   284         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   285         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   286         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   287         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   288         88  JULIAN-TO-BIN-3            VALUE 'C'.
   289         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   290         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   291         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   292         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   293         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   294         88  CHECK-LEAP-YEAR            VALUE 'H'.
   295         88  BIN-3-TO-GREG              VALUE 'I'.
   296         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   297         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   298         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   299         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   300         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   301         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   302         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   303         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   7
* NSRASLTR.cbl
   304         88  THREE-CHARACTER-BIN
   305                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   306         88  GREGORIAN-TO-BIN
   307                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   308         88  BIN-TO-GREGORIAN
   309                  VALUES ' ' '1' 'I' '8' 'G'.
   310         88  JULIAN-TO-BINARY
   311                  VALUES '5' 'C' 'E' 'F'.
   312     12  DC-ERROR-CODE                 PIC X.
   313         88  NO-CONVERSION-ERROR        VALUE ' '.
   314         88  DATE-CONVERSION-ERROR
   315                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   316         88  DATE-IS-ZERO               VALUE '1'.
   317         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   318         88  DATE-IS-INVALID            VALUE '3'.
   319         88  DATE1-GREATER-DATE2        VALUE '4'.
   320         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   321         88  DATE-INVALID-OPTION        VALUE '9'.
   322         88  INVALID-CENTURY            VALUE 'A'.
   323         88  ONLY-CENTURY               VALUE 'B'.
   324         88  ONLY-LEAP-YEAR             VALUE 'C'.
   325         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   326     12  DC-END-OF-MONTH               PIC X.
   327         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   328     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   329         88  USE-NORMAL-PROCESS         VALUE ' '.
   330         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   331         88  ADJUST-UP-100-YRS          VALUE '2'.
   332     12  FILLER                        PIC X.
   333     12  DC-CONVERSION-DATES.
   334         16  DC-BIN-DATE-1             PIC XX.
   335         16  DC-BIN-DATE-2             PIC XX.
   336         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   337         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   338                       DC-GREG-DATE-1-EDIT.
   339             20  DC-EDIT1-MONTH        PIC 99.
   340             20  SLASH1-1              PIC X.
   341             20  DC-EDIT1-DAY          PIC 99.
   342             20  SLASH1-2              PIC X.
   343             20  DC-EDIT1-YEAR         PIC 99.
   344         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   345         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   346                     DC-GREG-DATE-2-EDIT.
   347             20  DC-EDIT2-MONTH        PIC 99.
   348             20  SLASH2-1              PIC X.
   349             20  DC-EDIT2-DAY          PIC 99.
   350             20  SLASH2-2              PIC X.
   351             20  DC-EDIT2-YEAR         PIC 99.
   352         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   353         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   354                     DC-GREG-DATE-1-YMD.
   355             20  DC-YMD-YEAR           PIC 99.
   356             20  DC-YMD-MONTH          PIC 99.
   357             20  DC-YMD-DAY            PIC 99.
   358         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   359         16  DC-GREG-DATE-1-MDY-R REDEFINES
   360                      DC-GREG-DATE-1-MDY.
   361             20  DC-MDY-MONTH          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   8
* NSRASLTR.cbl
   362             20  DC-MDY-DAY            PIC 99.
   363             20  DC-MDY-YEAR           PIC 99.
   364         16  DC-GREG-DATE-1-ALPHA.
   365             20  DC-ALPHA-MONTH        PIC X(10).
   366             20  DC-ALPHA-DAY          PIC 99.
   367             20  FILLER                PIC XX.
   368             20  DC-ALPHA-CENTURY.
   369                 24 DC-ALPHA-CEN-N     PIC 99.
   370             20  DC-ALPHA-YEAR         PIC 99.
   371         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   372         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   373         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   374         16  DC-JULIAN-DATE            PIC 9(05).
   375         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   376                                       PIC 9(05).
   377         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   378             20  DC-JULIAN-YEAR        PIC 99.
   379             20  DC-JULIAN-DAYS        PIC 999.
   380         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   381         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   382         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   383     12  DATE-CONVERSION-VARIBLES.
   384         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   385         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   386             20  FILLER                PIC 9(3).
   387             20  HOLD-CEN-1-CCYY.
   388                 24  HOLD-CEN-1-CC     PIC 99.
   389                 24  HOLD-CEN-1-YY     PIC 99.
   390             20  HOLD-CEN-1-MO         PIC 99.
   391             20  HOLD-CEN-1-DA         PIC 99.
   392         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   393             20  HOLD-CEN-1-R-MO       PIC 99.
   394             20  HOLD-CEN-1-R-DA       PIC 99.
   395             20  HOLD-CEN-1-R-CCYY.
   396                 24  HOLD-CEN-1-R-CC   PIC 99.
   397                 24  HOLD-CEN-1-R-YY   PIC 99.
   398             20  FILLER                PIC 9(3).
   399         16  HOLD-CENTURY-1-X.
   400             20  FILLER                PIC X(3)  VALUE SPACES.
   401             20  HOLD-CEN-1-X-CCYY.
   402                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   403                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   404             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   405             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   406         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   407             20  HOLD-CEN-1-R-X-MO     PIC XX.
   408             20  HOLD-CEN-1-R-X-DA     PIC XX.
   409             20  HOLD-CEN-1-R-X-CCYY.
   410                 24  HOLD-CEN-1-R-X-CC PIC XX.
   411                 24  HOLD-CEN-1-R-X-YY PIC XX.
   412             20  FILLER                PIC XXX.
   413         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   414         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   415         16  DC-JULIAN-DATE-1          PIC 9(07).
   416         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   417             20  DC-JULIAN-1-CCYY.
   418                 24  DC-JULIAN-1-CC    PIC 99.
   419                 24  DC-JULIAN-1-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page   9
* NSRASLTR.cbl
   420             20  DC-JULIAN-DA-1        PIC 999.
   421         16  DC-JULIAN-DATE-2          PIC 9(07).
   422         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   423             20  DC-JULIAN-2-CCYY.
   424                 24  DC-JULIAN-2-CC    PIC 99.
   425                 24  DC-JULIAN-2-YR    PIC 99.
   426             20  DC-JULIAN-DA-2        PIC 999.
   427         16  DC-GREG-DATE-A-EDIT.
   428             20  DC-EDITA-MONTH        PIC 99.
   429             20  SLASHA-1              PIC X VALUE '/'.
   430             20  DC-EDITA-DAY          PIC 99.
   431             20  SLASHA-2              PIC X VALUE '/'.
   432             20  DC-EDITA-CCYY.
   433                 24  DC-EDITA-CENT     PIC 99.
   434                 24  DC-EDITA-YEAR     PIC 99.
   435         16  DC-GREG-DATE-B-EDIT.
   436             20  DC-EDITB-MONTH        PIC 99.
   437             20  SLASHB-1              PIC X VALUE '/'.
   438             20  DC-EDITB-DAY          PIC 99.
   439             20  SLASHB-2              PIC X VALUE '/'.
   440             20  DC-EDITB-CCYY.
   441                 24  DC-EDITB-CENT     PIC 99.
   442                 24  DC-EDITB-YEAR     PIC 99.
   443         16  DC-GREG-DATE-CYMD         PIC 9(08).
   444         16  DC-GREG-DATE-CYMD-R REDEFINES
   445                              DC-GREG-DATE-CYMD.
   446             20  DC-CYMD-CEN           PIC 99.
   447             20  DC-CYMD-YEAR          PIC 99.
   448             20  DC-CYMD-MONTH         PIC 99.
   449             20  DC-CYMD-DAY           PIC 99.
   450         16  DC-GREG-DATE-MDCY         PIC 9(08).
   451         16  DC-GREG-DATE-MDCY-R REDEFINES
   452                              DC-GREG-DATE-MDCY.
   453             20  DC-MDCY-MONTH         PIC 99.
   454             20  DC-MDCY-DAY           PIC 99.
   455             20  DC-MDCY-CEN           PIC 99.
   456             20  DC-MDCY-YEAR          PIC 99.
   457    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   458        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   459    12  DC-EL310-DATE                  PIC X(21).
   460    12  FILLER                         PIC X(28).
   461*****************************************
   462* symbol list for the ASBOD template
   463*****************************************
   464*                                COPY NSCASVARS.
   465******************************************************************
   466*                   C H A N G E   L O G
   467*
   468* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   469*-----------------------------------------------------------------
   470*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   471* EFFECTIVE    NUMBER
   472*-----------------------------------------------------------------
   473* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
   474* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
   475******************************************************************
   476 01 NAPER-OUTPUT-DATA.
   477    05  F                       PIC X(07) VALUE "LETTER=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  10
* NSRASLTR.cbl
   478    05  OUT-LETTER              PIC X(06) VALUE SPACES.
   479    05  F                       PIC X(08) VALUE "~PROCID=".
   480    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
   481    05  F                       PIC X(10) VALUE "~PROCNAME=".
   482    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
   483    05  F                       PIC X(11) VALUE "~PROCTITLE=".
   484    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
   485    05  F                       PIC X(09) VALUE "~CSRNAME=".
   486    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
   487    05  F                       PIC X(10) VALUE "~CSRTITLE=".
   488    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
   489    05  F                       PIC X(06) VALUE "~CARR=".
   490    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
   491    05  F                       PIC X(10) VALUE "~GROUPING=".
   492    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
   493    05  F                       PIC X(08) VALUE "~CERTST=".
   494    05  OUT-STATE               PIC X(02) VALUE SPACES.
   495    05  F                       PIC X(09) VALUE "~ACCOUNT=".
   496    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
   497    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
   498    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
   499    05  F                       PIC X(07) VALUE "~CRTNO=".
   500    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
   501    05  F                       PIC X(08) VALUE "~CRTSUF=".
   502    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
   503    05  F                       PIC X(08) VALUE "~ILNAME=".
   504    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
   505    05  F                       PIC X(08) VALUE "~IFNAME=".
   506    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
   507    05  F                       PIC X(08) VALUE "~IFINIT=".
   508    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
   509    05  F                       PIC X(08) VALUE "~IMINIT=".
   510    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
   511    05  F                       PIC X(09) VALUE "~IISSAGE=".
   512    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
   513    05  F                       PIC X(06) VALUE "~ISEX=".
   514    05  OUT-ISEX                PIC X(01) VALUE SPACES.
   515    05  F                       PIC X(10) VALUE "~INSADDR1=".
   516    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
   517    05  F                       PIC X(10) VALUE "~INSADDR2=".
   518    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
   519    05  F                       PIC X(09) VALUE "~INSCITY=".
   520    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
   521    05  F                       PIC X(10) VALUE "~INSSTATE=".
   522    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
   523    05  F                       PIC X(08) VALUE "~INSZIP=".
   524    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
   525    05  F                       PIC X(05) VALUE "~SSN=".
   526    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
   527    05  F                       PIC X(07) VALUE "~MEMNO=".
   528    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
   529    05  F                       PIC X(08) VALUE "~JLNAME=".
   530    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
   531    05  F                       PIC X(08) VALUE "~JFNAME=".
   532    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
   533    05  F                       PIC X(08) VALUE "~JMINIT=".
   534    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
   535    05  F                       PIC X(08) VALUE "~JNTAGE=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  11
* NSRASLTR.cbl
   536    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
   537    05  F                       PIC X(10) VALUE "~ACCTNAME=".
   538    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
   539    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
   540    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
   541    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
   542    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
   543    05  F                       PIC X(10) VALUE "~ACCTCITY=".
   544    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
   545    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
   546    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
   547    05  F                       PIC X(09) VALUE "~ACCTZIP=".
   548    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
   549    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
   550    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
   551    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
   552    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
   553    05  F                       PIC X(09) VALUE "~BUSTYPE=".
   554    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
   555    05  F                       PIC X(10) VALUE "~BENENAME=".
   556    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
   557    05  F                       PIC X(11) VALUE "~BENEADDR1=".
   558    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
   559    05  F                       PIC X(11) VALUE "~BENEADDR2=".
   560    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
   561    05  F                       PIC X(10) VALUE "~BENECITY=".
   562    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
   563    05  F                       PIC X(11) VALUE "~BENESTATE=".
   564    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
   565    05  F                       PIC X(09) VALUE "~BENEZIP=".
   566    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
   567    05  F                       PIC X(10) VALUE "~CARRNAME=".
   568    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
   569    05  F                       PIC X(08) VALUE "~RESPNO=".
   570    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
   571    05  F                       PIC X(12) VALUE "~COACCTNAME=".
   572    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
   573    05  F                       PIC X(12) VALUE "~COMAILNAME=".
   574    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
   575    05  F                       PIC X(11) VALUE "~COMPADDR1=".
   576    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
   577    05  F                       PIC X(11) VALUE "~COMPADDR2=".
   578    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
   579    05  F                       PIC X(10) VALUE "~COMPCITY=".
   580    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
   581    05  F                       PIC X(11) VALUE "~COMPSTATE=".
   582    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
   583    05  F                       PIC X(09) VALUE "~COMPZIP=".
   584    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
   585    05  F                       PIC X(11) VALUE "~COMPPHONE=".
   586    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
   587    05  F                       PIC X(09) VALUE "~COMPFAX=".
   588    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
   589    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
   590    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
   591    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
   592    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
   593    05  F                       PIC X(08) VALUE "~RPTCD1=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  12
* NSRASLTR.cbl
   594    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
   595    05  F                       PIC X(08) VALUE "~RPTCD2=".
   596    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
   597    05  F                       PIC X(09) VALUE "~ENTRYDT=".
   598    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
   599    05  F                       PIC X(07) VALUE "~BATCH=".
   600    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
   601    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
   602    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
   603    05  F                       PIC X(10) VALUE "~1STPMTDT=".
   604    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
   605    05  F                       PIC X(05) VALUE "~APR=".
   606    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
   607    05  F                       PIC X(08) VALUE "~LNTERM=".
   608    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
   609    05  F                       PIC X(11) VALUE "~RATECLASS=".
   610    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
   611    05  F                       PIC X(09) VALUE "~EXTDAYS=".
   612    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
   613    05  F                       PIC X(09) VALUE "~CSRCODE=".
   614    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
   615    05  F                       PIC X(07) VALUE "~UCODE=".
   616    05  OUT-UCODE               PIC X(01) VALUE SPACES.
   617    05  F                       PIC X(10) VALUE "~PREMTYPE=".
   618    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
   619    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
   620    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
   621    05  F                       PIC X(06) VALUE "~SKIP=".
   622    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
   623    05  F                       PIC X(06) VALUE "~MODE=".
   624    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
   625    05  F                       PIC X(09) VALUE "~LOANOFF=".
   626    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
   627    05  F                       PIC X(06) VALUE "~RTBL=".
   628    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
   629    05  F                       PIC X(10) VALUE "~SPECREIN=".
   630    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
   631    05  F                       PIC X(09) VALUE "~LFBENCD=".
   632    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
   633    05  F                       PIC X(08) VALUE "~LFTERM=".
   634    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
   635    05  F                       PIC X(07) VALUE "~LFDEV=".
   636    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
   637    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
   638    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
   639    05  F                       PIC X(07) VALUE "~LFBEN=".
   640    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
   641    05  F                       PIC X(08) VALUE "~LFPREM=".
   642    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   643    05  F                       PIC X(08) VALUE "~LFABEN=".
   644    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   645    05  F                       PIC X(09) VALUE "~LFAPREM=".
   646    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
   647    05  F                       PIC X(07) VALUE "~LFNSP=".
   648    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   649    05  F                       PIC X(08) VALUE "~LFRBEN=".
   650    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   651    05  F                       PIC X(07) VALUE "~LFCAN=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  13
* NSRASLTR.cbl
   652    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
   653    05  F                       PIC X(07) VALUE "~LFDTH=".
   654    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
   655    05  F                       PIC X(08) VALUE "~LFRATE=".
   656    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   657    05  F                       PIC X(09) VALUE "~LFARATE=".
   658    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
   659    05  F                       PIC X(09) VALUE "~LFEXPDT=".
   660    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
   661    05  F                       PIC X(08) VALUE "~LFSTAT=".
   662    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
   663    05  F                       PIC X(09) VALUE "~LFCANDT=".
   664    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
   665    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
   666    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   667    05  F                       PIC X(07) VALUE "~DTHDT=".
   668    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
   669    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
   670    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
   671    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
   672    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
   673    05  F                       PIC X(08) VALUE "~LFCOMM=".
   674    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   675    05  F                       PIC X(11) VALUE "~LFBENDESC=".
   676    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
   677    05  F                       PIC X(11) VALUE "~LFBENABRV=".
   678    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
   679    05  F                       PIC X(09) VALUE "~AHBENCD=".
   680    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
   681    05  F                       PIC X(08) VALUE "~AHTERM=".
   682    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
   683    05  F                       PIC X(11) VALUE "~AHCRITPER=".
   684    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
   685    05  F                       PIC X(09) VALUE "~AHDEVCD=".
   686    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
   687    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
   688    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
   689    05  F                       PIC X(07) VALUE "~AHBEN=".
   690    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
   691    05  F                       PIC X(08) VALUE "~AHPREM=".
   692    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   693    05  F                       PIC X(07) VALUE "~AHNSP=".
   694    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   695    05  F                       PIC X(07) VALUE "~AHCAN=".
   696    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
   697    05  F                       PIC X(10) VALUE "~AHITDPMT=".
   698    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
   699    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
   700    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   701    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
   702    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
   703    05  F                       PIC X(08) VALUE "~AHRATE=".
   704    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   705    05  F                       PIC X(09) VALUE "~AHEXPDT=".
   706    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
   707    05  F                       PIC X(08) VALUE "~AHSTAT=".
   708    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
   709    05  F                       PIC X(09) VALUE "~AHCANDT=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  14
* NSRASLTR.cbl
   710    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
   711    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
   712    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   713    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
   714    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
   715    05  F                       PIC X(08) VALUE "~AHCOMM=".
   716    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   717    05  F                       PIC X(11) VALUE "~AHBENDESC=".
   718    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
   719    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
   720    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
   721    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
   722    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
   723    05  F                       PIC X(08) VALUE "~AHWAIT=".
   724    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
   725    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
   726    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
   727    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
   728                                PIC X(2).
   729    05  F                       PIC X(09) VALUE "~TOTPREM=".
   730    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
   731    05  F                       PIC X(08) VALUE "~TOTREF=".
   732    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
   733    05  F                       PIC X(08) VALUE "~SEXPDT=".
   734    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
   735    05  F                       PIC X(07) VALUE "~STERM=".
   736    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
   737    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
   738    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
   739    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
   740    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
   741    05  F                       PIC X(11) VALUE "~IORIGINIT=".
   742    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
   743    05  F                       PIC X(10) VALUE "~IORIGAGE=".
   744    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
   745    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
   746    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
   747    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
   748    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
   749    05  F                       PIC X(11) VALUE "~JORIGINIT=".
   750    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
   751    05  F                       PIC X(10) VALUE "~JORIGAGE=".
   752    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
   753    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
   754    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
   755    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
   756    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
   757    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
   758    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
   759    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
   760                                PIC X(12).
   761    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
   762    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
   763    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
   764                                PIC X(12).
   765    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
   766    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
   767    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  15
* NSRASLTR.cbl
   768    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
   769    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
   770    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   771    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
   772    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
   773    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
   774                                PIC X(12).
   775    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
   776    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
   777    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
   778                                PIC X(10).
   779    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
   780    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
   781    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
   782    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
   783    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
   784    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
   785    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
   786    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
   787    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
   788    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
   789    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
   790    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
   791    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
   792                                PIC X(10).
   793    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
   794    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
   795    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
   796                                PIC X(10).
   797    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
   798    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
   799    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
   800    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
   801    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
   802    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   803    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
   804    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
   805    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
   806    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
   807    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
   808    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
   809    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
   810    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
   811    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
   812    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
   813    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
   814    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
   815    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
   816                                PIC X(2).
   817    05  F                       PIC X(09) VALUE "~OSEXPDT=".
   818    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
   819    05  F                       PIC X(08) VALUE "~OSTERM=".
   820    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
   821    05  F                       PIC X(11) VALUE "~INEWLNAME=".
   822    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
   823    05  F                       PIC X(11) VALUE "~INEWFNAME=".
   824    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
   825    05  F                       PIC X(10) VALUE "~INEWINIT=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  16
* NSRASLTR.cbl
   826    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
   827    05  F                       PIC X(09) VALUE "~INEWAGE=".
   828    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
   829    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
   830                                PIC X(09).
   831    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
   832    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
   833    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
   834    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
   835    05  F                       PIC X(10) VALUE "~JNEWINIT=".
   836    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
   837    05  F                       PIC X(09) VALUE "~JNEWAGE=".
   838    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
   839    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
   840                                PIC X(09).
   841    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
   842    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
   843    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
   844    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
   845    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
   846                                PIC X(09).
   847    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
   848    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
   849    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
   850                                PIC X(12).
   851    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
   852    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
   853    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
   854                                PIC X(10).
   855    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
   856    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
   857    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
   858    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
   859    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
   860                                PIC X(12).
   861    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
   862    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
   863    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
   864                                PIC X(10).
   865    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
   866    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
   867    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
   868    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
   869    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
   870    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
   871    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
   872    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
   873    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
   874                                PIC X(09).
   875    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
   876    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
   877    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
   878                                PIC X(09).
   879    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
   880    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
   881    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
   882                                PIC X(10).
   883    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  17
* NSRASLTR.cbl
   884    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
   885    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
   886                                PIC X(10).
   887    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
   888    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
   889    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
   890    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
   891    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
   892    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
   893    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
   894    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
   895    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
   896    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
   897    05  F                       PIC X(09) VALUE "~NEWWAIT=".
   898    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
   899    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
   900    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
   901    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
   902                                PIC X(09).
   903    05  F                       PIC X(09) VALUE "~NSEXPDT=".
   904    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
   905    05  F                       PIC X(08) VALUE "~NSTERM=".
   906    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
   907    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
   908                                PIC X(09).
   909    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
   910    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
   911    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
   912    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
   913    05  F                       PIC X(11) VALUE "~PAYABLETO=".
   914    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
   915    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
   916    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
   917    05  F                       PIC X(09) VALUE "~BALLOON=".
   918    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
   919    05  F                       PIC X(10) VALUE "~LEASEIND=".
   920    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
   921    05  F                       PIC X(09) VALUE "~RESCIND=".
   922    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
   923    05  F                       PIC X(07) VALUE "~RCD01=".
   924    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
   925    05  F                       PIC X(07) VALUE "~RCD02=".
   926    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
   927    05  F                       PIC X(07) VALUE "~RCD03=".
   928    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
   929    05  F                       PIC X(07) VALUE "~RCD04=".
   930    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
   931    05  F                       PIC X(07) VALUE "~RCD05=".
   932    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
   933    05  F                       PIC X(07) VALUE "~RCD06=".
   934    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
   935    05  F                       PIC X(07) VALUE "~RCD07=".
   936    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
   937    05  F                       PIC X(07) VALUE "~RCD08=".
   938    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
   939    05  F                       PIC X(07) VALUE "~RCD09=".
   940    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
   941    05  F                       PIC X(07) VALUE "~RCD10=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  18
* NSRASLTR.cbl
   942    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
   943    05  F                       PIC X(07) VALUE "~RCD11=".
   944    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
   945    05  F                       PIC X(07) VALUE "~RCD12=".
   946    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
   947    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
   948    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
   949    05  F                       PIC X(08) VALUE "~ARCHNO=".
   950    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
   951    05  F                       PIC X(06) VALUE "~FORM=".
   952    05  OUT-FORM                PIC X(03) VALUE SPACES.
   953    05  F                       PIC X(09) VALUE "~ENCLINE=".
   954    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
   955    05  F                       PIC X(08) VALUE "~ATTACH=".
   956    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
   957    05  F                       PIC X(10) VALUE "~OUTSTACK=".
   958    05  OUT-STACK               PIC X(10) VALUE SPACES.
   959    05  F                       PIC X(11) VALUE "~STATENAME=".
   960    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
   961    05  F                       PIC X(08) VALUE "~PRTNOW=".
   962    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
   963    05  F                       PIC X(05) VALUE "~NCB=".
   964    05  OUT-CHGBACK             PIC X     VALUE ' '.
   965    05  F                       PIC X(8) VALUE "~CSOAMT=".
   966    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
   967    05  F                       PIC X(9) VALUE "~ACCTAMT=".
   968    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
   969    05  F                       PIC X(09) VALUE "~LETRTYP=".
   970    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
   971    05  F                       PIC X(10) VALUE "~PRNTCERT=".
   972    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
   973    05  F                       PIC X(08) VALUE "~INSBDT=".
   974    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
   975    05  F                       PIC X(08) VALUE "~JNTBDT=".
   976    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
   977    05  F                       PIC X(08) VALUE "~TOTINT=".
   978    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
   979    05  F                       PIC X(8) VALUE "~TOPREM=".
   980    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
   981    05  F                       PIC X(7) VALUE "~TOREF=".
   982    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
   983    05  F                       PIC X(7) VALUE "~CANDT=".
   984    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
   985    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
   986    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
   987    05  F                       PIC X(08) VALUE "~CERTID=".
   988    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
   989    05  F                       PIC X(08) VALUE "~UNDWID=".
   990    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
   991    05  F                       PIC X(8) VALUE "~TNPREM=".
   992    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
   993    05  F                       PIC X(7) VALUE "~TNREF=".
   994    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
   995    05  F                       PIC X(8)  VALUE "~COVIND=".
   996    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
   997    05  F                       PIC X(9)  VALUE "~OCOVIND=".
   998    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
   999    05  F                       PIC X(9)  VALUE "~NCOVIND=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  19
* NSRASLTR.cbl
  1000    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  1001    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  1002    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  1003    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  1004    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  1005    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  1006    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  1007    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  1008                                PIC X(10).
  1009    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  1010    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  1011    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  1012    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  1013    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  1014    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  1015    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  1016    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  1017    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  1018    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  1019    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  1020    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  1021    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  1022    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  1023    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  1024    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1025    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  1026    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1027    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  1028    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  1029    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  1030    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  1031    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  1032    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1033    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  1034    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1035    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  1036    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  1037    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  1038    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  1039    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  1040    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1041    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  1042    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1043    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  1044    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  1045    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  1046    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  1047    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  1048    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1049    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  1050    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1051    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  1052    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1053    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  1054    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  1055    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  1056    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  1057    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  20
* NSRASLTR.cbl
  1058    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1059    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  1060    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1061    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  1062    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1063    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  1064    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  1065    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  1066    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  1067    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  1068    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1069    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  1070    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1071    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  1072    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1073    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  1074    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  1075    05  F                       PIC X(09) VALUE "~CSONAMT=".
  1076    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  1077    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  1078    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  1079    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  1080    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1081    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  1082    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1083    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  1084    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  1085    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  1086    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  1087    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  1088    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  1089    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  1090    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1091    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  1092    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1093    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  1094    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  1095    05  F                       PIC X(08) VALUE "~CSOCHG=".
  1096    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  1097    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  1098    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  1099    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  1100    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  1101    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  1102    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  1103    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  1104    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  1105    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  1106    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  1107    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  1108    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  1109    05  F                       PIC X(8)  VALUE "~SCREEN=".
  1110    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  1111    05  F                       PIC X(11) VALUE 'EndOfString'.
  1112    05  f                       pic x(12) value spaces.
  1113****************************************************************
  1114*
  1115* Copyright (c) 2007 by Clerity Solutions, Inc.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  21
* NSRASLTR.cbl
  1116* All rights reserved.
  1117*
  1118****************************************************************
  1119 01  DFHEIV.
  1120   02  DFHEIV0               PIC X(35).
  1121   02  DFHEIV1               PIC X(08).
  1122   02  DFHEIV2               PIC X(08).
  1123   02  DFHEIV3               PIC X(08).
  1124   02  DFHEIV4               PIC X(06).
  1125   02  DFHEIV5               PIC X(04).
  1126   02  DFHEIV6               PIC X(04).
  1127   02  DFHEIV7               PIC X(02).
  1128   02  DFHEIV8               PIC X(02).
  1129   02  DFHEIV9               PIC X(01).
  1130   02  DFHEIV10              PIC S9(7) COMP-3.
  1131   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1132   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1133   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1134   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1135   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1136   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1137   02  DFHEIV17              PIC X(04).
  1138   02  DFHEIV18              PIC X(04).
  1139   02  DFHEIV19              PIC X(04).
  1140   02  DFHEIV20              USAGE IS POINTER.
  1141   02  DFHEIV21              USAGE IS POINTER.
  1142   02  DFHEIV22              USAGE IS POINTER.
  1143   02  DFHEIV23              USAGE IS POINTER.
  1144   02  DFHEIV24              USAGE IS POINTER.
  1145   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1146   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1147   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1148   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1149   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1150   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1151   02  FILLER                PIC X(02).
  1152   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1153   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1154   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1155   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1156   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1157 LINKAGE  SECTION.
  1158*****************************************************************
  1159*                                                               *
  1160* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1161* All rights reserved.                                          *
  1162*                                                               *
  1163*****************************************************************
  1164 01  dfheiblk.
  1165     02  eibtime          pic s9(7) comp-3.
  1166     02  eibdate          pic s9(7) comp-3.
  1167     02  eibtrnid         pic x(4).
  1168     02  eibtaskn         pic s9(7) comp-3.
  1169     02  eibtrmid         pic x(4).
  1170     02  dfheigdi         pic s9(4) comp.
  1171     02  eibcposn         pic s9(4) comp.
  1172     02  eibcalen         pic s9(4) comp.
  1173     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  22
* NSRASLTR.cbl
  1174     02  eibfiller1       pic x(1).
  1175     02  eibfn            pic x(2).
  1176     02  eibfiller2       pic x(2).
  1177     02  eibrcode         pic x(6).
  1178     02  eibfiller3       pic x(2).
  1179     02  eibds            pic x(8).
  1180     02  eibreqid         pic x(8).
  1181     02  eibrsrce         pic x(8).
  1182     02  eibsync          pic x(1).
  1183     02  eibfree          pic x(1).
  1184     02  eibrecv          pic x(1).
  1185     02  eibsend          pic x(1).
  1186     02  eibatt           pic x(1).
  1187     02  eibeoc           pic x(1).
  1188     02  eibfmh           pic x(1).
  1189     02  eibcompl         pic x(1).
  1190     02  eibsig           pic x(1).
  1191     02  eibconf          pic x(1).
  1192     02  eiberr           pic x(1).
  1193     02  eibrldbk         pic x(1).
  1194     02  eiberrcd         pic x(4).
  1195     02  eibsynrb         pic x(1).
  1196     02  eibnodat         pic x(1).
  1197     02  eibfiller5       pic x(2).
  1198     02  eibresp          pic 9(09) comp.
  1199     02  eibresp2         pic 9(09) comp.
  1200     02  dfheigdj         pic s9(4) comp.
  1201     02  dfheigdk         pic s9(4) comp.
  1202 01  DFHCOMMAREA       PIC X(01).
  1203 01  var  pic x(30).
  1204 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  1205 0000-DFHEXIT SECTION.
  1206     MOVE '9#                    $   ' TO DFHEIV0.
  1207     MOVE 'NSRASLTR' TO DFHEIV1.
  1208     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1209*********************
  1210* Receive web input
  1211*********************
  1212     DISPLAY ' ENTERING NSRASLTR '
  1213     set P to address of KIXSYS
  1214     CALL "getenv" using by value P returning var-ptr
  1215     if var-ptr = null then
  1216        display ' kixsys not set '
  1217     else
  1218        set address of var to var-ptr
  1219        move 0 to env-var-len
  1220        inspect var tallying env-var-len
  1221          for characters before X'00'
  1222        DISPLAY '  KIXSYS = ' var (1:env-var-len)
  1223        unstring var (1:env-var-len) delimited by '/'
  1224           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1225              WS-KIX-SYS
  1226        end-unstring
  1227*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  1228*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  1229     end-if
  1230     set P to address of KIXHOST
  1231     CALL "getenv" using by value P returning var-ptr
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  23
* NSRASLTR.cbl
  1232     if var-ptr = null then
  1233        display ' kixhost not set '
  1234     else
  1235        set address of var to var-ptr
  1236        move 0 to env-var-len
  1237        inspect var tallying env-var-len
  1238          for characters before X'00'
  1239        MOVE var(1:env-var-len)  to ws-kixhost
  1240        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  1241     end-if
  1242     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1243     MOVE '5'                    TO DC-OPTION-CODE
  1244     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1245     MOVE DC-GREG-DATE-A-EDIT    TO ASERR-DT
  1246
  1247* exec cics web
  1248*       startbr formfield resp(w-resp)
  1249*     end-exec.
  1250*    MOVE 'X(f                   &  N#00001242' TO DFHEIV0
  1251     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
  1252     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1253     MOVE X'204E233030303031323432' TO DFHEIV0(25:11)
  1254     CALL 'kxdfhei1' USING DFHEIV0,
  1255           DFHEIV99,
  1256           DFHEIV99,
  1257           DFHEIV99,
  1258           DFHEIV99,
  1259           DFHEIV99
  1260     MOVE EIBRESP  TO w-resp
  1261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1262
  1263      perform read-form thru read-form-exit
  1264         until w-resp not = 0 .
  1265*   dfhresp(normal)
  1266
  1267* exec cics web
  1268*       endbr formfield
  1269*     end-exec
  1270*    MOVE 'X,f                   #   #00001247' TO DFHEIV0
  1271     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
  1272     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1273     MOVE X'2020233030303031323437' TO DFHEIV0(25:11)
  1274     CALL 'kxdfhei1' USING DFHEIV0,
  1275           DFHEIV99,
  1276           DFHEIV99
  1277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1278     display ' form input ' INPUT-FROM-FORM
  1279     MOVE SPACES                  TO BL-INPUT
  1280     MOVE IFF-DATA-SRCE           TO BL-DATA-SRCE
  1281     MOVE IFF-CARRIER             TO BL-CARRIER
  1282     MOVE IFF-GROUP               TO BL-GROUP
  1283     MOVE IFF-STATE               TO BL-STATE
  1284     MOVE IFF-ACCOUNT             TO BL-ACCOUNT
  1285     MOVE IFF-EFF-DT              TO BL-EFF-DT
  1286     MOVE IFF-CERT-NO             TO BL-CERT-NO
  1287     MOVE IFF-BATCH-NO            TO BL-BATCH-NO
  1288     MOVE IFF-BATCH-SEQ           TO BL-BATCH-SEQ
  1289     MOVE IFF-RESP-NO             TO BL-RESP-NO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  24
* NSRASLTR.cbl
  1290     MOVE IFF-LETTER-ID           TO BL-LETTER-ID
  1291     MOVE IFF-NO-OF-COPIES        TO BL-NO-OF-COPIES
  1292     MOVE IFF-PROC-ID             TO BL-PROC-ID
  1293     MOVE IFF-COMP-ID             TO OT-COMP-ID
  1294                                     BL-COMP-ID
  1295     MOVE IFF-PRINT-NOW-SW        TO OT-PRINT-NOW-SW
  1296                                     BL-PRINT-NOW-SW
  1297     MOVE IFF-ENC-CD              TO BL-ENC-CD
  1298     MOVE IFF-RESEND-DT           TO BL-RESEND-DT
  1299     MOVE IFF-FOLLOW-UP-DT        TO BL-FOLLOW-UP-DT
  1300*    MOVE IFF-COMMENTS            TO BL-COMMENTS
  1301     MOVE IFF-ARCHIVE-NO          TO BL-ARCHIVE-NO
  1302     MOVE IFF-FUNC                TO BL-FUNC
  1303                                     OT-FUNC
  1304     MOVE IFF-ENDT-ARCH-NO        TO BL-ENDT-ARCH-NO
  1305
  1306     EVALUATE BL-FUNC
  1307         WHEN 'Letter'
  1308             MOVE 'LETTER'        TO BL-SOURCE-SCREEN
  1309         WHEN 'CrtVerif'
  1310             MOVE 'VERIFY'        TO BL-SOURCE-SCREEN
  1311         WHEN 'Endorse'
  1312             MOVE 'ISS ENDT'      TO BL-SOURCE-SCREEN
  1313         WHEN 'CancChg'
  1314             MOVE 'CAN ENDT'      TO BL-SOURCE-SCREEN
  1315         WHEN OTHER
  1316             MOVE 'UNKNOWN'       TO BL-SOURCE-SCREEN
  1317     END-EVALUATE
  1318
  1319*****************************************
  1320* Since this program was called from the webservice
  1321* we really don't know if a real letter is being created
  1322* a "T" below will create temporary erarch and nsasextr
  1323* records and "X" we won't create anything
  1324*****************************************
  1325     MOVE 'T'                    TO BL-WRITE-ERARCH
  1326     IF BL-PRINT-NOW-SW = 'P'
  1327        MOVE 'X'                 TO BL-WRITE-ERARCH
  1328     END-IF
  1329     MOVE 'X'                 TO BL-WRITE-ERARCH
  1330*    DISPLAY ' INPUT FORM ' WS-KEY
  1331*****************************************
  1332* Invoke the LETTER business logic
  1333*****************************************
  1334     DISPLAY ' BL INPUT ' BL-INPUT
  1335     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  1336     DISPLAY ' BL INPUT ' BL-INPUT
  1337     display ' srch commarea ' srch-commarea
  1338     display ' length ' ws-comm-length
  1339
  1340* exec cics link
  1341*       program('NSRASBL')
  1342*       commarea(srch-commarea)
  1343*       LENGTH  (WS-COMM-LENGTH)
  1344*    end-exec.
  1345     MOVE 'NSRASBL' TO DFHEIV1
  1346*    MOVE '."C                   (   #00001311' TO DFHEIV0
  1347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  25
* NSRASLTR.cbl
  1348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1349     MOVE X'2020233030303031333131' TO DFHEIV0(25:11)
  1350     CALL 'kxdfhei1' USING DFHEIV0,
  1351           DFHEIV1,
  1352           srch-commarea,
  1353           WS-COMM-LENGTH,
  1354           DFHEIV99,
  1355           DFHEIV99,
  1356           DFHEIV99,
  1357           DFHEIV99
  1358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1359
  1360     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-output
  1361     IF BL-OK
  1362        perform varying bl-length from +6200 by -1 until
  1363           (bl-record-passed-data (bl-length:1) not = ' ')
  1364           or (bl-length = +1)
  1365        end-perform
  1366*       DISPLAY ' BL OK ' BL-ARCHIVE-NO
  1367        display ' bl length ' bl-length
  1368        move bl-length to sl-length
  1369        move spaces to naper-output-data
  1370        MOVE BL-RECORD-PASSED-DATA (1:bl-length)
  1371                                 TO NAPER-OUTPUT-DATA
  1372        MOVE BL-ARCHIVE-NO          TO OT-ARCHIVE-NO
  1373     ELSE
  1374        MOVE BL-MESSAGE          TO ASERR-MESS
  1375
  1376* exec cics document create
  1377*          doctoken   (w-doctoken)
  1378*          template   ('ASERR')
  1379*          symbollist (WS-ASERR)
  1380*          resp       (WS-RESPONSE)
  1381*       end-exec
  1382     MOVE LENGTH OF
  1383      WS-ASERR
  1384       TO DFHEIV16
  1385     MOVE 'ASERR'
  1386      TO DFHEIVL0
  1387*    MOVE '\"D tSL               )  N#00001331' TO DFHEIV0
  1388     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1389     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1390     MOVE X'204E233030303031333331' TO DFHEIV0(25:11)
  1391     CALL 'kxdfhei1' USING DFHEIV0,
  1392           w-doctoken,
  1393           DFHEIV99,
  1394           DFHEIVL0,
  1395           WS-ASERR,
  1396           DFHEIV16,
  1397           DFHEIV99,
  1398           DFHEIV99,
  1399           DFHEIV99
  1400     MOVE EIBRESP  TO WS-RESPONSE
  1401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1402        display ' doc create ' ws-response
  1403
  1404* exec cics web send
  1405*          doctoken(w-doctoken)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  26
* NSRASLTR.cbl
  1406*                      resp   (WS-RESPONSE)
  1407*       end-exec
  1408*    MOVE 'X$D                   *  N#00001338' TO DFHEIV0
  1409     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1410     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1411     MOVE X'204E233030303031333338' TO DFHEIV0(25:11)
  1412     CALL 'kxdfhei1' USING DFHEIV0,
  1413           w-doctoken,
  1414           DFHEIV99,
  1415           DFHEIV99,
  1416           DFHEIV99,
  1417           DFHEIV99,
  1418           DFHEIV99,
  1419           DFHEIV99,
  1420           DFHEIV99,
  1421           DFHEIV99
  1422     MOVE EIBRESP  TO WS-RESPONSE
  1423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1424        display ' web send ' ws-response
  1425
  1426* exec cics
  1427*          return
  1428*       end-exec
  1429*    MOVE '.(                    ''   #00001343' TO DFHEIV0
  1430     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1432     MOVE X'2020233030303031333433' TO DFHEIV0(25:11)
  1433     CALL 'kxdfhei1' USING DFHEIV0,
  1434           DFHEIV99,
  1435           DFHEIV99,
  1436           DFHEIV99,
  1437           DFHEIV99,
  1438           DFHEIV99,
  1439           DFHEIV99
  1440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1441     END-IF
  1442     evaluate ws-kixhost
  1443        when 'slunikix'
  1444           evaluate ws-kix-myenv
  1445              when 'cid1p'
  1446                 move '7001'     to ws-sl-port
  1447*                                   ws-sl-port2
  1448              when 'mdoff'
  1449                 move '7003'     to ws-sl-port
  1450*                                   ws-sl-port2
  1451              when 'cid1t'
  1452                 move '7002'     to ws-sl-port
  1453*                                   ws-sl-port2
  1454           end-evaluate
  1455           move ws-asftr         to ws-sl-key
  1456*                                   ws-sl-key2
  1457        when 'logictest'
  1458           evaluate ws-kix-myenv
  1459              when 'cid1t'
  1460                 move '6002'     to ws-lt-port
  1461*                                   ws-lt-port2
  1462              when 'tony'
  1463                 move '6003'     to ws-lt-port
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  27
* NSRASLTR.cbl
  1464*                                   ws-lt-port2
  1465              when 'paul'
  1466                 move '5002'     to ws-lt-port
  1467*                                   ws-lt-port2
  1468              when 'ahltst'
  1469                 move '6007'     to ws-lt-port
  1470*                                   ws-lt-port2
  1471           end-evaluate
  1472           move ws-asftr         to ws-lt-key
  1473*                                   ws-lt-key2
  1474     end-evaluate
  1475***********************************************************
  1476* Build output document.  There are three templates used
  1477* for this document.  ASHDR and ASFTR are the header
  1478* and footer, respectively.  ASBOD is used for the
  1479* actual data.  For each array entry in the business
  1480* logic output, set the symbol list from the array
  1481* entry and insert into the document using the ASBOD
  1482* template.
  1483***********************************************************
  1484*    move bl-output-message to out-msg-text.
  1485     IF IFF-COMP-ID = 'DCC'
  1486        IF WS-KIX-MYENV = 'cid1p'
  1487
  1488* exec cics document create
  1489*             doctoken   (w-doctoken)
  1490*             template   ('ASHDR')
  1491*             symbollist (WS-PROD-DCC-ASHDR)
  1492*             resp       (WS-RESPONSE)
  1493*          end-exec
  1494     MOVE LENGTH OF
  1495      WS-PROD-DCC-ASHDR
  1496       TO DFHEIV16
  1497     MOVE 'ASHDR'
  1498      TO DFHEIVL0
  1499*    MOVE '\"D tSL               )  N#00001392' TO DFHEIV0
  1500     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1501     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1502     MOVE X'204E233030303031333932' TO DFHEIV0(25:11)
  1503     CALL 'kxdfhei1' USING DFHEIV0,
  1504           w-doctoken,
  1505           DFHEIV99,
  1506           DFHEIVL0,
  1507           WS-PROD-DCC-ASHDR,
  1508           DFHEIV16,
  1509           DFHEIV99,
  1510           DFHEIV99,
  1511           DFHEIV99
  1512     MOVE EIBRESP  TO WS-RESPONSE
  1513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1514        ELSE
  1515
  1516* exec cics document create
  1517*             doctoken   (w-doctoken)
  1518*             template   ('ASHDR')
  1519*             symbollist (WS-TEST-DCC-ASHDR)
  1520*             resp       (WS-RESPONSE)
  1521*          end-exec
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  28
* NSRASLTR.cbl
  1522     MOVE LENGTH OF
  1523      WS-TEST-DCC-ASHDR
  1524       TO DFHEIV16
  1525     MOVE 'ASHDR'
  1526      TO DFHEIVL0
  1527*    MOVE '\"D tSL               )  N#00001399' TO DFHEIV0
  1528     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1529     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1530     MOVE X'204E233030303031333939' TO DFHEIV0(25:11)
  1531     CALL 'kxdfhei1' USING DFHEIV0,
  1532           w-doctoken,
  1533           DFHEIV99,
  1534           DFHEIVL0,
  1535           WS-TEST-DCC-ASHDR,
  1536           DFHEIV16,
  1537           DFHEIV99,
  1538           DFHEIV99,
  1539           DFHEIV99
  1540     MOVE EIBRESP  TO WS-RESPONSE
  1541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1542        END-IF
  1543     ELSE
  1544       IF IFF-COMP-ID = 'AHL'
  1545           IF WS-KIX-MYENV = 'cid1p'
  1546
  1547* exec cics document create
  1548*                doctoken   (w-doctoken)
  1549*                template   ('ASHDR')
  1550*                symbollist (WS-PROD-AHL-ASHDR)
  1551*                resp       (WS-RESPONSE)
  1552*             end-exec
  1553     MOVE LENGTH OF
  1554      WS-PROD-AHL-ASHDR
  1555       TO DFHEIV16
  1556     MOVE 'ASHDR'
  1557      TO DFHEIVL0
  1558*    MOVE '\"D tSL               )  N#00001409' TO DFHEIV0
  1559     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1560     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1561     MOVE X'204E233030303031343039' TO DFHEIV0(25:11)
  1562     CALL 'kxdfhei1' USING DFHEIV0,
  1563           w-doctoken,
  1564           DFHEIV99,
  1565           DFHEIVL0,
  1566           WS-PROD-AHL-ASHDR,
  1567           DFHEIV16,
  1568           DFHEIV99,
  1569           DFHEIV99,
  1570           DFHEIV99
  1571     MOVE EIBRESP  TO WS-RESPONSE
  1572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1573           ELSE
  1574
  1575* exec cics document create
  1576*                doctoken   (w-doctoken)
  1577*                template   ('ASHDR')
  1578*                symbollist (WS-TEST-AHL-ASHDR)
  1579*                resp       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  29
* NSRASLTR.cbl
  1580*             end-exec
  1581     MOVE LENGTH OF
  1582      WS-TEST-AHL-ASHDR
  1583       TO DFHEIV16
  1584     MOVE 'ASHDR'
  1585      TO DFHEIVL0
  1586*    MOVE '\"D tSL               )  N#00001416' TO DFHEIV0
  1587     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1588     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1589     MOVE X'204E233030303031343136' TO DFHEIV0(25:11)
  1590     CALL 'kxdfhei1' USING DFHEIV0,
  1591           w-doctoken,
  1592           DFHEIV99,
  1593           DFHEIVL0,
  1594           WS-TEST-AHL-ASHDR,
  1595           DFHEIV16,
  1596           DFHEIV99,
  1597           DFHEIV99,
  1598           DFHEIV99
  1599     MOVE EIBRESP  TO WS-RESPONSE
  1600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1601           END-IF
  1602       ELSE
  1603         IF WS-KIX-MYENV = 'cid1p'
  1604
  1605* exec cics document create
  1606*             doctoken   (w-doctoken)
  1607*             template   ('ASHDR')
  1608*             symbollist (WS-PROD-CID-ASHDR)
  1609*             resp       (WS-RESPONSE)
  1610*          end-exec
  1611     MOVE LENGTH OF
  1612      WS-PROD-CID-ASHDR
  1613       TO DFHEIV16
  1614     MOVE 'ASHDR'
  1615      TO DFHEIVL0
  1616*    MOVE '\"D tSL               )  N#00001425' TO DFHEIV0
  1617     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1618     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1619     MOVE X'204E233030303031343235' TO DFHEIV0(25:11)
  1620     CALL 'kxdfhei1' USING DFHEIV0,
  1621           w-doctoken,
  1622           DFHEIV99,
  1623           DFHEIVL0,
  1624           WS-PROD-CID-ASHDR,
  1625           DFHEIV16,
  1626           DFHEIV99,
  1627           DFHEIV99,
  1628           DFHEIV99
  1629     MOVE EIBRESP  TO WS-RESPONSE
  1630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1631         ELSE
  1632
  1633* exec cics document create
  1634*             doctoken   (w-doctoken)
  1635*             template   ('ASHDR')
  1636*             symbollist (WS-TEST-CID-ASHDR)
  1637*             resp       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  30
* NSRASLTR.cbl
  1638*          end-exec
  1639     MOVE LENGTH OF
  1640      WS-TEST-CID-ASHDR
  1641       TO DFHEIV16
  1642     MOVE 'ASHDR'
  1643      TO DFHEIVL0
  1644*    MOVE '\"D tSL               )  N#00001432' TO DFHEIV0
  1645     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1646     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1647     MOVE X'204E233030303031343332' TO DFHEIV0(25:11)
  1648     CALL 'kxdfhei1' USING DFHEIV0,
  1649           w-doctoken,
  1650           DFHEIV99,
  1651           DFHEIVL0,
  1652           WS-TEST-CID-ASHDR,
  1653           DFHEIV16,
  1654           DFHEIV99,
  1655           DFHEIV99,
  1656           DFHEIV99
  1657     MOVE EIBRESP  TO WS-RESPONSE
  1658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1659         END-IF
  1660       END-IF
  1661     END-IF
  1662*    DISPLAY ' ASHDR DOC CREATE ' WS-RESPONSE
  1663*    move 1 to bl-index.
  1664*
  1665*    perform bl-output-record-count times
  1666*
  1667*        move bl-output-account-number(bl-index)
  1668*          to out-account-number
  1669*        move bl-output-last-name(bl-index)
  1670*          to out-last-name
  1671*        move bl-output-first-name(bl-index)
  1672*          to out-first-name
  1673*        move bl-output-middle-initial(bl-index)
  1674*          to out-middle-initial
  1675*
  1676*    MOVE 'EL01'                 TO OUT-TEMP
  1677*    MOVE 'ALWA'                 TO OUT-PROC-ID
  1678*    MOVE 'EL01'                 TO OUT-LETTER
  1679*    MOVE '9'                    TO OUT-CARRIER
  1680*    MOVE 'MCDANIEL'             TO OUT-ILNAME
  1681*    MOVE 'KATHI'                TO OUT-IFNAME
  1682*
  1683*    MOVE '0009235906 '          TO OUT-CERT-NO
  1684*    MOVE '0990000208'           TO OUT-ACCOUNT
  1685
  1686* exec cics document set
  1687*       doctoken(w-doctoken)
  1688*       symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1689*       delimiter ('?')
  1690*       length(length of NAPER-OUTPUT-DATA)
  1691*       length(sl-length)
  1692*                   resp   (WS-RESPONSE)
  1693*     unescaped
  1694*    end-exec
  1695*    MOVE '\(Ds L                ''  N#00001464' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  31
* NSRASLTR.cbl
  1696     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1697     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1698     MOVE X'204E233030303031343634' TO DFHEIV0(25:11)
  1699     CALL 'kxdfhei1' USING DFHEIV0,
  1700           w-doctoken,
  1701           NAPER-OUTPUT-DATA(1 : bl-length),
  1702           DFHEIV99,
  1703           sl-length,
  1704           DFHEIV99,
  1705           DFHEIV99
  1706     MOVE EIBRESP  TO WS-RESPONSE
  1707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1708*    DISPLAY ' DOC SET    ' WS-RESPONSE
  1709
  1710* exec cics document insert
  1711*       doctoken(w-doctoken)
  1712*       template('ASBOD')
  1713*                   resp   (WS-RESPONSE)
  1714*    end-exec
  1715     MOVE 'ASBOD'
  1716      TO DFHEIVL0
  1717*    MOVE '\$Dt                  (  N#00001474' TO DFHEIV0
  1718     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1719     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1720     MOVE X'204E233030303031343734' TO DFHEIV0(25:11)
  1721     CALL 'kxdfhei1' USING DFHEIV0,
  1722           w-doctoken,
  1723           DFHEIVL0,
  1724           DFHEIV99,
  1725           DFHEIV99,
  1726           DFHEIV99,
  1727           DFHEIV99,
  1728           DFHEIV99
  1729     MOVE EIBRESP  TO WS-RESPONSE
  1730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1731     IF BL-LETTER-TO-ACCT NOT = SPACES
  1732        MOVE BL-LETTER-TO-ACCT   TO NAPER-OUTPUT-DATA (12:1)
  1733*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1734
  1735* exec cics document set
  1736*          doctoken(w-doctoken)
  1737*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1738*          length(sl-length)
  1739*          resp   (WS-RESPONSE)
  1740*       end-exec
  1741*    MOVE '\(Ds L                ''  N#00001482' TO DFHEIV0
  1742     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1743     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1744     MOVE X'204E233030303031343832' TO DFHEIV0(25:11)
  1745     CALL 'kxdfhei1' USING DFHEIV0,
  1746           w-doctoken,
  1747           NAPER-OUTPUT-DATA(1 : bl-length),
  1748           DFHEIV99,
  1749           sl-length,
  1750           DFHEIV99,
  1751           DFHEIV99
  1752     MOVE EIBRESP  TO WS-RESPONSE
  1753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  32
* NSRASLTR.cbl
  1754
  1755* exec cics document insert
  1756*          doctoken(w-doctoken)
  1757*          template('ASBOD')
  1758*          resp   (WS-RESPONSE)
  1759*       end-exec
  1760     MOVE 'ASBOD'
  1761      TO DFHEIVL0
  1762*    MOVE '\$Dt                  (  N#00001488' TO DFHEIV0
  1763     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1764     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1765     MOVE X'204E233030303031343838' TO DFHEIV0(25:11)
  1766     CALL 'kxdfhei1' USING DFHEIV0,
  1767           w-doctoken,
  1768           DFHEIVL0,
  1769           DFHEIV99,
  1770           DFHEIV99,
  1771           DFHEIV99,
  1772           DFHEIV99,
  1773           DFHEIV99
  1774     MOVE EIBRESP  TO WS-RESPONSE
  1775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1776     END-IF
  1777     IF BL-LETTER-TO-BENE NOT = SPACES
  1778        MOVE BL-LETTER-TO-BENE   TO NAPER-OUTPUT-DATA (12:1)
  1779*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1780
  1781* exec cics document set
  1782*          doctoken(w-doctoken)
  1783*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1784*          length(sl-length)
  1785*          resp   (WS-RESPONSE)
  1786*       end-exec
  1787*    MOVE '\(Ds L                ''  N#00001497' TO DFHEIV0
  1788     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1790     MOVE X'204E233030303031343937' TO DFHEIV0(25:11)
  1791     CALL 'kxdfhei1' USING DFHEIV0,
  1792           w-doctoken,
  1793           NAPER-OUTPUT-DATA(1 : bl-length),
  1794           DFHEIV99,
  1795           sl-length,
  1796           DFHEIV99,
  1797           DFHEIV99
  1798     MOVE EIBRESP  TO WS-RESPONSE
  1799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1800
  1801* exec cics document insert
  1802*          doctoken(w-doctoken)
  1803*          template('ASBOD')
  1804*          resp   (WS-RESPONSE)
  1805*       end-exec
  1806     MOVE 'ASBOD'
  1807      TO DFHEIVL0
  1808*    MOVE '\$Dt                  (  N#00001503' TO DFHEIV0
  1809     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1810     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1811     MOVE X'204E233030303031353033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  33
* NSRASLTR.cbl
  1812     CALL 'kxdfhei1' USING DFHEIV0,
  1813           w-doctoken,
  1814           DFHEIVL0,
  1815           DFHEIV99,
  1816           DFHEIV99,
  1817           DFHEIV99,
  1818           DFHEIV99,
  1819           DFHEIV99
  1820     MOVE EIBRESP  TO WS-RESPONSE
  1821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1822     END-IF
  1823*    DISPLAY ' ASBOD DOC INSERT ' WS-RESPONSE
  1824*
  1825*        add 1 to bl-index
  1826*
  1827*    end-perform.
  1828*    MOVE BL-CARRIER  TO OT-CARRIER
  1829*    MOVE BL-CLAIM-NO TO OT-CLMNO
  1830*    MOVE BL-CERT-NO  TO OT-CRTNO
  1831*    MOVE BL-ARCHIVE-NO TO OT-ARCHNO
  1832     IF WS-KIXHOST = 'slunikix'
  1833        display ' host slunikix ' ws-kixhost
  1834
  1835* exec cics document set
  1836*          doctoken(w-doctoken)
  1837*          symbollist(WS-VAR-SLUNIKIX)
  1838*          length(length of WS-VAR-SLUNIKIX)
  1839*                      resp   (WS-RESPONSE)
  1840*       end-exec
  1841     MOVE LENGTH OF
  1842      WS-VAR-SLUNIKIX TO DFHEIV16
  1843*    MOVE '\(Ds L                ''  N#00001520' TO DFHEIV0
  1844     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1845     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1846     MOVE X'204E233030303031353230' TO DFHEIV0(25:11)
  1847     CALL 'kxdfhei1' USING DFHEIV0,
  1848           w-doctoken,
  1849           WS-VAR-SLUNIKIX,
  1850           DFHEIV99,
  1851           DFHEIV16,
  1852           DFHEIV99,
  1853           DFHEIV99
  1854     MOVE EIBRESP  TO WS-RESPONSE
  1855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1856     else
  1857        display ' host logictest ' ws-kixhost
  1858
  1859* exec cics document set
  1860*          doctoken(w-doctoken)
  1861*          symbollist(WS-VAR-LOGICTEST)
  1862*          length(length of WS-VAR-LOGICTEST)
  1863*                      resp   (WS-RESPONSE)
  1864*       end-exec
  1865     MOVE LENGTH OF
  1866      WS-VAR-LOGICTEST TO DFHEIV16
  1867*    MOVE '\(Ds L                ''  N#00001528' TO DFHEIV0
  1868     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  34
* NSRASLTR.cbl
  1870     MOVE X'204E233030303031353238' TO DFHEIV0(25:11)
  1871     CALL 'kxdfhei1' USING DFHEIV0,
  1872           w-doctoken,
  1873           WS-VAR-LOGICTEST,
  1874           DFHEIV99,
  1875           DFHEIV16,
  1876           DFHEIV99,
  1877           DFHEIV99
  1878     MOVE EIBRESP  TO WS-RESPONSE
  1879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1880     end-if
  1881*    DISPLAY ' DOC SET ' WS-RESPONSE
  1882
  1883* exec cics document insert
  1884*       doctoken(w-doctoken)
  1885*       template('ASFTR')
  1886*                   resp   (WS-RESPONSE)
  1887*    end-exec
  1888     MOVE 'ASFTR'
  1889      TO DFHEIVL0
  1890*    MOVE '\$Dt                  (  N#00001536' TO DFHEIV0
  1891     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1893     MOVE X'204E233030303031353336' TO DFHEIV0(25:11)
  1894     CALL 'kxdfhei1' USING DFHEIV0,
  1895           w-doctoken,
  1896           DFHEIVL0,
  1897           DFHEIV99,
  1898           DFHEIV99,
  1899           DFHEIV99,
  1900           DFHEIV99,
  1901           DFHEIV99
  1902     MOVE EIBRESP  TO WS-RESPONSE
  1903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1904*    DISPLAY ' ASFTR DOC INSERT ' WS-RESPONSE
  1905*    if bl-fail
  1906*       exec cics syncpoint rollback
  1907*       end-exec
  1908*    end-if.
  1909****************************************
  1910* Send the document and return.
  1911****************************************
  1912
  1913* exec cics web send
  1914*       doctoken(w-doctoken)
  1915*                   resp   (WS-RESPONSE)
  1916*    end-exec.
  1917*    MOVE 'X$D                   *  N#00001549' TO DFHEIV0
  1918     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1919     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1920     MOVE X'204E233030303031353439' TO DFHEIV0(25:11)
  1921     CALL 'kxdfhei1' USING DFHEIV0,
  1922           w-doctoken,
  1923           DFHEIV99,
  1924           DFHEIV99,
  1925           DFHEIV99,
  1926           DFHEIV99,
  1927           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  35
* NSRASLTR.cbl
  1928           DFHEIV99,
  1929           DFHEIV99,
  1930           DFHEIV99
  1931     MOVE EIBRESP  TO WS-RESPONSE
  1932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1933
  1934*    DISPLAY ' WEB SEND  ' WS-RESPONSE
  1935*    DISPLAY ' ABOUT TO RETURN '
  1936
  1937* exec cics
  1938*       return
  1939*    end-exec.
  1940*    MOVE '.(                    ''   #00001555' TO DFHEIV0
  1941     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1942     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1943     MOVE X'2020233030303031353535' TO DFHEIV0(25:11)
  1944     CALL 'kxdfhei1' USING DFHEIV0,
  1945           DFHEIV99,
  1946           DFHEIV99,
  1947           DFHEIV99,
  1948           DFHEIV99,
  1949           DFHEIV99,
  1950           DFHEIV99
  1951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1952
  1953******************************************************
  1954* Read all fields of the incoming form, moving
  1955* each to the corresponding field of the commarea
  1956* (business logic input fields).
  1957******************************************************
  1958 read-form.
  1959     move spaces to w-form-name.
  1960     move length of w-form-name to w-form-name-len.
  1961           move spaces to w-form-value.
  1962     move length of w-form-value to w-form-value-len.
  1963
  1964* exec cics web readnext
  1965*                  formfield(w-form-name)
  1966*                  namelength(w-form-name-len)
  1967*                  value(w-form-value)
  1968*                  valuelength(w-form-value-len)
  1969*                  resp(w-resp)
  1970*    end-exec.
  1971*    MOVE 'X*FLVL                &  N#00001568' TO DFHEIV0
  1972     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1973     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1974     MOVE X'204E233030303031353638' TO DFHEIV0(25:11)
  1975     CALL 'kxdfhei1' USING DFHEIV0,
  1976           w-form-name,
  1977           w-form-name-len,
  1978           w-form-value,
  1979           w-form-value-len,
  1980           DFHEIV99
  1981     MOVE EIBRESP  TO w-resp
  1982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1983
  1984     evaluate w-resp
  1985        when 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  36
* NSRASLTR.cbl
  1986*   dfhresp(normal)
  1987           evaluate w-form-name(1:w-form-name-len)
  1988              when 'data_src'
  1989                 if w-form-value-len not = 0
  1990                    move w-form-value(1:w-form-value-len)
  1991                                 to IFF-DATA-SRCE
  1992                 else
  1993                                move spaces to IFF-DATA-SRCE
  1994                 end-if
  1995              when 'letter_id'
  1996                 if w-form-value-len not = 0
  1997                    move w-form-value(1:w-form-value-len)
  1998                                 to IFF-LETTER-ID
  1999                 else
  2000                                move spaces to IFF-LETTER-ID
  2001                 end-if
  2002              when 'carrier'
  2003                 if w-form-value-len not = 0
  2004                    move w-form-value(1:w-form-value-len)
  2005                             to IFF-CARRIER
  2006                 else
  2007                                move spaces to IFF-CARRIER
  2008                 end-if
  2009              when 'grouping'
  2010                             if w-form-value-len not = 0
  2011                    move w-form-value(1:w-form-value-len)
  2012                                                   to IFF-GROUP
  2013                 else
  2014                                move spaces  to IFF-GROUP
  2015                 end-if
  2016              when 'state_cd'
  2017                             if w-form-value-len not = 0
  2018                    move w-form-value(1:w-form-value-len)
  2019                                 to IFF-STATE
  2020                 else
  2021                                move spaces  to IFF-STATE
  2022                 end-if
  2023              when 'acct_no'
  2024                             if w-form-value-len not = 0
  2025                    move w-form-value(1:w-form-value-len)
  2026                                 to IFF-ACCOUNT
  2027                 else
  2028                    move spaces  to IFF-ACCOUNT
  2029                 end-if
  2030              when 'eff_date'
  2031                             if w-form-value-len not = 0
  2032                    move w-form-value(1:w-form-value-len)
  2033                                 to IFF-EFF-DT
  2034                 else
  2035                                move spaces  to IFF-EFF-DT
  2036                 end-if
  2037              when 'cert_no'
  2038                             if w-form-value-len not = 0
  2039                    move w-form-value(1:w-form-value-len)
  2040                                 to IFF-CERT-NO
  2041                 else
  2042                                move spaces  to IFF-CERT-NO
  2043                 end-if
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  37
* NSRASLTR.cbl
  2044              when 'batch_no'
  2045                             if w-form-value-len not = 0
  2046                    move w-form-value(1:w-form-value-len)
  2047                                 to IFF-BATCH-NO
  2048                 else
  2049                                move spaces  to IFF-BATCH-NO
  2050                 end-if
  2051              when 'batch_seq'
  2052                             if w-form-value-len not = 0
  2053                    move w-form-value(1:w-form-value-len)
  2054                                 to IFF-BATCH-SEQ
  2055                 else
  2056                                move zeros   to IFF-BATCH-SEQ
  2057                 end-if
  2058              when 'resp_no'
  2059                             if w-form-value-len not = 0
  2060                    move w-form-value(1:w-form-value-len)
  2061                                 to IFF-RESP-NO
  2062                 else
  2063                                move spaces  to IFF-RESP-NO
  2064                 end-if
  2065              when 'no_copies'
  2066                             if w-form-value-len not = 0
  2067                    move w-form-value(1:w-form-value-len)
  2068                                 to IFF-NO-OF-COPIES
  2069                 else
  2070                    move zeros   to IFF-NO-OF-COPIES
  2071                 end-if
  2072              when 'proc_id'
  2073                             if w-form-value-len not = 0
  2074                    move w-form-value(1:w-form-value-len)
  2075                                 to IFF-PROC-ID
  2076                 else
  2077                    move 'JJVA'  to IFF-PROC-ID
  2078                 end-if
  2079              when 'comp_id'
  2080                             if w-form-value-len not = 0
  2081                    move w-form-value(1:w-form-value-len)
  2082                                 to IFF-COMP-ID
  2083                 else
  2084                    move 'CID'   to IFF-COMP-ID
  2085                 end-if
  2086              when 'prt_now'
  2087                             if w-form-value-len not = 0
  2088                    move w-form-value(1:w-form-value-len)
  2089                                 to IFF-PRINT-NOW-SW
  2090                 else
  2091                    move 'N'     to IFF-PRINT-NOW-SW
  2092                 end-if
  2093              when 'enc_cd'
  2094                             if w-form-value-len not = 0
  2095                    move w-form-value(1:w-form-value-len)
  2096                                 to IFF-ENC-CD
  2097                 else
  2098                    move '0'     to IFF-ENC-CD
  2099                 end-if
  2100              when 'resend_dt'
  2101                             if w-form-value-len not = 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  38
* NSRASLTR.cbl
  2102                    move w-form-value(1:w-form-value-len)
  2103                                 to IFF-RESEND-DT
  2104                 else
  2105                    move SPACES  to IFF-RESEND-DT
  2106                 end-if
  2107              when 'follow_dt'
  2108                             if w-form-value-len not = 0
  2109                    move w-form-value(1:w-form-value-len)
  2110                                 to IFF-FOLLOW-UP-DT
  2111                 else
  2112                    move SPACES  to IFF-FOLLOW-UP-DT
  2113                 end-if
  2114              when 'arch_no'
  2115                             if w-form-value-len not = 0
  2116                    move w-form-value(1:w-form-value-len)
  2117                                 to IFF-ARCHIVE-NO
  2118                 else
  2119                    move ZEROS   to IFF-ARCHIVE-NO
  2120                 end-if
  2121              when 'pgm_func'
  2122                             if w-form-value-len not = 0
  2123                    move w-form-value(1:w-form-value-len)
  2124                                 to IFF-FUNC
  2125                 else
  2126                    move ZEROS   to IFF-FUNC
  2127                 end-if
  2128*             when 'ltr_comments'
  2129*                if w-form-value-len not = 0
  2130*                   move w-form-value(1:w-form-value-len)
  2131*                                to IFF-COMMENTS
  2132*                else
  2133*                   move SPACES  to IFF-COMMENTS
  2134*                end-if
  2135              when 'end_arch'
  2136                 if w-form-value-len not = 0
  2137                    move w-form-value(1:w-form-value-len)
  2138                                 to IFF-ENDT-ARCH-NO
  2139                 else
  2140                    move ZEROS  to IFF-ENDT-ARCH-NO
  2141                 end-if
  2142           end-evaluate
  2143        when other
  2144           continue
  2145     end-evaluate.
  2146 read-form-exit.
  2147 9700-DATE-LINK.
  2148
  2149* EXEC CICS LINK
  2150*        PROGRAM   ('ELDATCV')
  2151*        COMMAREA  (DATE-CONVERSION-DATA)
  2152*        LENGTH    (DC-COMM-LENGTH)
  2153*    END-EXEC.
  2154     MOVE 'ELDATCV' TO DFHEIV1
  2155*    MOVE '."C                   (   #00001738' TO DFHEIV0
  2156     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2158     MOVE X'2020233030303031373338' TO DFHEIV0(25:11)
  2159     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:19 Page  39
* NSRASLTR.cbl
  2160           DFHEIV1,
  2161           DATE-CONVERSION-DATA,
  2162           DC-COMM-LENGTH,
  2163           DFHEIV99,
  2164           DFHEIV99,
  2165           DFHEIV99,
  2166           DFHEIV99
  2167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2168
  2169 9700-EXIT.
  2170      EXIT.
  2171
  2172 9999-DFHBACK SECTION.
  2173     MOVE '9%                    "   ' TO DFHEIV0
  2174     MOVE 'NSRASLTR' TO DFHEIV1
  2175     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2176     GOBACK.
  2177 9999-DFHEXIT.
  2178     IF DFHEIGDJ EQUAL 0001
  2179         NEXT SENTENCE.
  2180     MOVE '9%                    "   ' TO DFHEIV0
  2181     MOVE 'NSRASLTR' TO DFHEIV1
  2182     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2183     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15068     Code:        6622
