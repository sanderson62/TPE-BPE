* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33*-----------------------------------------------------------------
    34*REMARKS.
    35*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   3
* EL6318.cbl
    37 ENVIRONMENT DIVISION.
    38 DATA DIVISION.
    39 WORKING-STORAGE SECTION.
    40 01  DFH-START PIC X(04).
    41 77  FILLER  PIC X(32)  VALUE '********************************'.
    42 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    43 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    44 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    45 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    46 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    47 77  s1                          pic s999 comp-3 value +0.
    48 77  s2                          pic s999 comp-3 value +0.
    49 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    50 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    51     88  ACCT-FOUND                 VALUE 'Y'.
    52 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    53 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    54 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    55 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    56 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    57 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    58 77  WS-REASON-SW                PIC X  VALUE ' '.
    59     88  REASONS-FOUND                  VALUE 'Y'.
    60     88  REASONS-NOT-FOUND              VALUE 'N'.
    61 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    62     88  NO-CERT-RW                 VALUE 'N'.
    63     88  CERT-RW                    VALUE 'Y'.
    64 01  P pointer.
    65 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    66 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    67 01  var-ptr pointer.
    68 01  env-var-len                 pic 9(4)  binary.
    69 01  rc                          pic 9(9)  binary.
    70 01  WS-KIXHOST                  PIC X(10).
    71 01  WS-KIXSYS.
    72     05  WS-KIX-FIL1             PIC X(10).
    73     05  WS-KIX-APPS             PIC X(10).
    74     05  WS-KIX-ENV              PIC X(10).
    75     05  WS-KIX-MYENV            PIC X(10).
    76     05  WS-KIX-SYS              PIC X(10).
    77*                                COPY ELCSCTM.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCTM                             *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    85*                                                                *
    86******************************************************************
    87 01  SECURITY-MESSAGE.
    88     12  FILLER                          PIC X(30)
    89            VALUE '** LOGIC SECURITY VIOLATION -'.
    90     12  SM-READ                         PIC X(6).
    91     12  FILLER                          PIC X(5)
    92            VALUE ' PGM='.
    93     12  SM-PGM                          PIC X(6).
    94     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   4
* EL6318.cbl
    95            VALUE ' OPR='.
    96     12  SM-PROCESSOR-ID                 PIC X(4).
    97     12  FILLER                          PIC X(6)
    98            VALUE ' TERM='.
    99     12  SM-TERMID                       PIC X(4).
   100     12  FILLER                          PIC XX   VALUE SPACE.
   101     12  SM-JUL-DATE                     PIC 9(5).
   102     12  FILLER                          PIC X    VALUE SPACE.
   103     12  SM-TIME                         PIC 99.99.
   104
   105*                                COPY ELCSCRTY.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCSCRTY                            *
   110*                            VMOD=2.001                          *
   111*                                                                *
   112*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   113*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   114*        SAVED IN PI-SECURITY-ADDRESS.                           *
   115*                                                                *
   116******************************************************************
   117 01  SECURITY-CONTROL.
   118     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   119     12  FILLER                       PIC XX    VALUE 'SC'.
   120     12  SC-CREDIT-CODES.
   121         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   122             20  SC-CREDIT-DISPLAY    PIC X.
   123             20  SC-CREDIT-UPDATE     PIC X.
   124     12  SC-CLAIMS-CODES.
   125         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   126             20  SC-CLAIMS-DISPLAY    PIC X.
   127             20  SC-CLAIMS-UPDATE     PIC X.
   128 01 srch-commarea.
   129*                                copy ELCADLTRSPI.
   130******************************************************************
   131*                   C H A N G E   L O G
   132*
   133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   134*-----------------------------------------------------------------
   135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   136* EFFECTIVE    NUMBER
   137*-----------------------------------------------------------------
   138* 060611    2011022800001  PEMA  NEW COPYBOOK
   139* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   140* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   141******************************************************************
   142****************************************
   143*  commarea for NaperSoft On Demand Admin services letters
   144*  (business logic input & output)
   145****************************************
   146     03  BL-INPUT.
   147         05  BL-DATA-SRCE        PIC X.
   148         05  BL-LETTER-ID        PIC XXXX.
   149         05  BL-CARRIER          PIC X.
   150         05  BL-GROUP            PIC X(6).
   151         05  BL-STATE            PIC XX.
   152         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   5
* EL6318.cbl
   153         05  BL-EFF-DT           PIC X(10).
   154         05  BL-CERT-NO          PIC X(11).
   155         05  BL-BATCH-NO         PIC X(6).
   156         05  BL-BATCH-SEQ        PIC 9(8).
   157         05  BL-RESP-NO          PIC X(10).
   158         05  BL-NO-OF-COPIES     PIC 99.
   159         05  BL-PROC-ID          PIC XXXX.
   160         05  BL-COMP-ID          PIC XXX.
   161         05  BL-PRINT-NOW-SW     PIC X.
   162         05  BL-ENC-CD           PIC XXX.
   163         05  BL-RESEND-DT        PIC X(10).
   164         05  BL-FOLLOW-UP-DT     PIC X(10).
   165         05  BL-ARCHIVE-NO       PIC 9(8).
   166         05  BL-FUNC             PIC X(8).
   167         05  BL-COMMENTS         PIC X(100).
   168         05  FILLER REDEFINES BL-COMMENTS.
   169             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   170             10  BL-LETTER-TO-ACCT PIC X.
   171             10  BL-LETTER-TO-BENE PIC X.
   172             10  BL-WRITE-ERARCH   PIC X.
   173                 88  ERARCH-QWS      VALUE 'Q'.
   174                 88  ERARCH-BATCH    VALUE 'B'.
   175                 88  ERARCH-TEMP     VALUE 'T'.
   176             10  BL-PROCESS-TYPE PIC X(07).
   177             10  BL-CERT-FORM-ID PIC X(05).
   178             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   179             10  BL-SOURCE-SCREEN PIC X(8).
   180             10  FILLER          PIC X(25).
   181     03  BL-OUTPUT.
   182         05  BL-STATUS                   PIC X.
   183             88  BL-OK                      VALUE "P".
   184             88  BL-FAIL                  VALUE "F".
   185         05  BL-MESSAGE          PIC X(50).
   186     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   187     03  FILLER                  PIC X(31).
   188
   189*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   190*                                COPY ELCZREC.
   191******************************************************************
   192*                                                                *
   193*                                                                *
   194*                            ELCZREC.                            *
   195*                                                                *
   196*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   197*                                                                *
   198******************************************************************
   199*-----------------------------------------------------------------
   200*                   C H A N G E   L O G
   201*
   202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   203*-----------------------------------------------------------------
   204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   205* EFFECTIVE    NUMBER
   206*-----------------------------------------------------------------
   207* 122011    2011022800001  AJRA  NEW FILE
   208* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   209*-----------------------------------------------------------------
   210 01  W-Z-CONTROL-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   6
* EL6318.cbl
   211     05  W-NUMBER-OF-COPIES      PIC  9.
   212     05  FILLER                  PIC  X.
   213     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   214     05  FILLER                  PIC  X.
   215     05  W-DAYS-TO-RESEND        PIC  999.
   216     05  FILLER                  PIC  X.
   217     05  W-FORM-TO-RESEND        PIC  X(4).
   218     05  FILLER                  PIC  X.
   219     05  W-PROMPT-LETTER         PIC  X.
   220     05  FILLER                  PIC  X.
   221     05  W-ENCLOSURE-CD          PIC  XXX.
   222     05  FILLER                  PIC  X.
   223     05  W-AUTO-CLOSE-IND        PIC  X.
   224     05  FILLER                  PIC  X.
   225     05  W-LETTER-TO-BENE        PIC  X.
   226     05  FILLER                  PIC  X.
   227     05  W-LETTER-TO-ACCT        PIC  X.
   228     05  FILLER                  PIC  X.
   229     05  W-LETTER-TYPE           PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-PRINT-CERTIFICATE     PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-REFUND-REQUIRED       PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-ONBASE-CODE           PIC  XX.
   236     05  FILLER                  PIC  X.
   237     05  W-ACCT-SUMM             PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-CSO-SUMM              PIC  X.
   240     05  FILLER                  PIC  X(31).
   241 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   242 01  STANDARD-AREAS.
   243     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   244     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   245                                 PIC  X(08).
   246     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   247     12  QID.
   248         16  QID-TERM        PIC X(4)    VALUE SPACES.
   249         16  FILLER          PIC X(4)    VALUE '631K'.
   250     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   251     12  TIME-MT                 PIC S9(7).
   252     12  TIME-MT-R  REDEFINES TIME-MT.
   253         16  FILLER              PIC X.
   254         16  TIME-LMT            PIC 99V99.
   255         16  FILLER              PIC X(2).
   256     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   257     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   258     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   259     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   260     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   261     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   262     12  W-CNTL-KEY.
   263         16  W-CNTL-COMPANY-ID   PIC  X(03).
   264         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   265         16  W-CNTL-GENL.
   266             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   267             20  W-CNTL-GEN2.
   268                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   7
* EL6318.cbl
   269                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   270         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   271     12  WS-ELCERT-KEY.
   272         16  W-CERT-COMPANY-CD   PIC X.
   273         16  W-CERT-CARRIER      PIC X.
   274         16  W-CERT-GROUPING     PIC X(6).
   275         16  W-CERT-STATE        PIC XX.
   276         16  W-CERT-ACCOUNT      PIC X(10).
   277         16  W-CERT-CERT-EFF-DT  PIC XX.
   278         16  W-CERT-CERT-PRIME   PIC X(10).
   279         16  W-CERT-CERT-SFX     PIC X.
   280     12  WS-ELEOBC-KEY.
   281         16  WS-EOBC-COMPANY-CD  PIC X.
   282         16  WS-EOBC-REC-TYPE    PIC X.
   283         16  WS-EOBC-CODE        PIC X(4).
   284         16  FILLER              PIC X(9).
   285     12  WS-ERNOTE-KEY.
   286         16  W-NOTE-COMPANY-CD   PIC X.
   287         16  W-NOTE-CARRIER      PIC X.
   288         16  W-NOTE-GROUPING     PIC X(6).
   289         16  W-NOTE-STATE        PIC XX.
   290         16  W-NOTE-ACCOUNT      PIC X(10).
   291         16  W-NOTE-CERT-EFF-DT  PIC XX.
   292         16  W-NOTE-CERT-PRIME   PIC X(10).
   293         16  W-NOTE-CERT-SFX     PIC X.
   294     12  ELLETR-KEY.
   295         16  LETR-PART-KEY.
   296             20  LETR-COMPANY-CD PIC X.
   297             20  LETR-LETTER-ID  PIC X(4).
   298         16  LETR-FILLER         PIC X(8).
   299         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   300     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   301     12  ERPNDB2-KEY.
   302         16  PNDB2-COMPANY-CD    PIC X.
   303         16  PNDB2-CARRIER       PIC X.
   304         16  PNDB2-GROUPING      PIC X(6).
   305         16  PNDB2-STATE         PIC XX.
   306         16  PNDB2-ACCOUNT       PIC X(10).
   307         16  PNDB2-CERT-EFF-DT   PIC XX.
   308         16  PNDB2-CERT-PRIME    PIC X(10).
   309         16  PNDB2-CERT-SFX      PIC X.
   310         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   311         16  PNDB2-RECORD-TYPE   PIC X.
   312     12  ERPNDB-KEY.
   313         16  PNDB-COMPANY-CD     PIC X.
   314         16  PNDB-BATCH-NO       PIC X(6).
   315         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   316         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   317     12  ERENDT-KEY.
   318         16  ENDT-COMPANY-CD       PIC X.
   319         16  ENDT-CARRIER          PIC X.
   320         16  ENDT-GROUPING         PIC X(6).
   321         16  ENDT-STATE            PIC XX.
   322         16  ENDT-ACCOUNT          PIC X(10).
   323         16  ENDT-CERT-EFF-DT      PIC XX.
   324         16  ENDT-CERT-PRIME       PIC X(10).
   325         16  ENDT-CERT-SFX         PIC X.
   326         16  ENDT-RECORD-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   8
* EL6318.cbl
   327         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   328     12  ELCRTO-KEY.
   329         16  CRTO-COMPANY-CD     PIC X.
   330         16  CRTO-CARRIER        PIC X.
   331         16  CRTO-GROUPING       PIC X(6).
   332         16  CRTO-STATE          PIC XX.
   333         16  CRTO-ACCOUNT        PIC X(10).
   334         16  CRTO-CERT-EFF-DT    PIC XX.
   335         16  CRTO-CERT-PRIME     PIC X(10).
   336         16  CRTO-CERT-SFX       PIC X.
   337         16  CRTO-RECORD-TYPE    PIC X.
   338         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   339     12  WS-ERMAIL-KEY.
   340         16  MAIL-COMPANY-CD     PIC X.
   341         16  MAIL-CARRIER        PIC X.
   342         16  MAIL-GROUPING       PIC X(6).
   343         16  MAIL-STATE          PIC XX.
   344         16  MAIL-ACCOUNT        PIC X(10).
   345         16  MAIL-CERT-EFF-DT    PIC XX.
   346         16  MAIL-CERT-PRIME     PIC X(10).
   347         16  MAIL-CERT-SFX       PIC X.
   348     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   349     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   350     12  WS-CURRENT-DT.
   351         16  FILLER              PIC X(6)    VALUE SPACES.
   352         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   353     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   354     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   355         88  CANCEL-REC            VALUE 'C'.
   356         88  ISSUE-REC             VALUE 'I'.
   357     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   358     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   359     12  ELCNTL-KEY.
   360         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   361         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   362         16  CNTL-ACCESS.
   363             20  CNTL-STATE      PIC XX    VALUE SPACES.
   364             20  FILLER          PIC X     VALUE SPACES.
   365             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   366         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   367     12  WS-ERACCT-KEY.
   368         16  ACCT-COMPANY-CD     PIC X.
   369         16  ACCT-CARRIER        PIC X.
   370         16  ACCT-GROUPING       PIC X(6).
   371         16  ACCT-STATE          PIC XX.
   372         16  ACCT-ACCOUNT        PIC X(10).
   373         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   374         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   375     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   376     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   377     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   378     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   379     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   380     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   381     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   382     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   383     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   384     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   9
* EL6318.cbl
   385     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   386     12  WS-RESPONSE             PIC S9(8)   COMP.
   387         88  RESP-NORMAL                  VALUE +00.
   388         88  RESP-NOTFND                  VALUE +13.
   389         88  RESP-DUPREC                  VALUE +14.
   390         88  RESP-DUPKEY                  VALUE +15.
   391         88  RESP-NOTOPEN                 VALUE +19.
   392         88  RESP-ENDFILE                 VALUE +20.
   393     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   394     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   395     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   396     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   397     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   398     12  PGM-NAME            PIC X(8).
   399     12  TIME-IN             PIC S9(7).
   400     12  TIME-OUT-R  REDEFINES TIME-IN.
   401         16  FILLER          PIC X.
   402         16  TIME-OUT        PIC 99V99.
   403         16  FILLER          PIC X(2).
   404     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   405     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   406     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   407     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   408     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   409     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   410     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   411     12  WS-PHONE.
   412         16  WS-PH1              PIC XXX.
   413         16  WS-PH2              PIC XXX.
   414         16  WS-PH3              PIC XXXX.
   415     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   416     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   417
   418     12  WS-BILLING-NOTE.
   419         16  WS-BN-NOTE          PIC X(25).
   420         16  WS-BN-LTRID         PIC X(4).
   421         16  FILLER              PIC X(3).
   422         16  WS-BN-DATE          PIC X(8).
   423         16  FILLER              PIC X(3).
   424         16  WS-BN-USERID        PIC X(4).
   425         16  FILLER              PIC X(30).
   426
   427 01  NEW-ELCRTO-REC.
   428     12  NEW-ELCRTO-KEY.
   429         16  NCRTO-COMPANY-CD      PIC X.
   430         16  NCRTO-CARRIER         PIC X.
   431         16  NCRTO-GROUPING        PIC X(6).
   432         16  NCRTO-STATE           PIC XX.
   433         16  NCRTO-ACCOUNT         PIC X(10).
   434         16  NCRTO-CERT-EFF-DT     PIC XX.
   435         16  NCRTO-CERT-PRIME      PIC X(10).
   436         16  NCRTO-CERT-SFX        PIC X.
   437         16  NCRTO-RECORD-TYPE     PIC X.
   438         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   439     12  NEW-ORIG-REC.
   440         16  NCRTO-INS-LAST-NAME   PIC X(15).
   441         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   442         16  NCRTO-INS-MIDDLE-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  10
* EL6318.cbl
   443         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   444         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   445         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   446         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   447         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   448         16  NCRTO-LF-BENCD        PIC XX.
   449         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   450         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   451         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   452         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   453         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   454         16  NCRTO-LF-EXP-DT       PIC XX.
   455         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   456         16  NCRTO-LF-CANCEL-DT    PIC XX.
   457         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   458         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   459         16  NCRTO-AH-BENCD        PIC XX.
   460         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   461         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   462         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   463         16  NCRTO-AH-EXP-DT       PIC XX.
   464         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   465         16  NCRTO-AH-CP           PIC 99.
   466         16  NCRTO-AH-CANCEL-DT    PIC XX.
   467         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   468         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   469         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   470         16  NCRTO-1ST-PMT-DT      PIC XX.
   471         16  FILLER                PIC X(239).
   472
   473 01  CERT-NOTE-ENTRIES.
   474     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   475         16  CERT-NT-TEXT                PIC X(63).
   476         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   477         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   478         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   479
   480 01  ERCNOT-AREA.
   481     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   482     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   483     12  ERCNOT-KEY.
   484         16  ERCNOT-PARTIAL-KEY.
   485             20 ERCNOT-COMPANY-CD    PIC X.
   486             20 ERCNOT-CARRIER       PIC X.
   487             20 ERCNOT-GROUPING      PIC X(06).
   488             20 ERCNOT-STATE         PIC XX.
   489             20 ERCNOT-ACCOUNT       PIC X(10).
   490             20 ERCNOT-EFF-DT        PIC XX.
   491             20 ERCNOT-CERT-NO.
   492                25 ERCNOT-CERT-PRIME PIC X(10).
   493                25 ERCNOT-CERT-SFX   PIC X.
   494             20 ERCNOT-REC-TYP       PIC X.
   495         16 ERCNOT-SEQ           PIC S9(4) COMP.
   496     12  SV-PARTIAL-KEY.
   497         20 SV-COMPANY-CD            PIC X.
   498         20 SV-CARRIER               PIC X.
   499         20 SV-GROUPING              PIC X(06).
   500         20 SV-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  11
* EL6318.cbl
   501         20 SV-ACCOUNT               PIC X(10).
   502         20 SV-EFF-DT                PIC XX.
   503         20 SV-CERT-NO.
   504            25 SV-CERT-PRIME         PIC X(10).
   505            25 SV-CERT-SFX           PIC X(1).
   506         20 SV-REC-TYP               PIC X.
   507 01  ERROR-MESSAGES.
   508     12  ER-0000                 PIC X(4)  VALUE '0000'.
   509     12  ER-0004                 PIC X(4)  VALUE '0004'.
   510     12  ER-0008                 PIC X(4)  VALUE '0008'.
   511     12  ER-0023                 PIC X(4)  VALUE '0023'.
   512     12  ER-0029                 PIC X(4)  VALUE '0029'.
   513     12  ER-0068                 PIC X(4)  VALUE '0068'.
   514     12  ER-0132                 PIC X(4)  VALUE '0132'.
   515     12  ER-0142                 PIC X(4)  VALUE '0142'.
   516     12  ER-0148                 PIC X(4)  VALUE '0148'.
   517     12  ER-0215                 PIC X(4)  VALUE '0215'.
   518     12  ER-0280                 PIC X(4)  VALUE '0280'.
   519     12  ER-0348                 PIC X(4)  VALUE '0348'.
   520     12  ER-0419                 PIC X(4)  VALUE '0419'.
   521     12  ER-0715                 PIC X(4)  VALUE '0715'.
   522     12  ER-0894                 PIC X(4)  VALUE '0894'.
   523     12  ER-1101                 PIC X(4)  VALUE '1101'.
   524     12  ER-1236                 PIC X(4)  VALUE '1236'.
   525     12  ER-1778                 PIC X(4)  VALUE '1778'.
   526     12  ER-1818                 PIC X(4)  VALUE '1818'.
   527     12  ER-1820                 PIC X(4)  VALUE '1820'.
   528     12  ER-1821                 PIC X(4)  VALUE '1821'.
   529     12  ER-2056                 PIC X(4)  VALUE '2056'.
   530     12  ER-2079                 PIC X(4)  VALUE '2079'.
   531     12  ER-2208                 PIC X(4)  VALUE '2208'.
   532     12  ER-2209                 PIC X(4)  VALUE '2209'.
   533     12  ER-2237                 PIC X(4)  VALUE '2237'.
   534     12  ER-2238                 PIC X(4)  VALUE '2238'.
   535     12  ER-2253                 PIC X(4)  VALUE '2253'.
   536     12  ER-2619                 PIC X(4)  VALUE '2619'.
   537     12  ER-2651                 PIC X(4)  VALUE '2651'.
   538     12  ER-2784                 PIC X(4)  VALUE '2784'.
   539     12  ER-2785                 PIC X(4)  VALUE '2785'.
   540     12  ER-2786                 PIC X(4)  VALUE '2786'.
   541     12  ER-2791                 PIC X(4)  VALUE '2791'.
   542     12  ER-2845                 PIC X(4)  VALUE '2845'.
   543     12  ER-2848                 PIC X(4)  VALUE '2848'.
   544     12  ER-2851                 PIC X(4)  VALUE '2851'.
   545     12  ER-3830                 PIC X(4)  VALUE '3830'.
   546     12  ER-3832                 PIC X(4)  VALUE '3832'.
   547     12  ER-7345                 PIC X(4)  VALUE '7345'.
   548     12  ER-7638                 PIC X(4)  VALUE '7638'.
   549     12  ER-8888                 PIC X(4)  VALUE '8888'.
   550     12  ER-9999                 PIC X(4)  VALUE '9999'.
   551*    COPY ELCDATE.
   552******************************************************************
   553*                                                                *
   554*                                                                *
   555*                            ELCDATE.                            *
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   557*                            VMOD=2.003
   558*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  12
* EL6318.cbl
   559*                                                                *
   560*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   561*                 LENGTH = 200                                   *
   562******************************************************************
   563
   564 01  DATE-CONVERSION-DATA.
   565     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   566     12  DC-OPTION-CODE                PIC X.
   567         88  BIN-TO-GREG                VALUE ' '.
   568         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   569         88  EDIT-GREG-TO-BIN           VALUE '2'.
   570         88  YMD-GREG-TO-BIN            VALUE '3'.
   571         88  MDY-GREG-TO-BIN            VALUE '4'.
   572         88  JULIAN-TO-BIN              VALUE '5'.
   573         88  BIN-PLUS-ELAPSED           VALUE '6'.
   574         88  FIND-CENTURY               VALUE '7'.
   575         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   576         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   577         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   578         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   579         88  JULIAN-TO-BIN-3            VALUE 'C'.
   580         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   581         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   582         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   583         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   584         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   585         88  CHECK-LEAP-YEAR            VALUE 'H'.
   586         88  BIN-3-TO-GREG              VALUE 'I'.
   587         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   588         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   589         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   590         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   591         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   592         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   593         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   594         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   595         88  THREE-CHARACTER-BIN
   596                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   597         88  GREGORIAN-TO-BIN
   598                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   599         88  BIN-TO-GREGORIAN
   600                  VALUES ' ' '1' 'I' '8' 'G'.
   601         88  JULIAN-TO-BINARY
   602                  VALUES '5' 'C' 'E' 'F'.
   603     12  DC-ERROR-CODE                 PIC X.
   604         88  NO-CONVERSION-ERROR        VALUE ' '.
   605         88  DATE-CONVERSION-ERROR
   606                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   607         88  DATE-IS-ZERO               VALUE '1'.
   608         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   609         88  DATE-IS-INVALID            VALUE '3'.
   610         88  DATE1-GREATER-DATE2        VALUE '4'.
   611         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   612         88  DATE-INVALID-OPTION        VALUE '9'.
   613         88  INVALID-CENTURY            VALUE 'A'.
   614         88  ONLY-CENTURY               VALUE 'B'.
   615         88  ONLY-LEAP-YEAR             VALUE 'C'.
   616         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  13
* EL6318.cbl
   617     12  DC-END-OF-MONTH               PIC X.
   618         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   619     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   620         88  USE-NORMAL-PROCESS         VALUE ' '.
   621         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   622         88  ADJUST-UP-100-YRS          VALUE '2'.
   623     12  FILLER                        PIC X.
   624     12  DC-CONVERSION-DATES.
   625         16  DC-BIN-DATE-1             PIC XX.
   626         16  DC-BIN-DATE-2             PIC XX.
   627         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   628         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   629                       DC-GREG-DATE-1-EDIT.
   630             20  DC-EDIT1-MONTH        PIC 99.
   631             20  SLASH1-1              PIC X.
   632             20  DC-EDIT1-DAY          PIC 99.
   633             20  SLASH1-2              PIC X.
   634             20  DC-EDIT1-YEAR         PIC 99.
   635         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   636         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   637                     DC-GREG-DATE-2-EDIT.
   638             20  DC-EDIT2-MONTH        PIC 99.
   639             20  SLASH2-1              PIC X.
   640             20  DC-EDIT2-DAY          PIC 99.
   641             20  SLASH2-2              PIC X.
   642             20  DC-EDIT2-YEAR         PIC 99.
   643         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   644         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   645                     DC-GREG-DATE-1-YMD.
   646             20  DC-YMD-YEAR           PIC 99.
   647             20  DC-YMD-MONTH          PIC 99.
   648             20  DC-YMD-DAY            PIC 99.
   649         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   650         16  DC-GREG-DATE-1-MDY-R REDEFINES
   651                      DC-GREG-DATE-1-MDY.
   652             20  DC-MDY-MONTH          PIC 99.
   653             20  DC-MDY-DAY            PIC 99.
   654             20  DC-MDY-YEAR           PIC 99.
   655         16  DC-GREG-DATE-1-ALPHA.
   656             20  DC-ALPHA-MONTH        PIC X(10).
   657             20  DC-ALPHA-DAY          PIC 99.
   658             20  FILLER                PIC XX.
   659             20  DC-ALPHA-CENTURY.
   660                 24 DC-ALPHA-CEN-N     PIC 99.
   661             20  DC-ALPHA-YEAR         PIC 99.
   662         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   663         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   664         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   665         16  DC-JULIAN-DATE            PIC 9(05).
   666         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   667                                       PIC 9(05).
   668         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   669             20  DC-JULIAN-YEAR        PIC 99.
   670             20  DC-JULIAN-DAYS        PIC 999.
   671         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   672         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   673         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   674     12  DATE-CONVERSION-VARIBLES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  14
* EL6318.cbl
   675         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   676         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   677             20  FILLER                PIC 9(3).
   678             20  HOLD-CEN-1-CCYY.
   679                 24  HOLD-CEN-1-CC     PIC 99.
   680                 24  HOLD-CEN-1-YY     PIC 99.
   681             20  HOLD-CEN-1-MO         PIC 99.
   682             20  HOLD-CEN-1-DA         PIC 99.
   683         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   684             20  HOLD-CEN-1-R-MO       PIC 99.
   685             20  HOLD-CEN-1-R-DA       PIC 99.
   686             20  HOLD-CEN-1-R-CCYY.
   687                 24  HOLD-CEN-1-R-CC   PIC 99.
   688                 24  HOLD-CEN-1-R-YY   PIC 99.
   689             20  FILLER                PIC 9(3).
   690         16  HOLD-CENTURY-1-X.
   691             20  FILLER                PIC X(3)  VALUE SPACES.
   692             20  HOLD-CEN-1-X-CCYY.
   693                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   694                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   695             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   696             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   697         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   698             20  HOLD-CEN-1-R-X-MO     PIC XX.
   699             20  HOLD-CEN-1-R-X-DA     PIC XX.
   700             20  HOLD-CEN-1-R-X-CCYY.
   701                 24  HOLD-CEN-1-R-X-CC PIC XX.
   702                 24  HOLD-CEN-1-R-X-YY PIC XX.
   703             20  FILLER                PIC XXX.
   704         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   705         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   706         16  DC-JULIAN-DATE-1          PIC 9(07).
   707         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   708             20  DC-JULIAN-1-CCYY.
   709                 24  DC-JULIAN-1-CC    PIC 99.
   710                 24  DC-JULIAN-1-YR    PIC 99.
   711             20  DC-JULIAN-DA-1        PIC 999.
   712         16  DC-JULIAN-DATE-2          PIC 9(07).
   713         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   714             20  DC-JULIAN-2-CCYY.
   715                 24  DC-JULIAN-2-CC    PIC 99.
   716                 24  DC-JULIAN-2-YR    PIC 99.
   717             20  DC-JULIAN-DA-2        PIC 999.
   718         16  DC-GREG-DATE-A-EDIT.
   719             20  DC-EDITA-MONTH        PIC 99.
   720             20  SLASHA-1              PIC X VALUE '/'.
   721             20  DC-EDITA-DAY          PIC 99.
   722             20  SLASHA-2              PIC X VALUE '/'.
   723             20  DC-EDITA-CCYY.
   724                 24  DC-EDITA-CENT     PIC 99.
   725                 24  DC-EDITA-YEAR     PIC 99.
   726         16  DC-GREG-DATE-B-EDIT.
   727             20  DC-EDITB-MONTH        PIC 99.
   728             20  SLASHB-1              PIC X VALUE '/'.
   729             20  DC-EDITB-DAY          PIC 99.
   730             20  SLASHB-2              PIC X VALUE '/'.
   731             20  DC-EDITB-CCYY.
   732                 24  DC-EDITB-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  15
* EL6318.cbl
   733                 24  DC-EDITB-YEAR     PIC 99.
   734         16  DC-GREG-DATE-CYMD         PIC 9(08).
   735         16  DC-GREG-DATE-CYMD-R REDEFINES
   736                              DC-GREG-DATE-CYMD.
   737             20  DC-CYMD-CEN           PIC 99.
   738             20  DC-CYMD-YEAR          PIC 99.
   739             20  DC-CYMD-MONTH         PIC 99.
   740             20  DC-CYMD-DAY           PIC 99.
   741         16  DC-GREG-DATE-MDCY         PIC 9(08).
   742         16  DC-GREG-DATE-MDCY-R REDEFINES
   743                              DC-GREG-DATE-MDCY.
   744             20  DC-MDCY-MONTH         PIC 99.
   745             20  DC-MDCY-DAY           PIC 99.
   746             20  DC-MDCY-CEN           PIC 99.
   747             20  DC-MDCY-YEAR          PIC 99.
   748    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   749        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   750    12  DC-EL310-DATE                  PIC X(21).
   751    12  FILLER                         PIC X(28).
   752*    COPY ELCTEXT.
   753******************************************************************
   754*                                                                *
   755*                                                                *
   756*                            ELCTEXT.                            *
   757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   758*                            VMOD=2.008                          *
   759*                                                                *
   760*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   761*                                     FORM LETTERS,              *
   762*                                     CERT FORM DISPLAY.
   763*                                                                *
   764*   FILE TYPE = VSAM,KSDS                                        *
   765*   RECORD SIZE = 100   RECFORM = FIXED                          *
   766*                                                                *
   767*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   768*       ALTERNATE INDEX = NONE                                   *
   769*                                                                *
   770*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   771*       ALTERNATE INDEX = NONE                                   *
   772*                                                                *
   773*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   774*       ALTERNATE INDEX = NONE                                   *
   775*                                                                *
   776*   LOG = NO                                                     *
   777*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   778******************************************************************
   779 01  TEXT-FILES.
   780     12  TEXT-FILE-ID                PIC XX.
   781         88  FORMS-FILE-TEXT            VALUE 'TF'.
   782         88  LETTER-FILE-TEXT           VALUE 'TL'.
   783         88  HELP-FILE-TEXT             VALUE 'TH'.
   784
   785     12  TX-CONTROL-PRIMARY.
   786         16  TX-COMPANY-CD           PIC X.
   787             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   788         16  TX-ACCESS-CD-GENL       PIC X(12).
   789
   790         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  16
* EL6318.cbl
   791             20  TX-LETTER-NO        PIC X(4).
   792             20  FILLER              PIC X(8).
   793
   794         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   795             20  TX-FORM-NO          PIC X(12).
   796
   797         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   798             20  TX-HELP-TYPE        PIC X.
   799                 88  HELP-FOR-GENERAL   VALUE ' '.
   800                 88  HELP-BY-SCREEN     VALUE 'S'.
   801                 88  HELP-BY-ERROR      VALUE 'E'.
   802             20  TX-SCREEN-OR-ERROR  PIC X(4).
   803                 88  GENERAL-INFO-HELP  VALUE '0000'.
   804             20  TX-HELP-FOR-COMPANY  PIC XXX.
   805                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   806             20  FILLER              PIC X(4).
   807
   808         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   809
   810     12  TX-PROCESS-CONTROL          PIC XX.
   811         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   812
   813     12  TX-TEXT-LINE                PIC X(70).
   814
   815     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   816         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   817         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   818         88  TX-VALID-FORM-SQUEEZE-VALUE
   819                                        VALUE 'Y' ' '.
   820
   821     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   822         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   823         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   824         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   825         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   826         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   827         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   828         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   829                                              'K' 'N' ' '
   830                                              'Z'.
   831
   832     12  TX-ARCHIVE-SW               PIC X.
   833         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   834         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   835         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   836
   837     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   838     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   839
   840     12  TX-BSR-CODE                 PIC X.
   841         88  TX-BSR-LETTER              VALUE 'B'.
   842         88  TX-NON-BSR-LETTER          VALUE ' '.
   843
   844     12  FILLER                      PIC X.
   845*****************************************************************
   846*    COPY ELCLOGOF.
   847******************************************************************
   848*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  17
* EL6318.cbl
   849*                                                                *
   850*                            ELCLOGOF.                           *
   851*                            VMOD=2.001                          *
   852*                                                                *
   853*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   854*                                                                *
   855******************************************************************
   856 01  CLASIC-LOGOFF.
   857     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   858     12  LOGOFF-TEXT.
   859         16  FILLER          PIC X(5)    VALUE SPACES.
   860         16  LOGOFF-MSG.
   861             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   862             20  FILLER      PIC X       VALUE SPACES.
   863             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   864         16  FILLER          PIC X(80)
   865           VALUE '* YOU ARE NOW LOGGED OFF'.
   866         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   867         16  FILLER          PIC X       VALUE QUOTE.
   868         16  LOGOFF-SYS-MSG  PIC X(17)
   869           VALUE 'S CLAS-IC SYSTEM '.
   870     12  TEXT-MESSAGES.
   871         16  UNACCESS-MSG    PIC X(29)
   872             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   873         16  PGMIDERR-MSG    PIC X(17)
   874             VALUE 'PROGRAM NOT FOUND'.
   875*    COPY ELCATTR.
   876******************************************************************
   877*                                                                *
   878*                            ELCATTR.                            *
   879*                            VMOD=2.001                          *
   880*                                                                *
   881*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   882*                                                                *
   883*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   884*                                                                *
   885*                   POS 1   P=PROTECTED                          *
   886*                           U=UNPROTECTED                        *
   887*                           S=ASKIP                              *
   888*                   POS 2   A=ALPHA/NUMERIC                      *
   889*                           N=NUMERIC                            *
   890*                   POS 3   N=NORMAL                             *
   891*                           B=BRIGHT                             *
   892*                           D=DARK                               *
   893*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   894*                           OF=MODIFIED DATA TAG OFF             *
   895*                                                                *
   896*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   897******************************************************************
   898 01  ATTRIBUTE-LIST.
   899     12  AL-PABOF            PIC X       VALUE 'Y'.
   900     12  AL-PABON            PIC X       VALUE 'Z'.
   901     12  AL-PADOF            PIC X       VALUE '%'.
   902     12  AL-PADON            PIC X       VALUE '_'.
   903     12  AL-PANOF            PIC X       VALUE '-'.
   904     12  AL-PANON            PIC X       VALUE '/'.
   905     12  AL-SABOF            PIC X       VALUE '8'.
   906     12  AL-SABON            PIC X       VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  18
* EL6318.cbl
   907     12  AL-SADOF            PIC X       VALUE '@'.
   908     12  AL-SADON            PIC X       VALUE QUOTE.
   909     12  AL-SANOF            PIC X       VALUE '0'.
   910     12  AL-SANON            PIC X       VALUE '1'.
   911     12  AL-UABOF            PIC X       VALUE 'H'.
   912     12  AL-UABON            PIC X       VALUE 'I'.
   913     12  AL-UADOF            PIC X       VALUE '<'.
   914     12  AL-UADON            PIC X       VALUE '('.
   915     12  AL-UANOF            PIC X       VALUE ' '.
   916     12  AL-UANON            PIC X       VALUE 'A'.
   917     12  AL-UNBOF            PIC X       VALUE 'Q'.
   918     12  AL-UNBON            PIC X       VALUE 'R'.
   919     12  AL-UNDOF            PIC X       VALUE '*'.
   920     12  AL-UNDON            PIC X       VALUE ')'.
   921     12  AL-UNNOF            PIC X       VALUE '&'.
   922     12  AL-UNNON            PIC X       VALUE 'J'.
   923*    COPY ELCEMIB.
   924******************************************************************
   925*                                                                *
   926*                                                                *
   927*                            ELCEMIB.                            *
   928*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   929*                            VMOD=2.005                          *
   930*                                                                *
   931*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   932*                                                                *
   933******************************************************************
   934 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   935     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   936     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   937     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   938     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   939     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   940     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   941     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   942     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   943     12  EMI-SWITCH1             PIC X        VALUE '1'.
   944         88  EMI-NO-ERRORS                    VALUE '1'.
   945         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   946         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   947     12  EMI-SWITCH2             PIC X        VALUE '1'.
   948         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   949     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   950         88  EMI-AREA1-EMPTY                  VALUE '1'.
   951         88  EMI-AREA1-FULL                   VALUE '2'.
   952     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   953         88  EMI-AREA2-EMPTY                  VALUE '1'.
   954         88  EMI-AREA2-FULL                   VALUE '2'.
   955     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   956         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   957         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   958         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   959         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   960         88  EMI-BYPASS-FATALS                VALUE 'X'.
   961     12  EMI-ERROR-LINES.
   962         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   963         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   964         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  19
* EL6318.cbl
   965         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   966             20  EMI-ERR-CODES OCCURS 10 TIMES.
   967                 24  EMI-ERR-NUM         PIC X(4).
   968                 24  EMI-FILLER          PIC X.
   969                 24  EMI-SEV             PIC X.
   970                 24  FILLER              PIC X.
   971             20  FILLER                  PIC X(02).
   972     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   973         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   974             20  EMI-ERROR-NUMBER    PIC X(4).
   975             20  EMI-FILL            PIC X.
   976             20  EMI-SEVERITY        PIC X.
   977             20  FILLER              PIC X.
   978             20  EMI-ERROR-TEXT.
   979                 24  EMI-TEXT-VARIABLE   PIC X(10).
   980                 24  FILLER          PIC X(55).
   981     12  EMI-SEVERITY-SAVE           PIC X.
   982         88  EMI-NOTE                    VALUE 'N'.
   983         88  EMI-WARNING                 VALUE 'W'.
   984         88  EMI-FORCABLE                VALUE 'F'.
   985         88  EMI-FATAL                   VALUE 'X'.
   986     12  EMI-MESSAGE-FLAG            PIC X.
   987         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   988         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   989     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   990     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   991         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   992         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   993         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   994     12  FILLER                      PIC X(137)  VALUE SPACES.
   995     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   996     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   997     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   998     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   999*    COPY ELCINTF.
  1000******************************************************************
  1001*                                                                *
  1002*                                                                *
  1003*                            ELCINTF.                            *
  1004*                            VMOD=2.017                          *
  1005*                                                                *
  1006*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1007*                                                                *
  1008*       LENGTH = 1024                                            *
  1009*                                                                *
  1010******************************************************************
  1011*                   C H A N G E   L O G
  1012*
  1013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1014*-----------------------------------------------------------------
  1015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1016* EFFECTIVE    NUMBER
  1017*-----------------------------------------------------------------
  1018* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1019******************************************************************
  1020 01  PROGRAM-INTERFACE-BLOCK.
  1021     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1022     12  PI-CALLING-PROGRAM              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  20
* EL6318.cbl
  1023     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1024     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1025     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1026     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1027     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1028     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1029     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1030     12  PI-COMPANY-ID                   PIC XXX.
  1031     12  PI-COMPANY-CD                   PIC X.
  1032
  1033     12  PI-COMPANY-PASSWORD             PIC X(8).
  1034
  1035     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1036
  1037     12  PI-CONTROL-IN-PROGRESS.
  1038         16  PI-CARRIER                  PIC X.
  1039         16  PI-GROUPING                 PIC X(6).
  1040         16  PI-STATE                    PIC XX.
  1041         16  PI-ACCOUNT                  PIC X(10).
  1042         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1043                                         PIC X(10).
  1044         16  PI-CLAIM-CERT-GRP.
  1045             20  PI-CLAIM-NO             PIC X(7).
  1046             20  PI-CERT-NO.
  1047                 25  PI-CERT-PRIME       PIC X(10).
  1048                 25  PI-CERT-SFX         PIC X.
  1049             20  PI-CERT-EFF-DT          PIC XX.
  1050         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1051             20  PI-PLAN-CODE            PIC X(2).
  1052             20  PI-REVISION-NUMBER      PIC X(3).
  1053             20  PI-PLAN-EFF-DT          PIC X(2).
  1054             20  PI-PLAN-EXP-DT          PIC X(2).
  1055             20  FILLER                  PIC X(11).
  1056         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1057             20  PI-OE-REFERENCE-1.
  1058                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1059                 25  PI-OE-REF-1-SUFF    PIC XX.
  1060
  1061     12  PI-SESSION-IN-PROGRESS          PIC X.
  1062         88  CLAIM-SESSION                   VALUE '1'.
  1063         88  CREDIT-SESSION                  VALUE '2'.
  1064         88  WARRANTY-SESSION                VALUE '3'.
  1065         88  MORTGAGE-SESSION                VALUE '4'.
  1066         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1067
  1068
  1069*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1070
  1071     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1072     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1073
  1074     12  PI-CREDIT-USER                  PIC X.
  1075         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1076         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1077
  1078     12  PI-CLAIM-USER                   PIC X.
  1079         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1080         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  21
* EL6318.cbl
  1081
  1082     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1083         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1084         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1085         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1086         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1087         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1088
  1089     12  PI-PROCESSOR-ID                 PIC X(4).
  1090
  1091     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1092
  1093     12  PI-MEMBER-CAPTION               PIC X(10).
  1094
  1095     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1096         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1097
  1098     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1099     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1100     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1101     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1102
  1103     12  PI-AH-OVERRIDE-L1               PIC X.
  1104     12  PI-AH-OVERRIDE-L2               PIC XX.
  1105     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1106     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1107
  1108     12  PI-NEW-SYSTEM                   PIC X(2).
  1109
  1110     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1111     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1112         88  PI-USES-PAID-TO                 VALUE '1'.
  1113     12  PI-CRDTCRD-SYSTEM.
  1114         16  PI-CRDTCRD-USER             PIC X.
  1115             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1116             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1117         16  PI-CC-MONTH-END-DT          PIC XX.
  1118     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1119
  1120     12  PI-OE-REFERENCE-2.
  1121         16  PI-OE-REF-2-PRIME           PIC X(10).
  1122         16  PI-OE-REF-2-SUFF            PIC X.
  1123
  1124     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1125
  1126     12  PI-LANGUAGE-TYPE                PIC X.
  1127             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1128             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1129             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1130
  1131     12  PI-POLICY-LINKAGE-IND           PIC X.
  1132         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1133         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1134                                                   LOW-VALUES.
  1135
  1136     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1137     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1138         88  PI-CLAIM-CREDIT                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  22
* EL6318.cbl
  1139         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1140
  1141     12  PI-PROCESSOR-CSR-IND            PIC X.
  1142         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1143         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1144
  1145     12  FILLER                          PIC X(3).
  1146
  1147     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1148
  1149     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1150         PI-SYSTEM-LEVEL.
  1151
  1152         16  PI-ENTRY-CODES.
  1153             20  PI-ENTRY-CD-1           PIC X.
  1154             20  PI-ENTRY-CD-2           PIC X.
  1155
  1156         16  PI-RETURN-CODES.
  1157             20  PI-RETURN-CD-1          PIC X.
  1158             20  PI-RETURN-CD-2          PIC X.
  1159
  1160         16  PI-UPDATE-STATUS-SAVE.
  1161             20  PI-UPDATE-BY            PIC X(4).
  1162             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1163
  1164         16  PI-LOWER-CASE-LETTERS       PIC X.
  1165             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1166
  1167*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1168*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1169*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1170
  1171         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1172             88  ST-ACCNT-CNTL               VALUE ' '.
  1173             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1174             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1175             88  ACCNT-CNTL                  VALUE '3'.
  1176             88  CARR-ACCNT-CNTL             VALUE '4'.
  1177
  1178         16  PI-PROCESSOR-CAP-LIST.
  1179             20  PI-SYSTEM-CONTROLS.
  1180                24 PI-SYSTEM-DISPLAY     PIC X.
  1181                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1182                24 PI-SYSTEM-MODIFY      PIC X.
  1183                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1184             20  FILLER                  PIC XX.
  1185             20  PI-DISPLAY-CAP          PIC X.
  1186                 88  DISPLAY-CAP             VALUE 'Y'.
  1187             20  PI-MODIFY-CAP           PIC X.
  1188                 88  MODIFY-CAP              VALUE 'Y'.
  1189             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1190                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1191             20  PI-FORCE-CAP            PIC X.
  1192                 88  FORCE-CAP               VALUE 'Y'.
  1193
  1194         16  PI-PROGRAM-CONTROLS.
  1195             20  PI-PGM-PRINT-OPT        PIC X.
  1196             20  PI-PGM-FORMAT-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  23
* EL6318.cbl
  1197             20  PI-PGM-PROCESS-OPT      PIC X.
  1198             20  PI-PGM-TOTALS-OPT       PIC X.
  1199
  1200         16  PI-HELP-INTERFACE.
  1201             20  PI-LAST-ERROR-NO        PIC X(4).
  1202             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1203
  1204         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1205             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1206
  1207         16  PI-CR-CONTROL-IN-PROGRESS.
  1208             20  PI-CR-CARRIER           PIC X.
  1209             20  PI-CR-GROUPING          PIC X(6).
  1210             20  PI-CR-STATE             PIC XX.
  1211             20  PI-CR-ACCOUNT           PIC X(10).
  1212             20  PI-CR-FIN-RESP          PIC X(10).
  1213             20  PI-CR-TYPE              PIC X.
  1214
  1215         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1216
  1217         16  PI-CR-MONTH-END-DT          PIC XX.
  1218
  1219         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1220             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1221             88  PI-ZERO-CARRIER             VALUE '1'.
  1222             88  PI-ZERO-GROUPING            VALUE '2'.
  1223             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1224
  1225         16  PI-CARRIER-SECURITY         PIC X.
  1226             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1227
  1228         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1229             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1230             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1231
  1232         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1233             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1234                                         INDEXED BY PI-ACCESS-NDX
  1235                                         PIC X.
  1236
  1237         16  PI-GA-BILLING-CONTROL       PIC X.
  1238             88  PI-GA-BILLING               VALUE '1'.
  1239
  1240         16  PI-MAIL-PROCESSING          PIC X.
  1241             88  PI-MAIL-YES                 VALUE 'Y'.
  1242
  1243         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1244
  1245         16  PI-AR-SYSTEM.
  1246             20  PI-AR-PROCESSING-CNTL   PIC X.
  1247                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1248             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1249             20  PI-AR-MONTH-END-DT      PIC XX.
  1250
  1251         16  PI-MP-SYSTEM.
  1252             20  PI-MORTGAGE-USER            PIC X.
  1253                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1254                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  24
* EL6318.cbl
  1255             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1256                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1257                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1258                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1259                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1260                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1261             20  PI-MP-MONTH-END-DT          PIC XX.
  1262             20  PI-MP-REFERENCE-NO.
  1263                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1264                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1265
  1266         16  PI-LABEL-CONTROL            PIC X(01).
  1267             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1268             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1269
  1270         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1271             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1272
  1273         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1274             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1275             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1276
  1277         16  FILLER                      PIC X(14).
  1278
  1279     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1280******************************************************************
  1281     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1282        16  PI-ISS-CAN-SW           PIC X.
  1283        16  PI-ERENDT-KEY.
  1284            20  PI-ENDT-COMPANY-CD  PIC X.
  1285            20  PI-ENDT-CARRIER     PIC X.
  1286            20  PI-ENDT-GROUPING    PIC X(6).
  1287            20  PI-ENDT-STATE       PIC XX.
  1288            20  PI-ENDT-ACCOUNT     PIC X(10).
  1289            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1290            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1291            20  PI-ENDT-CERT-SFX    PIC X.
  1292            20  PI-ENDT-RECORD-TYPE PIC X.
  1293            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1294        16  PI-ELCRTO-KEY.
  1295            20  PI-CRTO-COMPANY-CD  PIC X.
  1296            20  PI-CRTO-CARRIER     PIC X.
  1297            20  PI-CRTO-GROUPING    PIC X(6).
  1298            20  PI-CRTO-STATE       PIC XX.
  1299            20  PI-CRTO-ACCOUNT     PIC X(10).
  1300            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1301            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1302            20  PI-CRTO-CERT-SFX    PIC X.
  1303            20  PI-CRTO-RECORD-TYPE PIC X.
  1304            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1305        16  PI-ERPNDB-KEY           PIC X(11).
  1306        16  PI-DOCUMENT-PROCESSED   PIC X.
  1307            88  PI-VERI-PROCESSED      VALUE 'V'.
  1308            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1309        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1310        16  PI-RES-REF-CLM-TYPE     PIC X.
  1311        16  PI-CLM-REFORM-IND       PIC X.
  1312            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  25
* EL6318.cbl
  1313        16  PI-CLEAR-ERROR-SW       PIC X.
  1314            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1315        16  PI-PRINT-CERTIFICATE    PIC X.
  1316        16  PI-ENTERED.
  1317            20  PI-PRTSW-ENTERED    PIC X.
  1318            20  PI-SIGREQ-ENTERED   PIC X.
  1319            20  PI-MONEY-ENTERED    PIC X.
  1320            20  PI-LTRID-ENTERED    PIC X(4).
  1321            20  PI-VOUCHER-ENTERED  PIC X.
  1322            20  PI-HLTHAPP-ENTERED  PIC X.
  1323            20  PI-PAYEE-ENTERED    PIC X(10).
  1324            20  PI-CERTID-ENTERED   PIC X(5).
  1325            20  PI-REASONS-ENTERED  PIC X(84).
  1326            20  PI-CERTNT1-ENTERED  PIC X(63).
  1327            20  PI-CERTNT2-ENTERED  PIC X(63).
  1328        16  PI-FINALIZED-IND        PIC X.
  1329        16  PI-CERTNT3-ENTERED      PIC X(63).
  1330        16  PI-CERTNT4-ENTERED      PIC X(63).
  1331        16  PI-CERTNT5-ENTERED      PIC X(63).
  1332        16  PI-CERTNT6-ENTERED      PIC X(63).
  1333        16  FILLER                  PIC X(28).
  1334    12  FILLER                      PIC X(276).
  1335*    COPY ELCAID.
  1336******************************************************************
  1337*                                                                *
  1338*                            ELCAID.                             *
  1339*                            VMOD=2.001                          *
  1340*                                                                *
  1341*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1342*                                                                *
  1343*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1344*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1345******************************************************************
  1346
  1347 01  DFHAID.
  1348   02  DFHNULL   PIC  X  VALUE  ' '.
  1349   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1350   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1351   02  DFHPEN    PIC  X  VALUE  '='.
  1352   02  DFHOPID   PIC  X  VALUE  'W'.
  1353   02  DFHPA1    PIC  X  VALUE  '%'.
  1354   02  DFHPA2    PIC  X  VALUE  '>'.
  1355   02  DFHPA3    PIC  X  VALUE  ','.
  1356   02  DFHPF1    PIC  X  VALUE  '1'.
  1357   02  DFHPF2    PIC  X  VALUE  '2'.
  1358   02  DFHPF3    PIC  X  VALUE  '3'.
  1359   02  DFHPF4    PIC  X  VALUE  '4'.
  1360   02  DFHPF5    PIC  X  VALUE  '5'.
  1361   02  DFHPF6    PIC  X  VALUE  '6'.
  1362   02  DFHPF7    PIC  X  VALUE  '7'.
  1363   02  DFHPF8    PIC  X  VALUE  '8'.
  1364   02  DFHPF9    PIC  X  VALUE  '9'.
  1365   02  DFHPF10   PIC  X  VALUE  ':'.
  1366   02  DFHPF11   PIC  X  VALUE  '#'.
  1367   02  DFHPF12   PIC  X  VALUE  '@'.
  1368   02  DFHPF13   PIC  X  VALUE  'A'.
  1369   02  DFHPF14   PIC  X  VALUE  'B'.
  1370   02  DFHPF15   PIC  X  VALUE  'C'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  26
* EL6318.cbl
  1371   02  DFHPF16   PIC  X  VALUE  'D'.
  1372   02  DFHPF17   PIC  X  VALUE  'E'.
  1373   02  DFHPF18   PIC  X  VALUE  'F'.
  1374   02  DFHPF19   PIC  X  VALUE  'G'.
  1375   02  DFHPF20   PIC  X  VALUE  'H'.
  1376   02  DFHPF21   PIC  X  VALUE  'I'.
  1377*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1378   02  DFHPF22   PIC  X  VALUE  '['.
  1379   02  DFHPF23   PIC  X  VALUE  '.'.
  1380   02  DFHPF24   PIC  X  VALUE  '<'.
  1381   02  DFHMSRE   PIC  X  VALUE  'X'.
  1382   02  DFHSTRF   PIC  X  VALUE  'h'.
  1383   02  DFHTRIG   PIC  X  VALUE  '"'.
  1384 01  FILLER    REDEFINES DFHAID.
  1385     12  FILLER              PIC X(8).
  1386     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1387     12  FILLER              PIC X(3).
  1388*   COPY EL6318S.
  1389 01  EL631KI.
  1390     05  FILLER            PIC  X(0012).
  1391*    -------------------------------
  1392     05  DATEL PIC S9(0004) COMP.
  1393     05  DATEF PIC  X(0001).
  1394     05  FILLER REDEFINES DATEF.
  1395         10  DATEA PIC  X(0001).
  1396     05  DATEI PIC  X(0008).
  1397*    -------------------------------
  1398     05  TIMEL PIC S9(0004) COMP.
  1399     05  TIMEF PIC  X(0001).
  1400     05  FILLER REDEFINES TIMEF.
  1401         10  TIMEA PIC  X(0001).
  1402     05  TIMEI PIC  X(0005).
  1403*    -------------------------------
  1404     05  PROCIDL PIC S9(0004) COMP.
  1405     05  PROCIDF PIC  X(0001).
  1406     05  FILLER REDEFINES PROCIDF.
  1407         10  PROCIDA PIC  X(0001).
  1408     05  PROCIDI PIC  X(0004).
  1409*    -------------------------------
  1410     05  HOSTL PIC S9(0004) COMP.
  1411     05  HOSTF PIC  X(0001).
  1412     05  FILLER REDEFINES HOSTF.
  1413         10  HOSTA PIC  X(0001).
  1414     05  HOSTI PIC  X(0009).
  1415*    -------------------------------
  1416     05  SYSL PIC S9(0004) COMP.
  1417     05  SYSF PIC  X(0001).
  1418     05  FILLER REDEFINES SYSF.
  1419         10  SYSA PIC  X(0001).
  1420     05  SYSI PIC  X(0005).
  1421*    -------------------------------
  1422     05  COMPANYL PIC S9(0004) COMP.
  1423     05  COMPANYF PIC  X(0001).
  1424     05  FILLER REDEFINES COMPANYF.
  1425         10  COMPANYA PIC  X(0001).
  1426     05  COMPANYI PIC  X(0003).
  1427*    -------------------------------
  1428     05  DATASORL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  27
* EL6318.cbl
  1429     05  DATASORF PIC  X(0001).
  1430     05  FILLER REDEFINES DATASORF.
  1431         10  DATASORA PIC  X(0001).
  1432     05  DATASORI PIC  X(0001).
  1433*    -------------------------------
  1434     05  BATCHNOL PIC S9(0004) COMP.
  1435     05  BATCHNOF PIC  X(0001).
  1436     05  FILLER REDEFINES BATCHNOF.
  1437         10  BATCHNOA PIC  X(0001).
  1438     05  BATCHNOI PIC  X(0006).
  1439*    -------------------------------
  1440     05  BSEQNOL PIC S9(0004) COMP.
  1441     05  BSEQNOF PIC  X(0001).
  1442     05  FILLER REDEFINES BSEQNOF.
  1443         10  BSEQNOA PIC  X(0001).
  1444     05  BSEQNOI PIC  X(0008).
  1445*    -------------------------------
  1446     05  ARCHNOL PIC S9(0004) COMP.
  1447     05  ARCHNOF PIC  X(0001).
  1448     05  FILLER REDEFINES ARCHNOF.
  1449         10  ARCHNOA PIC  X(0001).
  1450     05  ARCHNOI PIC  X(0008).
  1451*    -------------------------------
  1452     05  PRTSWL PIC S9(0004) COMP.
  1453     05  PRTSWF PIC  X(0001).
  1454     05  FILLER REDEFINES PRTSWF.
  1455         10  PRTSWA PIC  X(0001).
  1456     05  PRTSWI PIC  X(0001).
  1457*    -------------------------------
  1458     05  CARRL PIC S9(0004) COMP.
  1459     05  CARRF PIC  X(0001).
  1460     05  FILLER REDEFINES CARRF.
  1461         10  CARRA PIC  X(0001).
  1462     05  CARRI PIC  X(0001).
  1463*    -------------------------------
  1464     05  GROUPL PIC S9(0004) COMP.
  1465     05  GROUPF PIC  X(0001).
  1466     05  FILLER REDEFINES GROUPF.
  1467         10  GROUPA PIC  X(0001).
  1468     05  GROUPI PIC  X(0006).
  1469*    -------------------------------
  1470     05  STATEL PIC S9(0004) COMP.
  1471     05  STATEF PIC  X(0001).
  1472     05  FILLER REDEFINES STATEF.
  1473         10  STATEA PIC  X(0001).
  1474     05  STATEI PIC  X(0002).
  1475*    -------------------------------
  1476     05  ACCTL PIC S9(0004) COMP.
  1477     05  ACCTF PIC  X(0001).
  1478     05  FILLER REDEFINES ACCTF.
  1479         10  ACCTA PIC  X(0001).
  1480     05  ACCTI PIC  X(0010).
  1481*    -------------------------------
  1482     05  EFFDTL PIC S9(0004) COMP.
  1483     05  EFFDTF PIC  X(0001).
  1484     05  FILLER REDEFINES EFFDTF.
  1485         10  EFFDTA PIC  X(0001).
  1486     05  EFFDTI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  28
* EL6318.cbl
  1487*    -------------------------------
  1488     05  CERTNOL PIC S9(0004) COMP.
  1489     05  CERTNOF PIC  X(0001).
  1490     05  FILLER REDEFINES CERTNOF.
  1491         10  CERTNOA PIC  X(0001).
  1492     05  CERTNOI PIC  X(0010).
  1493*    -------------------------------
  1494     05  CRTSFXL PIC S9(0004) COMP.
  1495     05  CRTSFXF PIC  X(0001).
  1496     05  FILLER REDEFINES CRTSFXF.
  1497         10  CRTSFXA PIC  X(0001).
  1498     05  CRTSFXI PIC  X(0001).
  1499*    -------------------------------
  1500     05  SEQNOL PIC S9(0004) COMP.
  1501     05  SEQNOF PIC  X(0001).
  1502     05  FILLER REDEFINES SEQNOF.
  1503         10  SEQNOA PIC  X(0001).
  1504     05  SEQNOI PIC  X(0006).
  1505*    -------------------------------
  1506     05  SIGREQL PIC S9(0004) COMP.
  1507     05  SIGREQF PIC  X(0001).
  1508     05  FILLER REDEFINES SIGREQF.
  1509         10  SIGREQA PIC  X(0001).
  1510     05  SIGREQI PIC  X(0001).
  1511*    -------------------------------
  1512     05  LTRIDL PIC S9(0004) COMP.
  1513     05  LTRIDF PIC  X(0001).
  1514     05  FILLER REDEFINES LTRIDF.
  1515         10  LTRIDA PIC  X(0001).
  1516     05  LTRIDI PIC  X(0004).
  1517*    -------------------------------
  1518     05  HLTHAPPL PIC S9(0004) COMP.
  1519     05  HLTHAPPF PIC  X(0001).
  1520     05  FILLER REDEFINES HLTHAPPF.
  1521         10  HLTHAPPA PIC  X(0001).
  1522     05  HLTHAPPI PIC  X(0001).
  1523*    -------------------------------
  1524     05  VOUCHL PIC S9(0004) COMP.
  1525     05  VOUCHF PIC  X(0001).
  1526     05  FILLER REDEFINES VOUCHF.
  1527         10  VOUCHA PIC  X(0001).
  1528     05  VOUCHI PIC  X(0001).
  1529*    -------------------------------
  1530     05  PAYEEL PIC S9(0004) COMP.
  1531     05  PAYEEF PIC  X(0001).
  1532     05  FILLER REDEFINES PAYEEF.
  1533         10  PAYEEA PIC  X(0001).
  1534     05  PAYEEI PIC  X(0010).
  1535*    -------------------------------
  1536     05  CERTIDL PIC S9(0004) COMP.
  1537     05  CERTIDF PIC  X(0001).
  1538     05  FILLER REDEFINES CERTIDF.
  1539         10  CERTIDA PIC  X(0001).
  1540     05  CERTIDI PIC  X(0005).
  1541*    -------------------------------
  1542     05  RCD01L PIC S9(0004) COMP.
  1543     05  RCD01F PIC  X(0001).
  1544     05  FILLER REDEFINES RCD01F.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  29
* EL6318.cbl
  1545         10  RCD01A PIC  X(0001).
  1546     05  RCD01I PIC  X(0004).
  1547*    -------------------------------
  1548     05  RCD02L PIC S9(0004) COMP.
  1549     05  RCD02F PIC  X(0001).
  1550     05  FILLER REDEFINES RCD02F.
  1551         10  RCD02A PIC  X(0001).
  1552     05  RCD02I PIC  X(0004).
  1553*    -------------------------------
  1554     05  RCD03L PIC S9(0004) COMP.
  1555     05  RCD03F PIC  X(0001).
  1556     05  FILLER REDEFINES RCD03F.
  1557         10  RCD03A PIC  X(0001).
  1558     05  RCD03I PIC  X(0004).
  1559*    -------------------------------
  1560     05  RCD04L PIC S9(0004) COMP.
  1561     05  RCD04F PIC  X(0001).
  1562     05  FILLER REDEFINES RCD04F.
  1563         10  RCD04A PIC  X(0001).
  1564     05  RCD04I PIC  X(0004).
  1565*    -------------------------------
  1566     05  RCD05L PIC S9(0004) COMP.
  1567     05  RCD05F PIC  X(0001).
  1568     05  FILLER REDEFINES RCD05F.
  1569         10  RCD05A PIC  X(0001).
  1570     05  RCD05I PIC  X(0004).
  1571*    -------------------------------
  1572     05  RCD06L PIC S9(0004) COMP.
  1573     05  RCD06F PIC  X(0001).
  1574     05  FILLER REDEFINES RCD06F.
  1575         10  RCD06A PIC  X(0001).
  1576     05  RCD06I PIC  X(0004).
  1577*    -------------------------------
  1578     05  RCD07L PIC S9(0004) COMP.
  1579     05  RCD07F PIC  X(0001).
  1580     05  FILLER REDEFINES RCD07F.
  1581         10  RCD07A PIC  X(0001).
  1582     05  RCD07I PIC  X(0004).
  1583*    -------------------------------
  1584     05  RCD08L PIC S9(0004) COMP.
  1585     05  RCD08F PIC  X(0001).
  1586     05  FILLER REDEFINES RCD08F.
  1587         10  RCD08A PIC  X(0001).
  1588     05  RCD08I PIC  X(0004).
  1589*    -------------------------------
  1590     05  RCD09L PIC S9(0004) COMP.
  1591     05  RCD09F PIC  X(0001).
  1592     05  FILLER REDEFINES RCD09F.
  1593         10  RCD09A PIC  X(0001).
  1594     05  RCD09I PIC  X(0004).
  1595*    -------------------------------
  1596     05  RCD10L PIC S9(0004) COMP.
  1597     05  RCD10F PIC  X(0001).
  1598     05  FILLER REDEFINES RCD10F.
  1599         10  RCD10A PIC  X(0001).
  1600     05  RCD10I PIC  X(0004).
  1601*    -------------------------------
  1602     05  RCD11L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  30
* EL6318.cbl
  1603     05  RCD11F PIC  X(0001).
  1604     05  FILLER REDEFINES RCD11F.
  1605         10  RCD11A PIC  X(0001).
  1606     05  RCD11I PIC  X(0004).
  1607*    -------------------------------
  1608     05  RCD12L PIC S9(0004) COMP.
  1609     05  RCD12F PIC  X(0001).
  1610     05  FILLER REDEFINES RCD12F.
  1611         10  RCD12A PIC  X(0001).
  1612     05  RCD12I PIC  X(0004).
  1613*    -------------------------------
  1614     05  CRTNT1L PIC S9(0004) COMP.
  1615     05  CRTNT1F PIC  X(0001).
  1616     05  FILLER REDEFINES CRTNT1F.
  1617         10  CRTNT1A PIC  X(0001).
  1618     05  CRTNT1I PIC  X(0063).
  1619*    -------------------------------
  1620     05  CRTNT2L PIC S9(0004) COMP.
  1621     05  CRTNT2F PIC  X(0001).
  1622     05  FILLER REDEFINES CRTNT2F.
  1623         10  CRTNT2A PIC  X(0001).
  1624     05  CRTNT2I PIC  X(0063).
  1625*    -------------------------------
  1626     05  CRTNT3L PIC S9(0004) COMP.
  1627     05  CRTNT3F PIC  X(0001).
  1628     05  FILLER REDEFINES CRTNT3F.
  1629         10  CRTNT3A PIC  X(0001).
  1630     05  CRTNT3I PIC  X(0063).
  1631*    -------------------------------
  1632     05  CRTNT4L PIC S9(0004) COMP.
  1633     05  CRTNT4F PIC  X(0001).
  1634     05  FILLER REDEFINES CRTNT4F.
  1635         10  CRTNT4A PIC  X(0001).
  1636     05  CRTNT4I PIC  X(0063).
  1637*    -------------------------------
  1638     05  CRTNT5L PIC S9(0004) COMP.
  1639     05  CRTNT5F PIC  X(0001).
  1640     05  FILLER REDEFINES CRTNT5F.
  1641         10  CRTNT5A PIC  X(0001).
  1642     05  CRTNT5I PIC  X(0063).
  1643*    -------------------------------
  1644     05  CRTNT6L PIC S9(0004) COMP.
  1645     05  CRTNT6F PIC  X(0001).
  1646     05  FILLER REDEFINES CRTNT6F.
  1647         10  CRTNT6A PIC  X(0001).
  1648     05  CRTNT6I PIC  X(0063).
  1649*    -------------------------------
  1650     05  ERRMSG1L PIC S9(0004) COMP.
  1651     05  ERRMSG1F PIC  X(0001).
  1652     05  FILLER REDEFINES ERRMSG1F.
  1653         10  ERRMSG1A PIC  X(0001).
  1654     05  ERRMSG1I PIC  X(0075).
  1655*    -------------------------------
  1656     05  ERRMSG2L PIC S9(0004) COMP.
  1657     05  ERRMSG2F PIC  X(0001).
  1658     05  FILLER REDEFINES ERRMSG2F.
  1659         10  ERRMSG2A PIC  X(0001).
  1660     05  ERRMSG2I PIC  X(0075).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  31
* EL6318.cbl
  1661*    -------------------------------
  1662     05  PFENTRL PIC S9(0004) COMP.
  1663     05  PFENTRF PIC  X(0001).
  1664     05  FILLER REDEFINES PFENTRF.
  1665         10  PFENTRA PIC  X(0001).
  1666     05  PFENTRI PIC  9(2).
  1667 01  EL631KO REDEFINES EL631KI.
  1668     05  FILLER            PIC  X(0012).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  DATEO PIC  X(0008).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  TIMEO PIC  99.99.
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  PROCIDO PIC  X(0004).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  HOSTO PIC  X(0009).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  SYSO PIC  X(0005).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  COMPANYO PIC  X(0003).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  DATASORO PIC  X(0001).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  BATCHNOO PIC  X(0006).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  BSEQNOO PIC  X(0008).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  ARCHNOO PIC  X(0008).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  PRTSWO PIC  X(0001).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  CARRO PIC  X(0001).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  GROUPO PIC  X(0006).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  STATEO PIC  X(0002).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  ACCTO PIC  X(0010).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  EFFDTO PIC  X(0008).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  32
* EL6318.cbl
  1719     05  CERTNOO PIC  X(0010).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  CRTSFXO PIC  X(0001).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  SEQNOO PIC  999999.
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  SIGREQO PIC  X(0001).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  LTRIDO PIC  X(0004).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  HLTHAPPO PIC  X(0001).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  VOUCHO PIC  X(0001).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  PAYEEO PIC  X(0010).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  CERTIDO PIC  X(0005).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  RCD01O PIC  X(0004).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  RCD02O PIC  X(0004).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  RCD03O PIC  X(0004).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  RCD04O PIC  X(0004).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  RCD05O PIC  X(0004).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  RCD06O PIC  X(0004).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  RCD07O PIC  X(0004).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  RCD08O PIC  X(0004).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  RCD09O PIC  X(0004).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  RCD10O PIC  X(0004).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  RCD11O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  33
* EL6318.cbl
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  RCD12O PIC  X(0004).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  CRTNT1O PIC  X(0063).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  CRTNT2O PIC  X(0063).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  CRTNT3O PIC  X(0063).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  CRTNT4O PIC  X(0063).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  CRTNT5O PIC  X(0063).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  CRTNT6O PIC  X(0063).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  ERRMSG1O PIC  X(0075).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  ERRMSG2O PIC  X(0075).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  PFENTRO PIC  X(0002).
  1807*    -------------------------------
  1808 01  FILLER REDEFINES EL631KI.
  1809     12  FILLER             PIC X(211).
  1810     12  REASONCDS.
  1811         16  FILLER OCCURS 12.
  1812           20  REACDL       PIC S9(4) COMP.
  1813           20  REACDA       PIC X.
  1814           20  REACD-IN     PIC X(4).
  1815     12  FILLER             PIC X(293).
  1816****************************************************************
  1817*
  1818* Copyright (c) 2007 by Clerity Solutions, Inc.
  1819* All rights reserved.
  1820*
  1821****************************************************************
  1822 01  DFHEIV.
  1823   02  DFHEIV0               PIC X(35).
  1824   02  DFHEIV1               PIC X(08).
  1825   02  DFHEIV2               PIC X(08).
  1826   02  DFHEIV3               PIC X(08).
  1827   02  DFHEIV4               PIC X(06).
  1828   02  DFHEIV5               PIC X(04).
  1829   02  DFHEIV6               PIC X(04).
  1830   02  DFHEIV7               PIC X(02).
  1831   02  DFHEIV8               PIC X(02).
  1832   02  DFHEIV9               PIC X(01).
  1833   02  DFHEIV10              PIC S9(7) COMP-3.
  1834   02  DFHEIV11              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  34
* EL6318.cbl
  1835   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1836   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1837   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1838   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1839   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1840   02  DFHEIV17              PIC X(04).
  1841   02  DFHEIV18              PIC X(04).
  1842   02  DFHEIV19              PIC X(04).
  1843   02  DFHEIV20              USAGE IS POINTER.
  1844   02  DFHEIV21              USAGE IS POINTER.
  1845   02  DFHEIV22              USAGE IS POINTER.
  1846   02  DFHEIV23              USAGE IS POINTER.
  1847   02  DFHEIV24              USAGE IS POINTER.
  1848   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1849   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1850   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1851   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1852   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1853   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1854   02  FILLER                PIC X(02).
  1855   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1856   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1857   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1858   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1859   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1860 LINKAGE  SECTION.
  1861*****************************************************************
  1862*                                                               *
  1863* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1864* All rights reserved.                                          *
  1865*                                                               *
  1866*****************************************************************
  1867 01  dfheiblk.
  1868     02  eibtime          pic s9(7) comp-3.
  1869     02  eibdate          pic s9(7) comp-3.
  1870     02  eibtrnid         pic x(4).
  1871     02  eibtaskn         pic s9(7) comp-3.
  1872     02  eibtrmid         pic x(4).
  1873     02  dfheigdi         pic s9(4) comp.
  1874     02  eibcposn         pic s9(4) comp.
  1875     02  eibcalen         pic s9(4) comp.
  1876     02  eibaid           pic x(1).
  1877     02  eibfiller1       pic x(1).
  1878     02  eibfn            pic x(2).
  1879     02  eibfiller2       pic x(2).
  1880     02  eibrcode         pic x(6).
  1881     02  eibfiller3       pic x(2).
  1882     02  eibds            pic x(8).
  1883     02  eibreqid         pic x(8).
  1884     02  eibrsrce         pic x(8).
  1885     02  eibsync          pic x(1).
  1886     02  eibfree          pic x(1).
  1887     02  eibrecv          pic x(1).
  1888     02  eibsend          pic x(1).
  1889     02  eibatt           pic x(1).
  1890     02  eibeoc           pic x(1).
  1891     02  eibfmh           pic x(1).
  1892     02  eibcompl         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  35
* EL6318.cbl
  1893     02  eibsig           pic x(1).
  1894     02  eibconf          pic x(1).
  1895     02  eiberr           pic x(1).
  1896     02  eibrldbk         pic x(1).
  1897     02  eiberrcd         pic x(4).
  1898     02  eibsynrb         pic x(1).
  1899     02  eibnodat         pic x(1).
  1900     02  eibfiller5       pic x(2).
  1901     02  eibresp          pic 9(09) comp.
  1902     02  eibresp2         pic 9(09) comp.
  1903     02  dfheigdj         pic s9(4) comp.
  1904     02  dfheigdk         pic s9(4) comp.
  1905 01  DFHCOMMAREA                 PIC X(1300).
  1906 01  var  pic x(30).
  1907*                                COPY ERCACCT.
  1908******************************************************************
  1909*                                                                *
  1910*                                                                *
  1911*                            ERCACCT                             *
  1912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1913*                            VMOD=2.031                          *
  1914*                                                                *
  1915*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1916*                                                                *
  1917*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1918*   VSAM ACCOUNT MASTER FILES.                                   *
  1919*                                                                *
  1920*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1921*                                                                *
  1922*   FILE TYPE = VSAM,KSDS                                        *
  1923*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1924*                                                                *
  1925*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1926*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1927*                                                                *
  1928*   LOG = NO                                                     *
  1929*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1930*                                                                *
  1931*                                                                *
  1932******************************************************************
  1933*                   C H A N G E   L O G
  1934*
  1935* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1936*-----------------------------------------------------------------
  1937*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1938* EFFECTIVE    NUMBER
  1939*-----------------------------------------------------------------
  1940* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1941* 092705    2005050300006  PEMA  ADD SPP LEASES
  1942* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1943* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1944* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1945* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1946* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1947******************************************************************
  1948
  1949 01  ACCOUNT-MASTER.
  1950     12  AM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  36
* EL6318.cbl
  1951         88  VALID-AM-ID                      VALUE 'AM'.
  1952
  1953     12  AM-CONTROL-PRIMARY.
  1954         16  AM-COMPANY-CD                 PIC X.
  1955         16  AM-MSTR-CNTRL.
  1956             20  AM-CONTROL-A.
  1957                 24  AM-CARRIER            PIC X.
  1958                 24  AM-GROUPING.
  1959                     28 AM-GROUPING-PREFIX PIC XXX.
  1960                     28 AM-GROUPING-PRIME  PIC XXX.
  1961                 24  AM-STATE              PIC XX.
  1962                 24  AM-ACCOUNT.
  1963                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1964                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1965             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1966                                           PIC X(19).
  1967             20  AM-CNTRL-B.
  1968                 24  AM-EXPIRATION-DT      PIC XX.
  1969                 24  FILLER                PIC X(4).
  1970             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1971                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1972
  1973     12  AM-CONTROL-BY-VAR-GRP.
  1974         16  AM-COMPANY-CD-A1              PIC X.
  1975         16  AM-VG-CARRIER                 PIC X.
  1976         16  AM-VG-GROUPING                PIC X(6).
  1977         16  AM-VG-STATE                   PIC XX.
  1978         16  AM-VG-ACCOUNT                 PIC X(10).
  1979         16  AM-VG-DATE.
  1980             20  AM-VG-EXPIRATION-DT       PIC XX.
  1981             20  FILLER                    PIC X(4).
  1982         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1983                                           PIC 9(11)      COMP-3.
  1984     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1985         16  FILLER                        PIC X(10).
  1986         16  AM-VG-KEY3.
  1987             20  AM-VG3-ACCOUNT            PIC X(10).
  1988             20  AM-VG3-EXP-DT             PIC XX.
  1989         16  FILLER                        PIC X(4).
  1990     12  AM-MAINT-INFORMATION.
  1991         16  AM-LAST-MAINT-DT              PIC XX.
  1992         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1993         16  AM-LAST-MAINT-USER            PIC X(4).
  1994         16  FILLER                        PIC XX.
  1995
  1996     12  AM-EFFECTIVE-DT                   PIC XX.
  1997     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1998
  1999     12  AM-PREV-DATES  COMP-3.
  2000         16  AM-PREV-EXP-DT                PIC 9(11).
  2001         16  AM-PREV-EFF-DT                PIC 9(11).
  2002
  2003     12  AM-REPORT-CODE-1                  PIC X(10).
  2004     12  AM-REPORT-CODE-2                  PIC X(10).
  2005
  2006     12  AM-CITY-CODE                      PIC X(4).
  2007     12  AM-COUNTY-PARISH                  PIC X(6).
  2008
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  37
* EL6318.cbl
  2009     12  AM-NAME                           PIC X(30).
  2010     12  AM-PERSON                         PIC X(30).
  2011     12  AM-ADDRS                          PIC X(30).
  2012     12  AM-CITY.
  2013         16  AM-ADDR-CITY                  PIC X(28).
  2014         16  AM-ADDR-STATE                 PIC XX.
  2015     12  AM-ZIP.
  2016         16  AM-ZIP-PRIME.
  2017             20  AM-ZIP-PRI-1ST            PIC X.
  2018                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2019             20  FILLER                    PIC X(4).
  2020         16  AM-ZIP-PLUS4                  PIC X(4).
  2021     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2022         16  AM-CAN-POSTAL-1               PIC XXX.
  2023         16  AM-CAN-POSTAL-2               PIC XXX.
  2024         16  FILLER                        PIC XXX.
  2025     12  AM-TEL-NO.
  2026         16  AM-AREA-CODE                  PIC 999.
  2027         16  AM-TEL-PRE                    PIC 999.
  2028         16  AM-TEL-NBR                    PIC 9(4).
  2029     12  AM-TEL-LOC                        PIC X.
  2030         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2031         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2032
  2033     12  AM-COMM-STRUCTURE.
  2034         16  AM-DEFN-1.
  2035             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2036                 24  AM-AGT.
  2037                     28  AM-AGT-PREFIX     PIC X(4).
  2038                     28  AM-AGT-PRIME      PIC X(6).
  2039                 24  AM-COM-TYP            PIC X.
  2040                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2041                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2042                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2043                 24  AM-RECALC-LV-INDIC    PIC X.
  2044                 24  AM-RETRO-LV-INDIC     PIC X.
  2045                 24  AM-GL-CODES           PIC X.
  2046                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2047                 24  FILLER                PIC X(01).
  2048         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2049             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2050                 24  FILLER                PIC X(11).
  2051                 24  AM-L-COMA             PIC XXX.
  2052                 24  AM-J-COMA             PIC XXX.
  2053                 24  AM-A-COMA             PIC XXX.
  2054                 24  FILLER                PIC X(6).
  2055
  2056     12  AM-COMM-CHANGE-STATUS             PIC X.
  2057         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2058
  2059     12  AM-CSR-CODE                       PIC X(4).
  2060
  2061     12  AM-BILLING-STATUS                 PIC X.
  2062         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2063         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2064     12  AM-AUTO-REFUND-SW                 PIC X.
  2065         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2066         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  38
* EL6318.cbl
  2067     12  AM-GPCD                           PIC 99.
  2068     12  AM-IG                             PIC X.
  2069         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2070         88  AM-HAS-GROUP                     VALUE '2'.
  2071     12  AM-STATUS                         PIC X.
  2072         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2073         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2074         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2075         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2076         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2077         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2078     12  AM-REMIT-TO                       PIC 99.
  2079     12  AM-ID-NO                          PIC X(11).
  2080
  2081     12  AM-CAL-TABLE                      PIC XX.
  2082     12  AM-LF-DEVIATION                   PIC XXX.
  2083     12  AM-AH-DEVIATION                   PIC XXX.
  2084     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2085     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2086     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2087     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2088     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2089     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2090
  2091     12  AM-USER-FIELDS.
  2092         16  AM-FLD-1                      PIC XX.
  2093         16  AM-FLD-2                      PIC XX.
  2094         16  AM-FLD-3                      PIC XX.
  2095         16  AM-FLD-4                      PIC XX.
  2096         16  AM-FLD-5                      PIC XX.
  2097
  2098     12  AM-1ST-PROD-DATE.
  2099         16  AM-1ST-PROD-YR                PIC XX.
  2100         16  AM-1ST-PROD-MO                PIC XX.
  2101         16  AM-1ST-PROD-DA                PIC XX.
  2102     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2103     12  AM-CERTS-PURGED-DATE.
  2104         16  AM-PUR-YR                     PIC XX.
  2105         16  AM-PUR-MO                     PIC XX.
  2106         16  AM-PUR-DA                     PIC XX.
  2107     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2108     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2109     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2110     12  AM-INACTIVE-DATE.
  2111         16  AM-INA-MO                     PIC 99.
  2112         16  AM-INA-DA                     PIC 99.
  2113         16  AM-INA-YR                     PIC 99.
  2114     12  AM-AR-HI-CERT-DATE                PIC XX.
  2115
  2116     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2117     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2118
  2119     12  AM-OB-PAYMENT-MODE                PIC X.
  2120         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2121         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2122         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2123         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2124
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  39
* EL6318.cbl
  2125     12  AM-AH-ONLY-INDICATOR              PIC X.
  2126         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2127         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2128
  2129     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2130
  2131     12  AM-OVER-SHORT.
  2132         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2133         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2134
  2135     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2136     12  AM-DCC-CLP-STATE                  PIC XX.
  2137
  2138     12  AM-RECALC-COMM                    PIC X.
  2139     12  AM-RECALC-REIN                    PIC X.
  2140
  2141     12  AM-REI-TABLE                      PIC XXX.
  2142     12  AM-REI-ET-LF                      PIC X.
  2143     12  AM-REI-ET-AH                      PIC X.
  2144     12  AM-REI-PE-LF                      PIC X.
  2145     12  AM-REI-PE-AH                      PIC X.
  2146     12  AM-REI-PRT-ST                     PIC X.
  2147     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2148     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2149     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2150     12  AM-REI-GROUP-A                    PIC X(6).
  2151     12  AM-REI-MORT                       PIC X(4).
  2152     12  AM-REI-PRT-OW                     PIC X.
  2153     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2154     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2155     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2156     12  AM-REI-GROUP-B                    PIC X(6).
  2157
  2158     12  AM-TRUST-TYPE                     PIC X(2).
  2159
  2160     12  AM-EMPLOYER-STMT-USED             PIC X.
  2161     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2162
  2163     12  AM-STD-AH-TYPE                    PIC XX.
  2164     12  AM-EARN-METHODS.
  2165         16  AM-EARN-METHOD-R              PIC X.
  2166             88 AM-REF-RL-R78                 VALUE 'R'.
  2167             88 AM-REF-RL-PR                  VALUE 'P'.
  2168             88 AM-REF-RL-MEAN                VALUE 'M'.
  2169             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2170         16  AM-EARN-METHOD-L              PIC X.
  2171             88 AM-REF-LL-R78                 VALUE 'R'.
  2172             88 AM-REF-LL-PR                  VALUE 'P'.
  2173             88 AM-REF-LL-MEAN                VALUE 'M'.
  2174             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2175         16  AM-EARN-METHOD-A              PIC X.
  2176             88 AM-REF-AH-R78                 VALUE 'R'.
  2177             88 AM-REF-AH-PR                  VALUE 'P'.
  2178             88 AM-REF-AH-MEAN                VALUE 'M'.
  2179             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2180             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2181             88 AM-REF-AH-NET                 VALUE 'N'.
  2182
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  40
* EL6318.cbl
  2183     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2184     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2185     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2186
  2187     12  AM-RET-Y-N                        PIC X.
  2188     12  AM-RET-P-E                        PIC X.
  2189     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2190     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2191     12  AM-RET-GRP                        PIC X(6).
  2192     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2193         16  AM-POOL-PRIME                 PIC XXX.
  2194         16  AM-POOL-SUB                   PIC XXX.
  2195     12  AM-RETRO-EARNINGS.
  2196         16  AM-RET-EARN-R                 PIC X.
  2197         16  AM-RET-EARN-L                 PIC X.
  2198         16  AM-RET-EARN-A                 PIC X.
  2199     12  AM-RET-ST-TAX-USE                 PIC X.
  2200         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2201         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2202     12  AM-RETRO-BEG-EARNINGS.
  2203         16  AM-RET-BEG-EARN-R             PIC X.
  2204         16  AM-RET-BEG-EARN-L             PIC X.
  2205         16  AM-RET-BEG-EARN-A             PIC X.
  2206     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2207     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2208
  2209     12  AM-USER-SELECT-OPTIONS.
  2210         16  AM-USER-SELECT-1              PIC X(10).
  2211         16  AM-USER-SELECT-2              PIC X(10).
  2212         16  AM-USER-SELECT-3              PIC X(10).
  2213         16  AM-USER-SELECT-4              PIC X(10).
  2214         16  AM-USER-SELECT-5              PIC X(10).
  2215
  2216     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2217
  2218     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2219
  2220     12  AM-RPT045A-SWITCH                 PIC X.
  2221         88  RPT045A-OFF                   VALUE 'N'.
  2222
  2223     12  AM-INSURANCE-LIMITS.
  2224         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2225         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2226
  2227     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2228         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2229
  2230     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2231         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2232         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2233
  2234     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2235
  2236     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2237     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2238     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2239     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2240     12  AM-DCC-UEF-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  41
* EL6318.cbl
  2241     12  FILLER                            PIC XXX.
  2242     12  AM-REPORT-CODE-3                  PIC X(10).
  2243*    12  FILLER                            PIC X(22).
  2244
  2245     12  AM-RESERVE-DATE.
  2246         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2247         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2248         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2249
  2250     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2251     12  AM-NOTIFICATION-TYPES.
  2252         16  AM-NOTIF-OF-LETTERS           PIC X.
  2253         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2254         16  AM-NOTIF-OF-REPORTS           PIC X.
  2255         16  AM-NOTIF-OF-STATUS            PIC X.
  2256
  2257     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2258         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2259         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2260         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2261         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2262
  2263     12  AM-BENEFIT-CONTROLS.
  2264         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2265             20  AM-BENEFIT-CODE           PIC XX.
  2266             20  AM-BENEFIT-TYPE           PIC X.
  2267             20  AM-BENEFIT-REVISION       PIC XXX.
  2268             20  AM-BENEFIT-REM-TERM       PIC X.
  2269             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2270             20  FILLER                    PIC XX.
  2271         16  FILLER                        PIC X(80).
  2272
  2273     12  AM-TRANSFER-DATA.
  2274         16  AM-TRANSFERRED-FROM.
  2275             20  AM-TRNFROM-CARRIER        PIC X.
  2276             20  AM-TRNFROM-GROUPING.
  2277                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2278                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2279             20  AM-TRNFROM-STATE          PIC XX.
  2280             20  AM-TRNFROM-ACCOUNT.
  2281                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2282                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2283             20  AM-TRNFROM-DTE            PIC XX.
  2284         16  AM-TRANSFERRED-TO.
  2285             20  AM-TRNTO-CARRIER          PIC X.
  2286             20  AM-TRNTO-GROUPING.
  2287                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2288                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2289             20  AM-TRNTO-STATE            PIC XX.
  2290             20  AM-TRNTO-ACCOUNT.
  2291                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2292                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2293             20  AM-TRNTO-DTE              PIC XX.
  2294         16  FILLER                        PIC X(10).
  2295
  2296     12  AM-SAVED-REMIT-TO                 PIC 99.
  2297
  2298     12  AM-COMM-STRUCTURE-SAVED.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  42
* EL6318.cbl
  2299         16  AM-DEFN-1-SAVED.
  2300             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2301                 24  AM-AGT-SV             PIC X(10).
  2302                 24  AM-COM-TYP-SV         PIC X.
  2303                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2304                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2305                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2306                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2307                 24  FILLER                PIC X.
  2308                 24  AM-GL-CODES-SV        PIC X.
  2309                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2310                 24  FILLER                PIC X.
  2311         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2312             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2313                 24  FILLER                PIC X(11).
  2314                 24  AM-L-COMA-SV          PIC XXX.
  2315                 24  AM-J-COMA-SV          PIC XXX.
  2316                 24  AM-A-COMA-SV          PIC XXX.
  2317                 24  FILLER                PIC X(6).
  2318
  2319     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2320         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2321            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2322            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2323            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2324
  2325     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2326     12  FILLER                            PIC X(120).
  2327
  2328     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2329         16  AM-CONTROL-NAME               PIC X(30).
  2330         16  AM-EXECUTIVE-ONE.
  2331             20  AM-EXEC1-NAME             PIC X(15).
  2332             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2333                                                          COMP-3.
  2334             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2335                                                          COMP-3.
  2336         16  AM-EXECUTIVE-TWO.
  2337             20  AM-EXEC2-NAME             PIC X(15).
  2338             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2339                                                          COMP-3.
  2340             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2341                                                          COMP-3.
  2342
  2343     12  AM-RETRO-ADDITIONAL-DATA.
  2344         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2345         16  AM-RETRO-PREM-P-E             PIC X.
  2346         16  AM-RETRO-CLMS-P-I             PIC X.
  2347         16  AM-RETRO-RET-BRACKET-LF.
  2348             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2349                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2350                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2351             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2352                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2353                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2354             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2355                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2356                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  43
* EL6318.cbl
  2357         16  AM-RETRO-RET-BRACKET-AH.
  2358             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2359                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2360                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2361                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2362             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2363                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2364                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2365             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2366                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2367                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2368
  2369     12  AM-COMMENTS.
  2370         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2371
  2372     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2373         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2374         16  AM-FLI-BILLING-CODE           PIC X.
  2375         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2376         16  AM-FLI-UNITED-IDENT           PIC X.
  2377         16  AM-FLI-INTEREST-LOST-DATA.
  2378             20  AM-FLI-BANK-NO            PIC X(5).
  2379             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2380             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2381             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2382         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2383             20  AM-FLI-AGT                PIC X(9).
  2384             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2385             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2386         16  FILLER                        PIC X(102).
  2387
  2388     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2389         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2390             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2391             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2392             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2393             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2394             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2395         16  FILLER                          PIC X(10).
  2396******************************************************************
  2397*                                COPY ELCCNTL.
  2398******************************************************************
  2399*                                                                *
  2400*                                                                *
  2401*                            ELCCNTL.                            *
  2402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2403*                            VMOD=2.059                          *
  2404*                                                                *
  2405*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2406*                                                                *
  2407*   FILE TYPE = VSAM,KSDS                                        *
  2408*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2409*                                                                *
  2410*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2411*       ALTERNATE INDEX = NONE                                   *
  2412*                                                                *
  2413*   LOG = YES                                                    *
  2414*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  44
* EL6318.cbl
  2415******************************************************************
  2416*                   C H A N G E   L O G
  2417*
  2418* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2419*-----------------------------------------------------------------
  2420*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2421* EFFECTIVE    NUMBER
  2422*-----------------------------------------------------------------
  2423* 082503                   PEMA  ADD BENEFIT GROUP
  2424* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2425* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2426* 092705    2005050300006  PEMA  ADD SPP LEASES
  2427* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2428* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2429* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2430* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2431* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2432* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2433******************************************************************
  2434*
  2435 01  CONTROL-FILE.
  2436     12  CF-RECORD-ID                       PIC XX.
  2437         88  VALID-CF-ID                        VALUE 'CF'.
  2438
  2439     12  CF-CONTROL-PRIMARY.
  2440         16  CF-COMPANY-ID                  PIC XXX.
  2441         16  CF-RECORD-TYPE                 PIC X.
  2442             88  CF-COMPANY-MASTER              VALUE '1'.
  2443             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2444             88  CF-STATE-MASTER                VALUE '3'.
  2445             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2446             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2447             88  CF-CARRIER-MASTER              VALUE '6'.
  2448             88  CF-MORTALITY-MASTER            VALUE '7'.
  2449             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2450             88  CF-TERMINAL-MASTER             VALUE '9'.
  2451             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2452             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2453             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2454             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2455             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2456             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2457             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2458             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2459             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2460         16  CF-ACCESS-CD-GENL              PIC X(4).
  2461         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2462             20  CF-PROCESSOR               PIC X(4).
  2463         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2464             20  CF-STATE-CODE              PIC XX.
  2465             20  FILLER                     PIC XX.
  2466         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2467             20  FILLER                     PIC XX.
  2468             20  CF-HI-BEN-IN-REC           PIC XX.
  2469         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2470             20  FILLER                     PIC XXX.
  2471             20  CF-CARRIER-CNTL            PIC X.
  2472         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  45
* EL6318.cbl
  2473             20  FILLER                     PIC XX.
  2474             20  CF-HI-TYPE-IN-REC          PIC 99.
  2475         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2476             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2477                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2478             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2479             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2480         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2481             20  FILLER                     PIC X.
  2482             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2483         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2484             20  FILLER                     PIC XX.
  2485             20  CF-MORTGAGE-PLAN           PIC XX.
  2486         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2487
  2488     12  CF-LAST-MAINT-DT                   PIC XX.
  2489     12  CF-LAST-MAINT-BY                   PIC X(4).
  2490     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2491
  2492     12  CF-RECORD-BODY                     PIC X(728).
  2493
  2494
  2495****************************************************************
  2496*             COMPANY MASTER RECORD                            *
  2497****************************************************************
  2498
  2499     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2500         16  CF-COMPANY-ADDRESS.
  2501             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2502             20  CF-CL-IN-CARE-OF           PIC X(30).
  2503             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2504             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2505             20  CF-CL-CITY-STATE           PIC X(30).
  2506             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2507             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2508         16  CF-COMPANY-CD                  PIC X.
  2509         16  CF-COMPANY-PASSWORD            PIC X(8).
  2510         16  CF-SECURITY-OPTION             PIC X.
  2511             88  ALL-SECURITY                   VALUE '1'.
  2512             88  COMPANY-VERIFY                 VALUE '2'.
  2513             88  PROCESSOR-VERIFY               VALUE '3'.
  2514             88  NO-SECURITY                    VALUE '4'.
  2515             88  ALL-BUT-TERM                   VALUE '5'.
  2516         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2517             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2518         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2519             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2520         16  CF-INFORCE-LOCATION            PIC X.
  2521             88  CERTS-ARE-ONLINE               VALUE '1'.
  2522             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2523             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2524         16  CF-LOWER-CASE-LETTERS          PIC X.
  2525         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2526             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2527             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2528             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2529             88  CF-ACCNT-CNTL                  VALUE '3'.
  2530             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  46
* EL6318.cbl
  2531
  2532         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2533         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2534
  2535         16  CF-LGX-CREDIT-USER             PIC X.
  2536             88  CO-IS-NOT-USER                 VALUE 'N'.
  2537             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2538
  2539         16 CF-CREDIT-CALC-CODES.
  2540             20  CF-CR-REM-TERM-CALC PIC X.
  2541               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2542               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2543               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2544               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2545               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2546               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2547               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2548             20  CF-CR-R78-METHOD           PIC X.
  2549               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2550               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2551
  2552         16  CF-CLAIM-CONTROL-COUNTS.
  2553             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2554                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2555
  2556             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2557                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2558
  2559             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2560                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2561
  2562             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2563                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2564
  2565         16  CF-CURRENT-MONTH-END           PIC XX.
  2566
  2567         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2568             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2569             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2570             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2571             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2572                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2573                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2574             20  CF-CO-PREM-REJECT-SW       PIC X.
  2575                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2576                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2577             20  CF-CO-REF-REJECT-SW        PIC X.
  2578                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2579                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2580
  2581         16  CF-CO-REPORTING-DT             PIC XX.
  2582         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2583         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2584           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2585           88  CF-CO-MONTH-END                  VALUE '1'.
  2586
  2587         16  CF-LGX-CLAIM-USER              PIC X.
  2588             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  47
* EL6318.cbl
  2589             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2590
  2591         16  CF-CREDIT-EDIT-CONTROLS.
  2592             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2593             20  CF-MIN-AGE                 PIC 99.
  2594             20  CF-DEFAULT-AGE             PIC 99.
  2595             20  CF-MIN-TERM                PIC S999      COMP-3.
  2596             20  CF-MAX-TERM                PIC S999      COMP-3.
  2597             20  CF-DEFAULT-SEX             PIC X.
  2598             20  CF-JOINT-AGE-INPUT         PIC X.
  2599                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2600             20  CF-BIRTH-DATE-INPUT        PIC X.
  2601                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2602             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2603                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2604                 88  CF-ZERO-CARRIER            VALUE '1'.
  2605                 88  CF-ZERO-GROUPING           VALUE '2'.
  2606                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2607             20  CF-EDIT-SW                 PIC X.
  2608                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2609             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2610             20  CF-CR-PR-METHOD            PIC X.
  2611               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2612               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2613             20  FILLER                     PIC X.
  2614
  2615         16  CF-CREDIT-MISC-CONTROLS.
  2616             20  CF-REIN-TABLE-SW           PIC X.
  2617                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2618             20  CF-COMP-TABLE-SW           PIC X.
  2619                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2620             20  CF-EXPERIENCE-RETENTION-AGE
  2621                                            PIC S9        COMP-3.
  2622             20  CF-CONVERSION-DT           PIC XX.
  2623             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2624             20  CF-RUN-FREQUENCY-SW        PIC X.
  2625                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2626                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2627
  2628             20  CF-CR-CHECK-NO-CONTROL.
  2629                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2630                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2631                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2632                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2633                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2634                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2635
  2636                 24  CF-CR-CHECK-COUNT       REDEFINES
  2637                     CF-CR-CHECK-COUNTER      PIC X(4).
  2638
  2639                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2640                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2641
  2642                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2643                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2644                 24  CF-MAIL-PROCESSING       PIC X.
  2645                     88  MAIL-PROCESSING          VALUE 'Y'.
  2646
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  48
* EL6318.cbl
  2647         16  CF-MISC-SYSTEM-CONTROL.
  2648             20  CF-SYSTEM-C                 PIC X.
  2649                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2650             20  CF-SYSTEM-D                 PIC X.
  2651                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2652             20  CF-SOC-SEC-NO-SW            PIC X.
  2653                 88  SOC-SEC-NO-USED             VALUE '1'.
  2654             20  CF-MEMBER-NO-SW             PIC X.
  2655                 88  MEMBER-NO-USED              VALUE '1'.
  2656             20  CF-TAX-ID-NUMBER            PIC X(11).
  2657             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2658             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2659                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2660                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2661                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2662                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2663             20  CF-SYSTEM-E                 PIC X.
  2664                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2665
  2666         16  CF-LGX-LIFE-USER               PIC X.
  2667             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2668             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2669
  2670         16  CF-CR-MONTH-END-DT             PIC XX.
  2671
  2672         16  CF-FILE-MAINT-DATES.
  2673             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2674                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2675             20  CF-LAST-BATCH       REDEFINES
  2676                 CF-LAST-BATCH-NO               PIC X(4).
  2677             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2678             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2679             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2680             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2681             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2682             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2683             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2684             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2685             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2686             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2687
  2688         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2689         16  FILLER                         PIC X.
  2690
  2691         16  CF-ALT-MORT-CODE               PIC X(4).
  2692         16  CF-MEMBER-CAPTION              PIC X(10).
  2693
  2694         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2695             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2696             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2697             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2698             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2699             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2700
  2701         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2702
  2703         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2704         16  CF-LIFE-OVERRIDE-L2            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  49
* EL6318.cbl
  2705         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2706         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2707
  2708         16  CF-AH-OVERRIDE-L1              PIC X.
  2709         16  CF-AH-OVERRIDE-L2              PIC XX.
  2710         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2711         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2712
  2713         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2714         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2715
  2716         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2717         16  CF-AR-LAST-EL860-DT            PIC XX.
  2718         16  CF-MP-MONTH-END-DT             PIC XX.
  2719
  2720         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2721         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2722             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2723
  2724         16  CF-AR-MONTH-END-DT             PIC XX.
  2725
  2726         16  CF-CRDTCRD-USER                PIC X.
  2727             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2728             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2729
  2730         16  CF-CC-MONTH-END-DT             PIC XX.
  2731
  2732         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2733
  2734         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2735             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2736             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2737             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2738         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2739         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2740         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2741         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2742             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2743             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2744         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2745         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2746         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2747             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2748         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2749
  2750         16  CF-CL-ZIP-CODE.
  2751             20  CF-CL-ZIP-PRIME.
  2752                 24  CF-CL-ZIP-1ST          PIC X.
  2753                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2754                 24  FILLER                 PIC X(4).
  2755             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2756         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2757             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2758             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2759             20  FILLER                     PIC XXX.
  2760
  2761         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2762         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  50
* EL6318.cbl
  2763         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2764         16  CF-CO-OPTION-START-DATE        PIC XX.
  2765         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2766           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2767                                                      '3' '4'.
  2768           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2769           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2770           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2771           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2772           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2773           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2774
  2775         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2776
  2777         16  CF-PAYMENT-APPROVAL-LEVELS.
  2778             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2779             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2780             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2781             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2782             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2783             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2784
  2785         16  CF-END-USER-REPORTING-USER     PIC X.
  2786             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2787             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2788
  2789         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2790             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2791             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2792
  2793         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2794
  2795         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2796         16  FILLER                         PIC X.
  2797
  2798         16  CF-CREDIT-ARCHIVE-CNTL.
  2799             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2800             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2801             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2802
  2803         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2804
  2805         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2806             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2807             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2808
  2809         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2810             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2811             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2812
  2813         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2814
  2815         16  CF-CO-ACH-ID-CODE              PIC  X.
  2816             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2817             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2818             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2819         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2820         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  51
* EL6318.cbl
  2821         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2822         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2823         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2824         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2825         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2826         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2827         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2828                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2829         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2830                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2831
  2832         16  CF-CO-OVER-SHORT.
  2833             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2834             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2835
  2836*         16  FILLER                         PIC X(102).
  2837         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2838             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2839             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2840
  2841         16  CF-AH-APPROVAL-DAYS.
  2842             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2843             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2844             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2845             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2846
  2847         16  FILLER                         PIC X(82).
  2848****************************************************************
  2849*             PROCESSOR/USER RECORD                            *
  2850****************************************************************
  2851
  2852     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2853         16  CF-PROCESSOR-NAME              PIC X(30).
  2854         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2855         16  CF-PROCESSOR-TITLE             PIC X(26).
  2856         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2857                 88  MESSAGE-YES                VALUE 'Y'.
  2858                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2859
  2860*****************************************************
  2861****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2862****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2863****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2864****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2865*****************************************************
  2866
  2867         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2868             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2869             20  CF-APPLICATION-FORCE       PIC X.
  2870             20  CF-INDIVIDUAL-APP.
  2871                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2872                     28  CF-BROWSE-APP      PIC X.
  2873                     28  CF-UPDATE-APP      PIC X.
  2874
  2875         16  CF-CURRENT-TERM-ON             PIC X(4).
  2876         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2877             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2878             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  52
* EL6318.cbl
  2879             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2880             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2881             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2882             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2883             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2884         16  CF-PROCESSOR-CARRIER           PIC X.
  2885             88  NO-CARRIER-SECURITY            VALUE ' '.
  2886         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2887             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2888         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2889             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2890         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2891             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2892
  2893         16  CF-PROC-SYS-ACCESS-SW.
  2894             20  CF-PROC-CREDIT-CLAIMS-SW.
  2895                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2896                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2897                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2898                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2899             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2900                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2901                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2902             20  CF-PROC-LIFE-GNRLDGR-SW.
  2903                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2904                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2905                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2906                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2907             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2908                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2909                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2910         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2911             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2912             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2913         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2914
  2915         16  CF-APPROVAL-LEVEL                  PIC X.
  2916             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2917             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2918             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2919             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2920
  2921         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2922
  2923         16  CF-LANGUAGE-TYPE                   PIC X.
  2924             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2925             88  CF-LANG-IS-FR                      VALUE 'F'.
  2926
  2927         16  CF-CSR-IND                         PIC X.
  2928         16  FILLER                             PIC X(239).
  2929
  2930****************************************************************
  2931*             PROCESSOR/REMINDERS RECORD                       *
  2932****************************************************************
  2933
  2934     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2935         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2936             20  CF-START-REMIND-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  53
* EL6318.cbl
  2937             20  CF-END-REMIND-DT           PIC XX.
  2938             20  CF-REMINDER-TEXT           PIC X(50).
  2939         16  FILLER                         PIC X(296).
  2940
  2941
  2942****************************************************************
  2943*             STATE MASTER RECORD                              *
  2944****************************************************************
  2945
  2946     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2947         16  CF-STATE-ABBREVIATION          PIC XX.
  2948         16  CF-STATE-NAME                  PIC X(25).
  2949         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2950         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2951             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2952             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2953             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2954             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2955                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2956                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2957             20  CF-ST-PREM-REJECT-SW       PIC X.
  2958                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2959                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2960             20  CF-ST-REF-REJECT-SW        PIC X.
  2961                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2962                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2963         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2964         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2965         16  CF-ST-REFUND-RULES.
  2966             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2967             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2968             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2969         16  CF-ST-FST-PMT-EXTENSION.
  2970             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2971             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2972                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2973                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2974                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2975                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2976         16  CF-ST-STATE-CALL.
  2977             20  CF-ST-CALL-UNEARNED        PIC X.
  2978             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2979             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2980         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2981             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2982             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2983         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2984         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2985         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2986         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2987         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2988         16  FILLER                         PIC X.
  2989         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2990             20  CF-ST-BENEFIT-CD           PIC XX.
  2991             20  CF-ST-BENEFIT-KIND         PIC X.
  2992                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2993                 88  CF-ST-AH-KIND              VALUE 'A'.
  2994             20  CF-ST-REM-TERM-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  54
* EL6318.cbl
  2995                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2996                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2997                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2998                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2999                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3000                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3001                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3002                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3003
  3004             20  CF-ST-REFUND-CALC          PIC X.
  3005                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3006                 88  ST-REFD-BY-R78             VALUE '1'.
  3007                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3008                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3009                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3010                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3011                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3012                 88  ST-REFD-UTAH               VALUE '7'.
  3013                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3014                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3015                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3016
  3017             20  CF-ST-EARNING-CALC         PIC X.
  3018                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3019                 88  ST-EARN-BY-R78             VALUE '1'.
  3020                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3021                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3022                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3023                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3024                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3025                 88  ST-EARN-MEAN               VALUE '8'.
  3026                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3027
  3028             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3029                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3030                 88  ST-OVRD-BY-R78             VALUE '1'.
  3031                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3032                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3033                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3034                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3035                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3036                 88  ST-OVRD-MEAN               VALUE '8'.
  3037                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3038             20  FILLER                     PIC X.
  3039
  3040         16  CF-ST-COMMISSION-CAPS.
  3041             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3042             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3043             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3044             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3045         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3046                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3047
  3048         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3049
  3050         16  CF-ST-STATUTORY-INTEREST.
  3051             20  CF-ST-STAT-DATE-FROM       PIC X.
  3052                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  55
* EL6318.cbl
  3053                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3054             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3055             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3056             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3057             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3058             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3059
  3060         16  CF-ST-OVER-SHORT.
  3061             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3062             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3063
  3064         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3065
  3066         16  CF-ST-RT-CALC                  PIC X.
  3067
  3068         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3069         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3070         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3071         16  CF-ST-RF-LR-CALC               PIC X.
  3072         16  CF-ST-RF-LL-CALC               PIC X.
  3073         16  CF-ST-RF-LN-CALC               PIC X.
  3074         16  CF-ST-RF-AH-CALC               PIC X.
  3075         16  CF-ST-RF-CP-CALC               PIC X.
  3076*        16  FILLER                         PIC X(206).
  3077*CIDMOD         16  FILLER                         PIC X(192).
  3078         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3079             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3080         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3081         16  CF-ST-VFY-2ND-BENE             PIC X.
  3082         16  FILLER                         PIC X(186).
  3083
  3084****************************************************************
  3085*             BENEFIT MASTER RECORD                            *
  3086****************************************************************
  3087
  3088     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3089         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3090             20  CF-BENEFIT-CODE            PIC XX.
  3091             20  CF-BENEFIT-NUMERIC  REDEFINES
  3092                 CF-BENEFIT-CODE            PIC XX.
  3093             20  CF-BENEFIT-ALPHA           PIC XXX.
  3094             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3095             20  CF-BENEFIT-COMMENT         PIC X(10).
  3096
  3097             20  CF-LF-COVERAGE-TYPE        PIC X.
  3098                 88  CF-REDUCING                VALUE 'R'.
  3099                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3100
  3101             20  CF-SPECIAL-CALC-CD         PIC X.
  3102                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3103                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3104                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3105                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3106                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3107                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3108                 88  CF-FARM-PLAN               VALUE 'F'.
  3109                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3110                 88  CF-2-MTH-INTEREST          VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  56
* EL6318.cbl
  3111                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3112                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3113                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3114                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3115                 88  CF-PRUDENTIAL              VALUE 'P'.
  3116                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3117                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3118                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3119                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3120                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3121                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3122
  3123             20  CF-JOINT-INDICATOR         PIC X.
  3124                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3125
  3126*            20  FILLER                     PIC X(12).
  3127             20  FILLER                     PIC X(11).
  3128             20  CF-BENEFIT-CATEGORY        PIC X.
  3129             20  CF-LOAN-TYPE               PIC X(8).
  3130
  3131             20  CF-CO-REM-TERM-CALC        PIC X.
  3132                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3133                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3134                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3135                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3136                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3137
  3138             20  CF-CO-EARNINGS-CALC        PIC X.
  3139                 88  CO-EARN-BY-R78             VALUE '1'.
  3140                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3141                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3142                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3143                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3144                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3145                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3146                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3147
  3148             20  CF-CO-REFUND-CALC          PIC X.
  3149                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3150                 88  CO-REFD-BY-R78             VALUE '1'.
  3151                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3152                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3153                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3154                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3155                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3156                 88  CO-REFD-MEAN               VALUE '8'.
  3157                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3158                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3159                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3160
  3161             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3162                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3163                 88  CO-OVRD-BY-R78             VALUE '1'.
  3164                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3165                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3166                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3167                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3168                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  57
* EL6318.cbl
  3169                 88  CO-OVRD-MEAN               VALUE '8'.
  3170                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3171
  3172             20  CF-CO-BEN-I-G-CD           PIC X.
  3173                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3174                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3175                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3176
  3177         16  FILLER                         PIC X(304).
  3178
  3179
  3180****************************************************************
  3181*             CARRIER MASTER RECORD                            *
  3182****************************************************************
  3183
  3184     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3185         16  CF-ADDRESS-DATA.
  3186             20  CF-MAIL-TO-NAME            PIC X(30).
  3187             20  CF-IN-CARE-OF              PIC X(30).
  3188             20  CF-ADDRESS-LINE-1          PIC X(30).
  3189             20  CF-ADDRESS-LINE-2          PIC X(30).
  3190             20  CF-CITY-STATE              PIC X(30).
  3191             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3192             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3193
  3194         16  CF-CLAIM-NO-CONTROL.
  3195             20  CF-CLAIM-NO-METHOD         PIC X.
  3196                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3197                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3198                 88  CLAIM-NO-SEQ               VALUE '3'.
  3199                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3200             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3201                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3202                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3203                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3204
  3205         16  CF-CHECK-NO-CONTROL.
  3206             20  CF-CHECK-NO-METHOD         PIC X.
  3207                 88  CHECK-NO-MANUAL            VALUE '1'.
  3208                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3209                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3210                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3211             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3212                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3213
  3214         16  CF-DOMICILE-STATE              PIC XX.
  3215
  3216         16  CF-EXPENSE-CONTROLS.
  3217             20  CF-EXPENSE-METHOD          PIC X.
  3218                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3219                 88  DOLLARS-PER-PMT            VALUE '2'.
  3220                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3221                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3222             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3223             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3224
  3225         16  CF-CORRESPONDENCE-CONTROL.
  3226             20  CF-LETTER-RESEND-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  58
* EL6318.cbl
  3227                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3228                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3229             20  FILLER                     PIC X(4).
  3230
  3231         16  CF-RESERVE-CONTROLS.
  3232             20  CF-MANUAL-SW               PIC X.
  3233                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3234             20  CF-FUTURE-SW               PIC X.
  3235                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3236             20  CF-PTC-SW                  PIC X.
  3237                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3238             20  CF-IBNR-SW                 PIC X.
  3239                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3240             20  CF-PTC-LF-SW               PIC X.
  3241                 88  CF-LF-PTC-USED             VALUE '1'.
  3242             20  CF-CDT-ACCESS-METHOD       PIC X.
  3243                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3244                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3245                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3246             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3247
  3248         16  CF-CLAIM-CALC-METHOD           PIC X.
  3249             88  360-PLUS-MONTHS                VALUE '1'.
  3250             88  365-PLUS-MONTHS                VALUE '2'.
  3251             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3252             88  360-DAILY                      VALUE '4'.
  3253             88  365-DAILY                      VALUE '5'.
  3254
  3255         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3256         16  FILLER                         PIC X(11).
  3257
  3258         16  CF-LIMIT-AMOUNTS.
  3259             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3260             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3261             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3262             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3263             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3264             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3265             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3266             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3267             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3268             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3269
  3270         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3271         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3272         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3273
  3274         16  CF-ZIP-CODE.
  3275             20  CF-ZIP-PRIME.
  3276                 24  CF-ZIP-1ST             PIC X.
  3277                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3278                 24  FILLER                 PIC X(4).
  3279             20  CF-ZIP-PLUS4               PIC X(4).
  3280         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3281             20  CF-CAN-POSTAL-1            PIC XXX.
  3282             20  CF-CAN-POSTAL-2            PIC XXX.
  3283             20  FILLER                     PIC XXX.
  3284
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  59
* EL6318.cbl
  3285         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3286         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3287         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3288
  3289         16  CF-RATING-SWITCH               PIC X.
  3290             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3291             88  CF-NO-RATING                   VALUE 'N'.
  3292
  3293         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3294
  3295         16  CF-CARRIER-OVER-SHORT.
  3296             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3297             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3298
  3299         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3300         16  CF-SECPAY-SWITCH               PIC X.
  3301             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3302             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3303         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3304         16  FILLER                         PIC X(448).
  3305*        16  FILLER                         PIC X(452).
  3306
  3307
  3308****************************************************************
  3309*             MORTALITY MASTER RECORD                          *
  3310****************************************************************
  3311
  3312     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3313         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3314                                INDEXED BY CF-MORT-NDX.
  3315             20  CF-MORT-TABLE              PIC X(5).
  3316             20  CF-MORT-TABLE-TYPE         PIC X.
  3317                 88  CF-MORT-JOINT              VALUE 'J'.
  3318                 88  CF-MORT-SINGLE             VALUE 'S'.
  3319                 88  CF-MORT-COMBINED           VALUE 'C'.
  3320                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3321                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3322             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3323             20  CF-MORT-AGE-METHOD         PIC XX.
  3324                 88  CF-AGE-LAST                VALUE 'AL'.
  3325                 88  CF-AGE-NEAR                VALUE 'AN'.
  3326             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3327             20  CF-MORT-ADJUSTMENT-DIRECTION
  3328                                            PIC X.
  3329                 88  CF-MINUS                   VALUE '-'.
  3330                 88  CF-PLUS                    VALUE '+'.
  3331             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3332             20  CF-MORT-JOINT-CODE         PIC X.
  3333                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3334             20  CF-MORT-PC-Q               PIC X.
  3335                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3336             20  CF-MORT-TABLE-CODE         PIC X(4).
  3337             20  CF-MORT-COMMENTS           PIC X(15).
  3338             20  FILLER                     PIC X(14).
  3339
  3340         16  FILLER                         PIC X(251).
  3341
  3342
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  60
* EL6318.cbl
  3343****************************************************************
  3344*             BUSSINESS TYPE MASTER RECORD                     *
  3345****************************************************************
  3346
  3347     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3348* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3349* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3350* AND RECORD 05 IS TYPES 81-99
  3351         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3352             20  CF-BUSINESS-TITLE          PIC  X(19).
  3353             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3354                                            PIC S9V9(4) COMP-3.
  3355             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3356             20  FILLER                     PIC  X.
  3357         16  FILLER                         PIC  X(248).
  3358
  3359
  3360****************************************************************
  3361*             TERMINAL MASTER RECORD                           *
  3362****************************************************************
  3363
  3364     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3365
  3366         16  CF-COMPANY-TERMINALS.
  3367             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3368                                  PIC X(4).
  3369         16  FILLER               PIC X(248).
  3370
  3371
  3372****************************************************************
  3373*             LIFE EDIT MASTER RECORD                          *
  3374****************************************************************
  3375
  3376     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3377         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3378             20  CF-LIFE-CODE-IN            PIC XX.
  3379             20  CF-LIFE-CODE-OUT           PIC XX.
  3380         16  FILLER                         PIC X(248).
  3381
  3382
  3383****************************************************************
  3384*             AH EDIT MASTER RECORD                            *
  3385****************************************************************
  3386
  3387     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3388         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3389             20  CF-AH-CODE-IN              PIC XXX.
  3390             20  CF-AH-CODE-OUT             PIC XX.
  3391         16  FILLER                         PIC X(248).
  3392
  3393
  3394****************************************************************
  3395*             CREDIBILITY TABLES                               *
  3396****************************************************************
  3397
  3398     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3399         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3400                             INDEXED BY CF-CRDB-NDX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  61
* EL6318.cbl
  3401             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3402             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3403             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3404         16  FILLER                         PIC  X(332).
  3405
  3406
  3407****************************************************************
  3408*             REPORT CUSTOMIZATION RECORD                      *
  3409****************************************************************
  3410
  3411     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3412         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3413             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3414             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3415             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3416**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3417****       A T-TRANSFER.                                   ****
  3418             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3419
  3420         16  FILLER                         PIC XX.
  3421
  3422         16  CF-CARRIER-CNTL-OPT.
  3423             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3424                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3425                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3426             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3427                                            PIC X.
  3428         16  CF-GROUP-CNTL-OPT.
  3429             20  CF-GROUP-OPT-SEQ           PIC 9.
  3430                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3431                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3432             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3433                                            PIC X(6).
  3434         16  CF-STATE-CNTL-OPT.
  3435             20  CF-STATE-OPT-SEQ           PIC 9.
  3436                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3437                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3438             20  CF-STATE-SELECT OCCURS 3 TIMES
  3439                                            PIC XX.
  3440         16  CF-ACCOUNT-CNTL-OPT.
  3441             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3442                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3443                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3444             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3445                                            PIC X(10).
  3446         16  CF-BUS-TYP-CNTL-OPT.
  3447             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3448                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3449                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3450             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3451                                            PIC XX.
  3452         16  CF-LF-TYP-CNTL-OPT.
  3453             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3454                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3455                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3456             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3457                                            PIC XX.
  3458         16  CF-AH-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  62
* EL6318.cbl
  3459             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3460                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3461                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3462             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3463                                            PIC XX.
  3464         16  CF-REPTCD1-CNTL-OPT.
  3465             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3466                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3467                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3468             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3469                                            PIC X(10).
  3470         16  CF-REPTCD2-CNTL-OPT.
  3471             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3472                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3473                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3474             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3475                                            PIC X(10).
  3476         16  CF-USER1-CNTL-OPT.
  3477             20  CF-USER1-OPT-SEQ           PIC 9.
  3478                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3479                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3480             20  CF-USER1-SELECT OCCURS 3 TIMES
  3481                                            PIC X(10).
  3482         16  CF-USER2-CNTL-OPT.
  3483             20  CF-USER2-OPT-SEQ           PIC 9.
  3484                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3485                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3486             20  CF-USER2-SELECT OCCURS 3 TIMES
  3487                                            PIC X(10).
  3488         16  CF-USER3-CNTL-OPT.
  3489             20  CF-USER3-OPT-SEQ           PIC 9.
  3490                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3491                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3492             20  CF-USER3-SELECT OCCURS 3 TIMES
  3493                                            PIC X(10).
  3494         16  CF-USER4-CNTL-OPT.
  3495             20  CF-USER4-OPT-SEQ           PIC 9.
  3496                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3497                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3498             20  CF-USER4-SELECT OCCURS 3 TIMES
  3499                                            PIC X(10).
  3500         16  CF-USER5-CNTL-OPT.
  3501             20  CF-USER5-OPT-SEQ           PIC 9.
  3502                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3503                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3504             20  CF-USER5-SELECT OCCURS 3 TIMES
  3505                                            PIC X(10).
  3506         16  CF-REINS-CNTL-OPT.
  3507             20  CF-REINS-OPT-SEQ           PIC 9.
  3508                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3509                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3510             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3511                 24  CF-REINS-PRIME         PIC XXX.
  3512                 24  CF-REINS-SUB           PIC XXX.
  3513
  3514         16  CF-AGENT-CNTL-OPT.
  3515             20  CF-AGENT-OPT-SEQ           PIC 9.
  3516                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  63
* EL6318.cbl
  3517                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3518             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3519                                            PIC X(10).
  3520
  3521         16  FILLER                         PIC X(43).
  3522
  3523         16  CF-LOSS-RATIO-SELECT.
  3524             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3525             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3526         16  CF-ENTRY-DATE-SELECT.
  3527             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3528             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3529         16  CF-EFFECTIVE-DATE-SELECT.
  3530             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3531             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3532
  3533         16  CF-EXCEPTION-LIST-IND          PIC X.
  3534             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3535
  3536         16  FILLER                         PIC X(318).
  3537
  3538****************************************************************
  3539*                  EXCEPTION REPORTING RECORD                  *
  3540****************************************************************
  3541
  3542     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3543         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3544             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3545
  3546         16  CF-COMBINED-LIFE-AH-OPT.
  3547             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3548             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3549             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3550             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3551
  3552         16  CF-LIFE-OPT.
  3553             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3554             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3555             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3556             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3557             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3558             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3559             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3560             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3561             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3562             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3563
  3564         16  CF-AH-OPT.
  3565             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3566             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3567             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3568             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3569             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3570             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3571             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3572             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3573             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3574             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  64
* EL6318.cbl
  3575
  3576         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3577             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3578             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3579             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3580
  3581         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3582
  3583         16  FILLER                         PIC X(673).
  3584
  3585
  3586****************************************************************
  3587*             MORTGAGE SYSTEM PLAN RECORD                      *
  3588****************************************************************
  3589
  3590     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3591         16  CF-PLAN-TYPE                   PIC X.
  3592             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3593             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3594             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3595         16  CF-PLAN-ABBREV                 PIC XXX.
  3596         16  CF-PLAN-DESCRIPT               PIC X(10).
  3597         16  CF-PLAN-NOTES                  PIC X(20).
  3598         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3599         16  CF-PLAN-UNDERWRITING.
  3600             20  CF-PLAN-TERM-DATA.
  3601                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3602                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3603             20  CF-PLAN-AGE-DATA.
  3604                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3605                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3606                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3607             20  CF-PLAN-BENEFIT-DATA.
  3608                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3609                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3610                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3611                                            PIC S9(7)V99  COMP-3.
  3612         16  CF-PLAN-POLICY-FORMS.
  3613             20  CF-POLICY-FORM             PIC X(12).
  3614             20  CF-MASTER-APPLICATION      PIC X(12).
  3615             20  CF-MASTER-POLICY           PIC X(12).
  3616         16  CF-PLAN-RATING.
  3617             20  CF-RATE-CODE               PIC X(5).
  3618             20  CF-SEX-RATING              PIC X.
  3619                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3620                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3621             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3622             20  CF-SUB-STD-TYPE            PIC X.
  3623                 88  CF-PCT-OF-PREM            VALUE '1'.
  3624                 88  CF-PCT-OF-BENE            VALUE '2'.
  3625         16  CF-PLAN-PREM-TOLERANCES.
  3626             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3627             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3628         16  CF-PLAN-PYMT-TOLERANCES.
  3629             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3630             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3631         16  CF-PLAN-MISC-DATA.
  3632             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  65
* EL6318.cbl
  3633             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3634             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3635         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3636         16  CF-PLAN-IND-GRP                PIC X.
  3637             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3638                                                     '1'.
  3639             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3640                                                     '2'.
  3641         16  CF-MIB-SEARCH-SW               PIC X.
  3642             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3643             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3644             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3645             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3646         16  CF-ALPHA-SEARCH-SW             PIC X.
  3647             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3648             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3649             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3650             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3651             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3652             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3653             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3654             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3655             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3656             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3657                                                     'A' 'B' 'C'
  3658                                                     'X' 'Y' 'Z'.
  3659         16  CF-EFF-DT-RULE-SW              PIC X.
  3660             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3661             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3662             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3663             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3664             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3665         16  FILLER                         PIC X(4).
  3666         16  CF-HEALTH-QUESTIONS            PIC X.
  3667             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3668         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3669         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3670         16  CF-PLAN-SNGL-JNT               PIC X.
  3671             88  CF-COMBINED-PLAN              VALUE 'C'.
  3672             88  CF-JNT-PLAN                   VALUE 'J'.
  3673             88  CF-SNGL-PLAN                  VALUE 'S'.
  3674         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3675         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3676         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3677         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3678         16  CF-RERATE-CNTL                 PIC  X.
  3679             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3680             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3681             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3682             88  CF-AUTO-RECALC                 VALUE '4'.
  3683         16  CF-BENEFIT-TYPE                PIC  X.
  3684             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3685             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3686         16  CF-POLICY-FEE                  PIC S999V99
  3687                                                    COMP-3.
  3688         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3689         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3690         16  CF-3RD-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  66
* EL6318.cbl
  3691         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3692         16  FILLER                         PIC  X(32).
  3693         16  CF-TERMINATION-FORM            PIC  X(04).
  3694         16  FILLER                         PIC  X(08).
  3695         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3696                                                       COMP-3.
  3697         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3698         16  CF-ISSUE-LETTER                PIC  X(4).
  3699         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3700         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3701             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3702             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3703         16  CF-MP-REFUND-CALC              PIC X.
  3704             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3705             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3706             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3707             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3708             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3709             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3710             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3711             88  CF-MP-REFD-MEAN                VALUE '8'.
  3712         16  CF-ALT-RATE-CODE               PIC  X(5).
  3713
  3714
  3715         16  FILLER                         PIC X(498).
  3716****************************************************************
  3717*             MORTGAGE COMPANY MASTER RECORD                   *
  3718****************************************************************
  3719
  3720     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3721         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3722         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3723             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3724             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3725             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3726             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3727             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3728
  3729         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3730         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3731         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3732         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3733         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3734
  3735         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3736             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3737         16  CF-MP-RECON-USE-IND            PIC X(1).
  3738             88  CF-MP-USE-RECON             VALUE 'Y'.
  3739         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3740             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3741         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3742             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3743             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3744         16  FILLER                         PIC X(1).
  3745         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3746             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3747         16  CF-MORTG-MIB-VERSION           PIC X.
  3748             88  CF-MORTG-MIB-BATCH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  67
* EL6318.cbl
  3749             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3750             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3751         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3752             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3753                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3754             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3755                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3756             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3757                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3758             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3759                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3760             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3761                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3762             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3763                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3764         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3765         16  FILLER                         PIC X(7).
  3766         16  CF-MORTG-DESTINATION-SYMBOL.
  3767             20  CF-MORTG-MIB-COMM          PIC X(5).
  3768             20  CF-MORTG-MIB-TERM          PIC X(5).
  3769         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3770             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3771         16  FILLER                         PIC X(03).
  3772         16  CF-MP-CHECK-NO-CONTROL.
  3773             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3774                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3775                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3776                                                ' ' LOW-VALUES.
  3777                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3778                                               VALUE '3'.
  3779         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3780         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3781         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3782             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3783                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3784             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3785                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3786             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3787                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3788             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3789                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3790             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3791                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3792             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3793                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3794         16  CF-MORTG-BILLING-AREA.
  3795             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3796                                            PIC X.
  3797         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3798         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3799         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3800         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3801             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3802             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3803         16  FILLER                         PIC X.
  3804         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3805             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3806             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  68
* EL6318.cbl
  3807         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3808         16  FILLER                         PIC X(8).
  3809         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3810         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3811         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3812         16  CF-ACH-COMPANY-ID.
  3813             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3814                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3815                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3816                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3817             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3818         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3819             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3820         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3821             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3822             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3823         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3824         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3825         16  FILLER                         PIC X(536).
  3826
  3827****************************************************************
  3828*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3829****************************************************************
  3830
  3831     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3832         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3833             20  CF-FEMALE-HEIGHT.
  3834                 24  CF-FEMALE-FT           PIC 99.
  3835                 24  CF-FEMALE-IN           PIC 99.
  3836             20  CF-FEMALE-MIN-WT           PIC 999.
  3837             20  CF-FEMALE-MAX-WT           PIC 999.
  3838         16  FILLER                         PIC X(428).
  3839
  3840     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3841         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3842             20  CF-MALE-HEIGHT.
  3843                 24  CF-MALE-FT             PIC 99.
  3844                 24  CF-MALE-IN             PIC 99.
  3845             20  CF-MALE-MIN-WT             PIC 999.
  3846             20  CF-MALE-MAX-WT             PIC 999.
  3847         16  FILLER                         PIC X(428).
  3848******************************************************************
  3849*             AUTOMATIC ACTIVITY RECORD                          *
  3850******************************************************************
  3851     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3852         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3853             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3854             20  CF-SYS-LETTER-ID           PIC X(04).
  3855             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3856             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3857             20  CF-SYS-RESET-SW            PIC X(01).
  3858             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3859             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3860
  3861         16  FILLER                         PIC X(50).
  3862
  3863         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3864             20  CF-USER-ACTIVE-SW          PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  69
* EL6318.cbl
  3865             20  CF-USER-LETTER-ID          PIC X(04).
  3866             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3867             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3868             20  CF-USER-RESET-SW           PIC X(01).
  3869             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3870             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3871             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3872
  3873         16  FILLER                         PIC X(246).
  3874*                                COPY ERCPNDB.
  3875******************************************************************
  3876*                                                                *
  3877*                                                                *
  3878*                            ERCPNDB.                            *
  3879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3880*                            VMOD=2.025                          *
  3881*                                                                *
  3882*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3883*                                                                *
  3884******************************************************************
  3885*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3886*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3887******************************************************************
  3888*                                                                *
  3889*                                                                *
  3890*   FILE TYPE = VSAM,KSDS                                        *
  3891*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3892*                                                                *
  3893*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3894*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3895*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3896*                                                 RKP=13,LEN=36  *
  3897*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3898*                                      AND CHG-SEQ.)             *
  3899*                                                RKP=49,LEN=11   *
  3900*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3901*                                      AND CHG-SEQ.)             *
  3902*                                                RKP=60,LEN=15   *
  3903*                                                                *
  3904*   LOG = NO                                                     *
  3905*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3906******************************************************************
  3907******************************************************************
  3908*                   C H A N G E   L O G
  3909*
  3910* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3911*-----------------------------------------------------------------
  3912*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3913* EFFECTIVE    NUMBER
  3914*-----------------------------------------------------------------
  3915* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3916* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3917* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3918* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3919* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3920* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3921* 032306                   PEMA  ADD BOW LOAN NUMBER
  3922* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  70
* EL6318.cbl
  3923* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3924* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3925* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3926* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3927* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3928* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3929* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3930******************************************************************
  3931
  3932 01  PENDING-BUSINESS.
  3933     12  PB-RECORD-ID                     PIC XX.
  3934         88  VALID-PB-ID                        VALUE 'PB'.
  3935
  3936     12  PB-CONTROL-PRIMARY.
  3937         16  PB-COMPANY-CD                PIC X.
  3938         16  PB-ENTRY-BATCH               PIC X(6).
  3939         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3940         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3941
  3942     12  PB-CONTROL-BY-ACCOUNT.
  3943         16  PB-COMPANY-CD-A1             PIC X.
  3944         16  PB-CARRIER                   PIC X.
  3945         16  PB-GROUPING.
  3946             20  PB-GROUPING-PREFIX       PIC XXX.
  3947             20  PB-GROUPING-PRIME        PIC XXX.
  3948         16  PB-STATE                     PIC XX.
  3949         16  PB-ACCOUNT.
  3950             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3951             20  PB-ACCOUNT-PRIME         PIC X(6).
  3952         16  PB-CERT-EFF-DT               PIC XX.
  3953         16  PB-CERT-NO.
  3954             20  PB-CERT-PRIME            PIC X(10).
  3955             20  PB-CERT-SFX              PIC X.
  3956         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3957
  3958         16  PB-RECORD-TYPE               PIC X.
  3959             88  PB-MAILING-DATA                VALUE '0'.
  3960             88  PB-ISSUE                       VALUE '1'.
  3961             88  PB-CANCELLATION                VALUE '2'.
  3962             88  PB-BATCH-TRAILER               VALUE '9'.
  3963
  3964     12  PB-CONTROL-BY-ORIG-BATCH.
  3965         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3966         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3967         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3968         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3969
  3970     12  PB-CONTROL-BY-CSR.
  3971         16  PB-CSR-COMPANY-CD            PIC X.
  3972         16  PB-CSR-ID                    PIC X(4).
  3973         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3974         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3975         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3976******************************************************************
  3977*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3978******************************************************************
  3979
  3980     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  71
* EL6318.cbl
  3981     12  PB-LAST-MAINT-BY                 PIC X(4).
  3982     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3983
  3984     12  PB-RECORD-BODY                   PIC X(375).
  3985
  3986     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3987         16  PB-CERT-ORIGIN               PIC X.
  3988             88  CLASIC-CREATED-CERT         VALUE '1'.
  3989         16  PB-I-NAME.
  3990             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3991             20  PB-I-INSURED-FIRST-NAME.
  3992                 24  PB-I-INSURED-1ST-INIT PIC X.
  3993                 24  FILLER                PIC X(9).
  3994             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3995         16  PB-I-AGE                     PIC S99   COMP-3.
  3996         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3997         16  PB-I-BIRTHDAY                PIC XX.
  3998         16  PB-I-INSURED-SEX             PIC X.
  3999             88  PB-SEX-MALE     VALUE 'M'.
  4000             88  PB-SEX-FEMALE   VALUE 'F'.
  4001
  4002         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4003         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4004         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4005         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4006         16  PB-I-SKIP-CODE               PIC X.
  4007             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4008             88  PB-SKIP-JULY              VALUE '1'.
  4009             88  PB-SKIP-AUGUST            VALUE '2'.
  4010             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4011             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4012             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4013             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4014             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4015             88  PB-SKIP-JUNE              VALUE '8'.
  4016             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4017             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4018             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4019         16  PB-I-TERM-TYPE               PIC X.
  4020             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4021             88  PB-PAID-WEEKLY            VALUE 'W'.
  4022             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4023             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4024             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4025         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4026         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4027         16  PB-I-DATA-ENTRY-SW           PIC X.
  4028             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4029             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4030             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4031             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4032         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4033         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4034*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4035         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4036         16  FILLER                       PIC X.
  4037
  4038         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  72
* EL6318.cbl
  4039             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4040             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4041                                                   '90' THRU '99'.
  4042         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4043                                          PIC XX.
  4044         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4045         16  PB-I-AMOUNT-FINANCED REDEFINES
  4046                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4047         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4048         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4049                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4050         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4051         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4052         16  PB-I-CLP-AMOUNT REDEFINES
  4053                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4054         16  PB-I-LF-CALC-FLAG            PIC X.
  4055             88 PB-COMP-LF-PREM               VALUE '?'.
  4056         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4057         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4058         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4059         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4060         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4061         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4062         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4063         16  PB-I-LF-ABBR                 PIC XXX.
  4064         16  PB-I-LF-INPUT-CD             PIC XX.
  4065
  4066         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4067             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4068             88  PB-INVALID-AH               VALUE '  ' '00'
  4069                                                   '90' THRU '99'.
  4070         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4071         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4072         16  PB-I-AH-CALC-FLAG            PIC X.
  4073             88 PB-COMP-AH-PREM                  VALUE '?'.
  4074         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4075         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4076         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4077         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4078         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4079         16  PB-I-AH-ABBR                 PIC XXX.
  4080         16  PB-I-AH-INPUT-CD             PIC XXX.
  4081
  4082         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4083         16  PB-I-REIN-TABLE              PIC XXX.
  4084         16  PB-I-BUSINESS-TYPE           PIC 99.
  4085         16  PB-I-INDV-GRP-CD             PIC X.
  4086         16  PB-I-MORT-CODE.
  4087             20  PB-I-TABLE               PIC X.
  4088             20  PB-I-INTEREST            PIC XX.
  4089             20  PB-I-MORT-TYP            PIC X.
  4090         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4091         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4092         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4093         16  PB-I-INDV-GRP-OVRD           PIC X.
  4094         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4095         16  PB-I-SIG-SW                  PIC X.
  4096             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  73
* EL6318.cbl
  4097         16  PB-I-RATE-CLASS              PIC XX.
  4098         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4099         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4100         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4101         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4102         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4103         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4104         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4105         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4106         16  PB-I-OB-FLAG                 PIC X.
  4107             88  PB-I-OB                      VALUE 'B'.
  4108             88  PB-I-SUMMARY                 VALUE 'Z'.
  4109         16  PB-I-ENTRY-STATUS            PIC X.
  4110             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4111                                              'M' '5' '9' '2'.
  4112             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4113             88  PB-I-POLICY-PENDING          VALUE '2'.
  4114             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4115             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4116             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4117             88  PB-I-REIN-ONLY               VALUE '9'.
  4118             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4119             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4120             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4121             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4122         16  PB-I-INT-CODE                PIC X.
  4123             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4124             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4125         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4126         16  PB-I-SOC-SEC-NO              PIC X(11).
  4127         16  PB-I-MEMBER-NO               PIC X(12).
  4128         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4129*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4130         16  PB-I-OLD-LOF                 PIC XXX.
  4131         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4132         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4133         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4134         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4135         16  PB-I-LIFE-INDICATOR          PIC X.
  4136             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4137         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4138         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4139                                          PIC S9(5)V99    COMP-3.
  4140         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4141             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4142             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4143         16  PB-I-1ST-PMT-DT              PIC XX.
  4144         16  PB-I-JOINT-INSURED.
  4145             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4146             20 PB-I-JOINT-FIRST-NAME.
  4147                24  PB-I-JOINT-FIRST-INIT PIC X.
  4148                24  FILLER                PIC X(9).
  4149             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4150*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4151         16  PB-I-BENEFICIARY-NAME.
  4152             20  PB-I-BANK-NUMBER         PIC X(10).
  4153             20  FILLER                   PIC X(15).
  4154         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  74
* EL6318.cbl
  4155         16  PB-I-REFERENCE               PIC X(12).
  4156         16  FILLER REDEFINES PB-I-REFERENCE.
  4157             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4158             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4159             20  PB-I-CLP-STATE           PIC XX.
  4160         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4161             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4162             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4163             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4164         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4165         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4166         16  PB-I-RESIDENT-STATE          PIC XX.
  4167         16  PB-I-RATE-CODE               PIC X(4).
  4168         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4169         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4170         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4171         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4172         16  PB-I-BANK-NOCHRGB            PIC 99.
  4173         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4174         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4175
  4176     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4177         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4178             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4179         16  PB-C-CANCEL-ORIGIN           PIC X.
  4180             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4181         16  PB-C-LF-CANCEL-DT            PIC XX.
  4182         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4183         16  PB-C-LF-CALC-REQ             PIC X.
  4184             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4185         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4186         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4187         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4188             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4189         16  PB-C-AH-CANCEL-DT            PIC XX.
  4190         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4191         16  PB-C-AH-CALC-REQ             PIC X.
  4192             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4193         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4194         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4195         16  PB-C-LAST-NAME               PIC X(15).
  4196         16  PB-C-REFUND-SW               PIC X.
  4197             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4198             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4199         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4200         16  PB-C-PAYEE-CODE              PIC X(6).
  4201         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4202         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4203         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4204         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4205         16  PB-C-REFERENCE               PIC X(12).
  4206         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4207         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4208         16  PB-C-POST-CARD-IND           PIC X.
  4209         16  PB-C-CANCEL-REASON           PIC X.
  4210         16  PB-C-REF-INTERFACE-SW        PIC X.
  4211         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4212         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  75
* EL6318.cbl
  4213         16  FILLER                       PIC X(01).
  4214*        16  FILLER                       PIC X(18).
  4215         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4216*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4217         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4218         16  PB-CANCELED-CERT-DATA.
  4219             20  PB-CI-INSURED-NAME.
  4220                 24  PB-CI-LAST-NAME      PIC X(15).
  4221                 24  PB-CI-INITIALS       PIC XX.
  4222             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4223             20  PB-CI-INSURED-SEX        PIC X.
  4224             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4225             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4226             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4227             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4228             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4229             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4230             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4231             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4232             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4233             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4234             20  PB-CI-RATE-CLASS         PIC XX.
  4235             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4236             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4237             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4238             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4239             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4240             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4241             20  PB-CI-LF-ABBR            PIC X(3).
  4242             20  PB-CI-AH-ABBR            PIC X(3).
  4243             20  PB-CI-OB-FLAG            PIC X.
  4244                 88  PB-CI-OB                VALUE 'B'.
  4245             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4246                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4247                                           'M' '4' '5' '9' '2'.
  4248                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4249                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4250                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4251                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4252                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4253                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4254                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4255                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4256                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4257                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4258                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4259                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4260             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4261                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4262                                           'M' '4' '5' '9' '2'.
  4263                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4264                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4265                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4266                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4267                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4268                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4269                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4270                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  76
* EL6318.cbl
  4271                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4272                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4273                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4274                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4275             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4276             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4277             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4278             20  PB-CI-MEMBER-NO          PIC X(12).
  4279             20  PB-CI-INT-CODE           PIC X.
  4280                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4281                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4282             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4283             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4284             20  PB-CI-COMP-EXCP-SW       PIC X.
  4285                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4286                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4287             20  PB-CI-ENTRY-STATUS       PIC X.
  4288             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4289             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4290             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4291             20  PB-CI-DEATH-DT           PIC XX.
  4292             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4293             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4294             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4295             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4296             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4297             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4298             20  PB-CI-ENTRY-DT              PIC XX.
  4299             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4300             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4301             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4302             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4303             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4304             20  PB-CI-OLD-LOF               PIC XXX.
  4305*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4306             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4307             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4308             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4309             20  PB-CI-INDV-GRP-CD           PIC X.
  4310             20  PB-CI-BENEFICIARY-NAME.
  4311                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4312                 24  FILLER                  PIC X(15).
  4313             20  PB-CI-NOTE-SW               PIC X.
  4314             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4315             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4316             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4317             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4318             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4319             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4320             20  PB-CI-FIRST-NAME            PIC X(10).
  4321             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4322
  4323         16  FILLER                       PIC X(13).
  4324*032306  16  FILLER                       PIC X(27).
  4325*        16  FILLER                       PIC X(46).
  4326
  4327     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4328         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  77
* EL6318.cbl
  4329         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4330         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4331         16  PB-M-INSURED-MID-INIT        PIC X.
  4332         16  PB-M-INSURED-AGE             PIC 99.
  4333         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4334         16  PB-M-INSURED-SEX             PIC X.
  4335         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4336         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4337         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4338         16  PB-M-INSURED-CITY-STATE.
  4339             20  PB-M-INSURED-CITY        PIC X(28).
  4340             20  PB-M-INSURED-STATE       PIC XX.
  4341         16  PB-M-INSURED-ZIP-CODE.
  4342             20  PB-M-INSURED-ZIP-PRIME.
  4343                 24  PB-M-INSURED-ZIP-1   PIC X.
  4344                     88  PB-M-CANADIAN-POST-CODE
  4345                                             VALUE 'A' THRU 'Z'.
  4346                 24  FILLER               PIC X(4).
  4347             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4348         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4349                                        PB-M-INSURED-ZIP-CODE.
  4350             20  PM-M-INS-CAN-POST1       PIC XXX.
  4351             20  PM-M-INS-CAN-POST2       PIC XXX.
  4352             20  FILLER                   PIC XXX.
  4353         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4354         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4355         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4356         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4357         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4358         16  PB-M-CRED-BENE-CITYST.
  4359             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4360             20  PB-M-CRED-BENE-STATE     PIC XX.
  4361         16  FILLER                       PIC X(92).
  4362
  4363     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4364         16  FILLER                       PIC X(10).
  4365         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4366         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4367         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4368         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4369         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4370         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4371         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4372         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4373         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4374         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4375         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4376         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4377         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4378         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4379         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4380         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4381         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4382         16  PB-ACCOUNT-NAME              PIC X(30).
  4383         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4384         16  PB-REFERENCE                 PIC X(12).
  4385         16  PB-B-RECEIVED-DT             PIC XX.
  4386         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  78
* EL6318.cbl
  4387
  4388     12  PB-RECORD-STATUS.
  4389         16  PB-CREDIT-SELECT-DT          PIC XX.
  4390         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4391         16  PB-BILLED-DT                 PIC XX.
  4392         16  PB-BILLING-STATUS            PIC X.
  4393             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4394             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4395             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4396         16  PB-RECORD-BILL               PIC X.
  4397             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4398             88  PB-RECORD-RETURNED           VALUE 'R'.
  4399             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4400             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4401             88  PB-OVERRIDE-AH               VALUE 'A'.
  4402             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4403         16  PB-BATCH-ENTRY               PIC X.
  4404             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4405             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4406             88  PB-REISSUED-CERT             VALUE 'E'.
  4407             88  PB-MONTHLY-CERT              VALUE 'M'.
  4408             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4409             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4410             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4411         16  PB-FORCE-CODE                PIC X.
  4412             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4413             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4414             88  PB-CANCEL-FORCE              VALUE '8'.
  4415             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4416             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4417             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4418             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4419             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4420             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4421             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4422         16  PB-FATAL-FLAG                PIC X.
  4423             88  PB-FATAL-ERRORS              VALUE 'X'.
  4424         16  PB-FORCE-ER-CD               PIC X.
  4425             88  PB-FORCE-ERRORS              VALUE 'F'.
  4426             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4427         16  PB-WARN-ER-CD                PIC X.
  4428             88  PB-WARNING-ERRORS            VALUE 'W'.
  4429         16  FILLER                       PIC X.
  4430         16  PB-OUT-BAL-CD                PIC X.
  4431             88  PB-OUT-OF-BAL                VALUE 'O'.
  4432         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4433         16  PB-AH-OVERRIDE-L1            PIC X.
  4434         16  PB-INPUT-DT                  PIC XX.
  4435         16  PB-INPUT-BY                  PIC X(4).
  4436         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4437         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4438         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4439         16  PB-LF-EARNING-METHOD         PIC X.
  4440         16  PB-AH-EARNING-METHOD         PIC X.
  4441         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4442         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4443         16  PB-REIN-CD                   PIC XXX.
  4444         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  79
* EL6318.cbl
  4445         16  PB-AH-REFUND-TYPE            PIC X.
  4446         16  PB-ACCT-EFF-DT               PIC XX.
  4447         16  PB-ACCT-EXP-DT               PIC XX.
  4448         16  PB-COMPANY-ID                PIC X(3).
  4449         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4450         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4451         16  PB-SV-CARRIER                PIC X.
  4452         16  PB-SV-GROUPING               PIC X(6).
  4453         16  PB-SV-STATE                  PIC XX.
  4454         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4455         16  PB-GA-BILLING-INFO.
  4456             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4457                                          PIC XX.
  4458         16  PB-SV-REMIT-TO  REDEFINES
  4459             PB-GA-BILLING-INFO           PIC X(10).
  4460         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4461         16  PB-I-LOAN-OFFICER            PIC X(5).
  4462         16  PB-I-VIN                     PIC X(17).
  4463
  4464         16  FILLER                       PIC X(04).
  4465         16  IMNET-BYPASS-SW              PIC X.
  4466
  4467******************************************************************
  4468*                COMMON EDIT ERRORS                              *
  4469******************************************************************
  4470
  4471     12  PB-COMMON-ERRORS.
  4472         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4473                                           PIC S9(4)     COMP.
  4474
  4475******************************************************************
  4476*                                COPY ELCCERT.
  4477******************************************************************
  4478*                                                                *
  4479*                            ELCCERT.                            *
  4480*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4481*                            VMOD=2.013                          *
  4482*                                                                *
  4483*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4484*                                                                *
  4485*   FILE TYPE = VSAM,KSDS                                        *
  4486*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4487*                                                                *
  4488*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4489*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4490*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4491*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4492*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4493*                                                                *
  4494*   LOG = YES                                                    *
  4495*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4496******************************************************************
  4497*                   C H A N G E   L O G
  4498*
  4499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4500*-----------------------------------------------------------------
  4501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4502* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  80
* EL6318.cbl
  4503*-----------------------------------------------------------------
  4504* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4505* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4506* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4507* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4508* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4509* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4510* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4511* 032612  CR2011110200001  PEMA  AHL CHANGES
  4512******************************************************************
  4513
  4514 01  CERTIFICATE-MASTER.
  4515     12  CM-RECORD-ID                      PIC XX.
  4516         88  VALID-CM-ID                      VALUE 'CM'.
  4517
  4518     12  CM-CONTROL-PRIMARY.
  4519         16  CM-COMPANY-CD                 PIC X.
  4520         16  CM-CARRIER                    PIC X.
  4521         16  CM-GROUPING.
  4522             20  CM-GROUPING-PREFIX        PIC X(3).
  4523             20  CM-GROUPING-PRIME         PIC X(3).
  4524         16  CM-STATE                      PIC XX.
  4525         16  CM-ACCOUNT.
  4526             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4527             20  CM-ACCOUNT-PRIME          PIC X(6).
  4528         16  CM-CERT-EFF-DT                PIC XX.
  4529         16  CM-CERT-NO.
  4530             20  CM-CERT-PRIME             PIC X(10).
  4531             20  CM-CERT-SFX               PIC X.
  4532
  4533     12  CM-CONTROL-BY-NAME.
  4534         16  CM-COMPANY-CD-A1              PIC X.
  4535         16  CM-INSURED-LAST-NAME          PIC X(15).
  4536         16  CM-INSURED-INITIALS.
  4537             20  CM-INSURED-INITIAL1       PIC X.
  4538             20  CM-INSURED-INITIAL2       PIC X.
  4539
  4540     12  CM-CONTROL-BY-SSN.
  4541         16  CM-COMPANY-CD-A2              PIC X.
  4542         16  CM-SOC-SEC-NO.
  4543             20  CM-SSN-STATE              PIC XX.
  4544             20  CM-SSN-ACCOUNT            PIC X(6).
  4545             20  CM-SSN-LN3.
  4546                 25  CM-INSURED-INITIALS-A2.
  4547                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4548                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4549                 25 CM-PART-LAST-NAME-A2         PIC X.
  4550
  4551     12  CM-CONTROL-BY-CERT-NO.
  4552         16  CM-COMPANY-CD-A4              PIC X.
  4553         16  CM-CERT-NO-A4                 PIC X(11).
  4554
  4555     12  CM-CONTROL-BY-MEMB.
  4556         16  CM-COMPANY-CD-A5              PIC X.
  4557         16  CM-MEMBER-NO.
  4558             20  CM-MEMB-STATE             PIC XX.
  4559             20  CM-MEMB-ACCOUNT           PIC X(6).
  4560             20  CM-MEMB-LN4.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  81
* EL6318.cbl
  4561                 25  CM-INSURED-INITIALS-A5.
  4562                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4563                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4564                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4565
  4566     12  CM-INSURED-PROFILE-DATA.
  4567         16  CM-INSURED-FIRST-NAME.
  4568             20  CM-INSURED-1ST-INIT       PIC X.
  4569             20  FILLER                    PIC X(9).
  4570         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4571         16  CM-INSURED-SEX                PIC X.
  4572             88  CM-SEX-MALE                  VALUE 'M'.
  4573             88  CM-SEX-FEMAL                 VALUE 'F'.
  4574         16  CM-INSURED-JOINT-AGE          PIC 99.
  4575         16  CM-JOINT-INSURED-NAME.
  4576             20  CM-JT-LAST-NAME           PIC X(15).
  4577             20  CM-JT-FIRST-NAME.
  4578                 24  CM-JT-1ST-INIT        PIC X.
  4579                 24  FILLER                PIC X(9).
  4580             20  CM-JT-INITIAL             PIC X.
  4581
  4582     12  CM-LIFE-DATA.
  4583         16  CM-LF-BENEFIT-CD              PIC XX.
  4584         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4585         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4586         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4587         16  CM-LF-DEV-CODE                PIC XXX.
  4588         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4589         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4590         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4591         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4592         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4593         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4594         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4595         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4596         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4597         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4598         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4599         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4600         16  FILLER                        PIC XX.
  4601
  4602     12  CM-AH-DATA.
  4603         16  CM-AH-BENEFIT-CD              PIC XX.
  4604         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4605         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4606         16  CM-AH-DEV-CODE                PIC XXX.
  4607         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4608         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4609         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4610         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4611         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4612         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4613         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4614         16  CM-AH-PAID-THRU-DT            PIC XX.
  4615             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4616         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4617         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4618         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  82
* EL6318.cbl
  4619         16  FILLER                        PIC X.
  4620
  4621     12  CM-LOAN-INFORMATION.
  4622         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4623         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4624                                           PIC S9(5)V99  COMP-3.
  4625         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4626         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4627         16  CM-PAY-FREQUENCY              PIC S99.
  4628         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4629         16  CM-RATE-CLASS                 PIC XX.
  4630         16  CM-BENEFICIARY                PIC X(25).
  4631         16  CM-POLICY-FORM-NO             PIC X(12).
  4632         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4633         16  CM-LAST-ADD-ON-DT             PIC XX.
  4634         16  CM-DEDUCTIBLE-AMOUNTS.
  4635             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4636             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4637         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4638             20  CM-RESIDENT-STATE         PIC XX.
  4639             20  CM-RATE-CODE              PIC X(4).
  4640             20  FILLER                    PIC XX.
  4641         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4642             20  CM-LOAN-OFFICER           PIC X(5).
  4643             20  FILLER                    PIC XXX.
  4644         16  CM-CSR-CODE                   PIC XXX.
  4645         16  CM-UNDERWRITING-CODE          PIC X.
  4646             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4647         16  CM-POST-CARD-IND              PIC X.
  4648         16  CM-NH-INTERFACE-SW            PIC X.
  4649         16  CM-PREMIUM-TYPE               PIC X.
  4650             88  CM-SING-PRM                  VALUE '1'.
  4651             88  CM-O-B-COVERAGE              VALUE '2'.
  4652             88  CM-OPEN-END                  VALUE '3'.
  4653         16  CM-IND-GRP-TYPE               PIC X.
  4654             88  CM-INDIVIDUAL                VALUE 'I'.
  4655             88  CM-GROUP                     VALUE 'G'.
  4656         16  CM-SKIP-CODE                  PIC X.
  4657             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4658             88  SKIP-JULY                    VALUE '1'.
  4659             88  SKIP-AUGUST                  VALUE '2'.
  4660             88  SKIP-SEPTEMBER               VALUE '3'.
  4661             88  SKIP-JULY-AUG                VALUE '4'.
  4662             88  SKIP-AUG-SEPT                VALUE '5'.
  4663             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4664             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4665             88  SKIP-JUNE                    VALUE '8'.
  4666             88  SKIP-JUNE-JULY               VALUE '9'.
  4667             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4668             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4669         16  CM-PAYMENT-MODE               PIC X.
  4670             88  PAY-MONTHLY                  VALUE SPACE.
  4671             88  PAY-WEEKLY                   VALUE '1'.
  4672             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4673             88  PAY-BI-WEEKLY                VALUE '3'.
  4674             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4675         16  CM-LOAN-NUMBER                PIC X(8).
  4676         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  83
* EL6318.cbl
  4677         16  CM-OLD-LOF                    PIC XXX.
  4678*        16  CM-LOAN-OFFICER               PIC XXX.
  4679         16  CM-REIN-TABLE                 PIC XXX.
  4680         16  CM-SPECIAL-REIN-CODE          PIC X.
  4681         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4682         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4683         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4684
  4685     12  CM-STATUS-DATA.
  4686         16  CM-ENTRY-STATUS               PIC X.
  4687         16  CM-ENTRY-DT                   PIC XX.
  4688
  4689         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4690         16  CM-LF-CANCEL-DT               PIC XX.
  4691         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4692
  4693         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4694         16  CM-LF-DEATH-DT                PIC XX.
  4695         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4696
  4697         16  CM-LF-CURRENT-STATUS          PIC X.
  4698             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4699                                                'M' '4' '5' '9'.
  4700             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4701             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4702             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4703             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4704             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4705             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4706             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4707             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4708             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4709             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4710             88  CM-LF-DECLINED               VALUE 'D'.
  4711             88  CM-LF-VOIDED                 VALUE 'V'.
  4712
  4713         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4714         16  CM-AH-CANCEL-DT               PIC XX.
  4715         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4716
  4717         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4718         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4719         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4720
  4721         16  CM-AH-CURRENT-STATUS          PIC X.
  4722             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4723                                                'M' '4' '5' '9'.
  4724             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4725             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4726             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4727             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4728             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4729             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4730             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4731             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4732             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4733             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4734             88  CM-AH-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  84
* EL6318.cbl
  4735             88  CM-AH-VOIDED                 VALUE 'V'.
  4736
  4737         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4738             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4739             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4740             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4741         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4742
  4743         16  CM-ENTRY-BATCH                PIC X(6).
  4744         16  CM-LF-EXIT-BATCH              PIC X(6).
  4745         16  CM-AH-EXIT-BATCH              PIC X(6).
  4746         16  CM-LAST-MONTH-END             PIC XX.
  4747
  4748     12  CM-NOTE-SW                        PIC X.
  4749         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4750         88  CERT-NOTES-PRESENT               VALUE '1'.
  4751         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4752         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4753         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4754         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4755         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4756         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4757     12  CM-COMP-EXCP-SW                   PIC X.
  4758         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4759         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4760     12  CM-INSURED-ADDRESS-SW             PIC X.
  4761         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4762         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4763
  4764*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4765     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4766     12  FILLER                            PIC X.
  4767
  4768*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4769     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4770     12  FILLER                            PIC X.
  4771*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4772     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4773
  4774     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4775         88  CERT-ADDED-BATCH                 VALUE ' '.
  4776         88  CERT-ADDED-ONLINE                VALUE '1'.
  4777         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4778         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4779         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4780     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4781         88  CERT-AS-LOADED                   VALUE ' '.
  4782         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4783         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4784         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4785         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4786         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4787         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4788         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4789
  4790     12  CM-ACCOUNT-COMM-PCTS.
  4791         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4792         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  85
* EL6318.cbl
  4793
  4794     12  CM-USER-FIELD                     PIC X.
  4795     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4796     12  CM-CLP-STATE                      PIC XX.
  4797     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4798     12  CM-USER-RESERVED                  PIC XXX.
  4799     12  FILLER REDEFINES CM-USER-RESERVED.
  4800         16  CM-AH-CLASS-CD                PIC XX.
  4801         16  F                             PIC X.
  4802******************************************************************
  4803*                                COPY ELCCRTO.
  4804******************************************************************
  4805*                                                                *
  4806*                            ELCCRTO.                            *
  4807*                                                                *
  4808*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4809*                                                                *
  4810*   FILE TYPE = VSAM,KSDS                                        *
  4811*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4812*                                                                *
  4813*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4814*                                                                *
  4815*   LOG = YES                                                    *
  4816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4817******************************************************************
  4818*                   C H A N G E   L O G
  4819*
  4820* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4821*-----------------------------------------------------------------
  4822*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4823* EFFECTIVE    NUMBER
  4824*-----------------------------------------------------------------
  4825* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4826* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4827* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4828******************************************************************
  4829 01  ORIGINAL-CERTIFICATE.
  4830     12  OC-RECORD-ID                      PIC XX.
  4831         88  VALID-OC-ID                      VALUE 'OC'.
  4832     12  OC-CONTROL-PRIMARY.
  4833         16  OC-COMPANY-CD                 PIC X.
  4834         16  OC-CARRIER                    PIC X.
  4835         16  OC-GROUPING                   PIC X(6).
  4836         16  OC-STATE                      PIC XX.
  4837         16  OC-ACCOUNT                    PIC X(10).
  4838         16  OC-CERT-EFF-DT                PIC XX.
  4839         16  OC-CERT-NO.
  4840             20  OC-CERT-PRIME             PIC X(10).
  4841             20  OC-CERT-SFX               PIC X.
  4842         16  OC-RECORD-TYPE                PIC X.
  4843         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4844     12  OC-LAST-MAINT-DT                  PIC XX.
  4845     12  OC-LAST-MAINT-BY                  PIC X(4).
  4846     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4847     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4848     12  FILLER                            PIC X(49).
  4849     12  OC-ORIG-REC.
  4850         16  OC-INS-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  86
* EL6318.cbl
  4851         16  OC-INS-FIRST-NAME             PIC X(10).
  4852         16  OC-INS-MIDDLE-INIT            PIC X.
  4853         16  OC-INS-AGE                    PIC S999     COMP-3.
  4854         16  OC-JNT-LAST-NAME              PIC X(15).
  4855         16  OC-JNT-FIRST-NAME             PIC X(10).
  4856         16  OC-JNT-MIDDLE-INIT            PIC X.
  4857         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4858         16  OC-LF-BENCD                   PIC XX.
  4859         16  OC-LF-TERM                    PIC S999      COMP-3.
  4860         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4861         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4862         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4863         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4864         16  OC-LF-EXP-DT                  PIC XX.
  4865         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4866         16  OC-LF-CANCEL-DT               PIC XX.
  4867         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4868         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4869         16  OC-AH-BENCD                   PIC XX.
  4870         16  OC-AH-TERM                    PIC S999      COMP-3.
  4871         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4872         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4873         16  OC-AH-EXP-DT                  PIC XX.
  4874         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4875         16  OC-AH-CP                      PIC 99.
  4876         16  OC-AH-CANCEL-DT               PIC XX.
  4877         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4878         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4879         16  OC-CRED-BENE-NAME             PIC X(25).
  4880         16  OC-1ST-PMT-DT                 PIC XX.
  4881         16  FILLER                        PIC X(215).
  4882
  4883     12  FILLER                            PIC X(50).
  4884******************************************************************
  4885*                                COPY ERCENDT.
  4886******************************************************************
  4887*                                                                *
  4888*                                                                *
  4889*                            ERCENDT.                            *
  4890*                            VMOD=2.001                          *
  4891*                                                                *
  4892*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4893*                                                                *
  4894*   FILE TYPE = VSAM,KSDS                                        *
  4895*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4896*                                                                *
  4897*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4898*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4899*                                                                *
  4900*   LOG = NO                                                     *
  4901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4902******************************************************************
  4903*-----------------------------------------------------------------
  4904*                   C H A N G E   L O G
  4905*
  4906* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4907*-----------------------------------------------------------------
  4908*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  87
* EL6318.cbl
  4909* EFFECTIVE    NUMBER
  4910*-----------------------------------------------------------------
  4911* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4912*                                WITH OPEN CLAIMS
  4913* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4914* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4915*-----------------------------------------------------------------
  4916 01  ENDORSEMENT-RECORD.
  4917     12  EN-RECORD-ID                PIC XX.
  4918         88  VALID-EN-ID                VALUE 'EN'.
  4919     12  EN-CONTROL-PRIMARY.
  4920         16  EN-COMPANY-CD           PIC X.
  4921         16  EN-CARRIER              PIC X.
  4922         16  EN-GROUPING             PIC X(6).
  4923         16  EN-STATE                PIC XX.
  4924         16  EN-ACCOUNT              PIC X(10).
  4925         16  EN-CERT-EFF-DT          PIC XX.
  4926         16  EN-CERT-NO.
  4927             20  EN-CERT-PRIME       PIC X(10).
  4928             20  EN-CERT-SFX         PIC X.
  4929         16  EN-REC-TYPE             PIC X.
  4930             88  EN-ISSUE               VALUE 'I'.
  4931             88  EN-CANCELLATION        VALUE 'C'.
  4932         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4933     12  EN-CONTROL-BY-ARCH-NO.
  4934         16  EN-COMPANY-CD-A1              PIC X.
  4935         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4936     12  EN-LAST-MAINT-DT            PIC XX.
  4937     12  EN-LAST-MAINT-BY            PIC X(4).
  4938     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4939     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4940     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4941         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4942         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4943         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4944         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4945         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4946         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4947         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4948         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4949         16  EN-LF-ORIG-BENCD        PIC XX.
  4950         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4951         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4952         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4953         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4954         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4955         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4956*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4957         16  EN-ORIG-CRED-BENE       PIC X(25).
  4958         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4959         16  FILLER                  PIC X.
  4960         16  EN-AH-ORIG-BENCD        PIC XX.
  4961         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4962         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4963         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4964         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4965*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4966*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  88
* EL6318.cbl
  4967         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4968         16  F                       PIC X(09).
  4969         16  EN-AH-ORIG-CP           PIC 99.
  4970         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4971         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4972         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4973         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4974         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4975         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4976         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4977         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4978         16  EN-LF-NEW-BENCD         PIC XX.
  4979         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4980         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4981         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4982         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4983         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4984         16  EN-LF-NEW-EXP-DT        PIC XX.
  4985         16  EN-NEW-CRED-BENE        PIC X(25).
  4986         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4987         16  FILLER                  PIC X.
  4988         16  EN-AH-NEW-BENCD         PIC XX.
  4989         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4990         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4991         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4992         16  EN-AH-NEW-EXP-DT        PIC XX.
  4993*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4994*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4995*        16  F                       PIC X(12).
  4996         16  EN-AH-NEW-CP            PIC 99.
  4997         16  EN-SIG-SW               PIC X.
  4998         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4999         16  FILLER                  PIC X(37).
  5000     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5001         16  EN-LF-ORIG-REF-DT       PIC XX.
  5002         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5003         16  EN-AH-ORIG-REF-DT       PIC XX.
  5004         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5005         16  EN-LF-NEW-REF-DT        PIC XX.
  5006         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5007         16  EN-AH-NEW-REF-DT        PIC XX.
  5008         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5009         16  EN-FLAG-CERT            PIC X.
  5010         16  EN-INS-LAST-NAME        PIC X(15).
  5011         16  EN-INS-FIRST-NAME       PIC X(10).
  5012         16  EN-INS-MIDDLE-INIT      PIC X.
  5013         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5014         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5015         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5016         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5017         16  FILLER                  PIC X(262).
  5018     12  EN-MONEY-SW             PIC X.
  5019     12  EN-HEALTH-APP           PIC X.
  5020     12  EN-VOUCHER-SW           PIC X.
  5021     12  EN-PAYEE                PIC X(14).
  5022     12  EN-INPUT-DT             PIC XX.
  5023     12  EN-PROCESS-DT           PIC XX.
  5024     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  89
* EL6318.cbl
  5025     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5026     12  EN-REASON-CODES.
  5027         16  F OCCURS 12.
  5028             20  EN-REASON-CODE  PIC X(4).
  5029     12  EN-TEMPLATE-USED        PIC X(8).
  5030     12  EN-DOCU-TYPE            PIC X.
  5031         88  EN-VERI-DOCU          VALUE 'V'.
  5032         88  EN-GCE-DOCU           VALUE 'G'.
  5033         88  EN-CANC-DOCU          VALUE 'C'.
  5034     12  EN-COMMENTS1            PIC X(13).
  5035     12  EN-COMMENTS2            PIC X(70).
  5036     12  EN-COMM-CHGBK           PIC X.
  5037         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5038         88  EN-CHG-ACCT           VALUE 'Y'.
  5039     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5040     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5041     12  EN-BATCH-NUMBER         PIC X(6).
  5042     12  EN-ACCT-SUMM            PIC X.
  5043     12  EN-CSO-SUMM             PIC X.
  5044     12  FILLER                  PIC X(13).
  5045******************************************************************
  5046*                                COPY ERCNOTE.
  5047******************************************************************
  5048*                                                                *
  5049*                                                                *
  5050*                            ERCNOTE                             *
  5051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5052*                            VMOD=2.003                          *
  5053*                                                                *
  5054*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5055*                                                                *
  5056*        FILE TYPE= VSAM,KSDS                                    *
  5057*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5058*                                                                *
  5059*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5060*                                                                *
  5061*        LOG = YES                                               *
  5062*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5063*                                                                *
  5064******************************************************************
  5065*                   C H A N G E   L O G
  5066*
  5067* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5068*-----------------------------------------------------------------
  5069*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5070* EFFECTIVE    NUMBER
  5071*-----------------------------------------------------------------
  5072* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5073*                                FILE WILL CONTAIN BILLING NOTES O
  5074******************************************************************
  5075
  5076 01  CERTIFICATE-NOTE.
  5077     12  CN-RECORD-ID                PIC  XX.
  5078         88  VALID-CN-ID                  VALUE 'CN'.
  5079
  5080     12  CN-CONTROL-PRIMARY.
  5081         16  CN-COMPANY-CD           PIC X.
  5082         16  CN-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  90
* EL6318.cbl
  5083         16  CN-GROUPING.
  5084             20 CN-GROUPING-PREFIX   PIC XXX.
  5085             20 CN-GROUPING-PRIME    PIC XXX.
  5086         16  CN-STATE                PIC XX.
  5087         16  CN-ACCOUNT.
  5088             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5089             20 CN-ACCOUNT-PRIME     PIC X(6).
  5090         16  CN-CERT-EFF-DT          PIC XX.
  5091         16  CN-CERT-NO.
  5092             20  CN-CERT-PRIME       PIC X(10).
  5093             20  CN-CERT-SFX         PIC X.
  5094
  5095     12  CN-BILLING-START-LINE-NO    PIC 99.
  5096     12  CN-BILLING-END-LINE-NO      PIC 99.
  5097
  5098     12  CN-LINES.
  5099         16  CN-LINE OCCURS 10       PIC X(77).
  5100
  5101     12  CN-LAST-MAINT-DT            PIC XX.
  5102     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5103     12  CN-LAST-MAINT-USER          PIC X(4).
  5104     12  FILLER                      PIC X(6).
  5105******************************************************************
  5106*                                COPY ERCMAIL.
  5107******************************************************************
  5108*                                                                *
  5109*                                                                *
  5110*                            ERCMAIL                             *
  5111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5112*                            VMOD=2.003                          *
  5113*                                                                *
  5114*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5115*                                                                *
  5116*   FILE TYPE = VSAM,KSDS                                        *
  5117*   RECORD SIZE = 374   RECFORM = FIX                            *
  5118*                                                                *
  5119*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5120*   ALTERNATE PATH    = NOT USED                                 *
  5121*                                                                *
  5122*   LOG = YES                                                    *
  5123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5124******************************************************************
  5125*                   C H A N G E   L O G
  5126*
  5127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5128*-----------------------------------------------------------------
  5129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5130* EFFECTIVE    NUMBER
  5131*-----------------------------------------------------------------
  5132* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5133* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5134* 111108                   PEMA  ADD CRED BENE ADDR2
  5135******************************************************************
  5136
  5137 01  MAILING-DATA.
  5138     12  MA-RECORD-ID                      PIC XX.
  5139         88  VALID-MA-ID                       VALUE 'MA'.
  5140
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  91
* EL6318.cbl
  5141     12  MA-CONTROL-PRIMARY.
  5142         16  MA-COMPANY-CD                 PIC X.
  5143         16  MA-CARRIER                    PIC X.
  5144         16  MA-GROUPING.
  5145             20  MA-GROUPING-PREFIX        PIC XXX.
  5146             20  MA-GROUPING-PRIME         PIC XXX.
  5147         16  MA-STATE                      PIC XX.
  5148         16  MA-ACCOUNT.
  5149             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5150             20  MA-ACCOUNT-PRIME          PIC X(6).
  5151         16  MA-CERT-EFF-DT                PIC XX.
  5152         16  MA-CERT-NO.
  5153             20  MA-CERT-PRIME             PIC X(10).
  5154             20  MA-CERT-SFX               PIC X.
  5155
  5156     12  FILLER                            PIC XX.
  5157
  5158     12  MA-ACCESS-CONTROL.
  5159         16  MA-SOURCE-SYSTEM              PIC XX.
  5160             88  MA-FROM-CREDIT                VALUE 'CR'.
  5161             88  MA-FROM-VSI                   VALUE 'VS'.
  5162             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5163             88  MA-FROM-OTHER                 VALUE 'OT'.
  5164         16  MA-RECORD-ADD-DT              PIC XX.
  5165         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5166         16  MA-LAST-MAINT-DT              PIC XX.
  5167         16  MA-LAST-MAINT-BY              PIC XXXX.
  5168         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5169
  5170     12  MA-PROFILE-INFO.
  5171         16  MA-QUALIFY-CODE-1             PIC XX.
  5172         16  MA-QUALIFY-CODE-2             PIC XX.
  5173         16  MA-QUALIFY-CODE-3             PIC XX.
  5174         16  MA-QUALIFY-CODE-4             PIC XX.
  5175         16  MA-QUALIFY-CODE-5             PIC XX.
  5176
  5177         16  MA-INSURED-LAST-NAME          PIC X(15).
  5178         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5179         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5180         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5181         16  MA-INSURED-BIRTH-DT           PIC XX.
  5182         16  MA-INSURED-SEX                PIC X.
  5183             88  MA-SEX-MALE                   VALUE 'M'.
  5184             88  MA-SEX-FEMALE                 VALUE 'F'.
  5185         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5186
  5187         16  MA-ADDRESS-CORRECTED          PIC X.
  5188         16  MA-JOINT-BIRTH-DT             PIC XX.
  5189*        16  FILLER                        PIC X(12).
  5190
  5191         16  MA-ADDRESS-LINE-1             PIC X(30).
  5192         16  MA-ADDRESS-LINE-2             PIC X(30).
  5193         16  MA-CITY-STATE.
  5194             20  MA-CITY                   PIC X(28).
  5195             20  MA-ADDR-STATE             PIC XX.
  5196         16  MA-ZIP.
  5197             20  MA-ZIP-CODE.
  5198                 24  MA-ZIP-CODE-1ST       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  92
* EL6318.cbl
  5199                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5200                 24  FILLER                PIC X(4).
  5201             20  MA-ZIP-PLUS4              PIC X(4).
  5202         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5203             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5204             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5205             20  FILLER                    PIC X(3).
  5206
  5207         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5208
  5209         16  FILLER                        PIC XXX.
  5210*        16  FILLER                        PIC X(10).
  5211
  5212     12  MA-CRED-BENE-INFO.
  5213         16  MA-CRED-BENE-NAME                 PIC X(25).
  5214         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5215         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5216         16  MA-CRED-BENE-CTYST.
  5217             20  MA-CRED-BENE-CITY             PIC X(28).
  5218             20  MA-CRED-BENE-STATE            PIC XX.
  5219         16  MA-CRED-BENE-ZIP.
  5220             20  MA-CB-ZIP-CODE.
  5221                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5222                     88  MA-CB-CANADIAN-POST-CODE
  5223                                           VALUE 'A' THRU 'Z'.
  5224                 24  FILLER                    PIC X(4).
  5225             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5226         16  MA-CB-CANADIAN-POSTAL-CODE
  5227                            REDEFINES MA-CRED-BENE-ZIP.
  5228             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5229             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5230             20  FILLER                        PIC X(3).
  5231     12  MA-POST-CARD-MAIL-DATA.
  5232         16  MA-MAIL-DATA OCCURS 7.
  5233             20  MA-MAIL-TYPE              PIC X.
  5234                 88  MA-12MO-MAILING           VALUE '1'.
  5235                 88  MA-EXP-MAILING            VALUE '2'.
  5236             20  MA-MAIL-STATUS            PIC X.
  5237                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5238                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5239                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5240             20  MA-MAIL-DATE              PIC XX.
  5241     12  FILLER                            PIC XX.
  5242     12  FILLER                            PIC XX.
  5243*    12  FILLER                            PIC X(30).
  5244******************************************************************
  5245*                                COPY ERCARCH.
  5246******************************************************************
  5247*                                                                *
  5248*                            ERCARCH.                            *
  5249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5250*                            VMOD=2.002                          *
  5251*                                                                *
  5252*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5253*                                                                *
  5254*   FILE TYPE = VSAM,KSDS                                        *
  5255*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5256*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  93
* EL6318.cbl
  5257*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5258*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5259*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5260*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5261*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5262*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5263*                                                                *
  5264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5265******************************************************************
  5266*                   C H A N G E   L O G
  5267*
  5268* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5269*-----------------------------------------------------------------
  5270*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5271* EFFECTIVE    NUMBER
  5272*-----------------------------------------------------------------
  5273* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5274* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5275* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5276******************************************************************
  5277 01  LETTER-ARCHIVE.
  5278     12  LA-RECORD-ID                PIC  X(02).
  5279         88  LA-VALID-ID                VALUE 'LA'.
  5280
  5281     12  LA-CONTROL-PRIMARY.
  5282         16  LA-COMPANY-CD           PIC  X(01).
  5283         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5284
  5285     12  LA-CONTROL-BY-CERT-RESP.
  5286         16  LA-COMPANY-CD-A2        PIC  X(01).
  5287         16  LA-CERT-NO-A2.
  5288             20  LA-CERT-PRIME-A2    PIC  X(10).
  5289             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5290         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5291             20  LA-RESP-PERSON-A2   PIC  X(10).
  5292             20  LA-TYPE-A2          PIC  X(01).
  5293         16  LA-CARRIER-A2           PIC  X(01).
  5294         16  LA-GROUPING-A2          PIC  X(06).
  5295         16  LA-STATE-A2             PIC  X(02).
  5296         16  LA-ACCOUNT-A2           PIC  X(10).
  5297         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5298         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5299
  5300     12  LA-CONTROL-BY-FORM.
  5301         16  LA-COMPANY-CD-A3        PIC  X(01).
  5302         16  LA-FORM-A3              PIC  X(04).
  5303         16  LA-CARRIER-A3           PIC  X(01).
  5304         16  LA-GROUPING-A3          PIC  X(06).
  5305         16  LA-STATE-A3             PIC  X(02).
  5306         16  LA-ACCOUNT-A3           PIC  X(10).
  5307         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5308
  5309     12  LA-CONTROL-BY-PROCESSOR.
  5310         16  LA-COMPANY-CD-A4        PIC  X(01).
  5311         16  LA-PROCESSOR-CD         PIC  X(04).
  5312         16  LA-CARRIER-A4           PIC  X(01).
  5313         16  LA-GROUPING-A4          PIC  X(06).
  5314         16  LA-STATE-A4             PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  94
* EL6318.cbl
  5315         16  LA-ACCOUNT-A4           PIC  X(10).
  5316         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5317
  5318     12  LA-CONTROL-BY-KEY-FIELDS.
  5319         16  LA-COMPANY-CD-A5        PIC  X(01).
  5320         16  LA-CARRIER-A5           PIC  X(01).
  5321         16  LA-GROUPING-A5          PIC  X(06).
  5322         16  LA-STATE-A5             PIC  X(02).
  5323         16  LA-ACCOUNT-A5           PIC  X(10).
  5324         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5325
  5326     12  LA-CONTROL-BY-GROUP-CODE.
  5327         16  LA-COMPANY-CD-A6        PIC  X(01).
  5328         16  LA-ENTRY-A6.
  5329             20  LA-FILLER           PIC  X(02).
  5330             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5331         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5332
  5333     12  FILLER                      PIC  X(09).
  5334
  5335     12  LA-HEADER-RECORD.
  5336         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5337         16  LA-CREATION-DATE        PIC  X(02).
  5338         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5339         16  LA-FINAL-ACT-DATE       REDEFINES
  5340               LA-FOLLOW-UP-DATE     PIC  X(02).
  5341         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5342         16  LA-NO-OF-COPIES         PIC S9(01).
  5343         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5344         16  LA-REPLY-DATE           PIC  X(02).
  5345         16  LA-RESEND-DATES.
  5346             20  LA-RESEND-DATE      PIC  X(02).
  5347             20  LA-SENT-DATE        PIC  X(02).
  5348             20  FILLER              PIC  X(08).
  5349         16  LA-SOURCE-INFORMATION.
  5350             20  LA-DATA-SOURCE      PIC  X(01).
  5351             20  LA-ADDR-SOURCE      PIC  X(01).
  5352         16  LA-STATUS               PIC  X(01).
  5353             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5354             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5355             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5356             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5357             88  LA-STATUS-PURGED         VALUE 'P'.
  5358             88  LA-STATUS-VOIDED         VALUE 'V'.
  5359         16  LA-LAST-RESENT-PRINT-DATE
  5360                                     PIC  X(02).
  5361         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5362             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5363                                          VALUE 'C'.
  5364             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5365                                          VALUE 'F'.
  5366             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5367                                          VALUE 'P'.
  5368         16  LA-PURGED-DATE          PIC  X(02).
  5369         16  LA-VOIDED-DATE          PIC  X(02).
  5370         16  LA-RESEND-LETR          PIC  X(4).
  5371         16  FILLER                  PIC  X(08).
  5372*        16  LA-RESEND-LETR-2        PIC  X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  95
* EL6318.cbl
  5373*        16  LA-RESEND-LETR-3        PIC  X(4).
  5374*        16  FILLER                  PIC  X(59).
  5375         16  LA-ARCHIVE-STATUS       PIC  X.
  5376             88  LA-TEMP                VALUE 'T'.
  5377             88  LA-QWS                 VALUE 'Q'.
  5378             88  LA-BATCH               VALUE 'B'.
  5379         16  LA-FINAL-ACT-IND        PIC  X(1).
  5380         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5381         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5382         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5383                                     PIC X(4).
  5384         16  FILLER                  PIC  X(42).
  5385*        16  FILLER                  PIC  X(71).
  5386         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5387         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5388         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5389                                     PIC  X(4).
  5390         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5391
  5392******************************************************************
  5393*                                COPY ERCCNOT.
  5394******************************************************************
  5395*                                                                *
  5396*                            ERCCNOT                             *
  5397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5398*                            VMOD=2.003                          *
  5399*                                                                *
  5400*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5401*                                                                *
  5402*        FILE TYPE= VSAM,KSDS                                    *
  5403*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5404*                                                                *
  5405*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5406*                                                                *
  5407*        LOG = YES                                               *
  5408*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5409*                                                                *
  5410******************************************************************
  5411*                   C H A N G E   L O G
  5412*
  5413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5414*-----------------------------------------------------------------
  5415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5416* EFFECTIVE    NUMBER
  5417*-----------------------------------------------------------------
  5418* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5419******************************************************************
  5420
  5421 01  CERT-NOTE-FILE.
  5422     12  CZ-RECORD-ID                PIC  XX.
  5423         88  VALID-CZ-ID                  VALUE 'CZ'.
  5424
  5425     12  CZ-CONTROL-PRIMARY.
  5426         16  CZ-COMPANY-CD           PIC X.
  5427         16  CZ-CARRIER              PIC X.
  5428         16  CZ-GROUPING.
  5429             20 CZ-GROUPING-PREFIX   PIC XXX.
  5430             20 CZ-GROUPING-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  96
* EL6318.cbl
  5431         16  CZ-STATE                PIC XX.
  5432         16  CZ-ACCOUNT.
  5433             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5434             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5435         16  CZ-CERT-EFF-DT          PIC XX.
  5436         16  CZ-CERT-NO.
  5437             20  CZ-CERT-PRIME       PIC X(10).
  5438             20  CZ-CERT-SFX         PIC X.
  5439         16  CZ-RECORD-TYPE          PIC X.
  5440             88  CERT-NOTE           VALUE '1'.
  5441             88  CLAIM-CERT-NOTE     VALUE '2'.
  5442         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5443
  5444     12  CZ-LAST-MAINT-DT            PIC XX.
  5445     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5446     12  CZ-LAST-MAINT-USER          PIC X(4).
  5447
  5448     12  CZ-NOTE-INFORMATION.
  5449         16  CZ-NOTE                 PIC X(63).
  5450         16  FILLER                  PIC X(39).
  5451******************************************************************
  5452*                                COPY ELCEOBC.
  5453******************************************************************
  5454*                                                                *
  5455*                                                                *
  5456*                            ELCEOBC                             *
  5457*                            VMOD=2.001                          *
  5458*                                                                *
  5459*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5460*                                                                *
  5461*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5462*   VSAM EOB CODE TABLE                                          *
  5463*                                                                *
  5464*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5465*                                                                *
  5466*   FILE TYPE = VSAM,KSDS                                        *
  5467*   RECORD SIZE = 350   RECFORM = FIX                            *
  5468*                                                                *
  5469*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5470*                                                                *
  5471*   LOG = NO                                                     *
  5472*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5473*                                                                *
  5474*                                                                *
  5475******************************************************************
  5476*                   C H A N G E   L O G
  5477*
  5478* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5479*-----------------------------------------------------------------
  5480*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5481* EFFECTIVE    NUMBER
  5482*-----------------------------------------------------------------
  5483* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5484* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5485******************************************************************
  5486 01  EOB-CODES.
  5487     12  EO-RECORD-ID                      PIC XX.
  5488         88  VALID-DN-ID                      VALUE 'EO'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  97
* EL6318.cbl
  5489     12  EO-CONTROL-PRIMARY.
  5490         16  EO-COMPANY-CD                 PIC X.
  5491         16  EO-RECORD-TYPE                PIC X.
  5492             88  EO-EOB-RECS                  VALUE '1'.
  5493             88  EO-VERIF-RECS                VALUE '2'.
  5494             88  EO-GCE-RECS                  VALUE '3'.
  5495         16  EO-EOB-CODE                   PIC X(4).
  5496         16  FILLER                        PIC X(9).
  5497     12  EO-MAINT-INFORMATION.
  5498         16  EO-LAST-MAINT-DT              PIC XX.
  5499         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5500         16  EO-LAST-MAINT-USER            PIC X(4).
  5501         16  FILLER                        PIC XX.
  5502     12  EO-DESCRIPTION                    PIC X(275).
  5503     12  FILLER                            PIC X(46).
  5504******************************************************************
  5505 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5506                          ACCOUNT-MASTER CONTROL-FILE
  5507                          PENDING-BUSINESS CERTIFICATE-MASTER
  5508                          ORIGINAL-CERTIFICATE
  5509                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5510                          MAILING-DATA LETTER-ARCHIVE
  5511                          CERT-NOTE-FILE EOB-CODES.
  5512 0000-DFHEXIT SECTION.
  5513     MOVE '9#                    $   ' TO DFHEIV0.
  5514     MOVE 'EL6318' TO DFHEIV1.
  5515     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5516     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5517     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5518     MOVE '5'                    TO DC-OPTION-CODE
  5519     PERFORM 9700-DATE-LINK
  5520     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5521     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5522     MOVE EIBTRMID               TO QID-TERM
  5523     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5524     IF EIBCALEN = 0
  5525        GO TO 8800-UNAUTHORIZED-ACCESS
  5526     END-IF
  5527     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5528     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5529        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5530           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5531           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5532           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5533           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5534           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5535           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5536           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5537           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5538           MOVE LOW-VALUES           TO EL631KI
  5539           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5540           GO TO 0350-BUILD-INIT-MAP
  5541        END-IF
  5542     END-IF
  5543     IF PI-CALLING-PROGRAM = 'EL614'
  5544        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5545                                 TO WS-PASSED-REASON-CODES
  5546        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  98
* EL6318.cbl
  5547        IF WS-PASSED-REASON-CODES NOT = SPACES
  5548           MOVE 'Y'                TO WS-SET-CODES-MDT
  5549        ELSE
  5550           MOVE 'N'                TO WS-SET-CODES-MDT
  5551        END-IF
  5552        PERFORM 0600-RECOVER-TEMP-STORAGE
  5553                                 THRU 0600-EXIT
  5554        GO TO 0350-BUILD-INIT-MAP
  5555     END-IF
  5556     IF EIBAID = DFHCLEAR
  5557        IF PI-CLEAR-ERROR
  5558           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5559           MOVE ER-3832           TO EMI-ERROR
  5560           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5561           GO TO 0350-BUILD-INIT-MAP
  5562        ELSE
  5563           GO TO 9400-CLEAR
  5564        END-IF
  5565     END-IF
  5566     .
  5567 0200-RECEIVE.
  5568     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5569        MOVE ER-0008             TO EMI-ERROR
  5570        PERFORM 9900-ERROR-FORMAT
  5571                                 THRU 9900-EXIT
  5572        MOVE -1                  TO PFENTRL
  5573        GO TO 8100-SEND-INITIAL-MAP
  5574     END-IF
  5575
  5576* EXEC CICS RECEIVE
  5577*        MAP      (MAP-NAME)
  5578*        MAPSET   (MAPSET-NAME)
  5579*        INTO     (EL631KI)
  5580*    END-EXEC
  5581     MOVE LENGTH OF
  5582      EL631KI
  5583       TO DFHEIV11
  5584*    MOVE '8"T I  L              ''   #00005571' TO DFHEIV0
  5585     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5586     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5587     MOVE X'2020233030303035353731' TO DFHEIV0(25:11)
  5588     CALL 'kxdfhei1' USING DFHEIV0,
  5589           MAP-NAME,
  5590           EL631KI,
  5591           DFHEIV11,
  5592           MAPSET-NAME,
  5593           DFHEIV99,
  5594           DFHEIV99
  5595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5596     IF PFENTRL = 0
  5597         GO TO 0300-CHECK-PFKEYS
  5598     END-IF
  5599     IF EIBAID NOT = DFHENTER
  5600         MOVE ER-0004            TO EMI-ERROR
  5601         GO TO 0320-INPUT-ERROR
  5602     END-IF
  5603     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5604        MOVE PF-VALUES (PFENTRI) TO EIBAID
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  99
* EL6318.cbl
  5605     ELSE
  5606        MOVE ER-0029            TO EMI-ERROR
  5607        GO TO 0320-INPUT-ERROR
  5608     END-IF
  5609     .
  5610 0300-CHECK-PFKEYS.
  5611     IF EIBAID = DFHPF1
  5612        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5613        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5614        MOVE 'EL614'             TO PGM-NAME
  5615        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5616        move +1                  to s2
  5617        perform varying s1 from +1 by +1 until s1 > +12
  5618           if reacd-in (s1) not = spaces and low-values
  5619              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5620              add +5 to s2
  5621           end-if
  5622        END-perform
  5623        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5624        GO TO 9300-XCTL
  5625     END-IF
  5626     IF EIBAID = DFHPF2 OR DFHPF8
  5627        GO TO 0360-FINALIZE
  5628     END-IF
  5629     IF EIBAID = DFHPF23
  5630        IF PI-CLEAR-ERROR
  5631           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5632           MOVE ER-3832           TO EMI-ERROR
  5633           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5634           GO TO 0350-BUILD-INIT-MAP
  5635        ELSE
  5636           GO TO 8810-PF23
  5637        END-IF
  5638     END-IF
  5639     IF EIBAID = DFHPF24
  5640        IF PI-CLEAR-ERROR
  5641           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5642           MOVE ER-3832           TO EMI-ERROR
  5643           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5644           GO TO 0350-BUILD-INIT-MAP
  5645        ELSE
  5646           GO TO 9200-RETURN-MAIN-MENU
  5647        END-IF
  5648     END-IF
  5649     IF EIBAID = DFHPF12
  5650        GO TO 9500-PF12
  5651     END-IF
  5652     IF EIBAID = DFHENTER
  5653        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5654        GO TO 0325-EDIT-SCREEN
  5655     END-IF
  5656     MOVE ER-0029                TO EMI-ERROR
  5657     .
  5658 0320-INPUT-ERROR.
  5659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5660     MOVE AL-UNBON               TO PFENTRA
  5661     MOVE -1                     TO PFENTRL
  5662     GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 100
* EL6318.cbl
  5663     .
  5664 0325-EDIT-SCREEN.
  5665     IF PRTSWL > ZEROS
  5666       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5667*          MOVE AL-UANON       TO PRTSWA
  5668*          IF PRTSWI = ' '
  5669*             MOVE 'N'         TO PRTSWI
  5670              MOVE 'P'         TO PRTSWI
  5671*          END-IF
  5672*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5673        END-IF
  5674     END-IF
  5675     IF (SIGREQL > ZEROS)
  5676        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5677        MOVE AL-UANON         TO SIGREQA
  5678        IF SIGREQI = ' '
  5679           MOVE 'N'           TO SIGREQI
  5680        END-IF
  5681        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5682     ELSE
  5683        MOVE ER-2651          TO EMI-ERROR
  5684        MOVE -1               TO SIGREQL
  5685        MOVE AL-UABON         TO SIGREQA
  5686        PERFORM 9900-ERROR-FORMAT
  5687                                 THRU 9900-EXIT
  5688     END-IF
  5689     IF LTRIDL > ZEROS
  5690        AND LTRIDI > SPACES
  5691        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5692        MOVE LTRIDI              TO LETR-LETTER-ID
  5693                                    PI-LTRID-ENTERED
  5694        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5695        MOVE SPACES              TO LETR-FILLER
  5696        MOVE 0                   TO LETR-SEQ-NO
  5697        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5698     ELSE
  5699        MOVE ER-1236          TO EMI-ERROR
  5700        MOVE -1               TO LTRIDL
  5701        MOVE AL-UABON         TO LTRIDA
  5702        PERFORM 9900-ERROR-FORMAT
  5703                                 THRU 9900-EXIT
  5704     END-IF
  5705
  5706     IF W-PROMPT-LETTER EQUAL 'Y'
  5707         MOVE ER-0894            TO EMI-ERROR
  5708         MOVE -1                 TO LTRIDL
  5709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5710     END-IF
  5711     IF VOUCHL > ZEROS
  5712        IF VOUCHI = 'Y' OR 'N'
  5713           MOVE AL-UANON         TO VOUCHA
  5714           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5715        ELSE
  5716           MOVE ER-9999          TO EMI-ERROR
  5717           MOVE -1               TO VOUCHL
  5718           MOVE AL-UABON         TO VOUCHA
  5719           PERFORM 9900-ERROR-FORMAT
  5720                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 101
* EL6318.cbl
  5721        END-IF
  5722     END-IF
  5723     IF HLTHAPPL > ZEROS
  5724        IF HLTHAPPI = 'Y' OR 'N'
  5725           MOVE AL-UANON         TO HLTHAPPA
  5726           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  5727        ELSE
  5728           MOVE ER-9999          TO EMI-ERROR
  5729           MOVE -1               TO HLTHAPPL
  5730           MOVE AL-UABON         TO HLTHAPPA
  5731           PERFORM 9900-ERROR-FORMAT
  5732                                 THRU 9900-EXIT
  5733        END-IF
  5734     END-IF
  5735     IF PAYEEL > ZEROS
  5736        IF PAYEEI > SPACES
  5737           MOVE AL-UANON         TO PAYEEA
  5738           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5739        ELSE
  5740           MOVE ER-9999          TO EMI-ERROR
  5741           MOVE -1               TO PAYEEL
  5742           MOVE AL-UABON         TO PAYEEA
  5743           PERFORM 9900-ERROR-FORMAT
  5744                                 THRU 9900-EXIT
  5745        END-IF
  5746     END-IF
  5747     IF CERTIDL > ZEROS
  5748         IF CERTIDI NUMERIC
  5749            MOVE AL-UANON      TO CERTIDA
  5750            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5751         ELSE
  5752            MOVE ER-1778       TO EMI-ERROR
  5753            MOVE -1            TO CERTIDL
  5754            MOVE AL-UABON      TO CERTIDA
  5755            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5756        END-IF
  5757     ELSE
  5758        IF PI-PRINT-CERTIFICATE = 'Y'
  5759            MOVE ER-0715       TO EMI-ERROR
  5760            MOVE -1            TO CERTIDL
  5761            MOVE AL-UABON      TO CERTIDA
  5762            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5763        END-IF
  5764     END-IF
  5765     SET REASONS-NOT-FOUND TO TRUE
  5766     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5767        IF REACDL (S1) = +4 OR
  5768          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5769              MOVE AL-SANON     TO REACDA (S1)
  5770              SET REASONS-FOUND TO TRUE
  5771        END-IF
  5772     END-PERFORM
  5773
  5774     IF REASONS-NOT-FOUND
  5775        MOVE ER-1820             TO EMI-ERROR
  5776        MOVE -1                  TO PFENTRL
  5777        PERFORM 9900-ERROR-FORMAT
  5778                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 102
* EL6318.cbl
  5779     ELSE
  5780        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5781     END-IF
  5782
  5783     IF CRTNT1L > ZEROS
  5784        IF CRTNT1I > SPACES
  5785           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5786        END-IF
  5787     END-IF
  5788
  5789     IF CRTNT2L > ZEROS
  5790        IF CRTNT2I > SPACES
  5791           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5792        END-IF
  5793     END-IF
  5794
  5795     IF CRTNT3L > ZEROS
  5796        IF CRTNT3I > SPACES
  5797           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  5798        END-IF
  5799     END-IF
  5800
  5801     IF CRTNT4L > ZEROS
  5802        IF CRTNT4I > SPACES
  5803           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  5804        END-IF
  5805     END-IF
  5806
  5807     IF CRTNT5L > ZEROS
  5808        IF CRTNT5I > SPACES
  5809           MOVE CRTNT5I          TO PI-CERTNT5-ENTERED
  5810        END-IF
  5811     END-IF
  5812
  5813     IF CRTNT6L > ZEROS
  5814        IF CRTNT6I > SPACES
  5815           MOVE CRTNT6I          TO PI-CERTNT6-ENTERED
  5816        END-IF
  5817     END-IF
  5818
  5819     .
  5820 0325-EXIT.
  5821     EXIT.
  5822
  5823 0326-GET-Z-RECORD.
  5824
  5825     MOVE SPACES  TO W-Z-CONTROL-DATA
  5826
  5827
  5828* EXEC CICS STARTBR
  5829*         DATASET    ('ELLETR')
  5830*         RIDFLD     (ELLETR-KEY)
  5831*         GTEQ
  5832*         RESP      (WS-RESPONSE)
  5833*    END-EXEC.
  5834     MOVE 'ELLETR' TO DFHEIV1
  5835     MOVE 0
  5836       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 103
* EL6318.cbl
  5837*    MOVE '&,         G          &  N#00005807' TO DFHEIV0
  5838     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5839     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5840     MOVE X'204E233030303035383037' TO DFHEIV0(25:11)
  5841     CALL 'kxdfhei1' USING DFHEIV0,
  5842           DFHEIV1,
  5843           ELLETR-KEY,
  5844           DFHEIV99,
  5845           DFHEIV11,
  5846           DFHEIV99
  5847     MOVE EIBRESP  TO WS-RESPONSE
  5848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5849
  5850     IF NOT RESP-NORMAL
  5851         MOVE ER-1236          TO EMI-ERROR
  5852         MOVE -1               TO LTRIDL
  5853         MOVE AL-UABON         TO LTRIDA
  5854         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5855         GO TO 0326-ENDBR
  5856     END-IF.
  5857
  5858 0326-READNEXT.
  5859
  5860
  5861* EXEC CICS READNEXT
  5862*        DATASET   ('ELLETR')
  5863*        INTO      (TEXT-FILES)
  5864*        RIDFLD    (ELLETR-KEY)
  5865*        RESP      (WS-RESPONSE)
  5866*    END-EXEC
  5867     MOVE LENGTH OF
  5868      TEXT-FILES
  5869       TO DFHEIV12
  5870     MOVE 'ELLETR' TO DFHEIV1
  5871     MOVE 0
  5872       TO DFHEIV11
  5873*    MOVE '&.IL                  )  N#00005823' TO DFHEIV0
  5874     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5875     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5876     MOVE X'204E233030303035383233' TO DFHEIV0(25:11)
  5877     CALL 'kxdfhei1' USING DFHEIV0,
  5878           DFHEIV1,
  5879           TEXT-FILES,
  5880           DFHEIV12,
  5881           ELLETR-KEY,
  5882           DFHEIV99,
  5883           DFHEIV11,
  5884           DFHEIV99,
  5885           DFHEIV99
  5886     MOVE EIBRESP  TO WS-RESPONSE
  5887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5888     IF RESP-NORMAL
  5889        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5890           MOVE ER-1236          TO EMI-ERROR
  5891           MOVE -1               TO LTRIDL
  5892           MOVE AL-UABON         TO LTRIDA
  5893           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5894           GO TO 0326-ENDBR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 104
* EL6318.cbl
  5895        END-IF
  5896
  5897        MOVE AL-UANON         TO LTRIDA
  5898        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5899           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5900        ELSE
  5901           GO TO 0326-READNEXT
  5902        END-IF
  5903     ELSE
  5904        MOVE ER-1236          TO EMI-ERROR
  5905        MOVE -1               TO LTRIDL
  5906        MOVE AL-UABON         TO LTRIDA
  5907        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5908        GO TO 0326-ENDBR
  5909     END-IF.
  5910
  5911 0326-ENDBR.
  5912
  5913
  5914* EXEC CICS ENDBR
  5915*        DATASET     ('ELLETR')
  5916*    END-EXEC.
  5917     MOVE 'ELLETR' TO DFHEIV1
  5918     MOVE 0
  5919       TO DFHEIV11
  5920*    MOVE '&2                    $   #00005854' TO DFHEIV0
  5921     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5922     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5923     MOVE X'2020233030303035383534' TO DFHEIV0(25:11)
  5924     CALL 'kxdfhei1' USING DFHEIV0,
  5925           DFHEIV1,
  5926           DFHEIV11,
  5927           DFHEIV99
  5928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5929
  5930
  5931 0326-EXIT.
  5932      EXIT.
  5933 0330-CHECK-ERRORS.
  5934     IF EMI-NO-ERRORS
  5935        GO TO 0350-BUILD-INIT-MAP
  5936     ELSE
  5937        GO TO 8200-SEND-DATAONLY
  5938     END-IF
  5939     .
  5940 0330-EXIT.
  5941     EXIT.
  5942 0350-BUILD-INIT-MAP.
  5943     MOVE PI-CRTO-CARRIER        TO CARRO
  5944     MOVE PI-CRTO-GROUPING       TO GROUPO
  5945     MOVE PI-CRTO-STATE          TO STATEO
  5946     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5947     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5948     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5949     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5950     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5951     MOVE ' '                    TO DC-OPTION-CODE
  5952     PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 105
* EL6318.cbl
  5953     IF NO-CONVERSION-ERROR
  5954        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5955     END-IF
  5956*     IF PI-PRTSW-ENTERED > SPACES
  5957*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5958*        MOVE AL-UANON            TO PRTSWA
  5959*        MOVE +1                  TO PRTSWL
  5960*     END-IF
  5961
  5962     IF PI-SIGREQ-ENTERED > SPACES
  5963        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5964        MOVE AL-UANON            TO SIGREQA
  5965        MOVE +1                  TO SIGREQL
  5966     ELSE
  5967        IF PI-CLAIM-REFORMATION
  5968            MOVE 'Y'             TO SIGREQI
  5969            MOVE AL-UANON        TO SIGREQA
  5970            MOVE +1              TO SIGREQL
  5971        END-IF
  5972     END-IF
  5973
  5974     IF PI-LTRID-ENTERED > SPACES
  5975        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5976        MOVE AL-UANON            TO LTRIDA
  5977        MOVE +4                  TO LTRIDL
  5978     ELSE
  5979        IF PI-CLAIM-REFORMATION
  5980            MOVE 'CLRF'          TO LTRIDI
  5981            MOVE AL-UANON        TO LTRIDA
  5982            MOVE +4              TO LTRIDL
  5983        END-IF
  5984     END-IF
  5985
  5986     IF PI-VOUCHER-ENTERED > SPACES
  5987        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  5988        MOVE AL-UANON            TO VOUCHA
  5989        MOVE +1                  TO VOUCHL
  5990     END-IF
  5991
  5992     IF PI-HLTHAPP-ENTERED > SPACES
  5993        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  5994        MOVE AL-UANON            TO HLTHAPPA
  5995        MOVE +1                  TO HLTHAPPL
  5996     END-IF
  5997
  5998     IF PI-PAYEE-ENTERED > SPACES
  5999        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6000        MOVE AL-UANON            TO PAYEEA
  6001        MOVE +10                 TO PAYEEL
  6002     END-IF
  6003
  6004     IF PI-CERTID-ENTERED > SPACES
  6005        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6006        MOVE AL-UANON            TO CERTIDA
  6007        MOVE +5                  TO CERTIDL
  6008     END-IF
  6009
  6010     SET REASONS-NOT-FOUND TO TRUE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 106
* EL6318.cbl
  6011     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6012     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6013        IF REACDL (S1) = +4 OR
  6014          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6015              MOVE AL-SANON      TO REACDA (S1)
  6016              MOVE +4            TO REACDL (S1)
  6017              SET REASONS-FOUND  TO TRUE
  6018        END-IF
  6019     END-PERFORM
  6020
  6021     IF REASONS-NOT-FOUND
  6022         IF PI-CLAIM-REFORMATION
  6023            MOVE 'CRNA'          TO REACD-IN (1)
  6024            MOVE AL-SANON        TO REACDA (1)
  6025            MOVE +4              TO REACDL (1)
  6026            SET REASONS-FOUND    TO TRUE
  6027        END-IF
  6028     END-IF
  6029
  6030     IF PI-CERTNT1-ENTERED > SPACES
  6031        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6032        MOVE AL-UANON            TO CRTNT1A
  6033        MOVE +63                 TO CRTNT1L
  6034     END-IF
  6035
  6036     IF PI-CERTNT2-ENTERED > SPACES
  6037        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6038        MOVE AL-UANON            TO CRTNT2A
  6039        MOVE +63                 TO CRTNT2L
  6040     END-IF
  6041
  6042     IF PI-CERTNT3-ENTERED > SPACES
  6043        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6044        MOVE AL-UANON            TO CRTNT3A
  6045        MOVE +63                 TO CRTNT3L
  6046     END-IF
  6047
  6048     IF PI-CERTNT4-ENTERED > SPACES
  6049        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6050        MOVE AL-UANON            TO CRTNT4A
  6051        MOVE +63                 TO CRTNT4L
  6052     END-IF
  6053
  6054     IF PI-CERTNT5-ENTERED > SPACES
  6055        MOVE PI-CERTNT5-ENTERED  TO CRTNT5I
  6056        MOVE AL-UANON            TO CRTNT5A
  6057        MOVE +63                 TO CRTNT5L
  6058     END-IF
  6059
  6060     IF PI-CERTNT6-ENTERED > SPACES
  6061        MOVE PI-CERTNT6-ENTERED  TO CRTNT6I
  6062        MOVE AL-UANON            TO CRTNT6A
  6063        MOVE +63                 TO CRTNT6L
  6064     END-IF
  6065
  6066     GO TO 8100-SEND-INITIAL-MAP
  6067     .
  6068 0360-FINALIZE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 107
* EL6318.cbl
  6069     display ' made it to 0360 '
  6070     set P to address of KIXSYS
  6071     CALL "getenv" using by value P returning var-ptr
  6072     if var-ptr = null then
  6073        display ' kixsys not set '
  6074     else
  6075        set address of var to var-ptr
  6076        move 0 to env-var-len
  6077        inspect var tallying env-var-len
  6078          for characters before X'00'
  6079*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6080        unstring var (1:env-var-len) delimited by '/'
  6081           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6082              WS-KIX-SYS
  6083        end-unstring
  6084*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6085*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6086     end-if
  6087     set P to address of KIXHOST
  6088     CALL "getenv" using by value P returning var-ptr
  6089     if var-ptr = null then
  6090        display ' kixhost not set '
  6091     else
  6092        set address of var to var-ptr
  6093        move 0 to env-var-len
  6094        inspect var tallying env-var-len
  6095          for characters before X'00'
  6096*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6097        MOVE var(1:env-var-len)  to ws-kixhost
  6098        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6099     end-if
  6100     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6101     IF NOT EMI-NO-ERRORS
  6102       AND EIBAID = DFHPF2
  6103        GO TO 8200-SEND-DATAONLY
  6104     END-IF
  6105     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6106     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6107                                    NEW-ELCRTO-KEY
  6108     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6109     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6110     IF RESP-NORMAL
  6111        AND (PI-ELCRTO-KEY = OC-CONTROL-PRIMARY)
  6112        DISPLAY ' RESP NORMAL AND = '
  6113        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6114*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6115        PERFORM 1100-CALL-NS-BUS-LOGIC
  6116                                 THRU 1100-EXIT
  6117        IF BL-OK
  6118           CONTINUE
  6119        ELSE
  6120           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6121           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6122           MOVE -1               TO SIGREQL
  6123        END-IF
  6124     ELSE
  6125        MOVE ER-9999             TO EMI-ERROR
  6126        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 108
* EL6318.cbl
  6127                                 THRU 9900-EXIT
  6128        MOVE -1                  TO SIGREQL
  6129        GO TO 8100-SEND-INITIAL-MAP
  6130     END-IF
  6131     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6132                                 TO SYSO
  6133     MOVE WS-KIXHOST             TO HOSTO
  6134     MOVE PI-COMPANY-ID          TO COMPANYO
  6135     MOVE '4'                    TO DATASORO
  6136     MOVE BL-BATCH-NO            TO BATCHNOO
  6137     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6138     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6139     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6140*    MOVE 'N'                    TO PRTSWO
  6141*    MOVE -1                     TO PRTSWL
  6142*    MOVE AL-UANON               TO PRTSWA
  6143     MOVE -1                     TO SIGREQL
  6144     MOVE AL-UANON               TO SIGREQA
  6145     IF EIBAID = DFHPF2
  6146        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6147        MOVE ER-0280             TO EMI-ERROR
  6148        PERFORM 9900-ERROR-FORMAT
  6149                                 THRU 9900-EXIT
  6150        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6151        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6152        MOVE 'Y'                 TO PI-FINALIZED-IND
  6153        GO TO 9400-CLEAR
  6154     ELSE
  6155        MOVE ER-1818             TO EMI-ERROR
  6156        PERFORM 9900-ERROR-FORMAT
  6157                                 THRU 9900-EXIT
  6158     END-IF
  6159     GO TO 0350-BUILD-INIT-MAP
  6160     .
  6161 0360-EXIT.
  6162     EXIT.
  6163 0362-READ-ELCRTO.
  6164     display ' made it to 0362 '
  6165
  6166* EXEC CICS READ
  6167*        DATASET   (WS-ELCRTO-FILE-ID)
  6168*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6169*        RIDFLD    (ELCRTO-KEY)
  6170*        RESP      (WS-RESPONSE)
  6171*    END-EXEC
  6172*    MOVE '&"S        E          (  N#00006092' TO DFHEIV0
  6173     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6175     MOVE X'204E233030303036303932' TO DFHEIV0(25:11)
  6176     CALL 'kxdfhei1' USING DFHEIV0,
  6177           WS-ELCRTO-FILE-ID,
  6178           DFHEIV20,
  6179           DFHEIV99,
  6180           ELCRTO-KEY,
  6181           DFHEIV99,
  6182           DFHEIV99,
  6183           DFHEIV99
  6184     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 109
* EL6318.cbl
  6185         DFHEIV20
  6186     MOVE EIBRESP  TO WS-RESPONSE
  6187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6188     .
  6189 0362-EXIT.
  6190     EXIT.
  6191 0363-READ-ELCRTO-UPD.
  6192     display ' made it to 0363 '
  6193
  6194* EXEC CICS READ
  6195*        DATASET   (WS-ELCRTO-FILE-ID)
  6196*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6197*        RIDFLD    (ELCRTO-KEY)
  6198*        UPDATE
  6199*        RESP      (WS-RESPONSE)
  6200*    END-EXEC
  6201*    MOVE '&"S        EU         (  N#00006103' TO DFHEIV0
  6202     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6203     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6204     MOVE X'204E233030303036313033' TO DFHEIV0(25:11)
  6205     CALL 'kxdfhei1' USING DFHEIV0,
  6206           WS-ELCRTO-FILE-ID,
  6207           DFHEIV20,
  6208           DFHEIV99,
  6209           ELCRTO-KEY,
  6210           DFHEIV99,
  6211           DFHEIV99,
  6212           DFHEIV99
  6213     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6214         DFHEIV20
  6215     MOVE EIBRESP  TO WS-RESPONSE
  6216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6217     .
  6218 0363-EXIT.
  6219     EXIT.
  6220 0365-READ-ERENDT.
  6221
  6222* EXEC CICS READ
  6223*        DATASET   (WS-ERENDT-FILE-ID)
  6224*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6225*        RIDFLD    (ERENDT-KEY)
  6226*        RESP      (WS-RESPONSE)
  6227*    END-EXEC
  6228*    MOVE '&"S        E          (  N#00006114' TO DFHEIV0
  6229     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6231     MOVE X'204E233030303036313134' TO DFHEIV0(25:11)
  6232     CALL 'kxdfhei1' USING DFHEIV0,
  6233           WS-ERENDT-FILE-ID,
  6234           DFHEIV20,
  6235           DFHEIV99,
  6236           ERENDT-KEY,
  6237           DFHEIV99,
  6238           DFHEIV99,
  6239           DFHEIV99
  6240     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6241         DFHEIV20
  6242     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 110
* EL6318.cbl
  6243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6244     .
  6245 0365-EXIT.
  6246     EXIT.
  6247 0400-ADD-ERENDT.
  6248     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6249     display ' made it to 0400 '
  6250
  6251* EXEC CICS GETMAIN
  6252*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6253*         LENGTH   (ERENDT-LENGTH)
  6254*         INITIMG  (GETMAIN-SPACE)
  6255*    END-EXEC
  6256*    MOVE ',"IL                  $   #00006126' TO DFHEIV0
  6257     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6258     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6259     MOVE X'2020233030303036313236' TO DFHEIV0(25:11)
  6260     CALL 'kxdfhei1' USING DFHEIV0,
  6261           DFHEIV20,
  6262           ERENDT-LENGTH,
  6263           GETMAIN-SPACE
  6264     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6265         DFHEIV20
  6266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6267     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6268     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6269     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6270     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6271                                    EN-INPUT-DT
  6272                                    EN-PROCESS-DT
  6273
  6274     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6275     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6276     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6277     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6278     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6279     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6280     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6281     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6282     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6283     IF OC-LF-BENCD NOT = '00' AND '  '
  6284        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6285        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6286        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6287        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6288        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6289        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6290        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6291     END-IF
  6292     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6293     IF OC-AH-BENCD NOT = '00' AND '  '
  6294        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6295        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6296        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6297        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6298        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6299        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6300     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 111
* EL6318.cbl
  6301     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6302
  6303* EXEC CICS GETMAIN
  6304*         SET      (ADDRESS OF PENDING-BUSINESS)
  6305*         LENGTH   (ERPNDB-LENGTH)
  6306*         INITIMG  (GETMAIN-SPACE)
  6307*    END-EXEC
  6308*    MOVE ',"IL                  $   #00006166' TO DFHEIV0
  6309     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6311     MOVE X'2020233030303036313636' TO DFHEIV0(25:11)
  6312     CALL 'kxdfhei1' USING DFHEIV0,
  6313           DFHEIV20,
  6314           ERPNDB-LENGTH,
  6315           GETMAIN-SPACE
  6316     SET ADDRESS OF PENDING-BUSINESS TO
  6317         DFHEIV20
  6318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6319     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6320     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6321
  6322* EXEC CICS READ
  6323*        DATASET   (WS-ERPNDB-FILE-ID)
  6324*        INTO      (PENDING-BUSINESS)
  6325*        RIDFLD    (ERPNDB-KEY)
  6326*        RESP      (WS-RESPONSE)
  6327*    END-EXEC
  6328     MOVE LENGTH OF
  6329      PENDING-BUSINESS
  6330       TO DFHEIV11
  6331*    MOVE '&"IL       E          (  N#00006173' TO DFHEIV0
  6332     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6334     MOVE X'204E233030303036313733' TO DFHEIV0(25:11)
  6335     CALL 'kxdfhei1' USING DFHEIV0,
  6336           WS-ERPNDB-FILE-ID,
  6337           PENDING-BUSINESS,
  6338           DFHEIV11,
  6339           ERPNDB-KEY,
  6340           DFHEIV99,
  6341           DFHEIV99,
  6342           DFHEIV99
  6343     MOVE EIBRESP  TO WS-RESPONSE
  6344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6345     IF NOT RESP-NORMAL
  6346        GO TO 0400-EXIT
  6347     END-IF
  6348*    set found-pndb to true
  6349     display ' good read on erpndb '
  6350     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6351                                      NCRTO-INS-FIRST-NAME
  6352     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6353                                      NCRTO-INS-MIDDLE-INIT
  6354     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6355                                      NCRTO-INS-LAST-NAME
  6356     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6357                                      NCRTO-INS-AGE
  6358     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 112
* EL6318.cbl
  6359                                      NCRTO-JNT-FIRST-NAME
  6360     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6361                                      NCRTO-JNT-MIDDLE-INIT
  6362     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6363                                      NCRTO-JNT-LAST-NAME
  6364     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6365                                      NCRTO-JNT-AGE
  6366     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6367                                      NCRTO-LF-BENCD
  6368     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6369        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6370                                      NCRTO-LF-BEN-AMT
  6371        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6372                                      NCRTO-LF-PRM-AMT
  6373        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6374                                      NCRTO-LF-ALT-BEN-AMT
  6375        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6376                                      NCRTO-LF-ALT-PRM-AMT
  6377        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6378                                      NCRTO-LF-TERM
  6379        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6380                                      NCRTO-LF-EXP-DT
  6381        IF PB-I-JOINT-COMMISSION > +0
  6382           MOVE PB-I-JOINT-COMMISSION
  6383                                   TO EN-LF-NEW-COMM-PCT
  6384                                      NCRTO-LF-COMM-PCT
  6385        ELSE
  6386           MOVE PB-I-LIFE-COMMISSION
  6387                                   TO EN-LF-NEW-COMM-PCT
  6388                                      NCRTO-LF-COMM-PCT
  6389        END-IF
  6390     END-IF
  6391     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6392                                      NCRTO-AH-BENCD
  6393     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6394        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6395                                      NCRTO-AH-BEN-AMT
  6396        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6397                                      NCRTO-AH-PRM-AMT
  6398        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6399                                      NCRTO-AH-TERM
  6400        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6401                                      NCRTO-AH-EXP-DT
  6402        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6403                                      NCRTO-AH-CP
  6404        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6405                                      NCRTO-AH-COMM-PCT
  6406     END-IF
  6407     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6408     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6409     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6410     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6411*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6412     MOVE 'Y'                    TO EN-COMM-CHGBK
  6413
  6414     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6415        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6416        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 113
* EL6318.cbl
  6417        EN-AH-NEW-PRM-AMT)
  6418     COMPUTE EN-ACCT-PORTION ROUNDED =
  6419        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6420        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6421        * EN-LF-NEW-COMM-PCT)
  6422                       +
  6423        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6424        * EN-AH-NEW-COMM-PCT)
  6425     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6426        EN-ACCT-PORTION
  6427     move pb-control-by-account (1:33)
  6428                                 to ws-ermail-key
  6429
  6430* EXEC CICS READ
  6431*        DATASET   ('ERMAIL')
  6432*        SET       (ADDRESS OF MAILING-DATA)
  6433*        RIDFLD    (WS-ERMAIL-KEY)
  6434*        RESP      (WS-RESPONSE)
  6435*    END-EXEC
  6436     MOVE 'ERMAIL' TO DFHEIV1
  6437*    MOVE '&"S        E          (  N#00006263' TO DFHEIV0
  6438     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6439     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6440     MOVE X'204E233030303036323633' TO DFHEIV0(25:11)
  6441     CALL 'kxdfhei1' USING DFHEIV0,
  6442           DFHEIV1,
  6443           DFHEIV20,
  6444           DFHEIV99,
  6445           WS-ERMAIL-KEY,
  6446           DFHEIV99,
  6447           DFHEIV99,
  6448           DFHEIV99
  6449     SET ADDRESS OF MAILING-DATA TO
  6450         DFHEIV20
  6451     MOVE EIBRESP  TO WS-RESPONSE
  6452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6453     IF RESP-NORMAL
  6454        DISPLAY ' FOUND ERMAIL '
  6455        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6456                                    NCRTO-CRED-BENE-NAME
  6457     ELSE
  6458        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6459     END-IF
  6460     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6461        IF REACD-IN (S1) NOT = LOW-VALUES
  6462           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6463        END-IF
  6464     END-PERFORM
  6465     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6466     MOVE 'G'                    TO EN-DOCU-TYPE
  6467     MOVE 'Y'                    TO EN-MONEY-SW
  6468     MOVE SIGREQI                TO EN-SIG-SW
  6469     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6470     MOVE PAYEEI                 TO EN-PAYEE
  6471     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6472     DISPLAY ' 0400 EXIT '
  6473     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6474     .
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 114
* EL6318.cbl
  6475 0400-EXIT.
  6476     EXIT.
  6477 0410-INIT-ERENDT.
  6478     display ' made it to 0410 '
  6479     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6480     MOVE ZEROS                  TO ENDT-SEQ-NO
  6481
  6482* EXEC CICS READ
  6483*        DATASET    (WS-ERENDT-FILE-ID)
  6484*        RIDFLD     (ERENDT-KEY)
  6485*        INTO       (ENDORSEMENT-RECORD)
  6486*        RESP       (WS-RESPONSE)
  6487*        GTEQ
  6488*    END-EXEC
  6489     MOVE LENGTH OF
  6490      ENDORSEMENT-RECORD
  6491       TO DFHEIV11
  6492*    MOVE '&"IL       G          (  N#00006297' TO DFHEIV0
  6493     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6495     MOVE X'204E233030303036323937' TO DFHEIV0(25:11)
  6496     CALL 'kxdfhei1' USING DFHEIV0,
  6497           WS-ERENDT-FILE-ID,
  6498           ENDORSEMENT-RECORD,
  6499           DFHEIV11,
  6500           ERENDT-KEY,
  6501           DFHEIV99,
  6502           DFHEIV99,
  6503           DFHEIV99
  6504     MOVE EIBRESP  TO WS-RESPONSE
  6505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6506     IF RESP-NORMAL
  6507        AND (EN-CONTROL-PRIMARY (1:34) =
  6508           OC-CONTROL-PRIMARY (1:34))
  6509        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6510     ELSE
  6511        MOVE +4096               TO WS-SEQ-NO
  6512     END-IF
  6513     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6514     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6515     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6516     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6517     INITIALIZE EN-ISSUE-RECORD
  6518     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6519                                    EN-AH-ORIG-EXP-DT
  6520                                    EN-LF-NEW-EXP-DT
  6521                                    EN-AH-NEW-EXP-DT
  6522                                    EN-PROCESS-DT
  6523     .
  6524 0410-EXIT.
  6525     EXIT.
  6526 0420-UPDATE-ELCRTO.
  6527     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6528     IF RESP-NORMAL
  6529        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6530                                    OC-LAST-MAINT-DT
  6531        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6532        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 115
* EL6318.cbl
  6533
  6534* EXEC CICS REWRITE
  6535*          FROM     (ORIGINAL-CERTIFICATE)
  6536*          DATASET  ('ELCRTO')
  6537*       END-EXEC
  6538     MOVE LENGTH OF
  6539      ORIGINAL-CERTIFICATE
  6540       TO DFHEIV11
  6541     MOVE 'ELCRTO' TO DFHEIV1
  6542*    MOVE '&& L                  %   #00006331' TO DFHEIV0
  6543     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6544     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6545     MOVE X'2020233030303036333331' TO DFHEIV0(25:11)
  6546     CALL 'kxdfhei1' USING DFHEIV0,
  6547           DFHEIV1,
  6548           ORIGINAL-CERTIFICATE,
  6549           DFHEIV11,
  6550           DFHEIV99
  6551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6552     END-IF
  6553     .
  6554 0420-EXIT.
  6555     EXIT.
  6556
  6557 0425-ADD-NEW-ELCRTO.
  6558     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6559     MOVE 'OC'                   TO OC-RECORD-ID
  6560     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6561     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6562     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6563     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6564     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6565     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6566     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6567     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6568     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6569     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6570     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6571     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6572     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6573     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6574     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6575     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6576     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6577     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6578     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6579     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6580     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  6581     MOVE +0                     TO OC-LF-CANCEL-AMT
  6582                                    OC-LF-ITD-CANCEL-AMT
  6583     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6584     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6585     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6586     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6587     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6588     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6589     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6590     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 116
* EL6318.cbl
  6591     MOVE +0                     TO OC-AH-CANCEL-AMT
  6592                                    OC-AH-ITD-CANCEL-AMT
  6593     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6594     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6595     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6596     .
  6597 0425-WRITE-ELCRTO.
  6598
  6599
  6600* EXEC CICS WRITE
  6601*       DATASET   ('ELCRTO')
  6602*       FROM      (ORIGINAL-CERTIFICATE)
  6603*       RIDFLD    (OC-CONTROL-PRIMARY)
  6604*       RESP      (WS-RESPONSE)
  6605*    END-EXEC
  6606     MOVE LENGTH OF
  6607      ORIGINAL-CERTIFICATE
  6608       TO DFHEIV11
  6609     MOVE 'ELCRTO' TO DFHEIV1
  6610*    MOVE '&$ L                  ''  N#00006382' TO DFHEIV0
  6611     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6613     MOVE X'204E233030303036333832' TO DFHEIV0(25:11)
  6614     CALL 'kxdfhei1' USING DFHEIV0,
  6615           DFHEIV1,
  6616           ORIGINAL-CERTIFICATE,
  6617           DFHEIV11,
  6618           OC-CONTROL-PRIMARY,
  6619           DFHEIV99,
  6620           DFHEIV99
  6621     MOVE EIBRESP  TO WS-RESPONSE
  6622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6623
  6624     display ' just wrote new crto ' ws-response
  6625     IF RESP-DUPKEY
  6626        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6627        GO TO 0425-WRITE-ELCRTO
  6628     ELSE
  6629        IF NOT RESP-NORMAL
  6630           MOVE -1               TO SIGREQL
  6631           MOVE ER-3830          TO EMI-ERROR
  6632           PERFORM 9900-ERROR-FORMAT
  6633                                 THRU 9900-EXIT
  6634        ELSE
  6635           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6636        END-IF
  6637     END-IF
  6638
  6639     .
  6640 0425-EXIT.
  6641     EXIT.
  6642
  6643 0426-ADD-CERT-NOTES.
  6644
  6645     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6646     SET TB-INDX TO 1
  6647
  6648     IF PI-CERTNT1-ENTERED > SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 117
* EL6318.cbl
  6649         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6650         MOVE PI-PROCESSOR-ID    TO
  6651                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6652         MOVE EIBTIME            TO
  6653                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6654         MOVE WS-CURRENT-BIN-DT  TO
  6655                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6656         SET TB-INDX UP BY +1
  6657     END-IF
  6658
  6659     IF PI-CERTNT2-ENTERED > SPACES
  6660         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6661         MOVE PI-PROCESSOR-ID    TO
  6662                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6663         MOVE EIBTIME            TO
  6664                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6665         MOVE WS-CURRENT-BIN-DT  TO
  6666                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6667         SET TB-INDX UP BY +1
  6668     END-IF
  6669
  6670     IF PI-CERTNT3-ENTERED > SPACES
  6671         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6672         MOVE PI-PROCESSOR-ID    TO
  6673                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6674         MOVE EIBTIME            TO
  6675                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6676         MOVE WS-CURRENT-BIN-DT  TO
  6677                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6678         SET TB-INDX UP BY +1
  6679     END-IF
  6680
  6681     IF PI-CERTNT4-ENTERED > SPACES
  6682         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6683         MOVE PI-PROCESSOR-ID    TO
  6684                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6685         MOVE EIBTIME            TO
  6686                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6687         MOVE WS-CURRENT-BIN-DT  TO
  6688                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6689         SET TB-INDX UP BY +1
  6690     END-IF
  6691
  6692     IF PI-CERTNT5-ENTERED > SPACES
  6693         MOVE PI-CERTNT5-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6694         MOVE PI-PROCESSOR-ID    TO
  6695                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6696         MOVE EIBTIME            TO
  6697                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6698         MOVE WS-CURRENT-BIN-DT  TO
  6699                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6700         SET TB-INDX UP BY +1
  6701     END-IF
  6702
  6703     IF PI-CERTNT6-ENTERED > SPACES
  6704         MOVE PI-CERTNT6-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6705         MOVE PI-PROCESSOR-ID    TO
  6706                      CERT-NT-LAST-MAINT-BY (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 118
* EL6318.cbl
  6707         MOVE EIBTIME            TO
  6708                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6709         MOVE WS-CURRENT-BIN-DT  TO
  6710                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6711         SET TB-INDX UP BY +1
  6712     END-IF
  6713
  6714     IF CERT-NOTE-ENTRIES > SPACES
  6715         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6716         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6717     END-IF
  6718
  6719     .
  6720 0426-EXIT.
  6721     EXIT.
  6722
  6723 0427-LOAD-CURRENT-CERT-NOTES.
  6724
  6725     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6726     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6727     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6728     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6729     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6730     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6731     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6732     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6733     MOVE '1'                 TO ERCNOT-REC-TYP
  6734     MOVE +0                  TO ERCNOT-SEQ
  6735     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6736
  6737
  6738* EXEC CICS STARTBR
  6739*         DATASET(WS-ERCNOT-FILE-ID)
  6740*         RIDFLD(ERCNOT-KEY)
  6741*         KEYLENGTH(ERCNOT-START-LENGTH)
  6742*         RESP      (WS-RESPONSE)
  6743*         GENERIC
  6744*         GTEQ
  6745*    END-EXEC.
  6746     MOVE 0
  6747       TO DFHEIV11
  6748*    MOVE '&,   KG    G          &  N#00006502' TO DFHEIV0
  6749     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6751     MOVE X'204E233030303036353032' TO DFHEIV0(25:11)
  6752     CALL 'kxdfhei1' USING DFHEIV0,
  6753           WS-ERCNOT-FILE-ID,
  6754           ERCNOT-KEY,
  6755           ERCNOT-START-LENGTH,
  6756           DFHEIV11,
  6757           DFHEIV99
  6758     MOVE EIBRESP  TO WS-RESPONSE
  6759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6760
  6761
  6762     IF NOT RESP-NORMAL
  6763        GO TO 0427-ENDBR
  6764     END-IF.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 119
* EL6318.cbl
  6765
  6766 0427-LOOP.
  6767
  6768* EXEC CICS READNEXT
  6769*         SET(ADDRESS OF CERT-NOTE-FILE)
  6770*         DATASET(WS-ERCNOT-FILE-ID)
  6771*         RIDFLD(ERCNOT-KEY)
  6772*    END-EXEC.
  6773     MOVE 0
  6774       TO DFHEIV11
  6775*    MOVE '&.S                   )   #00006516' TO DFHEIV0
  6776     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6777     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6778     MOVE X'2020233030303036353136' TO DFHEIV0(25:11)
  6779     CALL 'kxdfhei1' USING DFHEIV0,
  6780           WS-ERCNOT-FILE-ID,
  6781           DFHEIV20,
  6782           DFHEIV99,
  6783           ERCNOT-KEY,
  6784           DFHEIV99,
  6785           DFHEIV11,
  6786           DFHEIV99,
  6787           DFHEIV99
  6788     SET ADDRESS OF CERT-NOTE-FILE TO
  6789         DFHEIV20
  6790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6791
  6792
  6793     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6794         GO TO 0427-ENDBR
  6795     END-IF.
  6796
  6797     IF (CZ-CARRIER = SV-CARRIER)
  6798        AND (CZ-GROUPING = SV-GROUPING)
  6799        AND (CZ-STATE = SV-STATE)
  6800        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6801        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6802        AND (CZ-CERT-NO = SV-CERT-NO)
  6803        AND (CZ-RECORD-TYPE = '1')
  6804          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6805          MOVE CZ-LAST-MAINT-USER TO
  6806                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6807          MOVE CZ-LAST-MAINT-DT TO
  6808                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6809          MOVE CZ-LAST-MAINT-HHMMSS TO
  6810                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6811          SET TB-INDX UP BY 1
  6812          GO TO 0427-LOOP
  6813     END-IF.
  6814
  6815 0427-ENDBR.
  6816
  6817
  6818* EXEC CICS ENDBR
  6819*         DATASET(WS-ERCNOT-FILE-ID)
  6820*    END-EXEC.
  6821     MOVE 0
  6822       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 120
* EL6318.cbl
  6823*    MOVE '&2                    $   #00006546' TO DFHEIV0
  6824     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6825     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6826     MOVE X'2020233030303036353436' TO DFHEIV0(25:11)
  6827     CALL 'kxdfhei1' USING DFHEIV0,
  6828           WS-ERCNOT-FILE-ID,
  6829           DFHEIV11,
  6830           DFHEIV99
  6831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6832
  6833
  6834     .
  6835 0427-EXIT.
  6836     EXIT.
  6837
  6838 0430-WRITE-ERENDT.
  6839     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6840     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6841     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6842
  6843* EXEC CICS WRITE
  6844*         DATASET   (WS-ERENDT-FILE-ID)
  6845*         FROM      (ENDORSEMENT-RECORD)
  6846*         RIDFLD    (EN-CONTROL-PRIMARY)
  6847*         RESP      (WS-RESPONSE)
  6848*    END-EXEC
  6849     MOVE LENGTH OF
  6850      ENDORSEMENT-RECORD
  6851       TO DFHEIV11
  6852*    MOVE '&$ L                  ''  N#00006558' TO DFHEIV0
  6853     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6854     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6855     MOVE X'204E233030303036353538' TO DFHEIV0(25:11)
  6856     CALL 'kxdfhei1' USING DFHEIV0,
  6857           WS-ERENDT-FILE-ID,
  6858           ENDORSEMENT-RECORD,
  6859           DFHEIV11,
  6860           EN-CONTROL-PRIMARY,
  6861           DFHEIV99,
  6862           DFHEIV99
  6863     MOVE EIBRESP  TO WS-RESPONSE
  6864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6865     IF RESP-NORMAL
  6866        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  6867        display ' good write erendt '
  6868        IF EIBAID = DFHPF2
  6869           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6870           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6871           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6872           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6873        END-IF
  6874     ELSE
  6875        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6876        MOVE -1                  TO SIGREQL
  6877        MOVE ER-0132             TO EMI-ERROR
  6878        MOVE AL-UABON            TO SIGREQA
  6879        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6880     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 121
* EL6318.cbl
  6881     .
  6882 0430-EXIT.
  6883     EXIT.
  6884
  6885 0440-ADD-BILLING-NOTE.
  6886     DISPLAY 'ADD BILLING NOTE'
  6887
  6888* EXEC CICS GETMAIN
  6889*         SET      (ADDRESS OF EOB-CODES)
  6890*         LENGTH   (ELEOBC-LENGTH)
  6891*         INITIMG  (GETMAIN-SPACE)
  6892*    END-EXEC
  6893*    MOVE ',"IL                  $   #00006586' TO DFHEIV0
  6894     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6895     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6896     MOVE X'2020233030303036353836' TO DFHEIV0(25:11)
  6897     CALL 'kxdfhei1' USING DFHEIV0,
  6898           DFHEIV20,
  6899           ELEOBC-LENGTH,
  6900           GETMAIN-SPACE
  6901     SET ADDRESS OF EOB-CODES TO
  6902         DFHEIV20
  6903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6904
  6905     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6906     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6907     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6908
  6909
  6910* EXEC CICS STARTBR
  6911*        DATASET   ('ELEOBC')
  6912*        RIDFLD    (WS-ELEOBC-KEY)
  6913*        GTEQ
  6914*        RESP      (WS-RESPONSE)
  6915*    END-EXEC
  6916     MOVE 'ELEOBC' TO DFHEIV1
  6917     MOVE 0
  6918       TO DFHEIV11
  6919*    MOVE '&,         G          &  N#00006596' TO DFHEIV0
  6920     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6921     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6922     MOVE X'204E233030303036353936' TO DFHEIV0(25:11)
  6923     CALL 'kxdfhei1' USING DFHEIV0,
  6924           DFHEIV1,
  6925           WS-ELEOBC-KEY,
  6926           DFHEIV99,
  6927           DFHEIV11,
  6928           DFHEIV99
  6929     MOVE EIBRESP  TO WS-RESPONSE
  6930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6931
  6932     IF NOT RESP-NORMAL
  6933        GO TO 0440-EXIT
  6934     END-IF
  6935      .
  6936 0440-READNEXT-ELEOBC.
  6937
  6938
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 122
* EL6318.cbl
  6939* EXEC CICS READNEXT
  6940*       INTO    (EOB-CODES)
  6941*       DATASET ('ELEOBC')
  6942*       RIDFLD  (WS-ELEOBC-KEY)
  6943*       RESP    (WS-RESPONSE)
  6944*    END-EXEC
  6945     MOVE LENGTH OF
  6946      EOB-CODES
  6947       TO DFHEIV12
  6948     MOVE 'ELEOBC' TO DFHEIV1
  6949     MOVE 0
  6950       TO DFHEIV11
  6951*    MOVE '&.IL                  )  N#00006609' TO DFHEIV0
  6952     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6953     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6954     MOVE X'204E233030303036363039' TO DFHEIV0(25:11)
  6955     CALL 'kxdfhei1' USING DFHEIV0,
  6956           DFHEIV1,
  6957           EOB-CODES,
  6958           DFHEIV12,
  6959           WS-ELEOBC-KEY,
  6960           DFHEIV99,
  6961           DFHEIV11,
  6962           DFHEIV99,
  6963           DFHEIV99
  6964     MOVE EIBRESP  TO WS-RESPONSE
  6965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6966
  6967     IF RESP-NORMAL
  6968         IF EO-RECORD-TYPE NOT = '5'
  6969             GO TO 0440-EXIT
  6970         END-IF
  6971     ELSE
  6972         GO TO 0440-EXIT
  6973     END-IF
  6974
  6975     IF EO-RECORD-TYPE = '5' AND
  6976        EO-EOB-CODE = PI-LTRID-ENTERED
  6977           CONTINUE
  6978     ELSE
  6979         GO TO 0440-READNEXT-ELEOBC
  6980     END-IF
  6981
  6982     DISPLAY 'FOUND BILL NOTE ' EOB-CODES
  6983     MOVE SPACES TO WS-BILLING-NOTE
  6984     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6985     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6986     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6987     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6988
  6989
  6990* EXEC CICS GETMAIN
  6991*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6992*         LENGTH   (ERNOTE-LENGTH)
  6993*         INITIMG  (GETMAIN-SPACE)
  6994*    END-EXEC
  6995*    MOVE ',"IL                  $   #00006638' TO DFHEIV0
  6996     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 123
* EL6318.cbl
  6997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6998     MOVE X'2020233030303036363338' TO DFHEIV0(25:11)
  6999     CALL 'kxdfhei1' USING DFHEIV0,
  7000           DFHEIV20,
  7001           ERNOTE-LENGTH,
  7002           GETMAIN-SPACE
  7003     SET ADDRESS OF CERTIFICATE-NOTE TO
  7004         DFHEIV20
  7005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7006
  7007     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7008
  7009
  7010* EXEC CICS READ
  7011*       DATASET    (WS-ERNOTE-FILE-ID)
  7012*       RIDFLD     (WS-ERNOTE-KEY)
  7013*       INTO       (CERTIFICATE-NOTE)
  7014*       RESP       (WS-RESPONSE)
  7015*       UPDATE
  7016*    END-EXEC
  7017     MOVE LENGTH OF
  7018      CERTIFICATE-NOTE
  7019       TO DFHEIV11
  7020*    MOVE '&"IL       EU         (  N#00006646' TO DFHEIV0
  7021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7022     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7023     MOVE X'204E233030303036363436' TO DFHEIV0(25:11)
  7024     CALL 'kxdfhei1' USING DFHEIV0,
  7025           WS-ERNOTE-FILE-ID,
  7026           CERTIFICATE-NOTE,
  7027           DFHEIV11,
  7028           WS-ERNOTE-KEY,
  7029           DFHEIV99,
  7030           DFHEIV99,
  7031           DFHEIV99
  7032     MOVE EIBRESP  TO WS-RESPONSE
  7033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7034
  7035     IF RESP-NORMAL
  7036       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7037          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7038       END-IF
  7039       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7040          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7041       END-IF
  7042       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7043           (NOTE-SUB > +10) OR
  7044           (CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE)
  7045       END-PERFORM
  7046       IF CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE
  7047
  7048* EXEC CICS UNLOCK
  7049*           DATASET    (WS-ERNOTE-FILE-ID)
  7050*        END-EXEC
  7051*    MOVE '&*                    #   #00006666' TO DFHEIV0
  7052     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7053     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7054     MOVE X'2020233030303036363636' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 124
* EL6318.cbl
  7055     CALL 'kxdfhei1' USING DFHEIV0,
  7056           WS-ERNOTE-FILE-ID,
  7057           DFHEIV99
  7058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7059       ELSE
  7060         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7061           (NOTE-SUB > +10) OR
  7062           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7063         END-PERFORM
  7064         IF (NOTE-SUB < +11)
  7065           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7066              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7067                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7068           ELSE
  7069             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7070              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7071                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7072                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7073             ELSE
  7074               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7075                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7076                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7077                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7078               ELSE
  7079                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7080                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7081                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7082                                       CN-BILLING-START-LINE-NO
  7083                 ELSE
  7084                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7085                 END-IF
  7086               END-IF
  7087             END-IF
  7088           END-IF
  7089           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7090           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7091           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7092
  7093* EXEC CICS REWRITE
  7094*             DATASET    (WS-ERNOTE-FILE-ID)
  7095*             FROM       (CERTIFICATE-NOTE)
  7096*             RESP       (WS-RESPONSE)
  7097*          END-EXEC
  7098     MOVE LENGTH OF
  7099      CERTIFICATE-NOTE
  7100       TO DFHEIV11
  7101*    MOVE '&& L                  %  N#00006702' TO DFHEIV0
  7102     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7103     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7104     MOVE X'204E233030303036373032' TO DFHEIV0(25:11)
  7105     CALL 'kxdfhei1' USING DFHEIV0,
  7106           WS-ERNOTE-FILE-ID,
  7107           CERTIFICATE-NOTE,
  7108           DFHEIV11,
  7109           DFHEIV99
  7110     MOVE EIBRESP  TO WS-RESPONSE
  7111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7112           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 125
* EL6318.cbl
  7113         END-IF
  7114       END-IF
  7115     ELSE
  7116        MOVE SPACES              TO CERTIFICATE-NOTE
  7117        MOVE 'CN'                TO CN-RECORD-ID
  7118        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7119                                     WS-ERNOTE-KEY
  7120        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7121                                    CN-BILLING-END-LINE-NO
  7122        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7123        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7124        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7125        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7126
  7127* EXEC CICS WRITE
  7128*          DATASET    (WS-ERNOTE-FILE-ID)
  7129*          FROM       (CERTIFICATE-NOTE)
  7130*          RIDFLD     (WS-ERNOTE-KEY)
  7131*          RESP       (WS-RESPONSE)
  7132*       END-EXEC
  7133     MOVE LENGTH OF
  7134      CERTIFICATE-NOTE
  7135       TO DFHEIV11
  7136*    MOVE '&$ L                  ''  N#00006721' TO DFHEIV0
  7137     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7138     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7139     MOVE X'204E233030303036373231' TO DFHEIV0(25:11)
  7140     CALL 'kxdfhei1' USING DFHEIV0,
  7141           WS-ERNOTE-FILE-ID,
  7142           CERTIFICATE-NOTE,
  7143           DFHEIV11,
  7144           WS-ERNOTE-KEY,
  7145           DFHEIV99,
  7146           DFHEIV99
  7147     MOVE EIBRESP  TO WS-RESPONSE
  7148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7149
  7150        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7151     END-IF
  7152
  7153     .
  7154 0440-EXIT.
  7155     EXIT.
  7156
  7157
  7158 0442-SQUEEZE-IT-IN.
  7159
  7160     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7161        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7162           NOTE-SUB = +10
  7163           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7164           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7165             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7166             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7167             MOVE +9 TO NOTE-SUB
  7168           END-IF
  7169        END-PERFORM
  7170     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 126
* EL6318.cbl
  7171        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7172           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7173             UNTIL NOTE-SUB = +1
  7174             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7175             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7176                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7177                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7178                MOVE +2          TO NOTE-SUB
  7179             END-IF
  7180           END-PERFORM
  7181        END-IF
  7182     END-IF
  7183
  7184     .
  7185 0442-EXIT.
  7186     EXIT.
  7187
  7188 0445-CERTIFICATE-UPDATE.
  7189    display 'billing note written, updating cert'
  7190     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7191     IF RESP-NORMAL
  7192        EVALUATE CM-NOTE-SW
  7193           WHEN '2'
  7194           WHEN '3'
  7195           WHEN '6'
  7196           WHEN '7'
  7197              SET NO-CERT-RW     TO TRUE
  7198           WHEN ' '
  7199              MOVE '2'           TO CM-NOTE-SW
  7200           WHEN '1'
  7201              MOVE '3'           TO CM-NOTE-SW
  7202           WHEN '4'
  7203              MOVE '6'           TO CM-NOTE-SW
  7204           WHEN '5'
  7205              MOVE '7'           TO CM-NOTE-SW
  7206        END-EVALUATE
  7207     END-IF
  7208     IF NOT NO-CERT-RW
  7209        PERFORM 1810-REWRITE-ELCERT
  7210                                 THRU 1810-EXIT
  7211     ELSE
  7212
  7213* EXEC CICS UNLOCK
  7214*          DATASET    (WS-ELCERT-FILE-ID)
  7215*       END-EXEC
  7216*    MOVE '&*                    #   #00006790' TO DFHEIV0
  7217     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7218     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7219     MOVE X'2020233030303036373930' TO DFHEIV0(25:11)
  7220     CALL 'kxdfhei1' USING DFHEIV0,
  7221           WS-ELCERT-FILE-ID,
  7222           DFHEIV99
  7223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7224     END-IF
  7225
  7226     .
  7227 0445-EXIT.
  7228     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 127
* EL6318.cbl
  7229
  7230 0450-GET-ERACCT.
  7231     MOVE ' '                    TO WS-ERACCT-SW
  7232     MOVE ZEROS                  TO WS-CHGBACK
  7233                                    WS-CSO-PORTION
  7234                                    WS-ACCT-PORTION
  7235                                    WS-DIFF
  7236     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7237     IF RESP-NORMAL
  7238        PERFORM 0470-READNEXT-ERACCT
  7239                                 THRU 0470-EXIT
  7240     END-IF
  7241     IF RESP-NORMAL
  7242        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7243           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7244              AND >= AM-EFFECTIVE-DT
  7245              SET ACCT-FOUND TO TRUE
  7246           ELSE
  7247              PERFORM 0470-READNEXT-ERACCT
  7248                                 THRU 0470-EXIT
  7249              IF RESP-NORMAL
  7250                 IF AM-CONTROL-PRIMARY (1:20)
  7251                    = EN-CONTROL-PRIMARY (1:20)
  7252                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7253                       AND >= AM-EFFECTIVE-DT
  7254                       SET ACCT-FOUND TO TRUE
  7255                    END-IF
  7256                 END-IF
  7257              END-IF
  7258           END-IF
  7259        END-IF
  7260     END-IF
  7261     IF ACCT-FOUND
  7262        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7263           (AM-COM-TYP (S1) = 'C' OR 'D')
  7264           OR (S1 > +10)
  7265        END-PERFORM
  7266        IF S1 < +11
  7267           MOVE AM-COMM-CHARGEBACK (S1)
  7268                                 TO WS-CHGBACK
  7269        END-IF
  7270     END-IF
  7271    .
  7272 0450-EXIT.
  7273     EXIT.
  7274 0460-STARTBR-ERACCT.
  7275     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7276     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7277     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7278
  7279* EXEC CICS STARTBR
  7280*        DATASET   ('ERACCT')
  7281*        RIDFLD    (WS-ERACCT-KEY)
  7282*        GTEQ
  7283*        RESP      (WS-RESPONSE)
  7284*    END-EXEC
  7285     MOVE 'ERACCT' TO DFHEIV1
  7286     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 128
* EL6318.cbl
  7287       TO DFHEIV11
  7288*    MOVE '&,         G          &  N#00006847' TO DFHEIV0
  7289     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7290     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7291     MOVE X'204E233030303036383437' TO DFHEIV0(25:11)
  7292     CALL 'kxdfhei1' USING DFHEIV0,
  7293           DFHEIV1,
  7294           WS-ERACCT-KEY,
  7295           DFHEIV99,
  7296           DFHEIV11,
  7297           DFHEIV99
  7298     MOVE EIBRESP  TO WS-RESPONSE
  7299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7300     .
  7301 0460-EXIT.
  7302     EXIT.
  7303 0470-READNEXT-ERACCT.
  7304
  7305* EXEC CICS READNEXT
  7306*       INTO    (ACCOUNT-MASTER)
  7307*       DATASET ('ERACCT')
  7308*       RIDFLD  (WS-ERACCT-KEY)
  7309*       RESP    (WS-RESPONSE)
  7310*    END-EXEC
  7311     MOVE LENGTH OF
  7312      ACCOUNT-MASTER
  7313       TO DFHEIV12
  7314     MOVE 'ERACCT' TO DFHEIV1
  7315     MOVE 0
  7316       TO DFHEIV11
  7317*    MOVE '&.IL                  )  N#00006857' TO DFHEIV0
  7318     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7319     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7320     MOVE X'204E233030303036383537' TO DFHEIV0(25:11)
  7321     CALL 'kxdfhei1' USING DFHEIV0,
  7322           DFHEIV1,
  7323           ACCOUNT-MASTER,
  7324           DFHEIV12,
  7325           WS-ERACCT-KEY,
  7326           DFHEIV99,
  7327           DFHEIV11,
  7328           DFHEIV99,
  7329           DFHEIV99
  7330     MOVE EIBRESP  TO WS-RESPONSE
  7331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7332     .
  7333 0470-EXIT.
  7334     EXIT.
  7335 0500-CREATE-TEMP-STORAGE.
  7336     display ' about to write pi ' program-interface-block
  7337
  7338* EXEC CICS WRITEQ TS
  7339*        QUEUE (QID)
  7340*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7341*        LENGTH(PI-COMM-LENGTH)
  7342*    END-EXEC
  7343*    MOVE '*"                    ''   #00006868' TO DFHEIV0
  7344     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 129
* EL6318.cbl
  7345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7346     MOVE X'2020233030303036383638' TO DFHEIV0(25:11)
  7347     CALL 'kxdfhei1' USING DFHEIV0,
  7348           QID,
  7349           PROGRAM-INTERFACE-BLOCK,
  7350           PI-COMM-LENGTH,
  7351           DFHEIV99,
  7352           DFHEIV99,
  7353           DFHEIV99
  7354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7355     display ' about to write map ' el631ki
  7356
  7357* EXEC CICS WRITEQ TS
  7358*        QUEUE (QID)
  7359*        FROM  (EL631KI)
  7360*        LENGTH(MAP-LENGTH)
  7361*    END-EXEC.
  7362*    MOVE '*"                    ''   #00006874' TO DFHEIV0
  7363     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7364     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7365     MOVE X'2020233030303036383734' TO DFHEIV0(25:11)
  7366     CALL 'kxdfhei1' USING DFHEIV0,
  7367           QID,
  7368           EL631KI,
  7369           MAP-LENGTH,
  7370           DFHEIV99,
  7371           DFHEIV99,
  7372           DFHEIV99
  7373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7374
  7375 0500-EXIT.
  7376      EXIT.
  7377 0600-RECOVER-TEMP-STORAGE.
  7378     display ' about to recover pi '
  7379
  7380* EXEC CICS READQ TS
  7381*        QUEUE (QID)
  7382*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7383*        LENGTH(PI-COMM-LENGTH)
  7384*    END-EXEC
  7385*    MOVE '*$I    L              ''   #00006883' TO DFHEIV0
  7386     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7387     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7388     MOVE X'2020233030303036383833' TO DFHEIV0(25:11)
  7389     CALL 'kxdfhei1' USING DFHEIV0,
  7390           QID,
  7391           PROGRAM-INTERFACE-BLOCK,
  7392           PI-COMM-LENGTH,
  7393           DFHEIV99,
  7394           DFHEIV99,
  7395           DFHEIV99
  7396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7397     display ' pi ' pi-program-work-area
  7398     display ' about to recover map '
  7399
  7400* EXEC CICS READQ TS
  7401*        QUEUE (QID)
  7402*        INTO  (EL631KI)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 130
* EL6318.cbl
  7403*        LENGTH(MAP-LENGTH)
  7404*    END-EXEC
  7405*    MOVE '*$I    L              ''   #00006890' TO DFHEIV0
  7406     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7407     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7408     MOVE X'2020233030303036383930' TO DFHEIV0(25:11)
  7409     CALL 'kxdfhei1' USING DFHEIV0,
  7410           QID,
  7411           EL631KI,
  7412           MAP-LENGTH,
  7413           DFHEIV99,
  7414           DFHEIV99,
  7415           DFHEIV99
  7416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7417     display ' map ' el631ki
  7418     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7419     MOVE AL-UANON            TO SIGREQA
  7420     MOVE AL-UANON            TO LTRIDA
  7421     MOVE AL-UANON            TO VOUCHA
  7422     MOVE AL-UANON            TO HLTHAPPA
  7423     MOVE AL-UANON            TO PAYEEA
  7424     IF WS-SET-CODES-MDT = 'Y'
  7425        move +1                  to s2
  7426        perform varying s1 from +1 by +5 until s1 > +60
  7427           MOVE WS-PASSED-REASON-CODES (s1:4)
  7428                                 TO reacd-in (s2)
  7429           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7430               MOVE AL-SANON     TO REACDA (S2)
  7431               MOVE +4           TO REACDL (S2)
  7432           END-IF
  7433           add +1                to s2
  7434        end-perform
  7435        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7436     END-IF
  7437     IF CERTIDI > SPACES
  7438         MOVE AL-UANON       TO CERTIDA
  7439     END-IF
  7440
  7441     IF CRTNT1I > SPACES
  7442         MOVE AL-UANON       TO CRTNT1A
  7443     END-IF
  7444
  7445     IF CRTNT2I > SPACES
  7446         MOVE AL-UANON       TO CRTNT2A
  7447     END-IF
  7448
  7449     IF CRTNT3I > SPACES
  7450         MOVE AL-UANON       TO CRTNT3A
  7451     END-IF
  7452
  7453     IF CRTNT4I > SPACES
  7454         MOVE AL-UANON       TO CRTNT4A
  7455     END-IF
  7456
  7457     IF CRTNT5I > SPACES
  7458         MOVE AL-UANON       TO CRTNT5A
  7459     END-IF
  7460
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 131
* EL6318.cbl
  7461     IF CRTNT6I > SPACES
  7462         MOVE AL-UANON       TO CRTNT6A
  7463     END-IF
  7464     .
  7465 0600-EXIT.
  7466      EXIT.
  7467 0800-DELETE-TS.
  7468
  7469* EXEC CICS DELETEQ TS
  7470*        QUEUE(QID)
  7471*    END-EXEC
  7472*    MOVE '*&                    #   #00006946' TO DFHEIV0
  7473     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7474     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7475     MOVE X'2020233030303036393436' TO DFHEIV0(25:11)
  7476     CALL 'kxdfhei1' USING DFHEIV0,
  7477           QID,
  7478           DFHEIV99
  7479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7480     .
  7481 0800-EXIT.
  7482      EXIT.
  7483 1000-BUILD-ERARCH.
  7484     display ' made it to 1000 '
  7485     MOVE SPACES                 TO W-CNTL-KEY
  7486     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7487     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7488     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7489
  7490* EXEC CICS READ
  7491*         DATASET    (WS-ELCNTL-FILE-ID)
  7492*         SET        (ADDRESS OF CONTROL-FILE)
  7493*         RIDFLD     (W-CNTL-KEY)
  7494*         UPDATE
  7495*         RESP       (WS-RESPONSE)
  7496*    END-EXEC
  7497*    MOVE '&"S        EU         (  N#00006958' TO DFHEIV0
  7498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7500     MOVE X'204E233030303036393538' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0,
  7502           WS-ELCNTL-FILE-ID,
  7503           DFHEIV20,
  7504           DFHEIV99,
  7505           W-CNTL-KEY,
  7506           DFHEIV99,
  7507           DFHEIV99,
  7508           DFHEIV99
  7509     SET ADDRESS OF CONTROL-FILE TO
  7510         DFHEIV20
  7511     MOVE EIBRESP  TO WS-RESPONSE
  7512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7513     IF RESP-NORMAL
  7514        display ' good read elcntl '
  7515        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7516           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7517        END-IF
  7518        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 132
* EL6318.cbl
  7519        MOVE CF-CREDIT-LAST-ARCH-NUM
  7520                                 TO W-ARCH-NUMBER
  7521
  7522* EXEC CICS REWRITE
  7523*          FROM      (CONTROL-FILE)
  7524*          DATASET   (WS-ELCNTL-FILE-ID)
  7525*       END-EXEC
  7526     MOVE LENGTH OF
  7527      CONTROL-FILE
  7528       TO DFHEIV11
  7529*    MOVE '&& L                  %   #00006973' TO DFHEIV0
  7530     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7531     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7532     MOVE X'2020233030303036393733' TO DFHEIV0(25:11)
  7533     CALL 'kxdfhei1' USING DFHEIV0,
  7534           WS-ELCNTL-FILE-ID,
  7535           CONTROL-FILE,
  7536           DFHEIV11,
  7537           DFHEIV99
  7538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7539     END-IF
  7540
  7541* EXEC CICS GETMAIN
  7542*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7543*       LENGTH   (W-ARCH-LENGTH)
  7544*    END-EXEC
  7545*    MOVE '," L                  $   #00006978' TO DFHEIV0
  7546     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7547     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7548     MOVE X'2020233030303036393738' TO DFHEIV0(25:11)
  7549     CALL 'kxdfhei1' USING DFHEIV0,
  7550           DFHEIV20,
  7551           W-ARCH-LENGTH,
  7552           DFHEIV99
  7553     SET ADDRESS OF LETTER-ARCHIVE TO
  7554         DFHEIV20
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7556     MOVE 'LA'                   TO LETTER-ARCHIVE
  7557     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7558                                    LA-ARCHIVE-NO-A2
  7559                                    LA-ARCHIVE-NO-A3
  7560                                    LA-ARCHIVE-NO-A4
  7561                                    LA-ARCHIVE-NO-A5
  7562                                    LA-ARCHIVE-NO-A6
  7563     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7564                                    LA-COMPANY-CD-A2
  7565                                    LA-COMPANY-CD-A3
  7566                                    LA-COMPANY-CD-A4
  7567                                    LA-COMPANY-CD-A5
  7568                                    LA-COMPANY-CD-A6
  7569     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7570                                    LA-CARRIER-A3
  7571                                    LA-CARRIER-A4
  7572                                    LA-CARRIER-A5
  7573     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7574     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7575                                    LA-GROUPING-A3
  7576                                    LA-GROUPING-A4
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 133
* EL6318.cbl
  7577                                    LA-GROUPING-A5
  7578     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7579                                    LA-ACCOUNT-A3
  7580                                    LA-ACCOUNT-A4
  7581                                    LA-ACCOUNT-A5
  7582     MOVE PB-STATE               TO LA-STATE-A2
  7583                                    LA-STATE-A3
  7584                                    LA-STATE-A4
  7585                                    LA-STATE-A5
  7586     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7587     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7588     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7589     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7590     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7591                                    LA-INITIAL-PRINT-DATE
  7592                                    LA-SENT-DATE
  7593                                    LA-REPLY-DATE
  7594                                    LA-RESEND-DATE
  7595                                    LA-FOLLOW-UP-DATE
  7596     MOVE 'A'                    TO LA-STATUS
  7597     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7598     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7599     MOVE LTRIDI                 TO LA-FORM-A3
  7600     MOVE '4'                    TO LA-DATA-SOURCE
  7601     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7602     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7603                                    LA-NO-OF-TEXT-RECORDS
  7604
  7605* EXEC CICS WRITE
  7606*         DATASET   ('ERARCH')
  7607*         FROM      (LETTER-ARCHIVE)
  7608*         RIDFLD    (LA-CONTROL-PRIMARY)
  7609*         RESP      (WS-RESPONSE)
  7610*    END-EXEC
  7611     MOVE LENGTH OF
  7612      LETTER-ARCHIVE
  7613       TO DFHEIV11
  7614     MOVE 'ERARCH' TO DFHEIV1
  7615*    MOVE '&$ L                  ''  N#00007030' TO DFHEIV0
  7616     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7617     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7618     MOVE X'204E233030303037303330' TO DFHEIV0(25:11)
  7619     CALL 'kxdfhei1' USING DFHEIV0,
  7620           DFHEIV1,
  7621           LETTER-ARCHIVE,
  7622           DFHEIV11,
  7623           LA-CONTROL-PRIMARY,
  7624           DFHEIV99,
  7625           DFHEIV99
  7626     MOVE EIBRESP  TO WS-RESPONSE
  7627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7628     IF RESP-NORMAL
  7629        display ' good write erarch '
  7630        MOVE ER-0280             TO EMI-ERROR
  7631        MOVE -1                  TO SIGREQL
  7632        PERFORM 9900-ERROR-FORMAT
  7633                                 THRU 9900-EXIT
  7634        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 134
* EL6318.cbl
  7635        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7636     ELSE
  7637        MOVE ER-7345             TO EMI-ERROR
  7638        MOVE -1                  TO SIGREQL
  7639        PERFORM 9900-ERROR-FORMAT
  7640                                 THRU 9900-EXIT
  7641     END-IF
  7642     .
  7643 1000-EXIT.
  7644     EXIT.
  7645 1100-CALL-NS-BUS-LOGIC.
  7646     DISPLAY ' MADE IT TO 1100 '
  7647     MOVE SPACES                 TO BL-INPUT
  7648     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7649     MOVE '4'                    TO BL-DATA-SRCE
  7650     MOVE PB-CARRIER             TO BL-CARRIER
  7651     MOVE PB-GROUPING            TO BL-GROUP
  7652     MOVE PB-STATE               TO BL-STATE
  7653     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7654     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7655        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7656        MOVE ' '                 TO DC-OPTION-CODE
  7657        PERFORM 9700-date-link
  7658        IF NO-CONVERSION-ERROR
  7659           MOVE DC-GREG-DATE-B-EDIT
  7660                                 TO BL-EFF-DT
  7661        END-IF
  7662     END-IF
  7663     MOVE PB-CERT-NO             TO BL-CERT-NO
  7664     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7665     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7666     MOVE SPACES                 TO BL-RESP-NO
  7667     MOVE LTRIDI                 TO BL-LETTER-ID
  7668     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7669     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7670*    MOVE 'ALWA'                 TO BL-PROC-ID
  7671     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7672*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7673*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7674     IF EIBAID = DFHPF2
  7675        MOVE 'B'                 TO BL-WRITE-ERARCH
  7676     ELSE
  7677        MOVE 'T'                 TO BL-WRITE-ERARCH
  7678     END-IF
  7679     MOVE CERTIDI                TO BL-CERT-FORM-ID
  7680     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7681     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  7682     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7683        IF REACD-IN (S1) NOT = LOW-VALUES
  7684           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7685        END-IF
  7686     END-PERFORM
  7687    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7688*****************************************
  7689* Invoke the LETTER business logic
  7690*****************************************
  7691
  7692* exec cics link
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 135
* EL6318.cbl
  7693*       program('NSRASBL')
  7694*       commarea(srch-commarea)
  7695*    end-exec.
  7696     MOVE LENGTH OF
  7697      srch-commarea
  7698       TO DFHEIV11
  7699     MOVE 'NSRASBL' TO DFHEIV1
  7700*    MOVE '."C                   (   #00007099' TO DFHEIV0
  7701     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7703     MOVE X'2020233030303037303939' TO DFHEIV0(25:11)
  7704     CALL 'kxdfhei1' USING DFHEIV0,
  7705           DFHEIV1,
  7706           srch-commarea,
  7707           DFHEIV11,
  7708           DFHEIV99,
  7709           DFHEIV99,
  7710           DFHEIV99,
  7711           DFHEIV99
  7712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7713
  7714     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7715        BL-MESSAGE
  7716     .
  7717 1100-EXIT.
  7718     EXIT.
  7719 1500-GET-ARCH-NO.
  7720     display ' made it to 1500 '
  7721     MOVE SPACES                 TO ELCNTL-KEY
  7722     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7723     MOVE '1'                    TO CNTL-REC-TYPE
  7724     MOVE ZEROS                  TO CNTL-SEQ
  7725
  7726* EXEC CICS READ
  7727*         DATASET    (WS-ELCNTL-FILE-ID)
  7728*         SET        (ADDRESS OF CONTROL-FILE)
  7729*         RIDFLD     (ELCNTL-KEY)
  7730*         UPDATE
  7731*         RESP       (WS-RESPONSE)
  7732*    END-EXEC
  7733*    MOVE '&"S        EU         (  N#00007114' TO DFHEIV0
  7734     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7735     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7736     MOVE X'204E233030303037313134' TO DFHEIV0(25:11)
  7737     CALL 'kxdfhei1' USING DFHEIV0,
  7738           WS-ELCNTL-FILE-ID,
  7739           DFHEIV20,
  7740           DFHEIV99,
  7741           ELCNTL-KEY,
  7742           DFHEIV99,
  7743           DFHEIV99,
  7744           DFHEIV99
  7745     SET ADDRESS OF CONTROL-FILE TO
  7746         DFHEIV20
  7747     MOVE EIBRESP  TO WS-RESPONSE
  7748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7749     IF RESP-NORMAL
  7750        display ' good read elcntl '
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 136
* EL6318.cbl
  7751        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7752           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7753        END-IF
  7754        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7755        MOVE CF-CREDIT-LAST-ARCH-NUM
  7756                                 TO W-ARCH-NUMBER
  7757        display ' new arch number ' w-arch-number
  7758
  7759* EXEC CICS REWRITE
  7760*          FROM      (CONTROL-FILE)
  7761*          DATASET   (WS-ELCNTL-FILE-ID)
  7762*       END-EXEC
  7763     MOVE LENGTH OF
  7764      CONTROL-FILE
  7765       TO DFHEIV11
  7766*    MOVE '&& L                  %   #00007130' TO DFHEIV0
  7767     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7768     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7769     MOVE X'2020233030303037313330' TO DFHEIV0(25:11)
  7770     CALL 'kxdfhei1' USING DFHEIV0,
  7771           WS-ELCNTL-FILE-ID,
  7772           CONTROL-FILE,
  7773           DFHEIV11,
  7774           DFHEIV99
  7775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7776     END-IF
  7777     .
  7778 1500-EXIT.
  7779     EXIT.
  7780
  7781
  7782 1700-WRITE-CERT-NOTE      SECTION.
  7783
  7784     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7785     MOVE ZERO           TO ERCNOT-SEQ.
  7786     SET TB-INDX         DOWN BY 1.
  7787     SET TB-INDX1        TO TB-INDX.
  7788
  7789****DELETE CURRENT CERT NOTES
  7790 1700-LOOP.
  7791
  7792* EXEC CICS READ
  7793*        DATASET (WS-ERCNOT-FILE-ID)
  7794*        RIDFLD  (ERCNOT-KEY)
  7795*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7796*        RESP    (WS-RESPONSE)
  7797*        GTEQ
  7798*    END-EXEC.
  7799*    MOVE '&"S        G          (  N#00007149' TO DFHEIV0
  7800     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7802     MOVE X'204E233030303037313439' TO DFHEIV0(25:11)
  7803     CALL 'kxdfhei1' USING DFHEIV0,
  7804           WS-ERCNOT-FILE-ID,
  7805           DFHEIV20,
  7806           DFHEIV99,
  7807           ERCNOT-KEY,
  7808           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 137
* EL6318.cbl
  7809           DFHEIV99,
  7810           DFHEIV99
  7811     SET ADDRESS OF CERT-NOTE-FILE TO
  7812         DFHEIV20
  7813     MOVE EIBRESP  TO WS-RESPONSE
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816
  7817     IF NOT RESP-NORMAL
  7818        GO TO 1700-ENDDEL
  7819     END-IF
  7820
  7821     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7822
  7823     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7824         GO TO 1700-ENDDEL
  7825     END-IF.
  7826
  7827
  7828* EXEC CICS DELETE
  7829*        DATASET (WS-ERCNOT-FILE-ID)
  7830*        RIDFLD  (ERCNOT-KEY)
  7831*    END-EXEC.
  7832*    MOVE '&(  R                 &   #00007167' TO DFHEIV0
  7833     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7834     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7835     MOVE X'2020233030303037313637' TO DFHEIV0(25:11)
  7836     CALL 'kxdfhei1' USING DFHEIV0,
  7837           WS-ERCNOT-FILE-ID,
  7838           ERCNOT-KEY,
  7839           DFHEIV99,
  7840           DFHEIV99,
  7841           DFHEIV99
  7842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7843
  7844
  7845     GO TO 1700-LOOP.
  7846
  7847 1700-ENDDEL.
  7848
  7849
  7850* EXEC CICS GETMAIN
  7851*         LENGTH(ERCNOT-LENGTH)
  7852*         SET(ADDRESS OF CERT-NOTE-FILE)
  7853*         INITIMG(GETMAIN-SPACE)
  7854*    END-EXEC.
  7855*    MOVE ',"IL                  $   #00007176' TO DFHEIV0
  7856     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7858     MOVE X'2020233030303037313736' TO DFHEIV0(25:11)
  7859     CALL 'kxdfhei1' USING DFHEIV0,
  7860           DFHEIV20,
  7861           ERCNOT-LENGTH,
  7862           GETMAIN-SPACE
  7863     SET ADDRESS OF CERT-NOTE-FILE TO
  7864         DFHEIV20
  7865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7866
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 138
* EL6318.cbl
  7867
  7868     SET TB-INDX TO 1.
  7869     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7870     MOVE +0             TO ERCNOT-SEQ
  7871
  7872     PERFORM VARYING TB-INDX FROM 1 BY 1
  7873             UNTIL TB-INDX > TB-INDX1
  7874        MOVE SPACES                 TO  CERT-NOTE-FILE
  7875        ADD 1                       TO  ERCNOT-SEQ
  7876        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7877        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7878        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7879        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7880                                    TO  CZ-LAST-MAINT-USER
  7881        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7882                                    TO  CZ-LAST-MAINT-HHMMSS
  7883        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7884                                    TO  CZ-LAST-MAINT-DT
  7885
  7886
  7887* EXEC CICS WRITE
  7888*            DATASET(WS-ERCNOT-FILE-ID)
  7889*            FROM(CERT-NOTE-FILE)
  7890*            RIDFLD(ERCNOT-KEY)
  7891*       END-EXEC
  7892     MOVE LENGTH OF
  7893      CERT-NOTE-FILE
  7894       TO DFHEIV11
  7895*    MOVE '&$ L                  ''   #00007200' TO DFHEIV0
  7896     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7898     MOVE X'2020233030303037323030' TO DFHEIV0(25:11)
  7899     CALL 'kxdfhei1' USING DFHEIV0,
  7900           WS-ERCNOT-FILE-ID,
  7901           CERT-NOTE-FILE,
  7902           DFHEIV11,
  7903           ERCNOT-KEY,
  7904           DFHEIV99,
  7905           DFHEIV99
  7906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7907     END-PERFORM
  7908
  7909     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7910     IF RESP-NORMAL
  7911        EVALUATE CM-NOTE-SW
  7912           WHEN '1'
  7913           WHEN '3'
  7914           WHEN '5'
  7915           WHEN '7'
  7916              SET NO-CERT-RW     TO TRUE
  7917           WHEN ' '
  7918              MOVE '1'           TO CM-NOTE-SW
  7919           WHEN '2'
  7920              MOVE '3'           TO CM-NOTE-SW
  7921           WHEN '4'
  7922              MOVE '5'           TO CM-NOTE-SW
  7923           WHEN '6'
  7924              MOVE '7'           TO CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 139
* EL6318.cbl
  7925        END-EVALUATE
  7926     END-IF
  7927     IF NOT NO-CERT-RW
  7928        PERFORM 1810-REWRITE-ELCERT
  7929                                 THRU 1810-EXIT
  7930     ELSE
  7931
  7932* EXEC CICS UNLOCK
  7933*          DATASET    (WS-ELCERT-FILE-ID)
  7934*       END-EXEC
  7935*    MOVE '&*                    #   #00007229' TO DFHEIV0
  7936     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7937     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7938     MOVE X'2020233030303037323239' TO DFHEIV0(25:11)
  7939     CALL 'kxdfhei1' USING DFHEIV0,
  7940           WS-ELCERT-FILE-ID,
  7941           DFHEIV99
  7942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7943     END-IF
  7944
  7945     .
  7946 1799-EXIT.
  7947     EXIT.
  7948
  7949 1800-READ-ELCERT-UPDATE.
  7950
  7951     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7952     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7953     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7954     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7955     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7956     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7957     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7958     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7959
  7960
  7961* EXEC CICS READ
  7962*        UPDATE
  7963*        DATASET  (WS-ELCERT-FILE-ID)
  7964*        RIDFLD   (WS-ELCERT-KEY)
  7965*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7966*        RESP     (WS-RESPONSE)
  7967*    END-EXEC
  7968*    MOVE '&"S        EU         (  N#00007249' TO DFHEIV0
  7969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7970     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7971     MOVE X'204E233030303037323439' TO DFHEIV0(25:11)
  7972     CALL 'kxdfhei1' USING DFHEIV0,
  7973           WS-ELCERT-FILE-ID,
  7974           DFHEIV20,
  7975           DFHEIV99,
  7976           WS-ELCERT-KEY,
  7977           DFHEIV99,
  7978           DFHEIV99,
  7979           DFHEIV99
  7980     SET ADDRESS OF CERTIFICATE-MASTER TO
  7981         DFHEIV20
  7982     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 140
* EL6318.cbl
  7983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7984
  7985     .
  7986 1800-EXIT.
  7987     EXIT.
  7988
  7989 1810-REWRITE-ELCERT.
  7990
  7991
  7992* EXEC CICS REWRITE
  7993*        FROM     (CERTIFICATE-MASTER)
  7994*        DATASET  (WS-ELCERT-FILE-ID)
  7995*        RESP     (WS-RESPONSE)
  7996*    END-EXEC.
  7997     MOVE LENGTH OF
  7998      CERTIFICATE-MASTER
  7999       TO DFHEIV11
  8000*    MOVE '&& L                  %  N#00007263' TO DFHEIV0
  8001     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8002     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8003     MOVE X'204E233030303037323633' TO DFHEIV0(25:11)
  8004     CALL 'kxdfhei1' USING DFHEIV0,
  8005           WS-ELCERT-FILE-ID,
  8006           CERTIFICATE-MASTER,
  8007           DFHEIV11,
  8008           DFHEIV99
  8009     MOVE EIBRESP  TO WS-RESPONSE
  8010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8011
  8012
  8013     .
  8014 1810-EXIT.
  8015     EXIT.
  8016
  8017 8100-SEND-INITIAL-MAP.
  8018     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8019     MOVE '5'                    TO DC-OPTION-CODE.
  8020     PERFORM 9700-DATE-LINK.
  8021     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8022     MOVE EIBTIME                TO TIME-IN.
  8023     MOVE TIME-OUT               TO TIMEO.
  8024     MOVE -1                     TO SIGREQL
  8025     IF PI-PROCESSOR-IS-CSR-SUPER
  8026        perform varying s1 from +1 by +1 until
  8027           s1 > +12
  8028           MOVE AL-UANON            TO reacda (s1)
  8029        end-perform
  8030     END-IF
  8031     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8032     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8033
  8034* EXEC CICS SEND
  8035*        MAP      (MAP-NAME)
  8036*        MAPSET   (MAPSET-NAME)
  8037*        FROM     (EL631KO)
  8038*        ERASE
  8039*        CURSOR
  8040*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 141
* EL6318.cbl
  8041     MOVE LENGTH OF
  8042      EL631KO
  8043       TO DFHEIV12
  8044     MOVE -1
  8045       TO DFHEIV11
  8046*    MOVE '8$     CT  E    H L F ,   #00007289' TO DFHEIV0
  8047     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8048     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8049     MOVE X'2020233030303037323839' TO DFHEIV0(25:11)
  8050     CALL 'kxdfhei1' USING DFHEIV0,
  8051           MAP-NAME,
  8052           EL631KO,
  8053           DFHEIV12,
  8054           MAPSET-NAME,
  8055           DFHEIV99,
  8056           DFHEIV99,
  8057           DFHEIV99,
  8058           DFHEIV11,
  8059           DFHEIV99,
  8060           DFHEIV99,
  8061           DFHEIV99
  8062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8063
  8064     GO TO 9100-RETURN-TRAN.
  8065 8200-SEND-DATAONLY.
  8066     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8067     MOVE '5'                    TO DC-OPTION-CODE.
  8068     PERFORM 9700-DATE-LINK.
  8069     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8070     MOVE EIBTIME                TO TIME-IN.
  8071     MOVE TIME-OUT               TO TIMEO.
  8072     MOVE -1                     TO PFENTRL
  8073     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8074     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8075
  8076* EXEC CICS SEND
  8077*        MAP      (MAP-NAME)
  8078*        MAPSET   (MAPSET-NAME)
  8079*        FROM     (EL631KO)
  8080*        DATAONLY
  8081*        ERASEAUP
  8082*        CURSOR
  8083*    END-EXEC.
  8084     MOVE LENGTH OF
  8085      EL631KO
  8086       TO DFHEIV12
  8087     MOVE -1
  8088       TO DFHEIV11
  8089*    MOVE '8$D    CT  A    H L F ,   #00007307' TO DFHEIV0
  8090     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8091     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8092     MOVE X'2020233030303037333037' TO DFHEIV0(25:11)
  8093     CALL 'kxdfhei1' USING DFHEIV0,
  8094           MAP-NAME,
  8095           EL631KO,
  8096           DFHEIV12,
  8097           MAPSET-NAME,
  8098           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 142
* EL6318.cbl
  8099           DFHEIV99,
  8100           DFHEIV99,
  8101           DFHEIV11,
  8102           DFHEIV99,
  8103           DFHEIV99,
  8104           DFHEIV99
  8105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8106
  8107     GO TO 9100-RETURN-TRAN.
  8108 8300-SEND-TEXT.
  8109
  8110* EXEC CICS SEND TEXT
  8111*        FROM     (LOGOFF-TEXT)
  8112*        LENGTH   (LOGOFF-LENGTH)
  8113*        ERASE
  8114*        FREEKB
  8115*    END-EXEC.
  8116*    MOVE '8&      T  E F  H   F -   #00007317' TO DFHEIV0
  8117     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8118     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8119     MOVE X'2020233030303037333137' TO DFHEIV0(25:11)
  8120     CALL 'kxdfhei1' USING DFHEIV0,
  8121           LOGOFF-TEXT,
  8122           LOGOFF-LENGTH,
  8123           DFHEIV99,
  8124           DFHEIV99,
  8125           DFHEIV99,
  8126           DFHEIV99,
  8127           DFHEIV99,
  8128           DFHEIV99,
  8129           DFHEIV99,
  8130           DFHEIV99,
  8131           DFHEIV99,
  8132           DFHEIV99
  8133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8134
  8135
  8136* EXEC CICS RETURN
  8137*    END-EXEC.
  8138*    MOVE '.(                    ''   #00007323' TO DFHEIV0
  8139     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8140     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8141     MOVE X'2020233030303037333233' TO DFHEIV0(25:11)
  8142     CALL 'kxdfhei1' USING DFHEIV0,
  8143           DFHEIV99,
  8144           DFHEIV99,
  8145           DFHEIV99,
  8146           DFHEIV99,
  8147           DFHEIV99,
  8148           DFHEIV99
  8149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8150
  8151 8800-UNAUTHORIZED-ACCESS.
  8152     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8153     GO TO 8300-SEND-TEXT.
  8154 8810-PF23.
  8155     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8156     MOVE XCTL-005               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 143
* EL6318.cbl
  8157     GO TO 9300-XCTL.
  8158 9000-RETURN-CICS.
  8159
  8160* EXEC CICS RETURN
  8161*    END-EXEC.
  8162*    MOVE '.(                    ''   #00007333' TO DFHEIV0
  8163     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8164     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8165     MOVE X'2020233030303037333333' TO DFHEIV0(25:11)
  8166     CALL 'kxdfhei1' USING DFHEIV0,
  8167           DFHEIV99,
  8168           DFHEIV99,
  8169           DFHEIV99,
  8170           DFHEIV99,
  8171           DFHEIV99,
  8172           DFHEIV99
  8173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8174
  8175 9100-RETURN-TRAN.
  8176     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8177     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8178
  8179* EXEC CICS RETURN
  8180*        TRANSID    (TRANS-ID)
  8181*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8182*        LENGTH     (PI-COMM-LENGTH)
  8183*    END-EXEC.
  8184*    MOVE '.(CT                  ''   #00007338' TO DFHEIV0
  8185     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8186     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8187     MOVE X'2020233030303037333338' TO DFHEIV0(25:11)
  8188     CALL 'kxdfhei1' USING DFHEIV0,
  8189           TRANS-ID,
  8190           PROGRAM-INTERFACE-BLOCK,
  8191           PI-COMM-LENGTH,
  8192           DFHEIV99,
  8193           DFHEIV99,
  8194           DFHEIV99
  8195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8196
  8197 9200-RETURN-MAIN-MENU.
  8198     MOVE XCTL-626               TO PGM-NAME.
  8199     GO TO 9300-XCTL.
  8200 9300-XCTL.
  8201
  8202* EXEC CICS XCTL
  8203*        PROGRAM    (PGM-NAME)
  8204*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8205*        LENGTH     (PI-COMM-LENGTH)
  8206*    END-EXEC.
  8207*    MOVE '.$C                   %   #00007347' TO DFHEIV0
  8208     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8209     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8210     MOVE X'2020233030303037333437' TO DFHEIV0(25:11)
  8211     CALL 'kxdfhei1' USING DFHEIV0,
  8212           PGM-NAME,
  8213           PROGRAM-INTERFACE-BLOCK,
  8214           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 144
* EL6318.cbl
  8215           DFHEIV99
  8216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8217
  8218 9400-CLEAR.
  8219     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8220
  8221* EXEC CICS XCTL
  8222*        PROGRAM    (PGM-NAME)
  8223*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8224*        LENGTH     (PI-COMM-LENGTH)
  8225*    END-EXEC.
  8226*    MOVE '.$C                   %   #00007354' TO DFHEIV0
  8227     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8229     MOVE X'2020233030303037333534' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           PGM-NAME,
  8232           PROGRAM-INTERFACE-BLOCK,
  8233           PI-COMM-LENGTH,
  8234           DFHEIV99
  8235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8236
  8237 9500-PF12.
  8238     MOVE XCTL-010               TO PGM-NAME.
  8239     GO TO 9300-XCTL.
  8240 9600-PGMID-ERROR.
  8241
  8242* EXEC CICS HANDLE CONDITION
  8243*        PGMIDERR    (8300-SEND-TEXT)
  8244*    END-EXEC.
  8245*    MOVE '"$L                   ! " #00007363' TO DFHEIV0
  8246     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8248     MOVE X'2220233030303037333633' TO DFHEIV0(25:11)
  8249     CALL 'kxdfhei1' USING DFHEIV0
  8250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8251
  8252     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8253     MOVE ' '                    TO PI-ENTRY-CD-1.
  8254     MOVE XCTL-005               TO PGM-NAME.
  8255     MOVE PGM-NAME               TO LOGOFF-PGM.
  8256     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8257     GO TO 9300-XCTL.
  8258 9700-DATE-LINK.
  8259     MOVE LINK-ELDATCV           TO PGM-NAME.
  8260
  8261* EXEC CICS LINK
  8262*        PROGRAM    (PGM-NAME)
  8263*        COMMAREA   (DATE-CONVERSION-DATA)
  8264*        LENGTH     (DC-COMM-LENGTH)
  8265*    END-EXEC.
  8266*    MOVE '."C                   (   #00007374' TO DFHEIV0
  8267     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8269     MOVE X'2020233030303037333734' TO DFHEIV0(25:11)
  8270     CALL 'kxdfhei1' USING DFHEIV0,
  8271           PGM-NAME,
  8272           DATE-CONVERSION-DATA,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 145
* EL6318.cbl
  8273           DC-COMM-LENGTH,
  8274           DFHEIV99,
  8275           DFHEIV99,
  8276           DFHEIV99,
  8277           DFHEIV99
  8278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8279
  8280 9900-ERROR-FORMAT.
  8281     IF NOT EMI-ERRORS-COMPLETE
  8282        MOVE LINK-001            TO PGM-NAME
  8283
  8284* EXEC CICS LINK
  8285*           PROGRAM    (PGM-NAME)
  8286*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8287*           LENGTH     (EMI-COMM-LENGTH)
  8288*       END-EXEC
  8289*    MOVE '."C                   (   #00007382' TO DFHEIV0
  8290     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8292     MOVE X'2020233030303037333832' TO DFHEIV0(25:11)
  8293     CALL 'kxdfhei1' USING DFHEIV0,
  8294           PGM-NAME,
  8295           ERROR-MESSAGE-INTERFACE-BLOCK,
  8296           EMI-COMM-LENGTH,
  8297           DFHEIV99,
  8298           DFHEIV99,
  8299           DFHEIV99,
  8300           DFHEIV99
  8301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8302     END-IF
  8303     .
  8304 9900-EXIT.
  8305     EXIT.
  8306 9990-ABEND.
  8307     MOVE LINK-004               TO PGM-NAME.
  8308     MOVE DFHEIBLK               TO EMI-LINE1.
  8309
  8310* EXEC CICS LINK
  8311*        PROGRAM   (PGM-NAME)
  8312*        COMMAREA  (EMI-LINE1)
  8313*        LENGTH    (72)
  8314*    END-EXEC.
  8315     MOVE 72
  8316       TO DFHEIV11
  8317*    MOVE '."C                   (   #00007394' TO DFHEIV0
  8318     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8320     MOVE X'2020233030303037333934' TO DFHEIV0(25:11)
  8321     CALL 'kxdfhei1' USING DFHEIV0,
  8322           PGM-NAME,
  8323           EMI-LINE1,
  8324           DFHEIV11,
  8325           DFHEIV99,
  8326           DFHEIV99,
  8327           DFHEIV99,
  8328           DFHEIV99
  8329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8330
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 146
* EL6318.cbl
  8331     GO TO 8200-SEND-DATAONLY.
  8332
  8333* GOBACK.
  8334     MOVE '9%                    "   ' TO DFHEIV0
  8335     MOVE 'EL6318' TO DFHEIV1
  8336     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8337     GOBACK.
  8338 9995-SECURITY-VIOLATION.
  8339*                            COPY ELCSCTP.
  8340******************************************************************
  8341*                                                                *
  8342*                            ELCSCTP                             *
  8343*                            VMOD=2.001                          *
  8344*                                                                *
  8345*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8346******************************************************************
  8347
  8348
  8349     MOVE EIBDATE          TO SM-JUL-DATE.
  8350     MOVE EIBTRMID         TO SM-TERMID.
  8351     MOVE THIS-PGM         TO SM-PGM.
  8352     MOVE EIBTIME          TO TIME-IN.
  8353     MOVE TIME-OUT         TO SM-TIME.
  8354     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8355
  8356
  8357* EXEC CICS LINK
  8358*         PROGRAM  ('EL003')
  8359*         COMMAREA (SECURITY-MESSAGE)
  8360*         LENGTH   (80)
  8361*    END-EXEC.
  8362     MOVE 'EL003' TO DFHEIV1
  8363     MOVE 80
  8364       TO DFHEIV11
  8365*    MOVE '."C                   (   #00007419' TO DFHEIV0
  8366     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8367     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8368     MOVE X'2020233030303037343139' TO DFHEIV0(25:11)
  8369     CALL 'kxdfhei1' USING DFHEIV0,
  8370           DFHEIV1,
  8371           SECURITY-MESSAGE,
  8372           DFHEIV11,
  8373           DFHEIV99,
  8374           DFHEIV99,
  8375           DFHEIV99,
  8376           DFHEIV99
  8377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8378
  8379
  8380******************************************************************
  8381
  8382 9995-EXIT.
  8383     EXIT.
  8384
  8385 9999-DFHBACK SECTION.
  8386     MOVE '9%                    "   ' TO DFHEIV0
  8387     MOVE 'EL6318' TO DFHEIV1
  8388     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 147
* EL6318.cbl
  8389     GOBACK.
  8390 9999-DFHEXIT.
  8391     IF DFHEIGDJ EQUAL 0001
  8392         NEXT SENTENCE
  8393     ELSE IF DFHEIGDJ EQUAL 2
  8394         GO TO 8300-SEND-TEXT
  8395         DEPENDING ON DFHEIGDI.
  8396     MOVE '9%                    "   ' TO DFHEIV0
  8397     MOVE 'EL6318' TO DFHEIV1
  8398     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8399     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34732     Code:       19310
