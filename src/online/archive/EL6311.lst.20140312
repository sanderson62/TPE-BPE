* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   3
* EL6311.cbl
    72******************************************************************
    73
    74 ENVIRONMENT DIVISION.
    75
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   4
* EL6311.cbl
    77 DATA DIVISION.
    78 WORKING-STORAGE SECTION.
    79 01  DFH-START PIC X(04).
    80 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    81 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    82 77  FILLER  PIC X(32)  VALUE '********************************'.
    83 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    84 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    85 77  A1                          PIC S999 COMP-3 VALUE +0.
    86 77  N1                          PIC S999 COMP-3 VALUE +0.
    87 77  N2                          PIC S999 COMP-3 VALUE +0.
    88 77  N3                          PIC S999 COMP-3 VALUE +0.
    89 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    90 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    91 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    92     88  REVERSAL                    VALUE 'Y'.
    93 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    94 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    95 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    96 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    97 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    98     88  ERMAIL-FOUND                 VALUE 'Y'.
    99 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   100 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   101 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   102 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   103     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   104 77  ws-stop-sw                  pic x value ' '.
   105     88  i-say-stop                 value 'Y'.
   106 77  ws-check-sw                 pic x value ' '.
   107     88  i-have-checks              value 'Y'.
   108 77  ws-proc-check-sw            pic x value ' '.
   109     88  i-have-processed-checks    value 'Y'.
   110 77  ws-chek-browse-sw           pic x value ' '.
   111 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   112 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   113 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   114 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   115
   116*    COPY ELCSCTM.
   117******************************************************************
   118*                                                                *
   119*                                                                *
   120*                            ELCSCTM                             *
   121*                            VMOD=2.001                          *
   122*                                                                *
   123*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   124*                                                                *
   125******************************************************************
   126 01  SECURITY-MESSAGE.
   127     12  FILLER                          PIC X(30)
   128            VALUE '** LOGIC SECURITY VIOLATION -'.
   129     12  SM-READ                         PIC X(6).
   130     12  FILLER                          PIC X(5)
   131            VALUE ' PGM='.
   132     12  SM-PGM                          PIC X(6).
   133     12  FILLER                          PIC X(5)
   134            VALUE ' OPR='.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   5
* EL6311.cbl
   135     12  SM-PROCESSOR-ID                 PIC X(4).
   136     12  FILLER                          PIC X(6)
   137            VALUE ' TERM='.
   138     12  SM-TERMID                       PIC X(4).
   139     12  FILLER                          PIC XX   VALUE SPACE.
   140     12  SM-JUL-DATE                     PIC 9(5).
   141     12  FILLER                          PIC X    VALUE SPACE.
   142     12  SM-TIME                         PIC 99.99.
   143
   144
   145*    COPY ELCSCRTY.
   146******************************************************************
   147*                                                                *
   148*                                                                *
   149*                            ELCSCRTY                            *
   150*                            VMOD=2.001                          *
   151*                                                                *
   152*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   153*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   154*        SAVED IN PI-SECURITY-ADDRESS.                           *
   155*                                                                *
   156******************************************************************
   157 01  SECURITY-CONTROL.
   158     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   159     12  FILLER                       PIC XX    VALUE 'SC'.
   160     12  SC-CREDIT-CODES.
   161         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   162             20  SC-CREDIT-DISPLAY    PIC X.
   163             20  SC-CREDIT-UPDATE     PIC X.
   164     12  SC-CLAIMS-CODES.
   165         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   166             20  SC-CLAIMS-DISPLAY    PIC X.
   167             20  SC-CLAIMS-UPDATE     PIC X.
   168
   169 01  WS-VA-NO-COMM-MESS.
   170     12  FILLER                  PIC X(41) VALUE
   171        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   172 01  WS-OC-MESSAGE.
   173     12  FILLER                  PIC X(43) VALUE
   174        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   175     12  WS-OC-DIS-AMT           PIC -----9.99.
   176     12  FILLER                  PIC X(4) VALUE ' ON '.
   177     12  WS-OC-DATE              PIC X(10).
   178 01  WS-DATE-AREA.
   179     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   180     12  WS-CURRENT-DT.
   181         16  FILLER              PIC X(6)    VALUE SPACES.
   182         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   183     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   184     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   185     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   186
   187 01  STANDARD-AREAS.
   188     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   189     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   190     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   191     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   192     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   6
* EL6311.cbl
   193     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   194     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   195     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   196     12  PGM-NAME                PIC X(8).
   197     12  TIME-IN                 PIC S9(7).
   198     12  TIME-OUT-R  REDEFINES TIME-IN.
   199         16  FILLER              PIC X.
   200         16  TIME-OUT            PIC 99V99.
   201         16  FILLER              PIC XX.
   202     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   203     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   204     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   205     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   206     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   207     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   208     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   209     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   210     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   211     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   212     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   213     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   214     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   215     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   216     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   217     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   218     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   219     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   220     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   221     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   222     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   223     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   224     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   225     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   226     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   227     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   228     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   229     12  FILE-ID                 PIC X(8).
   230     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   231     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   232     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   233     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   234     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   235     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   236     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   237     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   238     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   239     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   240     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   241     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   242     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   243     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   244     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   245
   246 01  WS-PASS-AREA.
   247     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   248     05  WS-PASS-VADS-REC    PIC X(350).
   249*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   250*                                COPY ELCZREC.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   7
* EL6311.cbl
   251******************************************************************
   252*                                                                *
   253*                                                                *
   254*                            ELCZREC.                            *
   255*                                                                *
   256*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   257*                                                                *
   258******************************************************************
   259*-----------------------------------------------------------------
   260*                   C H A N G E   L O G
   261*
   262* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   263*-----------------------------------------------------------------
   264*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   265* EFFECTIVE    NUMBER
   266*-----------------------------------------------------------------
   267* 122011    2011022800001  AJRA  NEW FILE
   268* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   269* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   270* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   271* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   272*-----------------------------------------------------------------
   273 01  W-Z-CONTROL-DATA.
   274     05  W-NUMBER-OF-COPIES      PIC  9.
   275     05  FILLER                  PIC  X.
   276     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   277     05  FILLER                  PIC  X.
   278     05  W-DAYS-TO-RESEND        PIC  999.
   279     05  FILLER                  PIC  X.
   280     05  W-FORM-TO-RESEND        PIC  X(4).
   281     05  W-ADD-BAR-CODE          PIC  X.
   282     05  W-PROMPT-LETTER         PIC  X.
   283     05  W-HAS-RETURN-ENV        PIC  X.
   284     05  W-ENCLOSURE-CD          PIC  XXX.
   285     05  W-SIG-FLAG-DEFAULT      PIC  X.
   286     05  W-AUTO-CLOSE-IND        PIC  X.
   287     05  FILLER                  PIC  X.
   288     05  W-LETTER-TO-BENE        PIC  X.
   289     05  FILLER                  PIC  X.
   290     05  W-LETTER-TO-ACCT        PIC  X.
   291     05  FILLER                  PIC  X.
   292     05  W-LETTER-TYPE           PIC  X.
   293     05  FILLER                  PIC  X.
   294     05  W-PRINT-CERTIFICATE     PIC  X.
   295     05  FILLER                  PIC  X.
   296     05  W-REFUND-REQUIRED       PIC  X.
   297     05  FILLER                  PIC  X.
   298     05  W-ONBASE-CODE           PIC  XX.
   299     05  FILLER                  PIC  X.
   300     05  W-ACCT-SUMM             PIC  X.
   301     05  FILLER                  PIC  X.
   302     05  W-CSO-SUMM              PIC  X.
   303     05  FILLER                  PIC  X.
   304     05  W-REASONS-REQUIRED      PIC  X.
   305     05  FILLER                  PIC  X(29).
   306******************************************************************
   307*                                                                *
   308*              A C C E S S   K E Y S                             *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   8
* EL6311.cbl
   309*                                                                *
   310******************************************************************
   311
   312 01  ACCESS-KEYS.
   313     12  ERPYAJ-KEY.
   314         16  ERPYAJ-COMPANY-CD       PIC X.
   315         16  ERPYAJ-CARRIER          PIC X.
   316         16  ERPYAJ-GROUPING         PIC X(6).
   317         16  ERPYAJ-FIN-RESP         PIC X(10).
   318         16  ERPYAJ-ACCOUNT          PIC X(10).
   319         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   320         16  ERPYAJ-TYPE             PIC X.
   321     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   322     12  ELCERT-KEY.
   323         16  ELCERT-COMPANY-CD       PIC X.
   324         16  ELCERT-CARRIER          PIC X.
   325         16  ELCERT-GROUPING         PIC X(6).
   326         16  ELCERT-STATE            PIC XX.
   327         16  ELCERT-ACCOUNT          PIC X(10).
   328         16  ELCERT-CERT-EFF-DT      PIC XX.
   329         16  ELCERT-CERT-NO.
   330             20  ELCERT-CERT-PRIME   PIC X(10).
   331             20  ELCERT-CERT-SFX     PIC X.
   332
   333     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   334     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   335     12  ELCRTO-KEY.
   336         16  ELCRTO-COMPANY-CD       PIC X.
   337         16  ELCRTO-CARRIER          PIC X.
   338         16  ELCRTO-GROUPING         PIC X(6).
   339         16  ELCRTO-STATE            PIC XX.
   340         16  ELCRTO-ACCOUNT          PIC X(10).
   341         16  ELCRTO-CERT-EFF-DT      PIC XX.
   342         16  ELCRTO-CERT-NO.
   343             20  ELCRTO-CERT-PRIME   PIC X(10).
   344             20  ELCRTO-CERT-SFX     PIC X.
   345         16  ELCRTO-RECORD-TYPE      PIC X.
   346         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   347
   348     12  ELCRTT-KEY.
   349         16  ELCRTT-PRIMARY          PIC X(33).
   350         16  ELCRTT-REC-TYPE         PIC X(1).
   351     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   352     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   353
   354     12  ERPNDB-KEY.
   355         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   356         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   357         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   358         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   359             ERPNDB-BATCH-SEQ-NO     PIC XX.
   360         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   361
   362     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   363     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   364     12  ERCHEK-KEY.
   365         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   366         16  CHEK-CARRIER            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page   9
* EL6311.cbl
   367         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   368         16  CHEK-STATE              PIC XX      VALUE SPACES.
   369         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   370         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   371         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   372         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   373         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   374     12  ELLETR-KEY.
   375         16  LETR-COMPANY-CD     PIC X.
   376         16  LETR-LETTER-ID      PIC X(4).
   377         16  LETR-FILLER         PIC X(8).
   378         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   379     12  ERPNDM-KEY.
   380         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   381         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   382         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   383         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   384
   385*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   386     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   387*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   388     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   389
   390     12  ERPNDB-ALT-KEY.
   391         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   392         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   393         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   394         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   395         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   396         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   397         16  ERPNDB-CERT-NO.
   398             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   399             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   400         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   401         16  ERPNDB-RECORD-TYPE      PIC X.
   402
   403      12  ERPNDB-CSR-KEY.
   404          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   405          20  ERPNDB-CSR-ID                PIC X(4).
   406          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   407          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   408          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   409
   410     12  ERNOTE-KEY.
   411         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   412         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   413         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   414         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   415         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   416         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   417         16  ERNOTE-CERT-NO.
   418             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   419             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   420
   421     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   422     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   423
   424     12  ERCNOT-KEY.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  10
* EL6311.cbl
   425         16  ERCNOT-PART-KEY.
   426             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   427             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   428             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   429             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   430             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   431             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   432             20  ERCNOT-CERT-NO.
   433                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   434                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   435         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   436         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   437
   438     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   439     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   440
   441     12  ERMAIL-KEY.
   442         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   443         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   444         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   445         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   446         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   447         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   448         16  ERMAIL-CERT-NO.
   449             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   450             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   451
   452     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   453     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   454
   455     12  ERRQST-KEY.
   456         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   457         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   458
   459     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   460     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   461
   462     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   463
   464     12  ERLOFC-KEY.
   465         16  ERLOFC-COMPANY-CD          PIC  X.
   466         16  ERLOFC-CARRIER             PIC  X.
   467         16  ERLOFC-GROUPING            PIC  X(6).
   468         16  ERLOFC-STATE               PIC  XX.
   469         16  ERLOFC-ACCOUNT             PIC  X(10).
   470         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   471*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   472
   473     12  ERACCT-KEY.
   474         16  ERACCT-COMPANY-CD          PIC  X.
   475         16  ERACCT-CARRIER             PIC  X.
   476         16  ERACCT-GROUPING            PIC  X(6).
   477         16  ERACCT-STATE               PIC  XX.
   478         16  ERACCT-ACCOUNT             PIC  X(10).
   479         16  ERACCT-EXP-DT.
   480             20  ERACCT-DT              PIC  XX.
   481             20  ERACCT-FILL            PIC  X(4).
   482
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  11
* EL6311.cbl
   483     12  ERENDT-KEY.
   484         16  ENDT-COMPANY-CD       PIC X.
   485         16  ENDT-CARRIER          PIC X.
   486         16  ENDT-GROUPING         PIC X(6).
   487         16  ENDT-STATE            PIC XX.
   488         16  ENDT-ACCOUNT          PIC X(10).
   489         16  ENDT-CERT-EFF-DT      PIC XX.
   490         16  ENDT-CERT-PRIME       PIC X(10).
   491         16  ENDT-CERT-SFX         PIC X.
   492         16  ENDT-RECORD-TYPE      PIC X.
   493         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   494
   495 01  WS-ELMSTR-WORK.
   496     12  ELMSTR-KEY.
   497         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   498         16  MSTR-CERT-NO.
   499             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   500             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   501     12  W-CLAIM-KEY.
   502         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   503         16  W-CL-CERT-NO.
   504             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   505             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   506      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   507 01  CANCEL-GEN-PASS-AREA.
   508     05  CG-OPTION-CODE          PIC X.
   509         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   510         88  CG-FLAT-CANCEL        VALUE '1'.
   511         88  CG-CANCEL             VALUE '2'.
   512         88  CG-CANCEL-REISSUE     VALUE '3'.
   513     05  CG-ERROR-CODE           PIC 99.
   514         88  CG-SUCCESS            VALUE 00.
   515         88  CG-DATE-ERROR         VALUE 01.
   516         88  CG-CERT-NOT-FOUND     VALUE 02.
   517         88  CG-AMOUNT-ERROR       VALUE 04.
   518         88  CG-OPTION-ERROR       VALUE 05.
   519         88  CG-PREV-CAN           VALUE 06.
   520         88  CG-INVALID-DATA       VALUE 07.
   521         88  CG-NO-ACCT-MSTR       VALUE 08.
   522         88  CG-SFX-A-EXIST        VALUE 09.
   523         88  CG-MISC-ERROR         VALUE 99.
   524     05  CG-COMPANY-ID           PIC XXX.
   525     05  CG-PROC-ID              PIC XXXX.
   526     05  CG-CURRENT-DT           PIC XX.
   527     05  CG-MONTH-END-DT         PIC XX.
   528     05  CG-CERT-KEY.
   529         10  CG-CERT-COMPANY-CD  PIC X.
   530         10  CG-CERT-CARRIER     PIC X.
   531         10  CG-CERT-GROUP       PIC X(6).
   532         10  CG-CERT-STATE       PIC XX.
   533         10  CG-CERT-ACCOUNT     PIC X(10).
   534         10  CG-CERT-EFF-DT      PIC XX.
   535         10  CG-CERT-CERT-NO     PIC X(11).
   536     05  CG-LF-CAN-DATA.
   537         10  CG-LF-CAN-DT        PIC XX.
   538         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   539     05  CG-AH-CAN-DATA.
   540         10  CG-AH-CAN-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  12
* EL6311.cbl
   541         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   542     05  CG-CERT-PROFILE-DATA.
   543         10  CG-INS-LNAME        PIC X(15).
   544         10  CG-INS-FNAME        PIC X(10).
   545         10  CG-INS-MID-INIT     PIC X.
   546         10  CG-INS-AGE          PIC 99.
   547         10  CG-JNT-LNAME        PIC X(15).
   548         10  CG-JNT-FNAME        PIC X(10).
   549         10  CG-JNT-MID-INIT     PIC X.
   550         10  CG-JNT-AGE          PIC 99.
   551     05  CG-LF-ISS-DATA.
   552         10  CG-LF-BENCD         PIC XX.
   553         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   554         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   555     05  CG-AH-ISS-DATA.
   556         10  CG-AH-BENCD         PIC XX.
   557         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   558     05  CG-BATCH-NO             PIC X(6).
   559     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   560     05  FILLER                  PIC X(306).
   561******************************************************************
   562*                                                                *
   563*            G E N E R A L   W O R K   A R E A                   *
   564*                                                                *
   565******************************************************************
   566
   567 01  WORK-AREA.
   568     12  WS-RESPONSE             PIC S9(8)   COMP.
   569         88  RESP-NORMAL           VALUE +0.
   570         88  resp-file-notfnd      value +12.
   571         88  RESP-NOTFND           VALUE +13.
   572         88  resp-duprec           value +14.
   573         88  resp-dupkey           value +15.
   574         88  resp-invreq           value +16.
   575         88  RESP-NOTOPEN          VALUE +19.
   576         88  RESP-ENDFILE          VALUE +20.
   577         88  resp-lengtherr        value +22.
   578     12  DEEDIT-FIELD            PIC X(15).
   579     12  FILLER          REDEFINES DEEDIT-FIELD.
   580         16  FILLER              PIC X(4).
   581         16  DEEDIT-FIELD-X11    PIC X(11).
   582     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   583                                 PIC S9(15).
   584     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   585                                 PIC S9(13)V99.
   586     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   587                                 PIC S9(11)V9999.
   588     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   589     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   590     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   591         16  WS-CALC-TERM-WHOLE  PIC S999.
   592         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   593
   594     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   595     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   596         16  WS-HR-MINS          PIC 99V99.
   597         16  FILLER              PIC XX.
   598
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  13
* EL6311.cbl
   599     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   600     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   601
   602     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   603     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   604
   605     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   606     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   607     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   608     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   609     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   610     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   611     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   612
   613     12  QID.
   614         16  QID-TERM            PIC X(4).
   615         16  FILLER              PIC X(4)    VALUE '607B'.
   616
   617     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   618         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   619
   620     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   621         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   622
   623     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   624         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   625                                         'A'.
   626
   627     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   628
   629     12  WS-NUMERIC-SW           PIC X.
   630        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   631
   632     12  WS-EDIT-CSO-FIELD.
   633         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   634                                 PIC X.
   635
   636     12  WS-SAVE-INPUT-FIELDS.
   637         16  WS-BAGE             PIC 99       VALUE ZERO.
   638*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   639         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   640         16  FILLER REDEFINES WS-BAPR.
   641             20  WS-APR-WHOLE-NUM    PIC 99.
   642             20  WS-APR-DEC          PIC 9999.
   643         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   644         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   645
   646         16  WS-B-COVERAGE OCCURS 2 TIMES.
   647             20  WS-TERM-IN-DAYS-SW  PIC X.
   648                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   649             20  WS-BTERM        PIC 999       COMP-3.
   650             20  WS-BALT-TERM    PIC 999       COMP-3.
   651             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   652             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   653             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   654             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   655             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   656             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  14
* EL6311.cbl
   657
   658         16  WS-C-FIELDS COMP-3.
   659             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   660             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   661             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   662
   663         16  WS-D-FIELDS COMP-3.
   664             20  WS-DRISS        PIC S9(5)    VALUE +0.
   665             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   666             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   667             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   668             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   669             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   670
   671     12  WS-SAVE-BIRTH-DATE.
   672         16  FILLER              PIC X(4)   VALUE SPACES.
   673         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   674
   675     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   676     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   677     12  FILLER REDEFINES WS-WORK-BIN-RED.
   678         16  FILLER              PIC X(02).
   679         16  WS-WORK-BIN-DT      PIC X(02).
   680     12  WS-SW-1                 PIC X     VALUE SPACE.
   681     12  WS-SW-2                 PIC X     VALUE SPACE.
   682     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   683         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   684     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   685         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   686
   687     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   688     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   689     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   690     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   691     12  WS-CONVERTED-CANCEL-DATES.
   692         16  WS-CONVERTED-CANDT1                  PIC XX.
   693         16  WS-CONVERTED-CANDT2                  PIC XX.
   694
   695     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   696
   697     12  WS-REC-FOUND-SW         PIC X.
   698         88  RECORD-NOT-FOUND    VALUE 'N'.
   699
   700     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   701         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   702         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   703
   704     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   705         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   706         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   707
   708     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   709         88  BROWSE-STARTED      VALUE 'Y'.
   710
   711     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   712         88  FIRST-TIME          VALUE 'Y'.
   713
   714     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  15
* EL6311.cbl
   715         88  FIRST-ENTRY         VALUE 'Y'.
   716
   717     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   718         88  REC-BILLED          VALUE 'Y'.
   719
   720     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   721         88  NO-CURSOR-SET       VALUE +0.
   722         88  CURSOR-SET          VALUE +1.
   723
   724     12  WS-ERR-SW               PIC X.
   725         88  STD-ERRORS          VALUE 'S'.
   726         88  TRN-ERRORS          VALUE 'T'.
   727
   728     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   729         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   730
   731     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   732         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   733
   734     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   735         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   736
   737     12  WS-ERR-CODE.
   738         16  FILLER              PIC 99.
   739         16  WS-ERROR-SUB        PIC 99.
   740
   741     12  WS-DATE-WORK.
   742         16  WS-WORK-MM          PIC XX.
   743         16  WS-WORK-DD          PIC XX.
   744         16  WS-WORK-YY          PIC XX.
   745
   746     12  WS-MM-YY.
   747         16  WS-MM               PIC XX.
   748         16  FILLER              PIC X     VALUE '/'.
   749         16  WS-YY               PIC XX.
   750
   751     12  WS-CERT-EFF-DT          PIC XX.
   752
   753     12  WS-MEMBER-NO            PIC X(12).
   754     12  FILLER  REDEFINES  WS-MEMBER-NO.
   755         16  WS-MEMBER-NO-1-8    PIC 9(8).
   756         16  FILLER              PIC X(4).
   757
   758     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   759
   760     12  WS-ERPNDB-ALT-KEY.
   761         16  WS-PB-COMPANY-CD-A1         PIC X.
   762         16  WS-PB-CARRIER               PIC X.
   763         16  WS-PB-GROUPING              PIC X(6).
   764         16  WS-PB-STATE                 PIC XX.
   765         16  WS-PB-ACCOUNT               PIC X(10).
   766         16  WS-PB-CERT-EFF-DT           PIC XX.
   767         16  WS-PB-CERT-NO.
   768             20  WS-PB-CERT-PRIME        PIC X(10).
   769             20  WS-PB-CERT-SFX          PIC X.
   770         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   771         16  WS-PB-RECORD-TYPE           PIC X.
   772
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  16
* EL6311.cbl
   773     12  WS-SHOW-SAVE-AREAS.
   774         16  WS-NEW-CERT-NO.
   775             20  WS-NEW-PRIME    PIC X(10).
   776             20  WS-NEW-SUFFIX   PIC X.
   777         16  WS-NEW-CERT-EFF-DT  PIC XX.
   778         16  WS-NEW-RECORD-TYPE  PIC X.
   779         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   780             88   SHOW-RECORD            VALUE 'Y'.
   781
   782     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   783
   784     12  WS-BATCH-NO.
   785         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   786         16  FILLER              PIC X(5) VALUE SPACES.
   787
   788     12  WS-FIRST-NAME.
   789         16  WS-1ST-INIT         PIC X.
   790         16  FILLER              PIC X(9).
   791
   792     12  WS-INITIALS.
   793         16  WS-INITIAL-1        PIC X.
   794         16  WS-INITIAL-2        PIC X.
   795
   796     12  WS-C-HDG.
   797         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   798         16  FILLER              PIC X(4) VALUE '-REF'.
   799
   800     12  WS-D-PREM-HDG.
   801         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   802         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   803
   804     12  WS-D-REFUND-HDG.
   805         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   806         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   807
   808     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   809
   810     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   811     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   812     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   813     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   814     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   815     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   816     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   817
   818     12  WS-01-CANCEL-ERR        PIC X(25)
   819         VALUE 'CANCEL DATE ERROR'.
   820     12  WS-02-CANCEL-ERR        PIC X(25)
   821         VALUE 'CERT NOT FOUND'.
   822     12  WS-04-CANCEL-ERR        PIC X(25)
   823         VALUE 'CANCEL AMOUNT ERROR'.
   824     12  WS-05-CANCEL-ERR        PIC X(25)
   825         VALUE 'CANCEL OPTION ERROR'.
   826     12  WS-06-CANCEL-ERR        PIC X(25)
   827         VALUE 'PREVIOUSLY CANCELLED'.
   828     12  WS-07-CANCEL-ERR        PIC X(25)
   829         VALUE 'INVALID DATA'.
   830     12  WS-08-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  17
* EL6311.cbl
   831         VALUE 'NO ACCOUNT MASTER'.
   832     12  WS-09-CANCEL-ERR        PIC X(25)
   833         VALUE 'SUFFIX ALREADY EXISTS'.
   834     12  WS-99-CANCEL-ERR        PIC X(25)
   835         VALUE 'MISC CANCEL ERROR'.
   836
   837     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   838     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   839
   840     12  WS-AGE-FIELDS.
   841         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   842         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   843         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   844         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   845
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  18
* EL6311.cbl
   847
   848******************************************************************
   849*                                                                *
   850*                 B A T C H   T O T A L S                        *
   851*                                                                *
   852******************************************************************
   853
   854     12  WS-BATCH-RECORD.
   855         16  FILLER                       PIC X(10).
   856         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   857         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   858         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   859         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   860         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   861         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   862         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   863         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   864         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   865         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   866         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   867         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   868         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   869         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   870         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   871         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   872         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   873         16  WS-ACCOUNT-NAME              PIC X(30).
   874         16  FILLER                       PIC X.
   875         16  WS-REFERENCE                 PIC X(12).
   876         16  FILLER                       PIC X(197).
   877
   878     12  WS-BATCH-TOTALS.
   879         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   880         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   881         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   882         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   883         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   884         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   885         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   886         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   887         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   888         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   889         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   890         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   891         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   892         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   893         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   894         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   895         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   896         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   897         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   898
   899     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   900
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  19
* EL6311.cbl
   902
   903******************************************************************
   904*                                                                *
   905*                E R R O R   M E S S A G E S                     *
   906*                                                                *
   907******************************************************************
   908
   909 01  ERROR-MESSAGES.
   910     12  ER-0004                 PIC  9(4) VALUE 0004.
   911     12  ER-0008                 PIC  9(4) VALUE 0008.
   912     12  ER-0023                 PIC  9(4) VALUE 0023.
   913     12  ER-0029                 PIC  9(4) VALUE 0029.
   914     12  ER-0033                 PIC  9(4) VALUE 0033.
   915     12  ER-0070                 PIC  9(4) VALUE 0070.
   916     12  ER-0220                 PIC  9(4) VALUE 0220.
   917     12  ER-0248                 PIC  9(4) VALUE 0248.
   918     12  ER-0280                 PIC  9(4) VALUE 0280.
   919     12  ER-0348                 PIC  9(4) VALUE 0348.
   920     12  ER-0582                 PIC  9(4) VALUE 0582.
   921     12  ER-0877                 PIC  9(4) VALUE 0877.
   922     12  ER-1236                 PIC  9(4) VALUE 1236.
   923     12  ER-1570                 PIC  9(4) VALUE 1570.
   924     12  ER-1575                 PIC  9(4) VALUE 1575.
   925     12  ER-1609                 PIC  9(4) VALUE 1609.
   926     12  ER-1819                 PIC  9(4) VALUE 1819.
   927     12  ER-2077                 PIC  9(4) VALUE 2077.
   928     12  ER-2129                 PIC  9(4) VALUE 2129.
   929     12  ER-2188                 PIC  9(4) VALUE 2188.
   930     12  ER-2192                 PIC  9(4) VALUE 2192.
   931     12  ER-2196                 PIC  9(4) VALUE 2196.
   932     12  ER-2197                 PIC  9(4) VALUE 2197.
   933     12  ER-2198                 PIC  9(4) VALUE 2198.
   934     12  ER-2200                 PIC  9(4) VALUE 2200.
   935     12  ER-2212                 PIC  9(4) VALUE 2212.
   936     12  ER-2218                 PIC  9(4) VALUE 2218.
   937     12  ER-2220                 PIC  9(4) VALUE 2220.
   938     12  ER-2222                 PIC  9(4) VALUE 2222.
   939     12  ER-2223                 PIC  9(4) VALUE 2223.
   940     12  ER-2224                 PIC  9(4) VALUE 2224.
   941     12  ER-2225                 PIC  9(4) VALUE 2225.
   942     12  ER-2226                 PIC  9(4) VALUE 2226.
   943     12  ER-2227                 PIC  9(4) VALUE 2227.
   944     12  ER-2228                 PIC  9(4) VALUE 2228.
   945     12  ER-2240                 PIC  9(4) VALUE 2240.
   946     12  ER-2241                 PIC  9(4) VALUE 2241.
   947     12  ER-2242                 PIC  9(4) VALUE 2242.
   948     12  ER-2243                 PIC  9(4) VALUE 2243.
   949     12  ER-2244                 PIC  9(4) VALUE 2244.
   950     12  ER-2245                 PIC  9(4) VALUE 2245.
   951     12  ER-2246                 PIC  9(4) VALUE 2246.
   952     12  ER-2247                 PIC  9(4) VALUE 2247.
   953     12  ER-2251                 PIC  9(4) VALUE 2251.
   954     12  ER-2252                 PIC  9(4) VALUE 2252.
   955     12  ER-2253                 PIC  9(4) VALUE 2253.
   956     12  ER-2254                 PIC  9(4) VALUE 2254.
   957     12  ER-2255                 PIC  9(4) VALUE 2255.
   958     12  ER-2256                 PIC  9(4) VALUE 2256.
   959     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  20
* EL6311.cbl
   960     12  ER-2258                 PIC  9(4) VALUE 2258.
   961     12  ER-2259                 PIC  9(4) VALUE 2259.
   962     12  ER-2260                 PIC  9(4) VALUE 2260.
   963     12  ER-2261                 PIC  9(4) VALUE 2261.
   964     12  ER-2287                 PIC  9(4) VALUE 2287.
   965     12  ER-2336                 PIC  9(4) VALUE 2336.
   966     12  ER-2337                 PIC  9(4) VALUE 2337.
   967     12  ER-2437                 PIC  9(4) VALUE 2437.
   968     12  ER-2471                 PIC  9(4) VALUE 2471.
   969     12  ER-2530                 PIC  9(4) VALUE 2530.
   970     12  ER-2531                 PIC  9(4) VALUE 2531.
   971     12  ER-2532                 PIC  9(4) VALUE 2532.
   972     12  ER-2533                 PIC  9(4) VALUE 2533.
   973     12  ER-2547                 PIC  9(4) VALUE 2547.
   974     12  ER-2591                 PIC  9(4) VALUE 2591.
   975     12  ER-2592                 PIC  9(4) VALUE 2592.
   976     12  ER-2593                 PIC  9(4) VALUE 2593.
   977     12  ER-2600                 PIC  9(4) VALUE 2600.
   978     12  ER-2601                 PIC  9(4) VALUE 2601.
   979     12  ER-2604                 PIC  9(4) VALUE 2604.
   980     12  ER-2605                 PIC  9(4) VALUE 2605.
   981     12  ER-2606                 PIC  9(4) VALUE 2606.
   982     12  ER-2607                 PIC  9(4) VALUE 2607.
   983     12  ER-2622                 PIC  9(4) VALUE 2622.
   984     12  ER-2625                 PIC  9(4) VALUE 2625.
   985     12  ER-2626                 PIC  9(4) VALUE 2626.
   986     12  ER-2627                 PIC  9(4) VALUE 2627.
   987     12  ER-2628                 PIC  9(4) VALUE 2628.
   988     12  ER-2629                 PIC  9(4) VALUE 2629.
   989     12  ER-2630                 PIC  9(4) VALUE 2630.
   990     12  ER-2631                 PIC  9(4) VALUE 2631.
   991     12  ER-2632                 PIC  9(4) VALUE 2632.
   992     12  ER-2633                 PIC  9(4) VALUE 2633.
   993     12  ER-2634                 PIC  9(4) VALUE 2634.
   994     12  ER-2635                 PIC  9(4) VALUE 2635.
   995     12  ER-2636                 PIC  9(4) VALUE 2636.
   996     12  ER-2639                 PIC  9(4) VALUE 2639.
   997     12  ER-2640                 PIC  9(4) VALUE 2640.
   998     12  ER-2647                 PIC  9(4) VALUE 2647.
   999     12  ER-2648                 PIC  9(4) VALUE 2648.
  1000     12  ER-2649                 PIC  9(4) VALUE 2649.
  1001     12  ER-2650                 PIC  9(4) VALUE 2650.
  1002     12  ER-2653                 PIC  9(4) VALUE 2653.
  1003     12  ER-2654                 PIC  9(4) VALUE 2654.
  1004     12  ER-2655                 PIC  9(4) VALUE 2655.
  1005     12  ER-2656                 PIC  9(4) VALUE 2656.
  1006     12  ER-2657                 PIC  9(4) VALUE 2657.
  1007     12  ER-2660                 PIC  9(4) VALUE 2660.
  1008     12  ER-2661                 PIC  9(4) VALUE 2661.
  1009     12  ER-2662                 PIC  9(4) VALUE 2662.
  1010     12  ER-2663                 PIC  9(4) VALUE 2663.
  1011     12  ER-2664                 PIC  9(4) VALUE 2664.
  1012     12  ER-2667                 PIC  9(4) VALUE 2667.
  1013     12  ER-2668                 PIC  9(4) VALUE 2668.
  1014     12  ER-2669                 PIC  9(4) VALUE 2669.
  1015     12  ER-2670                 PIC  9(4) VALUE 2670.
  1016     12  ER-2671                 PIC  9(4) VALUE 2671.
  1017     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  21
* EL6311.cbl
  1018     12  ER-2673                 PIC  9(4) VALUE 2673.
  1019     12  ER-2677                 PIC  9(4) VALUE 2677.
  1020     12  ER-2678                 PIC  9(4) VALUE 2678.
  1021     12  ER-2679                 PIC  9(4) VALUE 2679.
  1022     12  ER-2680                 PIC  9(4) VALUE 2680.
  1023     12  ER-2681                 PIC  9(4) VALUE 2681.
  1024     12  ER-2682                 PIC  9(4) VALUE 2682.
  1025     12  ER-2683                 PIC  9(4) VALUE 2683.
  1026     12  ER-2684                 PIC  9(4) VALUE 2684.
  1027     12  ER-2686                 PIC  9(4) VALUE 2686.
  1028     12  ER-2689                 PIC  9(4) VALUE 2689.
  1029     12  ER-2690                 PIC  9(4) VALUE 2690.
  1030     12  ER-2693                 PIC  9(4) VALUE 2693.
  1031     12  ER-2695                 PIC  9(4) VALUE 2695.
  1032     12  ER-2701                 PIC  9(4) VALUE 2701.
  1033     12  ER-2720                 PIC  9(4) VALUE 2720.
  1034     12  ER-2709                 PIC  9(4) VALUE 2709.
  1035     12  ER-2704                 PIC  9(4) VALUE 2704.
  1036     12  ER-2725                 PIC  9(4) VALUE 2725.
  1037     12  ER-2726                 PIC  9(4) VALUE 2726.
  1038     12  ER-2728                 PIC  9(4) VALUE 2728.
  1039     12  ER-2729                 PIC  9(4) VALUE 2729.
  1040     12  ER-2731                 PIC  9(4) VALUE 2731.
  1041     12  ER-2732                 PIC  9(4) VALUE 2732.
  1042     12  ER-2733                 PIC  9(4) VALUE 2733.
  1043     12  ER-2735                 PIC  9(4) VALUE 2735.
  1044     12  ER-2738                 PIC  9(4) VALUE 2738.
  1045     12  ER-2742                 PIC  9(4) VALUE 2742.
  1046     12  ER-2743                 PIC  9(4) VALUE 2743.
  1047     12  ER-2744                 PIC  9(4) VALUE 2744.
  1048     12  ER-2747                 PIC  9(4) VALUE 2747.
  1049     12  ER-2749                 PIC  9(4) VALUE 2749.
  1050     12  ER-2753                 PIC  9(4) VALUE 2753.
  1051     12  ER-2755                 PIC  9(4) VALUE 2755.
  1052     12  ER-2757                 PIC  9(4) VALUE 2757.
  1053     12  ER-2771                 PIC  9(4) VALUE 2771.
  1054     12  ER-2774                 PIC  9(4) VALUE 2774.
  1055     12  ER-2775                 PIC  9(4) VALUE 2775.
  1056     12  ER-2776                 PIC  9(4) VALUE 2776.
  1057     12  ER-2777                 PIC  9(4) VALUE 2777.
  1058     12  ER-2794                 PIC  9(4) VALUE 2794.
  1059     12  ER-2799                 PIC  9(4) VALUE 2799.
  1060     12  ER-2900                 PIC  9(4) VALUE 2900.
  1061     12  ER-2902                 PIC  9(4) VALUE 2902.
  1062     12  ER-2945                 PIC  9(4) VALUE 2945.
  1063     12  ER-3000                 PIC  9(4) VALUE 3000.
  1064     12  ER-3006                 PIC  9(4) VALUE 3006.
  1065     12  ER-3054                 PIC  9(4) VALUE 3054.
  1066     12  ER-3224                 PIC  9(4) VALUE 3224.
  1067     12  ER-3269                 PIC  9(4) VALUE 3269.
  1068     12  er-3444                 pic  9(4) value 3444.
  1069     12  er-3446                 pic  9(4) value 3446.
  1070     12  er-3447                 pic  9(4) value 3447.
  1071     12  er-3448                 pic  9(4) value 3448.
  1072     12  er-3449                 pic  9(4) value 3449.
  1073     12  ER-3504                 PIC  9(4) VALUE 3504.
  1074     12  ER-3513                 PIC  9(4) VALUE 3513.
  1075     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  22
* EL6311.cbl
  1076     12  ER-3834                 PIC  9(4) VALUE 3834.
  1077     12  ER-3835                 PIC  9(4) VALUE 3835.
  1078     12  ER-4005                 PIC  9(4) VALUE 4005.
  1079     12  ER-7144                 PIC  9(4) VALUE 7144.
  1080     12  ER-7401                 PIC  9(4) VALUE 7401.
  1081     12  ER-7402                 PIC  9(4) VALUE 7402.
  1082     12  ER-7403                 PIC  9(4) VALUE 7403.
  1083     12  ER-7404                 PIC  9(4) VALUE 7404.
  1084     12  ER-7423                 PIC  9(4) VALUE 7423.
  1085     12  ER-7424                 PIC  9(4) VALUE 7424.
  1086     12  ER-7433                 PIC  9(4) VALUE 7433.
  1087     12  ER-7450                 PIC  9(4) VALUE 7450.
  1088     12  ER-7451                 PIC  9(4) VALUE 7451.
  1089     12  ER-7530                 PIC  9(4) VALUE 7530.
  1090     12  ER-7573                 PIC  9(4) VALUE 7573.
  1091     12  ER-7631                 PIC  9(4) VALUE 7631.
  1092     12  ER-7632                 PIC  9(4) VALUE 7632.
  1093     12  ER-7633                 PIC  9(4) VALUE 7633.
  1094     12  ER-7537                 PIC  9(4) VALUE 7537.
  1095     12  ER-7538                 PIC  9(4) VALUE 7538.
  1096     12  ER-7574                 PIC  9(4) VALUE 7574.
  1097     12  ER-7997                 PIC  9(4) VALUE 7997.
  1098     12  ER-7998                 PIC  9(4) VALUE 7998.
  1099     12  ER-8148                 PIC  9(4) VALUE 8148.
  1100     12  ER-9063                 PIC  9(4) VALUE 9063.
  1101     12  ER-9076                 PIC  9(4) VALUE 9076.
  1102     12  ER-9618                 PIC  9(4) VALUE 9618.
  1103     12  ER-9841                 PIC  9(4) VALUE 9841.
  1104
  1105*                                COPY ELCTEXT.
  1106******************************************************************
  1107*                                                                *
  1108*                                                                *
  1109*                            ELCTEXT.                            *
  1110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1111*                            VMOD=2.008                          *
  1112*                                                                *
  1113*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1114*                                     FORM LETTERS,              *
  1115*                                     CERT FORM DISPLAY.
  1116*                                                                *
  1117*   FILE TYPE = VSAM,KSDS                                        *
  1118*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1119*                                                                *
  1120*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1121*       ALTERNATE INDEX = NONE                                   *
  1122*                                                                *
  1123*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1124*       ALTERNATE INDEX = NONE                                   *
  1125*                                                                *
  1126*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1127*       ALTERNATE INDEX = NONE                                   *
  1128*                                                                *
  1129*   LOG = NO                                                     *
  1130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1131******************************************************************
  1132 01  TEXT-FILES.
  1133     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  23
* EL6311.cbl
  1134         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1135         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1136         88  HELP-FILE-TEXT             VALUE 'TH'.
  1137
  1138     12  TX-CONTROL-PRIMARY.
  1139         16  TX-COMPANY-CD           PIC X.
  1140             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1141         16  TX-ACCESS-CD-GENL       PIC X(12).
  1142
  1143         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1144             20  TX-LETTER-NO        PIC X(4).
  1145             20  FILLER              PIC X(8).
  1146
  1147         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1148             20  TX-FORM-NO          PIC X(12).
  1149
  1150         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1151             20  TX-HELP-TYPE        PIC X.
  1152                 88  HELP-FOR-GENERAL   VALUE ' '.
  1153                 88  HELP-BY-SCREEN     VALUE 'S'.
  1154                 88  HELP-BY-ERROR      VALUE 'E'.
  1155             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1156                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1157             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1158                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1159             20  FILLER              PIC X(4).
  1160
  1161         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1162
  1163     12  TX-PROCESS-CONTROL          PIC XX.
  1164         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1165
  1166     12  TX-TEXT-LINE                PIC X(70).
  1167
  1168     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1169         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1170         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1171         88  TX-VALID-FORM-SQUEEZE-VALUE
  1172                                        VALUE 'Y' ' '.
  1173
  1174     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1175         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1176         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1177         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1178         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1179         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1180         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1181         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1182                                              'K' 'N' ' '
  1183                                              'Z'.
  1184
  1185     12  TX-ARCHIVE-SW               PIC X.
  1186         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1187         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1188         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1189
  1190     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1191     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  24
* EL6311.cbl
  1192
  1193     12  TX-BSR-CODE                 PIC X.
  1194         88  TX-BSR-LETTER              VALUE 'B'.
  1195         88  TX-NON-BSR-LETTER          VALUE ' '.
  1196
  1197     12  FILLER                      PIC X.
  1198*****************************************************************
  1199*                                COPY ELCCRTO.
  1200******************************************************************
  1201*                                                                *
  1202*                            ELCCRTO.                            *
  1203*                                                                *
  1204*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1205*                                                                *
  1206*   FILE TYPE = VSAM,KSDS                                        *
  1207*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1208*                                                                *
  1209*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1210*                                                                *
  1211*   LOG = YES                                                    *
  1212*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1213******************************************************************
  1214*                   C H A N G E   L O G
  1215*
  1216* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1217*-----------------------------------------------------------------
  1218*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1219* EFFECTIVE    NUMBER
  1220*-----------------------------------------------------------------
  1221* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1222* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1223* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1224* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1225* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1226******************************************************************
  1227 01  ORIGINAL-CERTIFICATE.
  1228     12  OC-RECORD-ID                      PIC XX.
  1229         88  VALID-OC-ID                      VALUE 'OC'.
  1230     12  OC-CONTROL-PRIMARY.
  1231         16  OC-COMPANY-CD                 PIC X.
  1232         16  OC-CARRIER                    PIC X.
  1233         16  OC-GROUPING                   PIC X(6).
  1234         16  OC-STATE                      PIC XX.
  1235         16  OC-ACCOUNT                    PIC X(10).
  1236         16  OC-CERT-EFF-DT                PIC XX.
  1237         16  OC-CERT-NO.
  1238             20  OC-CERT-PRIME             PIC X(10).
  1239             20  OC-CERT-SFX               PIC X.
  1240         16  OC-RECORD-TYPE                PIC X.
  1241         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1242     12  OC-LAST-MAINT-DT                  PIC XX.
  1243     12  OC-LAST-MAINT-BY                  PIC X(4).
  1244     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1245     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1246     12  FILLER                            PIC X(49).
  1247     12  OC-ORIG-REC.
  1248         16  OC-INS-LAST-NAME              PIC X(15).
  1249         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  25
* EL6311.cbl
  1250         16  OC-INS-MIDDLE-INIT            PIC X.
  1251         16  OC-INS-AGE                    PIC S999     COMP-3.
  1252         16  OC-JNT-LAST-NAME              PIC X(15).
  1253         16  OC-JNT-FIRST-NAME             PIC X(10).
  1254         16  OC-JNT-MIDDLE-INIT            PIC X.
  1255         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1256         16  OC-LF-BENCD                   PIC XX.
  1257         16  OC-LF-TERM                    PIC S999      COMP-3.
  1258         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1259         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1260         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1261         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1262         16  OC-LF-EXP-DT                  PIC XX.
  1263         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1264         16  OC-LF-CANCEL-DT               PIC XX.
  1265         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1266         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1267         16  OC-AH-BENCD                   PIC XX.
  1268         16  OC-AH-TERM                    PIC S999      COMP-3.
  1269         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1270         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1271         16  OC-AH-EXP-DT                  PIC XX.
  1272         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1273         16  OC-AH-CP                      PIC 99.
  1274         16  OC-AH-CANCEL-DT               PIC XX.
  1275         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1276         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1277         16  OC-CRED-BENE-NAME             PIC X(25).
  1278         16  OC-1ST-PMT-DT                 PIC XX.
  1279         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1280         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1281         16  OC-ISSUE-TRAN-IND             PIC X.
  1282         16  OC-CANCEL-TRAN-IND            PIC X.
  1283         16  FILLER                        PIC X(211).
  1284
  1285     12  FILLER                            PIC X(50).
  1286******************************************************************
  1287*                                COPY ERCACCT.
  1288******************************************************************
  1289*                                                                *
  1290*                                                                *
  1291*                            ERCACCT                             *
  1292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1293*                            VMOD=2.031                          *
  1294*                                                                *
  1295*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1296*                                                                *
  1297*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1298*   VSAM ACCOUNT MASTER FILES.                                   *
  1299*                                                                *
  1300*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1301*                                                                *
  1302*   FILE TYPE = VSAM,KSDS                                        *
  1303*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1304*                                                                *
  1305*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1306*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1307*                                                                *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  26
* EL6311.cbl
  1308*   LOG = NO                                                     *
  1309*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1310*                                                                *
  1311*                                                                *
  1312******************************************************************
  1313*                   C H A N G E   L O G
  1314*
  1315* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1316*-----------------------------------------------------------------
  1317*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1318* EFFECTIVE    NUMBER
  1319*-----------------------------------------------------------------
  1320* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1321* 092705    2005050300006  PEMA  ADD SPP LEASES
  1322* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1323* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1324* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1325* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1326* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1327******************************************************************
  1328
  1329 01  ACCOUNT-MASTER.
  1330     12  AM-RECORD-ID                      PIC XX.
  1331         88  VALID-AM-ID                      VALUE 'AM'.
  1332
  1333     12  AM-CONTROL-PRIMARY.
  1334         16  AM-COMPANY-CD                 PIC X.
  1335         16  AM-MSTR-CNTRL.
  1336             20  AM-CONTROL-A.
  1337                 24  AM-CARRIER            PIC X.
  1338                 24  AM-GROUPING.
  1339                     28 AM-GROUPING-PREFIX PIC XXX.
  1340                     28 AM-GROUPING-PRIME  PIC XXX.
  1341                 24  AM-STATE              PIC XX.
  1342                 24  AM-ACCOUNT.
  1343                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1344                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1345             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1346                                           PIC X(19).
  1347             20  AM-CNTRL-B.
  1348                 24  AM-EXPIRATION-DT      PIC XX.
  1349                 24  FILLER                PIC X(4).
  1350             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1351                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1352
  1353     12  AM-CONTROL-BY-VAR-GRP.
  1354         16  AM-COMPANY-CD-A1              PIC X.
  1355         16  AM-VG-CARRIER                 PIC X.
  1356         16  AM-VG-GROUPING                PIC X(6).
  1357         16  AM-VG-STATE                   PIC XX.
  1358         16  AM-VG-ACCOUNT                 PIC X(10).
  1359         16  AM-VG-DATE.
  1360             20  AM-VG-EXPIRATION-DT       PIC XX.
  1361             20  FILLER                    PIC X(4).
  1362         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1363                                           PIC 9(11)      COMP-3.
  1364     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1365         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  27
* EL6311.cbl
  1366         16  AM-VG-KEY3.
  1367             20  AM-VG3-ACCOUNT            PIC X(10).
  1368             20  AM-VG3-EXP-DT             PIC XX.
  1369         16  FILLER                        PIC X(4).
  1370     12  AM-MAINT-INFORMATION.
  1371         16  AM-LAST-MAINT-DT              PIC XX.
  1372         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1373         16  AM-LAST-MAINT-USER            PIC X(4).
  1374         16  FILLER                        PIC XX.
  1375
  1376     12  AM-EFFECTIVE-DT                   PIC XX.
  1377     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1378
  1379     12  AM-PREV-DATES  COMP-3.
  1380         16  AM-PREV-EXP-DT                PIC 9(11).
  1381         16  AM-PREV-EFF-DT                PIC 9(11).
  1382
  1383     12  AM-REPORT-CODE-1                  PIC X(10).
  1384     12  AM-REPORT-CODE-2                  PIC X(10).
  1385
  1386     12  AM-CITY-CODE                      PIC X(4).
  1387     12  AM-COUNTY-PARISH                  PIC X(6).
  1388
  1389     12  AM-NAME                           PIC X(30).
  1390     12  AM-PERSON                         PIC X(30).
  1391     12  AM-ADDRS                          PIC X(30).
  1392     12  AM-CITY.
  1393         16  AM-ADDR-CITY                  PIC X(28).
  1394         16  AM-ADDR-STATE                 PIC XX.
  1395     12  AM-ZIP.
  1396         16  AM-ZIP-PRIME.
  1397             20  AM-ZIP-PRI-1ST            PIC X.
  1398                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1399             20  FILLER                    PIC X(4).
  1400         16  AM-ZIP-PLUS4                  PIC X(4).
  1401     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1402         16  AM-CAN-POSTAL-1               PIC XXX.
  1403         16  AM-CAN-POSTAL-2               PIC XXX.
  1404         16  FILLER                        PIC XXX.
  1405     12  AM-TEL-NO.
  1406         16  AM-AREA-CODE                  PIC 999.
  1407         16  AM-TEL-PRE                    PIC 999.
  1408         16  AM-TEL-NBR                    PIC 9(4).
  1409     12  AM-TEL-LOC                        PIC X.
  1410         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1411         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1412
  1413     12  AM-COMM-STRUCTURE.
  1414         16  AM-DEFN-1.
  1415             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1416                 24  AM-AGT.
  1417                     28  AM-AGT-PREFIX     PIC X(4).
  1418                     28  AM-AGT-PRIME      PIC X(6).
  1419                 24  AM-COM-TYP            PIC X.
  1420                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1421                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1422                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1423                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  28
* EL6311.cbl
  1424                 24  AM-RETRO-LV-INDIC     PIC X.
  1425                 24  AM-GL-CODES           PIC X.
  1426                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1427                 24  FILLER                PIC X(01).
  1428         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1429             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1430                 24  FILLER                PIC X(11).
  1431                 24  AM-L-COMA             PIC XXX.
  1432                 24  AM-J-COMA             PIC XXX.
  1433                 24  AM-A-COMA             PIC XXX.
  1434                 24  FILLER                PIC X(6).
  1435
  1436     12  AM-COMM-CHANGE-STATUS             PIC X.
  1437         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1438
  1439     12  AM-CSR-CODE                       PIC X(4).
  1440
  1441     12  AM-BILLING-STATUS                 PIC X.
  1442         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1443         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1444     12  AM-AUTO-REFUND-SW                 PIC X.
  1445         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1446         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1447     12  AM-GPCD                           PIC 99.
  1448     12  AM-IG                             PIC X.
  1449         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1450         88  AM-HAS-GROUP                     VALUE '2'.
  1451     12  AM-STATUS                         PIC X.
  1452         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1453         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1454         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1455         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1456         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1457         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1458     12  AM-REMIT-TO                       PIC 99.
  1459     12  AM-ID-NO                          PIC X(11).
  1460
  1461     12  AM-CAL-TABLE                      PIC XX.
  1462     12  AM-LF-DEVIATION                   PIC XXX.
  1463     12  AM-AH-DEVIATION                   PIC XXX.
  1464     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1465     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1466     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1467     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1468     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1469     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1470
  1471     12  AM-USER-FIELDS.
  1472         16  AM-FLD-1                      PIC XX.
  1473         16  AM-FLD-2                      PIC XX.
  1474         16  AM-FLD-3                      PIC XX.
  1475         16  AM-FLD-4                      PIC XX.
  1476         16  AM-FLD-5                      PIC XX.
  1477
  1478     12  AM-1ST-PROD-DATE.
  1479         16  AM-1ST-PROD-YR                PIC XX.
  1480         16  AM-1ST-PROD-MO                PIC XX.
  1481         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  29
* EL6311.cbl
  1482     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1483     12  AM-CERTS-PURGED-DATE.
  1484         16  AM-PUR-YR                     PIC XX.
  1485         16  AM-PUR-MO                     PIC XX.
  1486         16  AM-PUR-DA                     PIC XX.
  1487     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1488     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1489     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1490     12  AM-INACTIVE-DATE.
  1491         16  AM-INA-MO                     PIC 99.
  1492         16  AM-INA-DA                     PIC 99.
  1493         16  AM-INA-YR                     PIC 99.
  1494     12  AM-AR-HI-CERT-DATE                PIC XX.
  1495
  1496     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1497     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1498
  1499     12  AM-OB-PAYMENT-MODE                PIC X.
  1500         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1501         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1502         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1503         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1504
  1505     12  AM-AH-ONLY-INDICATOR              PIC X.
  1506         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1507         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1508
  1509     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1510
  1511     12  AM-OVER-SHORT.
  1512         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1513         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1514
  1515     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1516     12  AM-DCC-CLP-STATE                  PIC XX.
  1517
  1518     12  AM-RECALC-COMM                    PIC X.
  1519     12  AM-RECALC-REIN                    PIC X.
  1520
  1521     12  AM-REI-TABLE                      PIC XXX.
  1522     12  AM-REI-ET-LF                      PIC X.
  1523     12  AM-REI-ET-AH                      PIC X.
  1524     12  AM-REI-PE-LF                      PIC X.
  1525     12  AM-REI-PE-AH                      PIC X.
  1526     12  AM-REI-PRT-ST                     PIC X.
  1527     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1528     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1529     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1530     12  AM-REI-GROUP-A                    PIC X(6).
  1531     12  AM-REI-MORT                       PIC X(4).
  1532     12  AM-REI-PRT-OW                     PIC X.
  1533     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1534     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1535     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1536     12  AM-REI-GROUP-B                    PIC X(6).
  1537
  1538     12  AM-TRUST-TYPE                     PIC X(2).
  1539
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  30
* EL6311.cbl
  1540     12  AM-EMPLOYER-STMT-USED             PIC X.
  1541     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1542
  1543     12  AM-STD-AH-TYPE                    PIC XX.
  1544     12  AM-EARN-METHODS.
  1545         16  AM-EARN-METHOD-R              PIC X.
  1546             88 AM-REF-RL-R78                 VALUE 'R'.
  1547             88 AM-REF-RL-PR                  VALUE 'P'.
  1548             88 AM-REF-RL-MEAN                VALUE 'M'.
  1549             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1550         16  AM-EARN-METHOD-L              PIC X.
  1551             88 AM-REF-LL-R78                 VALUE 'R'.
  1552             88 AM-REF-LL-PR                  VALUE 'P'.
  1553             88 AM-REF-LL-MEAN                VALUE 'M'.
  1554             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1555         16  AM-EARN-METHOD-A              PIC X.
  1556             88 AM-REF-AH-R78                 VALUE 'R'.
  1557             88 AM-REF-AH-PR                  VALUE 'P'.
  1558             88 AM-REF-AH-MEAN                VALUE 'M'.
  1559             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1560             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1561             88 AM-REF-AH-NET                 VALUE 'N'.
  1562
  1563     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1564     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1565     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1566
  1567     12  AM-RET-Y-N                        PIC X.
  1568     12  AM-RET-P-E                        PIC X.
  1569     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1570     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1571     12  AM-RET-GRP                        PIC X(6).
  1572     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1573         16  AM-POOL-PRIME                 PIC XXX.
  1574         16  AM-POOL-SUB                   PIC XXX.
  1575     12  AM-RETRO-EARNINGS.
  1576         16  AM-RET-EARN-R                 PIC X.
  1577         16  AM-RET-EARN-L                 PIC X.
  1578         16  AM-RET-EARN-A                 PIC X.
  1579     12  AM-RET-ST-TAX-USE                 PIC X.
  1580         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1581         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1582     12  AM-RETRO-BEG-EARNINGS.
  1583         16  AM-RET-BEG-EARN-R             PIC X.
  1584         16  AM-RET-BEG-EARN-L             PIC X.
  1585         16  AM-RET-BEG-EARN-A             PIC X.
  1586     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1587     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1588
  1589     12  AM-USER-SELECT-OPTIONS.
  1590         16  AM-USER-SELECT-1              PIC X(10).
  1591         16  AM-USER-SELECT-2              PIC X(10).
  1592         16  AM-USER-SELECT-3              PIC X(10).
  1593         16  AM-USER-SELECT-4              PIC X(10).
  1594         16  AM-USER-SELECT-5              PIC X(10).
  1595
  1596     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1597
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  31
* EL6311.cbl
  1598     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1599
  1600     12  AM-RPT045A-SWITCH                 PIC X.
  1601         88  RPT045A-OFF                   VALUE 'N'.
  1602
  1603     12  AM-INSURANCE-LIMITS.
  1604         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1605         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1606
  1607     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1608         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1609
  1610     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1611         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1612         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1613
  1614     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1615
  1616     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1617     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1618     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1619     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1620     12  AM-DCC-UEF-STATE                  PIC XX.
  1621     12  FILLER                            PIC XXX.
  1622     12  AM-REPORT-CODE-3                  PIC X(10).
  1623*    12  FILLER                            PIC X(22).
  1624
  1625     12  AM-RESERVE-DATE.
  1626         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1627         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1628         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1629
  1630     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1631     12  AM-NOTIFICATION-TYPES.
  1632         16  AM-NOTIF-OF-LETTERS           PIC X.
  1633         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1634         16  AM-NOTIF-OF-REPORTS           PIC X.
  1635         16  AM-NOTIF-OF-STATUS            PIC X.
  1636
  1637     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1638         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1639         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1640         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1641         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1642
  1643     12  AM-BENEFIT-CONTROLS.
  1644         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1645             20  AM-BENEFIT-CODE           PIC XX.
  1646             20  AM-BENEFIT-TYPE           PIC X.
  1647             20  AM-BENEFIT-REVISION       PIC XXX.
  1648             20  AM-BENEFIT-REM-TERM       PIC X.
  1649             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1650             20  FILLER                    PIC XX.
  1651         16  FILLER                        PIC X(80).
  1652
  1653     12  AM-TRANSFER-DATA.
  1654         16  AM-TRANSFERRED-FROM.
  1655             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  32
* EL6311.cbl
  1656             20  AM-TRNFROM-GROUPING.
  1657                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1658                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1659             20  AM-TRNFROM-STATE          PIC XX.
  1660             20  AM-TRNFROM-ACCOUNT.
  1661                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1662                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1663             20  AM-TRNFROM-DTE            PIC XX.
  1664         16  AM-TRANSFERRED-TO.
  1665             20  AM-TRNTO-CARRIER          PIC X.
  1666             20  AM-TRNTO-GROUPING.
  1667                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1668                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1669             20  AM-TRNTO-STATE            PIC XX.
  1670             20  AM-TRNTO-ACCOUNT.
  1671                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1672                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1673             20  AM-TRNTO-DTE              PIC XX.
  1674         16  FILLER                        PIC X(10).
  1675
  1676     12  AM-SAVED-REMIT-TO                 PIC 99.
  1677
  1678     12  AM-COMM-STRUCTURE-SAVED.
  1679         16  AM-DEFN-1-SAVED.
  1680             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1681                 24  AM-AGT-SV             PIC X(10).
  1682                 24  AM-COM-TYP-SV         PIC X.
  1683                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1684                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1685                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1686                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1687                 24  FILLER                PIC X.
  1688                 24  AM-GL-CODES-SV        PIC X.
  1689                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1690                 24  FILLER                PIC X.
  1691         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1692             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1693                 24  FILLER                PIC X(11).
  1694                 24  AM-L-COMA-SV          PIC XXX.
  1695                 24  AM-J-COMA-SV          PIC XXX.
  1696                 24  AM-A-COMA-SV          PIC XXX.
  1697                 24  FILLER                PIC X(6).
  1698
  1699     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1700         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1701            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1702            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1703            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1704
  1705     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1706     12  FILLER                            PIC X(120).
  1707
  1708     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1709         16  AM-CONTROL-NAME               PIC X(30).
  1710         16  AM-EXECUTIVE-ONE.
  1711             20  AM-EXEC1-NAME             PIC X(15).
  1712             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1713                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  33
* EL6311.cbl
  1714             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1715                                                          COMP-3.
  1716         16  AM-EXECUTIVE-TWO.
  1717             20  AM-EXEC2-NAME             PIC X(15).
  1718             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1719                                                          COMP-3.
  1720             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1721                                                          COMP-3.
  1722
  1723     12  AM-RETRO-ADDITIONAL-DATA.
  1724         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1725         16  AM-RETRO-PREM-P-E             PIC X.
  1726         16  AM-RETRO-CLMS-P-I             PIC X.
  1727         16  AM-RETRO-RET-BRACKET-LF.
  1728             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1729                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1730                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1731             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1732                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1733                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1734             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1735                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1736                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1737         16  AM-RETRO-RET-BRACKET-AH.
  1738             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1739                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1740                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1741                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1742             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1743                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1744                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1745             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1746                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1747                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1748
  1749     12  AM-COMMENTS.
  1750         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1751
  1752     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1753         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1754         16  AM-FLI-BILLING-CODE           PIC X.
  1755         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1756         16  AM-FLI-UNITED-IDENT           PIC X.
  1757         16  AM-FLI-INTEREST-LOST-DATA.
  1758             20  AM-FLI-BANK-NO            PIC X(5).
  1759             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1760             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1761             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1762         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1763             20  AM-FLI-AGT                PIC X(9).
  1764             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1765             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1766         16  FILLER                        PIC X(102).
  1767
  1768     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1769         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1770             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1771             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  34
* EL6311.cbl
  1772             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1773             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1774             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1775         16  FILLER                          PIC X(10).
  1776******************************************************************
  1777*                                COPY ELCVADS.
  1778******************************************************************
  1779*                                                                *
  1780*                                                                *
  1781*                            ELCVADS.                            *
  1782*                                                                *
  1783*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1784*   ELVADS                  LENGTH = 350                         *
  1785******************************************************************
  1786******************************************************************
  1787*                   C H A N G E   L O G
  1788*
  1789* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1790*-----------------------------------------------------------------
  1791*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1792* EFFECTIVE    NUMBER
  1793*-----------------------------------------------------------------
  1794* 100111    2011022800001  AJRA  NAPERSOFT
  1795******************************************************************
  1796
  1797 01  VIRGINIA-DISCLOSURE.
  1798     12  VD-COMPANY-CD              PIC X.
  1799     12  VD-CARRIER                 PIC X.
  1800     12  VD-GROUPING.
  1801         20  VD-GROUPING-PREFIX     PIC XXX.
  1802         20  VD-GROUPING-PRIME      PIC XXX.
  1803     12  VD-STATE                   PIC XX.
  1804     12  VD-ACCOUNT.
  1805         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1806         20  VD-ACCOUNT-PRIME       PIC X(6).
  1807     12  VD-CERT-EFF-DT             PIC XX.
  1808     12  VD-CERT-NO.
  1809         20  VD-CERT-PRIME          PIC X(10).
  1810         20  VD-CERT-SFX            PIC X.
  1811     12  VD-ENTRY-BATCH             PIC X(6).
  1812     12  VD-CSR-ID                  PIC X(4).
  1813     12  VD-NAME.
  1814         20  VD-INSURED-LAST-NAME   PIC X(15).
  1815         20  VD-INSURED-FIRST-NAME.
  1816             24  VD-INSURED-1ST-INIT PIC X.
  1817             24  FILLER             PIC X(9).
  1818         20  VD-INSURED-MIDDLE-INIT PIC X.
  1819     12  VD-JOINT-INSURED.
  1820         20 VD-JOINT-LAST-NAME      PIC X(15).
  1821         20 VD-JOINT-FIRST-NAME.
  1822            24  VD-JOINT-FIRST-INIT PIC X.
  1823            24  FILLER              PIC X(9).
  1824         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1825     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1826     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1827     12  VD-INSURED-CITY-STATE.
  1828         20  VD-INSURED-CITY        PIC X(28).
  1829         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  35
* EL6311.cbl
  1830     12  VD-INSURED-ZIP-CODE.
  1831         20  VD-INSURED-ZIP-PRIME.
  1832             24  VD-INSURED-ZIP-1   PIC X.
  1833                 88  VD-CANADIAN-POST-CODE
  1834                                       VALUE 'A' THRU 'Z'.
  1835             24  FILLER             PIC X(4).
  1836         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1837     12  VD-BENEFICIARY-NAME        PIC X(30).
  1838     12  VD-ACCOUNT-NAME            PIC X(30).
  1839     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1840     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1841     12  VD-1ST-PMT-DT              PIC XX.
  1842     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1843         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1844         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1845                                             '90' THRU '99'.
  1846     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1847                                    PIC XX.
  1848     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1849     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1850     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1851     12  VD-LF-TERM                 PIC S999   COMP-3.
  1852     12  VD-AH-BENEFIT-CD           PIC XX.
  1853         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1854         88  VD-INVALID-AH             VALUE '  ' '00'
  1855                                             '90' THRU '99'.
  1856     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1857     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1858     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1859     12  VD-AH-TERM                 PIC S999   COMP-3.
  1860     12  VD-LETTER-ID               PIC X(4).
  1861     12  VD-PROC-ID                 PIC X(4).
  1862     12  VD-COMP-ID                 PIC X(3).
  1863     12  VD-CURRENT-DATE            PIC XX.
  1864     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1865     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1866     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  36
* EL6311.cbl
  1868*    COPY ELCDATE.
  1869******************************************************************
  1870*                                                                *
  1871*                                                                *
  1872*                            ELCDATE.                            *
  1873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1874*                            VMOD=2.003
  1875*                                                                *
  1876*                                                                *
  1877*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1878*                 LENGTH = 200                                   *
  1879******************************************************************
  1880
  1881 01  DATE-CONVERSION-DATA.
  1882     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1883     12  DC-OPTION-CODE                PIC X.
  1884         88  BIN-TO-GREG                VALUE ' '.
  1885         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1886         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1887         88  YMD-GREG-TO-BIN            VALUE '3'.
  1888         88  MDY-GREG-TO-BIN            VALUE '4'.
  1889         88  JULIAN-TO-BIN              VALUE '5'.
  1890         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1891         88  FIND-CENTURY               VALUE '7'.
  1892         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1893         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1894         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1895         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1896         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1897         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1898         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1899         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1900         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1901         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1902         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1903         88  BIN-3-TO-GREG              VALUE 'I'.
  1904         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1905         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1906         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1907         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1908         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1909         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1910         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1911         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1912         88  THREE-CHARACTER-BIN
  1913                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1914         88  GREGORIAN-TO-BIN
  1915                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1916         88  BIN-TO-GREGORIAN
  1917                  VALUES ' ' '1' 'I' '8' 'G'.
  1918         88  JULIAN-TO-BINARY
  1919                  VALUES '5' 'C' 'E' 'F'.
  1920     12  DC-ERROR-CODE                 PIC X.
  1921         88  NO-CONVERSION-ERROR        VALUE ' '.
  1922         88  DATE-CONVERSION-ERROR
  1923                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1924         88  DATE-IS-ZERO               VALUE '1'.
  1925         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  37
* EL6311.cbl
  1926         88  DATE-IS-INVALID            VALUE '3'.
  1927         88  DATE1-GREATER-DATE2        VALUE '4'.
  1928         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1929         88  DATE-INVALID-OPTION        VALUE '9'.
  1930         88  INVALID-CENTURY            VALUE 'A'.
  1931         88  ONLY-CENTURY               VALUE 'B'.
  1932         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1933         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1934     12  DC-END-OF-MONTH               PIC X.
  1935         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1936     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1937         88  USE-NORMAL-PROCESS         VALUE ' '.
  1938         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1939         88  ADJUST-UP-100-YRS          VALUE '2'.
  1940     12  FILLER                        PIC X.
  1941     12  DC-CONVERSION-DATES.
  1942         16  DC-BIN-DATE-1             PIC XX.
  1943         16  DC-BIN-DATE-2             PIC XX.
  1944         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1945         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1946                       DC-GREG-DATE-1-EDIT.
  1947             20  DC-EDIT1-MONTH        PIC 99.
  1948             20  SLASH1-1              PIC X.
  1949             20  DC-EDIT1-DAY          PIC 99.
  1950             20  SLASH1-2              PIC X.
  1951             20  DC-EDIT1-YEAR         PIC 99.
  1952         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1953         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1954                     DC-GREG-DATE-2-EDIT.
  1955             20  DC-EDIT2-MONTH        PIC 99.
  1956             20  SLASH2-1              PIC X.
  1957             20  DC-EDIT2-DAY          PIC 99.
  1958             20  SLASH2-2              PIC X.
  1959             20  DC-EDIT2-YEAR         PIC 99.
  1960         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1961         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1962                     DC-GREG-DATE-1-YMD.
  1963             20  DC-YMD-YEAR           PIC 99.
  1964             20  DC-YMD-MONTH          PIC 99.
  1965             20  DC-YMD-DAY            PIC 99.
  1966         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1967         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1968                      DC-GREG-DATE-1-MDY.
  1969             20  DC-MDY-MONTH          PIC 99.
  1970             20  DC-MDY-DAY            PIC 99.
  1971             20  DC-MDY-YEAR           PIC 99.
  1972         16  DC-GREG-DATE-1-ALPHA.
  1973             20  DC-ALPHA-MONTH        PIC X(10).
  1974             20  DC-ALPHA-DAY          PIC 99.
  1975             20  FILLER                PIC XX.
  1976             20  DC-ALPHA-CENTURY.
  1977                 24 DC-ALPHA-CEN-N     PIC 99.
  1978             20  DC-ALPHA-YEAR         PIC 99.
  1979         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1980         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1981         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1982         16  DC-JULIAN-DATE            PIC 9(05).
  1983         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  38
* EL6311.cbl
  1984                                       PIC 9(05).
  1985         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1986             20  DC-JULIAN-YEAR        PIC 99.
  1987             20  DC-JULIAN-DAYS        PIC 999.
  1988         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1989         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1990         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1991     12  DATE-CONVERSION-VARIBLES.
  1992         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1993         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1994             20  FILLER                PIC 9(3).
  1995             20  HOLD-CEN-1-CCYY.
  1996                 24  HOLD-CEN-1-CC     PIC 99.
  1997                 24  HOLD-CEN-1-YY     PIC 99.
  1998             20  HOLD-CEN-1-MO         PIC 99.
  1999             20  HOLD-CEN-1-DA         PIC 99.
  2000         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2001             20  HOLD-CEN-1-R-MO       PIC 99.
  2002             20  HOLD-CEN-1-R-DA       PIC 99.
  2003             20  HOLD-CEN-1-R-CCYY.
  2004                 24  HOLD-CEN-1-R-CC   PIC 99.
  2005                 24  HOLD-CEN-1-R-YY   PIC 99.
  2006             20  FILLER                PIC 9(3).
  2007         16  HOLD-CENTURY-1-X.
  2008             20  FILLER                PIC X(3)  VALUE SPACES.
  2009             20  HOLD-CEN-1-X-CCYY.
  2010                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2011                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2012             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2013             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2014         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2015             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2016             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2017             20  HOLD-CEN-1-R-X-CCYY.
  2018                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2019                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2020             20  FILLER                PIC XXX.
  2021         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2022         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2023         16  DC-JULIAN-DATE-1          PIC 9(07).
  2024         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2025             20  DC-JULIAN-1-CCYY.
  2026                 24  DC-JULIAN-1-CC    PIC 99.
  2027                 24  DC-JULIAN-1-YR    PIC 99.
  2028             20  DC-JULIAN-DA-1        PIC 999.
  2029         16  DC-JULIAN-DATE-2          PIC 9(07).
  2030         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2031             20  DC-JULIAN-2-CCYY.
  2032                 24  DC-JULIAN-2-CC    PIC 99.
  2033                 24  DC-JULIAN-2-YR    PIC 99.
  2034             20  DC-JULIAN-DA-2        PIC 999.
  2035         16  DC-GREG-DATE-A-EDIT.
  2036             20  DC-EDITA-MONTH        PIC 99.
  2037             20  SLASHA-1              PIC X VALUE '/'.
  2038             20  DC-EDITA-DAY          PIC 99.
  2039             20  SLASHA-2              PIC X VALUE '/'.
  2040             20  DC-EDITA-CCYY.
  2041                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  39
* EL6311.cbl
  2042                 24  DC-EDITA-YEAR     PIC 99.
  2043         16  DC-GREG-DATE-B-EDIT.
  2044             20  DC-EDITB-MONTH        PIC 99.
  2045             20  SLASHB-1              PIC X VALUE '/'.
  2046             20  DC-EDITB-DAY          PIC 99.
  2047             20  SLASHB-2              PIC X VALUE '/'.
  2048             20  DC-EDITB-CCYY.
  2049                 24  DC-EDITB-CENT     PIC 99.
  2050                 24  DC-EDITB-YEAR     PIC 99.
  2051         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2052         16  DC-GREG-DATE-CYMD-R REDEFINES
  2053                              DC-GREG-DATE-CYMD.
  2054             20  DC-CYMD-CEN           PIC 99.
  2055             20  DC-CYMD-YEAR          PIC 99.
  2056             20  DC-CYMD-MONTH         PIC 99.
  2057             20  DC-CYMD-DAY           PIC 99.
  2058         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2059         16  DC-GREG-DATE-MDCY-R REDEFINES
  2060                              DC-GREG-DATE-MDCY.
  2061             20  DC-MDCY-MONTH         PIC 99.
  2062             20  DC-MDCY-DAY           PIC 99.
  2063             20  DC-MDCY-CEN           PIC 99.
  2064             20  DC-MDCY-YEAR          PIC 99.
  2065    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2066        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2067    12  DC-EL310-DATE                  PIC X(21).
  2068    12  FILLER                         PIC X(28).
  2069
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  40
* EL6311.cbl
  2071*    COPY ELCLOGOF.
  2072******************************************************************
  2073*                                                                *
  2074*                                                                *
  2075*                            ELCLOGOF.                           *
  2076*                            VMOD=2.001                          *
  2077*                                                                *
  2078*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2079*                                                                *
  2080******************************************************************
  2081 01  CLASIC-LOGOFF.
  2082     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2083     12  LOGOFF-TEXT.
  2084         16  FILLER          PIC X(5)    VALUE SPACES.
  2085         16  LOGOFF-MSG.
  2086             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2087             20  FILLER      PIC X       VALUE SPACES.
  2088             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2089         16  FILLER          PIC X(80)
  2090           VALUE '* YOU ARE NOW LOGGED OFF'.
  2091         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2092         16  FILLER          PIC X       VALUE QUOTE.
  2093         16  LOGOFF-SYS-MSG  PIC X(17)
  2094           VALUE 'S CLAS-IC SYSTEM '.
  2095     12  TEXT-MESSAGES.
  2096         16  UNACCESS-MSG    PIC X(29)
  2097             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2098         16  PGMIDERR-MSG    PIC X(17)
  2099             VALUE 'PROGRAM NOT FOUND'.
  2100
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  41
* EL6311.cbl
  2102*    COPY ELCATTR.
  2103******************************************************************
  2104*                                                                *
  2105*                            ELCATTR.                            *
  2106*                            VMOD=2.001                          *
  2107*                                                                *
  2108*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2109*                                                                *
  2110*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2111*                                                                *
  2112*                   POS 1   P=PROTECTED                          *
  2113*                           U=UNPROTECTED                        *
  2114*                           S=ASKIP                              *
  2115*                   POS 2   A=ALPHA/NUMERIC                      *
  2116*                           N=NUMERIC                            *
  2117*                   POS 3   N=NORMAL                             *
  2118*                           B=BRIGHT                             *
  2119*                           D=DARK                               *
  2120*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2121*                           OF=MODIFIED DATA TAG OFF             *
  2122*                                                                *
  2123*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2124******************************************************************
  2125 01  ATTRIBUTE-LIST.
  2126     12  AL-PABOF            PIC X       VALUE 'Y'.
  2127     12  AL-PABON            PIC X       VALUE 'Z'.
  2128     12  AL-PADOF            PIC X       VALUE '%'.
  2129     12  AL-PADON            PIC X       VALUE '_'.
  2130     12  AL-PANOF            PIC X       VALUE '-'.
  2131     12  AL-PANON            PIC X       VALUE '/'.
  2132     12  AL-SABOF            PIC X       VALUE '8'.
  2133     12  AL-SABON            PIC X       VALUE '9'.
  2134     12  AL-SADOF            PIC X       VALUE '@'.
  2135     12  AL-SADON            PIC X       VALUE QUOTE.
  2136     12  AL-SANOF            PIC X       VALUE '0'.
  2137     12  AL-SANON            PIC X       VALUE '1'.
  2138     12  AL-UABOF            PIC X       VALUE 'H'.
  2139     12  AL-UABON            PIC X       VALUE 'I'.
  2140     12  AL-UADOF            PIC X       VALUE '<'.
  2141     12  AL-UADON            PIC X       VALUE '('.
  2142     12  AL-UANOF            PIC X       VALUE ' '.
  2143     12  AL-UANON            PIC X       VALUE 'A'.
  2144     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2145     12  AL-UNBON            PIC X       VALUE 'R'.
  2146     12  AL-UNDOF            PIC X       VALUE '*'.
  2147     12  AL-UNDON            PIC X       VALUE ')'.
  2148     12  AL-UNNOF            PIC X       VALUE '&'.
  2149     12  AL-UNNON            PIC X       VALUE 'J'.
  2150
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  42
* EL6311.cbl
  2152*    COPY ELCEMIB.
  2153******************************************************************
  2154*                                                                *
  2155*                                                                *
  2156*                            ELCEMIB.                            *
  2157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2158*                            VMOD=2.005                          *
  2159*                                                                *
  2160*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2161*                                                                *
  2162******************************************************************
  2163 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2164     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2165     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2166     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2167     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2168     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2169     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2170     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2171     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2172     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2173         88  EMI-NO-ERRORS                    VALUE '1'.
  2174         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2175         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2176     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2177         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2178     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2179         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2180         88  EMI-AREA1-FULL                   VALUE '2'.
  2181     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2182         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2183         88  EMI-AREA2-FULL                   VALUE '2'.
  2184     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2185         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2186         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2187         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2188         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2189         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2190     12  EMI-ERROR-LINES.
  2191         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2192         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2193         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2194         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2195             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2196                 24  EMI-ERR-NUM         PIC X(4).
  2197                 24  EMI-FILLER          PIC X.
  2198                 24  EMI-SEV             PIC X.
  2199                 24  FILLER              PIC X.
  2200             20  FILLER                  PIC X(02).
  2201     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2202         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2203             20  EMI-ERROR-NUMBER    PIC X(4).
  2204             20  EMI-FILL            PIC X.
  2205             20  EMI-SEVERITY        PIC X.
  2206             20  FILLER              PIC X.
  2207             20  EMI-ERROR-TEXT.
  2208                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2209                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  43
* EL6311.cbl
  2210     12  EMI-SEVERITY-SAVE           PIC X.
  2211         88  EMI-NOTE                    VALUE 'N'.
  2212         88  EMI-WARNING                 VALUE 'W'.
  2213         88  EMI-FORCABLE                VALUE 'F'.
  2214         88  EMI-FATAL                   VALUE 'X'.
  2215     12  EMI-MESSAGE-FLAG            PIC X.
  2216         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2217         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2218     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2219     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2220         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2221         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2222         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2223     12  emi-claim-no                pic x(7).
  2224     12  emi-claim-type              pic x(6).
  2225     12  FILLER                      PIC X(124)  VALUE SPACES.
  2226     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2227     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2228     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2229     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2230
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  44
* EL6311.cbl
  2232*    COPY ELCINTF.
  2233******************************************************************
  2234*                                                                *
  2235*                                                                *
  2236*                            ELCINTF.                            *
  2237*                            VMOD=2.017                          *
  2238*                                                                *
  2239*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2240*                                                                *
  2241*       LENGTH = 1024                                            *
  2242*                                                                *
  2243******************************************************************
  2244*                   C H A N G E   L O G
  2245*
  2246* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2247*-----------------------------------------------------------------
  2248*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2249* EFFECTIVE    NUMBER
  2250*-----------------------------------------------------------------
  2251* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2252******************************************************************
  2253 01  PROGRAM-INTERFACE-BLOCK.
  2254     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2255     12  PI-CALLING-PROGRAM              PIC X(8).
  2256     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2257     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2258     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2259     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2260     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2261     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2262     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2263     12  PI-COMPANY-ID                   PIC XXX.
  2264     12  PI-COMPANY-CD                   PIC X.
  2265
  2266     12  PI-COMPANY-PASSWORD             PIC X(8).
  2267
  2268     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2269
  2270     12  PI-CONTROL-IN-PROGRESS.
  2271         16  PI-CARRIER                  PIC X.
  2272         16  PI-GROUPING                 PIC X(6).
  2273         16  PI-STATE                    PIC XX.
  2274         16  PI-ACCOUNT                  PIC X(10).
  2275         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2276                                         PIC X(10).
  2277         16  PI-CLAIM-CERT-GRP.
  2278             20  PI-CLAIM-NO             PIC X(7).
  2279             20  PI-CERT-NO.
  2280                 25  PI-CERT-PRIME       PIC X(10).
  2281                 25  PI-CERT-SFX         PIC X.
  2282             20  PI-CERT-EFF-DT          PIC XX.
  2283         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2284             20  PI-PLAN-CODE            PIC X(2).
  2285             20  PI-REVISION-NUMBER      PIC X(3).
  2286             20  PI-PLAN-EFF-DT          PIC X(2).
  2287             20  PI-PLAN-EXP-DT          PIC X(2).
  2288             20  FILLER                  PIC X(11).
  2289         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  45
* EL6311.cbl
  2290             20  PI-OE-REFERENCE-1.
  2291                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2292                 25  PI-OE-REF-1-SUFF    PIC XX.
  2293
  2294     12  PI-SESSION-IN-PROGRESS          PIC X.
  2295         88  CLAIM-SESSION                   VALUE '1'.
  2296         88  CREDIT-SESSION                  VALUE '2'.
  2297         88  WARRANTY-SESSION                VALUE '3'.
  2298         88  MORTGAGE-SESSION                VALUE '4'.
  2299         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2300
  2301
  2302*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2303
  2304     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2305     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2306
  2307     12  PI-CREDIT-USER                  PIC X.
  2308         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2309         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2310
  2311     12  PI-CLAIM-USER                   PIC X.
  2312         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2313         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2314
  2315     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2316         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2317         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2318         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2319         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2320         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2321
  2322     12  PI-PROCESSOR-ID                 PIC X(4).
  2323
  2324     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2325
  2326     12  PI-MEMBER-CAPTION               PIC X(10).
  2327
  2328     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2329         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2330
  2331     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2332     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2333     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2334     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2335
  2336     12  PI-AH-OVERRIDE-L1               PIC X.
  2337     12  PI-AH-OVERRIDE-L2               PIC XX.
  2338     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2339     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2340
  2341     12  PI-NEW-SYSTEM                   PIC X(2).
  2342
  2343     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2344     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2345         88  PI-USES-PAID-TO                 VALUE '1'.
  2346     12  PI-CRDTCRD-SYSTEM.
  2347         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  46
* EL6311.cbl
  2348             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2349             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2350         16  PI-CC-MONTH-END-DT          PIC XX.
  2351     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2352
  2353     12  PI-OE-REFERENCE-2.
  2354         16  PI-OE-REF-2-PRIME           PIC X(10).
  2355         16  PI-OE-REF-2-SUFF            PIC X.
  2356
  2357     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2358
  2359     12  PI-LANGUAGE-TYPE                PIC X.
  2360             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2361             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2362             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2363
  2364     12  PI-POLICY-LINKAGE-IND           PIC X.
  2365         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2366         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2367                                                   LOW-VALUES.
  2368
  2369     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2370     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2371         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2372         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2373
  2374     12  PI-PROCESSOR-CSR-IND            PIC X.
  2375         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2376         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2377
  2378     12  FILLER                          PIC X(3).
  2379
  2380     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2381
  2382     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2383         PI-SYSTEM-LEVEL.
  2384
  2385         16  PI-ENTRY-CODES.
  2386             20  PI-ENTRY-CD-1           PIC X.
  2387             20  PI-ENTRY-CD-2           PIC X.
  2388
  2389         16  PI-RETURN-CODES.
  2390             20  PI-RETURN-CD-1          PIC X.
  2391             20  PI-RETURN-CD-2          PIC X.
  2392
  2393         16  PI-UPDATE-STATUS-SAVE.
  2394             20  PI-UPDATE-BY            PIC X(4).
  2395             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2396
  2397         16  PI-LOWER-CASE-LETTERS       PIC X.
  2398             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2399
  2400*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2401*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2402*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2403
  2404         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2405             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  47
* EL6311.cbl
  2406             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2407             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2408             88  ACCNT-CNTL                  VALUE '3'.
  2409             88  CARR-ACCNT-CNTL             VALUE '4'.
  2410
  2411         16  PI-PROCESSOR-CAP-LIST.
  2412             20  PI-SYSTEM-CONTROLS.
  2413                24 PI-SYSTEM-DISPLAY     PIC X.
  2414                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2415                24 PI-SYSTEM-MODIFY      PIC X.
  2416                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2417             20  FILLER                  PIC XX.
  2418             20  PI-DISPLAY-CAP          PIC X.
  2419                 88  DISPLAY-CAP             VALUE 'Y'.
  2420             20  PI-MODIFY-CAP           PIC X.
  2421                 88  MODIFY-CAP              VALUE 'Y'.
  2422             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2423                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2424             20  PI-FORCE-CAP            PIC X.
  2425                 88  FORCE-CAP               VALUE 'Y'.
  2426
  2427         16  PI-PROGRAM-CONTROLS.
  2428             20  PI-PGM-PRINT-OPT        PIC X.
  2429             20  PI-PGM-FORMAT-OPT       PIC X.
  2430             20  PI-PGM-PROCESS-OPT      PIC X.
  2431             20  PI-PGM-TOTALS-OPT       PIC X.
  2432
  2433         16  PI-HELP-INTERFACE.
  2434             20  PI-LAST-ERROR-NO        PIC X(4).
  2435             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2436
  2437         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2438             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2439
  2440         16  PI-CR-CONTROL-IN-PROGRESS.
  2441             20  PI-CR-CARRIER           PIC X.
  2442             20  PI-CR-GROUPING          PIC X(6).
  2443             20  PI-CR-STATE             PIC XX.
  2444             20  PI-CR-ACCOUNT           PIC X(10).
  2445             20  PI-CR-FIN-RESP          PIC X(10).
  2446             20  PI-CR-TYPE              PIC X.
  2447
  2448         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2449
  2450         16  PI-CR-MONTH-END-DT          PIC XX.
  2451
  2452         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2453             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2454             88  PI-ZERO-CARRIER             VALUE '1'.
  2455             88  PI-ZERO-GROUPING            VALUE '2'.
  2456             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2457
  2458         16  PI-CARRIER-SECURITY         PIC X.
  2459             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2460
  2461         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2462             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2463             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  48
* EL6311.cbl
  2464
  2465         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2466             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2467                                         INDEXED BY PI-ACCESS-NDX
  2468                                         PIC X.
  2469
  2470         16  PI-GA-BILLING-CONTROL       PIC X.
  2471             88  PI-GA-BILLING               VALUE '1'.
  2472
  2473         16  PI-MAIL-PROCESSING          PIC X.
  2474             88  PI-MAIL-YES                 VALUE 'Y'.
  2475
  2476         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2477
  2478         16  PI-AR-SYSTEM.
  2479             20  PI-AR-PROCESSING-CNTL   PIC X.
  2480                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2481             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2482             20  PI-AR-MONTH-END-DT      PIC XX.
  2483
  2484         16  PI-MP-SYSTEM.
  2485             20  PI-MORTGAGE-USER            PIC X.
  2486                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2487                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2488             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2489                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2490                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2491                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2492                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2493                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2494             20  PI-MP-MONTH-END-DT          PIC XX.
  2495             20  PI-MP-REFERENCE-NO.
  2496                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2497                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2498
  2499         16  PI-LABEL-CONTROL            PIC X(01).
  2500             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2501             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2502
  2503         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2504             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2505
  2506         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2507             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2508             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2509
  2510         16  FILLER                      PIC X(14).
  2511
  2512     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2513******************************************************************
  2514
  2515     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2516*    COPY ELC631PI.
  2517******************************************************************
  2518*                                                                *
  2519*                                                                *
  2520*                            ELC631PI                            *
  2521*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  49
* EL6311.cbl
  2522*                                                                *
  2523*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2524*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2525*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2526*                                                                *
  2527*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2528*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2529*    BETWEEN PROGRAMS.                                           *
  2530*                                                                *
  2531*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2532*                                                                *
  2533*               EL631 - EL6311 - EL6312 - EL6313                 *
  2534*                                                                *
  2535******************************************************************
  2536*                   C H A N G E   L O G
  2537*
  2538* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2539*-----------------------------------------------------------------
  2540*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2541* EFFECTIVE    NUMBER
  2542*-----------------------------------------------------------------
  2543* 021414    2003053000001  PEMA  changes for auto chk request
  2544******************************************************************
  2545
  2546         16  PI-631-DATA.
  2547             20  PI-ERPNDB-KEY.
  2548                 24  PI-PB-COMPANY-CD     PIC X.
  2549                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2550                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2551                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2552
  2553             20  PI-ERPNDB-ALT-KEY.
  2554                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2555                 24  PI-PB-CARRIER        PIC X.
  2556                 24  PI-PB-GROUPING       PIC X(6).
  2557                 24  PI-PB-STATE          PIC XX.
  2558                 24  PI-PB-ACCOUNT        PIC X(10).
  2559                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2560                 24  PI-PB-CERT-NO.
  2561                     28  PI-PB-CERT-PRIME PIC X(10).
  2562                     28  PI-PB-CERT-SFX   PIC X.
  2563                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2564                 24  PI-PB-RECORD-TYPE    PIC X.
  2565
  2566             20  PI-ERPNDB-CSR-KEY.
  2567                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2568                 24  PI-PB-CSR-ID             PIC X(4).
  2569                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2570                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2571                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2572
  2573             20  PI-BROWSE-TYPE               PIC X.
  2574                 88  PI-FILE-BROWSE             VALUE ' '.
  2575                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2576                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2577                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2578                 88  PI-CSR-BROWSE              VALUE '4'.
  2579
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  50
* EL6311.cbl
  2580             20  PI-MAINT-FUNCTION            PIC X.
  2581                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2582                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2583                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2584                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2585                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2586                 88  PI-PF5-FUNCTION            VALUE '5'.
  2587                 88  PI-PF6-FUNCTION            VALUE '6'.
  2588
  2589             20  PI-FILE-SWITCHES.
  2590                 24  PI-ALL-ISSUES-SW         PIC X.
  2591                     88  ALL-ISSUES             VALUE 'Y'.
  2592                 24  PI-ALL-CANCELS-SW        PIC X.
  2593                     88  ALL-CANCELS            VALUE 'Y'.
  2594                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2595                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2596                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2597                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2598                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2599                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2600                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2601                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2602                 24  PI-HOLD-REC-SW           PIC X.
  2603                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2604                 24  PI-CHANGE-REC-SW         PIC X.
  2605                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2606                 24  PI-CHK-REQ-REC-SW        PIC X.
  2607                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2608                 24  PI-ISSUE-WARNING-SW      PIC X.
  2609                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2610                 24  PI-CANCEL-WARNING-SW     PIC X.
  2611                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2612             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2613                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2614             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2615                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2616
  2617             20  PI-MAP-NAME                  PIC X(8).
  2618
  2619             20  PI-CURSOR                    PIC S9(4) COMP.
  2620
  2621             20  PI-PREV-ALT-KEY              PIC X(36).
  2622             20  PI-PREV-CSR-KEY              PIC X(15).
  2623             20  PI-PREV-KEY.
  2624                 24  PI-PREV-COMPANY-CD       PIC X.
  2625                 24  PI-PREV-BATCH            PIC X(6).
  2626                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2627                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2628             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2629             20  PI-BROWSE-SW                 PIC X.
  2630                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2631                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2632             20  PI-SV-CARRIER                PIC X.
  2633             20  PI-SV-GROUPING               PIC X(6).
  2634             20  PI-SV-STATE                  PIC XX.
  2635             20  PI-EDIT-SW                   PIC X.
  2636             20  PI-DISPLAY-SW                PIC XX.
  2637                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  51
* EL6311.cbl
  2638                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2639             20  PI-CRITERIA-DATA             PIC X(350).
  2640             20  PI-BMODE                     PIC X.
  2641             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2642             20  PI-BPMTS                     PIC S999     COMP-3.
  2643             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2644             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2645             20  PI-CSR-SESSION-SW            PIC X.
  2646                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2647             20  PI-ERRORS-SW                 PIC X.
  2648                 88  FATAL-ERRORS               VALUE 'X'.
  2649*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2650             20  pi-unforced-sw               pic x.
  2651                 88  unforced-errors            value 'X'.
  2652             20  FILLER                       PIC X(4).
  2653
  2654        16  FILLER             PIC X(94).
  2655
  2656 01  W-LETTER-COMMUNICATION-AREAS.
  2657*    COPY ELC1042.
  2658******************************************************************
  2659*                                                                *
  2660*                                                                *
  2661*                           ELC1042                              *
  2662*                            VMOD=2.002                          *
  2663*                                                                *
  2664*    NOTE                                                        *
  2665*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2666*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2667*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2668*        TO THESE PROGRAMS.                                      *
  2669*                                                                *
  2670*    NOTE                                                        *
  2671*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2672*        USE ONLY!                                               *
  2673*                                                                *
  2674******************************************************************
  2675
  2676         16  PI-1042-WA.
  2677             20  PI-ACTION       PIC  X(01).
  2678                 88 PI-SHOW-MODE           VALUE '1'.
  2679                 88 PI-CLEAR-MODE          VALUE '2'.
  2680                 88 PI-CREATE-MODE         VALUE '3'.
  2681             20  PI-COMM-CONTROL PIC  X(12).
  2682             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2683             20  PI-EOF-SW       PIC  X(01).
  2684                 88  PI-FILE-EOF           VALUE 'Y'.
  2685             20  PI-FILETYP      PIC  X(01).
  2686             20  PI-FORM-SQUEEZE-CONTROL
  2687                                 PIC  X(01).
  2688                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2689                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2690             20  PI-LAST-CONTROL PIC  X(12).
  2691             20  PI-TEMP-STOR-ITEMS
  2692                                 PIC S9(04) COMP.
  2693             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2694             20  PI-UPDATE-SW    PIC  9(01).
  2695                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  52
* EL6311.cbl
  2696             20  PI-104-SCREEN-SENT-IND
  2697                                 PIC  X(01).
  2698                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2699                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2700             20  PI-1042-SCREEN-SENT-IND
  2701                                 PIC  X(01).
  2702                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2703                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2704             20  PI-1042-ARCHIVE-IND
  2705                                 PIC  X(01).
  2706                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2707             20  FILLER          PIC  X(29).
  2708*    COPY ELC689PI.
  2709******************************************************************
  2710*                                                                *
  2711*                            ELC689PI                            *
  2712*                            VMOD=2.003                          *
  2713*                                                                *
  2714*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2715*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2716*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2717*                                                                *
  2718*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2719*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2720*    BETWEEN PROGRAMS.                                           *
  2721*                                                                *
  2722*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2723*                                                                *
  2724*               EL631 - EL689  - EL6891 - EL6892                 *
  2725*                                                                *
  2726******************************************************************
  2727*                   C H A N G E   L O G
  2728*
  2729* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2730*-----------------------------------------------------------------
  2731*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2732* EFFECTIVE    NUMBER
  2733*-----------------------------------------------------------------
  2734* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2735* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2736* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2737******************************************************************
  2738
  2739
  2740         16  PI-689-WORK-AREA.
  2741             20  PI-689-ALT-PRINTER-ID
  2742                                 PIC  X(04).
  2743             20  PI-689-ARCHIVE-NUMBER
  2744                                 PIC  9(08).
  2745             20  PI-689-ARCHIVE-SW
  2746                                 PIC  X(01).
  2747                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2748             20  PI-689-DATA-SOURCE
  2749                                 PIC  X(01).
  2750                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2751                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2752                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2753                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  53
* EL6311.cbl
  2754                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2755             20  PI-689-ERROR-IND
  2756                                 PIC  X(01).
  2757                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2758             20  PI-689-ERROR    PIC  9(04).
  2759                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2760                 88  PI-689-FATAL-ERROR
  2761                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2762                            0042 0047 0051 0066 0067 0070
  2763                            0168 0169 0174 0175 0176 0177 0179
  2764                            0180 0181 0182 0184 0185 0189 0190
  2765                            0191
  2766                            0215 0279 0280
  2767                            0412 0413 0454
  2768                            0533 0537
  2769                            2055 2114 2208 2209 2216 2232 2369
  2770                            2398 2433 2908 2999
  2771                            3000 3770 3771 3775
  2772                            7250 7365 7367 7368 7369 7370 7371
  2773                            7272 7373 7374 7376 7377 7378 7379
  2774                            7381 7388 7390 7393 7395 7396 7398
  2775                            9095 9096 9281 9298 9299 9320 9327
  2776                            9426 9427.
  2777                 88  PI-689-STOP-ERROR
  2778                     VALUES 0004 0008 0013 0023 0029 0033
  2779                            0042 0047 0066 0067 0070
  2780                            0168 0169 0174 0175 0176 0177
  2781                            0181 0182 0184 0185 0189 0190
  2782                            0279 0280
  2783                            0412 0413 0454
  2784                            2055 2208 2209 2216 2232
  2785                            2398 2999
  2786                            3000 3770 3771 3775
  2787                            7250 7365 7369 7370 7371
  2788                            7272 7373 7374 7376 7377 7378 7379
  2789                            7381 7388 7390 7393 7396 7398
  2790                            9095 9096 9299 9320 9426.
  2791             20  PI-689-FOLLOW-UP-DATE
  2792                                 PIC  X(02).
  2793             20  PI-689-FORM-NUMBER
  2794                                 PIC  X(04).
  2795             20  PI-689-LABEL-SOURCE
  2796                                 PIC X(01).
  2797                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2798                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2799                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2800                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2801                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2802                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2803                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2804             20  PI-689-NUMBER-COPIES
  2805                                 PIC  9(01).
  2806             20  PI-689-NUMBER-LABEL-LINES
  2807                                 PIC  9(01).
  2808             20  PI-689-NUMBER-TEXT-RECORDS
  2809                                 PIC  9(03).
  2810             20  PI-689-PRINT-ORDER-SW
  2811                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  54
* EL6311.cbl
  2812                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2813                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2814                 88  PI-689-PRINT-LATER     VALUE '3'.
  2815                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2816             20  PI-689-PRINT-RESTRICTION
  2817                                 PIC  X(01).
  2818                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2819                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2820                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2821             20  PI-689-PRINT-SW PIC  X(01).
  2822                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2823             20  PI-689-RESEND-DATE-1
  2824                                 PIC  X(02).
  2825             20  PI-689-RESEND-LETR-1
  2826                                 PIC X(4).
  2827             20  PI-689-TEMP-STOR-ID
  2828                                 PIC  X(08).
  2829             20  PI-689-USE-SCREEN-IND
  2830                                 PIC  X(01).
  2831                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2832             20  PI-689-ARCH-POINTER
  2833                                 PIC S9(08) COMP.
  2834                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2835             20  PI-689-ARCT-POINTER
  2836                                 PIC S9(08) COMP.
  2837                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2838             20  PI-689-VARIABLE-DATA-GRP.
  2839                 24  PI-689-VARIABLE-DATA-1
  2840                                 PIC  X(30).
  2841                 24  PI-689-VARIABLE-DATA-2
  2842                                 PIC  X(30).
  2843                 24  PI-689-VARIABLE-DATA-3
  2844                                 PIC  X(30).
  2845                 24  PI-689-VARIABLE-DATA-4
  2846                                 PIC  X(30).
  2847
  2848         16  PI-689-KEY-DATA-FIELDS.
  2849             20  PI-689-ACCOUNT  PIC  X(10).
  2850             20  PI-689-CARRIER  PIC  X(01).
  2851             20  PI-689-CERT-NO.
  2852                 24  PI-689-CERT-PRIME
  2853                                 PIC  X(10).
  2854                 24  PI-689-CERT-SFX
  2855                                 PIC  X(01).
  2856             20  PI-689-CHG-SEQ-NO
  2857                                 PIC S9(04)    COMP.
  2858             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2859                                 PIC  X(02).
  2860             20  PI-689-ENTRY-BATCH
  2861                                 PIC  X(06).
  2862             20  PI-689-EFF-DATE PIC  X(02).
  2863             20  PI-689-EXP-DATE PIC  X(02).
  2864             20  PI-689-GROUPING PIC  X(06).
  2865             20  PI-689-RESP-PERSON
  2866                                 PIC  X(10).
  2867             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2868             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2869                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  55
* EL6311.cbl
  2870             20  PI-689-STATE    PIC  X(02).
  2871             20  PI-689-TYPE     PIC  X(01).
  2872             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2873             20  PI-689-ALT-SEQ-NO
  2874                                 PIC S9(04)    COMP.
  2875         16  PI-689-DATE-EDIT    PIC  X(08).
  2876         16  PI-689-FOLLOW-UP-EDIT
  2877                                 PIC  X(08).
  2878         16  PI-689-RESEND1-EDIT PIC  X(08).
  2879         16  PI-689-SEQ-EDIT     PIC  X(08).
  2880         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2881         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2882             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2883         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2884         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  56
* EL6311.cbl
  2886
  2887 01  WS-EL6315-PASS-AREA.
  2888        16  PI-6315-ISS-CAN-SW      PIC X.
  2889        16  FILLER                  PIC X(120).
  2890        16  PI-RES-REF-CLM-TYPE     PIC X.
  2891        16  FILLER                  PIC X.
  2892        16  PI-6315-PASS-AREA.
  2893            20 FILLER               PIC X(236).
  2894            20 PI-6315-FINALIZED    PIC X.
  2895            20 FILLER               PIC X(280).
  2896
  2897 01  WS-EL6316-PASS-AREA.
  2898        16  PI-ISS-CAN-SW           PIC X.
  2899        16  FILLER                  PIC X(121).
  2900        16  PI-CLM-RESC-IND         PIC X.
  2901        16  PI-6316-PASS-AREA.
  2902            20 FILLER               PIC X(236).
  2903            20 PI-6316-FINALIZED    PIC X.
  2904            20 FILLER               PIC X(280).
  2905
  2906******************************************************************
  2907*                                                                *
  2908*         P A S S   A R E A   F O R   E D I T                    *
  2909*                                                                *
  2910******************************************************************
  2911
  2912 01  PASSED-RECORD.
  2913     12  RECORD-SAVE                  PIC X(585).
  2914* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2915*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2916*                    BY  WK-CURRENT-DATE.
  2917******************************************************************
  2918*                                                                *
  2919*                                                                *
  2920*                             ELC50W1                            *
  2921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2922*                            VMOD=2.004                          *
  2923*                                                                *
  2924*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2925*                                                                *
  2926*                                                                *
  2927******************************************************************
  2928
  2929     12  WK-WORK-AREA.
  2930         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2931         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2932         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2933         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2934         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2935         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2936         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2937         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2938         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2939         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2940         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2941         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2942         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2943         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  57
* EL6311.cbl
  2944         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2945         16  WK-CREDIT-EDIT-CONTROLS.
  2946             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2947             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2948             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2949             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2950             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2951             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2952         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2953         16  WK-SAVE-REIN-DATA.
  2954             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2955             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2956             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2957         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2958             88  ENTRY-FROM-EL6311       VALUE '6'.
  2959         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2960         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2961     12  WK-RECORD-ADDRESSES.
  2962         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2963         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2964         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2965         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2966         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2967         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2968         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2969         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2970     12  WK-OVER-SHORT-AREA.
  2971         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2972         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2973         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2974             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2975         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  58
* EL6311.cbl
  2977
  2978*    COPY ELCEDITC.
  2979******************************************************************
  2980*                                                                *
  2981*                                                                *
  2982*                            ELCEDITC                            *
  2983*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2984*                            VMOD=2.012                          *
  2985*                                                                *
  2986*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2987*                     EL6313, EL050 AND EL517.                   *
  2988*                                                                *
  2989******************************************************************
  2990******************************************************************
  2991*                   C H A N G E   L O G
  2992*
  2993* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2994*-----------------------------------------------------------------
  2995*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2996* EFFECTIVE    NUMBER
  2997*-----------------------------------------------------------------
  2998* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2999******************************************************************
  3000
  3001     12  EDIT-CRITERIA-DATA.
  3002         16  EC-CO-MONTH-END-DT       PIC XX.
  3003         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3004         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3005         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3006         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3007         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3008         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3009         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3010         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3011         16  EC-CO-REM-TERM-CALC      PIC X.
  3012               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3013               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3014               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3015               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3016
  3017         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3018               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3019               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3020               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3021               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3022               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3023               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3024               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3025               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3026               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3027               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3028
  3029         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3030               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3031               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3032               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3033               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3034               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  59
* EL6311.cbl
  3035               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3036               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3037               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3038
  3039         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3040                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3041                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3042
  3043         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3044                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3045                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3046                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3047                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3048                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3049                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3050                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3051                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3052
  3053         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3054               88  EC-BR-REDUCING                   VALUE 'R'.
  3055               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3056
  3057         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3058         16  EC-BR-LF-DESC             PIC X(10).
  3059         16  EC-BR-AH-DESC             PIC X(10).
  3060         16  EC-BR-LF-COMMENT          PIC X(10).
  3061         16  EC-BR-AH-COMMENT          PIC X(10).
  3062
  3063         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3064               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3065               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3066               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3067               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3068
  3069         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3070               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3071               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3072               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3073               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3074
  3075         16  EC-BR-LF-REFUND-CALC      PIC X.
  3076                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3077                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3078                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3079                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3080                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3081                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3082                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3083
  3084         16  EC-BR-AH-REFUND-CALC      PIC X.
  3085                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3086                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3087                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3088                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3089                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3090                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3091                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3092                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  60
* EL6311.cbl
  3093
  3094         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3095                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3096                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3097                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3098
  3099         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3100                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3101                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3102                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3103
  3104         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3105         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3106         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3107         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3108
  3109         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3110         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3111                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3112                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3113                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3114                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3115
  3116         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3117               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3118               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3119               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3120               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3121               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3122
  3123         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3124               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3125               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3126               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3127               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3128               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3129
  3130         16  EC-ST-LF-REFUND-CALC      PIC X.
  3131                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3132                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3133                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3134                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3135                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3136                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3137                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3138                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3139
  3140         16  EC-ST-AH-REFUND-CALC      PIC X.
  3141                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3142                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3143                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3144                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3145                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3146                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3147                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3148                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3149
  3150         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  61
* EL6311.cbl
  3151         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3152         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3153         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3154         16  EC-AM-EXPIRATION-DT       PIC XX.
  3155         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3156         16  EC-AM-CLASS-CD            PIC XX.
  3157         16  EC-AM-LF-DEVIATION        PIC XXX.
  3158         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3159         16  EC-AM-AH-DEVIATION        PIC XXX.
  3160         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3161         16  EC-AM-PHONE-NO            PIC X(10).
  3162
  3163         16  EC-AM-LF-REFUND-CALC      PIC X.
  3164                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3165                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3166                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3167                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3168                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3169                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3170                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3171
  3172         16  EC-AM-AH-REFUND-CALC      PIC X.
  3173                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3174                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3175                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3176                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3177                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3178                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3179                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3180
  3181         16  EC-AM-BEN-I-G-CD          PIC X.
  3182                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3183                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3184                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3185
  3186         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3187         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3188         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3189         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3190         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3191         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3192         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3193         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3194         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3195
  3196         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3197         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3198         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3199         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3200         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3201         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3202         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3203         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3204         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3205         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3206         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3207         16  EC-RT-LF-NSP-ST           PIC XX.
  3208         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  62
* EL6311.cbl
  3209         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3210         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3211
  3212         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3213             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3214                                             'M' '5' '9' '2'.
  3215             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3216             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3217             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3218             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3219             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3220             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3221             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3222             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3223             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3224             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3225
  3226         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3227             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3228                                             'M' '5' '9' '2'.
  3229             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3230             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3231             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3232             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3233             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3234             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3235             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3236             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3237             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3238             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3239
  3240         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3241         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3242         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3243         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3244         16  EC-CM-DEATH-DT            PIC XX.
  3245
  3246*DMD CUSTOM CODING FIELDS BELOW
  3247*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3248         16  EC-BR-DMD-RATING-SW       PIC X.
  3249                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3250                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3251                 88  NO-DMD-RATING               VALUE 'N'.
  3252
  3253         16  EC-NEW-CERT               PIC X(11).
  3254         16  EC-NEW-STATE              PIC XX.
  3255         16  FILLER                    PIC X.
  3256*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3257         16  OVER-SHORT-EDIT-FIELDS.
  3258             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3259             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3260             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3261             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3262             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3263             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3264             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3265             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3266             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  63
* EL6311.cbl
  3267         16  FILLER                    PIC X(71).
  3268
  3269******************************************************************
  3270
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  64
* EL6311.cbl
  3272
  3273*    COPY ELCJPFX.
  3274******************************************************************
  3275*                                                                *
  3276*                                                                *
  3277*                            ELCJPFX.                            *
  3278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3279*                            VMOD=2.002                          *
  3280*                                                                *
  3281*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3282*                                                                *
  3283*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3284*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3285*        ELCNTL - CONTROL FILE                                   *
  3286*        ELMSTR - CLAIM MASTERS                                  *
  3287*        ELTRLR - ACTIVITY TRAILERS                              *
  3288*        ELCHKQ - CHECK QUE                                      *
  3289******************************************************************
  3290 01  JOURNAL-RECORD.
  3291     12  jp-date                     pic s9(5) comp-3.
  3292     12  jp-time                     pic s9(7) comp-3.
  3293     12  JP-USER-ID                  PIC X(4).
  3294     12  JP-FILE-ID                  PIC X(8).
  3295     12  JP-PROGRAM-ID               PIC X(8).
  3296     12  JP-RECORD-TYPE              PIC X.
  3297         88 JP-ADD              VALUE 'A'.
  3298         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3299         88 JP-AFTER-CHANGE     VALUE 'C'.
  3300         88 JP-DELETE           VALUE 'D'.
  3301         88 JP-GENERIC-DELETE   VALUE 'G'.
  3302         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3303         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3304     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3305     12  JP-RECORD-AREA
  3306
  3307
  3308                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  65
* EL6311.cbl
  3310*    COPY ELCAID.
  3311******************************************************************
  3312*                                                                *
  3313*                            ELCAID.                             *
  3314*                            VMOD=2.001                          *
  3315*                                                                *
  3316*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3317*                                                                *
  3318*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3319*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3320******************************************************************
  3321
  3322 01  DFHAID.
  3323   02  DFHNULL   PIC  X  VALUE  ' '.
  3324   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3325   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3326   02  DFHPEN    PIC  X  VALUE  '='.
  3327   02  DFHOPID   PIC  X  VALUE  'W'.
  3328   02  DFHPA1    PIC  X  VALUE  '%'.
  3329   02  DFHPA2    PIC  X  VALUE  '>'.
  3330   02  DFHPA3    PIC  X  VALUE  ','.
  3331   02  DFHPF1    PIC  X  VALUE  '1'.
  3332   02  DFHPF2    PIC  X  VALUE  '2'.
  3333   02  DFHPF3    PIC  X  VALUE  '3'.
  3334   02  DFHPF4    PIC  X  VALUE  '4'.
  3335   02  DFHPF5    PIC  X  VALUE  '5'.
  3336   02  DFHPF6    PIC  X  VALUE  '6'.
  3337   02  DFHPF7    PIC  X  VALUE  '7'.
  3338   02  DFHPF8    PIC  X  VALUE  '8'.
  3339   02  DFHPF9    PIC  X  VALUE  '9'.
  3340   02  DFHPF10   PIC  X  VALUE  ':'.
  3341   02  DFHPF11   PIC  X  VALUE  '#'.
  3342   02  DFHPF12   PIC  X  VALUE  '@'.
  3343   02  DFHPF13   PIC  X  VALUE  'A'.
  3344   02  DFHPF14   PIC  X  VALUE  'B'.
  3345   02  DFHPF15   PIC  X  VALUE  'C'.
  3346   02  DFHPF16   PIC  X  VALUE  'D'.
  3347   02  DFHPF17   PIC  X  VALUE  'E'.
  3348   02  DFHPF18   PIC  X  VALUE  'F'.
  3349   02  DFHPF19   PIC  X  VALUE  'G'.
  3350   02  DFHPF20   PIC  X  VALUE  'H'.
  3351   02  DFHPF21   PIC  X  VALUE  'I'.
  3352*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3353   02  DFHPF22   PIC  X  VALUE  '['.
  3354   02  DFHPF23   PIC  X  VALUE  '.'.
  3355   02  DFHPF24   PIC  X  VALUE  '<'.
  3356   02  DFHMSRE   PIC  X  VALUE  'X'.
  3357   02  DFHSTRF   PIC  X  VALUE  'h'.
  3358   02  DFHTRIG   PIC  X  VALUE  '"'.
  3359
  3360 01  FILLER    REDEFINES DFHAID.
  3361     12  FILLER              PIC X(8).
  3362     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3363
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  66
* EL6311.cbl
  3365*    COPY EL6311S.
  3366 01  EL631BI.
  3367     05  FILLER            PIC  X(0012).
  3368*    -------------------------------
  3369     05  BDATEL PIC S9(0004) COMP.
  3370     05  BDATEF PIC  X(0001).
  3371     05  FILLER REDEFINES BDATEF.
  3372         10  BDATEA PIC  X(0001).
  3373     05  BDATEI PIC  X(0008).
  3374*    -------------------------------
  3375     05  BTIMEL PIC S9(0004) COMP.
  3376     05  BTIMEF PIC  X(0001).
  3377     05  FILLER REDEFINES BTIMEF.
  3378         10  BTIMEA PIC  X(0001).
  3379     05  BTIMEI PIC  X(0005).
  3380*    -------------------------------
  3381     05  BHEADL PIC S9(0004) COMP.
  3382     05  BHEADF PIC  X(0001).
  3383     05  FILLER REDEFINES BHEADF.
  3384         10  BHEADA PIC  X(0001).
  3385     05  BHEADI PIC  X(0038).
  3386*    -------------------------------
  3387     05  BNCERTLL PIC S9(0004) COMP.
  3388     05  BNCERTLF PIC  X(0001).
  3389     05  FILLER REDEFINES BNCERTLF.
  3390         10  BNCERTLA PIC  X(0001).
  3391     05  BNCERTLI PIC  X(0008).
  3392*    -------------------------------
  3393     05  BNCERTL PIC S9(0004) COMP.
  3394     05  BNCERTF PIC  X(0001).
  3395     05  FILLER REDEFINES BNCERTF.
  3396         10  BNCERTA PIC  X(0001).
  3397     05  BNCERTI PIC  X(0011).
  3398*    -------------------------------
  3399     05  BNSTATLL PIC S9(0004) COMP.
  3400     05  BNSTATLF PIC  X(0001).
  3401     05  FILLER REDEFINES BNSTATLF.
  3402         10  BNSTATLA PIC  X(0001).
  3403     05  BNSTATLI PIC  X(0009).
  3404*    -------------------------------
  3405     05  BNSTATL PIC S9(0004) COMP.
  3406     05  BNSTATF PIC  X(0001).
  3407     05  FILLER REDEFINES BNSTATF.
  3408         10  BNSTATA PIC  X(0001).
  3409     05  BNSTATI PIC  X(0002).
  3410*    -------------------------------
  3411     05  BCHGTL PIC S9(0004) COMP.
  3412     05  BCHGTF PIC  X(0001).
  3413     05  FILLER REDEFINES BCHGTF.
  3414         10  BCHGTA PIC  X(0001).
  3415     05  BCHGTI PIC  X(0004).
  3416*    -------------------------------
  3417     05  BCHGL PIC S9(0004) COMP.
  3418     05  BCHGF PIC  X(0001).
  3419     05  FILLER REDEFINES BCHGF.
  3420         10  BCHGA PIC  X(0001).
  3421     05  BCHGI PIC  X(0004).
  3422*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  67
* EL6311.cbl
  3423     05  BMAINTL PIC S9(0004) COMP.
  3424     05  BMAINTF PIC  X(0001).
  3425     05  FILLER REDEFINES BMAINTF.
  3426         10  BMAINTA PIC  X(0001).
  3427     05  BMAINTI PIC  X(0001).
  3428*    -------------------------------
  3429     05  BMANTBYL PIC S9(0004) COMP.
  3430     05  BMANTBYF PIC  X(0001).
  3431     05  FILLER REDEFINES BMANTBYF.
  3432         10  BMANTBYA PIC  X(0001).
  3433     05  BMANTBYI PIC  X(0004).
  3434*    -------------------------------
  3435     05  BCHGHDGL PIC S9(0004) COMP.
  3436     05  BCHGHDGF PIC  X(0001).
  3437     05  FILLER REDEFINES BCHGHDGF.
  3438         10  BCHGHDGA PIC  X(0001).
  3439     05  BCHGHDGI PIC  X(0003).
  3440*    -------------------------------
  3441     05  BMANTDTL PIC S9(0004) COMP.
  3442     05  BMANTDTF PIC  X(0001).
  3443     05  FILLER REDEFINES BMANTDTF.
  3444         10  BMANTDTA PIC  X(0001).
  3445     05  BMANTDTI PIC  X(0008).
  3446*    -------------------------------
  3447     05  BMANTATL PIC S9(0004) COMP.
  3448     05  BMANTATF PIC  X(0001).
  3449     05  FILLER REDEFINES BMANTATF.
  3450         10  BMANTATA PIC  X(0001).
  3451     05  BMANTATI PIC  X(0005).
  3452*    -------------------------------
  3453     05  BCSRL PIC S9(0004) COMP.
  3454     05  BCSRF PIC  X(0001).
  3455     05  FILLER REDEFINES BCSRF.
  3456         10  BCSRA PIC  X(0001).
  3457     05  BCSRI PIC  X(0004).
  3458*    -------------------------------
  3459     05  BBATCHL PIC S9(0004) COMP.
  3460     05  BBATCHF PIC  X(0001).
  3461     05  FILLER REDEFINES BBATCHF.
  3462         10  BBATCHA PIC  X(0001).
  3463     05  BBATCHI PIC  X(0006).
  3464*    -------------------------------
  3465     05  BSEQL PIC S9(0004) COMP.
  3466     05  BSEQF PIC  X(0001).
  3467     05  FILLER REDEFINES BSEQF.
  3468         10  BSEQA PIC  X(0001).
  3469     05  BSEQI PIC  X(0004).
  3470*    -------------------------------
  3471     05  BMOENDTL PIC S9(0004) COMP.
  3472     05  BMOENDTF PIC  X(0001).
  3473     05  FILLER REDEFINES BMOENDTF.
  3474         10  BMOENDTA PIC  X(0001).
  3475     05  BMOENDTI PIC  X(0008).
  3476*    -------------------------------
  3477     05  BCARRL PIC S9(0004) COMP.
  3478     05  BCARRF PIC  X(0001).
  3479     05  FILLER REDEFINES BCARRF.
  3480         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  68
* EL6311.cbl
  3481     05  BCARRI PIC  X(0001).
  3482*    -------------------------------
  3483     05  BGROUPL PIC S9(0004) COMP.
  3484     05  BGROUPF PIC  X(0001).
  3485     05  FILLER REDEFINES BGROUPF.
  3486         10  BGROUPA PIC  X(0001).
  3487     05  BGROUPI PIC  X(0006).
  3488*    -------------------------------
  3489     05  BSTATEL PIC S9(0004) COMP.
  3490     05  BSTATEF PIC  X(0001).
  3491     05  FILLER REDEFINES BSTATEF.
  3492         10  BSTATEA PIC  X(0001).
  3493     05  BSTATEI PIC  X(0002).
  3494*    -------------------------------
  3495     05  BACCTL PIC S9(0004) COMP.
  3496     05  BACCTF PIC  X(0001).
  3497     05  FILLER REDEFINES BACCTF.
  3498         10  BACCTA PIC  X(0001).
  3499     05  BACCTI PIC  X(0010).
  3500*    -------------------------------
  3501     05  BVINHL PIC S9(0004) COMP.
  3502     05  BVINHF PIC  X(0001).
  3503     05  FILLER REDEFINES BVINHF.
  3504         10  BVINHA PIC  X(0001).
  3505     05  BVINHI PIC  X(0004).
  3506*    -------------------------------
  3507     05  BVINL PIC S9(0004) COMP.
  3508     05  BVINF PIC  X(0001).
  3509     05  FILLER REDEFINES BVINF.
  3510         10  BVINA PIC  X(0001).
  3511     05  BVINI PIC  X(0017).
  3512*    -------------------------------
  3513     05  BREFHDGL PIC S9(0004) COMP.
  3514     05  BREFHDGF PIC  X(0001).
  3515     05  FILLER REDEFINES BREFHDGF.
  3516         10  BREFHDGA PIC  X(0001).
  3517     05  BREFHDGI PIC  X(0004).
  3518*    -------------------------------
  3519     05  BREFL PIC S9(0004) COMP.
  3520     05  BREFF PIC  X(0001).
  3521     05  FILLER REDEFINES BREFF.
  3522         10  BREFA PIC  X(0001).
  3523     05  BREFI PIC  X(0012).
  3524*    -------------------------------
  3525     05  BAGEDEFL PIC S9(0004) COMP.
  3526     05  BAGEDEFF PIC  X(0001).
  3527     05  FILLER REDEFINES BAGEDEFF.
  3528         10  BAGEDEFA PIC  X(0001).
  3529     05  BAGEDEFI PIC  X(0004).
  3530*    -------------------------------
  3531     05  BCERTNOL PIC S9(0004) COMP.
  3532     05  BCERTNOF PIC  X(0001).
  3533     05  FILLER REDEFINES BCERTNOF.
  3534         10  BCERTNOA PIC  X(0001).
  3535     05  BCERTNOI PIC  X(0010).
  3536*    -------------------------------
  3537     05  BSUFIXL PIC S9(0004) COMP.
  3538     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  69
* EL6311.cbl
  3539     05  FILLER REDEFINES BSUFIXF.
  3540         10  BSUFIXA PIC  X(0001).
  3541     05  BSUFIXI PIC  X(0001).
  3542*    -------------------------------
  3543     05  BEFFDTL PIC S9(0004) COMP.
  3544     05  BEFFDTF PIC  X(0001).
  3545     05  FILLER REDEFINES BEFFDTF.
  3546         10  BEFFDTA PIC  X(0001).
  3547     05  BEFFDTI PIC  X(0008).
  3548*    -------------------------------
  3549     05  BLSTNML PIC S9(0004) COMP.
  3550     05  BLSTNMF PIC  X(0001).
  3551     05  FILLER REDEFINES BLSTNMF.
  3552         10  BLSTNMA PIC  X(0001).
  3553     05  BLSTNMI PIC  X(0015).
  3554*    -------------------------------
  3555     05  B1STNML PIC S9(0004) COMP.
  3556     05  B1STNMF PIC  X(0001).
  3557     05  FILLER REDEFINES B1STNMF.
  3558         10  B1STNMA PIC  X(0001).
  3559     05  B1STNMI PIC  X(0010).
  3560*    -------------------------------
  3561     05  BINITL PIC S9(0004) COMP.
  3562     05  BINITF PIC  X(0001).
  3563     05  FILLER REDEFINES BINITF.
  3564         10  BINITA PIC  X(0001).
  3565     05  BINITI PIC  X(0001).
  3566*    -------------------------------
  3567     05  BSEXL PIC S9(0004) COMP.
  3568     05  BSEXF PIC  X(0001).
  3569     05  FILLER REDEFINES BSEXF.
  3570         10  BSEXA PIC  X(0001).
  3571     05  BSEXI PIC  X(0001).
  3572*    -------------------------------
  3573     05  BAGEL PIC S9(0004) COMP.
  3574     05  BAGEF PIC  X(0001).
  3575     05  FILLER REDEFINES BAGEF.
  3576         10  BAGEA PIC  X(0001).
  3577     05  BAGEI PIC  X(0002).
  3578*    -------------------------------
  3579     05  BBIRTHL PIC S9(0004) COMP.
  3580     05  BBIRTHF PIC  X(0001).
  3581     05  FILLER REDEFINES BBIRTHF.
  3582         10  BBIRTHA PIC  X(0001).
  3583     05  BBIRTHI PIC  X(0008).
  3584*    -------------------------------
  3585     05  B1STPMTL PIC S9(0004) COMP.
  3586     05  B1STPMTF PIC  X(0001).
  3587     05  FILLER REDEFINES B1STPMTF.
  3588         10  B1STPMTA PIC  X(0001).
  3589     05  B1STPMTI PIC  X(0008).
  3590*    -------------------------------
  3591     05  BDAYSL PIC S9(0004) COMP.
  3592     05  BDAYSF PIC  X(0001).
  3593     05  FILLER REDEFINES BDAYSF.
  3594         10  BDAYSA PIC  X(0001).
  3595     05  BDAYSI PIC  X(0003).
  3596*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  70
* EL6311.cbl
  3597     05  BLNTRML PIC S9(0004) COMP.
  3598     05  BLNTRMF PIC  X(0001).
  3599     05  FILLER REDEFINES BLNTRMF.
  3600         10  BLNTRMA PIC  X(0001).
  3601     05  BLNTRMI PIC  X(0003).
  3602*    -------------------------------
  3603     05  BLNOFCRL PIC S9(0004) COMP.
  3604     05  BLNOFCRF PIC  X(0001).
  3605     05  FILLER REDEFINES BLNOFCRF.
  3606         10  BLNOFCRA PIC  X(0001).
  3607     05  BLNOFCRI PIC  X(0005).
  3608*    -------------------------------
  3609     05  BMODEL PIC S9(0004) COMP.
  3610     05  BMODEF PIC  X(0001).
  3611     05  FILLER REDEFINES BMODEF.
  3612         10  BMODEA PIC  X(0001).
  3613     05  BMODEI PIC  X(0001).
  3614*    -------------------------------
  3615     05  BFREQL PIC S9(0004) COMP.
  3616     05  BFREQF PIC  X(0001).
  3617     05  FILLER REDEFINES BFREQF.
  3618         10  BFREQA PIC  X(0001).
  3619     05  BFREQI PIC  X(0002).
  3620*    -------------------------------
  3621     05  BPMTSL PIC S9(0004) COMP.
  3622     05  BPMTSF PIC  X(0001).
  3623     05  FILLER REDEFINES BPMTSF.
  3624         10  BPMTSA PIC  X(0001).
  3625     05  BPMTSI PIC  999.
  3626*    -------------------------------
  3627     05  BPMTAMTL PIC S9(0004) COMP.
  3628     05  BPMTAMTF PIC  X(0001).
  3629     05  FILLER REDEFINES BPMTAMTF.
  3630         10  BPMTAMTA PIC  X(0001).
  3631     05  BPMTAMTI PIC  9(7)V99.
  3632*    -------------------------------
  3633     05  BAPRL PIC S9(0004) COMP.
  3634     05  BAPRF PIC  X(0001).
  3635     05  FILLER REDEFINES BAPRF.
  3636         10  BAPRA PIC  X(0001).
  3637     05  BAPRI PIC  X(7).
  3638*    -------------------------------
  3639     05  BLIVESL PIC S9(0004) COMP.
  3640     05  BLIVESF PIC  X(0001).
  3641     05  FILLER REDEFINES BLIVESF.
  3642         10  BLIVESA PIC  X(0001).
  3643     05  BLIVESI PIC  X(0009).
  3644*    -------------------------------
  3645     05  BMEMCAPL PIC S9(0004) COMP.
  3646     05  BMEMCAPF PIC  X(0001).
  3647     05  FILLER REDEFINES BMEMCAPF.
  3648         10  BMEMCAPA PIC  X(0001).
  3649     05  BMEMCAPI PIC  X(0011).
  3650*    -------------------------------
  3651     05  BORIGHDL PIC S9(0004) COMP.
  3652     05  BORIGHDF PIC  X(0001).
  3653     05  FILLER REDEFINES BORIGHDF.
  3654         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  71
* EL6311.cbl
  3655     05  BORIGHDI PIC  X(0009).
  3656*    -------------------------------
  3657     05  DMDBILL PIC S9(0004) COMP.
  3658     05  DMDBILF PIC  X(0001).
  3659     05  FILLER REDEFINES DMDBILF.
  3660         10  DMDBILA PIC  X(0001).
  3661     05  DMDBILI PIC  X(0006).
  3662*    -------------------------------
  3663     05  BFORCEL PIC S9(0004) COMP.
  3664     05  BFORCEF PIC  X(0001).
  3665     05  FILLER REDEFINES BFORCEF.
  3666         10  BFORCEA PIC  X(0001).
  3667     05  BFORCEI PIC  X(0001).
  3668*    -------------------------------
  3669     05  BENTRYL PIC S9(0004) COMP.
  3670     05  BENTRYF PIC  X(0001).
  3671     05  FILLER REDEFINES BENTRYF.
  3672         10  BENTRYA PIC  X(0001).
  3673     05  BENTRYI PIC  X(0001).
  3674*    -------------------------------
  3675     05  BREINL PIC S9(0004) COMP.
  3676     05  BREINF PIC  X(0001).
  3677     05  FILLER REDEFINES BREINF.
  3678         10  BREINA PIC  X(0001).
  3679     05  BREINI PIC  X(0001).
  3680*    -------------------------------
  3681     05  BBILCDL PIC S9(0004) COMP.
  3682     05  BBILCDF PIC  X(0001).
  3683     05  FILLER REDEFINES BBILCDF.
  3684         10  BBILCDA PIC  X(0001).
  3685     05  BBILCDI PIC  X(0001).
  3686*    -------------------------------
  3687     05  BUNWRITL PIC S9(0004) COMP.
  3688     05  BUNWRITF PIC  X(0001).
  3689     05  FILLER REDEFINES BUNWRITF.
  3690         10  BUNWRITA PIC  X(0001).
  3691     05  BUNWRITI PIC  X(0001).
  3692*    -------------------------------
  3693     05  BSKPCDL PIC S9(0004) COMP.
  3694     05  BSKPCDF PIC  X(0001).
  3695     05  FILLER REDEFINES BSKPCDF.
  3696         10  BSKPCDA PIC  X(0001).
  3697     05  BSKPCDI PIC  X(0001).
  3698*    -------------------------------
  3699     05  BINDGRPL PIC S9(0004) COMP.
  3700     05  BINDGRPF PIC  X(0001).
  3701     05  FILLER REDEFINES BINDGRPF.
  3702         10  BINDGRPA PIC  X(0001).
  3703     05  BINDGRPI PIC  X(0001).
  3704*    -------------------------------
  3705     05  BSIGL PIC S9(0004) COMP.
  3706     05  BSIGF PIC  X(0001).
  3707     05  FILLER REDEFINES BSIGF.
  3708         10  BSIGA PIC  X(0001).
  3709     05  BSIGI PIC  X(0001).
  3710*    -------------------------------
  3711     05  BRTCLSL PIC S9(0004) COMP.
  3712     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  72
* EL6311.cbl
  3713     05  FILLER REDEFINES BRTCLSF.
  3714         10  BRTCLSA PIC  X(0001).
  3715     05  BRTCLSI PIC  X(0002).
  3716*    -------------------------------
  3717     05  BCHGCNTL PIC S9(0004) COMP.
  3718     05  BCHGCNTF PIC  X(0001).
  3719     05  FILLER REDEFINES BCHGCNTF.
  3720         10  BCHGCNTA PIC  X(0001).
  3721     05  BCHGCNTI PIC  X(0003).
  3722*    -------------------------------
  3723     05  BMEMBERL PIC S9(0004) COMP.
  3724     05  BMEMBERF PIC  X(0001).
  3725     05  FILLER REDEFINES BMEMBERF.
  3726         10  BMEMBERA PIC  X(0001).
  3727     05  BMEMBERI PIC  X(0012).
  3728*    -------------------------------
  3729     05  BORGNOL PIC S9(0004) COMP.
  3730     05  BORGNOF PIC  X(0001).
  3731     05  FILLER REDEFINES BORGNOF.
  3732         10  BORGNOA PIC  X(0001).
  3733     05  BORGNOI PIC  X(0006).
  3734*    -------------------------------
  3735     05  BORGSEQL PIC S9(0004) COMP.
  3736     05  BORGSEQF PIC  X(0001).
  3737     05  FILLER REDEFINES BORGSEQF.
  3738         10  BORGSEQA PIC  X(0001).
  3739     05  BORGSEQI PIC  X(0004).
  3740*    -------------------------------
  3741     05  BBILLEDL PIC S9(0004) COMP.
  3742     05  BBILLEDF PIC  X(0001).
  3743     05  FILLER REDEFINES BBILLEDF.
  3744         10  BBILLEDA PIC  X(0001).
  3745     05  BBILLEDI PIC  9(9).
  3746*    -------------------------------
  3747     05  BKIND1L PIC S9(0004) COMP.
  3748     05  BKIND1F PIC  X(0001).
  3749     05  FILLER REDEFINES BKIND1F.
  3750         10  BKIND1A PIC  X(0001).
  3751     05  BKIND1I PIC  X(0002).
  3752*    -------------------------------
  3753     05  BTYPE1L PIC S9(0004) COMP.
  3754     05  BTYPE1F PIC  X(0001).
  3755     05  FILLER REDEFINES BTYPE1F.
  3756         10  BTYPE1A PIC  X(0001).
  3757     05  BTYPE1I PIC  X(0003).
  3758*    -------------------------------
  3759     05  BTERM1L PIC S9(0004) COMP.
  3760     05  BTERM1F PIC  X(0001).
  3761     05  FILLER REDEFINES BTERM1F.
  3762         10  BTERM1A PIC  X(0001).
  3763     05  BTERM1I PIC  X(0003).
  3764*    -------------------------------
  3765     05  BBEN1L PIC S9(0004) COMP.
  3766     05  BBEN1F PIC  X(0001).
  3767     05  FILLER REDEFINES BBEN1F.
  3768         10  BBEN1A PIC  X(0001).
  3769     05  BBEN1I PIC  X(0012).
  3770*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  73
* EL6311.cbl
  3771     05  BPREM1L PIC S9(0004) COMP.
  3772     05  BPREM1F PIC  X(0001).
  3773     05  FILLER REDEFINES BPREM1F.
  3774         10  BPREM1A PIC  X(0001).
  3775     05  BPREM1I PIC  X(0011).
  3776*    -------------------------------
  3777     05  BEXPIR1L PIC S9(0004) COMP.
  3778     05  BEXPIR1F PIC  X(0001).
  3779     05  FILLER REDEFINES BEXPIR1F.
  3780         10  BEXPIR1A PIC  X(0001).
  3781     05  BEXPIR1I PIC  X(0008).
  3782*    -------------------------------
  3783     05  BCP1L PIC S9(0004) COMP.
  3784     05  BCP1F PIC  X(0001).
  3785     05  FILLER REDEFINES BCP1F.
  3786         10  BCP1A PIC  X(0001).
  3787     05  BCP1I PIC  X(0002).
  3788*    -------------------------------
  3789     05  BALTBN1L PIC S9(0004) COMP.
  3790     05  BALTBN1F PIC  X(0001).
  3791     05  FILLER REDEFINES BALTBN1F.
  3792         10  BALTBN1A PIC  X(0001).
  3793     05  BALTBN1I PIC  X(0012).
  3794*    -------------------------------
  3795     05  BALTPR1L PIC S9(0004) COMP.
  3796     05  BALTPR1F PIC  X(0001).
  3797     05  FILLER REDEFINES BALTPR1F.
  3798         10  BALTPR1A PIC  X(0001).
  3799     05  BALTPR1I PIC  X(0011).
  3800*    -------------------------------
  3801     05  BBNCD1L PIC S9(0004) COMP.
  3802     05  BBNCD1F PIC  X(0001).
  3803     05  FILLER REDEFINES BBNCD1F.
  3804         10  BBNCD1A PIC  X(0001).
  3805     05  BBNCD1I PIC  X(0003).
  3806*    -------------------------------
  3807     05  BCPRM1L PIC S9(0004) COMP.
  3808     05  BCPRM1F PIC  X(0001).
  3809     05  FILLER REDEFINES BCPRM1F.
  3810         10  BCPRM1A PIC  X(0001).
  3811     05  BCPRM1I PIC  X(0011).
  3812*    -------------------------------
  3813     05  BCAPRM1L PIC S9(0004) COMP.
  3814     05  BCAPRM1F PIC  X(0001).
  3815     05  FILLER REDEFINES BCAPRM1F.
  3816         10  BCAPRM1A PIC  X(0001).
  3817     05  BCAPRM1I PIC  X(0011).
  3818*    -------------------------------
  3819     05  BENABR1L PIC S9(0004) COMP.
  3820     05  BENABR1F PIC  X(0001).
  3821     05  FILLER REDEFINES BENABR1F.
  3822         10  BENABR1A PIC  X(0001).
  3823     05  BENABR1I PIC  X(0005).
  3824*    -------------------------------
  3825     05  BDIFF1L PIC S9(0004) COMP.
  3826     05  BDIFF1F PIC  X(0001).
  3827     05  FILLER REDEFINES BDIFF1F.
  3828         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  74
* EL6311.cbl
  3829     05  BDIFF1I PIC  X(0011).
  3830*    -------------------------------
  3831     05  BBILIT1L PIC S9(0004) COMP.
  3832     05  BBILIT1F PIC  X(0001).
  3833     05  FILLER REDEFINES BBILIT1F.
  3834         10  BBILIT1A PIC  X(0001).
  3835     05  BBILIT1I PIC  X(0008).
  3836*    -------------------------------
  3837     05  BADIFF1L PIC S9(0004) COMP.
  3838     05  BADIFF1F PIC  X(0001).
  3839     05  FILLER REDEFINES BADIFF1F.
  3840         10  BADIFF1A PIC  X(0001).
  3841     05  BADIFF1I PIC  X(0011).
  3842*    -------------------------------
  3843     05  BKIND2L PIC S9(0004) COMP.
  3844     05  BKIND2F PIC  X(0001).
  3845     05  FILLER REDEFINES BKIND2F.
  3846         10  BKIND2A PIC  X(0001).
  3847     05  BKIND2I PIC  X(0002).
  3848*    -------------------------------
  3849     05  BTYPE2L PIC S9(0004) COMP.
  3850     05  BTYPE2F PIC  X(0001).
  3851     05  FILLER REDEFINES BTYPE2F.
  3852         10  BTYPE2A PIC  X(0001).
  3853     05  BTYPE2I PIC  X(0003).
  3854*    -------------------------------
  3855     05  BTERM2L PIC S9(0004) COMP.
  3856     05  BTERM2F PIC  X(0001).
  3857     05  FILLER REDEFINES BTERM2F.
  3858         10  BTERM2A PIC  X(0001).
  3859     05  BTERM2I PIC  X(0003).
  3860*    -------------------------------
  3861     05  BBEN2L PIC S9(0004) COMP.
  3862     05  BBEN2F PIC  X(0001).
  3863     05  FILLER REDEFINES BBEN2F.
  3864         10  BBEN2A PIC  X(0001).
  3865     05  BBEN2I PIC  X(0012).
  3866*    -------------------------------
  3867     05  BPREM2L PIC S9(0004) COMP.
  3868     05  BPREM2F PIC  X(0001).
  3869     05  FILLER REDEFINES BPREM2F.
  3870         10  BPREM2A PIC  X(0001).
  3871     05  BPREM2I PIC  X(0011).
  3872*    -------------------------------
  3873     05  BEXPIR2L PIC S9(0004) COMP.
  3874     05  BEXPIR2F PIC  X(0001).
  3875     05  FILLER REDEFINES BEXPIR2F.
  3876         10  BEXPIR2A PIC  X(0001).
  3877     05  BEXPIR2I PIC  X(0008).
  3878*    -------------------------------
  3879     05  BCP2L PIC S9(0004) COMP.
  3880     05  BCP2F PIC  X(0001).
  3881     05  FILLER REDEFINES BCP2F.
  3882         10  BCP2A PIC  X(0001).
  3883     05  BCP2I PIC  X(0002).
  3884*    -------------------------------
  3885     05  BALTBN2L PIC S9(0004) COMP.
  3886     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  75
* EL6311.cbl
  3887     05  FILLER REDEFINES BALTBN2F.
  3888         10  BALTBN2A PIC  X(0001).
  3889     05  BALTBN2I PIC  X(0012).
  3890*    -------------------------------
  3891     05  BALTPR2L PIC S9(0004) COMP.
  3892     05  BALTPR2F PIC  X(0001).
  3893     05  FILLER REDEFINES BALTPR2F.
  3894         10  BALTPR2A PIC  X(0001).
  3895     05  BALTPR2I PIC  X(0011).
  3896*    -------------------------------
  3897     05  BBNCD2L PIC S9(0004) COMP.
  3898     05  BBNCD2F PIC  X(0001).
  3899     05  FILLER REDEFINES BBNCD2F.
  3900         10  BBNCD2A PIC  X(0001).
  3901     05  BBNCD2I PIC  X(0003).
  3902*    -------------------------------
  3903     05  BCPRM2L PIC S9(0004) COMP.
  3904     05  BCPRM2F PIC  X(0001).
  3905     05  FILLER REDEFINES BCPRM2F.
  3906         10  BCPRM2A PIC  X(0001).
  3907     05  BCPRM2I PIC  X(0011).
  3908*    -------------------------------
  3909     05  BCAPRM2L PIC S9(0004) COMP.
  3910     05  BCAPRM2F PIC  X(0001).
  3911     05  FILLER REDEFINES BCAPRM2F.
  3912         10  BCAPRM2A PIC  X(0001).
  3913     05  BCAPRM2I PIC  X(0011).
  3914*    -------------------------------
  3915     05  BENABR2L PIC S9(0004) COMP.
  3916     05  BENABR2F PIC  X(0001).
  3917     05  FILLER REDEFINES BENABR2F.
  3918         10  BENABR2A PIC  X(0001).
  3919     05  BENABR2I PIC  X(0005).
  3920*    -------------------------------
  3921     05  BDIFF2L PIC S9(0004) COMP.
  3922     05  BDIFF2F PIC  X(0001).
  3923     05  FILLER REDEFINES BDIFF2F.
  3924         10  BDIFF2A PIC  X(0001).
  3925     05  BDIFF2I PIC  X(0011).
  3926*    -------------------------------
  3927     05  BBILIT2L PIC S9(0004) COMP.
  3928     05  BBILIT2F PIC  X(0001).
  3929     05  FILLER REDEFINES BBILIT2F.
  3930         10  BBILIT2A PIC  X(0001).
  3931     05  BBILIT2I PIC  X(0008).
  3932*    -------------------------------
  3933     05  BADIFF2L PIC S9(0004) COMP.
  3934     05  BADIFF2F PIC  X(0001).
  3935     05  FILLER REDEFINES BADIFF2F.
  3936         10  BADIFF2A PIC  X(0001).
  3937     05  BADIFF2I PIC  X(0011).
  3938*    -------------------------------
  3939     05  BERMSG1L PIC S9(0004) COMP.
  3940     05  BERMSG1F PIC  X(0001).
  3941     05  FILLER REDEFINES BERMSG1F.
  3942         10  BERMSG1A PIC  X(0001).
  3943     05  BERMSG1I PIC  X(0078).
  3944*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  76
* EL6311.cbl
  3945     05  BERMSG2L PIC S9(0004) COMP.
  3946     05  BERMSG2F PIC  X(0001).
  3947     05  FILLER REDEFINES BERMSG2F.
  3948         10  BERMSG2A PIC  X(0001).
  3949     05  BERMSG2I PIC  X(0078).
  3950*    -------------------------------
  3951     05  BERMSG3L PIC S9(0004) COMP.
  3952     05  BERMSG3F PIC  X(0001).
  3953     05  FILLER REDEFINES BERMSG3F.
  3954         10  BERMSG3A PIC  X(0001).
  3955     05  BERMSG3I PIC  X(0078).
  3956*    -------------------------------
  3957     05  BPFENTRL PIC S9(0004) COMP.
  3958     05  BPFENTRF PIC  X(0001).
  3959     05  FILLER REDEFINES BPFENTRF.
  3960         10  BPFENTRA PIC  X(0001).
  3961     05  BPFENTRI PIC  9(2).
  3962*    -------------------------------
  3963     05  BPF5HDRL PIC S9(0004) COMP.
  3964     05  BPF5HDRF PIC  X(0001).
  3965     05  FILLER REDEFINES BPF5HDRF.
  3966         10  BPF5HDRA PIC  X(0001).
  3967     05  BPF5HDRI PIC  X(0005).
  3968*    -------------------------------
  3969     05  BPF4HDRL PIC S9(0004) COMP.
  3970     05  BPF4HDRF PIC  X(0001).
  3971     05  FILLER REDEFINES BPF4HDRF.
  3972         10  BPF4HDRA PIC  X(0001).
  3973     05  BPF4HDRI PIC  X(0013).
  3974*    -------------------------------
  3975     05  BF15HDRL PIC S9(0004) COMP.
  3976     05  BF15HDRF PIC  X(0001).
  3977     05  FILLER REDEFINES BF15HDRF.
  3978         10  BF15HDRA PIC  X(0001).
  3979     05  BF15HDRI PIC  X(0010).
  3980 01  EL631BO REDEFINES EL631BI.
  3981     05  FILLER            PIC  X(0012).
  3982*    -------------------------------
  3983     05  FILLER            PIC  X(0003).
  3984     05  BDATEO PIC  X(0008).
  3985*    -------------------------------
  3986     05  FILLER            PIC  X(0003).
  3987     05  BTIMEO PIC  99.99.
  3988*    -------------------------------
  3989     05  FILLER            PIC  X(0003).
  3990     05  BHEADO PIC  X(0038).
  3991*    -------------------------------
  3992     05  FILLER            PIC  X(0003).
  3993     05  BNCERTLO PIC  X(0008).
  3994*    -------------------------------
  3995     05  FILLER            PIC  X(0003).
  3996     05  BNCERTO PIC  X(0011).
  3997*    -------------------------------
  3998     05  FILLER            PIC  X(0003).
  3999     05  BNSTATLO PIC  X(0009).
  4000*    -------------------------------
  4001     05  FILLER            PIC  X(0003).
  4002     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  77
* EL6311.cbl
  4003*    -------------------------------
  4004     05  FILLER            PIC  X(0003).
  4005     05  BCHGTO PIC  X(0004).
  4006*    -------------------------------
  4007     05  FILLER            PIC  X(0003).
  4008     05  BCHGO PIC  ZZZ9.
  4009*    -------------------------------
  4010     05  FILLER            PIC  X(0003).
  4011     05  BMAINTO PIC  X(0001).
  4012*    -------------------------------
  4013     05  FILLER            PIC  X(0003).
  4014     05  BMANTBYO PIC  X(0004).
  4015*    -------------------------------
  4016     05  FILLER            PIC  X(0003).
  4017     05  BCHGHDGO PIC  X(0003).
  4018*    -------------------------------
  4019     05  FILLER            PIC  X(0003).
  4020     05  BMANTDTO PIC  X(0008).
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  BMANTATO PIC  99.99.
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BCSRO PIC  X(0004).
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BBATCHO PIC  X(0006).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BSEQO PIC  X(0004).
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BMOENDTO PIC  X(0008).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BCARRO PIC  X(0001).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BGROUPO PIC  X(0006).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BSTATEO PIC  X(0002).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BACCTO PIC  X(0010).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BVINHO PIC  X(0004).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BVINO PIC  X(0017).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BREFHDGO PIC  X(0004).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BREFO PIC  X(0012).
  4060*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  78
* EL6311.cbl
  4061     05  FILLER            PIC  X(0003).
  4062     05  BAGEDEFO PIC  X(0004).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BCERTNOO PIC  X(0010).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BSUFIXO PIC  X(0001).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BEFFDTO PIC  X(0008).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BLSTNMO PIC  X(0015).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  B1STNMO PIC  X(0010).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BINITO PIC  X(0001).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BSEXO PIC  X(0001).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BAGEO PIC  X(0002).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BBIRTHO PIC  X(0008).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  B1STPMTO PIC  X(0008).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BDAYSO PIC  X(0003).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BLNTRMO PIC  X(0003).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BLNOFCRO PIC  X(0005).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BMODEO PIC  X(0001).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BFREQO PIC  X(0002).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BPMTSO PIC  X(0003).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BPMTAMTO PIC  ZZZZZ9.99.
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BAPRO PIC  99.9999.
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  79
* EL6311.cbl
  4119     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BMEMCAPO PIC  X(0011).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BORIGHDO PIC  X(0009).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  DMDBILO PIC  X(0006).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BFORCEO PIC  X(0001).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BENTRYO PIC  X(0001).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BREINO PIC  X(0001).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BBILCDO PIC  X(0001).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BUNWRITO PIC  X(0001).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BSKPCDO PIC  X(0001).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BINDGRPO PIC  X(0001).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BSIGO PIC  X(0001).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BRTCLSO PIC  X(0002).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BCHGCNTO PIC  X(0003).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BMEMBERO PIC  X(0012).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BORGNOO PIC  X(0006).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BORGSEQO PIC  X(0004).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BKIND1O PIC  X(0002).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  80
* EL6311.cbl
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BTERM1O PIC  X(0003).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BBEN1O PIC  X(0012).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BPREM1O PIC  X(0011).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BEXPIR1O PIC  X(0008).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BCP1O PIC  X(0002).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BALTBN1O PIC  X(0012).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BALTPR1O PIC  X(0011).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BBNCD1O PIC  X(0003).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BCPRM1O PIC  X(0011).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BCAPRM1O PIC  X(0011).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BENABR1O PIC  X(0005).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BDIFF1O PIC  X(0011).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BBILIT1O PIC  X(0008).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BADIFF1O PIC  X(0011).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BKIND2O PIC  X(0002).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BTYPE2O PIC  X(0003).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BTERM2O PIC  X(0003).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BBEN2O PIC  X(0012).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BPREM2O PIC  X(0011).
  4234*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  81
* EL6311.cbl
  4235     05  FILLER            PIC  X(0003).
  4236     05  BEXPIR2O PIC  X(0008).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BCP2O PIC  X(0002).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BALTBN2O PIC  X(0012).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BALTPR2O PIC  X(0011).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BBNCD2O PIC  X(0003).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BCPRM2O PIC  X(0011).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BCAPRM2O PIC  X(0011).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BENABR2O PIC  X(0005).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BDIFF2O PIC  X(0011).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BBILIT2O PIC  X(0008).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BADIFF2O PIC  X(0011).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BERMSG1O PIC  X(0078).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BERMSG2O PIC  X(0078).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BERMSG3O PIC  X(0078).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BPFENTRO PIC  X(0002).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BPF5HDRO PIC  X(0005).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BPF4HDRO PIC  X(0013).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BF15HDRO PIC  X(0010).
  4288*    -------------------------------
  4289 01  EL631CI REDEFINES EL631BI.
  4290     05  FILLER            PIC  X(0012).
  4291*    -------------------------------
  4292     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  82
* EL6311.cbl
  4293     05  CDATEF PIC  X(0001).
  4294     05  FILLER REDEFINES CDATEF.
  4295         10  CDATEA PIC  X(0001).
  4296     05  CDATEI PIC  X(0008).
  4297*    -------------------------------
  4298     05  CTIMEL PIC S9(0004) COMP.
  4299     05  CTIMEF PIC  X(0001).
  4300     05  FILLER REDEFINES CTIMEF.
  4301         10  CTIMEA PIC  X(0001).
  4302     05  CTIMEI PIC  X(0005).
  4303*    -------------------------------
  4304     05  CHEADL PIC S9(0004) COMP.
  4305     05  CHEADF PIC  X(0001).
  4306     05  FILLER REDEFINES CHEADF.
  4307         10  CHEADA PIC  X(0001).
  4308     05  CHEADI PIC  X(0038).
  4309*    -------------------------------
  4310     05  CCHGTL PIC S9(0004) COMP.
  4311     05  CCHGTF PIC  X(0001).
  4312     05  FILLER REDEFINES CCHGTF.
  4313         10  CCHGTA PIC  X(0001).
  4314     05  CCHGTI PIC  X(0004).
  4315*    -------------------------------
  4316     05  CCHGL PIC S9(0004) COMP.
  4317     05  CCHGF PIC  X(0001).
  4318     05  FILLER REDEFINES CCHGF.
  4319         10  CCHGA PIC  X(0001).
  4320     05  CCHGI PIC  X(0004).
  4321*    -------------------------------
  4322     05  CMAINTL PIC S9(0004) COMP.
  4323     05  CMAINTF PIC  X(0001).
  4324     05  FILLER REDEFINES CMAINTF.
  4325         10  CMAINTA PIC  X(0001).
  4326     05  CMAINTI PIC  X(0001).
  4327*    -------------------------------
  4328     05  CMANTBYL PIC S9(0004) COMP.
  4329     05  CMANTBYF PIC  X(0001).
  4330     05  FILLER REDEFINES CMANTBYF.
  4331         10  CMANTBYA PIC  X(0001).
  4332     05  CMANTBYI PIC  X(0004).
  4333*    -------------------------------
  4334     05  CCHGHDGL PIC S9(0004) COMP.
  4335     05  CCHGHDGF PIC  X(0001).
  4336     05  FILLER REDEFINES CCHGHDGF.
  4337         10  CCHGHDGA PIC  X(0001).
  4338     05  CCHGHDGI PIC  X(0003).
  4339*    -------------------------------
  4340     05  CMANTDTL PIC S9(0004) COMP.
  4341     05  CMANTDTF PIC  X(0001).
  4342     05  FILLER REDEFINES CMANTDTF.
  4343         10  CMANTDTA PIC  X(0001).
  4344     05  CMANTDTI PIC  X(0008).
  4345*    -------------------------------
  4346     05  CMANTATL PIC S9(0004) COMP.
  4347     05  CMANTATF PIC  X(0001).
  4348     05  FILLER REDEFINES CMANTATF.
  4349         10  CMANTATA PIC  X(0001).
  4350     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  83
* EL6311.cbl
  4351*    -------------------------------
  4352     05  CCSRL PIC S9(0004) COMP.
  4353     05  CCSRF PIC  X(0001).
  4354     05  FILLER REDEFINES CCSRF.
  4355         10  CCSRA PIC  X(0001).
  4356     05  CCSRI PIC  X(0004).
  4357*    -------------------------------
  4358     05  CBATCHL PIC S9(0004) COMP.
  4359     05  CBATCHF PIC  X(0001).
  4360     05  FILLER REDEFINES CBATCHF.
  4361         10  CBATCHA PIC  X(0001).
  4362     05  CBATCHI PIC  X(0006).
  4363*    -------------------------------
  4364     05  CSEQL PIC S9(0004) COMP.
  4365     05  CSEQF PIC  X(0001).
  4366     05  FILLER REDEFINES CSEQF.
  4367         10  CSEQA PIC  X(0001).
  4368     05  CSEQI PIC  X(0004).
  4369*    -------------------------------
  4370     05  CMOENDTL PIC S9(0004) COMP.
  4371     05  CMOENDTF PIC  X(0001).
  4372     05  FILLER REDEFINES CMOENDTF.
  4373         10  CMOENDTA PIC  X(0001).
  4374     05  CMOENDTI PIC  X(0008).
  4375*    -------------------------------
  4376     05  CCARRL PIC S9(0004) COMP.
  4377     05  CCARRF PIC  X(0001).
  4378     05  FILLER REDEFINES CCARRF.
  4379         10  CCARRA PIC  X(0001).
  4380     05  CCARRI PIC  X(0001).
  4381*    -------------------------------
  4382     05  CGROUPL PIC S9(0004) COMP.
  4383     05  CGROUPF PIC  X(0001).
  4384     05  FILLER REDEFINES CGROUPF.
  4385         10  CGROUPA PIC  X(0001).
  4386     05  CGROUPI PIC  X(0006).
  4387*    -------------------------------
  4388     05  CSTATEL PIC S9(0004) COMP.
  4389     05  CSTATEF PIC  X(0001).
  4390     05  FILLER REDEFINES CSTATEF.
  4391         10  CSTATEA PIC  X(0001).
  4392     05  CSTATEI PIC  X(0002).
  4393*    -------------------------------
  4394     05  CACCTL PIC S9(0004) COMP.
  4395     05  CACCTF PIC  X(0001).
  4396     05  FILLER REDEFINES CACCTF.
  4397         10  CACCTA PIC  X(0001).
  4398     05  CACCTI PIC  X(0010).
  4399*    -------------------------------
  4400     05  CORIGHDL PIC S9(0004) COMP.
  4401     05  CORIGHDF PIC  X(0001).
  4402     05  FILLER REDEFINES CORIGHDF.
  4403         10  CORIGHDA PIC  X(0001).
  4404     05  CORIGHDI PIC  X(0011).
  4405*    -------------------------------
  4406     05  CORGNOL PIC S9(0004) COMP.
  4407     05  CORGNOF PIC  X(0001).
  4408     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  84
* EL6311.cbl
  4409         10  CORGNOA PIC  X(0001).
  4410     05  CORGNOI PIC  X(0006).
  4411*    -------------------------------
  4412     05  CORGSEQL PIC S9(0004) COMP.
  4413     05  CORGSEQF PIC  X(0001).
  4414     05  FILLER REDEFINES CORGSEQF.
  4415         10  CORGSEQA PIC  X(0001).
  4416     05  CORGSEQI PIC  X(0004).
  4417*    -------------------------------
  4418     05  CREFHDGL PIC S9(0004) COMP.
  4419     05  CREFHDGF PIC  X(0001).
  4420     05  FILLER REDEFINES CREFHDGF.
  4421         10  CREFHDGA PIC  X(0001).
  4422     05  CREFHDGI PIC  X(0010).
  4423*    -------------------------------
  4424     05  CREFL PIC S9(0004) COMP.
  4425     05  CREFF PIC  X(0001).
  4426     05  FILLER REDEFINES CREFF.
  4427         10  CREFA PIC  X(0001).
  4428     05  CREFI PIC  X(0012).
  4429*    -------------------------------
  4430     05  CNHINTL PIC S9(0004) COMP.
  4431     05  CNHINTF PIC  X(0001).
  4432     05  FILLER REDEFINES CNHINTF.
  4433         10  CNHINTA PIC  X(0001).
  4434     05  CNHINTI PIC  9(7)V99.
  4435*    -------------------------------
  4436     05  CCERTNOL PIC S9(0004) COMP.
  4437     05  CCERTNOF PIC  X(0001).
  4438     05  FILLER REDEFINES CCERTNOF.
  4439         10  CCERTNOA PIC  X(0001).
  4440     05  CCERTNOI PIC  X(0010).
  4441*    -------------------------------
  4442     05  CSUFIXL PIC S9(0004) COMP.
  4443     05  CSUFIXF PIC  X(0001).
  4444     05  FILLER REDEFINES CSUFIXF.
  4445         10  CSUFIXA PIC  X(0001).
  4446     05  CSUFIXI PIC  X(0001).
  4447*    -------------------------------
  4448     05  CEFFDTL PIC S9(0004) COMP.
  4449     05  CEFFDTF PIC  X(0001).
  4450     05  FILLER REDEFINES CEFFDTF.
  4451         10  CEFFDTA PIC  X(0001).
  4452     05  CEFFDTI PIC  X(0008).
  4453*    -------------------------------
  4454     05  CLSTNML PIC S9(0004) COMP.
  4455     05  CLSTNMF PIC  X(0001).
  4456     05  FILLER REDEFINES CLSTNMF.
  4457         10  CLSTNMA PIC  X(0001).
  4458     05  CLSTNMI PIC  X(0015).
  4459*    -------------------------------
  4460     05  CPCYNL PIC S9(0004) COMP.
  4461     05  CPCYNF PIC  X(0001).
  4462     05  FILLER REDEFINES CPCYNF.
  4463         10  CPCYNA PIC  X(0001).
  4464     05  CPCYNI PIC  X(0001).
  4465*    -------------------------------
  4466     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  85
* EL6311.cbl
  4467     05  CINAMEF PIC  X(0001).
  4468     05  FILLER REDEFINES CINAMEF.
  4469         10  CINAMEA PIC  X(0001).
  4470     05  CINAMEI PIC  X(0015).
  4471*    -------------------------------
  4472     05  CINITSL PIC S9(0004) COMP.
  4473     05  CINITSF PIC  X(0001).
  4474     05  FILLER REDEFINES CINITSF.
  4475         10  CINITSA PIC  X(0001).
  4476     05  CINITSI PIC  X(0010).
  4477*    -------------------------------
  4478     05  CCANREAL PIC S9(0004) COMP.
  4479     05  CCANREAF PIC  X(0001).
  4480     05  FILLER REDEFINES CCANREAF.
  4481         10  CCANREAA PIC  X(0001).
  4482     05  CCANREAI PIC  X(0001).
  4483*    -------------------------------
  4484     05  CKIND1L PIC S9(0004) COMP.
  4485     05  CKIND1F PIC  X(0001).
  4486     05  FILLER REDEFINES CKIND1F.
  4487         10  CKIND1A PIC  X(0001).
  4488     05  CKIND1I PIC  X(0002).
  4489*    -------------------------------
  4490     05  CCANDT1L PIC S9(0004) COMP.
  4491     05  CCANDT1F PIC  X(0001).
  4492     05  FILLER REDEFINES CCANDT1F.
  4493         10  CCANDT1A PIC  X(0001).
  4494     05  CCANDT1I PIC  X(0008).
  4495*    -------------------------------
  4496     05  CREFND1L PIC S9(0004) COMP.
  4497     05  CREFND1F PIC  X(0001).
  4498     05  FILLER REDEFINES CREFND1F.
  4499         10  CREFND1A PIC  X(0001).
  4500     05  CREFND1I PIC  S9(9)V99.
  4501*    -------------------------------
  4502     05  CMTHD1L PIC S9(0004) COMP.
  4503     05  CMTHD1F PIC  X(0001).
  4504     05  FILLER REDEFINES CMTHD1F.
  4505         10  CMTHD1A PIC  X(0001).
  4506     05  CMTHD1I PIC  X(0001).
  4507*    -------------------------------
  4508     05  CKIND2L PIC S9(0004) COMP.
  4509     05  CKIND2F PIC  X(0001).
  4510     05  FILLER REDEFINES CKIND2F.
  4511         10  CKIND2A PIC  X(0001).
  4512     05  CKIND2I PIC  X(0002).
  4513*    -------------------------------
  4514     05  CCANDT2L PIC S9(0004) COMP.
  4515     05  CCANDT2F PIC  X(0001).
  4516     05  FILLER REDEFINES CCANDT2F.
  4517         10  CCANDT2A PIC  X(0001).
  4518     05  CCANDT2I PIC  X(0008).
  4519*    -------------------------------
  4520     05  CREFND2L PIC S9(0004) COMP.
  4521     05  CREFND2F PIC  X(0001).
  4522     05  FILLER REDEFINES CREFND2F.
  4523         10  CREFND2A PIC  X(0001).
  4524     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  86
* EL6311.cbl
  4525*    -------------------------------
  4526     05  CMTHD2L PIC S9(0004) COMP.
  4527     05  CMTHD2F PIC  X(0001).
  4528     05  FILLER REDEFINES CMTHD2F.
  4529         10  CMTHD2A PIC  X(0001).
  4530     05  CMTHD2I PIC  X(0001).
  4531*    -------------------------------
  4532     05  CLIVESL PIC S9(0004) COMP.
  4533     05  CLIVESF PIC  X(0001).
  4534     05  FILLER REDEFINES CLIVESF.
  4535         10  CLIVESA PIC  X(0001).
  4536     05  CLIVESI PIC  X(0003).
  4537*    -------------------------------
  4538     05  CFORCEL PIC S9(0004) COMP.
  4539     05  CFORCEF PIC  X(0001).
  4540     05  FILLER REDEFINES CFORCEF.
  4541         10  CFORCEA PIC  X(0001).
  4542     05  CFORCEI PIC  X(0001).
  4543*    -------------------------------
  4544     05  CBILCDL PIC S9(0004) COMP.
  4545     05  CBILCDF PIC  X(0001).
  4546     05  FILLER REDEFINES CBILCDF.
  4547         10  CBILCDA PIC  X(0001).
  4548     05  CBILCDI PIC  X(0001).
  4549*    -------------------------------
  4550     05  CCRFND1L PIC S9(0004) COMP.
  4551     05  CCRFND1F PIC  X(0001).
  4552     05  FILLER REDEFINES CCRFND1F.
  4553         10  CCRFND1A PIC  X(0001).
  4554     05  CCRFND1I PIC  X(0011).
  4555*    -------------------------------
  4556     05  CCRFND2L PIC S9(0004) COMP.
  4557     05  CCRFND2F PIC  X(0001).
  4558     05  FILLER REDEFINES CCRFND2F.
  4559         10  CCRFND2A PIC  X(0001).
  4560     05  CCRFND2I PIC  X(0011).
  4561*    -------------------------------
  4562     05  CBILIT1L PIC S9(0004) COMP.
  4563     05  CBILIT1F PIC  X(0001).
  4564     05  FILLER REDEFINES CBILIT1F.
  4565         10  CBILIT1A PIC  X(0001).
  4566     05  CBILIT1I PIC  X(0008).
  4567*    -------------------------------
  4568     05  CDRFND1L PIC S9(0004) COMP.
  4569     05  CDRFND1F PIC  X(0001).
  4570     05  FILLER REDEFINES CDRFND1F.
  4571         10  CDRFND1A PIC  X(0001).
  4572     05  CDRFND1I PIC  X(0011).
  4573*    -------------------------------
  4574     05  CBILIT2L PIC S9(0004) COMP.
  4575     05  CBILIT2F PIC  X(0001).
  4576     05  FILLER REDEFINES CBILIT2F.
  4577         10  CBILIT2A PIC  X(0001).
  4578     05  CBILIT2I PIC  X(0008).
  4579*    -------------------------------
  4580     05  CDRFND2L PIC S9(0004) COMP.
  4581     05  CDRFND2F PIC  X(0001).
  4582     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  87
* EL6311.cbl
  4583         10  CDRFND2A PIC  X(0001).
  4584     05  CDRFND2I PIC  X(0011).
  4585*    -------------------------------
  4586     05  CCANTXTL PIC S9(0004) COMP.
  4587     05  CCANTXTF PIC  X(0001).
  4588     05  FILLER REDEFINES CCANTXTF.
  4589         10  CCANTXTA PIC  X(0001).
  4590     05  CCANTXTI PIC  X(0005).
  4591*    -------------------------------
  4592     05  CCANFEEL PIC S9(0004) COMP.
  4593     05  CCANFEEF PIC  X(0001).
  4594     05  FILLER REDEFINES CCANFEEF.
  4595         10  CCANFEEA PIC  X(0001).
  4596     05  CCANFEEI PIC  X(0002).
  4597*    -------------------------------
  4598     05  CTERM1L PIC S9(0004) COMP.
  4599     05  CTERM1F PIC  X(0001).
  4600     05  FILLER REDEFINES CTERM1F.
  4601         10  CTERM1A PIC  X(0001).
  4602     05  CTERM1I PIC  X(0003).
  4603*    -------------------------------
  4604     05  CRTERM1L PIC S9(0004) COMP.
  4605     05  CRTERM1F PIC  X(0001).
  4606     05  FILLER REDEFINES CRTERM1F.
  4607         10  CRTERM1A PIC  X(0001).
  4608     05  CRTERM1I PIC  X(0003).
  4609*    -------------------------------
  4610     05  CPREM1L PIC S9(0004) COMP.
  4611     05  CPREM1F PIC  X(0001).
  4612     05  FILLER REDEFINES CPREM1F.
  4613         10  CPREM1A PIC  X(0001).
  4614     05  CPREM1I PIC  X(0011).
  4615*    -------------------------------
  4616     05  CTERM2L PIC S9(0004) COMP.
  4617     05  CTERM2F PIC  X(0001).
  4618     05  FILLER REDEFINES CTERM2F.
  4619         10  CTERM2A PIC  X(0001).
  4620     05  CTERM2I PIC  X(0003).
  4621*    -------------------------------
  4622     05  CRTERM2L PIC S9(0004) COMP.
  4623     05  CRTERM2F PIC  X(0001).
  4624     05  FILLER REDEFINES CRTERM2F.
  4625         10  CRTERM2A PIC  X(0001).
  4626     05  CRTERM2I PIC  X(0003).
  4627*    -------------------------------
  4628     05  CPREM2L PIC S9(0004) COMP.
  4629     05  CPREM2F PIC  X(0001).
  4630     05  FILLER REDEFINES CPREM2F.
  4631         10  CPREM2A PIC  X(0001).
  4632     05  CPREM2I PIC  X(0011).
  4633*    -------------------------------
  4634     05  CENTRDTL PIC S9(0004) COMP.
  4635     05  CENTRDTF PIC  X(0001).
  4636     05  FILLER REDEFINES CENTRDTF.
  4637         10  CENTRDTA PIC  X(0001).
  4638     05  CENTRDTI PIC  X(0008).
  4639*    -------------------------------
  4640     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  88
* EL6311.cbl
  4641     05  CPAYEEF PIC  X(0001).
  4642     05  FILLER REDEFINES CPAYEEF.
  4643         10  CPAYEEA PIC  X(0001).
  4644     05  CPAYEEI PIC  X(0006).
  4645*    -------------------------------
  4646     05  CRFNDSWL PIC S9(0004) COMP.
  4647     05  CRFNDSWF PIC  X(0001).
  4648     05  FILLER REDEFINES CRFNDSWF.
  4649         10  CRFNDSWA PIC  X(0001).
  4650     05  CRFNDSWI PIC  X(0003).
  4651*    -------------------------------
  4652     05  CLFHDGL PIC S9(0004) COMP.
  4653     05  CLFHDGF PIC  X(0001).
  4654     05  FILLER REDEFINES CLFHDGF.
  4655         10  CLFHDGA PIC  X(0001).
  4656     05  CLFHDGI PIC  X(0006).
  4657*    -------------------------------
  4658     05  CAHHDGL PIC S9(0004) COMP.
  4659     05  CAHHDGF PIC  X(0001).
  4660     05  FILLER REDEFINES CAHHDGF.
  4661         10  CAHHDGA PIC  X(0001).
  4662     05  CAHHDGI PIC  X(0006).
  4663*    -------------------------------
  4664     05  CENTDTL PIC S9(0004) COMP.
  4665     05  CENTDTF PIC  X(0001).
  4666     05  FILLER REDEFINES CENTDTF.
  4667         10  CENTDTA PIC  X(0001).
  4668     05  CENTDTI PIC  X(0008).
  4669*    -------------------------------
  4670     05  CENTBYL PIC S9(0004) COMP.
  4671     05  CENTBYF PIC  X(0001).
  4672     05  FILLER REDEFINES CENTBYF.
  4673         10  CENTBYA PIC  X(0001).
  4674     05  CENTBYI PIC  X(0004).
  4675*    -------------------------------
  4676     05  CCHGCNTL PIC S9(0004) COMP.
  4677     05  CCHGCNTF PIC  X(0001).
  4678     05  FILLER REDEFINES CCHGCNTF.
  4679         10  CCHGCNTA PIC  X(0001).
  4680     05  CCHGCNTI PIC  X(0003).
  4681*    -------------------------------
  4682     05  CLFREFNL PIC S9(0004) COMP.
  4683     05  CLFREFNF PIC  X(0001).
  4684     05  FILLER REDEFINES CLFREFNF.
  4685         10  CLFREFNA PIC  X(0001).
  4686     05  CLFREFNI PIC  X(0006).
  4687*    -------------------------------
  4688     05  CAHREFNL PIC S9(0004) COMP.
  4689     05  CAHREFNF PIC  X(0001).
  4690     05  FILLER REDEFINES CAHREFNF.
  4691         10  CAHREFNA PIC  X(0001).
  4692     05  CAHREFNI PIC  X(0006).
  4693*    -------------------------------
  4694     05  CREINCDL PIC S9(0004) COMP.
  4695     05  CREINCDF PIC  X(0001).
  4696     05  FILLER REDEFINES CREINCDF.
  4697         10  CREINCDA PIC  X(0001).
  4698     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  89
* EL6311.cbl
  4699*    -------------------------------
  4700     05  CAEFFDTL PIC S9(0004) COMP.
  4701     05  CAEFFDTF PIC  X(0001).
  4702     05  FILLER REDEFINES CAEFFDTF.
  4703         10  CAEFFDTA PIC  X(0001).
  4704     05  CAEFFDTI PIC  X(0008).
  4705*    -------------------------------
  4706     05  CAEXPDTL PIC S9(0004) COMP.
  4707     05  CAEXPDTF PIC  X(0001).
  4708     05  FILLER REDEFINES CAEXPDTF.
  4709         10  CAEXPDTA PIC  X(0001).
  4710     05  CAEXPDTI PIC  X(0008).
  4711*    -------------------------------
  4712     05  COMMLFL PIC S9(0004) COMP.
  4713     05  COMMLFF PIC  X(0001).
  4714     05  FILLER REDEFINES COMMLFF.
  4715         10  COMMLFA PIC  X(0001).
  4716     05  COMMLFI PIC  X(0006).
  4717*    -------------------------------
  4718     05  COMMAHL PIC S9(0004) COMP.
  4719     05  COMMAHF PIC  X(0001).
  4720     05  FILLER REDEFINES COMMAHF.
  4721         10  COMMAHA PIC  X(0001).
  4722     05  COMMAHI PIC  X(0006).
  4723*    -------------------------------
  4724     05  CERMSG1L PIC S9(0004) COMP.
  4725     05  CERMSG1F PIC  X(0001).
  4726     05  FILLER REDEFINES CERMSG1F.
  4727         10  CERMSG1A PIC  X(0001).
  4728     05  CERMSG1I PIC  X(0078).
  4729*    -------------------------------
  4730     05  CERMSG2L PIC S9(0004) COMP.
  4731     05  CERMSG2F PIC  X(0001).
  4732     05  FILLER REDEFINES CERMSG2F.
  4733         10  CERMSG2A PIC  X(0001).
  4734     05  CERMSG2I PIC  X(0078).
  4735*    -------------------------------
  4736     05  CERMSG3L PIC S9(0004) COMP.
  4737     05  CERMSG3F PIC  X(0001).
  4738     05  FILLER REDEFINES CERMSG3F.
  4739         10  CERMSG3A PIC  X(0001).
  4740     05  CERMSG3I PIC  X(0078).
  4741*    -------------------------------
  4742     05  CPFENTRL PIC S9(0004) COMP.
  4743     05  CPFENTRF PIC  X(0001).
  4744     05  FILLER REDEFINES CPFENTRF.
  4745         10  CPFENTRA PIC  X(0001).
  4746     05  CPFENTRI PIC  9(2).
  4747*    -------------------------------
  4748     05  CPF5HDRL PIC S9(0004) COMP.
  4749     05  CPF5HDRF PIC  X(0001).
  4750     05  FILLER REDEFINES CPF5HDRF.
  4751         10  CPF5HDRA PIC  X(0001).
  4752     05  CPF5HDRI PIC  X(0005).
  4753*    -------------------------------
  4754     05  CPF4HDRL PIC S9(0004) COMP.
  4755     05  CPF4HDRF PIC  X(0001).
  4756     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  90
* EL6311.cbl
  4757         10  CPF4HDRA PIC  X(0001).
  4758     05  CPF4HDRI PIC  X(0013).
  4759*    -------------------------------
  4760     05  CF15HDRL PIC S9(0004) COMP.
  4761     05  CF15HDRF PIC  X(0001).
  4762     05  FILLER REDEFINES CF15HDRF.
  4763         10  CF15HDRA PIC  X(0001).
  4764     05  CF15HDRI PIC  X(0022).
  4765 01  EL631CO REDEFINES EL631BI.
  4766     05  FILLER            PIC  X(0012).
  4767*    -------------------------------
  4768     05  FILLER            PIC  X(0003).
  4769     05  CDATEO PIC  X(0008).
  4770*    -------------------------------
  4771     05  FILLER            PIC  X(0003).
  4772     05  CTIMEO PIC  99.99.
  4773*    -------------------------------
  4774     05  FILLER            PIC  X(0003).
  4775     05  CHEADO PIC  X(0038).
  4776*    -------------------------------
  4777     05  FILLER            PIC  X(0003).
  4778     05  CCHGTO PIC  X(0004).
  4779*    -------------------------------
  4780     05  FILLER            PIC  X(0003).
  4781     05  CCHGO PIC  ZZZ9.
  4782*    -------------------------------
  4783     05  FILLER            PIC  X(0003).
  4784     05  CMAINTO PIC  X(0001).
  4785*    -------------------------------
  4786     05  FILLER            PIC  X(0003).
  4787     05  CMANTBYO PIC  X(0004).
  4788*    -------------------------------
  4789     05  FILLER            PIC  X(0003).
  4790     05  CCHGHDGO PIC  X(0003).
  4791*    -------------------------------
  4792     05  FILLER            PIC  X(0003).
  4793     05  CMANTDTO PIC  X(0008).
  4794*    -------------------------------
  4795     05  FILLER            PIC  X(0003).
  4796     05  CMANTATO PIC  99.99.
  4797*    -------------------------------
  4798     05  FILLER            PIC  X(0003).
  4799     05  CCSRO PIC  X(0004).
  4800*    -------------------------------
  4801     05  FILLER            PIC  X(0003).
  4802     05  CBATCHO PIC  X(0006).
  4803*    -------------------------------
  4804     05  FILLER            PIC  X(0003).
  4805     05  CSEQO PIC  X(0004).
  4806*    -------------------------------
  4807     05  FILLER            PIC  X(0003).
  4808     05  CMOENDTO PIC  X(0008).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  CCARRO PIC  X(0001).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  91
* EL6311.cbl
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CSTATEO PIC  X(0002).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CACCTO PIC  X(0010).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CORIGHDO PIC  X(0011).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CORGNOO PIC  X(0006).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CORGSEQO PIC  X(0004).
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CREFHDGO PIC  X(0010).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CREFO PIC  X(0012).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CNHINTO PIC  999999.99.
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CCERTNOO PIC  X(0010).
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CSUFIXO PIC  X(0001).
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CEFFDTO PIC  X(0008).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CLSTNMO PIC  X(0015).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CPCYNO PIC  X(0001).
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CINAMEO PIC  X(0015).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CINITSO PIC  X(0010).
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CCANREAO PIC  X(0001).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CKIND1O PIC  X(0002).
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CCANDT1O PIC  X(0008).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CREFND1O PIC  Z(7).99-.
  4872*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  92
* EL6311.cbl
  4873     05  FILLER            PIC  X(0003).
  4874     05  CMTHD1O PIC  X(0001).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CKIND2O PIC  X(0002).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CCANDT2O PIC  X(0008).
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CREFND2O PIC  Z(7).99-.
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CMTHD2O PIC  X(0001).
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CLIVESO PIC  X(0003).
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CFORCEO PIC  X(0001).
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CBILCDO PIC  X(0001).
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CCRFND1O PIC  Z(7).99-.
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CCRFND2O PIC  Z(7).99-.
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CBILIT1O PIC  X(0008).
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CDRFND1O PIC  Z(7).99-.
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CBILIT2O PIC  X(0008).
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CDRFND2O PIC  Z(7).99-.
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CCANTXTO PIC  X(0005).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CCANFEEO PIC  Z9.
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CTERM1O PIC  ZZ9.
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CRTERM1O PIC  ZZ9.
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CPREM1O PIC  ZZZZZZ9.99-.
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  93
* EL6311.cbl
  4931     05  CTERM2O PIC  ZZ9.
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CRTERM2O PIC  ZZ9.
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CPREM2O PIC  ZZZZZZ9.99-.
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CENTRDTO PIC  X(0008).
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CPAYEEO PIC  X(0006).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CRFNDSWO PIC  X(0003).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CLFHDGO PIC  X(0006).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CAHHDGO PIC  X(0006).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CENTDTO PIC  X(0008).
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CENTBYO PIC  X(0004).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CCHGCNTO PIC  X(0003).
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CLFREFNO PIC  X(0006).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CAHREFNO PIC  X(0006).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CREINCDO PIC  X(0003).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CAEFFDTO PIC  X(0008).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CAEXPDTO PIC  X(0008).
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  COMMLFO PIC  .99999.
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  COMMAHO PIC  .99999.
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CERMSG1O PIC  X(0078).
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  94
* EL6311.cbl
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CERMSG3O PIC  X(0078).
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CPFENTRO PIC  X(0002).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CPF5HDRO PIC  X(0005).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CPF4HDRO PIC  X(0013).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CF15HDRO PIC  X(0022).
  5004*    -------------------------------
  5005 01  EL631DI REDEFINES EL631BI.
  5006     05  FILLER            PIC  X(0012).
  5007*    -------------------------------
  5008     05  DDATEL PIC S9(0004) COMP.
  5009     05  DDATEF PIC  X(0001).
  5010     05  FILLER REDEFINES DDATEF.
  5011         10  DDATEA PIC  X(0001).
  5012     05  DDATEI PIC  X(0008).
  5013*    -------------------------------
  5014     05  DTIMEL PIC S9(0004) COMP.
  5015     05  DTIMEF PIC  X(0001).
  5016     05  FILLER REDEFINES DTIMEF.
  5017         10  DTIMEA PIC  X(0001).
  5018     05  DTIMEI PIC  X(0005).
  5019*    -------------------------------
  5020     05  DHEADL PIC S9(0004) COMP.
  5021     05  DHEADF PIC  X(0001).
  5022     05  FILLER REDEFINES DHEADF.
  5023         10  DHEADA PIC  X(0001).
  5024     05  DHEADI PIC  X(0038).
  5025*    -------------------------------
  5026     05  DLDATEL PIC S9(0004) COMP.
  5027     05  DLDATEF PIC  X(0001).
  5028     05  FILLER REDEFINES DLDATEF.
  5029         10  DLDATEA PIC  X(0001).
  5030     05  DLDATEI PIC  X(0010).
  5031*    -------------------------------
  5032     05  DBATCHL PIC S9(0004) COMP.
  5033     05  DBATCHF PIC  X(0001).
  5034     05  FILLER REDEFINES DBATCHF.
  5035         10  DBATCHA PIC  X(0001).
  5036     05  DBATCHI PIC  X(0011).
  5037*    -------------------------------
  5038     05  DACCTNML PIC S9(0004) COMP.
  5039     05  DACCTNMF PIC  X(0001).
  5040     05  FILLER REDEFINES DACCTNMF.
  5041         10  DACCTNMA PIC  X(0001).
  5042     05  DACCTNMI PIC  X(0030).
  5043*    -------------------------------
  5044     05  DPROCDTL PIC S9(0004) COMP.
  5045     05  DPROCDTF PIC  X(0001).
  5046     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  95
* EL6311.cbl
  5047         10  DPROCDTA PIC  X(0001).
  5048     05  DPROCDTI PIC  X(0008).
  5049*    -------------------------------
  5050     05  DINPUTL PIC S9(0004) COMP.
  5051     05  DINPUTF PIC  X(0001).
  5052     05  FILLER REDEFINES DINPUTF.
  5053         10  DINPUTA PIC  X(0001).
  5054     05  DINPUTI PIC  X(0008).
  5055*    -------------------------------
  5056     05  DMAINDTL PIC S9(0004) COMP.
  5057     05  DMAINDTF PIC  X(0001).
  5058     05  FILLER REDEFINES DMAINDTF.
  5059         10  DMAINDTA PIC  X(0001).
  5060     05  DMAINDTI PIC  X(0008).
  5061*    -------------------------------
  5062     05  DCARRL PIC S9(0004) COMP.
  5063     05  DCARRF PIC  X(0001).
  5064     05  FILLER REDEFINES DCARRF.
  5065         10  DCARRA PIC  X(0001).
  5066     05  DCARRI PIC  X(0001).
  5067*    -------------------------------
  5068     05  DGROUPL PIC S9(0004) COMP.
  5069     05  DGROUPF PIC  X(0001).
  5070     05  FILLER REDEFINES DGROUPF.
  5071         10  DGROUPA PIC  X(0001).
  5072     05  DGROUPI PIC  X(0006).
  5073*    -------------------------------
  5074     05  DSTATEL PIC S9(0004) COMP.
  5075     05  DSTATEF PIC  X(0001).
  5076     05  FILLER REDEFINES DSTATEF.
  5077         10  DSTATEA PIC  X(0001).
  5078     05  DSTATEI PIC  X(0002).
  5079*    -------------------------------
  5080     05  DACCTL PIC S9(0004) COMP.
  5081     05  DACCTF PIC  X(0001).
  5082     05  FILLER REDEFINES DACCTF.
  5083         10  DACCTA PIC  X(0001).
  5084     05  DACCTI PIC  X(0010).
  5085*    -------------------------------
  5086     05  DRECVDTL PIC S9(0004) COMP.
  5087     05  DRECVDTF PIC  X(0001).
  5088     05  FILLER REDEFINES DRECVDTF.
  5089         10  DRECVDTA PIC  X(0001).
  5090     05  DRECVDTI PIC  X(0008).
  5091*    -------------------------------
  5092     05  DCSRL PIC S9(0004) COMP.
  5093     05  DCSRF PIC  X(0001).
  5094     05  FILLER REDEFINES DCSRF.
  5095         10  DCSRA PIC  X(0001).
  5096     05  DCSRI PIC  X(0004).
  5097*    -------------------------------
  5098     05  DREFHDGL PIC S9(0004) COMP.
  5099     05  DREFHDGF PIC  X(0001).
  5100     05  FILLER REDEFINES DREFHDGF.
  5101         10  DREFHDGA PIC  X(0001).
  5102     05  DREFHDGI PIC  X(0010).
  5103*    -------------------------------
  5104     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  96
* EL6311.cbl
  5105     05  DREFF PIC  X(0001).
  5106     05  FILLER REDEFINES DREFF.
  5107         10  DREFA PIC  X(0001).
  5108     05  DREFI PIC  X(0012).
  5109*    -------------------------------
  5110     05  DLFPHDGL PIC S9(0004) COMP.
  5111     05  DLFPHDGF PIC  X(0001).
  5112     05  FILLER REDEFINES DLFPHDGF.
  5113         10  DLFPHDGA PIC  X(0001).
  5114     05  DLFPHDGI PIC  X(0010).
  5115*    -------------------------------
  5116     05  DAHPHDGL PIC S9(0004) COMP.
  5117     05  DAHPHDGF PIC  X(0001).
  5118     05  FILLER REDEFINES DAHPHDGF.
  5119         10  DAHPHDGA PIC  X(0001).
  5120     05  DAHPHDGI PIC  X(0010).
  5121*    -------------------------------
  5122     05  DLFRHDGL PIC S9(0004) COMP.
  5123     05  DLFRHDGF PIC  X(0001).
  5124     05  FILLER REDEFINES DLFRHDGF.
  5125         10  DLFRHDGA PIC  X(0001).
  5126     05  DLFRHDGI PIC  X(0009).
  5127*    -------------------------------
  5128     05  DAHRHDGL PIC S9(0004) COMP.
  5129     05  DAHRHDGF PIC  X(0001).
  5130     05  FILLER REDEFINES DAHRHDGF.
  5131         10  DAHRHDGA PIC  X(0001).
  5132     05  DAHRHDGI PIC  X(0009).
  5133*    -------------------------------
  5134     05  DRISSL PIC S9(0004) COMP.
  5135     05  DRISSF PIC  X(0001).
  5136     05  FILLER REDEFINES DRISSF.
  5137         10  DRISSA PIC  X(0001).
  5138     05  DRISSI PIC  X(0005).
  5139*    -------------------------------
  5140     05  DRLFPRML PIC S9(0004) COMP.
  5141     05  DRLFPRMF PIC  X(0001).
  5142     05  FILLER REDEFINES DRLFPRMF.
  5143         10  DRLFPRMA PIC  X(0001).
  5144     05  DRLFPRMI PIC  S9(9)V99.
  5145*    -------------------------------
  5146     05  DRAHPRML PIC S9(0004) COMP.
  5147     05  DRAHPRMF PIC  X(0001).
  5148     05  FILLER REDEFINES DRAHPRMF.
  5149         10  DRAHPRMA PIC  X(0001).
  5150     05  DRAHPRMI PIC  S9(9)V99.
  5151*    -------------------------------
  5152     05  DRCANCL PIC S9(0004) COMP.
  5153     05  DRCANCF PIC  X(0001).
  5154     05  FILLER REDEFINES DRCANCF.
  5155         10  DRCANCA PIC  X(0001).
  5156     05  DRCANCI PIC  X(0005).
  5157*    -------------------------------
  5158     05  DRLFRFDL PIC S9(0004) COMP.
  5159     05  DRLFRFDF PIC  X(0001).
  5160     05  FILLER REDEFINES DRLFRFDF.
  5161         10  DRLFRFDA PIC  X(0001).
  5162     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  97
* EL6311.cbl
  5163*    -------------------------------
  5164     05  DRAHRFDL PIC S9(0004) COMP.
  5165     05  DRAHRFDF PIC  X(0001).
  5166     05  FILLER REDEFINES DRAHRFDF.
  5167         10  DRAHRFDA PIC  X(0001).
  5168     05  DRAHRFDI PIC  S9(9)V99.
  5169*    -------------------------------
  5170     05  DEISSL PIC S9(0004) COMP.
  5171     05  DEISSF PIC  X(0001).
  5172     05  FILLER REDEFINES DEISSF.
  5173         10  DEISSA PIC  X(0001).
  5174     05  DEISSI PIC  X(0005).
  5175*    -------------------------------
  5176     05  DELFPRML PIC S9(0004) COMP.
  5177     05  DELFPRMF PIC  X(0001).
  5178     05  FILLER REDEFINES DELFPRMF.
  5179         10  DELFPRMA PIC  X(0001).
  5180     05  DELFPRMI PIC  X(0011).
  5181*    -------------------------------
  5182     05  DEAHPRML PIC S9(0004) COMP.
  5183     05  DEAHPRMF PIC  X(0001).
  5184     05  FILLER REDEFINES DEAHPRMF.
  5185         10  DEAHPRMA PIC  X(0001).
  5186     05  DEAHPRMI PIC  X(0011).
  5187*    -------------------------------
  5188     05  DECANCL PIC S9(0004) COMP.
  5189     05  DECANCF PIC  X(0001).
  5190     05  FILLER REDEFINES DECANCF.
  5191         10  DECANCA PIC  X(0001).
  5192     05  DECANCI PIC  X(0005).
  5193*    -------------------------------
  5194     05  DELFRFDL PIC S9(0004) COMP.
  5195     05  DELFRFDF PIC  X(0001).
  5196     05  FILLER REDEFINES DELFRFDF.
  5197         10  DELFRFDA PIC  X(0001).
  5198     05  DELFRFDI PIC  X(0011).
  5199*    -------------------------------
  5200     05  DEAHRFDL PIC S9(0004) COMP.
  5201     05  DEAHRFDF PIC  X(0001).
  5202     05  FILLER REDEFINES DEAHRFDF.
  5203         10  DEAHRFDA PIC  X(0001).
  5204     05  DEAHRFDI PIC  X(0011).
  5205*    -------------------------------
  5206     05  DCISSL PIC S9(0004) COMP.
  5207     05  DCISSF PIC  X(0001).
  5208     05  FILLER REDEFINES DCISSF.
  5209         10  DCISSA PIC  X(0001).
  5210     05  DCISSI PIC  X(0005).
  5211*    -------------------------------
  5212     05  DCLFPRML PIC S9(0004) COMP.
  5213     05  DCLFPRMF PIC  X(0001).
  5214     05  FILLER REDEFINES DCLFPRMF.
  5215         10  DCLFPRMA PIC  X(0001).
  5216     05  DCLFPRMI PIC  X(0011).
  5217*    -------------------------------
  5218     05  DCAHPRML PIC S9(0004) COMP.
  5219     05  DCAHPRMF PIC  X(0001).
  5220     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  98
* EL6311.cbl
  5221         10  DCAHPRMA PIC  X(0001).
  5222     05  DCAHPRMI PIC  X(0011).
  5223*    -------------------------------
  5224     05  DCCANCL PIC S9(0004) COMP.
  5225     05  DCCANCF PIC  X(0001).
  5226     05  FILLER REDEFINES DCCANCF.
  5227         10  DCCANCA PIC  X(0001).
  5228     05  DCCANCI PIC  X(0005).
  5229*    -------------------------------
  5230     05  DCLFRFDL PIC S9(0004) COMP.
  5231     05  DCLFRFDF PIC  X(0001).
  5232     05  FILLER REDEFINES DCLFRFDF.
  5233         10  DCLFRFDA PIC  X(0001).
  5234     05  DCLFRFDI PIC  X(0011).
  5235*    -------------------------------
  5236     05  DCAHRFDL PIC S9(0004) COMP.
  5237     05  DCAHRFDF PIC  X(0001).
  5238     05  FILLER REDEFINES DCAHRFDF.
  5239         10  DCAHRFDA PIC  X(0001).
  5240     05  DCAHRFDI PIC  X(0011).
  5241*    -------------------------------
  5242     05  DOISSL PIC S9(0004) COMP.
  5243     05  DOISSF PIC  X(0001).
  5244     05  FILLER REDEFINES DOISSF.
  5245         10  DOISSA PIC  X(0001).
  5246     05  DOISSI PIC  X(0005).
  5247*    -------------------------------
  5248     05  DOLFPRML PIC S9(0004) COMP.
  5249     05  DOLFPRMF PIC  X(0001).
  5250     05  FILLER REDEFINES DOLFPRMF.
  5251         10  DOLFPRMA PIC  X(0001).
  5252     05  DOLFPRMI PIC  X(0011).
  5253*    -------------------------------
  5254     05  DOAHPRML PIC S9(0004) COMP.
  5255     05  DOAHPRMF PIC  X(0001).
  5256     05  FILLER REDEFINES DOAHPRMF.
  5257         10  DOAHPRMA PIC  X(0001).
  5258     05  DOAHPRMI PIC  X(0011).
  5259*    -------------------------------
  5260     05  DOCANCL PIC S9(0004) COMP.
  5261     05  DOCANCF PIC  X(0001).
  5262     05  FILLER REDEFINES DOCANCF.
  5263         10  DOCANCA PIC  X(0001).
  5264     05  DOCANCI PIC  X(0005).
  5265*    -------------------------------
  5266     05  DOLFRFDL PIC S9(0004) COMP.
  5267     05  DOLFRFDF PIC  X(0001).
  5268     05  FILLER REDEFINES DOLFRFDF.
  5269         10  DOLFRFDA PIC  X(0001).
  5270     05  DOLFRFDI PIC  X(0011).
  5271*    -------------------------------
  5272     05  DOAHRFDL PIC S9(0004) COMP.
  5273     05  DOAHRFDF PIC  X(0001).
  5274     05  FILLER REDEFINES DOAHRFDF.
  5275         10  DOAHRFDA PIC  X(0001).
  5276     05  DOAHRFDI PIC  X(0011).
  5277*    -------------------------------
  5278     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page  99
* EL6311.cbl
  5279     05  DITOTALF PIC  X(0001).
  5280     05  FILLER REDEFINES DITOTALF.
  5281         10  DITOTALA PIC  X(0001).
  5282     05  DITOTALI PIC  X(0005).
  5283*    -------------------------------
  5284     05  DIFATALL PIC S9(0004) COMP.
  5285     05  DIFATALF PIC  X(0001).
  5286     05  FILLER REDEFINES DIFATALF.
  5287         10  DIFATALA PIC  X(0001).
  5288     05  DIFATALI PIC  X(0005).
  5289*    -------------------------------
  5290     05  DIFORCEL PIC S9(0004) COMP.
  5291     05  DIFORCEF PIC  X(0001).
  5292     05  FILLER REDEFINES DIFORCEF.
  5293         10  DIFORCEA PIC  X(0001).
  5294     05  DIFORCEI PIC  X(0005).
  5295*    -------------------------------
  5296     05  DIHOLDL PIC S9(0004) COMP.
  5297     05  DIHOLDF PIC  X(0001).
  5298     05  FILLER REDEFINES DIHOLDF.
  5299         10  DIHOLDA PIC  X(0001).
  5300     05  DIHOLDI PIC  X(0005).
  5301*    -------------------------------
  5302     05  DIAVAILL PIC S9(0004) COMP.
  5303     05  DIAVAILF PIC  X(0001).
  5304     05  FILLER REDEFINES DIAVAILF.
  5305         10  DIAVAILA PIC  X(0001).
  5306     05  DIAVAILI PIC  X(0005).
  5307*    -------------------------------
  5308     05  DIGPREML PIC S9(0004) COMP.
  5309     05  DIGPREMF PIC  X(0001).
  5310     05  FILLER REDEFINES DIGPREMF.
  5311         10  DIGPREMA PIC  X(0001).
  5312     05  DIGPREMI PIC  X(0011).
  5313*    -------------------------------
  5314     05  DIBPREML PIC S9(0004) COMP.
  5315     05  DIBPREMF PIC  X(0001).
  5316     05  FILLER REDEFINES DIBPREMF.
  5317         10  DIBPREMA PIC  X(0001).
  5318     05  DIBPREMI PIC  X(0011).
  5319*    -------------------------------
  5320     05  DCTOTALL PIC S9(0004) COMP.
  5321     05  DCTOTALF PIC  X(0001).
  5322     05  FILLER REDEFINES DCTOTALF.
  5323         10  DCTOTALA PIC  X(0001).
  5324     05  DCTOTALI PIC  X(0005).
  5325*    -------------------------------
  5326     05  DCFATALL PIC S9(0004) COMP.
  5327     05  DCFATALF PIC  X(0001).
  5328     05  FILLER REDEFINES DCFATALF.
  5329         10  DCFATALA PIC  X(0001).
  5330     05  DCFATALI PIC  X(0005).
  5331*    -------------------------------
  5332     05  DCFORCEL PIC S9(0004) COMP.
  5333     05  DCFORCEF PIC  X(0001).
  5334     05  FILLER REDEFINES DCFORCEF.
  5335         10  DCFORCEA PIC  X(0001).
  5336     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 100
* EL6311.cbl
  5337*    -------------------------------
  5338     05  DCHOLDL PIC S9(0004) COMP.
  5339     05  DCHOLDF PIC  X(0001).
  5340     05  FILLER REDEFINES DCHOLDF.
  5341         10  DCHOLDA PIC  X(0001).
  5342     05  DCHOLDI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DCAVAILL PIC S9(0004) COMP.
  5345     05  DCAVAILF PIC  X(0001).
  5346     05  FILLER REDEFINES DCAVAILF.
  5347         10  DCAVAILA PIC  X(0001).
  5348     05  DCAVAILI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DCGPREML PIC S9(0004) COMP.
  5351     05  DCGPREMF PIC  X(0001).
  5352     05  FILLER REDEFINES DCGPREMF.
  5353         10  DCGPREMA PIC  X(0001).
  5354     05  DCGPREMI PIC  X(0011).
  5355*    -------------------------------
  5356     05  DCBPREML PIC S9(0004) COMP.
  5357     05  DCBPREMF PIC  X(0001).
  5358     05  FILLER REDEFINES DCBPREMF.
  5359         10  DCBPREMA PIC  X(0001).
  5360     05  DCBPREMI PIC  X(0011).
  5361*    -------------------------------
  5362     05  DNTOTALL PIC S9(0004) COMP.
  5363     05  DNTOTALF PIC  X(0001).
  5364     05  FILLER REDEFINES DNTOTALF.
  5365         10  DNTOTALA PIC  X(0001).
  5366     05  DNTOTALI PIC  X(0005).
  5367*    -------------------------------
  5368     05  DNFATALL PIC S9(0004) COMP.
  5369     05  DNFATALF PIC  X(0001).
  5370     05  FILLER REDEFINES DNFATALF.
  5371         10  DNFATALA PIC  X(0001).
  5372     05  DNFATALI PIC  X(0005).
  5373*    -------------------------------
  5374     05  DNFORCEL PIC S9(0004) COMP.
  5375     05  DNFORCEF PIC  X(0001).
  5376     05  FILLER REDEFINES DNFORCEF.
  5377         10  DNFORCEA PIC  X(0001).
  5378     05  DNFORCEI PIC  X(0005).
  5379*    -------------------------------
  5380     05  DNHOLDL PIC S9(0004) COMP.
  5381     05  DNHOLDF PIC  X(0001).
  5382     05  FILLER REDEFINES DNHOLDF.
  5383         10  DNHOLDA PIC  X(0001).
  5384     05  DNHOLDI PIC  X(0005).
  5385*    -------------------------------
  5386     05  DNAVAILL PIC S9(0004) COMP.
  5387     05  DNAVAILF PIC  X(0001).
  5388     05  FILLER REDEFINES DNAVAILF.
  5389         10  DNAVAILA PIC  X(0001).
  5390     05  DNAVAILI PIC  X(0005).
  5391*    -------------------------------
  5392     05  DNGPREML PIC S9(0004) COMP.
  5393     05  DNGPREMF PIC  X(0001).
  5394     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 101
* EL6311.cbl
  5395         10  DNGPREMA PIC  X(0001).
  5396     05  DNGPREMI PIC  X(0011).
  5397*    -------------------------------
  5398     05  DNBPREML PIC S9(0004) COMP.
  5399     05  DNBPREMF PIC  X(0001).
  5400     05  FILLER REDEFINES DNBPREMF.
  5401         10  DNBPREMA PIC  X(0001).
  5402     05  DNBPREMI PIC  X(0011).
  5403*    -------------------------------
  5404     05  DERMSGL PIC S9(0004) COMP.
  5405     05  DERMSGF PIC  X(0001).
  5406     05  FILLER REDEFINES DERMSGF.
  5407         10  DERMSGA PIC  X(0001).
  5408     05  DERMSGI PIC  X(0075).
  5409*    -------------------------------
  5410     05  DPFENTRL PIC S9(0004) COMP.
  5411     05  DPFENTRF PIC  X(0001).
  5412     05  FILLER REDEFINES DPFENTRF.
  5413         10  DPFENTRA PIC  X(0001).
  5414     05  DPFENTRI PIC  9(2).
  5415 01  EL631DO REDEFINES EL631BI.
  5416     05  FILLER            PIC  X(0012).
  5417*    -------------------------------
  5418     05  FILLER            PIC  X(0003).
  5419     05  DDATEO PIC  X(0008).
  5420*    -------------------------------
  5421     05  FILLER            PIC  X(0003).
  5422     05  DTIMEO PIC  99.99.
  5423*    -------------------------------
  5424     05  FILLER            PIC  X(0003).
  5425     05  DHEADO PIC  X(0038).
  5426*    -------------------------------
  5427     05  FILLER            PIC  X(0003).
  5428     05  DLDATEO PIC  X(0010).
  5429*    -------------------------------
  5430     05  FILLER            PIC  X(0003).
  5431     05  DBATCHO PIC  X(0011).
  5432*    -------------------------------
  5433     05  FILLER            PIC  X(0003).
  5434     05  DACCTNMO PIC  X(0030).
  5435*    -------------------------------
  5436     05  FILLER            PIC  X(0003).
  5437     05  DPROCDTO PIC  X(0008).
  5438*    -------------------------------
  5439     05  FILLER            PIC  X(0003).
  5440     05  DINPUTO PIC  X(0008).
  5441*    -------------------------------
  5442     05  FILLER            PIC  X(0003).
  5443     05  DMAINDTO PIC  X(0008).
  5444*    -------------------------------
  5445     05  FILLER            PIC  X(0003).
  5446     05  DCARRO PIC  X(0001).
  5447*    -------------------------------
  5448     05  FILLER            PIC  X(0003).
  5449     05  DGROUPO PIC  X(0006).
  5450*    -------------------------------
  5451     05  FILLER            PIC  X(0003).
  5452     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 102
* EL6311.cbl
  5453*    -------------------------------
  5454     05  FILLER            PIC  X(0003).
  5455     05  DACCTO PIC  X(0010).
  5456*    -------------------------------
  5457     05  FILLER            PIC  X(0003).
  5458     05  DRECVDTO PIC  X(0008).
  5459*    -------------------------------
  5460     05  FILLER            PIC  X(0003).
  5461     05  DCSRO PIC  X(0004).
  5462*    -------------------------------
  5463     05  FILLER            PIC  X(0003).
  5464     05  DREFHDGO PIC  X(0010).
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DREFO PIC  X(0012).
  5468*    -------------------------------
  5469     05  FILLER            PIC  X(0003).
  5470     05  DLFPHDGO PIC  X(0010).
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DAHPHDGO PIC  X(0010).
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DLFRHDGO PIC  X(0009).
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DAHRHDGO PIC  X(0009).
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DRISSO PIC  ZZ99-.
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DRCANCO PIC  ZZ99-.
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DEISSO PIC  ZZ99-.
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DECANCO PIC  ZZ99-.
  5510*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 103
* EL6311.cbl
  5511     05  FILLER            PIC  X(0003).
  5512     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DCISSO PIC  ZZ99-.
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DCCANCO PIC  ZZ99-.
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DOISSO PIC  ZZ99-.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DOCANCO PIC  ZZ99-.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DITOTALO PIC  ZZZ99.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DIFATALO PIC  ZZZ99.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DIFORCEO PIC  ZZZ99.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DIHOLDO PIC  ZZZ99.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DIAVAILO PIC  ZZZ99.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 104
* EL6311.cbl
  5569     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DCTOTALO PIC  ZZZ99.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DCFATALO PIC  ZZZ99.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DCFORCEO PIC  ZZZ99.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
  5584     05  DCHOLDO PIC  ZZZ99.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DCAVAILO PIC  ZZZ99.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DNTOTALO PIC  ---99.
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DNFATALO PIC  ---99.
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DNFORCEO PIC  ---99.
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DNHOLDO PIC  ---99.
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DNAVAILO PIC  ---99.
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DNGPREMO PIC  -------9.99.
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DNBPREMO PIC  -------9.99.
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DERMSGO PIC  X(0075).
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DPFENTRO PIC  X(0002).
  5621*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 105
* EL6311.cbl
  5623 01  MAP-B REDEFINES EL631BI.
  5624     12  FILLER                  PIC X(569).
  5625*    12  FILLER                  PIC X(512).
  5626*    12  FILLER                  PIC X(510).
  5627     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5628         16  BKIND-LEN               PIC S9(4)  COMP.
  5629         16  BKIND-ATTRB             PIC X.
  5630         16  BKIND                   PIC XX.
  5631         16  BTYPE-LEN               PIC S9(4)  COMP.
  5632         16  BTYPE-ATTRB             PIC X.
  5633         16  BTYPE                   PIC X(3).
  5634         16  BTERM-LEN               PIC S9(4)  COMP.
  5635         16  BTERM-ATTRB             PIC X.
  5636         16  BTERMI                  PIC 999.
  5637         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5638         16  BBEN-LEN                PIC S9(4)  COMP.
  5639         16  BBEN-ATTRB              PIC X.
  5640         16  BBENI                   PIC 9(10)V99.
  5641*        16  BBENI                   PIC 9(12).
  5642         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5643         16  BPREM-LEN               PIC S9(4)  COMP.
  5644         16  BPREM-ATTRB             PIC X.
  5645         16  BPREMI                  PIC S9(9)V99.
  5646*        16  BPREMI                  PIC 9(11).
  5647         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5648         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5649         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5650         16  BEXPIRE-ATTRB           PIC X.
  5651         16  BEXPIRE                 PIC X(8).
  5652         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5653         16  BCRIT-PERD-ATTRB        PIC X.
  5654         16  BCRIT-PERDI             PIC 99.
  5655         16  BCRIT-PERDO REDEFINES
  5656                         BCRIT-PERDI PIC ZZ.
  5657         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5658         16  BALT-BEN-ATTRB          PIC X.
  5659         16  BALT-BENI               PIC 9(10)V99.
  5660*        16  BALT-BENI               PIC 9(12).
  5661         16  BALT-BENO REDEFINES
  5662                           BALT-BENI PIC Z(9).ZZ.
  5663         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5664         16  BALT-PREM-ATTRB         PIC X.
  5665         16  BALT-PREMI              PIC 9(9)V99.
  5666*        16  BALT-PREMI              PIC 9(11).
  5667         16  BALT-PREMO REDEFINES
  5668                          BALT-PREMI PIC Z(7).ZZ-.
  5669         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5670         16  BBEN-CD-ATTRB           PIC X.
  5671         16  BBEN-CD                 PIC XXX.
  5672         16  BCPREM-LEN              PIC S9(4)  COMP.
  5673         16  BCPREM-ATTRB            PIC X.
  5674         16  BCPREMI                 PIC S9(9)V99.
  5675*        16  BCPREMI                 PIC X(11).
  5676         16  BCPREMO REDEFINES BCPREMI
  5677                                     PIC Z(7).99-.
  5678         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5679         16  BCALT-PREM-ATTRB        PIC X.
  5680         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 106
* EL6311.cbl
  5681         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5682         16  BBEN-ABBR-ATTRB         PIC X.
  5683         16  BBEN-ABBR               PIC X(5).
  5684         16  BDIFF-LEN               PIC S9(4)  COMP.
  5685         16  BDIFF-ATTRB             PIC X.
  5686         16  BDIFFO                  PIC Z(7).99-.
  5687         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5688         16  BBILL-LIT-ATTRB         PIC X.
  5689         16  BBILL-LIT               PIC X(8).
  5690         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5691         16  BDALT-PREM-ATTRB        PIC X.
  5692         16  BDALT-PREM              PIC Z(7).99-.
  5693
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 107
* EL6311.cbl
  5695
  5696****************************************************************
  5697*
  5698* Copyright (c) 2007 by Clerity Solutions, Inc.
  5699* All rights reserved.
  5700*
  5701****************************************************************
  5702 01  DFHEIV.
  5703   02  DFHEIV0               PIC X(35).
  5704   02  DFHEIV1               PIC X(08).
  5705   02  DFHEIV2               PIC X(08).
  5706   02  DFHEIV3               PIC X(08).
  5707   02  DFHEIV4               PIC X(06).
  5708   02  DFHEIV5               PIC X(04).
  5709   02  DFHEIV6               PIC X(04).
  5710   02  DFHEIV7               PIC X(02).
  5711   02  DFHEIV8               PIC X(02).
  5712   02  DFHEIV9               PIC X(01).
  5713   02  DFHEIV10              PIC S9(7) COMP-3.
  5714   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5715   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5716   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5717   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5718   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5719   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5720   02  DFHEIV17              PIC X(04).
  5721   02  DFHEIV18              PIC X(04).
  5722   02  DFHEIV19              PIC X(04).
  5723   02  DFHEIV20              USAGE IS POINTER.
  5724   02  DFHEIV21              USAGE IS POINTER.
  5725   02  DFHEIV22              USAGE IS POINTER.
  5726   02  DFHEIV23              USAGE IS POINTER.
  5727   02  DFHEIV24              USAGE IS POINTER.
  5728   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5729   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5730   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5731   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5732   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5733   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5734   02  FILLER                PIC X(02).
  5735   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5736   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5737   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5738   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5739   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5740 LINKAGE  SECTION.
  5741*****************************************************************
  5742*                                                               *
  5743* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5744* All rights reserved.                                          *
  5745*                                                               *
  5746*****************************************************************
  5747 01  dfheiblk.
  5748     02  eibtime          pic s9(7) comp-3.
  5749     02  eibdate          pic s9(7) comp-3.
  5750     02  eibtrnid         pic x(4).
  5751     02  eibtaskn         pic s9(7) comp-3.
  5752     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 108
* EL6311.cbl
  5753     02  dfheigdi         pic s9(4) comp.
  5754     02  eibcposn         pic s9(4) comp.
  5755     02  eibcalen         pic s9(4) comp.
  5756     02  eibaid           pic x(1).
  5757     02  eibfiller1       pic x(1).
  5758     02  eibfn            pic x(2).
  5759     02  eibfiller2       pic x(2).
  5760     02  eibrcode         pic x(6).
  5761     02  eibfiller3       pic x(2).
  5762     02  eibds            pic x(8).
  5763     02  eibreqid         pic x(8).
  5764     02  eibrsrce         pic x(8).
  5765     02  eibsync          pic x(1).
  5766     02  eibfree          pic x(1).
  5767     02  eibrecv          pic x(1).
  5768     02  eibsend          pic x(1).
  5769     02  eibatt           pic x(1).
  5770     02  eibeoc           pic x(1).
  5771     02  eibfmh           pic x(1).
  5772     02  eibcompl         pic x(1).
  5773     02  eibsig           pic x(1).
  5774     02  eibconf          pic x(1).
  5775     02  eiberr           pic x(1).
  5776     02  eibrldbk         pic x(1).
  5777     02  eiberrcd         pic x(4).
  5778     02  eibsynrb         pic x(1).
  5779     02  eibnodat         pic x(1).
  5780     02  eibfiller5       pic x(2).
  5781     02  eibresp          pic 9(09) comp.
  5782     02  eibresp2         pic 9(09) comp.
  5783     02  dfheigdj         pic s9(4) comp.
  5784     02  dfheigdk         pic s9(4) comp.
  5785 01  DFHCOMMAREA                 PIC X(1300).
  5786*                                COPY ERCPNDB.
  5787******************************************************************
  5788*                                                                *
  5789*                                                                *
  5790*                            ERCPNDB.                            *
  5791*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5792*                            VMOD=2.025                          *
  5793*                                                                *
  5794*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5795*                                                                *
  5796******************************************************************
  5797*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5798*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5799******************************************************************
  5800*                                                                *
  5801*                                                                *
  5802*   FILE TYPE = VSAM,KSDS                                        *
  5803*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5804*                                                                *
  5805*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5806*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5807*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5808*                                                 RKP=13,LEN=36  *
  5809*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5810*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 109
* EL6311.cbl
  5811*                                                RKP=49,LEN=11   *
  5812*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5813*                                      AND CHG-SEQ.)             *
  5814*                                                RKP=60,LEN=15   *
  5815*                                                                *
  5816*   LOG = NO                                                     *
  5817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5818******************************************************************
  5819******************************************************************
  5820*                   C H A N G E   L O G
  5821*
  5822* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5823*-----------------------------------------------------------------
  5824*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5825* EFFECTIVE    NUMBER
  5826*-----------------------------------------------------------------
  5827* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5828* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5829* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5830* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5831* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5832* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5833* 032306                   PEMA  ADD BOW LOAN NUMBER
  5834* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5835* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5836* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5837* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5838* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5839* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5840* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5841* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5842******************************************************************
  5843
  5844 01  PENDING-BUSINESS.
  5845     12  PB-RECORD-ID                     PIC XX.
  5846         88  VALID-PB-ID                        VALUE 'PB'.
  5847
  5848     12  PB-CONTROL-PRIMARY.
  5849         16  PB-COMPANY-CD                PIC X.
  5850         16  PB-ENTRY-BATCH               PIC X(6).
  5851         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5852         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5853
  5854     12  PB-CONTROL-BY-ACCOUNT.
  5855         16  PB-COMPANY-CD-A1             PIC X.
  5856         16  PB-CARRIER                   PIC X.
  5857         16  PB-GROUPING.
  5858             20  PB-GROUPING-PREFIX       PIC XXX.
  5859             20  PB-GROUPING-PRIME        PIC XXX.
  5860         16  PB-STATE                     PIC XX.
  5861         16  PB-ACCOUNT.
  5862             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5863             20  PB-ACCOUNT-PRIME         PIC X(6).
  5864         16  PB-CERT-EFF-DT               PIC XX.
  5865         16  PB-CERT-NO.
  5866             20  PB-CERT-PRIME            PIC X(10).
  5867             20  PB-CERT-SFX              PIC X.
  5868         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 110
* EL6311.cbl
  5869
  5870         16  PB-RECORD-TYPE               PIC X.
  5871             88  PB-MAILING-DATA                VALUE '0'.
  5872             88  PB-ISSUE                       VALUE '1'.
  5873             88  PB-CANCELLATION                VALUE '2'.
  5874             88  PB-BATCH-TRAILER               VALUE '9'.
  5875
  5876     12  PB-CONTROL-BY-ORIG-BATCH.
  5877         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5878         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5879         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5880         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5881
  5882     12  PB-CONTROL-BY-CSR.
  5883         16  PB-CSR-COMPANY-CD            PIC X.
  5884         16  PB-CSR-ID                    PIC X(4).
  5885         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5886         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5887         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5888******************************************************************
  5889*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5890******************************************************************
  5891
  5892     12  PB-LAST-MAINT-DT                 PIC XX.
  5893     12  PB-LAST-MAINT-BY                 PIC X(4).
  5894     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5895
  5896     12  PB-RECORD-BODY                   PIC X(375).
  5897
  5898     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5899         16  PB-CERT-ORIGIN               PIC X.
  5900             88  CLASIC-CREATED-CERT         VALUE '1'.
  5901         16  PB-I-NAME.
  5902             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5903             20  PB-I-INSURED-FIRST-NAME.
  5904                 24  PB-I-INSURED-1ST-INIT PIC X.
  5905                 24  FILLER                PIC X(9).
  5906             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5907         16  PB-I-AGE                     PIC S99   COMP-3.
  5908         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5909         16  PB-I-BIRTHDAY                PIC XX.
  5910         16  PB-I-INSURED-SEX             PIC X.
  5911             88  PB-SEX-MALE     VALUE 'M'.
  5912             88  PB-SEX-FEMALE   VALUE 'F'.
  5913
  5914         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5915         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5916         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5917         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5918         16  PB-I-SKIP-CODE               PIC X.
  5919             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5920             88  PB-SKIP-JULY              VALUE '1'.
  5921             88  PB-SKIP-AUGUST            VALUE '2'.
  5922             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5923             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5924             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5925             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5926             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 111
* EL6311.cbl
  5927             88  PB-SKIP-JUNE              VALUE '8'.
  5928             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5929             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5930             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5931         16  PB-I-TERM-TYPE               PIC X.
  5932             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5933             88  PB-PAID-WEEKLY            VALUE 'W'.
  5934             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5935             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5936             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5937         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5938         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5939         16  PB-I-DATA-ENTRY-SW           PIC X.
  5940             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5941             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5942             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5943             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5944         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5945         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5946*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5947         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5948         16  FILLER                       PIC X.
  5949
  5950         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5951             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5952             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5953                                                   '90' THRU '99'.
  5954         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5955                                          PIC XX.
  5956         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5957         16  PB-I-AMOUNT-FINANCED REDEFINES
  5958                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5959         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5960         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5961                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5962         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5963         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5964         16  PB-I-CLP-AMOUNT REDEFINES
  5965                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5966         16  PB-I-LF-CALC-FLAG            PIC X.
  5967             88 PB-COMP-LF-PREM               VALUE '?'.
  5968         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5969         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5970         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5971         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5972         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5973         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5974         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5975         16  PB-I-LF-ABBR                 PIC XXX.
  5976         16  PB-I-LF-INPUT-CD             PIC XX.
  5977
  5978         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5979             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5980             88  PB-INVALID-AH               VALUE '  ' '00'
  5981                                                   '90' THRU '99'.
  5982         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5983         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5984         16  PB-I-AH-CALC-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 112
* EL6311.cbl
  5985             88 PB-COMP-AH-PREM                  VALUE '?'.
  5986         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5987         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5988         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5989         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5990         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5991         16  PB-I-AH-ABBR                 PIC XXX.
  5992         16  PB-I-AH-INPUT-CD             PIC XXX.
  5993
  5994         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5995         16  PB-I-REIN-TABLE              PIC XXX.
  5996         16  PB-I-BUSINESS-TYPE           PIC 99.
  5997         16  PB-I-INDV-GRP-CD             PIC X.
  5998         16  PB-I-MORT-CODE.
  5999             20  PB-I-TABLE               PIC X.
  6000             20  PB-I-INTEREST            PIC XX.
  6001             20  PB-I-MORT-TYP            PIC X.
  6002         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6003         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6004         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6005         16  PB-I-INDV-GRP-OVRD           PIC X.
  6006         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6007         16  PB-I-SIG-SW                  PIC X.
  6008             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6009         16  PB-I-RATE-CLASS              PIC XX.
  6010         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6011         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6012         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6013         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6014         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6015         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6016         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6017         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6018         16  PB-I-OB-FLAG                 PIC X.
  6019             88  PB-I-OB                      VALUE 'B'.
  6020             88  PB-I-SUMMARY                 VALUE 'Z'.
  6021         16  PB-I-ENTRY-STATUS            PIC X.
  6022             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6023                                              'M' '5' '9' '2'.
  6024             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6025             88  PB-I-POLICY-PENDING          VALUE '2'.
  6026             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6027             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6028             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6029             88  PB-I-REIN-ONLY               VALUE '9'.
  6030             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6031             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6032             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6033             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6034         16  PB-I-INT-CODE                PIC X.
  6035             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6036             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6037         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6038         16  PB-I-SOC-SEC-NO              PIC X(11).
  6039         16  PB-I-MEMBER-NO               PIC X(12).
  6040         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6041*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6042         16  PB-I-OLD-LOF                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 113
* EL6311.cbl
  6043         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6044         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6045         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6046         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6047         16  PB-I-LIFE-INDICATOR          PIC X.
  6048             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6049         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6050         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6051                                          PIC S9(5)V99    COMP-3.
  6052         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6053             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6054             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6055         16  PB-I-1ST-PMT-DT              PIC XX.
  6056         16  PB-I-JOINT-INSURED.
  6057             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6058             20 PB-I-JOINT-FIRST-NAME.
  6059                24  PB-I-JOINT-FIRST-INIT PIC X.
  6060                24  FILLER                PIC X(9).
  6061             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6062*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6063         16  PB-I-BENEFICIARY-NAME.
  6064             20  PB-I-BANK-NUMBER         PIC X(10).
  6065             20  FILLER                   PIC X(15).
  6066         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6067         16  PB-I-REFERENCE               PIC X(12).
  6068         16  FILLER REDEFINES PB-I-REFERENCE.
  6069             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6070             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6071             20  PB-I-CLP-STATE           PIC XX.
  6072         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6073             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6074             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6075             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6076         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6077         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6078         16  PB-I-RESIDENT-STATE          PIC XX.
  6079         16  PB-I-RATE-CODE               PIC X(4).
  6080         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6081         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6082         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6083         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6084         16  PB-I-BANK-NOCHRGB            PIC 99.
  6085         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6086         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6087
  6088     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6089         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6090             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6091         16  PB-C-CANCEL-ORIGIN           PIC X.
  6092             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6093         16  PB-C-LF-CANCEL-DT            PIC XX.
  6094         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6095         16  PB-C-LF-CALC-REQ             PIC X.
  6096             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6097         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6098         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6099         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6100             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 114
* EL6311.cbl
  6101         16  PB-C-AH-CANCEL-DT            PIC XX.
  6102         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6103         16  PB-C-AH-CALC-REQ             PIC X.
  6104             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6105         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6106         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6107         16  PB-C-LAST-NAME               PIC X(15).
  6108         16  PB-C-REFUND-SW               PIC X.
  6109             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6110             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6111         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6112         16  PB-C-PAYEE-CODE              PIC X(6).
  6113         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6114         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6115         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6116         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6117         16  PB-C-REFERENCE               PIC X(12).
  6118         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6119         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6120         16  PB-C-POST-CARD-IND           PIC X.
  6121         16  PB-C-CANCEL-REASON           PIC X.
  6122         16  PB-C-REF-INTERFACE-SW        PIC X.
  6123         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6124         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6125         16  FILLER                       PIC X(01).
  6126*        16  FILLER                       PIC X(18).
  6127         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6128*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6129         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6130         16  PB-CANCELED-CERT-DATA.
  6131             20  PB-CI-INSURED-NAME.
  6132                 24  PB-CI-LAST-NAME      PIC X(15).
  6133                 24  PB-CI-INITIALS       PIC XX.
  6134             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6135             20  PB-CI-INSURED-SEX        PIC X.
  6136             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6137             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6138             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6139             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6140             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6141             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6142             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6143             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6144             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6145             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6146             20  PB-CI-RATE-CLASS         PIC XX.
  6147             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6148             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6149             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6150             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6151             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6152             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6153             20  PB-CI-LF-ABBR            PIC X(3).
  6154             20  PB-CI-AH-ABBR            PIC X(3).
  6155             20  PB-CI-OB-FLAG            PIC X.
  6156                 88  PB-CI-OB                VALUE 'B'.
  6157             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6158                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 115
* EL6311.cbl
  6159                                           'M' '4' '5' '9' '2'.
  6160                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6161                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6162                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6163                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6164                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6165                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6166                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6167                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6168                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6169                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6170                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6171                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6172             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6173                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6174                                           'M' '4' '5' '9' '2'.
  6175                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6176                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6177                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6178                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6179                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6180                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6181                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6182                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6183                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6184                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6185                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6186                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6187             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6188             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6189             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6190             20  PB-CI-MEMBER-NO          PIC X(12).
  6191             20  PB-CI-INT-CODE           PIC X.
  6192                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6193                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6194             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6195             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6196             20  PB-CI-COMP-EXCP-SW       PIC X.
  6197                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6198                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6199             20  PB-CI-ENTRY-STATUS       PIC X.
  6200             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6201             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6202             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6203             20  PB-CI-DEATH-DT           PIC XX.
  6204             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6205             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6206             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6207             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6208             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6209             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6210             20  PB-CI-ENTRY-DT              PIC XX.
  6211             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6212             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6213             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6214             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6215             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6216             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 116
* EL6311.cbl
  6217*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6218             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6219             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6220             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6221             20  PB-CI-INDV-GRP-CD           PIC X.
  6222             20  PB-CI-BENEFICIARY-NAME.
  6223                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6224                 24  FILLER                  PIC X(15).
  6225             20  PB-CI-NOTE-SW               PIC X.
  6226             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6227             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6228             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6229             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6230             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6231             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6232             20  PB-CI-FIRST-NAME            PIC X(10).
  6233             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6234
  6235         16  FILLER                       PIC X(13).
  6236*032306  16  FILLER                       PIC X(27).
  6237*        16  FILLER                       PIC X(46).
  6238
  6239     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6240         16  FILLER                       PIC X(10).
  6241         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6242         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6243         16  PB-M-INSURED-MID-INIT        PIC X.
  6244         16  PB-M-INSURED-AGE             PIC 99.
  6245         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6246         16  PB-M-INSURED-SEX             PIC X.
  6247         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6248         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6249         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6250         16  PB-M-INSURED-CITY-STATE.
  6251             20  PB-M-INSURED-CITY        PIC X(28).
  6252             20  PB-M-INSURED-STATE       PIC XX.
  6253         16  PB-M-INSURED-ZIP-CODE.
  6254             20  PB-M-INSURED-ZIP-PRIME.
  6255                 24  PB-M-INSURED-ZIP-1   PIC X.
  6256                     88  PB-M-CANADIAN-POST-CODE
  6257                                             VALUE 'A' THRU 'Z'.
  6258                 24  FILLER               PIC X(4).
  6259             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6260         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6261                                        PB-M-INSURED-ZIP-CODE.
  6262             20  PM-M-INS-CAN-POST1       PIC XXX.
  6263             20  PM-M-INS-CAN-POST2       PIC XXX.
  6264             20  FILLER                   PIC XXX.
  6265         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6266         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6267         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6268         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6269         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6270         16  PB-M-CRED-BENE-CITYST.
  6271             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6272             20  PB-M-CRED-BENE-STATE     PIC XX.
  6273         16  FILLER                       PIC X(92).
  6274
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 117
* EL6311.cbl
  6275     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6276         16  FILLER                       PIC X(10).
  6277         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6278         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6279         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6280         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6281         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6282         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6283         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6284         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6285         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6286         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6287         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6288         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6289         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6290         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6291         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6292         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6293         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6294         16  PB-ACCOUNT-NAME              PIC X(30).
  6295         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6296         16  PB-REFERENCE                 PIC X(12).
  6297         16  PB-B-RECEIVED-DT             PIC XX.
  6298         16  FILLER                       PIC X(234).
  6299
  6300     12  PB-RECORD-STATUS.
  6301         16  PB-CREDIT-SELECT-DT          PIC XX.
  6302         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6303         16  PB-BILLED-DT                 PIC XX.
  6304         16  PB-BILLING-STATUS            PIC X.
  6305             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6306             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6307             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6308         16  PB-RECORD-BILL               PIC X.
  6309             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6310             88  PB-RECORD-RETURNED           VALUE 'R'.
  6311             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6312             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6313             88  PB-OVERRIDE-AH               VALUE 'A'.
  6314             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6315         16  PB-BATCH-ENTRY               PIC X.
  6316             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6317             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6318             88  PB-REISSUED-CERT             VALUE 'E'.
  6319             88  PB-MONTHLY-CERT              VALUE 'M'.
  6320             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6321             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6322             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6323         16  PB-FORCE-CODE                PIC X.
  6324             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6325             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6326             88  PB-CANCEL-FORCE              VALUE '8'.
  6327             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6328             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6329             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6330             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6331             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6332             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 118
* EL6311.cbl
  6333             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6334         16  PB-FATAL-FLAG                PIC X.
  6335             88  PB-FATAL-ERRORS              VALUE 'X'.
  6336         16  PB-FORCE-ER-CD               PIC X.
  6337             88  PB-FORCE-ERRORS              VALUE 'F'.
  6338             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6339         16  PB-WARN-ER-CD                PIC X.
  6340             88  PB-WARNING-ERRORS            VALUE 'W'.
  6341         16  FILLER                       PIC X.
  6342         16  PB-OUT-BAL-CD                PIC X.
  6343             88  PB-OUT-OF-BAL                VALUE 'O'.
  6344         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6345         16  PB-AH-OVERRIDE-L1            PIC X.
  6346         16  PB-INPUT-DT                  PIC XX.
  6347         16  PB-INPUT-BY                  PIC X(4).
  6348         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6349         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6350         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6351         16  PB-LF-EARNING-METHOD         PIC X.
  6352         16  PB-AH-EARNING-METHOD         PIC X.
  6353         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6354         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6355         16  PB-REIN-CD                   PIC XXX.
  6356         16  PB-LF-REFUND-TYPE            PIC X.
  6357         16  PB-AH-REFUND-TYPE            PIC X.
  6358         16  PB-ACCT-EFF-DT               PIC XX.
  6359         16  PB-ACCT-EXP-DT               PIC XX.
  6360         16  PB-COMPANY-ID                PIC X(3).
  6361         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6362         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6363         16  PB-SV-CARRIER                PIC X.
  6364         16  PB-SV-GROUPING               PIC X(6).
  6365         16  PB-SV-STATE                  PIC XX.
  6366         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6367         16  PB-GA-BILLING-INFO.
  6368             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6369                                          PIC XX.
  6370         16  PB-SV-REMIT-TO  REDEFINES
  6371             PB-GA-BILLING-INFO           PIC X(10).
  6372         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6373         16  PB-I-LOAN-OFFICER            PIC X(5).
  6374         16  PB-I-VIN                     PIC X(17).
  6375
  6376         16  FILLER                       PIC X(04).
  6377         16  IMNET-BYPASS-SW              PIC X.
  6378
  6379******************************************************************
  6380*                COMMON EDIT ERRORS                              *
  6381******************************************************************
  6382
  6383     12  PB-COMMON-ERRORS.
  6384         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6385                                           PIC S9(4)     COMP.
  6386
  6387******************************************************************
  6388*                                COPY ELCCERT.
  6389******************************************************************
  6390*                                                                *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 119
* EL6311.cbl
  6391*                            ELCCERT.                            *
  6392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6393*                            VMOD=2.013                          *
  6394*                                                                *
  6395*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6396*                                                                *
  6397*   FILE TYPE = VSAM,KSDS                                        *
  6398*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6399*                                                                *
  6400*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6401*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6402*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6403*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6404*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6405*                                                                *
  6406*   LOG = YES                                                    *
  6407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6408******************************************************************
  6409*                   C H A N G E   L O G
  6410*
  6411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6412*-----------------------------------------------------------------
  6413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6414* EFFECTIVE    NUMBER
  6415*-----------------------------------------------------------------
  6416* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6417* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6418* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6419* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6420* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6421* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6422* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6423* 032612  CR2011110200001  PEMA  AHL CHANGES
  6424******************************************************************
  6425
  6426 01  CERTIFICATE-MASTER.
  6427     12  CM-RECORD-ID                      PIC XX.
  6428         88  VALID-CM-ID                      VALUE 'CM'.
  6429
  6430     12  CM-CONTROL-PRIMARY.
  6431         16  CM-COMPANY-CD                 PIC X.
  6432         16  CM-CARRIER                    PIC X.
  6433         16  CM-GROUPING.
  6434             20  CM-GROUPING-PREFIX        PIC X(3).
  6435             20  CM-GROUPING-PRIME         PIC X(3).
  6436         16  CM-STATE                      PIC XX.
  6437         16  CM-ACCOUNT.
  6438             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6439             20  CM-ACCOUNT-PRIME          PIC X(6).
  6440         16  CM-CERT-EFF-DT                PIC XX.
  6441         16  CM-CERT-NO.
  6442             20  CM-CERT-PRIME             PIC X(10).
  6443             20  CM-CERT-SFX               PIC X.
  6444
  6445     12  CM-CONTROL-BY-NAME.
  6446         16  CM-COMPANY-CD-A1              PIC X.
  6447         16  CM-INSURED-LAST-NAME          PIC X(15).
  6448         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 120
* EL6311.cbl
  6449             20  CM-INSURED-INITIAL1       PIC X.
  6450             20  CM-INSURED-INITIAL2       PIC X.
  6451
  6452     12  CM-CONTROL-BY-SSN.
  6453         16  CM-COMPANY-CD-A2              PIC X.
  6454         16  CM-SOC-SEC-NO.
  6455             20  CM-SSN-STATE              PIC XX.
  6456             20  CM-SSN-ACCOUNT            PIC X(6).
  6457             20  CM-SSN-LN3.
  6458                 25  CM-INSURED-INITIALS-A2.
  6459                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6460                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6461                 25 CM-PART-LAST-NAME-A2         PIC X.
  6462
  6463     12  CM-CONTROL-BY-CERT-NO.
  6464         16  CM-COMPANY-CD-A4              PIC X.
  6465         16  CM-CERT-NO-A4                 PIC X(11).
  6466
  6467     12  CM-CONTROL-BY-MEMB.
  6468         16  CM-COMPANY-CD-A5              PIC X.
  6469         16  CM-MEMBER-NO.
  6470             20  CM-MEMB-STATE             PIC XX.
  6471             20  CM-MEMB-ACCOUNT           PIC X(6).
  6472             20  CM-MEMB-LN4.
  6473                 25  CM-INSURED-INITIALS-A5.
  6474                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6475                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6476                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6477
  6478     12  CM-INSURED-PROFILE-DATA.
  6479         16  CM-INSURED-FIRST-NAME.
  6480             20  CM-INSURED-1ST-INIT       PIC X.
  6481             20  FILLER                    PIC X(9).
  6482         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6483         16  CM-INSURED-SEX                PIC X.
  6484             88  CM-SEX-MALE                  VALUE 'M'.
  6485             88  CM-SEX-FEMAL                 VALUE 'F'.
  6486         16  CM-INSURED-JOINT-AGE          PIC 99.
  6487         16  CM-JOINT-INSURED-NAME.
  6488             20  CM-JT-LAST-NAME           PIC X(15).
  6489             20  CM-JT-FIRST-NAME.
  6490                 24  CM-JT-1ST-INIT        PIC X.
  6491                 24  FILLER                PIC X(9).
  6492             20  CM-JT-INITIAL             PIC X.
  6493
  6494     12  CM-LIFE-DATA.
  6495         16  CM-LF-BENEFIT-CD              PIC XX.
  6496         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6497         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6498         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6499         16  CM-LF-DEV-CODE                PIC XXX.
  6500         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6501         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6502         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6503         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6504         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6505         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6506         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 121
* EL6311.cbl
  6507         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6508         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6509         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6510         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6511         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6512         16  FILLER                        PIC XX.
  6513
  6514     12  CM-AH-DATA.
  6515         16  CM-AH-BENEFIT-CD              PIC XX.
  6516         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6517         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6518         16  CM-AH-DEV-CODE                PIC XXX.
  6519         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6520         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6521         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6522         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6523         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6524         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6525         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6526         16  CM-AH-PAID-THRU-DT            PIC XX.
  6527             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6528         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6529         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6530         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6531         16  FILLER                        PIC X.
  6532
  6533     12  CM-LOAN-INFORMATION.
  6534         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6535         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6536                                           PIC S9(5)V99  COMP-3.
  6537         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6538         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6539         16  CM-PAY-FREQUENCY              PIC S99.
  6540         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6541         16  CM-RATE-CLASS                 PIC XX.
  6542         16  CM-BENEFICIARY                PIC X(25).
  6543         16  CM-POLICY-FORM-NO             PIC X(12).
  6544         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6545         16  CM-LAST-ADD-ON-DT             PIC XX.
  6546         16  CM-DEDUCTIBLE-AMOUNTS.
  6547             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6548             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6549         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6550             20  CM-RESIDENT-STATE         PIC XX.
  6551             20  CM-RATE-CODE              PIC X(4).
  6552             20  FILLER                    PIC XX.
  6553         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6554             20  CM-LOAN-OFFICER           PIC X(5).
  6555             20  FILLER                    PIC XXX.
  6556         16  CM-CSR-CODE                   PIC XXX.
  6557         16  CM-UNDERWRITING-CODE          PIC X.
  6558             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6559         16  CM-POST-CARD-IND              PIC X.
  6560         16  CM-NH-INTERFACE-SW            PIC X.
  6561         16  CM-PREMIUM-TYPE               PIC X.
  6562             88  CM-SING-PRM                  VALUE '1'.
  6563             88  CM-O-B-COVERAGE              VALUE '2'.
  6564             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 122
* EL6311.cbl
  6565         16  CM-IND-GRP-TYPE               PIC X.
  6566             88  CM-INDIVIDUAL                VALUE 'I'.
  6567             88  CM-GROUP                     VALUE 'G'.
  6568         16  CM-SKIP-CODE                  PIC X.
  6569             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6570             88  SKIP-JULY                    VALUE '1'.
  6571             88  SKIP-AUGUST                  VALUE '2'.
  6572             88  SKIP-SEPTEMBER               VALUE '3'.
  6573             88  SKIP-JULY-AUG                VALUE '4'.
  6574             88  SKIP-AUG-SEPT                VALUE '5'.
  6575             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6576             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6577             88  SKIP-JUNE                    VALUE '8'.
  6578             88  SKIP-JUNE-JULY               VALUE '9'.
  6579             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6580             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6581         16  CM-PAYMENT-MODE               PIC X.
  6582             88  PAY-MONTHLY                  VALUE SPACE.
  6583             88  PAY-WEEKLY                   VALUE '1'.
  6584             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6585             88  PAY-BI-WEEKLY                VALUE '3'.
  6586             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6587         16  CM-LOAN-NUMBER                PIC X(8).
  6588         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6589         16  CM-OLD-LOF                    PIC XXX.
  6590*        16  CM-LOAN-OFFICER               PIC XXX.
  6591         16  CM-REIN-TABLE                 PIC XXX.
  6592         16  CM-SPECIAL-REIN-CODE          PIC X.
  6593         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6594         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6595         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6596
  6597     12  CM-STATUS-DATA.
  6598         16  CM-ENTRY-STATUS               PIC X.
  6599         16  CM-ENTRY-DT                   PIC XX.
  6600
  6601         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6602         16  CM-LF-CANCEL-DT               PIC XX.
  6603         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6604
  6605         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6606         16  CM-LF-DEATH-DT                PIC XX.
  6607         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6608
  6609         16  CM-LF-CURRENT-STATUS          PIC X.
  6610             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6611                                                'M' '4' '5' '9'.
  6612             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6613             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6614             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6615             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6616             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6617             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6618             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6619             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6620             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6621             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6622             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 123
* EL6311.cbl
  6623             88  CM-LF-VOIDED                 VALUE 'V'.
  6624
  6625         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6626         16  CM-AH-CANCEL-DT               PIC XX.
  6627         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6628
  6629         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6630         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6631         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6632
  6633         16  CM-AH-CURRENT-STATUS          PIC X.
  6634             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6635                                                'M' '4' '5' '9'.
  6636             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6637             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6638             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6639             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6640             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6641             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6642             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6643             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6644             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6645             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6646             88  CM-AH-DECLINED               VALUE 'D'.
  6647             88  CM-AH-VOIDED                 VALUE 'V'.
  6648
  6649         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6650             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6651             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6652             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6653         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6654
  6655         16  CM-ENTRY-BATCH                PIC X(6).
  6656         16  CM-LF-EXIT-BATCH              PIC X(6).
  6657         16  CM-AH-EXIT-BATCH              PIC X(6).
  6658         16  CM-LAST-MONTH-END             PIC XX.
  6659
  6660     12  CM-NOTE-SW                        PIC X.
  6661         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6662         88  CERT-NOTES-PRESENT               VALUE '1'.
  6663         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6664         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6665         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6666         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6667         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6668         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6669     12  CM-COMP-EXCP-SW                   PIC X.
  6670         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6671         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6672     12  CM-INSURED-ADDRESS-SW             PIC X.
  6673         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6674         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6675
  6676*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6677     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6678     12  FILLER                            PIC X.
  6679
  6680*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 124
* EL6311.cbl
  6681     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6682     12  FILLER                            PIC X.
  6683*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6684     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6685
  6686     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6687         88  CERT-ADDED-BATCH                 VALUE ' '.
  6688         88  CERT-ADDED-ONLINE                VALUE '1'.
  6689         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6690         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6691         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6692     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6693         88  CERT-AS-LOADED                   VALUE ' '.
  6694         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6695         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6696         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6697         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6698         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6699         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6700         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6701
  6702     12  CM-ACCOUNT-COMM-PCTS.
  6703         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6704         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6705
  6706     12  CM-USER-FIELD                     PIC X.
  6707     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6708     12  CM-CLP-STATE                      PIC XX.
  6709     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6710     12  CM-USER-RESERVED                  PIC XXX.
  6711     12  FILLER REDEFINES CM-USER-RESERVED.
  6712         16  CM-AH-CLASS-CD                PIC XX.
  6713         16  F                             PIC X.
  6714******************************************************************
  6715*                                COPY ERCNOTE.
  6716******************************************************************
  6717*                                                                *
  6718*                                                                *
  6719*                            ERCNOTE                             *
  6720*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6721*                            VMOD=2.003                          *
  6722*                                                                *
  6723*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6724*                                                                *
  6725*        FILE TYPE= VSAM,KSDS                                    *
  6726*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6727*                                                                *
  6728*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6729*                                                                *
  6730*        LOG = YES                                               *
  6731*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6732*                                                                *
  6733******************************************************************
  6734*                   C H A N G E   L O G
  6735*
  6736* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6737*-----------------------------------------------------------------
  6738*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 125
* EL6311.cbl
  6739* EFFECTIVE    NUMBER
  6740*-----------------------------------------------------------------
  6741* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6742*                                FILE WILL CONTAIN BILLING NOTES O
  6743******************************************************************
  6744
  6745 01  CERTIFICATE-NOTE.
  6746     12  CN-RECORD-ID                PIC  XX.
  6747         88  VALID-CN-ID                  VALUE 'CN'.
  6748
  6749     12  CN-CONTROL-PRIMARY.
  6750         16  CN-COMPANY-CD           PIC X.
  6751         16  CN-CARRIER              PIC X.
  6752         16  CN-GROUPING.
  6753             20 CN-GROUPING-PREFIX   PIC XXX.
  6754             20 CN-GROUPING-PRIME    PIC XXX.
  6755         16  CN-STATE                PIC XX.
  6756         16  CN-ACCOUNT.
  6757             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6758             20 CN-ACCOUNT-PRIME     PIC X(6).
  6759         16  CN-CERT-EFF-DT          PIC XX.
  6760         16  CN-CERT-NO.
  6761             20  CN-CERT-PRIME       PIC X(10).
  6762             20  CN-CERT-SFX         PIC X.
  6763
  6764     12  CN-BILLING-START-LINE-NO    PIC 99.
  6765     12  CN-BILLING-END-LINE-NO      PIC 99.
  6766
  6767     12  CN-LINES.
  6768         16  CN-LINE OCCURS 10       PIC X(77).
  6769
  6770     12  CN-LAST-MAINT-DT            PIC XX.
  6771     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6772     12  CN-LAST-MAINT-USER          PIC X(4).
  6773     12  FILLER                      PIC X(6).
  6774******************************************************************
  6775*                                COPY ERCPNDM.
  6776******************************************************************
  6777*                                                                *
  6778*                                                                *
  6779*                            ERCPNDM                             *
  6780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6781*                            VMOD=2.003                          *
  6782*                                                                *
  6783*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6784*                                                                *
  6785*   FILE TYPE = VSAM,KSDS                                        *
  6786*   RECORD SIZE = 374   RECFORM = FIX                            *
  6787*                                                                *
  6788*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6789*   ALTERNATE PATH    = NOT USED                                 *
  6790*                                                                *
  6791*   LOG = YES                                                    *
  6792*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6793******************************************************************
  6794*                   C H A N G E   L O G
  6795*
  6796* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 126
* EL6311.cbl
  6797*-----------------------------------------------------------------
  6798*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6799* EFFECTIVE    NUMBER
  6800*-----------------------------------------------------------------
  6801* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6802* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6803* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6804******************************************************************
  6805
  6806 01  PENDING-MAILING-DATA.
  6807     12  PM-RECORD-ID                      PIC XX.
  6808         88  VALID-MA-ID                       VALUE 'PM'.
  6809
  6810     12  PM-CONTROL-PRIMARY.
  6811         16  PM-COMPANY-CD                 PIC X.
  6812         16  PM-ENTRY-BATCH                PIC X(6).
  6813         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6814         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6815
  6816     12  FILLER                            PIC X(14).
  6817
  6818     12  PM-ACCESS-CONTROL.
  6819         16  PM-SOURCE-SYSTEM              PIC XX.
  6820             88  PM-FROM-CREDIT                VALUE 'CR'.
  6821             88  PM-FROM-VSI                   VALUE 'VS'.
  6822             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6823             88  PM-FROM-OTHER                 VALUE 'OT'.
  6824         16  PM-RECORD-ADD-DT              PIC XX.
  6825         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6826         16  PM-LAST-MAINT-DT              PIC XX.
  6827         16  PM-LAST-MAINT-BY              PIC XXXX.
  6828         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6829
  6830     12  PM-PROFILE-INFO.
  6831         16  PM-QUALIFY-CODE-1             PIC XX.
  6832         16  PM-QUALIFY-CODE-2             PIC XX.
  6833         16  PM-QUALIFY-CODE-3             PIC XX.
  6834         16  PM-QUALIFY-CODE-4             PIC XX.
  6835         16  PM-QUALIFY-CODE-5             PIC XX.
  6836
  6837         16  PM-INSURED-LAST-NAME          PIC X(15).
  6838         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6839         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6840         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6841         16  PM-INSURED-BIRTH-DT           PIC XX.
  6842         16  PM-INSURED-SEX                PIC X.
  6843             88  PM-SEX-MALE                   VALUE 'M'.
  6844             88  PM-SEX-FEMALE                 VALUE 'F'.
  6845         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6846
  6847         16  PM-ADDRESS-CORRECTED          PIC X.
  6848         16  PM-JOINT-BIRTH-DT             PIC XX.
  6849*        16  FILLER                        PIC X(12).
  6850
  6851         16  PM-ADDRESS-LINE-1             PIC X(30).
  6852         16  PM-ADDRESS-LINE-2             PIC X(30).
  6853         16  PM-CITY-STATE.
  6854             20  PM-CITY                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 127
* EL6311.cbl
  6855             20  PM-STATE                  PIC XX.
  6856         16  PM-ZIP.
  6857             20  PM-ZIP-CODE.
  6858                 24  PM-ZIP-1              PIC X.
  6859                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6860                 24  FILLER                PIC X(4).
  6861             20  PM-ZIP-PLUS4              PIC X(4).
  6862         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6863             20  PM-CAN-POST1              PIC XXX.
  6864             20  PM-CAN-POST2              PIC XXX.
  6865             20  FILLER                    PIC XXX.
  6866
  6867         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6868
  6869         16  FILLER                        PIC X(03).
  6870
  6871     12  PM-CRED-BENE-INFO.
  6872         16  PM-CRED-BENE-NAME             PIC X(25).
  6873         16  PM-CRED-BENE-ADDR             PIC X(30).
  6874         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6875         16  PM-CRED-BENE-CTYST.
  6876             20  PM-CRED-BENE-CITY         PIC X(28).
  6877             20  PM-CRED-BENE-STATE        PIC XX.
  6878         16  PM-CRED-BENE-ZIP.
  6879             20  PM-CB-ZIP-CODE.
  6880                 24  PM-CB-ZIP-1           PIC X.
  6881                     88  PM-CB-CANADIAN-POST-CODE
  6882                                  VALUE 'A' THRU 'Z'.
  6883                 24  FILLER                PIC X(4).
  6884             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6885         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6886             20  PM-CB-CAN-POST1           PIC XXX.
  6887             20  PM-CB-CAN-POST2           PIC XXX.
  6888             20  FILLER                    PIC XXX.
  6889     12  PM-POST-CARD-MAIL-DATA.
  6890         16  PM-MAIL-DATA OCCURS 7.
  6891             20  PM-MAIL-TYPE              PIC X.
  6892                 88  PM-12MO-MAILING           VALUE '1'.
  6893                 88  PM-EXP-MAILING            VALUE '2'.
  6894             20  PM-MAIL-STATUS            PIC X.
  6895                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6896                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6897                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6898             20  PM-MAIL-DATE              PIC XX.
  6899     12  FILLER                            PIC XX.
  6900     12  FILLER                            PIC X(12).
  6901*    12  FILLER                            PIC X(30).
  6902
  6903******************************************************************
  6904*                                COPY ERCMAIL.
  6905******************************************************************
  6906*                                                                *
  6907*                                                                *
  6908*                            ERCMAIL                             *
  6909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6910*                            VMOD=2.003                          *
  6911*                                                                *
  6912*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 128
* EL6311.cbl
  6913*                                                                *
  6914*   FILE TYPE = VSAM,KSDS                                        *
  6915*   RECORD SIZE = 374   RECFORM = FIX                            *
  6916*                                                                *
  6917*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6918*   ALTERNATE PATH    = NOT USED                                 *
  6919*                                                                *
  6920*   LOG = YES                                                    *
  6921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6922******************************************************************
  6923*                   C H A N G E   L O G
  6924*
  6925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6926*-----------------------------------------------------------------
  6927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6928* EFFECTIVE    NUMBER
  6929*-----------------------------------------------------------------
  6930* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6931* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6932* 111108                   PEMA  ADD CRED BENE ADDR2
  6933******************************************************************
  6934
  6935 01  MAILING-DATA.
  6936     12  MA-RECORD-ID                      PIC XX.
  6937         88  VALID-MA-ID                       VALUE 'MA'.
  6938
  6939     12  MA-CONTROL-PRIMARY.
  6940         16  MA-COMPANY-CD                 PIC X.
  6941         16  MA-CARRIER                    PIC X.
  6942         16  MA-GROUPING.
  6943             20  MA-GROUPING-PREFIX        PIC XXX.
  6944             20  MA-GROUPING-PRIME         PIC XXX.
  6945         16  MA-STATE                      PIC XX.
  6946         16  MA-ACCOUNT.
  6947             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6948             20  MA-ACCOUNT-PRIME          PIC X(6).
  6949         16  MA-CERT-EFF-DT                PIC XX.
  6950         16  MA-CERT-NO.
  6951             20  MA-CERT-PRIME             PIC X(10).
  6952             20  MA-CERT-SFX               PIC X.
  6953
  6954     12  FILLER                            PIC XX.
  6955
  6956     12  MA-ACCESS-CONTROL.
  6957         16  MA-SOURCE-SYSTEM              PIC XX.
  6958             88  MA-FROM-CREDIT                VALUE 'CR'.
  6959             88  MA-FROM-VSI                   VALUE 'VS'.
  6960             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6961             88  MA-FROM-OTHER                 VALUE 'OT'.
  6962         16  MA-RECORD-ADD-DT              PIC XX.
  6963         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6964         16  MA-LAST-MAINT-DT              PIC XX.
  6965         16  MA-LAST-MAINT-BY              PIC XXXX.
  6966         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6967
  6968     12  MA-PROFILE-INFO.
  6969         16  MA-QUALIFY-CODE-1             PIC XX.
  6970         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 129
* EL6311.cbl
  6971         16  MA-QUALIFY-CODE-3             PIC XX.
  6972         16  MA-QUALIFY-CODE-4             PIC XX.
  6973         16  MA-QUALIFY-CODE-5             PIC XX.
  6974
  6975         16  MA-INSURED-LAST-NAME          PIC X(15).
  6976         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6977         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6978         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6979         16  MA-INSURED-BIRTH-DT           PIC XX.
  6980         16  MA-INSURED-SEX                PIC X.
  6981             88  MA-SEX-MALE                   VALUE 'M'.
  6982             88  MA-SEX-FEMALE                 VALUE 'F'.
  6983         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6984
  6985         16  MA-ADDRESS-CORRECTED          PIC X.
  6986         16  MA-JOINT-BIRTH-DT             PIC XX.
  6987*        16  FILLER                        PIC X(12).
  6988
  6989         16  MA-ADDRESS-LINE-1             PIC X(30).
  6990         16  MA-ADDRESS-LINE-2             PIC X(30).
  6991         16  MA-CITY-STATE.
  6992             20  MA-CITY                   PIC X(28).
  6993             20  MA-ADDR-STATE             PIC XX.
  6994         16  MA-ZIP.
  6995             20  MA-ZIP-CODE.
  6996                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6997                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6998                 24  FILLER                PIC X(4).
  6999             20  MA-ZIP-PLUS4              PIC X(4).
  7000         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7001             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7002             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7003             20  FILLER                    PIC X(3).
  7004
  7005         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7006
  7007         16  FILLER                        PIC XXX.
  7008*        16  FILLER                        PIC X(10).
  7009
  7010     12  MA-CRED-BENE-INFO.
  7011         16  MA-CRED-BENE-NAME                 PIC X(25).
  7012         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7013         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7014         16  MA-CRED-BENE-CTYST.
  7015             20  MA-CRED-BENE-CITY             PIC X(28).
  7016             20  MA-CRED-BENE-STATE            PIC XX.
  7017         16  MA-CRED-BENE-ZIP.
  7018             20  MA-CB-ZIP-CODE.
  7019                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7020                     88  MA-CB-CANADIAN-POST-CODE
  7021                                           VALUE 'A' THRU 'Z'.
  7022                 24  FILLER                    PIC X(4).
  7023             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7024         16  MA-CB-CANADIAN-POSTAL-CODE
  7025                            REDEFINES MA-CRED-BENE-ZIP.
  7026             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7027             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7028             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 130
* EL6311.cbl
  7029     12  MA-POST-CARD-MAIL-DATA.
  7030         16  MA-MAIL-DATA OCCURS 7.
  7031             20  MA-MAIL-TYPE              PIC X.
  7032                 88  MA-12MO-MAILING           VALUE '1'.
  7033                 88  MA-EXP-MAILING            VALUE '2'.
  7034             20  MA-MAIL-STATUS            PIC X.
  7035                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7036                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7037                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7038             20  MA-MAIL-DATE              PIC XX.
  7039     12  FILLER                            PIC XX.
  7040     12  FILLER                            PIC XX.
  7041*    12  FILLER                            PIC X(30).
  7042******************************************************************
  7043*                                COPY ERCRQST.
  7044******************************************************************
  7045*                                                                *
  7046*                                                                *
  7047*                            ERCRQST.                            *
  7048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7049*                            VMOD=2.002                          *
  7050*                                                                *
  7051*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7052*                                                                *
  7053*   FILE TYPE = VSAM,KSDS                                        *
  7054*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7055*                                                                *
  7056*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7057*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7058*                                   ACCOUNT, REF, BATCH)         *
  7059*                                                RKP=9, LEN=38   *
  7060*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7061*                                   ACCOUNT, REF, BATCH)         *
  7062*                                                RKP=47, LEN=46  *
  7063*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7064*                                   BATCH)                       *
  7065*                                                RKP=93, LEN=24  *
  7066*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7067*                                   REF, BATCH)                  *
  7068*                                                RKP=117, LEN=35 *
  7069*   LOG = NO                                                     *
  7070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7071******************************************************************
  7072
  7073 01  AR-REQUEST-RECORD.
  7074     12  RQ-RECORD-ID                     PIC XX.
  7075         88  VALID-RQ-ID                        VALUE 'RQ'.
  7076
  7077     12  RQ-CONTROL-PRIMARY.
  7078         16  RQ-COMPANY-CD                PIC X.
  7079         16  RQ-ENTRY-BATCH               PIC X(6).
  7080
  7081     12  RQ-CONTROL-BY-ACCT-REF.
  7082         16  RQ-COMPANY-CD-A1             PIC X.
  7083         16  RQ-CARRIER-A1                PIC X.
  7084         16  RQ-GROUPING-A1               PIC X(6).
  7085         16  RQ-STATE-A1                  PIC XX.
  7086         16  RQ-ACCOUNT-A1                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 131
* EL6311.cbl
  7087         16  RQ-REFERENCE-A1              PIC X(12).
  7088         16  RQ-BATCH-A1                  PIC X(6).
  7089
  7090     12  RQ-CONTROL-BY-FIN-RESP.
  7091         16  RQ-COMPANY-CD-A2             PIC X.
  7092         16  RQ-CARRIER-A2                PIC X.
  7093         16  RQ-GROUPING-A2               PIC X(6).
  7094         16  RQ-FIN-RESP-A2               PIC X(10).
  7095         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7096         16  RQ-REFERENCE-A2              PIC X(12).
  7097         16  RQ-BATCH-A2                  PIC X(6).
  7098
  7099     12  RQ-CONTROL-BY-ACCT-AGENT.
  7100         16  RQ-COMPANY-CD-A3             PIC X.
  7101         16  RQ-CARRIER-A3                PIC X.
  7102         16  RQ-GROUPING-A3               PIC X(6).
  7103         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7104         16  RQ-BATCH-A3                  PIC X(6).
  7105
  7106     12  RQ-CONTROL-BY-SUMMARY.
  7107         16  RQ-COMPANY-CD-A4             PIC X.
  7108         16  RQ-SUMMARY-CODE              PIC X(6).
  7109         16  RQ-ACCOUNT-A4                PIC X(10).
  7110         16  RQ-REFERENCE-A4              PIC X(12).
  7111         16  RQ-BATCH-A4                  PIC X(6).
  7112
  7113     12  RQ-REQUEST-METHOD                PIC X.
  7114         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7115         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7116         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7117         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7118     12  FILLER                           PIC X.
  7119     12  RQ-STATUS                        PIC X.
  7120         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7121         88  RQ-RESUBMIT                      VALUE 'R'.
  7122     12  RQ-PROCESSOR-ID                  PIC X(4).
  7123     12  RQ-ENTRY-DT                      PIC XX.
  7124     12  RQ-MO-END-DT                     PIC XX.
  7125     12  RQ-REQUEST-DT                    PIC XX.
  7126     12  RQ-STMT-DT                       PIC XX.
  7127     12  RQ-REVERSAL-DT                   PIC XX.
  7128     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7129     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7130
  7131     12  FILLER                           PIC X(27).
  7132
  7133******************************************************************
  7134
  7135*                                COPY ERCLOFC.
  7136******************************************************************
  7137*                                                                *
  7138*                                                                *
  7139*                            ERCLOFC                             *
  7140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7141*                            VMOD=2.003                          *
  7142*                                                                *
  7143*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7144*                                                                *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 132
* EL6311.cbl
  7145*   FILE TYPE = VSAM,KSDS                                        *
  7146*   RECORD SIZE = 670   RECFORM = FIX                            *
  7147*                                                                *
  7148*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7149*                                                                *
  7150*   LOG = YES                                                    *
  7151*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7152*                                                                *
  7153******************************************************************
  7154
  7155 01  LOAN-OFFICER-MASTER.
  7156     12  LO-RECORD-ID                PIC XX.
  7157         88  VALID-LO-ID                VALUE 'LO'.
  7158
  7159     12  LO-CONTROL-PRIMARY.
  7160         16  LO-COMPANY-CD           PIC X.
  7161         16  LO-CARRIER              PIC X.
  7162         16  LO-GROUPING.
  7163             20  LO-GROUPING-PREFIX  PIC XXX.
  7164             20  LO-GROUPING-PRIME   PIC XXX.
  7165         16  LO-STATE                PIC XX.
  7166         16  LO-ACCOUNT.
  7167             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7168             20  LO-ACCOUNT-PRIME    PIC X(6).
  7169         16  LO-OFFICER-CODE         PIC X(5).
  7170
  7171     12  LO-OFFICER-NAME             PIC X(30).
  7172
  7173     12  LO-LAST-MAINT-DT            PIC XX.
  7174     12  LO-LAST-USER                PIC X(4).
  7175     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7176
  7177     12  LO-COMP-CONTROL             PIC X.
  7178             88  LO-SHOW-COMP           VALUE 'Y'.
  7179             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7180     12  LO-DETAIL-CONTROL           PIC X.
  7181             88  LO-PRINT-DETAIL        VALUE 'D'.
  7182             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7183
  7184     12  LO-SV-CARRIER               PIC X.
  7185     12  LO-SV-GROUPING              PIC X(6).
  7186     12  LO-SV-STATE                 PIC XX.
  7187
  7188     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7189     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7190
  7191     12  LO-OFFICER-INFO.
  7192         16  FILLER OCCURS 12 TIMES.
  7193             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7194             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7195             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7196             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7197             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7198             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7199             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7200             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7201     12  FILLER                      PIC X(198).
  7202******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 133
* EL6311.cbl
  7203*                                COPY ERCPYAJ.
  7204******************************************************************
  7205*                                                                *
  7206*                            ERCPYAJ                             *
  7207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7208*                            VMOD=2.015                          *
  7209*                                                                *
  7210*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7211*                                                                *
  7212*                                                                *
  7213*   FILE TYPE = VSAM,KSDS                                        *
  7214*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7215*                                                                *
  7216*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7217*       ALTERNATE PATHS = NONE                                   *
  7218*                                                                *
  7219*   LOG = YES                                                    *
  7220*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7221******************************************************************
  7222******************************************************************
  7223*                   C H A N G E   L O G
  7224*
  7225* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7226*-----------------------------------------------------------------
  7227*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7228* EFFECTIVE    NUMBER
  7229*-----------------------------------------------------------------
  7230* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7231* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7232******************************************************************
  7233
  7234 01  PENDING-PAY-ADJ.
  7235     12  PY-RECORD-ID                     PIC XX.
  7236         88  VALID-PY-ID                        VALUE 'PY'.
  7237
  7238     12  PY-CONTROL-PRIMARY.
  7239         16  PY-COMPANY-CD                PIC X.
  7240         16  PY-CARRIER                   PIC X.
  7241         16  PY-GROUPING                  PIC X(6).
  7242         16  PY-FIN-RESP                  PIC X(10).
  7243         16  PY-ACCOUNT                   PIC X(10).
  7244         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7245                                          PIC X(10).
  7246         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7247         16  PY-RECORD-TYPE               PIC X.
  7248             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7249             88  PY-DEPOSIT                   VALUE 'D'.
  7250             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7251             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7252             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7253             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7254             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7255             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7256             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7257             88  PY-FICA-ENTRY                VALUE 'F'.
  7258             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7259             88  PY-POLICY-FEE                VALUE 'W'.
  7260             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 134
* EL6311.cbl
  7261
  7262     12  PY-PYMT-TYPE                     PIC X.
  7263             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7264             88  PY-REINS-PYMT                VALUE 'R'.
  7265             88  PY-EXP-PYMT                  VALUE 'E'.
  7266
  7267     12  PY-BIL-INV                       PIC X(6).
  7268     12  PY-REF-NO                        PIC X(12).
  7269
  7270     12  PY-LAST-MAINT-DT                 PIC XX.
  7271     12  PY-LAST-MAINT-BY                 PIC X(4).
  7272     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7273
  7274     12  PY-PYADJ-RECORD.
  7275         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7276         16  PY-ENTRY-COMMENT             PIC X(30).
  7277         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7278             20  PY-GL-ACCOUNT            PIC X(10).
  7279             20  PY-GL-STATE              PIC X(02).
  7280             20  PY-GL-CANC-SW            PIC X(01).
  7281                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7282                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7283             20  PY-GL-COMMENT            PIC X(10).
  7284             20  FILLER      REDEFINES PY-GL-COMMENT.
  7285                 24  PY-GL-CHECK-NO       PIC 9(06).
  7286                 24  FILLER               PIC X(04).
  7287             20  FILLER                   PIC X(07).
  7288         16  PY-SAVE-ACCOUNT              PIC X(10).
  7289         16  PY-SAVE-TYPE                 PIC X(01).
  7290
  7291         16  PY-LETTERS.
  7292             20  PY-LETTER OCCURS 3 TIMES
  7293                           INDEXED BY PY-LET-NDX
  7294                                          PIC X(04).
  7295
  7296         16  PY-ERCOMP-TYPE               PIC X.
  7297             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7298             88  PY-GA-TYPE                   VALUE 'G'.
  7299             88  PY-BANK-TYPE                 VALUE 'B'.
  7300         16  FILLER                       PIC X(05).
  7301
  7302     12  PY-RECORD-STATUS.
  7303         16  PY-CREDIT-SELECT-DT          PIC XX.
  7304         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7305         16  PY-BILLED-DATE               PIC XX.
  7306         16  PY-REPORTED-DT               PIC XX.
  7307         16  PY-PMT-APPLIED               PIC X.
  7308             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7309             88  PY-GA-PMT                    VALUE 'G'.
  7310             88  PY-OVWRITE-PMT               VALUE 'O'.
  7311             88  PY-NON-AR-PMT                VALUE 'N'.
  7312         16  FILLER                       PIC X(5).
  7313         16  PY-INPUT-DT                  PIC XX.
  7314         16  PY-CHECK-NUMBER              PIC X(6).
  7315         16  PY-VOID-SW                   PIC X.
  7316             88  PY-CHECK-VOIDED              VALUE 'V'.
  7317         16  PY-CHECK-ORIGIN-SW           PIC X.
  7318             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 135
* EL6311.cbl
  7319             88  PY-REFUND-CHECK              VALUE 'R'.
  7320             88  PY-GA-CHECK                  VALUE 'G'.
  7321             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7322             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7323         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7324         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7325         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7326         16  PY-BILL-FLAG                 PIC X.
  7327             88  PY-BILLED                    VALUE 'B'.
  7328         16  PY-AR-FLAG                   PIC X.
  7329             88  PY-AR-CYCLE                  VALUE 'C'.
  7330             88  PY-AR-MONTH-END              VALUE 'M'.
  7331         16  PY-AR-DATE                   PIC XX.
  7332
  7333     12  PY-GL-CODES.
  7334         16  PY-GL-DB                     PIC X(14).
  7335         16  PY-GL-CR                     PIC X(14).
  7336         16  PY-GL-FLAG                   PIC X.
  7337         16  PY-GL-DATE                   PIC XX.
  7338
  7339     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7340     12  FILLER                           PIC X(3).
  7341******************************************************************
  7342*                                COPY ERCCNOT.
  7343******************************************************************
  7344*                                                                *
  7345*                            ERCCNOT                             *
  7346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7347*                            VMOD=2.003                          *
  7348*                                                                *
  7349*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7350*                                                                *
  7351*        FILE TYPE= VSAM,KSDS                                    *
  7352*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7353*                                                                *
  7354*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7355*                                                                *
  7356*        LOG = YES                                               *
  7357*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7358*                                                                *
  7359******************************************************************
  7360*                   C H A N G E   L O G
  7361*
  7362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7363*-----------------------------------------------------------------
  7364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7365* EFFECTIVE    NUMBER
  7366*-----------------------------------------------------------------
  7367* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7368******************************************************************
  7369
  7370 01  CERT-NOTE-FILE.
  7371     12  CZ-RECORD-ID                PIC  XX.
  7372         88  VALID-CZ-ID                  VALUE 'CZ'.
  7373
  7374     12  CZ-CONTROL-PRIMARY.
  7375         16  CZ-COMPANY-CD           PIC X.
  7376         16  CZ-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 136
* EL6311.cbl
  7377         16  CZ-GROUPING.
  7378             20 CZ-GROUPING-PREFIX   PIC XXX.
  7379             20 CZ-GROUPING-PRIME    PIC XXX.
  7380         16  CZ-STATE                PIC XX.
  7381         16  CZ-ACCOUNT.
  7382             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7383             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7384         16  CZ-CERT-EFF-DT          PIC XX.
  7385         16  CZ-CERT-NO.
  7386             20  CZ-CERT-PRIME       PIC X(10).
  7387             20  CZ-CERT-SFX         PIC X.
  7388         16  CZ-RECORD-TYPE          PIC X.
  7389             88  CERT-NOTE           VALUE '1'.
  7390             88  CLAIM-CERT-NOTE     VALUE '2'.
  7391         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7392
  7393     12  CZ-LAST-MAINT-DT            PIC XX.
  7394     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7395     12  CZ-LAST-MAINT-USER          PIC X(4).
  7396
  7397     12  CZ-NOTE-INFORMATION.
  7398         16  CZ-NOTE                 PIC X(63).
  7399         16  FILLER                  PIC X(39).
  7400******************************************************************
  7401*                                COPY ELCMSTR.
  7402******************************************************************
  7403*                                                                *
  7404*                            ELCMSTR.                            *
  7405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7406*                            VMOD=2.012                          *
  7407*                                                                *
  7408*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7409*                                                                *
  7410*   FILE TYPE = VSAM,KSDS                                        *
  7411*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7412*                                                                *
  7413*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7414*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7415*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7416*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7417*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7418*                                                 RKP=75,LEN=21  *
  7419*                                                                *
  7420*   **** NOTE ****                                               *
  7421*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7422*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7423*                                                                *
  7424*   LOG = YES                                                    *
  7425*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7426******************************************************************
  7427*                   C H A N G E   L O G
  7428*
  7429* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7430*-----------------------------------------------------------------
  7431*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7432* EFFECTIVE    NUMBER
  7433*-----------------------------------------------------------------
  7434* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 137
* EL6311.cbl
  7435* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7436* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7437******************************************************************
  7438 01  CLAIM-MASTER.
  7439     12  CL-RECORD-ID                PIC XX.
  7440         88  VALID-CL-ID         VALUE 'CL'.
  7441
  7442     12  CL-CONTROL-PRIMARY.
  7443         16  CL-COMPANY-CD           PIC X.
  7444         16  CL-CARRIER              PIC X.
  7445         16  CL-CLAIM-NO             PIC X(7).
  7446         16  CL-CERT-NO.
  7447             20  CL-CERT-PRIME       PIC X(10).
  7448             20  CL-CERT-SFX         PIC X.
  7449
  7450     12  CL-CONTROL-BY-NAME.
  7451         16  CL-COMPANY-CD-A1        PIC X.
  7452         16  CL-INSURED-LAST-NAME    PIC X(15).
  7453         16  CL-INSURED-NAME.
  7454             20  CL-INSURED-1ST-NAME PIC X(12).
  7455             20  CL-INSURED-MID-INIT PIC X.
  7456
  7457     12  CL-CONTROL-BY-SSN.
  7458         16  CL-COMPANY-CD-A2        PIC X.
  7459         16  CL-SOC-SEC-NO.
  7460             20  CL-SSN-STATE        PIC XX.
  7461             20  CL-SSN-ACCOUNT      PIC X(6).
  7462             20  CL-SSN-LN3          PIC X(3).
  7463
  7464     12  CL-CONTROL-BY-CERT-NO.
  7465         16  CL-COMPANY-CD-A4        PIC X.
  7466         16  CL-CERT-NO-A4.
  7467             20  CL-CERT-A4-PRIME    PIC X(10).
  7468             20  CL-CERT-A4-SFX      PIC X.
  7469
  7470     12  CL-CONTROL-BY-CCN.
  7471         16  CL-COMPANY-CD-A5        PIC X.
  7472         16  CL-CCN-A5.
  7473             20  CL-CCN.
  7474                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7475                 24  CL-CCN-PRIME-A5 PIC X(12).
  7476             20  CL-CCN-FILLER-A5    PIC X(4).
  7477
  7478     12  CL-INSURED-PROFILE-DATA.
  7479         16  CL-INSURED-BIRTH-DT     PIC XX.
  7480         16  CL-INSURED-SEX-CD       PIC X.
  7481             88  INSURED-IS-MALE        VALUE 'M'.
  7482             88  INSURED-IS-FEMALE      VALUE 'F'.
  7483             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7484         16  CL-INSURED-OCC-CD       PIC X(6).
  7485         16  FILLER                  PIC X(5).
  7486
  7487     12  CL-PROCESSING-INFO.
  7488         16  CL-PROCESSOR-ID         PIC X(4).
  7489         16  CL-CLAIM-STATUS         PIC X.
  7490             88  CLAIM-IS-OPEN          VALUE 'O'.
  7491             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7492         16  CL-CLAIM-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 138
* EL6311.cbl
  7493*            88  AH-CLAIM               VALUE 'A'.
  7494*            88  LIFE-CLAIM             VALUE 'L'.
  7495*            88  PROPERTY-CLAIM         VALUE 'P'.
  7496*            88  IUI-CLAIM              VALUE 'I'.
  7497*            88  GAP-CLAIM              VALUE 'G'.
  7498         16  CL-CLAIM-PREM-TYPE      PIC X.
  7499             88  SINGLE-PREMIUM         VALUE '1'.
  7500             88  O-B-COVERAGE           VALUE '2'.
  7501             88  OPEN-END-COVERAGE      VALUE '3'.
  7502         16  CL-INCURRED-DT          PIC XX.
  7503         16  CL-REPORTED-DT          PIC XX.
  7504         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7505         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7506         16  CL-LAST-PMT-DT          PIC XX.
  7507         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7508         16  CL-PAID-THRU-DT         PIC XX.
  7509         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7510         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7511         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7512         16  CL-PMT-CALC-METHOD      PIC X.
  7513             88  CL-360-DAY-YR          VALUE '1'.
  7514             88  CL-365-DAY-YR          VALUE '2'.
  7515             88  CL-FULL-MONTHS         VALUE '3'.
  7516         16  CL-CAUSE-CD             PIC X(6).
  7517
  7518         16  CL-PRIME-CERT-NO.
  7519             20  CL-PRIME-CERT-PRIME PIC X(10).
  7520             20  CL-PRIME-CERT-SFX   PIC X.
  7521
  7522         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7523             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7524             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7525
  7526         16  CL-MICROFILM-NO         PIC X(10).
  7527         16  CL-PROG-FORM-TYPE       PIC X.
  7528         16  CL-LAST-ADD-ON-DT       PIC XX.
  7529
  7530         16  CL-LAST-REOPEN-DT       PIC XX.
  7531         16  CL-LAST-CLOSE-DT        PIC XX.
  7532         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7533             88  FINAL-PAID             VALUE '1'.
  7534             88  CLAIM-DENIED           VALUE '2'.
  7535             88  AUTO-CLOSE             VALUE '3'.
  7536             88  MANUAL-CLOSE           VALUE '4'.
  7537             88  BENEFITS-CHANGED       VALUE 'C'.
  7538             88  SETUP-ERRORS           VALUE 'E'.
  7539         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7540         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7541         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7542             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7543         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7544         16  FILLER                  PIC X.
  7545
  7546     12  CL-CERTIFICATE-DATA.
  7547         16  CL-CERT-ORIGIN          PIC X.
  7548             88  CERT-WAS-ONLINE        VALUE '1'.
  7549             88  CERT-WAS-CREATED       VALUE '2'.
  7550             88  COVERAGE-WAS-ADDED     VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 139
* EL6311.cbl
  7551         16  CL-CERT-KEY-DATA.
  7552             20  CL-CERT-CARRIER     PIC X.
  7553             20  CL-CERT-GROUPING    PIC X(6).
  7554             20  CL-CERT-STATE       PIC XX.
  7555             20  CL-CERT-ACCOUNT.
  7556                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7557                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7558             20  CL-CERT-EFF-DT      PIC XX.
  7559
  7560     12  CL-STATUS-CONTROLS.
  7561         16  CL-PRIORITY-CD          PIC X.
  7562             88  CONFIDENTIAL-DATA      VALUE '8'.
  7563             88  HIGHEST-PRIORITY       VALUE '9'.
  7564         16  CL-SUPV-ATTN-CD         PIC X.
  7565             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7566             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7567         16  CL-PURGED-DT            PIC XX.
  7568         16  CL-RESTORED-DT          PIC XX.
  7569         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7570         16  CL-NEXT-RESEND-DT       PIC XX.
  7571         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7572         16  CL-CRITICAL-PERIOD      PIC 99.
  7573*        16  FILLER                  PIC XX.
  7574         16  CL-LAST-MAINT-DT        PIC XX.
  7575         16  CL-LAST-MAINT-USER      PIC X(4).
  7576         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7577         16  CL-LAST-MAINT-TYPE      PIC X.
  7578             88  CLAIM-SET-UP           VALUE ' '.
  7579             88  PAYMENT-MADE           VALUE '1'.
  7580             88  LETTER-SENT            VALUE '2'.
  7581             88  MASTER-WAS-ALTERED     VALUE '3'.
  7582             88  MASTER-WAS-RESTORED    VALUE '4'.
  7583             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7584             88  FILE-CONVERTED         VALUE '6'.
  7585             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7586             88  ERROR-CORRECTION       VALUE 'E'.
  7587         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7588         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7589         16  CL-BENEFICIARY          PIC X(10).
  7590         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7591         16  CL-DENIAL-TYPE          PIC X.
  7592             88  CL-TYPE-DENIAL          VALUE '1'.
  7593             88  CL-TYPE-RESCISSION      VALUE '2'.
  7594             88  CL-TYPE-REFORMATION     VALUE '3'.
  7595             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7596             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7597         16  CL-CRIT-PER-RECURRENT   PIC X.
  7598         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7599         16  CL-RTW-DT               PIC XX.
  7600
  7601     12  CL-TRAILER-CONTROLS.
  7602         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7603             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7604             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7605             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7606         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7607         16  FILLER                  PIC XX.
  7608         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 140
* EL6311.cbl
  7609         16  CL-ADDRESS-TRAILER-CNT.
  7610             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7611                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7612             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7613                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7614             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7615                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7616             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7617                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7618             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7619                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7620             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7621                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7622             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7623                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7624
  7625     12  CL-CV-REFERENCE-NO.
  7626         16  CL-CV-REFNO-PRIME       PIC X(18).
  7627         16  CL-CV-REFNO-SFX         PIC XX.
  7628
  7629     12  CL-FILE-LOCATION            PIC X(4).
  7630
  7631     12  CL-PROCESS-ERRORS.
  7632         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7633             88  NO-FATAL-ERRORS        VALUE ZERO.
  7634         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7635             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7636
  7637     12  CL-PRODUCT-CD               PIC X.
  7638
  7639     12  CL-CURRENT-KEY-DATA.
  7640         16  CL-CURRENT-CARRIER      PIC X.
  7641         16  CL-CURRENT-GROUPING     PIC X(6).
  7642         16  CL-CURRENT-STATE        PIC XX.
  7643         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7644
  7645     12  CL-ASSOCIATES               PIC X.
  7646         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7647         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7648         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7649         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7650
  7651     12  CL-ACTIVITY-CODE            PIC 99.
  7652     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7653     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7654
  7655     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7656     12  CL-LAG-REPORT-CODE          PIC 9.
  7657     12  CL-LOAN-TYPE                PIC XX.
  7658     12  CL-LEGAL-STATE              PIC XX.
  7659
  7660     12  CL-YESNOSW                  PIC X.
  7661     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7662         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7663         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7664         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7665     12  cl-insured-claim            pic x.
  7666         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 141
* EL6311.cbl
  7667         88  cl-claim-on-secondary       value 'S'.
  7668     12  cl-benefit-expiration-dt    PIC XX.
  7669*                                COPY ERCENDT.
  7670******************************************************************
  7671*                                                                *
  7672*                                                                *
  7673*                            ERCENDT.                            *
  7674*                            VMOD=2.001                          *
  7675*                                                                *
  7676*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7677*                                                                *
  7678*   FILE TYPE = VSAM,KSDS                                        *
  7679*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7680*                                                                *
  7681*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7682*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7683*                                                                *
  7684*   LOG = NO                                                     *
  7685*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7686******************************************************************
  7687*-----------------------------------------------------------------
  7688*                   C H A N G E   L O G
  7689*
  7690* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7691*-----------------------------------------------------------------
  7692*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7693* EFFECTIVE    NUMBER
  7694*-----------------------------------------------------------------
  7695* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7696*                                WITH OPEN CLAIMS
  7697* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7698* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7699* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7700*-----------------------------------------------------------------
  7701 01  ENDORSEMENT-RECORD.
  7702     12  EN-RECORD-ID                PIC XX.
  7703         88  VALID-EN-ID                VALUE 'EN'.
  7704     12  EN-CONTROL-PRIMARY.
  7705         16  EN-COMPANY-CD           PIC X.
  7706         16  EN-CARRIER              PIC X.
  7707         16  EN-GROUPING             PIC X(6).
  7708         16  EN-STATE                PIC XX.
  7709         16  EN-ACCOUNT              PIC X(10).
  7710         16  EN-CERT-EFF-DT          PIC XX.
  7711         16  EN-CERT-NO.
  7712             20  EN-CERT-PRIME       PIC X(10).
  7713             20  EN-CERT-SFX         PIC X.
  7714         16  EN-REC-TYPE             PIC X.
  7715             88  EN-ISSUE               VALUE 'I'.
  7716             88  EN-CANCELLATION        VALUE 'C'.
  7717         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7718     12  EN-CONTROL-BY-ARCH-NO.
  7719         16  EN-COMPANY-CD-A1              PIC X.
  7720         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7721     12  EN-LAST-MAINT-DT            PIC XX.
  7722     12  EN-LAST-MAINT-BY            PIC X(4).
  7723     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7724     12  EN-ENDORSEMENT-RECORD       PIC X(329).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 142
* EL6311.cbl
  7725     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7726         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7727         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7728         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7729         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7730         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7731         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7732         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7733         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7734         16  EN-LF-ORIG-BENCD        PIC XX.
  7735         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7736         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7737         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7738         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7739         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7740         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7741*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7742         16  EN-ORIG-CRED-BENE       PIC X(25).
  7743         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7744         16  FILLER                  PIC X.
  7745         16  EN-AH-ORIG-BENCD        PIC XX.
  7746         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7747         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7748         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7749         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7750*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7751*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7752         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7753         16  F                       PIC X(09).
  7754         16  EN-AH-ORIG-CP           PIC 99.
  7755         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7756         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7757         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7758         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7759         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7760         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7761         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7762         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7763         16  EN-LF-NEW-BENCD         PIC XX.
  7764         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7765         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7766         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7767         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7768         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7769         16  EN-LF-NEW-EXP-DT        PIC XX.
  7770         16  EN-NEW-CRED-BENE        PIC X(25).
  7771         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7772         16  FILLER                  PIC X.
  7773         16  EN-AH-NEW-BENCD         PIC XX.
  7774         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7775         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7776         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7777         16  EN-AH-NEW-EXP-DT        PIC XX.
  7778*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7779*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7780*        16  F                       PIC X(12).
  7781         16  EN-AH-NEW-CP            PIC 99.
  7782         16  EN-SIG-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 143
* EL6311.cbl
  7783         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7784         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7785         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7786         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7787         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7788         16  FILLER                  PIC X(33).
  7789     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7790         16  EN-LF-ORIG-REF-DT       PIC XX.
  7791         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7792         16  EN-AH-ORIG-REF-DT       PIC XX.
  7793         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7794         16  EN-LF-NEW-REF-DT        PIC XX.
  7795         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7796         16  EN-AH-NEW-REF-DT        PIC XX.
  7797         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7798         16  EN-FLAG-CERT            PIC X.
  7799         16  EN-INS-LAST-NAME        PIC X(15).
  7800         16  EN-INS-FIRST-NAME       PIC X(10).
  7801         16  EN-INS-MIDDLE-INIT      PIC X.
  7802         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7803         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7804         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7805         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7806         16  FILLER                  PIC X(262).
  7807     12  EN-MONEY-SW             PIC X.
  7808     12  EN-HEALTH-APP           PIC X.
  7809     12  EN-VOUCHER-SW           PIC X.
  7810     12  EN-PAYEE                PIC X(14).
  7811     12  EN-INPUT-DT             PIC XX.
  7812     12  EN-PROCESS-DT           PIC XX.
  7813     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7814     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7815     12  EN-REASON-CODES.
  7816         16  F OCCURS 12.
  7817             20  EN-REASON-CODE  PIC X(4).
  7818     12  EN-TEMPLATE-USED        PIC X(8).
  7819     12  EN-DOCU-TYPE            PIC X.
  7820         88  EN-VERI-DOCU          VALUE 'V'.
  7821         88  EN-GCE-DOCU           VALUE 'G'.
  7822         88  EN-CANC-DOCU          VALUE 'C'.
  7823     12  EN-COMMENTS1            PIC X(13).
  7824     12  EN-COMMENTS2            PIC X(70).
  7825     12  EN-COMM-CHGBK           PIC X.
  7826         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7827         88  EN-CHG-ACCT           VALUE 'Y'.
  7828     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7829     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7830     12  EN-BATCH-NUMBER         PIC X(6).
  7831     12  EN-ACCT-SUMM            PIC X.
  7832     12  EN-CSO-SUMM             PIC X.
  7833     12  FILLER                  PIC X(13).
  7834******************************************************************
  7835*                                COPY ELCCRTT.
  7836******************************************************************
  7837*                                                                *
  7838*                            ELCCRTT.                            *
  7839*                                                                *
  7840*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 144
* EL6311.cbl
  7841*                                                                *
  7842*   FILE TYPE = VSAM,KSDS                                        *
  7843*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7844*                                                                *
  7845*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7846*                                                                *
  7847*   LOG = YES                                                    *
  7848*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7849******************************************************************
  7850*                   C H A N G E   L O G
  7851*
  7852* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7853*-----------------------------------------------------------------
  7854*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7855* EFFECTIVE    NUMBER
  7856*-----------------------------------------------------------------
  7857* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7858* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7859* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7860* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7861* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7862******************************************************************
  7863
  7864 01  CERTIFICATE-TRAILERS.
  7865     12  CS-RECORD-ID                      PIC XX.
  7866         88  VALID-CS-ID                      VALUE 'CS'.
  7867
  7868     12  CS-CONTROL-PRIMARY.
  7869         16  CS-COMPANY-CD                 PIC X.
  7870         16  CS-CARRIER                    PIC X.
  7871         16  CS-GROUPING                   PIC X(6).
  7872         16  CS-STATE                      PIC XX.
  7873         16  CS-ACCOUNT                    PIC X(10).
  7874         16  CS-CERT-EFF-DT                PIC XX.
  7875         16  CS-CERT-NO.
  7876             20  CS-CERT-PRIME             PIC X(10).
  7877             20  CS-CERT-SFX               PIC X.
  7878         16  CS-TRAILER-TYPE               PIC X.
  7879             88  COMM-TRLR           VALUE 'A'.
  7880             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7881             88  CERT-DATA-TRLR      VALUE 'C'.
  7882
  7883     12  CS-DATA-AREA                      PIC X(516).
  7884
  7885     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7886         16  CS-BANK-COMMISSION-AREA.
  7887             20  CS-BANK-COMMS       OCCURS 10.
  7888                 24  CS-AGT                PIC X(10).
  7889                 24  CS-COM-TYP            PIC X.
  7890                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7891                 24  CS-RECALC-LV-INDIC    PIC X.
  7892                 24  FILLER                PIC X(10).
  7893         16  FILLER                        PIC X(256).
  7894
  7895     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7896****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7897****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7898         16  CS-MB-CLAIM-DATA OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 145
* EL6311.cbl
  7899             20  FILLER OCCURS 10.
  7900                 24  CS-CLAIM-TYPE         PIC X.
  7901                     88  CS-AH-CLM           VALUE 'A'.
  7902                     88  CS-IU-CLM           VALUE 'I'.
  7903                     88  CS-GP-CLM           VALUE 'G'.
  7904                     88  CS-LF-CLM           VALUE 'L'.
  7905                     88  CS-PR-CLM           VALUE 'P'.
  7906                 24  CS-BANK               PIC S999 COMP-3.
  7907                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7908                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7909                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7910         16  FILLER                        PIC X(216).
  7911     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7912         16  CS-VIN-NUMBER                 PIC X(17).
  7913         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7914         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7915         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7916         16  FILLER                        PIC X(496).
  7917******************************************************************
  7918*                                COPY ERCCHEK.
  7919******************************************************************
  7920*                                                                *
  7921*                                                                *
  7922*                            ERCCHEK                             *
  7923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7924*                            VMOD=2.008                          *
  7925*                                                                *
  7926*   FILE DESCRIPTION = CHECK RECORDS                             *
  7927*                                                                *
  7928*   FILE TYPE = VSAM,KSDS                                        *
  7929*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7930*                                                                *
  7931*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7932*       ALTERNATE INDEX = NONE                                   *
  7933*                                                                *
  7934*   LOG = YES                                                    *
  7935*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7936******************************************************************
  7937*                   C H A N G E   L O G
  7938*
  7939* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7940*-----------------------------------------------------------------
  7941*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7942* EFFECTIVE    NUMBER
  7943*-----------------------------------------------------------------
  7944* 021414    2003053000001  PEMA  changes for auto chk request
  7945******************************************************************
  7946 01  CHECK-RECORDS.
  7947     12  CH-RECORD-ID                      PIC XX.
  7948         88  VALID-CH-ID                      VALUE 'CH'.
  7949
  7950     12  CH-CONTROL-PRIMARY.
  7951         16  CH-COMPANY-CD                 PIC X.
  7952         16  CH-CARRIER                    PIC X.
  7953         16  CH-GROUPING                   PIC X(6).
  7954         16  CH-STATE                      PIC XX.
  7955         16  CH-ACCOUNT                    PIC X(10).
  7956         16  CH-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 146
* EL6311.cbl
  7957         16  CH-CERT-NO.
  7958             20  CH-CERT-PRIME             PIC X(10).
  7959             20  CH-CERT-SFX               PIC X.
  7960         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7961
  7962     12  CH-RECORDED-DT                    PIC XX.
  7963     12  CH-RECORDED-BY                    PIC X(4).
  7964     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  7965
  7966     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  7967     12  CH-CHECK-NO                       PIC X(7).
  7968     12  CH-REASON-FOR-CHECK               PIC X(25).
  7969     12  CH-CHECK-WRITTEN-DT               PIC XX.
  7970     12  FILLER                            PIC X.
  7971
  7972     12  CH-PAYEE-INFO.
  7973         16  CH-PAYEE-NAME-1               PIC X(30).
  7974         16  CH-PAYEE-NAME-2               PIC X(30).
  7975         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  7976         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  7977         16  CH-PAYEE-CITY-ST.
  7978             20  CH-PAYEE-CITY             PIC X(28).
  7979             20  CH-PAYEE-STATE            PIC XX.
  7980         16  CH-PAYEE-ZIP-CODE.
  7981             20  CH-PAYEE-ZIP.
  7982                 24  CH-ZIP-PRI-1ST        PIC X.
  7983                     88  CH-CANADIAN-POST-CODE
  7984                                           VALUES 'A' THRU 'Z'.
  7985                 24  FILLER                PIC X(4).
  7986             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  7987         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  7988             20  CH-CAN-POSTAL-1           PIC XXX.
  7989             20  CH-CAN-POSTAL-2           PIC XXX.
  7990             20  FILLER                    PIC XXX.
  7991
  7992     12  CH-CHECK-STUB-TEXT.
  7993         16  CH-STUB-LINE-1                PIC X(30).
  7994         16  CH-TEXT-LINE-1                PIC X(50).
  7995         16  CH-TEXT-LINE-2                PIC X(50).
  7996         16  CH-TEXT-LINE-3                PIC X(40).
  7997     12  CH-RETURN-TO                      PIC X(30).
  7998
  7999     12  CH-COMPENSATION-CONTROL.
  8000         16  CH-COMP-CARRIER               PIC X.
  8001         16  CH-COMP-GROUPING              PIC X(6).
  8002         16  CH-COMP-FIN-RESP              PIC X(10).
  8003         16  CH-COMP-ACCOUNT               PIC X(10).
  8004
  8005     12  CH-CREDIT-SELECT-DT               PIC XX.
  8006     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8007     12  CH-PAYEE-CODE                     PIC X(6).
  8008
  8009     12  CH-VOID-DATA.
  8010         20  CH-VOID-DT                    PIC XX.
  8011         20  CH-VOID-BY                    PIC X(4).
  8012         20  CH-VOID-REASON                PIC X(25).
  8013
  8014     12  CH-APPROVAL-DATA.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 147
* EL6311.cbl
  8015         20  CH-APPROVAL-DT                PIC XX.
  8016         20  CH-APPROVAL-STATUS            PIC X.
  8017             88  CH-IN-LIMBO                  VALUE ' '.
  8018             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8019             88  CH-APPROVED                  VALUE 'A'.
  8020             88  CH-DENIED                    VALUE 'D'.
  8021         20  CH-APPROVED-BY                PIC XXXX.
  8022     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8023             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8024     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8025
  8026     12  ch-released-dt                    pic xx.
  8027     12  ch-check-cashed-dt                pic xx.
  8028     12  FILLER                            PIC X.
  8029*    12  CH-CHECK-REFERENCE                PIC X(12).
  8030     12  CH-CHECK-ORIGIN-SW                PIC X.
  8031             88  CH-REFUND-CHECK              VALUE 'R'.
  8032             88  CH-MAINT-CHECK               VALUE 'M'.
  8033
  8034     12  CH-CANC-DT                        PIC XX.
  8035     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8036     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8037
  8038     12  CH-INSURED-NAME                   PIC X(28).
  8039
  8040     12  ch-released-by                    pic x(4).
  8041     12  ch-csr                            pic x(4).
  8042     12  ch-deduct-commission              pic x.
  8043         88  ch-deduct-comm                  value 'Y'.
  8044         88  ch-do-not-deduct-comm           value 'N'.
  8045
  8046     12  FILLER                            PIC X(11).
  8047*    12  CH-LETTER-TABLE.
  8048*        16  CH-LETTERS OCCURS 3 TIMES
  8049*                       INDEXED BY CH-LT-NDX
  8050*                                          PIC X(04).
  8051
  8052     12  FILLER                            PIC X(07).
  8053
  8054 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8055                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8056                          PENDING-MAILING-DATA MAILING-DATA
  8057                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8058                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8059                          CLAIM-MASTER ENDORSEMENT-RECORD
  8060                          CERTIFICATE-TRAILERS CHECK-RECORDS.
  8061 0000-DFHEXIT SECTION.
  8062     MOVE '9#                    $   ' TO DFHEIV0.
  8063     MOVE 'EL6311' TO DFHEIV1.
  8064     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8065
  8066     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8067     MOVE EIBTRMID               TO QID-TERM.
  8068     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8069     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8070     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8071     MOVE 2                      TO EMI-SWITCH2.
  8072
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 148
* EL6311.cbl
  8073     IF EIBCALEN = 0
  8074         GO TO 8800-UNAUTHORIZED-ACCESS.
  8075
  8076     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8077     MOVE '5'                   TO DC-OPTION-CODE.
  8078     PERFORM 9700-DATE-LINK.
  8079     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8080     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8081
  8082     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8083     MOVE SPACE                  TO DC-OPTION-CODE.
  8084     PERFORM 9700-DATE-LINK.
  8085     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8086     MOVE LOW-VALUES             TO EL631BI.
  8087
  8088
  8089* EXEC CICS HANDLE CONDITION
  8090*        PGMIDERR  (9600-PGMID-ERROR)
  8091*        ERROR     (9990-ABEND)
  8092*        INVREQ    (9990-ABEND)
  8093*        QIDERR    (0010-MAIN-LOGIC)
  8094*    END-EXEC.
  8095*    MOVE '"$L.8N                ! " #00008084' TO DFHEIV0
  8096     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8098     MOVE X'2220233030303038303834' TO DFHEIV0(25:11)
  8099     CALL 'kxdfhei1' USING DFHEIV0
  8100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8101
  8102
  8103     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8104         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8105             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8106             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8107             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8108             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8109             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8110             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8111             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8112             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8113
  8114             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8115                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8116
  8117             ELSE
  8118                 NEXT SENTENCE
  8119
  8120         ELSE
  8121             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8122             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8123             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8124             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8125             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8126             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8127             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8128             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8129             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8130             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 149
* EL6311.cbl
  8131             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8132             GO TO 3900-RE-DISPLAY-RECORD
  8133     ELSE
  8134         GO TO 0020-MAIN-LOGIC.
  8135
  8136 0010-MAIN-LOGIC.
  8137     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8138                                    WS-FIRST-ENTRY-SW.
  8139
  8140     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8141
  8142     MOVE LOW-VALUES             TO EC-NEW-CERT
  8143                                    EC-NEW-STATE.
  8144
  8145     IF PI-DISPLAY-ORIGINAL-BATCH
  8146         NEXT SENTENCE
  8147     ELSE
  8148         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8149             GO TO 5000-BROWSE-BATCH-HEADERS.
  8150
  8151     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8152         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8153
  8154     IF PI-CSR-BROWSE
  8155        GO TO 4200-BROWSE-CSR-FORWARD.
  8156
  8157     IF PI-FILE-BROWSE
  8158         GO TO 4300-BROWSE-FILE-FORWARD.
  8159
  8160     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8161
  8162 0020-MAIN-LOGIC.
  8163     IF EIBAID = DFHCLEAR
  8164         GO TO 9400-CLEAR.
  8165
  8166     MOVE LOW-VALUES             TO EC-NEW-CERT
  8167                                    EC-NEW-STATE.
  8168
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 150
* EL6311.cbl
  8170
  8171******************************************************************
  8172*                                                                *
  8173*              R E C E I V E   M A P                             *
  8174*                                                                *
  8175******************************************************************
  8176
  8177 0200-RECEIVE.
  8178     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8179         MOVE ER-0008            TO EMI-ERROR
  8180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8181         IF PI-MAP-NAME = EL631B
  8182             MOVE -1                 TO BMAINTL
  8183             GO TO 8200-SEND-DATAONLY
  8184         ELSE
  8185             IF PI-MAP-NAME = EL631C
  8186                 MOVE -1                 TO CMAINTL
  8187                 GO TO 8200-SEND-DATAONLY
  8188             ELSE
  8189                 IF PI-MAP-NAME = EL631D
  8190                     MOVE -1                 TO DPFENTRL
  8191                     GO TO 8200-SEND-DATAONLY.
  8192
  8193
  8194* EXEC CICS RECEIVE
  8195*        MAP      (PI-MAP-NAME)
  8196*        MAPSET   (MAPSET-EL6311S)
  8197*        INTO     (EL631BI)
  8198*    END-EXEC.
  8199     MOVE LENGTH OF
  8200      EL631BI
  8201       TO DFHEIV11
  8202*    MOVE '8"T I  L              ''   #00008181' TO DFHEIV0
  8203     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8204     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8205     MOVE X'2020233030303038313831' TO DFHEIV0(25:11)
  8206     CALL 'kxdfhei1' USING DFHEIV0,
  8207           PI-MAP-NAME,
  8208           EL631BI,
  8209           DFHEIV11,
  8210           MAPSET-EL6311S,
  8211           DFHEIV99,
  8212           DFHEIV99
  8213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8214
  8215
  8216******************************************************************
  8217*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8218******************************************************************
  8219
  8220     IF BTYPE-LEN (1) EQUAL +3
  8221        IF BTYPE (1) EQUAL ALL ' '
  8222            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8223
  8224     IF BTYPE-LEN (2) EQUAL +3
  8225        IF BTYPE (2) EQUAL ALL ' '
  8226            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8227
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 151
* EL6311.cbl
  8228     INSPECT EL631BI CONVERTING '_' TO ' '.
  8229
  8230     IF PI-MAP-NAME = EL631B
  8231         IF BPFENTRL GREATER THAN ZEROS
  8232             IF EIBAID NOT = DFHENTER
  8233                 MOVE ER-0004       TO EMI-ERROR
  8234                 MOVE -1            TO BPFENTRL
  8235                 MOVE AL-UNBOF      TO BPFENTRA
  8236                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8237                 GO TO 8200-SEND-DATAONLY
  8238             ELSE
  8239                 IF BPFENTRI NUMERIC AND
  8240                   (BPFENTRI GREATER 0 AND LESS 25)
  8241                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8242                 ELSE
  8243                     MOVE ER-0029  TO EMI-ERROR
  8244                     MOVE AL-UNBON TO BPFENTRA
  8245                     MOVE -1       TO BPFENTRL
  8246                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8247                     GO TO 8200-SEND-DATAONLY
  8248         ELSE
  8249             NEXT SENTENCE
  8250     ELSE
  8251         IF PI-MAP-NAME = EL631C
  8252            IF CPFENTRL GREATER THAN ZEROS
  8253                IF EIBAID NOT = DFHENTER
  8254                 MOVE ER-0004         TO EMI-ERROR
  8255                 MOVE -1              TO CPFENTRL
  8256                 MOVE AL-UNBOF        TO CPFENTRA
  8257                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8258                 GO TO 8200-SEND-DATAONLY
  8259             ELSE
  8260                 IF CPFENTRI NUMERIC AND
  8261                   (CPFENTRI GREATER 0 AND LESS 25)
  8262                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8263                 ELSE
  8264                     MOVE ER-0029      TO EMI-ERROR
  8265                     MOVE AL-UNBON     TO CPFENTRA
  8266                     MOVE -1           TO CPFENTRL
  8267                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8268                     GO TO 8200-SEND-DATAONLY
  8269         ELSE
  8270             NEXT SENTENCE
  8271     ELSE
  8272     IF PI-MAP-NAME = EL631D
  8273         IF DPFENTRL GREATER THAN ZEROS
  8274             IF EIBAID NOT = DFHENTER
  8275                 MOVE ER-0004         TO EMI-ERROR
  8276                 MOVE -1              TO DPFENTRL
  8277                 MOVE AL-UNBOF        TO DPFENTRA
  8278                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8279                 GO TO 8200-SEND-DATAONLY
  8280             ELSE
  8281                 IF DPFENTRI NUMERIC AND
  8282                   (DPFENTRI GREATER 0 AND LESS 25)
  8283                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8284                 ELSE
  8285                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 152
* EL6311.cbl
  8286                     MOVE AL-UNBON     TO DPFENTRA
  8287                     MOVE -1           TO DPFENTRL
  8288                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8289                     GO TO 8200-SEND-DATAONLY.
  8290
  8291     IF EIBAID = DFHPF23
  8292         GO TO 8810-PF23.
  8293
  8294     IF EIBAID = DFHPF24
  8295         GO TO 9200-RETURN-MAIN-MENU.
  8296
  8297     IF EIBAID = DFHPF12
  8298         GO TO 9500-PF12.
  8299
  8300     IF PI-MAP-NAME = EL631B
  8301        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8302
  8303     IF PI-MAP-NAME = EL631C
  8304        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8305
  8306     IF PI-MAP-NAME = EL631D
  8307        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8308
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 153
* EL6311.cbl
  8310
  8311******************************************************************
  8312*                                                                *
  8313*      ISSUE SCREEN PF KEY CHECKING                              *
  8314*                                                                *
  8315******************************************************************
  8316
  8317******************************************************************
  8318*                                                                *
  8319*      PF KEY FUNCTIONS:                                         *
  8320*                                                                *
  8321*      PF1  = BROWSE FORWARD                                     *
  8322*      PF2  = BROWSE BACKWARD                                    *
  8323*      PF3  = CERTIFICATE LOOKUP                                 *
  8324*      PF4  = DISPLAY BATCH HEADER                               *
  8325*      PF5  = ADD ISSUE  SCREEN                                  *
  8326*      PF6  = ADD CANCEL SCREEN                                  *
  8327*      PF7  = CERTIFICATE DISPLAY                                *
  8328*      PF8  = CERTIFICATE NOTES                                  *
  8329*      PF9  = EDIT CONTROL                                       *
  8330*      PF10 = DISPLAY LETTER SCREEN                              *
  8331*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8332*      PF12 = HELP SCREEN                                        *
  8333*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8334*      PF14 = ACCOUNT MASTER                                     *
  8335*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8336*      PF16 = DISPLAY LETTER REVIEW                              *
  8337*                                                                *
  8338******************************************************************
  8339
  8340 0300-CHECK-ISSUE-PF-KEYS.
  8341     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8342        MOVE ER-2337            TO EMI-ERROR
  8343        MOVE -1                  TO BMAINTL
  8344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8345        GO TO 8200-SEND-DATAONLY.
  8346
  8347     IF EIBAID = DFHPF1
  8348        MOVE '0'                TO PI-EDIT-SW
  8349        IF PI-PRIMARY-BROWSE
  8350           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8351        ELSE
  8352           IF PI-PRIMARY-WITH-SELECT
  8353              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8354           ELSE
  8355              IF PI-FILE-BROWSE
  8356                 GO TO 4300-BROWSE-FILE-FORWARD
  8357              ELSE
  8358                 IF PI-CSR-BROWSE
  8359                    GO TO 4200-BROWSE-CSR-FORWARD
  8360                 ELSE
  8361                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8362
  8363     IF EIBAID = DFHPF2
  8364        MOVE '0'                TO PI-EDIT-SW
  8365        IF PI-PRIMARY-BROWSE
  8366           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8367        ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 154
* EL6311.cbl
  8368           IF PI-PRIMARY-WITH-SELECT
  8369              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8370           ELSE
  8371              IF PI-FILE-BROWSE
  8372                 GO TO 4800-BROWSE-FILE-BACKWARD
  8373              ELSE
  8374                 IF PI-CSR-BROWSE
  8375                    GO TO 4900-BROWSE-CSR-BACKWARD
  8376                 ELSE
  8377                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8378
  8379     IF EIBAID = DFHPF3
  8380        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8381        MOVE XCTL-EL127         TO PGM-NAME
  8382        GO TO 9300-XCTL.
  8383
  8384     IF (EIBAID = DFHPF15 OR DFHPF6)
  8385        AND (CSR-EDIT-SESSION)
  8386*       AND (FATAL-OR-UNFORCED)
  8387        AND (FATAL-ERRORS)
  8388        MOVE ER-1819             TO EMI-ERROR
  8389        MOVE -1                  TO BMAINTL
  8390        MOVE AL-UANON            TO BMAINTA
  8391        PERFORM 9900-ERROR-FORMAT
  8392                                 THRU 9900-EXIT
  8393        GO TO 8200-SEND-DATAONLY
  8394     END-IF
  8395     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8396      OR (EIBAID = DFHPF10)
  8397        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8398        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8399        IF (RESP-NORMAL)
  8400           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8401              AM-CONTROL-PRIMARY (1:20))
  8402            IF AM-NAME NOT GREATER THAN SPACES OR
  8403               AM-ADDRS NOT GREATER THAN SPACES  OR
  8404               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8405               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8406               AM-ZIP NOT GREATER THAN SPACES
  8407               MOVE ER-3834             TO EMI-ERROR
  8408               MOVE -1                  TO BMAINTL
  8409               MOVE AL-UANON            TO BMAINTA
  8410               PERFORM 9900-ERROR-FORMAT
  8411                                 THRU 9900-EXIT
  8412               GO TO 8200-SEND-DATAONLY
  8413            END-IF
  8414        ELSE
  8415           MOVE ER-1609             TO EMI-ERROR
  8416           MOVE -1                  TO BMAINTL
  8417           MOVE AL-UANON            TO BMAINTA
  8418           PERFORM 9900-ERROR-FORMAT
  8419                                THRU 9900-EXIT
  8420           GO TO 8200-SEND-DATAONLY
  8421        END-IF
  8422
  8423        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8424        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8425        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 155
* EL6311.cbl
  8426            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8427               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8428               MA-CITY NOT GREATER THAN SPACES OR
  8429               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8430               MA-ZIP-CODE NOT GREATER THAN SPACES
  8431               MOVE ER-3835             TO EMI-ERROR
  8432               MOVE -1                  TO BMAINTL
  8433               MOVE AL-UANON            TO BMAINTA
  8434               PERFORM 9900-ERROR-FORMAT
  8435                                 THRU 9900-EXIT
  8436               GO TO 8200-SEND-DATAONLY
  8437            END-IF
  8438        ELSE
  8439           MOVE ER-3000             TO EMI-ERROR
  8440           MOVE -1                  TO BMAINTL
  8441           MOVE AL-UANON            TO BMAINTA
  8442           PERFORM 9900-ERROR-FORMAT
  8443                                THRU 9900-EXIT
  8444           GO TO 8200-SEND-DATAONLY
  8445        END-IF
  8446
  8447     END-IF
  8448     IF (EIBAID = DFHPF15)
  8449        AND (CSR-EDIT-SESSION)
  8450        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8451        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8452        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8453        MOVE PI-SV-STATE         TO PI-STATE
  8454        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8455        MOVE BCERTNOI            TO PI-CERT-PRIME
  8456        MOVE BSUFIXI             TO PI-CERT-SFX
  8457        MOVE BEFFDTI             TO DEEDIT-FIELD
  8458        PERFORM 8600-DEEDIT
  8459        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8460        MOVE '4'                 TO DC-OPTION-CODE
  8461        PERFORM 9700-DATE-LINK
  8462        IF DATE-CONVERSION-ERROR
  8463           MOVE ER-0348          TO EMI-ERROR
  8464           MOVE -1               TO BEFFDTL
  8465           MOVE AL-UABON         TO BEFFDTA
  8466           PERFORM 9900-ERROR-FORMAT
  8467                                 THRU 9900-EXIT
  8468           GO TO 8200-SEND-DATAONLY
  8469        ELSE
  8470           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8471           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8472           MOVE XCTL-EL6315      TO PGM-NAME
  8473           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8474           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8475           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8476           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8477           GO TO 9300-XCTL
  8478        END-IF
  8479     END-IF
  8480
  8481     IF EIBAID = DFHPF4
  8482        MOVE '0'                TO PI-EDIT-SW
  8483        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 156
* EL6311.cbl
  8484           NEXT SENTENCE
  8485        ELSE
  8486           GO TO 7200-DISPLAY-BATCHES.
  8487
  8488     IF EIBAID = DFHPF5
  8489        MOVE ER-0029                TO EMI-ERROR
  8490        MOVE -1                     TO BPFENTRL
  8491        MOVE AL-UNBON               TO BPFENTRA
  8492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8493        GO TO 8200-SEND-DATAONLY.
  8494*        MOVE '0'                TO PI-EDIT-SW
  8495*        IF PI-DISPLAY-ORIGINAL-BATCH
  8496*           NEXT SENTENCE
  8497*        ELSE
  8498*           MOVE EL631B              TO PI-MAP-NAME
  8499*           MOVE LOW-VALUES          TO EL631BI
  8500*           MOVE 'A'                 TO BMAINTO
  8501*           MOVE AL-UANON            TO BMAINTA
  8502*           MOVE -1                  TO BMAINTL
  8503*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8504*           GO TO 8100-SEND-INITIAL-MAP.
  8505
  8506     IF EIBAID = DFHPF6
  8507        IF NOT CSR-EDIT-SESSION
  8508           MOVE ER-0029                TO EMI-ERROR
  8509           MOVE -1                     TO BPFENTRL
  8510           MOVE AL-UNBON               TO BPFENTRA
  8511           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8512           GO TO 8200-SEND-DATAONLY
  8513*           MOVE '0'              TO PI-EDIT-SW
  8514*           IF PI-DISPLAY-ORIGINAL-BATCH
  8515*              NEXT SENTENCE
  8516*           ELSE
  8517*              MOVE EL631C        TO PI-MAP-NAME
  8518*              MOVE LOW-VALUES    TO EL631CI
  8519*              MOVE 'A'           TO CMAINTO
  8520*              MOVE AL-UANON      TO CMAINTA
  8521*              MOVE -1            TO CMAINTL
  8522*              MOVE '6'           TO PI-MAINT-FUNCTION
  8523*              GO TO 8100-SEND-INITIAL-MAP
  8524*           END-IF
  8525        ELSE
  8526           PERFORM 5100-PROCESS-POL-RESC
  8527                                 THRU 5100-EXIT
  8528           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8529           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8530                                    PI-PREV-SEQ-NO
  8531           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8532*                                    WS-CANCEL-LETTER-SW
  8533                                    PI-ALL-ISSUES-SW
  8534                                    PI-ALL-CANCELS-SW
  8535           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8536        END-IF
  8537     END-IF
  8538     IF EIBAID = DFHPF7
  8539        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8540        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8541        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 157
* EL6311.cbl
  8542        MOVE PI-SV-STATE            TO PI-STATE
  8543        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8544        MOVE BCERTNOI               TO PI-CERT-PRIME
  8545        MOVE BSUFIXI                TO PI-CERT-SFX
  8546        MOVE BEFFDTI                TO DEEDIT-FIELD
  8547        PERFORM 8600-DEEDIT
  8548        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8549        MOVE '4'                    TO DC-OPTION-CODE
  8550        PERFORM 9700-DATE-LINK
  8551        IF DATE-CONVERSION-ERROR
  8552           MOVE ER-0348            TO EMI-ERROR
  8553           MOVE -1                  TO BEFFDTL
  8554           MOVE AL-UABON            TO BEFFDTA
  8555           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8556           GO TO 8200-SEND-DATAONLY
  8557        ELSE
  8558           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8559           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8560           MOVE XCTL-EL1273        TO PGM-NAME
  8561           GO TO 9300-XCTL.
  8562
  8563     IF EIBAID = DFHPF8
  8564        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8565        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8566        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8567        MOVE PI-SV-STATE            TO PI-STATE
  8568        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8569        MOVE BCERTNOI               TO PI-CERT-PRIME
  8570        MOVE BSUFIXI                TO PI-CERT-SFX
  8571        MOVE BEFFDTI                TO DEEDIT-FIELD
  8572        PERFORM 8600-DEEDIT
  8573        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8574        MOVE '4'                    TO DC-OPTION-CODE
  8575        PERFORM 9700-DATE-LINK
  8576        IF DATE-CONVERSION-ERROR
  8577           MOVE ER-0348            TO EMI-ERROR
  8578           MOVE -1                  TO BEFFDTL
  8579           MOVE AL-UABON            TO BEFFDTA
  8580           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8581           GO TO 8200-SEND-DATAONLY
  8582        ELSE
  8583           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8584           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8585           IF PI-COMPANY-ID = 'DMD'
  8586               MOVE XCTL-EL401DMD      TO PGM-NAME
  8587             ELSE
  8588               MOVE XCTL-EL1279        TO PGM-NAME
  8589           END-IF
  8590           GO TO 9300-XCTL.
  8591
  8592     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8593        MOVE XCTL-EL6312         TO PGM-NAME
  8594
  8595* EXEC CICS XCTL
  8596*           PROGRAM   (PGM-NAME)
  8597*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8598*           LENGTH    (WS-COMM-LENGTH)
  8599*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 158
* EL6311.cbl
  8600*    MOVE '.$C                   %   #00008565' TO DFHEIV0
  8601     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8602     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8603     MOVE X'2020233030303038353635' TO DFHEIV0(25:11)
  8604     CALL 'kxdfhei1' USING DFHEIV0,
  8605           PGM-NAME,
  8606           PROGRAM-INTERFACE-BLOCK,
  8607           WS-COMM-LENGTH,
  8608           DFHEIV99
  8609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8610     ELSE
  8611        MOVE '0'                 TO  PI-EDIT-SW.
  8612
  8613     IF  EIBAID = DFHPF10
  8614         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8615         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8616         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8617                                    PI-1042-WA
  8618         MOVE 4                  TO PI-689-DATA-SOURCE
  8619         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8620         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8621         MOVE PI-SV-STATE        TO PI-689-STATE
  8622         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8623         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8624         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8625         MOVE PI-PB-ALT-CHG-SEQ-NO
  8626                                 TO PI-689-ALT-SEQ-NO
  8627         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8628         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8629         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8630         MOVE +0                 TO PI-689-CONTROL
  8631         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8632                                    PI-689-EXP-DATE
  8633                                    PI-689-RESP-PERSON
  8634                                    PI-689-TYPE
  8635                                    PI-689-FOLLOW-UP-EDIT
  8636                                    PI-689-RESEND1-EDIT
  8637                                    PI-689-SEQ-EDIT
  8638                                    PI-689-BCSEQ-EDIT
  8639                                    PI-689-LBL-OVERRIDE
  8640         MOVE W-LETTER-COMMUNICATION-AREAS
  8641                                 TO PI-PROGRAM-WORK-AREA
  8642         MOVE XCTL-EL689         TO PGM-NAME
  8643         GO TO 9300-XCTL.
  8644
  8645     IF  EIBAID = DFHPF16
  8646         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8647         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8648         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8649                                    PI-1042-WA
  8650         MOVE 4                  TO PI-689-DATA-SOURCE
  8651         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8652         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8653         MOVE PI-SV-STATE        TO PI-689-STATE
  8654         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8655         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8656         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8657         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 159
* EL6311.cbl
  8658                                 TO PI-689-ALT-SEQ-NO
  8659         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8660         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8661         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8662         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8663         MOVE W-LETTER-COMMUNICATION-AREAS
  8664                                 TO PI-PROGRAM-WORK-AREA
  8665         MOVE XCTL-EL690         TO PGM-NAME
  8666         GO TO 9300-XCTL.
  8667
  8668     IF EIBAID = DFHPF13
  8669         MOVE XCTL-EL6313        TO PGM-NAME
  8670         GO TO 9300-XCTL.
  8671
  8672     IF EIBAID = DFHPF17
  8673        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8674        IF (PB-I-LOAN-APR > ZEROS)
  8675           and (pb-i-loan-apr < 99.9999)
  8676           AND (PB-I-BENEFICIARY-NAME NOT
  8677              = SPACES AND LOW-VALUES)
  8678
  8679           MOVE LINK-ELVADS          TO PGM-NAME
  8680
  8681* EXEC CICS LINK
  8682*              PROGRAM    (PGM-NAME)
  8683*              COMMAREA   (WS-PASS-AREA)
  8684*              LENGTH     (WS-PASS-AREA-LENGTH)
  8685*          END-EXEC
  8686*    MOVE '."C                   (   #00008640' TO DFHEIV0
  8687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8689     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
  8690     CALL 'kxdfhei1' USING DFHEIV0,
  8691           PGM-NAME,
  8692           WS-PASS-AREA,
  8693           WS-PASS-AREA-LENGTH,
  8694           DFHEIV99,
  8695           DFHEIV99,
  8696           DFHEIV99,
  8697           DFHEIV99
  8698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8699
  8700           MOVE 0000             TO EMI-ERROR
  8701           MOVE -1               TO BMAINTL
  8702           PERFORM 9900-ERROR-FORMAT
  8703                                 THRU 9900-EXIT
  8704           GO TO 8200-SEND-DATAONLY
  8705        ELSE
  8706           MOVE ER-0877            TO EMI-ERROR
  8707           MOVE -1                  TO BEFFDTL
  8708           MOVE AL-UABON            TO BEFFDTA
  8709           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8710           GO TO 8200-SEND-DATAONLY
  8711        END-IF
  8712     END-IF
  8713     IF EIBAID = DFHPF14
  8714        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8715        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 160
* EL6311.cbl
  8716        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8717        MOVE PI-SV-STATE            TO PI-CR-STATE
  8718        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8719        MOVE SPACE                  TO PI-EDIT-SW
  8720        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8721        MOVE XCTL-EL650             TO PGM-NAME
  8722        GO TO 9300-XCTL.
  8723
  8724     IF EIBAID = DFHPF15
  8725        IF PI-COMPANY-ID  =  'HER'
  8726            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8727            MOVE XCTL-EL680         TO PGM-NAME
  8728            GO TO 9300-XCTL.
  8729
  8730     IF EIBAID = DFHENTER OR DFHPF11
  8731        GO TO 1000-ISSUE-MAINLINE.
  8732
  8733     MOVE ER-0029                TO EMI-ERROR
  8734     MOVE -1                     TO BPFENTRL
  8735     MOVE AL-UNBON               TO BPFENTRA
  8736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8737     GO TO 8200-SEND-DATAONLY.
  8738
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 161
* EL6311.cbl
  8740
  8741******************************************************************
  8742*                                                                *
  8743*      CANCEL SCREEN PF KEY CHECKING                             *
  8744*                                                                *
  8745******************************************************************
  8746
  8747******************************************************************
  8748*                                                                *
  8749*      PF KEY FUNCTIONS:                                         *
  8750*                                                                *
  8751*      PF1  = BROWSE FORWARD                                     *
  8752*      PF2  = BROWSE BACKWARD                                    *
  8753*      PF3  = CERTIFICATE LOOKUP                                 *
  8754*      PF4  = DISPLAY BATCH HEADER                               *
  8755*      PF5  = ADD ISSUE SCREEN                                   *
  8756*      PF6  = ADD CANCEL SCREEN                                  *
  8757*      PF7  = CERTIFICATE DISPLAY                                *
  8758*      PF8  = CERTIFICATE NOTES                                  *
  8759*      PF9  = EDIT CONTROL                                       *
  8760*      PF10 = DISPLAY LETTER SCREEN                              *
  8761*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8762*      PF12 = DISPLAY HELP SCREEN                                *
  8763*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8764*      PF14 = ACCOUNT MASTER                                     *
  8765*      PF16 = LETTER REVIEW                                      *
  8766*                                                                *
  8767******************************************************************
  8768
  8769 0400-CHECK-CANCEL-PF-KEYS.
  8770     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8771        MOVE ER-2337             TO EMI-ERROR
  8772        MOVE -1                  TO CMAINTL
  8773        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8774        GO TO 8200-SEND-DATAONLY.
  8775
  8776     IF EIBAID = DFHPF1
  8777        MOVE '0'                TO PI-EDIT-SW
  8778        IF PI-PRIMARY-BROWSE
  8779           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8780        ELSE
  8781           IF PI-PRIMARY-WITH-SELECT
  8782              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8783           ELSE
  8784              IF PI-FILE-BROWSE
  8785                 GO TO 4300-BROWSE-FILE-FORWARD
  8786              ELSE
  8787                 IF PI-CSR-BROWSE
  8788                    GO TO 4200-BROWSE-CSR-FORWARD
  8789                 ELSE
  8790                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8791
  8792     IF EIBAID = DFHPF2
  8793        MOVE '0'                TO PI-EDIT-SW
  8794        IF PI-PRIMARY-BROWSE
  8795           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8796        ELSE
  8797           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 162
* EL6311.cbl
  8798              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8799           ELSE
  8800              IF PI-FILE-BROWSE
  8801                 GO TO 4800-BROWSE-FILE-BACKWARD
  8802              ELSE
  8803                 IF PI-CSR-BROWSE
  8804                    GO TO 4900-BROWSE-CSR-BACKWARD
  8805                 ELSE
  8806                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8807
  8808     IF EIBAID = DFHPF3
  8809        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8810        MOVE XCTL-EL127         TO PGM-NAME
  8811        GO TO 9300-XCTL.
  8812
  8813     IF (EIBAID = DFHPF15 OR DFHPF17)
  8814        AND (CSR-EDIT-SESSION)
  8815*       AND (FATAL-OR-UNFORCED)
  8816        AND (FATAL-ERRORS)
  8817        MOVE ER-1819             TO EMI-ERROR
  8818        MOVE -1                  TO CMAINTL
  8819        MOVE AL-UANON            TO CMAINTA
  8820        PERFORM 9900-ERROR-FORMAT
  8821                                 THRU 9900-EXIT
  8822        GO TO 8200-SEND-DATAONLY
  8823     END-IF
  8824     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8825       AND (CSR-EDIT-SESSION)
  8826        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8827        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8828        IF (RESP-NORMAL)
  8829           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8830              AM-CONTROL-PRIMARY (1:20))
  8831            IF AM-NAME NOT GREATER THAN SPACES OR
  8832               AM-ADDRS NOT GREATER THAN SPACES  OR
  8833               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8834               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8835               AM-ZIP NOT GREATER THAN SPACES
  8836               MOVE ER-3834             TO EMI-ERROR
  8837               MOVE -1                  TO BMAINTL
  8838               MOVE AL-UANON            TO BMAINTA
  8839               PERFORM 9900-ERROR-FORMAT
  8840                                 THRU 9900-EXIT
  8841               GO TO 8200-SEND-DATAONLY
  8842            END-IF
  8843        ELSE
  8844           MOVE ER-1609             TO EMI-ERROR
  8845           MOVE -1                  TO BMAINTL
  8846           MOVE AL-UANON            TO BMAINTA
  8847           PERFORM 9900-ERROR-FORMAT
  8848                                THRU 9900-EXIT
  8849           GO TO 8200-SEND-DATAONLY
  8850        END-IF
  8851
  8852        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8853        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8854        IF (ERMAIL-FOUND)
  8855            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 163
* EL6311.cbl
  8856               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8857               MA-CITY NOT GREATER THAN SPACES OR
  8858               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8859               MA-ZIP-CODE NOT GREATER THAN SPACES
  8860               MOVE ER-3835             TO EMI-ERROR
  8861               MOVE -1                  TO BMAINTL
  8862               MOVE AL-UANON            TO BMAINTA
  8863               PERFORM 9900-ERROR-FORMAT
  8864                                 THRU 9900-EXIT
  8865               GO TO 8200-SEND-DATAONLY
  8866            END-IF
  8867        ELSE
  8868           MOVE ER-3000             TO EMI-ERROR
  8869           MOVE -1                  TO BMAINTL
  8870           MOVE AL-UANON            TO BMAINTA
  8871           PERFORM 9900-ERROR-FORMAT
  8872                                THRU 9900-EXIT
  8873           GO TO 8200-SEND-DATAONLY
  8874        END-IF
  8875
  8876     END-IF
  8877     IF (EIBAID = DFHPF15 OR DFHPF17)
  8878        AND (CSR-EDIT-SESSION)
  8879        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8880        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8881        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8882        MOVE PI-SV-STATE         TO PI-STATE
  8883        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8884        MOVE CCERTNOI            TO PI-CERT-PRIME
  8885        MOVE CSUFIXI             TO PI-CERT-SFX
  8886        MOVE CEFFDTI             TO DEEDIT-FIELD
  8887        PERFORM 8600-DEEDIT
  8888        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8889        MOVE '4'                 TO DC-OPTION-CODE
  8890        PERFORM 9700-DATE-LINK
  8891        IF DATE-CONVERSION-ERROR
  8892           MOVE ER-0348          TO EMI-ERROR
  8893           MOVE -1               TO CEFFDTL
  8894           MOVE AL-UABON         TO CEFFDTA
  8895           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8896           GO TO 8200-SEND-DATAONLY
  8897        ELSE
  8898           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8899           PERFORM 6000-CREATE-TEMP-STORAGE
  8900                                 THRU 6000-EXIT
  8901           IF EIBAID = DFHPF17
  8902               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8903                                  THRU 6400-EXIT
  8904               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8905                                 '2' AND '3' AND '4'
  8906                  MOVE ER-3831     TO  EMI-ERROR
  8907                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8908                  GO TO 8200-SEND-DATAONLY
  8909               END-IF
  8910               MOVE 'Y'          TO PI-CLM-RESC-IND
  8911           ELSE
  8912               MOVE 'N'          TO PI-CLM-RESC-IND
  8913           END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 164
* EL6311.cbl
  8914           MOVE XCTL-EL6316      TO PGM-NAME
  8915           MOVE '2'              TO PI-ISS-CAN-SW
  8916           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8917           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8918           GO TO 9300-XCTL
  8919        END-IF
  8920     END-IF
  8921
  8922     IF EIBAID = DFHPF4
  8923        MOVE '0'                TO PI-EDIT-SW
  8924        IF PI-DISPLAY-ORIGINAL-BATCH
  8925           NEXT SENTENCE
  8926        ELSE
  8927           GO TO 7200-DISPLAY-BATCHES.
  8928
  8929     IF EIBAID = DFHPF5
  8930        MOVE ER-0029                TO EMI-ERROR
  8931        MOVE -1                     TO BPFENTRL
  8932        MOVE AL-UNBON               TO BPFENTRA
  8933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8934        GO TO 8200-SEND-DATAONLY.
  8935*        MOVE '0'                TO PI-EDIT-SW
  8936*        IF PI-DISPLAY-ORIGINAL-BATCH
  8937*           NEXT SENTENCE
  8938*        ELSE
  8939*           MOVE EL631B              TO PI-MAP-NAME
  8940*           MOVE LOW-VALUES          TO EL631BI
  8941*           MOVE 'A'                 TO BMAINTO
  8942*           MOVE AL-UANON            TO BMAINTA
  8943*           MOVE -1                  TO BMAINTL
  8944*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8945*           GO TO 8100-SEND-INITIAL-MAP.
  8946
  8947     IF EIBAID = DFHPF6
  8948        MOVE ER-0029                TO EMI-ERROR
  8949        MOVE -1                     TO BPFENTRL
  8950        MOVE AL-UNBON               TO BPFENTRA
  8951        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8952        GO TO 8200-SEND-DATAONLY.
  8953*        MOVE '0'                TO PI-EDIT-SW
  8954*        IF PI-DISPLAY-ORIGINAL-BATCH
  8955*           NEXT SENTENCE
  8956*        ELSE
  8957*           MOVE EL631C              TO PI-MAP-NAME
  8958*           MOVE LOW-VALUES          TO EL631CI
  8959*           MOVE 'A'                 TO CMAINTO
  8960*           MOVE AL-UANON            TO CMAINTA
  8961*           MOVE -1                  TO CMAINTL
  8962*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8963*           GO TO 8100-SEND-INITIAL-MAP.
  8964
  8965     IF EIBAID = DFHPF7
  8966        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8967        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8968        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8969        MOVE PI-SV-STATE            TO PI-STATE
  8970        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8971        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 165
* EL6311.cbl
  8972        MOVE CSUFIXI                TO PI-CERT-SFX
  8973        MOVE CEFFDTI                TO DEEDIT-FIELD
  8974        PERFORM 8600-DEEDIT
  8975        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8976        MOVE '4'                    TO DC-OPTION-CODE
  8977        PERFORM 9700-DATE-LINK
  8978        IF DATE-CONVERSION-ERROR
  8979           MOVE ER-0348            TO EMI-ERROR
  8980           MOVE -1                  TO BEFFDTL
  8981           MOVE AL-UABON            TO BEFFDTA
  8982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8983           GO TO 8200-SEND-DATAONLY
  8984        ELSE
  8985           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8986           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8987           MOVE XCTL-EL1273        TO PGM-NAME
  8988           GO TO 9300-XCTL.
  8989
  8990     IF EIBAID = DFHPF8
  8991        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8992        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8993        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8994        MOVE PI-SV-STATE            TO PI-STATE
  8995        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8996        MOVE CCERTNOI               TO PI-CERT-PRIME
  8997        MOVE CSUFIXI                TO PI-CERT-SFX
  8998        MOVE CEFFDTI                TO DEEDIT-FIELD
  8999        PERFORM 8600-DEEDIT
  9000        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9001        MOVE '4'                    TO DC-OPTION-CODE
  9002        PERFORM 9700-DATE-LINK
  9003        IF DATE-CONVERSION-ERROR
  9004           MOVE ER-0348             TO EMI-ERROR
  9005           MOVE -1                  TO BEFFDTL
  9006           MOVE AL-UABON            TO BEFFDTA
  9007           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9008           GO TO 8200-SEND-DATAONLY
  9009        ELSE
  9010           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9011           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9012           IF PI-COMPANY-ID = 'DMD'
  9013               MOVE XCTL-EL401DMD      TO PGM-NAME
  9014             ELSE
  9015               MOVE XCTL-EL1279        TO PGM-NAME
  9016           END-IF
  9017           GO TO 9300-XCTL.
  9018
  9019     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9020        MOVE XCTL-EL6312     TO PGM-NAME
  9021
  9022* EXEC CICS XCTL
  9023*           PROGRAM  (PGM-NAME)
  9024*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9025*           LENGTH   (WS-COMM-LENGTH)
  9026*       END-EXEC
  9027*    MOVE '.$C                   %   #00008967' TO DFHEIV0
  9028     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9029     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 166
* EL6311.cbl
  9030     MOVE X'2020233030303038393637' TO DFHEIV0(25:11)
  9031     CALL 'kxdfhei1' USING DFHEIV0,
  9032           PGM-NAME,
  9033           PROGRAM-INTERFACE-BLOCK,
  9034           WS-COMM-LENGTH,
  9035           DFHEIV99
  9036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9037     ELSE
  9038        MOVE '0'                 TO  PI-EDIT-SW.
  9039
  9040     IF EIBAID = DFHPF10
  9041         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9042         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9043         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9044         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9045                                    PI-1042-WA
  9046         MOVE 4                  TO PI-689-DATA-SOURCE
  9047         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9048         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9049         MOVE PI-SV-STATE        TO PI-689-STATE
  9050         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9051         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9052         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9053         MOVE PI-PB-ALT-CHG-SEQ-NO
  9054                                 TO PI-689-ALT-SEQ-NO
  9055         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9056         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9057         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9058         MOVE +0                 TO PI-689-CONTROL
  9059         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9060                                    PI-689-EXP-DATE
  9061                                    PI-689-RESP-PERSON
  9062                                    PI-689-TYPE
  9063                                    PI-689-FOLLOW-UP-EDIT
  9064                                    PI-689-RESEND1-EDIT
  9065                                    PI-689-SEQ-EDIT
  9066                                    PI-689-BCSEQ-EDIT
  9067                                    PI-689-LBL-OVERRIDE
  9068         MOVE W-LETTER-COMMUNICATION-AREAS
  9069                                 TO PI-PROGRAM-WORK-AREA
  9070         MOVE XCTL-EL689         TO PGM-NAME
  9071         GO TO 9300-XCTL.
  9072
  9073     IF  EIBAID = DFHPF16
  9074         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9075         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9076         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9077                                    PI-1042-WA
  9078         MOVE 4                  TO PI-689-DATA-SOURCE
  9079         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9080         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9081         MOVE PI-SV-STATE        TO PI-689-STATE
  9082         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9083         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9084         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9085         MOVE PI-PB-ALT-CHG-SEQ-NO
  9086                                 TO PI-689-ALT-SEQ-NO
  9087         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 167
* EL6311.cbl
  9088         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9089         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9090         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9091         MOVE W-LETTER-COMMUNICATION-AREAS
  9092                                 TO PI-PROGRAM-WORK-AREA
  9093         MOVE XCTL-EL690         TO PGM-NAME
  9094         GO TO 9300-XCTL.
  9095     IF (EIBAID = DFHPF13)
  9096        if (not fatal-errors)
  9097           and (not unforced-errors)
  9098           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9099           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9100           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9101           MOVE PI-SV-STATE      TO PI-STATE
  9102           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9103           MOVE CCERTNOI         TO PI-CERT-PRIME
  9104           MOVE CSUFIXI          TO PI-CERT-SFX
  9105           MOVE CEFFDTI          TO DEEDIT-FIELD
  9106           PERFORM 8600-DEEDIT
  9107           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9108           MOVE '4'              TO DC-OPTION-CODE
  9109           PERFORM 9700-DATE-LINK
  9110           IF DATE-CONVERSION-ERROR
  9111              MOVE ER-0348       TO EMI-ERROR
  9112              MOVE -1            TO CEFFDTL
  9113              MOVE AL-UABON      TO CEFFDTA
  9114              PERFORM 9900-ERROR-FORMAT
  9115                                 THRU 9900-EXIT
  9116              GO TO 8200-SEND-DATAONLY
  9117           ELSE
  9118              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9119              MOVE AL-UANON      TO CEFFDTA
  9120              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9121              PERFORM 6000-CREATE-TEMP-STORAGE
  9122                                 THRU 6000-EXIT
  9123              MOVE XCTL-EL677    TO PGM-NAME
  9124              GO TO 9300-XCTL
  9125           end-if
  9126        else
  9127           MOVE ER-3444          TO EMI-ERROR
  9128           MOVE -1               TO CPFENTRL
  9129           MOVE AL-UNBON         TO CPFENTRA
  9130           PERFORM 9900-ERROR-FORMAT
  9131                                 THRU 9900-EXIT
  9132           GO TO 8200-SEND-DATAONLY
  9133        end-if
  9134     end-if
  9135
  9136     IF EIBAID = DFHPF14
  9137        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9138        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9139        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9140        MOVE PI-SV-STATE            TO PI-CR-STATE
  9141        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9142        MOVE SPACE                  TO PI-EDIT-SW
  9143        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9144        MOVE XCTL-EL650             TO PGM-NAME
  9145        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 168
* EL6311.cbl
  9146
  9147     IF EIBAID = DFHENTER OR DFHPF11
  9148        GO TO 2000-CANCEL-MAINLINE.
  9149
  9150     MOVE ER-0029                TO EMI-ERROR.
  9151     MOVE -1                     TO CPFENTRL.
  9152     MOVE AL-UNBON               TO CPFENTRA.
  9153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9154     GO TO 8200-SEND-DATAONLY.
  9155
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 169
* EL6311.cbl
  9157
  9158******************************************************************
  9159*                                                                *
  9160*      BATCH SCREEN PF KEY CHECKING                              *
  9161*                                                                *
  9162******************************************************************
  9163
  9164******************************************************************
  9165*                                                                *
  9166*      PF KEY FUNCTIONS:                                         *
  9167*                                                                *
  9168*      PF1 = BROWSE FORWARD                                      *
  9169*      PF2 = BROWSE BACKWARD                                     *
  9170*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9171*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9172*                                                                *
  9173*                                                                *
  9174******************************************************************
  9175
  9176 0500-CHECK-BATCH-PF-KEYS.
  9177     IF EIBAID = DFHPF1
  9178        MOVE '0'                TO PI-EDIT-SW
  9179        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9180           GO TO 5000-BROWSE-BATCH-HEADERS
  9181        ELSE
  9182           IF PI-GOOD-BROWSE
  9183              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9184                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9185              ELSE
  9186                 IF PI-FILE-BROWSE
  9187                    GO TO 4300-BROWSE-FILE-FORWARD
  9188                 ELSE
  9189                    IF PI-CSR-BROWSE
  9190                       GO TO 4200-BROWSE-CSR-FORWARD
  9191                    ELSE
  9192                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9193           ELSE
  9194              GO TO 0800-BROWSE-ERROR.
  9195
  9196     IF EIBAID = DFHPF2
  9197        MOVE '0'                TO PI-EDIT-SW
  9198        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9199           GO TO 5500-BROWSE-BATCH-BACKWARD
  9200        ELSE
  9201           IF PI-GOOD-BROWSE
  9202              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9203                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9204              ELSE
  9205                 IF PI-FILE-BROWSE
  9206                    GO TO 4800-BROWSE-FILE-BACKWARD
  9207                 ELSE
  9208                    IF PI-CSR-BROWSE
  9209                       GO TO 4900-BROWSE-CSR-BACKWARD
  9210                    ELSE
  9211                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9212           ELSE
  9213              GO TO 0800-BROWSE-ERROR.
  9214
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 170
* EL6311.cbl
  9215     IF EIBAID = DFHPF3
  9216        GO TO 3000-BATCH-MAINLINE.
  9217
  9218     IF  EIBAID = DFHPF4
  9219        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9220        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9221        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9222        MOVE PI-SV-STATE            TO PI-CR-STATE
  9223        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9224                                       PI-CR-FIN-RESP
  9225        MOVE 'A'                    TO PI-CR-TYPE
  9226        MOVE SPACE                  TO PI-EDIT-SW
  9227        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9228        MOVE XCTL-EL640             TO PGM-NAME
  9229        GO TO 9300-XCTL.
  9230
  9231     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9232       AND
  9233        (EIBAID = DFHENTER)
  9234           GO TO 3500-EDIT-BATCH-DATA.
  9235
  9236     IF EIBAID = DFHENTER
  9237        GO TO 3500-EDIT-BATCH-DATA.
  9238
  9239     MOVE ER-0029             TO EMI-ERROR.
  9240     MOVE -1                  TO DPFENTRL.
  9241     MOVE AL-UNBON            TO DPFENTRA.
  9242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9243     GO TO 8200-SEND-DATAONLY.
  9244
  9245 0800-BROWSE-ERROR.
  9246     MOVE ER-2258                TO EMI-ERROR.
  9247     MOVE -1                     TO DPFENTRL.
  9248     MOVE AL-UNBON               TO DPFENTRA.
  9249     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9250     GO TO 8200-SEND-DATAONLY.
  9251
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 171
* EL6311.cbl
  9253
  9254******************************************************************
  9255*                                                                *
  9256*                I S S U E   M A I N L I N E                     *
  9257*                                                                *
  9258******************************************************************
  9259
  9260 1000-ISSUE-MAINLINE.
  9261     IF PI-DISPLAY-ORIGINAL-BATCH
  9262        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9263           MOVE ER-0023             TO EMI-ERROR
  9264           MOVE -1                  TO BMAINTL
  9265           MOVE AL-UABON            TO BMAINTA
  9266           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9267           GO TO 8200-SEND-DATAONLY
  9268        ELSE
  9269           NEXT SENTENCE
  9270     ELSE
  9271        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9272           MOVE ER-0023             TO EMI-ERROR
  9273           MOVE -1                  TO BMAINTL
  9274           MOVE AL-UABON            TO BMAINTA
  9275           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9276           GO TO 8200-SEND-DATAONLY.
  9277
  9278     IF BMAINTI = 'S'
  9279        GO TO 1100-SHOW-REQUEST.
  9280
  9281     IF NOT MODIFY-CAP
  9282         MOVE 'UPDATE'       TO SM-READ
  9283         PERFORM 9995-SECURITY-VIOLATION
  9284         MOVE ER-0070        TO EMI-ERROR
  9285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9286         GO TO 8100-SEND-INITIAL-MAP.
  9287
  9288     IF BMAINTL GREATER THAN ZEROS
  9289        IF PI-PF5-FUNCTION
  9290           IF BMAINTI NOT = 'A'
  9291              MOVE AL-UABON  TO BMAINTA
  9292              MOVE -1        TO BMAINTL
  9293              MOVE ER-2260   TO EMI-ERROR
  9294              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9295              GO TO 8200-SEND-DATAONLY.
  9296
  9297     IF BCERTNOL = ZEROS
  9298       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9299         NEXT SENTENCE
  9300     ELSE
  9301         IF BCERTNOL NOT = ZEROS
  9302             MOVE AL-UANON       TO BCERTNOA
  9303         ELSE
  9304             MOVE -1             TO BCERTNOL
  9305             MOVE  1             TO SET-CURSOR-SW
  9306             MOVE ER-2218        TO EMI-ERROR
  9307             MOVE AL-UABON       TO BCERTNOA
  9308             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309
  9310     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 172
* EL6311.cbl
  9311         MOVE AL-UANON       TO BSUFIXA
  9312     ELSE
  9313         MOVE AL-SANOF       TO BSUFIXA.
  9314
  9315     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9316        NEXT SENTENCE
  9317     ELSE
  9318        IF BEFFDTL NOT = ZEROS
  9319           MOVE AL-UNNON             TO BEFFDTA
  9320           MOVE BEFFDTI              TO DEEDIT-FIELD
  9321           PERFORM 8600-DEEDIT
  9322           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9323           MOVE 4                    TO DC-OPTION-CODE
  9324           PERFORM 9700-DATE-LINK
  9325           IF NO-CONVERSION-ERROR
  9326              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9327              ELSE
  9328              MOVE -1                TO BEFFDTL
  9329              MOVE  1                TO SET-CURSOR-SW
  9330              MOVE ER-2226           TO EMI-ERROR
  9331              MOVE AL-UNBON          TO BEFFDTA
  9332              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9333           ELSE
  9334              MOVE -1                TO BEFFDTL
  9335              MOVE  1                TO SET-CURSOR-SW
  9336              MOVE ER-2220           TO EMI-ERROR
  9337              MOVE AL-UNBON          TO BEFFDTA
  9338              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9339
  9340     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9341
  9342     IF BCERTNOL NOT = ZEROS
  9343        MOVE BCERTNOI                TO WS-NEW-PRIME
  9344     ELSE
  9345        MOVE SPACES                  TO WS-NEW-PRIME.
  9346
  9347     IF BSUFIXL NOT = ZEROS
  9348        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9349     ELSE
  9350        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9351
  9352     IF BEFFDTL NOT = ZEROS
  9353        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9354     ELSE
  9355        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9356
  9357     IF BMAINTI = 'A' OR 'K' OR 'S'
  9358        NEXT SENTENCE
  9359     ELSE
  9360        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9361        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9362           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9363           WS-PB-RECORD-TYPE NOT = '1'
  9364           IF BMAINTI = 'C'
  9365               MOVE ER-2287          TO EMI-ERROR
  9366               MOVE -1               TO BCERTNOL
  9367               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9368               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 173
* EL6311.cbl
  9369               GO TO 8200-SEND-DATAONLY
  9370             ELSE
  9371               MOVE ER-2260          TO EMI-ERROR
  9372               MOVE -1               TO BCERTNOL
  9373               MOVE AL-UABON         TO BCERTNOA
  9374               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9375               GO TO 8200-SEND-DATAONLY.
  9376
  9377     IF BMAINTI = 'D'
  9378         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9379
  9380*    IF BMICRNOL  NOT =  ZEROS
  9381*        IF BMICRNOI  NUMERIC
  9382*            MOVE AL-UNNON       TO  BMICRNOA
  9383*        ELSE
  9384*            MOVE -1             TO  BMICRNOL
  9385*            MOVE 1              TO  SET-CURSOR-SW
  9386*            MOVE AL-UNBON       TO  BMICRNOA
  9387*            MOVE ER-2701        TO  EMI-ERROR
  9388*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9389     IF BVINL NOT = ZEROS
  9390        MOVE AL-UANON            TO BVINA
  9391     END-IF
  9392     IF B1STNML NOT = ZEROS
  9393         MOVE AL-UANON                TO B1STNMA.
  9394
  9395     IF BINITL  NOT = ZEROS
  9396        MOVE AL-UANON                TO BINITA.
  9397
  9398     IF BSEXL NOT = ZEROS
  9399        IF BSEXI = 'M' OR 'F'
  9400           MOVE AL-UANON             TO BSEXA
  9401        ELSE
  9402           MOVE -1               TO BSEXL
  9403           MOVE ER-2629          TO EMI-ERROR
  9404           MOVE AL-UABON         TO BSEXA
  9405           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9406
  9407     IF BAGEL NOT = ZEROS
  9408         IF BAGEI NUMERIC
  9409             MOVE BAGEI              TO WS-BAGE
  9410             MOVE AL-UNNON           TO BAGEA
  9411         ELSE
  9412             MOVE -1                 TO BAGEL
  9413             MOVE  1                 TO SET-CURSOR-SW
  9414             MOVE ER-2223            TO EMI-ERROR
  9415             MOVE AL-UNBON           TO BAGEA
  9416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9417
  9418     IF BLSTNML NOT = ZERO  OR
  9419        B1STNML NOT = ZERO  OR
  9420        BINITL NOT = ZERO
  9421         IF BAGEL = ZEROS
  9422             MOVE -1                 TO BAGEL
  9423             MOVE  1                 TO SET-CURSOR-SW
  9424             MOVE ER-3269            TO EMI-ERROR
  9425             MOVE AL-UNBON           TO BAGEA
  9426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 174
* EL6311.cbl
  9427         END-IF
  9428     END-IF.
  9429
  9430     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9431
  9432     IF (BBIRTHL GREATER THAN +0) AND
  9433        (BBIRTHI NOT EQUAL SPACES)
  9434        NEXT SENTENCE
  9435     ELSE
  9436        GO TO 1010-CHECK-AGE.
  9437
  9438     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9439     PERFORM 8600-DEEDIT.
  9440     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9441     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9442     MOVE AL-UNNON               TO BBIRTHA.
  9443     MOVE '4'                    TO DC-OPTION-CODE.
  9444     PERFORM 9700-DATE-LINK.
  9445     IF DATE-CONVERSION-ERROR
  9446        MOVE -1                  TO BBIRTHL
  9447        MOVE  1                  TO SET-CURSOR-SW
  9448        MOVE ER-2228             TO EMI-ERROR
  9449        MOVE AL-UNBON            TO BBIRTHA
  9450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9451        GO TO 1010-CHECK-AGE.
  9452
  9453     IF (NO-CONVERSION-ERROR) AND
  9454        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9455        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9456        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9457        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9458                                    WS-CONVERTED-BIRTH
  9459        MOVE AL-UANON            TO BBIRTHA
  9460     ELSE
  9461        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9462        MOVE AL-UANON            TO BBIRTHA.
  9463
  9464 1010-CHECK-AGE.
  9465
  9466*    IF BAGEL = ZERO
  9467*       IF BBIRTHL GREATER THAN ZERO
  9468*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9469
  9470     IF B1STPMTL NOT = ZEROS
  9471        IF B1STPMTI = SPACES
  9472           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9473        ELSE
  9474           MOVE B1STPMTI             TO DEEDIT-FIELD
  9475           PERFORM 8600-DEEDIT
  9476           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9477           MOVE AL-UNNON             TO B1STPMTA
  9478           MOVE 4                    TO DC-OPTION-CODE
  9479           PERFORM 9700-DATE-LINK
  9480           IF NO-CONVERSION-ERROR
  9481              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9482              MOVE AL-UANON          TO B1STPMTA
  9483           ELSE
  9484              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 175
* EL6311.cbl
  9485              MOVE  1                TO SET-CURSOR-SW
  9486              MOVE ER-2200           TO EMI-ERROR
  9487              MOVE AL-UNBON          TO B1STPMTA
  9488              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9489
  9490     IF BDAYSL NOT = ZEROS
  9491         IF BDAYSI NUMERIC
  9492             MOVE AL-UNNON           TO BDAYSA
  9493         ELSE
  9494             MOVE -1                 TO BDAYSL
  9495             MOVE ER-2530            TO EMI-ERROR
  9496             MOVE AL-UNBON           TO BDAYSA
  9497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9498
  9499     IF BLNTRML NOT = ZEROS
  9500         IF BLNTRMI NUMERIC
  9501             MOVE AL-UNNON       TO BLNTRMA
  9502         ELSE
  9503             MOVE -1             TO BLNTRML
  9504             MOVE ER-2533        TO EMI-ERROR
  9505             MOVE AL-UNBON       TO BLNTRMA
  9506             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9507
  9508**   IF PI-COMPANY-ID = 'DMD'
  9509     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9510        NEXT SENTENCE
  9511     ELSE
  9512         IF BLNOFCRL NOT = ZEROS
  9513            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9514            IF LOAN-OFFICER-FOUND
  9515                MOVE AL-UANON        TO BLNOFCRA
  9516             ELSE
  9517                 MOVE SPACE          TO WS-LOAN-OFFICER
  9518                 MOVE -1             TO BLNOFCRL
  9519                 MOVE  1             TO SET-CURSOR-SW
  9520                 MOVE ER-3006        TO EMI-ERROR
  9521                 MOVE AL-UNBON       TO BLNOFCRA
  9522                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9523
  9524     IF BFREQL NOT = ZEROS
  9525         IF BFREQI NUMERIC
  9526             MOVE AL-UNNON       TO BFREQA
  9527         ELSE
  9528             MOVE -1             TO BFREQL
  9529             MOVE  1             TO SET-CURSOR-SW
  9530             MOVE ER-2223        TO EMI-ERROR
  9531             MOVE AL-UNBON       TO BFREQA
  9532             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9533
  9534     IF BMODEL NOT = ZEROS
  9535         MOVE BMODEI             TO WS-MODE-CODE
  9536                                    PI-BMODE
  9537         IF WS-MODE-CODE-VALID
  9538             MOVE AL-UANON       TO BMODEA
  9539         ELSE
  9540             MOVE -1             TO BMODEL
  9541             MOVE ER-2591        TO EMI-ERROR
  9542             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 176
* EL6311.cbl
  9543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9544
  9545     IF BPMTSL NOT = ZEROS
  9546         IF BPMTSI NUMERIC
  9547             MOVE AL-UNNON           TO BPMTSA
  9548             MOVE BPMTSI             TO PI-BPMTS
  9549         ELSE
  9550             MOVE -1                 TO BPMTSL
  9551             MOVE ER-2592            TO EMI-ERROR
  9552             MOVE AL-UNBON           TO BPMTSA
  9553             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9554
  9555     IF BPMTAMTL NOT = ZEROS
  9556
  9557* EXEC CICS BIF DEEDIT
  9558*            FIELD  (BPMTAMTI)
  9559*            LENGTH (9)
  9560*       END-EXEC
  9561     MOVE 9
  9562       TO DFHEIV11
  9563*    MOVE '@"L                   #   #00009491' TO DFHEIV0
  9564     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9565     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9566     MOVE X'2020233030303039343931' TO DFHEIV0(25:11)
  9567     CALL 'kxdfhei1' USING DFHEIV0,
  9568           BPMTAMTI,
  9569           DFHEIV11
  9570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9571        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9572*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9573*        PERFORM 8600-DEEDIT
  9574*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9575
  9576*    IF BAPRL NOT = ZEROS
  9577*        EXEC CICS BIF DEEDIT
  9578*            FIELD  (BAPRI)
  9579*            LENGTH (7)
  9580*        END-EXEC
  9581*        MOVE BAPRI              TO WS-BAPR.
  9582
  9583     IF BAPRL > 0
  9584        MOVE +0                  TO  WS-BAPR
  9585        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9586           (WS-SUB > 7)
  9587           OR (BAPRI (WS-SUB:1) NUMERIC)
  9588           OR (BAPRI (WS-SUB:1) = '.')
  9589        END-PERFORM
  9590        IF WS-SUB > 7
  9591           MOVE ER-2471       TO EMI-ERROR
  9592           MOVE -1            TO BAPRL
  9593           MOVE AL-UNBON      TO BAPRA
  9594           PERFORM 9900-ERROR-FORMAT
  9595                                 THRU 9900-EXIT
  9596        ELSE
  9597           IF BAPRI (WS-SUB:1) NUMERIC
  9598              MOVE WS-SUB           TO WS-BEG
  9599              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9600                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 177
* EL6311.cbl
  9601                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9602              END-PERFORM
  9603              COMPUTE WS-END = WS-SUB - WS-BEG
  9604              MOVE BAPRI (WS-BEG:WS-END)
  9605                                 TO WS-APR-WHOLE-NUM
  9606           END-IF
  9607           IF BAPRI (WS-SUB:1) = '.'
  9608              COMPUTE WS-BEG = WS-SUB + 1
  9609              IF (WS-BEG < 8)
  9610                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9611                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9612                    (WS-SUB > 7)
  9613                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9614                 END-PERFORM
  9615                 COMPUTE WS-END = WS-SUB - WS-BEG
  9616                 MOVE BAPRI (WS-BEG:WS-END)
  9617                                 TO WS-APR-DEC (1:WS-END)
  9618              END-IF
  9619           END-IF
  9620           MOVE AL-UNNON      TO BAPRA
  9621           MOVE WS-BAPR       TO BAPRO
  9622        END-IF
  9623     END-IF
  9624*     IF BAPRL NOT = ZEROS
  9625*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9626*        PERFORM 8600-DEEDIT
  9627*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9628
  9629     IF BLIVESL NOT = ZEROS
  9630        MOVE BLIVESI             TO DEEDIT-FIELD
  9631        PERFORM 8600-DEEDIT
  9632        IF DEEDIT-FIELD-V0 NUMERIC
  9633           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9634           MOVE AL-UNNON         TO BLIVESA
  9635        ELSE
  9636           MOVE -1               TO BLIVESL
  9637           MOVE AL-UNBON         TO BLIVESA
  9638           MOVE ER-2223          TO EMI-ERROR
  9639           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9640
  9641*DMD CUSTOM CODING*************START
  9642*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9643     IF PI-COMPANY-ID NOT = 'DMD'
  9644         MOVE ZEROS               TO BBILLEDL
  9645         GO TO 1010-EDIT-CONT.
  9646
  9647     IF BBILLEDL NOT = ZEROS
  9648        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9649        MOVE 'Y'                 TO WS-NUMERIC-SW
  9650        MOVE +1                  TO WS-CSO-SUB
  9651        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9652        IF CSO-NUMERIC-FIELD
  9653
  9654* EXEC CICS BIF DEEDIT
  9655*              FIELD  (BBILLEDI)
  9656*              LENGTH (9)
  9657*          END-EXEC
  9658     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 178
* EL6311.cbl
  9659       TO DFHEIV11
  9660*    MOVE '@"L                   #   #00009577' TO DFHEIV0
  9661     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9662     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9663     MOVE X'2020233030303039353737' TO DFHEIV0(25:11)
  9664     CALL 'kxdfhei1' USING DFHEIV0,
  9665           BBILLEDI,
  9666           DFHEIV11
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9668           MOVE BBILLEDI         TO WS-BILLED
  9669           MOVE AL-UNNON         TO BBILLEDA
  9670        ELSE
  9671           MOVE -1               TO BBILLEDL
  9672           MOVE AL-UNBON         TO BBILLEDA
  9673           MOVE ER-2547          TO EMI-ERROR
  9674           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9675     ELSE
  9676        IF BMAINTI EQUAL 'A'
  9677           MOVE -1               TO BBILLEDL
  9678           MOVE AL-UNBON         TO BBILLEDA
  9679           MOVE ER-8148          TO EMI-ERROR
  9680           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9681
  9682 1010-EDIT-CONT.
  9683
  9684     IF BFORCEL  NOT = ZEROS
  9685         IF FORCE-CAP
  9686            MOVE AL-UANON            TO BFORCEA
  9687         ELSE
  9688            MOVE ER-2945             TO EMI-ERROR
  9689            MOVE AL-UABON            TO BFORCEA
  9690            MOVE -1                  TO BFORCEL
  9691            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9692
  9693     IF BENTRYL NOT = ZEROS
  9694        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9695                         'D' AND 'V' AND 'U' AND 'M'
  9696           MOVE ER-2224              TO EMI-ERROR
  9697           MOVE AL-UABON             TO BENTRYA
  9698           MOVE -1                   TO BENTRYL
  9699           MOVE  1                   TO SET-CURSOR-SW
  9700           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9701        ELSE
  9702           MOVE AL-UANON             TO BENTRYA.
  9703
  9704     IF BUNWRITL NOT = ZEROS
  9705        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9706           MOVE ER-7574              TO EMI-ERROR
  9707           MOVE AL-UABON             TO BUNWRITA
  9708           MOVE -1                   TO BUNWRITL
  9709           MOVE  1                   TO SET-CURSOR-SW
  9710           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9711        ELSE
  9712           MOVE AL-UANON             TO BUNWRITA.
  9713
  9714     IF BREINL  NOT = ZEROS
  9715         MOVE AL-UANON               TO BREINA.
  9716
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 179
* EL6311.cbl
  9717     IF BBILCDL NOT = ZEROS
  9718        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9719                             AND 'A' AND 'B' AND 'E'
  9720           MOVE ER-2225              TO EMI-ERROR
  9721           MOVE AL-UABON             TO BBILCDA
  9722           MOVE -1                   TO BBILCDL
  9723           MOVE  1                   TO SET-CURSOR-SW
  9724           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9725        ELSE
  9726           MOVE AL-UANON             TO BBILCDA.
  9727
  9728     IF BSKPCDL NOT = ZEROS
  9729         MOVE AL-UANON               TO BSKPCDA.
  9730
  9731     IF BINDGRPL NOT = ZEROS
  9732         MOVE AL-UANON               TO BINDGRPA.
  9733
  9734     IF BSIGL   NOT = ZEROS
  9735         MOVE AL-UANON               TO BSIGA.
  9736
  9737     IF BRTCLSL NOT = ZEROS
  9738         MOVE AL-UANON               TO BRTCLSA.
  9739
  9740     IF BMEMBERL NOT = ZEROS
  9741         MOVE AL-UANON               TO BMEMBERA.
  9742
  9743     MOVE +0                         TO WS-SUB1.
  9744
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 180
* EL6311.cbl
  9746
  9747******************************************************************
  9748*                                                                *
  9749*           E D I T   I S S U E   C O V E R A G E S              *
  9750*                                                                *
  9751******************************************************************
  9752
  9753 1020-EDIT-COVERAGES.
  9754     ADD +1                      TO WS-SUB1.
  9755
  9756     IF WS-SUB1 GREATER +2
  9757        GO TO 1025-EDIT-COMPLETE.
  9758
  9759     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9760       IF (BMODEL   GREATER ZERO  OR
  9761            BPMTSL   GREATER ZERO  OR
  9762            BPMTAMTL GREATER ZERO)
  9763          AND
  9764            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9765               GO TO 1021-CONT-EDIT.
  9766
  9767     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9768        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9769        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9770        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9771        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9772        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9773        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9774        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9775        NEXT SENTENCE
  9776         ELSE
  9777            GO TO 1020-EDIT-COVERAGES.
  9778
  9779 1021-CONT-EDIT.
  9780
  9781     IF BMAINTI = 'A'
  9782        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9783           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9784        ELSE
  9785           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9786           MOVE ER-7404          TO EMI-ERROR
  9787           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9789     ELSE
  9790        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9791           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9792
  9793     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9794        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9795        PERFORM 8600-DEEDIT
  9796        IF DEEDIT-FIELD-V0 NUMERIC
  9797           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9798        ELSE
  9799           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9800
  9801     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9802*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9803        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 181
* EL6311.cbl
  9804           BPMTSL  GREATER THAN ZEROS
  9805           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9806
  9807     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9808         IF BMODEL   GREATER THAN ZEROS  OR
  9809            BPMTSL   GREATER THAN ZEROS  OR
  9810            BPMTAMTL GREATER THAN ZEROS
  9811             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9812
  9813     IF BMAINTI = ('C' OR 'K')
  9814        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9815           NEXT SENTENCE
  9816        ELSE
  9817           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9818           PERFORM 8600-DEEDIT
  9819           IF DEEDIT-FIELD-V0 NUMERIC
  9820              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9821              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9822                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9823              ELSE
  9824                    MOVE ER-2241      TO EMI-ERROR
  9825                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9826                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9827                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9828           ELSE
  9829              MOVE ER-2223          TO EMI-ERROR
  9830              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9831              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9832              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9833     ELSE
  9834        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9835            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9836            PERFORM 8600-DEEDIT
  9837            IF DEEDIT-FIELD-V0      NUMERIC
  9838               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9839                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9840                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9841               ELSE
  9842                  MOVE ER-2241         TO EMI-ERROR
  9843                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9844                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9845                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9846            ELSE
  9847              MOVE ER-2223             TO EMI-ERROR
  9848              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9849              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9850              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9851        ELSE
  9852            MOVE ER-2240               TO EMI-ERROR
  9853            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9854            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9855*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9856*        IF BMODEL  GREATER THAN ZEROS  AND
  9857*           BPMTSL  GREATER THAN ZEROS
  9858*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9859
  9860     IF BBEN-LEN (WS-SUB1) = ZEROS
  9861        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 182
* EL6311.cbl
  9862           NEXT SENTENCE
  9863     ELSE
  9864        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9865           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9866
  9867* EXEC CICS BIF DEEDIT
  9868*              FIELD  (BBENI (WS-SUB1))
  9869*              LENGTH (12)
  9870*          END-EXEC
  9871     MOVE 12
  9872       TO DFHEIV11
  9873*    MOVE '@"L                   #   #00009779' TO DFHEIV0
  9874     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9875     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9876     MOVE X'2020233030303039373739' TO DFHEIV0(25:11)
  9877     CALL 'kxdfhei1' USING DFHEIV0,
  9878           BBENI(WS-SUB1),
  9879           DFHEIV11
  9880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9881           IF BBENI (WS-SUB1)  NUMERIC
  9882              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9883                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9884*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9885*          PERFORM 8600-DEEDIT
  9886*          IF DEEDIT-FIELD-V2  NUMERIC
  9887*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9888*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9889              ELSE
  9890                 MOVE ER-7632    TO EMI-ERROR
  9891                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9892                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9893                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9894           ELSE
  9895              MOVE ER-2223         TO EMI-ERROR
  9896              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9897              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9898              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9899        ELSE
  9900           MOVE ER-7632    TO EMI-ERROR
  9901           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9902           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9904
  9905     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9906        AND (BMAINTI = ('C' OR 'K'))
  9907        CONTINUE
  9908     ELSE
  9909        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9910           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9911           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9912              FOR ALL '.'
  9913           IF WS-TALLY > 1
  9914              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9915                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9916              END-PERFORM
  9917              IF A1 < 9
  9918                 ADD 3 TO A1
  9919                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 183
* EL6311.cbl
  9920              END-IF
  9921           ELSE
  9922              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9923                (A1 > 11)
  9924                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9925                  LOW-VALUES OR SPACES)
  9926              END-PERFORM
  9927              IF A1 > 1 AND < 12
  9928                 MOVE SPACES
  9929                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9930              END-IF
  9931           END-IF
  9932
  9933* EXEC CICS BIF DEEDIT
  9934*              FIELD  (BPREMI (WS-SUB1))
  9935*              LENGTH (11)
  9936*          END-EXEC
  9937     MOVE 11
  9938       TO DFHEIV11
  9939*    MOVE '@"L                   #   #00009834' TO DFHEIV0
  9940     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9941     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9942     MOVE X'2020233030303039383334' TO DFHEIV0(25:11)
  9943     CALL 'kxdfhei1' USING DFHEIV0,
  9944           BPREMI(WS-SUB1),
  9945           DFHEIV11
  9946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9947           IF BPREMI (WS-SUB1) NUMERIC
  9948              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9949                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9950*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9951*          PERFORM 8600-DEEDIT
  9952*          IF DEEDIT-FIELD-V2  NUMERIC
  9953*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9954*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9955              ELSE
  9956                 IF PI-COMPANY-ID NOT = 'DCC'
  9957                    MOVE ER-7633    TO EMI-ERROR
  9958                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9959                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9960                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9961                 END-IF
  9962              END-IF
  9963           ELSE
  9964              MOVE ER-2223         TO EMI-ERROR
  9965              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9966              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9967              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9968           END-IF
  9969        ELSE
  9970           IF PI-COMPANY-ID NOT = 'DCC'
  9971              MOVE ER-7633         TO EMI-ERROR
  9972              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9973              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9974              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9975           END-IF
  9976        END-IF
  9977     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 184
* EL6311.cbl
  9978
  9979     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9980        NEXT SENTENCE
  9981     ELSE
  9982        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9983
  9984* EXEC CICS BIF DEEDIT
  9985*           FIELD  (BCPREMI (WS-SUB1))
  9986*           LENGTH (11)
  9987*       END-EXEC
  9988     MOVE 11
  9989       TO DFHEIV11
  9990*    MOVE '@"L                   #   #00009874' TO DFHEIV0
  9991     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9992     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9993     MOVE X'2020233030303039383734' TO DFHEIV0(25:11)
  9994     CALL 'kxdfhei1' USING DFHEIV0,
  9995           BCPREMI(WS-SUB1),
  9996           DFHEIV11
  9997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9998        IF BCPREMI (WS-SUB1) NUMERIC
  9999           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10000*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10001*       PERFORM 8600-DEEDIT
 10002*       IF DEEDIT-FIELD-V2  NUMERIC
 10003*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10004        ELSE
 10005           MOVE ER-2223         TO EMI-ERROR
 10006           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10007           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10009
 10010     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10011        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10012        PERFORM 8600-DEEDIT
 10013        IF DEEDIT-FIELD-V0 NUMERIC
 10014           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10015           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10016         ELSE
 10017           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10018           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10019           MOVE ER-2223              TO EMI-ERROR
 10020           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10021
 10022     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10023        IF BEXPIRE   (WS-SUB1) = SPACES
 10024           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10025        ELSE
 10026           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10027           PERFORM 8600-DEEDIT
 10028           IF DEEDIT-FIELD-V0        NUMERIC
 10029              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10030              MOVE 4                TO DC-OPTION-CODE
 10031              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10032              PERFORM 9700-DATE-LINK
 10033              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10034                                                        (WS-SUB1)
 10035              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 185
* EL6311.cbl
 10036                 NEXT SENTENCE
 10037              ELSE
 10038                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10039                 MOVE ER-2531    TO EMI-ERROR
 10040                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10041                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10042           ELSE
 10043             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10044             MOVE ER-2532        TO EMI-ERROR
 10045             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10047
 10048     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10049        NEXT SENTENCE
 10050     ELSE
 10051
 10052* EXEC CICS BIF DEEDIT
 10053*           FIELD  (BALT-BENI (WS-SUB1))
 10054*           LENGTH (12)
 10055*       END-EXEC
 10056     MOVE 12
 10057       TO DFHEIV11
 10058*    MOVE '@"L                   #   #00009931' TO DFHEIV0
 10059     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10060     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10061     MOVE X'2020233030303039393331' TO DFHEIV0(25:11)
 10062     CALL 'kxdfhei1' USING DFHEIV0,
 10063           BALT-BENI(WS-SUB1),
 10064           DFHEIV11
 10065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10066        IF BALT-BENI (WS-SUB1) NUMERIC
 10067           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10068*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10069*       PERFORM 8600-DEEDIT
 10070*       IF DEEDIT-FIELD-V0 NUMERIC
 10071*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10072        ELSE
 10073           MOVE ER-2223         TO EMI-ERROR
 10074           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10075           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10077
 10078     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10079        NEXT SENTENCE
 10080     ELSE
 10081
 10082* EXEC CICS BIF DEEDIT
 10083*           FIELD  (BALT-PREMI (WS-SUB1))
 10084*           LENGTH (11)
 10085*       END-EXEC
 10086     MOVE 11
 10087       TO DFHEIV11
 10088*    MOVE '@"L                   #   #00009950' TO DFHEIV0
 10089     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10090     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10091     MOVE X'2020233030303039393530' TO DFHEIV0(25:11)
 10092     CALL 'kxdfhei1' USING DFHEIV0,
 10093           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 186
* EL6311.cbl
 10094           DFHEIV11
 10095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10096        IF BALT-PREMI (WS-SUB1) NUMERIC
 10097           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10098*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10099*       PERFORM 8600-DEEDIT
 10100*       IF DEEDIT-FIELD-V0 NUMERIC
 10101*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10102        ELSE
 10103           MOVE ER-2223         TO EMI-ERROR
 10104           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10105           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10106           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10107
 10108      GO TO 1020-EDIT-COVERAGES.
 10109
 10110 1025-EDIT-COMPLETE.
 10111     IF PI-COMPANY-ID  =  'DMD'
 10112        MOVE LOW-VALUES             TO BNCERTI
 10113                                       BNSTATI.
 10114
 10115     IF EMI-ERROR = ZEROS
 10116         NEXT SENTENCE
 10117     ELSE
 10118         GO TO 8200-SEND-DATAONLY.
 10119
 10120     IF BMAINTI = 'A'
 10121         GO TO 1200-ADD-ISSUE-ROUTINE.
 10122
 10123     IF BMAINTI = 'C'
 10124         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10125
 10126     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10127
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 187
* EL6311.cbl
 10129
 10130 1030-EDIT-FOR-NUMERICS.
 10131     IF WS-CSO-SUB EQUAL 10
 10132        GO TO 1030-EDIT-EXIT.
 10133
 10134     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10135        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10136        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10137           ADD +1               TO WS-CSO-SUB
 10138           GO TO 1030-EDIT-FOR-NUMERICS.
 10139
 10140     MOVE 'N'                   TO WS-NUMERIC-SW.
 10141
 10142 1030-EDIT-EXIT.
 10143******************************************************************
 10144*                                                                *
 10145*                 C A L C U L A T E   A G E                      *
 10146*                                                                *
 10147******************************************************************
 10148
 10149
 10150 1095-CALC-AGE.
 10151
 10152     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10153     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10154     MOVE 1                  TO DC-OPTION-CODE.
 10155     PERFORM 9700-DATE-LINK
 10156     IF NO-CONVERSION-ERROR
 10157         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10158         MOVE WS-BAGE            TO BAGEI
 10159         MOVE +2                 TO BAGEL
 10160         MOVE AL-UNNON TO BAGEA.
 10161
 10162 1099-EXIT.
 10163     EXIT.
 10164
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 188
* EL6311.cbl
 10166
 10167******************************************************************
 10168*                                                                *
 10169*                   S H O W   I S S U E                          *
 10170*                                                                *
 10171******************************************************************
 10172
 10173 1100-SHOW-REQUEST.
 10174     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10175
 10176     IF BCERTNOL = ZEROS AND
 10177        BEFFDTL  = ZEROS
 10178        MOVE -1                  TO BMAINTL
 10179        GO TO 8200-SEND-DATAONLY.
 10180
 10181     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10182
 10183     IF BSUFIXL NOT = ZEROS
 10184        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10185     ELSE
 10186        MOVE SPACE               TO WS-NEW-SUFFIX.
 10187
 10188     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10189     PERFORM 8600-DEEDIT.
 10190     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10191     MOVE '4'                    TO DC-OPTION-CODE.
 10192     PERFORM 9700-DATE-LINK.
 10193     IF DATE-CONVERSION-ERROR
 10194        MOVE ER-0348             TO EMI-ERROR
 10195        MOVE -1                  TO BEFFDTL
 10196        MOVE AL-UABON            TO BEFFDTA
 10197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10198        GO TO 8200-SEND-DATAONLY
 10199     ELSE
 10200        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10201        MOVE AL-UANON            TO BEFFDTA
 10202        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10203
 10204     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10205
 10206     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10207        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10208          MOVE 'Y'                    TO WS-SHOW-SW
 10209          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10210             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10211           ELSE
 10212             IF PI-FILE-BROWSE
 10213                GO TO 4300-BROWSE-FILE-FORWARD
 10214              ELSE
 10215                IF PI-CSR-BROWSE
 10216                   GO TO 4200-BROWSE-CSR-FORWARD
 10217                ELSE
 10218                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10219        ELSE
 10220           GO TO 3900-RE-DISPLAY-RECORD.
 10221
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 189
* EL6311.cbl
 10223
 10224******************************************************************
 10225*                                                                *
 10226*            A D D   I S S U E   R O U T I N E                   *
 10227*                                                                *
 10228******************************************************************
 10229
 10230***************************************************************
 10231*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10232*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10233*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10234*     4. LINK TO THE EDIT ROUTINE.                            *
 10235*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10236*     6. WRITE THE NEW ISSUE RECORD.                          *
 10237*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10238*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10239*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10240*        ELSE                                                 *
 10241*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10242***************************************************************
 10243
 10244 1200-ADD-ISSUE-ROUTINE.
 10245     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10246
 10247
 10248* EXEC CICS GETMAIN
 10249*        SET     (ADDRESS OF PENDING-BUSINESS)
 10250*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10251*    END-EXEC.
 10252*    MOVE '," L                  $   #00010105' TO DFHEIV0
 10253     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10254     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10255     MOVE X'2020233030303130313035' TO DFHEIV0(25:11)
 10256     CALL 'kxdfhei1' USING DFHEIV0,
 10257           DFHEIV20,
 10258           ERPNDB-RECORD-LENGTH,
 10259           DFHEIV99
 10260     SET ADDRESS OF PENDING-BUSINESS TO
 10261         DFHEIV20
 10262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10263
 10264
 10265
 10266* EXEC CICS HANDLE CONDITION
 10267*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10268*    END-EXEC.
 10269*    MOVE '"$I                   ! # #00010110' TO DFHEIV0
 10270     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10272     MOVE X'2320233030303130313130' TO DFHEIV0(25:11)
 10273     CALL 'kxdfhei1' USING DFHEIV0
 10274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10275
 10276
 10277     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10278     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10279     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10280
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 190
* EL6311.cbl
 10281
 10282* EXEC CICS READ
 10283*        INTO    (PENDING-BUSINESS)
 10284*        DATASET (FILE-ID-ERPNDB)
 10285*        RIDFLD  (ERPNDB-KEY)
 10286*    END-EXEC.
 10287     MOVE LENGTH OF
 10288      PENDING-BUSINESS
 10289       TO DFHEIV11
 10290*    MOVE '&"IL       E          (   #00010118' TO DFHEIV0
 10291     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10293     MOVE X'2020233030303130313138' TO DFHEIV0(25:11)
 10294     CALL 'kxdfhei1' USING DFHEIV0,
 10295           FILE-ID-ERPNDB,
 10296           PENDING-BUSINESS,
 10297           DFHEIV11,
 10298           ERPNDB-KEY,
 10299           DFHEIV99,
 10300           DFHEIV99,
 10301           DFHEIV99
 10302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10303
 10304
 10305     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10306
 10307     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10308     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10309     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10310     MOVE SPACES                 TO PENDING-BUSINESS.
 10311     MOVE 'PB'                   TO PB-RECORD-ID.
 10312     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10313     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10314     MOVE SPACES                 TO PB-CERT-SFX.
 10315     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10316     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10317                                    PB-ALT-CHG-SEQ-NO.
 10318
 10319     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10320     MOVE '1'                    TO PB-RECORD-TYPE.
 10321
 10322     IF BSUFIXL NOT = ZEROS
 10323        MOVE BSUFIXI             TO PB-CERT-SFX.
 10324
 10325     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10326
 10327     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10328     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10329
 10330     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10331                                    PB-I-LF-PREM-CALC
 10332                                    PB-I-LF-ALT-PREM-CALC
 10333                                    PB-I-LF-RATE
 10334                                    PB-I-LF-ALT-RATE
 10335                                    PB-I-LF-REI-RATE
 10336                                    PB-I-LF-ALT-REI-RATE
 10337                                    PB-I-RATE-DEV-PCT-LF
 10338                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 191
* EL6311.cbl
 10339                                    PB-I-AH-RATE
 10340                                    PB-I-AH-REI-RATE
 10341                                    PB-I-AH-RATE-TRM
 10342                                    PB-I-RATE-DEV-PCT-AH
 10343                                    PB-I-BUSINESS-TYPE
 10344                                    PB-I-LIFE-COMMISSION
 10345                                    PB-I-JOINT-COMMISSION
 10346                                    PB-I-JOINT-AGE
 10347                                    PB-I-AH-COMMISSION
 10348                                    PB-I-CURR-SEQ
 10349                                    PB-CHG-COUNT
 10350                                    PB-LF-BILLED-AMTS
 10351                                    PB-AH-BILLED-AMTS
 10352                                    PB-CALC-TOLERANCE
 10353                                    PB-I-EXTENTION-DAYS
 10354*                                   PB-I-MICROFILM-NO
 10355                                    PB-I-TERM-IN-DAYS.
 10356
 10357     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10358                                    PB-I-LF-EXPIRE-DT
 10359                                    PB-I-AH-EXPIRE-DT
 10360                                    PB-BILLED-DT
 10361                                    PB-ACCT-EFF-DT
 10362                                    PB-ACCT-EXP-DT
 10363                                    PB-I-1ST-PMT-DT.
 10364
 10365     MOVE 'X'                    TO PB-FATAL-FLAG.
 10366
 10367     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10368
 10369     IF BLSTNML GREATER THAN ZEROS
 10370         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10371
 10372*    IF BMICRNOL  GREATER  ZEROS
 10373*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10374*    ELSE
 10375*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10376     IF BVINL > ZEROS
 10377        MOVE BVINI               TO PB-I-VIN
 10378     END-IF
 10379     IF B1STNML GREATER THAN ZEROS
 10380         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10381
 10382     IF BINITL  GREATER THAN ZEROS
 10383         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10384
 10385     IF BBIRTHL GREATER THAN ZERO
 10386         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10387     ELSE
 10388         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10389
 10390     IF B1STPMTL GREATER THAN ZERO
 10391         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10392     ELSE
 10393         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10394
 10395     IF BAGEL    GREATER THAN ZEROS
 10396         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 192
* EL6311.cbl
 10397        ELSE
 10398         MOVE ZEROS              TO PB-I-AGE.
 10399
 10400     IF BSEXL    GREATER THAN ZEROS
 10401         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10402
 10403     IF BTERM-LEN (1) GREATER THAN ZEROS
 10404        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10405     ELSE
 10406        MOVE ZEROS               TO PB-I-LF-TERM.
 10407
 10408     IF BTERM-LEN (2) GREATER THAN ZEROS
 10409        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10410     ELSE
 10411        MOVE ZEROS               TO PB-I-AH-TERM.
 10412
 10413     IF BLNTRML       GREATER THAN ZEROS
 10414         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10415        ELSE
 10416         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10417
 10418     IF BFREQL        GREATER THAN ZEROS
 10419         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10420        ELSE
 10421         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10422
 10423     IF BSKPCDL       GREATER THAN ZEROS
 10424         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10425
 10426     IF BMODEL        GREATER THAN ZEROS
 10427         MOVE BMODEI             TO PB-I-TERM-TYPE
 10428                                    PI-BMODE.
 10429
 10430     IF BPMTSL        GREATER THAN ZEROS
 10431         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10432                                    PI-BPMTS
 10433        ELSE
 10434         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10435                                    PI-BPMTS.
 10436
 10437     IF BPMTAMTL      GREATER THAN ZEROS
 10438         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10439        ELSE
 10440         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10441
 10442     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10443        IF BTYPE  (1)   NOT = ZEROS
 10444           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10445                                    PI-BTYPE (1)
 10446           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10447           MOVE SPACES           TO PB-I-LF-ABBR
 10448        ELSE
 10449           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10450                                    PB-I-LF-ABBR
 10451           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10452     ELSE
 10453        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10454                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 193
* EL6311.cbl
 10455        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10456
 10457     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10458         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10459     ELSE
 10460         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10461
 10462     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10463         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10464     ELSE
 10465         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10466
 10467     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10468         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10469            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10470            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10471         ELSE
 10472            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10473*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10474*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10475         END-IF
 10476     ELSE
 10477         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10478
 10479     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10480         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10481
 10482     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10483         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10484         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10485     ELSE
 10486         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10487
 10488     IF  BALT-PREM-LEN     (2) > ZEROS
 10489         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10490     ELSE
 10491         MOVE ZEROS            TO PB-I-TOT-FEES.
 10492
 10493     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10494        IF BTYPE      (2)   NOT = ZEROS
 10495           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10496                                  PI-BTYPE (2)
 10497           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10498           MOVE SPACES         TO PB-I-AH-ABBR
 10499        ELSE
 10500           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10501                                  PB-I-AH-ABBR
 10502           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10503     ELSE
 10504        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10505                                  PB-I-AH-ABBR
 10506        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10507
 10508     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10509         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10510     ELSE
 10511         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10512
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 194
* EL6311.cbl
 10513     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10514         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10515            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10516            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10517         ELSE
 10518            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10519*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10520*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10521         END-IF
 10522     ELSE
 10523         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10524
 10525     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10526         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10527
 10528     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10529        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10530     ELSE
 10531        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10532
 10533     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10534        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10535     ELSE
 10536        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10537
 10538     IF BINDGRPL  GREATER THAN ZEROS
 10539         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10540
 10541     IF BRTCLSL   GREATER THAN ZEROS
 10542         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10543
 10544     IF BSIGL     GREATER THAN ZEROS
 10545         MOVE BSIGI              TO PB-I-SIG-SW.
 10546     IF BAPRL > ZEROS
 10547         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10548     ELSE
 10549        if pi-company-id = 'CID'
 10550           move +99.9999         to pb-i-loan-apr
 10551        else
 10552           MOVE ZEROS            TO PB-I-LOAN-APR
 10553        end-if
 10554     end-if
 10555     IF BMEMBERL  GREATER THAN ZEROS
 10556         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10557
 10558     IF BLNOFCRL  GREATER THAN ZEROS
 10559         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10560
 10561     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10562        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10563     ELSE
 10564        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10565
 10566     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10567        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10568     ELSE
 10569        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10570
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 195
* EL6311.cbl
 10571     IF BDAYSL   GREATER THAN ZEROS
 10572        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10573                                    PB-I-EXTENTION-DAYS
 10574     ELSE
 10575        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10576                                    PB-I-EXTENTION-DAYS.
 10577
 10578     IF BDAYSL GREATER THAN ZEROS
 10579        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10580
 10581     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10582        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10583           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10584
 10585     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10586        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10587           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10588
 10589     IF B1STPMTL GREATER THAN ZEROS
 10590        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10591
 10592     IF PB-EXT-DAYS-PROCESSING
 10593        IF PB-I-EXTENTION-DAYS = ZEROS
 10594           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10595
 10596     IF PB-EXPIRE-DT-PROCESSING
 10597        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10598           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10599             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10600
 10601     IF PB-1ST-PMT-DT-PROCESSING
 10602        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10603           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10604
 10605     IF BREINL GREATER THAN ZEROS
 10606        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10607
 10608     IF BENTRYL NOT = ZEROS
 10609        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10610        IF PI-COMPANY-ID = 'CID'
 10611           AND (PB-BATCH-ENTRY = 'P')
 10612           AND (PB-STATE = 'VA')
 10613           PERFORM 1500-UPDATE-ERNOTE
 10614                                 THRU 1500-EXIT
 10615        END-IF
 10616     END-IF
 10617     IF BUNWRITL NOT = ZEROS
 10618        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10619
 10620     IF BFORCEL NOT = ZEROS
 10621        MOVE BFORCEI             TO PB-FORCE-CODE.
 10622
 10623     IF BBILCDL NOT = ZEROS
 10624        MOVE BBILCDI             TO PB-RECORD-BILL.
 10625
 10626     IF BLIVESL GREATER THAN ZEROS
 10627        MOVE WS-BLIVES           TO PB-I-LIVES
 10628     ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 196
* EL6311.cbl
 10629        MOVE ZEROS               TO PB-I-LIVES.
 10630
 10631     IF BBILLEDL GREATER THAN ZEROS
 10632        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10633     ELSE
 10634        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10635
 10636*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10637
 10638 1260-WRITE-PB-RECORD.
 10639     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10640                                    PB-INPUT-BY.
 10641     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10642     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10643                                    PB-INPUT-DT.
 10644
 10645     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10646     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10647                                    PB-CONTROL-BY-ORIG-BATCH.
 10648
 10649
 10650     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10651     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10652     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10653     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10654     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10655
 10656     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10657
 10658     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10659
 10660     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10661     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10662     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10663
 10664     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10665     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10666
 10667 1275-WRITE-PENDING-BUSINESS.
 10668     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10669     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10670     MOVE 'A'                    TO JP-RECORD-TYPE.
 10671     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10672
 10673
 10674* EXEC CICS HANDLE CONDITION
 10675*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10676*    END-EXEC.
 10677*    MOVE '"$%                   ! $ #00010492' TO DFHEIV0
 10678     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10680     MOVE X'2420233030303130343932' TO DFHEIV0(25:11)
 10681     CALL 'kxdfhei1' USING DFHEIV0
 10682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10683
 10684
 10685
 10686* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 197
* EL6311.cbl
 10687*        DATASET (FILE-ID-ERPNDB)
 10688*        FROM    (PENDING-BUSINESS)
 10689*        RIDFLD  (PB-CONTROL-PRIMARY)
 10690*    END-EXEC.
 10691     MOVE LENGTH OF
 10692      PENDING-BUSINESS
 10693       TO DFHEIV11
 10694*    MOVE '&$ L                  ''   #00010496' TO DFHEIV0
 10695     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10696     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10697     MOVE X'2020233030303130343936' TO DFHEIV0(25:11)
 10698     CALL 'kxdfhei1' USING DFHEIV0,
 10699           FILE-ID-ERPNDB,
 10700           PENDING-BUSINESS,
 10701           DFHEIV11,
 10702           PB-CONTROL-PRIMARY,
 10703           DFHEIV99,
 10704           DFHEIV99
 10705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10706
 10707
 10708     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10709
 10710     PERFORM 8400-LOG-JOURNAL-RECORD.
 10711
 10712******************************************************************
 10713*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10714******************************************************************
 10715     display ' made it to add orig cert '
 10716     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10717     MOVE ' '                    TO WS-ERMAIL-SW
 10718
 10719* EXEC CICS READ
 10720*       DATASET   (FILE-ID-ERMAIL)
 10721*       SET       (ADDRESS OF MAILING-DATA)
 10722*       RIDFLD    (ERMAIL-KEY)
 10723*       RESP      (WS-RESPONSE)
 10724*    END-EXEC
 10725*    MOVE '&"S        E          (  N#00010512' TO DFHEIV0
 10726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10728     MOVE X'204E233030303130353132' TO DFHEIV0(25:11)
 10729     CALL 'kxdfhei1' USING DFHEIV0,
 10730           FILE-ID-ERMAIL,
 10731           DFHEIV20,
 10732           DFHEIV99,
 10733           ERMAIL-KEY,
 10734           DFHEIV99,
 10735           DFHEIV99,
 10736           DFHEIV99
 10737     SET ADDRESS OF MAILING-DATA TO
 10738         DFHEIV20
 10739     MOVE EIBRESP  TO WS-RESPONSE
 10740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10741     IF RESP-NORMAL
 10742        SET ERMAIL-FOUND TO TRUE
 10743     END-IF
 10744
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 198
* EL6311.cbl
 10745     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10746     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10747     MOVE 'OC'                   TO OC-RECORD-ID
 10748     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10749                                 TO OC-CONTROL-PRIMARY (1:33)
 10750     MOVE 'I'                    TO OC-RECORD-TYPE
 10751     MOVE +4096                  TO OC-KEY-SEQ-NO
 10752     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10753     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10754     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10755     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10756     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10757     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10758     MOVE PB-I-AGE               TO OC-INS-AGE
 10759     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10760     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10761     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10762     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10763     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10764     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10765     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10766     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10767     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10768     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10769     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10770     IF PB-I-JOINT-COMMISSION > +0
 10771         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10772     ELSE
 10773         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10774     END-IF
 10775     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10776     MOVE +0                     TO OC-LF-CANCEL-AMT
 10777                                    OC-LF-ITD-CANCEL-AMT
 10778     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10779     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10780     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10781     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10782     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10783     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10784     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10785     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10786     MOVE +0                     TO OC-AH-CANCEL-AMT
 10787                                    OC-AH-ITD-CANCEL-AMT
 10788     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10789     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10790     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10791     IF ERMAIL-FOUND
 10792        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10793     END-IF
 10794     IF NOT CERT-TRL-REC-NOT-FOUND
 10795        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10796                           OC-INS-AGE-DEFAULT-FLAG
 10797        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10798                           OC-JNT-AGE-DEFAULT-FLAG
 10799     END-IF
 10800     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10801     .
 10802 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 199
* EL6311.cbl
 10803
 10804* EXEC CICS WRITE
 10805*       DATASET   ('ELCRTO')
 10806*       FROM      (ORIGINAL-CERTIFICATE)
 10807*       RIDFLD    (OC-CONTROL-PRIMARY)
 10808*       RESP      (WS-RESPONSE)
 10809*    END-EXEC
 10810     MOVE LENGTH OF
 10811      ORIGINAL-CERTIFICATE
 10812       TO DFHEIV11
 10813     MOVE 'ELCRTO' TO DFHEIV1
 10814*    MOVE '&$ L                  ''  N#00010580' TO DFHEIV0
 10815     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10816     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10817     MOVE X'204E233030303130353830' TO DFHEIV0(25:11)
 10818     CALL 'kxdfhei1' USING DFHEIV0,
 10819           DFHEIV1,
 10820           ORIGINAL-CERTIFICATE,
 10821           DFHEIV11,
 10822           OC-CONTROL-PRIMARY,
 10823           DFHEIV99,
 10824           DFHEIV99
 10825     MOVE EIBRESP  TO WS-RESPONSE
 10826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10827     display ' just wrote 1275 ' ws-response
 10828     IF RESP-DUPKEY
 10829        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10830        GO TO 1275-WRITE-ELCRTO
 10831     ELSE
 10832        IF NOT RESP-NORMAL
 10833           MOVE -1               TO BMAINTL
 10834           MOVE ER-7450          TO EMI-ERROR
 10835           PERFORM 9900-ERROR-FORMAT
 10836                                 THRU 9900-EXIT
 10837           GO TO 8200-SEND-DATAONLY
 10838        END-IF
 10839     END-IF
 10840******************************************************************
 10841*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10842******************************************************************
 10843
 10844
 10845* EXEC CICS READ
 10846*        INTO    (PENDING-BUSINESS)
 10847*        DATASET (FILE-ID-ERPNDB)
 10848*        RIDFLD  (ERPNDB-KEY)
 10849*        UPDATE
 10850*    END-EXEC.
 10851     MOVE LENGTH OF
 10852      PENDING-BUSINESS
 10853       TO DFHEIV11
 10854*    MOVE '&"IL       EU         (   #00010603' TO DFHEIV0
 10855     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10856     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10857     MOVE X'2020233030303130363033' TO DFHEIV0(25:11)
 10858     CALL 'kxdfhei1' USING DFHEIV0,
 10859           FILE-ID-ERPNDB,
 10860           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 200
* EL6311.cbl
 10861           DFHEIV11,
 10862           ERPNDB-KEY,
 10863           DFHEIV99,
 10864           DFHEIV99,
 10865           DFHEIV99
 10866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10867
 10868
 10869     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10870     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10871     MOVE 'B'                    TO JP-RECORD-TYPE.
 10872     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10873
 10874     PERFORM 8400-LOG-JOURNAL-RECORD.
 10875
 10876     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10877
 10878
 10879* EXEC CICS REWRITE
 10880*        DATASET (FILE-ID-ERPNDB)
 10881*        FROM    (PENDING-BUSINESS)
 10882*    END-EXEC.
 10883     MOVE LENGTH OF
 10884      PENDING-BUSINESS
 10885       TO DFHEIV11
 10886*    MOVE '&& L                  %   #00010619' TO DFHEIV0
 10887     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10888     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10889     MOVE X'2020233030303130363139' TO DFHEIV0(25:11)
 10890     CALL 'kxdfhei1' USING DFHEIV0,
 10891           FILE-ID-ERPNDB,
 10892           PENDING-BUSINESS,
 10893           DFHEIV11,
 10894           DFHEIV99
 10895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10896
 10897
 10898     MOVE 'C'                    TO JP-RECORD-TYPE.
 10899     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10900
 10901     PERFORM 8400-LOG-JOURNAL-RECORD.
 10902
 10903     IF WS-ERRORS-PRESENT
 10904         GO TO 3900-RE-DISPLAY-RECORD.
 10905
 10906     MOVE ZEROS                  TO EMI-ERROR.
 10907     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10908     MOVE LOW-VALUES             TO EL631BI.
 10909     MOVE  -1                    TO BMAINTL.
 10910     GO TO 8100-SEND-INITIAL-MAP.
 10911
 10912 1280-BATCH-HDR-NOT-FOUND.
 10913     MOVE -1                     TO BMAINTL.
 10914     MOVE ER-7450                TO EMI-ERROR.
 10915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10916     GO TO 8200-SEND-DATAONLY.
 10917
 10918 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 201
* EL6311.cbl
 10919
 10920******************************************************************
 10921*                                                                *
 10922*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10923*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10924*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10925*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10926*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10927*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10928*                                                                *
 10929******************************************************************
 10930
 10931     IF LCP-ONCTR-01 =  0
 10932         ADD 1 TO LCP-ONCTR-01
 10933        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10934
 10935     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10936
 10937     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10938         NEXT SENTENCE
 10939     ELSE
 10940         ADD +1 TO PB-BATCH-SEQ-NO
 10941                   PB-CSR-BATCH-SEQ-NO
 10942         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10943         GO TO 1275-WRITE-PENDING-BUSINESS.
 10944
 10945     MOVE -1                     TO BCERTNOL.
 10946     MOVE AL-UABON               TO BCERTNOA.
 10947     MOVE AL-UNBON               TO BEFFDTA.
 10948
 10949     MOVE 1                      TO EMI-SUB
 10950                                    EMI-SWITCH1
 10951                                    EMI-SWITCH-AREA-1
 10952                                    EMI-SWITCH-AREA-2.
 10953
 10954     MOVE SPACES                 TO EMI-ERROR-LINES.
 10955
 10956
 10957* EXEC CICS SYNCPOINT ROLLBACK
 10958*    END-EXEC.
 10959*    MOVE '6"R                   !   #00010682' TO DFHEIV0
 10960     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10962     MOVE X'2020233030303130363832' TO DFHEIV0(25:11)
 10963     CALL 'kxdfhei1' USING DFHEIV0
 10964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10965
 10966
 10967     MOVE ER-2247                TO EMI-ERROR.
 10968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10969     GO TO 8200-SEND-DATAONLY.
 10970
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 202
* EL6311.cbl
 10972
 10973
 10974 1295-READ-CERT-TRAILER.
 10975
 10976
 10977* EXEC CICS GETMAIN
 10978*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10979*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10980*        INITIMG (GETMAIN-SPACE)
 10981*    END-EXEC
 10982*    MOVE ',"IL                  $   #00010694' TO DFHEIV0
 10983     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10984     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10985     MOVE X'2020233030303130363934' TO DFHEIV0(25:11)
 10986     CALL 'kxdfhei1' USING DFHEIV0,
 10987           DFHEIV20,
 10988           ELCRTT-RECORD-LENGTH,
 10989           GETMAIN-SPACE
 10990     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10991         DFHEIV20
 10992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10993
 10994     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10995     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10996     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10997
 10998
 10999* EXEC CICS HANDLE CONDITION
 11000*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11001*    END-EXEC.
 11002*    MOVE '"$I                   ! % #00010704' TO DFHEIV0
 11003     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11005     MOVE X'2520233030303130373034' TO DFHEIV0(25:11)
 11006     CALL 'kxdfhei1' USING DFHEIV0
 11007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11008
 11009
 11010
 11011* EXEC CICS READ
 11012*        DATASET  (CRTT-ID)
 11013*        RIDFLD   (ELCRTT-KEY)
 11014*        INTO     (CERTIFICATE-TRAILERS)
 11015*    END-EXEC.
 11016     MOVE LENGTH OF
 11017      CERTIFICATE-TRAILERS
 11018       TO DFHEIV11
 11019*    MOVE '&"IL       E          (   #00010708' TO DFHEIV0
 11020     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11022     MOVE X'2020233030303130373038' TO DFHEIV0(25:11)
 11023     CALL 'kxdfhei1' USING DFHEIV0,
 11024           CRTT-ID,
 11025           CERTIFICATE-TRAILERS,
 11026           DFHEIV11,
 11027           ELCRTT-KEY,
 11028           DFHEIV99,
 11029           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 203
* EL6311.cbl
 11030           DFHEIV99
 11031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11032
 11033
 11034     GO TO 1295-EXIT.
 11035
 11036 1295-CERT-TRL-REC-NOTFND.
 11037     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11038
 11039 1295-EXIT.
 11040     EXIT.
 11041
 11042******************************************************************
 11043*                                                                *
 11044*          C H A N G E   I S S U E   R O U T I N E               *
 11045*                                                                *
 11046******************************************************************
 11047
 11048***************************************************************
 11049*                                                             *
 11050*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11051*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11052*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11053*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11054*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11055*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11056*     5. LINK TO THE EDIT ROUTINE.                            *
 11057*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11058*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11059*              THE EDIT ROUTINE.                              *
 11060*     7. REWRITE THE NEW ISSUE                                *
 11061*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11062*                                                             *
 11063***************************************************************
 11064
 11065 1300-CHANGE-ISSUE-ROUTINE.
 11066     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11067
 11068     IF BCHGL NOT = ZEROS
 11069        MOVE ER-2196             TO EMI-ERROR
 11070        MOVE AL-UABON            TO BMAINTA
 11071        MOVE -1                  TO BMAINTL
 11072        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11073        GO TO 8200-SEND-DATAONLY.
 11074
 11075     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11076
 11077     IF BSUFIXL NOT = ZEROS
 11078        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11079     ELSE
 11080        MOVE SPACE               TO WS-NEW-SUFFIX.
 11081
 11082     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11083     PERFORM 8600-DEEDIT.
 11084     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11085     MOVE '4'                    TO DC-OPTION-CODE.
 11086     PERFORM 9700-DATE-LINK.
 11087     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 204
* EL6311.cbl
 11088        MOVE ER-0348             TO EMI-ERROR
 11089        MOVE -1                  TO BEFFDTL
 11090        MOVE AL-UABON            TO BEFFDTA
 11091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11092        GO TO 8200-SEND-DATAONLY
 11093     ELSE
 11094        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11095        MOVE AL-UANON            TO BEFFDTA
 11096        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11097
 11098 1325-PROCESS-ISSUE-CHANGES.
 11099
 11100* EXEC CICS HANDLE CONDITION
 11101*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11102*    END-EXEC.
 11103*    MOVE '"$I                   ! & #00010779' TO DFHEIV0
 11104     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11106     MOVE X'2620233030303130373739' TO DFHEIV0(25:11)
 11107     CALL 'kxdfhei1' USING DFHEIV0
 11108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11109
 11110
 11111     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11112     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11113     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11114
 11115
 11116* EXEC CICS GETMAIN
 11117*        SET      (ADDRESS OF PENDING-BUSINESS)
 11118*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11119*        INITIMG  (GETMAIN-SPACE)
 11120*     END-EXEC.
 11121*    MOVE ',"IL                  $   #00010787' TO DFHEIV0
 11122     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11123     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11124     MOVE X'2020233030303130373837' TO DFHEIV0(25:11)
 11125     CALL 'kxdfhei1' USING DFHEIV0,
 11126           DFHEIV20,
 11127           ERPNDB-RECORD-LENGTH,
 11128           GETMAIN-SPACE
 11129     SET ADDRESS OF PENDING-BUSINESS TO
 11130         DFHEIV20
 11131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11132
 11133
 11134
 11135* EXEC CICS READ
 11136*        INTO    (PENDING-BUSINESS)
 11137*        DATASET (FILE-ID-ERPNDB)
 11138*        RIDFLD  (ERPNDB-KEY)
 11139*    END-EXEC.
 11140     MOVE LENGTH OF
 11141      PENDING-BUSINESS
 11142       TO DFHEIV11
 11143*    MOVE '&"IL       E          (   #00010793' TO DFHEIV0
 11144     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 205
* EL6311.cbl
 11146     MOVE X'2020233030303130373933' TO DFHEIV0(25:11)
 11147     CALL 'kxdfhei1' USING DFHEIV0,
 11148           FILE-ID-ERPNDB,
 11149           PENDING-BUSINESS,
 11150           DFHEIV11,
 11151           ERPNDB-KEY,
 11152           DFHEIV99,
 11153           DFHEIV99,
 11154           DFHEIV99
 11155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11156
 11157
 11158     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11159
 11160
 11161* EXEC CICS HANDLE CONDITION
 11162*         NOTFND     (1385-REC-NOT-FOUND)
 11163*    END-EXEC.
 11164*    MOVE '"$I                   ! '' #00010801' TO DFHEIV0
 11165     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11167     MOVE X'2720233030303130383031' TO DFHEIV0(25:11)
 11168     CALL 'kxdfhei1' USING DFHEIV0
 11169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11170
 11171
 11172**********************************************************
 11173*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11174*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11175**********************************************************
 11176
 11177
 11178* EXEC CICS READ
 11179*        DATASET (FILE-ID-ERPNDB)
 11180*        INTO    (PENDING-BUSINESS)
 11181*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11182*    END-EXEC.
 11183     MOVE LENGTH OF
 11184      PENDING-BUSINESS
 11185       TO DFHEIV11
 11186*    MOVE '&"IL       E          (   #00010810' TO DFHEIV0
 11187     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11189     MOVE X'2020233030303130383130' TO DFHEIV0(25:11)
 11190     CALL 'kxdfhei1' USING DFHEIV0,
 11191           FILE-ID-ERPNDB,
 11192           PENDING-BUSINESS,
 11193           DFHEIV11,
 11194           PI-PREV-CONTROL-PRIMARY,
 11195           DFHEIV99,
 11196           DFHEIV99,
 11197           DFHEIV99
 11198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11199
 11200
 11201********** DO NOT ALLOW CHANGES IF THRU A/R
 11202     IF BMAINTI = 'C'
 11203         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 206
* EL6311.cbl
 11204             MOVE ER-4005          TO EMI-ERROR
 11205             MOVE -1               TO BMAINTL
 11206             MOVE AL-UABON         TO BMAINTA
 11207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11208             GO TO 8200-SEND-DATAONLY.
 11209**********
 11210
 11211     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11212        MOVE -1                 TO BMAINTL
 11213        MOVE ER-2197            TO EMI-ERROR
 11214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11215        GO TO 8200-SEND-DATAONLY.
 11216
 11217     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11218        MOVE ER-2196             TO EMI-ERROR
 11219        MOVE AL-UABON            TO BMAINTA
 11220        MOVE -1                  TO BMAINTL
 11221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11222        GO TO 8200-SEND-DATAONLY.
 11223
 11224     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11225
 11226     IF PB-BILLED-DT = LOW-VALUES AND
 11227        PB-CHG-COUNT = ZEROS
 11228        NEXT SENTENCE
 11229     ELSE
 11230        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11231            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11232           OR
 11233           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11234            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11235           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11236
 11237
 11238* EXEC CICS READ
 11239*        DATASET (FILE-ID-ERPNDB)
 11240*        INTO    (PENDING-BUSINESS)
 11241*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11242*        UPDATE
 11243*    END-EXEC.
 11244     MOVE LENGTH OF
 11245      PENDING-BUSINESS
 11246       TO DFHEIV11
 11247*    MOVE '&"IL       EU         (   #00010852' TO DFHEIV0
 11248     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11249     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11250     MOVE X'2020233030303130383532' TO DFHEIV0(25:11)
 11251     CALL 'kxdfhei1' USING DFHEIV0,
 11252           FILE-ID-ERPNDB,
 11253           PENDING-BUSINESS,
 11254           DFHEIV11,
 11255           PI-PREV-CONTROL-PRIMARY,
 11256           DFHEIV99,
 11257           DFHEIV99,
 11258           DFHEIV99
 11259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11260
 11261
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 207
* EL6311.cbl
 11262     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11263     MOVE 'B'                    TO JP-RECORD-TYPE
 11264     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11265     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11266
 11267     PERFORM 8400-LOG-JOURNAL-RECORD.
 11268
 11269     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11270        PB-CHG-COUNT NOT = ZEROS
 11271        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11272            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11273           OR
 11274           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11275            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11276            MOVE LOW-VALUES             TO PB-BILLED-DT
 11277            ADD +1                      TO PB-CHG-COUNT.
 11278
 11279     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11280     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11281     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11282     MOVE '5'                    TO DC-OPTION-CODE.
 11283     PERFORM 9700-DATE-LINK
 11284     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11285
 11286*    IF BMICRNOL  GREATER  ZEROS
 11287*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11288
 11289     IF BVINL > ZEROS
 11290        MOVE BVINI               TO PB-I-VIN
 11291     END-IF
 11292     IF (BFORCEL NOT = ZEROS)
 11293        AND (PB-COMPANY-ID = 'DCC')
 11294        AND (BFORCEI = ' ')
 11295        AND (PB-FORCE-CODE = 'O')
 11296        COMPUTE PB-I-AH-PREMIUM-AMT =
 11297           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11298        PERFORM 1800-REMOVE-CERT-NOTES
 11299                                 THRU 1800-EXIT
 11300        PERFORM 1900-DELETE-ERPYAJ
 11301                                 THRU 1900-EXIT
 11302        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11303     END-IF
 11304     IF (BFORCEL NOT = ZEROS)
 11305        AND (PB-COMPANY-ID = 'DCC')
 11306        AND (BFORCEI = 'O')
 11307        AND (PB-FORCE-CODE NOT = 'O')
 11308        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11309           PB-I-AH-PREM-CALC
 11310        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11311        MOVE SPACE               TO DC-OPTION-CODE
 11312        PERFORM 9700-DATE-LINK
 11313        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11314        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11315        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11316        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11317        PERFORM 1500-UPDATE-ERNOTE
 11318                                 THRU 1500-EXIT
 11319        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 208
* EL6311.cbl
 11320                                 THRU 1600-EXIT
 11321     END-IF
 11322     IF BLSTNML  GREATER THAN ZEROS
 11323         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11324
 11325     IF B1STNML  GREATER THAN ZEROS
 11326         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11327
 11328     IF BINITL   GREATER THAN ZEROS
 11329         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11330
 11331     IF BBIRTHL  GREATER THAN ZERO
 11332         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11333
 11334     IF B1STPMTL GREATER THAN ZERO
 11335         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11336
 11337     IF BAGEL    GREATER THAN ZEROS
 11338         MOVE BAGEI              TO PB-I-AGE.
 11339
 11340     MOVE 'N'                    TO WS-INS-AGE-SET
 11341                                    WS-JNT-AGE-SET.
 11342     IF BAGEL    GREATER THAN ZEROS
 11343        MOVE 'Y'                TO WS-INS-AGE-SET
 11344        IF BAGEI = ZERO AND
 11345             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11346           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11347           MOVE 'AGE*'          TO BAGEDEFO
 11348        ELSE
 11349           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11350           MOVE 'AGE '          TO BAGEDEFO
 11351        END-IF
 11352        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11353     END-IF.
 11354
 11355     IF BSEXL    GREATER THAN ZEROS
 11356         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11357
 11358     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11359        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11360
 11361     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11362        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11363
 11364     IF BLNTRML  GREATER THAN ZEROS
 11365         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11366
 11367     IF BFREQL   GREATER THAN ZEROS
 11368         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11369
 11370     IF BSKPCDL  GREATER THAN ZEROS
 11371         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11372
 11373     IF BMODEL   GREATER THAN ZEROS
 11374         MOVE BMODEI             TO PB-I-TERM-TYPE
 11375                                    PI-BMODE.
 11376
 11377     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 209
* EL6311.cbl
 11378         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11379                                    PI-BPMTS.
 11380
 11381     IF BPMTAMTL GREATER THAN ZEROS
 11382         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11383
 11384     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11385         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11386
 11387     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11388         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11389
 11390     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11391
 11392     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11393         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11394            SUBTRACT PB-I-LF-PREMIUM-AMT
 11395                     FROM WS-B-LF-ISS-PRM-ENTERED
 11396            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11397            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11398            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11399         ELSE
 11400            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11401*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11402*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11403         END-IF
 11404     END-IF.
 11405
 11406     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11407            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11408                     FROM WS-B-LF-ISS-PRM-ENTERED
 11409         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11410         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11411
 11412     IF  BALT-PREM-LEN     (2)  > ZEROS
 11413         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11414
 11415     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11416         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11417
 11418     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11419         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11420            SUBTRACT PB-I-AH-PREMIUM-AMT
 11421                     FROM WS-B-AH-ISS-PRM-ENTERED
 11422            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11423            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11424            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11425         ELSE
 11426            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11427*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11428*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11429         END-IF
 11430     END-IF
 11431
 11432     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11433        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11434
 11435     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 210
* EL6311.cbl
 11436        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11437
 11438     IF BINDGRPL            GREATER THAN ZEROS
 11439         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11440
 11441     IF BRTCLSL             GREATER THAN ZEROS
 11442         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11443
 11444     IF BSIGL               GREATER THAN ZEROS
 11445         MOVE BSIGI              TO PB-I-SIG-SW.
 11446
 11447     IF BAPRL               GREATER THAN ZEROS
 11448         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11449
 11450     IF BMEMBERL            GREATER THAN ZEROS
 11451         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11452
 11453     IF BLNOFCRL            GREATER THAN ZEROS
 11454         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11455
 11456     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11457        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11458
 11459     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11460        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11461
 11462     IF BDAYSL              GREATER THAN ZEROS
 11463        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11464                                    PB-I-EXTENTION-DAYS.
 11465
 11466     IF BDAYSL GREATER THAN ZEROS
 11467        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11468
 11469     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11470        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11471           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11472
 11473     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11474        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11475           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11476
 11477     IF B1STPMTL GREATER THAN ZEROS
 11478        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11479
 11480     IF PB-EXT-DAYS-PROCESSING
 11481        IF PB-I-EXTENTION-DAYS = ZEROS
 11482           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11483
 11484     IF PB-EXPIRE-DT-PROCESSING
 11485        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11486           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11487             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11488
 11489     IF PB-1ST-PMT-DT-PROCESSING
 11490        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11491           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11492
 11493     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 211
* EL6311.cbl
 11494        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11495
 11496     IF BFORCEL NOT = ZEROS
 11497        MOVE BFORCEI             TO PB-FORCE-CODE.
 11498     IF (BENTRYL NOT = ZEROS)
 11499        AND (PB-COMPANY-ID = 'CID')
 11500        AND (PB-STATE = 'VA')
 11501        AND (BENTRYI NOT = 'P')
 11502        AND (PB-BATCH-ENTRY = 'P')
 11503        PERFORM 1800-REMOVE-CERT-NOTES
 11504                                 THRU 1800-EXIT
 11505     END-IF
 11506     IF BENTRYL NOT = ZEROS
 11507        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11508        IF PI-COMPANY-ID = 'CID'
 11509           AND (PB-BATCH-ENTRY = 'P')
 11510           AND (PB-STATE = 'VA')
 11511           PERFORM 1500-UPDATE-ERNOTE
 11512                                 THRU 1500-EXIT
 11513        END-IF
 11514     END-IF
 11515
 11516     IF BUNWRITL NOT = ZEROS
 11517        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11518
 11519     IF BBILCDL NOT = ZEROS
 11520        MOVE BBILCDI             TO PB-RECORD-BILL.
 11521
 11522     IF BLIVESL GREATER THAN ZEROS
 11523        MOVE WS-BLIVES           TO PB-I-LIVES.
 11524
 11525
 11526*DMD CUSTOM CODING*************START
 11527     IF PI-COMPANY-ID NOT = 'DMD'
 11528         MOVE ZEROS               TO BBILLEDL.
 11529*DMD CUSTOM CODING*************END
 11530
 11531     IF BBILLEDL GREATER THAN ZEROS
 11532        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11533
 11534
 11535*****************************************************************
 11536*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11537*****************************************************************
 11538
 11539     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11540        IF BTYPE  (1)   = ZEROS OR SPACES
 11541           IF REMOVE-LF-COVERAGE
 11542               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11543                                        PI-BTYPE (1)
 11544               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11545                                        WS-B-LF-ISS-PRM-ENTERED
 11546               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11547                                        WS-B-LF-ISS-PRM-ENTERED
 11548               SUBTRACT PB-I-LF-PREM-CALC FROM
 11549                                        WS-B-LF-ISS-PRM-COMPUTED
 11550               MOVE ZEROS            TO PB-I-LF-TERM
 11551                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 212
* EL6311.cbl
 11552                                        PB-I-LF-PREMIUM-AMT
 11553                                        PB-I-LF-BENEFIT-CD
 11554                                        PB-I-LF-PREM-CALC
 11555                                        PB-I-LF-CRIT-PER
 11556                                        PB-I-LF-ALT-BENEFIT-AMT
 11557                                        PB-I-LF-ALT-PREMIUM-AMT
 11558               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11559           ELSE
 11560               NEXT SENTENCE
 11561        ELSE
 11562           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11563                                    PI-BTYPE (1).
 11564     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11565        IF BTYPE  (2)   = ZEROS OR SPACES
 11566           IF  REMOVE-AH-COVERAGE
 11567               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11568                                        PI-BTYPE (2)
 11569               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11570                                        WS-B-AH-ISS-PRM-ENTERED
 11571               SUBTRACT PB-I-AH-PREM-CALC FROM
 11572                                        WS-B-AH-ISS-PRM-COMPUTED
 11573               MOVE ZEROS            TO PB-I-AH-TERM
 11574                                        PB-I-AH-BENEFIT-AMT
 11575                                        PB-I-AH-PREMIUM-AMT
 11576                                        PB-I-AH-BENEFIT-CD
 11577                                        PB-I-AH-PREM-CALC
 11578                                        PB-I-AH-CRIT-PER
 11579               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11580           ELSE
 11581               NEXT SENTENCE
 11582        ELSE
 11583           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11584                                    PI-BTYPE (2).
 11585 1360-REWRITE-PB-RECORD.
 11586     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11587
 11588     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11589     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11590
 11591     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11592
 11593     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11594     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11595
 11596     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11597         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11598
 11599     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11600         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11601
 11602     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11603
 11604     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11605
 11606     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11607
 11608     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11609     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 213
* EL6311.cbl
 11610     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11611
 11612     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11613     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11614
 11615 1375-REWRITE-PB-RECORD.
 11616     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11617     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11618     MOVE 'C'                    TO JP-RECORD-TYPE.
 11619     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11620
 11621
 11622* EXEC CICS REWRITE
 11623*        DATASET (FILE-ID-ERPNDB)
 11624*        FROM    (PENDING-BUSINESS)
 11625*    END-EXEC.
 11626     MOVE LENGTH OF
 11627      PENDING-BUSINESS
 11628       TO DFHEIV11
 11629*    MOVE '&& L                  %   #00011218' TO DFHEIV0
 11630     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11631     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11632     MOVE X'2020233030303131323138' TO DFHEIV0(25:11)
 11633     CALL 'kxdfhei1' USING DFHEIV0,
 11634           FILE-ID-ERPNDB,
 11635           PENDING-BUSINESS,
 11636           DFHEIV11,
 11637           DFHEIV99
 11638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11639
 11640
 11641     PERFORM 8400-LOG-JOURNAL-RECORD.
 11642******************************************************************
 11643*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11644******************************************************************
 11645     display ' made it to update orig cert '
 11646     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11647     MOVE ' '                    TO WS-ERMAIL-SW
 11648
 11649* EXEC CICS READ
 11650*       DATASET   (FILE-ID-ERMAIL)
 11651*       SET       (ADDRESS OF MAILING-DATA)
 11652*       RIDFLD    (ERMAIL-KEY)
 11653*       RESP      (WS-RESPONSE)
 11654*    END-EXEC
 11655*    MOVE '&"S        E          (  N#00011230' TO DFHEIV0
 11656     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11657     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11658     MOVE X'204E233030303131323330' TO DFHEIV0(25:11)
 11659     CALL 'kxdfhei1' USING DFHEIV0,
 11660           FILE-ID-ERMAIL,
 11661           DFHEIV20,
 11662           DFHEIV99,
 11663           ERMAIL-KEY,
 11664           DFHEIV99,
 11665           DFHEIV99,
 11666           DFHEIV99
 11667     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 214
* EL6311.cbl
 11668         DFHEIV20
 11669     MOVE EIBRESP  TO WS-RESPONSE
 11670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11671     IF RESP-NORMAL
 11672        SET ERMAIL-FOUND TO TRUE
 11673     END-IF
 11674
 11675     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11676     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11677                                 TO ELCRTO-KEY
 11678     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11679     MOVE +0                     TO ELCRTO-SEQ-NO
 11680
 11681* EXEC CICS READ
 11682*       DATASET   ('ELCRTO')
 11683*       INTO      (ORIGINAL-CERTIFICATE)
 11684*       RIDFLD    (ELCRTO-KEY)
 11685*       GTEQ
 11686*       RESP      (WS-RESPONSE)
 11687*    END-EXEC
 11688     MOVE LENGTH OF
 11689      ORIGINAL-CERTIFICATE
 11690       TO DFHEIV11
 11691     MOVE 'ELCRTO' TO DFHEIV1
 11692*    MOVE '&"IL       G          (  N#00011245' TO DFHEIV0
 11693     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11695     MOVE X'204E233030303131323435' TO DFHEIV0(25:11)
 11696     CALL 'kxdfhei1' USING DFHEIV0,
 11697           DFHEIV1,
 11698           ORIGINAL-CERTIFICATE,
 11699           DFHEIV11,
 11700           ELCRTO-KEY,
 11701           DFHEIV99,
 11702           DFHEIV99,
 11703           DFHEIV99
 11704     MOVE EIBRESP  TO WS-RESPONSE
 11705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11706     display ' just read gteq ' ws-response
 11707     IF RESP-NORMAL
 11708        AND (OC-CONTROL-PRIMARY (1:33) =
 11709                 PB-CONTROL-BY-ACCOUNT (1:33))
 11710        AND (OC-RECORD-TYPE = 'I')
 11711        display ' resp norm, key =, type i '
 11712        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11713           display ' end proc blank '
 11714           display ' csr edit session ' PI-CSR-SESSION-SW
 11715           IF NOT CSR-EDIT-SESSION
 11716
 11717* EXEC CICS READ
 11718*                DATASET   ('ELCRTO')
 11719*                INTO      (ORIGINAL-CERTIFICATE)
 11720*                RIDFLD    (OC-CONTROL-PRIMARY)
 11721*                UPDATE
 11722*                RESP      (WS-RESPONSE)
 11723*             END-EXEC
 11724     MOVE LENGTH OF
 11725      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 215
* EL6311.cbl
 11726       TO DFHEIV11
 11727     MOVE 'ELCRTO' TO DFHEIV1
 11728*    MOVE '&"IL       EU         (  N#00011262' TO DFHEIV0
 11729     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11730     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11731     MOVE X'204E233030303131323632' TO DFHEIV0(25:11)
 11732     CALL 'kxdfhei1' USING DFHEIV0,
 11733           DFHEIV1,
 11734           ORIGINAL-CERTIFICATE,
 11735           DFHEIV11,
 11736           OC-CONTROL-PRIMARY,
 11737           DFHEIV99,
 11738           DFHEIV99,
 11739           DFHEIV99
 11740     MOVE EIBRESP  TO WS-RESPONSE
 11741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11742              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11743              IF RESP-NORMAL
 11744                 display ' good read upd '
 11745                 MOVE PB-I-INSURED-LAST-NAME TO
 11746                         OC-INS-LAST-NAME
 11747                 MOVE PB-I-INSURED-FIRST-NAME TO
 11748                         OC-INS-FIRST-NAME
 11749                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11750                         OC-INS-MIDDLE-INIT
 11751                 MOVE PB-I-AGE         TO OC-INS-AGE
 11752                 MOVE PB-I-JOINT-LAST-NAME   TO
 11753                         OC-JNT-LAST-NAME
 11754                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11755                         OC-JNT-FIRST-NAME
 11756                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11757                         OC-JNT-MIDDLE-INIT
 11758                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11759                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11760                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11761                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11762                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11763                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11764                         OC-LF-ALT-BEN-AMT
 11765                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11766                         OC-LF-ALT-PRM-AMT
 11767                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11768                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11769                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11770                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11771                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11772                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11773                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11774                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11775                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11776                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11777                 IF OC-CANCEL-TRAN-IND = 'N'
 11778                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11779                    MOVE +0            TO OC-LF-CANCEL-AMT
 11780                                          OC-LF-ITD-CANCEL-AMT
 11781                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11782                    MOVE +0            TO OC-AH-CANCEL-AMT
 11783                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 216
* EL6311.cbl
 11784                 END-IF
 11785                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11786                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11787                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11788                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11789                 IF ERMAIL-FOUND
 11790                    MOVE MA-CRED-BENE-NAME
 11791                                 TO OC-CRED-BENE-NAME
 11792                 END-IF
 11793                 IF NOT CERT-TRL-REC-NOT-FOUND
 11794                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11795                           OC-INS-AGE-DEFAULT-FLAG
 11796                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11797                           OC-JNT-AGE-DEFAULT-FLAG
 11798                 END-IF
 11799
 11800* EXEC CICS REWRITE
 11801*                   DATASET   ('ELCRTO')
 11802*                   FROM      (ORIGINAL-CERTIFICATE)
 11803*                   RESP      (WS-RESPONSE)
 11804*                END-EXEC
 11805     MOVE LENGTH OF
 11806      ORIGINAL-CERTIFICATE
 11807       TO DFHEIV11
 11808     MOVE 'ELCRTO' TO DFHEIV1
 11809*    MOVE '&& L                  %  N#00011326' TO DFHEIV0
 11810     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11811     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11812     MOVE X'204E233030303131333236' TO DFHEIV0(25:11)
 11813     CALL 'kxdfhei1' USING DFHEIV0,
 11814           DFHEIV1,
 11815           ORIGINAL-CERTIFICATE,
 11816           DFHEIV11,
 11817           DFHEIV99
 11818     MOVE EIBRESP  TO WS-RESPONSE
 11819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11820                 display ' just rewrote ' ws-response
 11821              END-IF
 11822           END-IF
 11823        ELSE
 11824           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11825           MOVE 'OC'             TO OC-RECORD-ID
 11826           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11827           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11828           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11829           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11830           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11831           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11832           MOVE PB-I-AGE         TO OC-INS-AGE
 11833           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11834           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11835           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11836           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11837           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11838           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11839           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11840           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11841           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 217
* EL6311.cbl
 11842           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11843           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11844           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11845           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11846           MOVE +0               TO OC-LF-CANCEL-AMT
 11847                                    OC-LF-ITD-CANCEL-AMT
 11848           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11849           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11850           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11851           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11852           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11853           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11854           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11855           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11856           MOVE +0               TO OC-AH-CANCEL-AMT
 11857                                    OC-AH-ITD-CANCEL-AMT
 11858           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11859           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11860           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11861           IF ERMAIL-FOUND
 11862              MOVE MA-CRED-BENE-NAME
 11863                                 TO OC-CRED-BENE-NAME
 11864           END-IF
 11865           IF NOT CERT-TRL-REC-NOT-FOUND
 11866              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11867                           OC-INS-AGE-DEFAULT-FLAG
 11868              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11869                           OC-JNT-AGE-DEFAULT-FLAG
 11870           END-IF
 11871           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11872
 11873* EXEC CICS WRITE
 11874*             DATASET   ('ELCRTO')
 11875*             FROM      (ORIGINAL-CERTIFICATE)
 11876*             RIDFLD    (OC-CONTROL-PRIMARY)
 11877*             RESP      (WS-RESPONSE)
 11878*          END-EXEC
 11879     MOVE LENGTH OF
 11880      ORIGINAL-CERTIFICATE
 11881       TO DFHEIV11
 11882     MOVE 'ELCRTO' TO DFHEIV1
 11883*    MOVE '&$ L                  ''  N#00011383' TO DFHEIV0
 11884     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11885     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11886     MOVE X'204E233030303131333833' TO DFHEIV0(25:11)
 11887     CALL 'kxdfhei1' USING DFHEIV0,
 11888           DFHEIV1,
 11889           ORIGINAL-CERTIFICATE,
 11890           DFHEIV11,
 11891           OC-CONTROL-PRIMARY,
 11892           DFHEIV99,
 11893           DFHEIV99
 11894     MOVE EIBRESP  TO WS-RESPONSE
 11895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11896        END-IF
 11897     ELSE
 11898        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11899        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 218
* EL6311.cbl
 11900        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11901                                 TO OC-CONTROL-PRIMARY (1:33)
 11902        MOVE 'I'                 TO OC-RECORD-TYPE
 11903        MOVE +4096               TO OC-KEY-SEQ-NO
 11904        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11905        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11906        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11907        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11908        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11909        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11910        MOVE PB-I-AGE            TO OC-INS-AGE
 11911        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11912        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11913        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11914        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11915        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11916        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11917        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11918        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11919        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11920        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11921        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11922        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11923        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11924        MOVE +0                  TO OC-LF-CANCEL-AMT
 11925                                    OC-LF-ITD-CANCEL-AMT
 11926        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11927        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11928        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11929        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11930        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11931        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11932        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11933        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11934        MOVE +0                  TO OC-AH-CANCEL-AMT
 11935                                    OC-AH-ITD-CANCEL-AMT
 11936        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11937        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11938        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11939        IF ERMAIL-FOUND
 11940           MOVE MA-CRED-BENE-NAME
 11941                                 TO OC-CRED-BENE-NAME
 11942        END-IF
 11943        IF NOT CERT-TRL-REC-NOT-FOUND
 11944           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11945                           OC-INS-AGE-DEFAULT-FLAG
 11946           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11947                           OC-JNT-AGE-DEFAULT-FLAG
 11948        END-IF
 11949        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11950
 11951* EXEC CICS WRITE
 11952*          DATASET   ('ELCRTO')
 11953*          FROM      (ORIGINAL-CERTIFICATE)
 11954*          RIDFLD    (OC-CONTROL-PRIMARY)
 11955*          RESP      (WS-RESPONSE)
 11956*       END-EXEC
 11957     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 219
* EL6311.cbl
 11958      ORIGINAL-CERTIFICATE
 11959       TO DFHEIV11
 11960     MOVE 'ELCRTO' TO DFHEIV1
 11961*    MOVE '&$ L                  ''  N#00011443' TO DFHEIV0
 11962     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11963     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11964     MOVE X'204E233030303131343433' TO DFHEIV0(25:11)
 11965     CALL 'kxdfhei1' USING DFHEIV0,
 11966           DFHEIV1,
 11967           ORIGINAL-CERTIFICATE,
 11968           DFHEIV11,
 11969           OC-CONTROL-PRIMARY,
 11970           DFHEIV99,
 11971           DFHEIV99
 11972     MOVE EIBRESP  TO WS-RESPONSE
 11973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11974     END-IF
 11975******************************************************************
 11976*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11977******************************************************************
 11978
 11979     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11980     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11981
 11982
 11983* EXEC CICS READ
 11984*        INTO    (PENDING-BUSINESS)
 11985*        DATASET (FILE-ID-ERPNDB)
 11986*        RIDFLD  (ERPNDB-KEY)
 11987*        UPDATE
 11988*    END-EXEC.
 11989     MOVE LENGTH OF
 11990      PENDING-BUSINESS
 11991       TO DFHEIV11
 11992*    MOVE '&"IL       EU         (   #00011457' TO DFHEIV0
 11993     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11994     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11995     MOVE X'2020233030303131343537' TO DFHEIV0(25:11)
 11996     CALL 'kxdfhei1' USING DFHEIV0,
 11997           FILE-ID-ERPNDB,
 11998           PENDING-BUSINESS,
 11999           DFHEIV11,
 12000           ERPNDB-KEY,
 12001           DFHEIV99,
 12002           DFHEIV99,
 12003           DFHEIV99
 12004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12005
 12006
 12007     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12008     MOVE 'B'                    TO JP-RECORD-TYPE.
 12009     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12010
 12011     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12012
 12013     PERFORM 8400-LOG-JOURNAL-RECORD.
 12014
 12015     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 220
* EL6311.cbl
 12016
 12017     MOVE 'C'                    TO JP-RECORD-TYPE.
 12018     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12019
 12020
 12021* EXEC CICS REWRITE
 12022*        DATASET    (FILE-ID-ERPNDB)
 12023*        FROM       (PENDING-BUSINESS)
 12024*    END-EXEC.
 12025     MOVE LENGTH OF
 12026      PENDING-BUSINESS
 12027       TO DFHEIV11
 12028*    MOVE '&& L                  %   #00011477' TO DFHEIV0
 12029     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12030     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12031     MOVE X'2020233030303131343737' TO DFHEIV0(25:11)
 12032     CALL 'kxdfhei1' USING DFHEIV0,
 12033           FILE-ID-ERPNDB,
 12034           PENDING-BUSINESS,
 12035           DFHEIV11,
 12036           DFHEIV99
 12037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12038
 12039
 12040     PERFORM 8400-LOG-JOURNAL-RECORD.
 12041
 12042     IF WS-ERRORS-PRESENT
 12043        GO TO 3900-RE-DISPLAY-RECORD.
 12044
 12045     MOVE ZEROS                  TO EMI-ERROR.
 12046     MOVE -1                     TO BMAINTL.
 12047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12048     GO TO 3900-RE-DISPLAY-RECORD.
 12049
 12050 1380-BATCH-HDR-NOT-FOUND.
 12051     MOVE -1                     TO BMAINTL.
 12052     MOVE ER-7450                TO EMI-ERROR.
 12053     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12054     GO TO 8200-SEND-DATAONLY.
 12055
 12056 1385-REC-NOT-FOUND.
 12057     MOVE -1                     TO BMAINTL.
 12058     MOVE ER-7451                TO EMI-ERROR.
 12059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12060     GO TO 8200-SEND-DATAONLY.
 12061
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 221
* EL6311.cbl
 12063
 12064 1386-UPDATE-AGE-FLAGS.
 12065
 12066
 12067* EXEC CICS GETMAIN
 12068*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12069*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12070*        INITIMG (GETMAIN-SPACE)
 12071*    END-EXEC
 12072*    MOVE ',"IL                  $   #00011508' TO DFHEIV0
 12073     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12075     MOVE X'2020233030303131353038' TO DFHEIV0(25:11)
 12076     CALL 'kxdfhei1' USING DFHEIV0,
 12077           DFHEIV20,
 12078           ELCRTT-RECORD-LENGTH,
 12079           GETMAIN-SPACE
 12080     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12081         DFHEIV20
 12082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12083
 12084
 12085* EXEC CICS HANDLE CONDITION
 12086*        NOTFND   (1386-NOTFND)
 12087*    END-EXEC.
 12088*    MOVE '"$I                   ! ( #00011514' TO DFHEIV0
 12089     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12090     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12091     MOVE X'2820233030303131353134' TO DFHEIV0(25:11)
 12092     CALL 'kxdfhei1' USING DFHEIV0
 12093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12094
 12095
 12096     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12097     MOVE 'C'                TO ELCRTT-REC-TYPE
 12098
 12099
 12100* EXEC CICS READ
 12101*        UPDATE
 12102*        DATASET  (CRTT-ID)
 12103*        RIDFLD   (ELCRTT-KEY)
 12104*        INTO     (CERTIFICATE-TRAILERS)
 12105*    END-EXEC.
 12106     MOVE LENGTH OF
 12107      CERTIFICATE-TRAILERS
 12108       TO DFHEIV11
 12109*    MOVE '&"IL       EU         (   #00011521' TO DFHEIV0
 12110     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12111     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12112     MOVE X'2020233030303131353231' TO DFHEIV0(25:11)
 12113     CALL 'kxdfhei1' USING DFHEIV0,
 12114           CRTT-ID,
 12115           CERTIFICATE-TRAILERS,
 12116           DFHEIV11,
 12117           ELCRTT-KEY,
 12118           DFHEIV99,
 12119           DFHEIV99,
 12120           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 222
* EL6311.cbl
 12121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12122
 12123
 12124     IF WS-INS-AGE-SET = 'Y'
 12125        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12126     END-IF
 12127     IF WS-JNT-AGE-SET = 'Y'
 12128        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12129     END-IF
 12130
 12131
 12132* EXEC CICS REWRITE
 12133*       DATASET  (CRTT-ID)
 12134*       FROM     (CERTIFICATE-TRAILERS)
 12135*    END-EXEC.
 12136     MOVE LENGTH OF
 12137      CERTIFICATE-TRAILERS
 12138       TO DFHEIV11
 12139*    MOVE '&& L                  %   #00011535' TO DFHEIV0
 12140     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12141     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12142     MOVE X'2020233030303131353335' TO DFHEIV0(25:11)
 12143     CALL 'kxdfhei1' USING DFHEIV0,
 12144           CRTT-ID,
 12145           CERTIFICATE-TRAILERS,
 12146           DFHEIV11,
 12147           DFHEIV99
 12148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12149
 12150
 12151     GO TO 1386-EXIT.
 12152
 12153 1386-NOTFND.
 12154
 12155     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12156     MOVE 'CS'         TO CS-RECORD-ID.
 12157     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12158     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12159     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12160     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12161     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12162
 12163* EXEC CICS WRITE
 12164*       DATASET  (CRTT-ID)
 12165*       RIDFLD   (ELCRTT-KEY)
 12166*       FROM     (CERTIFICATE-TRAILERS)
 12167*    END-EXEC.
 12168     MOVE LENGTH OF
 12169      CERTIFICATE-TRAILERS
 12170       TO DFHEIV11
 12171*    MOVE '&$ L                  ''   #00011551' TO DFHEIV0
 12172     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12174     MOVE X'2020233030303131353531' TO DFHEIV0(25:11)
 12175     CALL 'kxdfhei1' USING DFHEIV0,
 12176           CRTT-ID,
 12177           CERTIFICATE-TRAILERS,
 12178           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 223
* EL6311.cbl
 12179           ELCRTT-KEY,
 12180           DFHEIV99,
 12181           DFHEIV99
 12182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12183
 12184
 12185 1386-EXIT.
 12186     EXIT.
 12187
 12188 1390-UPDATE-ERPNDM.
 12189
 12190
 12191* EXEC CICS HANDLE CONDITION
 12192*        NOTFND (1399-EXIT)
 12193*    END-EXEC.
 12194*    MOVE '"$I                   ! ) #00011562' TO DFHEIV0
 12195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12197     MOVE X'2920233030303131353632' TO DFHEIV0(25:11)
 12198     CALL 'kxdfhei1' USING DFHEIV0
 12199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12200
 12201
 12202     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12203
 12204
 12205* EXEC CICS READ
 12206*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12207*        DATASET (FILE-ID-ERPNDM)
 12208*        RIDFLD  (ERPNDM-KEY)
 12209*        UPDATE
 12210*    END-EXEC.
 12211*    MOVE '&"S        EU         (   #00011568' TO DFHEIV0
 12212     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12213     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12214     MOVE X'2020233030303131353638' TO DFHEIV0(25:11)
 12215     CALL 'kxdfhei1' USING DFHEIV0,
 12216           FILE-ID-ERPNDM,
 12217           DFHEIV20,
 12218           DFHEIV99,
 12219           ERPNDM-KEY,
 12220           DFHEIV99,
 12221           DFHEIV99,
 12222           DFHEIV99
 12223     SET ADDRESS OF PENDING-MAILING-DATA TO
 12224         DFHEIV20
 12225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12226
 12227
 12228     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12229     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12230     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12231
 12232     IF BLSTNML GREATER THAN ZEROS
 12233         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12234
 12235     IF B1STNML GREATER  THAN ZEROS
 12236         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 224
* EL6311.cbl
 12237
 12238     IF BINITL GREATER THAN ZEROS
 12239         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12240
 12241     IF BAGEL GREATER THAN ZEROS
 12242         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12243
 12244     IF BBIRTHL GREATER THAN ZEROS
 12245         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12246
 12247     IF BSEXL GREATER THAN ZEROS
 12248         MOVE  BSEXI             TO PM-INSURED-SEX.
 12249
 12250
 12251* EXEC CICS REWRITE
 12252*        DATASET (FILE-ID-ERPNDM)
 12253*        FROM    (PENDING-MAILING-DATA)
 12254*    END-EXEC.
 12255     MOVE LENGTH OF
 12256      PENDING-MAILING-DATA
 12257       TO DFHEIV11
 12258*    MOVE '&& L                  %   #00011597' TO DFHEIV0
 12259     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12260     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12261     MOVE X'2020233030303131353937' TO DFHEIV0(25:11)
 12262     CALL 'kxdfhei1' USING DFHEIV0,
 12263           FILE-ID-ERPNDM,
 12264           PENDING-MAILING-DATA,
 12265           DFHEIV11,
 12266           DFHEIV99
 12267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12268
 12269
 12270 1399-EXIT.
 12271     EXIT.
 12272
 12273******************************************************************
 12274*                                                                *
 12275*          D E L E T E   I S S U E   R O U T I N E               *
 12276*                                                                *
 12277******************************************************************
 12278
 12279 1400-DELETE-ISSUE-ROUTINE.
 12280     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12281
 12282     IF BCHGL NOT = ZEROS
 12283        MOVE ER-2196             TO EMI-ERROR
 12284        MOVE AL-UABON            TO BMAINTA
 12285        MOVE -1                  TO BMAINTL
 12286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12287        GO TO 8200-SEND-DATAONLY.
 12288
 12289
 12290* EXEC CICS HANDLE CONDITION
 12291*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12292*    END-EXEC.
 12293*    MOVE '"$I                   ! * #00011621' TO DFHEIV0
 12294     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 225
* EL6311.cbl
 12295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12296     MOVE X'2A20233030303131363231' TO DFHEIV0(25:11)
 12297     CALL 'kxdfhei1' USING DFHEIV0
 12298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12299
 12300
 12301     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12302     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12303     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12304
 12305
 12306* EXEC CICS READ
 12307*        SET     (ADDRESS OF PENDING-BUSINESS)
 12308*        DATASET (FILE-ID-ERPNDB)
 12309*        RIDFLD  (ERPNDB-KEY)
 12310*    END-EXEC.
 12311*    MOVE '&"S        E          (   #00011629' TO DFHEIV0
 12312     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12313     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12314     MOVE X'2020233030303131363239' TO DFHEIV0(25:11)
 12315     CALL 'kxdfhei1' USING DFHEIV0,
 12316           FILE-ID-ERPNDB,
 12317           DFHEIV20,
 12318           DFHEIV99,
 12319           ERPNDB-KEY,
 12320           DFHEIV99,
 12321           DFHEIV99,
 12322           DFHEIV99
 12323     SET ADDRESS OF PENDING-BUSINESS TO
 12324         DFHEIV20
 12325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12326
 12327
 12328     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12329
 12330     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12331
 12332     IF BSUFIXL NOT = ZEROS
 12333        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12334     ELSE
 12335        MOVE SPACE               TO WS-NEW-SUFFIX.
 12336
 12337     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12338     PERFORM 8600-DEEDIT.
 12339     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12340     MOVE '4'                    TO DC-OPTION-CODE.
 12341     PERFORM 9700-DATE-LINK.
 12342     IF DATE-CONVERSION-ERROR
 12343        MOVE ER-0348             TO EMI-ERROR
 12344        MOVE -1                  TO BEFFDTL
 12345        MOVE AL-UABON            TO BEFFDTA
 12346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12347        GO TO 8200-SEND-DATAONLY
 12348     ELSE
 12349        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12350        MOVE AL-UANON            TO BEFFDTA
 12351        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12352
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 226
* EL6311.cbl
 12353
 12354* EXEC CICS HANDLE CONDITION
 12355*         NOTFND    (1490-RECORD-NOT-FOUND)
 12356*    END-EXEC.
 12357*    MOVE '"$I                   ! + #00011660' TO DFHEIV0
 12358     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12359     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12360     MOVE X'2B20233030303131363630' TO DFHEIV0(25:11)
 12361     CALL 'kxdfhei1' USING DFHEIV0
 12362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12363
 12364
 12365
 12366* EXEC CICS READ
 12367*        SET     (ADDRESS OF PENDING-BUSINESS)
 12368*        DATASET (FILE-ID-ERPNDB)
 12369*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12370*        UPDATE
 12371*    END-EXEC.
 12372*    MOVE '&"S        EU         (   #00011664' TO DFHEIV0
 12373     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12374     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12375     MOVE X'2020233030303131363634' TO DFHEIV0(25:11)
 12376     CALL 'kxdfhei1' USING DFHEIV0,
 12377           FILE-ID-ERPNDB,
 12378           DFHEIV20,
 12379           DFHEIV99,
 12380           PI-PREV-CONTROL-PRIMARY,
 12381           DFHEIV99,
 12382           DFHEIV99,
 12383           DFHEIV99
 12384     SET ADDRESS OF PENDING-BUSINESS TO
 12385         DFHEIV20
 12386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12387
 12388
 12389     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12390        MOVE -1                 TO BMAINTL
 12391        MOVE ER-2197            TO EMI-ERROR
 12392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12393        GO TO 8200-SEND-DATAONLY.
 12394
 12395     IF PB-BILLED-DT NOT = LOW-VALUES
 12396        MOVE -1                 TO BMAINTL
 12397        MOVE ER-2129            TO EMI-ERROR
 12398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12399        GO TO 8200-SEND-DATAONLY.
 12400
 12401     IF PB-CHG-COUNT NOT = ZEROS
 12402        MOVE ER-2336            TO EMI-ERROR
 12403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12404        MOVE AL-UABON            TO BMAINTA
 12405        MOVE -1                  TO BMAINTL
 12406        GO TO 8200-SEND-DATAONLY.
 12407
 12408     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12409        PB-CHG-COUNT NOT = ZEROS
 12410        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 227
* EL6311.cbl
 12411        MOVE AL-UABON            TO BMAINTA
 12412        MOVE -1                  TO BMAINTL
 12413        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12414        GO TO 8200-SEND-DATAONLY.
 12415******************************************************************
 12416*                                                                *
 12417*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12418*                                                                *
 12419******************************************************************
 12420     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12421     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12422     MOVE +0                     TO ELCRTO-SEQ-NO
 12423
 12424* EXEC CICS READ
 12425*       DATASET   ('ELCRTO')
 12426*       INTO      (ORIGINAL-CERTIFICATE)
 12427*       RIDFLD    (ELCRTO-KEY)
 12428*       GTEQ
 12429*       RESP      (WS-RESPONSE)
 12430*    END-EXEC
 12431     MOVE LENGTH OF
 12432      ORIGINAL-CERTIFICATE
 12433       TO DFHEIV11
 12434     MOVE 'ELCRTO' TO DFHEIV1
 12435*    MOVE '&"IL       G          (  N#00011705' TO DFHEIV0
 12436     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12438     MOVE X'204E233030303131373035' TO DFHEIV0(25:11)
 12439     CALL 'kxdfhei1' USING DFHEIV0,
 12440           DFHEIV1,
 12441           ORIGINAL-CERTIFICATE,
 12442           DFHEIV11,
 12443           ELCRTO-KEY,
 12444           DFHEIV99,
 12445           DFHEIV99,
 12446           DFHEIV99
 12447     MOVE EIBRESP  TO WS-RESPONSE
 12448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12449     IF RESP-NORMAL
 12450        AND (OC-CONTROL-PRIMARY (1:33) =
 12451                 PB-CONTROL-BY-ACCOUNT (1:33))
 12452        AND (OC-RECORD-TYPE = 'I')
 12453
 12454* EXEC CICS READ
 12455*          DATASET   ('ELCRTO')
 12456*          INTO      (ORIGINAL-CERTIFICATE)
 12457*          RIDFLD    (ELCRTO-KEY)
 12458*          UPDATE
 12459*          RESP      (WS-RESPONSE)
 12460*       END-EXEC
 12461     MOVE LENGTH OF
 12462      ORIGINAL-CERTIFICATE
 12463       TO DFHEIV11
 12464     MOVE 'ELCRTO' TO DFHEIV1
 12465*    MOVE '&"IL       EU         (  N#00011716' TO DFHEIV0
 12466     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12467     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12468     MOVE X'204E233030303131373136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 228
* EL6311.cbl
 12469     CALL 'kxdfhei1' USING DFHEIV0,
 12470           DFHEIV1,
 12471           ORIGINAL-CERTIFICATE,
 12472           DFHEIV11,
 12473           ELCRTO-KEY,
 12474           DFHEIV99,
 12475           DFHEIV99,
 12476           DFHEIV99
 12477     MOVE EIBRESP  TO WS-RESPONSE
 12478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12479        IF RESP-NORMAL
 12480
 12481* EXEC CICS DELETE
 12482*             DATASET   ('ELCRTO')
 12483*          END-EXEC
 12484     MOVE 'ELCRTO' TO DFHEIV1
 12485*    MOVE '&(                    &   #00011724' TO DFHEIV0
 12486     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12487     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12488     MOVE X'2020233030303131373234' TO DFHEIV0(25:11)
 12489     CALL 'kxdfhei1' USING DFHEIV0,
 12490           DFHEIV1,
 12491           DFHEIV99,
 12492           DFHEIV99,
 12493           DFHEIV99,
 12494           DFHEIV99
 12495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12496        END-IF
 12497     END-IF
 12498******************************************************************
 12499*                                                                *
 12500*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12501*                                                                *
 12502******************************************************************
 12503
 12504* EXEC CICS HANDLE CONDITION
 12505*        NOTFND    (1405-DELETE-CERTIFICATE)
 12506*    END-EXEC.
 12507*    MOVE '"$I                   ! , #00011734' TO DFHEIV0
 12508     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12510     MOVE X'2C20233030303131373334' TO DFHEIV0(25:11)
 12511     CALL 'kxdfhei1' USING DFHEIV0
 12512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12513
 12514
 12515
 12516* EXEC CICS READ
 12517*        EQUAL
 12518*        DATASET   (FILE-ID-ERPNDM)
 12519*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12520*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12521*        UPDATE
 12522*    END-EXEC.
 12523*    MOVE '&"S        EU         (   #00011738' TO DFHEIV0
 12524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12525     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12526     MOVE X'2020233030303131373338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 229
* EL6311.cbl
 12527     CALL 'kxdfhei1' USING DFHEIV0,
 12528           FILE-ID-ERPNDM,
 12529           DFHEIV20,
 12530           DFHEIV99,
 12531           PI-PREV-CONTROL-PRIMARY,
 12532           DFHEIV99,
 12533           DFHEIV99,
 12534           DFHEIV99
 12535     SET ADDRESS OF PENDING-MAILING-DATA TO
 12536         DFHEIV20
 12537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12538
 12539
 12540     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12541     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12542     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12543
 12544     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12545
 12546
 12547* EXEC CICS DELETE
 12548*        DATASET   (FILE-ID-ERPNDM)
 12549*    END-EXEC.
 12550*    MOVE '&(                    &   #00011752' TO DFHEIV0
 12551     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12552     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12553     MOVE X'2020233030303131373532' TO DFHEIV0(25:11)
 12554     CALL 'kxdfhei1' USING DFHEIV0,
 12555           FILE-ID-ERPNDM,
 12556           DFHEIV99,
 12557           DFHEIV99,
 12558           DFHEIV99,
 12559           DFHEIV99
 12560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12561
 12562
 12563******************************************************************
 12564*                PROCESS   CERTIFICATE                           *
 12565******************************************************************
 12566
 12567 1405-DELETE-CERTIFICATE.
 12568
 12569* EXEC CICS HANDLE CONDITION
 12570*         NOTFND  (1420-CONTINUE-DELETE)
 12571*    END-EXEC.
 12572*    MOVE '"$I                   ! - #00011761' TO DFHEIV0
 12573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12575     MOVE X'2D20233030303131373631' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0
 12577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12578
 12579
 12580     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12581     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12582     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12583     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12584
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 230
* EL6311.cbl
 12585
 12586* EXEC CICS READ
 12587*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12588*        DATASET (FILE-ID-ELCERT)
 12589*        RIDFLD  (ELCERT-KEY)
 12590*        UPDATE
 12591*    END-EXEC.
 12592*    MOVE '&"S        EU         (   #00011770' TO DFHEIV0
 12593     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12594     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12595     MOVE X'2020233030303131373730' TO DFHEIV0(25:11)
 12596     CALL 'kxdfhei1' USING DFHEIV0,
 12597           FILE-ID-ELCERT,
 12598           DFHEIV20,
 12599           DFHEIV99,
 12600           ELCERT-KEY,
 12601           DFHEIV99,
 12602           DFHEIV99,
 12603           DFHEIV99
 12604     SET ADDRESS OF CERTIFICATE-MASTER TO
 12605         DFHEIV20
 12606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12607
 12608
 12609     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12610
 12611     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12612     MOVE 'B'                    TO JP-RECORD-TYPE
 12613     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12614
 12615     PERFORM 8400-LOG-JOURNAL-RECORD.
 12616
 12617     IF CERT-NOTES-ARE-NOT-PRESENT
 12618        MOVE ' '                 TO WS-CERT-NOTE-SW
 12619     ELSE
 12620        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12621
 12622     IF INSURED-ADDR-PRESENT
 12623        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12624
 12625******************************************************************
 12626******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12627******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12628******************************************************************
 12629******************************************************************
 12630
 12631     IF CERT-ADDED-BATCH AND
 12632        (NOT NO-CLAIM-ATTACHED
 12633         OR
 12634         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12635        GO TO 1410-REWRITE-CERT.
 12636
 12637******************************************************************
 12638******************************************************************
 12639
 12640     IF CERT-ADDED-BATCH  AND
 12641        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12642        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 231
* EL6311.cbl
 12643
 12644     IF NO-CLAIM-ATTACHED
 12645        NEXT SENTENCE
 12646     ELSE
 12647        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12648        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12649        GO TO 1410-REWRITE-CERT.
 12650
 12651     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12652     MOVE 'D'                      TO JP-RECORD-TYPE.
 12653     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12654
 12655
 12656* EXEC CICS DELETE
 12657*         DATASET    (FILE-ID-ELCERT)
 12658*    END-EXEC.
 12659*    MOVE '&(                    &   #00011823' TO DFHEIV0
 12660     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12661     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12662     MOVE X'2020233030303131383233' TO DFHEIV0(25:11)
 12663     CALL 'kxdfhei1' USING DFHEIV0,
 12664           FILE-ID-ELCERT,
 12665           DFHEIV99,
 12666           DFHEIV99,
 12667           DFHEIV99,
 12668           DFHEIV99
 12669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12670
 12671
 12672     PERFORM 8400-LOG-JOURNAL-RECORD.
 12673
 12674******************************************************************
 12675*                                                                *
 12676*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12677*                                                                *
 12678******************************************************************
 12679
 12680     IF  CERT-NOTES-ARE-PRESENT
 12681         NEXT SENTENCE
 12682     ELSE
 12683         GO TO 1407-DELETE-MAILING.
 12684
 12685
 12686* EXEC CICS HANDLE CONDITION
 12687*         NOTFND  (1406-DELETE-ERNOTE)
 12688*    END-EXEC.
 12689*    MOVE '"$I                   ! . #00011840' TO DFHEIV0
 12690     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12692     MOVE X'2E20233030303131383430' TO DFHEIV0(25:11)
 12693     CALL 'kxdfhei1' USING DFHEIV0
 12694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12695
 12696
 12697     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12698     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12699     MOVE 0                     TO ERCNOT-SEQUENCE.
 12700
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 232
* EL6311.cbl
 12701 1406-DELETE-ERCNOT-LOOP.
 12702
 12703
 12704* EXEC CICS READ
 12705*        GTEQ
 12706*        DATASET   (FILE-ID-ERCNOT)
 12707*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12708*        RIDFLD    (ERCNOT-KEY)
 12709*    END-EXEC.
 12710*    MOVE '&"S        G          (   #00011850' TO DFHEIV0
 12711     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12713     MOVE X'2020233030303131383530' TO DFHEIV0(25:11)
 12714     CALL 'kxdfhei1' USING DFHEIV0,
 12715           FILE-ID-ERCNOT,
 12716           DFHEIV20,
 12717           DFHEIV99,
 12718           ERCNOT-KEY,
 12719           DFHEIV99,
 12720           DFHEIV99,
 12721           DFHEIV99
 12722     SET ADDRESS OF CERT-NOTE-FILE TO
 12723         DFHEIV20
 12724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12725
 12726
 12727     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12728     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12729         GO TO 1406-DELETE-ERNOTE
 12730     END-IF.
 12731
 12732     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12733     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12734     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12735
 12736     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12737
 12738
 12739* EXEC CICS DELETE
 12740*        DATASET   (FILE-ID-ERCNOT)
 12741*        RIDFLD    (ERCNOT-KEY)
 12742*        END-EXEC.
 12743*    MOVE '&(  R                 &   #00011868' TO DFHEIV0
 12744     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12745     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12746     MOVE X'2020233030303131383638' TO DFHEIV0(25:11)
 12747     CALL 'kxdfhei1' USING DFHEIV0,
 12748           FILE-ID-ERCNOT,
 12749           ERCNOT-KEY,
 12750           DFHEIV99,
 12751           DFHEIV99,
 12752           DFHEIV99
 12753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12754
 12755
 12756     PERFORM 8400-LOG-JOURNAL-RECORD.
 12757
 12758     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 233
* EL6311.cbl
 12759
 12760 1406-DELETE-ERNOTE.
 12761
 12762
 12763* EXEC CICS HANDLE CONDITION
 12764*         NOTFND  (1407-DELETE-MAILING)
 12765*    END-EXEC.
 12766*    MOVE '"$I                   ! / #00011879' TO DFHEIV0
 12767     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12769     MOVE X'2F20233030303131383739' TO DFHEIV0(25:11)
 12770     CALL 'kxdfhei1' USING DFHEIV0
 12771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12772
 12773
 12774
 12775* EXEC CICS READ
 12776*        EQUAL
 12777*        DATASET   (FILE-ID-ERNOTE)
 12778*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12779*        RIDFLD    (ELCERT-KEY)
 12780*        UPDATE
 12781*    END-EXEC.
 12782*    MOVE '&"S        EU         (   #00011883' TO DFHEIV0
 12783     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12784     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12785     MOVE X'2020233030303131383833' TO DFHEIV0(25:11)
 12786     CALL 'kxdfhei1' USING DFHEIV0,
 12787           FILE-ID-ERNOTE,
 12788           DFHEIV20,
 12789           DFHEIV99,
 12790           ELCERT-KEY,
 12791           DFHEIV99,
 12792           DFHEIV99,
 12793           DFHEIV99
 12794     SET ADDRESS OF CERTIFICATE-NOTE TO
 12795         DFHEIV20
 12796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12797
 12798
 12799     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12800     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12801     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12802
 12803     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12804
 12805
 12806* EXEC CICS DELETE
 12807*        DATASET   (FILE-ID-ERNOTE)
 12808*        END-EXEC.
 12809*    MOVE '&(                    &   #00011897' TO DFHEIV0
 12810     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12812     MOVE X'2020233030303131383937' TO DFHEIV0(25:11)
 12813     CALL 'kxdfhei1' USING DFHEIV0,
 12814           FILE-ID-ERNOTE,
 12815           DFHEIV99,
 12816           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 234
* EL6311.cbl
 12817           DFHEIV99,
 12818           DFHEIV99
 12819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12820
 12821
 12822     PERFORM 8400-LOG-JOURNAL-RECORD.
 12823
 12824******************************************************************
 12825*                                                                *
 12826*                DELETE MAILING ADDRESS RECORDS                  *
 12827*                                                                *
 12828******************************************************************
 12829
 12830 1407-DELETE-MAILING.
 12831     IF CERT-ADDRESS-PRESENT
 12832        NEXT SENTENCE
 12833     ELSE
 12834        GO TO 1420-CONTINUE-DELETE.
 12835
 12836
 12837* EXEC CICS HANDLE CONDITION
 12838*         NOTFND  (1420-CONTINUE-DELETE)
 12839*    END-EXEC.
 12840*    MOVE '"$I                   ! 0 #00011915' TO DFHEIV0
 12841     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12843     MOVE X'3020233030303131393135' TO DFHEIV0(25:11)
 12844     CALL 'kxdfhei1' USING DFHEIV0
 12845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12846
 12847
 12848
 12849* EXEC CICS READ
 12850*        EQUAL
 12851*        DATASET   (FILE-ID-ERMAIL)
 12852*        SET       (ADDRESS OF MAILING-DATA)
 12853*        RIDFLD    (ELCERT-KEY)
 12854*        UPDATE
 12855*    END-EXEC.
 12856*    MOVE '&"S        EU         (   #00011919' TO DFHEIV0
 12857     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12859     MOVE X'2020233030303131393139' TO DFHEIV0(25:11)
 12860     CALL 'kxdfhei1' USING DFHEIV0,
 12861           FILE-ID-ERMAIL,
 12862           DFHEIV20,
 12863           DFHEIV99,
 12864           ELCERT-KEY,
 12865           DFHEIV99,
 12866           DFHEIV99,
 12867           DFHEIV99
 12868     SET ADDRESS OF MAILING-DATA TO
 12869         DFHEIV20
 12870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12871
 12872
 12873     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12874     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 235
* EL6311.cbl
 12875     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12876
 12877     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12878
 12879
 12880* EXEC CICS DELETE
 12881*        DATASET   (FILE-ID-ERMAIL)
 12882*    END-EXEC.
 12883*    MOVE '&(                    &   #00011933' TO DFHEIV0
 12884     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12885     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12886     MOVE X'2020233030303131393333' TO DFHEIV0(25:11)
 12887     CALL 'kxdfhei1' USING DFHEIV0,
 12888           FILE-ID-ERMAIL,
 12889           DFHEIV99,
 12890           DFHEIV99,
 12891           DFHEIV99,
 12892           DFHEIV99
 12893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12894
 12895
 12896     GO TO 1420-CONTINUE-DELETE.
 12897
 12898 1410-REWRITE-CERT.
 12899     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12900     MOVE 'C'                      TO JP-RECORD-TYPE.
 12901     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12902     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12903
 12904
 12905* EXEC CICS REWRITE
 12906*         DATASET    (FILE-ID-ELCERT)
 12907*         FROM       (CERTIFICATE-MASTER)
 12908*         END-EXEC.
 12909     MOVE LENGTH OF
 12910      CERTIFICATE-MASTER
 12911       TO DFHEIV11
 12912*    MOVE '&& L                  %   #00011945' TO DFHEIV0
 12913     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12914     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12915     MOVE X'2020233030303131393435' TO DFHEIV0(25:11)
 12916     CALL 'kxdfhei1' USING DFHEIV0,
 12917           FILE-ID-ELCERT,
 12918           CERTIFICATE-MASTER,
 12919           DFHEIV11,
 12920           DFHEIV99
 12921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12922
 12923
 12924     PERFORM 8400-LOG-JOURNAL-RECORD.
 12925
 12926 1420-CONTINUE-DELETE.
 12927     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12928     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12929
 12930     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12931     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12932
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 236
* EL6311.cbl
 12933     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12934
 12935 1450-DELETE-PB-RECORD.
 12936     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12937     MOVE 'D'                      TO JP-RECORD-TYPE
 12938     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12939
 12940
 12941* EXEC CICS DELETE
 12942*        DATASET    (FILE-ID-ERPNDB)
 12943*    END-EXEC.
 12944*    MOVE '&(                    &   #00011966' TO DFHEIV0
 12945     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12946     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12947     MOVE X'2020233030303131393636' TO DFHEIV0(25:11)
 12948     CALL 'kxdfhei1' USING DFHEIV0,
 12949           FILE-ID-ERPNDB,
 12950           DFHEIV99,
 12951           DFHEIV99,
 12952           DFHEIV99,
 12953           DFHEIV99
 12954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12955
 12956
 12957     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12958
 12959     PERFORM 8400-LOG-JOURNAL-RECORD.
 12960
 12961     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12962     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12963     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12964
 12965
 12966* EXEC CICS HANDLE CONDITION
 12967*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12968*    END-EXEC.
 12969*    MOVE '"$I                   ! 1 #00011978' TO DFHEIV0
 12970     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12972     MOVE X'3120233030303131393738' TO DFHEIV0(25:11)
 12973     CALL 'kxdfhei1' USING DFHEIV0
 12974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12975
 12976
 12977
 12978* EXEC CICS READ
 12979*        SET     (ADDRESS OF PENDING-BUSINESS)
 12980*        DATASET (FILE-ID-ERPNDB)
 12981*        RIDFLD  (ERPNDB-KEY)
 12982*        UPDATE
 12983*    END-EXEC.
 12984*    MOVE '&"S        EU         (   #00011982' TO DFHEIV0
 12985     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12986     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12987     MOVE X'2020233030303131393832' TO DFHEIV0(25:11)
 12988     CALL 'kxdfhei1' USING DFHEIV0,
 12989           FILE-ID-ERPNDB,
 12990           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 237
* EL6311.cbl
 12991           DFHEIV99,
 12992           ERPNDB-KEY,
 12993           DFHEIV99,
 12994           DFHEIV99,
 12995           DFHEIV99
 12996     SET ADDRESS OF PENDING-BUSINESS TO
 12997         DFHEIV20
 12998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12999
 13000
 13001     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13002
 13003     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13004
 13005     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13006        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13007        MOVE 'D'                   TO JP-RECORD-TYPE
 13008        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13009
 13010* EXEC CICS DELETE
 13011*            DATASET    (FILE-ID-ERPNDB)
 13012*       END-EXEC
 13013*    MOVE '&(                    &   #00011997' TO DFHEIV0
 13014     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13016     MOVE X'2020233030303131393937' TO DFHEIV0(25:11)
 13017     CALL 'kxdfhei1' USING DFHEIV0,
 13018           FILE-ID-ERPNDB,
 13019           DFHEIV99,
 13020           DFHEIV99,
 13021           DFHEIV99,
 13022           DFHEIV99
 13023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13024        PERFORM 8400-LOG-JOURNAL-RECORD
 13025     ELSE
 13026        MOVE 'B'                 TO JP-RECORD-TYPE
 13027        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13028        PERFORM 8400-LOG-JOURNAL-RECORD
 13029        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13030        MOVE 'C'                 TO JP-RECORD-TYPE
 13031        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13032
 13033* EXEC CICS REWRITE
 13034*            DATASET    (FILE-ID-ERPNDB)
 13035*            FROM       (PENDING-BUSINESS)
 13036*       END-EXEC
 13037     MOVE LENGTH OF
 13038      PENDING-BUSINESS
 13039       TO DFHEIV11
 13040*    MOVE '&& L                  %   #00012008' TO DFHEIV0
 13041     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13042     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13043     MOVE X'2020233030303132303038' TO DFHEIV0(25:11)
 13044     CALL 'kxdfhei1' USING DFHEIV0,
 13045           FILE-ID-ERPNDB,
 13046           PENDING-BUSINESS,
 13047           DFHEIV11,
 13048           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 238
* EL6311.cbl
 13049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13050        PERFORM 8400-LOG-JOURNAL-RECORD.
 13051
 13052******************************************************************
 13053*                                                                *
 13054*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13055*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13056*                                                                *
 13057******************************************************************
 13058
 13059     IF NOT PI-AR-PROCESSING
 13060        GO TO 1475-DELETE-FINISHED.
 13061
 13062     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13063        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13064        NEXT SENTENCE
 13065     ELSE
 13066        GO TO 1475-DELETE-FINISHED.
 13067
 13068
 13069* EXEC CICS HANDLE CONDITION
 13070*         NOTFND    (1475-DELETE-FINISHED)
 13071*         END-EXEC.
 13072*    MOVE '"$I                   ! 2 #00012030' TO DFHEIV0
 13073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13075     MOVE X'3220233030303132303330' TO DFHEIV0(25:11)
 13076     CALL 'kxdfhei1' USING DFHEIV0
 13077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13078
 13079
 13080     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13081     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13082
 13083
 13084* EXEC CICS READ
 13085*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13086*        DATASET (FILE-ID-ERRQST)
 13087*        RIDFLD  (ERRQST-KEY)
 13088*        UPDATE
 13089*    END-EXEC.
 13090*    MOVE '&"S        EU         (   #00012037' TO DFHEIV0
 13091     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13092     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13093     MOVE X'2020233030303132303337' TO DFHEIV0(25:11)
 13094     CALL 'kxdfhei1' USING DFHEIV0,
 13095           FILE-ID-ERRQST,
 13096           DFHEIV20,
 13097           DFHEIV99,
 13098           ERRQST-KEY,
 13099           DFHEIV99,
 13100           DFHEIV99,
 13101           DFHEIV99
 13102     SET ADDRESS OF AR-REQUEST-RECORD TO
 13103         DFHEIV20
 13104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13105
 13106
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 239
* EL6311.cbl
 13107     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13108
 13109     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13110
 13111     MOVE 'D'                      TO JP-RECORD-TYPE.
 13112     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13113
 13114
 13115* EXEC CICS DELETE
 13116*         DATASET    (FILE-ID-ERRQST)
 13117*    END-EXEC.
 13118*    MOVE '&(                    &   #00012051' TO DFHEIV0
 13119     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13121     MOVE X'2020233030303132303531' TO DFHEIV0(25:11)
 13122     CALL 'kxdfhei1' USING DFHEIV0,
 13123           FILE-ID-ERRQST,
 13124           DFHEIV99,
 13125           DFHEIV99,
 13126           DFHEIV99,
 13127           DFHEIV99
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13129
 13130
 13131     PERFORM 8400-LOG-JOURNAL-RECORD.
 13132
 13133 1475-DELETE-FINISHED.
 13134     MOVE ZEROS                  TO EMI-ERROR.
 13135     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13136     MOVE LOW-VALUES             TO EL631BI.
 13137     MOVE -1                     TO BMAINTL.
 13138     GO TO 8100-SEND-INITIAL-MAP.
 13139
 13140 1480-BATCH-HDR-NOT-FOUND.
 13141     MOVE -1                     TO BMAINTL.
 13142     MOVE ER-7450                TO EMI-ERROR.
 13143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13144     GO TO 8200-SEND-DATAONLY.
 13145
 13146 1490-RECORD-NOT-FOUND.
 13147     MOVE -1                     TO BMAINTL.
 13148     MOVE ER-7451                TO EMI-ERROR.
 13149     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13150     GO TO 8200-SEND-DATAONLY.
 13151
 13152******************************************************************
 13153*            O V E R   C H A R G E   P R O C E S S I N G         *
 13154******************************************************************
 13155 1500-UPDATE-ERNOTE.
 13156     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13157     MOVE 'A'                    TO WS-NOTE-SW
 13158     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13159     .
 13160 1500-EXIT.
 13161     EXIT.
 13162 1510-ADD-ERNOTE-REC.
 13163
 13164* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 240
* EL6311.cbl
 13165*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13166*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13167*        INITIMG (GETMAIN-SPACE)
 13168*    END-EXEC
 13169*    MOVE ',"IL                  $   #00012087' TO DFHEIV0
 13170     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13172     MOVE X'2020233030303132303837' TO DFHEIV0(25:11)
 13173     CALL 'kxdfhei1' USING DFHEIV0,
 13174           DFHEIV20,
 13175           ERNOTE-RECORD-LENGTH,
 13176           GETMAIN-SPACE
 13177     SET ADDRESS OF CERTIFICATE-NOTE TO
 13178         DFHEIV20
 13179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13180     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13181                                 TO ERNOTE-KEY
 13182
 13183* EXEC CICS READ
 13184*       DATASET    (FILE-ID-ERNOTE)
 13185*       RIDFLD     (ERNOTE-KEY)
 13186*       INTO       (CERTIFICATE-NOTE)
 13187*       RESP       (WS-RESPONSE)
 13188*       UPDATE
 13189*    END-EXEC
 13190     MOVE LENGTH OF
 13191      CERTIFICATE-NOTE
 13192       TO DFHEIV11
 13193*    MOVE '&"IL       EU         (  N#00012094' TO DFHEIV0
 13194     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13195     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13196     MOVE X'204E233030303132303934' TO DFHEIV0(25:11)
 13197     CALL 'kxdfhei1' USING DFHEIV0,
 13198           FILE-ID-ERNOTE,
 13199           CERTIFICATE-NOTE,
 13200           DFHEIV11,
 13201           ERNOTE-KEY,
 13202           DFHEIV99,
 13203           DFHEIV99,
 13204           DFHEIV99
 13205     MOVE EIBRESP  TO WS-RESPONSE
 13206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13207     IF RESP-NORMAL
 13208        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13209           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13210        END-IF
 13211        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13212           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13213        END-IF
 13214        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13215           (N1 > +10)
 13216           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13217           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13218        END-PERFORM
 13219        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13220          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13221
 13222* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 241
* EL6311.cbl
 13223*            DATASET    (FILE-ID-ERNOTE)
 13224*          END-EXEC
 13225*    MOVE '&*                    #   #00012115' TO DFHEIV0
 13226     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13227     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13228     MOVE X'2020233030303132313135' TO DFHEIV0(25:11)
 13229     CALL 'kxdfhei1' USING DFHEIV0,
 13230           FILE-ID-ERNOTE,
 13231           DFHEIV99
 13232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13233        ELSE
 13234          PERFORM VARYING N1 FROM +1 BY +1
 13235           UNTIL (N1 > +10)
 13236           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13237          END-PERFORM
 13238          IF (N1 < +11)
 13239            IF N1 >= CN-BILLING-START-LINE-NO AND
 13240              N1 <= CN-BILLING-END-LINE-NO
 13241              IF PI-COMPANY-ID = 'DCC'
 13242                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13243              ELSE
 13244                 MOVE WS-VA-NO-COMM-MESS
 13245                                    TO CN-LINE (N1)
 13246              END-IF
 13247            ELSE
 13248              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13249               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13250                IF PI-COMPANY-ID = 'DCC'
 13251                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13252                ELSE
 13253                  MOVE WS-VA-NO-COMM-MESS
 13254                                    TO CN-LINE (N1)
 13255                END-IF
 13256                MOVE N1             TO CN-BILLING-END-LINE-NO
 13257              ELSE
 13258                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13259                  IF PI-COMPANY-ID = 'DCC'
 13260                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13261                  ELSE
 13262                     MOVE WS-VA-NO-COMM-MESS
 13263                                    TO CN-LINE (N1)
 13264                  END-IF
 13265                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13266                                      CN-BILLING-START-LINE-NO
 13267                ELSE
 13268                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13269                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13270                     IF PI-COMPANY-ID = 'DCC'
 13271                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13272                     ELSE
 13273                       MOVE WS-VA-NO-COMM-MESS
 13274                                    TO CN-LINE (N1)
 13275                     END-IF
 13276                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13277                  ELSE
 13278                     PERFORM 1700-SQUEEZE-IT-IN
 13279                                 THRU 1700-EXIT
 13280                  END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 242
* EL6311.cbl
 13281                END-IF
 13282              END-IF
 13283            END-IF
 13284            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13285            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13286            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13287
 13288* EXEC CICS REWRITE
 13289*              DATASET    (FILE-ID-ERNOTE)
 13290*              FROM       (CERTIFICATE-NOTE)
 13291*              RESP       (WS-RESPONSE)
 13292*           END-EXEC
 13293     MOVE LENGTH OF
 13294      CERTIFICATE-NOTE
 13295       TO DFHEIV11
 13296*    MOVE '&& L                  %  N#00012172' TO DFHEIV0
 13297     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13298     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13299     MOVE X'204E233030303132313732' TO DFHEIV0(25:11)
 13300     CALL 'kxdfhei1' USING DFHEIV0,
 13301           FILE-ID-ERNOTE,
 13302           CERTIFICATE-NOTE,
 13303           DFHEIV11,
 13304           DFHEIV99
 13305     MOVE EIBRESP  TO WS-RESPONSE
 13306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13307          END-IF
 13308        END-IF
 13309     ELSE
 13310        MOVE SPACES              TO CERTIFICATE-NOTE
 13311        MOVE 'CN'                TO CN-RECORD-ID
 13312        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13313                                 TO CN-CONTROL-PRIMARY
 13314                                    ERNOTE-KEY
 13315        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13316                                    CN-BILLING-END-LINE-NO
 13317        IF PI-COMPANY-ID = 'DCC'
 13318           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13319        ELSE
 13320           MOVE WS-VA-NO-COMM-MESS
 13321                                 TO CN-LINE (1)
 13322        END-IF
 13323        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13324        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13325        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13326
 13327* EXEC CICS WRITE
 13328*          DATASET    (FILE-ID-ERNOTE)
 13329*          FROM       (CERTIFICATE-NOTE)
 13330*          RIDFLD     (ERNOTE-KEY)
 13331*          RESP       (WS-RESPONSE)
 13332*       END-EXEC
 13333     MOVE LENGTH OF
 13334      CERTIFICATE-NOTE
 13335       TO DFHEIV11
 13336*    MOVE '&$ L                  ''  N#00012196' TO DFHEIV0
 13337     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13338     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 243
* EL6311.cbl
 13339     MOVE X'204E233030303132313936' TO DFHEIV0(25:11)
 13340     CALL 'kxdfhei1' USING DFHEIV0,
 13341           FILE-ID-ERNOTE,
 13342           CERTIFICATE-NOTE,
 13343           DFHEIV11,
 13344           ERNOTE-KEY,
 13345           DFHEIV99,
 13346           DFHEIV99
 13347     MOVE EIBRESP  TO WS-RESPONSE
 13348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13349     END-IF
 13350     .
 13351 1510-EXIT.
 13352     EXIT.
 13353 1520-UPDATE-ELCERT.
 13354     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13355                                 TO ELCERT-KEY
 13356
 13357* EXEC CICS READ
 13358*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13359*        DATASET (FILE-ID-ELCERT)
 13360*        RIDFLD  (ELCERT-KEY)
 13361*        UPDATE
 13362*        RESP    (WS-RESPONSE)
 13363*    END-EXEC
 13364*    MOVE '&"S        EU         (  N#00012209' TO DFHEIV0
 13365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13366     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13367     MOVE X'204E233030303132323039' TO DFHEIV0(25:11)
 13368     CALL 'kxdfhei1' USING DFHEIV0,
 13369           FILE-ID-ELCERT,
 13370           DFHEIV20,
 13371           DFHEIV99,
 13372           ELCERT-KEY,
 13373           DFHEIV99,
 13374           DFHEIV99,
 13375           DFHEIV99
 13376     SET ADDRESS OF CERTIFICATE-MASTER TO
 13377         DFHEIV20
 13378     MOVE EIBRESP  TO WS-RESPONSE
 13379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13380     IF RESP-NORMAL
 13381        IF WS-NOTE-SW = 'A'
 13382           IF CM-NOTE-SW = ' '
 13383              MOVE '2'             TO CM-NOTE-SW
 13384           ELSE
 13385             IF CM-NOTE-SW = '1'
 13386                MOVE '3'           TO CM-NOTE-SW
 13387             ELSE
 13388               IF CM-NOTE-SW = '4'
 13389                  MOVE '6'         TO CM-NOTE-SW
 13390               ELSE
 13391                 IF CM-NOTE-SW = '5'
 13392                    MOVE '7'       TO CM-NOTE-SW
 13393                 END-IF
 13394               END-IF
 13395             END-IF
 13396           END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 244
* EL6311.cbl
 13397        ELSE
 13398           IF CM-NOTE-SW = '2'
 13399              MOVE ' '             TO CM-NOTE-SW
 13400           ELSE
 13401             IF CM-NOTE-SW = '3'
 13402                MOVE '1'           TO CM-NOTE-SW
 13403             ELSE
 13404               IF CM-NOTE-SW = '6'
 13405                  MOVE '4'         TO CM-NOTE-SW
 13406               ELSE
 13407                 IF CM-NOTE-SW = '7'
 13408                    MOVE '5'       TO CM-NOTE-SW
 13409                 END-IF
 13410               END-IF
 13411             END-IF
 13412           END-IF
 13413        END-IF
 13414
 13415* EXEC CICS REWRITE
 13416*          DATASET    (FILE-ID-ELCERT)
 13417*          FROM       (CERTIFICATE-MASTER)
 13418*          RESP       (WS-RESPONSE)
 13419*       END-EXEC
 13420     MOVE LENGTH OF
 13421      CERTIFICATE-MASTER
 13422       TO DFHEIV11
 13423*    MOVE '&& L                  %  N#00012250' TO DFHEIV0
 13424     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13425     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13426     MOVE X'204E233030303132323530' TO DFHEIV0(25:11)
 13427     CALL 'kxdfhei1' USING DFHEIV0,
 13428           FILE-ID-ELCERT,
 13429           CERTIFICATE-MASTER,
 13430           DFHEIV11,
 13431           DFHEIV99
 13432     MOVE EIBRESP  TO WS-RESPONSE
 13433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13434        IF RESP-NORMAL
 13435           CONTINUE
 13436        ELSE
 13437           MOVE WS-RESPONSE TO EMI-ERROR
 13438           PERFORM 9900-ERROR-FORMAT
 13439                                 THRU 9900-EXIT
 13440           GO TO 8200-SEND-DATAONLY
 13441        END-IF
 13442     ELSE
 13443        MOVE -1                  TO BMAINTL
 13444        MOVE 0249                TO EMI-ERROR
 13445        PERFORM 9900-ERROR-FORMAT
 13446                                 THRU 9900-EXIT
 13447        GO TO 8200-SEND-DATAONLY
 13448     END-IF
 13449     .
 13450 1520-EXIT.
 13451     EXIT.
 13452 1600-UPDATE-ERPYAJ.
 13453     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13454                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 245
* EL6311.cbl
 13455     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13456                                 THRU 1620-EXIT
 13457     .
 13458 1600-EXIT.
 13459     EXIT.
 13460 1610-ADD-ERPYAJ-BANK-REC.
 13461
 13462* EXEC CICS GETMAIN
 13463*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13464*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13465*        INITIMG (GETMAIN-SPACE)
 13466*    END-EXEC
 13467*    MOVE ',"IL                  $   #00012282' TO DFHEIV0
 13468     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13469     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13470     MOVE X'2020233030303132323832' TO DFHEIV0(25:11)
 13471     CALL 'kxdfhei1' USING DFHEIV0,
 13472           DFHEIV20,
 13473           ERPYAJ-RECORD-LENGTH,
 13474           GETMAIN-SPACE
 13475     SET ADDRESS OF PENDING-PAY-ADJ TO
 13476         DFHEIV20
 13477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13478     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13479     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13480     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13481     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13482     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13483     MOVE +10                    TO ERPYAJ-SEQ-NO
 13484     MOVE 'R'                    TO ERPYAJ-TYPE
 13485     IF REVERSAL
 13486        MOVE 'C'                 TO ERPYAJ-TYPE
 13487     END-IF
 13488     MOVE SPACES                 TO PENDING-PAY-ADJ
 13489     MOVE 'PY'                   TO PY-RECORD-ID
 13490     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13491     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13492     IF REVERSAL
 13493        MOVE PB-I-DCC-OVER-CHG-AMT
 13494                                 TO PY-ENTRY-AMT
 13495     END-IF
 13496     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13497                                    PY-INPUT-DT
 13498*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13499*                                   PY-INPUT-DT
 13500     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13501     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13502     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13503     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13504     IF PB-CARRIER = '2'
 13505        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13506     ELSE
 13507        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13508     END-IF
 13509     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13510                                    PY-BILLED-DATE
 13511                                    PY-AR-DATE
 13512                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 246
* EL6311.cbl
 13513                                    PY-CHECK-WRITTEN-DT
 13514     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13515                                    PY-CHECK-QUE-SEQUENCE
 13516     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13517     PERFORM WITH TEST AFTER
 13518        UNTIL (NOT RESP-DUPKEY)
 13519           AND (NOT RESP-DUPREC)
 13520
 13521* EXEC CICS WRITE
 13522*          DATASET    (FILE-ID-ERPYAJ)
 13523*          FROM       (PENDING-PAY-ADJ)
 13524*          RIDFLD     (ERPYAJ-KEY)
 13525*          RESP       (WS-RESPONSE)
 13526*       END-EXEC
 13527     MOVE LENGTH OF
 13528      PENDING-PAY-ADJ
 13529       TO DFHEIV11
 13530*    MOVE '&$ L                  ''  N#00012329' TO DFHEIV0
 13531     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13532     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13533     MOVE X'204E233030303132333239' TO DFHEIV0(25:11)
 13534     CALL 'kxdfhei1' USING DFHEIV0,
 13535           FILE-ID-ERPYAJ,
 13536           PENDING-PAY-ADJ,
 13537           DFHEIV11,
 13538           ERPYAJ-KEY,
 13539           DFHEIV99,
 13540           DFHEIV99
 13541     MOVE EIBRESP  TO WS-RESPONSE
 13542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13543        IF RESP-DUPKEY OR RESP-DUPREC
 13544           ADD +1                TO ERPYAJ-SEQ-NO
 13545           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13546        END-IF
 13547     END-PERFORM
 13548     .
 13549 1610-EXIT.
 13550     EXIT.
 13551 1620-ADD-ERPYAJ-DLR-REC.
 13552     MOVE 'C'                    TO ERPYAJ-TYPE
 13553     IF REVERSAL
 13554        MOVE 'R'                 TO ERPYAJ-TYPE
 13555     END-IF
 13556     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13557                                    ERPYAJ-ACCOUNT
 13558     ADD +1                      TO ERPYAJ-SEQ-NO
 13559     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13560     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13561     IF PB-CARRIER = '2'
 13562        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13563     ELSE
 13564        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13565     END-IF
 13566     PERFORM WITH TEST AFTER
 13567        UNTIL (NOT RESP-DUPKEY)
 13568           AND (NOT RESP-DUPREC)
 13569
 13570* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 247
* EL6311.cbl
 13571*          DATASET    (FILE-ID-ERPYAJ)
 13572*          FROM       (PENDING-PAY-ADJ)
 13573*          RIDFLD     (ERPYAJ-KEY)
 13574*          RESP       (WS-RESPONSE)
 13575*       END-EXEC
 13576     MOVE LENGTH OF
 13577      PENDING-PAY-ADJ
 13578       TO DFHEIV11
 13579*    MOVE '&$ L                  ''  N#00012361' TO DFHEIV0
 13580     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13582     MOVE X'204E233030303132333631' TO DFHEIV0(25:11)
 13583     CALL 'kxdfhei1' USING DFHEIV0,
 13584           FILE-ID-ERPYAJ,
 13585           PENDING-PAY-ADJ,
 13586           DFHEIV11,
 13587           ERPYAJ-KEY,
 13588           DFHEIV99,
 13589           DFHEIV99
 13590     MOVE EIBRESP  TO WS-RESPONSE
 13591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13592        IF RESP-DUPKEY OR RESP-DUPREC
 13593           ADD +1                TO ERPYAJ-SEQ-NO
 13594           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13595        END-IF
 13596     END-PERFORM
 13597     .
 13598 1620-EXIT.
 13599     EXIT.
 13600 1700-SQUEEZE-IT-IN.
 13601     IF (N1 > CN-BILLING-END-LINE-NO)
 13602        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13603           N1 = +1
 13604           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13605           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13606              IF PI-COMPANY-ID = 'DCC'
 13607                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13608              ELSE
 13609                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13610              END-IF
 13611              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13612              MOVE +2 TO N1
 13613           END-IF
 13614        END-PERFORM
 13615     ELSE
 13616        IF (N1 < CN-BILLING-START-LINE-NO)
 13617           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13618              N1 = +10
 13619              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13620              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13621                 IF PI-COMPANY-ID = 'DCC'
 13622                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13623                 ELSE
 13624                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13625                 END-IF
 13626                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13627                 MOVE +9 TO N1
 13628              END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 248
* EL6311.cbl
 13629           END-PERFORM
 13630        END-IF
 13631     END-IF
 13632     .
 13633 1700-EXIT.
 13634     EXIT.
 13635 1800-REMOVE-CERT-NOTES.
 13636     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13637                                 TO ERNOTE-KEY
 13638
 13639* EXEC CICS READ
 13640*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13641*       DATASET    (FILE-ID-ERNOTE)
 13642*       RIDFLD     (ERNOTE-KEY)
 13643*       RESP       (WS-RESPONSE)
 13644*       UPDATE
 13645*    END-EXEC
 13646*    MOVE '&"S        EU         (  N#00012413' TO DFHEIV0
 13647     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13648     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13649     MOVE X'204E233030303132343133' TO DFHEIV0(25:11)
 13650     CALL 'kxdfhei1' USING DFHEIV0,
 13651           FILE-ID-ERNOTE,
 13652           DFHEIV20,
 13653           DFHEIV99,
 13654           ERNOTE-KEY,
 13655           DFHEIV99,
 13656           DFHEIV99,
 13657           DFHEIV99
 13658     SET ADDRESS OF CERTIFICATE-NOTE TO
 13659         DFHEIV20
 13660     MOVE EIBRESP  TO WS-RESPONSE
 13661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13662     IF RESP-NORMAL
 13663        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13664           (N1 > +10)
 13665           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13666           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13667        END-PERFORM
 13668        IF N1 < +11
 13669           MOVE SPACES              TO CN-LINE (N1)
 13670           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13671              N1 <= CN-BILLING-END-LINE-NO
 13672              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13673              IF CN-BILLING-END-LINE-NO <
 13674                               CN-BILLING-START-LINE-NO
 13675                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13676                                     CN-BILLING-START-LINE-NO
 13677              END-IF
 13678              PERFORM 1820-SQUEEZE-ERNOTE
 13679                                  THRU 1820-EXIT
 13680           END-IF
 13681           IF CN-LINES = SPACES
 13682
 13683* EXEC CICS DELETE
 13684*                DATASET    (FILE-ID-ERNOTE)
 13685*                RESP       (WS-RESPONSE)
 13686*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 249
* EL6311.cbl
 13687*    MOVE '&(                    &  N#00012440' TO DFHEIV0
 13688     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13689     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13690     MOVE X'204E233030303132343430' TO DFHEIV0(25:11)
 13691     CALL 'kxdfhei1' USING DFHEIV0,
 13692           FILE-ID-ERNOTE,
 13693           DFHEIV99,
 13694           DFHEIV99,
 13695           DFHEIV99,
 13696           DFHEIV99
 13697     MOVE EIBRESP  TO WS-RESPONSE
 13698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13699              IF RESP-NORMAL
 13700                 MOVE 'D'        TO WS-NOTE-SW
 13701                 PERFORM 1520-UPDATE-ELCERT
 13702                                 THRU 1520-EXIT
 13703              END-IF
 13704           ELSE
 13705
 13706* EXEC CICS REWRITE
 13707*                DATASET    (FILE-ID-ERNOTE)
 13708*                FROM       (CERTIFICATE-NOTE)
 13709*                RESP       (WS-RESPONSE)
 13710*             END-EXEC
 13711     MOVE LENGTH OF
 13712      CERTIFICATE-NOTE
 13713       TO DFHEIV11
 13714*    MOVE '&& L                  %  N#00012450' TO DFHEIV0
 13715     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13716     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13717     MOVE X'204E233030303132343530' TO DFHEIV0(25:11)
 13718     CALL 'kxdfhei1' USING DFHEIV0,
 13719           FILE-ID-ERNOTE,
 13720           CERTIFICATE-NOTE,
 13721           DFHEIV11,
 13722           DFHEIV99
 13723     MOVE EIBRESP  TO WS-RESPONSE
 13724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13725           END-IF
 13726        END-IF
 13727     END-IF
 13728     .
 13729 1800-EXIT.
 13730     EXIT.
 13731 1820-SQUEEZE-ERNOTE.
 13732     MOVE CN-BILLING-START-LINE-NO TO N2
 13733     IF N2 = 0
 13734         MOVE +1                 TO N2
 13735     END-IF
 13736     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13737        (N1 > +9)
 13738        IF CN-LINE (N1) = SPACES
 13739           MOVE CN-LINE (N1 + +1)
 13740                                 TO CN-LINE (N1)
 13741           MOVE SPACES           TO CN-LINE (N1 + +1)
 13742        END-IF
 13743     END-PERFORM
 13744     .
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 250
* EL6311.cbl
 13745 1820-EXIT.
 13746     EXIT.
 13747 1900-DELETE-ERPYAJ.
 13748     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13749     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13750     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13751     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13752     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13753     MOVE +10                    TO ERPYAJ-SEQ-NO
 13754     MOVE 'R'                    TO ERPYAJ-TYPE
 13755     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13756
 13757* EXEC CICS STARTBR
 13758*       DATASET    (FILE-ID-ERPYAJ)
 13759*       RIDFLD     (ERPYAJ-KEY)
 13760*       RESP       (WS-RESPONSE)
 13761*    END-EXEC
 13762     MOVE 0
 13763       TO DFHEIV11
 13764*    MOVE '&,         G          &  N#00012486' TO DFHEIV0
 13765     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13767     MOVE X'204E233030303132343836' TO DFHEIV0(25:11)
 13768     CALL 'kxdfhei1' USING DFHEIV0,
 13769           FILE-ID-ERPYAJ,
 13770           ERPYAJ-KEY,
 13771           DFHEIV99,
 13772           DFHEIV11,
 13773           DFHEIV99
 13774     MOVE EIBRESP  TO WS-RESPONSE
 13775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13776     IF RESP-NORMAL
 13777        CONTINUE
 13778     ELSE
 13779        GO TO 1900-GET-DEALER
 13780     END-IF
 13781     .
 13782 1900-READNEXT-ERPYAJ-B.
 13783*  GET THE BANK ERPYAJ RECORD
 13784
 13785* EXEC CICS READNEXT
 13786*       DATASET    (FILE-ID-ERPYAJ)
 13787*       RIDFLD     (ERPYAJ-KEY)
 13788*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13789*       RESP       (WS-RESPONSE)
 13790*    END-EXEC
 13791     MOVE 0
 13792       TO DFHEIV11
 13793*    MOVE '&.S                   )  N#00012499' TO DFHEIV0
 13794     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13795     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13796     MOVE X'204E233030303132343939' TO DFHEIV0(25:11)
 13797     CALL 'kxdfhei1' USING DFHEIV0,
 13798           FILE-ID-ERPYAJ,
 13799           DFHEIV20,
 13800           DFHEIV99,
 13801           ERPYAJ-KEY,
 13802           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 251
* EL6311.cbl
 13803           DFHEIV11,
 13804           DFHEIV99,
 13805           DFHEIV99
 13806     SET ADDRESS OF PENDING-PAY-ADJ TO
 13807         DFHEIV20
 13808     MOVE EIBRESP  TO WS-RESPONSE
 13809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13810     IF RESP-NORMAL
 13811        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13812           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13813              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13814                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13815
 13816* EXEC CICS READ
 13817*                   DATASET    (FILE-ID-ERPYAJ)
 13818*                   RIDFLD     (ERPYAJ-KEY)
 13819*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13820*                   RESP       (WS-RESPONSE)
 13821*                   UPDATE
 13822*                END-EXEC
 13823*    MOVE '&"S        EU         (  N#00012510' TO DFHEIV0
 13824     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13825     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13826     MOVE X'204E233030303132353130' TO DFHEIV0(25:11)
 13827     CALL 'kxdfhei1' USING DFHEIV0,
 13828           FILE-ID-ERPYAJ,
 13829           DFHEIV20,
 13830           DFHEIV99,
 13831           ERPYAJ-KEY,
 13832           DFHEIV99,
 13833           DFHEIV99,
 13834           DFHEIV99
 13835     SET ADDRESS OF PENDING-PAY-ADJ TO
 13836         DFHEIV20
 13837     MOVE EIBRESP  TO WS-RESPONSE
 13838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13839                 IF RESP-NORMAL
 13840
 13841* EXEC CICS DELETE
 13842*                      DATASET   (FILE-ID-ERPYAJ)
 13843*                      RESP      (WS-RESPONSE)
 13844*                   END-EXEC
 13845*    MOVE '&(                    &  N#00012518' TO DFHEIV0
 13846     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13848     MOVE X'204E233030303132353138' TO DFHEIV0(25:11)
 13849     CALL 'kxdfhei1' USING DFHEIV0,
 13850           FILE-ID-ERPYAJ,
 13851           DFHEIV99,
 13852           DFHEIV99,
 13853           DFHEIV99,
 13854           DFHEIV99
 13855     MOVE EIBRESP  TO WS-RESPONSE
 13856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13857                 END-IF
 13858              ELSE
 13859                 SET REVERSAL    TO TRUE
 13860                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 252
* EL6311.cbl
 13861                                 THRU 1600-EXIT
 13862                 GO TO 1900-EXIT
 13863              END-IF
 13864           ELSE
 13865              GO TO 1900-READNEXT-ERPYAJ-B
 13866           END-IF
 13867        END-IF
 13868
 13869* EXEC CICS ENDBR
 13870*          DATASET   (FILE-ID-ERPYAJ)
 13871*       END-EXEC
 13872     MOVE 0
 13873       TO DFHEIV11
 13874*    MOVE '&2                    $   #00012533' TO DFHEIV0
 13875     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13876     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13877     MOVE X'2020233030303132353333' TO DFHEIV0(25:11)
 13878     CALL 'kxdfhei1' USING DFHEIV0,
 13879           FILE-ID-ERPYAJ,
 13880           DFHEIV11,
 13881           DFHEIV99
 13882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13883     END-IF
 13884     .
 13885 1900-GET-DEALER.
 13886     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13887     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13888     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13889     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13890     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13891     MOVE +10                    TO ERPYAJ-SEQ-NO
 13892     MOVE 'C'                    TO ERPYAJ-TYPE
 13893     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13894
 13895* EXEC CICS STARTBR
 13896*       DATASET    (FILE-ID-ERPYAJ)
 13897*       RIDFLD     (ERPYAJ-KEY)
 13898*       RESP       (WS-RESPONSE)
 13899*    END-EXEC
 13900     MOVE 0
 13901       TO DFHEIV11
 13902*    MOVE '&,         G          &  N#00012547' TO DFHEIV0
 13903     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13904     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13905     MOVE X'204E233030303132353437' TO DFHEIV0(25:11)
 13906     CALL 'kxdfhei1' USING DFHEIV0,
 13907           FILE-ID-ERPYAJ,
 13908           ERPYAJ-KEY,
 13909           DFHEIV99,
 13910           DFHEIV11,
 13911           DFHEIV99
 13912     MOVE EIBRESP  TO WS-RESPONSE
 13913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13914     IF RESP-NORMAL
 13915        CONTINUE
 13916     ELSE
 13917        GO TO 1900-EXIT
 13918     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 253
* EL6311.cbl
 13919     .
 13920 1900-READNEXT-ERPYAJ-D.
 13921*  GET THE DEALER ERPYAJ RECORD
 13922
 13923* EXEC CICS READNEXT
 13924*       DATASET    (FILE-ID-ERPYAJ)
 13925*       RIDFLD     (ERPYAJ-KEY)
 13926*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13927*       RESP       (WS-RESPONSE)
 13928*    END-EXEC
 13929     MOVE 0
 13930       TO DFHEIV11
 13931*    MOVE '&.S                   )  N#00012560' TO DFHEIV0
 13932     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13933     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13934     MOVE X'204E233030303132353630' TO DFHEIV0(25:11)
 13935     CALL 'kxdfhei1' USING DFHEIV0,
 13936           FILE-ID-ERPYAJ,
 13937           DFHEIV20,
 13938           DFHEIV99,
 13939           ERPYAJ-KEY,
 13940           DFHEIV99,
 13941           DFHEIV11,
 13942           DFHEIV99,
 13943           DFHEIV99
 13944     SET ADDRESS OF PENDING-PAY-ADJ TO
 13945         DFHEIV20
 13946     MOVE EIBRESP  TO WS-RESPONSE
 13947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13948     IF RESP-NORMAL
 13949        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13950           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13951              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13952                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13953
 13954* EXEC CICS READ
 13955*                   DATASET    (FILE-ID-ERPYAJ)
 13956*                   RIDFLD     (ERPYAJ-KEY)
 13957*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13958*                   RESP       (WS-RESPONSE)
 13959*                   UPDATE
 13960*                END-EXEC
 13961*    MOVE '&"S        EU         (  N#00012571' TO DFHEIV0
 13962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13963     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13964     MOVE X'204E233030303132353731' TO DFHEIV0(25:11)
 13965     CALL 'kxdfhei1' USING DFHEIV0,
 13966           FILE-ID-ERPYAJ,
 13967           DFHEIV20,
 13968           DFHEIV99,
 13969           ERPYAJ-KEY,
 13970           DFHEIV99,
 13971           DFHEIV99,
 13972           DFHEIV99
 13973     SET ADDRESS OF PENDING-PAY-ADJ TO
 13974         DFHEIV20
 13975     MOVE EIBRESP  TO WS-RESPONSE
 13976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 254
* EL6311.cbl
 13977                 IF RESP-NORMAL
 13978
 13979* EXEC CICS DELETE
 13980*                      DATASET   (FILE-ID-ERPYAJ)
 13981*                      RESP      (WS-RESPONSE)
 13982*                   END-EXEC
 13983*    MOVE '&(                    &  N#00012579' TO DFHEIV0
 13984     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13985     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13986     MOVE X'204E233030303132353739' TO DFHEIV0(25:11)
 13987     CALL 'kxdfhei1' USING DFHEIV0,
 13988           FILE-ID-ERPYAJ,
 13989           DFHEIV99,
 13990           DFHEIV99,
 13991           DFHEIV99,
 13992           DFHEIV99
 13993     MOVE EIBRESP  TO WS-RESPONSE
 13994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13995                 END-IF
 13996              ELSE
 13997                 SET REVERSAL    TO TRUE
 13998              END-IF
 13999           ELSE
 14000              GO TO 1900-READNEXT-ERPYAJ-D
 14001           END-IF
 14002        END-IF
 14003
 14004* EXEC CICS ENDBR
 14005*          DATASET   (FILE-ID-ERPYAJ)
 14006*       END-EXEC
 14007     MOVE 0
 14008       TO DFHEIV11
 14009*    MOVE '&2                    $   #00012591' TO DFHEIV0
 14010     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14011     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14012     MOVE X'2020233030303132353931' TO DFHEIV0(25:11)
 14013     CALL 'kxdfhei1' USING DFHEIV0,
 14014           FILE-ID-ERPYAJ,
 14015           DFHEIV11,
 14016           DFHEIV99
 14017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14018     END-IF
 14019     .
 14020 1900-EXIT.
 14021     EXIT.
 14022******************************************************************
 14023*            C A N C E L   M A I N L I N E                       *
 14024******************************************************************
 14025
 14026 2000-CANCEL-MAINLINE.
 14027     IF PI-DISPLAY-ORIGINAL-BATCH
 14028        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14029           MOVE ER-0023             TO EMI-ERROR
 14030           MOVE -1                  TO CMAINTL
 14031           MOVE AL-UABON            TO CMAINTA
 14032           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14033           GO TO 8200-SEND-DATAONLY
 14034        ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 255
* EL6311.cbl
 14035           NEXT SENTENCE
 14036     ELSE
 14037        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14038           MOVE ER-0023             TO EMI-ERROR
 14039           MOVE -1                  TO CMAINTL
 14040           MOVE AL-UABON            TO CMAINTA
 14041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14042           GO TO 8200-SEND-DATAONLY.
 14043
 14044     IF CMAINTI = 'S'
 14045        GO TO 2100-SHOW-REQUEST.
 14046
 14047     IF NOT MODIFY-CAP
 14048         MOVE 'UPDATE'       TO SM-READ
 14049         PERFORM 9995-SECURITY-VIOLATION
 14050         MOVE ER-0070        TO EMI-ERROR
 14051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14052         GO TO 8100-SEND-INITIAL-MAP.
 14053
 14054     IF CMAINTL GREATER THAN ZEROS
 14055        IF PI-PF6-FUNCTION
 14056           IF CMAINTI NOT = 'A'
 14057              MOVE AL-UABON  TO CMAINTA
 14058              MOVE -1        TO CMAINTL
 14059              MOVE ER-2260   TO EMI-ERROR
 14060              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14061              GO TO 8200-SEND-DATAONLY.
 14062
 14063     IF CCERTNOL = ZEROS
 14064       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14065         NEXT SENTENCE
 14066     ELSE
 14067         IF CCERTNOL NOT = ZEROS
 14068             MOVE AL-UANON       TO CCERTNOA
 14069         ELSE
 14070             MOVE -1             TO CCERTNOL
 14071             MOVE  1             TO SET-CURSOR-SW
 14072             MOVE ER-2218       TO EMI-ERROR
 14073             MOVE AL-UABON       TO CCERTNOA
 14074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14075
 14076     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14077        NEXT SENTENCE
 14078     ELSE
 14079        IF CEFFDTL NOT = ZEROS
 14080           MOVE AL-UNNON         TO CEFFDTA
 14081           MOVE CEFFDTI TO DEEDIT-FIELD
 14082           PERFORM 8600-DEEDIT
 14083           MOVE 4                TO DC-OPTION-CODE
 14084           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14085           PERFORM 9700-DATE-LINK
 14086           IF NO-CONVERSION-ERROR
 14087              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14088              ELSE
 14089              MOVE -1            TO CEFFDTL
 14090              MOVE  1            TO SET-CURSOR-SW
 14091              MOVE ER-2226      TO EMI-ERROR
 14092              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 256
* EL6311.cbl
 14093              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14094          ELSE
 14095          MOVE -1                 TO CEFFDTL
 14096          MOVE  1                 TO SET-CURSOR-SW
 14097          MOVE ER-2220            TO EMI-ERROR
 14098          MOVE AL-UNBON           TO CEFFDTA
 14099          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14100
 14101     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14102
 14103     IF CCERTNOL NOT = ZEROS
 14104        MOVE CCERTNOI                TO WS-NEW-PRIME
 14105     ELSE
 14106        MOVE SPACES                  TO WS-NEW-PRIME.
 14107
 14108     IF CSUFIXL NOT = ZEROS
 14109        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14110     ELSE
 14111        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14112
 14113     IF CEFFDTL NOT = ZEROS
 14114        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14115     ELSE
 14116        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14117
 14118     IF CMAINTI = 'A' OR 'K' OR 'S'
 14119        NEXT SENTENCE
 14120     ELSE
 14121        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14122        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14123           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14124           WS-PB-RECORD-TYPE NOT = '2'
 14125           IF CMAINTI = 'C'
 14126              MOVE ER-2287          TO EMI-ERROR
 14127              MOVE -1               TO CCERTNOL
 14128              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14129              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14130              GO TO 8200-SEND-DATAONLY
 14131             ELSE
 14132              MOVE ER-2260          TO EMI-ERROR
 14133              MOVE -1               TO CCERTNOL
 14134              MOVE AL-UABON         TO CCERTNOA
 14135              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14136              GO TO 8200-SEND-DATAONLY.
 14137
 14138     IF CMAINTI = 'D'
 14139        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14140
 14141     IF CLSTNML GREATER THAN ZEROS
 14142         MOVE AL-UANON           TO CLSTNMA.
 14143
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 257
* EL6311.cbl
 14145
 14146******************************************************************
 14147*                                                                *
 14148*           E D I T   C A N C E L   C O V E R A G E S            *
 14149*                                                                *
 14150******************************************************************
 14151
 14152 2015-EDIT-COVERAGES.
 14153     IF CCANDT1L      GREATER THAN ZEROS OR
 14154        CREFND1L      GREATER THAN ZEROS OR
 14155        CCANDT2L      GREATER THAN ZEROS OR
 14156        CREFND2L      GREATER THAN ZEROS OR
 14157        CMTHD1L       GREATER THAN ZEROS OR
 14158        CMTHD2L       GREATER THAN ZEROS OR
 14159        CLIVESL       GREATER THAN ZEROS OR
 14160        CPAYEEL       GREATER THAN ZEROS OR
 14161        CFORCEL       GREATER THAN ZEROS OR
 14162        CBILCDL       GREATER THAN ZEROS OR
 14163        CCANREAL      GREATER THAN ZEROS
 14164            NEXT SENTENCE
 14165         ELSE
 14166            GO TO 2030-EDIT-COMPLETE.
 14167
 14168     IF CCANDT1L = ZEROS
 14169        AND (CMAINTI = 'C' OR 'K')
 14170        NEXT SENTENCE
 14171     ELSE
 14172        IF CCANDT1L      GREATER THAN ZEROS
 14173            MOVE AL-UNNON            TO CCANDT1A
 14174            IF CCANDT1I = SPACES
 14175               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14176            ELSE
 14177               MOVE CCANDT1I            TO DEEDIT-FIELD
 14178               PERFORM 8600-DEEDIT
 14179               IF DEEDIT-FIELD-V0   NUMERIC
 14180                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14181                  MOVE 4                TO DC-OPTION-CODE
 14182                  PERFORM 9700-DATE-LINK
 14183                  IF NO-CONVERSION-ERROR
 14184                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14185                  ELSE
 14186                      MOVE -1        TO CCANDT1L
 14187                      MOVE ER-2227   TO EMI-ERROR
 14188                      MOVE AL-UNBON  TO CCANDT1A
 14189                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14190               ELSE
 14191                  MOVE -1         TO CCANDT1L
 14192                  MOVE ER-2223    TO EMI-ERROR
 14193                  MOVE AL-UNBON   TO CCANDT1A
 14194                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14195        ELSE
 14196            IF CREFND1L GREATER THAN ZEROS
 14197               MOVE -1             TO CCANDT1L
 14198               MOVE ER-2222        TO EMI-ERROR
 14199               MOVE AL-UNBOF       TO CCANDT1A
 14200               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14201
 14202     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 258
* EL6311.cbl
 14203        AND (CMAINTI = 'C' OR 'K')
 14204         NEXT SENTENCE
 14205     ELSE
 14206         IF CREFND1L NOT = ZEROS
 14207            MOVE AL-UNNON        TO CREFND1A
 14208
 14209* EXEC CICS BIF DEEDIT
 14210*               FIELD  (CREFND1I)
 14211*               LENGTH (11)
 14212*           END-EXEC
 14213     MOVE 11
 14214       TO DFHEIV11
 14215*    MOVE '@"L                   #   #00012784' TO DFHEIV0
 14216     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14217     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14218     MOVE X'2020233030303132373834' TO DFHEIV0(25:11)
 14219     CALL 'kxdfhei1' USING DFHEIV0,
 14220           CREFND1I,
 14221           DFHEIV11
 14222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14223            MOVE CREFND1I        TO WS-CREFND1
 14224*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14225*           PERFORM 8600-DEEDIT
 14226*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14227            IF WS-CREFND1  = ZEROS
 14228               AND CMAINTI = 'A'
 14229             MOVE ER-2437        TO EMI-ERROR
 14230             MOVE -1             TO CREFND1L
 14231             MOVE AL-UNBON       TO CREFND1A
 14232             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14233
 14234     IF CCANREAL > +0
 14235        MOVE AL-UANON            TO CCANREAA
 14236        IF CCANREAI = 'R' OR ' '
 14237           CONTINUE
 14238        ELSE
 14239           MOVE ER-9841        TO EMI-ERROR
 14240           MOVE -1             TO CCANREAL
 14241           MOVE AL-UABON       TO CCANREAA
 14242           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14243        END-IF
 14244     END-IF
 14245     IF CMTHD1L EQUAL +0
 14246        NEXT SENTENCE
 14247     ELSE
 14248        IF CMTHD1L NOT = +0
 14249           MOVE AL-UNNON        TO CMTHD1A
 14250           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14251                         OR '5' OR '6' OR '8' OR '9'
 14252                         OR 'R' OR ' '
 14253              NEXT SENTENCE
 14254           ELSE
 14255              MOVE ER-0582        TO EMI-ERROR
 14256              MOVE -1             TO CMTHD1L
 14257              MOVE AL-UNBON       TO CMTHD1A
 14258              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14259
 14260     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 259
* EL6311.cbl
 14261        AND (CMAINTI = 'C' OR 'K')
 14262         NEXT SENTENCE
 14263     ELSE
 14264         IF CCANDT2L  GREATER THAN ZEROS
 14265             MOVE AL-UNNON       TO CCANDT2A
 14266             IF CCANDT2I = SPACES
 14267                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14268             ELSE
 14269                MOVE CCANDT2I       TO DEEDIT-FIELD
 14270                PERFORM 8600-DEEDIT
 14271                IF DEEDIT-FIELD-V0   NUMERIC
 14272                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14273                   MOVE 4                TO DC-OPTION-CODE
 14274                   PERFORM 9700-DATE-LINK
 14275                   IF NO-CONVERSION-ERROR
 14276                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14277                   ELSE
 14278                      MOVE -1       TO CCANDT2L
 14279                      MOVE ER-2227  TO EMI-ERROR
 14280                      MOVE AL-UNBON TO CCANDT2A
 14281                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14282                ELSE
 14283                   MOVE -1         TO CCANDT2L
 14284                   MOVE ER-2223    TO EMI-ERROR
 14285                   MOVE AL-UNBON   TO CCANDT2A
 14286                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14287         ELSE
 14288            IF CREFND2L GREATER THAN ZEROS
 14289               MOVE -1             TO CCANDT2L
 14290               MOVE ER-2222        TO EMI-ERROR
 14291               MOVE AL-UNBOF       TO CCANDT2A
 14292               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14293
 14294     IF CREFND2L = ZEROS
 14295        AND (CMAINTI = 'C' OR 'K')
 14296         NEXT SENTENCE
 14297     ELSE
 14298         IF CREFND2L NOT = ZEROS
 14299            MOVE AL-UNNON        TO CREFND2A
 14300
 14301* EXEC CICS BIF DEEDIT
 14302*               FIELD  (CREFND2I)
 14303*               LENGTH (11)
 14304*           END-EXEC
 14305     MOVE 11
 14306       TO DFHEIV11
 14307*    MOVE '@"L                   #   #00012865' TO DFHEIV0
 14308     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14309     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14310     MOVE X'2020233030303132383635' TO DFHEIV0(25:11)
 14311     CALL 'kxdfhei1' USING DFHEIV0,
 14312           CREFND2I,
 14313           DFHEIV11
 14314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14315            MOVE CREFND2I        TO WS-CREFND2
 14316*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14317*           PERFORM 8600-DEEDIT
 14318*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 260
* EL6311.cbl
 14319            IF WS-CREFND2  = ZEROS
 14320               AND CMAINTI = 'A'
 14321             MOVE ER-2437        TO EMI-ERROR
 14322             MOVE -1             TO CREFND2L
 14323             MOVE AL-UNBON       TO CREFND2A
 14324             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14325
 14326     IF CMTHD2L EQUAL +0
 14327        NEXT SENTENCE
 14328     ELSE
 14329        IF CMTHD2L NOT = +0
 14330           MOVE AL-UNNON        TO CMTHD2A
 14331           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14332                         OR '5' OR '6' OR '8' OR '9'
 14333                         OR ' ' OR 'R'
 14334              NEXT SENTENCE
 14335           ELSE
 14336              MOVE ER-0582        TO EMI-ERROR
 14337              MOVE -1             TO CMTHD2L
 14338              MOVE AL-UNBON       TO CMTHD2A
 14339              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14340
 14341     IF CLIVESL GREATER THAN ZEROS
 14342         MOVE CLIVESI            TO DEEDIT-FIELD
 14343         PERFORM 8600-DEEDIT
 14344         IF DEEDIT-FIELD-V0 NUMERIC
 14345             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14346             MOVE AL-UNNON       TO CLIVESA
 14347         ELSE
 14348             MOVE -1             TO CLIVESL
 14349             MOVE AL-UNBON       TO CLIVESA
 14350             MOVE ER-2223        TO EMI-ERROR
 14351             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14352
 14353     IF CFORCEL  NOT = ZEROS
 14354         IF FORCE-CAP
 14355            MOVE AL-UANON            TO CFORCEA
 14356         ELSE
 14357            MOVE ER-2945             TO EMI-ERROR
 14358            MOVE AL-UABON            TO CFORCEA
 14359            MOVE -1                  TO CFORCEL
 14360            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14361
 14362     IF CPAYEEL GREATER THAN ZEROS
 14363        MOVE AL-UANON            TO CPAYEEA.
 14364
 14365     IF CBILCDL NOT = ZEROS
 14366        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14367                             AND 'A' AND 'B' AND 'E'
 14368           MOVE ER-2225              TO EMI-ERROR
 14369           MOVE AL-UABON             TO CBILCDA
 14370           MOVE -1                   TO CBILCDL
 14371           MOVE  1                   TO SET-CURSOR-SW
 14372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14373        ELSE
 14374           MOVE AL-UANON             TO CBILCDA.
 14375
 14376 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 261
* EL6311.cbl
 14377     IF EMI-ERROR = ZEROS
 14378         NEXT SENTENCE
 14379     ELSE
 14380         GO TO 8200-SEND-DATAONLY.
 14381
 14382     IF CMAINTI = 'A'
 14383        GO TO 2200-ADD-CANCEL-ROUTINE.
 14384
 14385     IF CMAINTI = 'C'
 14386        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14387
 14388     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14389
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 262
* EL6311.cbl
 14391
 14392******************************************************************
 14393*                                                                *
 14394*                   S H O W   C A N C E L                        *
 14395*                                                                *
 14396******************************************************************
 14397
 14398 2100-SHOW-REQUEST.
 14399     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14400
 14401     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14402        MOVE -1                  TO CMAINTL
 14403        GO TO 8200-SEND-DATAONLY.
 14404
 14405     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14406
 14407     IF CSUFIXL NOT = ZEROS
 14408        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14409       ELSE
 14410        MOVE SPACE            TO WS-NEW-SUFFIX.
 14411
 14412     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14413     PERFORM 8600-DEEDIT.
 14414     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14415     MOVE '4'                    TO DC-OPTION-CODE.
 14416     PERFORM 9700-DATE-LINK.
 14417     IF DATE-CONVERSION-ERROR
 14418        MOVE ER-0348             TO EMI-ERROR
 14419        MOVE -1                  TO CEFFDTL
 14420        MOVE AL-UABON            TO CEFFDTA
 14421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14422        GO TO 8200-SEND-DATAONLY
 14423     ELSE
 14424        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14425        MOVE AL-UANON            TO CEFFDTA
 14426        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14427
 14428     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14429
 14430     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14431        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14432        MOVE 'Y'                    TO WS-SHOW-SW
 14433        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14434           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14435        ELSE
 14436           IF PI-FILE-BROWSE
 14437              GO TO 4300-BROWSE-FILE-FORWARD
 14438           ELSE
 14439              IF PI-CSR-BROWSE
 14440                 GO TO 4200-BROWSE-CSR-FORWARD
 14441              ELSE
 14442                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14443     ELSE
 14444        GO TO 3900-RE-DISPLAY-RECORD.
 14445
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 263
* EL6311.cbl
 14447
 14448
 14449******************************************************************
 14450*                                                                *
 14451*            A D D   C A N C E L   R O U T I N E                 *
 14452*                                                                *
 14453******************************************************************
 14454
 14455 2200-ADD-CANCEL-ROUTINE.
 14456     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14457
 14458
 14459* EXEC CICS GETMAIN
 14460*        SET     (ADDRESS OF PENDING-BUSINESS)
 14461*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14462*    END-EXEC.
 14463*    MOVE '," L                  $   #00013012' TO DFHEIV0
 14464     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14466     MOVE X'2020233030303133303132' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0,
 14468           DFHEIV20,
 14469           ERPNDB-RECORD-LENGTH,
 14470           DFHEIV99
 14471     SET ADDRESS OF PENDING-BUSINESS TO
 14472         DFHEIV20
 14473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14474
 14475
 14476
 14477* EXEC CICS HANDLE CONDITION
 14478*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14479*    END-EXEC.
 14480*    MOVE '"$I                   ! 3 #00013017' TO DFHEIV0
 14481     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14482     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14483     MOVE X'3320233030303133303137' TO DFHEIV0(25:11)
 14484     CALL 'kxdfhei1' USING DFHEIV0
 14485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14486
 14487
 14488     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14489     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14490     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14491
 14492
 14493* EXEC CICS READ
 14494*        INTO    (PENDING-BUSINESS)
 14495*        DATASET (FILE-ID-ERPNDB)
 14496*        RIDFLD  (ERPNDB-KEY)
 14497*    END-EXEC.
 14498     MOVE LENGTH OF
 14499      PENDING-BUSINESS
 14500       TO DFHEIV11
 14501*    MOVE '&"IL       E          (   #00013025' TO DFHEIV0
 14502     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14504     MOVE X'2020233030303133303235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 264
* EL6311.cbl
 14505     CALL 'kxdfhei1' USING DFHEIV0,
 14506           FILE-ID-ERPNDB,
 14507           PENDING-BUSINESS,
 14508           DFHEIV11,
 14509           ERPNDB-KEY,
 14510           DFHEIV99,
 14511           DFHEIV99,
 14512           DFHEIV99
 14513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14514
 14515
 14516     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14517
 14518     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14519     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14520     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14521     MOVE SPACES                 TO PENDING-BUSINESS.
 14522     MOVE 'PB'                   TO PB-RECORD-ID.
 14523     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14524     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14525     MOVE SPACES                 TO PB-CERT-SFX.
 14526     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14527     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14528                                    PB-ALT-CHG-SEQ-NO.
 14529
 14530     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14531     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14532     MOVE '2'                    TO PB-RECORD-TYPE.
 14533
 14534     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14535     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14536
 14537
 14538     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14539                                    PB-ALT-CHG-SEQ-NO
 14540                                    PB-C-LF-REF-CALC
 14541                                    PB-C-AH-REF-CALC
 14542                                    PB-C-LF-RFND-CLP
 14543                                    PB-C-AH-RFND-CLP
 14544                                    PB-CI-INSURED-AGE
 14545                                    PB-CI-LF-TERM
 14546                                    PB-CI-AH-TERM
 14547                                    PB-CI-LF-BENEFIT-CD
 14548                                    PB-CI-LF-BENEFIT-AMT
 14549                                    PB-CI-LF-ALT-BENEFIT-AMT
 14550                                    PB-CI-LF-PREMIUM-AMT
 14551                                    PB-CI-LF-ALT-PREMIUM-AMT
 14552                                    PB-CI-AH-BENEFIT-CD
 14553                                    PB-CI-AH-BENEFIT-AMT
 14554                                    PB-CI-AH-PREMIUM-AMT
 14555                                    PB-CI-PAY-FREQUENCY
 14556                                    PB-CI-LOAN-APR
 14557                                    PB-CI-LOAN-TERM
 14558                                    PB-CI-LIFE-COMMISSION
 14559                                    PB-CI-AH-COMMISSION
 14560                                    PB-CI-CURR-SEQ
 14561                                    PB-CI-AH-CANCEL-AMT
 14562                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 265
* EL6311.cbl
 14563                                    PB-CI-RATE-DEV-PCT-LF
 14564                                    PB-CI-RATE-DEV-PCT-AH
 14565                                    PB-CI-EXTENTION-DAYS
 14566                                    PB-CI-TERM-IN-DAYS
 14567                                    PB-CI-LIVES
 14568                                    PB-CI-LF-CRIT-PER
 14569                                    PB-CI-AH-CRIT-PER
 14570                                    PB-C-LF-REM-TERM
 14571                                    PB-C-AH-REM-TERM
 14572                                    PB-CHG-COUNT
 14573                                    PB-LF-BILLED-AMTS
 14574                                    PB-AH-BILLED-AMTS
 14575                                    PB-C-NH-INT-ON-REFS
 14576*                                   PB-C-MICROFILM-NO
 14577                                    PB-CALC-TOLERANCE.
 14578
 14579     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14580                                    PB-CI-AH-SETTLEMENT-DT
 14581                                    PB-CI-DEATH-DT
 14582                                    PB-CI-LF-PRIOR-CANCEL-DT
 14583                                    PB-CI-AH-PRIOR-CANCEL-DT
 14584                                    PB-CI-ENTRY-DT
 14585                                    PB-CI-LF-EXPIRE-DT
 14586                                    PB-CI-AH-EXPIRE-DT
 14587                                    PB-CI-LOAN-1ST-PMT-DT
 14588                                    PB-C-LF-CANCEL-DT
 14589                                    PB-C-AH-CANCEL-DT
 14590                                    PB-CREDIT-ACCEPT-DT
 14591                                    PB-BILLED-DT
 14592                                    PB-ACCT-EFF-DT
 14593                                    PB-ACCT-EXP-DT.
 14594
 14595     MOVE 'X'                    TO PB-FATAL-FLAG.
 14596
 14597     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14598
 14599     IF CSUFIXL     GREATER THAN ZEROS
 14600        MOVE CSUFIXI             TO PB-CERT-SFX.
 14601
 14602*    IF CMICRNOL  GREATER  ZEROS
 14603*        IF CMICRNOI  NUMERIC
 14604*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14605*            MOVE AL-UNNON       TO  CMICRNOA
 14606*        ELSE
 14607*            MOVE -1             TO  CMICRNOL
 14608*            MOVE AL-UNBON       TO  CMICRNOA
 14609*            MOVE ER-2701        TO  EMI-ERROR
 14610*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14611
 14612     IF CLSTNML     GREATER THAN ZEROS
 14613        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14614
 14615     IF CCANREAL > ZEROS
 14616        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14617     END-IF
 14618     IF CPCYNL > ZEROS
 14619        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14620     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 266
* EL6311.cbl
 14621     IF CCANDT1L    GREATER THAN ZEROS
 14622        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14623
 14624     IF CCANDT2L    GREATER THAN ZEROS
 14625        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14626
 14627     IF CMTHD1L    GREATER THAN +0
 14628        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14629
 14630     IF CMTHD2L    GREATER THAN +0
 14631        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14632
 14633     IF CREFND1L    GREATER THAN ZEROS
 14634        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14635        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14636     ELSE
 14637        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14638
 14639     IF CREFND2L    GREATER THAN ZEROS
 14640        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14641        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14642     ELSE
 14643        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14644
 14645     IF CLIVESL     GREATER THAN ZEROS
 14646        MOVE WS-CLIVES           TO PB-C-LIVES
 14647     ELSE
 14648        MOVE ZEROS               TO PB-C-LIVES.
 14649
 14650     IF CPAYEEL     GREATER THAN ZEROS
 14651        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14652
 14653     IF CFORCEL     GREATER THAN ZEROS
 14654        MOVE CFORCEI             TO PB-FORCE-CODE.
 14655
 14656     IF CBILCDL     GREATER THAN ZEROS
 14657        MOVE CBILCDI             TO PB-RECORD-BILL.
 14658
 14659*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14660
 14661 2260-WRITE-PB-RECORD.
 14662     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14663                                    PB-INPUT-BY.
 14664     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14665     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14666                                    PB-INPUT-DT.
 14667
 14668     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14669     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14670                                    PB-CONTROL-BY-ORIG-BATCH.
 14671
 14672     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14673     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14674     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14675     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14676     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14677
 14678     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 267
* EL6311.cbl
 14679
 14680     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14681
 14682     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14683     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14684     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14685
 14686     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14687     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14688
 14689 2275-WRITE-PENDING-BUSINESS.
 14690     MOVE 'A'                    TO JP-RECORD-TYPE.
 14691     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14692     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14693     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14694
 14695
 14696* EXEC CICS HANDLE CONDITION
 14697*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14698*    END-EXEC.
 14699*    MOVE '"$%                   ! 4 #00013210' TO DFHEIV0
 14700     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14702     MOVE X'3420233030303133323130' TO DFHEIV0(25:11)
 14703     CALL 'kxdfhei1' USING DFHEIV0
 14704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14705
 14706
 14707
 14708* EXEC CICS WRITE
 14709*        DATASET (FILE-ID-ERPNDB)
 14710*        FROM    (PENDING-BUSINESS)
 14711*        RIDFLD  (PB-CONTROL-PRIMARY)
 14712*    END-EXEC.
 14713     MOVE LENGTH OF
 14714      PENDING-BUSINESS
 14715       TO DFHEIV11
 14716*    MOVE '&$ L                  ''   #00013214' TO DFHEIV0
 14717     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14719     MOVE X'2020233030303133323134' TO DFHEIV0(25:11)
 14720     CALL 'kxdfhei1' USING DFHEIV0,
 14721           FILE-ID-ERPNDB,
 14722           PENDING-BUSINESS,
 14723           DFHEIV11,
 14724           PB-CONTROL-PRIMARY,
 14725           DFHEIV99,
 14726           DFHEIV99
 14727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14728
 14729
 14730     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14731
 14732     PERFORM 8400-LOG-JOURNAL-RECORD.
 14733
 14734******************************************************************
 14735*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14736******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 268
* EL6311.cbl
 14737
 14738     display ' made it to add orig CANCEL cert '
 14739     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14740     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14741     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14742     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14743
 14744
 14745* EXEC CICS READ
 14746*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14747*        DATASET (FILE-ID-ELCERT)
 14748*        RIDFLD  (ELCERT-KEY)
 14749*        RESP    (WS-RESPONSE)
 14750*    END-EXEC.
 14751*    MOVE '&"S        E          (  N#00013234' TO DFHEIV0
 14752     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14754     MOVE X'204E233030303133323334' TO DFHEIV0(25:11)
 14755     CALL 'kxdfhei1' USING DFHEIV0,
 14756           FILE-ID-ELCERT,
 14757           DFHEIV20,
 14758           DFHEIV99,
 14759           ELCERT-KEY,
 14760           DFHEIV99,
 14761           DFHEIV99,
 14762           DFHEIV99
 14763     SET ADDRESS OF CERTIFICATE-MASTER TO
 14764         DFHEIV20
 14765     MOVE EIBRESP  TO WS-RESPONSE
 14766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14767
 14768
 14769     IF NOT RESP-NORMAL
 14770        GO TO 2276-BYPASS-CRTO
 14771     END-IF
 14772
 14773     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14774     MOVE ' '                    TO WS-ERMAIL-SW
 14775
 14776
 14777* EXEC CICS READ
 14778*       DATASET   (FILE-ID-ERMAIL)
 14779*       SET       (ADDRESS OF MAILING-DATA)
 14780*       RIDFLD    (ERMAIL-KEY)
 14781*       RESP      (WS-RESPONSE)
 14782*    END-EXEC
 14783*    MOVE '&"S        E          (  N#00013248' TO DFHEIV0
 14784     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14785     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14786     MOVE X'204E233030303133323438' TO DFHEIV0(25:11)
 14787     CALL 'kxdfhei1' USING DFHEIV0,
 14788           FILE-ID-ERMAIL,
 14789           DFHEIV20,
 14790           DFHEIV99,
 14791           ERMAIL-KEY,
 14792           DFHEIV99,
 14793           DFHEIV99,
 14794           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 269
* EL6311.cbl
 14795     SET ADDRESS OF MAILING-DATA TO
 14796         DFHEIV20
 14797     MOVE EIBRESP  TO WS-RESPONSE
 14798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14799
 14800     IF RESP-NORMAL
 14801        SET ERMAIL-FOUND TO TRUE
 14802     END-IF
 14803
 14804     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14805
 14806     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14807     MOVE 'OC'                   TO OC-RECORD-ID
 14808     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14809                                 TO OC-CONTROL-PRIMARY (1:33)
 14810     MOVE 'I'                    TO OC-RECORD-TYPE
 14811     MOVE +4096                  TO OC-KEY-SEQ-NO
 14812     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14813     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14814     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14815
 14816     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14817     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14818     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14819     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14820     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14821     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14822     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14823     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14824     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14825     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14826     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14827     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14828     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14829     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14830     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14831     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14832     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14833     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14834     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14835     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14836     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14837     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14838     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14839     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14840     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14841     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14842     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14843     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14844     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14845     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14846     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14847     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14848
 14849     IF ERMAIL-FOUND
 14850        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14851     END-IF
 14852     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 270
* EL6311.cbl
 14853        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14854                           OC-INS-AGE-DEFAULT-FLAG
 14855        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14856                           OC-JNT-AGE-DEFAULT-FLAG
 14857     END-IF
 14858     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14859     .
 14860 2275-WRITE-ELCRTO.
 14861
 14862
 14863* EXEC CICS WRITE
 14864*       DATASET   ('ELCRTO')
 14865*       FROM      (ORIGINAL-CERTIFICATE)
 14866*       RIDFLD    (OC-CONTROL-PRIMARY)
 14867*       RESP      (WS-RESPONSE)
 14868*    END-EXEC
 14869     MOVE LENGTH OF
 14870      ORIGINAL-CERTIFICATE
 14871       TO DFHEIV11
 14872     MOVE 'ELCRTO' TO DFHEIV1
 14873*    MOVE '&$ L                  ''  N#00013317' TO DFHEIV0
 14874     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14875     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14876     MOVE X'204E233030303133333137' TO DFHEIV0(25:11)
 14877     CALL 'kxdfhei1' USING DFHEIV0,
 14878           DFHEIV1,
 14879           ORIGINAL-CERTIFICATE,
 14880           DFHEIV11,
 14881           OC-CONTROL-PRIMARY,
 14882           DFHEIV99,
 14883           DFHEIV99
 14884     MOVE EIBRESP  TO WS-RESPONSE
 14885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14886
 14887     display ' just wrote 2275 ' ws-response
 14888     IF RESP-DUPKEY
 14889        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14890        GO TO 2275-WRITE-ELCRTO
 14891     ELSE
 14892        IF NOT RESP-NORMAL
 14893           MOVE -1               TO BMAINTL
 14894           MOVE ER-7450          TO EMI-ERROR
 14895           PERFORM 9900-ERROR-FORMAT
 14896                                 THRU 9900-EXIT
 14897           GO TO 8200-SEND-DATAONLY
 14898        END-IF
 14899     END-IF.
 14900
 14901 2276-BYPASS-CRTO.
 14902******************************************************************
 14903*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14904******************************************************************
 14905
 14906
 14907* EXEC CICS READ
 14908*        INTO    (PENDING-BUSINESS)
 14909*        DATASET (FILE-ID-ERPNDB)
 14910*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 271
* EL6311.cbl
 14911*        UPDATE
 14912*    END-EXEC.
 14913     MOVE LENGTH OF
 14914      PENDING-BUSINESS
 14915       TO DFHEIV11
 14916*    MOVE '&"IL       EU         (   #00013343' TO DFHEIV0
 14917     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14918     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14919     MOVE X'2020233030303133333433' TO DFHEIV0(25:11)
 14920     CALL 'kxdfhei1' USING DFHEIV0,
 14921           FILE-ID-ERPNDB,
 14922           PENDING-BUSINESS,
 14923           DFHEIV11,
 14924           ERPNDB-KEY,
 14925           DFHEIV99,
 14926           DFHEIV99,
 14927           DFHEIV99
 14928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14929
 14930
 14931     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14932     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14933     MOVE 'B'                    TO JP-RECORD-TYPE.
 14934     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14935
 14936     PERFORM 8400-LOG-JOURNAL-RECORD.
 14937
 14938     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14939
 14940
 14941* EXEC CICS REWRITE
 14942*        DATASET (FILE-ID-ERPNDB)
 14943*        FROM    (PENDING-BUSINESS)
 14944*    END-EXEC.
 14945     MOVE LENGTH OF
 14946      PENDING-BUSINESS
 14947       TO DFHEIV11
 14948*    MOVE '&& L                  %   #00013359' TO DFHEIV0
 14949     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14950     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14951     MOVE X'2020233030303133333539' TO DFHEIV0(25:11)
 14952     CALL 'kxdfhei1' USING DFHEIV0,
 14953           FILE-ID-ERPNDB,
 14954           PENDING-BUSINESS,
 14955           DFHEIV11,
 14956           DFHEIV99
 14957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14958
 14959
 14960     MOVE 'C'                    TO JP-RECORD-TYPE.
 14961     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14962
 14963     PERFORM 8400-LOG-JOURNAL-RECORD.
 14964
 14965     IF WS-ERRORS-PRESENT
 14966        GO TO 3900-RE-DISPLAY-RECORD.
 14967
 14968     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 272
* EL6311.cbl
 14969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14970     MOVE LOW-VALUES             TO EL631CI.
 14971     MOVE  -1                    TO CMAINTL.
 14972     GO TO 8100-SEND-INITIAL-MAP.
 14973
 14974 2280-BATCH-HDR-NOT-FOUND.
 14975     MOVE -1                     TO BMAINTL.
 14976     MOVE ER-7450                TO EMI-ERROR.
 14977     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14978     GO TO 8200-SEND-DATAONLY.
 14979
 14980 2290-DUPLICATE-ALT-INDEX.
 14981
 14982******************************************************************
 14983*                                                                *
 14984*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14985*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14986*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14987*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14988*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14989*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14990*                                                                *
 14991******************************************************************
 14992
 14993     IF LCP-ONCTR-02 =  0
 14994         ADD 1 TO LCP-ONCTR-02
 14995        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14996
 14997     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14998
 14999     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15000         NEXT SENTENCE
 15001     ELSE
 15002         ADD +1 TO PB-BATCH-SEQ-NO
 15003                   PB-CSR-BATCH-SEQ-NO
 15004         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15005         GO TO 2275-WRITE-PENDING-BUSINESS.
 15006
 15007     MOVE -1                     TO CCERTNOL.
 15008     MOVE AL-UABON               TO CCERTNOA.
 15009     MOVE AL-UNBON               TO CEFFDTA.
 15010
 15011     MOVE 1                      TO EMI-SUB
 15012                                    EMI-SWITCH1
 15013                                    EMI-SWITCH-AREA-1
 15014                                    EMI-SWITCH-AREA-2.
 15015
 15016     MOVE SPACES                 TO EMI-ERROR-LINES.
 15017
 15018
 15019* EXEC CICS SYNCPOINT ROLLBACK
 15020*    END-EXEC.
 15021*    MOVE '6"R                   !   #00013422' TO DFHEIV0
 15022     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15024     MOVE X'2020233030303133343232' TO DFHEIV0(25:11)
 15025     CALL 'kxdfhei1' USING DFHEIV0
 15026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 273
* EL6311.cbl
 15027
 15028
 15029     MOVE ER-2247                TO EMI-ERROR.
 15030     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15031     GO TO 8200-SEND-DATAONLY.
 15032
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 274
* EL6311.cbl
 15034
 15035******************************************************************
 15036*                                                                *
 15037*          C H A N G E   C A N C E L   R O U T I N E             *
 15038*                                                                *
 15039******************************************************************
 15040
 15041***************************************************************
 15042*                                                             *
 15043*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15044*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15045*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15046*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15047*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15048*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15049*     5. LINK TO THE EDIT ROUTINE.                            *
 15050*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15051*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15052*              THE EDIT ROUTINE.                              *
 15053*     7. REWRITE THE NEW ISSUE                                *
 15054*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15055*                                                             *
 15056***************************************************************
 15057 2300-CHANGE-CANCEL-ROUTINE.
 15058     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15059
 15060     IF CCHGL NOT = ZEROS
 15061        MOVE ER-2196             TO EMI-ERROR
 15062        MOVE AL-UABON            TO CMAINTA
 15063        MOVE -1                  TO CMAINTL
 15064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15065        GO TO 8200-SEND-DATAONLY.
 15066
 15067     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15068
 15069     IF CSUFIXL NOT = ZEROS
 15070        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15071     ELSE
 15072        MOVE SPACE               TO WS-NEW-SUFFIX.
 15073
 15074     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15075     PERFORM 8600-DEEDIT.
 15076     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15077     MOVE '4'                    TO DC-OPTION-CODE.
 15078
 15079     PERFORM 9700-DATE-LINK.
 15080
 15081     IF DATE-CONVERSION-ERROR
 15082        MOVE ER-0348             TO EMI-ERROR
 15083        MOVE -1                  TO CEFFDTL
 15084        MOVE AL-UABON            TO CEFFDTA
 15085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15086        GO TO 8200-SEND-DATAONLY
 15087     ELSE
 15088        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15089        MOVE AL-UANON            TO CEFFDTA
 15090        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15091
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 275
* EL6311.cbl
 15092 2325-PROCESS-CANCEL-CHANGES.
 15093
 15094* EXEC CICS HANDLE CONDITION
 15095*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15096*    END-EXEC.
 15097*    MOVE '"$I                   ! 5 #00013489' TO DFHEIV0
 15098     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15100     MOVE X'3520233030303133343839' TO DFHEIV0(25:11)
 15101     CALL 'kxdfhei1' USING DFHEIV0
 15102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15103
 15104
 15105     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15106     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15107     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15108
 15109
 15110* EXEC CICS GETMAIN
 15111*        SET      (ADDRESS OF PENDING-BUSINESS)
 15112*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15113*        INITIMG  (GETMAIN-SPACE)
 15114*     END-EXEC.
 15115*    MOVE ',"IL                  $   #00013497' TO DFHEIV0
 15116     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15117     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15118     MOVE X'2020233030303133343937' TO DFHEIV0(25:11)
 15119     CALL 'kxdfhei1' USING DFHEIV0,
 15120           DFHEIV20,
 15121           ERPNDB-RECORD-LENGTH,
 15122           GETMAIN-SPACE
 15123     SET ADDRESS OF PENDING-BUSINESS TO
 15124         DFHEIV20
 15125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15126
 15127
 15128
 15129* EXEC CICS READ
 15130*        INTO    (PENDING-BUSINESS)
 15131*        DATASET (FILE-ID-ERPNDB)
 15132*        RIDFLD  (ERPNDB-KEY)
 15133*    END-EXEC.
 15134     MOVE LENGTH OF
 15135      PENDING-BUSINESS
 15136       TO DFHEIV11
 15137*    MOVE '&"IL       E          (   #00013503' TO DFHEIV0
 15138     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15139     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15140     MOVE X'2020233030303133353033' TO DFHEIV0(25:11)
 15141     CALL 'kxdfhei1' USING DFHEIV0,
 15142           FILE-ID-ERPNDB,
 15143           PENDING-BUSINESS,
 15144           DFHEIV11,
 15145           ERPNDB-KEY,
 15146           DFHEIV99,
 15147           DFHEIV99,
 15148           DFHEIV99
 15149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 276
* EL6311.cbl
 15150
 15151
 15152     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15153
 15154
 15155* EXEC CICS HANDLE CONDITION
 15156*         NOTFND     (2385-REC-NOT-FOUND)
 15157*    END-EXEC.
 15158*    MOVE '"$I                   ! 6 #00013511' TO DFHEIV0
 15159     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15161     MOVE X'3620233030303133353131' TO DFHEIV0(25:11)
 15162     CALL 'kxdfhei1' USING DFHEIV0
 15163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15164
 15165
 15166**********************************************************
 15167*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15168*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15169**********************************************************
 15170
 15171
 15172* EXEC CICS READ
 15173*        DATASET (FILE-ID-ERPNDB)
 15174*        INTO    (PENDING-BUSINESS)
 15175*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15176*    END-EXEC.
 15177     MOVE LENGTH OF
 15178      PENDING-BUSINESS
 15179       TO DFHEIV11
 15180*    MOVE '&"IL       E          (   #00013520' TO DFHEIV0
 15181     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15183     MOVE X'2020233030303133353230' TO DFHEIV0(25:11)
 15184     CALL 'kxdfhei1' USING DFHEIV0,
 15185           FILE-ID-ERPNDB,
 15186           PENDING-BUSINESS,
 15187           DFHEIV11,
 15188           PI-PREV-CONTROL-PRIMARY,
 15189           DFHEIV99,
 15190           DFHEIV99,
 15191           DFHEIV99
 15192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15193
 15194
 15195********** DO NOT ALLOW CHANGES IF THRU A/R
 15196     IF BMAINTI = 'C'
 15197         IF PB-EL860-INTERNAL-PROCESS
 15198             MOVE ER-4005          TO EMI-ERROR
 15199             MOVE -1               TO BMAINTL
 15200             MOVE AL-UABON         TO BMAINTA
 15201             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15202             GO TO 8200-SEND-DATAONLY.
 15203**********
 15204
 15205     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15206        MOVE -1                 TO CMAINTL
 15207        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 277
* EL6311.cbl
 15208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15209        GO TO 8200-SEND-DATAONLY.
 15210
 15211     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15212        MOVE ER-2196             TO EMI-ERROR
 15213        MOVE AL-UABON            TO CMAINTA
 15214        MOVE -1                  TO CMAINTL
 15215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15216        GO TO 8200-SEND-DATAONLY.
 15217     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15218
 15219     IF PB-BILLED-DT = LOW-VALUES AND
 15220        PB-CHG-COUNT = ZEROS
 15221        NEXT SENTENCE
 15222     ELSE
 15223        IF (CREFND1L GREATER THAN ZEROS AND
 15224            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15225           OR
 15226           (CREFND2L GREATER THAN ZEROS AND
 15227            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15228           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15229     if ((crefnd1l <> zeros)
 15230        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15231                      or
 15232        ((crefnd2l <> zeros)
 15233        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15234        continue
 15235     else
 15236        go to 2330-continue-change
 15237     end-if
 15238
 15239     move ' '                    to ws-stop-sw
 15240                                    ws-check-sw
 15241                                    ws-proc-check-sw
 15242                                    ws-chek-browse-sw
 15243
 15244     perform 2500-browse-checks  thru 2500-exit
 15245
 15246     if i-have-processed-checks
 15247        or i-have-checks
 15248        continue
 15249     else
 15250        go to 2330-continue-change
 15251     end-if
 15252
 15253     display ' pb lf can ' pb-c-lf-cancel-amt
 15254     display ' ws lf can ' ws-crefnd1
 15255     if crefnd1l <> zeros
 15256        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15257        move ws-crefnd1 to ws-new-ref-total
 15258     else
 15259        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15260     end-if
 15261     display ' pb ah can ' pb-c-ah-cancel-amt
 15262     display ' ws ah can ' ws-crefnd2
 15263     display ' chk amts  ' ws-check-amts
 15264     if crefnd2l <> zeros
 15265        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 278
* EL6311.cbl
 15266        compute ws-new-ref-total = ws-new-ref-total +
 15267           ws-crefnd2
 15268     else
 15269        compute ws-new-ref-total = ws-new-ref-total +
 15270           pb-c-ah-cancel-amt
 15271     end-if
 15272
 15273     if zeros = (ws-lf-diff + ws-ah-diff)
 15274        move er-3449             to emi-error
 15275        perform 9900-error-format thru 9900-exit
 15276        go to 2330-continue-change
 15277     end-if
 15278
 15279     if ws-new-ref-total < ws-check-amts
 15280        move er-3447             to emi-error
 15281        perform 9900-error-format thru 9900-exit
 15282        move al-uabon            to cmainta
 15283        move -1                  to cmaintl
 15284        go to 8200-send-dataonly
 15285     end-if
 15286
 15287     if ws-new-ref-total > ws-check-amts
 15288        move er-3448             to emi-error
 15289        move al-uabon            to crefnd1a
 15290                                    crefnd2a
 15291        perform 9900-error-format thru 9900-exit
 15292     end-if
 15293
 15294*     if (ws-lf-diff + ws-ah-diff) < zeros
 15295*        move er-3447             to emi-error
 15296*        perform 9900-error-format thru 9900-exit
 15297*        move al-uabon            to cmainta
 15298*        move -1                  to cmaintl
 15299*        go to 8200-send-dataonly
 15300*     end-if
 15301     .
 15302 2330-continue-change.
 15303
 15304
 15305* EXEC CICS READ
 15306*        DATASET (FILE-ID-ERPNDB)
 15307*        INTO    (PENDING-BUSINESS)
 15308*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15309*        UPDATE
 15310*    END-EXEC.
 15311     MOVE LENGTH OF
 15312      PENDING-BUSINESS
 15313       TO DFHEIV11
 15314*    MOVE '&"IL       EU         (   #00013635' TO DFHEIV0
 15315     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15316     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15317     MOVE X'2020233030303133363335' TO DFHEIV0(25:11)
 15318     CALL 'kxdfhei1' USING DFHEIV0,
 15319           FILE-ID-ERPNDB,
 15320           PENDING-BUSINESS,
 15321           DFHEIV11,
 15322           PI-PREV-CONTROL-PRIMARY,
 15323           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 279
* EL6311.cbl
 15324           DFHEIV99,
 15325           DFHEIV99
 15326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15327
 15328
 15329     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15330     MOVE 'B'                    TO JP-RECORD-TYPE
 15331     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15332     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15333
 15334     PERFORM 8400-LOG-JOURNAL-RECORD.
 15335
 15336     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15337          PB-CHG-COUNT NOT = ZEROS
 15338        IF (CREFND1L GREATER THAN ZEROS AND
 15339            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15340           OR
 15341           (CREFND2L GREATER THAN ZEROS AND
 15342            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15343            ADD +1                      TO PB-CHG-COUNT
 15344            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15345
 15346*    IF CMICRNOL  GREATER  ZEROS
 15347*        IF CMICRNOI  NUMERIC
 15348*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15349*            MOVE AL-UNNON       TO  CMICRNOA
 15350*        ELSE
 15351*            MOVE -1             TO  CMICRNOL
 15352*            MOVE AL-UNBON       TO  CMICRNOA
 15353*            MOVE ER-2701        TO  EMI-ERROR
 15354*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15355
 15356     IF CSUFIXL GREATER THAN ZEROS
 15357        MOVE CSUFIXI             TO PB-CERT-SFX.
 15358
 15359     IF CLSTNML GREATER THAN ZEROS
 15360         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15361
 15362     IF CCANREAL > ZEROS
 15363        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15364     END-IF
 15365     IF CPCYNL > ZEROS
 15366        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15367     END-IF
 15368     IF CCANDT1L    GREATER THAN ZEROS
 15369        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15370
 15371     IF CCANDT2L    GREATER THAN ZEROS
 15372        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15373
 15374     IF CMTHD1L    GREATER THAN +0
 15375        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15376
 15377     IF CMTHD2L    GREATER THAN +0
 15378        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15379
 15380     IF CREFND1L    GREATER THAN ZEROS
 15381        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 280
* EL6311.cbl
 15382        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15383        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15384        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15385
 15386     IF CREFND2L    GREATER THAN ZEROS
 15387        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15388        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15389        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15390        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15391
 15392     IF CLIVESL     GREATER THAN ZEROS
 15393        MOVE WS-CLIVES           TO PB-C-LIVES.
 15394
 15395     IF CPAYEEL     GREATER THAN ZEROS
 15396        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15397
 15398     IF CFORCEL     GREATER THAN ZEROS
 15399        MOVE CFORCEI             TO PB-FORCE-CODE.
 15400
 15401     IF CBILCDL     GREATER THAN ZEROS
 15402        MOVE CBILCDI             TO PB-RECORD-BILL.
 15403
 15404 2360-REWRITE-PB-RECORD.
 15405     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15406     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15407     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15408     MOVE 'C'                    TO JP-RECORD-TYPE.
 15409     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15410     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15411     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15412
 15413     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15414
 15415     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15416     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15417
 15418     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15419
 15420     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15421
 15422     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15423     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15424     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15425
 15426     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15427     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15428
 15429 2375-REWRITE-PENDING-BUSINESS.
 15430     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15431     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15432     MOVE 'C'                    TO JP-RECORD-TYPE.
 15433     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15434
 15435
 15436* EXEC CICS REWRITE
 15437*        DATASET (FILE-ID-ERPNDB)
 15438*        FROM    (PENDING-BUSINESS)
 15439*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 281
* EL6311.cbl
 15440     MOVE LENGTH OF
 15441      PENDING-BUSINESS
 15442       TO DFHEIV11
 15443*    MOVE '&& L                  %   #00013748' TO DFHEIV0
 15444     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15445     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15446     MOVE X'2020233030303133373438' TO DFHEIV0(25:11)
 15447     CALL 'kxdfhei1' USING DFHEIV0,
 15448           FILE-ID-ERPNDB,
 15449           PENDING-BUSINESS,
 15450           DFHEIV11,
 15451           DFHEIV99
 15452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15453
 15454
 15455     PERFORM 8400-LOG-JOURNAL-RECORD.
 15456
 15457******************************************************************
 15458*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15459******************************************************************
 15460
 15461     display ' made it to update orig cancel cert '
 15462
 15463     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15464     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15465     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15466     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15467
 15468
 15469* EXEC CICS READ
 15470*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15471*        DATASET (FILE-ID-ELCERT)
 15472*        RIDFLD  (ELCERT-KEY)
 15473*        RESP    (WS-RESPONSE)
 15474*    END-EXEC.
 15475*    MOVE '&"S        E          (  N#00013766' TO DFHEIV0
 15476     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15478     MOVE X'204E233030303133373636' TO DFHEIV0(25:11)
 15479     CALL 'kxdfhei1' USING DFHEIV0,
 15480           FILE-ID-ELCERT,
 15481           DFHEIV20,
 15482           DFHEIV99,
 15483           ELCERT-KEY,
 15484           DFHEIV99,
 15485           DFHEIV99,
 15486           DFHEIV99
 15487     SET ADDRESS OF CERTIFICATE-MASTER TO
 15488         DFHEIV20
 15489     MOVE EIBRESP  TO WS-RESPONSE
 15490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15491
 15492
 15493     IF NOT RESP-NORMAL
 15494        GO TO 2376-BYPASS-CRTO
 15495     END-IF
 15496
 15497
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 282
* EL6311.cbl
 15498     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15499     MOVE ' '                    TO WS-ERMAIL-SW
 15500
 15501
 15502* EXEC CICS READ
 15503*       DATASET   (FILE-ID-ERMAIL)
 15504*       SET       (ADDRESS OF MAILING-DATA)
 15505*       RIDFLD    (ERMAIL-KEY)
 15506*       RESP      (WS-RESPONSE)
 15507*    END-EXEC
 15508*    MOVE '&"S        E          (  N#00013781' TO DFHEIV0
 15509     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15510     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15511     MOVE X'204E233030303133373831' TO DFHEIV0(25:11)
 15512     CALL 'kxdfhei1' USING DFHEIV0,
 15513           FILE-ID-ERMAIL,
 15514           DFHEIV20,
 15515           DFHEIV99,
 15516           ERMAIL-KEY,
 15517           DFHEIV99,
 15518           DFHEIV99,
 15519           DFHEIV99
 15520     SET ADDRESS OF MAILING-DATA TO
 15521         DFHEIV20
 15522     MOVE EIBRESP  TO WS-RESPONSE
 15523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15524
 15525     IF RESP-NORMAL
 15526        SET ERMAIL-FOUND TO TRUE
 15527     END-IF
 15528
 15529     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15530
 15531     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15532                                 TO ELCRTO-KEY
 15533     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15534     MOVE +0                     TO ELCRTO-SEQ-NO
 15535
 15536
 15537* EXEC CICS READ
 15538*       DATASET   ('ELCRTO')
 15539*       INTO      (ORIGINAL-CERTIFICATE)
 15540*       RIDFLD    (ELCRTO-KEY)
 15541*       GTEQ
 15542*       RESP      (WS-RESPONSE)
 15543*    END-EXEC
 15544     MOVE LENGTH OF
 15545      ORIGINAL-CERTIFICATE
 15546       TO DFHEIV11
 15547     MOVE 'ELCRTO' TO DFHEIV1
 15548*    MOVE '&"IL       G          (  N#00013799' TO DFHEIV0
 15549     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15550     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15551     MOVE X'204E233030303133373939' TO DFHEIV0(25:11)
 15552     CALL 'kxdfhei1' USING DFHEIV0,
 15553           DFHEIV1,
 15554           ORIGINAL-CERTIFICATE,
 15555           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 283
* EL6311.cbl
 15556           ELCRTO-KEY,
 15557           DFHEIV99,
 15558           DFHEIV99,
 15559           DFHEIV99
 15560     MOVE EIBRESP  TO WS-RESPONSE
 15561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15562
 15563     display ' just read gteq ' ws-response
 15564     IF RESP-NORMAL
 15565        AND (OC-CONTROL-PRIMARY (1:33) =
 15566                 PB-CONTROL-BY-ACCOUNT (1:33))
 15567        AND (OC-RECORD-TYPE = 'I')
 15568        display ' resp norm, key =, type i '
 15569        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15570           display ' end proc blank '
 15571           display ' csr edit session ' PI-CSR-SESSION-SW
 15572           IF NOT CSR-EDIT-SESSION
 15573
 15574* EXEC CICS READ
 15575*                DATASET   ('ELCRTO')
 15576*                INTO      (ORIGINAL-CERTIFICATE)
 15577*                RIDFLD    (OC-CONTROL-PRIMARY)
 15578*                UPDATE
 15579*                RESP      (WS-RESPONSE)
 15580*             END-EXEC
 15581     MOVE LENGTH OF
 15582      ORIGINAL-CERTIFICATE
 15583       TO DFHEIV11
 15584     MOVE 'ELCRTO' TO DFHEIV1
 15585*    MOVE '&"IL       EU         (  N#00013817' TO DFHEIV0
 15586     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15587     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15588     MOVE X'204E233030303133383137' TO DFHEIV0(25:11)
 15589     CALL 'kxdfhei1' USING DFHEIV0,
 15590           DFHEIV1,
 15591           ORIGINAL-CERTIFICATE,
 15592           DFHEIV11,
 15593           OC-CONTROL-PRIMARY,
 15594           DFHEIV99,
 15595           DFHEIV99,
 15596           DFHEIV99
 15597     MOVE EIBRESP  TO WS-RESPONSE
 15598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15599              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15600              IF RESP-NORMAL
 15601                 display ' good read upd '
 15602                 IF OC-ISSUE-TRAN-IND = 'N'
 15603                    MOVE CM-INSURED-LAST-NAME   TO
 15604                         OC-INS-LAST-NAME
 15605                    MOVE CM-INSURED-FIRST-NAME  TO
 15606                         OC-INS-FIRST-NAME
 15607                    MOVE CM-INSURED-INITIAL2    TO
 15608                         OC-INS-MIDDLE-INIT
 15609                    MOVE CM-INSURED-ISSUE-AGE   TO
 15610                         OC-INS-AGE
 15611                    MOVE CM-JT-LAST-NAME        TO
 15612                         OC-JNT-LAST-NAME
 15613                    MOVE CM-JT-FIRST-NAME       TO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 284
* EL6311.cbl
 15614                         OC-JNT-FIRST-NAME
 15615                    MOVE CM-JT-INITIAL          TO
 15616                         OC-JNT-MIDDLE-INIT
 15617                    MOVE CM-INSURED-JOINT-AGE   TO
 15618                         OC-JNT-AGE
 15619                    MOVE CM-LF-BENEFIT-CD       TO
 15620                         OC-LF-BENCD
 15621                    MOVE CM-LF-ORIG-TERM        TO
 15622                         OC-LF-TERM
 15623                    MOVE CM-LF-BENEFIT-AMT      TO
 15624                         OC-LF-BEN-AMT
 15625                    MOVE CM-LF-PREMIUM-AMT      TO
 15626                         OC-LF-PRM-AMT
 15627                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15628                         OC-LF-ALT-BEN-AMT
 15629                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15630                         OC-LF-ALT-PRM-AMT
 15631                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15632                         OC-LF-EXP-DT
 15633                    MOVE CM-LIFE-COMM-PCT       TO
 15634                         OC-LF-COMM-PCT
 15635                    MOVE CM-AH-BENEFIT-CD       TO
 15636                         OC-AH-BENCD
 15637                    MOVE CM-AH-ORIG-TERM        TO
 15638                         OC-AH-TERM
 15639                    MOVE CM-AH-BENEFIT-AMT      TO
 15640                         OC-AH-BEN-AMT
 15641                    MOVE CM-AH-PREMIUM-AMT      TO
 15642                         OC-AH-PRM-AMT
 15643                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15644                         OC-AH-EXP-DT
 15645                    MOVE CM-AH-COMM-PCT         TO
 15646                         OC-AH-COMM-PCT
 15647                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15648                         OC-AH-CP
 15649                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15650                         OC-1ST-PMT-DT
 15651                 END-IF
 15652                 MOVE PB-C-LF-CANCEL-DT      TO
 15653                         OC-LF-CANCEL-DT
 15654                 MOVE PB-C-LF-CANCEL-AMT     TO
 15655                         OC-LF-CANCEL-AMT
 15656                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15657                         OC-LF-ITD-CANCEL-AMT
 15658                 MOVE PB-C-AH-CANCEL-DT      TO
 15659                         OC-AH-CANCEL-DT
 15660                 MOVE PB-C-AH-CANCEL-AMT     TO
 15661                         OC-AH-CANCEL-AMT
 15662                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15663                         OC-AH-ITD-CANCEL-AMT
 15664                 MOVE 'Y'                    TO
 15665                         OC-CANCEL-TRAN-IND
 15666                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15667                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15668                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15669                 IF ERMAIL-FOUND
 15670                    MOVE MA-CRED-BENE-NAME
 15671                                 TO OC-CRED-BENE-NAME
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 285
* EL6311.cbl
 15672                 END-IF
 15673                 IF NOT CERT-TRL-REC-NOT-FOUND
 15674                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15675                           OC-INS-AGE-DEFAULT-FLAG
 15676                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15677                           OC-JNT-AGE-DEFAULT-FLAG
 15678                 END-IF
 15679
 15680* EXEC CICS REWRITE
 15681*                   DATASET   ('ELCRTO')
 15682*                   FROM      (ORIGINAL-CERTIFICATE)
 15683*                   RESP      (WS-RESPONSE)
 15684*                END-EXEC
 15685     MOVE LENGTH OF
 15686      ORIGINAL-CERTIFICATE
 15687       TO DFHEIV11
 15688     MOVE 'ELCRTO' TO DFHEIV1
 15689*    MOVE '&& L                  %  N#00013904' TO DFHEIV0
 15690     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15691     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15692     MOVE X'204E233030303133393034' TO DFHEIV0(25:11)
 15693     CALL 'kxdfhei1' USING DFHEIV0,
 15694           DFHEIV1,
 15695           ORIGINAL-CERTIFICATE,
 15696           DFHEIV11,
 15697           DFHEIV99
 15698     MOVE EIBRESP  TO WS-RESPONSE
 15699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15700                 display ' just rewrote ' ws-response
 15701              END-IF
 15702           END-IF
 15703        ELSE
 15704           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15705           MOVE 'OC'             TO OC-RECORD-ID
 15706           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15707           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15708           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15709           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15710           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15711           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15712           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15713           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15714           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15715           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15716           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15717           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15718           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15719           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15720           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15721           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15722           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15723           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15724           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15725           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15726           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15727           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15728           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15729           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 286
* EL6311.cbl
 15730           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15731           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15732           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15733           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15734           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15735           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15736           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15737           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15738           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15739           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15740           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15741           IF ERMAIL-FOUND
 15742              MOVE MA-CRED-BENE-NAME
 15743                                 TO OC-CRED-BENE-NAME
 15744           END-IF
 15745           IF NOT CERT-TRL-REC-NOT-FOUND
 15746              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15747                           OC-INS-AGE-DEFAULT-FLAG
 15748              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15749                           OC-JNT-AGE-DEFAULT-FLAG
 15750           END-IF
 15751           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15752
 15753* EXEC CICS WRITE
 15754*             DATASET   ('ELCRTO')
 15755*             FROM      (ORIGINAL-CERTIFICATE)
 15756*             RIDFLD    (OC-CONTROL-PRIMARY)
 15757*             RESP      (WS-RESPONSE)
 15758*          END-EXEC
 15759     MOVE LENGTH OF
 15760      ORIGINAL-CERTIFICATE
 15761       TO DFHEIV11
 15762     MOVE 'ELCRTO' TO DFHEIV1
 15763*    MOVE '&$ L                  ''  N#00013961' TO DFHEIV0
 15764     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15766     MOVE X'204E233030303133393631' TO DFHEIV0(25:11)
 15767     CALL 'kxdfhei1' USING DFHEIV0,
 15768           DFHEIV1,
 15769           ORIGINAL-CERTIFICATE,
 15770           DFHEIV11,
 15771           OC-CONTROL-PRIMARY,
 15772           DFHEIV99,
 15773           DFHEIV99
 15774     MOVE EIBRESP  TO WS-RESPONSE
 15775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15776        END-IF
 15777     ELSE
 15778        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15779        MOVE 'OC'                TO OC-RECORD-ID
 15780        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15781                                 TO OC-CONTROL-PRIMARY (1:33)
 15782        MOVE 'I'                 TO OC-RECORD-TYPE
 15783        MOVE +4096               TO OC-KEY-SEQ-NO
 15784        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15785        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15786        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15787        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 287
* EL6311.cbl
 15788        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15789        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15790        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15791        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15792        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15793        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15794        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15795        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15796        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15797        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15798        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15799        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15800        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15801        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15802        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15803        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15804        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15805        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15806        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15807        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15808        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15809        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15810        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15811        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15812        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15813        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15814        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15815        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15816        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15817        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15818        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15819        IF ERMAIL-FOUND
 15820           MOVE MA-CRED-BENE-NAME
 15821                                 TO OC-CRED-BENE-NAME
 15822        END-IF
 15823        IF NOT CERT-TRL-REC-NOT-FOUND
 15824           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15825                           OC-INS-AGE-DEFAULT-FLAG
 15826           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15827                           OC-JNT-AGE-DEFAULT-FLAG
 15828        END-IF
 15829        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15830
 15831
 15832* EXEC CICS WRITE
 15833*          DATASET   ('ELCRTO')
 15834*          FROM      (ORIGINAL-CERTIFICATE)
 15835*          RIDFLD    (OC-CONTROL-PRIMARY)
 15836*          RESP      (WS-RESPONSE)
 15837*       END-EXEC
 15838     MOVE LENGTH OF
 15839      ORIGINAL-CERTIFICATE
 15840       TO DFHEIV11
 15841     MOVE 'ELCRTO' TO DFHEIV1
 15842*    MOVE '&$ L                  ''  N#00014022' TO DFHEIV0
 15843     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15845     MOVE X'204E233030303134303232' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 288
* EL6311.cbl
 15846     CALL 'kxdfhei1' USING DFHEIV0,
 15847           DFHEIV1,
 15848           ORIGINAL-CERTIFICATE,
 15849           DFHEIV11,
 15850           OC-CONTROL-PRIMARY,
 15851           DFHEIV99,
 15852           DFHEIV99
 15853     MOVE EIBRESP  TO WS-RESPONSE
 15854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15855     END-IF.
 15856
 15857 2376-BYPASS-CRTO.
 15858******************************************************************
 15859*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15860******************************************************************
 15861
 15862
 15863* EXEC CICS HANDLE CONDITION
 15864*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15865*    END-EXEC.
 15866*    MOVE '"$I                   ! 7 #00014035' TO DFHEIV0
 15867     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15869     MOVE X'3720233030303134303335' TO DFHEIV0(25:11)
 15870     CALL 'kxdfhei1' USING DFHEIV0
 15871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15872
 15873
 15874
 15875* EXEC CICS READ
 15876*        INTO    (PENDING-BUSINESS)
 15877*        DATASET (FILE-ID-ERPNDB)
 15878*        RIDFLD  (ERPNDB-KEY)
 15879*        UPDATE
 15880*    END-EXEC.
 15881     MOVE LENGTH OF
 15882      PENDING-BUSINESS
 15883       TO DFHEIV11
 15884*    MOVE '&"IL       EU         (   #00014039' TO DFHEIV0
 15885     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15887     MOVE X'2020233030303134303339' TO DFHEIV0(25:11)
 15888     CALL 'kxdfhei1' USING DFHEIV0,
 15889           FILE-ID-ERPNDB,
 15890           PENDING-BUSINESS,
 15891           DFHEIV11,
 15892           ERPNDB-KEY,
 15893           DFHEIV99,
 15894           DFHEIV99,
 15895           DFHEIV99
 15896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15897
 15898
 15899     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15900     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15901     MOVE 'B'                    TO JP-RECORD-TYPE.
 15902     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15903
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 289
* EL6311.cbl
 15904     PERFORM 8400-LOG-JOURNAL-RECORD.
 15905
 15906     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15907
 15908
 15909* EXEC CICS REWRITE
 15910*        DATASET (FILE-ID-ERPNDB)
 15911*        FROM    (PENDING-BUSINESS)
 15912*    END-EXEC.
 15913     MOVE LENGTH OF
 15914      PENDING-BUSINESS
 15915       TO DFHEIV11
 15916*    MOVE '&& L                  %   #00014055' TO DFHEIV0
 15917     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15918     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15919     MOVE X'2020233030303134303535' TO DFHEIV0(25:11)
 15920     CALL 'kxdfhei1' USING DFHEIV0,
 15921           FILE-ID-ERPNDB,
 15922           PENDING-BUSINESS,
 15923           DFHEIV11,
 15924           DFHEIV99
 15925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15926
 15927
 15928     MOVE 'C'                    TO JP-RECORD-TYPE.
 15929     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15930
 15931     PERFORM 8400-LOG-JOURNAL-RECORD.
 15932
 15933     IF WS-ERRORS-PRESENT
 15934         GO TO 3900-RE-DISPLAY-RECORD.
 15935
 15936     MOVE ZEROS                  TO EMI-ERROR
 15937     MOVE -1                     TO CMAINTL
 15938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15939     GO TO 3900-RE-DISPLAY-RECORD.
 15940
 15941 2380-BATCH-HDR-NOT-FOUND.
 15942     MOVE -1                     TO BMAINTL.
 15943     MOVE ER-7450                TO EMI-ERROR.
 15944     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15945     GO TO 8200-SEND-DATAONLY.
 15946
 15947 2385-REC-NOT-FOUND.
 15948     MOVE -1                     TO BMAINTL.
 15949     MOVE ER-7451                TO EMI-ERROR.
 15950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15951     GO TO 8200-SEND-DATAONLY.
 15952
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 290
* EL6311.cbl
 15954
 15955******************************************************************
 15956*                                                                *
 15957*          D E L E T E   C A N C E L   R O U T I N E             *
 15958*                                                                *
 15959******************************************************************
 15960
 15961 2400-DELETE-CANCEL-ROUTINE.
 15962     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15963
 15964     IF CCHGL NOT = ZEROS
 15965        MOVE ER-2196             TO EMI-ERROR
 15966        MOVE AL-UABON            TO CMAINTA
 15967        MOVE -1                  TO CMAINTL
 15968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15969        GO TO 8200-SEND-DATAONLY.
 15970
 15971
 15972* EXEC CICS HANDLE CONDITION
 15973*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15974*    END-EXEC.
 15975*    MOVE '"$I                   ! 8 #00014103' TO DFHEIV0
 15976     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15978     MOVE X'3820233030303134313033' TO DFHEIV0(25:11)
 15979     CALL 'kxdfhei1' USING DFHEIV0
 15980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15981
 15982
 15983     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15984     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15985     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15986
 15987
 15988* EXEC CICS READ
 15989*        SET     (ADDRESS OF PENDING-BUSINESS)
 15990*        DATASET (FILE-ID-ERPNDB)
 15991*        RIDFLD  (ERPNDB-KEY)
 15992*    END-EXEC.
 15993*    MOVE '&"S        E          (   #00014111' TO DFHEIV0
 15994     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15995     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15996     MOVE X'2020233030303134313131' TO DFHEIV0(25:11)
 15997     CALL 'kxdfhei1' USING DFHEIV0,
 15998           FILE-ID-ERPNDB,
 15999           DFHEIV20,
 16000           DFHEIV99,
 16001           ERPNDB-KEY,
 16002           DFHEIV99,
 16003           DFHEIV99,
 16004           DFHEIV99
 16005     SET ADDRESS OF PENDING-BUSINESS TO
 16006         DFHEIV20
 16007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16008
 16009
 16010     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16011
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 291
* EL6311.cbl
 16012     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16013
 16014     IF CSUFIXL NOT = ZEROS
 16015        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16016     ELSE
 16017        MOVE SPACE               TO WS-NEW-SUFFIX.
 16018
 16019     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16020
 16021     PERFORM 8600-DEEDIT.
 16022     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16023     MOVE '4'                    TO DC-OPTION-CODE.
 16024     PERFORM 9700-DATE-LINK.
 16025
 16026     IF DATE-CONVERSION-ERROR
 16027        MOVE ER-0348             TO EMI-ERROR
 16028        MOVE -1                  TO CEFFDTL
 16029        MOVE AL-UABON            TO CEFFDTA
 16030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16031        GO TO 8200-SEND-DATAONLY
 16032     ELSE
 16033        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16034        MOVE AL-UANON            TO CEFFDTA
 16035        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16036
 16037
 16038* EXEC CICS HANDLE CONDITION
 16039*         NOTFND    (2490-RECORD-NOT-FOUND)
 16040*    END-EXEC.
 16041*    MOVE '"$I                   ! 9 #00014144' TO DFHEIV0
 16042     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16044     MOVE X'3920233030303134313434' TO DFHEIV0(25:11)
 16045     CALL 'kxdfhei1' USING DFHEIV0
 16046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16047
 16048
 16049
 16050* EXEC CICS READ
 16051*        SET     (ADDRESS OF PENDING-BUSINESS)
 16052*        DATASET (FILE-ID-ERPNDB)
 16053*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16054*        UPDATE
 16055*    END-EXEC.
 16056*    MOVE '&"S        EU         (   #00014148' TO DFHEIV0
 16057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16059     MOVE X'2020233030303134313438' TO DFHEIV0(25:11)
 16060     CALL 'kxdfhei1' USING DFHEIV0,
 16061           FILE-ID-ERPNDB,
 16062           DFHEIV20,
 16063           DFHEIV99,
 16064           PI-PREV-CONTROL-PRIMARY,
 16065           DFHEIV99,
 16066           DFHEIV99,
 16067           DFHEIV99
 16068     SET ADDRESS OF PENDING-BUSINESS TO
 16069         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 292
* EL6311.cbl
 16070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16071
 16072
 16073     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16074        MOVE -1                 TO CMAINTL
 16075        MOVE ER-2197            TO EMI-ERROR
 16076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16077        GO TO 8200-SEND-DATAONLY.
 16078
 16079     IF PB-BILLED-DT NOT = LOW-VALUES
 16080        MOVE -1                 TO CMAINTL
 16081        MOVE ER-2129            TO EMI-ERROR
 16082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16083        GO TO 8200-SEND-DATAONLY.
 16084
 16085     IF PB-CHG-COUNT NOT = ZEROS
 16086        MOVE ER-2336            TO EMI-ERROR
 16087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16088        MOVE AL-UABON            TO CMAINTA
 16089        MOVE -1                  TO CMAINTL
 16090        GO TO 8200-SEND-DATAONLY.
 16091
 16092     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16093        PB-CHG-COUNT NOT = ZEROS
 16094        MOVE ER-2196             TO EMI-ERROR
 16095        MOVE AL-UABON            TO CMAINTA
 16096        MOVE -1                  TO CMAINTL
 16097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16098        GO TO 8200-SEND-DATAONLY.
 16099
 16100     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16101        MOVE ER-2900 TO EMI-ERROR
 16102        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16103        MOVE AL-UABON         TO CMAINTA
 16104        MOVE -1               TO CMAINTL
 16105        GO TO 8200-SEND-DATAONLY.
 16106     move ' '                    to ws-stop-sw
 16107                                    ws-check-sw
 16108                                    ws-proc-check-sw
 16109                                    ws-chek-browse-sw
 16110
 16111     perform 2500-browse-checks  thru 2500-exit
 16112     if i-have-processed-checks
 16113        move er-3446             to emi-error
 16114        perform 9900-error-format thru 9900-exit
 16115        move al-uabon            to cmainta
 16116        move -1                  to cmaintl
 16117        go to 8200-send-dataonly
 16118     end-if
 16119
 16120* EXEC CICS HANDLE CONDITION
 16121*         NOTFND  (2475-CONTINUE-DELETE)
 16122*    END-EXEC
 16123*    MOVE '"$I                   ! : #00014201' TO DFHEIV0
 16124     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16126     MOVE X'3A20233030303134323031' TO DFHEIV0(25:11)
 16127     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 293
* EL6311.cbl
 16128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16129
 16130     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16131     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16132     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16133     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16134
 16135
 16136* EXEC CICS READ
 16137*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16138*        DATASET (FILE-ID-ELCERT)
 16139*        RIDFLD  (ELCERT-KEY)
 16140*        UPDATE
 16141*    END-EXEC.
 16142*    MOVE '&"S        EU         (   #00014210' TO DFHEIV0
 16143     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16144     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16145     MOVE X'2020233030303134323130' TO DFHEIV0(25:11)
 16146     CALL 'kxdfhei1' USING DFHEIV0,
 16147           FILE-ID-ELCERT,
 16148           DFHEIV20,
 16149           DFHEIV99,
 16150           ELCERT-KEY,
 16151           DFHEIV99,
 16152           DFHEIV99,
 16153           DFHEIV99
 16154     SET ADDRESS OF CERTIFICATE-MASTER TO
 16155         DFHEIV20
 16156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16157
 16158
 16159     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16160
 16161     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16162     MOVE 'B'                    TO JP-RECORD-TYPE.
 16163     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16164     PERFORM 8400-LOG-JOURNAL-RECORD.
 16165
 16166     IF PB-CI-LIVES NOT NUMERIC
 16167         MOVE ZERO                    TO PB-CI-LIVES.
 16168
 16169     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16170        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16171           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16172           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16173           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16174                                            CM-LF-CANCEL-DT
 16175           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16176        ELSE
 16177           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16178           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16179           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16180           MOVE PB-CI-LIVES              TO CM-LIVES.
 16181
 16182     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16183        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16184           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16185               MOVE CM-LF-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 294
* EL6311.cbl
 16186                                        TO CM-LF-CURRENT-STATUS
 16187               MOVE SPACE
 16188                                        TO CM-LF-STATUS-AT-CANCEL
 16189           ELSE
 16190               MOVE PB-CI-LF-POLICY-STATUS
 16191                                        TO CM-LF-CURRENT-STATUS
 16192        ELSE
 16193           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16194
 16195
 16196     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16197        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16198           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16199           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16200           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16201                                            CM-AH-CANCEL-DT
 16202           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16203        ELSE
 16204           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16205           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16206           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16207           MOVE PB-CI-LIVES              TO CM-LIVES.
 16208
 16209     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16210        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16211           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16212               MOVE CM-AH-STATUS-AT-CANCEL
 16213                                        TO CM-AH-CURRENT-STATUS
 16214               MOVE SPACE
 16215                                        TO CM-AH-STATUS-AT-CANCEL
 16216           ELSE
 16217               MOVE PB-CI-AH-POLICY-STATUS
 16218                                        TO CM-AH-CURRENT-STATUS
 16219        ELSE
 16220           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16221
 16222 2450-REWRITE-CERT.
 16223     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16224     MOVE 'C'                      TO JP-RECORD-TYPE.
 16225     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16226
 16227
 16228* EXEC CICS REWRITE
 16229*        DATASET  (FILE-ID-ELCERT)
 16230*        FROM     (CERTIFICATE-MASTER)
 16231*    END-EXEC.
 16232     MOVE LENGTH OF
 16233      CERTIFICATE-MASTER
 16234       TO DFHEIV11
 16235*    MOVE '&& L                  %   #00014285' TO DFHEIV0
 16236     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16237     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16238     MOVE X'2020233030303134323835' TO DFHEIV0(25:11)
 16239     CALL 'kxdfhei1' USING DFHEIV0,
 16240           FILE-ID-ELCERT,
 16241           CERTIFICATE-MASTER,
 16242           DFHEIV11,
 16243           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 295
* EL6311.cbl
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246
 16247     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16248
 16249     PERFORM 8400-LOG-JOURNAL-RECORD.
 16250
 16251     move ' '                    to ws-stop-sw
 16252                                    ws-proc-check-sw
 16253                                    ws-chek-browse-sw
 16254
 16255     if i-have-checks
 16256        perform until i-say-stop
 16257           perform 2510-startbr-erchek
 16258                                 thru 2510-exit
 16259           if resp-normal
 16260              perform 2520-readnext-erchek
 16261                                 thru 2520-exit
 16262           end-if
 16263           if (not resp-normal)
 16264              or (pb-control-by-account (1:33) not =
 16265                 ch-control-primary (1:33))
 16266                 set i-say-stop to true
 16267           else
 16268              perform 2530-readupd-erchek
 16269                                 thru 2530-exit
 16270              if resp-normal
 16271                 perform 2540-delete-erchek
 16272                                 thru 2540-exit
 16273              end-if
 16274              if ws-chek-browse-sw = 'Y'
 16275                 perform 2525-endbr-erchek
 16276                                 thru 2525-exit
 16277                 move ' '        to ws-chek-browse-sw
 16278              end-if
 16279           end-if
 16280        end-perform
 16281     end-if
 16282
 16283     if ws-chek-browse-sw = 'Y'
 16284        perform 2525-endbr-erchek thru 2525-exit
 16285     end-if
 16286     .
 16287 2475-CONTINUE-DELETE.
 16288     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16289     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16290
 16291     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16292     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16293
 16294     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16295
 16296     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16297     MOVE 'D'                    TO JP-RECORD-TYPE
 16298     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16299
 16300
 16301* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 296
* EL6311.cbl
 16302*        DATASET    (FILE-ID-ERPNDB)
 16303*    END-EXEC.
 16304*    MOVE '&(                    &   #00014343' TO DFHEIV0
 16305     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16306     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16307     MOVE X'2020233030303134333433' TO DFHEIV0(25:11)
 16308     CALL 'kxdfhei1' USING DFHEIV0,
 16309           FILE-ID-ERPNDB,
 16310           DFHEIV99,
 16311           DFHEIV99,
 16312           DFHEIV99,
 16313           DFHEIV99
 16314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16315
 16316
 16317     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16318
 16319     PERFORM 8400-LOG-JOURNAL-RECORD.
 16320
 16321     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16322     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16323
 16324
 16325* EXEC CICS HANDLE CONDITION
 16326*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16327*    END-EXEC.
 16328*    MOVE '"$I                   ! ; #00014354' TO DFHEIV0
 16329     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16331     MOVE X'3B20233030303134333534' TO DFHEIV0(25:11)
 16332     CALL 'kxdfhei1' USING DFHEIV0
 16333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16334
 16335
 16336
 16337* EXEC CICS READ
 16338*        SET     (ADDRESS OF PENDING-BUSINESS)
 16339*        DATASET (FILE-ID-ERPNDB)
 16340*        RIDFLD  (ERPNDB-KEY)
 16341*        UPDATE
 16342*    END-EXEC.
 16343*    MOVE '&"S        EU         (   #00014358' TO DFHEIV0
 16344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16345     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16346     MOVE X'2020233030303134333538' TO DFHEIV0(25:11)
 16347     CALL 'kxdfhei1' USING DFHEIV0,
 16348           FILE-ID-ERPNDB,
 16349           DFHEIV20,
 16350           DFHEIV99,
 16351           ERPNDB-KEY,
 16352           DFHEIV99,
 16353           DFHEIV99,
 16354           DFHEIV99
 16355     SET ADDRESS OF PENDING-BUSINESS TO
 16356         DFHEIV20
 16357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16358
 16359
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 297
* EL6311.cbl
 16360     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16361     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16362
 16363     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16364        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16365        MOVE 'D'                 TO JP-RECORD-TYPE
 16366        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16367
 16368* EXEC CICS DELETE
 16369*            DATASET    (FILE-ID-ERPNDB)
 16370*       END-EXEC
 16371*    MOVE '&(                    &   #00014372' TO DFHEIV0
 16372     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16374     MOVE X'2020233030303134333732' TO DFHEIV0(25:11)
 16375     CALL 'kxdfhei1' USING DFHEIV0,
 16376           FILE-ID-ERPNDB,
 16377           DFHEIV99,
 16378           DFHEIV99,
 16379           DFHEIV99,
 16380           DFHEIV99
 16381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16382        PERFORM 8400-LOG-JOURNAL-RECORD
 16383     ELSE
 16384        MOVE 'B'                 TO JP-RECORD-TYPE
 16385        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16386        PERFORM 8400-LOG-JOURNAL-RECORD
 16387        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16388        MOVE 'C'                 TO JP-RECORD-TYPE
 16389        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16390
 16391* EXEC CICS REWRITE
 16392*            DATASET    (FILE-ID-ERPNDB)
 16393*            FROM       (PENDING-BUSINESS)
 16394*       END-EXEC
 16395     MOVE LENGTH OF
 16396      PENDING-BUSINESS
 16397       TO DFHEIV11
 16398*    MOVE '&& L                  %   #00014383' TO DFHEIV0
 16399     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16400     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16401     MOVE X'2020233030303134333833' TO DFHEIV0(25:11)
 16402     CALL 'kxdfhei1' USING DFHEIV0,
 16403           FILE-ID-ERPNDB,
 16404           PENDING-BUSINESS,
 16405           DFHEIV11,
 16406           DFHEIV99
 16407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16408        PERFORM 8400-LOG-JOURNAL-RECORD.
 16409
 16410******************************************************************
 16411*                                                                *
 16412*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16413*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16414*                                                                *
 16415******************************************************************
 16416
 16417     IF NOT PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 298
* EL6311.cbl
 16418        GO TO 2480-DELETE-FINISHED.
 16419
 16420     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16421        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16422        NEXT SENTENCE
 16423     ELSE
 16424        GO TO 2480-DELETE-FINISHED.
 16425
 16426
 16427* EXEC CICS HANDLE CONDITION
 16428*         NOTFND    (2480-DELETE-FINISHED)
 16429*    END-EXEC.
 16430*    MOVE '"$I                   ! < #00014405' TO DFHEIV0
 16431     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16433     MOVE X'3C20233030303134343035' TO DFHEIV0(25:11)
 16434     CALL 'kxdfhei1' USING DFHEIV0
 16435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16436
 16437
 16438     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16439     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16440
 16441
 16442* EXEC CICS READ
 16443*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16444*        DATASET (FILE-ID-ERRQST)
 16445*        RIDFLD  (ERRQST-KEY)
 16446*        UPDATE
 16447*    END-EXEC.
 16448*    MOVE '&"S        EU         (   #00014412' TO DFHEIV0
 16449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16450     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16451     MOVE X'2020233030303134343132' TO DFHEIV0(25:11)
 16452     CALL 'kxdfhei1' USING DFHEIV0,
 16453           FILE-ID-ERRQST,
 16454           DFHEIV20,
 16455           DFHEIV99,
 16456           ERRQST-KEY,
 16457           DFHEIV99,
 16458           DFHEIV99,
 16459           DFHEIV99
 16460     SET ADDRESS OF AR-REQUEST-RECORD TO
 16461         DFHEIV20
 16462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16463
 16464
 16465     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16466
 16467     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16468
 16469     MOVE 'D'                      TO JP-RECORD-TYPE.
 16470     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16471
 16472
 16473* EXEC CICS DELETE
 16474*         DATASET    (FILE-ID-ERRQST)
 16475*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 299
* EL6311.cbl
 16476*    MOVE '&(                    &   #00014426' TO DFHEIV0
 16477     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16478     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16479     MOVE X'2020233030303134343236' TO DFHEIV0(25:11)
 16480     CALL 'kxdfhei1' USING DFHEIV0,
 16481           FILE-ID-ERRQST,
 16482           DFHEIV99,
 16483           DFHEIV99,
 16484           DFHEIV99,
 16485           DFHEIV99
 16486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16487
 16488
 16489     PERFORM 8400-LOG-JOURNAL-RECORD.
 16490
 16491 2480-DELETE-FINISHED.
 16492     MOVE ZEROS                  TO EMI-ERROR.
 16493     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16494     MOVE LOW-VALUES             TO EL631CI.
 16495     MOVE -1                     TO CMAINTL.
 16496     GO TO 8100-SEND-INITIAL-MAP.
 16497
 16498 2485-BATCH-HDR-NOT-FOUND.
 16499     MOVE -1                     TO CMAINTL
 16500     MOVE AL-UABON               TO CMAINTA.
 16501     MOVE ER-7450                TO EMI-ERROR.
 16502     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16503     GO TO 8200-SEND-DATAONLY.
 16504
 16505 2490-RECORD-NOT-FOUND.
 16506     MOVE -1                     TO CMAINTL
 16507     MOVE AL-UABON               TO CMAINTA.
 16508     MOVE ER-7451                TO EMI-ERROR.
 16509     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16510     GO TO 8200-SEND-DATAONLY.
 16511***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16512***                                                            ***
 16513***     2500  B R O W S E   C H E C K S                        ***
 16514***  We perform this routine from 2 different places.          ***
 16515***  1. If the user changes the refund amount on a cancel, we  ***
 16516***    want to.........                                        ***
 16517***    a. determine if prior checks have been processed        ***
 16518***    b. If the amt is larger, display message instructing    ***
 16519***     them to create another check to make up the difference.***
 16520***    c. If the amt is less, do not allow the change and      ***
 16521***     display a FATAL error suggesting they deal with check  ***
 16522***     records befor continuing.                              ***
 16523***  2. If the user wants to delete a cancel record we......   ***
 16524***    a. browse through all the checks and if there is a      ***
 16525***     processed check, send FATAL message.                   ***
 16526***    b. If there is a non-released check, then delete that   ***
 16527***     check after you delete the pending cancel record.      ***
 16528***                                                            ***
 16529***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16530
 16531 2500-browse-checks.
 16532
 16533     perform 2510-startbr-erchek thru 2510-exit
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 300
* EL6311.cbl
 16534
 16535     if not resp-normal
 16536        go to 2500-exit
 16537     end-if
 16538
 16539     perform until i-say-stop
 16540        perform 2520-readnext-erchek
 16541                                 thru 2520-exit
 16542        if (not resp-normal)
 16543           or (pb-control-by-account (1:33) not =
 16544              ch-control-primary (1:33))
 16545              set i-say-stop to true
 16546        else
 16547           if (ch-approval-status) = ' '
 16548              and (ch-void-dt = low-values)
 16549              and (ch-released-dt = low-values)
 16550              set i-have-checks to true
 16551           else
 16552              set i-have-processed-checks to true
 16553           end-if
 16554           if ch-credit-accept-dt = low-values
 16555              and ch-void-dt = low-values
 16556              and ch-approval-status = ' ' OR 'P' OR 'A'
 16557              compute ws-check-amts = ws-check-amts +
 16558                 ch-amount-paid
 16559           end-if
 16560        end-if
 16561     end-perform
 16562
 16563     if ws-chek-browse-sw = 'Y'
 16564        perform 2525-endbr-erchek thru 2525-exit
 16565     end-if
 16566
 16567    .
 16568 2500-exit.
 16569     exit.
 16570
 16571 2510-startbr-erchek.
 16572
 16573     move pb-control-by-account  to erchek-key
 16574     move +0                     to chek-record-seq
 16575
 16576
 16577* exec cics startbr
 16578*       dataset   ('ERCHEK')
 16579*       ridfld    (erchek-key)
 16580*       gteq
 16581*       resp      (ws-response)
 16582*    end-exec
 16583     MOVE 'ERCHEK' TO DFHEIV1
 16584     MOVE 0
 16585       TO DFHEIV11
 16586*    MOVE '&,         G          &  N#00014517' TO DFHEIV0
 16587     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16588     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16589     MOVE X'204E233030303134353137' TO DFHEIV0(25:11)
 16590     CALL 'kxdfhei1' USING DFHEIV0,
 16591           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 301
* EL6311.cbl
 16592           erchek-key,
 16593           DFHEIV99,
 16594           DFHEIV11,
 16595           DFHEIV99
 16596     MOVE EIBRESP  TO ws-response
 16597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16598
 16599     IF RESP-NORMAL
 16600        move 'Y'                 to ws-chek-browse-sw
 16601     end-if
 16602
 16603     .
 16604 2510-exit.
 16605     exit.
 16606
 16607 2520-readnext-erchek.
 16608
 16609
 16610* EXEC CICS READNEXT
 16611*       SET     (ADDRESS OF CHECK-RECORDS)
 16612*       DATASET ('ERCHEK')
 16613*       RIDFLD  (ERCHEK-KEY)
 16614*       RESP    (WS-RESPONSE)
 16615*    END-EXEC
 16616     MOVE 'ERCHEK' TO DFHEIV1
 16617     MOVE 0
 16618       TO DFHEIV11
 16619*    MOVE '&.S                   )  N#00014534' TO DFHEIV0
 16620     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16621     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16622     MOVE X'204E233030303134353334' TO DFHEIV0(25:11)
 16623     CALL 'kxdfhei1' USING DFHEIV0,
 16624           DFHEIV1,
 16625           DFHEIV20,
 16626           DFHEIV99,
 16627           ERCHEK-KEY,
 16628           DFHEIV99,
 16629           DFHEIV11,
 16630           DFHEIV99,
 16631           DFHEIV99
 16632     SET ADDRESS OF CHECK-RECORDS TO
 16633         DFHEIV20
 16634     MOVE EIBRESP  TO WS-RESPONSE
 16635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16636
 16637     .
 16638 2520-exit.
 16639     exit.
 16640
 16641 2525-endbr-erchek.
 16642
 16643
 16644* exec cics endbr
 16645*       dataset  ('ERCHEK')
 16646*    end-exec
 16647     MOVE 'ERCHEK' TO DFHEIV1
 16648     MOVE 0
 16649       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 302
* EL6311.cbl
 16650*    MOVE '&2                    $   #00014547' TO DFHEIV0
 16651     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16652     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16653     MOVE X'2020233030303134353437' TO DFHEIV0(25:11)
 16654     CALL 'kxdfhei1' USING DFHEIV0,
 16655           DFHEIV1,
 16656           DFHEIV11,
 16657           DFHEIV99
 16658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16659
 16660     .
 16661 2525-exit.
 16662     exit.
 16663
 16664 2530-readupd-erchek.
 16665
 16666
 16667* EXEC CICS READ
 16668*       UPDATE
 16669*       SET     (ADDRESS OF CHECK-RECORDS)
 16670*       DATASET ('ERCHEK')
 16671*       RIDFLD  (ERCHEK-KEY)
 16672*       RESP    (WS-RESPONSE)
 16673*    END-EXEC
 16674     MOVE 'ERCHEK' TO DFHEIV1
 16675*    MOVE '&"S        EU         (  N#00014557' TO DFHEIV0
 16676     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16677     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16678     MOVE X'204E233030303134353537' TO DFHEIV0(25:11)
 16679     CALL 'kxdfhei1' USING DFHEIV0,
 16680           DFHEIV1,
 16681           DFHEIV20,
 16682           DFHEIV99,
 16683           ERCHEK-KEY,
 16684           DFHEIV99,
 16685           DFHEIV99,
 16686           DFHEIV99
 16687     SET ADDRESS OF CHECK-RECORDS TO
 16688         DFHEIV20
 16689     MOVE EIBRESP  TO WS-RESPONSE
 16690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16691
 16692     .
 16693 2530-exit.
 16694     exit.
 16695
 16696 2540-delete-erchek.
 16697
 16698
 16699* EXEC CICS DELETE
 16700*       DATASET ('ERCHEK')
 16701*       RESP    (WS-RESPONSE)
 16702*    END-EXEC
 16703     MOVE 'ERCHEK' TO DFHEIV1
 16704*    MOVE '&(                    &  N#00014571' TO DFHEIV0
 16705     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16707     MOVE X'204E233030303134353731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 303
* EL6311.cbl
 16708     CALL 'kxdfhei1' USING DFHEIV0,
 16709           DFHEIV1,
 16710           DFHEIV99,
 16711           DFHEIV99,
 16712           DFHEIV99,
 16713           DFHEIV99
 16714     MOVE EIBRESP  TO WS-RESPONSE
 16715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16716
 16717     .
 16718 2540-exit.
 16719     exit.
 16720***************************************************************
 16721*                                                             *
 16722*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16723*                                                             *
 16724***************************************************************
 16725
 16726***************************************************************
 16727*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16728*     AN ALREADY BILLED RECORD.                               *
 16729***************************************************************
 16730
 16731 2700-BUILD-CORRECTION-RECORD.
 16732     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16733     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16734     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16735     MOVE '5'                    TO DC-OPTION-CODE.
 16736     PERFORM 9700-DATE-LINK.
 16737     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16738
 16739     IF PB-CHG-COUNT = ZEROS
 16740        MOVE +1                  TO WS-SEQ-SAVE
 16741     ELSE
 16742        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16743
 16744     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16745     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16746
 16747     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16748
 16749     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16750     MOVE 'A'                    TO JP-RECORD-TYPE.
 16751     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16752
 16753
 16754* EXEC CICS WRITE
 16755*        DATASET    (FILE-ID-ERPNDB)
 16756*        FROM       (PENDING-BUSINESS)
 16757*        RIDFLD     (PB-CONTROL-PRIMARY)
 16758*    END-EXEC.
 16759     MOVE LENGTH OF
 16760      PENDING-BUSINESS
 16761       TO DFHEIV11
 16762*    MOVE '&$ L                  ''   #00014612' TO DFHEIV0
 16763     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16764     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16765     MOVE X'2020233030303134363132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 304
* EL6311.cbl
 16766     CALL 'kxdfhei1' USING DFHEIV0,
 16767           FILE-ID-ERPNDB,
 16768           PENDING-BUSINESS,
 16769           DFHEIV11,
 16770           PB-CONTROL-PRIMARY,
 16771           DFHEIV99,
 16772           DFHEIV99
 16773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16774
 16775
 16776     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16777
 16778     PERFORM 8400-LOG-JOURNAL-RECORD.
 16779
 16780 2799-EXIT.
 16781      EXIT.
 16782
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 305
* EL6311.cbl
 16784
 16785******************************************************************
 16786*                                                                *
 16787*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16788*                                                                *
 16789******************************************************************
 16790
 16791 2800-REWRITE-ISSUE-CERT-KEY.
 16792     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16793
 16794     IF  BCERTNOL GREATER THAN ZEROS
 16795         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16796
 16797     IF  BSUFIXL  GREATER THAN ZEROS
 16798         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16799
 16800     IF  BEFFDTL  GREATER THAN ZEROS
 16801         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16802
 16803 2810-READ-BY-ACCOUNT.
 16804
 16805* EXEC CICS HANDLE CONDITION
 16806*         NOTFND    (2820-PROCESS-REWRITE)
 16807*    END-EXEC.
 16808*    MOVE '"$I                   ! = #00014646' TO DFHEIV0
 16809     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16811     MOVE X'3D20233030303134363436' TO DFHEIV0(25:11)
 16812     CALL 'kxdfhei1' USING DFHEIV0
 16813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16814
 16815
 16816
 16817* EXEC CICS READ
 16818*        SET     (ADDRESS OF PENDING-BUSINESS)
 16819*        DATASET (FILE-ID-ERPNDB2)
 16820*        RIDFLD  (ERPNDB-ALT-KEY)
 16821*    END-EXEC.
 16822*    MOVE '&"S        E          (   #00014650' TO DFHEIV0
 16823     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16824     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16825     MOVE X'2020233030303134363530' TO DFHEIV0(25:11)
 16826     CALL 'kxdfhei1' USING DFHEIV0,
 16827           FILE-ID-ERPNDB2,
 16828           DFHEIV20,
 16829           DFHEIV99,
 16830           ERPNDB-ALT-KEY,
 16831           DFHEIV99,
 16832           DFHEIV99,
 16833           DFHEIV99
 16834     SET ADDRESS OF PENDING-BUSINESS TO
 16835         DFHEIV20
 16836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16837
 16838
 16839     GO TO 2890-DUPLICATE-RECORD.
 16840
 16841  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 306
* EL6311.cbl
 16842
 16843* EXEC CICS HANDLE CONDITION
 16844*         NOTFND    (2885-RECORD-MISSING)
 16845*    END-EXEC.
 16846*    MOVE '"$I                   ! > #00014659' TO DFHEIV0
 16847     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16849     MOVE X'3E20233030303134363539' TO DFHEIV0(25:11)
 16850     CALL 'kxdfhei1' USING DFHEIV0
 16851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16852
 16853
 16854     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16855
 16856
 16857* EXEC CICS READ
 16858*        SET     (ADDRESS OF PENDING-BUSINESS)
 16859*        DATASET (FILE-ID-ERPNDB)
 16860*        RIDFLD  (ERPNDB-KEY)
 16861*        UPDATE
 16862*    END-EXEC.
 16863*    MOVE '&"S        EU         (   #00014665' TO DFHEIV0
 16864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16865     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16866     MOVE X'2020233030303134363635' TO DFHEIV0(25:11)
 16867     CALL 'kxdfhei1' USING DFHEIV0,
 16868           FILE-ID-ERPNDB,
 16869           DFHEIV20,
 16870           DFHEIV99,
 16871           ERPNDB-KEY,
 16872           DFHEIV99,
 16873           DFHEIV99,
 16874           DFHEIV99
 16875     SET ADDRESS OF PENDING-BUSINESS TO
 16876         DFHEIV20
 16877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16878
 16879
 16880     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16881     MOVE 'D'                    TO JP-RECORD-TYPE.
 16882     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16883     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16884
 16885     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16886
 16887     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16888     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16889     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16890
 16891
 16892* EXEC CICS DELETE
 16893*        DATASET    (FILE-ID-ERPNDB)
 16894*    END-EXEC.
 16895*    MOVE '&(                    &   #00014683' TO DFHEIV0
 16896     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16897     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16898     MOVE X'2020233030303134363833' TO DFHEIV0(25:11)
 16899     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 307
* EL6311.cbl
 16900           FILE-ID-ERPNDB,
 16901           DFHEIV99,
 16902           DFHEIV99,
 16903           DFHEIV99,
 16904           DFHEIV99
 16905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16906
 16907
 16908     PERFORM 8400-LOG-JOURNAL-RECORD.
 16909
 16910
 16911* EXEC CICS GETMAIN
 16912*        SET      (ADDRESS OF PENDING-BUSINESS)
 16913*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16914*        INITIMG  (GETMAIN-SPACE)
 16915*    END-EXEC.
 16916*    MOVE ',"IL                  $   #00014689' TO DFHEIV0
 16917     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16918     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16919     MOVE X'2020233030303134363839' TO DFHEIV0(25:11)
 16920     CALL 'kxdfhei1' USING DFHEIV0,
 16921           DFHEIV20,
 16922           ERPNDB-RECORD-LENGTH,
 16923           GETMAIN-SPACE
 16924     SET ADDRESS OF PENDING-BUSINESS TO
 16925         DFHEIV20
 16926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16927
 16928
 16929     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16930
 16931
 16932* EXEC CICS HANDLE CONDITION
 16933*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16934*    END-EXEC.
 16935*    MOVE '"$I                   ! ? #00014697' TO DFHEIV0
 16936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16938     MOVE X'3F20233030303134363937' TO DFHEIV0(25:11)
 16939     CALL 'kxdfhei1' USING DFHEIV0
 16940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16941
 16942
 16943
 16944* EXEC CICS READ
 16945*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16946*        DATASET (FILE-ID-ELCERT)
 16947*        RIDFLD  (ELCERT-KEY)
 16948*        UPDATE
 16949*    END-EXEC.
 16950*    MOVE '&"S        EU         (   #00014701' TO DFHEIV0
 16951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16952     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16953     MOVE X'2020233030303134373031' TO DFHEIV0(25:11)
 16954     CALL 'kxdfhei1' USING DFHEIV0,
 16955           FILE-ID-ELCERT,
 16956           DFHEIV20,
 16957           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 308
* EL6311.cbl
 16958           ELCERT-KEY,
 16959           DFHEIV99,
 16960           DFHEIV99,
 16961           DFHEIV99
 16962     SET ADDRESS OF CERTIFICATE-MASTER TO
 16963         DFHEIV20
 16964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16965
 16966
 16967     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16968     MOVE 'B'                    TO JP-RECORD-TYPE
 16969     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16970     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16971
 16972     IF INSURED-ADDR-PRESENT
 16973        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16974
 16975     IF CERT-NOTES-ARE-NOT-PRESENT
 16976        MOVE SPACE               TO WS-CERT-NOTE-SW
 16977     ELSE
 16978        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16979
 16980     IF CERT-ADDED-BATCH      OR
 16981        CERT-AND-CLAIM-ONLINE OR
 16982        CERT-WAS-CREATED-FOR-CLAIM
 16983        NEXT SENTENCE
 16984     ELSE
 16985        GO TO 2825-DELETE-CERTIFICATE.
 16986
 16987     PERFORM 8400-LOG-JOURNAL-RECORD.
 16988
 16989*********************************************************
 16990** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16991     IF CERT-ADDED-BATCH
 16992         GO TO 2822-REWRITE-ELCERT.
 16993*********************************************************
 16994
 16995     IF NO-CLAIM-ATTACHED
 16996        NEXT SENTENCE
 16997     ELSE
 16998        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16999        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17000
 17001 2822-REWRITE-ELCERT.
 17002     MOVE 'C'                    TO JP-RECORD-TYPE
 17003     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17004
 17005     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17006
 17007
 17008* EXEC CICS REWRITE
 17009*         DATASET    (FILE-ID-ELCERT)
 17010*         FROM       (CERTIFICATE-MASTER)
 17011*    END-EXEC.
 17012     MOVE LENGTH OF
 17013      CERTIFICATE-MASTER
 17014       TO DFHEIV11
 17015*    MOVE '&& L                  %   #00014748' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 309
* EL6311.cbl
 17016     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17017     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17018     MOVE X'2020233030303134373438' TO DFHEIV0(25:11)
 17019     CALL 'kxdfhei1' USING DFHEIV0,
 17020           FILE-ID-ELCERT,
 17021           CERTIFICATE-MASTER,
 17022           DFHEIV11,
 17023           DFHEIV99
 17024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17025
 17026
 17027     PERFORM 8400-LOG-JOURNAL-RECORD.
 17028
 17029     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17030
 17031 2825-DELETE-CERTIFICATE.
 17032     MOVE 'D'                      TO JP-RECORD-TYPE.
 17033     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17034
 17035     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17036
 17037
 17038* EXEC CICS DELETE
 17039*         DATASET    (FILE-ID-ELCERT)
 17040*    END-EXEC.
 17041*    MOVE '&(                    &   #00014763' TO DFHEIV0
 17042     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17043     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17044     MOVE X'2020233030303134373633' TO DFHEIV0(25:11)
 17045     CALL 'kxdfhei1' USING DFHEIV0,
 17046           FILE-ID-ELCERT,
 17047           DFHEIV99,
 17048           DFHEIV99,
 17049           DFHEIV99,
 17050           DFHEIV99
 17051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17052
 17053
 17054     PERFORM 8400-LOG-JOURNAL-RECORD.
 17055
 17056******************************************************************
 17057*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17058******************************************************************
 17059
 17060     IF CERT-NOTES-ARE-PRESENT
 17061        NEXT SENTENCE
 17062     ELSE
 17063        GO TO 2827-DELETE-MAILING.
 17064
 17065
 17066* EXEC CICS HANDLE CONDITION
 17067*         NOTFND  (2827-DELETE-MAILING)
 17068*    END-EXEC.
 17069*    MOVE '"$I                   ! @ #00014778' TO DFHEIV0
 17070     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17071     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17072     MOVE X'4020233030303134373738' TO DFHEIV0(25:11)
 17073     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 310
* EL6311.cbl
 17074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17075
 17076
 17077
 17078* EXEC CICS READ
 17079*        EQUAL
 17080*        DATASET   (FILE-ID-ERNOTE)
 17081*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17082*        RIDFLD    (ELCERT-KEY)
 17083*        UPDATE
 17084*    END-EXEC.
 17085*    MOVE '&"S        EU         (   #00014782' TO DFHEIV0
 17086     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17087     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17088     MOVE X'2020233030303134373832' TO DFHEIV0(25:11)
 17089     CALL 'kxdfhei1' USING DFHEIV0,
 17090           FILE-ID-ERNOTE,
 17091           DFHEIV20,
 17092           DFHEIV99,
 17093           ELCERT-KEY,
 17094           DFHEIV99,
 17095           DFHEIV99,
 17096           DFHEIV99
 17097     SET ADDRESS OF CERTIFICATE-NOTE TO
 17098         DFHEIV20
 17099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17100
 17101
 17102     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17103     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17104     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17105
 17106     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17107
 17108
 17109* EXEC CICS DELETE
 17110*        DATASET   (FILE-ID-ERNOTE)
 17111*    END-EXEC.
 17112*    MOVE '&(                    &   #00014796' TO DFHEIV0
 17113     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17114     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17115     MOVE X'2020233030303134373936' TO DFHEIV0(25:11)
 17116     CALL 'kxdfhei1' USING DFHEIV0,
 17117           FILE-ID-ERNOTE,
 17118           DFHEIV99,
 17119           DFHEIV99,
 17120           DFHEIV99,
 17121           DFHEIV99
 17122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17123
 17124
 17125     PERFORM 8400-LOG-JOURNAL-RECORD.
 17126
 17127******************************************************************
 17128*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17129******************************************************************
 17130
 17131 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 311
* EL6311.cbl
 17132     IF CERT-ADDRESS-PRESENT
 17133        NEXT SENTENCE
 17134     ELSE
 17135        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17136
 17137
 17138* EXEC CICS HANDLE CONDITION
 17139*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17140*    END-EXEC.
 17141*    MOVE '"$I                   ! A #00014812' TO DFHEIV0
 17142     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17144     MOVE X'4120233030303134383132' TO DFHEIV0(25:11)
 17145     CALL 'kxdfhei1' USING DFHEIV0
 17146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17147
 17148
 17149     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17150
 17151
 17152* EXEC CICS READ
 17153*        EQUAL
 17154*        DATASET   (FILE-ID-ERMAIL)
 17155*        SET       (ADDRESS OF MAILING-DATA)
 17156*        RIDFLD    (ERMAIL-KEY)
 17157*        UPDATE
 17158*    END-EXEC.
 17159*    MOVE '&"S        EU         (   #00014818' TO DFHEIV0
 17160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17161     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17162     MOVE X'2020233030303134383138' TO DFHEIV0(25:11)
 17163     CALL 'kxdfhei1' USING DFHEIV0,
 17164           FILE-ID-ERMAIL,
 17165           DFHEIV20,
 17166           DFHEIV99,
 17167           ERMAIL-KEY,
 17168           DFHEIV99,
 17169           DFHEIV99,
 17170           DFHEIV99
 17171     SET ADDRESS OF MAILING-DATA TO
 17172         DFHEIV20
 17173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17174
 17175
 17176     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17177     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17178     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17179
 17180     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17181
 17182
 17183* EXEC CICS DELETE
 17184*        DATASET   (FILE-ID-ERMAIL)
 17185*    END-EXEC.
 17186*    MOVE '&(                    &   #00014832' TO DFHEIV0
 17187     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17188     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17189     MOVE X'2020233030303134383332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 312
* EL6311.cbl
 17190     CALL 'kxdfhei1' USING DFHEIV0,
 17191           FILE-ID-ERMAIL,
 17192           DFHEIV99,
 17193           DFHEIV99,
 17194           DFHEIV99,
 17195           DFHEIV99
 17196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17197
 17198
 17199     PERFORM 8400-LOG-JOURNAL-RECORD.
 17200
 17201 2830-BUILD-NEW-ISSUE-RECORD.
 17202     MOVE SPACES                 TO ELCERT-KEY.
 17203
 17204     IF  BCERTNOL GREATER THAN ZEROS
 17205         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17206
 17207     IF  BSUFIXL  GREATER THAN ZEROS
 17208         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17209
 17210     IF BEFFDTL GREATER THAN ZEROS
 17211        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17212
 17213 2870-WRITE-PENDING-BUSINESS.
 17214     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17215     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17216     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17217     MOVE '5'                    TO DC-OPTION-CODE.
 17218     PERFORM 9700-DATE-LINK.
 17219     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17220
 17221     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17222
 17223     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17224     MOVE 'A'                    TO JP-RECORD-TYPE.
 17225     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17226
 17227
 17228* EXEC CICS WRITE
 17229*        DATASET  (FILE-ID-ERPNDB)
 17230*        FROM     (PENDING-BUSINESS)
 17231*        RIDFLD   (PB-CONTROL-PRIMARY)
 17232*    END-EXEC.
 17233     MOVE LENGTH OF
 17234      PENDING-BUSINESS
 17235       TO DFHEIV11
 17236*    MOVE '&$ L                  ''   #00014864' TO DFHEIV0
 17237     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17238     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17239     MOVE X'2020233030303134383634' TO DFHEIV0(25:11)
 17240     CALL 'kxdfhei1' USING DFHEIV0,
 17241           FILE-ID-ERPNDB,
 17242           PENDING-BUSINESS,
 17243           DFHEIV11,
 17244           PB-CONTROL-PRIMARY,
 17245           DFHEIV99,
 17246           DFHEIV99
 17247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 313
* EL6311.cbl
 17248
 17249
 17250     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17251
 17252     PERFORM 8400-LOG-JOURNAL-RECORD.
 17253
 17254     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17255
 17256 2885-RECORD-MISSING.
 17257     MOVE -1                     TO BMAINTL
 17258     MOVE AL-UABON               TO BMAINTA
 17259     MOVE ER-2902                TO EMI-ERROR.
 17260     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17261     GO TO 8200-SEND-DATAONLY.
 17262
 17263 2890-DUPLICATE-RECORD.
 17264     MOVE -1                     TO BMAINTL.
 17265     MOVE AL-UABON               TO BCERTNOA.
 17266     MOVE AL-UNBON               TO BEFFDTA.
 17267     MOVE SPACE                  TO BMAINTI.
 17268
 17269     MOVE 1                      TO EMI-SUB
 17270                                    EMI-SWITCH1
 17271                                    EMI-SWITCH-AREA-1
 17272                                    EMI-SWITCH-AREA-2.
 17273
 17274     MOVE SPACES                 TO EMI-ERROR-LINES.
 17275
 17276
 17277* EXEC CICS SYNCPOINT ROLLBACK
 17278*    END-EXEC.
 17279*    MOVE '6"R                   !   #00014896' TO DFHEIV0
 17280     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17282     MOVE X'2020233030303134383936' TO DFHEIV0(25:11)
 17283     CALL 'kxdfhei1' USING DFHEIV0
 17284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17285
 17286
 17287     MOVE ER-2247                TO EMI-ERROR.
 17288     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17289     GO TO 8200-SEND-DATAONLY.
 17290
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 314
* EL6311.cbl
 17292
 17293******************************************************************
 17294*                                                                *
 17295*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17296*                                                                *
 17297******************************************************************
 17298
 17299 2900-REWRITE-CAN-CERT-KEY.
 17300     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17301
 17302     IF  CCERTNOL GREATER THAN ZEROS
 17303         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17304
 17305     IF  CSUFIXL  GREATER THAN ZEROS
 17306         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17307
 17308     IF  CEFFDTL  GREATER THAN ZEROS
 17309         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17310
 17311 2910-READ-BY-ACCOUNT.
 17312
 17313* EXEC CICS HANDLE CONDITION
 17314*         NOTFND    (2920-PROCESS-REWRITE)
 17315*    END-EXEC.
 17316*    MOVE '"$I                   ! B #00014924' TO DFHEIV0
 17317     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17319     MOVE X'4220233030303134393234' TO DFHEIV0(25:11)
 17320     CALL 'kxdfhei1' USING DFHEIV0
 17321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17322
 17323
 17324
 17325* EXEC CICS READ
 17326*        SET     (ADDRESS OF PENDING-BUSINESS)
 17327*        DATASET (FILE-ID-ERPNDB2)
 17328*        RIDFLD  (ERPNDB-ALT-KEY)
 17329*    END-EXEC.
 17330*    MOVE '&"S        E          (   #00014928' TO DFHEIV0
 17331     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17333     MOVE X'2020233030303134393238' TO DFHEIV0(25:11)
 17334     CALL 'kxdfhei1' USING DFHEIV0,
 17335           FILE-ID-ERPNDB2,
 17336           DFHEIV20,
 17337           DFHEIV99,
 17338           ERPNDB-ALT-KEY,
 17339           DFHEIV99,
 17340           DFHEIV99,
 17341           DFHEIV99
 17342     SET ADDRESS OF PENDING-BUSINESS TO
 17343         DFHEIV20
 17344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17345
 17346
 17347     GO TO 2990-DUPLICATE-RECORD.
 17348
 17349  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 315
* EL6311.cbl
 17350
 17351* EXEC CICS HANDLE CONDITION
 17352*         NOTFND    (2985-RECORD-MISSING)
 17353*    END-EXEC.
 17354*    MOVE '"$I                   ! C #00014937' TO DFHEIV0
 17355     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17357     MOVE X'4320233030303134393337' TO DFHEIV0(25:11)
 17358     CALL 'kxdfhei1' USING DFHEIV0
 17359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17360
 17361
 17362     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17363
 17364
 17365* EXEC CICS READ
 17366*        SET     (ADDRESS OF PENDING-BUSINESS)
 17367*        DATASET (FILE-ID-ERPNDB)
 17368*        RIDFLD  (ERPNDB-KEY)
 17369*        UPDATE
 17370*    END-EXEC.
 17371*    MOVE '&"S        EU         (   #00014943' TO DFHEIV0
 17372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17374     MOVE X'2020233030303134393433' TO DFHEIV0(25:11)
 17375     CALL 'kxdfhei1' USING DFHEIV0,
 17376           FILE-ID-ERPNDB,
 17377           DFHEIV20,
 17378           DFHEIV99,
 17379           ERPNDB-KEY,
 17380           DFHEIV99,
 17381           DFHEIV99,
 17382           DFHEIV99
 17383     SET ADDRESS OF PENDING-BUSINESS TO
 17384         DFHEIV20
 17385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17386
 17387
 17388     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17389     MOVE 'D'                    TO JP-RECORD-TYPE.
 17390     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17391     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17392
 17393     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17394
 17395     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17396     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17397     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17398
 17399
 17400* EXEC CICS DELETE
 17401*        DATASET    (FILE-ID-ERPNDB)
 17402*    END-EXEC.
 17403*    MOVE '&(                    &   #00014961' TO DFHEIV0
 17404     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17405     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17406     MOVE X'2020233030303134393631' TO DFHEIV0(25:11)
 17407     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 316
* EL6311.cbl
 17408           FILE-ID-ERPNDB,
 17409           DFHEIV99,
 17410           DFHEIV99,
 17411           DFHEIV99,
 17412           DFHEIV99
 17413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17414
 17415
 17416     PERFORM 8400-LOG-JOURNAL-RECORD.
 17417
 17418
 17419* EXEC CICS GETMAIN
 17420*        SET      (ADDRESS OF PENDING-BUSINESS)
 17421*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17422*        INITIMG  (GETMAIN-SPACE)
 17423*    END-EXEC.
 17424*    MOVE ',"IL                  $   #00014967' TO DFHEIV0
 17425     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17427     MOVE X'2020233030303134393637' TO DFHEIV0(25:11)
 17428     CALL 'kxdfhei1' USING DFHEIV0,
 17429           DFHEIV20,
 17430           ERPNDB-RECORD-LENGTH,
 17431           GETMAIN-SPACE
 17432     SET ADDRESS OF PENDING-BUSINESS TO
 17433         DFHEIV20
 17434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17435
 17436
 17437     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17438
 17439 2950-PROCESS-CANCELS.
 17440
 17441
 17442* EXEC CICS HANDLE CONDITION
 17443*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17444*    END-EXEC.
 17445*    MOVE '"$I                   ! D #00014977' TO DFHEIV0
 17446     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17448     MOVE X'4420233030303134393737' TO DFHEIV0(25:11)
 17449     CALL 'kxdfhei1' USING DFHEIV0
 17450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17451
 17452
 17453
 17454* EXEC CICS READ
 17455*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17456*        DATASET (FILE-ID-ELCERT)
 17457*        RIDFLD  (ELCERT-KEY)
 17458*        UPDATE
 17459*    END-EXEC.
 17460*    MOVE '&"S        EU         (   #00014981' TO DFHEIV0
 17461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17462     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17463     MOVE X'2020233030303134393831' TO DFHEIV0(25:11)
 17464     CALL 'kxdfhei1' USING DFHEIV0,
 17465           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 317
* EL6311.cbl
 17466           DFHEIV20,
 17467           DFHEIV99,
 17468           ELCERT-KEY,
 17469           DFHEIV99,
 17470           DFHEIV99,
 17471           DFHEIV99
 17472     SET ADDRESS OF CERTIFICATE-MASTER TO
 17473         DFHEIV20
 17474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17475
 17476
 17477     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17478
 17479     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17480     MOVE 'B'                      TO JP-RECORD-TYPE.
 17481     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17482     PERFORM 8400-LOG-JOURNAL-RECORD.
 17483
 17484     IF PB-CI-LIVES NOT NUMERIC
 17485         MOVE ZERO                    TO PB-CI-LIVES.
 17486
 17487     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17488        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17489        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17490        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17491                                         CM-LF-CANCEL-DT
 17492     ELSE
 17493        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17494        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17495        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17496        MOVE PB-CI-LIVES              TO CM-LIVES.
 17497
 17498     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17499        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17500            MOVE CM-LF-STATUS-AT-CANCEL
 17501                                     TO CM-LF-CURRENT-STATUS
 17502            MOVE SPACE
 17503                                     TO CM-LF-STATUS-AT-CANCEL
 17504        ELSE
 17505            MOVE PB-CI-LF-POLICY-STATUS
 17506                                     TO CM-LF-CURRENT-STATUS
 17507     ELSE
 17508        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17509
 17510     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17511        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17512        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17513        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17514                                         CM-AH-CANCEL-DT
 17515     ELSE
 17516        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17517        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17518        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17519        MOVE PB-CI-LIVES              TO CM-LIVES.
 17520
 17521     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17522        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17523            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 318
* EL6311.cbl
 17524                                     TO CM-AH-CURRENT-STATUS
 17525            MOVE SPACE
 17526                                     TO CM-AH-STATUS-AT-CANCEL
 17527        ELSE
 17528            MOVE PB-CI-AH-POLICY-STATUS
 17529                                     TO CM-AH-CURRENT-STATUS
 17530     ELSE
 17531        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17532
 17533 2975-REWRITE-CERT.
 17534     MOVE 'C'                      TO JP-RECORD-TYPE.
 17535     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17536
 17537
 17538* EXEC CICS REWRITE
 17539*        DATASET    (FILE-ID-ELCERT)
 17540*        FROM       (CERTIFICATE-MASTER)
 17541*    END-EXEC.
 17542     MOVE LENGTH OF
 17543      CERTIFICATE-MASTER
 17544       TO DFHEIV11
 17545*    MOVE '&& L                  %   #00015048' TO DFHEIV0
 17546     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17547     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17548     MOVE X'2020233030303135303438' TO DFHEIV0(25:11)
 17549     CALL 'kxdfhei1' USING DFHEIV0,
 17550           FILE-ID-ELCERT,
 17551           CERTIFICATE-MASTER,
 17552           DFHEIV11,
 17553           DFHEIV99
 17554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17555
 17556
 17557     PERFORM 8400-LOG-JOURNAL-RECORD.
 17558
 17559 2960-BUILD-NEW-CANCEL-RECORD.
 17560     IF  CCERTNOL GREATER THAN ZEROS
 17561         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17562
 17563     IF  CSUFIXL  GREATER THAN ZEROS
 17564         MOVE CSUFIXI             TO PB-CERT-SFX.
 17565
 17566     IF  CEFFDTL  GREATER  THAN ZEROS
 17567         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17568
 17569 2970-WRITE-PENDING-BUSINESS.
 17570     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17571     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17572     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17573     MOVE '5'                    TO DC-OPTION-CODE.
 17574     PERFORM 9700-DATE-LINK.
 17575     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17576
 17577     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17578
 17579     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17580                                    PB-CI-INSURED-SEX
 17581                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 319
* EL6311.cbl
 17582                                    PB-CI-AH-BENEFIT-CD
 17583                                    PB-CI-RATE-CLASS
 17584                                    PB-CI-RATE-DEV-LF
 17585                                    PB-CI-RATE-DEV-AH
 17586                                    PB-CI-LF-ABBR
 17587                                    PB-CI-AH-ABBR
 17588                                    PB-CI-OB-FLAG
 17589                                    PB-CI-LF-POLICY-STATUS
 17590                                    PB-CI-AH-POLICY-STATUS
 17591                                    PB-CI-INDV-GRP-CD
 17592                                    PB-CI-BENEFICIARY-NAME
 17593                                    PB-CI-NOTE-SW
 17594                                    PB-CI-SOC-SEC-NO
 17595                                    PB-CI-MEMBER-NO
 17596                                    PB-CI-INT-CODE
 17597                                    PB-CI-COMP-EXCP-SW
 17598                                    PB-CI-ENTRY-STATUS
 17599                                    PB-CI-CREDIT-INTERFACE-SW-1
 17600                                    PB-CI-CREDIT-INTERFACE-SW-2
 17601                                    PB-CI-ENTRY-BATCH.
 17602
 17603     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17604                                    PB-CI-AH-SETTLEMENT-DT
 17605                                    PB-CI-DEATH-DT
 17606                                    PB-CI-LF-PRIOR-CANCEL-DT
 17607                                    PB-CI-AH-PRIOR-CANCEL-DT
 17608                                    PB-CI-LOAN-1ST-PMT-DT
 17609                                    PB-CI-ENTRY-DT
 17610                                    PB-CI-LF-EXPIRE-DT
 17611                                    PB-CI-AH-EXPIRE-DT.
 17612
 17613     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17614                                    PB-CI-LF-TERM
 17615                                    PB-CI-LF-BENEFIT-AMT
 17616                                    PB-CI-LF-ALT-BENEFIT-AMT
 17617                                    PB-CI-LF-PREMIUM-AMT
 17618                                    PB-CI-LF-ALT-PREMIUM-AMT
 17619                                    PB-CI-AH-TERM
 17620                                    PB-CI-AH-BENEFIT-AMT
 17621                                    PB-CI-AH-PREMIUM-AMT
 17622                                    PB-CI-RATE-DEV-PCT-LF
 17623                                    PB-CI-RATE-DEV-PCT-AH
 17624                                    PB-CI-LIFE-COMMISSION
 17625                                    PB-CI-AH-COMMISSION
 17626                                    PB-CI-PAY-FREQUENCY
 17627                                    PB-CI-LOAN-APR
 17628                                    PB-CI-LOAN-TERM
 17629                                    PB-CI-CURR-SEQ
 17630                                    PB-CI-AH-CANCEL-AMT
 17631                                    PB-CI-LF-CANCEL-AMT
 17632                                    PB-CI-EXTENTION-DAYS
 17633                                    PB-CI-TERM-IN-DAYS
 17634                                    PB-CI-LOAN-OFFICER
 17635                                    PB-CI-LIVES
 17636                                    PB-CI-LF-CRIT-PER
 17637                                    PB-CI-AH-CRIT-PER
 17638                                    PB-C-LF-REM-TERM
 17639                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 320
* EL6311.cbl
 17640
 17641     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17642     MOVE 'A'                    TO JP-RECORD-TYPE.
 17643     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17644
 17645
 17646* EXEC CICS HANDLE CONDITION
 17647*        DUPREC   (2990-DUPLICATE-RECORD)
 17648*    END-EXEC.
 17649*    MOVE '"$%                   ! E #00015141' TO DFHEIV0
 17650     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17652     MOVE X'4520233030303135313431' TO DFHEIV0(25:11)
 17653     CALL 'kxdfhei1' USING DFHEIV0
 17654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17655
 17656
 17657
 17658* EXEC CICS WRITE
 17659*        DATASET  (FILE-ID-ERPNDB)
 17660*        FROM     (PENDING-BUSINESS)
 17661*        RIDFLD   (PB-CONTROL-PRIMARY)
 17662*    END-EXEC.
 17663     MOVE LENGTH OF
 17664      PENDING-BUSINESS
 17665       TO DFHEIV11
 17666*    MOVE '&$ L                  ''   #00015145' TO DFHEIV0
 17667     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17669     MOVE X'2020233030303135313435' TO DFHEIV0(25:11)
 17670     CALL 'kxdfhei1' USING DFHEIV0,
 17671           FILE-ID-ERPNDB,
 17672           PENDING-BUSINESS,
 17673           DFHEIV11,
 17674           PB-CONTROL-PRIMARY,
 17675           DFHEIV99,
 17676           DFHEIV99
 17677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17678
 17679
 17680     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17681
 17682     PERFORM 8400-LOG-JOURNAL-RECORD.
 17683
 17684     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17685
 17686 2985-RECORD-MISSING.
 17687     MOVE -1                     TO CMAINTL
 17688     MOVE AL-UABON               TO CMAINTA.
 17689
 17690     MOVE ER-2902                TO EMI-ERROR.
 17691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17692     GO TO 8200-SEND-DATAONLY.
 17693
 17694 2990-DUPLICATE-RECORD.
 17695     MOVE SPACE                  TO CMAINTI.
 17696     MOVE -1                     TO CMAINTL.
 17697     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 321
* EL6311.cbl
 17698     MOVE AL-UNBON               TO CEFFDTA.
 17699
 17700     MOVE 1                      TO EMI-SUB
 17701                                    EMI-SWITCH1
 17702                                    EMI-SWITCH-AREA-1
 17703                                    EMI-SWITCH-AREA-2.
 17704     MOVE SPACES                 TO EMI-ERROR-LINES.
 17705
 17706
 17707* EXEC CICS SYNCPOINT ROLLBACK
 17708*    END-EXEC.
 17709*    MOVE '6"R                   !   #00015177' TO DFHEIV0
 17710     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17712     MOVE X'2020233030303135313737' TO DFHEIV0(25:11)
 17713     CALL 'kxdfhei1' USING DFHEIV0
 17714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17715
 17716
 17717     MOVE ER-2247                TO EMI-ERROR.
 17718     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17719     GO TO 8200-SEND-DATAONLY.
 17720
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 322
* EL6311.cbl
 17722
 17723***************************************************************
 17724*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17725*     PREMIUM FOR A SINGLE BATCH.                             *
 17726*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17727***************************************************************
 17728
 17729 3000-BATCH-MAINLINE.
 17730     IF PI-PREV-KEY NOT = SPACES
 17731         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17732     ELSE
 17733         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17734
 17735     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17736
 17737 3010-READNEXT.
 17738
 17739* EXEC CICS READ
 17740*         DATASET    (FILE-ID-ERPNDB)
 17741*         SET        (ADDRESS OF PENDING-BUSINESS)
 17742*         RIDFLD     (ERPNDB-KEY)
 17743*         GTEQ
 17744*    END-EXEC.
 17745*    MOVE '&"S        G          (   #00015201' TO DFHEIV0
 17746     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17748     MOVE X'2020233030303135323031' TO DFHEIV0(25:11)
 17749     CALL 'kxdfhei1' USING DFHEIV0,
 17750           FILE-ID-ERPNDB,
 17751           DFHEIV20,
 17752           DFHEIV99,
 17753           ERPNDB-KEY,
 17754           DFHEIV99,
 17755           DFHEIV99,
 17756           DFHEIV99
 17757     SET ADDRESS OF PENDING-BUSINESS TO
 17758         DFHEIV20
 17759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17760
 17761
 17762     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17763        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17764          GO TO 3030-END-BATCH.
 17765
 17766     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17767
 17768     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17769        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17770          GO TO 3020-BUMP-SEQ.
 17771
 17772     IF PB-ISSUE
 17773        ADD +1                   TO WS-ISS-TOTAL-CNT
 17774        IF PB-FATAL-ERRORS
 17775           ADD +1                      TO WS-ISS-FATAL-CNT
 17776           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17777           GO TO 3020-BUMP-SEQ
 17778        ELSE
 17779           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 323
* EL6311.cbl
 17780              ADD +1                      TO WS-ISS-FORCE-CNT
 17781              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17782              GO TO 3020-BUMP-SEQ
 17783           ELSE
 17784              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17785                 ADD +1                      TO WS-ISS-HOLD-CNT
 17786                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17787                 GO TO 3020-BUMP-SEQ
 17788              ELSE
 17789                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17790                     THRU  3299-EXIT
 17791                 GO TO 3020-BUMP-SEQ.
 17792
 17793     IF PB-CANCELLATION
 17794        ADD +1                   TO WS-CAN-TOTAL-CNT
 17795        IF PB-FATAL-ERRORS
 17796           ADD +1                 TO WS-CAN-FATAL-CNT
 17797           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17798           GO TO 3020-BUMP-SEQ
 17799        ELSE
 17800           IF PB-UNFORCED-ERRORS
 17801              ADD +1                 TO WS-CAN-FORCE-CNT
 17802              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17803              GO TO 3020-BUMP-SEQ
 17804           ELSE
 17805              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17806                 ADD +1                 TO WS-CAN-HOLD-CNT
 17807                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17808                 GO TO 3020-BUMP-SEQ
 17809              ELSE
 17810                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17811                     THRU  3499-EXIT
 17812                 GO TO 3020-BUMP-SEQ.
 17813
 17814     IF PB-BATCH-TRAILER
 17815         GO TO 3030-END-BATCH.
 17816
 17817 3020-BUMP-SEQ.
 17818     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17819     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17820     GO TO 3010-READNEXT.
 17821
 17822 3030-END-BATCH.
 17823     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17824     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17825     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17826     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17827
 17828     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17829                                          - WS-ISS-FORCE-CNT
 17830                                          - WS-ISS-HOLD-CNT).
 17831
 17832     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17833     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17834
 17835     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17836     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17837     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 324
* EL6311.cbl
 17838     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17839     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17840                                          - WS-CAN-FORCE-CNT
 17841                                          - WS-CAN-HOLD-CNT).
 17842     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17843     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17844
 17845     COMPUTE WS-NET-TOTAL-CNT
 17846         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17847     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17848     COMPUTE WS-NET-FATAL-CNT
 17849         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17850     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17851     COMPUTE WS-NET-FORCE-CNT
 17852         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17853     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17854     COMPUTE WS-NET-HOLD-CNT
 17855         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17856     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17857
 17858     COMPUTE WS-NET-AVAIL-CNT
 17859          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17860                              - WS-ISS-FORCE-CNT
 17861                              - WS-ISS-HOLD-CNT)
 17862          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17863                              - WS-CAN-FORCE-CNT
 17864                              - WS-CAN-HOLD-CNT).
 17865     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17866
 17867     COMPUTE WS-NET-GOOD-PREM
 17868         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17869     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17870     COMPUTE WS-NET-BAD-PREM
 17871         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17872     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17873
 17874     MOVE 0000                   TO EMI-ERROR.
 17875     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17876     MOVE -1                     TO DPFENTRL.
 17877     GO TO 8200-SEND-DATAONLY.
 17878
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 325
* EL6311.cbl
 17880
 17881******************************************************************
 17882*                                                                *
 17883*           A D D    B A D   I S S U E   P R E M I U M           *
 17884*                                                                *
 17885******************************************************************
 17886
 17887 3100-ADD-BAD-ISSUE-PREM.
 17888     IF PB-OVERRIDE-LIFE
 17889       OR PB-OVERRIDE-BOTH
 17890           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17891           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17892       ELSE
 17893           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17894           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17895
 17896     IF PB-OVERRIDE-AH
 17897       OR PB-OVERRIDE-BOTH
 17898           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17899       ELSE
 17900           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17901
 17902 3199-EXIT.
 17903     EXIT.
 17904
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 326
* EL6311.cbl
 17906
 17907******************************************************************
 17908*                                                                *
 17909*       A D D   G O O D   I S S U E   P R E M I U M              *
 17910*                                                                *
 17911******************************************************************
 17912
 17913 3200-ADD-GOOD-ISSUE-PREM.
 17914     IF PB-OVERRIDE-LIFE
 17915       OR PB-OVERRIDE-BOTH
 17916           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17917           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17918       ELSE
 17919           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17920           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17921
 17922     IF PB-OVERRIDE-AH
 17923       OR PB-OVERRIDE-BOTH
 17924           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17925       ELSE
 17926           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17927
 17928 3299-EXIT.
 17929     EXIT.
 17930
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 327
* EL6311.cbl
 17932
 17933
 17934******************************************************************
 17935*                                                                *
 17936*        A D D   B A D   C A N C E L   P R E M I U M             *
 17937*                                                                *
 17938******************************************************************
 17939
 17940 3300-ADD-BAD-CANCEL-PREM.
 17941     IF PB-OVERRIDE-LIFE
 17942       OR PB-OVERRIDE-BOTH
 17943           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17944       ELSE
 17945           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17946
 17947     IF PB-OVERRIDE-AH
 17948       OR PB-OVERRIDE-BOTH
 17949           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17950       ELSE
 17951           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17952
 17953 3399-EXIT.
 17954     EXIT.
 17955
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 328
* EL6311.cbl
 17957
 17958******************************************************************
 17959*                                                                *
 17960*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17961*                                                                *
 17962******************************************************************
 17963
 17964 3400-ADD-GOOD-CANCEL-PREM.
 17965     IF PB-OVERRIDE-LIFE
 17966       OR PB-OVERRIDE-BOTH
 17967           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17968       ELSE
 17969           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17970
 17971     IF PB-OVERRIDE-AH
 17972       OR PB-OVERRIDE-BOTH
 17973           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17974       ELSE
 17975           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17976
 17977 3499-EXIT.
 17978     EXIT.
 17979
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 329
* EL6311.cbl
 17981
 17982******************************************************************
 17983*                                                                *
 17984*           E D I T   B A T C H   D A T A                        *
 17985*                                                                *
 17986******************************************************************
 17987
 17988 3500-EDIT-BATCH-DATA.
 17989     IF PI-PREV-KEY NOT = SPACES
 17990        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17991     ELSE
 17992        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17993
 17994     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17995     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17996
 17997
 17998* EXEC CICS HANDLE CONDITION
 17999*         NOTFND      (3590-NOT-FOUND)
 18000*    END-EXEC.
 18001*    MOVE '"$I                   ! F #00015443' TO DFHEIV0
 18002     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18004     MOVE X'4620233030303135343433' TO DFHEIV0(25:11)
 18005     CALL 'kxdfhei1' USING DFHEIV0
 18006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18007
 18008
 18009     IF DRISSL   GREATER THAN ZEROS OR
 18010        DRISSL   GREATER THAN ZEROS OR
 18011        DRLFPRML GREATER THAN ZEROS OR
 18012        DRAHPRML GREATER THAN ZEROS OR
 18013        DRCANCL  GREATER THAN ZEROS OR
 18014        DRLFRFDL GREATER THAN ZEROS OR
 18015        DRAHRFDL GREATER THAN ZEROS
 18016              NEXT SENTENCE
 18017          ELSE
 18018              MOVE ER-3224    TO EMI-ERROR
 18019              MOVE -1         TO DPFENTRL
 18020              MOVE AL-UNBON   TO DPFENTRA
 18021              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18022              GO TO 8200-SEND-DATAONLY.
 18023
 18024     IF NOT MODIFY-CAP
 18025         MOVE 'UPDATE'       TO SM-READ
 18026         PERFORM 9995-SECURITY-VIOLATION
 18027         MOVE ER-0070        TO EMI-ERROR
 18028         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18029         GO TO 8100-SEND-INITIAL-MAP.
 18030
 18031        IF DRISSL GREATER THAN ZEROS
 18032           MOVE AL-UNNON         TO DRISSA
 18033           MOVE DRISSI           TO DEEDIT-FIELD
 18034           PERFORM 8600-DEEDIT
 18035           IF DEEDIT-FIELD-V0  NUMERIC
 18036              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18037           ELSE
 18038              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 330
* EL6311.cbl
 18039              MOVE -1         TO DRISSL
 18040              MOVE AL-UNBON   TO DRISSA
 18041              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18042
 18043        IF DRLFPRML GREATER THAN ZEROS
 18044           MOVE AL-UNNON         TO DRLFPRMA
 18045
 18046* EXEC CICS BIF DEEDIT
 18047*              FIELD  (DRLFPRMI)
 18048*              LENGTH (11)
 18049*          END-EXEC
 18050     MOVE 11
 18051       TO DFHEIV11
 18052*    MOVE '@"L                   #   #00015483' TO DFHEIV0
 18053     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18054     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18055     MOVE X'2020233030303135343833' TO DFHEIV0(25:11)
 18056     CALL 'kxdfhei1' USING DFHEIV0,
 18057           DRLFPRMI,
 18058           DFHEIV11
 18059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18060           IF DRLFPRMI NUMERIC
 18061              MOVE DRLFPRMI   TO WS-DRLFPRM
 18062*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18063*          PERFORM 8600-DEEDIT
 18064*          IF DEEDIT-FIELD-V2  NUMERIC
 18065*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18066           ELSE
 18067              MOVE ER-2223    TO EMI-ERROR
 18068              MOVE -1         TO DRLFPRML
 18069              MOVE AL-UNBON   TO DRLFPRMA
 18070              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18071
 18072        IF DRAHPRML GREATER THAN ZEROS
 18073           MOVE AL-UNNON         TO DRAHPRMA
 18074
 18075* EXEC CICS BIF DEEDIT
 18076*              FIELD  (DRAHPRMI)
 18077*              LENGTH (11)
 18078*          END-EXEC
 18079     MOVE 11
 18080       TO DFHEIV11
 18081*    MOVE '@"L                   #   #00015501' TO DFHEIV0
 18082     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18083     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18084     MOVE X'2020233030303135353031' TO DFHEIV0(25:11)
 18085     CALL 'kxdfhei1' USING DFHEIV0,
 18086           DRAHPRMI,
 18087           DFHEIV11
 18088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18089           IF DRAHPRMI NUMERIC
 18090              MOVE DRAHPRMI   TO WS-DRAHPRM
 18091*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18092*          PERFORM 8600-DEEDIT
 18093*          IF DEEDIT-FIELD-V2  NUMERIC
 18094*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18095           ELSE
 18096              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 331
* EL6311.cbl
 18097              MOVE -1         TO DRAHPRML
 18098              MOVE AL-UNBON   TO DRAHPRMA
 18099              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18100
 18101        IF DRCANCL GREATER THAN ZEROS
 18102           MOVE AL-UNNON         TO DRCANCA
 18103           MOVE DRCANCI          TO DEEDIT-FIELD
 18104           PERFORM 8600-DEEDIT
 18105           IF DEEDIT-FIELD-V0  NUMERIC
 18106              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18107           ELSE
 18108              MOVE ER-2223    TO EMI-ERROR
 18109              MOVE -1         TO DRCANCL
 18110              MOVE AL-UNBON   TO DRCANCL
 18111              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18112
 18113        IF DRLFRFDL GREATER THAN ZEROS
 18114           MOVE AL-UNNON         TO DRLFRFDA
 18115
 18116* EXEC CICS BIF DEEDIT
 18117*              FIELD  (DRLFRFDI)
 18118*              LENGTH (11)
 18119*          END-EXEC
 18120     MOVE 11
 18121       TO DFHEIV11
 18122*    MOVE '@"L                   #   #00015531' TO DFHEIV0
 18123     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18124     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18125     MOVE X'2020233030303135353331' TO DFHEIV0(25:11)
 18126     CALL 'kxdfhei1' USING DFHEIV0,
 18127           DRLFRFDI,
 18128           DFHEIV11
 18129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18130           IF DRLFRFDI NUMERIC
 18131              MOVE DRLFRFDI   TO WS-DRLFRFD
 18132*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18133*          PERFORM 8600-DEEDIT
 18134*          IF DEEDIT-FIELD-V2  NUMERIC
 18135*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18136           ELSE
 18137              MOVE ER-2223    TO EMI-ERROR
 18138              MOVE -1         TO DRLFRFDL
 18139              MOVE AL-UNBON   TO DRLFRFDA
 18140              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18141
 18142        IF DRAHRFDL GREATER THAN ZEROS
 18143           MOVE AL-UNNON         TO DRAHRFDA
 18144
 18145* EXEC CICS BIF DEEDIT
 18146*              FIELD  (DRAHRFDI)
 18147*              LENGTH (11)
 18148*          END-EXEC
 18149     MOVE 11
 18150       TO DFHEIV11
 18151*    MOVE '@"L                   #   #00015549' TO DFHEIV0
 18152     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18153     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18154     MOVE X'2020233030303135353439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 332
* EL6311.cbl
 18155     CALL 'kxdfhei1' USING DFHEIV0,
 18156           DRAHRFDI,
 18157           DFHEIV11
 18158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18159           IF DRAHRFDI NUMERIC
 18160              MOVE DRAHRFDI   TO WS-DRAHRFD
 18161*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18162*          PERFORM 8600-DEEDIT
 18163*          IF DEEDIT-FIELD-V2  NUMERIC
 18164*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18165           ELSE
 18166              MOVE ER-2223    TO EMI-ERROR
 18167              MOVE -1         TO DRAHRFDL
 18168              MOVE AL-UNBON   TO DRAHRFDA
 18169              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18170
 18171     IF EMI-ERROR = ZEROS
 18172        GO 3600-UPDATE-BATCH-HEADER.
 18173
 18174     GO TO 8200-SEND-DATAONLY.
 18175
 18176 3590-NOT-FOUND.
 18177     MOVE ER-2192                TO EMI-ERROR.
 18178     MOVE -1                     TO DPFENTRL.
 18179     MOVE AL-UNBON               TO DPFENTRA.
 18180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18181     GO TO 8200-SEND-DATAONLY.
 18182
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 333
* EL6311.cbl
 18184
 18185******************************************************************
 18186*                                                                *
 18187*           U P D A T E   B A T C H   H E A D E R                *
 18188*                                                                *
 18189******************************************************************
 18190
 18191 3600-UPDATE-BATCH-HEADER.
 18192
 18193* EXEC CICS HANDLE CONDITION
 18194*         NOTFND      (3690-NOT-FOUND)
 18195*    END-EXEC.
 18196*    MOVE '"$I                   ! G #00015586' TO DFHEIV0
 18197     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18199     MOVE X'4720233030303135353836' TO DFHEIV0(25:11)
 18200     CALL 'kxdfhei1' USING DFHEIV0
 18201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18202
 18203
 18204
 18205* EXEC CICS READ
 18206*        DATASET (FILE-ID-ERPNDB)
 18207*        RIDFLD  (ERPNDB-KEY)
 18208*        SET     (ADDRESS OF PENDING-BUSINESS)
 18209*        UPDATE
 18210*    END-EXEC.
 18211*    MOVE '&"S        EU         (   #00015590' TO DFHEIV0
 18212     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18213     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18214     MOVE X'2020233030303135353930' TO DFHEIV0(25:11)
 18215     CALL 'kxdfhei1' USING DFHEIV0,
 18216           FILE-ID-ERPNDB,
 18217           DFHEIV20,
 18218           DFHEIV99,
 18219           ERPNDB-KEY,
 18220           DFHEIV99,
 18221           DFHEIV99,
 18222           DFHEIV99
 18223     SET ADDRESS OF PENDING-BUSINESS TO
 18224         DFHEIV20
 18225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18226
 18227
 18228     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18229     MOVE 'B'                    TO JP-RECORD-TYPE.
 18230     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18231
 18232     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18233
 18234     PERFORM 8400-LOG-JOURNAL-RECORD.
 18235
 18236     IF DRISSL GREATER THAN ZEROS
 18237        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18238
 18239     IF DRCANCL GREATER THAN ZEROS
 18240        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18241
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 334
* EL6311.cbl
 18242
 18243     IF DRLFPRML GREATER THAN ZEROS
 18244        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18245
 18246     IF DRAHPRML GREATER THAN ZEROS
 18247        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18248
 18249     IF DRLFRFDL GREATER THAN ZEROS
 18250        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18251
 18252     IF DRAHRFDL GREATER THAN ZEROS
 18253        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18254
 18255 3670-REWRITE-BATCH-HEADER.
 18256     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18257        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18258        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18259        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18260        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18261        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18262        MOVE SPACE               TO PB-OUT-BAL-CD
 18263     ELSE
 18264        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18265
 18266     MOVE 'C'                    TO JP-RECORD-TYPE.
 18267     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18268
 18269
 18270* EXEC CICS REWRITE
 18271*         DATASET      (FILE-ID-ERPNDB)
 18272*         FROM         (PENDING-BUSINESS)
 18273*    END-EXEC.
 18274     MOVE LENGTH OF
 18275      PENDING-BUSINESS
 18276       TO DFHEIV11
 18277*    MOVE '&& L                  %   #00015638' TO DFHEIV0
 18278     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18279     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18280     MOVE X'2020233030303135363338' TO DFHEIV0(25:11)
 18281     CALL 'kxdfhei1' USING DFHEIV0,
 18282           FILE-ID-ERPNDB,
 18283           PENDING-BUSINESS,
 18284           DFHEIV11,
 18285           DFHEIV99
 18286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18287
 18288
 18289     PERFORM 8400-LOG-JOURNAL-RECORD.
 18290
 18291     GO TO 7200-DISPLAY-BATCHES.
 18292
 18293 3690-NOT-FOUND.
 18294     MOVE ER-2192                TO EMI-ERROR.
 18295     MOVE -1                     TO DPFENTRL.
 18296     MOVE AL-UNBON               TO DPFENTRA.
 18297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18298     GO TO 8200-SEND-DATAONLY.
 18299
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 335
* EL6311.cbl
 18301
 18302******************************************************************
 18303*                                                                *
 18304*           R E - D I S P L A Y   R E C O R D                    *
 18305*                                                                *
 18306******************************************************************
 18307
 18308 3900-RE-DISPLAY-RECORD.
 18309
 18310* EXEC CICS HANDLE CONDITION
 18311*         NOTFND   (3990-NOT-FOUND)
 18312*    END-EXEC.
 18313*    MOVE '"$I                   ! H #00015663' TO DFHEIV0
 18314     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18316     MOVE X'4820233030303135363633' TO DFHEIV0(25:11)
 18317     CALL 'kxdfhei1' USING DFHEIV0
 18318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18319
 18320
 18321     IF PI-DISPLAY-ORIGINAL-BATCH
 18322         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18323     ELSE
 18324         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18325
 18326
 18327* EXEC CICS READ
 18328*         DATASET   (FILE-ID)
 18329*         RIDFLD    (PI-PREV-KEY)
 18330*         SET       (ADDRESS OF PENDING-BUSINESS)
 18331*    END-EXEC.
 18332*    MOVE '&"S        E          (   #00015672' TO DFHEIV0
 18333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18335     MOVE X'2020233030303135363732' TO DFHEIV0(25:11)
 18336     CALL 'kxdfhei1' USING DFHEIV0,
 18337           FILE-ID,
 18338           DFHEIV20,
 18339           DFHEIV99,
 18340           PI-PREV-KEY,
 18341           DFHEIV99,
 18342           DFHEIV99,
 18343           DFHEIV99
 18344     SET ADDRESS OF PENDING-BUSINESS TO
 18345         DFHEIV20
 18346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18347
 18348
 18349     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18350
 18351     IF PB-ISSUE
 18352         GO TO 7000-DISPLAY-ISSUES.
 18353
 18354     IF PB-CANCELLATION
 18355         GO TO 7100-DISPLAY-CANCELS.
 18356
 18357     IF PB-BATCH-TRAILER
 18358         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 336
* EL6311.cbl
 18359
 18360 3990-NOT-FOUND.
 18361     MOVE LOW-VALUES             TO EL631BI.
 18362
 18363     IF PI-MAP-NAME = EL631B
 18364         MOVE -1                  TO BMAINTL
 18365     ELSE
 18366         MOVE -1                  TO CMAINTL.
 18367
 18368     GO TO 8100-SEND-INITIAL-MAP.
 18369
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 337
* EL6311.cbl
 18371
 18372***************************************************************
 18373*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18374*                                                             *
 18375*      1. START BROWSE WITH                                   *
 18376*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18377*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18378*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18379*                                                             *
 18380*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18381*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18382*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18383*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18384*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18385*               AND IS IT TO BE DISPLAYED.                    *
 18386*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18387*               DISPLAYED.                                    *
 18388*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18389*               DISPLAYED.                                    *
 18390*                                                             *
 18391*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18392*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18393***************************************************************
 18394
 18395 4000-BROWSE-DETAIL-FORWARD.
 18396     IF FIRST-TIME
 18397        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18398     ELSE
 18399        IF SHOW-RECORD
 18400           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18401           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18402           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18403           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18404           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18405        ELSE
 18406           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18407
 18408
 18409* EXEC CICS HANDLE CONDITION
 18410*         NOTFND   (4050-END-RECORDS)
 18411*         ENDFILE  (4050-END-RECORDS)
 18412*    END-EXEC.
 18413*    MOVE '"$I''                  ! I #00015737' TO DFHEIV0
 18414     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18416     MOVE X'4920233030303135373337' TO DFHEIV0(25:11)
 18417     CALL 'kxdfhei1' USING DFHEIV0
 18418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18419
 18420
 18421
 18422* EXEC CICS STARTBR
 18423*         DATASET   (FILE-ID-ERPNDB2)
 18424*         RIDFLD    (ERPNDB-ALT-KEY)
 18425*    END-EXEC.
 18426     MOVE 0
 18427       TO DFHEIV11
 18428*    MOVE '&,         G          &   #00015742' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 338
* EL6311.cbl
 18429     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18430     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18431     MOVE X'2020233030303135373432' TO DFHEIV0(25:11)
 18432     CALL 'kxdfhei1' USING DFHEIV0,
 18433           FILE-ID-ERPNDB2,
 18434           ERPNDB-ALT-KEY,
 18435           DFHEIV99,
 18436           DFHEIV11,
 18437           DFHEIV99
 18438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18439
 18440
 18441     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18442
 18443     IF FIRST-TIME OR SHOW-RECORD
 18444        MOVE SPACE               TO WS-FIRST-TIME-SW
 18445        GO TO 4005-READ-NEXT-RECORD.
 18446
 18447
 18448* EXEC CICS READNEXT
 18449*         DATASET    (FILE-ID-ERPNDB2)
 18450*         SET        (ADDRESS OF PENDING-BUSINESS)
 18451*         RIDFLD     (ERPNDB-ALT-KEY)
 18452*    END-EXEC.
 18453     MOVE 0
 18454       TO DFHEIV11
 18455*    MOVE '&.S                   )   #00015753' TO DFHEIV0
 18456     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18457     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18458     MOVE X'2020233030303135373533' TO DFHEIV0(25:11)
 18459     CALL 'kxdfhei1' USING DFHEIV0,
 18460           FILE-ID-ERPNDB2,
 18461           DFHEIV20,
 18462           DFHEIV99,
 18463           ERPNDB-ALT-KEY,
 18464           DFHEIV99,
 18465           DFHEIV11,
 18466           DFHEIV99,
 18467           DFHEIV99
 18468     SET ADDRESS OF PENDING-BUSINESS TO
 18469         DFHEIV20
 18470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18471
 18472
 18473 4005-READ-NEXT-RECORD.
 18474
 18475* EXEC CICS READNEXT
 18476*         DATASET    (FILE-ID-ERPNDB2)
 18477*         SET        (ADDRESS OF PENDING-BUSINESS)
 18478*         RIDFLD     (ERPNDB-ALT-KEY)
 18479*    END-EXEC.
 18480     MOVE 0
 18481       TO DFHEIV11
 18482*    MOVE '&.S                   )   #00015760' TO DFHEIV0
 18483     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18484     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18485     MOVE X'2020233030303135373630' TO DFHEIV0(25:11)
 18486     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 339
* EL6311.cbl
 18487           FILE-ID-ERPNDB2,
 18488           DFHEIV20,
 18489           DFHEIV99,
 18490           ERPNDB-ALT-KEY,
 18491           DFHEIV99,
 18492           DFHEIV11,
 18493           DFHEIV99,
 18494           DFHEIV99
 18495     SET ADDRESS OF PENDING-BUSINESS TO
 18496         DFHEIV20
 18497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18498
 18499
 18500     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18501
 18502     IF WS-BATCH-PREFIX = '#CL'
 18503        GO TO 4005-READ-NEXT-RECORD.
 18504
 18505     IF SHOW-RECORD
 18506        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18507           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18508           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18509           PB-STATE         NOT = PI-PB-STATE          OR
 18510           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18511           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18512           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18513           GO TO 4050-END-RECORDS
 18514        ELSE
 18515           GO TO 4010-CHECK-REC-TYPE.
 18516
 18517     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18518        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18519        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18520        PB-STATE            NOT = PI-PB-STATE          OR
 18521        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18522        GO TO 4050-END-RECORDS.
 18523
 18524     IF PB-BATCH-TRAILER
 18525        GO TO 4005-READ-NEXT-RECORD.
 18526
 18527     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18528        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18529           GO TO 4005-READ-NEXT-RECORD
 18530        ELSE
 18531           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18532              GO TO 4010-CHECK-REC-TYPE
 18533           ELSE
 18534              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18535                 GO TO 4010-CHECK-REC-TYPE
 18536              ELSE
 18537                 GO TO 4005-READ-NEXT-RECORD.
 18538
 18539     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18540        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18541           GO TO 4005-READ-NEXT-RECORD.
 18542
 18543 4010-CHECK-REC-TYPE.
 18544     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 340
* EL6311.cbl
 18545         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18546             NEXT SENTENCE
 18547         ELSE
 18548             GO TO 4005-READ-NEXT-RECORD.
 18549
 18550     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18551         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18552             NEXT SENTENCE
 18553        ELSE
 18554             GO TO 4005-READ-NEXT-RECORD.
 18555
 18556     IF NOT DISPLAY-CHANGE-RECORDS AND
 18557            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18558        GO TO 4005-READ-NEXT-RECORD.
 18559
 18560     IF DISPLAY-HOLD-RECORDS AND
 18561        NOT PB-RECORD-ON-HOLD
 18562          GO TO 4005-READ-NEXT-RECORD.
 18563
 18564     IF PB-ISSUE
 18565        IF DISPLAY-CHK-REQ-RECORDS
 18566            GO TO 4005-READ-NEXT-RECORD.
 18567
 18568     IF PB-ISSUE
 18569        IF ISSUE-WITH-WARNING
 18570           IF PB-WARNING-ERRORS
 18571              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18572                  GO TO 4005-READ-NEXT-RECORD
 18573              ELSE
 18574                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18575                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18576                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18577                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18578                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18579                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18580                 GO TO 7000-DISPLAY-ISSUES
 18581           ELSE
 18582              GO TO 4005-READ-NEXT-RECORD.
 18583
 18584     IF PB-ISSUE
 18585        IF (ISSUES-IN-ERROR AND
 18586            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18587            ALL-ISSUES
 18588            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18589            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18590            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18591            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18592            MOVE PB-SV-STATE            TO PI-SV-STATE
 18593            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18594            GO TO 7000-DISPLAY-ISSUES
 18595        ELSE
 18596            GO TO 4005-READ-NEXT-RECORD.
 18597
 18598     IF PB-CANCELLATION
 18599        IF DISPLAY-CHK-REQ-RECORDS
 18600           IF PB-C-REFUND-REQUESTED
 18601              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18602              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 341
* EL6311.cbl
 18603              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18604              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18605              MOVE PB-SV-STATE            TO PI-SV-STATE
 18606              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18607              GO TO 7100-DISPLAY-CANCELS
 18608           ELSE
 18609               GO TO 4005-READ-NEXT-RECORD.
 18610
 18611     IF PB-CANCELLATION
 18612        IF CANCEL-WITH-WARNING
 18613           IF PB-WARNING-ERRORS
 18614              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18615                  GO TO 4005-READ-NEXT-RECORD
 18616              ELSE
 18617                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18618                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18619                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18620                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18621                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18622                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18623                 GO TO 7100-DISPLAY-CANCELS
 18624           ELSE
 18625              GO TO 4005-READ-NEXT-RECORD.
 18626
 18627     IF PB-CANCELLATION
 18628        IF (CANCEL-IN-ERROR  AND
 18629            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18630            ALL-CANCELS
 18631            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18632            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18633            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18634            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18635            MOVE PB-SV-STATE            TO PI-SV-STATE
 18636            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18637            GO TO 7100-DISPLAY-CANCELS.
 18638
 18639     GO TO 4005-READ-NEXT-RECORD.
 18640
 18641 4050-END-RECORDS.
 18642******************************************************************
 18643*                                                                *
 18644*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18645*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18646*         PROGRAM.                                               *
 18647*                                                                *
 18648******************************************************************
 18649
 18650     IF BROWSE-STARTED
 18651        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18652
 18653* EXEC CICS ENDBR
 18654*            DATASET  (FILE-ID-ERPNDB2)
 18655*       END-EXEC.
 18656     MOVE 0
 18657       TO DFHEIV11
 18658*    MOVE '&2                    $   #00015918' TO DFHEIV0
 18659     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18660     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 342
* EL6311.cbl
 18661     MOVE X'2020233030303135393138' TO DFHEIV0(25:11)
 18662     CALL 'kxdfhei1' USING DFHEIV0,
 18663           FILE-ID-ERPNDB2,
 18664           DFHEIV11,
 18665           DFHEIV99
 18666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18667
 18668
 18669     IF  EIBTRNID NOT = TRANS-EXB1
 18670         IF PENDING-BUS-RECS-FOUND
 18671             NEXT SENTENCE
 18672           ELSE
 18673             MOVE '9'            TO PI-BROWSE-SW
 18674             GO TO 9400-CLEAR.
 18675
 18676     IF SHOW-RECORD
 18677        MOVE ER-2253            TO EMI-ERROR
 18678       ELSE
 18679        MOVE ER-2254            TO EMI-ERROR.
 18680
 18681     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18682
 18683     IF PI-MAP-NAME = SPACES
 18684        MOVE -1                  TO DPFENTRL
 18685        MOVE EL631D               TO PI-MAP-NAME
 18686        GO TO 8100-SEND-INITIAL-MAP.
 18687
 18688     IF PI-MAP-NAME = EL631B
 18689        MOVE -1                  TO BMAINTL
 18690     ELSE
 18691        IF PI-MAP-NAME = EL631C
 18692           MOVE -1               TO CMAINTL
 18693        ELSE
 18694           MOVE -1               TO DPFENTRL.
 18695
 18696     GO TO 8200-SEND-DATAONLY.
 18697
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 343
* EL6311.cbl
 18699
 18700***************************************************************
 18701*                                                             *
 18702*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18703*                                                             *
 18704*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18705*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18706*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18707*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18708*                                                             *
 18709*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18710*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18711*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18712*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18713*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18714*                AND IS IT TO BE DISPLAYED.                   *
 18715*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18716*                DISPLAYED.                                   *
 18717*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18718*                DISPLAYED.                                   *
 18719*                                                             *
 18720*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18721*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18722*                                                             *
 18723*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18724*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18725*                THEY ARE NOT TO BE DISPLAYED.                *
 18726*                                                             *
 18727***************************************************************
 18728
 18729 4100-BROWSE-PRIMARY-FORWARD.
 18730     IF FIRST-TIME  OR SHOW-RECORD
 18731        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18732        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18733        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18734     ELSE
 18735        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18736        IF ERPNDB-BATCH-SEQ-NO = +9999
 18737           GO TO 4150-END-BATCH
 18738        ELSE
 18739           IF DISPLAY-CHANGE-RECORDS
 18740              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18741           ELSE
 18742              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18743              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18744
 18745     IF FIRST-TIME
 18746         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18747            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18748              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18749
 18750
 18751* EXEC CICS HANDLE CONDITION
 18752*         ENDFILE  (4150-END-BATCH)
 18753*    END-EXEC.
 18754*    MOVE '"$''                   ! J #00016003' TO DFHEIV0
 18755     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 344
* EL6311.cbl
 18757     MOVE X'4A20233030303136303033' TO DFHEIV0(25:11)
 18758     CALL 'kxdfhei1' USING DFHEIV0
 18759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18760
 18761
 18762 4105-READ-NEXT.
 18763
 18764* EXEC CICS HANDLE CONDITION
 18765*         NOTFND    (4150-END-BATCH)
 18766*    END-EXEC.
 18767*    MOVE '"$I                   ! K #00016008' TO DFHEIV0
 18768     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18770     MOVE X'4B20233030303136303038' TO DFHEIV0(25:11)
 18771     CALL 'kxdfhei1' USING DFHEIV0
 18772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18773
 18774
 18775     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18776
 18777     IF PI-DISPLAY-ORIGINAL-BATCH
 18778        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18779     ELSE
 18780        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18781
 18782
 18783* EXEC CICS READ
 18784*         DATASET   (FILE-ID)
 18785*         SET       (ADDRESS OF PENDING-BUSINESS)
 18786*         RIDFLD    (ERPNDB-KEY)
 18787*         GTEQ
 18788*    END-EXEC.
 18789*    MOVE '&"S        G          (   #00016019' TO DFHEIV0
 18790     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18792     MOVE X'2020233030303136303139' TO DFHEIV0(25:11)
 18793     CALL 'kxdfhei1' USING DFHEIV0,
 18794           FILE-ID,
 18795           DFHEIV20,
 18796           DFHEIV99,
 18797           ERPNDB-KEY,
 18798           DFHEIV99,
 18799           DFHEIV99,
 18800           DFHEIV99
 18801     SET ADDRESS OF PENDING-BUSINESS TO
 18802         DFHEIV20
 18803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18804
 18805
 18806     IF PI-DISPLAY-ORIGINAL-BATCH
 18807        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18808           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18809           GO TO 4150-END-BATCH
 18810        ELSE
 18811           IF PB-BATCH-TRAILER
 18812              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18813              GO TO 4105-READ-NEXT
 18814           ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 345
* EL6311.cbl
 18815              NEXT SENTENCE
 18816     ELSE
 18817        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18818           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18819           GO TO 4150-END-BATCH.
 18820
 18821     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18822
 18823     IF WS-BATCH-PREFIX = '#CL'
 18824         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18825         GO TO 4105-READ-NEXT.
 18826
 18827     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18828     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18829     MOVE PB-STATE               TO PI-PB-STATE.
 18830     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18831
 18832     IF PB-BATCH-TRAILER
 18833        IF SHOW-RECORD
 18834           GO TO 4150-END-BATCH
 18835        ELSE
 18836           MOVE ER-2251         TO EMI-ERROR
 18837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18838           MOVE 1               TO PI-BROWSE-TYPE
 18839           GO TO 7200-DISPLAY-BATCHES.
 18840
 18841     IF SHOW-RECORD
 18842           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18843              GO TO 4110-BUMP-SEQ
 18844           ELSE
 18845              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18846                 GO TO 4110-BUMP-SEQ
 18847              ELSE
 18848                 GO TO 4107-CHECK-REC-TYPE.
 18849
 18850     IF NOT  PI-PRIMARY-WITH-SELECT
 18851        GO TO 4107-CHECK-REC-TYPE.
 18852
 18853     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18854        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18855           GO TO 4110-BUMP-SEQ
 18856        ELSE
 18857           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18858              GO TO 4107-CHECK-REC-TYPE
 18859           ELSE
 18860              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18861                 GO TO 4107-CHECK-REC-TYPE
 18862              ELSE
 18863                 GO TO 4110-BUMP-SEQ.
 18864
 18865     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18866        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18867           GO TO 4110-BUMP-SEQ.
 18868
 18869 4107-CHECK-REC-TYPE.
 18870     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18871         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18872             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 346
* EL6311.cbl
 18873           ELSE
 18874             GO TO 4110-BUMP-SEQ.
 18875
 18876     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18877         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18878             NEXT SENTENCE
 18879           ELSE
 18880             GO TO 4110-BUMP-SEQ.
 18881
 18882     IF NOT DISPLAY-CHANGE-RECORDS AND
 18883        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18884           GO TO 4110-BUMP-SEQ.
 18885
 18886     IF DISPLAY-HOLD-RECORDS AND
 18887        NOT PB-RECORD-ON-HOLD
 18888          GO TO 4110-BUMP-SEQ.
 18889
 18890     IF PB-ISSUE
 18891        IF DISPLAY-CHK-REQ-RECORDS
 18892            GO TO 4110-BUMP-SEQ.
 18893
 18894     IF PB-ISSUE
 18895        IF ISSUE-WITH-WARNING
 18896           IF PB-WARNING-ERRORS
 18897              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18898                  GO TO 4110-BUMP-SEQ
 18899              ELSE
 18900                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18901                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18902                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18903                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18904                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18905                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18906                 GO TO 7000-DISPLAY-ISSUES
 18907        ELSE
 18908            GO TO 4110-BUMP-SEQ.
 18909
 18910     IF PB-ISSUE
 18911        IF (ISSUES-IN-ERROR AND
 18912            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18913            ALL-ISSUES
 18914            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18915            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18916            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18917            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18918            MOVE PB-SV-STATE            TO PI-SV-STATE
 18919            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18920            GO TO 7000-DISPLAY-ISSUES
 18921        ELSE
 18922            GO TO 4110-BUMP-SEQ.
 18923
 18924     IF PB-CANCELLATION
 18925        IF DISPLAY-CHK-REQ-RECORDS
 18926           IF PB-C-REFUND-REQUESTED
 18927              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18928              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18929              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18930              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 347
* EL6311.cbl
 18931              MOVE PB-SV-STATE            TO PI-SV-STATE
 18932              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18933              GO TO 7100-DISPLAY-CANCELS
 18934           ELSE
 18935              GO TO 4110-BUMP-SEQ.
 18936
 18937     IF PB-CANCELLATION
 18938        IF CANCEL-WITH-WARNING
 18939           IF PB-WARNING-ERRORS
 18940              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18941                  GO TO 4110-BUMP-SEQ
 18942              ELSE
 18943                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18944                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18945                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18946                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18947                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18948                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18949                 GO TO 7100-DISPLAY-CANCELS
 18950           ELSE
 18951              GO TO 4110-BUMP-SEQ.
 18952
 18953     IF PB-CANCELLATION
 18954        IF (CANCEL-IN-ERROR  AND
 18955            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18956            ALL-CANCELS
 18957            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18958            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18959            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18960            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18961            MOVE PB-SV-STATE            TO PI-SV-STATE
 18962            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18963            GO TO 7100-DISPLAY-CANCELS.
 18964
 18965 4110-BUMP-SEQ.
 18966     IF NOT DISPLAY-CHANGE-RECORDS
 18967        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18968        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18969     ELSE
 18970        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18971           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18972           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18973        ELSE
 18974           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18975           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18976
 18977     GO TO 4105-READ-NEXT.
 18978
 18979 4150-END-BATCH.
 18980******************************************************************
 18981*                                                                *
 18982*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18983*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18984*         PROGRAM.                                               *
 18985*                                                                *
 18986******************************************************************
 18987
 18988     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 348
* EL6311.cbl
 18989         IF PENDING-BUS-RECS-FOUND
 18990             NEXT SENTENCE
 18991           ELSE
 18992             MOVE '9'            TO PI-BROWSE-SW
 18993             GO TO 9400-CLEAR.
 18994
 18995     IF SHOW-RECORD
 18996        MOVE ER-2253             TO EMI-ERROR
 18997     ELSE
 18998        MOVE ER-2251             TO EMI-ERROR.
 18999
 19000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19001
 19002     IF PI-MAP-NAME = SPACES
 19003        MOVE -1                  TO BMAINTL
 19004        MOVE EL631B              TO PI-MAP-NAME
 19005        GO TO 8100-SEND-INITIAL-MAP.
 19006
 19007     IF PI-MAP-NAME = EL631B
 19008        MOVE -1                  TO BMAINTL
 19009     ELSE
 19010        IF PI-MAP-NAME = EL631C
 19011           MOVE -1               TO CMAINTL
 19012        ELSE
 19013           MOVE -1               TO DPFENTRL.
 19014
 19015     GO TO 8200-SEND-DATAONLY.
 19016
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 349
* EL6311.cbl
 19018
 19019***************************************************************
 19020*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19021*                                                             *
 19022*      1. START BROWSE WITH                                   *
 19023*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19024*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19025*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19026*                                                             *
 19027*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19028*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19029*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19030*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19031*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19032*               AND IS IT TO BE DISPLAYED.                    *
 19033*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19034*               DISPLAYED.                                    *
 19035*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19036*               DISPLAYED.                                    *
 19037*                                                             *
 19038*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19039*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19040***************************************************************
 19041
 19042 4200-BROWSE-CSR-FORWARD.
 19043
 19044     IF FIRST-TIME
 19045        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19046     ELSE
 19047        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19048
 19049
 19050* EXEC CICS HANDLE CONDITION
 19051*         NOTFND   (4250-END-RECORDS)
 19052*         ENDFILE  (4250-END-RECORDS)
 19053*    END-EXEC.
 19054*    MOVE '"$I''                  ! L #00016269' TO DFHEIV0
 19055     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19057     MOVE X'4C20233030303136323639' TO DFHEIV0(25:11)
 19058     CALL 'kxdfhei1' USING DFHEIV0
 19059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19060
 19061
 19062
 19063* EXEC CICS STARTBR
 19064*         DATASET   (FILE-ID-ERPNDB4)
 19065*         RIDFLD    (ERPNDB-CSR-KEY)
 19066*    END-EXEC.
 19067     MOVE 0
 19068       TO DFHEIV11
 19069*    MOVE '&,         G          &   #00016274' TO DFHEIV0
 19070     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19071     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19072     MOVE X'2020233030303136323734' TO DFHEIV0(25:11)
 19073     CALL 'kxdfhei1' USING DFHEIV0,
 19074           FILE-ID-ERPNDB4,
 19075           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 350
* EL6311.cbl
 19076           DFHEIV99,
 19077           DFHEIV11,
 19078           DFHEIV99
 19079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19080
 19081
 19082     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19083
 19084     IF FIRST-TIME
 19085        MOVE SPACE               TO WS-FIRST-TIME-SW
 19086        GO TO 4205-READ-NEXT-RECORD.
 19087
 19088
 19089* EXEC CICS READNEXT
 19090*         DATASET    (FILE-ID-ERPNDB4)
 19091*         SET        (ADDRESS OF PENDING-BUSINESS)
 19092*         RIDFLD     (ERPNDB-CSR-KEY)
 19093*    END-EXEC.
 19094     MOVE 0
 19095       TO DFHEIV11
 19096*    MOVE '&.S                   )   #00016285' TO DFHEIV0
 19097     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19098     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19099     MOVE X'2020233030303136323835' TO DFHEIV0(25:11)
 19100     CALL 'kxdfhei1' USING DFHEIV0,
 19101           FILE-ID-ERPNDB4,
 19102           DFHEIV20,
 19103           DFHEIV99,
 19104           ERPNDB-CSR-KEY,
 19105           DFHEIV99,
 19106           DFHEIV11,
 19107           DFHEIV99,
 19108           DFHEIV99
 19109     SET ADDRESS OF PENDING-BUSINESS TO
 19110         DFHEIV20
 19111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19112
 19113
 19114 4205-READ-NEXT-RECORD.
 19115
 19116
 19117* EXEC CICS READNEXT
 19118*         DATASET    (FILE-ID-ERPNDB4)
 19119*         SET        (ADDRESS OF PENDING-BUSINESS)
 19120*         RIDFLD     (ERPNDB-CSR-KEY)
 19121*    END-EXEC.
 19122     MOVE 0
 19123       TO DFHEIV11
 19124*    MOVE '&.S                   )   #00016293' TO DFHEIV0
 19125     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19126     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19127     MOVE X'2020233030303136323933' TO DFHEIV0(25:11)
 19128     CALL 'kxdfhei1' USING DFHEIV0,
 19129           FILE-ID-ERPNDB4,
 19130           DFHEIV20,
 19131           DFHEIV99,
 19132           ERPNDB-CSR-KEY,
 19133           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 351
* EL6311.cbl
 19134           DFHEIV11,
 19135           DFHEIV99,
 19136           DFHEIV99
 19137     SET ADDRESS OF PENDING-BUSINESS TO
 19138         DFHEIV20
 19139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19140
 19141
 19142     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19143
 19144     IF WS-BATCH-PREFIX = '#CL'
 19145        GO TO 4205-READ-NEXT-RECORD.
 19146
 19147     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19148        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19149        GO TO 4250-END-RECORDS.
 19150
 19151     IF PB-BATCH-TRAILER
 19152        GO TO 4205-READ-NEXT-RECORD.
 19153
 19154     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19155        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19156           GO TO 4205-READ-NEXT-RECORD
 19157        ELSE
 19158           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19159              GO TO 4210-CHECK-REC-TYPE
 19160           ELSE
 19161              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19162                 GO TO 4210-CHECK-REC-TYPE
 19163              ELSE
 19164                 GO TO 4205-READ-NEXT-RECORD.
 19165
 19166     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19167        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19168           GO TO 4205-READ-NEXT-RECORD.
 19169
 19170 4210-CHECK-REC-TYPE.
 19171     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19172         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19173             NEXT SENTENCE
 19174         ELSE
 19175             GO TO 4205-READ-NEXT-RECORD.
 19176
 19177     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19178         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19179             NEXT SENTENCE
 19180        ELSE
 19181             GO TO 4205-READ-NEXT-RECORD.
 19182
 19183     IF NOT DISPLAY-CHANGE-RECORDS AND
 19184            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19185        GO TO 4205-READ-NEXT-RECORD.
 19186
 19187     IF DISPLAY-HOLD-RECORDS AND
 19188        NOT PB-RECORD-ON-HOLD
 19189          GO TO 4205-READ-NEXT-RECORD.
 19190
 19191     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 352
* EL6311.cbl
 19192        IF DISPLAY-CHK-REQ-RECORDS
 19193            GO TO 4205-READ-NEXT-RECORD.
 19194
 19195     IF PB-ISSUE
 19196        IF ISSUE-WITH-WARNING
 19197           IF PB-WARNING-ERRORS
 19198              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19199                  GO TO 4205-READ-NEXT-RECORD
 19200              ELSE
 19201                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19202                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19203                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19204                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19205                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19206                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19207                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19208                 GO TO 7000-DISPLAY-ISSUES
 19209           ELSE
 19210              GO TO 4205-READ-NEXT-RECORD.
 19211
 19212     IF PB-ISSUE
 19213        IF (ISSUES-IN-ERROR AND
 19214            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19215            ALL-ISSUES
 19216            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19217            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19218            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19219            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19220            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19221            MOVE PB-SV-STATE            TO PI-SV-STATE
 19222            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19223            GO TO 7000-DISPLAY-ISSUES
 19224        ELSE
 19225            GO TO 4205-READ-NEXT-RECORD.
 19226
 19227     IF PB-CANCELLATION
 19228        IF DISPLAY-CHK-REQ-RECORDS
 19229           IF PB-C-REFUND-REQUESTED
 19230              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19231              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19232              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19233              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19234              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19235              MOVE PB-SV-STATE            TO PI-SV-STATE
 19236              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19237              GO TO 7100-DISPLAY-CANCELS
 19238           ELSE
 19239               GO TO 4205-READ-NEXT-RECORD.
 19240
 19241     IF PB-CANCELLATION
 19242        IF CANCEL-WITH-WARNING
 19243           IF PB-WARNING-ERRORS
 19244              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19245                  GO TO 4205-READ-NEXT-RECORD
 19246              ELSE
 19247                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19248                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19249                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 353
* EL6311.cbl
 19250                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19251                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19252                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19253                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19254                 GO TO 7100-DISPLAY-CANCELS
 19255           ELSE
 19256              GO TO 4205-READ-NEXT-RECORD.
 19257
 19258     IF PB-CANCELLATION
 19259        IF (CANCEL-IN-ERROR  AND
 19260            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19261            ALL-CANCELS
 19262            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19263            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19264            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19265            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19266            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19267            MOVE PB-SV-STATE            TO PI-SV-STATE
 19268            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19269            GO TO 7100-DISPLAY-CANCELS.
 19270
 19271     GO TO 4205-READ-NEXT-RECORD.
 19272
 19273 4250-END-RECORDS.
 19274******************************************************************
 19275*                                                                *
 19276*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19277*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19278*         PROGRAM.                                               *
 19279*                                                                *
 19280******************************************************************
 19281
 19282     IF BROWSE-STARTED
 19283        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19284
 19285* EXEC CICS ENDBR
 19286*            DATASET  (FILE-ID-ERPNDB4)
 19287*       END-EXEC.
 19288     MOVE 0
 19289       TO DFHEIV11
 19290*    MOVE '&2                    $   #00016441' TO DFHEIV0
 19291     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303136343431' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
 19295           FILE-ID-ERPNDB4,
 19296           DFHEIV11,
 19297           DFHEIV99
 19298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19299
 19300
 19301     IF  EIBTRNID NOT = TRANS-EXB1
 19302         IF PENDING-BUS-RECS-FOUND
 19303             NEXT SENTENCE
 19304           ELSE
 19305             MOVE '9'            TO PI-BROWSE-SW
 19306             GO TO 9400-CLEAR.
 19307
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 354
* EL6311.cbl
 19308     IF SHOW-RECORD
 19309        MOVE ER-2253            TO EMI-ERROR
 19310       ELSE
 19311        MOVE ER-2254            TO EMI-ERROR.
 19312
 19313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19314
 19315     IF PI-MAP-NAME = SPACES
 19316        MOVE -1                  TO DPFENTRL
 19317        MOVE EL631D               TO PI-MAP-NAME
 19318        GO TO 8100-SEND-INITIAL-MAP.
 19319
 19320     IF PI-MAP-NAME = EL631B
 19321        MOVE -1                  TO BMAINTL
 19322     ELSE
 19323        IF PI-MAP-NAME = EL631C
 19324           MOVE -1               TO CMAINTL
 19325        ELSE
 19326           MOVE -1               TO DPFENTRL.
 19327
 19328     GO TO 8200-SEND-DATAONLY.
 19329
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 355
* EL6311.cbl
 19331
 19332***************************************************************
 19333*                                                             *
 19334*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19335*                                                             *
 19336*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19337*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19338*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19339*                                                             *
 19340*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19341*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19342*          A. IS IT WITHIN THE SAME COMPANY                   *
 19343*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19344*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19345*                AND IS IT TO BE DISPLAYED.                   *
 19346*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19347*                DISPLAYED.                                   *
 19348*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19349*                DISPLAYED.                                   *
 19350*                                                             *
 19351*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19352*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19353*                                                             *
 19354*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19355*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19356*                THEY ARE NOT TO BE DISPLAYED.                *
 19357*                                                             *
 19358***************************************************************
 19359
 19360 4300-BROWSE-FILE-FORWARD.
 19361     IF FIRST-TIME OR SHOW-RECORD
 19362        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19363        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19364        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19365     ELSE
 19366        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19367        IF ERPNDB-BATCH-SEQ-NO = +9999
 19368           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19369        ELSE
 19370           IF DISPLAY-CHANGE-RECORDS
 19371              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19372           ELSE
 19373              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19374              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19375
 19376
 19377* EXEC CICS HANDLE CONDITION
 19378*         ENDFILE  (4350-END-BATCH)
 19379*         NOTFND   (4350-END-BATCH)
 19380*    END-EXEC.
 19381*    MOVE '"$''I                  ! M #00016520' TO DFHEIV0
 19382     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19384     MOVE X'4D20233030303136353230' TO DFHEIV0(25:11)
 19385     CALL 'kxdfhei1' USING DFHEIV0
 19386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19387
 19388
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 356
* EL6311.cbl
 19389 4305-READ-NEXT.
 19390     IF PI-DISPLAY-ORIGINAL-BATCH
 19391        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19392     ELSE
 19393        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19394
 19395
 19396* EXEC CICS READ
 19397*         DATASET   (FILE-ID)
 19398*         SET       (ADDRESS OF PENDING-BUSINESS)
 19399*         RIDFLD    (ERPNDB-KEY)
 19400*         GTEQ
 19401*    END-EXEC.
 19402*    MOVE '&"S        G          (   #00016531' TO DFHEIV0
 19403     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19405     MOVE X'2020233030303136353331' TO DFHEIV0(25:11)
 19406     CALL 'kxdfhei1' USING DFHEIV0,
 19407           FILE-ID,
 19408           DFHEIV20,
 19409           DFHEIV99,
 19410           ERPNDB-KEY,
 19411           DFHEIV99,
 19412           DFHEIV99,
 19413           DFHEIV99
 19414     SET ADDRESS OF PENDING-BUSINESS TO
 19415         DFHEIV20
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
 19419     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19420        GO TO 4350-END-BATCH.
 19421
 19422     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19423                                    WS-BATCH-NO.
 19424
 19425     IF  WS-BATCH-PREFIX = '#CL'
 19426         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19427         GO TO 4305-READ-NEXT.
 19428
 19429     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19430     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19431     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19432     MOVE PB-STATE               TO PI-PB-STATE.
 19433     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19434
 19435     IF PB-BATCH-TRAILER
 19436        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19437        GO TO 4305-READ-NEXT.
 19438
 19439     IF SHOW-RECORD
 19440           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19441              GO TO 4310-BUMP-SEQ
 19442           ELSE
 19443              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19444                 GO TO 4310-BUMP-SEQ
 19445              ELSE
 19446                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 357
* EL6311.cbl
 19447
 19448     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19449        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19450           GO TO 4310-BUMP-SEQ
 19451        ELSE
 19452           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19453              GO TO 4307-CHECK-REC-TYPE
 19454           ELSE
 19455              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19456                 GO TO 4307-CHECK-REC-TYPE
 19457              ELSE
 19458                 GO TO 4310-BUMP-SEQ.
 19459
 19460     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19461        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19462           GO TO 4310-BUMP-SEQ.
 19463
 19464 4307-CHECK-REC-TYPE.
 19465     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19466         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19467             NEXT SENTENCE
 19468         ELSE
 19469             GO TO 4310-BUMP-SEQ.
 19470
 19471     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19472         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19473             NEXT SENTENCE
 19474        ELSE
 19475             GO TO 4310-BUMP-SEQ.
 19476
 19477     IF NOT DISPLAY-CHANGE-RECORDS AND
 19478            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19479        GO TO 4310-BUMP-SEQ.
 19480
 19481     IF DISPLAY-HOLD-RECORDS AND
 19482        NOT PB-RECORD-ON-HOLD
 19483          GO TO 4310-BUMP-SEQ.
 19484
 19485     IF PB-ISSUE
 19486        IF DISPLAY-CHK-REQ-RECORDS
 19487           GO TO 4310-BUMP-SEQ.
 19488
 19489     IF PB-ISSUE
 19490        IF ISSUE-WITH-WARNING
 19491           IF PB-WARNING-ERRORS
 19492              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19493                  GO TO 4310-BUMP-SEQ
 19494              ELSE
 19495                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19496                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19497                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19498                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19499                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19500                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19501                 GO TO 7000-DISPLAY-ISSUES
 19502           ELSE
 19503              GO TO 4310-BUMP-SEQ.
 19504
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 358
* EL6311.cbl
 19505     IF PB-ISSUE
 19506        IF (ISSUES-IN-ERROR AND
 19507            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19508            ALL-ISSUES
 19509            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19510            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19511            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19512            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19513            MOVE PB-SV-STATE            TO PI-SV-STATE
 19514            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19515            GO TO 7000-DISPLAY-ISSUES
 19516        ELSE
 19517            GO TO 4310-BUMP-SEQ.
 19518
 19519     IF PB-CANCELLATION
 19520        IF DISPLAY-CHK-REQ-RECORDS
 19521           IF PB-C-REFUND-REQUESTED
 19522              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19523              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19524              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19525              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19526              MOVE PB-SV-STATE            TO PI-SV-STATE
 19527              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19528              GO TO 7100-DISPLAY-CANCELS
 19529           ELSE
 19530              GO TO 4310-BUMP-SEQ.
 19531
 19532     IF PB-CANCELLATION
 19533        IF CANCEL-WITH-WARNING
 19534           IF PB-WARNING-ERRORS
 19535              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19536                  GO TO 4310-BUMP-SEQ
 19537              ELSE
 19538                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19539                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19540                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19541                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19542                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19543                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19544                 GO TO 7100-DISPLAY-CANCELS
 19545           ELSE
 19546              GO TO 4310-BUMP-SEQ.
 19547
 19548     IF PB-CANCELLATION
 19549        IF (CANCEL-IN-ERROR  AND
 19550            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19551            ALL-CANCELS
 19552            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19553            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19554            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19555            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19556            MOVE PB-SV-STATE            TO PI-SV-STATE
 19557            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19558            GO TO 7100-DISPLAY-CANCELS.
 19559
 19560 4310-BUMP-SEQ.
 19561     IF NOT DISPLAY-CHANGE-RECORDS
 19562        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 359
* EL6311.cbl
 19563        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19564     ELSE
 19565        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19566           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19567           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19568        ELSE
 19569           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19570           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19571
 19572     GO TO 4305-READ-NEXT.
 19573
 19574 4350-END-BATCH.
 19575
 19576******************************************************************
 19577*                                                                *
 19578*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19579*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19580*         PROGRAM.                                               *
 19581*                                                                *
 19582******************************************************************
 19583
 19584     IF  EIBTRNID NOT = TRANS-EXB1
 19585         IF PENDING-BUS-RECS-FOUND
 19586             NEXT SENTENCE
 19587           ELSE
 19588             MOVE '9'            TO PI-BROWSE-SW
 19589             GO TO 9400-CLEAR.
 19590
 19591     IF SHOW-RECORD
 19592        MOVE ER-2253            TO EMI-ERROR
 19593     ELSE
 19594        MOVE ER-2251            TO EMI-ERROR.
 19595
 19596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19597
 19598     IF PI-MAP-NAME = SPACES
 19599        MOVE -1                  TO BMAINTL
 19600        MOVE EL631B               TO PI-MAP-NAME
 19601        GO TO 8100-SEND-INITIAL-MAP.
 19602
 19603     IF PI-MAP-NAME = EL631B
 19604        MOVE -1                  TO BMAINTL
 19605     ELSE
 19606        IF PI-MAP-NAME = EL631C
 19607           MOVE -1               TO CMAINTL
 19608        ELSE
 19609           MOVE -1               TO DPFENTRL.
 19610
 19611     GO TO 8200-SEND-DATAONLY.
 19612
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 360
* EL6311.cbl
 19614
 19615******************************************************************
 19616*                                                                *
 19617*        B R O W S E   D E T A I L   B A C K W A R D             *
 19618*                                                                *
 19619******************************************************************
 19620
 19621 4500-BROWSE-DETAIL-BACKWARD.
 19622
 19623     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19624
 19625
 19626* EXEC CICS HANDLE CONDITION
 19627*         NOTFND   (4570-NOT-FOUND)
 19628*         ENDFILE  (4550-END-RECORDS)
 19629*    END-EXEC
 19630*    MOVE '"$I''                  ! N #00016744' TO DFHEIV0
 19631     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19633     MOVE X'4E20233030303136373434' TO DFHEIV0(25:11)
 19634     CALL 'kxdfhei1' USING DFHEIV0
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19636
 19637
 19638* EXEC CICS STARTBR
 19639*         DATASET   (FILE-ID-ERPNDB2)
 19640*         RIDFLD    (ERPNDB-ALT-KEY)
 19641*    END-EXEC.
 19642     MOVE 0
 19643       TO DFHEIV11
 19644*    MOVE '&,         G          &   #00016749' TO DFHEIV0
 19645     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19647     MOVE X'2020233030303136373439' TO DFHEIV0(25:11)
 19648     CALL 'kxdfhei1' USING DFHEIV0,
 19649           FILE-ID-ERPNDB2,
 19650           ERPNDB-ALT-KEY,
 19651           DFHEIV99,
 19652           DFHEIV11,
 19653           DFHEIV99
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19655
 19656
 19657     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19658                                    WS-FIRST-TIME-SW.
 19659
 19660 4505-READ-PREV-RECORD.
 19661
 19662* EXEC CICS READPREV
 19663*         DATASET    (FILE-ID-ERPNDB2)
 19664*         SET        (ADDRESS OF PENDING-BUSINESS)
 19665*         RIDFLD     (ERPNDB-ALT-KEY)
 19666*    END-EXEC.
 19667     MOVE 0
 19668       TO DFHEIV11
 19669*    MOVE '&0S                   )   #00016758' TO DFHEIV0
 19670     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19671     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 361
* EL6311.cbl
 19672     MOVE X'2020233030303136373538' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0,
 19674           FILE-ID-ERPNDB2,
 19675           DFHEIV20,
 19676           DFHEIV99,
 19677           ERPNDB-ALT-KEY,
 19678           DFHEIV99,
 19679           DFHEIV11,
 19680           DFHEIV99,
 19681           DFHEIV99
 19682     SET ADDRESS OF PENDING-BUSINESS TO
 19683         DFHEIV20
 19684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19685
 19686
 19687     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19688
 19689     IF WS-BATCH-PREFIX = '#CL'
 19690         GO TO 4505-READ-PREV-RECORD.
 19691
 19692     IF FIRST-TIME
 19693         MOVE SPACE               TO WS-FIRST-TIME-SW
 19694         GO TO 4505-READ-PREV-RECORD.
 19695
 19696     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19697        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19698        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19699        PB-STATE         NOT = PI-PB-STATE    OR
 19700        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19701          GO TO 4550-END-RECORDS.
 19702
 19703
 19704     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19705
 19706     IF PB-BATCH-TRAILER
 19707        GO TO 4505-READ-PREV-RECORD.
 19708
 19709     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19710
 19711     IF  WS-BATCH-PREFIX = '#CL'
 19712         GO TO 4505-READ-PREV-RECORD.
 19713
 19714     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19715        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19716           GO TO 4505-READ-PREV-RECORD
 19717        ELSE
 19718           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19719              GO TO 4510-CHECK-REC-TYPE
 19720           ELSE
 19721              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19722                 GO TO 4510-CHECK-REC-TYPE
 19723              ELSE
 19724                 GO TO 4505-READ-PREV-RECORD.
 19725
 19726     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19727        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19728           GO TO 4505-READ-PREV-RECORD.
 19729
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 362
* EL6311.cbl
 19730 4510-CHECK-REC-TYPE.
 19731     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19732         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19733             NEXT SENTENCE
 19734         ELSE
 19735             GO TO 4505-READ-PREV-RECORD.
 19736
 19737     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19738         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19739             NEXT SENTENCE
 19740        ELSE
 19741             GO TO 4505-READ-PREV-RECORD.
 19742
 19743     IF NOT DISPLAY-CHANGE-RECORDS AND
 19744            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19745        GO TO 4505-READ-PREV-RECORD.
 19746
 19747     IF DISPLAY-HOLD-RECORDS AND
 19748        NOT PB-RECORD-ON-HOLD
 19749          GO TO 4505-READ-PREV-RECORD.
 19750
 19751     IF PB-ISSUE
 19752        IF DISPLAY-CHK-REQ-RECORDS
 19753           GO TO 4505-READ-PREV-RECORD.
 19754
 19755     IF PB-ISSUE
 19756        IF ISSUE-WITH-WARNING
 19757           IF PB-WARNING-ERRORS
 19758              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19759                  GO TO 4505-READ-PREV-RECORD
 19760              ELSE
 19761                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19762                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19763                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19764                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19765                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19766                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19767                 GO TO 7000-DISPLAY-ISSUES
 19768           ELSE
 19769              GO TO 4505-READ-PREV-RECORD.
 19770
 19771     IF PB-ISSUE
 19772        IF (ISSUES-IN-ERROR AND
 19773            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19774            ALL-ISSUES
 19775            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19776            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19777            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19778            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19779            MOVE PB-SV-STATE            TO PI-SV-STATE
 19780            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19781            GO TO 7000-DISPLAY-ISSUES
 19782        ELSE
 19783            GO TO 4505-READ-PREV-RECORD.
 19784
 19785     IF PB-CANCELLATION
 19786        IF DISPLAY-CHK-REQ-RECORDS
 19787           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 363
* EL6311.cbl
 19788              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19789              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19790              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19791              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19792              MOVE PB-SV-STATE            TO PI-SV-STATE
 19793              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19794              GO TO 7100-DISPLAY-CANCELS
 19795           ELSE
 19796              GO TO 4505-READ-PREV-RECORD.
 19797
 19798     IF PB-CANCELLATION
 19799        IF CANCEL-WITH-WARNING
 19800           IF PB-WARNING-ERRORS
 19801              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19802                  GO TO 4505-READ-PREV-RECORD
 19803              ELSE
 19804                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19805                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19806                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19807                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19808                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19809                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19810                 GO TO 7100-DISPLAY-CANCELS
 19811           ELSE
 19812              GO TO 4505-READ-PREV-RECORD.
 19813
 19814     IF PB-CANCELLATION
 19815        IF (CANCEL-IN-ERROR  AND
 19816            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19817            ALL-CANCELS
 19818            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19819            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19820            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19821            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19822            MOVE PB-SV-STATE            TO PI-SV-STATE
 19823            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19824            GO TO 7100-DISPLAY-CANCELS.
 19825
 19826     GO TO 4505-READ-PREV-RECORD.
 19827
 19828 4550-END-RECORDS.
 19829     IF PI-MAP-NAME = EL631B
 19830        MOVE -1                  TO BMAINTL
 19831     ELSE
 19832        IF PI-MAP-NAME = EL631C
 19833           MOVE -1               TO CMAINTL
 19834        ELSE
 19835           MOVE -1               TO DPFENTRL.
 19836
 19837     MOVE ER-2255               TO EMI-ERROR.
 19838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19839     GO TO 8200-SEND-DATAONLY.
 19840
 19841 4570-NOT-FOUND.
 19842
 19843******************************************************************
 19844*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19845******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 364
* EL6311.cbl
 19846
 19847
 19848* EXEC CICS RESETBR
 19849*         DATASET    (FILE-ID-ERPNDB2)
 19850*         RIDFLD     (ERPNDB-ALT-KEY)
 19851*    END-EXEC.
 19852     MOVE 0
 19853       TO DFHEIV11
 19854*    MOVE '&4         G          &   #00016924' TO DFHEIV0
 19855     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19856     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19857     MOVE X'2020233030303136393234' TO DFHEIV0(25:11)
 19858     CALL 'kxdfhei1' USING DFHEIV0,
 19859           FILE-ID-ERPNDB2,
 19860           ERPNDB-ALT-KEY,
 19861           DFHEIV99,
 19862           DFHEIV11,
 19863           DFHEIV99
 19864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19865
 19866
 19867
 19868* EXEC CICS READNEXT
 19869*         DATASET    (FILE-ID-ERPNDB2)
 19870*         SET        (ADDRESS OF PENDING-BUSINESS)
 19871*         RIDFLD     (ERPNDB-ALT-KEY)
 19872*    END-EXEC.
 19873     MOVE 0
 19874       TO DFHEIV11
 19875*    MOVE '&.S                   )   #00016929' TO DFHEIV0
 19876     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19877     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19878     MOVE X'2020233030303136393239' TO DFHEIV0(25:11)
 19879     CALL 'kxdfhei1' USING DFHEIV0,
 19880           FILE-ID-ERPNDB2,
 19881           DFHEIV20,
 19882           DFHEIV99,
 19883           ERPNDB-ALT-KEY,
 19884           DFHEIV99,
 19885           DFHEIV11,
 19886           DFHEIV99,
 19887           DFHEIV99
 19888     SET ADDRESS OF PENDING-BUSINESS TO
 19889         DFHEIV20
 19890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19891
 19892
 19893
 19894* EXEC CICS READPREV
 19895*         DATASET    (FILE-ID-ERPNDB2)
 19896*         SET        (ADDRESS OF PENDING-BUSINESS)
 19897*         RIDFLD     (ERPNDB-ALT-KEY)
 19898*    END-EXEC.
 19899     MOVE 0
 19900       TO DFHEIV11
 19901*    MOVE '&0S                   )   #00016935' TO DFHEIV0
 19902     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19903     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 365
* EL6311.cbl
 19904     MOVE X'2020233030303136393335' TO DFHEIV0(25:11)
 19905     CALL 'kxdfhei1' USING DFHEIV0,
 19906           FILE-ID-ERPNDB2,
 19907           DFHEIV20,
 19908           DFHEIV99,
 19909           ERPNDB-ALT-KEY,
 19910           DFHEIV99,
 19911           DFHEIV11,
 19912           DFHEIV99,
 19913           DFHEIV99
 19914     SET ADDRESS OF PENDING-BUSINESS TO
 19915         DFHEIV20
 19916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19917
 19918
 19919 4580-READ-PREV-RECORD.
 19920
 19921* EXEC CICS READPREV
 19922*         DATASET    (FILE-ID-ERPNDB2)
 19923*         SET        (ADDRESS OF PENDING-BUSINESS)
 19924*         RIDFLD     (ERPNDB-ALT-KEY)
 19925*    END-EXEC.
 19926     MOVE 0
 19927       TO DFHEIV11
 19928*    MOVE '&0S                   )   #00016942' TO DFHEIV0
 19929     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19930     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19931     MOVE X'2020233030303136393432' TO DFHEIV0(25:11)
 19932     CALL 'kxdfhei1' USING DFHEIV0,
 19933           FILE-ID-ERPNDB2,
 19934           DFHEIV20,
 19935           DFHEIV99,
 19936           ERPNDB-ALT-KEY,
 19937           DFHEIV99,
 19938           DFHEIV11,
 19939           DFHEIV99,
 19940           DFHEIV99
 19941     SET ADDRESS OF PENDING-BUSINESS TO
 19942         DFHEIV20
 19943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19944
 19945
 19946     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19947
 19948     IF WS-BATCH-PREFIX = '#CL'
 19949        GO TO 4580-READ-PREV-RECORD.
 19950
 19951     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19952     GO TO 4505-READ-PREV-RECORD.
 19953
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 366
* EL6311.cbl
 19955
 19956******************************************************************
 19957*                                                                *
 19958*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19959*                                                                *
 19960******************************************************************
 19961
 19962 4600-BROWSE-PRIMARY-BACKWARD.
 19963        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19964
 19965     IF ERPNDB-BATCH-SEQ-NO = +9999
 19966        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19967
 19968        IF ERPNDB-BATCH-SEQ-NO = +0000
 19969           GO TO 4650-END-BATCH
 19970        ELSE
 19971           IF PI-MAP-NAME NOT = EL631D
 19972              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19973                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19974              ELSE
 19975                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19976                 IF DISPLAY-CHANGE-RECORDS
 19977                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19978                 ELSE
 19979                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19980
 19981
 19982* EXEC CICS HANDLE CONDITION
 19983*         NOTFND    (4680-NOT-FOUND)
 19984*         ENDFILE   (4680-NOT-FOUND)
 19985*    END-EXEC.
 19986*    MOVE '"$I''                  ! O #00016983' TO DFHEIV0
 19987     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19989     MOVE X'4F20233030303136393833' TO DFHEIV0(25:11)
 19990     CALL 'kxdfhei1' USING DFHEIV0
 19991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19992
 19993
 19994 4605-READ-NEXT.
 19995     IF ERPNDB-BATCH-SEQ-NO = +0000
 19996        GO TO 4650-END-BATCH.
 19997
 19998     IF PI-DISPLAY-ORIGINAL-BATCH
 19999        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20000     ELSE
 20001        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20002
 20003
 20004* EXEC CICS READ
 20005*         DATASET   (FILE-ID)
 20006*         SET       (ADDRESS OF PENDING-BUSINESS)
 20007*         RIDFLD    (ERPNDB-KEY)
 20008*    END-EXEC.
 20009*    MOVE '&"S        E          (   #00016997' TO DFHEIV0
 20010     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20011     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20012     MOVE X'2020233030303136393937' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 367
* EL6311.cbl
 20013     CALL 'kxdfhei1' USING DFHEIV0,
 20014           FILE-ID,
 20015           DFHEIV20,
 20016           DFHEIV99,
 20017           ERPNDB-KEY,
 20018           DFHEIV99,
 20019           DFHEIV99,
 20020           DFHEIV99
 20021     SET ADDRESS OF PENDING-BUSINESS TO
 20022         DFHEIV20
 20023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20024
 20025
 20026     IF NOT  PI-PRIMARY-WITH-SELECT
 20027        GO TO 4607-CHECK-REC-TYPE.
 20028
 20029     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20030
 20031     IF  WS-BATCH-PREFIX = '#CL'
 20032         GO TO 4610-BUMP-SEQ.
 20033
 20034     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20035        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20036           GO TO 4610-BUMP-SEQ
 20037        ELSE
 20038           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20039              GO TO 4607-CHECK-REC-TYPE
 20040           ELSE
 20041              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20042                 GO TO 4607-CHECK-REC-TYPE
 20043              ELSE
 20044                 GO TO 4610-BUMP-SEQ.
 20045
 20046     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20047        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20048           GO TO 4610-BUMP-SEQ.
 20049
 20050 4607-CHECK-REC-TYPE.
 20051     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20052         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20053             NEXT SENTENCE
 20054         ELSE
 20055             GO TO 4610-BUMP-SEQ.
 20056
 20057     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20058         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20059             NEXT SENTENCE
 20060        ELSE
 20061             GO TO 4610-BUMP-SEQ.
 20062
 20063     IF NOT DISPLAY-CHANGE-RECORDS AND
 20064            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20065        GO TO 4610-BUMP-SEQ.
 20066
 20067     IF DISPLAY-HOLD-RECORDS AND
 20068        NOT PB-RECORD-ON-HOLD
 20069          GO TO 4610-BUMP-SEQ.
 20070
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 368
* EL6311.cbl
 20071     IF PB-ISSUE
 20072        IF DISPLAY-CHK-REQ-RECORDS
 20073           GO TO 4610-BUMP-SEQ.
 20074
 20075     IF PB-ISSUE
 20076        IF ISSUE-WITH-WARNING
 20077           IF PB-WARNING-ERRORS
 20078              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20079                  GO TO 4610-BUMP-SEQ
 20080              ELSE
 20081                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20082                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20083                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20084                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20085                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20086                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20087                 GO TO 7000-DISPLAY-ISSUES
 20088           ELSE
 20089              GO TO 4610-BUMP-SEQ.
 20090
 20091     IF PB-ISSUE
 20092        IF (ISSUES-IN-ERROR AND
 20093            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20094            ALL-ISSUES
 20095            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20096            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20097            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20098            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20099            MOVE PB-SV-STATE            TO PI-SV-STATE
 20100            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20101            GO TO 7000-DISPLAY-ISSUES
 20102        ELSE
 20103            GO TO 4610-BUMP-SEQ.
 20104
 20105     IF PB-CANCELLATION
 20106        IF DISPLAY-CHK-REQ-RECORDS
 20107           IF PB-C-REFUND-REQUESTED
 20108              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20109              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20110              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20111              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20112              MOVE PB-SV-STATE            TO PI-SV-STATE
 20113              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20114              GO TO 7100-DISPLAY-CANCELS
 20115           ELSE
 20116              GO TO 4610-BUMP-SEQ.
 20117
 20118     IF PB-CANCELLATION
 20119        IF CANCEL-WITH-WARNING
 20120           IF PB-WARNING-ERRORS
 20121              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20122                  GO TO 4610-BUMP-SEQ
 20123              ELSE
 20124                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20125                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20126                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20127                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20128                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 369
* EL6311.cbl
 20129                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20130                 GO TO 7100-DISPLAY-CANCELS
 20131           ELSE
 20132              GO TO 4610-BUMP-SEQ.
 20133
 20134     IF PB-CANCELLATION
 20135        IF (CANCEL-IN-ERROR  AND
 20136            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20137            ALL-CANCELS
 20138            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20139            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20140            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20141            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20142            MOVE PB-SV-STATE            TO PI-SV-STATE
 20143            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20144            GO TO 7100-DISPLAY-CANCELS.
 20145
 20146 4610-BUMP-SEQ.
 20147     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20148        GO TO 4650-END-BATCH.
 20149
 20150     IF DISPLAY-CHANGE-RECORDS
 20151        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20152           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20153        ELSE
 20154           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20155           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20156        ELSE
 20157           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20158           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20159
 20160        GO TO 4605-READ-NEXT.
 20161
 20162 4650-END-BATCH.
 20163     IF PI-MAP-NAME = EL631B
 20164        MOVE -1                  TO BMAINTL
 20165     ELSE
 20166        IF PI-MAP-NAME = EL631C
 20167           MOVE -1               TO CMAINTL
 20168        ELSE
 20169           MOVE -1               TO DPFENTRL.
 20170
 20171     MOVE ER-2252               TO EMI-ERROR.
 20172     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20173     GO TO 8200-SEND-DATAONLY.
 20174
 20175 4680-NOT-FOUND.
 20176     IF DISPLAY-CHANGE-RECORDS
 20177        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20178           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20179        ELSE
 20180           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20181           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20182     ELSE
 20183        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20184
 20185     GO TO 4605-READ-NEXT.
 20186
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 370
* EL6311.cbl
 20188
 20189******************************************************************
 20190*                                                                *
 20191*        B R O W S E   F I L E   B A C K W A R D S               *
 20192*                                                                *
 20193******************************************************************
 20194
 20195 4800-BROWSE-FILE-BACKWARD.
 20196
 20197* EXEC CICS HANDLE CONDITION
 20198*         NOTFND   (4860-NOT-FOUND)
 20199*         ENDFILE  (4850-END-RECORDS)
 20200*    END-EXEC.
 20201*    MOVE '"$I''                  ! P #00017173' TO DFHEIV0
 20202     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20204     MOVE X'5020233030303137313733' TO DFHEIV0(25:11)
 20205     CALL 'kxdfhei1' USING DFHEIV0
 20206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20207
 20208
 20209     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20210
 20211     IF PI-DISPLAY-ORIGINAL-BATCH
 20212        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20213     ELSE
 20214        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20215
 20216
 20217* EXEC CICS STARTBR
 20218*         DATASET   (FILE-ID)
 20219*         RIDFLD    (ERPNDB-KEY)
 20220*    END-EXEC.
 20221     MOVE 0
 20222       TO DFHEIV11
 20223*    MOVE '&,         G          &   #00017185' TO DFHEIV0
 20224     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20225     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20226     MOVE X'2020233030303137313835' TO DFHEIV0(25:11)
 20227     CALL 'kxdfhei1' USING DFHEIV0,
 20228           FILE-ID,
 20229           ERPNDB-KEY,
 20230           DFHEIV99,
 20231           DFHEIV11,
 20232           DFHEIV99
 20233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20234
 20235
 20236     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20237
 20238
 20239* EXEC CICS READPREV
 20240*         DATASET    (FILE-ID-ERPNDB)
 20241*         SET        (ADDRESS OF PENDING-BUSINESS)
 20242*         RIDFLD     (ERPNDB-KEY)
 20243*    END-EXEC.
 20244     MOVE 0
 20245       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 371
* EL6311.cbl
 20246*    MOVE '&0S                   )   #00017192' TO DFHEIV0
 20247     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20248     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20249     MOVE X'2020233030303137313932' TO DFHEIV0(25:11)
 20250     CALL 'kxdfhei1' USING DFHEIV0,
 20251           FILE-ID-ERPNDB,
 20252           DFHEIV20,
 20253           DFHEIV99,
 20254           ERPNDB-KEY,
 20255           DFHEIV99,
 20256           DFHEIV11,
 20257           DFHEIV99,
 20258           DFHEIV99
 20259     SET ADDRESS OF PENDING-BUSINESS TO
 20260         DFHEIV20
 20261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20262
 20263
 20264 4810-READ-PREV-RECORD.
 20265
 20266* EXEC CICS READPREV
 20267*         DATASET    (FILE-ID-ERPNDB)
 20268*         SET        (ADDRESS OF PENDING-BUSINESS)
 20269*         RIDFLD     (ERPNDB-KEY)
 20270*    END-EXEC.
 20271     MOVE 0
 20272       TO DFHEIV11
 20273*    MOVE '&0S                   )   #00017199' TO DFHEIV0
 20274     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20275     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20276     MOVE X'2020233030303137313939' TO DFHEIV0(25:11)
 20277     CALL 'kxdfhei1' USING DFHEIV0,
 20278           FILE-ID-ERPNDB,
 20279           DFHEIV20,
 20280           DFHEIV99,
 20281           ERPNDB-KEY,
 20282           DFHEIV99,
 20283           DFHEIV11,
 20284           DFHEIV99,
 20285           DFHEIV99
 20286     SET ADDRESS OF PENDING-BUSINESS TO
 20287         DFHEIV20
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20292        GO TO 4850-END-RECORDS.
 20293
 20294     IF PB-BATCH-TRAILER
 20295        GO TO 4810-READ-PREV-RECORD.
 20296
 20297     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20298
 20299     IF  WS-BATCH-PREFIX = '#CL'
 20300         GO TO 4810-READ-PREV-RECORD.
 20301
 20302     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20303        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 372
* EL6311.cbl
 20304           GO TO 4810-READ-PREV-RECORD
 20305        ELSE
 20306           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20307              GO TO 4820-CHECK-REC-TYPE
 20308           ELSE
 20309              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20310                 GO TO 4820-CHECK-REC-TYPE
 20311              ELSE
 20312                 GO TO 4810-READ-PREV-RECORD.
 20313
 20314     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20315        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20316           GO TO 4810-READ-PREV-RECORD.
 20317
 20318 4820-CHECK-REC-TYPE.
 20319     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20320         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20321             NEXT SENTENCE
 20322         ELSE
 20323             GO TO 4810-READ-PREV-RECORD.
 20324
 20325     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20326         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20327             NEXT SENTENCE
 20328        ELSE
 20329             GO TO 4810-READ-PREV-RECORD.
 20330
 20331     IF NOT DISPLAY-CHANGE-RECORDS AND
 20332            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20333        GO TO 4810-READ-PREV-RECORD.
 20334
 20335     IF DISPLAY-HOLD-RECORDS AND
 20336        NOT PB-RECORD-ON-HOLD
 20337          GO TO 4810-READ-PREV-RECORD.
 20338
 20339     IF PB-ISSUE
 20340        IF DISPLAY-CHK-REQ-RECORDS
 20341           GO TO 4810-READ-PREV-RECORD.
 20342
 20343     IF PB-ISSUE
 20344        IF ISSUE-WITH-WARNING
 20345           IF PB-WARNING-ERRORS
 20346              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20347                  GO TO 4810-READ-PREV-RECORD
 20348              ELSE
 20349                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20350                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20351                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20352                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20353                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20354                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20355                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20356                 GO TO 7000-DISPLAY-ISSUES
 20357           ELSE
 20358              GO TO 4810-READ-PREV-RECORD.
 20359
 20360     IF PB-ISSUE
 20361        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 373
* EL6311.cbl
 20362            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20363            ALL-ISSUES
 20364            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20365            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20366            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20367            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20368            MOVE PB-SV-STATE            TO PI-SV-STATE
 20369            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20370            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20371            GO TO 7000-DISPLAY-ISSUES
 20372        ELSE
 20373            GO TO 4810-READ-PREV-RECORD.
 20374
 20375     IF PB-CANCELLATION
 20376        IF DISPLAY-CHK-REQ-RECORDS
 20377           IF PB-C-REFUND-REQUESTED
 20378              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20379              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20380              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20381              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20382              MOVE PB-SV-STATE            TO PI-SV-STATE
 20383              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20384              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20385              GO TO 7100-DISPLAY-CANCELS
 20386           ELSE
 20387              GO TO 4810-READ-PREV-RECORD.
 20388
 20389     IF PB-CANCELLATION
 20390        IF CANCEL-WITH-WARNING
 20391           IF PB-WARNING-ERRORS
 20392              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20393                  GO TO 4810-READ-PREV-RECORD
 20394              ELSE
 20395                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20396                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20397                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20398                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20399                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20400                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20401                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20402                 GO TO 7100-DISPLAY-CANCELS
 20403           ELSE
 20404              GO TO 4810-READ-PREV-RECORD.
 20405
 20406     IF PB-CANCELLATION
 20407        IF (CANCEL-IN-ERROR  AND
 20408            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20409            ALL-CANCELS
 20410            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20411            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20412            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20413            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20414            MOVE PB-SV-STATE            TO PI-SV-STATE
 20415            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20416            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20417            GO TO 7100-DISPLAY-CANCELS.
 20418
 20419     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 374
* EL6311.cbl
 20420
 20421 4850-END-RECORDS.
 20422     MOVE ER-2252                TO EMI-ERROR.
 20423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20424
 20425     IF PI-MAP-NAME = EL631B
 20426        MOVE -1                  TO BPFENTRL
 20427     ELSE
 20428        MOVE -1                  TO CPFENTRL.
 20429
 20430     GO TO 8200-SEND-DATAONLY.
 20431
 20432 4860-NOT-FOUND.
 20433
 20434******************************************************************
 20435*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20436******************************************************************
 20437
 20438
 20439* EXEC CICS RESETBR
 20440*         DATASET    (FILE-ID-ERPNDB)
 20441*         RIDFLD     (ERPNDB-KEY)
 20442*     END-EXEC.
 20443     MOVE 0
 20444       TO DFHEIV11
 20445*    MOVE '&4         G          &   #00017352' TO DFHEIV0
 20446     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20448     MOVE X'2020233030303137333532' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0,
 20450           FILE-ID-ERPNDB,
 20451           ERPNDB-KEY,
 20452           DFHEIV99,
 20453           DFHEIV11,
 20454           DFHEIV99
 20455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20456
 20457
 20458
 20459* EXEC CICS READNEXT
 20460*         DATASET    (FILE-ID-ERPNDB)
 20461*         SET        (ADDRESS OF PENDING-BUSINESS)
 20462*         RIDFLD     (ERPNDB-KEY)
 20463*    END-EXEC.
 20464     MOVE 0
 20465       TO DFHEIV11
 20466*    MOVE '&.S                   )   #00017357' TO DFHEIV0
 20467     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20468     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20469     MOVE X'2020233030303137333537' TO DFHEIV0(25:11)
 20470     CALL 'kxdfhei1' USING DFHEIV0,
 20471           FILE-ID-ERPNDB,
 20472           DFHEIV20,
 20473           DFHEIV99,
 20474           ERPNDB-KEY,
 20475           DFHEIV99,
 20476           DFHEIV11,
 20477           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 375
* EL6311.cbl
 20478           DFHEIV99
 20479     SET ADDRESS OF PENDING-BUSINESS TO
 20480         DFHEIV20
 20481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20482
 20483
 20484
 20485* EXEC CICS READPREV
 20486*         DATASET    (FILE-ID-ERPNDB)
 20487*         SET        (ADDRESS OF PENDING-BUSINESS)
 20488*         RIDFLD     (ERPNDB-KEY)
 20489*    END-EXEC.
 20490     MOVE 0
 20491       TO DFHEIV11
 20492*    MOVE '&0S                   )   #00017363' TO DFHEIV0
 20493     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20494     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20495     MOVE X'2020233030303137333633' TO DFHEIV0(25:11)
 20496     CALL 'kxdfhei1' USING DFHEIV0,
 20497           FILE-ID-ERPNDB,
 20498           DFHEIV20,
 20499           DFHEIV99,
 20500           ERPNDB-KEY,
 20501           DFHEIV99,
 20502           DFHEIV11,
 20503           DFHEIV99,
 20504           DFHEIV99
 20505     SET ADDRESS OF PENDING-BUSINESS TO
 20506         DFHEIV20
 20507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20508
 20509
 20510     GO TO 4810-READ-PREV-RECORD.
 20511
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 376
* EL6311.cbl
 20513
 20514******************************************************************
 20515*                                                                *
 20516*           B R O W S E   C S R   B A C K W A R D                *
 20517*                                                                *
 20518******************************************************************
 20519
 20520 4900-BROWSE-CSR-BACKWARD.
 20521
 20522     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20523
 20524
 20525* EXEC CICS HANDLE CONDITION
 20526*         NOTFND   (4970-NOT-FOUND)
 20527*         ENDFILE  (4950-END-RECORDS)
 20528*    END-EXEC
 20529*    MOVE '"$I''                  ! Q #00017383' TO DFHEIV0
 20530     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20531     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20532     MOVE X'5120233030303137333833' TO DFHEIV0(25:11)
 20533     CALL 'kxdfhei1' USING DFHEIV0
 20534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20535
 20536
 20537* EXEC CICS STARTBR
 20538*         DATASET   (FILE-ID-ERPNDB4)
 20539*         RIDFLD    (ERPNDB-CSR-KEY)
 20540*    END-EXEC.
 20541     MOVE 0
 20542       TO DFHEIV11
 20543*    MOVE '&,         G          &   #00017388' TO DFHEIV0
 20544     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20545     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20546     MOVE X'2020233030303137333838' TO DFHEIV0(25:11)
 20547     CALL 'kxdfhei1' USING DFHEIV0,
 20548           FILE-ID-ERPNDB4,
 20549           ERPNDB-CSR-KEY,
 20550           DFHEIV99,
 20551           DFHEIV11,
 20552           DFHEIV99
 20553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20554
 20555
 20556     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20557                                    WS-FIRST-TIME-SW.
 20558
 20559 4905-READ-PREV-RECORD.
 20560
 20561* EXEC CICS READPREV
 20562*         DATASET    (FILE-ID-ERPNDB4)
 20563*         SET        (ADDRESS OF PENDING-BUSINESS)
 20564*         RIDFLD     (ERPNDB-CSR-KEY)
 20565*    END-EXEC.
 20566     MOVE 0
 20567       TO DFHEIV11
 20568*    MOVE '&0S                   )   #00017397' TO DFHEIV0
 20569     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20570     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 377
* EL6311.cbl
 20571     MOVE X'2020233030303137333937' TO DFHEIV0(25:11)
 20572     CALL 'kxdfhei1' USING DFHEIV0,
 20573           FILE-ID-ERPNDB4,
 20574           DFHEIV20,
 20575           DFHEIV99,
 20576           ERPNDB-CSR-KEY,
 20577           DFHEIV99,
 20578           DFHEIV11,
 20579           DFHEIV99,
 20580           DFHEIV99
 20581     SET ADDRESS OF PENDING-BUSINESS TO
 20582         DFHEIV20
 20583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20584
 20585
 20586     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20587
 20588     IF WS-BATCH-PREFIX = '#CL'
 20589         GO TO 4905-READ-PREV-RECORD.
 20590
 20591     IF FIRST-TIME
 20592         MOVE SPACE               TO WS-FIRST-TIME-SW
 20593         GO TO 4905-READ-PREV-RECORD.
 20594
 20595     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20596        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20597        GO TO 4950-END-RECORDS.
 20598
 20599     IF PB-BATCH-TRAILER
 20600        GO TO 4905-READ-PREV-RECORD.
 20601
 20602     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20603
 20604     IF  WS-BATCH-PREFIX = '#CL'
 20605         GO TO 4905-READ-PREV-RECORD.
 20606
 20607     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20608        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20609           GO TO 4905-READ-PREV-RECORD
 20610        ELSE
 20611           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20612              GO TO 4910-CHECK-REC-TYPE
 20613           ELSE
 20614              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20615                 GO TO 4910-CHECK-REC-TYPE
 20616              ELSE
 20617                 GO TO 4905-READ-PREV-RECORD.
 20618
 20619     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20620        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20621           GO TO 4905-READ-PREV-RECORD.
 20622
 20623 4910-CHECK-REC-TYPE.
 20624     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20625         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20626             NEXT SENTENCE
 20627         ELSE
 20628             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 378
* EL6311.cbl
 20629
 20630     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20631         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20632             NEXT SENTENCE
 20633        ELSE
 20634             GO TO 4905-READ-PREV-RECORD.
 20635
 20636     IF NOT DISPLAY-CHANGE-RECORDS AND
 20637            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20638        GO TO 4905-READ-PREV-RECORD.
 20639
 20640     IF DISPLAY-HOLD-RECORDS AND
 20641        NOT PB-RECORD-ON-HOLD
 20642          GO TO 4905-READ-PREV-RECORD.
 20643
 20644     IF PB-ISSUE
 20645        IF DISPLAY-CHK-REQ-RECORDS
 20646           GO TO 4905-READ-PREV-RECORD.
 20647
 20648     IF PB-ISSUE
 20649        IF ISSUE-WITH-WARNING
 20650           IF PB-WARNING-ERRORS
 20651              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20652                  GO TO 4505-READ-PREV-RECORD
 20653              ELSE
 20654                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20655                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20656                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20657                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20658                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20659                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20660                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20661                 GO TO 7000-DISPLAY-ISSUES
 20662           ELSE
 20663              GO TO 4905-READ-PREV-RECORD.
 20664
 20665     IF PB-ISSUE
 20666        IF (ISSUES-IN-ERROR AND
 20667            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20668            ALL-ISSUES
 20669            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20670            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20671            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20672            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20673            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20674            MOVE PB-SV-STATE            TO PI-SV-STATE
 20675            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20676            GO TO 7000-DISPLAY-ISSUES
 20677        ELSE
 20678            GO TO 4905-READ-PREV-RECORD.
 20679
 20680     IF PB-CANCELLATION
 20681        IF DISPLAY-CHK-REQ-RECORDS
 20682           IF PB-C-REFUND-REQUESTED
 20683              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20684              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20685              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20686              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 379
* EL6311.cbl
 20687              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20688              MOVE PB-SV-STATE            TO PI-SV-STATE
 20689              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20690              GO TO 7100-DISPLAY-CANCELS
 20691           ELSE
 20692              GO TO 4905-READ-PREV-RECORD.
 20693
 20694     IF PB-CANCELLATION
 20695        IF CANCEL-WITH-WARNING
 20696           IF PB-WARNING-ERRORS
 20697              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20698                  GO TO 4505-READ-PREV-RECORD
 20699              ELSE
 20700                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20701                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20702                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20703                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20704                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20705                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20706                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20707                 GO TO 7100-DISPLAY-CANCELS
 20708           ELSE
 20709              GO TO 4905-READ-PREV-RECORD.
 20710
 20711     IF PB-CANCELLATION
 20712        IF (CANCEL-IN-ERROR  AND
 20713            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20714            ALL-CANCELS
 20715            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20716            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20717            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20718            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20719            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20720            MOVE PB-SV-STATE            TO PI-SV-STATE
 20721            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20722            GO TO 7100-DISPLAY-CANCELS.
 20723
 20724     GO TO 4905-READ-PREV-RECORD.
 20725
 20726 4950-END-RECORDS.
 20727     IF PI-MAP-NAME = EL631B
 20728        MOVE -1                  TO BMAINTL
 20729     ELSE
 20730        IF PI-MAP-NAME = EL631C
 20731           MOVE -1               TO CMAINTL
 20732        ELSE
 20733           MOVE -1               TO DPFENTRL.
 20734
 20735     MOVE ER-2255               TO EMI-ERROR.
 20736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20737     GO TO 8200-SEND-DATAONLY.
 20738
 20739 4970-NOT-FOUND.
 20740
 20741******************************************************************
 20742*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20743******************************************************************
 20744
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 380
* EL6311.cbl
 20745
 20746* EXEC CICS RESETBR
 20747*         DATASET    (FILE-ID-ERPNDB4)
 20748*         RIDFLD     (ERPNDB-CSR-KEY)
 20749*    END-EXEC.
 20750     MOVE 0
 20751       TO DFHEIV11
 20752*    MOVE '&4         G          &   #00017562' TO DFHEIV0
 20753     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20754     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20755     MOVE X'2020233030303137353632' TO DFHEIV0(25:11)
 20756     CALL 'kxdfhei1' USING DFHEIV0,
 20757           FILE-ID-ERPNDB4,
 20758           ERPNDB-CSR-KEY,
 20759           DFHEIV99,
 20760           DFHEIV11,
 20761           DFHEIV99
 20762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20763
 20764
 20765
 20766* EXEC CICS READNEXT
 20767*         DATASET    (FILE-ID-ERPNDB4)
 20768*         SET        (ADDRESS OF PENDING-BUSINESS)
 20769*         RIDFLD     (ERPNDB-CSR-KEY)
 20770*    END-EXEC.
 20771     MOVE 0
 20772       TO DFHEIV11
 20773*    MOVE '&.S                   )   #00017567' TO DFHEIV0
 20774     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20775     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20776     MOVE X'2020233030303137353637' TO DFHEIV0(25:11)
 20777     CALL 'kxdfhei1' USING DFHEIV0,
 20778           FILE-ID-ERPNDB4,
 20779           DFHEIV20,
 20780           DFHEIV99,
 20781           ERPNDB-CSR-KEY,
 20782           DFHEIV99,
 20783           DFHEIV11,
 20784           DFHEIV99,
 20785           DFHEIV99
 20786     SET ADDRESS OF PENDING-BUSINESS TO
 20787         DFHEIV20
 20788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20789
 20790
 20791
 20792* EXEC CICS READPREV
 20793*         DATASET    (FILE-ID-ERPNDB4)
 20794*         SET        (ADDRESS OF PENDING-BUSINESS)
 20795*         RIDFLD     (ERPNDB-CSR-KEY)
 20796*    END-EXEC.
 20797     MOVE 0
 20798       TO DFHEIV11
 20799*    MOVE '&0S                   )   #00017573' TO DFHEIV0
 20800     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20801     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20802     MOVE X'2020233030303137353733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 381
* EL6311.cbl
 20803     CALL 'kxdfhei1' USING DFHEIV0,
 20804           FILE-ID-ERPNDB4,
 20805           DFHEIV20,
 20806           DFHEIV99,
 20807           ERPNDB-CSR-KEY,
 20808           DFHEIV99,
 20809           DFHEIV11,
 20810           DFHEIV99,
 20811           DFHEIV99
 20812     SET ADDRESS OF PENDING-BUSINESS TO
 20813         DFHEIV20
 20814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20815
 20816
 20817 4980-READ-PREV-RECORD.
 20818
 20819* EXEC CICS READPREV
 20820*         DATASET    (FILE-ID-ERPNDB4)
 20821*         SET        (ADDRESS OF PENDING-BUSINESS)
 20822*         RIDFLD     (ERPNDB-CSR-KEY)
 20823*    END-EXEC.
 20824     MOVE 0
 20825       TO DFHEIV11
 20826*    MOVE '&0S                   )   #00017580' TO DFHEIV0
 20827     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20828     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20829     MOVE X'2020233030303137353830' TO DFHEIV0(25:11)
 20830     CALL 'kxdfhei1' USING DFHEIV0,
 20831           FILE-ID-ERPNDB4,
 20832           DFHEIV20,
 20833           DFHEIV99,
 20834           ERPNDB-CSR-KEY,
 20835           DFHEIV99,
 20836           DFHEIV11,
 20837           DFHEIV99,
 20838           DFHEIV99
 20839     SET ADDRESS OF PENDING-BUSINESS TO
 20840         DFHEIV20
 20841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20842
 20843
 20844     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20845
 20846     IF WS-BATCH-PREFIX = '#CL'
 20847        GO TO 4980-READ-PREV-RECORD.
 20848
 20849     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20850     GO TO 4905-READ-PREV-RECORD.
 20851
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 382
* EL6311.cbl
 20853
 20854
 20855******************************************************************
 20856*                                                                *
 20857*        B R O W S E   B A T C H   H E A D E R S                 *
 20858*                                                                *
 20859******************************************************************
 20860
 20861 5000-BROWSE-BATCH-HEADERS.
 20862
 20863     IF EIBTRNID NOT = TRANS-EXB1
 20864        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20865        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20866        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20867        GO TO 5010-READ-NEXT-RECORD.
 20868
 20869     IF EIBAID = DFHPF4
 20870        MOVE '0'                TO PI-EDIT-SW
 20871        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20872        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20873        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20874        GO TO 5010-READ-NEXT-RECORD.
 20875
 20876     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20877     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20878     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20879
 20880
 20881* EXEC CICS HANDLE CONDITION
 20882*         ENDFILE  (5050-NOT-FOUND)
 20883*    END-EXEC.
 20884*    MOVE '"$''                   ! R #00017622' TO DFHEIV0
 20885     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20887     MOVE X'5220233030303137363232' TO DFHEIV0(25:11)
 20888     CALL 'kxdfhei1' USING DFHEIV0
 20889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20890
 20891
 20892 5010-READ-NEXT-RECORD.
 20893
 20894* EXEC CICS HANDLE CONDITION
 20895*         NOTFND    (5050-NOT-FOUND)
 20896*    END-EXEC.
 20897*    MOVE '"$I                   ! S #00017627' TO DFHEIV0
 20898     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20900     MOVE X'5320233030303137363237' TO DFHEIV0(25:11)
 20901     CALL 'kxdfhei1' USING DFHEIV0
 20902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20903
 20904
 20905
 20906* EXEC CICS READ
 20907*         DATASET   (FILE-ID-ERPNDB)
 20908*         SET       (ADDRESS OF PENDING-BUSINESS)
 20909*         RIDFLD    (ERPNDB-KEY)
 20910*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 383
* EL6311.cbl
 20911*    END-EXEC.
 20912*    MOVE '&"S        G          (   #00017631' TO DFHEIV0
 20913     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20915     MOVE X'2020233030303137363331' TO DFHEIV0(25:11)
 20916     CALL 'kxdfhei1' USING DFHEIV0,
 20917           FILE-ID-ERPNDB,
 20918           DFHEIV20,
 20919           DFHEIV99,
 20920           ERPNDB-KEY,
 20921           DFHEIV99,
 20922           DFHEIV99,
 20923           DFHEIV99
 20924     SET ADDRESS OF PENDING-BUSINESS TO
 20925         DFHEIV20
 20926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20927
 20928
 20929     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20930         GO TO 5050-NOT-FOUND.
 20931
 20932     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20933
 20934     IF WS-BATCH-PREFIX = '#CL'
 20935         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20936         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20937         GO TO 5010-READ-NEXT-RECORD.
 20938
 20939     IF NOT PB-BATCH-TRAILER
 20940         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20941         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20942         GO TO 5010-READ-NEXT-RECORD.
 20943
 20944     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20945         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20946             NEXT SENTENCE
 20947         ELSE
 20948             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20949             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20950             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20951             GO TO 5010-READ-NEXT-RECORD.
 20952
 20953     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20954         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20955             NEXT SENTENCE
 20956        ELSE
 20957             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20958             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20959             GO TO 5010-READ-NEXT-RECORD.
 20960
 20961     IF EIBAID = DFHPF4
 20962        MOVE '0'                TO PI-EDIT-SW
 20963        GO TO 7200-DISPLAY-BATCHES.
 20964
 20965     IF PI-CSR-BROWSE
 20966        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20967           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20968           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 384
* EL6311.cbl
 20969           GO TO 5010-READ-NEXT-RECORD.
 20970
 20971     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20972       IF PI-PB-CARRIER    = SPACES AND
 20973          PI-PB-GROUPING   = SPACES AND
 20974          PI-PB-STATE      = SPACES AND
 20975          PI-PB-ACCOUNT    = SPACES
 20976            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20977            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20978            GO TO 7200-DISPLAY-BATCHES
 20979         ELSE
 20980           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20981              PI-PB-GROUPING   = PB-GROUPING AND
 20982              PI-PB-STATE      = PB-STATE    AND
 20983              PI-PB-ACCOUNT    = PB-ACCOUNT
 20984              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20985              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20986              GO TO 7200-DISPLAY-BATCHES.
 20987
 20988     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20989     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20990
 20991
 20992* EXEC CICS HANDLE CONDITION
 20993*         NOTFND    (5050-NOT-FOUND)
 20994*    END-EXEC.
 20995*    MOVE '"$I                   ! T #00017700' TO DFHEIV0
 20996     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20998     MOVE X'5420233030303137373030' TO DFHEIV0(25:11)
 20999     CALL 'kxdfhei1' USING DFHEIV0
 21000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21001
 21002
 21003
 21004* EXEC CICS READ
 21005*         DATASET   (FILE-ID-ERPNDB)
 21006*         SET       (ADDRESS OF PENDING-BUSINESS)
 21007*         RIDFLD    (ERPNDB-KEY)
 21008*         GTEQ
 21009*    END-EXEC.
 21010*    MOVE '&"S        G          (   #00017704' TO DFHEIV0
 21011     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21013     MOVE X'2020233030303137373034' TO DFHEIV0(25:11)
 21014     CALL 'kxdfhei1' USING DFHEIV0,
 21015           FILE-ID-ERPNDB,
 21016           DFHEIV20,
 21017           DFHEIV99,
 21018           ERPNDB-KEY,
 21019           DFHEIV99,
 21020           DFHEIV99,
 21021           DFHEIV99
 21022     SET ADDRESS OF PENDING-BUSINESS TO
 21023         DFHEIV20
 21024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21025
 21026
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 385
* EL6311.cbl
 21027     GO TO 5010-READ-NEXT-RECORD.
 21028
 21029 5050-NOT-FOUND.
 21030
 21031******************************************************************
 21032*                                                                *
 21033*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21034*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21035*         PROGRAM.                                               *
 21036*                                                                *
 21037******************************************************************
 21038
 21039     IF EIBTRNID NOT = TRANS-EXB1
 21040        IF PENDING-BUS-RECS-FOUND
 21041            NEXT SENTENCE
 21042          ELSE
 21043            MOVE '9'            TO PI-BROWSE-SW
 21044            GO TO 9400-CLEAR.
 21045
 21046     MOVE ER-2256                TO EMI-ERROR.
 21047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21048
 21049     IF PI-MAP-NAME = SPACES
 21050        MOVE EL631D              TO PI-MAP-NAME
 21051        MOVE -1                  TO DPFENTRL
 21052        GO TO 8100-SEND-INITIAL-MAP.
 21053
 21054     IF PI-MAP-NAME = EL631B
 21055        MOVE -1                  TO BMAINTL
 21056     ELSE
 21057        IF PI-MAP-NAME = EL631C
 21058           MOVE -1               TO CMAINTL
 21059        ELSE
 21060           MOVE -1               TO DPFENTRL
 21061           GO TO 8200-SEND-DATAONLY.
 21062
 21063     GO TO 8100-SEND-INITIAL-MAP.
 21064
 21065     .
 21066 5100-PROCESS-POL-RESC.
 21067     MOVE ZEROS                  TO CG-LF-BENCD
 21068                                    CG-AH-BENCD
 21069                                    CG-LF-CAN-AMT
 21070                                    CG-AH-CAN-AMT
 21071     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21072                                    CG-AH-CAN-DT
 21073     MOVE SPACES                 TO CG-BATCH-NO
 21074     MOVE '4'                    TO CG-OPTION-CODE
 21075     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21076     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21077     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21078     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21079     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21080     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21081     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21082     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21083     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21084     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 386
* EL6311.cbl
 21085     MOVE PI-PREV-ALT-KEY (1:33)
 21086                                 TO CG-CERT-KEY
 21087     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21088     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21089                                    CG-AH-CAN-AMT
 21090     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21091                                    CG-AH-CAN-DT
 21092     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21093     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21094      display 'about to cancel ' cg-cert-key
 21095
 21096* EXEC CICS LINK
 21097*        PROGRAM  ('ELCANC')
 21098*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21099*    END-EXEC
 21100     MOVE LENGTH OF
 21101      CANCEL-GEN-PASS-AREA
 21102       TO DFHEIV11
 21103     MOVE 'ELCANC' TO DFHEIV1
 21104*    MOVE '."C                   (   #00017779' TO DFHEIV0
 21105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21107     MOVE X'2020233030303137373739' TO DFHEIV0(25:11)
 21108     CALL 'kxdfhei1' USING DFHEIV0,
 21109           DFHEIV1,
 21110           CANCEL-GEN-PASS-AREA,
 21111           DFHEIV11,
 21112           DFHEIV99,
 21113           DFHEIV99,
 21114           DFHEIV99,
 21115           DFHEIV99
 21116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21117     IF CG-SUCCESS
 21118        CONTINUE
 21119     ELSE
 21120        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21121        MOVE '3'                 TO EMI-SWITCH1
 21122        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21123        EVALUATE TRUE
 21124           WHEN CG-DATE-ERROR
 21125             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21126           WHEN CG-CERT-NOT-FOUND
 21127             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21128           WHEN CG-AMOUNT-ERROR
 21129             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21130           WHEN CG-OPTION-ERROR
 21131             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21132           WHEN CG-PREV-CAN
 21133             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21134           WHEN CG-INVALID-DATA
 21135             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21136           WHEN CG-NO-ACCT-MSTR
 21137             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21138           WHEN CG-SFX-A-EXIST
 21139             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21140           WHEN CG-MISC-ERROR
 21141             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21142           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 387
* EL6311.cbl
 21143             MOVE ' ERROR - ELCANC - RETURN '
 21144                                 TO EMI-ERROR-TEXT (1) (12:25)
 21145        END-EVALUATE
 21146        GO TO 8200-SEND-DATAONLY
 21147     END-IF
 21148     .
 21149 5100-EXIT.
 21150     EXIT.
 21151
 21152******************************************************************
 21153*                                                                *
 21154*        B R O W S E   B A T C H   B A C K W A R D S             *
 21155*                                                                *
 21156******************************************************************
 21157
 21158 5500-BROWSE-BATCH-BACKWARD.
 21159
 21160* EXEC CICS HANDLE CONDITION
 21161*         NOTFND   (5550-END-RECORDS)
 21162*         ENDFILE  (5550-END-RECORDS)
 21163*    END-EXEC.
 21164*    MOVE '"$I''                  ! U #00017825' TO DFHEIV0
 21165     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21167     MOVE X'5520233030303137383235' TO DFHEIV0(25:11)
 21168     CALL 'kxdfhei1' USING DFHEIV0
 21169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21170
 21171
 21172 5505-START-BROWSE.
 21173     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21174     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21175     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21176
 21177
 21178* EXEC CICS STARTBR
 21179*         DATASET   (FILE-ID-ERPNDB)
 21180*         RIDFLD    (ERPNDB-ALT-KEY)
 21181*    END-EXEC.
 21182     MOVE 0
 21183       TO DFHEIV11
 21184*    MOVE '&,         G          &   #00017835' TO DFHEIV0
 21185     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21186     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21187     MOVE X'2020233030303137383335' TO DFHEIV0(25:11)
 21188     CALL 'kxdfhei1' USING DFHEIV0,
 21189           FILE-ID-ERPNDB,
 21190           ERPNDB-ALT-KEY,
 21191           DFHEIV99,
 21192           DFHEIV11,
 21193           DFHEIV99
 21194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21195
 21196
 21197     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21198
 21199
 21200* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 388
* EL6311.cbl
 21201*         DATASET    (FILE-ID-ERPNDB)
 21202*         SET        (ADDRESS OF PENDING-BUSINESS)
 21203*         RIDFLD     (ERPNDB-KEY)
 21204*    END-EXEC.
 21205     MOVE 0
 21206       TO DFHEIV11
 21207*    MOVE '&.S                   )   #00017842' TO DFHEIV0
 21208     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21209     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21210     MOVE X'2020233030303137383432' TO DFHEIV0(25:11)
 21211     CALL 'kxdfhei1' USING DFHEIV0,
 21212           FILE-ID-ERPNDB,
 21213           DFHEIV20,
 21214           DFHEIV99,
 21215           ERPNDB-KEY,
 21216           DFHEIV99,
 21217           DFHEIV11,
 21218           DFHEIV99,
 21219           DFHEIV99
 21220     SET ADDRESS OF PENDING-BUSINESS TO
 21221         DFHEIV20
 21222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21223
 21224
 21225
 21226* EXEC CICS READPREV
 21227*         DATASET    (FILE-ID-ERPNDB)
 21228*         SET        (ADDRESS OF PENDING-BUSINESS)
 21229*         RIDFLD     (ERPNDB-KEY)
 21230*    END-EXEC.
 21231     MOVE 0
 21232       TO DFHEIV11
 21233*    MOVE '&0S                   )   #00017848' TO DFHEIV0
 21234     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21235     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21236     MOVE X'2020233030303137383438' TO DFHEIV0(25:11)
 21237     CALL 'kxdfhei1' USING DFHEIV0,
 21238           FILE-ID-ERPNDB,
 21239           DFHEIV20,
 21240           DFHEIV99,
 21241           ERPNDB-KEY,
 21242           DFHEIV99,
 21243           DFHEIV11,
 21244           DFHEIV99,
 21245           DFHEIV99
 21246     SET ADDRESS OF PENDING-BUSINESS TO
 21247         DFHEIV20
 21248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21249
 21250
 21251
 21252* EXEC CICS READPREV
 21253*         DATASET    (FILE-ID-ERPNDB)
 21254*         SET        (ADDRESS OF PENDING-BUSINESS)
 21255*         RIDFLD     (ERPNDB-KEY)
 21256*    END-EXEC.
 21257     MOVE 0
 21258       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 389
* EL6311.cbl
 21259*    MOVE '&0S                   )   #00017854' TO DFHEIV0
 21260     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21261     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21262     MOVE X'2020233030303137383534' TO DFHEIV0(25:11)
 21263     CALL 'kxdfhei1' USING DFHEIV0,
 21264           FILE-ID-ERPNDB,
 21265           DFHEIV20,
 21266           DFHEIV99,
 21267           ERPNDB-KEY,
 21268           DFHEIV99,
 21269           DFHEIV11,
 21270           DFHEIV99,
 21271           DFHEIV99
 21272     SET ADDRESS OF PENDING-BUSINESS TO
 21273         DFHEIV20
 21274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21275
 21276
 21277     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21278        GO TO 5550-END-RECORDS.
 21279
 21280     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21281
 21282     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21283
 21284     IF  WS-BATCH-PREFIX = '#CL'
 21285             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21286
 21287* EXEC CICS ENDBR
 21288*                 DATASET  (FILE-ID-ERPNDB)
 21289*            END-EXEC
 21290     MOVE 0
 21291       TO DFHEIV11
 21292*    MOVE '&2                    $   #00017869' TO DFHEIV0
 21293     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21294     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21295     MOVE X'2020233030303137383639' TO DFHEIV0(25:11)
 21296     CALL 'kxdfhei1' USING DFHEIV0,
 21297           FILE-ID-ERPNDB,
 21298           DFHEIV11,
 21299           DFHEIV99
 21300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21301         GO TO 5505-START-BROWSE.
 21302
 21303     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21304         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21305             NEXT SENTENCE
 21306         ELSE
 21307             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21308
 21309* EXEC CICS ENDBR
 21310*                 DATASET  (FILE-ID-ERPNDB)
 21311*            END-EXEC
 21312     MOVE 0
 21313       TO DFHEIV11
 21314*    MOVE '&2                    $   #00017879' TO DFHEIV0
 21315     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21316     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 390
* EL6311.cbl
 21317     MOVE X'2020233030303137383739' TO DFHEIV0(25:11)
 21318     CALL 'kxdfhei1' USING DFHEIV0,
 21319           FILE-ID-ERPNDB,
 21320           DFHEIV11,
 21321           DFHEIV99
 21322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21323             GO TO 5505-START-BROWSE.
 21324
 21325
 21326     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21327         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21328             NEXT SENTENCE
 21329        ELSE
 21330             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21331
 21332* EXEC CICS ENDBR
 21333*                 DATASET  (FILE-ID-ERPNDB)
 21334*            END-EXEC
 21335     MOVE 0
 21336       TO DFHEIV11
 21337*    MOVE '&2                    $   #00017890' TO DFHEIV0
 21338     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21339     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21340     MOVE X'2020233030303137383930' TO DFHEIV0(25:11)
 21341     CALL 'kxdfhei1' USING DFHEIV0,
 21342           FILE-ID-ERPNDB,
 21343           DFHEIV11,
 21344           DFHEIV99
 21345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21346             GO TO 5505-START-BROWSE.
 21347
 21348     IF NOT PB-BATCH-TRAILER
 21349        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21350
 21351* EXEC CICS ENDBR
 21352*            DATASET  (FILE-ID-ERPNDB)
 21353*       END-EXEC
 21354     MOVE 0
 21355       TO DFHEIV11
 21356*    MOVE '&2                    $   #00017897' TO DFHEIV0
 21357     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21358     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21359     MOVE X'2020233030303137383937' TO DFHEIV0(25:11)
 21360     CALL 'kxdfhei1' USING DFHEIV0,
 21361           FILE-ID-ERPNDB,
 21362           DFHEIV11,
 21363           DFHEIV99
 21364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21365        GO TO 5505-START-BROWSE.
 21366
 21367     IF PI-CSR-BROWSE
 21368        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21369           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21370
 21371* EXEC CICS ENDBR
 21372*               DATASET  (FILE-ID-ERPNDB)
 21373*          END-EXEC
 21374     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 391
* EL6311.cbl
 21375       TO DFHEIV11
 21376*    MOVE '&2                    $   #00017905' TO DFHEIV0
 21377     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21379     MOVE X'2020233030303137393035' TO DFHEIV0(25:11)
 21380     CALL 'kxdfhei1' USING DFHEIV0,
 21381           FILE-ID-ERPNDB,
 21382           DFHEIV11,
 21383           DFHEIV99
 21384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21385           GO TO 5505-START-BROWSE.
 21386
 21387     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21388        IF PI-PB-CARRIER    = SPACES AND
 21389           PI-PB-GROUPING   = SPACES AND
 21390           PI-PB-STATE      = SPACES AND
 21391           PI-PB-ACCOUNT    = SPACES
 21392             GO TO 7200-DISPLAY-BATCHES
 21393          ELSE
 21394            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21395               PI-PB-GROUPING   = PB-GROUPING AND
 21396               PI-PB-STATE      = PB-STATE    AND
 21397               PI-PB-ACCOUNT    = PB-ACCOUNT
 21398                 GO TO 7200-DISPLAY-BATCHES.
 21399
 21400     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21401
 21402
 21403* EXEC CICS ENDBR
 21404*         DATASET  (FILE-ID-ERPNDB)
 21405*    END-EXEC.
 21406     MOVE 0
 21407       TO DFHEIV11
 21408*    MOVE '&2                    $   #00017925' TO DFHEIV0
 21409     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21411     MOVE X'2020233030303137393235' TO DFHEIV0(25:11)
 21412     CALL 'kxdfhei1' USING DFHEIV0,
 21413           FILE-ID-ERPNDB,
 21414           DFHEIV11,
 21415           DFHEIV99
 21416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21417
 21418
 21419     GO TO 5505-START-BROWSE.
 21420
 21421 5550-END-RECORDS.
 21422     MOVE ER-2257                TO EMI-ERROR.
 21423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21424     MOVE -1                     TO DPFENTRL.
 21425
 21426     GO TO 8200-SEND-DATAONLY.
 21427
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 392
* EL6311.cbl
 21429
 21430******************************************************************
 21431*                                                                *
 21432*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21433*                                                                *
 21434******************************************************************
 21435
 21436 6000-CREATE-TEMP-STORAGE.
 21437
 21438
 21439* EXEC CICS HANDLE CONDITION
 21440*        QIDERR  (6050-QID-ERROR)
 21441*    END-EXEC.
 21442*    MOVE '"$N                   ! V #00017948' TO DFHEIV0
 21443     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21445     MOVE X'5620233030303137393438' TO DFHEIV0(25:11)
 21446     CALL 'kxdfhei1' USING DFHEIV0
 21447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21448
 21449
 21450
 21451* EXEC CICS WRITEQ TS
 21452*        QUEUE    (QID)
 21453*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21454*        LENGTH   (WS-COMM-LENGTH)
 21455*        ITEM     (W-ONE)
 21456*    END-EXEC.
 21457*    MOVE '*" I                  ''   #00017952' TO DFHEIV0
 21458     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21459     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21460     MOVE X'2020233030303137393532' TO DFHEIV0(25:11)
 21461     CALL 'kxdfhei1' USING DFHEIV0,
 21462           QID,
 21463           PROGRAM-INTERFACE-BLOCK,
 21464           WS-COMM-LENGTH,
 21465           W-ONE,
 21466           DFHEIV99,
 21467           DFHEIV99
 21468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21469
 21470
 21471 6000-EXIT.
 21472      EXIT.
 21473
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 393
* EL6311.cbl
 21475
 21476******************************************************************
 21477*                                                                *
 21478*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21479*                                                                *
 21480******************************************************************
 21481
 21482 6050-RECOVER-TEMP-STORAGE.
 21483     IF PGM-NAME = XCTL-EL6312
 21484        GO TO 6050-EXIT.
 21485
 21486     IF PGM-NAME = XCTL-EL6313
 21487        GO TO 6050-EXIT.
 21488
 21489     IF PGM-NAME = XCTL-EL6315
 21490         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21491     END-IF
 21492
 21493     IF PGM-NAME = XCTL-EL6316
 21494         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21495     END-IF
 21496
 21497
 21498* EXEC CICS HANDLE CONDITION
 21499*        QIDERR  (6050-QID-ERROR)
 21500*    END-EXEC.
 21501*    MOVE '"$N                   ! W #00017985' TO DFHEIV0
 21502     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21504     MOVE X'5720233030303137393835' TO DFHEIV0(25:11)
 21505     CALL 'kxdfhei1' USING DFHEIV0
 21506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21507
 21508
 21509
 21510* EXEC CICS READQ TS
 21511*         QUEUE   (QID)
 21512*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21513*         LENGTH  (WS-COMM-LENGTH)
 21514*         ITEM    (W-ONE)
 21515*     END-EXEC.
 21516*    MOVE '*$II   L              ''   #00017989' TO DFHEIV0
 21517     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21518     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21519     MOVE X'2020233030303137393839' TO DFHEIV0(25:11)
 21520     CALL 'kxdfhei1' USING DFHEIV0,
 21521           QID,
 21522           PROGRAM-INTERFACE-BLOCK,
 21523           WS-COMM-LENGTH,
 21524           W-ONE,
 21525           DFHEIV99,
 21526           DFHEIV99
 21527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21528
 21529
 21530 6050-DELETE-TEMP-STORAGE.
 21531
 21532
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 394
* EL6311.cbl
 21533* EXEC CICS DELETEQ TS
 21534*        QUEUE   (QID)
 21535*    END-EXEC.
 21536*    MOVE '*&                    #   #00017998' TO DFHEIV0
 21537     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21538     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21539     MOVE X'2020233030303137393938' TO DFHEIV0(25:11)
 21540     CALL 'kxdfhei1' USING DFHEIV0,
 21541           QID,
 21542           DFHEIV99
 21543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21544
 21545
 21546     GO TO 6050-EXIT.
 21547
 21548 6050-QID-ERROR.
 21549     MOVE ER-0033                TO EMI-ERROR
 21550     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21551
 21552 6050-EXIT.
 21553      EXIT.
 21554
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 395
* EL6311.cbl
 21556
 21557******************************************************************
 21558*                                                                *
 21559*            T E R M   C O N V E R S I O N                       *
 21560*                                                                *
 21561******************************************************************
 21562
 21563 6100-TERM-CONVERSION.
 21564
 21565     IF PI-BPMTS = ZERO
 21566         GO TO 6199-EXIT.
 21567
 21568     IF PI-BMODE = ' ' OR 'M'
 21569         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21570         GO TO 6105-ROUND-TERM.
 21571
 21572     IF PI-BMODE = 'S'
 21573         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21574         GO TO 6105-ROUND-TERM.
 21575
 21576     IF PI-BMODE = 'W'
 21577         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21578         GO TO 6105-ROUND-TERM.
 21579
 21580     IF PI-BMODE = 'B'
 21581         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21582         GO TO 6105-ROUND-TERM.
 21583
 21584     IF PI-BMODE = 'T'
 21585         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21586
 21587 6105-ROUND-TERM.
 21588
 21589     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21590         ADD +1                  TO WS-CALC-TERM-WHOLE
 21591         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21592
 21593     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21594         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21595
 21596     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21597         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21598                                      WS-BTERM    (WS-SUB1)
 21599         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21600
 21601     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21602         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21603             MOVE -1               TO BMODEL
 21604             MOVE ER-2593          TO EMI-ERROR
 21605             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21606             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21607
 21608 6124-CHECK-BENEFIT.
 21609
 21610     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21611        GO TO 6126-COMPUTE-BENEFIT.
 21612
 21613     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 396
* EL6311.cbl
 21614
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 397
* EL6311.cbl
 21616******************************************************************
 21617**         COMPUTE TERM AND BENEFIT
 21618******************************************************************
 21619 6125-COMPUTE-TERM-BENEFIT.
 21620
 21621     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21622        PI-BPMTAMT = ZERO
 21623         GO TO 6199-EXIT.
 21624
 21625     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21626                                     WS-BTERM  (WS-SUB1).
 21627     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21628
 21629 6126-COMPUTE-BENEFIT.
 21630
 21631     IF PI-BMODE = 'M' OR  ' '
 21632         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21633
 21634     IF PI-BMODE = 'W'
 21635         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21636
 21637     IF PI-BMODE = 'S'
 21638         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21639
 21640     IF PI-BMODE = 'B'
 21641         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21642
 21643     IF PI-BMODE = 'T'
 21644         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21645
 21646     IF WS-SUB1 = +1
 21647        COMPUTE WS-BBEN (WS-SUB1) =
 21648                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21649
 21650     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21651     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21652     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21653
 21654 6199-EXIT.
 21655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 398
* EL6311.cbl
 21657
 21658******************************************************************
 21659*                                                                *
 21660*             D I S P L A Y   I S S U E S                        *
 21661*                                                                *
 21662******************************************************************
 21663
 21664 6200-CREATE-VADS.
 21665     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21666     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21667     MOVE SPACES                 TO WS-PASS-VADS-REC
 21668
 21669* EXEC CICS GETMAIN
 21670*       SET      (ADDRESS OF PENDING-BUSINESS)
 21671*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21672*       INITIMG  (GETMAIN-SPACE)
 21673*       RESP     (WS-RESPONSE)
 21674*    END-EXEC
 21675*    MOVE ',"IL                  $  N#00018124' TO DFHEIV0
 21676     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21677     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21678     MOVE X'204E233030303138313234' TO DFHEIV0(25:11)
 21679     CALL 'kxdfhei1' USING DFHEIV0,
 21680           DFHEIV20,
 21681           ERPNDB-RECORD-LENGTH,
 21682           GETMAIN-SPACE
 21683     SET ADDRESS OF PENDING-BUSINESS TO
 21684         DFHEIV20
 21685     MOVE EIBRESP  TO WS-RESPONSE
 21686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21687
 21688* EXEC CICS READ
 21689*       INTO    (PENDING-BUSINESS)
 21690*       DATASET (FILE-ID-ERPNDB)
 21691*       RIDFLD  (ERPNDB-KEY)
 21692*       RESP    (WS-RESPONSE)
 21693*    END-EXEC
 21694     MOVE LENGTH OF
 21695      PENDING-BUSINESS
 21696       TO DFHEIV11
 21697*    MOVE '&"IL       E          (  N#00018130' TO DFHEIV0
 21698     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21700     MOVE X'204E233030303138313330' TO DFHEIV0(25:11)
 21701     CALL 'kxdfhei1' USING DFHEIV0,
 21702           FILE-ID-ERPNDB,
 21703           PENDING-BUSINESS,
 21704           DFHEIV11,
 21705           ERPNDB-KEY,
 21706           DFHEIV99,
 21707           DFHEIV99,
 21708           DFHEIV99
 21709     MOVE EIBRESP  TO WS-RESPONSE
 21710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21711     IF RESP-NORMAL
 21712        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21713        IF (RESP-NORMAL)
 21714           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 399
* EL6311.cbl
 21715              AM-CONTROL-PRIMARY (1:20))
 21716           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21717        ELSE
 21718           MOVE 'ACCOUNT NOT FOUND'
 21719                                 TO VD-ACCOUNT-NAME
 21720        END-IF
 21721        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21722                                    TO M1
 21723        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21724        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21725           (A2 > M1)
 21726           OR (WS-WORK-FIELD (A2:1) = '*')
 21727           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21728           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21729        END-PERFORM
 21730        IF A2 > M1
 21731           CONTINUE
 21732        ELSE
 21733           MOVE WS-WORK-FIELD (1:A2 - 1)
 21734                                    TO VD-ACCOUNT-NAME
 21735        END-IF
 21736        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21737        MOVE PB-CARRIER          TO VD-CARRIER
 21738        MOVE PB-GROUPING         TO VD-GROUPING
 21739        MOVE PB-STATE            TO VD-STATE
 21740        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21741        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21742        MOVE PB-CERT-NO          TO VD-CERT-NO
 21743        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21744        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21745        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21746        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21747        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21748        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21749        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21750        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21751        MOVE PB-CSR-ID           TO VD-CSR-ID
 21752        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21753        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21754        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21755        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21756        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21757        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21758        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21759        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21760        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21761        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21762        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21763        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21764        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21765     END-IF
 21766     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21767
 21768
 21769* EXEC CICS GETMAIN
 21770*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21771*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21772*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 400
* EL6311.cbl
 21773*       RESP     (WS-RESPONSE)
 21774*    END-EXEC
 21775*    MOVE ',"IL                  $  N#00018193' TO DFHEIV0
 21776     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21777     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21778     MOVE X'204E233030303138313933' TO DFHEIV0(25:11)
 21779     CALL 'kxdfhei1' USING DFHEIV0,
 21780           DFHEIV20,
 21781           ERPNDM-RECORD-LENGTH,
 21782           GETMAIN-SPACE
 21783     SET ADDRESS OF PENDING-MAILING-DATA TO
 21784         DFHEIV20
 21785     MOVE EIBRESP  TO WS-RESPONSE
 21786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21787
 21788
 21789* EXEC CICS READ
 21790*       INTO    (PENDING-MAILING-DATA)
 21791*       DATASET (FILE-ID-ERPNDM)
 21792*       RIDFLD  (ERPNDM-KEY)
 21793*       RESP    (WS-RESPONSE)
 21794*    END-EXEC
 21795     MOVE LENGTH OF
 21796      PENDING-MAILING-DATA
 21797       TO DFHEIV11
 21798*    MOVE '&"IL       E          (  N#00018200' TO DFHEIV0
 21799     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21801     MOVE X'204E233030303138323030' TO DFHEIV0(25:11)
 21802     CALL 'kxdfhei1' USING DFHEIV0,
 21803           FILE-ID-ERPNDM,
 21804           PENDING-MAILING-DATA,
 21805           DFHEIV11,
 21806           ERPNDM-KEY,
 21807           DFHEIV99,
 21808           DFHEIV99,
 21809           DFHEIV99
 21810     MOVE EIBRESP  TO WS-RESPONSE
 21811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21812
 21813     IF RESP-NORMAL
 21814        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21815        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21816        MOVE PM-CITY              TO VD-INSURED-CITY
 21817        MOVE PM-STATE             TO VD-INSURED-STATE
 21818        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21819     END-IF
 21820
 21821     MOVE 'VAC1'                  TO VD-LETTER-ID
 21822     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21823     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21824     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21825     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21826     MOVE +0                      TO VD-ARCHIVE-NO
 21827     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21828     .
 21829 6200-EXIT.
 21830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 401
* EL6311.cbl
 21831 6210-READ-ERACCT.
 21832     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21833     MOVE LOW-VALUES             TO ERACCT-FILL
 21834
 21835* EXEC CICS READ
 21836*         DATASET   ('ERACCT')
 21837*         INTO      (ACCOUNT-MASTER)
 21838*         RIDFLD    (ERACCT-KEY)
 21839*         GTEQ
 21840*         RESP      (WS-RESPONSE)
 21841*    END-EXEC
 21842     MOVE LENGTH OF
 21843      ACCOUNT-MASTER
 21844       TO DFHEIV11
 21845     MOVE 'ERACCT' TO DFHEIV1
 21846*    MOVE '&"IL       G          (  N#00018228' TO DFHEIV0
 21847     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21849     MOVE X'204E233030303138323238' TO DFHEIV0(25:11)
 21850     CALL 'kxdfhei1' USING DFHEIV0,
 21851           DFHEIV1,
 21852           ACCOUNT-MASTER,
 21853           DFHEIV11,
 21854           ERACCT-KEY,
 21855           DFHEIV99,
 21856           DFHEIV99,
 21857           DFHEIV99
 21858     MOVE EIBRESP  TO WS-RESPONSE
 21859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21860     .
 21861 6210-EXIT.
 21862     EXIT.
 21863
 21864 6220-READ-ERMAIL.
 21865
 21866     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21867     MOVE ' '                    TO WS-ERMAIL-SW
 21868
 21869
 21870* EXEC CICS READ
 21871*       DATASET   (FILE-ID-ERMAIL)
 21872*       SET       (ADDRESS OF MAILING-DATA)
 21873*       RIDFLD    (ERMAIL-KEY)
 21874*       RESP      (WS-RESPONSE)
 21875*    END-EXEC
 21876*    MOVE '&"S        E          (  N#00018244' TO DFHEIV0
 21877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21879     MOVE X'204E233030303138323434' TO DFHEIV0(25:11)
 21880     CALL 'kxdfhei1' USING DFHEIV0,
 21881           FILE-ID-ERMAIL,
 21882           DFHEIV20,
 21883           DFHEIV99,
 21884           ERMAIL-KEY,
 21885           DFHEIV99,
 21886           DFHEIV99,
 21887           DFHEIV99
 21888     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 402
* EL6311.cbl
 21889         DFHEIV20
 21890     MOVE EIBRESP  TO WS-RESPONSE
 21891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21892
 21893     IF RESP-NORMAL
 21894        SET ERMAIL-FOUND TO TRUE
 21895     END-IF
 21896     .
 21897 6220-EXIT.
 21898     EXIT.
 21899
 21900 6400-CHECK-FOR-RES-REF-CLAIM.
 21901     display 'made it to 6400- for ' pi-cert-no
 21902     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21903
 21904     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21905                                    W-CL-COMP-CD.
 21906     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21907                                    W-CL-CERT-NO.
 21908     MOVE SPACES                 TO MSTR-CERT-SFX.
 21909
 21910
 21911* EXEC CICS HANDLE CONDITION
 21912*        NOTFND  (6400-CONTINUE)
 21913*        ENDFILE (6400-CONTINUE)
 21914*    END-EXEC.
 21915*    MOVE '"$I''                  ! X #00018268' TO DFHEIV0
 21916     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21918     MOVE X'5820233030303138323638' TO DFHEIV0(25:11)
 21919     CALL 'kxdfhei1' USING DFHEIV0
 21920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21921
 21922
 21923
 21924* EXEC CICS IGNORE CONDITION
 21925*        DUPKEY
 21926*    END-EXEC.
 21927*    MOVE '"*$                   !   #00018273' TO DFHEIV0
 21928     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21930     MOVE X'2020233030303138323733' TO DFHEIV0(25:11)
 21931     CALL 'kxdfhei1' USING DFHEIV0
 21932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21933
 21934
 21935
 21936* EXEC CICS STARTBR
 21937*        DATASET   (CLMS-ID)
 21938*        RIDFLD    (ELMSTR-KEY)
 21939*        GENERIC   EQUAL
 21940*        KEYLENGTH (ELMSTR-LENGTH)
 21941*    END-EXEC.
 21942     MOVE 0
 21943       TO DFHEIV11
 21944*    MOVE '&,   KG    E          &   #00018277' TO DFHEIV0
 21945     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21946     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 403
* EL6311.cbl
 21947     MOVE X'2020233030303138323737' TO DFHEIV0(25:11)
 21948     CALL 'kxdfhei1' USING DFHEIV0,
 21949           CLMS-ID,
 21950           ELMSTR-KEY,
 21951           ELMSTR-LENGTH,
 21952           DFHEIV11,
 21953           DFHEIV99
 21954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21955
 21956
 21957     display 'browse started'
 21958     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21959
 21960 6400-NEXT-CLAIM.
 21961
 21962
 21963* EXEC CICS READNEXT
 21964*        DATASET   (CLMS-ID)
 21965*        RIDFLD    (ELMSTR-KEY)
 21966*        SET       (ADDRESS OF CLAIM-MASTER)
 21967*    END-EXEC.
 21968     MOVE 0
 21969       TO DFHEIV11
 21970*    MOVE '&.S                   )   #00018289' TO DFHEIV0
 21971     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21972     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21973     MOVE X'2020233030303138323839' TO DFHEIV0(25:11)
 21974     CALL 'kxdfhei1' USING DFHEIV0,
 21975           CLMS-ID,
 21976           DFHEIV20,
 21977           DFHEIV99,
 21978           ELMSTR-KEY,
 21979           DFHEIV99,
 21980           DFHEIV11,
 21981           DFHEIV99,
 21982           DFHEIV99
 21983     SET ADDRESS OF CLAIM-MASTER TO
 21984         DFHEIV20
 21985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21986
 21987
 21988     display 'read claim for ' mstr-cert-no
 21989     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21990        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21991         GO TO 6400-CONTINUE
 21992     END-IF.
 21993
 21994     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21995        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21996        PI-STATE       NOT = CL-CERT-STATE     OR
 21997        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21998        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21999         GO TO 6400-NEXT-CLAIM
 22000     END-IF.
 22001
 22002     display 'found claim ' cl-claim-no
 22003        ' with denial type ' cl-denial-type
 22004     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 404
* EL6311.cbl
 22005         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22006         GO TO 6400-CONTINUE
 22007     END-IF.
 22008
 22009     GO TO 6400-NEXT-CLAIM.
 22010
 22011 6400-CONTINUE.
 22012
 22013     IF WS-BROWSE-STARTED-SW = 'Y'
 22014
 22015* EXEC CICS ENDBR
 22016*            DATASET   (CLMS-ID)
 22017*        END-EXEC
 22018     MOVE 0
 22019       TO DFHEIV11
 22020*    MOVE '&2                    $   #00018321' TO DFHEIV0
 22021     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22023     MOVE X'2020233030303138333231' TO DFHEIV0(25:11)
 22024     CALL 'kxdfhei1' USING DFHEIV0,
 22025           CLMS-ID,
 22026           DFHEIV11,
 22027           DFHEIV99
 22028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22029         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22030     END-IF.
 22031
 22032 6400-EXIT.
 22033     EXIT.
 22034
 22035 7000-DISPLAY-ISSUES.
 22036
 22037     IF PI-DISPLAY-ORIGINAL-BATCH
 22038        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22039        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22040     ELSE
 22041        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22042
 22043     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22044
 22045     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22046     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22047
 22048     MOVE LOW-VALUES                 TO EL631BI.
 22049     MOVE ZEROS                      TO PI-BPMTAMT
 22050                                        PI-BPMTS.
 22051     MOVE SPACE                      TO PI-BMODE
 22052                                        PI-BTYPE (1)
 22053                                        PI-BTYPE (2).
 22054     MOVE EL631B                     TO PI-MAP-NAME.
 22055     MOVE 'Y'                        TO PI-BROWSE-SW.
 22056     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22057                                        PI-HIGH-SEQ-NO.
 22058
 22059     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22060        MOVE AL-SABOF                TO BCHGTA
 22061        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22062        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 405
* EL6311.cbl
 22063     ELSE
 22064        MOVE AL-SADOF                TO BCHGTA
 22065                                        BCHGA
 22066        MOVE PB-CHG-COUNT            TO BCHGO.
 22067
 22068     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22069     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22070     MOVE WS-HR-MINS                 TO BMANTATO.
 22071
 22072     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22073        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22074        MOVE SPACE                   TO DC-OPTION-CODE
 22075        PERFORM 9700-DATE-LINK
 22076        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22077        MOVE 'INACTIVE'              TO BMOENDTO
 22078     ELSE
 22079        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22080        MOVE SPACE                   TO DC-OPTION-CODE
 22081        PERFORM 9700-DATE-LINK
 22082        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22083        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22084        MOVE SPACE                   TO DC-OPTION-CODE
 22085        PERFORM 9700-DATE-LINK
 22086        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22087
 22088*    MOVE PB-I-REFERENCE             TO BREFO.
 22089
 22090*    IF PI-COMPANY-ID EQUAL 'HER'
 22091*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22092*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22093*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22094*                MOVE WS-MEMBER-NO-1-8
 22095*                                TO  BMICRNOO.
 22096
 22097*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22098*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22099*            MOVE PB-I-MICROFILM-NO
 22100*                                TO  BMICRNOO.
 22101     IF PB-I-VIN NOT = SPACES
 22102        MOVE PB-I-VIN            TO BVINO
 22103     END-IF
 22104
 22105     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22106     MOVE PB-CERT-SFX                TO BSUFIXO.
 22107     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22108     MOVE SPACE                      TO DC-OPTION-CODE.
 22109     PERFORM 9700-DATE-LINK.
 22110     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22111
 22112     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22113     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22114     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22115     MOVE PB-I-INSURED-SEX           TO BSEXO
 22116
 22117     IF PB-I-AGE NOT = ZEROS
 22118         MOVE PB-I-AGE               TO BAGEO.
 22119
 22120     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 406
* EL6311.cbl
 22121                                 TO ELCERT-KEY
 22122     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22123     IF NOT CERT-TRL-REC-NOT-FOUND
 22124         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22125             MOVE 'AGE*'             TO BAGEDEFO
 22126         ELSE
 22127             MOVE 'AGE '             TO BAGEDEFO
 22128         END-IF
 22129     ELSE
 22130         MOVE 'AGE '             TO BAGEDEFO
 22131     END-IF
 22132
 22133     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22134         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22135         MOVE SPACE                  TO DC-OPTION-CODE
 22136         PERFORM 9700-DATE-LINK
 22137         IF NO-CONVERSION-ERROR
 22138            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22139
 22140     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22141         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22142         MOVE SPACE                  TO DC-OPTION-CODE
 22143         PERFORM 9700-DATE-LINK
 22144         IF NO-CONVERSION-ERROR
 22145            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22146
 22147     IF PB-I-EXTENTION-DAYS NUMERIC
 22148        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22149           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22150        ELSE
 22151           IF PB-I-TERM-IN-DAYS NUMERIC
 22152              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22153                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22154
 22155     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22156        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22157
 22158     MOVE PB-FORCE-CODE              TO BFORCEO.
 22159     MOVE PB-I-TERM-TYPE             TO BMODEO
 22160                                        PI-BMODE.
 22161
 22162     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22163        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22164
 22165     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22166         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22167                                        PI-BPMTS.
 22168
 22169     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22170         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22171           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22172                                        PI-BPMTAMT.
 22173
 22174     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22175     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22176     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22177     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22178     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 407
* EL6311.cbl
 22179     MOVE PB-I-SIG-SW                TO BSIGO.
 22180     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22181     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22182     MOVE PB-RECORD-BILL             TO BBILCDO.
 22183     MOVE PB-FORCE-CODE              TO BFORCEO.
 22184
 22185     IF (PB-I-LIVES NUMERIC)
 22186        AND (PB-I-LIVES > ZEROS)
 22187        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22188        IF (RESP-NORMAL)
 22189           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22190           CONTINUE
 22191        ELSE
 22192           MOVE PB-I-LIVES       TO BLIVESO
 22193        END-IF
 22194     END-IF
 22195
 22196     IF PB-I-NUM-BILLED NUMERIC AND
 22197        PB-I-NUM-BILLED GREATER THAN ZEROS
 22198        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22199*    ELSE
 22200*       MOVE ZEROS                   TO BBILLEDO.
 22201
 22202     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22203
 22204     IF PB-I-LOAN-APR NOT = +99.9999
 22205        MOVE PB-I-LOAN-APR           TO BAPRO.
 22206
 22207     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22208        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22209
 22210     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22211        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22212           MOVE AL-SANOF                TO BORIGHDA
 22213           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22214           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22215
 22216     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22217
 22218     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22219        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22220
 22221     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22222        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22223                                        PI-BTYPE (1).
 22224
 22225     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22226        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22227
 22228     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22229        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22230
 22231     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22232        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22233
 22234     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22235        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22236
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 408
* EL6311.cbl
 22237     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22238        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22239
 22240     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22241         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22242         MOVE SPACE                  TO DC-OPTION-CODE
 22243         PERFORM 9700-DATE-LINK
 22244         IF NO-CONVERSION-ERROR
 22245            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22246
 22247     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22248        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22249        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22250        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22251        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22252                 GIVING BDIFFO (1)
 22253     ELSE
 22254        MOVE SPACES                  TO BBEN-CD     (1)
 22255                                        BBEN-ABBR   (1).
 22256
 22257     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22258        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22259        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22260                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22261
 22262     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22263       IF PB-RECORD-ON-HOLD
 22264          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22265
 22266     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22267       IF PB-RECORD-RETURNED
 22268          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22269
 22270     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22271        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22272             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22273
 22274     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22275
 22276     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22277        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22278
 22279     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22280        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22281                                        PI-BTYPE (2).
 22282
 22283     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22284        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22285
 22286     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22287        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22288
 22289     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22290        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22291
 22292     IF PB-I-TOT-FEES NOT NUMERIC
 22293        MOVE ZEROS               TO PB-I-TOT-FEES
 22294     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 409
* EL6311.cbl
 22295     IF PB-I-TOT-FEES > ZEROS
 22296        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22297
 22298     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22299         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22300         MOVE SPACE                  TO DC-OPTION-CODE
 22301         PERFORM 9700-DATE-LINK
 22302         IF NO-CONVERSION-ERROR
 22303            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22304
 22305     IF PB-I-TOT-FEES > ZEROS
 22306        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22307        SUBTRACT PB-I-TOT-FEES FROM
 22308                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22309
 22310     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22311        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22312        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22313        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22314        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22315                 GIVING BDIFFO (2)
 22316     ELSE
 22317        MOVE SPACES                  TO BBEN-CD     (2)
 22318                                        BBEN-ABBR   (2).
 22319
 22320     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22321       IF PB-RECORD-ON-HOLD
 22322          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22323
 22324     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22325       IF PB-RECORD-RETURNED
 22326          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22327
 22328     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22329        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22330             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22331
 22332     MOVE PB-CSR-ID                  TO BCSRO.
 22333
 22334     IF PI-COMPANY-ID  =  'DMD'
 22335        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22336            NEXT SENTENCE
 22337        ELSE
 22338            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22339               MOVE 'NEW CERT'       TO BNCERTLI
 22340               MOVE EC-NEW-CERT      TO BNCERTO.
 22341
 22342     IF PI-COMPANY-ID  =  'DMD'
 22343        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22344            NEXT SENTENCE
 22345        ELSE
 22346           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22347               MOVE 'NEW STATE'      TO BNSTATLI
 22348               MOVE EC-NEW-STATE     TO BNSTATO.
 22349
 22350 7000-CONTINUE.
 22351     MOVE 'C'                        TO BMAINTI.
 22352     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 410
* EL6311.cbl
 22353
 22354     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22355        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22356
 22357     IF PI-6315-FINALIZED = 'Y'   AND
 22358        PB-UNFORCED-ERRORS
 22359          MOVE -1                TO BFORCEL
 22360          MOVE  1                TO SET-CURSOR-SW
 22361     END-IF
 22362
 22363     IF NO-CURSOR-SET
 22364        MOVE -1                      TO BMAINTL.
 22365
 22366     GO TO 8100-SEND-INITIAL-MAP.
 22367
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 411
* EL6311.cbl
 22369
 22370******************************************************************
 22371*                                                                *
 22372*             D I S P L A Y   C A N C E L S                      *
 22373*                                                                *
 22374******************************************************************
 22375
 22376 7100-DISPLAY-CANCELS.
 22377     IF PI-DISPLAY-ORIGINAL-BATCH
 22378        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22379        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22380     ELSE
 22381        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22382
 22383     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22384
 22385     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22386     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22387
 22388     MOVE LOW-VALUES                 TO EL631CI.
 22389     MOVE EL631C                     TO PI-MAP-NAME.
 22390     MOVE 'Y'                        TO PI-BROWSE-SW.
 22391     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22392                                        PI-HIGH-SEQ-NO.
 22393
 22394     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22395        MOVE AL-SABOF                TO CCHGTA
 22396        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22397        MOVE AL-SANON                TO CCHGA
 22398      ELSE
 22399        MOVE AL-SADOF                TO CCHGTA
 22400                                        CCHGA
 22401        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22402
 22403*    MOVE PB-C-REFERENCE             TO CREFO.
 22404
 22405*    IF PB-C-MICROFILM-NO IS NUMERIC
 22406*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22407*          MOVE PB-C-MICROFILM-NO
 22408*                                TO CMICRNOO
 22409*          MOVE AL-UNNON         TO CMICRNOA
 22410*       END-IF
 22411*    END-IF
 22412     IF PB-C-NH-INT-ON-REFS NUMERIC
 22413        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22414           MOVE PB-C-NH-INT-ON-REFS
 22415                                 TO CNHINTO
 22416           MOVE AL-SANOF         TO CNHINTA
 22417        END-IF
 22418     END-IF
 22419     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22420     MOVE PB-CERT-SFX                TO CSUFIXO.
 22421     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22422     MOVE SPACE                      TO DC-OPTION-CODE.
 22423     PERFORM 9700-DATE-LINK.
 22424     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22425
 22426     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 412
* EL6311.cbl
 22427        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22428        MOVE SPACE                   TO DC-OPTION-CODE
 22429        PERFORM 9700-DATE-LINK
 22430        IF NO-CONVERSION-ERROR
 22431           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22432
 22433     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22434        NEXT SENTENCE
 22435     ELSE
 22436        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22437
 22438     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22439        NEXT SENTENCE
 22440     ELSE
 22441        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22442
 22443     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22444        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22445        MOVE SPACE                   TO DC-OPTION-CODE
 22446        PERFORM 9700-DATE-LINK
 22447        IF NO-CONVERSION-ERROR
 22448           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22449
 22450     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22451         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22452
 22453     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22454         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22455
 22456     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22457        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22458        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22459                 GIVING CDRFND1O.
 22460
 22461     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22462        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22463        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22464                 GIVING CDRFND2O.
 22465
 22466     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22467       IF PB-RECORD-ON-HOLD
 22468          MOVE 'ON HOLD'             TO CBILIT1O.
 22469
 22470     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22471       IF PB-RECORD-RETURNED
 22472          MOVE 'RETURNED'            TO CBILIT1O.
 22473
 22474     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22475        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22476             MOVE 'OVERRIDE'         TO CBILIT1O.
 22477
 22478     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22479       IF PB-RECORD-ON-HOLD
 22480          MOVE 'ON HOLD'             TO CBILIT2O.
 22481
 22482     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22483       IF PB-RECORD-RETURNED
 22484          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 413
* EL6311.cbl
 22485
 22486     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22487        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22488             MOVE 'OVERRIDE'         TO CBILIT2O.
 22489
 22490     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22491     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22492     IF PB-C-POST-CARD-IND = 'Y'
 22493        MOVE 'Y'                     TO CPCYNO
 22494     ELSE
 22495        MOVE 'N'                     TO CPCYNO
 22496     END-IF
 22497     MOVE PB-FORCE-CODE              TO CFORCEO.
 22498     MOVE PB-RECORD-BILL             TO CBILCDO.
 22499     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22500     MOVE SPACES                     TO CINITSO.
 22501     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22502         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22503     ELSE
 22504         MOVE PB-CI-INITIALS         TO CINITSO
 22505     END-IF.
 22506
 22507     IF PB-CI-CANCEL-FEE NUMERIC
 22508        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22509        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22510     ELSE
 22511        MOVE ZEROES                  TO W-CANCEL-FEE.
 22512
 22513     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22514
 22515     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22516        ADD PB-CI-LF-PREMIUM-AMT
 22517             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22518
 22519     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22520        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22521
 22522     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22523     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22524     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22525     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22526
 22527     IF PB-C-LIVES NUMERIC
 22528        MOVE PB-C-LIVES              TO CLIVESO.
 22529
 22530     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22531        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22532
 22533     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22534        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22535        MOVE SPACE                   TO DC-OPTION-CODE
 22536        PERFORM 9700-DATE-LINK
 22537        IF NO-CONVERSION-ERROR
 22538           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22539
 22540     IF  PB-C-REFUND-CREATED
 22541         MOVE 'YES'                  TO CRFNDSWO
 22542     ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 414
* EL6311.cbl
 22543         IF PB-C-REFUND-REQUESTED
 22544            MOVE 'REQ'               TO CRFNDSWO
 22545         ELSE
 22546            MOVE 'NO'                TO CRFNDSWO.
 22547
 22548     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22549     MOVE SPACE                      TO DC-OPTION-CODE.
 22550     PERFORM 9700-DATE-LINK.
 22551     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22552     MOVE PB-INPUT-BY                TO CENTBYO.
 22553
 22554     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22555        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22556        MOVE SPACE                   TO DC-OPTION-CODE
 22557        PERFORM 9700-DATE-LINK
 22558        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22559        MOVE 'INACTIVE'              TO CMOENDTO
 22560     ELSE
 22561        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22562        MOVE SPACE                   TO DC-OPTION-CODE
 22563        PERFORM 9700-DATE-LINK
 22564        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22565        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22566        MOVE SPACE                   TO DC-OPTION-CODE
 22567        PERFORM 9700-DATE-LINK
 22568        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22569
 22570     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22571
 22572     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22573     MOVE WS-HR-MINS                 TO CMANTATO.
 22574
 22575     EVALUATE PB-LF-REFUND-TYPE
 22576        WHEN '1'
 22577           MOVE 'RULE78'            TO CLFREFNO
 22578        WHEN '2'
 22579           MOVE 'PRORAT'            TO CLFREFNO
 22580        WHEN '3'
 22581           MOVE 'CALIF'             TO CLFREFNO
 22582        WHEN '4'
 22583           MOVE 'IRREG'             TO CLFREFNO
 22584        WHEN '5'
 22585           MOVE 'NETPAY'            TO CLFREFNO
 22586        WHEN '6'
 22587           MOVE 'ATCP'              TO CLFREFNO
 22588        WHEN '7'
 22589           MOVE 'UTAH'              TO CLFREFNO
 22590        WHEN '8'
 22591           MOVE 'MEAN'              TO CLFREFNO
 22592        WHEN '9'
 22593           MOVE 'SUM '              TO CLFREFNO
 22594        WHEN 'B'
 22595           MOVE 'BALN'              TO CLFREFNO
 22596     END-EVALUATE.
 22597
 22598     EVALUATE TRUE
 22599        WHEN PB-AH-REFUND-TYPE =  '1'
 22600           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 415
* EL6311.cbl
 22601        WHEN PB-AH-REFUND-TYPE =  '2'
 22602           MOVE 'PRORAT'            TO CAHREFNO
 22603        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22604           MOVE 'CALIF'             TO CAHREFNO
 22605        WHEN PB-AH-REFUND-TYPE =  '4'
 22606           MOVE 'IRREG'             TO CAHREFNO
 22607        WHEN PB-AH-REFUND-TYPE =  '5'
 22608           MOVE 'NETPAY'            TO CAHREFNO
 22609        WHEN PB-AH-REFUND-TYPE =  '6'
 22610           MOVE 'ATCP'              TO CAHREFNO
 22611        WHEN PB-AH-REFUND-TYPE =  '7'
 22612           MOVE 'UTAH'              TO CAHREFNO
 22613        WHEN PB-AH-REFUND-TYPE =  '8'
 22614           MOVE 'MEAN'              TO CAHREFNO
 22615        WHEN PB-AH-REFUND-TYPE =  '9'
 22616           MOVE 'SUM '              TO CAHREFNO
 22617        WHEN PB-AH-REFUND-TYPE =  'B'
 22618           MOVE 'BALN'              TO CAHREFNO
 22619     END-EVALUATE.
 22620
 22621     MOVE PB-REIN-CD                 TO CREINCDO.
 22622
 22623     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22624        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22625        MOVE SPACE                   TO DC-OPTION-CODE
 22626        PERFORM 9700-DATE-LINK
 22627        IF NO-CONVERSION-ERROR
 22628           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22629
 22630     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22631        MOVE 999999                  TO WS-EXP-DT-EDIT
 22632        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22633        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22634     ELSE
 22635        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22636           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22637           MOVE SPACE                   TO DC-OPTION-CODE
 22638           PERFORM 9700-DATE-LINK
 22639           IF NO-CONVERSION-ERROR
 22640              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22641
 22642     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22643        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22644           MOVE AL-SANOF                TO CORIGHDA
 22645           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22646           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22647
 22648     MOVE PB-CSR-ID              TO CCSRO.
 22649
 22650     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22651     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22652
 22653     MOVE 'C'                    TO CMAINTI.
 22654     MOVE AL-UANON               TO CMAINTA.
 22655
 22656     IF PI-6316-FINALIZED = 'Y'  AND
 22657        PB-UNFORCED-ERRORS
 22658          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 416
* EL6311.cbl
 22659          MOVE  1                TO SET-CURSOR-SW
 22660     END-IF
 22661
 22662     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22663        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22664
 22665     IF NO-CURSOR-SET
 22666        MOVE -1                  TO CMAINTL.
 22667
 22668     GO TO 8100-SEND-INITIAL-MAP.
 22669
 22670
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 417
* EL6311.cbl
 22672***************************************************************
 22673*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22674*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22675***************************************************************
 22676
 22677 7200-DISPLAY-BATCHES.
 22678     MOVE EL631D                 TO PI-MAP-NAME.
 22679     MOVE LOW-VALUES             TO EL631DI.
 22680
 22681     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22682
 22683
 22684* EXEC CICS HANDLE CONDITION
 22685*         NOTFND   (3690-NOT-FOUND)
 22686*    END-EXEC.
 22687*    MOVE '"$I                   ! Y #00018978' TO DFHEIV0
 22688     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22690     MOVE X'5920233030303138393738' TO DFHEIV0(25:11)
 22691     CALL 'kxdfhei1' USING DFHEIV0
 22692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22693
 22694
 22695     IF PI-DISPLAY-SCREEN
 22696        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22697     ELSE
 22698        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22699
 22700     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22701     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22702
 22703
 22704* EXEC CICS READ
 22705*         DATASET   (FILE-ID-ERPNDB)
 22706*         RIDFLD    (ERPNDB-KEY)
 22707*         SET       (ADDRESS OF PENDING-BUSINESS)
 22708*    END-EXEC.
 22709*    MOVE '&"S        E          (   #00018990' TO DFHEIV0
 22710     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22712     MOVE X'2020233030303138393930' TO DFHEIV0(25:11)
 22713     CALL 'kxdfhei1' USING DFHEIV0,
 22714           FILE-ID-ERPNDB,
 22715           DFHEIV20,
 22716           DFHEIV99,
 22717           ERPNDB-KEY,
 22718           DFHEIV99,
 22719           DFHEIV99,
 22720           DFHEIV99
 22721     SET ADDRESS OF PENDING-BUSINESS TO
 22722         DFHEIV20
 22723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22724
 22725
 22726     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22727     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22728     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22729     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 418
* EL6311.cbl
 22730     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22731
 22732     MOVE EL631D                 TO PI-MAP-NAME.
 22733     MOVE LOW-VALUES             TO EL631DI.
 22734     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22735
 22736*    IF PI-AR-PROCESSING
 22737*       MOVE PB-REFERENCE        TO DREFO.
 22738
 22739     MOVE PB-CSR-ID              TO DCSRO.
 22740
 22741     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22742        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22743        MOVE SPACE               TO DC-OPTION-CODE
 22744        PERFORM 9700-DATE-LINK
 22745        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22746        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22747        MOVE 'INACTIVE'          TO DLDATEO
 22748     ELSE
 22749        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22750        MOVE SPACE               TO DC-OPTION-CODE
 22751        PERFORM 9700-DATE-LINK
 22752        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22753
 22754     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22755     MOVE SPACE                  TO DC-OPTION-CODE.
 22756     PERFORM 9700-DATE-LINK.
 22757     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22758
 22759     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22760        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22761     ELSE
 22762        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22763        MOVE SPACE               TO DC-OPTION-CODE
 22764        PERFORM 9700-DATE-LINK
 22765        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22766
 22767     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22768     MOVE SPACE                  TO DC-OPTION-CODE.
 22769     PERFORM 9700-DATE-LINK.
 22770     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22771
 22772     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22773     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22774
 22775     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22776        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22777                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22778
 22779     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22780     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22781     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22782
 22783     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22784        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22785                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22786
 22787     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 419
* EL6311.cbl
 22788     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22789     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22790
 22791     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22792        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22793                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22794
 22795     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22796     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22797
 22798     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22799        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22800                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22801
 22802     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22803     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22804     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22805
 22806     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22807        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22808                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22809
 22810     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22811     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22812     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22813
 22814     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22815        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22816                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22817
 22818     MOVE -1                     TO DPFENTRL.
 22819     GO TO 8100-SEND-INITIAL-MAP.
 22820
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 420
* EL6311.cbl
 22822
 22823***************************************************************
 22824*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22825*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22826*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22827*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22828*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22829*     ARE THEN SET ACCORDINGLY.                               *
 22830*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22831*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22832*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22833***************************************************************
 22834
 22835******************************************************************
 22836*                                                                *
 22837*            E R R O R   A N A L Y S I S                         *
 22838*                                                                *
 22839******************************************************************
 22840
 22841******************************************************************
 22842*                                                                *
 22843*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22844*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22845*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22846*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22847*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22848*                                                                *
 22849*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22850*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22851*                                                                *
 22852******************************************************************
 22853
 22854 7300-FORMAT-ERRORS.
 22855     MOVE ' '                    TO PI-ERRORS-SW
 22856     IF PB-COMMON-ERRORS = LOW-VALUES
 22857        IF PB-FATAL-ERRORS
 22858           MOVE ER-2695          TO EMI-ERROR
 22859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22860           GO TO 7399-EXIT.
 22861
 22862     MOVE +0                     TO WS-SUB4.
 22863
 22864 7310-ERROR-LOOP.
 22865
 22866     ADD +1                      TO WS-SUB4.
 22867
 22868     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22869        GO TO 7350-SET-ERROR-FLAGS.
 22870
 22871     IF PI-COMPANY-ID = 'UCL'
 22872         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22873             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22874             MOVE ' '                   TO DC-OPTION-CODE
 22875             PERFORM 9700-DATE-LINK
 22876             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22877
 22878     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22879     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 421
* EL6311.cbl
 22880     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22881
 22882     GO TO 7310-ERROR-LOOP.
 22883
 22884
 22885 7350-SET-ERROR-FLAGS.
 22886
 22887     IF EMI-FATAL-CTR NOT = ZEROS
 22888        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22889        MOVE 'X'                 TO PB-FATAL-FLAG
 22890                                    PI-ERRORS-SW
 22891        GO TO 7355-SET-ERROR-FLAGS.
 22892
 22893     move ' ' to pi-unforced-sw
 22894     IF EMI-FORCABLE-CTR NOT = ZEROS
 22895        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22896        IF PB-ISSUE
 22897           IF PB-ISSUE-FORCE
 22898              MOVE 'F'           TO PB-FORCE-ER-CD
 22899              MOVE ER-2600       TO EMI-ERROR
 22900              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22901             ELSE
 22902              MOVE 'X'           TO PB-FORCE-ER-CD
 22903*                                   PI-ERRORS-SW
 22904          ELSE
 22905           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22906              MOVE 'F'           TO PB-FORCE-ER-CD
 22907                                    pi-unforced-sw
 22908              MOVE ER-2600       TO EMI-ERROR
 22909              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22910             ELSE
 22911              MOVE 'X'           TO PB-FORCE-ER-CD
 22912                                    pi-unforced-sw.
 22913*                                   PI-ERRORS-SW.
 22914
 22915     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22916     IF PB-ISSUE
 22917         MOVE 'I'                TO ENDT-RECORD-TYPE
 22918     ELSE
 22919         MOVE 'C'                TO ENDT-RECORD-TYPE
 22920     END-IF
 22921     MOVE +0                     TO ENDT-SEQ-NO
 22922
 22923
 22924* EXEC CICS READ
 22925*        DATASET   (FILE-ID-ERENDT)
 22926*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22927*        RIDFLD    (ERENDT-KEY)
 22928*        RESP      (WS-RESPONSE)
 22929*        GTEQ
 22930*    END-EXEC
 22931*    MOVE '&"S        G          (  N#00019193' TO DFHEIV0
 22932     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22934     MOVE X'204E233030303139313933' TO DFHEIV0(25:11)
 22935     CALL 'kxdfhei1' USING DFHEIV0,
 22936           FILE-ID-ERENDT,
 22937           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 422
* EL6311.cbl
 22938           DFHEIV99,
 22939           ERENDT-KEY,
 22940           DFHEIV99,
 22941           DFHEIV99,
 22942           DFHEIV99
 22943     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22944         DFHEIV20
 22945     MOVE EIBRESP  TO WS-RESPONSE
 22946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22947
 22948     IF RESP-NORMAL
 22949        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22950        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22951            MOVE ER-0280          TO EMI-ERROR
 22952            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22953            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22954            EVALUATE TRUE
 22955              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22956                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22957              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22958                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22959              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22960                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22961            END-EVALUATE
 22962        END-IF
 22963     END-IF
 22964
 22965
 22966
 22967     IF FIRST-ENTRY OR
 22968        EIBAID = DFHPF1 OR DFHPF2
 22969        MOVE '0'                TO PI-EDIT-SW
 22970        GO TO 7399-EXIT.
 22971
 22972 7355-SET-ERROR-FLAGS.
 22973
 22974     IF EMI-WARNING-CTR NOT = ZEROS
 22975        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22976        MOVE 'W'                 TO PB-WARN-ER-CD.
 22977
 22978     IF PB-UNFORCED-ERRORS OR
 22979        PB-FATAL-ERRORS    OR
 22980        PB-RECORD-ON-HOLD  OR
 22981        PB-RECORD-RETURNED OR
 22982        PB-CANCELLATION
 22983          NEXT SENTENCE
 22984        ELSE
 22985          GO TO 7399-EXIT.
 22986
 22987
 22988* EXEC CICS  HANDLE CONDITION
 22989*           NOTFND   (7399-EXIT)
 22990*    END-EXEC.
 22991*    MOVE '"$I                   ! Z #00019240' TO DFHEIV0
 22992     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22994     MOVE X'5A20233030303139323430' TO DFHEIV0(25:11)
 22995     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 423
* EL6311.cbl
 22996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22997
 22998
 22999     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23000     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23001     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23002     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23003
 23004
 23005* EXEC CICS READ
 23006*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23007*        DATASET (FILE-ID-ELCERT)
 23008*        RIDFLD  (ELCERT-KEY)
 23009*        UPDATE
 23010*    END-EXEC.
 23011*    MOVE '&"S        EU         (   #00019249' TO DFHEIV0
 23012     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23013     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23014     MOVE X'2020233030303139323439' TO DFHEIV0(25:11)
 23015     CALL 'kxdfhei1' USING DFHEIV0,
 23016           FILE-ID-ELCERT,
 23017           DFHEIV20,
 23018           DFHEIV99,
 23019           ELCERT-KEY,
 23020           DFHEIV99,
 23021           DFHEIV99,
 23022           DFHEIV99
 23023     SET ADDRESS OF CERTIFICATE-MASTER TO
 23024         DFHEIV20
 23025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23026
 23027
 23028
 23029     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23030     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23031
 23032     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23033        GO TO 7360-REWRITE-CERT-MASTER.
 23034
 23035     IF PB-ISSUE
 23036        IF PB-RECORD-RETURNED
 23037            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23038            GO TO 7360-REWRITE-CERT-MASTER
 23039        ELSE
 23040            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23041            GO TO 7360-REWRITE-CERT-MASTER.
 23042
 23043     IF PB-RECORD-RETURNED
 23044         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23045         GO TO 7360-REWRITE-CERT-MASTER.
 23046
 23047     IF (PB-C-LF-CANCEL-VOIDED)
 23048        or (pb-c-ah-cancel-voided)
 23049        IF (PB-UNFORCED-ERRORS OR
 23050            PB-FATAL-ERRORS    OR
 23051            PB-RECORD-ON-HOLD)
 23052            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23053            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 424
* EL6311.cbl
 23054        ELSE
 23055            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23056            GO TO 7360-REWRITE-CERT-MASTER.
 23057
 23058     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23059                            OR PB-RECORD-ON-HOLD)
 23060        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23061     ELSE
 23062        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23063
 23064 7360-REWRITE-CERT-MASTER.
 23065
 23066     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23067        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23068
 23069* EXEC CICS UNLOCK
 23070*            DATASET    (FILE-ID-ELCERT)
 23071*       END-EXEC
 23072*    MOVE '&*                    #   #00019296' TO DFHEIV0
 23073     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23074     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23075     MOVE X'2020233030303139323936' TO DFHEIV0(25:11)
 23076     CALL 'kxdfhei1' USING DFHEIV0,
 23077           FILE-ID-ELCERT,
 23078           DFHEIV99
 23079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23080        GO TO 7399-EXIT.
 23081
 23082
 23083* EXEC CICS REWRITE
 23084*         DATASET    (FILE-ID-ELCERT)
 23085*         FROM       (CERTIFICATE-MASTER)
 23086*    END-EXEC.
 23087     MOVE LENGTH OF
 23088      CERTIFICATE-MASTER
 23089       TO DFHEIV11
 23090*    MOVE '&& L                  %   #00019301' TO DFHEIV0
 23091     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23092     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23093     MOVE X'2020233030303139333031' TO DFHEIV0(25:11)
 23094     CALL 'kxdfhei1' USING DFHEIV0,
 23095           FILE-ID-ELCERT,
 23096           CERTIFICATE-MASTER,
 23097           DFHEIV11,
 23098           DFHEIV99
 23099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23100
 23101
 23102 7399-EXIT.
 23103      EXIT.
 23104
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 425
* EL6311.cbl
 23106
 23107*************************************************************
 23108*                                                           *
 23109*              S E T   A T T R I B U T E S                  *
 23110*                                                           *
 23111*************************************************************
 23112
 23113 7400-SET-ATTRIBUTES.
 23114
 23115     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23116        GO TO 7499-EXIT.
 23117
 23118**2601**
 23119
 23120     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23121        IF PB-ISSUE
 23122           MOVE AL-UABON         TO BEFFDTA
 23123           GO TO 7499-EXIT
 23124         ELSE
 23125           MOVE AL-UABON         TO CEFFDTA
 23126           GO TO 7499-EXIT.
 23127
 23128**2604**
 23129
 23130     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23131        IF PB-ISSUE
 23132           MOVE AL-UABON         TO BTYPE1A
 23133           MOVE -1               TO BTYPE1L
 23134           MOVE  1               TO SET-CURSOR-SW
 23135           GO TO 7499-EXIT.
 23136
 23137**2605**
 23138
 23139     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23140        IF PB-ISSUE
 23141           MOVE AL-UABON         TO BTYPE2A
 23142           MOVE -1               TO BTYPE2L
 23143           MOVE  1               TO SET-CURSOR-SW
 23144           GO TO 7499-EXIT.
 23145
 23146**2606**
 23147
 23148     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23149        IF PB-ISSUE
 23150           MOVE AL-UABON         TO BSIGA
 23151           MOVE -1               TO BSIGL
 23152           MOVE  1               TO SET-CURSOR-SW
 23153           GO TO 7499-EXIT.
 23154
 23155**2607**
 23156
 23157     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23158        IF PB-ISSUE
 23159           MOVE AL-UABON         TO BSIGA
 23160           MOVE -1               TO BSIGL
 23161           MOVE  1               TO SET-CURSOR-SW
 23162           GO TO 7499-EXIT.
 23163
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 426
* EL6311.cbl
 23164**2615**
 23165
 23166     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23167        IF PB-ISSUE
 23168           MOVE AL-UABOF         TO BREINA
 23169           MOVE -1               TO BREINL
 23170           GO TO 7499-EXIT.
 23171
 23172**2622**
 23173
 23174     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23175        IF PB-ISSUE
 23176           MOVE AL-UABON         TO BEFFDTA
 23177           GO TO 7499-EXIT
 23178        ELSE
 23179           MOVE AL-UABON         TO CEFFDTA
 23180           GO TO 7499-EXIT.
 23181
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 427
* EL6311.cbl
 23183
 23184*************************************************************
 23185*                                                           *
 23186*              I S S U E   E R R O R S                      *
 23187*                                                           *
 23188*************************************************************
 23189
 23190 7420-ISSUE-ERRORS.
 23191
 23192**2626**
 23193
 23194     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23195        MOVE AL-UABON            TO BCERTNOA
 23196        GO TO 7499-EXIT.
 23197
 23198**2627**
 23199
 23200     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23201        MOVE AL-UNBON            TO BAGEA
 23202        MOVE -1                  TO BAGEL
 23203        MOVE  1                  TO SET-CURSOR-SW
 23204        GO TO 7499-EXIT.
 23205
 23206**2628**
 23207
 23208     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23209        MOVE AL-UNBON            TO BAGEA
 23210        MOVE -1                  TO BAGEL
 23211        MOVE  1                  TO SET-CURSOR-SW
 23212        GO TO 7499-EXIT.
 23213
 23214**2629**
 23215
 23216     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23217        MOVE AL-UABON            TO BSEXA
 23218        MOVE -1                  TO BSEXL
 23219        MOVE  1                  TO SET-CURSOR-SW
 23220        GO TO 7499-EXIT.
 23221
 23222**2630**
 23223
 23224     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23225        MOVE -1                  TO BTYPE1L
 23226        MOVE  1                  TO SET-CURSOR-SW
 23227        GO TO 7499-EXIT.
 23228
 23229**2631**
 23230
 23231     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23232        MOVE -1                  TO BTYPE1L
 23233        MOVE  1                  TO SET-CURSOR-SW
 23234        GO TO 7499-EXIT.
 23235
 23236**2632**
 23237
 23238     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23239        MOVE AL-UNBON            TO BBEN1A
 23240        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 428
* EL6311.cbl
 23241        MOVE  1                  TO SET-CURSOR-SW
 23242        GO TO 7499-EXIT.
 23243
 23244**2633**
 23245
 23246     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23247        MOVE AL-UNBON            TO BPREM1A
 23248        MOVE -1                  TO BPREM1L
 23249        MOVE  1                  TO SET-CURSOR-SW
 23250        GO TO 7499-EXIT.
 23251
 23252**2634**
 23253
 23254     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23255        MOVE -1                  TO BTYPE2L
 23256        MOVE  1                  TO SET-CURSOR-SW
 23257        GO TO 7499-EXIT.
 23258
 23259**2635**
 23260
 23261     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23262        MOVE AL-UNBON            TO BBEN2A
 23263        MOVE -1                  TO BBEN2L
 23264        MOVE  1                  TO SET-CURSOR-SW
 23265        GO TO 7499-EXIT.
 23266
 23267**2636**
 23268
 23269     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23270        MOVE AL-UNBON            TO BPREM2A
 23271        MOVE -1                  TO BPREM2L
 23272        MOVE  1                  TO SET-CURSOR-SW
 23273        GO TO 7499-EXIT.
 23274
 23275**2639**
 23276
 23277     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23278        MOVE AL-UNBON            TO BBEN1A
 23279        MOVE -1                  TO BBEN1L
 23280        MOVE  1                  TO SET-CURSOR-SW
 23281        GO TO 7499-EXIT.
 23282
 23283**2640**
 23284
 23285     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23286        MOVE AL-UNBON            TO BBEN2A
 23287        MOVE -1                  TO BBEN2L
 23288        MOVE  1                  TO SET-CURSOR-SW
 23289        GO TO 7499-EXIT.
 23290
 23291**2647**
 23292
 23293     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23294        MOVE AL-UNBON            TO BTERM1A
 23295        MOVE -1                  TO BTERM1L
 23296        MOVE  1                  TO SET-CURSOR-SW
 23297        GO TO 7499-EXIT.
 23298
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 429
* EL6311.cbl
 23299**2648**
 23300
 23301     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23302        MOVE AL-UNBON            TO BLNTRMA
 23303        MOVE -1                  TO BLNTRML
 23304        MOVE  1                  TO SET-CURSOR-SW
 23305        GO TO 7499-EXIT.
 23306
 23307**2649**
 23308
 23309     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23310        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23311            MOVE AL-UNBON            TO BPREM1A
 23312            MOVE -1                  TO BPREM1L
 23313            MOVE  1                  TO SET-CURSOR-SW
 23314            GO TO 7499-EXIT
 23315     ELSE
 23316        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23317           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23318            MOVE AL-UNBON            TO BPREM2A
 23319            MOVE -1                  TO BPREM2L
 23320            MOVE  1                  TO SET-CURSOR-SW
 23321            GO TO 7499-EXIT.
 23322
 23323**2650**
 23324
 23325     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23326        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23327            MOVE AL-UNBON        TO BPREM1A
 23328            MOVE -1              TO BPREM1L
 23329            MOVE  1              TO SET-CURSOR-SW
 23330            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23331                MOVE AL-UNBON        TO BPREM2A
 23332                MOVE -1              TO BPREM2L
 23333                MOVE  1              TO SET-CURSOR-SW
 23334                GO TO 7499-EXIT
 23335            ELSE
 23336                GO TO 7499-EXIT
 23337        ELSE
 23338            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23339                MOVE AL-UNBON        TO BPREM2A
 23340                MOVE -1              TO BPREM2L
 23341                MOVE  1              TO SET-CURSOR-SW
 23342                GO TO 7499-EXIT
 23343            ELSE
 23344                GO TO 7499-EXIT.
 23345
 23346**2651**
 23347
 23348     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23349        MOVE AL-UABON            TO BSIGA
 23350        MOVE -1                  TO BSIGL
 23351        MOVE  1                  TO SET-CURSOR-SW
 23352        GO TO 7499-EXIT.
 23353
 23354**2653**
 23355
 23356     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 430
* EL6311.cbl
 23357        MOVE AL-UABON            TO BFREQA
 23358        MOVE -1                  TO BFREQL
 23359        MOVE  1                  TO SET-CURSOR-SW
 23360        GO TO 7499-EXIT.
 23361
 23362**2654**
 23363
 23364     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23365        MOVE AL-UABON            TO BFREQA
 23366        MOVE -1                  TO BFREQL
 23367        MOVE  1                  TO SET-CURSOR-SW
 23368        GO TO 7499-EXIT.
 23369
 23370**2655**
 23371
 23372     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23373        MOVE AL-UABON            TO BFREQA
 23374        MOVE -1                  TO BFREQL
 23375        MOVE  1                  TO SET-CURSOR-SW
 23376        GO TO 7499-EXIT.
 23377
 23378**2656**
 23379
 23380     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23381        MOVE AL-UNBON            TO BAPRA
 23382        MOVE -1                  TO BAPRL
 23383        MOVE  1                  TO SET-CURSOR-SW
 23384        GO TO 7499-EXIT.
 23385
 23386**2657**
 23387
 23388     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23389        MOVE AL-UNBON            TO BAPRA
 23390        MOVE -1                  TO BAPRL
 23391        MOVE  1                  TO SET-CURSOR-SW
 23392        GO TO 7499-EXIT.
 23393
 23394**2658**
 23395
 23396     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23397        MOVE AL-UNBON            TO BTERM2A
 23398        MOVE -1                  TO BTERM2L
 23399        MOVE  1                  TO SET-CURSOR-SW
 23400        GO TO 7499-EXIT.
 23401
 23402**2660**
 23403
 23404     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23405        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23406        MOVE -1                  TO BLSTNML
 23407        MOVE  1                  TO SET-CURSOR-SW
 23408        GO TO 7499-EXIT.
 23409
 23410
 23411**2662**
 23412
 23413     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23414        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 431
* EL6311.cbl
 23415        MOVE -1                  TO BAGEL
 23416        MOVE  1                  TO SET-CURSOR-SW
 23417        GO TO 7499-EXIT.
 23418
 23419**2663**
 23420
 23421     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23422        MOVE AL-UNBON            TO BAGEA
 23423        MOVE -1                  TO BAGEL
 23424        MOVE  1                  TO SET-CURSOR-SW
 23425        GO TO 7499-EXIT.
 23426
 23427**2664**
 23428
 23429     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23430        MOVE AL-UABON            TO BREINA
 23431        MOVE -1                  TO BREINL
 23432        MOVE  1                  TO SET-CURSOR-SW
 23433        GO TO 7499-EXIT.
 23434
 23435**2667**
 23436
 23437     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23438        MOVE AL-UNBON            TO BBEN2A
 23439        MOVE -1                  TO BBEN2L
 23440        MOVE  1                  TO SET-CURSOR-SW
 23441        GO TO 7499-EXIT.
 23442
 23443**2668**
 23444
 23445     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23446        MOVE AL-UABON            TO BEFFDTA
 23447        GO TO 7499-EXIT.
 23448
 23449**2669**
 23450
 23451     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23452       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23453       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23454        MOVE AL-UNBON            TO BAGEA
 23455        MOVE -1                  TO BAGEL
 23456        MOVE  1                  TO SET-CURSOR-SW
 23457        GO TO 7499-EXIT.
 23458
 23459**2670**
 23460
 23461     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23462        MOVE AL-UABON            TO BFORCEA
 23463        MOVE -1                  TO BFORCEL
 23464        MOVE  1                  TO SET-CURSOR-SW
 23465        GO TO 7499-EXIT.
 23466
 23467**2671**
 23468
 23469     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23470        MOVE AL-UABON            TO BEFFDTA
 23471        GO TO 7499-EXIT.
 23472
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 432
* EL6311.cbl
 23473**2672**
 23474
 23475     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23476        MOVE AL-UABON            TO BEFFDTA
 23477        GO TO 7499-EXIT.
 23478
 23479**2673**
 23480
 23481     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23482        MOVE AL-UABON            TO BEFFDTA
 23483        GO TO 7499-EXIT.
 23484
 23485**2674**
 23486
 23487     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23488        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23489        MOVE -1                  TO BTYPE1L
 23490        MOVE  1                  TO SET-CURSOR-SW
 23491        GO TO 7499-EXIT.
 23492
 23493**2677**
 23494
 23495     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23496        MOVE AL-UNBON            TO BTERM1A
 23497        MOVE -1                  TO BTERM1L
 23498        MOVE  1                  TO SET-CURSOR-SW
 23499        GO TO 7499-EXIT.
 23500
 23501**2678**
 23502
 23503     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23504        MOVE AL-UNBON            TO BTERM2A
 23505        MOVE -1                  TO BTERM2L
 23506        MOVE  1                  TO SET-CURSOR-SW
 23507        GO TO 7499-EXIT.
 23508
 23509**2679**
 23510
 23511     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23512        MOVE AL-UABON            TO BTYPE1A
 23513        MOVE -1                  TO BTYPE1L
 23514        MOVE  1                  TO SET-CURSOR-SW
 23515        GO TO 7499-EXIT.
 23516
 23517**2680**
 23518
 23519     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23520        MOVE AL-UABOF            TO B1STPMTA
 23521        MOVE -1                  TO B1STPMTL
 23522        MOVE  1                  TO SET-CURSOR-SW
 23523        GO TO 7499-EXIT.
 23524
 23525**2681**
 23526
 23527     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23528        MOVE AL-UABON            TO BDAYSA
 23529        MOVE -1                  TO BDAYSL
 23530        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 433
* EL6311.cbl
 23531        GO TO 7499-EXIT.
 23532
 23533**2682**
 23534
 23535     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23536        MOVE AL-UABON            TO BTERM1A
 23537        MOVE -1                  TO BTERM1L
 23538        MOVE  1                  TO SET-CURSOR-SW
 23539        GO TO 7499-EXIT.
 23540
 23541**2683**
 23542
 23543     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23544        MOVE AL-UABON            TO BSKPCDA
 23545        MOVE -1                  TO BSKPCDL
 23546        MOVE  1                  TO SET-CURSOR-SW
 23547        GO TO 7499-EXIT.
 23548
 23549**2684**
 23550
 23551     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23552        MOVE AL-UABON            TO BTYPE2A
 23553        MOVE -1                  TO BTYPE2L
 23554        MOVE  1                  TO SET-CURSOR-SW
 23555        GO TO 7499-EXIT.
 23556
 23557**2686**
 23558
 23559     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23560        MOVE AL-UABON            TO BTYPE2A
 23561        MOVE -1                  TO BTYPE2L
 23562        MOVE  1                  TO SET-CURSOR-SW
 23563        GO TO 7499-EXIT.
 23564
 23565**2689**
 23566
 23567     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23568        MOVE AL-UABON            TO BSIGA
 23569        MOVE -1                  TO BSIGL
 23570        MOVE  1                  TO SET-CURSOR-SW
 23571        GO TO 7499-EXIT.
 23572
 23573**2690**
 23574
 23575     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23576        MOVE AL-UABOF            TO BLNOFCRA
 23577        MOVE -1                  TO BLNOFCRL
 23578        MOVE  1                  TO SET-CURSOR-SW
 23579        GO TO 7499-EXIT.
 23580
 23581**2693**
 23582
 23583     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23584        MOVE AL-UABOF            TO BLNOFCRA
 23585        MOVE AL-UNBON            TO BBEN1A
 23586        MOVE -1                  TO BBEN1L
 23587        MOVE  1                  TO SET-CURSOR-SW
 23588        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 434
* EL6311.cbl
 23589
 23590**2720**
 23591
 23592     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23593        MOVE AL-UNBON            TO BBEN1A
 23594        MOVE -1                  TO BBEN1L
 23595        MOVE  1                  TO SET-CURSOR-SW
 23596        GO TO 7499-EXIT.
 23597
 23598**2709**
 23599
 23600*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23601*       MOVE AL-UNBON            TO BBEN1A
 23602*       MOVE -1                  TO BBEN1L
 23603*       MOVE  1                  TO SET-CURSOR-SW
 23604*       GO TO 7499-EXIT.
 23605
 23606*************************************************************
 23607*                                                           *
 23608*            C A N C E L   E R R O R S                      *
 23609*                                                           *
 23610*************************************************************
 23611
 23612**2726**
 23613
 23614     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23615        MOVE AL-UABON            TO CCERTNOA
 23616        GO TO 7499-EXIT.
 23617
 23618**2728**
 23619
 23620     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23621        MOVE AL-UABON            TO CCERTNOA
 23622        GO TO 7499-EXIT.
 23623
 23624**2729**
 23625
 23626     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23627        MOVE AL-UABON            TO CCERTNOA
 23628        GO TO 7499-EXIT.
 23629
 23630**2730**
 23631
 23632     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23633        MOVE AL-UABON            TO CCERTNOA
 23634        GO TO 7499-EXIT.
 23635
 23636**2731**
 23637
 23638     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23639        MOVE AL-UABON            TO CCANDT1A
 23640        MOVE -1                  TO CCANDT1L
 23641        MOVE  1                  TO SET-CURSOR-SW
 23642        GO TO 7499-EXIT.
 23643
 23644**2732**
 23645
 23646     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 435
* EL6311.cbl
 23647        MOVE AL-UABON            TO CCANDT1A
 23648        MOVE -1                  TO CCANDT1L
 23649        MOVE  1                  TO SET-CURSOR-SW
 23650        GO TO 7499-EXIT.
 23651
 23652**2733**
 23653
 23654     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23655        MOVE AL-UABON            TO CCANDT1A
 23656        MOVE -1                  TO CCANDT1L
 23657        MOVE  1                  TO SET-CURSOR-SW
 23658        GO TO 7499-EXIT.
 23659
 23660**2734**
 23661
 23662     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23663        MOVE AL-UNBON            TO CREFND1A
 23664        MOVE -1                  TO CREFND1L
 23665        MOVE  1                  TO SET-CURSOR-SW
 23666        GO TO 7499-EXIT.
 23667
 23668**2735**
 23669
 23670     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23671        MOVE AL-UABON            TO CCANDT2A
 23672        MOVE -1                  TO CCANDT2L
 23673        MOVE  1                  TO SET-CURSOR-SW
 23674        GO TO 7499-EXIT.
 23675
 23676**2736**
 23677
 23678     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23679        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23680            MOVE AL-UNBON        TO CREFND1A
 23681            MOVE -1              TO CREFND1L
 23682            MOVE  1              TO SET-CURSOR-SW
 23683            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23684                MOVE AL-UNBON        TO CREFND2A
 23685                MOVE -1              TO CREFND2L
 23686                MOVE  1              TO SET-CURSOR-SW
 23687                GO TO 7499-EXIT
 23688            ELSE
 23689                GO TO 7499-EXIT
 23690        ELSE
 23691            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23692                MOVE AL-UNBON        TO CREFND2A
 23693                MOVE -1              TO CREFND2L
 23694                MOVE  1              TO SET-CURSOR-SW
 23695                GO TO 7499-EXIT
 23696            ELSE
 23697                GO TO 7499-EXIT.
 23698
 23699**2738**
 23700
 23701     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23702        MOVE -1                  TO CREFND2L
 23703        MOVE  1                  TO SET-CURSOR-SW
 23704        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 436
* EL6311.cbl
 23705
 23706**2739**
 23707
 23708     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23709        MOVE -1                  TO CREFND1L
 23710        MOVE  1                  TO SET-CURSOR-SW
 23711        GO TO 7499-EXIT.
 23712
 23713**2741**
 23714
 23715     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23716        MOVE -1                  TO CREFND1L
 23717        MOVE  1                  TO SET-CURSOR-SW
 23718        GO TO 7499-EXIT.
 23719
 23720**2743**
 23721
 23722     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23723        MOVE AL-UNBON            TO CCANDT1A
 23724        MOVE -1                  TO CCANDT1L
 23725        MOVE  1                  TO SET-CURSOR-SW
 23726        GO TO 7499-EXIT.
 23727
 23728**2744**
 23729
 23730     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23731        MOVE AL-UNBON            TO CCANDT2A
 23732        MOVE -1                  TO CCANDT2L
 23733        MOVE  1                  TO SET-CURSOR-SW
 23734        GO TO 7499-EXIT.
 23735
 23736**2747**
 23737
 23738     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23739        MOVE AL-UABON            TO CLSTNMA
 23740        MOVE -1                  TO CLSTNML
 23741        MOVE  1                  TO SET-CURSOR-SW
 23742        GO TO 7499-EXIT.
 23743
 23744**2749**
 23745
 23746     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23747        MOVE AL-UABON            TO CFORCEA
 23748        MOVE -1                  TO CFORCEL
 23749        MOVE  1                  TO SET-CURSOR-SW
 23750        GO TO 7499-EXIT.
 23751
 23752**2753**
 23753
 23754     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23755        MOVE AL-UNBON            TO CCANDT1A
 23756        MOVE -1                  TO CCANDT1L
 23757        MOVE  1                  TO SET-CURSOR-SW
 23758        GO TO 7499-EXIT.
 23759
 23760**2755**
 23761
 23762     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 437
* EL6311.cbl
 23763        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23764            MOVE AL-UNBON        TO CREFND1A
 23765            MOVE -1              TO CREFND1L
 23766            MOVE  1              TO SET-CURSOR-SW
 23767            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23768                MOVE AL-UNBON        TO CREFND2A
 23769                MOVE -1              TO CREFND2L
 23770                MOVE  1              TO SET-CURSOR-SW
 23771                GO TO 7499-EXIT
 23772            ELSE
 23773                GO TO 7499-EXIT
 23774        ELSE
 23775            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23776                MOVE AL-UNBON        TO CREFND2A
 23777                MOVE -1              TO CREFND2L
 23778                MOVE  1              TO SET-CURSOR-SW
 23779            ELSE
 23780                GO TO 7499-EXIT.
 23781
 23782**2757**
 23783
 23784     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23785        MOVE AL-UNBON            TO CLIVESA
 23786        MOVE -1                  TO CLIVESL
 23787        MOVE  1                  TO SET-CURSOR-SW
 23788        GO TO 7499-EXIT.
 23789
 23790**2771**
 23791
 23792     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23793        MOVE AL-UABON            TO CCANDT2A
 23794        MOVE -1                  TO CCANDT2L
 23795        MOVE  1                  TO SET-CURSOR-SW
 23796        GO TO 7499-EXIT.
 23797
 23798**2774**
 23799
 23800     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23801        MOVE AL-UABON            TO CCANDT1A
 23802        MOVE -1                  TO CCANDT1L
 23803        MOVE  1                  TO SET-CURSOR-SW
 23804        GO TO 7499-EXIT.
 23805
 23806**2775**
 23807
 23808     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23809        MOVE AL-UABON            TO CCANDT2A
 23810        MOVE -1                  TO CCANDT2L
 23811        MOVE  1                  TO SET-CURSOR-SW
 23812        GO TO 7499-EXIT.
 23813
 23814**2776**
 23815
 23816     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23817        MOVE AL-UABON            TO CCANDT1A
 23818        MOVE -1                  TO CCANDT1L
 23819        MOVE  1                  TO SET-CURSOR-SW
 23820        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 438
* EL6311.cbl
 23821
 23822
 23823**2777**
 23824
 23825     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23826        MOVE AL-UABON            TO CCANDT2A
 23827        MOVE -1                  TO CCANDT2L
 23828        MOVE  1                  TO SET-CURSOR-SW
 23829        GO TO 7499-EXIT.
 23830
 23831**2794**
 23832
 23833     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23834        MOVE AL-UABON            TO CFORCEA
 23835        MOVE -1                  TO CFORCEL
 23836        MOVE  1                  TO SET-CURSOR-SW
 23837        GO TO 7499-EXIT.
 23838
 23839**2799**
 23840
 23841     IF PI-COMPANY-ID = 'UCL'
 23842         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23843             MOVE AL-UNBON            TO BEFFDTA
 23844             MOVE -1                  TO BEFFDTL
 23845             MOVE  1                  TO SET-CURSOR-SW
 23846             GO TO 7499-EXIT.
 23847
 23848 7499-EXIT.
 23849      EXIT.
 23850
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 439
* EL6311.cbl
 23852
 23853 7500-READ-ERLOFC.
 23854     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23855                                     ERLOFC-KEY.
 23856
 23857     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23858
 23859     IF ST-ACCNT-CNTL
 23860         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23861
 23862     IF CARR-GROUP-ST-ACCNT-CNTL
 23863         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23864         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23865         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23866
 23867     IF CARR-ST-ACCNT-CNTL
 23868         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23869         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23870
 23871     IF CARR-ACCNT-CNTL
 23872         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23873
 23874     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23875
 23876     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23877
 23878
 23879* EXEC CICS HANDLE CONDITION
 23880*        NOTFND   (7550-OFFICER-NOTFND)
 23881*    END-EXEC.
 23882*    MOVE '"$I                   ! [ #00020082' TO DFHEIV0
 23883     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23885     MOVE X'5B20233030303230303832' TO DFHEIV0(25:11)
 23886     CALL 'kxdfhei1' USING DFHEIV0
 23887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23888
 23889
 23890
 23891* EXEC CICS READ
 23892*        DATASET   (FILE-ID-ERLOFC)
 23893*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23894*        RIDFLD    (ERLOFC-KEY)
 23895*        EQUAL
 23896*    END-EXEC.
 23897*    MOVE '&"S        E          (   #00020086' TO DFHEIV0
 23898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23900     MOVE X'2020233030303230303836' TO DFHEIV0(25:11)
 23901     CALL 'kxdfhei1' USING DFHEIV0,
 23902           FILE-ID-ERLOFC,
 23903           DFHEIV20,
 23904           DFHEIV99,
 23905           ERLOFC-KEY,
 23906           DFHEIV99,
 23907           DFHEIV99,
 23908           DFHEIV99
 23909     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 440
* EL6311.cbl
 23910         DFHEIV20
 23911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23912
 23913
 23914     GO TO 7599-EXIT.
 23915
 23916 7550-OFFICER-NOTFND.
 23917     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23918
 23919 7599-EXIT.
 23920      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 441
* EL6311.cbl
 23922******************************************************************
 23923*                                                                *
 23924*            S  E N D    I N I T I A L   M A P                   *
 23925*                                                                *
 23926******************************************************************
 23927
 23928 8100-SEND-INITIAL-MAP.
 23929     MOVE EIBTIME                TO TIME-IN.
 23930
 23931     IF EIBAID = DFHPF11
 23932        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23934
 23935
 23936     IF PI-COMPANY-ID = CLIENT-GIC
 23937        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23938                                       BCPREM-ATTRB (2).
 23939
 23940     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23941                         CLIENT-PEM OR
 23942                         CLIENT-CSO)
 23943        AND PI-DISPLAY-ORIGINAL-BATCH
 23944          IF PI-MAP-NAME = EL631B
 23945             MOVE AL-SADOF               TO BPF5HDRA
 23946                                            BPF4HDRA
 23947          ELSE
 23948             IF PI-MAP-NAME = EL631C
 23949                MOVE AL-SADOF            TO CPF5HDRA
 23950                                            CPF4HDRA.
 23951
 23952     IF PI-MAP-NAME = EL631B
 23953        MOVE AL-SADOF               TO BPF5HDRA
 23954     ELSE
 23955        MOVE AL-SADOF               TO CPF5HDRA
 23956     END-IF
 23957
 23958*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23959     IF PI-MAP-NAME = EL631B
 23960          IF PI-COMPANY-ID NOT = 'DMD'
 23961             MOVE AL-SANOF            TO BBILLEDA
 23962             MOVE AL-SADOF            TO DMDBILA.
 23963*DMD CUSTOM CODING*************END
 23964
 23965     IF PI-PROCESSOR-ID = 'LGXX'
 23966        IF PI-MAP-NAME = EL631B
 23967           MOVE AL-SABOF                    TO BREFHDGA
 23968           MOVE AL-SANOF                    TO BREFA
 23969        ELSE
 23970           IF PI-MAP-NAME = EL631C
 23971              MOVE AL-SABOF                 TO CREFHDGA
 23972              MOVE AL-SANOF                 TO CREFA.
 23973
 23974*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23975     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23976        NEXT SENTENCE
 23977     ELSE
 23978        IF PI-MAP-NAME = EL631C
 23979           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 442
* EL6311.cbl
 23980                                       CCANFEEA.
 23981
 23982     IF PI-MAP-NAME = EL631D
 23983        IF PI-AR-PROCESSING
 23984           MOVE AL-SANOF            TO DREFHDGA
 23985        ELSE
 23986           MOVE AL-SADOF            TO DREFHDGA.
 23987
 23988     IF (PI-COMPANY-ID NOT = 'DCC')
 23989        AND (PI-MAP-NAME = EL631B)
 23990        MOVE AL-SADOF            TO BVINHA
 23991                                    BVINA
 23992     END-IF
 23993     IF PI-MAP-NAME = EL631B
 23994        IF CSR-EDIT-SESSION
 23995           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23996                                 TO BHEADO
 23997           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23998        ELSE
 23999           MOVE AL-SADOF         TO BF15HDRA
 24000           MOVE '4=B-HDR      '  TO BPF4HDRO
 24001        END-IF
 24002        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24003        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24004        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24005        MOVE WS-CURRENT-DT          TO BDATEO
 24006        MOVE TIME-OUT               TO BTIMEO
 24007        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24008        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24009        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24010        IF   WS-DISPLAY-SCREEN
 24011             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24012             MOVE PB-SV-CARRIER     TO BCARRO
 24013             MOVE PB-SV-GROUPING    TO BGROUPO
 24014             MOVE PB-SV-STATE       TO BSTATEO
 24015             MOVE PB-ACCOUNT        TO BACCTO
 24016        ELSE
 24017             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24018     ELSE
 24019        IF PI-MAP-NAME = EL631C
 24020           MOVE '4=B-HDR      '     TO CPF4HDRO
 24021           IF CSR-EDIT-SESSION
 24022              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24023                                 TO CHEADO
 24024           ELSE
 24025              MOVE AL-SADOF      TO CF15HDRA
 24026           END-IF
 24027           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24028           MOVE WS-CURRENT-DT          TO CDATEO
 24029           MOVE TIME-OUT               TO CTIMEO
 24030           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24031           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24032           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24033           MOVE WS-C-HDG               TO CLFHDGO
 24034           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24035           MOVE WS-C-HDG               TO CAHHDGO
 24036           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24037           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 443
* EL6311.cbl
 24038           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24039           IF   WS-DISPLAY-SCREEN
 24040                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24041                MOVE PB-SV-CARRIER     TO CCARRO
 24042                MOVE PB-SV-GROUPING    TO CGROUPO
 24043                MOVE PB-SV-STATE       TO CSTATEO
 24044                MOVE PB-ACCOUNT        TO CACCTO
 24045           ELSE
 24046                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24047        ELSE
 24048           MOVE WS-CURRENT-DT          TO DDATEO
 24049           MOVE TIME-OUT               TO DTIMEO
 24050           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24051                                          WS-REFUND-HDG-OVERRIDE
 24052           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24053           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24054           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24055                                          WS-REFUND-HDG-OVERRIDE
 24056           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24057           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24058           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24059           IF CSR-EDIT-SESSION
 24060              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24061                                 TO DHEADO
 24062           END-IF
 24063           IF  WS-DISPLAY-SCREEN
 24064               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24065               MOVE PB-CARRIER         TO DCARRO
 24066               MOVE PB-GROUPING        TO DGROUPO
 24067               MOVE PB-STATE           TO DSTATEO
 24068               MOVE PB-ACCOUNT         TO DACCTO
 24069               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24070           ELSE
 24071               MOVE EL631D             TO PI-MAP-NAME
 24072               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24073               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24074
 24075     MOVE SPACE                        TO WS-DISPLAY-SW.
 24076
 24077
 24078* EXEC CICS SEND
 24079*        MAP      (PI-MAP-NAME)
 24080*        MAPSET   (MAPSET-EL6311S)
 24081*        FROM     (EL631BI)
 24082*        ERASE
 24083*        CURSOR
 24084*    END-EXEC.
 24085     MOVE LENGTH OF
 24086      EL631BI
 24087       TO DFHEIV12
 24088     MOVE -1
 24089       TO DFHEIV11
 24090*    MOVE '8$     CT  E    H L F ,   #00020256' TO DFHEIV0
 24091     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 24092     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24093     MOVE X'2020233030303230323536' TO DFHEIV0(25:11)
 24094     CALL 'kxdfhei1' USING DFHEIV0,
 24095           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 444
* EL6311.cbl
 24096           EL631BI,
 24097           DFHEIV12,
 24098           MAPSET-EL6311S,
 24099           DFHEIV99,
 24100           DFHEIV99,
 24101           DFHEIV99,
 24102           DFHEIV11,
 24103           DFHEIV99,
 24104           DFHEIV99,
 24105           DFHEIV99
 24106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24107
 24108
 24109     GO TO 9100-RETURN-TRAN.
 24110
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 445
* EL6311.cbl
 24112
 24113******************************************************************
 24114*                                                                *
 24115*              S E N D    D A T A O N L Y                        *
 24116*                                                                *
 24117******************************************************************
 24118
 24119 8200-SEND-DATAONLY.
 24120     MOVE EIBTIME                TO TIME-IN.
 24121
 24122     IF PI-COMPANY-ID = CLIENT-GIC
 24123        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24124                                       BCPREM-ATTRB (2).
 24125
 24126     IF PI-MAP-NAME = EL631B
 24127        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24128        MOVE WS-CURRENT-DT          TO BDATEO
 24129        MOVE TIME-OUT               TO BTIMEO
 24130        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24131        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24132        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24133        MOVE SPACES                 TO BPFENTRO
 24134        MOVE AL-UANOF               TO BPFENTRA
 24135
 24136*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24137        IF PI-COMPANY-ID NOT = 'DMD'
 24138             MOVE AL-SANOF            TO BBILLEDA
 24139             MOVE AL-SADOF            TO DMDBILA
 24140         ELSE
 24141            NEXT SENTENCE
 24142*DMD CUSTOM CODING*************END
 24143     ELSE
 24144        IF PI-MAP-NAME = EL631C
 24145           MOVE WS-CURRENT-DT          TO CDATEO
 24146           MOVE TIME-OUT               TO CTIMEO
 24147           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24148           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24149           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24150           MOVE SPACES                 TO CPFENTRO
 24151           MOVE AL-UANOF               TO CPFENTRA
 24152        ELSE
 24153           MOVE WS-CURRENT-DT          TO DDATEO
 24154           MOVE TIME-OUT               TO DTIMEO
 24155           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24156
 24157
 24158* EXEC CICS SEND
 24159*        MAP      (PI-MAP-NAME)
 24160*        MAPSET   (MAPSET-EL6311S)
 24161*        FROM     (EL631BI)
 24162*        DATAONLY
 24163*        CURSOR
 24164*    END-EXEC.
 24165     MOVE LENGTH OF
 24166      EL631BI
 24167       TO DFHEIV12
 24168     MOVE -1
 24169       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 446
* EL6311.cbl
 24170*    MOVE '8$D    CT       H L F ,   #00020312' TO DFHEIV0
 24171     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24172     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24173     MOVE X'2020233030303230333132' TO DFHEIV0(25:11)
 24174     CALL 'kxdfhei1' USING DFHEIV0,
 24175           PI-MAP-NAME,
 24176           EL631BI,
 24177           DFHEIV12,
 24178           MAPSET-EL6311S,
 24179           DFHEIV99,
 24180           DFHEIV99,
 24181           DFHEIV99,
 24182           DFHEIV11,
 24183           DFHEIV99,
 24184           DFHEIV99,
 24185           DFHEIV99
 24186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24187
 24188
 24189     GO TO 9100-RETURN-TRAN.
 24190
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 447
* EL6311.cbl
 24192
 24193******************************************************************
 24194*                                                                *
 24195*           U T I L I T Y   R O U T I N E S                      *
 24196*                                                                *
 24197******************************************************************
 24198
 24199 8300-SEND-TEXT.
 24200
 24201* EXEC CICS SEND TEXT
 24202*        FROM     (LOGOFF-TEXT)
 24203*        LENGTH   (LOGOFF-LENGTH)
 24204*        ERASE
 24205*        FREEKB
 24206*    END-EXEC.
 24207*    MOVE '8&      T  E F  H   F -   #00020331' TO DFHEIV0
 24208     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24209     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24210     MOVE X'2020233030303230333331' TO DFHEIV0(25:11)
 24211     CALL 'kxdfhei1' USING DFHEIV0,
 24212           LOGOFF-TEXT,
 24213           LOGOFF-LENGTH,
 24214           DFHEIV99,
 24215           DFHEIV99,
 24216           DFHEIV99,
 24217           DFHEIV99,
 24218           DFHEIV99,
 24219           DFHEIV99,
 24220           DFHEIV99,
 24221           DFHEIV99,
 24222           DFHEIV99,
 24223           DFHEIV99
 24224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24225
 24226
 24227
 24228* EXEC CICS RETURN
 24229*    END-EXEC.
 24230*    MOVE '.(                    ''   #00020338' TO DFHEIV0
 24231     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24233     MOVE X'2020233030303230333338' TO DFHEIV0(25:11)
 24234     CALL 'kxdfhei1' USING DFHEIV0,
 24235           DFHEIV99,
 24236           DFHEIV99,
 24237           DFHEIV99,
 24238           DFHEIV99,
 24239           DFHEIV99,
 24240           DFHEIV99
 24241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24242
 24243
 24244 8400-LOG-JOURNAL-RECORD.
 24245     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24246     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24247
 24248*    EXEC CICS JOURNAL
 24249*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 448
* EL6311.cbl
 24250*        JTYPEID     ('EL')
 24251*        FROM        (JOURNAL-RECORD)
 24252*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24253*    END-EXEC.
 24254
 24255 8600-DEEDIT.
 24256
 24257* EXEC CICS BIF DEEDIT
 24258*         FIELD   (DEEDIT-FIELD)
 24259*         LENGTH  (15)
 24260*    END-EXEC.
 24261     MOVE 15
 24262       TO DFHEIV11
 24263*    MOVE '@"L                   #   #00020353' TO DFHEIV0
 24264     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24265     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24266     MOVE X'2020233030303230333533' TO DFHEIV0(25:11)
 24267     CALL 'kxdfhei1' USING DFHEIV0,
 24268           DEEDIT-FIELD,
 24269           DFHEIV11
 24270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24271
 24272
 24273 8800-UNAUTHORIZED-ACCESS.
 24274     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24275     GO TO 8300-SEND-TEXT.
 24276
 24277 8810-PF23.
 24278     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24279     MOVE XCTL-EL005             TO PGM-NAME.
 24280     GO TO 9300-XCTL.
 24281
 24282 9100-RETURN-TRAN.
 24283     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24284
 24285     IF  PI-MAP-NAME =  EL631B
 24286         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24287
 24288     IF  PI-MAP-NAME =  EL631C
 24289         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24290
 24291     IF  PI-MAP-NAME =  EL631D
 24292         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24293
 24294
 24295* EXEC CICS RETURN
 24296*        TRANSID    (TRANS-EXB1)
 24297*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24298*        LENGTH     (1300)
 24299*    END-EXEC.
 24300     MOVE 1300
 24301       TO DFHEIV11
 24302*    MOVE '.(CT                  ''   #00020379' TO DFHEIV0
 24303     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24305     MOVE X'2020233030303230333739' TO DFHEIV0(25:11)
 24306     CALL 'kxdfhei1' USING DFHEIV0,
 24307           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 449
* EL6311.cbl
 24308           PROGRAM-INTERFACE-BLOCK,
 24309           DFHEIV11,
 24310           DFHEIV99,
 24311           DFHEIV99,
 24312           DFHEIV99
 24313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24314
 24315
 24316 9200-RETURN-MAIN-MENU.
 24317     MOVE XCTL-EL626             TO PGM-NAME.
 24318     GO TO 9300-XCTL.
 24319
 24320 9300-XCTL.
 24321
 24322* EXEC CICS XCTL
 24323*        PROGRAM    (PGM-NAME)
 24324*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24325*        LENGTH     (PI-COMM-LENGTH)
 24326*    END-EXEC.
 24327*    MOVE '.$C                   %   #00020390' TO DFHEIV0
 24328     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24329     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24330     MOVE X'2020233030303230333930' TO DFHEIV0(25:11)
 24331     CALL 'kxdfhei1' USING DFHEIV0,
 24332           PGM-NAME,
 24333           PROGRAM-INTERFACE-BLOCK,
 24334           PI-COMM-LENGTH,
 24335           DFHEIV99
 24336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24337
 24338
 24339 9400-CLEAR.
 24340     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24341     GO TO 9300-XCTL.
 24342
 24343 9500-PF12.
 24344     MOVE XCTL-EL010             TO PGM-NAME.
 24345     GO TO 9300-XCTL.
 24346
 24347 9600-PGMID-ERROR.
 24348
 24349* EXEC CICS HANDLE CONDITION
 24350*        PGMIDERR    (8300-SEND-TEXT)
 24351*    END-EXEC.
 24352*    MOVE '"$L                   ! \ #00020405' TO DFHEIV0
 24353     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24355     MOVE X'5C20233030303230343035' TO DFHEIV0(25:11)
 24356     CALL 'kxdfhei1' USING DFHEIV0
 24357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24358
 24359
 24360     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24361     MOVE ' '                    TO PI-ENTRY-CD-1.
 24362     MOVE XCTL-EL005             TO PGM-NAME.
 24363     MOVE PGM-NAME               TO LOGOFF-PGM.
 24364     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24365     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 450
* EL6311.cbl
 24366
 24367 9700-DATE-LINK.
 24368     MOVE LINK-ELDATCV           TO PGM-NAME.
 24369
 24370* EXEC CICS LINK
 24371*        PROGRAM    (PGM-NAME)
 24372*        COMMAREA   (DATE-CONVERSION-DATA)
 24373*        LENGTH     (DC-COMM-LENGTH)
 24374*    END-EXEC.
 24375*    MOVE '."C                   (   #00020418' TO DFHEIV0
 24376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24378     MOVE X'2020233030303230343138' TO DFHEIV0(25:11)
 24379     CALL 'kxdfhei1' USING DFHEIV0,
 24380           PGM-NAME,
 24381           DATE-CONVERSION-DATA,
 24382           DC-COMM-LENGTH,
 24383           DFHEIV99,
 24384           DFHEIV99,
 24385           DFHEIV99,
 24386           DFHEIV99
 24387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24388
 24389
 24390 9800-LINK-PENDING-EDIT.
 24391     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24392     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24393
 24394     MOVE LINK-EL050             TO PGM-NAME
 24395     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24396     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24397                                    WK-CO-TOL-CLAIM
 24398                                    WK-CO-TOL-PREM
 24399                                    WK-CO-TOL-REFUND
 24400                                    WK-CO-TOL-PREM-PCT
 24401                                    WK-CO-TOL-REFUND-PCT
 24402                                    WK-REFUND-OVS-AMT
 24403                                    WK-REFUND-OVS-PCT
 24404                                    WK-ACCT-ADDR
 24405                                    WK-LIFE-EDIT-ADDR
 24406                                    WK-AH-EDIT-ADDR
 24407                                    WK-LIFE-BEN-ADDR
 24408                                    WK-AH-BEN-ADDR
 24409                                    WK-STATE-ADDR
 24410                                    WK-PLAN-ADDR
 24411                                    WK-FORM-ADDR
 24412     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24413
 24414     MOVE '6'                    TO WK-ENTRY-SW.
 24415
 24416     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24417
 24418     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24419                                    EC-AM-EXPIRATION-DT
 24420                                    EC-AM-EFFECTIVE-DT
 24421                                    EC-CM-LF-CANCEL-DT
 24422                                    EC-CM-AH-CANCEL-DT
 24423                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 451
* EL6311.cbl
 24424
 24425     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24426                                    EC-CO-TOL-REFUND
 24427                                    EC-CO-MIN-AGE
 24428                                    EC-CO-MIN-PREMIUM
 24429                                    EC-CO-MIN-TERM
 24430                                    EC-CO-MAX-TERM
 24431                                    EC-ST-TOL-PREM
 24432                                    EC-ST-TOL-REFUND
 24433                                    EC-AM-LF-TOL-PREM
 24434                                    EC-AM-AH-TOL-PREM
 24435                                    EC-AM-LF-MAX-ATT-AGE
 24436                                    EC-AM-LF-MAX-AGE
 24437                                    EC-AM-LF-MAX-TERM
 24438                                    EC-AM-LF-MAX-TOT-BEN
 24439                                    EC-AM-AH-MAX-ATT-AGE
 24440                                    EC-AM-AH-MAX-AGE
 24441                                    EC-AM-AH-MAX-TERM
 24442                                    EC-AM-AH-MAX-TOT-BEN
 24443                                    EC-AM-AH-MAX-MON-BEN
 24444                                    EC-RT-LF-MAX-ATT-AGE
 24445                                    EC-RT-LF-MAX-AGE
 24446                                    EC-RT-LF-MAX-TERM
 24447                                    EC-RT-LF-MAX-TOT-BEN
 24448                                    EC-RT-AH-MAX-ATT-AGE
 24449                                    EC-RT-AH-MAX-AGE
 24450                                    EC-RT-AH-MAX-TERM
 24451                                    EC-RT-AH-MAX-TOT-BEN
 24452                                    EC-RT-AH-MAX-MON-BEN
 24453                                    EC-RT-AH-RATE
 24454                                    EC-RT-LF-RATE
 24455                                    EC-RT-LF-NSP-RATE
 24456                                    EC-RT-AH-NSP-RATE
 24457                                    EC-CM-LF-PRIOR-REFUND
 24458                                    EC-CM-AH-PRIOR-REFUND.
 24459
 24460     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24461                                    EC-ST-TOL-PREM-PCT
 24462                                    EC-AM-LF-TOL-REFUND
 24463                                    EC-AM-LF-DEV-PERCENT
 24464                                    EC-CO-TOL-REFUND-PCT
 24465                                    EC-ST-TOL-REFUND-PCT
 24466                                    EC-AM-AH-TOL-REFUND
 24467                                    EC-AM-AH-DEV-PERCENT.
 24468
 24469
 24470* EXEC CICS LINK
 24471*         PROGRAM   (PGM-NAME)
 24472*         COMMAREA  (PASSED-RECORD)
 24473*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24474*    END-EXEC.
 24475*    MOVE '."C                   (   #00020503' TO DFHEIV0
 24476     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24478     MOVE X'2020233030303230353033' TO DFHEIV0(25:11)
 24479     CALL 'kxdfhei1' USING DFHEIV0,
 24480           PGM-NAME,
 24481           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 452
* EL6311.cbl
 24482           WS-EDIT-PASS-LENGTH,
 24483           DFHEIV99,
 24484           DFHEIV99,
 24485           DFHEIV99,
 24486           DFHEIV99
 24487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24488
 24489
 24490     MOVE '1'                    TO PI-EDIT-SW.
 24491     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24492
 24493     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24494
 24495     IF PI-COMPANY-ID = 'UCL'
 24496         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24497
 24498     IF VALID-PB-ID
 24499        GO TO 9800-EXIT.
 24500
 24501     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24502
 24503     IF PI-MAP-NAME = EL631B
 24504        MOVE -1                  TO BMAINTL
 24505       ELSE
 24506        MOVE -1                  TO CMAINTL.
 24507
 24508     GO TO 8200-SEND-DATAONLY.
 24509
 24510 9800-EXIT.
 24511      EXIT.
 24512
 24513 9900-ERROR-FORMAT.
 24514
 24515     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24516
 24517     IF NOT EMI-ERRORS-COMPLETE
 24518         MOVE LINK-EL001         TO PGM-NAME
 24519
 24520* EXEC CICS LINK
 24521*            PROGRAM    (PGM-NAME)
 24522*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24523*            LENGTH     (EMI-COMM-LENGTH)
 24524*        END-EXEC.
 24525*    MOVE '."C                   (   #00020538' TO DFHEIV0
 24526     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24528     MOVE X'2020233030303230353338' TO DFHEIV0(25:11)
 24529     CALL 'kxdfhei1' USING DFHEIV0,
 24530           PGM-NAME,
 24531           ERROR-MESSAGE-INTERFACE-BLOCK,
 24532           EMI-COMM-LENGTH,
 24533           DFHEIV99,
 24534           DFHEIV99,
 24535           DFHEIV99,
 24536           DFHEIV99
 24537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24538
 24539
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 453
* EL6311.cbl
 24540 9900-EXIT.
 24541     EXIT.
 24542
 24543 9990-ABEND.
 24544     MOVE LINK-EL004             TO PGM-NAME.
 24545     MOVE DFHEIBLK               TO EMI-LINE1.
 24546
 24547* EXEC CICS LINK
 24548*        PROGRAM   (PGM-NAME)
 24549*        COMMAREA  (EMI-LINE1)
 24550*        LENGTH    (72)
 24551*    END-EXEC.
 24552     MOVE 72
 24553       TO DFHEIV11
 24554*    MOVE '."C                   (   #00020550' TO DFHEIV0
 24555     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24557     MOVE X'2020233030303230353530' TO DFHEIV0(25:11)
 24558     CALL 'kxdfhei1' USING DFHEIV0,
 24559           PGM-NAME,
 24560           EMI-LINE1,
 24561           DFHEIV11,
 24562           DFHEIV99,
 24563           DFHEIV99,
 24564           DFHEIV99,
 24565           DFHEIV99
 24566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24567
 24568
 24569     IF PI-MAP-NAME = EL631B
 24570        MOVE -1                  TO BMAINTL
 24571       ELSE
 24572        MOVE -1                  TO CMAINTL.
 24573
 24574     IF EIBTRNID NOT = TRANS-EXB1
 24575        GO TO 8100-SEND-INITIAL-MAP
 24576       ELSE
 24577        GO TO 8200-SEND-DATAONLY.
 24578
 24579 9995-SECURITY-VIOLATION.
 24580*                            COPY ELCSCTP.
 24581******************************************************************
 24582*                                                                *
 24583*                            ELCSCTP                             *
 24584*                            VMOD=2.001                          *
 24585*                                                                *
 24586*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24587******************************************************************
 24588
 24589
 24590     MOVE EIBDATE          TO SM-JUL-DATE.
 24591     MOVE EIBTRMID         TO SM-TERMID.
 24592     MOVE THIS-PGM         TO SM-PGM.
 24593     MOVE EIBTIME          TO TIME-IN.
 24594     MOVE TIME-OUT         TO SM-TIME.
 24595     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24596
 24597
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 454
* EL6311.cbl
 24598* EXEC CICS LINK
 24599*         PROGRAM  ('EL003')
 24600*         COMMAREA (SECURITY-MESSAGE)
 24601*         LENGTH   (80)
 24602*    END-EXEC.
 24603     MOVE 'EL003' TO DFHEIV1
 24604     MOVE 80
 24605       TO DFHEIV11
 24606*    MOVE '."C                   (   #00020584' TO DFHEIV0
 24607     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24608     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24609     MOVE X'2020233030303230353834' TO DFHEIV0(25:11)
 24610     CALL 'kxdfhei1' USING DFHEIV0,
 24611           DFHEIV1,
 24612           SECURITY-MESSAGE,
 24613           DFHEIV11,
 24614           DFHEIV99,
 24615           DFHEIV99,
 24616           DFHEIV99,
 24617           DFHEIV99
 24618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24619
 24620
 24621******************************************************************
 24622
 24623
 24624 9999-DFHBACK SECTION.
 24625     MOVE '9%                    "   ' TO DFHEIV0
 24626     MOVE 'EL6311' TO DFHEIV1
 24627     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24628     GOBACK.
 24629 9999-DFHEXIT.
 24630     IF DFHEIGDJ EQUAL 0001
 24631         NEXT SENTENCE
 24632     ELSE IF DFHEIGDJ EQUAL 2
 24633         GO TO 9600-PGMID-ERROR,
 24634               9990-ABEND,
 24635               9990-ABEND,
 24636               0010-MAIN-LOGIC
 24637         DEPENDING ON DFHEIGDI
 24638     ELSE IF DFHEIGDJ EQUAL 3
 24639         GO TO 1280-BATCH-HDR-NOT-FOUND
 24640         DEPENDING ON DFHEIGDI
 24641     ELSE IF DFHEIGDJ EQUAL 4
 24642         GO TO 1290-DUPLICATE-ALT-INDEX
 24643         DEPENDING ON DFHEIGDI
 24644     ELSE IF DFHEIGDJ EQUAL 5
 24645         GO TO 1295-CERT-TRL-REC-NOTFND
 24646         DEPENDING ON DFHEIGDI
 24647     ELSE IF DFHEIGDJ EQUAL 6
 24648         GO TO 1380-BATCH-HDR-NOT-FOUND
 24649         DEPENDING ON DFHEIGDI
 24650     ELSE IF DFHEIGDJ EQUAL 7
 24651         GO TO 1385-REC-NOT-FOUND
 24652         DEPENDING ON DFHEIGDI
 24653     ELSE IF DFHEIGDJ EQUAL 8
 24654         GO TO 1386-NOTFND
 24655         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 455
* EL6311.cbl
 24656     ELSE IF DFHEIGDJ EQUAL 9
 24657         GO TO 1399-EXIT
 24658         DEPENDING ON DFHEIGDI
 24659     ELSE IF DFHEIGDJ EQUAL 10
 24660         GO TO 1480-BATCH-HDR-NOT-FOUND
 24661         DEPENDING ON DFHEIGDI
 24662     ELSE IF DFHEIGDJ EQUAL 11
 24663         GO TO 1490-RECORD-NOT-FOUND
 24664         DEPENDING ON DFHEIGDI
 24665     ELSE IF DFHEIGDJ EQUAL 12
 24666         GO TO 1405-DELETE-CERTIFICATE
 24667         DEPENDING ON DFHEIGDI
 24668     ELSE IF DFHEIGDJ EQUAL 13
 24669         GO TO 1420-CONTINUE-DELETE
 24670         DEPENDING ON DFHEIGDI
 24671     ELSE IF DFHEIGDJ EQUAL 14
 24672         GO TO 1406-DELETE-ERNOTE
 24673         DEPENDING ON DFHEIGDI
 24674     ELSE IF DFHEIGDJ EQUAL 15
 24675         GO TO 1407-DELETE-MAILING
 24676         DEPENDING ON DFHEIGDI
 24677     ELSE IF DFHEIGDJ EQUAL 16
 24678         GO TO 1420-CONTINUE-DELETE
 24679         DEPENDING ON DFHEIGDI
 24680     ELSE IF DFHEIGDJ EQUAL 17
 24681         GO TO 1480-BATCH-HDR-NOT-FOUND
 24682         DEPENDING ON DFHEIGDI
 24683     ELSE IF DFHEIGDJ EQUAL 18
 24684         GO TO 1475-DELETE-FINISHED
 24685         DEPENDING ON DFHEIGDI
 24686     ELSE IF DFHEIGDJ EQUAL 19
 24687         GO TO 2280-BATCH-HDR-NOT-FOUND
 24688         DEPENDING ON DFHEIGDI
 24689     ELSE IF DFHEIGDJ EQUAL 20
 24690         GO TO 2290-DUPLICATE-ALT-INDEX
 24691         DEPENDING ON DFHEIGDI
 24692     ELSE IF DFHEIGDJ EQUAL 21
 24693         GO TO 2380-BATCH-HDR-NOT-FOUND
 24694         DEPENDING ON DFHEIGDI
 24695     ELSE IF DFHEIGDJ EQUAL 22
 24696         GO TO 2385-REC-NOT-FOUND
 24697         DEPENDING ON DFHEIGDI
 24698     ELSE IF DFHEIGDJ EQUAL 23
 24699         GO TO 2380-BATCH-HDR-NOT-FOUND
 24700         DEPENDING ON DFHEIGDI
 24701     ELSE IF DFHEIGDJ EQUAL 24
 24702         GO TO 2485-BATCH-HDR-NOT-FOUND
 24703         DEPENDING ON DFHEIGDI
 24704     ELSE IF DFHEIGDJ EQUAL 25
 24705         GO TO 2490-RECORD-NOT-FOUND
 24706         DEPENDING ON DFHEIGDI
 24707     ELSE IF DFHEIGDJ EQUAL 26
 24708         GO TO 2475-CONTINUE-DELETE
 24709         DEPENDING ON DFHEIGDI
 24710     ELSE IF DFHEIGDJ EQUAL 27
 24711         GO TO 2485-BATCH-HDR-NOT-FOUND
 24712         DEPENDING ON DFHEIGDI
 24713     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 456
* EL6311.cbl
 24714         GO TO 2480-DELETE-FINISHED
 24715         DEPENDING ON DFHEIGDI
 24716     ELSE IF DFHEIGDJ EQUAL 29
 24717         GO TO 2820-PROCESS-REWRITE
 24718         DEPENDING ON DFHEIGDI
 24719     ELSE IF DFHEIGDJ EQUAL 30
 24720         GO TO 2885-RECORD-MISSING
 24721         DEPENDING ON DFHEIGDI
 24722     ELSE IF DFHEIGDJ EQUAL 31
 24723         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24724         DEPENDING ON DFHEIGDI
 24725     ELSE IF DFHEIGDJ EQUAL 32
 24726         GO TO 2827-DELETE-MAILING
 24727         DEPENDING ON DFHEIGDI
 24728     ELSE IF DFHEIGDJ EQUAL 33
 24729         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24730         DEPENDING ON DFHEIGDI
 24731     ELSE IF DFHEIGDJ EQUAL 34
 24732         GO TO 2920-PROCESS-REWRITE
 24733         DEPENDING ON DFHEIGDI
 24734     ELSE IF DFHEIGDJ EQUAL 35
 24735         GO TO 2985-RECORD-MISSING
 24736         DEPENDING ON DFHEIGDI
 24737     ELSE IF DFHEIGDJ EQUAL 36
 24738         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24739         DEPENDING ON DFHEIGDI
 24740     ELSE IF DFHEIGDJ EQUAL 37
 24741         GO TO 2990-DUPLICATE-RECORD
 24742         DEPENDING ON DFHEIGDI
 24743     ELSE IF DFHEIGDJ EQUAL 38
 24744         GO TO 3590-NOT-FOUND
 24745         DEPENDING ON DFHEIGDI
 24746     ELSE IF DFHEIGDJ EQUAL 39
 24747         GO TO 3690-NOT-FOUND
 24748         DEPENDING ON DFHEIGDI
 24749     ELSE IF DFHEIGDJ EQUAL 40
 24750         GO TO 3990-NOT-FOUND
 24751         DEPENDING ON DFHEIGDI
 24752     ELSE IF DFHEIGDJ EQUAL 41
 24753         GO TO 4050-END-RECORDS,
 24754               4050-END-RECORDS
 24755         DEPENDING ON DFHEIGDI
 24756     ELSE IF DFHEIGDJ EQUAL 42
 24757         GO TO 4150-END-BATCH
 24758         DEPENDING ON DFHEIGDI
 24759     ELSE IF DFHEIGDJ EQUAL 43
 24760         GO TO 4150-END-BATCH
 24761         DEPENDING ON DFHEIGDI
 24762     ELSE IF DFHEIGDJ EQUAL 44
 24763         GO TO 4250-END-RECORDS,
 24764               4250-END-RECORDS
 24765         DEPENDING ON DFHEIGDI
 24766     ELSE IF DFHEIGDJ EQUAL 45
 24767         GO TO 4350-END-BATCH,
 24768               4350-END-BATCH
 24769         DEPENDING ON DFHEIGDI
 24770     ELSE IF DFHEIGDJ EQUAL 46
 24771         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-14 12:31 Page 457
* EL6311.cbl
 24772               4550-END-RECORDS
 24773         DEPENDING ON DFHEIGDI
 24774     ELSE IF DFHEIGDJ EQUAL 47
 24775         GO TO 4680-NOT-FOUND,
 24776               4680-NOT-FOUND
 24777         DEPENDING ON DFHEIGDI
 24778     ELSE IF DFHEIGDJ EQUAL 48
 24779         GO TO 4860-NOT-FOUND,
 24780               4850-END-RECORDS
 24781         DEPENDING ON DFHEIGDI
 24782     ELSE IF DFHEIGDJ EQUAL 49
 24783         GO TO 4970-NOT-FOUND,
 24784               4950-END-RECORDS
 24785         DEPENDING ON DFHEIGDI
 24786     ELSE IF DFHEIGDJ EQUAL 50
 24787         GO TO 5050-NOT-FOUND
 24788         DEPENDING ON DFHEIGDI
 24789     ELSE IF DFHEIGDJ EQUAL 51
 24790         GO TO 5050-NOT-FOUND
 24791         DEPENDING ON DFHEIGDI
 24792     ELSE IF DFHEIGDJ EQUAL 52
 24793         GO TO 5050-NOT-FOUND
 24794         DEPENDING ON DFHEIGDI
 24795     ELSE IF DFHEIGDJ EQUAL 53
 24796         GO TO 5550-END-RECORDS,
 24797               5550-END-RECORDS
 24798         DEPENDING ON DFHEIGDI
 24799     ELSE IF DFHEIGDJ EQUAL 54
 24800         GO TO 6050-QID-ERROR
 24801         DEPENDING ON DFHEIGDI
 24802     ELSE IF DFHEIGDJ EQUAL 55
 24803         GO TO 6050-QID-ERROR
 24804         DEPENDING ON DFHEIGDI
 24805     ELSE IF DFHEIGDJ EQUAL 56
 24806         GO TO 6400-CONTINUE,
 24807               6400-CONTINUE
 24808         DEPENDING ON DFHEIGDI
 24809     ELSE IF DFHEIGDJ EQUAL 57
 24810         GO TO 3690-NOT-FOUND
 24811         DEPENDING ON DFHEIGDI
 24812     ELSE IF DFHEIGDJ EQUAL 58
 24813         GO TO 7399-EXIT
 24814         DEPENDING ON DFHEIGDI
 24815     ELSE IF DFHEIGDJ EQUAL 59
 24816         GO TO 7550-OFFICER-NOTFND
 24817         DEPENDING ON DFHEIGDI
 24818     ELSE IF DFHEIGDJ EQUAL 60
 24819         GO TO 8300-SEND-TEXT
 24820         DEPENDING ON DFHEIGDI.
 24821     MOVE '9%                    "   ' TO DFHEIV0
 24822     MOVE 'EL6311' TO DFHEIV1
 24823     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24824     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14900     Code:       98427
