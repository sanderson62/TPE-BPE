* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   3
* EL050.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    66
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    73                                   USAGE IS POINTER.
    74 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    82 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    83                                   USAGE IS POINTER.
    84
    85*    COPY ELC50WS.
    86*****************************************************************
    87*                                                               *
    88*                            ELC50WS.                           *
    89*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    90*                            VMOD=2.061.                        *
    91*                                                               *
    92*   THIS IS THE WORKING STORAGE FOR EL050                       *
    93*                                   EL517                       *
    94*****************************************************************
    95******************************************************************
    96*                   C H A N G E   L O G
    97*
    98* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    99*-----------------------------------------------------------------
   100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   101* EFFECTIVE    NUMBER
   102*-----------------------------------------------------------------
   103* 123102                   PEMA  ADD DCC PROCESSING
   104* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   105* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   106* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   108* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   109* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   110* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   111* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   112* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   113* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   114* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   115* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   116* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   117* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   4
* EL050.cbl
   118* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   119* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   120* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   121* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   122* 030309  CR2009021700001  PEMA  ADD ER-2883
   123* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   125* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   126* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   127* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   128* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   129* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   130* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   131* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   132* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   133* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   134* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   135* 061412  CR2011022800001  AJRA  NAPERSOFT
   136* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   137* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   138* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   139* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   140* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   141* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   142* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   143* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   144* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   145* 091114  IR2014091000001  TANA  ADD ERROR 2898
   146* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   147* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   148*-----------------------------------------------------------------
   149
   150 01  WORK-AREAS.
   151
   152*****************************************************************
   153*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   154*****************************************************************
   155
   156     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   157     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   158     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   159     12  WS-NAME-EDIT-WORK-AREA.
   160         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   161         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   162             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   163         16  WS-WORK-NAME.
   164             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   165             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   166             20  FILLER           PIC X(10)     VALUE SPACES.
   167         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   168             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   169
   170*****************************************************************
   171*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   172*****************************************************************
   173
   174     12  WS-ERRESC-KEY.
   175         16 WS-ERRESC-SEARCH-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   5
* EL050.cbl
   176             20  WS-ERRESC-COMPANY-CD PIC  X.
   177             20  WS-ERRESC-CARRIER    PIC  X.
   178             20  WS-ERRESC-GROUP      PIC X(6).
   179             20  WS-ERRESC-STATE      PIC XX.
   180             20  WS-ERRESC-ACCOUNT    PIC X(10).
   181         16 WS-ERRESC-RESIDUAL-KEY.
   182             20  WS-ERRESC-AGENT      PIC X(10).
   183             20  WS-ERRESC-RES-STATE  PIC XX.
   184             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   185*                                          YYYYMMDD
   186     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   187     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   188
   189*RESIDENT STATE TAX MASTER(ERRESS)
   190*
   191     12  WS-ERRESS-KEY.
   192         16  WS-ERRESS-COMPANY-CD      PIC  X.
   193         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   194         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   195         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   196*                                          YYYYMMDD
   197
   198     12  WS-CONTRACT-DATE              PIC 9(8).
   199*                                          YYYYMMDD
   200     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   201     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   202         16 WS-YEAR-YY                 PIC   9999.
   203         16 FILLER                     PIC 9(4).
   204*                                          YYYYMMDD
   205     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   206     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   207     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   208     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   209
   210     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   211         88  DPRB-1ST-TIME                      VALUE ' '.
   212
   213*****************************************************************
   214*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   215*****************************************************************
   216
   217     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   218     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   219     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   221     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   223     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   224     12  ws-st-agent-sig-edit    pic x          value spaces.
   225     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   226     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   227     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   229         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   230         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   231     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   232         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   233         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   6
* EL050.cbl
   234     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   235
   236     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   237     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   238
   239     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   240     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   253     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   254     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   275     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   276     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   277     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   278     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   287     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   288     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   289     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   290     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   291     12  WS-2671-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   7
* EL050.cbl
   292     12  WS-2672-SW               PIC X         VALUE SPACE.
   293     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   294         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   295     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   296         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   297     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   298
   299     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   300         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   301         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   302         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   303         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   304
   305     12  WS-CREDIT-EDIT-CONTROLS.
   306         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   307         16  WS-MIN-AGE           PIC 99                VALUE  0.
   308         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   309         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   310         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   311         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   312
   313     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   314     12  WS-AGE-FIELDS.
   315         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   316         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   317         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   318         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   319
   320     12  WS-SAVE-ALLOWABLE-BENEFIT.
   321         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   322         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   323         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   324         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   325         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   326         16  FILLER                      PIC XX.
   327
   328     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   329     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   330     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   331     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   332     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   333     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   334     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   335     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   336     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   337     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   338
   339     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   340     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   341     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   342     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   343     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   344     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   345     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   346     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   347         88  WS-REDUCING              VALUE 'R'.
   348         88  WS-LEVEL                 VALUE 'L' 'P'.
   349     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   8
* EL050.cbl
   350
   351     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   352     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   353     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   354     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   355     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   356     12  ws-ah-max-bens           pic 99        value zeros.
   357     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   358     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   359     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   360     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   361
   362     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   364     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   365     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   366     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   367     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   368     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   370     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   371     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   372     12  WS-ACCT-SIG-SW.
   373         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   374         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   375     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   376     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   377     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   382     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-INITIALS.
   385         16  WS-INIT-1            PIC X         VALUE SPACES.
   386         16  WS-INIT-2            PIC X         VALUE SPACES.
   387
   388     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   389     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   390     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   391     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   392     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   393*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   394     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   401     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   402     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   404     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   405     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   406     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   407     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page   9
* EL050.cbl
   408     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416******** FLA
   417     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   418     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   421     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   422********
   423     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   424     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   425     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   426     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   427     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   428     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   429     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   430     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   431     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   432     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   433
   434     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   435         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   436                                         '0' THRU '9'.
   437
   438     12  NUMBER-OF-MONTHS.
   439         16  SK-MO OCCURS 12 TIMES PIC X.
   440
   441     12  WS-WORK-DATE.
   442         16  WS-YEAR            PIC 99    VALUE 00.
   443         16  WS-MONTH           PIC 99    VALUE 00.
   444         16  WS-DAY             PIC 99    VALUE 00.
   445
   446     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   447     12  WS-WORK-CRIT-DEV       REDEFINES
   448         WS-WORK-LF-CRIT-PER    PIC X(03).
   449
   450     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   451     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   452
   453     12  WS-WORK-DATE-FROM.
   454         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   455         16  FILLER             PIC X  VALUE SPACE.
   456         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   457         16  FILLER             PIC X         VALUE SPACE.
   458         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   459
   460     12  WS-WORK-DATE-THRU.
   461         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X         VALUE SPACE.
   463         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  10
* EL050.cbl
   466
   467     12  WS-LF-INPUT-CD.
   468         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   469         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   470
   471     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   472     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   473         16  WS-AH-INPUT-CD-1   PIC X.
   474         16  WS-AH-INPUT-CD-2-3 PIC XX.
   475
   476     12  WS-SWITCHES.
   477         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   478         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   479             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   480         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   481             88  BANK-ACCT-FOUND          VALUE 'Y'.
   482         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   484         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   486         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   487             88  COMP-MASTER-FOUND        VALUE 'Y'.
   488         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   489             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   490         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   491             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   492         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   493             88  STAT-MASTER-FOUND        VALUE 'Y'.
   494         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   495             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   496         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   497             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   498         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   499             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   500         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   501             88  FORM-MASTER-FOUND        VALUE 'Y'.
   502         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   503             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   504         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   505             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   506         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   507             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   508         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   509             88  NO-BENEFIT-FOUND         VALUE 'N'.
   510         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   511             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   512         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   513             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   514         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  AH-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   517         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  LF-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   520         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   521             88  NO-STATE-RECORD          VALUE '1'.
   522         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   523             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  11
* EL050.cbl
   524         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   525             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   526         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   527             88  CERT-WAS-FOUND           VALUE ' '.
   528             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   529         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   530             88  BROWSE-STARTED           VALUE 'Y'.
   531         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   532             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   533         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   534             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   535         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   536             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   537         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   538             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   539         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   540             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   541         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   542             88  APP-CERT-USED            VALUE 'Y' 'A'.
   543         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   544             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   545             88  FIRST-TIME-THROUGH       VALUE '1'.
   546             88  CTBL-NOT-FOUND           VALUE '2'.
   547
   548         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   549             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   550
   551         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   552             88  DLO-ERROR-FOUND          VALUE 'Y'.
   553
   554********FLA
   555     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   556     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   557********
   558     12  RC-SW-1                  PIC X           VALUE '0'.
   559     12  RC-SW-2                  PIC X           VALUE '0'.
   560     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   561     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   562     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   570     12  LIT-SPACES               PIC X           VALUE SPACES.
   571     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   572     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   573     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   574     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   575     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   576     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   577     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   578         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   579         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   580     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   581         88  SKIP-ADDR-EDIT         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  12
* EL050.cbl
   582
   583 01  WS-EXTRA-PERIODS-BY-STATE.
   584     12  WS-INT-PERIODS          PIC 9.
   585     12  WS-EXTRA-PMTS           PIC 9.
   586 01  ws-net-only-state           pic x value 'N'.
   587 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   588     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   589     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   590 01  WS-CRI-SSN-WORK-AREA.
   591     05  WS-CRI-SOC-SEC-NO.
   592         10  WS-SS-REPT-CD       PIC X(5).
   593         10  WS-SS-LAST-NAME     PIC X(5).
   594         10  WS-SS-INITIAL       PIC X.
   595
   596     05  WS-CRI-REPORT-CODE.
   597         10  FILLER              PIC X(5).
   598         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   599
   600     05  WS-CRI-LAST-NAME.
   601         10  WS-CRI-NAME-MOVE    PIC X(5).
   602         10  FILLER              PIC X(10).
   603
   604 01  WS-NUM-TABLE                PIC X(26)  VALUE
   605     '12345678012345070923456789'.
   606 01  FILLER REDEFINES WS-NUM-TABLE.
   607     05  WS-NUM OCCURS 26        PIC 9.
   608 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   609 01  V1                          PIC S999 COMP-3.
   610 01  V2                          PIC S999 COMP-3.
   611 01  V3                          PIC S999 COMP-3.
   612 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   613 01  FILLER REDEFINES WS-WORK-VIN.
   614     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   615 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   616 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   617 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   618 01  WS-HEX-WORK.
   619     05  FILLER                  PIC X  VALUE LOW-VALUES.
   620     05  WS-HEX-BYTE             PIC X.
   621 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   622 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   623 01  WS-WORK-HIN-ROW-B.
   624     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   625
   626 01  ws-benefit-cd-chg-sw      pic x value spaces.
   627     88  benefit-code-chg           value 'Y'.
   628 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   629 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   630     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   631 01  WS-ROW-D-TABLE.
   632     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   633
   634 01  WS-HIN-TABLE-B.
   635     05  F                       PIC XX VALUE 'A2'.
   636     05  F                       PIC XX VALUE 'B3'.
   637     05  F                       PIC XX VALUE 'C4'.
   638     05  F                       PIC XX VALUE 'D5'.
   639     05  F                       PIC XX VALUE 'E6'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  13
* EL050.cbl
   640     05  F                       PIC XX VALUE 'F7'.
   641     05  F                       PIC XX VALUE 'G8'.
   642     05  F                       PIC XX VALUE 'H9'.
   643     05  F                       PIC XX VALUE 'I1'.
   644     05  F                       PIC XX VALUE 'J2'.
   645     05  F                       PIC XX VALUE 'K3'.
   646     05  F                       PIC XX VALUE 'L4'.
   647     05  F                       PIC XX VALUE 'M5'.
   648     05  F                       PIC XX VALUE 'N6'.
   649     05  F                       PIC XX VALUE 'O0'.
   650     05  F                       PIC XX VALUE 'P7'.
   651     05  F                       PIC XX VALUE 'Q0'.
   652     05  F                       PIC XX VALUE 'R8'.
   653     05  F                       PIC XX VALUE 'S9'.
   654     05  F                       PIC XX VALUE 'T2'.
   655     05  F                       PIC XX VALUE 'U3'.
   656     05  F                       PIC XX VALUE 'V4'.
   657     05  F                       PIC XX VALUE 'W5'.
   658     05  F                       PIC XX VALUE 'X6'.
   659     05  F                       PIC XX VALUE 'Y7'.
   660     05  F                       PIC XX VALUE 'Z8'.
   661 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   662     05  WS-VAL-IN               PIC X.
   663     05  WS-VAL-OUT              PIC 9.
   664 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   665 01  WS-COMPARE-BINARY-DATES.
   666     05  WS-971231                PIC XX VALUE X'92FF'.
   667     05  WS-931231                PIC XX VALUE X'8CFF'.
   668     05  WS-791231                PIC XX VALUE X'77FF'.
   669     05  WS-771001                PIC XX VALUE X'74A1'.
   670     05  WS-820301                PIC XX VALUE X'7B41'.
   671     05  WS-831031                PIC XX VALUE X'7DBF'.
   672     05  WS-831231                PIC XX VALUE X'7DFF'.
   673     05  WS-810831                PIC XX VALUE X'7A7F'.
   674     05  WS-830901                PIC XX VALUE X'7D81'.
   675
   676 01  FILE-ACCESS-IDS.
   677     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   678     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   679     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   680     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   681     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   682     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   683     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   684     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   685     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   686     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   687     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   688     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   689     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   690     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   691     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   692     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   693     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   694 01  DD-IU-SW                    PIC X   VALUE ' '.
   695     88  DD-IU-PRESENT                 VALUE 'Y'.
   696
   697 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  14
* EL050.cbl
   698     12  ELMSTR-KEY.
   699         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   701     12  W-CLAIM-KEY.
   702         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   704
   705     12  ELCNTL-KEY.
   706         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   707         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   708         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   709         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   710
   711     12  ELCERT-KEY.
   712         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   713         16  CERT-CARRIER         PIC X       VALUE SPACE.
   714         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   715         16  CERT-STATE           PIC XX      VALUE SPACES.
   716         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   717         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   718         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   719
   720     12  ELCERT2-KEY.
   721         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   722         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   723
   724     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   725
   726     12  ELCERT-SAVE.
   727         16  FILLER                      PIC XX    VALUE SPACES.
   728
   729         16  WCS-CONTROL-PRIMARY.
   730             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   731             20  WCS-CARRIER             PIC X     VALUE SPACE.
   732             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   733             20  WCS-STATE               PIC XX    VALUE SPACES.
   734             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   735             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   736             20  WCS-CERT-NO.
   737                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   738                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   739
   740         16  CS-CONTROL-BY-NAME.
   741             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   742             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   743             20  CS-INSURED-INITIALS.
   744                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   745                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   746
   747         16  CS-CONTROL-BY-SSN.
   748             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   749             20  CS-SOC-SEC-NO.
   750                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   751                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   752                 24  CS-SSN-LN3.
   753                     28 CS-INSURED-INITIALS-A2   PIC XX
   754                                     VALUE SPACES.
   755                     28 CS-PART-LAST-NAME-A2     PIC X
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  15
* EL050.cbl
   756                                     VALUE SPACE.
   757
   758         16  CS-CONTROL-BY-CERT-NO.
   759             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   760             20  CS-CERT-NO-A4           PIC X(11)
   761                                     VALUE SPACES.
   762
   763         16  CS-CONTROL-BY-MEMB.
   764             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   765             20  CS-MEMBER-NO.
   766                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   767                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   768                 24  CS-MEMB-LN4.
   769                     28 CS-INSURED-INITIALS-A5   PIC XX
   770                                      VALUE SPACES.
   771                     28 CS-PART-LAST-NAME-A5     PIC XX
   772                                      VALUE SPACES.
   773
   774         16  FILLER              PIC X(360) VALUE SPACES.
   775
   776     12  ERACCT-KEY.
   777         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   778         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   779         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   780         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   781         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   782         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   783
   784     12  ERCOMP-KEY.
   785         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  COMP-CARRIER         PIC X     VALUE SPACES.
   787         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   788         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   789         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   790         16  COMP-TYPE            PIC X     VALUE SPACES.
   791
   792     12  ERLOFC-KEY.
   793         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   794         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   795         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   796         16  LOFC-STATE           PIC XX    VALUE SPACES.
   797         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   798         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   799
   800     12  WS-ELCRTT-KEY.
   801         16  WS-ELCRTT-PRIMARY       PIC X(33).
   802         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   803
   804     12  ERBXRF-KEY.
   805         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   807         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   808         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   809
   810     12  ERAGTC-KEY.
   811         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   812         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   813         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  16
* EL050.cbl
   814         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   815         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   816         16  AGTC-TYPE            PIC X     VALUE SPACES.
   817
   818     12  ERPLAN-KEY.
   819         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   821         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   822         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   823         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   824         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   825         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   826         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   827
   828     12  ERFORM-KEY.
   829         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   830         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   831         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   832         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   833
   834     12  ERREIN-KEY.
   835         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   836         16  REIN-TYPE            PIC X     VALUE SPACES.
   837         16  REIN-TABLE-CO.
   838             20  REIN-CODE-1      PIC X     VALUE SPACE.
   839             20  REIN-CODE-2      PIC X     VALUE SPACE.
   840             20  REIN-CODE-3      PIC X     VALUE SPACE.
   841         16  FILLER               PIC X(3)  VALUE SPACES.
   842
   843     12  ERCTBL-KEY.
   844         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   845         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   846         16  CTBL-CNTRL-2.
   847             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   848             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   849
   850     12  ELCRTO-KEY.
   851         16  ELCRTO-COMPANY-CD       PIC X.
   852         16  ELCRTO-CARRIER          PIC X.
   853         16  ELCRTO-GROUPING         PIC X(6).
   854         16  ELCRTO-STATE            PIC XX.
   855         16  ELCRTO-ACCOUNT          PIC X(10).
   856         16  ELCRTO-CERT-EFF-DT      PIC XX.
   857         16  ELCRTO-CERT-NO.
   858             20  ELCRTO-CERT-PRIME   PIC X(10).
   859             20  ELCRTO-CERT-SFX     PIC X.
   860         16  ELCRTO-RECORD-TYPE      PIC X.
   861         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   862
   863
   864     12  WS-ACCESS.
   865         16  FILLER               PIC XX    VALUE SPACES.
   866         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   867
   868     12  WS-CARR-ACCESS.
   869         16  FILLER               PIC X(3)  VALUE SPACES.
   870         16  WS-CARR              PIC X     VALUE SPACE.
   871*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  17
* EL050.cbl
   872*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   873     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   874         88  WS-DMD-LF-RATING   VALUE 'Y'.
   875         88  WS-DMD-AH-RATING   VALUE 'Y'.
   876         88  WS-DMD-NO-RATING   VALUE 'N'.
   877
   878     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   879         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   880                                         'NJ' 'NL'
   881                                         'PJ' 'PL'
   882                                         'SJ' 'SL'.
   883     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   884         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   885                                         'NI' 'NJ' 'NL' 'NU'
   886                                         'PJ' 'PL' 'PI' 'PU'
   887                                         'SI' 'SJ' 'SL' 'SU'
   888                                         'MX' 'MY' 'MZ'.
   889 01  ERPDEF-KEY-SAVE             PIC X(18).
   890 01  ERPDEF-KEY.
   891     12  ERPDEF-COMPANY-CD       PIC X.
   892     12  ERPDEF-STATE            PIC XX.
   893     12  ERPDEF-PROD-CD          PIC XXX.
   894     12  F                       PIC X(7).
   895     12  ERPDEF-BEN-TYPE         PIC X.
   896     12  ERPDEF-BEN-CODE         PIC XX.
   897     12  ERPDEF-EXP-DT           PIC XX.
   898
   899 01  ELSTAT-KEY-SAVE             PIC X(20).
   900 01  ELSTAT-KEY.
   901     12  ELSTAT-COMPANY-ID       PIC XXX.
   902     12  ELSTAT-CARRIER          PIC X.
   903     12  ELSTAT-GROUP            PIC X(6).
   904     12  ELSTAT-STATE            PIC XX.
   905     12  ELSTAT-EXP-DT           PIC 9(8).
   906 01  WS-ERROR-VALUES.
   907     12  ER-1570                     PIC S9(4)   VALUE +1570.
   908     12  ER-1571                     PIC S9(4)   VALUE +1571.
   909     12  er-1572                     pic s9(4)   value +1572.
   910     12  er-1573                     pic s9(4)   value +1573.
   911     12  er-1574                     pic s9(4)   value +1574.
   912     12  ER-1575                     PIC S9(4)   VALUE +1575.
   913     12  er-1576                     pic s9(4)   value +1576.
   914     12  er-1583                     pic s9(4)   value +1583.
   915     12  er-1743                     pic s9(4)   value +1743.
   916     12  er-1744                     pic s9(4)   value +1744.
   917     12  er-1745                     pic s9(4)   value +1745.
   918     12  er-1746                     pic s9(4)   value +1746.
   919     12  er-1747                     pic s9(4)   value +1747.
   920     12  er-1748                     pic s9(4)   value +1748.
   921     12  ER-1891                     PIC S9(4)   VALUE +1891.
   922     12  ER-1892                     PIC S9(4)   VALUE +1892.
   923     12  ER-1893                     PIC S9(4)   VALUE +1893.
   924     12  ER-1894                     PIC S9(4)   VALUE +1894.
   925     12  ER-1895                     PIC S9(4)   VALUE +1895.
   926     12  ER-1896                     PIC S9(4)   VALUE +1896.
   927     12  ER-1897                     PIC S9(4)   VALUE +1897.
   928     12  ER-1898                     PIC S9(4)   VALUE +1898.
   929     12  ER-1899                     PIC S9(4)   VALUE +1899.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  18
* EL050.cbl
   930     12  ER-1900                     PIC S9(4)   VALUE +1900.
   931     12  ER-1901                     PIC S9(4)   VALUE +1901.
   932     12  ER-1902                     PIC S9(4)   VALUE +1902.
   933     12  ER-1903                     PIC S9(4)   VALUE +1903.
   934     12  ER-1904                     PIC S9(4)   VALUE +1904.
   935     12  ER-1905                     PIC S9(4)   VALUE +1905.
   936     12  ER-1906                     PIC S9(4)   VALUE +1906.
   937     12  ER-1907                     PIC S9(4)   VALUE +1907.
   938     12  ER-1909                     PIC S9(4)   VALUE +1909.
   939     12  ER-1910                     PIC S9(4)   VALUE +1910.
   940     12  ER-1911                     PIC S9(4)   VALUE +1911.
   941     12  ER-1912                     PIC S9(4)   VALUE +1912.
   942     12  ER-1913                     PIC S9(4)   VALUE +1913.
   943     12  ER-1914                     PIC S9(4)   VALUE +1914.
   944     12  ER-1915                     PIC S9(4)   VALUE +1915.
   945     12  ER-1916                     PIC S9(4)   VALUE +1916.
   946     12  ER-1917                     PIC S9(4)   VALUE +1917.
   947     12  ER-1918                     PIC S9(4)   VALUE +1918.
   948     12  ER-1919                     PIC S9(4)   VALUE +1919.
   949     12  ER-1920                     PIC S9(4)   VALUE +1920.
   950     12  ER-1921                     PIC S9(4)   VALUE +1921.
   951     12  ER-1922                     PIC S9(4)   VALUE +1922.
   952     12  ER-1923                     PIC S9(4)   VALUE +1923.
   953     12  ER-1924                     PIC S9(4)   VALUE +1924.
   954     12  ER-1925                     PIC S9(4)   VALUE +1925.
   955     12  ER-1926                     PIC S9(4)   VALUE +1926.
   956     12  ER-1927                     PIC S9(4)   VALUE +1927.
   957     12  ER-2393                     PIC S9(4)   VALUE +2393.
   958     12  ER-2600                     PIC S9(4)   VALUE +2600.
   959     12  ER-2601                     PIC S9(4)   VALUE +2601.
   960     12  ER-2602                     PIC S9(4)   VALUE +2602.
   961     12  ER-2603                     PIC S9(4)   VALUE +2603.
   962     12  ER-2604                     PIC S9(4)   VALUE +2604.
   963     12  ER-2605                     PIC S9(4)   VALUE +2605.
   964     12  ER-2606                     PIC S9(4)   VALUE +2606.
   965     12  ER-2607                     PIC S9(4)   VALUE +2607.
   966     12  ER-2608                     PIC S9(4)   VALUE +2608.
   967     12  ER-2609                     PIC S9(4)   VALUE +2609.
   968     12  ER-2610                     PIC S9(4)   VALUE +2610.
   969     12  ER-2611                     PIC S9(4)   VALUE +2611.
   970     12  ER-2612                     PIC S9(4)   VALUE +2612.
   971     12  ER-2613                     PIC S9(4)   VALUE +2613.
   972     12  ER-2614                     PIC S9(4)   VALUE +2614.
   973     12  ER-2615                     PIC S9(4)   VALUE +2615.
   974     12  ER-2616                     PIC S9(4)   VALUE +2616.
   975     12  ER-2617                     PIC S9(4)   VALUE +2617.
   976     12  ER-2618                     PIC S9(4)   VALUE +2618.
   977     12  ER-2619                     PIC S9(4)   VALUE +2619.
   978     12  ER-2620                     PIC S9(4)   VALUE +2620.
   979     12  ER-2621                     PIC S9(4)   VALUE +2621.
   980     12  ER-2622                     PIC S9(4)   VALUE +2622.
   981     12  ER-2623                     PIC S9(4)   VALUE +2623.
   982     12  ER-2624                     PIC S9(4)   VALUE +2624.
   983     12  ER-2625                     PIC S9(4)   VALUE +2625.
   984     12  ER-2626                     PIC S9(4)   VALUE +2626.
   985     12  ER-2627                     PIC S9(4)   VALUE +2627.
   986     12  ER-2628                     PIC S9(4)   VALUE +2628.
   987     12  ER-2629                     PIC S9(4)   VALUE +2629.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  19
* EL050.cbl
   988     12  ER-2630                     PIC S9(4)   VALUE +2630.
   989     12  ER-2631                     PIC S9(4)   VALUE +2631.
   990     12  ER-2632                     PIC S9(4)   VALUE +2632.
   991     12  ER-2633                     PIC S9(4)   VALUE +2633.
   992     12  ER-2634                     PIC S9(4)   VALUE +2634.
   993     12  ER-2635                     PIC S9(4)   VALUE +2635.
   994     12  ER-2636                     PIC S9(4)   VALUE +2636.
   995     12  ER-2637                     PIC S9(4)   VALUE +2637.
   996     12  ER-2638                     PIC S9(4)   VALUE +2638.
   997     12  ER-2639                     PIC S9(4)   VALUE +2639.
   998     12  ER-2640                     PIC S9(4)   VALUE +2640.
   999     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1000     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1001     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1002     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1003     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1004     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1005     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1006     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1007     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1008     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1009     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1010     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1011     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1012     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1013     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1014     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1015     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1016     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1017     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1018     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1019     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1020     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1021     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1022     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1023     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1024     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1025     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1026     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1027     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1028     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1029     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1030     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1031     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1032     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1033     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1034     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1035     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1036     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1037     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1038     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1039     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1040     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1041     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1042     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1043     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1044     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1045     12  ER-2687                     PIC S9(4)   VALUE +2687.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  20
* EL050.cbl
  1046     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1047     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1048     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1049     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1050     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1051     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1052     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1053     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1054     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1055     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1056     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1057     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1058     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1059     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1060     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1061     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1062     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1063     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1064     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1065     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1066     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1067     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1068     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1069     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1070     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1071     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1072     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1073     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1074     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1075     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1076     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1077     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1078     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1079     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1080     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1081     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1082     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1083     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1084     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1085     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1086     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1087     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1088     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1089     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1090     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1091     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1092     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1093     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1094     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1095     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1096     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1097     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1098     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1099     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1100     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1101     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1102     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1103     12  ER-2755                     PIC S9(4)   VALUE +2755.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  21
* EL050.cbl
  1104     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1105     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1106     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1107     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1108     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1109     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1110     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1111     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1112     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1113     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1114     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1115     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1116     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1117     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1118     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1119     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1120     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1121     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1122     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1123     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1124     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1125     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1126     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1127     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1128     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1129     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1130     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1131     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1132     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1133     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1134     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1135     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1136     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1137     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1138     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1139     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1140     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1141     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1142     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1143     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1144     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1145     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1146     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1147     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1148     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1149     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1150     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1151     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1152     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1153     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1154     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1155     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1156     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1157     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1158     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1159     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1160     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1161     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  22
* EL050.cbl
  1162     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1163     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1164     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1165     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1166     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1167     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1168     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1169     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1170     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1171     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1172     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1173     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1174     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1175     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1176     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1177     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1178     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1179     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1180     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1181     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1182     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1183     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1184     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1185     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1186     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1187     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1188     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1189     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1190     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1191     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1192     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1193     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1194     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1195     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1196     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1197     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1198     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1199     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1200     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1201     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1202     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1203     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1204     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1205     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1206     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1207     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1208     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1209     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1210     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1211     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1212     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1213     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1214     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1215     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1216     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1217     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1218     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1219     12  ER-8082                     PIC S9(4)   VALUE +8082.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  23
* EL050.cbl
  1220     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1221     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1222     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1223     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1224     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1225     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1226     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1227     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1228     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1229     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1230     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1231     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1232     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1233     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1234     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1235     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1236     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1237     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1238     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1239     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1240     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1241     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1242     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1243     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1244     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1245     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1246     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1247     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1248     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1249     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1250     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1251     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1252     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1253     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1254     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1255     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1256     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1257     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1258     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1259     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1260     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1261     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1262     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1263     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1264     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1265******************************************************************
  1266***************   END OF ELC50WS     ****************************
  1267******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  24
* EL050.cbl
  1270 01  WORKING-STORAGE-WORK-AREAS.
  1271     12  WS-RESPONSE             PIC S9(8)  COMP.
  1272         88  WS-RESP-NORMAL           VALUE +00.
  1273         88  WS-RESP-ERROR            VALUE +01.
  1274         88  WS-RESP-NOTFND           VALUE +13.
  1275         88  WS-RESP-DUPREC           VALUE +14.
  1276         88  WS-RESP-ENDFILE          VALUE +20.
  1277     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1278     12  WORK-AREAS.
  1279         16  WK-CONV-GREG.
  1280             24  WCG-CENT             PIC XX.
  1281             24  WCG-REST             PIC X(4).
  1282         16  WORK-GREGORIAN-DATE.
  1283             24  WK-GREG-CENT         PIC XX.
  1284             24  WK-GREG-DATE-YYMMDD.
  1285                 28  WK-GREG-YYMM     PIC X(4).
  1286                 28  WK-GREG-DD       PIC XX.
  1287
  1288         16  WORK-SELECT-DATE.
  1289             24  WK-SELECT-CENT            PIC XX.
  1290             24  WK-SELECT-DATE-YYMMDD.
  1291                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1292                 28  FILLER                PIC XX.
  1293
  1294         16  WK-FORM-NO.
  1295             24  WK-FORM-BANK-ID       PIC X(5).
  1296             24  WK-FORM-UNDRWRTR      PIC X(1).
  1297             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1298
  1299         16  WK-MEMBER-NO.
  1300             24  WK-MEMBER-1-6        PIC X(6).
  1301             24  WK-MEMBER-7-12       PIC X(6).
  1302
  1303         16  WK-FULL-CERT-NO.
  1304             24  WK-CERT-POS-1-2      PIC X(2).
  1305             24  WK-CERT-POS-3        PIC X(1).
  1306             24  WK-CERT-POS-4        PIC X(1).
  1307             24  WK-CERT-POS-5-6      PIC X(2).
  1308             24  WK-CERT-POS-7        PIC X(1).
  1309             24  WK-CERT-POS-8-11     PIC X(4).
  1310
  1311         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1312             88  VALID-RATE-CODE        VALUE 'Y'.
  1313             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1314
  1315         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1316         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1317         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1318         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1319         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1320         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1321         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1322         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1323         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1324         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1325
  1326* DLO001
  1327 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  25
* EL050.cbl
  1328     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1329     12  DMPF-RETURN-CODE          PIC XX.
  1330         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1331         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1332         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1333         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1334         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1335         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1336
  1337* DLO002
  1338 01  WS-DLO-INTERNAL-POLICY-FORM.
  1339     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1340     12  DIPF-RETURN-CODE          PIC XX.
  1341         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1342         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1343         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1344         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1345         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1346         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1347
  1348* DLO003
  1349 01  WS-DLO-VALID-BANK-ID.
  1350     12  DVBI-BANK-ID              PIC X(5).
  1351     12  DVBI-BANK-ID-TYPE         PIC X.
  1352         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1353         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1354         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1355         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1356         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1357     12  DVBI-RETURN-CODE          PIC XX.
  1358         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1359         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1360         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1361         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1362         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1363         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1364         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1365         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1366         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO007
  1369 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1370     12  DCUA-RES-STATE            PIC XX.
  1371     12  DCUA-BEN-TYPE             PIC XX.
  1372     12  DCUA-SYS-IDENT            PIC X.
  1373         88  DCUA-CLAIM                        VALUE 'C'.
  1374         88  DCUA-PREMIUM                      VALUE 'P'.
  1375     12  DCUA-COVERAGE-RULE        PIC X.
  1376     12  DCUA-CLIENT-ID            PIC X(10).
  1377     12  DCUA-EFF-DATE             PIC X(8).
  1378     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1379     12  DCUA-RETURN-CODE          PIC XX.
  1380         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1381     12  DCUA-CERT-NUMBER          PIC X(11).
  1382     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1383     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1384
  1385* DLO011
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  26
* EL050.cbl
  1386 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1387     12  DPRB-RATE-CODE            PIC X(4).
  1388     12  DPRB-COVERAGE-CATEG       PIC X.
  1389     12  DPRB-RETURN-CODE          PIC XX.
  1390         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1391         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1392         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1393         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1394         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1395         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1396         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1397         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1398         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1399     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1400     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1401     12  DPRB-BEN-TYPE             PIC XX.
  1402
  1403* DLO017
  1404 01  WS-DLO-VALID-RATE-CODE.
  1405     12  DVRC-RATE-CODE            PIC X(4).
  1406     12  DVRC-RETURN-CODE          PIC XX.
  1407         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1409         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1410         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1411         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1412         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1413
  1414* DLO019
  1415 01  WS-DLO-ORIG-COV-CAT.
  1416     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1417     12  DOCC-RETURN-CODE          PIC XX.
  1418     12  DOCC-ORIG-COV-CAT         PIC X.
  1419     12  DOCC-UNDERWITER           PIC XX.
  1420     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1421     12  DOCC-FILLER               PIC X(6).
  1422
  1423* DLO021
  1424 01  WS-DLO-VALID-LOAN-OFFICER.
  1425     12  DVLO-LOAN-OFFICER.
  1426         16  DVLO-BILL-TYPE        PIC X.
  1427         16  DVLO-BILL-SOURCE      PIC X.
  1428         16  DVLO-BATCH-TYPE       PIC X.
  1429     12  DVLO-RETURN-CODE          PIC XX.
  1430         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1431         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1432         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1433         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1434         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1435         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1436
  1437* DLO022
  1438 01  WS-DLO-VALID-STATE-CODE.
  1439     12  DVSC-STATE-CODE           PIC XX.
  1440     12  DVSC-RETURN-CODE          PIC XX.
  1441         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1442
  1443* DLO023
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  27
* EL050.cbl
  1444 01  WS-DLO-VALID-CODE-VALUES.
  1445     12  DVCV-SYSTEM-ID            PIC XX.
  1446         88  DVCV-CLAIMS                       VALUE 'CL'.
  1447         88  DVCV-CREDIT                       VALUE 'CR'.
  1448     12  DVCV-RECORD-TYPE          PIC XX.
  1449         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1450         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1451         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1452         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1453         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1454         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1455         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1456         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1457     12  DVCV-RECORD-KEY           PIC X(6).
  1458     12  DVCV-RETURN-CODE          PIC XX.
  1459         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1460         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1461         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1462         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1463         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1464         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1465         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1466     12  DVCV-CODE-DESC            PIC X(60).
  1467     12  DVCV-GEN-DESC-1           PIC X(20).
  1468     12  DVCV-GEN-DESC-2           PIC X(20).
  1469     12  DVCV-GEN-DESC-3           PIC X(20).
  1470
  1471****  this is for aggregate report.
  1472****  Length is erpndb + 100 of passed-key-area
  1473 01  ws-passed-key-length        pic s9(4) comp value +587.
  1474 01  ws-pass-to-pemaggo.
  1475     05  ws-passed-erpndb        pic x(585).
  1476     05  ws-exceed-limit-yn      pic x.
  1477     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  28
* EL050.cbl
  1479*    COPY ERCBXRF.
  1480******************************************************************
  1481*                                                                *
  1482*                                                                *
  1483*                            ERCBXRF                             *
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499
  1500 01  BANK-CROSS-REFERENCE.
  1501     12  BK-RECORD-ID                PIC XX.
  1502         88  VALID-BK-ID             VALUE 'BK'.
  1503
  1504     12  BK-CONTROL-PRIMARY.
  1505         16  BK-COMPANY-CD           PIC X.
  1506         16  BK-CARRIER              PIC X.
  1507         16  BK-GROUPING             PIC X(6).
  1508         16  BK-BANK-NO              PIC X(10).
  1509
  1510     12  BK-MAINT-INFORMATION.
  1511         16  BK-LAST-MAINT-DT        PIC XX.
  1512         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1513         16  BK-LAST-MAINT-USER      PIC X(4).
  1514         16  FILLER                  PIC X(9).
  1515
  1516     12  FILLER                      PIC X(37).
  1517
  1518     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1519
  1520     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1521                            DEPENDING ON BK-BANK-POINTER-CNT.
  1522         16  BK-AM-ACCOUNT           PIC X(10).
  1523         16  BK-AM-EXP-DT            PIC XX.
  1524         16  BK-AM-EFF-DT            PIC XX.
  1525         16  BK-AM-STATE             PIC XX.
  1526         16  FILLER                  PIC X(20).
  1527
  1528******************************************************************
  1529
  1530*    COPY ERCCOMP.
  1531******************************************************************
  1532*                                                                *
  1533*                                                                *
  1534*                            ERCCOMP                             *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  29
* EL050.cbl
  1537*                                                                *
  1538*   ONLINE CREDIT SYSTEM                                         *
  1539*                                                                *
  1540*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1541*                                                                *
  1542*   FILE TYPE = VSAM,KSDS                                        *
  1543*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1544*                                                                *
  1545*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1546*       ALTERNATE PATH = NONE                                    *
  1547*                                                                *
  1548*   LOG = NO                                                     *
  1549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1550*                                                                *
  1551******************************************************************
  1552*                   C H A N G E   L O G
  1553*
  1554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1555*-----------------------------------------------------------------
  1556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1557* EFFECTIVE    NUMBER
  1558*-----------------------------------------------------------------
  1559* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1560* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1561* 092205    2005050300006  PEMA  ADD LEASE FEE
  1562* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1563* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1564* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1565* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1566* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1567* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1568******************************************************************
  1569
  1570 01  COMPENSATION-MASTER.
  1571     12  CO-RECORD-ID                          PIC XX.
  1572         88  VALID-CO-ID                          VALUE 'CO'.
  1573
  1574     12  CO-CONTROL-PRIMARY.
  1575         16  CO-COMPANY-CD                     PIC X.
  1576         16  CO-CONTROL.
  1577             20  CO-CTL-1.
  1578                 24  CO-CARR-GROUP.
  1579                     28  CO-CARRIER            PIC X.
  1580                     28  CO-GROUPING.
  1581                         32  CO-GROUP-PREFIX   PIC XXX.
  1582                         32  CO-GROUP-PRIME    PIC XXX.
  1583                 24  CO-RESP-NO.
  1584                     28  CO-RESP-PREFIX        PIC X(4).
  1585                     28  CO-RESP-PRIME         PIC X(6).
  1586             20  CO-CTL-2.
  1587                 24  CO-ACCOUNT.
  1588                     28  CO-ACCT-PREFIX        PIC X(4).
  1589                     28  CO-ACCT-PRIME         PIC X(6).
  1590         16  CO-TYPE                           PIC X.
  1591             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1592             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1593             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1594
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  30
* EL050.cbl
  1595     12  CO-MAINT-INFORMATION.
  1596         16  CO-LAST-MAINT-DT                  PIC XX.
  1597         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1598         16  CO-LAST-MAINT-USER                PIC X(4).
  1599     12  FILLER                                PIC XX.
  1600     12  CO-STMT-TYPE                          PIC XXX.
  1601     12  CO-COMP-TYPE                          PIC X.
  1602         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1603     12  CO-STMT-OWNER                         PIC X(4).
  1604     12  CO-BALANCE-CONTROL                    PIC X.
  1605         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1606         88  CO-NO-BALANCE                        VALUE 'N'.
  1607
  1608     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1609         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1610         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1611         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1612
  1613     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1614         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1615         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1616
  1617     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1618     12  CO-GA-DIRECT-DEP                      PIC X.
  1619     12  CO-FUTURE-SPACE                       PIC X.
  1620         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1621
  1622     12  CO-ACCT-NAME                          PIC X(30).
  1623     12  CO-MAIL-NAME                          PIC X(30).
  1624     12  CO-ADDR-1                             PIC X(30).
  1625     12  CO-ADDR-2                             PIC X(30).
  1626     12  CO-ADDR-3.
  1627         16  CO-ADDR-CITY                      PIC X(27).
  1628         16  CO-ADDR-STATE                     PIC XX.
  1629     12  CO-CSO-1099                           PIC X.
  1630     12  CO-ZIP.
  1631         16  CO-ZIP-PRIME.
  1632             20  CO-ZIP-PRI-1ST                PIC X.
  1633                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1634             20  FILLER                        PIC X(4).
  1635         16  CO-ZIP-PLUS4                      PIC X(4).
  1636     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1637         16  CO-CAN-POSTAL-1                   PIC XXX.
  1638         16  CO-CAN-POSTAL-2                   PIC XXX.
  1639         16  FILLER                            PIC XXX.
  1640     12  CO-SOC-SEC                            PIC X(13).
  1641     12  CO-TELEPHONE.
  1642         16  CO-AREA-CODE                      PIC XXX.
  1643         16  CO-PREFIX                         PIC XXX.
  1644         16  CO-PHONE                          PIC X(4).
  1645
  1646     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1647
  1648     12  CO-AR-BAL-LEVEL                       PIC X.
  1649         88  CO-AR-REF-LVL                        VALUE '1'.
  1650         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1651         88  CO-AR-BILL-LVL                       VALUE '2'.
  1652         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  31
* EL050.cbl
  1653         88  CO-AR-FR-LVL                         VALUE '4'.
  1654
  1655     12  CO-AR-NORMAL-PRINT                    PIC X.
  1656         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1657         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1658
  1659     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1660
  1661     12  CO-AR-REPORTING                       PIC X.
  1662         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1663         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1664
  1665     12  CO-AR-PULL-CHECK                      PIC X.
  1666         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1667         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1668
  1669     12  CO-AR-BALANCE-PRINT                   PIC X.
  1670         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1671
  1672     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1673         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1674         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1675         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1676
  1677     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1678
  1679     12  CO-USER-CODE                          PIC X.
  1680     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1681
  1682******************************************************************
  1683*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1684*    THE LAST MONTH END RUN.
  1685******************************************************************
  1686
  1687     12  CO-LAST-ACTIVITY-DATE.
  1688         16  CO-ACT-YEAR                       PIC 99.
  1689         16  CO-ACT-MONTH                      PIC 99.
  1690         16  CO-ACT-DAY                        PIC 99.
  1691
  1692     12  CO-LAST-STMT-DT.
  1693         16  CO-LAST-STMT-YEAR                 PIC 99.
  1694         16  CO-LAST-STMT-MONTH                PIC 99.
  1695         16  CO-LAST-STMT-DAY                  PIC 99.
  1696
  1697     12  CO-MO-END-TOTALS.
  1698         16  CO-MONTHLY-TOTALS.
  1699             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1700             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1701             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1702             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1703             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1704
  1705         16  CO-AGING-TOTALS.
  1706             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1707             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1708             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1709             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1710
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  32
* EL050.cbl
  1711         16  CO-YTD-TOTALS.
  1712             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1714
  1715         16  CO-OVER-UNDER-TOTALS.
  1716             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1717             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1718
  1719     12  CO-MISCELLANEOUS-TOTALS.
  1720         16  CO-FICA-TOTALS.
  1721             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1722             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1723
  1724         16  CO-CLAIM-TOTALS.
  1725             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1726             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1727
  1728******************************************************************
  1729*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1730*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1731******************************************************************
  1732
  1733     12  CO-CURRENT-TOTALS.
  1734         16  CO-CURRENT-LAST-STMT-DT.
  1735             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1736             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1737             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1738
  1739         16  CO-CURRENT-MONTHLY-TOTALS.
  1740             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1741             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1743             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1745
  1746         16  CO-CURRENT-AGING-TOTALS.
  1747             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1749             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1751
  1752         16  CO-CURRENT-YTD-TOTALS.
  1753             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1755
  1756     12  CO-PAID-COMM-TOTALS.
  1757         16  CO-YTD-PAID-COMMS.
  1758             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1759             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1760
  1761     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1762         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1763         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1764
  1765     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1766         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1767         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1768         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  33
* EL050.cbl
  1769         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1770         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1771         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1772         88  CO-FINAL-LETTER                  VALUE 'F'.
  1773         88  CO-RECONCILING                   VALUE 'R'.
  1774         88  CO-PHONE-CALL                    VALUE 'P'.
  1775         88  CO-LEGAL                         VALUE 'L'.
  1776         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1777         88  CO-WRITE-OFF                     VALUE 'W'.
  1778         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1779
  1780     12  CO-CSR-CODE                       PIC X(4).
  1781
  1782     12  CO-GA-STATUS-INFO.
  1783         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1784         16  CO-GA-TERMINATION-DT          PIC XX.
  1785         16  CO-GA-STATUS-CODE             PIC X.
  1786             88  CO-GA-ACTIVE                 VALUE 'A'.
  1787             88  CO-GA-INACTIVE               VALUE 'I'.
  1788             88  CO-GA-PENDING                VALUE 'P'.
  1789         16  CO-GA-COMMENTS.
  1790             20  CO-GA-COMMENT-1           PIC X(40).
  1791             20  CO-GA-COMMENT-2           PIC X(40).
  1792             20  CO-GA-COMMENT-3           PIC X(40).
  1793             20  CO-GA-COMMENT-4           PIC X(40).
  1794
  1795     12  CO-RPTCD2                         PIC X(10).
  1796     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1797         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1798         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1799
  1800     12  CO-TYPE-AGENT                     PIC X(01).
  1801         88  CO-CORPORATION                   VALUE 'C'.
  1802         88  CO-PARTNERSHIP                   VALUE 'P'.
  1803         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1804         88  CO-TRUST                         VALUE 'T'.
  1805         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1806
  1807     12  CO-FAXNO.
  1808         16  CO-FAX-AREA-CODE                  PIC XXX.
  1809         16  CO-FAX-PREFIX                     PIC XXX.
  1810         16  CO-FAX-PHONE                      PIC X(4).
  1811
  1812     12  CO-BANK-INFORMATION.
  1813         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1814         16  CO-BANK-TRANSIT-NON REDEFINES
  1815             CO-BANK-TRANSIT-NO                PIC 9(8).
  1816
  1817         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1818     12  CO-MISC-DEDUCT-INFO REDEFINES
  1819                  CO-BANK-INFORMATION.
  1820         16  CO-MD-GL-ACCT                     PIC X(10).
  1821         16  CO-MD-DIV                         PIC XX.
  1822         16  CO-MD-CENTER                      PIC X(4).
  1823         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1824         16  CO-CREATE-AP-CHECK                PIC X.
  1825         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1826         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  34
* EL050.cbl
  1827     12  CO-ACH-STATUS                         PIC X.
  1828         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1829         88  CO-ACH-PENDING                        VALUE 'P'.
  1830
  1831     12  CO-BILL-SW                            PIC X.
  1832     12  CO-CONTROL-NAME                       PIC X(30).
  1833     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1834     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1835     12  CO-CLP-STATE                          PIC XX.
  1836     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1837     12  CO-SPP-REFUND-EDIT                    PIC X.
  1838
  1839******************************************************************
  1840
  1841*    COPY ERCAGTC.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                            ERCAGTC                             *
  1846*                            VMOD=2.001                          *
  1847*                                                                *
  1848*   ONLINE CREDIT SYSTEM                                         *
  1849*                                                                *
  1850*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1851*                                                                *
  1852*   FILE TYPE = VSAM,KSDS                                        *
  1853*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1854*                                                                *
  1855*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1856*       ALTERNATE PATH = NONE                                    *
  1857*                                                                *
  1858*   LOG = NO                                                     *
  1859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1860*                                                                *
  1861******************************************************************
  1862*                   C H A N G E   L O G
  1863*
  1864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1865*-----------------------------------------------------------------
  1866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1867* EFFECTIVE    NUMBER
  1868*-----------------------------------------------------------------
  1869* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1870* 111004                         NEW FILE AND COPYBOOK
  1871* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1872******************************************************************
  1873 01  AGENT-COMMISSIONS.
  1874     12  AG-RECORD-ID                          PIC XX.
  1875         88  VALID-CO-ID                          VALUE 'AG'.
  1876     12  AG-CONTROL-PRIMARY.
  1877         16  AG-COMPANY-CD                     PIC X.
  1878         16  AG-CONTROL.
  1879             20  AG-CTL-1.
  1880                 24  AG-CARR-GROUP.
  1881                     28  AG-CARRIER            PIC X.
  1882                     28  AG-GROUPING           PIC X(6).
  1883                 24  AG-BANK                   PIC X(10).
  1884             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  35
* EL050.cbl
  1885                 24  AG-EXP-DT                 PIC XX.
  1886         16  AG-TYPE                           PIC X.
  1887             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1888             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1889     12  AG-MAINT-INFORMATION.
  1890         16  AG-LAST-MAINT-DT                  PIC XX.
  1891         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1892         16  AG-LAST-MAINT-USER                PIC X(4).
  1893         16  FILLER                            PIC X(10).
  1894     12  AG-EFF-DT                             PIC XX.
  1895     12  AG-COMM-STRUCTURE.
  1896         16  AG-AGT-COMMS OCCURS 10.
  1897             20  AG-AGT                PIC X(10).
  1898             20  AG-COM-TYP            PIC X.
  1899             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1900             20  AG-RECALC-LV-INDIC    PIC X.
  1901             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1902             20  AG-LRCALC-LV-INDIC    PIC X.
  1903             20  FILLER                PIC X(05).
  1904     12  FILLER                  PIC X(145).
  1905******************************************************************
  1906*    COPY ERCRESS.
  1907******************************************************************
  1908*                                                                *
  1909*                            ERCRESS                             *
  1910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1911*                            VMOD=2.002                          *
  1912*                                                                *
  1913*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1914*                                                                *
  1915*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1916*   VSAM RESIDENT STATE TAX MASTER                              *
  1917*                                                                *
  1918*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1919*                                                                *
  1920*   FILE TYPE = VSAM,KSDS                                        *
  1921*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1922*                                                                *
  1923*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1924*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1925*                                                                *
  1926*   LOG = NO                                                     *
  1927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1928*                                                                *
  1929*                                                                *
  1930******************************************************************
  1931
  1932 01  RESIDENT-STATE-TAX-MASTER.
  1933
  1934     10  ERRESS-PRIMARY-KEY.
  1935         15  RES-COMPANY-CD        PIC X.
  1936         15  RES-RESIDENT-STATE    PIC XX.
  1937         15  RES-COVERAGE-CATEGORY PIC X.
  1938         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1939*                                      YYYYMMDD
  1940*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1941
  1942     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  36
* EL050.cbl
  1943
  1944         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1945         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1946         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1947         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1948
  1949     10 RES-RECALC-SW              PIC   X.
  1950         88 RECALC                VALUE 'Y'.
  1951         88 NO-RECALC             VALUE 'N'.
  1952     10  RES-MAINT-BY              PIC X(4).
  1953     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1954     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1955*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  37
* EL050.cbl
  1957*    COPY ERCRESC.
  1958******************************************************************
  1959*                                                                *
  1960*                            ERCRESC                             *
  1961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1962*                            VMOD=2.003                          *
  1963*                                                                *
  1964*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1965*                                                                *
  1966*   FILE TYPE = VSAM,KSDS                                        *
  1967*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1968*                                                                *
  1969*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1970*       ALTERNATE PATH1 = NONE                                   *
  1971*                                                                *
  1972*   LOG = NO                                                     *
  1973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1978
  1979     10  ERRESC-RECORD-KEY.
  1980         15  RESC-COMPANY-CD           PIC   X.
  1981         15  RESC-CARRIER              PIC   X.
  1982         15  RESC-GROUP                PIC   X(6).
  1983         15  RESC-STATE                PIC   XX.
  1984         15  RESC-ACCOUNT              PIC   X(10).
  1985         15  RESC-AGENT                PIC   X(10).
  1986         15  RESC-RESIDENT-STATE       PIC   XX.
  1987         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1988*                                           YYYYMMDD
  1989     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1990
  1991     10  RESC-COMM-RECORD-DATA.
  1992         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1993             20 RESC-COVERAGE-CAT      PIC    X.
  1994             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1995             20 RESC-COMMISSION-TAB REDEFINES
  1996                RESC-COMMISSION-PER    PIC  XXX.
  1997
  1998     10  RESC-MAINT-BY                 PIC X(4).
  1999     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2000     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2001*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  38
* EL050.cbl
  2003*    COPY ERCPLAN.
  2004******************************************************************
  2005*                                                                *
  2006*                                                                *
  2007*                            ERCPLAN                             *
  2008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2009*                            VMOD=2.003                          *
  2010*                                                                *
  2011*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2012*                                                                *
  2013*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2014*   PLAN MASTER                                                  *
  2015*                                                                *
  2016*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2017*                                                                *
  2018*   FILE TYPE = VSAM,KSDS                                        *
  2019*   RECORD SIZE = 420   RECFORM = FIX                            *
  2020*                                                                *
  2021*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2022*       ALTERNATE PATH1 = N/A                                    *
  2023*                                                                *
  2024*   LOG = NO                                                     *
  2025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2026*                                                                *
  2027*                                                                *
  2028******************************************************************
  2029
  2030 01  PLAN-MASTER.
  2031     12  PL-RECORD-ID                      PIC XX.
  2032         88  VALID-PL-ID                      VALUE 'PL'.
  2033
  2034     12  PL-CONTROL-PRIMARY.
  2035         16  PL-COMPANY-CD                 PIC X.
  2036         16  PL-MSTR-CNTRL.
  2037             20  PL-CONTROL-A.
  2038                 24  PL-CARRIER            PIC X.
  2039                 24  PL-GROUPING           PIC X(6).
  2040                 24  PL-STATE              PIC XX.
  2041                 24  PL-ACCOUNT            PIC X(10).
  2042             20  PL-BENEFIT-TYPE           PIC X.
  2043             20  PL-BENEFIT-CODE           PIC XX.
  2044             20  PL-REVISION-NO            PIC X(3).
  2045
  2046     12  PL-CONTROL-BY-VAR-GRP.
  2047         16  PL-COMPANY-CD-A1              PIC X.
  2048         16  PL-VG-CARRIER                 PIC X.
  2049         16  PL-VG-GROUPING                PIC X(6).
  2050         16  PL-VG-STATE                   PIC XX.
  2051         16  PL-VG-ACCOUNT                 PIC X(10).
  2052         16  PL-BENEFIT-TYPE-A1            PIC X.
  2053         16  PL-BENEFIT-CODE-A1            PIC XX.
  2054         16  PL-REVISION-NO-A1             PIC 999.
  2055
  2056     12  PL-MAINT-INFORMATION.
  2057         16  PL-LAST-MAINT-DT              PIC XX.
  2058         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2059         16  PL-LAST-MAINT-USER            PIC X(4).
  2060         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  39
* EL050.cbl
  2061
  2062     12  PL-LIABILITY-LIMITS.
  2063         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2064         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2065             20  PL-LM-AGE                 PIC S99        COMP-3.
  2066             20  PL-LM-DUR                 PIC S999       COMP-3.
  2067             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2068             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2069
  2070     12  FILLER                            PIC X(30).
  2071
  2072     12  PL-GL-ACCOUNT-NOS.
  2073         16  PL-PREMIUM-GL                 PIC X(8).
  2074         16  PL-COMM-GL                    PIC X(8).
  2075         16  PL-CLAIM-GL                   PIC X(8).
  2076     12  FILLER                            PIC X(24).
  2077     12  PL-TOLERANCES.
  2078         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2079         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2080         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2081         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2082         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2083         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2084     12  PL-OVER-SHORT.
  2085         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2086         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2087     12  FILLER                            PIC X(24).
  2088     12  PLAN-MISC.
  2089         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2090         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2091         16  PL-IG                         PIC X.
  2092         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2093         16  PL-POLICY-FORM                PIC X(12).
  2094         16  PL-EDIT-FOR-FORM              PIC X(01).
  2095         16  PL-DEV-CODE                   PIC XXX.
  2096         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2097         16  PL-CALC-METHOD                PIC X.
  2098         16  PL-BENEFIT-GROUP              PIC X(05).
  2099         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2100
  2101         16  FILLER                        PIC X(99).
  2102******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  40
* EL050.cbl
  2104*    COPY ELCCERT.
  2105******************************************************************
  2106*                                                                *
  2107*                            ELCCERT.                            *
  2108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2109*                            VMOD=2.013                          *
  2110*                                                                *
  2111*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2112*                                                                *
  2113*   FILE TYPE = VSAM,KSDS                                        *
  2114*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2115*                                                                *
  2116*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2117*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2118*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2119*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2120*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2121*                                                                *
  2122*   LOG = YES                                                    *
  2123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2124******************************************************************
  2125*                   C H A N G E   L O G
  2126*
  2127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2128*-----------------------------------------------------------------
  2129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2130* EFFECTIVE    NUMBER
  2131*-----------------------------------------------------------------
  2132* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2133* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2134* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2135* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2136* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2137* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2138* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2139* 032612  CR2011110200001  PEMA  AHL CHANGES
  2140* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2141* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2142******************************************************************
  2143
  2144 01  CERTIFICATE-MASTER.
  2145     12  CM-RECORD-ID                      PIC XX.
  2146         88  VALID-CM-ID                      VALUE 'CM'.
  2147
  2148     12  CM-CONTROL-PRIMARY.
  2149         16  CM-COMPANY-CD                 PIC X.
  2150         16  CM-CARRIER                    PIC X.
  2151         16  CM-GROUPING.
  2152             20  CM-GROUPING-PREFIX        PIC X(3).
  2153             20  CM-GROUPING-PRIME         PIC X(3).
  2154         16  CM-STATE                      PIC XX.
  2155         16  CM-ACCOUNT.
  2156             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2157             20  CM-ACCOUNT-PRIME          PIC X(6).
  2158         16  CM-CERT-EFF-DT                PIC XX.
  2159         16  CM-CERT-NO.
  2160             20  CM-CERT-PRIME             PIC X(10).
  2161             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  41
* EL050.cbl
  2162
  2163     12  CM-CONTROL-BY-NAME.
  2164         16  CM-COMPANY-CD-A1              PIC X.
  2165         16  CM-INSURED-LAST-NAME          PIC X(15).
  2166         16  CM-INSURED-INITIALS.
  2167             20  CM-INSURED-INITIAL1       PIC X.
  2168             20  CM-INSURED-INITIAL2       PIC X.
  2169
  2170     12  CM-CONTROL-BY-SSN.
  2171         16  CM-COMPANY-CD-A2              PIC X.
  2172         16  CM-SOC-SEC-NO.
  2173             20  CM-SSN-STATE              PIC XX.
  2174             20  CM-SSN-ACCOUNT            PIC X(6).
  2175             20  CM-SSN-LN3.
  2176                 25  CM-INSURED-INITIALS-A2.
  2177                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2178                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2179                 25 CM-PART-LAST-NAME-A2         PIC X.
  2180
  2181     12  CM-CONTROL-BY-CERT-NO.
  2182         16  CM-COMPANY-CD-A4              PIC X.
  2183         16  CM-CERT-NO-A4                 PIC X(11).
  2184
  2185     12  CM-CONTROL-BY-MEMB.
  2186         16  CM-COMPANY-CD-A5              PIC X.
  2187         16  CM-MEMBER-NO.
  2188             20  CM-MEMB-STATE             PIC XX.
  2189             20  CM-MEMB-ACCOUNT           PIC X(6).
  2190             20  CM-MEMB-LN4.
  2191                 25  CM-INSURED-INITIALS-A5.
  2192                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2193                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2194                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2195
  2196     12  CM-INSURED-PROFILE-DATA.
  2197         16  CM-INSURED-FIRST-NAME.
  2198             20  CM-INSURED-1ST-INIT       PIC X.
  2199             20  FILLER                    PIC X(9).
  2200         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2201         16  CM-INSURED-SEX                PIC X.
  2202             88  CM-SEX-MALE                  VALUE 'M'.
  2203             88  CM-SEX-FEMAL                 VALUE 'F'.
  2204         16  CM-INSURED-JOINT-AGE          PIC 99.
  2205         16  CM-JOINT-INSURED-NAME.
  2206             20  CM-JT-LAST-NAME           PIC X(15).
  2207             20  CM-JT-FIRST-NAME.
  2208                 24  CM-JT-1ST-INIT        PIC X.
  2209                 24  FILLER                PIC X(9).
  2210             20  CM-JT-INITIAL             PIC X.
  2211
  2212     12  CM-LIFE-DATA.
  2213         16  CM-LF-BENEFIT-CD              PIC XX.
  2214         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2215         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2216         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2217         16  CM-LF-DEV-CODE                PIC XXX.
  2218         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2219         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  42
* EL050.cbl
  2220         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2223         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2224         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2225         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2226         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2227         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2228         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2229         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2230         16  cm-temp-epiq                  pic xx.
  2231             88  EPIQ-CLASS                  value 'EQ'.
  2232*        16  FILLER                        PIC XX.
  2233
  2234     12  CM-AH-DATA.
  2235         16  CM-AH-BENEFIT-CD              PIC XX.
  2236         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2237         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2238         16  CM-AH-DEV-CODE                PIC XXX.
  2239         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2240         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2241         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2242         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2243         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2244         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2245         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2246         16  CM-AH-PAID-THRU-DT            PIC XX.
  2247             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2248         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2249         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2250         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2251         16  FILLER                        PIC X.
  2252
  2253     12  CM-LOAN-INFORMATION.
  2254         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2255         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2256                                           PIC S9(5)V99  COMP-3.
  2257         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2258         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2259         16  CM-PAY-FREQUENCY              PIC S99.
  2260         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2261         16  CM-RATE-CLASS                 PIC XX.
  2262         16  CM-BENEFICIARY                PIC X(25).
  2263         16  CM-POLICY-FORM-NO             PIC X(12).
  2264         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2265         16  CM-LAST-ADD-ON-DT             PIC XX.
  2266         16  CM-DEDUCTIBLE-AMOUNTS.
  2267             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2268             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2269         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2270             20  CM-RESIDENT-STATE         PIC XX.
  2271             20  CM-RATE-CODE              PIC X(4).
  2272             20  FILLER                    PIC XX.
  2273         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2274             20  CM-LOAN-OFFICER           PIC X(5).
  2275             20  FILLER                    PIC XXX.
  2276         16  CM-CSR-CODE                   PIC XXX.
  2277         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  43
* EL050.cbl
  2278             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2279         16  CM-POST-CARD-IND              PIC X.
  2280         16  CM-NH-INTERFACE-SW            PIC X.
  2281         16  CM-PREMIUM-TYPE               PIC X.
  2282             88  CM-SING-PRM                  VALUE '1'.
  2283             88  CM-O-B-COVERAGE              VALUE '2'.
  2284             88  CM-OPEN-END                  VALUE '3'.
  2285         16  CM-IND-GRP-TYPE               PIC X.
  2286             88  CM-INDIVIDUAL                VALUE 'I'.
  2287             88  CM-GROUP                     VALUE 'G'.
  2288         16  CM-SKIP-CODE                  PIC X.
  2289             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2290             88  SKIP-JULY                    VALUE '1'.
  2291             88  SKIP-AUGUST                  VALUE '2'.
  2292             88  SKIP-SEPTEMBER               VALUE '3'.
  2293             88  SKIP-JULY-AUG                VALUE '4'.
  2294             88  SKIP-AUG-SEPT                VALUE '5'.
  2295             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2296             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2297             88  SKIP-JUNE                    VALUE '8'.
  2298             88  SKIP-JUNE-JULY               VALUE '9'.
  2299             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2300             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2301         16  CM-PAYMENT-MODE               PIC X.
  2302             88  PAY-MONTHLY                  VALUE SPACE.
  2303             88  PAY-WEEKLY                   VALUE '1'.
  2304             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2305             88  PAY-BI-WEEKLY                VALUE '3'.
  2306             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2307         16  CM-LOAN-NUMBER                PIC X(8).
  2308         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2309         16  CM-OLD-LOF                    PIC XXX.
  2310*        16  CM-LOAN-OFFICER               PIC XXX.
  2311         16  CM-REIN-TABLE                 PIC XXX.
  2312         16  CM-SPECIAL-REIN-CODE          PIC X.
  2313         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2314         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2315         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2316
  2317     12  CM-STATUS-DATA.
  2318         16  CM-ENTRY-STATUS               PIC X.
  2319         16  CM-ENTRY-DT                   PIC XX.
  2320
  2321         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2322         16  CM-LF-CANCEL-DT               PIC XX.
  2323         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2324
  2325         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2326         16  CM-LF-DEATH-DT                PIC XX.
  2327         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2328
  2329         16  CM-LF-CURRENT-STATUS          PIC X.
  2330             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2331                                                'M' '4' '5' '9'.
  2332             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2333             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2334             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2335             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  44
* EL050.cbl
  2336             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2337             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2338             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2339             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2340             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2341             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2342             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2343             88  CM-LF-DECLINED               VALUE 'D'.
  2344             88  CM-LF-VOIDED                 VALUE 'V'.
  2345
  2346         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2347         16  CM-AH-CANCEL-DT               PIC XX.
  2348         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2349
  2350         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2351         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2352         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2353
  2354         16  CM-AH-CURRENT-STATUS          PIC X.
  2355             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2356                                                'M' '4' '5' '9'.
  2357             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2358             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2359             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2360             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2361             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2362             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2363             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2364             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2365             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2366             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2367             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2368             88  CM-AH-DECLINED               VALUE 'D'.
  2369             88  CM-AH-VOIDED                 VALUE 'V'.
  2370
  2371         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2372             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2373             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2374             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2375         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2376
  2377         16  CM-ENTRY-BATCH                PIC X(6).
  2378         16  CM-LF-EXIT-BATCH              PIC X(6).
  2379         16  CM-AH-EXIT-BATCH              PIC X(6).
  2380         16  CM-LAST-MONTH-END             PIC XX.
  2381
  2382     12  CM-NOTE-SW                        PIC X.
  2383         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2384         88  CERT-NOTES-PRESENT               VALUE '1'.
  2385         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2386         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2387         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2388         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2389         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2390         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2391     12  CM-COMP-EXCP-SW                   PIC X.
  2392         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2393         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  45
* EL050.cbl
  2394     12  CM-INSURED-ADDRESS-SW             PIC X.
  2395         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2396         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2397
  2398*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2399     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2400     12  FILLER                            PIC X.
  2401
  2402*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2403     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2404     12  FILLER                            PIC X.
  2405*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2406     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2407
  2408     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2409         88  CERT-ADDED-BATCH                 VALUE ' '.
  2410         88  CERT-ADDED-ONLINE                VALUE '1'.
  2411         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2412         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2413         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2414     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2415         88  CERT-AS-LOADED                   VALUE ' '.
  2416         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2417         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2418         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2419         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2420         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2421         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2422         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2423
  2424     12  CM-ACCOUNT-COMM-PCTS.
  2425         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2426         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2427
  2428     12  CM-USER-FIELD                     PIC X.
  2429     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2430     12  CM-CLP-STATE                      PIC XX.
  2431     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2432     12  CM-USER-RESERVED                  PIC XXX.
  2433     12  FILLER REDEFINES CM-USER-RESERVED.
  2434         16  CM-AH-CLASS-CD                PIC XX.
  2435         16  F                             PIC X.
  2436******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  46
* EL050.cbl
  2438*    COPY ERCMAIL.
  2439******************************************************************
  2440*                                                                *
  2441*                                                                *
  2442*                            ERCMAIL                             *
  2443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2444*                            VMOD=2.003                          *
  2445*                                                                *
  2446*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2447*                                                                *
  2448*   FILE TYPE = VSAM,KSDS                                        *
  2449*   RECORD SIZE = 374   RECFORM = FIX                            *
  2450*                                                                *
  2451*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2452*   ALTERNATE PATH    = NOT USED                                 *
  2453*                                                                *
  2454*   LOG = YES                                                    *
  2455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2456******************************************************************
  2457*                   C H A N G E   L O G
  2458*
  2459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2460*-----------------------------------------------------------------
  2461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2462* EFFECTIVE    NUMBER
  2463*-----------------------------------------------------------------
  2464* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2465* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2466* 111108                   PEMA  ADD CRED BENE ADDR2
  2467******************************************************************
  2468
  2469 01  MAILING-DATA.
  2470     12  MA-RECORD-ID                      PIC XX.
  2471         88  VALID-MA-ID                       VALUE 'MA'.
  2472
  2473     12  MA-CONTROL-PRIMARY.
  2474         16  MA-COMPANY-CD                 PIC X.
  2475         16  MA-CARRIER                    PIC X.
  2476         16  MA-GROUPING.
  2477             20  MA-GROUPING-PREFIX        PIC XXX.
  2478             20  MA-GROUPING-PRIME         PIC XXX.
  2479         16  MA-STATE                      PIC XX.
  2480         16  MA-ACCOUNT.
  2481             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2482             20  MA-ACCOUNT-PRIME          PIC X(6).
  2483         16  MA-CERT-EFF-DT                PIC XX.
  2484         16  MA-CERT-NO.
  2485             20  MA-CERT-PRIME             PIC X(10).
  2486             20  MA-CERT-SFX               PIC X.
  2487
  2488     12  FILLER                            PIC XX.
  2489
  2490     12  MA-ACCESS-CONTROL.
  2491         16  MA-SOURCE-SYSTEM              PIC XX.
  2492             88  MA-FROM-CREDIT                VALUE 'CR'.
  2493             88  MA-FROM-VSI                   VALUE 'VS'.
  2494             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2495             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  47
* EL050.cbl
  2496         16  MA-RECORD-ADD-DT              PIC XX.
  2497         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2498         16  MA-LAST-MAINT-DT              PIC XX.
  2499         16  MA-LAST-MAINT-BY              PIC XXXX.
  2500         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2501
  2502     12  MA-PROFILE-INFO.
  2503         16  MA-QUALIFY-CODE-1             PIC XX.
  2504         16  MA-QUALIFY-CODE-2             PIC XX.
  2505         16  MA-QUALIFY-CODE-3             PIC XX.
  2506         16  MA-QUALIFY-CODE-4             PIC XX.
  2507         16  MA-QUALIFY-CODE-5             PIC XX.
  2508
  2509         16  MA-INSURED-LAST-NAME          PIC X(15).
  2510         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2511         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2512         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2513         16  MA-INSURED-BIRTH-DT           PIC XX.
  2514         16  MA-INSURED-SEX                PIC X.
  2515             88  MA-SEX-MALE                   VALUE 'M'.
  2516             88  MA-SEX-FEMALE                 VALUE 'F'.
  2517         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2518
  2519         16  MA-ADDRESS-CORRECTED          PIC X.
  2520         16  MA-JOINT-BIRTH-DT             PIC XX.
  2521*        16  FILLER                        PIC X(12).
  2522
  2523         16  MA-ADDRESS-LINE-1             PIC X(30).
  2524         16  MA-ADDRESS-LINE-2             PIC X(30).
  2525         16  MA-CITY-STATE.
  2526             20  MA-CITY                   PIC X(28).
  2527             20  MA-ADDR-STATE             PIC XX.
  2528         16  MA-ZIP.
  2529             20  MA-ZIP-CODE.
  2530                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2531                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2532                 24  FILLER                PIC X(4).
  2533             20  MA-ZIP-PLUS4              PIC X(4).
  2534         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2535             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2536             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2537             20  FILLER                    PIC X(3).
  2538
  2539         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2540
  2541         16  FILLER                        PIC XXX.
  2542*        16  FILLER                        PIC X(10).
  2543
  2544     12  MA-CRED-BENE-INFO.
  2545         16  MA-CRED-BENE-NAME                 PIC X(25).
  2546         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2547         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2548         16  MA-CRED-BENE-CTYST.
  2549             20  MA-CRED-BENE-CITY             PIC X(28).
  2550             20  MA-CRED-BENE-STATE            PIC XX.
  2551         16  MA-CRED-BENE-ZIP.
  2552             20  MA-CB-ZIP-CODE.
  2553                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  48
* EL050.cbl
  2554                     88  MA-CB-CANADIAN-POST-CODE
  2555                                           VALUE 'A' THRU 'Z'.
  2556                 24  FILLER                    PIC X(4).
  2557             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2558         16  MA-CB-CANADIAN-POSTAL-CODE
  2559                            REDEFINES MA-CRED-BENE-ZIP.
  2560             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2561             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2562             20  FILLER                        PIC X(3).
  2563     12  MA-POST-CARD-MAIL-DATA.
  2564         16  MA-MAIL-DATA OCCURS 7.
  2565             20  MA-MAIL-TYPE              PIC X.
  2566                 88  MA-12MO-MAILING           VALUE '1'.
  2567                 88  MA-EXP-MAILING            VALUE '2'.
  2568             20  MA-MAIL-STATUS            PIC X.
  2569                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2570                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2571                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2572             20  MA-MAIL-DATE              PIC XX.
  2573     12  FILLER                            PIC XX.
  2574     12  FILLER                            PIC XX.
  2575*    12  FILLER                            PIC X(30).
  2576******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  49
* EL050.cbl
  2578*    COPY ERCPNDM.
  2579******************************************************************
  2580*                                                                *
  2581*                                                                *
  2582*                            ERCPNDM                             *
  2583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2584*                            VMOD=2.003                          *
  2585*                                                                *
  2586*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2587*                                                                *
  2588*   FILE TYPE = VSAM,KSDS                                        *
  2589*   RECORD SIZE = 374   RECFORM = FIX                            *
  2590*                                                                *
  2591*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2592*   ALTERNATE PATH    = NOT USED                                 *
  2593*                                                                *
  2594*   LOG = YES                                                    *
  2595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2596******************************************************************
  2597*                   C H A N G E   L O G
  2598*
  2599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2600*-----------------------------------------------------------------
  2601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2602* EFFECTIVE    NUMBER
  2603*-----------------------------------------------------------------
  2604* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2605* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2606* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2607******************************************************************
  2608
  2609 01  PENDING-MAILING-DATA.
  2610     12  PM-RECORD-ID                      PIC XX.
  2611         88  VALID-MA-ID                       VALUE 'PM'.
  2612
  2613     12  PM-CONTROL-PRIMARY.
  2614         16  PM-COMPANY-CD                 PIC X.
  2615         16  PM-ENTRY-BATCH                PIC X(6).
  2616         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2617         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2618
  2619     12  FILLER                            PIC X(14).
  2620
  2621     12  PM-ACCESS-CONTROL.
  2622         16  PM-SOURCE-SYSTEM              PIC XX.
  2623             88  PM-FROM-CREDIT                VALUE 'CR'.
  2624             88  PM-FROM-VSI                   VALUE 'VS'.
  2625             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2626             88  PM-FROM-OTHER                 VALUE 'OT'.
  2627         16  PM-RECORD-ADD-DT              PIC XX.
  2628         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2629         16  PM-LAST-MAINT-DT              PIC XX.
  2630         16  PM-LAST-MAINT-BY              PIC XXXX.
  2631         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2632
  2633     12  PM-PROFILE-INFO.
  2634         16  PM-QUALIFY-CODE-1             PIC XX.
  2635         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  50
* EL050.cbl
  2636         16  PM-QUALIFY-CODE-3             PIC XX.
  2637         16  PM-QUALIFY-CODE-4             PIC XX.
  2638         16  PM-QUALIFY-CODE-5             PIC XX.
  2639
  2640         16  PM-INSURED-LAST-NAME          PIC X(15).
  2641         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2642         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2643         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2644         16  PM-INSURED-BIRTH-DT           PIC XX.
  2645         16  PM-INSURED-SEX                PIC X.
  2646             88  PM-SEX-MALE                   VALUE 'M'.
  2647             88  PM-SEX-FEMALE                 VALUE 'F'.
  2648         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2649
  2650         16  PM-ADDRESS-CORRECTED          PIC X.
  2651         16  PM-JOINT-BIRTH-DT             PIC XX.
  2652*        16  FILLER                        PIC X(12).
  2653
  2654         16  PM-ADDRESS-LINE-1             PIC X(30).
  2655         16  PM-ADDRESS-LINE-2             PIC X(30).
  2656         16  PM-CITY-STATE.
  2657             20  PM-CITY                   PIC X(28).
  2658             20  PM-STATE                  PIC XX.
  2659         16  PM-ZIP.
  2660             20  PM-ZIP-CODE.
  2661                 24  PM-ZIP-1              PIC X.
  2662                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2663                 24  FILLER                PIC X(4).
  2664             20  PM-ZIP-PLUS4              PIC X(4).
  2665         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2666             20  PM-CAN-POST1              PIC XXX.
  2667             20  PM-CAN-POST2              PIC XXX.
  2668             20  FILLER                    PIC XXX.
  2669
  2670         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2671
  2672         16  FILLER                        PIC X(03).
  2673
  2674     12  PM-CRED-BENE-INFO.
  2675         16  PM-CRED-BENE-NAME             PIC X(25).
  2676         16  PM-CRED-BENE-ADDR             PIC X(30).
  2677         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2678         16  PM-CRED-BENE-CTYST.
  2679             20  PM-CRED-BENE-CITY         PIC X(28).
  2680             20  PM-CRED-BENE-STATE        PIC XX.
  2681         16  PM-CRED-BENE-ZIP.
  2682             20  PM-CB-ZIP-CODE.
  2683                 24  PM-CB-ZIP-1           PIC X.
  2684                     88  PM-CB-CANADIAN-POST-CODE
  2685                                  VALUE 'A' THRU 'Z'.
  2686                 24  FILLER                PIC X(4).
  2687             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2688         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2689             20  PM-CB-CAN-POST1           PIC XXX.
  2690             20  PM-CB-CAN-POST2           PIC XXX.
  2691             20  FILLER                    PIC XXX.
  2692     12  PM-POST-CARD-MAIL-DATA.
  2693         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  51
* EL050.cbl
  2694             20  PM-MAIL-TYPE              PIC X.
  2695                 88  PM-12MO-MAILING           VALUE '1'.
  2696                 88  PM-EXP-MAILING            VALUE '2'.
  2697             20  PM-MAIL-STATUS            PIC X.
  2698                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2699                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2700                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2701             20  PM-MAIL-DATE              PIC XX.
  2702     12  FILLER                            PIC XX.
  2703     12  FILLER                            PIC X(12).
  2704*    12  FILLER                            PIC X(30).
  2705
  2706******************************************************************
  2707*                                COPY ERCLOFC.
  2708******************************************************************
  2709*                                                                *
  2710*                                                                *
  2711*                            ERCLOFC                             *
  2712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2713*                            VMOD=2.003                          *
  2714*                                                                *
  2715*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2716*                                                                *
  2717*   FILE TYPE = VSAM,KSDS                                        *
  2718*   RECORD SIZE = 670   RECFORM = FIX                            *
  2719*                                                                *
  2720*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2721*                                                                *
  2722*   LOG = YES                                                    *
  2723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2724*                                                                *
  2725******************************************************************
  2726
  2727 01  LOAN-OFFICER-MASTER.
  2728     12  LO-RECORD-ID                PIC XX.
  2729         88  VALID-LO-ID                VALUE 'LO'.
  2730
  2731     12  LO-CONTROL-PRIMARY.
  2732         16  LO-COMPANY-CD           PIC X.
  2733         16  LO-CARRIER              PIC X.
  2734         16  LO-GROUPING.
  2735             20  LO-GROUPING-PREFIX  PIC XXX.
  2736             20  LO-GROUPING-PRIME   PIC XXX.
  2737         16  LO-STATE                PIC XX.
  2738         16  LO-ACCOUNT.
  2739             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2740             20  LO-ACCOUNT-PRIME    PIC X(6).
  2741         16  LO-OFFICER-CODE         PIC X(5).
  2742
  2743     12  LO-OFFICER-NAME             PIC X(30).
  2744
  2745     12  LO-LAST-MAINT-DT            PIC XX.
  2746     12  LO-LAST-USER                PIC X(4).
  2747     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2748
  2749     12  LO-COMP-CONTROL             PIC X.
  2750             88  LO-SHOW-COMP           VALUE 'Y'.
  2751             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  52
* EL050.cbl
  2752     12  LO-DETAIL-CONTROL           PIC X.
  2753             88  LO-PRINT-DETAIL        VALUE 'D'.
  2754             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2755
  2756     12  LO-SV-CARRIER               PIC X.
  2757     12  LO-SV-GROUPING              PIC X(6).
  2758     12  LO-SV-STATE                 PIC XX.
  2759
  2760     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2761     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2762
  2763     12  LO-OFFICER-INFO.
  2764         16  FILLER OCCURS 12 TIMES.
  2765             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2766             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2767             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2768             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2769             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2770             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2771             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2772             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2773     12  FILLER                      PIC X(198).
  2774******************************************************************
  2775*                                COPY ERCPDEF.
  2776******************************************************************
  2777*                                                                *
  2778*                                                                *
  2779*                            ERCPDEF.                            *
  2780*                                                                *
  2781*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2782*                                                                *
  2783*    FILE TYPE = VSAM,KSDS                                       *
  2784*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2785*                                                                *
  2786*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2787*                                                                *
  2788*    LOG = YES                                                   *
  2789*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2790******************************************************************
  2791*                   C H A N G E   L O G
  2792*
  2793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2794*-----------------------------------------------------------------
  2795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2796* EFFECTIVE    NUMBER
  2797*-----------------------------------------------------------------
  2798* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2799* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2800* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2801******************************************************************
  2802 01  PRODUCT-MASTER.
  2803    12  PD-RECORD-ID                 PIC X(02).
  2804        88  VALID-PD-ID                  VALUE 'PD'.
  2805    12  PD-CONTROL-PRIMARY.
  2806        16  PD-COMPANY-CD            PIC X.
  2807        16  PD-STATE                 PIC XX.
  2808        16  PD-PRODUCT-CD            PIC XXX.
  2809        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  53
* EL050.cbl
  2810        16  PD-BEN-TYPE              PIC X.
  2811        16  PD-BEN-CODE              PIC XX.
  2812        16  PD-PROD-EXP-DT           PIC XX.
  2813    12  FILLER                       PIC X(50).
  2814    12  PD-PRODUCT-DATA OCCURS 8.
  2815        16  PD-PROD-CODE             PIC X.
  2816            88  PD-PROD-LIFE           VALUE 'L'.
  2817            88  PD-PROD-PROP           VALUE 'P'.
  2818            88  PD-PROD-AH             VALUE 'A'.
  2819            88  PD-PROD-IU             VALUE 'I'.
  2820            88  PD-PROD-GAP            VALUE 'G'.
  2821            88  PD-PROD-FAML           VALUE 'F'.
  2822        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2823        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2824        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2825        16  PD-MAX-TERM              PIC S999        COMP-3.
  2826        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2827        16  FILLER                   PIC X.
  2828        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2829        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2830        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2831        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2832        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2833        16  PD-REC-CRIT-PERIOD       PIC 99.
  2834        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2835            20  PD-RECURRING-YN      PIC X.
  2836            20  FILLER               PIC X.
  2837        16  PD-RTW-MOS               PIC 99.
  2838        16  PD-MAX-EXTENSION         PIC 99.
  2839        16  pd-ben-pct               pic sv999 comp-3.
  2840*       16  FILLER                   PIC XX.
  2841    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2842    12  PD-TERM-LIMITS OCCURS 15.
  2843        16  PD-LOW-TERM              PIC S999        COMP-3.
  2844        16  PD-HI-TERM               PIC S999        COMP-3.
  2845*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2846    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2847        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2848        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2849    12  PD-EARN-FACTORS.
  2850        16  FILLER OCCURS 15.
  2851            20  FILLER OCCURS 15.
  2852                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2853    12  PD-PRODUCT-DESC              PIC X(80).
  2854    12  PD-TRUNCATED                 PIC X.
  2855    12  FILLER                       PIC X(59).
  2856    12  PD-MAINT-INFORMATION.
  2857        16  PD-LAST-MAINT-DT         PIC X(02).
  2858        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2859        16  PD-LAST-MAINT-BY         PIC X(04).
  2860*                                COPY ELCSTATE.
  2861******************************************************************
  2862*                                                                *
  2863*                                                                *
  2864*                            ELCSTATE.                           *
  2865*                                                                *
  2866*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2867*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  54
* EL050.cbl
  2868*   FILE TYPE = VSAM,KSDS                                        *
  2869*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2870*                                                                *
  2871*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2872*       ALTERNATE INDEX = NONE                                   *
  2873*                                                                *
  2874*   LOG = YES                                                    *
  2875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2876******************************************************************
  2877*                   C H A N G E   L O G
  2878*
  2879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2880*-----------------------------------------------------------------
  2881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2882* EFFECTIVE    NUMBER
  2883*-----------------------------------------------------------------
  2884* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2885******************************************************************
  2886*
  2887 01  STATE-FILE.
  2888     12  SF-RECORD-ID                       PIC XX.
  2889         88  VALID-CF-ID                        VALUE 'SF'.
  2890     12  SF-CONTROL-PRIMARY.
  2891         16  SF-COMPANY-ID                  PIC XXX.
  2892         16  SF-CARRIER-CODE                PIC X.
  2893         16  SF-GROUPING                    PIC X(6).
  2894         16  SF-STATE-CODE                  PIC XX.
  2895         16  SF-EXPIRE-DATE                 PIC 9(8).
  2896****************************************************************
  2897*             STATE CONTROLS
  2898****************************************************************
  2899     12  SF-LAST-MAINT-DT                   PIC XX.
  2900     12  SF-LAST-MAINT-BY                   PIC X(4).
  2901     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2902     12  SF-STATE-RT-CONTROLS.
  2903         16  SF-ST-RT-CALC                  PIC X.
  2904     12  SF-ST-TAX-CONTROLS.
  2905         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2906         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2907         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2908     12  SF-ST-REFUND-OPTIONS.
  2909         16  SF-ST-RF-LR-CALC               PIC X.
  2910         16  SF-ST-RF-LL-CALC               PIC X.
  2911         16  SF-ST-RF-LN-CALC               PIC X.
  2912         16  SF-ST-RF-AH-CALC               PIC X.
  2913         16  SF-ST-RF-CP-CALC               PIC X.
  2914     12  SF-ST-UNEARN-PREM-OPTIONS.
  2915         16  SF-ST-LUEP-R78                 PIC X.
  2916         16  SF-ST-LUEP-PRO                 PIC X.
  2917         16  SF-ST-LUEP-ST                  PIC X.
  2918         16  SF-ST-LUEP-DOM                 PIC X.
  2919         16  SF-ST-AUEP-R78                 PIC X.
  2920         16  SF-ST-AUEP-PRO                 PIC X.
  2921         16  SF-ST-AUEP-ST                  PIC X.
  2922         16  SF-ST-AUEP-DOM                 PIC X.
  2923         16  SF-ST-CUEP-R78                 PIC X.
  2924         16  SF-ST-CUEP-PRO                 PIC X.
  2925         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  55
* EL050.cbl
  2926         16  SF-ST-CUEP-DOM                 PIC X.
  2927     12  SF-ST-EARN-PREM-OPTIONS.
  2928         16  SF-ST-LEP-R78                  PIC X.
  2929         16  SF-ST-LEP-PRO                  PIC X.
  2930         16  SF-ST-LEP-ST                   PIC X.
  2931         16  SF-ST-LEP-DOM                  PIC X.
  2932         16  SF-ST-AEP-R78                  PIC X.
  2933         16  SF-ST-AEP-PRO                  PIC X.
  2934         16  SF-ST-AEP-ST                   PIC X.
  2935         16  SF-ST-AEP-DOM                  PIC X.
  2936         16  SF-ST-CEP-R78                  PIC X.
  2937         16  SF-ST-CEP-PRO                  PIC X.
  2938         16  SF-ST-CEP-ST                   PIC X.
  2939         16  SF-ST-CEP-DOM                  PIC X.
  2940     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  56
* EL050.cbl
  2942*    COPY ELCCRTT.
  2943******************************************************************
  2944*                                                                *
  2945*                            ELCCRTT.                            *
  2946*                                                                *
  2947*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2948*                                                                *
  2949*   FILE TYPE = VSAM,KSDS                                        *
  2950*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2951*                                                                *
  2952*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2953*                                                                *
  2954*   LOG = YES                                                    *
  2955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2956******************************************************************
  2957*                   C H A N G E   L O G
  2958*
  2959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2960*-----------------------------------------------------------------
  2961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2962* EFFECTIVE    NUMBER
  2963*-----------------------------------------------------------------
  2964* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2965* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2966* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2967* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2968* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2969* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2970* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2971* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2972* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2973******************************************************************
  2974
  2975 01  CERTIFICATE-TRAILERS.
  2976     12  CS-RECORD-ID                      PIC XX.
  2977         88  VALID-CS-ID                      VALUE 'CS'.
  2978
  2979     12  CS-CONTROL-PRIMARY.
  2980         16  CS-COMPANY-CD                 PIC X.
  2981         16  CS-CARRIER                    PIC X.
  2982         16  CS-GROUPING                   PIC X(6).
  2983         16  CS-STATE                      PIC XX.
  2984         16  CS-ACCOUNT                    PIC X(10).
  2985         16  CS-CERT-EFF-DT                PIC XX.
  2986         16  CS-CERT-NO.
  2987             20  CS-CERT-PRIME             PIC X(10).
  2988             20  CS-CERT-SFX               PIC X.
  2989         16  CS-TRAILER-TYPE               PIC X.
  2990             88  COMM-TRLR           VALUE 'A'.
  2991             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2992             88  CERT-DATA-TRLR      VALUE 'C'.
  2993
  2994     12  CS-DATA-AREA                      PIC X(516).
  2995
  2996     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2997         16  CS-BANK-COMMISSION-AREA.
  2998             20  CS-BANK-COMMS       OCCURS 10.
  2999                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  57
* EL050.cbl
  3000                 24  CS-COM-TYP            PIC X.
  3001                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3002                 24  CS-RECALC-LV-INDIC    PIC X.
  3003                 24  FILLER                PIC X(10).
  3004         16  FILLER                        PIC X(256).
  3005
  3006     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3007****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3008         16  CS-MB-CLAIM-DATA OCCURS 24.
  3009             20  CS-CLAIM-NO               PIC X(7).
  3010             20  CS-CLAIM-TYPE             PIC X.
  3011                 88  CS-AH-CLM               VALUE 'A'.
  3012                 88  CS-IU-CLM               VALUE 'I'.
  3013                 88  CS-GP-CLM               VALUE 'G'.
  3014                 88  CS-LF-CLM               VALUE 'L'.
  3015                 88  CS-PR-CLM               VALUE 'P'.
  3016                 88  CS-FL-CLM               VALUE 'F'.
  3017             20  CS-INSURED-TYPE           PIC X.
  3018                 88  CS-PRIM-INSURED          VALUE 'P'.
  3019                 88  CS-CO-BORROWER           VALUE 'C'.
  3020             20  CS-BENEFIT-PERIOD         PIC 99.
  3021             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3022             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3023             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3024         16  FILLER                        PIC X(12).
  3025     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3026         16  CS-VIN-NUMBER                 PIC X(17).
  3027         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3028         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3029         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3030         16  cs-agent-name.
  3031             20  cs-agent-fname            pic x(20).
  3032             20  cs-agent-mi               pic x.
  3033             20  cs-agent-lname            pic x(25).
  3034         16  cs-license-no                 pic x(15).
  3035         16  cs-npn-number                 pic x(10).
  3036         16  cs-agent-edit-status          pic x.
  3037             88  cs-ae-refer-to-manager      value 'M'.
  3038             88  cs-ae-cover-sheet           value 'C'.
  3039             88  cs-ae-sig-form              value 'S'.
  3040             88  cs-ae-verified              value 'V'.
  3041             88  cs-unidentified-signature   value 'U'.
  3042             88  cs-cert-returned            value 'R'.
  3043             88  cs-accept-no-commission     value 'N'.
  3044         16  cs-year                       pic 9999.
  3045         16  cs-make                       pic x(20).
  3046         16  cs-model                      pic x(20).
  3047         16  cs-future                     pic x(20).
  3048         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3049         16  FILLER                        PIC X(356). *> was 420
  3050*        16  FILLER                        PIC X(496).
  3051*    COPY ELCCRTO.
  3052******************************************************************
  3053*                                                                *
  3054*                            ELCCRTO.                            *
  3055*                                                                *
  3056*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  58
* EL050.cbl
  3058*   FILE TYPE = VSAM,KSDS                                        *
  3059*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3060*                                                                *
  3061*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3074* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3075* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3076* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3077* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3078******************************************************************
  3079 01  ORIGINAL-CERTIFICATE.
  3080     12  OC-RECORD-ID                      PIC XX.
  3081         88  VALID-OC-ID                      VALUE 'OC'.
  3082     12  OC-CONTROL-PRIMARY.
  3083         16  OC-COMPANY-CD                 PIC X.
  3084         16  OC-CARRIER                    PIC X.
  3085         16  OC-GROUPING                   PIC X(6).
  3086         16  OC-STATE                      PIC XX.
  3087         16  OC-ACCOUNT                    PIC X(10).
  3088         16  OC-CERT-EFF-DT                PIC XX.
  3089         16  OC-CERT-NO.
  3090             20  OC-CERT-PRIME             PIC X(10).
  3091             20  OC-CERT-SFX               PIC X.
  3092         16  OC-RECORD-TYPE                PIC X.
  3093         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3094     12  OC-LAST-MAINT-DT                  PIC XX.
  3095     12  OC-LAST-MAINT-BY                  PIC X(4).
  3096     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3097     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3098     12  FILLER                            PIC X(49).
  3099     12  OC-ORIG-REC.
  3100         16  OC-INS-LAST-NAME              PIC X(15).
  3101         16  OC-INS-FIRST-NAME             PIC X(10).
  3102         16  OC-INS-MIDDLE-INIT            PIC X.
  3103         16  OC-INS-AGE                    PIC S999     COMP-3.
  3104         16  OC-JNT-LAST-NAME              PIC X(15).
  3105         16  OC-JNT-FIRST-NAME             PIC X(10).
  3106         16  OC-JNT-MIDDLE-INIT            PIC X.
  3107         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3108         16  OC-LF-BENCD                   PIC XX.
  3109         16  OC-LF-TERM                    PIC S999      COMP-3.
  3110         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3111         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3113         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3114         16  OC-LF-EXP-DT                  PIC XX.
  3115         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  59
* EL050.cbl
  3116         16  OC-LF-CANCEL-DT               PIC XX.
  3117         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3118         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3119         16  OC-AH-BENCD                   PIC XX.
  3120         16  OC-AH-TERM                    PIC S999      COMP-3.
  3121         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3122         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3123         16  OC-AH-EXP-DT                  PIC XX.
  3124         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3125         16  OC-AH-CP                      PIC 99.
  3126         16  OC-AH-CANCEL-DT               PIC XX.
  3127         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3128         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3129         16  OC-CRED-BENE-NAME             PIC X(25).
  3130         16  OC-1ST-PMT-DT                 PIC XX.
  3131         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3132         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3133         16  OC-ISSUE-TRAN-IND             PIC X.
  3134         16  OC-CANCEL-TRAN-IND            PIC X.
  3135         16  FILLER                        PIC X(211).
  3136
  3137     12  FILLER                            PIC X(50).
  3138******************************************************************
  3139
  3140*    COPY ELCDATE.
  3141******************************************************************
  3142*                                                                *
  3143*                                                                *
  3144*                            ELCDATE.                            *
  3145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3146*                            VMOD=2.003
  3147*                                                                *
  3148*                                                                *
  3149*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3150*                 LENGTH = 200                                   *
  3151******************************************************************
  3152
  3153 01  DATE-CONVERSION-DATA.
  3154     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3155     12  DC-OPTION-CODE                PIC X.
  3156         88  BIN-TO-GREG                VALUE ' '.
  3157         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3158         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3159         88  YMD-GREG-TO-BIN            VALUE '3'.
  3160         88  MDY-GREG-TO-BIN            VALUE '4'.
  3161         88  JULIAN-TO-BIN              VALUE '5'.
  3162         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3163         88  FIND-CENTURY               VALUE '7'.
  3164         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3165         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3166         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3167         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3168         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3169         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3170         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3171         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3172         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3173         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  60
* EL050.cbl
  3174         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3175         88  BIN-3-TO-GREG              VALUE 'I'.
  3176         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3177         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3178         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3179         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3180         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3181         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3182         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3183         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3184         88  THREE-CHARACTER-BIN
  3185                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3186         88  GREGORIAN-TO-BIN
  3187                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3188         88  BIN-TO-GREGORIAN
  3189                  VALUES ' ' '1' 'I' '8' 'G'.
  3190         88  JULIAN-TO-BINARY
  3191                  VALUES '5' 'C' 'E' 'F'.
  3192     12  DC-ERROR-CODE                 PIC X.
  3193         88  NO-CONVERSION-ERROR        VALUE ' '.
  3194         88  DATE-CONVERSION-ERROR
  3195                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3196         88  DATE-IS-ZERO               VALUE '1'.
  3197         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3198         88  DATE-IS-INVALID            VALUE '3'.
  3199         88  DATE1-GREATER-DATE2        VALUE '4'.
  3200         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3201         88  DATE-INVALID-OPTION        VALUE '9'.
  3202         88  INVALID-CENTURY            VALUE 'A'.
  3203         88  ONLY-CENTURY               VALUE 'B'.
  3204         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3205         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3206     12  DC-END-OF-MONTH               PIC X.
  3207         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3208     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3209         88  USE-NORMAL-PROCESS         VALUE ' '.
  3210         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3211         88  ADJUST-UP-100-YRS          VALUE '2'.
  3212     12  FILLER                        PIC X.
  3213     12  DC-CONVERSION-DATES.
  3214         16  DC-BIN-DATE-1             PIC XX.
  3215         16  DC-BIN-DATE-2             PIC XX.
  3216         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3217         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3218                       DC-GREG-DATE-1-EDIT.
  3219             20  DC-EDIT1-MONTH        PIC 99.
  3220             20  SLASH1-1              PIC X.
  3221             20  DC-EDIT1-DAY          PIC 99.
  3222             20  SLASH1-2              PIC X.
  3223             20  DC-EDIT1-YEAR         PIC 99.
  3224         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3225         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3226                     DC-GREG-DATE-2-EDIT.
  3227             20  DC-EDIT2-MONTH        PIC 99.
  3228             20  SLASH2-1              PIC X.
  3229             20  DC-EDIT2-DAY          PIC 99.
  3230             20  SLASH2-2              PIC X.
  3231             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  61
* EL050.cbl
  3232         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3233         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3234                     DC-GREG-DATE-1-YMD.
  3235             20  DC-YMD-YEAR           PIC 99.
  3236             20  DC-YMD-MONTH          PIC 99.
  3237             20  DC-YMD-DAY            PIC 99.
  3238         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3239         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3240                      DC-GREG-DATE-1-MDY.
  3241             20  DC-MDY-MONTH          PIC 99.
  3242             20  DC-MDY-DAY            PIC 99.
  3243             20  DC-MDY-YEAR           PIC 99.
  3244         16  DC-GREG-DATE-1-ALPHA.
  3245             20  DC-ALPHA-MONTH        PIC X(10).
  3246             20  DC-ALPHA-DAY          PIC 99.
  3247             20  FILLER                PIC XX.
  3248             20  DC-ALPHA-CENTURY.
  3249                 24 DC-ALPHA-CEN-N     PIC 99.
  3250             20  DC-ALPHA-YEAR         PIC 99.
  3251         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3252         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3253         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3254         16  DC-JULIAN-DATE            PIC 9(05).
  3255         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3256                                       PIC 9(05).
  3257         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3258             20  DC-JULIAN-YEAR        PIC 99.
  3259             20  DC-JULIAN-DAYS        PIC 999.
  3260         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3261         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3262         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3263     12  DATE-CONVERSION-VARIBLES.
  3264         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3265         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3266             20  FILLER                PIC 9(3).
  3267             20  HOLD-CEN-1-CCYY.
  3268                 24  HOLD-CEN-1-CC     PIC 99.
  3269                 24  HOLD-CEN-1-YY     PIC 99.
  3270             20  HOLD-CEN-1-MO         PIC 99.
  3271             20  HOLD-CEN-1-DA         PIC 99.
  3272         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3273             20  HOLD-CEN-1-R-MO       PIC 99.
  3274             20  HOLD-CEN-1-R-DA       PIC 99.
  3275             20  HOLD-CEN-1-R-CCYY.
  3276                 24  HOLD-CEN-1-R-CC   PIC 99.
  3277                 24  HOLD-CEN-1-R-YY   PIC 99.
  3278             20  FILLER                PIC 9(3).
  3279         16  HOLD-CENTURY-1-X.
  3280             20  FILLER                PIC X(3)  VALUE SPACES.
  3281             20  HOLD-CEN-1-X-CCYY.
  3282                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3283                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3284             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3285             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3286         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3287             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3288             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3289             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  62
* EL050.cbl
  3290                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3291                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3292             20  FILLER                PIC XXX.
  3293         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3294         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3295         16  DC-JULIAN-DATE-1          PIC 9(07).
  3296         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3297             20  DC-JULIAN-1-CCYY.
  3298                 24  DC-JULIAN-1-CC    PIC 99.
  3299                 24  DC-JULIAN-1-YR    PIC 99.
  3300             20  DC-JULIAN-DA-1        PIC 999.
  3301         16  DC-JULIAN-DATE-2          PIC 9(07).
  3302         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3303             20  DC-JULIAN-2-CCYY.
  3304                 24  DC-JULIAN-2-CC    PIC 99.
  3305                 24  DC-JULIAN-2-YR    PIC 99.
  3306             20  DC-JULIAN-DA-2        PIC 999.
  3307         16  DC-GREG-DATE-A-EDIT.
  3308             20  DC-EDITA-MONTH        PIC 99.
  3309             20  SLASHA-1              PIC X VALUE '/'.
  3310             20  DC-EDITA-DAY          PIC 99.
  3311             20  SLASHA-2              PIC X VALUE '/'.
  3312             20  DC-EDITA-CCYY.
  3313                 24  DC-EDITA-CENT     PIC 99.
  3314                 24  DC-EDITA-YEAR     PIC 99.
  3315         16  DC-GREG-DATE-B-EDIT.
  3316             20  DC-EDITB-MONTH        PIC 99.
  3317             20  SLASHB-1              PIC X VALUE '/'.
  3318             20  DC-EDITB-DAY          PIC 99.
  3319             20  SLASHB-2              PIC X VALUE '/'.
  3320             20  DC-EDITB-CCYY.
  3321                 24  DC-EDITB-CENT     PIC 99.
  3322                 24  DC-EDITB-YEAR     PIC 99.
  3323         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3324         16  DC-GREG-DATE-CYMD-R REDEFINES
  3325                              DC-GREG-DATE-CYMD.
  3326             20  DC-CYMD-CEN           PIC 99.
  3327             20  DC-CYMD-YEAR          PIC 99.
  3328             20  DC-CYMD-MONTH         PIC 99.
  3329             20  DC-CYMD-DAY           PIC 99.
  3330         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3331         16  DC-GREG-DATE-MDCY-R REDEFINES
  3332                              DC-GREG-DATE-MDCY.
  3333             20  DC-MDCY-MONTH         PIC 99.
  3334             20  DC-MDCY-DAY           PIC 99.
  3335             20  DC-MDCY-CEN           PIC 99.
  3336             20  DC-MDCY-YEAR          PIC 99.
  3337    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3338        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3339    12  DC-EL310-DATE                  PIC X(21).
  3340    12  FILLER                         PIC X(28).
  3341
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  63
* EL050.cbl
  3343*    COPY ELCCALC.
  3344******************************************************************
  3345*                                                                *
  3346*                           ELCCALC.                            *
  3347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3348*                            VMOD=2.025                          *
  3349*                                                                *
  3350*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3351*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3352*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3353*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3354*                                                                *
  3355*  PASSED TO ELRTRM                                              *
  3356*  -----------------                                             *
  3357*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3358*  ORIGINAL TERM                                                 *
  3359*  BEGINNING DATE                                                *
  3360*  ENDING DATE                                                   *
  3361*  COMPANY I.D.                                                  *
  3362*  ACCOUNT MASTER USER FIELD                                     *
  3363*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3364*  FREE LOOK DAYS                                                *
  3365*                                                                *
  3366*  RETURNED FROM ELRTRM                                          *
  3367*  ---------------------                                         *
  3368*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3369*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3370*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3371*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3372*----------------------------------------------------------------*
  3373*  PASSED TO ELRAMT                                              *
  3374*  ----------------                                              *
  3375*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3376*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3377*  ORIGINAL AMOUNT                                               *
  3378*  ALTERNATE BENEFIT (BALLON)                                    *
  3379*  A.P.R. - NET PAY ONLY                                         *
  3380*  METHOD
  3381*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3382*  COMPANY I.D.                                                  *
  3383*  BENEFIT TYPE                                                  *
  3384*                                                                *
  3385*  RETURNED FROM ELRAMT                                          *
  3386*  --------------------                                          *
  3387*  REMAINING AMOUNT 1 - CURRENT                                  *
  3388*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3389*  REMAINING AMOUNT FACTOR
  3390*----------------------------------------------------------------*
  3391*  PASSED TO ELRESV                                              *
  3392*  -----------------                                             *
  3393*  CERTIFICATE EFFECTIVE DATE                                    *
  3394*  VALUATION DATE                                                *
  3395*  PAID THRU DATE                                                *
  3396*  BENEFIT                                                       *
  3397*  INCURRED DATE                                                 *
  3398*  REPORTED DATE                                                 *
  3399*  ISSUE AGE                                                     *
  3400*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  64
* EL050.cbl
  3401*  CDT PERCENT                                                   *
  3402*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3403* *CLAIM TYPE (LIFE, A/H)                                        *
  3404* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3405* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3406*                                                                *
  3407*  RETURNED FROM ELRESV                                          *
  3408*  --------------------                                          *
  3409*  CDT TABLE USED                                                *
  3410*  CDT FACTOR USED                                               *
  3411*  PAY TO CURRENT RESERVE                                        *
  3412*  I.B.N.R. - A/H ONLY                                           *
  3413*  FUTURE (ACCRUED) AH ONLY                                      *
  3414*----------------------------------------------------------------*
  3415*  PASSED TO ELRATE                                              *
  3416*  ----------------                                              *
  3417*  CERT ISSUE DATE                                               *
  3418*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3419*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3420*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3421*  STATE CODE (CLIENT DEFINED)                                   *
  3422*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3423*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3424*  DEVIATION CODE                                                *
  3425*  ISSUE AGE                                                     *
  3426*  ORIGINAL BENEFIT AMOUNT                                       *
  3427*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3428*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3429*  BENEFIT KIND (LIFE OR A/H)                                    *
  3430*  A.P.R.                                                        *
  3431*  METHOD
  3432*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3433*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3434*  COMPANY I.D. (3 CHARACTER)                                    *
  3435*  BENEFIT CODE                                                  *
  3436*  BENEFIT OVERRIDE CODE                                         *
  3437*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3438*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3439*  JOINT INDICATOR (CSL ONLY)                                    *
  3440*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3441*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3442*                                                                *
  3443*  RETURNED FROM ELRATE                                          *
  3444*  --------------------                                          *
  3445*  CALCULATED PREMIUM                                            *
  3446*  PREMIUM RATE                                                  *
  3447*  MORTALITY CODE                                                *
  3448*  MAX ATTAINED AGE                                              *
  3449*  MAX AGE                                                       *
  3450*  MAX TERM                                                      *
  3451*  MAX MONTHLY BENEFIT                                           *
  3452*  MAX TOTAL BENIFIT                                             *
  3453*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3454*----------------------------------------------------------------*
  3455*  PASSED TO ELRFND                                              *
  3456*  ----------------                                              *
  3457*  CERT ISSUE DATE                                               *
  3458*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  65
* EL050.cbl
  3459*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3460*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3461*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3462*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3463*  STATE CODE (CLIENT DEFINED)                                   *
  3464*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3465*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3466*  DEVIATION CODE                                                *
  3467*  ISSUE AGE                                                     *
  3468*  ORIGINAL BENEFIT AMOUNT                                       *
  3469*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3470*  PROCESS TYPE (CANCEL)                                         *
  3471*  BENEFIT KIND (LIFE OR A/H)                                    *
  3472*  A.P.R.                                                        *
  3473*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3474*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3475*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3476*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3477*  COMPANY I.D. (3 CHARACTER)                                    *
  3478*  BENEFIT CODE                                                  *
  3479*  BENEFIT OVERRIDE CODE                                         *
  3480*                                                                *
  3481*  RETURNED FROM ELRFND                                          *
  3482*  --------------------                                          *
  3483*  CALCULATED REFUND                                             *
  3484*----------------------------------------------------------------*
  3485*  PASSED TO ELEARN                                              *
  3486*  ----------------                                              *
  3487*  CERT ISSUE DATE                                               *
  3488*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3489*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3490*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3491*  STATE CODE (CLIENT DEFINED)                                   *
  3492*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3493*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3494*  DEVIATION CODE                                                *
  3495*  ISSUE AGE                                                     *
  3496*  ORIGINAL BENEFIT AMOUNT                                       *
  3497*  BENEFIT KIND (LIFE OR A/H)                                    *
  3498*  A.P.R.                                                        *
  3499*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3500*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3501*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3502*  COMPANY I.D. (3 CHARACTER)                                    *
  3503*  BENEFIT CODE                                                  *
  3504*  BENEFIT OVERRIDE CODE                                         *
  3505*                                                                *
  3506*  RETURNED FROM ELEARN                                          *
  3507*  --------------------                                          *
  3508*  INDICATED  EARNINGS                                           *
  3509*----------------------------------------------------------------*
  3510*                 LENGTH = 450                                   *
  3511*                                                                *
  3512******************************************************************
  3513******************************************************************
  3514*                   C H A N G E   L O G
  3515*
  3516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  66
* EL050.cbl
  3517*-----------------------------------------------------------------
  3518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3519* EFFECTIVE    NUMBER
  3520*-----------------------------------------------------------------
  3521* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3522* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3523* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3524* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3525* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3526* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3527* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3528* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3529* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3530* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3531* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3532******************************************************************
  3533
  3534 01  CALCULATION-PASS-AREA.
  3535     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3536                                     COMP.
  3537
  3538     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3539       88  NO-CP-ERROR                             VALUE ZERO.
  3540       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3541                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3542       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3543       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3544       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3545       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3546       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3547       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3548       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3549       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3550       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3551       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3552       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3553       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3554       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3555       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3556       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3557       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3558       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3559
  3560     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3561       88  NO-CP-ERROR-2                           VALUE ZERO.
  3562***********************  INPUT AREAS ****************************
  3563
  3564     12  CP-CALCULATION-AREA.
  3565         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3566         16  CP-CERT-EFF-DT        PIC XX.
  3567         16  CP-VALUATION-DT       PIC XX.
  3568         16  CP-PAID-THRU-DT       PIC XX.
  3569         16  CP-BENEFIT-TYPE       PIC X.
  3570           88  CP-AH                               VALUE 'A' 'D'
  3571                                                   'I' 'U'.
  3572           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3573           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3574         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  67
* EL050.cbl
  3575         16  CP-REPORTED-DT        PIC XX.
  3576         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3577         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3578         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-CDT-METHOD         PIC X.
  3583           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3584           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3585           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3586         16  CP-CLAIM-TYPE         PIC X.
  3587           88  CP-AH-CLAIM                         VALUE 'A'.
  3588           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3589         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-REM-TERM-METHOD    PIC X.
  3604           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3605           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3606           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3607           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3608           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3609           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3610           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3611         16  CP-EARNING-METHOD     PIC X.
  3612           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3613           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3614           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3615           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3616           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3617           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3618           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3619           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3620           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3621           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3622           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3623           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3624           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3625           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3626         16  CP-PROCESS-TYPE       PIC X.
  3627           88  CP-CLAIM                            VALUE '1'.
  3628           88  CP-CANCEL                           VALUE '2'.
  3629           88  CP-ISSUE                            VALUE '3'.
  3630         16  CP-SPECIAL-CALC-CD    PIC X.
  3631           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3632           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  68
* EL050.cbl
  3633           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3634           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3635           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3636           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3637           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3638           88  CP-FARM-PLAN                    VALUE 'F'.
  3639           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3640           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3641           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3642           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3643           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3644           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3645           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3646           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3647           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3648           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3649                                                     'W' 'X'.
  3650           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3651           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3652           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3653           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3654           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3655           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3656           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3657           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3658           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3659           88  CP-CSL-METH-1                   VALUE '5'.
  3660           88  CP-CSL-METH-2                   VALUE '6'.
  3661           88  CP-CSL-METH-3                   VALUE '7'.
  3662           88  CP-CSL-METH-4                   VALUE '8'.
  3663
  3664         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3667         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3668         16  CP-STATE              PIC XX          VALUE SPACE.
  3669         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3670         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3671           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3672               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3673         16  CP-R78-OPTION         PIC X.
  3674           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3675           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3676
  3677         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3678         16  CP-IBNR-RESERVE-SW    PIC X.
  3679         16  CP-CLAIM-STATUS       PIC X.
  3680         16  CP-RATE-FILE          PIC X.
  3681         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3682                                     COMP-3.
  3683
  3684         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3685         16  CP-AH-OVERRIDE-CODE   PIC X.
  3686
  3687         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3690                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  69
* EL050.cbl
  3691         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3698                                  PIC S9(7)V99 COMP-3.
  3699
  3700         16  CP-PAID-FROM-DATE     PIC X(02).
  3701         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3702         16  CP-EXT-DAYS-CALC      PIC X.
  3703           88  CP-EXT-NO-CHG                   VALUE ' '.
  3704           88  CP-EXT-CHG-LF                   VALUE '1'.
  3705           88  CP-EXT-CHG-AH                   VALUE '2'.
  3706           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3707         16  CP-DOMICILE-STATE     PIC XX.
  3708         16  CP-CARRIER            PIC X.
  3709         16  CP-REIN-FLAG          PIC X.
  3710         16  CP-REM-TRM-CALC-OPTION PIC X.
  3711           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3712                      '2' '3' '4' '5'.
  3713           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3714           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3715           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3716           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3717           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3718           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3719           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3720           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3721         16  CP-SIG-SWITCH         PIC X.
  3722         16  CP-RATING-METHOD      PIC X.
  3723           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3724           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3725           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3726           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3727           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3728           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3729           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3730           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3731           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3732         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3733                                     COMP-3.
  3734         16  CP-BEN-CATEGORY       PIC X.
  3735         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3736         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3737                                   PIC S99V9(5) COMP-3.
  3738         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3739         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3740                                   PIC S99V9(5) COMP-3.
  3741         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3742         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3743         16  CP-EXPIRE-DT          PIC XX.
  3744         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3745         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3746         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3747         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3748         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  70
* EL050.cbl
  3749             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3750             88  CP-CALC-CLP              VALUE 'C'.
  3751         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3752         16  CP-CANCEL-REASON      PIC X.
  3753         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3754         16  CP-PMT-MODE           PIC X.
  3755         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3756         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3757         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3758         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3759         16  FILLER                PIC X.
  3760
  3761***************    OUTPUT FROM ELRESV   ************************
  3762
  3763         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3764
  3765         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  FILLER                PIC X(09).
  3774***************    OUTPUT FROM ELRTRM   *************************
  3775
  3776         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3783                                     COMP-3.
  3784         16  FILLER                PIC X(12).
  3785
  3786***************    OUTPUT FROM ELRAMT   *************************
  3787
  3788         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3789                                     COMP-3.
  3790         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3791                                     COMP-3.
  3792         16  FILLER                PIC X(12).
  3793
  3794***************    OUTPUT FROM ELRATE   *************************
  3795
  3796         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3797                                     COMP-3.
  3798         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3799                                     COMP-3.
  3800         16  CP-MORTALITY-CODE     PIC X(4).
  3801         16  CP-RATE-EDIT-FLAG     PIC X.
  3802             88  CP-RATES-NEED-APR                  VALUE '1'.
  3803         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3806         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  71
* EL050.cbl
  3807         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3808                                   PIC S9(7)V99 COMP-3.
  3809         16  FILLER                PIC X(07).
  3810
  3811***************    OUTPUT FROM ELRFND   *************************
  3812
  3813         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-REFUND-TYPE-USED   PIC X.
  3816           88  CP-R-AS-R78                         VALUE '1'.
  3817           88  CP-R-AS-PRORATA                     VALUE '2'.
  3818           88  CP-R-AS-CALIF                       VALUE '3'.
  3819           88  CP-R-AS-TEXAS                       VALUE '4'.
  3820           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3821           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3822           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3823           88  CP-R-AS-MEAN                        VALUE '8'.
  3824           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3825           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3826           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3827           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3828           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3829           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3830         16  FILLER                PIC X(12).
  3831
  3832***************    OUTPUT FROM ELEARN   *************************
  3833
  3834         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3841                                     COMP-3.
  3842         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-EARNING-TYPE-USED  PIC X.
  3847           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3848           88  CP-E-AS-R78                         VALUE '1'.
  3849           88  CP-E-AS-PRORATA                     VALUE '2'.
  3850           88  CP-E-AS-TEXAS                       VALUE '4'.
  3851           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3852           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3853           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3854           88  CP-E-AS-MEAN                        VALUE '8'.
  3855           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3856         16  FILLER                PIC X(12).
  3857
  3858***************    OUTPUT FROM ELPMNT   *************************
  3859
  3860         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3861                                     COMP-3.
  3862         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3863                                     COMP-3.
  3864         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  72
* EL050.cbl
  3865
  3866***************   MISC WORK AREAS    *****************************
  3867         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3870                                     COMP-3.
  3871         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3872                                     COMP-3.
  3873         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3878                                     COMP-3.
  3879         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3880             88  OPEN-RATE-FILE                   VALUE 'O'.
  3881             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3882             88  IO-ERROR                         VALUE 'E'.
  3883
  3884         16  CP-FIRST-PAY-DATE     PIC XX.
  3885
  3886         16  CP-JOINT-INDICATOR    PIC X.
  3887
  3888         16  CP-RESERVE-REMAINING-TERM
  3889                                   PIC S9(4)V9    VALUE ZERO
  3890                                     COMP-3.
  3891
  3892         16  CP-INSURED-BIRTH-DT   PIC XX.
  3893
  3894         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3898                                     COMP-3.
  3899
  3900         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3904                                     COMP-3.
  3905
  3906         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3907                                     COMP-3.
  3908
  3909         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3910                                     COMP-3.
  3911
  3912         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3913                                     COMP-3.
  3914
  3915         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3916             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3917
  3918         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  73
* EL050.cbl
  3923         16  cp-extra-periods      pic 9 value zeros.
  3924         16  cp-net-only-state     pic x value spaces.
  3925         16  FILLER                PIC X(13).
  3926******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  74
* EL050.cbl
  3928******************************************************************
  3929*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3930*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3931*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3932*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3933*** MODIFICATION.                                              ***
  3934*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3935*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3936******************************************************************
  3937*    COPY ERCPNDB.
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*                            ERCPNDB.                            *
  3942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3943*                            VMOD=2.025                          *
  3944*                                                                *
  3945*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3946*                                                                *
  3947******************************************************************
  3948*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3949*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3950******************************************************************
  3951*                                                                *
  3952*                                                                *
  3953*   FILE TYPE = VSAM,KSDS                                        *
  3954*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3955*                                                                *
  3956*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3957*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3958*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3959*                                                 RKP=13,LEN=36  *
  3960*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3961*                                      AND CHG-SEQ.)             *
  3962*                                                RKP=49,LEN=11   *
  3963*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3964*                                      AND CHG-SEQ.)             *
  3965*                                                RKP=60,LEN=15   *
  3966*                                                                *
  3967*   LOG = NO                                                     *
  3968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3969******************************************************************
  3970******************************************************************
  3971*                   C H A N G E   L O G
  3972*
  3973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3974*-----------------------------------------------------------------
  3975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3976* EFFECTIVE    NUMBER
  3977*-----------------------------------------------------------------
  3978* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3980* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3981* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3982* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3983* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3984* 032306                   PEMA  ADD BOW LOAN NUMBER
  3985* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  75
* EL050.cbl
  3986* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3987* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3988* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3989* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3990* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3991* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3992* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3993* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3994* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3995******************************************************************
  3996
  3997 01  PENDING-BUSINESS.
  3998     12  PB-RECORD-ID                     PIC XX.
  3999         88  VALID-PB-ID                        VALUE 'PB'.
  4000
  4001     12  PB-CONTROL-PRIMARY.
  4002         16  PB-COMPANY-CD                PIC X.
  4003         16  PB-ENTRY-BATCH               PIC X(6).
  4004         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4005         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4006
  4007     12  PB-CONTROL-BY-ACCOUNT.
  4008         16  PB-COMPANY-CD-A1             PIC X.
  4009         16  PB-CARRIER                   PIC X.
  4010         16  PB-GROUPING.
  4011             20  PB-GROUPING-PREFIX       PIC XXX.
  4012             20  PB-GROUPING-PRIME        PIC XXX.
  4013         16  PB-STATE                     PIC XX.
  4014         16  PB-ACCOUNT.
  4015             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4016             20  PB-ACCOUNT-PRIME         PIC X(6).
  4017         16  PB-CERT-EFF-DT               PIC XX.
  4018         16  PB-CERT-NO.
  4019             20  PB-CERT-PRIME            PIC X(10).
  4020             20  PB-CERT-SFX              PIC X.
  4021         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4022
  4023         16  PB-RECORD-TYPE               PIC X.
  4024             88  PB-MAILING-DATA                VALUE '0'.
  4025             88  PB-ISSUE                       VALUE '1'.
  4026             88  PB-CANCELLATION                VALUE '2'.
  4027             88  PB-BATCH-TRAILER               VALUE '9'.
  4028
  4029     12  PB-CONTROL-BY-ORIG-BATCH.
  4030         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4031         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4032         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4033         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4034
  4035     12  PB-CONTROL-BY-CSR.
  4036         16  PB-CSR-COMPANY-CD            PIC X.
  4037         16  PB-CSR-ID                    PIC X(4).
  4038         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4039         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4040         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4041******************************************************************
  4042*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4043******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  76
* EL050.cbl
  4044
  4045     12  PB-LAST-MAINT-DT                 PIC XX.
  4046     12  PB-LAST-MAINT-BY                 PIC X(4).
  4047     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4048
  4049     12  PB-RECORD-BODY                   PIC X(375).
  4050
  4051     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4052         16  PB-CERT-ORIGIN               PIC X.
  4053             88  CLASIC-CREATED-CERT         VALUE '1'.
  4054         16  PB-I-NAME.
  4055             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4056             20  PB-I-INSURED-FIRST-NAME.
  4057                 24  PB-I-INSURED-1ST-INIT PIC X.
  4058                 24  FILLER                PIC X(9).
  4059             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4060         16  PB-I-AGE                     PIC S99   COMP-3.
  4061         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4062         16  PB-I-BIRTHDAY                PIC XX.
  4063         16  PB-I-INSURED-SEX             PIC X.
  4064             88  PB-SEX-MALE     VALUE 'M'.
  4065             88  PB-SEX-FEMALE   VALUE 'F'.
  4066
  4067         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4068         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4069         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4070         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4071         16  PB-I-SKIP-CODE               PIC X.
  4072             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4073             88  PB-SKIP-JULY              VALUE '1'.
  4074             88  PB-SKIP-AUGUST            VALUE '2'.
  4075             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4076             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4077             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4078             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4079             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4080             88  PB-SKIP-JUNE              VALUE '8'.
  4081             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4082             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4083             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4084         16  PB-I-TERM-TYPE               PIC X.
  4085             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4086             88  PB-PAID-WEEKLY            VALUE 'W'.
  4087             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4088             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4089             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4090         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4091         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4092         16  PB-I-DATA-ENTRY-SW           PIC X.
  4093             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4094             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4095             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4096             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4097         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4098         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4099*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4100         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4101         16  FILLER                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  77
* EL050.cbl
  4102
  4103         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4104             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4105             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4106                                                   '90' THRU '99'.
  4107         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4108                                          PIC XX.
  4109         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4110         16  PB-I-AMOUNT-FINANCED REDEFINES
  4111                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4112         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4113         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4114                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4115         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4116         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4117         16  PB-I-CLP-AMOUNT REDEFINES
  4118                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4119         16  PB-I-LF-CALC-FLAG            PIC X.
  4120             88 PB-COMP-LF-PREM               VALUE '?'.
  4121         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4122         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4123         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4124         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4125         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4126         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4127         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4128         16  PB-I-LF-ABBR                 PIC XXX.
  4129         16  PB-I-LF-INPUT-CD             PIC XX.
  4130
  4131         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4132             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4133             88  PB-INVALID-AH               VALUE '  ' '00'
  4134                                                   '90' THRU '99'.
  4135         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4136         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4137         16  PB-I-AH-CALC-FLAG            PIC X.
  4138             88 PB-COMP-AH-PREM                  VALUE '?'.
  4139         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4140         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4141         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4142         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4143         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4144         16  PB-I-AH-ABBR                 PIC XXX.
  4145         16  PB-I-AH-INPUT-CD             PIC XXX.
  4146
  4147         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4148         16  PB-I-REIN-TABLE              PIC XXX.
  4149         16  PB-I-BUSINESS-TYPE           PIC 99.
  4150         16  PB-I-INDV-GRP-CD             PIC X.
  4151         16  PB-I-MORT-CODE.
  4152             20  PB-I-TABLE               PIC X.
  4153             20  PB-I-INTEREST            PIC XX.
  4154             20  PB-I-MORT-TYP            PIC X.
  4155         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4156         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4157         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4158         16  PB-I-INDV-GRP-OVRD           PIC X.
  4159         16  PB-I-RATE-CLASS-OVRD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  78
* EL050.cbl
  4160         16  PB-I-SIG-SW                  PIC X.
  4161             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4162         16  PB-I-RATE-CLASS              PIC XX.
  4163         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4164         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4165         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4166         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4167         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4168         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4169         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4170         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4171         16  PB-I-OB-FLAG                 PIC X.
  4172             88  PB-I-OB                      VALUE 'B'.
  4173             88  PB-I-SUMMARY                 VALUE 'Z'.
  4174         16  PB-I-ENTRY-STATUS            PIC X.
  4175             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4176                                              'M' '5' '9' '2'.
  4177             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4178             88  PB-I-POLICY-PENDING          VALUE '2'.
  4179             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4180             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4181             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4182             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4183             88  PB-I-REIN-ONLY               VALUE '9'.
  4184             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4185             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4186             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4187             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4188         16  PB-I-INT-CODE                PIC X.
  4189             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4190             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4191         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4192         16  PB-I-SOC-SEC-NO              PIC X(11).
  4193         16  PB-I-MEMBER-NO               PIC X(12).
  4194         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4195*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4196         16  PB-I-OLD-LOF                 PIC XXX.
  4197         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4198         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4199         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4200         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4201         16  PB-I-LIFE-INDICATOR          PIC X.
  4202             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4203         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4204         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4205                                          PIC S9(5)V99    COMP-3.
  4206         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4207             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4208             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4209         16  PB-I-1ST-PMT-DT              PIC XX.
  4210         16  PB-I-JOINT-INSURED.
  4211             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4212             20 PB-I-JOINT-FIRST-NAME.
  4213                24  PB-I-JOINT-FIRST-INIT PIC X.
  4214                24  FILLER                PIC X(9).
  4215             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4216*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4217         16  PB-I-BENEFICIARY-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  79
* EL050.cbl
  4218             20  PB-I-BANK-NUMBER         PIC X(10).
  4219             20  FILLER                   PIC X(15).
  4220         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4221         16  PB-I-REFERENCE               PIC X(12).
  4222         16  FILLER REDEFINES PB-I-REFERENCE.
  4223             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4224             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4225             20  PB-I-CLP-STATE           PIC XX.
  4226         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4227             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4228             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4229             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4230         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4231         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4232         16  PB-I-RESIDENT-STATE          PIC XX.
  4233         16  PB-I-RATE-CODE               PIC X(4).
  4234         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4235         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4236         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4237         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4238         16  PB-I-BANK-NOCHRGB            PIC 99.
  4239         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4240         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4241
  4242     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4243         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4244             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4245         16  PB-C-CANCEL-ORIGIN           PIC X.
  4246             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4247         16  PB-C-LF-CANCEL-DT            PIC XX.
  4248         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4249         16  PB-C-LF-CALC-REQ             PIC X.
  4250             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4251         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4252         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4253         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4254             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4255         16  PB-C-AH-CANCEL-DT            PIC XX.
  4256         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4257         16  PB-C-AH-CALC-REQ             PIC X.
  4258             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4259         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4260         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4261         16  PB-C-LAST-NAME               PIC X(15).
  4262         16  PB-C-REFUND-SW               PIC X.
  4263             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4264             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4265         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4266         16  PB-C-PAYEE-CODE              PIC X(6).
  4267         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4268         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4269         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4270         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4271         16  PB-C-REFERENCE               PIC X(12).
  4272         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4273         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4274         16  PB-C-POST-CARD-IND           PIC X.
  4275         16  PB-C-CANCEL-REASON           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  80
* EL050.cbl
  4276         16  PB-C-REF-INTERFACE-SW        PIC X.
  4277         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4278         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4279         16  FILLER                       PIC X(01).
  4280*        16  FILLER                       PIC X(18).
  4281         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4282*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4283         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4284         16  PB-CANCELED-CERT-DATA.
  4285             20  PB-CI-INSURED-NAME.
  4286                 24  PB-CI-LAST-NAME      PIC X(15).
  4287                 24  PB-CI-INITIALS       PIC XX.
  4288             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4289             20  PB-CI-INSURED-SEX        PIC X.
  4290             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4291             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4292             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4293             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4294             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4295             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4296             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4297             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4298             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4299             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4300             20  PB-CI-RATE-CLASS         PIC XX.
  4301             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4302             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4303             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4304             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4305             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4306             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4307             20  PB-CI-LF-ABBR            PIC X(3).
  4308             20  PB-CI-AH-ABBR            PIC X(3).
  4309             20  PB-CI-OB-FLAG            PIC X.
  4310                 88  PB-CI-OB                VALUE 'B'.
  4311             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4312                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4313                                           'M' '4' '5' '9' '2'.
  4314                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4315                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4316                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4317                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4318                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4319                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4320                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4321                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4322                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4323                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4324                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4325                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4326                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4327             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4328                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4329                                           'M' '4' '5' '9' '2'.
  4330                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4331                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4332                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4333                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  81
* EL050.cbl
  4334                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4335                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4336                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4337                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4338                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4339                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4340                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4341                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4342                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4343             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4344             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4345             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4346             20  PB-CI-MEMBER-NO          PIC X(12).
  4347             20  PB-CI-INT-CODE           PIC X.
  4348                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4349                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4350             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4351             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4352             20  PB-CI-COMP-EXCP-SW       PIC X.
  4353                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4354                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4355             20  PB-CI-ENTRY-STATUS       PIC X.
  4356             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4357             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4358             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4359             20  PB-CI-DEATH-DT           PIC XX.
  4360             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4361             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4362             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4364             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4365             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4366             20  PB-CI-ENTRY-DT              PIC XX.
  4367             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4368             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4369             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4370             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4371             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4372             20  PB-CI-OLD-LOF               PIC XXX.
  4373*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4374             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4375             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4376             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4377             20  PB-CI-INDV-GRP-CD           PIC X.
  4378             20  PB-CI-BENEFICIARY-NAME.
  4379                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4380                 24  FILLER                  PIC X(15).
  4381             20  PB-CI-NOTE-SW               PIC X.
  4382             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4383             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4384             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4385             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4386             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4387             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4388             20  PB-CI-FIRST-NAME            PIC X(10).
  4389             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4390
  4391         16  FILLER                       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  82
* EL050.cbl
  4392*032306  16  FILLER                       PIC X(27).
  4393*        16  FILLER                       PIC X(46).
  4394
  4395     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4396         16  FILLER                       PIC X(10).
  4397         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4398         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4399         16  PB-M-INSURED-MID-INIT        PIC X.
  4400         16  PB-M-INSURED-AGE             PIC 99.
  4401         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4402         16  PB-M-INSURED-SEX             PIC X.
  4403         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4404         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4405         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4406         16  PB-M-INSURED-CITY-STATE.
  4407             20  PB-M-INSURED-CITY        PIC X(28).
  4408             20  PB-M-INSURED-STATE       PIC XX.
  4409         16  PB-M-INSURED-ZIP-CODE.
  4410             20  PB-M-INSURED-ZIP-PRIME.
  4411                 24  PB-M-INSURED-ZIP-1   PIC X.
  4412                     88  PB-M-CANADIAN-POST-CODE
  4413                                             VALUE 'A' THRU 'Z'.
  4414                 24  FILLER               PIC X(4).
  4415             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4416         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4417                                        PB-M-INSURED-ZIP-CODE.
  4418             20  PM-M-INS-CAN-POST1       PIC XXX.
  4419             20  PM-M-INS-CAN-POST2       PIC XXX.
  4420             20  FILLER                   PIC XXX.
  4421         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4422         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4423         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4424         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4425         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4426         16  PB-M-CRED-BENE-CITYST.
  4427             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4428             20  PB-M-CRED-BENE-STATE     PIC XX.
  4429         16  FILLER                       PIC X(92).
  4430
  4431     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4432         16  FILLER                       PIC X(10).
  4433         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4434         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4435         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4436         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4437         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4438         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4439         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4440         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4441         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4442         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4443         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4444         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4445         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4446         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4447         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4448         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4449         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  83
* EL050.cbl
  4450         16  PB-ACCOUNT-NAME              PIC X(30).
  4451         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4452         16  PB-REFERENCE                 PIC X(12).
  4453         16  PB-B-RECEIVED-DT             PIC XX.
  4454         16  FILLER                       PIC X(234).
  4455
  4456     12  PB-RECORD-STATUS.
  4457         16  PB-CREDIT-SELECT-DT          PIC XX.
  4458         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4459         16  PB-BILLED-DT                 PIC XX.
  4460         16  PB-BILLING-STATUS            PIC X.
  4461             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4462             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4463             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4464         16  PB-RECORD-BILL               PIC X.
  4465             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4466             88  PB-RECORD-RETURNED           VALUE 'R'.
  4467             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4468             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4469             88  PB-OVERRIDE-AH               VALUE 'A'.
  4470             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4471         16  PB-BATCH-ENTRY               PIC X.
  4472             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4473             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4474             88  PB-REISSUED-CERT             VALUE 'E'.
  4475             88  PB-CASH-CERT                 VALUE 'C'.
  4476             88  PB-MONTHLY-CERT              VALUE 'M'.
  4477             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4478             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4479             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4480         16  PB-FORCE-CODE                PIC X.
  4481             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4482             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4483             88  PB-CANCEL-FORCE              VALUE '8'.
  4484             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4485             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4486             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4487             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4488             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4489             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4490             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4491         16  PB-FATAL-FLAG                PIC X.
  4492             88  PB-FATAL-ERRORS              VALUE 'X'.
  4493         16  PB-FORCE-ER-CD               PIC X.
  4494             88  PB-FORCE-ERRORS              VALUE 'F'.
  4495             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4496         16  PB-WARN-ER-CD                PIC X.
  4497             88  PB-WARNING-ERRORS            VALUE 'W'.
  4498         16  FILLER                       PIC X.
  4499         16  PB-OUT-BAL-CD                PIC X.
  4500             88  PB-OUT-OF-BAL                VALUE 'O'.
  4501         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4502         16  PB-AH-OVERRIDE-L1            PIC X.
  4503         16  PB-INPUT-DT                  PIC XX.
  4504         16  PB-INPUT-BY                  PIC X(4).
  4505         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4506         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4507         16  PB-TOLERANCE-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  84
* EL050.cbl
  4508         16  PB-LF-EARNING-METHOD         PIC X.
  4509         16  PB-AH-EARNING-METHOD         PIC X.
  4510         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4511         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4512         16  PB-REIN-CD                   PIC XXX.
  4513         16  PB-LF-REFUND-TYPE            PIC X.
  4514         16  PB-AH-REFUND-TYPE            PIC X.
  4515         16  PB-ACCT-EFF-DT               PIC XX.
  4516         16  PB-ACCT-EXP-DT               PIC XX.
  4517         16  PB-COMPANY-ID                PIC X(3).
  4518         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4519         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4520         16  PB-SV-CARRIER                PIC X.
  4521         16  PB-SV-GROUPING               PIC X(6).
  4522         16  PB-SV-STATE                  PIC XX.
  4523         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4524         16  PB-GA-BILLING-INFO.
  4525             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4526                                          PIC XX.
  4527         16  PB-SV-REMIT-TO  REDEFINES
  4528             PB-GA-BILLING-INFO           PIC X(10).
  4529         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4530         16  PB-I-LOAN-OFFICER            PIC X(5).
  4531         16  PB-I-VIN                     PIC X(17).
  4532
  4533         16  FILLER                       PIC X(04).
  4534         16  IMNET-BYPASS-SW              PIC X.
  4535
  4536******************************************************************
  4537*                COMMON EDIT ERRORS                              *
  4538******************************************************************
  4539
  4540     12  PB-COMMON-ERRORS.
  4541         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4542                                           PIC S9(4)     COMP.
  4543
  4544******************************************************************
  4545
  4546* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4547*    COPY ELC50W1.
  4548******************************************************************
  4549*                                                                *
  4550*                                                                *
  4551*                             ELC50W1                            *
  4552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4553*                            VMOD=2.004                          *
  4554*                                                                *
  4555*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4556*                                                                *
  4557*                                                                *
  4558******************************************************************
  4559
  4560     12  WK-WORK-AREA.
  4561         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4562         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4563         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4564         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4565         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  85
* EL050.cbl
  4566         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4567         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4568         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4569         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4570         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4571         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4572         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4573         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4574         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4575         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4576         16  WK-CREDIT-EDIT-CONTROLS.
  4577             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4578             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4579             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4580             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4581             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4582             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4583         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4584         16  WK-SAVE-REIN-DATA.
  4585             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4586             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4587             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4588         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4589             88  ENTRY-FROM-EL6311       VALUE '6'.
  4590         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4591         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4592     12  WK-RECORD-ADDRESSES.
  4593         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4594         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4595         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4596         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4597         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4598         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4599         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4600         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4601     12  WK-OVER-SHORT-AREA.
  4602         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4603         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4604         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4605             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4606         16  FILLER                   PIC X(5) VALUE SPACES.
  4607
  4608*    COPY ELCEDITC.
  4609******************************************************************
  4610*                                                                *
  4611*                                                                *
  4612*                            ELCEDITC                            *
  4613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4614*                            VMOD=2.012                          *
  4615*                                                                *
  4616*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4617*                     EL6313, EL050 AND EL517.                   *
  4618*                                                                *
  4619******************************************************************
  4620******************************************************************
  4621*                   C H A N G E   L O G
  4622*
  4623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  86
* EL050.cbl
  4624*-----------------------------------------------------------------
  4625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4626* EFFECTIVE    NUMBER
  4627*-----------------------------------------------------------------
  4628* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4629******************************************************************
  4630
  4631     12  EDIT-CRITERIA-DATA.
  4632         16  EC-CO-MONTH-END-DT       PIC XX.
  4633         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4634         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4635         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4636         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4637         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4638         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4639         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4640         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4641         16  EC-CO-REM-TERM-CALC      PIC X.
  4642               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4643               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4644               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4645               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4646
  4647         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4648               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4649               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4650               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4651               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4652               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4653               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4654               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4655               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4656               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4657               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4658
  4659         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4660               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4661               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4662               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4663               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4664               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4665               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4666               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4667               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4668
  4669         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4670                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4671                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4672
  4673         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4674                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4675                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4676                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4677                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4678                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4679                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4680                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4681                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  87
* EL050.cbl
  4682
  4683         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4684               88  EC-BR-REDUCING                   VALUE 'R'.
  4685               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4686
  4687         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4688         16  EC-BR-LF-DESC             PIC X(10).
  4689         16  EC-BR-AH-DESC             PIC X(10).
  4690         16  EC-BR-LF-COMMENT          PIC X(10).
  4691         16  EC-BR-AH-COMMENT          PIC X(10).
  4692
  4693         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4694               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4695               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4696               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4697               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4698
  4699         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4700               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4701               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4702               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4703               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4704
  4705         16  EC-BR-LF-REFUND-CALC      PIC X.
  4706                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4707                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4708                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-BR-AH-REFUND-CALC      PIC X.
  4715                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4725                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4726                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4727                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4728
  4729         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4730                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4731                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4732                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4733
  4734         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4735         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4736         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4737         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4738
  4739         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  88
* EL050.cbl
  4740         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4741                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4742                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4743                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4744                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4745
  4746         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4747               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4748               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4749               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4750               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4751               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4752
  4753         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4754               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4755               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4756               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4757               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4758               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4759
  4760         16  EC-ST-LF-REFUND-CALC      PIC X.
  4761                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4762                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4763                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4764                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4765                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4766                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4767                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4768                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4769
  4770         16  EC-ST-AH-REFUND-CALC      PIC X.
  4771                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4772                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4773                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4774                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4775                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4776                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4777                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4778                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4779
  4780         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4781         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4782         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4783         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4784         16  EC-AM-EXPIRATION-DT       PIC XX.
  4785         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4786         16  EC-AM-CLASS-CD            PIC XX.
  4787         16  EC-AM-LF-DEVIATION        PIC XXX.
  4788         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4789         16  EC-AM-AH-DEVIATION        PIC XXX.
  4790         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4791         16  EC-AM-PHONE-NO            PIC X(10).
  4792
  4793         16  EC-AM-LF-REFUND-CALC      PIC X.
  4794                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4795                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4796                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4797                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  89
* EL050.cbl
  4798                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4799                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4800                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4801
  4802         16  EC-AM-AH-REFUND-CALC      PIC X.
  4803                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4804                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4805                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4806                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4807                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4808                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4809                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4810
  4811         16  EC-AM-BEN-I-G-CD          PIC X.
  4812                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4813                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4814                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4815
  4816         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4817         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4818         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4819         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4820         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4821         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4822         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4823         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4824         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4825
  4826         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4827         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4828         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4829         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4830         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4831         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4832         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4833         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4834         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4836         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4837         16  EC-RT-LF-NSP-ST           PIC XX.
  4838         16  EC-RT-AH-NSP-ST           PIC XX.
  4839         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4840         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4841
  4842         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4843             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4844                                             'M' '5' '9' '2'.
  4845             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4846             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4847             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4848             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4849             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4850             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4851             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4852             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4853             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4854             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4855
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  90
* EL050.cbl
  4856         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4857             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4858                                             'M' '5' '9' '2'.
  4859             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4860             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4861             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4862             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4863             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4864             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4865             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4866             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4867             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4868             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4869
  4870         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4871         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4872         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4873         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4874         16  EC-CM-DEATH-DT            PIC XX.
  4875
  4876*DMD CUSTOM CODING FIELDS BELOW
  4877*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4878         16  EC-BR-DMD-RATING-SW       PIC X.
  4879                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4880                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4881                 88  NO-DMD-RATING               VALUE 'N'.
  4882
  4883         16  EC-NEW-CERT               PIC X(11).
  4884         16  EC-NEW-STATE              PIC XX.
  4885         16  FILLER                    PIC X.
  4886*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4887         16  OVER-SHORT-EDIT-FIELDS.
  4888             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4889             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4890             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4891             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4892             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4893             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4894             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4895             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4896             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4897         16  FILLER                    PIC X(71).
  4898******************************************************************
  4899
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  91
* EL050.cbl
  4901*    COPY ELCDIFRD.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ELCDIFRD.                           *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.004                          *
  4908*                                                                *
  4909*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4910*                                                                *
  4911******************************************************************
  4912*
  4913  01  WS-DIFFERENCE-CALCULATION.
  4914        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4915        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4916        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4917        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4918        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4919        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4920        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4921        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4922        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4923        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4924        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4925
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  92
* EL050.cbl
  4927****************************************************************
  4928*
  4929* Copyright (c) 2007 by Clerity Solutions, Inc.
  4930* All rights reserved.
  4931*
  4932****************************************************************
  4933 01  DFHEIV.
  4934   02  DFHEIV0               PIC X(35).
  4935   02  DFHEIV1               PIC X(08).
  4936   02  DFHEIV2               PIC X(08).
  4937   02  DFHEIV3               PIC X(08).
  4938   02  DFHEIV4               PIC X(06).
  4939   02  DFHEIV5               PIC X(04).
  4940   02  DFHEIV6               PIC X(04).
  4941   02  DFHEIV7               PIC X(02).
  4942   02  DFHEIV8               PIC X(02).
  4943   02  DFHEIV9               PIC X(01).
  4944   02  DFHEIV10              PIC S9(7) COMP-3.
  4945   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4946   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4947   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4948   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4949   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4950   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4951   02  DFHEIV17              PIC X(04).
  4952   02  DFHEIV18              PIC X(04).
  4953   02  DFHEIV19              PIC X(04).
  4954   02  DFHEIV20              USAGE IS POINTER.
  4955   02  DFHEIV21              USAGE IS POINTER.
  4956   02  DFHEIV22              USAGE IS POINTER.
  4957   02  DFHEIV23              USAGE IS POINTER.
  4958   02  DFHEIV24              USAGE IS POINTER.
  4959   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4960   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4961   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4962   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4963   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4964   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4965   02  FILLER                PIC X(02).
  4966   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4967   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4968   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4969   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4970   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4971 LINKAGE  SECTION.
  4972*****************************************************************
  4973*                                                               *
  4974* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4975* All rights reserved.                                          *
  4976*                                                               *
  4977*****************************************************************
  4978 01  dfheiblk.
  4979     02  eibtime          pic s9(7) comp-3.
  4980     02  eibdate          pic s9(7) comp-3.
  4981     02  eibtrnid         pic x(4).
  4982     02  eibtaskn         pic s9(7) comp-3.
  4983     02  eibtrmid         pic x(4).
  4984     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  93
* EL050.cbl
  4985     02  eibcposn         pic s9(4) comp.
  4986     02  eibcalen         pic s9(4) comp.
  4987     02  eibaid           pic x(1).
  4988     02  eibfiller1       pic x(1).
  4989     02  eibfn            pic x(2).
  4990     02  eibfiller2       pic x(2).
  4991     02  eibrcode         pic x(6).
  4992     02  eibfiller3       pic x(2).
  4993     02  eibds            pic x(8).
  4994     02  eibreqid         pic x(8).
  4995     02  eibrsrce         pic x(8).
  4996     02  eibsync          pic x(1).
  4997     02  eibfree          pic x(1).
  4998     02  eibrecv          pic x(1).
  4999     02  eibsend          pic x(1).
  5000     02  eibatt           pic x(1).
  5001     02  eibeoc           pic x(1).
  5002     02  eibfmh           pic x(1).
  5003     02  eibcompl         pic x(1).
  5004     02  eibsig           pic x(1).
  5005     02  eibconf          pic x(1).
  5006     02  eiberr           pic x(1).
  5007     02  eibrldbk         pic x(1).
  5008     02  eiberrcd         pic x(4).
  5009     02  eibsynrb         pic x(1).
  5010     02  eibnodat         pic x(1).
  5011     02  eibfiller5       pic x(2).
  5012     02  eibresp          pic 9(09) comp.
  5013     02  eibresp2         pic 9(09) comp.
  5014     02  dfheigdj         pic s9(4) comp.
  5015     02  dfheigdk         pic s9(4) comp.
  5016
  5017 01  DFHCOMMAREA                   PIC X(1036).
  5018
  5019*01 PARMLIST .
  5020*    02  FILLER                    PIC S9(8)   COMP.
  5021*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5022*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5023*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5024*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5025*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5026*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5027*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5028
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  94
* EL050.cbl
  5030*    COPY ELCCNTL.
  5031******************************************************************
  5032*                                                                *
  5033*                                                                *
  5034*                            ELCCNTL.                            *
  5035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5036*                            VMOD=2.059                          *
  5037*                                                                *
  5038*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5039*                                                                *
  5040*   FILE TYPE = VSAM,KSDS                                        *
  5041*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5042*                                                                *
  5043*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5044*       ALTERNATE INDEX = NONE                                   *
  5045*                                                                *
  5046*   LOG = YES                                                    *
  5047*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5048******************************************************************
  5049*                   C H A N G E   L O G
  5050*
  5051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5052*-----------------------------------------------------------------
  5053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5054* EFFECTIVE    NUMBER
  5055*-----------------------------------------------------------------
  5056* 082503                   PEMA  ADD BENEFIT GROUP
  5057* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5058* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5059* 092705    2005050300006  PEMA  ADD SPP LEASES
  5060* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5061* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5062* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5063* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5064* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5065* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5066* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5067* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5068* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5069* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5070******************************************************************
  5071*
  5072 01  CONTROL-FILE.
  5073     12  CF-RECORD-ID                       PIC XX.
  5074         88  VALID-CF-ID                        VALUE 'CF'.
  5075
  5076     12  CF-CONTROL-PRIMARY.
  5077         16  CF-COMPANY-ID                  PIC XXX.
  5078         16  CF-RECORD-TYPE                 PIC X.
  5079             88  CF-COMPANY-MASTER              VALUE '1'.
  5080             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5081             88  CF-STATE-MASTER                VALUE '3'.
  5082             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5083             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5084             88  CF-CARRIER-MASTER              VALUE '6'.
  5085             88  CF-MORTALITY-MASTER            VALUE '7'.
  5086             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5087             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  95
* EL050.cbl
  5088             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5089             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5090             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5091             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5092             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5093             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5094             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5095             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5096             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5097         16  CF-ACCESS-CD-GENL              PIC X(4).
  5098         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5099             20  CF-PROCESSOR               PIC X(4).
  5100         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5101             20  CF-STATE-CODE              PIC XX.
  5102             20  FILLER                     PIC XX.
  5103         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5104             20  FILLER                     PIC XX.
  5105             20  CF-HI-BEN-IN-REC           PIC XX.
  5106         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5107             20  FILLER                     PIC XXX.
  5108             20  CF-CARRIER-CNTL            PIC X.
  5109         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5110             20  FILLER                     PIC XX.
  5111             20  CF-HI-TYPE-IN-REC          PIC 99.
  5112         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5113             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5114                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5115             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5116             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5117         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5118             20  FILLER                     PIC X.
  5119             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5120         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5121             20  FILLER                     PIC XX.
  5122             20  CF-MORTGAGE-PLAN           PIC XX.
  5123         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5124
  5125     12  CF-LAST-MAINT-DT                   PIC XX.
  5126     12  CF-LAST-MAINT-BY                   PIC X(4).
  5127     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5128
  5129     12  CF-RECORD-BODY                     PIC X(728).
  5130
  5131
  5132****************************************************************
  5133*             COMPANY MASTER RECORD                            *
  5134****************************************************************
  5135
  5136     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5137         16  CF-COMPANY-ADDRESS.
  5138             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5139             20  CF-CL-IN-CARE-OF           PIC X(30).
  5140             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5141             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5142             20  CF-CL-CITY-STATE           PIC X(30).
  5143             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5144             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5145         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  96
* EL050.cbl
  5146         16  CF-COMPANY-PASSWORD            PIC X(8).
  5147         16  CF-SECURITY-OPTION             PIC X.
  5148             88  ALL-SECURITY                   VALUE '1'.
  5149             88  COMPANY-VERIFY                 VALUE '2'.
  5150             88  PROCESSOR-VERIFY               VALUE '3'.
  5151             88  NO-SECURITY                    VALUE '4'.
  5152             88  ALL-BUT-TERM                   VALUE '5'.
  5153         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5154             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5155         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5156             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5157         16  CF-INFORCE-LOCATION            PIC X.
  5158             88  CERTS-ARE-ONLINE               VALUE '1'.
  5159             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5160             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5161         16  CF-LOWER-CASE-LETTERS          PIC X.
  5162         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5163             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5164             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5165             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5166             88  CF-ACCNT-CNTL                  VALUE '3'.
  5167             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5168
  5169         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5170         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5171
  5172         16  CF-LGX-CREDIT-USER             PIC X.
  5173             88  CO-IS-NOT-USER                 VALUE 'N'.
  5174             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5175
  5176         16 CF-CREDIT-CALC-CODES.
  5177             20  CF-CR-REM-TERM-CALC PIC X.
  5178               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5179               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5180               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5181               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5182               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5183               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5184               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5185             20  CF-CR-R78-METHOD           PIC X.
  5186               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5187               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5188
  5189         16  CF-CLAIM-CONTROL-COUNTS.
  5190             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5191                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5192
  5193             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5194                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5195
  5196             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5197                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5198
  5199             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5200                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5201
  5202         16  CF-CURRENT-MONTH-END           PIC XX.
  5203
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  97
* EL050.cbl
  5204         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5205             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5206             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5207             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5208             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5209                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5210                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5211             20  CF-CO-PREM-REJECT-SW       PIC X.
  5212                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5213                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5214             20  CF-CO-REF-REJECT-SW        PIC X.
  5215                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5216                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5217
  5218         16  CF-CO-REPORTING-DT             PIC XX.
  5219         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5220         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5221           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5222           88  CF-CO-MONTH-END                  VALUE '1'.
  5223
  5224         16  CF-LGX-CLAIM-USER              PIC X.
  5225             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5226             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5227
  5228         16  CF-CREDIT-EDIT-CONTROLS.
  5229             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5230             20  CF-MIN-AGE                 PIC 99.
  5231             20  CF-DEFAULT-AGE             PIC 99.
  5232             20  CF-MIN-TERM                PIC S999      COMP-3.
  5233             20  CF-MAX-TERM                PIC S999      COMP-3.
  5234             20  CF-DEFAULT-SEX             PIC X.
  5235             20  CF-JOINT-AGE-INPUT         PIC X.
  5236                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5237             20  CF-BIRTH-DATE-INPUT        PIC X.
  5238                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5239             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5240                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5241                 88  CF-ZERO-CARRIER            VALUE '1'.
  5242                 88  CF-ZERO-GROUPING           VALUE '2'.
  5243                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5244             20  CF-EDIT-SW                 PIC X.
  5245                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5246             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5247             20  CF-CR-PR-METHOD            PIC X.
  5248               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5249               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5250             20  FILLER                     PIC X.
  5251
  5252         16  CF-CREDIT-MISC-CONTROLS.
  5253             20  CF-REIN-TABLE-SW           PIC X.
  5254                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5255             20  CF-COMP-TABLE-SW           PIC X.
  5256                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5257             20  CF-EXPERIENCE-RETENTION-AGE
  5258                                            PIC S9        COMP-3.
  5259             20  CF-CONVERSION-DT           PIC XX.
  5260             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5261             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  98
* EL050.cbl
  5262                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5263                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5264
  5265             20  CF-CR-CHECK-NO-CONTROL.
  5266                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5267                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5268                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5269                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5270                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5271                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5272
  5273                 24  CF-CR-CHECK-COUNT       REDEFINES
  5274                     CF-CR-CHECK-COUNTER      PIC X(4).
  5275
  5276                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5277                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5278
  5279                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5280                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5281                 24  CF-MAIL-PROCESSING       PIC X.
  5282                     88  MAIL-PROCESSING          VALUE 'Y'.
  5283
  5284         16  CF-MISC-SYSTEM-CONTROL.
  5285             20  CF-SYSTEM-C                 PIC X.
  5286                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5287             20  CF-SYSTEM-D                 PIC X.
  5288                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5289             20  CF-SOC-SEC-NO-SW            PIC X.
  5290                 88  SOC-SEC-NO-USED             VALUE '1'.
  5291             20  CF-MEMBER-NO-SW             PIC X.
  5292                 88  MEMBER-NO-USED              VALUE '1'.
  5293             20  CF-TAX-ID-NUMBER            PIC X(11).
  5294             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5295             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5296                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5297                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5298                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5299                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5300             20  CF-SYSTEM-E                 PIC X.
  5301                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5302
  5303         16  CF-LGX-LIFE-USER               PIC X.
  5304             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5306
  5307         16  CF-CR-MONTH-END-DT             PIC XX.
  5308
  5309         16  CF-FILE-MAINT-DATES.
  5310             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5311                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5312             20  CF-LAST-BATCH       REDEFINES
  5313                 CF-LAST-BATCH-NO               PIC X(4).
  5314             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5315             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5316             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5317             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5318             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5319             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page  99
* EL050.cbl
  5320             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5321             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5322             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5323             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5324
  5325         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5326         16  FILLER                         PIC X.
  5327
  5328         16  CF-ALT-MORT-CODE               PIC X(4).
  5329         16  CF-MEMBER-CAPTION              PIC X(10).
  5330
  5331         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5332             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5333             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5334             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5335             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5336             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5337
  5338         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5339
  5340         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5341         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5342         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5343         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5344
  5345         16  CF-AH-OVERRIDE-L1              PIC X.
  5346         16  CF-AH-OVERRIDE-L2              PIC XX.
  5347         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5348         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5349
  5350         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5351         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5352
  5353         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5354         16  CF-AR-LAST-EL860-DT            PIC XX.
  5355         16  CF-MP-MONTH-END-DT             PIC XX.
  5356
  5357         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5358         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5359             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5360
  5361         16  CF-AR-MONTH-END-DT             PIC XX.
  5362
  5363         16  CF-CRDTCRD-USER                PIC X.
  5364             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5365             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5366
  5367         16  CF-CC-MONTH-END-DT             PIC XX.
  5368
  5369         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5370
  5371         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5372             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5373             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5374             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5375         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5376         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5377         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 100
* EL050.cbl
  5378         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5379             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5380             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5381         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5382         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5383         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5384             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5385         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5386
  5387         16  CF-CL-ZIP-CODE.
  5388             20  CF-CL-ZIP-PRIME.
  5389                 24  CF-CL-ZIP-1ST          PIC X.
  5390                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5391                 24  FILLER                 PIC X(4).
  5392             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5393         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5394             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5395             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5396             20  FILLER                     PIC XXX.
  5397
  5398         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5399         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5400         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5401         16  CF-CO-OPTION-START-DATE        PIC XX.
  5402         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5403           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5404                                                      '3' '4'.
  5405           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5406           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5407           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5408           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5409           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5410           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5411
  5412         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5413
  5414         16  CF-PAYMENT-APPROVAL-LEVELS.
  5415             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5416             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5417             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5418             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5419             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-END-USER-REPORTING-USER     PIC X.
  5423             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5424             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5425
  5426         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5427             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5428             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5429
  5430         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5431
  5432         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5433         16  FILLER                         PIC X.
  5434
  5435         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 101
* EL050.cbl
  5436             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5437             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5438             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5439
  5440         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5441
  5442         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5443             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5444             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5445
  5446         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5447             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5448             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5451
  5452         16  CF-CO-ACH-ID-CODE              PIC  X.
  5453             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5454             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5455             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5456         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5457         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5458         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5459         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5460         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5461         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5462         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5463         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5464         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5465                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5466         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5467                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5468
  5469         16  CF-CO-OVER-SHORT.
  5470             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5471             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5472
  5473*         16  FILLER                         PIC X(102).
  5474         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5475             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5476             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5477
  5478         16  CF-AH-APPROVAL-DAYS.
  5479             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5480             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5481             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5482             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5483
  5484         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5485
  5486         16  CF-APPROV-LEV-5.
  5487             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5488             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5489             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5490
  5491         16  FILLER                         PIC X(68).
  5492****************************************************************
  5493*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 102
* EL050.cbl
  5494****************************************************************
  5495
  5496     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5497         16  CF-PROCESSOR-NAME              PIC X(30).
  5498         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5499         16  CF-PROCESSOR-TITLE             PIC X(26).
  5500         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5501                 88  MESSAGE-YES                VALUE 'Y'.
  5502                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5503
  5504*****************************************************
  5505****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5506****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5507****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5508****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5509*****************************************************
  5510
  5511         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5512             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5513             20  CF-APPLICATION-FORCE       PIC X.
  5514             20  CF-INDIVIDUAL-APP.
  5515                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5516                     28  CF-BROWSE-APP      PIC X.
  5517                     28  CF-UPDATE-APP      PIC X.
  5518
  5519         16  CF-CURRENT-TERM-ON             PIC X(4).
  5520         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5521             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5522             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5523             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5524             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5525             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5526             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5527             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5528         16  CF-PROCESSOR-CARRIER           PIC X.
  5529             88  NO-CARRIER-SECURITY            VALUE ' '.
  5530         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5531             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5532         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5533             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5534         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5535             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5536
  5537         16  CF-PROC-SYS-ACCESS-SW.
  5538             20  CF-PROC-CREDIT-CLAIMS-SW.
  5539                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5540                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5541                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5542                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5543             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5544                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5545                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5546             20  CF-PROC-LIFE-GNRLDGR-SW.
  5547                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5548                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5549                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5550                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5551             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 103
* EL050.cbl
  5552                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5553                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5554         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5555             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5556             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5557         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5558
  5559         16  CF-APPROVAL-LEVEL                  PIC X.
  5560             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5561             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5562             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5563             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5564             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5565
  5566         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5567
  5568         16  CF-LANGUAGE-TYPE                   PIC X.
  5569             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5570             88  CF-LANG-IS-FR                      VALUE 'F'.
  5571
  5572         16  CF-CSR-IND                         PIC X.
  5573         16  FILLER                             PIC X(239).
  5574
  5575****************************************************************
  5576*             PROCESSOR/REMINDERS RECORD                       *
  5577****************************************************************
  5578
  5579     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5580         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5581             20  CF-START-REMIND-DT         PIC XX.
  5582             20  CF-END-REMIND-DT           PIC XX.
  5583             20  CF-REMINDER-TEXT           PIC X(50).
  5584         16  FILLER                         PIC X(296).
  5585
  5586
  5587****************************************************************
  5588*             STATE MASTER RECORD                              *
  5589****************************************************************
  5590
  5591     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5592         16  CF-STATE-ABBREVIATION          PIC XX.
  5593         16  CF-STATE-NAME                  PIC X(25).
  5594         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5595         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5596             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5597             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5598             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5599             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5600                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5601                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5602             20  CF-ST-PREM-REJECT-SW       PIC X.
  5603                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5604                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5605             20  CF-ST-REF-REJECT-SW        PIC X.
  5606                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5607                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5608         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5609         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 104
* EL050.cbl
  5610         16  CF-ST-REFUND-RULES.
  5611             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5612             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5613             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5614         16  CF-ST-FST-PMT-EXTENSION.
  5615             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5616             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5617                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5618                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5619                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5620                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5621         16  CF-ST-STATE-CALL.
  5622             20  CF-ST-CALL-UNEARNED        PIC X.
  5623             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5624             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5625         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5626             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5627             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5628         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5629         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5630         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5631         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5632         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5633         16  FILLER                         PIC X.
  5634         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5635             20  CF-ST-BENEFIT-CD           PIC XX.
  5636             20  CF-ST-BENEFIT-KIND         PIC X.
  5637                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5638                 88  CF-ST-AH-KIND              VALUE 'A'.
  5639             20  CF-ST-REM-TERM-CALC        PIC X.
  5640                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5641                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5642                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5643                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5644                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5645                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5646                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5647                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5648
  5649             20  CF-ST-REFUND-CALC          PIC X.
  5650                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5651                 88  ST-REFD-BY-R78             VALUE '1'.
  5652                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5654                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5655                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5657                 88  ST-REFD-UTAH               VALUE '7'.
  5658                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5659                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5660                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5661
  5662             20  CF-ST-EARNING-CALC         PIC X.
  5663                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5664                 88  ST-EARN-BY-R78             VALUE '1'.
  5665                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5666                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5667                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 105
* EL050.cbl
  5668                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5669                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5670                 88  ST-EARN-MEAN               VALUE '8'.
  5671                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5672
  5673             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5674                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5675                 88  ST-OVRD-BY-R78             VALUE '1'.
  5676                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5678                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-OVRD-MEAN               VALUE '8'.
  5682                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5683             20  cf-st-extra-periods        pic 9.
  5684*            20  FILLER                     PIC X.
  5685
  5686         16  CF-ST-COMMISSION-CAPS.
  5687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5693
  5694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5695
  5696         16  CF-ST-STATUTORY-INTEREST.
  5697             20  CF-ST-STAT-DATE-FROM       PIC X.
  5698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5705
  5706         16  CF-ST-OVER-SHORT.
  5707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5709
  5710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5711
  5712         16  CF-ST-RT-CALC                  PIC X.
  5713
  5714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5717         16  CF-ST-RF-LR-CALC               PIC X.
  5718         16  CF-ST-RF-LL-CALC               PIC X.
  5719         16  CF-ST-RF-LN-CALC               PIC X.
  5720         16  CF-ST-RF-AH-CALC               PIC X.
  5721         16  CF-ST-RF-CP-CALC               PIC X.
  5722*        16  FILLER                         PIC X(206).
  5723*CIDMOD         16  FILLER                         PIC X(192).
  5724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 106
* EL050.cbl
  5726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5727         16  CF-ST-VFY-2ND-BENE             PIC X.
  5728         16  CF-ST-CAUSAL-STATE             PIC X.
  5729         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5730         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5731         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5732             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5733         16  CF-ST-NET-ONLY-STATE           PIC X.
  5734             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5735         16  FILLER                         PIC X(181).
  5736
  5737****************************************************************
  5738*             BENEFIT MASTER RECORD                            *
  5739****************************************************************
  5740
  5741     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5742         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5743             20  CF-BENEFIT-CODE            PIC XX.
  5744             20  CF-BENEFIT-NUMERIC  REDEFINES
  5745                 CF-BENEFIT-CODE            PIC XX.
  5746             20  CF-BENEFIT-ALPHA           PIC XXX.
  5747             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5748             20  CF-BENEFIT-COMMENT         PIC X(10).
  5749
  5750             20  CF-LF-COVERAGE-TYPE        PIC X.
  5751                 88  CF-REDUCING                VALUE 'R'.
  5752                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5753
  5754             20  CF-SPECIAL-CALC-CD         PIC X.
  5755                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5756                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5757                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5758                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5759                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5760                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5761                 88  CF-FARM-PLAN               VALUE 'F'.
  5762                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5763                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5764                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5765                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5766                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5767                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5768                 88  CF-PRUDENTIAL              VALUE 'P'.
  5769                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5770                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5771                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5772                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5773                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5774                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5775
  5776             20  CF-JOINT-INDICATOR         PIC X.
  5777                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5778
  5779*            20  FILLER                     PIC X(12).
  5780             20  cf-maximum-benefits        pic s999 comp-3.
  5781             20  FILLER                     PIC X(09).
  5782             20  CF-BENEFIT-CATEGORY        PIC X.
  5783             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 107
* EL050.cbl
  5784
  5785             20  CF-CO-REM-TERM-CALC        PIC X.
  5786                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5787                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5788                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5789                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5790                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5791
  5792             20  CF-CO-EARNINGS-CALC        PIC X.
  5793                 88  CO-EARN-BY-R78             VALUE '1'.
  5794                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5795                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5796                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5797                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5798                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5799                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5800                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5801
  5802             20  CF-CO-REFUND-CALC          PIC X.
  5803                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5804                 88  CO-REFD-BY-R78             VALUE '1'.
  5805                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5807                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-REFD-MEAN               VALUE '8'.
  5811                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5812                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5813                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5814
  5815             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5816                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5817                 88  CO-OVRD-BY-R78             VALUE '1'.
  5818                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5820                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5821                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5823                 88  CO-OVRD-MEAN               VALUE '8'.
  5824                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-BEN-I-G-CD           PIC X.
  5827                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5828                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5829                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5830
  5831         16  FILLER                         PIC X(304).
  5832
  5833
  5834****************************************************************
  5835*             CARRIER MASTER RECORD                            *
  5836****************************************************************
  5837
  5838     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5839         16  CF-ADDRESS-DATA.
  5840             20  CF-MAIL-TO-NAME            PIC X(30).
  5841             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 108
* EL050.cbl
  5842             20  CF-ADDRESS-LINE-1          PIC X(30).
  5843             20  CF-ADDRESS-LINE-2          PIC X(30).
  5844             20  CF-CITY-STATE              PIC X(30).
  5845             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5846             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5847
  5848         16  CF-CLAIM-NO-CONTROL.
  5849             20  CF-CLAIM-NO-METHOD         PIC X.
  5850                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5851                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5852                 88  CLAIM-NO-SEQ               VALUE '3'.
  5853                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5854             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5855                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5856                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5857                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5858
  5859         16  CF-CHECK-NO-CONTROL.
  5860             20  CF-CHECK-NO-METHOD         PIC X.
  5861                 88  CHECK-NO-MANUAL            VALUE '1'.
  5862                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5863                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5864                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5865             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5866                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5867
  5868         16  CF-DOMICILE-STATE              PIC XX.
  5869
  5870         16  CF-EXPENSE-CONTROLS.
  5871             20  CF-EXPENSE-METHOD          PIC X.
  5872                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5873                 88  DOLLARS-PER-PMT            VALUE '2'.
  5874                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5875                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5876             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5877             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5878
  5879         16  CF-CORRESPONDENCE-CONTROL.
  5880             20  CF-LETTER-RESEND-OPT       PIC X.
  5881                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5882                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5883             20  FILLER                     PIC X(4).
  5884
  5885         16  CF-RESERVE-CONTROLS.
  5886             20  CF-MANUAL-SW               PIC X.
  5887                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5888             20  CF-FUTURE-SW               PIC X.
  5889                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5890             20  CF-PTC-SW                  PIC X.
  5891                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5892             20  CF-IBNR-SW                 PIC X.
  5893                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5894             20  CF-PTC-LF-SW               PIC X.
  5895                 88  CF-LF-PTC-USED             VALUE '1'.
  5896             20  CF-CDT-ACCESS-METHOD       PIC X.
  5897                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5898                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5899                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 109
* EL050.cbl
  5900             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5901
  5902         16  CF-CLAIM-CALC-METHOD           PIC X.
  5903             88  360-PLUS-MONTHS                VALUE '1'.
  5904             88  365-PLUS-MONTHS                VALUE '2'.
  5905             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5906             88  360-DAILY                      VALUE '4'.
  5907             88  365-DAILY                      VALUE '5'.
  5908
  5909         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5910         16  FILLER                         PIC X(11).
  5911
  5912         16  CF-LIMIT-AMOUNTS.
  5913             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5914             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5915             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5916             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5917             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5918             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5919             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5920             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5921             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5922             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5923
  5924         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5925         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5926         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5927
  5928         16  CF-ZIP-CODE.
  5929             20  CF-ZIP-PRIME.
  5930                 24  CF-ZIP-1ST             PIC X.
  5931                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5932                 24  FILLER                 PIC X(4).
  5933             20  CF-ZIP-PLUS4               PIC X(4).
  5934         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5935             20  CF-CAN-POSTAL-1            PIC XXX.
  5936             20  CF-CAN-POSTAL-2            PIC XXX.
  5937             20  FILLER                     PIC XXX.
  5938
  5939         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5940         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5941         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5942
  5943         16  CF-RATING-SWITCH               PIC X.
  5944             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5945             88  CF-NO-RATING                   VALUE 'N'.
  5946
  5947         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5948
  5949         16  CF-CARRIER-OVER-SHORT.
  5950             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5951             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5952
  5953         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5954         16  CF-SECPAY-SWITCH               PIC X.
  5955             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5956             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5957         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 110
* EL050.cbl
  5958         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5959         16  FILLER                         PIC X(444).
  5960*        16  FILLER                         PIC X(452).
  5961
  5962
  5963****************************************************************
  5964*             MORTALITY MASTER RECORD                          *
  5965****************************************************************
  5966
  5967     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5968         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5969                                INDEXED BY CF-MORT-NDX.
  5970             20  CF-MORT-TABLE              PIC X(5).
  5971             20  CF-MORT-TABLE-TYPE         PIC X.
  5972                 88  CF-MORT-JOINT              VALUE 'J'.
  5973                 88  CF-MORT-SINGLE             VALUE 'S'.
  5974                 88  CF-MORT-COMBINED           VALUE 'C'.
  5975                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5976                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5977             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5978             20  CF-MORT-AGE-METHOD         PIC XX.
  5979                 88  CF-AGE-LAST                VALUE 'AL'.
  5980                 88  CF-AGE-NEAR                VALUE 'AN'.
  5981             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5982             20  CF-MORT-ADJUSTMENT-DIRECTION
  5983                                            PIC X.
  5984                 88  CF-MINUS                   VALUE '-'.
  5985                 88  CF-PLUS                    VALUE '+'.
  5986             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5987             20  CF-MORT-JOINT-CODE         PIC X.
  5988                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5989             20  CF-MORT-PC-Q               PIC X.
  5990                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5991             20  CF-MORT-TABLE-CODE         PIC X(4).
  5992             20  CF-MORT-COMMENTS           PIC X(15).
  5993             20  FILLER                     PIC X(14).
  5994
  5995         16  FILLER                         PIC X(251).
  5996
  5997
  5998****************************************************************
  5999*             BUSSINESS TYPE MASTER RECORD                     *
  6000****************************************************************
  6001
  6002     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6003* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6004* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6005* AND RECORD 05 IS TYPES 81-99
  6006         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6007             20  CF-BUSINESS-TITLE          PIC  X(19).
  6008             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6009                                            PIC S9V9(4) COMP-3.
  6010             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6011             20  FILLER                     PIC  X.
  6012         16  FILLER                         PIC  X(248).
  6013
  6014
  6015****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 111
* EL050.cbl
  6016*             TERMINAL MASTER RECORD                           *
  6017****************************************************************
  6018
  6019     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6020
  6021         16  CF-COMPANY-TERMINALS.
  6022             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6023                                  PIC X(4).
  6024         16  FILLER               PIC X(248).
  6025
  6026
  6027****************************************************************
  6028*             LIFE EDIT MASTER RECORD                          *
  6029****************************************************************
  6030
  6031     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6032         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6033             20  CF-LIFE-CODE-IN            PIC XX.
  6034             20  CF-LIFE-CODE-OUT           PIC XX.
  6035         16  FILLER                         PIC X(248).
  6036
  6037
  6038****************************************************************
  6039*             AH EDIT MASTER RECORD                            *
  6040****************************************************************
  6041
  6042     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6043         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6044             20  CF-AH-CODE-IN              PIC XXX.
  6045             20  CF-AH-CODE-OUT             PIC XX.
  6046         16  FILLER                         PIC X(248).
  6047
  6048
  6049****************************************************************
  6050*             CREDIBILITY TABLES                               *
  6051****************************************************************
  6052
  6053     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6054         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6055                             INDEXED BY CF-CRDB-NDX.
  6056             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6057             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6058             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6059         16  FILLER                         PIC  X(332).
  6060
  6061
  6062****************************************************************
  6063*             REPORT CUSTOMIZATION RECORD                      *
  6064****************************************************************
  6065
  6066     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6067         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6068             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6069             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6070             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6071**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6072****       A T-TRANSFER.                                   ****
  6073             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 112
* EL050.cbl
  6074
  6075         16  FILLER                         PIC XX.
  6076
  6077         16  CF-CARRIER-CNTL-OPT.
  6078             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6079                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6080                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6081             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6082                                            PIC X.
  6083         16  CF-GROUP-CNTL-OPT.
  6084             20  CF-GROUP-OPT-SEQ           PIC 9.
  6085                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6086                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6087             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6088                                            PIC X(6).
  6089         16  CF-STATE-CNTL-OPT.
  6090             20  CF-STATE-OPT-SEQ           PIC 9.
  6091                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6092                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6093             20  CF-STATE-SELECT OCCURS 3 TIMES
  6094                                            PIC XX.
  6095         16  CF-ACCOUNT-CNTL-OPT.
  6096             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6097                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6098                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6099             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6100                                            PIC X(10).
  6101         16  CF-BUS-TYP-CNTL-OPT.
  6102             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6103                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6105             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6106                                            PIC XX.
  6107         16  CF-LF-TYP-CNTL-OPT.
  6108             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6109                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6110                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6111             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6112                                            PIC XX.
  6113         16  CF-AH-TYP-CNTL-OPT.
  6114             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6115                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6116                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6117             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-REPTCD1-CNTL-OPT.
  6120             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6121                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6123             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-REPTCD2-CNTL-OPT.
  6126             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6127                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6129             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6130                                            PIC X(10).
  6131         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 113
* EL050.cbl
  6132             20  CF-USER1-OPT-SEQ           PIC 9.
  6133                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6134                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6135             20  CF-USER1-SELECT OCCURS 3 TIMES
  6136                                            PIC X(10).
  6137         16  CF-USER2-CNTL-OPT.
  6138             20  CF-USER2-OPT-SEQ           PIC 9.
  6139                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6140                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6141             20  CF-USER2-SELECT OCCURS 3 TIMES
  6142                                            PIC X(10).
  6143         16  CF-USER3-CNTL-OPT.
  6144             20  CF-USER3-OPT-SEQ           PIC 9.
  6145                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6146                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6147             20  CF-USER3-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-USER4-CNTL-OPT.
  6150             20  CF-USER4-OPT-SEQ           PIC 9.
  6151                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6152                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6153             20  CF-USER4-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER5-CNTL-OPT.
  6156             20  CF-USER5-OPT-SEQ           PIC 9.
  6157                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER5-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-REINS-CNTL-OPT.
  6162             20  CF-REINS-OPT-SEQ           PIC 9.
  6163                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6165             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6166                 24  CF-REINS-PRIME         PIC XXX.
  6167                 24  CF-REINS-SUB           PIC XXX.
  6168
  6169         16  CF-AGENT-CNTL-OPT.
  6170             20  CF-AGENT-OPT-SEQ           PIC 9.
  6171                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6172                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6173             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6174                                            PIC X(10).
  6175
  6176         16  FILLER                         PIC X(43).
  6177
  6178         16  CF-LOSS-RATIO-SELECT.
  6179             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6180             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6181         16  CF-ENTRY-DATE-SELECT.
  6182             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6183             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6184         16  CF-EFFECTIVE-DATE-SELECT.
  6185             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6186             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6187
  6188         16  CF-EXCEPTION-LIST-IND          PIC X.
  6189             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 114
* EL050.cbl
  6190
  6191         16  FILLER                         PIC X(318).
  6192
  6193****************************************************************
  6194*                  EXCEPTION REPORTING RECORD                  *
  6195****************************************************************
  6196
  6197     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6198         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6199             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6200
  6201         16  CF-COMBINED-LIFE-AH-OPT.
  6202             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6203             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6204             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6205             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6206
  6207         16  CF-LIFE-OPT.
  6208             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6209             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6210             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6211             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6212             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6213             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6214             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6215             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6216             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6217             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6218
  6219         16  CF-AH-OPT.
  6220             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6221             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6222             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6223             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6224             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6225             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6226             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6227             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6228             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6229             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6230
  6231         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6232             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6233             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6234             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6235
  6236         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6237
  6238         16  FILLER                         PIC X(673).
  6239
  6240
  6241****************************************************************
  6242*             MORTGAGE SYSTEM PLAN RECORD                      *
  6243****************************************************************
  6244
  6245     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6246         16  CF-PLAN-TYPE                   PIC X.
  6247             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 115
* EL050.cbl
  6248             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6249             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6250         16  CF-PLAN-ABBREV                 PIC XXX.
  6251         16  CF-PLAN-DESCRIPT               PIC X(10).
  6252         16  CF-PLAN-NOTES                  PIC X(20).
  6253         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6254         16  CF-PLAN-UNDERWRITING.
  6255             20  CF-PLAN-TERM-DATA.
  6256                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6257                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6258             20  CF-PLAN-AGE-DATA.
  6259                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6260                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6261                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6262             20  CF-PLAN-BENEFIT-DATA.
  6263                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6264                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6265                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6266                                            PIC S9(7)V99  COMP-3.
  6267         16  CF-PLAN-POLICY-FORMS.
  6268             20  CF-POLICY-FORM             PIC X(12).
  6269             20  CF-MASTER-APPLICATION      PIC X(12).
  6270             20  CF-MASTER-POLICY           PIC X(12).
  6271         16  CF-PLAN-RATING.
  6272             20  CF-RATE-CODE               PIC X(5).
  6273             20  CF-SEX-RATING              PIC X.
  6274                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6275                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6276             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6277             20  CF-SUB-STD-TYPE            PIC X.
  6278                 88  CF-PCT-OF-PREM            VALUE '1'.
  6279                 88  CF-PCT-OF-BENE            VALUE '2'.
  6280         16  CF-PLAN-PREM-TOLERANCES.
  6281             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6282             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6283         16  CF-PLAN-PYMT-TOLERANCES.
  6284             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6285             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6286         16  CF-PLAN-MISC-DATA.
  6287             20  FILLER                     PIC X.
  6288             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6289             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6290         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6291         16  CF-PLAN-IND-GRP                PIC X.
  6292             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6293                                                     '1'.
  6294             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6295                                                     '2'.
  6296         16  CF-MIB-SEARCH-SW               PIC X.
  6297             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6298             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6299             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6300             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6301         16  CF-ALPHA-SEARCH-SW             PIC X.
  6302             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6303             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6304             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6305             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 116
* EL050.cbl
  6306             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6307             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6308             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6309             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6310             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6311             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6312                                                     'A' 'B' 'C'
  6313                                                     'X' 'Y' 'Z'.
  6314         16  CF-EFF-DT-RULE-SW              PIC X.
  6315             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6316             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6317             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6318             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6319             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6320         16  FILLER                         PIC X(4).
  6321         16  CF-HEALTH-QUESTIONS            PIC X.
  6322             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6323         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6324         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6325         16  CF-PLAN-SNGL-JNT               PIC X.
  6326             88  CF-COMBINED-PLAN              VALUE 'C'.
  6327             88  CF-JNT-PLAN                   VALUE 'J'.
  6328             88  CF-SNGL-PLAN                  VALUE 'S'.
  6329         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6330         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6331         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6332         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6333         16  CF-RERATE-CNTL                 PIC  X.
  6334             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6335             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6336             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6337             88  CF-AUTO-RECALC                 VALUE '4'.
  6338         16  CF-BENEFIT-TYPE                PIC  X.
  6339             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6340             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6341         16  CF-POLICY-FEE                  PIC S999V99
  6342                                                    COMP-3.
  6343         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6344         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6345         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6346         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6347         16  FILLER                         PIC  X(32).
  6348         16  CF-TERMINATION-FORM            PIC  X(04).
  6349         16  FILLER                         PIC  X(08).
  6350         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6351                                                       COMP-3.
  6352         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6353         16  CF-ISSUE-LETTER                PIC  X(4).
  6354         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6355         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6356             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6357             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6358         16  CF-MP-REFUND-CALC              PIC X.
  6359             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6360             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6361             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6362             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6363             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 117
* EL050.cbl
  6364             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6365             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6366             88  CF-MP-REFD-MEAN                VALUE '8'.
  6367         16  CF-ALT-RATE-CODE               PIC  X(5).
  6368
  6369
  6370         16  FILLER                         PIC X(498).
  6371****************************************************************
  6372*             MORTGAGE COMPANY MASTER RECORD                   *
  6373****************************************************************
  6374
  6375     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6376         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6377         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6378             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6379             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6380             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6381             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6382             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6383
  6384         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6385         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6386         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6387         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6388         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6389
  6390         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6391             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6392         16  CF-MP-RECON-USE-IND            PIC X(1).
  6393             88  CF-MP-USE-RECON             VALUE 'Y'.
  6394         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6395             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6396         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6397             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6398             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6399         16  FILLER                         PIC X(1).
  6400         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6401             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6402         16  CF-MORTG-MIB-VERSION           PIC X.
  6403             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6404             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6405             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6406         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6407             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6408                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6409             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6410                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6411             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6412                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6413             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6414                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6415             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6416                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6417             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6418                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6419         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6420         16  FILLER                         PIC X(7).
  6421         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 118
* EL050.cbl
  6422             20  CF-MORTG-MIB-COMM          PIC X(5).
  6423             20  CF-MORTG-MIB-TERM          PIC X(5).
  6424         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6425             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6426         16  FILLER                         PIC X(03).
  6427         16  CF-MP-CHECK-NO-CONTROL.
  6428             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6429                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6430                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6431                                                ' ' LOW-VALUES.
  6432                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6433                                               VALUE '3'.
  6434         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6435         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6436         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6437             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6438                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6439             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6440                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6441             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6442                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6443             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6444                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6445             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6446                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6447             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6448                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6449         16  CF-MORTG-BILLING-AREA.
  6450             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6451                                            PIC X.
  6452         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6453         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6454         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6455         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6456             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6457             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6458         16  FILLER                         PIC X.
  6459         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6460             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6461             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6462         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6463         16  FILLER                         PIC X(8).
  6464         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6465         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6466         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6467         16  CF-ACH-COMPANY-ID.
  6468             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6469                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6470                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6471                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6472             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6473         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6474             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6475         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6476             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6477             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6478         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6479         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 119
* EL050.cbl
  6480         16  FILLER                         PIC X(536).
  6481
  6482****************************************************************
  6483*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6484****************************************************************
  6485
  6486     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6487         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6488             20  CF-FEMALE-HEIGHT.
  6489                 24  CF-FEMALE-FT           PIC 99.
  6490                 24  CF-FEMALE-IN           PIC 99.
  6491             20  CF-FEMALE-MIN-WT           PIC 999.
  6492             20  CF-FEMALE-MAX-WT           PIC 999.
  6493         16  FILLER                         PIC X(428).
  6494
  6495     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6496         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6497             20  CF-MALE-HEIGHT.
  6498                 24  CF-MALE-FT             PIC 99.
  6499                 24  CF-MALE-IN             PIC 99.
  6500             20  CF-MALE-MIN-WT             PIC 999.
  6501             20  CF-MALE-MAX-WT             PIC 999.
  6502         16  FILLER                         PIC X(428).
  6503******************************************************************
  6504*             AUTOMATIC ACTIVITY RECORD                          *
  6505******************************************************************
  6506     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6507         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6508             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6509             20  CF-SYS-LETTER-ID           PIC X(04).
  6510             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6511             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6512             20  CF-SYS-RESET-SW            PIC X(01).
  6513             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6514             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6515
  6516         16  FILLER                         PIC X(50).
  6517
  6518         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6519             20  CF-USER-ACTIVE-SW          PIC X(01).
  6520             20  CF-USER-LETTER-ID          PIC X(04).
  6521             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6522             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6523             20  CF-USER-RESET-SW           PIC X(01).
  6524             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6525             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6526             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6527
  6528         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 120
* EL050.cbl
  6530*    COPY ERCACCT.
  6531******************************************************************
  6532*                                                                *
  6533*                                                                *
  6534*                            ERCACCT                             *
  6535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6536*                            VMOD=2.031                          *
  6537*                                                                *
  6538*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6539*                                                                *
  6540*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6541*   VSAM ACCOUNT MASTER FILES.                                   *
  6542*                                                                *
  6543*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6544*                                                                *
  6545*   FILE TYPE = VSAM,KSDS                                        *
  6546*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6547*                                                                *
  6548*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6549*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6550*                                                                *
  6551*   LOG = NO                                                     *
  6552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6553*                                                                *
  6554*                                                                *
  6555******************************************************************
  6556*                   C H A N G E   L O G
  6557*
  6558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6559*-----------------------------------------------------------------
  6560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6561* EFFECTIVE    NUMBER
  6562*-----------------------------------------------------------------
  6563* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6564* 092705    2005050300006  PEMA  ADD SPP LEASES
  6565* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6566* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6567* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6568* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6569* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6570* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6571******************************************************************
  6572
  6573 01  ACCOUNT-MASTER.
  6574     12  AM-RECORD-ID                      PIC XX.
  6575         88  VALID-AM-ID                      VALUE 'AM'.
  6576
  6577     12  AM-CONTROL-PRIMARY.
  6578         16  AM-COMPANY-CD                 PIC X.
  6579         16  AM-MSTR-CNTRL.
  6580             20  AM-CONTROL-A.
  6581                 24  AM-CARRIER            PIC X.
  6582                 24  AM-GROUPING.
  6583                     28 AM-GROUPING-PREFIX PIC XXX.
  6584                     28 AM-GROUPING-PRIME  PIC XXX.
  6585                 24  AM-STATE              PIC XX.
  6586                 24  AM-ACCOUNT.
  6587                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 121
* EL050.cbl
  6588                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6589             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6590                                           PIC X(19).
  6591             20  AM-CNTRL-B.
  6592                 24  AM-EXPIRATION-DT      PIC XX.
  6593                 24  FILLER                PIC X(4).
  6594             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6595                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6596
  6597     12  AM-CONTROL-BY-VAR-GRP.
  6598         16  AM-COMPANY-CD-A1              PIC X.
  6599         16  AM-VG-CARRIER                 PIC X.
  6600         16  AM-VG-GROUPING                PIC X(6).
  6601         16  AM-VG-STATE                   PIC XX.
  6602         16  AM-VG-ACCOUNT                 PIC X(10).
  6603         16  AM-VG-DATE.
  6604             20  AM-VG-EXPIRATION-DT       PIC XX.
  6605             20  FILLER                    PIC X(4).
  6606         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6607                                           PIC 9(11)      COMP-3.
  6608     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6609         16  FILLER                        PIC X(10).
  6610         16  AM-VG-KEY3.
  6611             20  AM-VG3-ACCOUNT            PIC X(10).
  6612             20  AM-VG3-EXP-DT             PIC XX.
  6613         16  FILLER                        PIC X(4).
  6614     12  AM-MAINT-INFORMATION.
  6615         16  AM-LAST-MAINT-DT              PIC XX.
  6616         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6617         16  AM-LAST-MAINT-USER            PIC X(4).
  6618         16  FILLER                        PIC XX.
  6619
  6620     12  AM-EFFECTIVE-DT                   PIC XX.
  6621     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6622
  6623     12  AM-PREV-DATES  COMP-3.
  6624         16  AM-PREV-EXP-DT                PIC 9(11).
  6625         16  AM-PREV-EFF-DT                PIC 9(11).
  6626
  6627     12  AM-REPORT-CODE-1                  PIC X(10).
  6628     12  AM-REPORT-CODE-2                  PIC X(10).
  6629
  6630     12  AM-CITY-CODE                      PIC X(4).
  6631     12  AM-COUNTY-PARISH                  PIC X(6).
  6632
  6633     12  AM-NAME                           PIC X(30).
  6634     12  AM-PERSON                         PIC X(30).
  6635     12  AM-ADDRS                          PIC X(30).
  6636     12  AM-CITY.
  6637         16  AM-ADDR-CITY                  PIC X(28).
  6638         16  AM-ADDR-STATE                 PIC XX.
  6639     12  AM-ZIP.
  6640         16  AM-ZIP-PRIME.
  6641             20  AM-ZIP-PRI-1ST            PIC X.
  6642                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6643             20  FILLER                    PIC X(4).
  6644         16  AM-ZIP-PLUS4                  PIC X(4).
  6645     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 122
* EL050.cbl
  6646         16  AM-CAN-POSTAL-1               PIC XXX.
  6647         16  AM-CAN-POSTAL-2               PIC XXX.
  6648         16  FILLER                        PIC XXX.
  6649     12  AM-TEL-NO.
  6650         16  AM-AREA-CODE                  PIC 999.
  6651         16  AM-TEL-PRE                    PIC 999.
  6652         16  AM-TEL-NBR                    PIC 9(4).
  6653     12  AM-TEL-LOC                        PIC X.
  6654         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6655         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6656
  6657     12  AM-COMM-STRUCTURE.
  6658         16  AM-DEFN-1.
  6659             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6660                 24  AM-AGT.
  6661                     28  AM-AGT-PREFIX     PIC X(4).
  6662                     28  AM-AGT-PRIME      PIC X(6).
  6663                 24  AM-COM-TYP            PIC X.
  6664                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6665                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6666                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6667                 24  AM-RECALC-LV-INDIC    PIC X.
  6668                 24  AM-RETRO-LV-INDIC     PIC X.
  6669                 24  AM-GL-CODES           PIC X.
  6670                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6671                 24  FILLER                PIC X(01).
  6672         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6673             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6674                 24  FILLER                PIC X(11).
  6675                 24  AM-L-COMA             PIC XXX.
  6676                 24  AM-J-COMA             PIC XXX.
  6677                 24  AM-A-COMA             PIC XXX.
  6678                 24  FILLER                PIC X(6).
  6679
  6680     12  AM-COMM-CHANGE-STATUS             PIC X.
  6681         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6682
  6683     12  AM-CSR-CODE                       PIC X(4).
  6684
  6685     12  AM-BILLING-STATUS                 PIC X.
  6686         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6687         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6688     12  AM-AUTO-REFUND-SW                 PIC X.
  6689         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6690         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6691     12  AM-GPCD                           PIC 99.
  6692     12  AM-IG                             PIC X.
  6693         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6694         88  AM-HAS-GROUP                     VALUE '2'.
  6695     12  AM-STATUS                         PIC X.
  6696         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6697         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6698         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6699         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6700         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6701         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6702         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6703         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 123
* EL050.cbl
  6704         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6705         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6706     12  AM-REMIT-TO                       PIC 99.
  6707     12  AM-ID-NO                          PIC X(11).
  6708
  6709     12  AM-CAL-TABLE                      PIC XX.
  6710     12  AM-LF-DEVIATION                   PIC XXX.
  6711     12  AM-AH-DEVIATION                   PIC XXX.
  6712     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6713     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6714     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6715     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6716     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6717     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6718
  6719     12  AM-USER-FIELDS.
  6720         16  AM-FLD-1                      PIC XX.
  6721         16  AM-FLD-2                      PIC XX.
  6722         16  AM-FLD-3                      PIC XX.
  6723         16  AM-FLD-4                      PIC XX.
  6724         16  AM-FLD-5                      PIC XX.
  6725
  6726     12  AM-1ST-PROD-DATE.
  6727         16  AM-1ST-PROD-YR                PIC XX.
  6728         16  AM-1ST-PROD-MO                PIC XX.
  6729         16  AM-1ST-PROD-DA                PIC XX.
  6730     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6731     12  AM-CERTS-PURGED-DATE.
  6732         16  AM-PUR-YR                     PIC XX.
  6733         16  AM-PUR-MO                     PIC XX.
  6734         16  AM-PUR-DA                     PIC XX.
  6735     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6736     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6737     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6738     12  AM-INACTIVE-DATE.
  6739         16  AM-INA-MO                     PIC 99.
  6740         16  AM-INA-DA                     PIC 99.
  6741         16  AM-INA-YR                     PIC 99.
  6742     12  AM-AR-HI-CERT-DATE                PIC XX.
  6743
  6744     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6745     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6746
  6747     12  AM-OB-PAYMENT-MODE                PIC X.
  6748         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6749         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6750         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6751         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6752
  6753     12  AM-AH-ONLY-INDICATOR              PIC X.
  6754         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6755         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6756
  6757     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6758
  6759     12  AM-OVER-SHORT.
  6760         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6761         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 124
* EL050.cbl
  6762
  6763     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6764     12  AM-DCC-CLP-STATE                  PIC XX.
  6765
  6766     12  AM-RECALC-COMM                    PIC X.
  6767     12  AM-RECALC-REIN                    PIC X.
  6768
  6769     12  AM-REI-TABLE                      PIC XXX.
  6770     12  AM-REI-ET-LF                      PIC X.
  6771     12  AM-REI-ET-AH                      PIC X.
  6772     12  AM-REI-PE-LF                      PIC X.
  6773     12  AM-REI-PE-AH                      PIC X.
  6774     12  AM-REI-PRT-ST                     PIC X.
  6775     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6776     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6777     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6778     12  AM-REI-GROUP-A                    PIC X(6).
  6779     12  AM-REI-MORT                       PIC X(4).
  6780     12  AM-REI-PRT-OW                     PIC X.
  6781     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6782     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6783     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6784     12  AM-REI-GROUP-B                    PIC X(6).
  6785
  6786     12  AM-TRUST-TYPE                     PIC X(2).
  6787
  6788     12  AM-EMPLOYER-STMT-USED             PIC X.
  6789     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6790
  6791     12  AM-STD-AH-TYPE                    PIC XX.
  6792     12  AM-EARN-METHODS.
  6793         16  AM-EARN-METHOD-R              PIC X.
  6794             88 AM-REF-RL-R78                 VALUE 'R'.
  6795             88 AM-REF-RL-PR                  VALUE 'P'.
  6796             88 AM-REF-RL-MEAN                VALUE 'M'.
  6797             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6798         16  AM-EARN-METHOD-L              PIC X.
  6799             88 AM-REF-LL-R78                 VALUE 'R'.
  6800             88 AM-REF-LL-PR                  VALUE 'P'.
  6801             88 AM-REF-LL-MEAN                VALUE 'M'.
  6802             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6803         16  AM-EARN-METHOD-A              PIC X.
  6804             88 AM-REF-AH-R78                 VALUE 'R'.
  6805             88 AM-REF-AH-PR                  VALUE 'P'.
  6806             88 AM-REF-AH-MEAN                VALUE 'M'.
  6807             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6808             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6809             88 AM-REF-AH-NET                 VALUE 'N'.
  6810
  6811     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6812     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6813     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6814
  6815     12  AM-RET-Y-N                        PIC X.
  6816     12  AM-RET-P-E                        PIC X.
  6817     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6818     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6819     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 125
* EL050.cbl
  6820     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6821         16  AM-POOL-PRIME                 PIC XXX.
  6822         16  AM-POOL-SUB                   PIC XXX.
  6823     12  AM-RETRO-EARNINGS.
  6824         16  AM-RET-EARN-R                 PIC X.
  6825         16  AM-RET-EARN-L                 PIC X.
  6826         16  AM-RET-EARN-A                 PIC X.
  6827     12  AM-RET-ST-TAX-USE                 PIC X.
  6828         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6829         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6830     12  AM-RETRO-BEG-EARNINGS.
  6831         16  AM-RET-BEG-EARN-R             PIC X.
  6832         16  AM-RET-BEG-EARN-L             PIC X.
  6833         16  AM-RET-BEG-EARN-A             PIC X.
  6834     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6835     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6836
  6837     12  AM-USER-SELECT-OPTIONS.
  6838         16  AM-USER-SELECT-1              PIC X(10).
  6839         16  AM-USER-SELECT-2              PIC X(10).
  6840         16  AM-USER-SELECT-3              PIC X(10).
  6841         16  AM-USER-SELECT-4              PIC X(10).
  6842         16  AM-USER-SELECT-5              PIC X(10).
  6843
  6844     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6845
  6846     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6847
  6848     12  AM-RPT045A-SWITCH                 PIC X.
  6849         88  RPT045A-OFF                   VALUE 'N'.
  6850
  6851     12  AM-INSURANCE-LIMITS.
  6852         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6853         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6854
  6855     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6856         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6857
  6858     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6859         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6860         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6861
  6862     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6863
  6864     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6865     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6866     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6867     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6868     12  AM-DCC-UEF-STATE                  PIC XX.
  6869     12  FILLER                            PIC XXX.
  6870     12  AM-REPORT-CODE-3                  PIC X(10).
  6871*    12  FILLER                            PIC X(22).
  6872
  6873     12  AM-RESERVE-DATE.
  6874         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6875         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6876         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6877
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 126
* EL050.cbl
  6878     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6879     12  AM-NOTIFICATION-TYPES.
  6880         16  AM-NOTIF-OF-LETTERS           PIC X.
  6881         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6882         16  AM-NOTIF-OF-REPORTS           PIC X.
  6883         16  AM-NOTIF-OF-STATUS            PIC X.
  6884
  6885     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6886         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6887         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6888         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6889         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6890
  6891     12  AM-BENEFIT-CONTROLS.
  6892         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6893             20  AM-BENEFIT-CODE           PIC XX.
  6894             20  AM-BENEFIT-TYPE           PIC X.
  6895             20  AM-BENEFIT-REVISION       PIC XXX.
  6896             20  AM-BENEFIT-REM-TERM       PIC X.
  6897             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6898             20  FILLER                    PIC XX.
  6899         16  FILLER                        PIC X(80).
  6900
  6901     12  AM-TRANSFER-DATA.
  6902         16  AM-TRANSFERRED-FROM.
  6903             20  AM-TRNFROM-CARRIER        PIC X.
  6904             20  AM-TRNFROM-GROUPING.
  6905                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6906                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6907             20  AM-TRNFROM-STATE          PIC XX.
  6908             20  AM-TRNFROM-ACCOUNT.
  6909                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6910                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6911             20  AM-TRNFROM-DTE            PIC XX.
  6912         16  AM-TRANSFERRED-TO.
  6913             20  AM-TRNTO-CARRIER          PIC X.
  6914             20  AM-TRNTO-GROUPING.
  6915                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6916                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6917             20  AM-TRNTO-STATE            PIC XX.
  6918             20  AM-TRNTO-ACCOUNT.
  6919                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6920                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6921             20  AM-TRNTO-DTE              PIC XX.
  6922         16  FILLER                        PIC X(10).
  6923
  6924     12  AM-SAVED-REMIT-TO                 PIC 99.
  6925
  6926     12  AM-COMM-STRUCTURE-SAVED.
  6927         16  AM-DEFN-1-SAVED.
  6928             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6929                 24  AM-AGT-SV             PIC X(10).
  6930                 24  AM-COM-TYP-SV         PIC X.
  6931                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6932                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6933                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6934                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6935                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 127
* EL050.cbl
  6936                 24  AM-GL-CODES-SV        PIC X.
  6937                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6938                 24  FILLER                PIC X.
  6939         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6940             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6941                 24  FILLER                PIC X(11).
  6942                 24  AM-L-COMA-SV          PIC XXX.
  6943                 24  AM-J-COMA-SV          PIC XXX.
  6944                 24  AM-A-COMA-SV          PIC XXX.
  6945                 24  FILLER                PIC X(6).
  6946
  6947     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6948         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6949            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6950            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6951            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6952
  6953     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6954     12  FILLER                            PIC X(120).
  6955
  6956     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6957         16  AM-CONTROL-NAME               PIC X(30).
  6958         16  AM-EXECUTIVE-ONE.
  6959             20  AM-EXEC1-NAME             PIC X(15).
  6960             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6961                                                          COMP-3.
  6962             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6963                                                          COMP-3.
  6964         16  AM-EXECUTIVE-TWO.
  6965             20  AM-EXEC2-NAME             PIC X(15).
  6966             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6967                                                          COMP-3.
  6968             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6969                                                          COMP-3.
  6970
  6971     12  AM-RETRO-ADDITIONAL-DATA.
  6972         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6973         16  AM-RETRO-PREM-P-E             PIC X.
  6974         16  AM-RETRO-CLMS-P-I             PIC X.
  6975         16  AM-RETRO-RET-BRACKET-LF.
  6976             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6977                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6978                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6979             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6980                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6981                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6982             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6983                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6984                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6985         16  AM-RETRO-RET-BRACKET-AH.
  6986             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6987                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6988                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6989                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6990             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6991                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6992                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6993             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 128
* EL050.cbl
  6994                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6995                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6996
  6997     12  AM-COMMENTS.
  6998         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6999
  7000     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7001         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7002         16  AM-FLI-BILLING-CODE           PIC X.
  7003         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7004         16  AM-FLI-UNITED-IDENT           PIC X.
  7005         16  AM-FLI-INTEREST-LOST-DATA.
  7006             20  AM-FLI-BANK-NO            PIC X(5).
  7007             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7008             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7009             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7010         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7011             20  AM-FLI-AGT                PIC X(9).
  7012             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7013             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7014         16  FILLER                        PIC X(102).
  7015
  7016     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7017         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7018             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7019             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7020             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7021             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7022             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7023         16  FILLER                          PIC X(10).
  7024******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 129
* EL050.cbl
  7026*    COPY ERCREIN.
  7027******************************************************************
  7028*                                                                *
  7029*                            ERCREIN                             *
  7030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7031*                            VMOD=2.010                          *
  7032*                                                                *
  7033*   ONLINE CREDIT SYSTEM                                         *
  7034*                                                                *
  7035*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7036*                                                                *
  7037*   FILE TYPE = VSAM,KSDS                                        *
  7038*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7039*                                                                *
  7040*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7041*       ALTERNATE PATH = NONE                                    *
  7042*                                                                *
  7043*   LOG = NO                                                     *
  7044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7045*                                                                *
  7046******************************************************************
  7047*                   C H A N G E   L O G
  7048*
  7049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7050*-----------------------------------------------------------------
  7051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7052* EFFECTIVE    NUMBER
  7053*-----------------------------------------------------------------
  7054* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7055* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7056******************************************************************
  7057 01  REINSURANCE-RECORD.
  7058     12  RE-RECORD-ID                      PIC XX.
  7059         88  VALID-RE-ID                      VALUE 'RE'.
  7060
  7061     12  RE-CONTROL-PRIMARY.
  7062         16  RE-COMPANY-CD                 PIC X.
  7063         16  RE-KEY.
  7064             20  RE-CODE                   PIC X.
  7065                 88  RE-TABLE-RECORD          VALUE 'A'.
  7066                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7067             20  RE-TABLE                  PIC XXX.
  7068             20  FILLER                    PIC XXX.
  7069         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7070             20  FILLER                    PIC X.
  7071             20  RE-COMPANY.
  7072                 24  RE-COMP-PRIME         PIC XXX.
  7073                 24  RE-COMP-SUB           PIC XXX.
  7074
  7075     12  RE-MAINT-INFORMATION.
  7076         16  RE-LAST-MAINT-DT              PIC XX.
  7077         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7078         16  RE-LAST-MAINT-USER            PIC X(4).
  7079         16  FILLER                        PIC X(10).
  7080
  7081     12  RE-TABLE-DATA.
  7082         16  RE-100-COMP                   PIC 99.
  7083
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 130
* EL050.cbl
  7084         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7085             20  RE-REI-COMP-NO.
  7086                 24  RE-REI-COMP           PIC XXX.
  7087                 24  RE-REI-COMP-SUB       PIC XXX.
  7088             20  RE-LF-QC                  PIC X.
  7089             20  RE-AH-QC                  PIC X.
  7090             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7091             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7092             20  RE-LFAGE-LO               PIC 99.
  7093             20  RE-LFAGE-HI               PIC 99.
  7094             20  RE-AHAGE-LO               PIC 99.
  7095             20  RE-AHAGE-HI               PIC 99.
  7096             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7097             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7098             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7099             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7100             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7101             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7102             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7103             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7104             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7105             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7106             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7107             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7108             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7109             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7110             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7111             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7112             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7113             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7114             20  RE-LF-BEN-CODE            PIC X.
  7115             20  RE-AH-BEN-CODE            PIC X.
  7116             20  RE-INTERACTIVE            PIC X.
  7117             20  RE-REMAINING              PIC X.
  7118             20  RE-LF-RUNOFF-SW           PIC X.
  7119             20  RE-AH-RUNOFF-SW           PIC X.
  7120             20  FILLER                    PIC X(19).
  7121
  7122         16  RE-COMP-INFO-END              PIC X(6).
  7123         16  RE-NSP-ST-CD-LF               PIC XX.
  7124         16  RE-NSP-ST-CD-AH               PIC XX.
  7125         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7126             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7127
  7128         16  FILLER                        PIC X(27).
  7129
  7130     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7131         16  RE-NAME                       PIC X(30).
  7132         16  RE-LF-PE                      PIC X.
  7133         16  RE-AH-PE                      PIC X.
  7134         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7135         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7136         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7137         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7138         16  RE-PRT-ST                     PIC X.
  7139         16  RE-PRT-OW                     PIC X.
  7140         16  RE-MORT-CODE                  PIC X(4).
  7141         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 131
* EL050.cbl
  7142         16  RE-ZERO-LF-FEE                PIC X.
  7143         16  RE-ZERO-AH-FEE                PIC X.
  7144         16  RE-CEDE-NAME                  PIC X(30).
  7145         16  RE-LF-COMM                    PIC X.
  7146         16  RE-AH-COMM                    PIC X.
  7147         16  RE-LF-TAX                     PIC X.
  7148         16  RE-AH-TAX                     PIC X.
  7149         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7150         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7151         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7152
  7153         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7154             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7155
  7156         16  RE-LF-CEDING-FEE-BRACKETS.
  7157             20  RE-LF-FEE-METHOD          PIC X.
  7158                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7159                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7160                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7161                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7162             20  RE-LF-FEE-BASIS           PIC X.
  7163                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7164                 88  RE-LF-NET-CEDED               VALUE '2'.
  7165                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7166                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7167                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7168                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7169                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7170                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7171             20  FILLER                    PIC XXX.
  7172             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7173                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7174                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7175
  7176         16  RE-AH-CEDING-FEE-BRACKETS.
  7177             20  RE-AH-FEE-METHOD          PIC X.
  7178                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7179                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7180                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7181                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7182             20  RE-AH-FEE-BASIS           PIC X.
  7183                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7184                 88  RE-AH-NET-CEDED               VALUE '2'.
  7185                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7186                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7187                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7188                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7189                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7190                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7191             20  FILLER                    PIC XXX.
  7192             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7193                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7194                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7195
  7196         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7197
  7198         16  RE-OLD-CEDING-STMT            PIC X.
  7199
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 132
* EL050.cbl
  7200         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7201         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7202         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7203         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7204         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7205         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7206         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7207         16  RE-MORT-SW                    PIC X.
  7208         16  RE-CEDING-TYPE-FLAG           PIC X.
  7209             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7210             88  RE-CEDED                          VALUE 'C'.
  7211             88  RE-ASSUMED                        VALUE 'A'.
  7212             88  RE-PHANTOM                        VALUE 'P'.
  7213
  7214         16  RE-CEDING-STMT-OPT-A          PIC X.
  7215             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7216         16  RE-CEDING-STMT-OPT-B          PIC X.
  7217             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7218         16  RE-CEDING-STMT-OPT-C          PIC X.
  7219             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7220         16  RE-CEDING-STMT-OPT-D          PIC X.
  7221             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7222         16  RE-CEDING-STMT-OPT-E          PIC X.
  7223             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7224
  7225         16  RE-PRT-CRSV                   PIC X.
  7226
  7227         16  RE-GL-CENTER                  PIC X(4).
  7228
  7229         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7230
  7231         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7232
  7233         16  RE-EARN-STOP-CODE             PIC X.
  7234             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7235             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7236
  7237         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7238             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7239
  7240         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7241         16  FILLER                        PIC X(2281).
  7242
  7243         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7244
  7245******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 133
* EL050.cbl
  7247*    COPY ERCCTBL.
  7248******************************************************************
  7249*                                                                *
  7250*                                                                *
  7251*                            ERCCTBL                             *
  7252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7253*                            VMOD=2.003
  7254*                                                                *
  7255*   ONLINE CREDIT SYSTEM                                         *
  7256*                                                                *
  7257*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7258*                                                                *
  7259*   FILE TYPE = VSAM,KSDS                                        *
  7260*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7261*                                                                *
  7262*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7263*       ALTERNATE PATH = NONE                                    *
  7264*                                                                *
  7265*   LOG = NO                                                     *
  7266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7267*                                                                *
  7268*                                                                *
  7269******************************************************************
  7270
  7271 01  COMM-TABLE-RECORD.
  7272     12  CT-RECORD-ID                      PIC XX.
  7273         88  VALID-CT-ID                      VALUE 'CT'.
  7274
  7275     12  CT-CONTROL-PRIMARY.
  7276         16  CT-COMPANY-CD                 PIC X.
  7277         16  CT-TABLE                      PIC XXX.
  7278         16  CT-CNTRL-2.
  7279             20  CT-BEN-TYPE               PIC X.
  7280             20  CT-BEN-CODE               PIC XX.
  7281
  7282     12  CT-MAINT-INFORMATION.
  7283         16  CT-LAST-MAINT-DT              PIC XX.
  7284         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7285         16  CT-LAST-MAINT-USER            PIC X(4).
  7286         16  FILLER                        PIC X(31).
  7287
  7288     12  CT-LIMITS.
  7289         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7290
  7291         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7292
  7293         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7294
  7295     12  CT-RATES.
  7296         16  CT-RTX          OCCURS 27 TIMES.
  7297             20  CT-RT                     PIC SV9(5)     COMP-3.
  7298             20  CT-RT-R   REDEFINES
  7299                 CT-RT                     PIC XXX.
  7300
  7301     12  FILLER                            PIC  X(42).
  7302
  7303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 134
* EL050.cbl
  7305*    COPY ERCFORM.
  7306******************************************************************
  7307*                                                                *
  7308*                                                                *
  7309*                            ERCFORM.                            *
  7310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7311*                            VMOD=2.003                          *
  7312*                                                                *
  7313*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7314*                                                                *
  7315*    FILE TYPE = VSAM,KSDS                                       *
  7316*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7317*                                                                *
  7318*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7319*                                                                *
  7320*    LOG = YES                                                   *
  7321*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7322******************************************************************
  7323 01  FORM-MASTER.
  7324    12  FO-RECORD-ID                 PIC X(02).
  7325        88  VALID-FO-ID                  VALUE 'FO'.
  7326
  7327    12  FO-CONTROL-PRIMARY.
  7328        16  FO-COMPANY-CD            PIC X(01).
  7329        16  FO-STATE                 PIC X(02).
  7330        16  FO-FORM-ID               PIC X(12).
  7331        16  FO-FORM-EXP-DT           PIC X(02).
  7332
  7333    12  FO-POLICY-FORM-DATA.
  7334        16  FO-IND-GRP-CD            PIC X(01).
  7335        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7336        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7337        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7338        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7339        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7340        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7341        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7342        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7343        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7344        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7345        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7346        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7347        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7348        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7349        16  FO-APP-CERT-USE-CD       PIC X(01).
  7350
  7351    12  FILLER                       PIC X(29).
  7352
  7353    12  FO-FORM-PLAN-TABLE.
  7354        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7355            20  FO-PLAN-TYPE         PIC X(01).
  7356            20  FO-PLAN-ID           PIC X(02).
  7357            20  FO-PLAN-TERM         PIC 9(03).
  7358            20  FO-PLAN-REFUND-METHOD
  7359                                     PIC X.
  7360
  7361    12  FILLER                       PIC X(30).
  7362
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 135
* EL050.cbl
  7363    12  FO-COMMENTS-AREA.
  7364        16  FO-COMMENT-LINE-1        PIC X(78).
  7365
  7366    12  FILLER                       PIC X(20).
  7367
  7368    12  FO-MAINT-INFORMATION.
  7369        16  FO-LAST-MAINT-DT         PIC X(02).
  7370        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7371        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 136
* EL050.cbl
  7373*    COPY ELCMSTR.
  7374******************************************************************
  7375*                                                                *
  7376*                            ELCMSTR.                            *
  7377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7378*                            VMOD=2.012                          *
  7379*                                                                *
  7380*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7381*                                                                *
  7382*   FILE TYPE = VSAM,KSDS                                        *
  7383*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7384*                                                                *
  7385*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7386*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7387*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7388*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7389*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7390*                                                 RKP=75,LEN=21  *
  7391*                                                                *
  7392*   **** NOTE ****                                               *
  7393*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7394*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7395*                                                                *
  7396*   LOG = YES                                                    *
  7397*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7398******************************************************************
  7399*                   C H A N G E   L O G
  7400*
  7401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7402*-----------------------------------------------------------------
  7403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7404* EFFECTIVE    NUMBER
  7405*-----------------------------------------------------------------
  7406* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7407* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7408* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7409* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7410* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7411******************************************************************
  7412 01  CLAIM-MASTER.
  7413     12  CL-RECORD-ID                PIC XX.
  7414         88  VALID-CL-ID         VALUE 'CL'.
  7415
  7416     12  CL-CONTROL-PRIMARY.
  7417         16  CL-COMPANY-CD           PIC X.
  7418         16  CL-CARRIER              PIC X.
  7419         16  CL-CLAIM-NO             PIC X(7).
  7420         16  CL-CERT-NO.
  7421             20  CL-CERT-PRIME       PIC X(10).
  7422             20  CL-CERT-SFX         PIC X.
  7423
  7424     12  CL-CONTROL-BY-NAME.
  7425         16  CL-COMPANY-CD-A1        PIC X.
  7426         16  CL-INSURED-LAST-NAME    PIC X(15).
  7427         16  CL-INSURED-NAME.
  7428             20  CL-INSURED-1ST-NAME PIC X(12).
  7429             20  CL-INSURED-MID-INIT PIC X.
  7430
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 137
* EL050.cbl
  7431     12  CL-CONTROL-BY-SSN.
  7432         16  CL-COMPANY-CD-A2        PIC X.
  7433         16  CL-SOC-SEC-NO.
  7434             20  CL-SSN-STATE        PIC XX.
  7435             20  CL-SSN-ACCOUNT      PIC X(6).
  7436             20  CL-SSN-LN3          PIC X(3).
  7437
  7438     12  CL-CONTROL-BY-CERT-NO.
  7439         16  CL-COMPANY-CD-A4        PIC X.
  7440         16  CL-CERT-NO-A4.
  7441             20  CL-CERT-A4-PRIME    PIC X(10).
  7442             20  CL-CERT-A4-SFX      PIC X.
  7443
  7444     12  CL-CONTROL-BY-CCN.
  7445         16  CL-COMPANY-CD-A5        PIC X.
  7446         16  CL-CCN-A5.
  7447             20  CL-CCN.
  7448                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7449                 24  CL-CCN-PRIME-A5 PIC X(12).
  7450             20  CL-CCN-FILLER-A5    PIC X(4).
  7451
  7452     12  CL-INSURED-PROFILE-DATA.
  7453         16  CL-INSURED-BIRTH-DT     PIC XX.
  7454         16  CL-INSURED-SEX-CD       PIC X.
  7455             88  INSURED-IS-MALE        VALUE 'M'.
  7456             88  INSURED-IS-FEMALE      VALUE 'F'.
  7457             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7458         16  CL-INSURED-OCC-CD       PIC X(6).
  7459         16  FILLER                  PIC X(5).
  7460
  7461     12  CL-PROCESSING-INFO.
  7462         16  CL-PROCESSOR-ID         PIC X(4).
  7463         16  CL-CLAIM-STATUS         PIC X.
  7464             88  CLAIM-IS-OPEN          VALUE 'O'.
  7465             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7466         16  CL-CLAIM-TYPE           PIC X.
  7467*            88  AH-CLAIM               VALUE 'A'.
  7468*            88  LIFE-CLAIM             VALUE 'L'.
  7469*            88  PROPERTY-CLAIM         VALUE 'P'.
  7470*            88  IUI-CLAIM              VALUE 'I'.
  7471*            88  GAP-CLAIM              VALUE 'G'.
  7472*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7473         16  CL-CLAIM-PREM-TYPE      PIC X.
  7474             88  SINGLE-PREMIUM         VALUE '1'.
  7475             88  O-B-COVERAGE           VALUE '2'.
  7476             88  OPEN-END-COVERAGE      VALUE '3'.
  7477         16  CL-INCURRED-DT          PIC XX.
  7478         16  CL-REPORTED-DT          PIC XX.
  7479         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7480         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7481         16  CL-LAST-PMT-DT          PIC XX.
  7482         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7483         16  CL-PAID-THRU-DT         PIC XX.
  7484         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7485         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7486         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7487         16  CL-PMT-CALC-METHOD      PIC X.
  7488             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 138
* EL050.cbl
  7489             88  CL-365-DAY-YR          VALUE '2'.
  7490             88  CL-FULL-MONTHS         VALUE '3'.
  7491         16  CL-CAUSE-CD             PIC X(6).
  7492
  7493         16  CL-PRIME-CERT-NO.
  7494             20  CL-PRIME-CERT-PRIME PIC X(10).
  7495             20  CL-PRIME-CERT-SFX   PIC X.
  7496
  7497         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7498             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7499             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7500
  7501         16  CL-MICROFILM-NO         PIC X(10).
  7502         16  FILLER REDEFINES CL-MICROFILM-NO.
  7503             20  CL-BENEFIT-PERIOD   PIC 99.
  7504             20  FILLER              PIC X(8).
  7505         16  CL-PROG-FORM-TYPE       PIC X.
  7506         16  CL-LAST-ADD-ON-DT       PIC XX.
  7507
  7508         16  CL-LAST-REOPEN-DT       PIC XX.
  7509         16  CL-LAST-CLOSE-DT        PIC XX.
  7510         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7511             88  FINAL-PAID             VALUE '1'.
  7512             88  CLAIM-DENIED           VALUE '2'.
  7513             88  AUTO-CLOSE             VALUE '3'.
  7514             88  MANUAL-CLOSE           VALUE '4'.
  7515             88  BENEFITS-CHANGED       VALUE 'C'.
  7516             88  SETUP-ERRORS           VALUE 'E'.
  7517         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7518         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7519         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7520             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7521         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7522         16  FILLER                  PIC X.
  7523
  7524     12  CL-CERTIFICATE-DATA.
  7525         16  CL-CERT-ORIGIN          PIC X.
  7526             88  CERT-WAS-ONLINE        VALUE '1'.
  7527             88  CERT-WAS-CREATED       VALUE '2'.
  7528             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7529         16  CL-CERT-KEY-DATA.
  7530             20  CL-CERT-CARRIER     PIC X.
  7531             20  CL-CERT-GROUPING    PIC X(6).
  7532             20  CL-CERT-STATE       PIC XX.
  7533             20  CL-CERT-ACCOUNT.
  7534                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7535                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7536             20  CL-CERT-EFF-DT      PIC XX.
  7537
  7538     12  CL-STATUS-CONTROLS.
  7539         16  CL-PRIORITY-CD          PIC X.
  7540             88  CONFIDENTIAL-DATA      VALUE '8'.
  7541             88  HIGHEST-PRIORITY       VALUE '9'.
  7542         16  CL-SUPV-ATTN-CD         PIC X.
  7543             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7544             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7545         16  CL-PURGED-DT            PIC XX.
  7546         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 139
* EL050.cbl
  7547         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7548         16  CL-NEXT-RESEND-DT       PIC XX.
  7549         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7550         16  CL-CRITICAL-PERIOD      PIC 99.
  7551*        16  FILLER                  PIC XX.
  7552         16  CL-LAST-MAINT-DT        PIC XX.
  7553         16  CL-LAST-MAINT-USER      PIC X(4).
  7554         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7555         16  CL-LAST-MAINT-TYPE      PIC X.
  7556             88  CLAIM-SET-UP           VALUE ' '.
  7557             88  PAYMENT-MADE           VALUE '1'.
  7558             88  LETTER-SENT            VALUE '2'.
  7559             88  MASTER-WAS-ALTERED     VALUE '3'.
  7560             88  MASTER-WAS-RESTORED    VALUE '4'.
  7561             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7562             88  FILE-CONVERTED         VALUE '6'.
  7563             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7564             88  ERROR-CORRECTION       VALUE 'E'.
  7565         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7566         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7567         16  CL-BENEFICIARY          PIC X(10).
  7568         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7569         16  CL-DENIAL-TYPE          PIC X.
  7570             88  CL-TYPE-DENIAL          VALUE '1'.
  7571             88  CL-TYPE-RESCISSION      VALUE '2'.
  7572             88  CL-TYPE-REFORMATION     VALUE '3'.
  7573             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7574             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7575         16  filler                  pic x(5).
  7576*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7577*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7578*        16  CL-RTW-DT               PIC XX.
  7579
  7580     12  CL-TRAILER-CONTROLS.
  7581         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7582             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7583             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7584             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7585         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7586         16  FILLER                  PIC XX.
  7587         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7588         16  CL-ADDRESS-TRAILER-CNT.
  7589             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7590                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7591             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7592                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7593             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7594                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7595             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7596                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7597             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7598                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7599             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7600                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7601             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7602                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7603
  7604     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 140
* EL050.cbl
  7605         16  CL-CV-REFNO-PRIME       PIC X(18).
  7606         16  CL-CV-REFNO-SFX         PIC XX.
  7607
  7608     12  CL-FILE-LOCATION            PIC X(4).
  7609
  7610     12  CL-PROCESS-ERRORS.
  7611         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7612             88  NO-FATAL-ERRORS        VALUE ZERO.
  7613         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7614             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7615
  7616     12  CL-PRODUCT-CD               PIC X.
  7617
  7618     12  CL-CURRENT-KEY-DATA.
  7619         16  CL-CURRENT-CARRIER      PIC X.
  7620         16  CL-CURRENT-GROUPING     PIC X(6).
  7621         16  CL-CURRENT-STATE        PIC XX.
  7622         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7623
  7624     12  CL-ASSOCIATES               PIC X.
  7625         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7626         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7627         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7628         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7629
  7630     12  CL-ACTIVITY-CODE            PIC 99.
  7631     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7632     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7633
  7634     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7635     12  CL-LAG-REPORT-CODE          PIC 9.
  7636     12  CL-LOAN-TYPE                PIC XX.
  7637     12  CL-LEGAL-STATE              PIC XX.
  7638
  7639     12  CL-YESNOSW                  PIC X.
  7640     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7641         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7642         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7643         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7644     12  cl-insured-type             pic x.
  7645         88  cl-claim-on-primary         value 'P'.
  7646         88  cl-claim-on-co-borrower     value 'C'.
  7647     12  cl-benefit-expiration-dt    PIC XX.
  7648
  7649 01  PLAN-RECORDS.
  7650     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7651     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7652
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 141
* EL050.cbl
  7654 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7655                          ACCOUNT-MASTER REINSURANCE-RECORD
  7656                          COMM-TABLE-RECORD FORM-MASTER
  7657                          CLAIM-MASTER PLAN-RECORDS.
  7658 0000-DFHEXIT SECTION.
  7659     MOVE '9#                    $   ' TO DFHEIV0.
  7660     MOVE 'EL050' TO DFHEIV1.
  7661     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7662
  7663     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7664
  7665
  7666* EXEC CICS  HANDLE CONDITION
  7667*           ERROR    (9300-ABEND)
  7668*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7669*    END-EXEC.
  7670*    MOVE '"$.J                  ! " #00007661' TO DFHEIV0
  7671     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7673     MOVE X'2220233030303037363631' TO DFHEIV0(25:11)
  7674     CALL 'kxdfhei1' USING DFHEIV0
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678 0000-COPY-PROCEDURE-DIV.
  7679*                          COPY ELC50PD.
  7680******************************************************************
  7681*                                                                *
  7682*                            ELC50PD                             *
  7683*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7684*                            VMOD=2.188                          *
  7685*                                                                *
  7686******************************************************************
  7687*                   C H A N G E   L O G
  7688*
  7689* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7690*-----------------------------------------------------------------
  7691*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7692* EFFECTIVE    NUMBER
  7693*-----------------------------------------------------------------
  7694* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7695* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7696* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7697*                             2709 AND 2718
  7698* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7699* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7700* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7701* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7702* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7703*                                IS OPEN OR CNC DT < PD THRU
  7704* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7705* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7706* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7707* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7708* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7709* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7710* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7711* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 142
* EL050.cbl
  7712* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7713* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7714* 020906                   PEMA  EXPAND LOAN OFFICER
  7715* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7716* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7717* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7718* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7719* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7720* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7721* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7722* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7723* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7724* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7725* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7726* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7727* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7728* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7729* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7730* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7731* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7732* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7733* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7734* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7735* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7736* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7737* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7738* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7739* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7740*                                UPDATE VIN ON CERT TRAILER
  7741* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7742* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7743* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7744* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7745* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7746* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7747* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7748* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7749* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7750* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7751* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7752* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7753* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7754* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7755* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7756* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7757* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7758* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7759* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7760* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7761* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7762* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7763* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7764* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7765* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7766* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7767* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7768* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7769* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 143
* EL050.cbl
  7770* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7771* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7772* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7773* 032912  CR2011110200001  PEMA  AHL CHANGES
  7774* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7775* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7776* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7777* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7778* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7779* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7780* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7781* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7782* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7783* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7784* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7785* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7786* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7787* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7788* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7789* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7790* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7791* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7792* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7793* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7794* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7795* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7796* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7797* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7798* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7799* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7800* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7801*                                CERT #, ADD 2898 FORCIBLE ERROR
  7802* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7803* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7804* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7805* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7806* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7807* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7808* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7809* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7810* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7811* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7812* 05256   IR2016052400001  PEMA  Correct malformed IF stmt.
  7813******************************************************************
  7814************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7815******************************************************************
  7816
  7817     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7818
  7819     MOVE SPACES                 TO PB-FATAL-FLAG
  7820                                    PB-FORCE-ER-CD
  7821                                    PB-WARN-ER-CD
  7822                                    PB-OUT-BAL-CD.
  7823
  7824     MOVE SPACE                  TO WS-IG-OVRD-AH
  7825                                    WS-IG-OVRD-LF
  7826                                    WS-IG-OVRD-AM
  7827                                    WS-IG-OVRD
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 144
* EL050.cbl
  7828                                    WS-IG-OVRD-AH-PL
  7829                                    WS-IG-OVRD-LF-PL
  7830                                    WS-IG-OVRD-AH-BEN
  7831                                    WS-IG-OVRD-LF-BEN.
  7832
  7833******************************************************************
  7834*************       INITIALIZE COMMON ERRORS       ***************
  7835******************************************************************
  7836
  7837     MOVE +0                     TO PB-NO-OF-ERRORS.
  7838     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7839
  7840******************************************************************
  7841
  7842     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7843     SET JULIAN-TO-BIN           TO TRUE.
  7844*    MOVE 5                      TO DC-OPTION-CODE.
  7845     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7846     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7847
  7848     MOVE ZERO                   TO  SUB4.
  7849
  7850 0040-INITIALIZE-GA-BILL-DT.
  7851
  7852     ADD +1                      TO  SUB4.
  7853
  7854     IF  SUB4 GREATER THAN +5
  7855         GO TO 0050-CHECK-CNTL-FOUND.
  7856
  7857     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7858         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7859
  7860     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7861
  7862 0050-CHECK-CNTL-FOUND.
  7863
  7864     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7865        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7866                                         WS-AH-REM-TERM-CALC
  7867                                         EC-CO-REM-TERM-CALC
  7868        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7869        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7870        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7871                                         WS-TOL-AH-CLAIM
  7872        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7873                                         WS-TOL-AH-PREM
  7874                                         EC-CO-TOL-PREM
  7875        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7876                                         WS-TOL-AH-REFUND
  7877                                         EC-CO-TOL-REFUND
  7878        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7879                                         WS-AH-REFUND-OVS-AMT
  7880                                         EC-CO-OVR-SHT-AMT
  7881        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7882                                         WS-TOL-AH-PREM-PCT
  7883                                         EC-CO-TOL-PREM-PCT
  7884        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7885                                         WS-TOL-AH-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 145
* EL050.cbl
  7886                                         EC-CO-TOL-REFUND-PCT
  7887        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7888                                         WS-AH-REFUND-OVS-PCT
  7889                                         EC-CO-OVR-SHT-PCT
  7890        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7891        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7892        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7893        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7894        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7895        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7896        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7897        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7898        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7899        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7900        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7901        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7902                                         EC-CO-MONTH-END-DT
  7903        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7904          GO TO 0100-READ-ACCT.
  7905
  7906     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7907     MOVE SPACES                 TO CNTL-ACCESS.
  7908     MOVE '1'                    TO CNTL-REC-TYPE.
  7909     MOVE +0                     TO CNTL-SEQ-NO.
  7910
  7911     MOVE '1' TO RC-SW-1.
  7912     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7913     IF NOT CF-COMPANY-MASTER
  7914         MOVE ZEROS             TO WK-CO-TOL-PREM
  7915                                   WK-CO-TOL-CLAIM
  7916                                   WK-CO-TOL-REFUND
  7917                                   WK-REFUND-OVS-AMT
  7918                                   WK-REFUND-OVS-PCT
  7919                                   WK-CO-TOL-PREM-PCT
  7920                                   WK-CO-TOL-REFUND-PCT
  7921                                   WK-DEFAULT-APR
  7922                                   WK-CO-MAX-CAP
  7923        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7924                                   WK-CR-R78-METHOD
  7925                                   WK-CO-REF-REJECT-SW
  7926                                   WK-CO-PREM-REJECT-SW
  7927                                   WK-REM-TRM-CALC-OPTION
  7928                                   WK-BIRTH-DATE-INPUT
  7929                                   WK-JOINT-AGE-INPUT
  7930        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7931        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7932        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7933        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7934          GO TO 0099-COMPANY-NOT-FOUND.
  7935
  7936     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7937        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7938     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7939        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7940     IF CF-CO-TOL-CAP NOT NUMERIC
  7941        MOVE +0                    TO CF-CO-TOL-CAP.
  7942     IF CF-DEFAULT-APR NOT NUMERIC
  7943        MOVE +0                    TO CF-DEFAULT-APR.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 146
* EL050.cbl
  7944
  7945     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7946     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7947     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7948     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7949     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7950     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7951     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7952     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7953     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7954     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7955     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7956     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7957
  7958     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7959          CF-CO-OVR-SHT-AMT > +0
  7960        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7961
  7962     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7963          CF-CO-OVR-SHT-PCT > +0
  7964        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7965
  7966     IF CF-VALID-REM-TRM-OPTION
  7967         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7968     ELSE
  7969         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7970
  7971     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7972     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7973     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7974     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7975
  7976     GO TO 0050-CHECK-CNTL-FOUND.
  7977
  7978 0099-COMPANY-NOT-FOUND.
  7979
  7980     MOVE ER-2616                TO WS-ERROR.
  7981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7982
  7983 0100-READ-ACCT.
  7984
  7985     MOVE SPACES                 TO DATE-RANGE-SW.
  7986
  7987     IF WK-ACCT-ADDR = ZEROS
  7988        GO TO 0102-ACCT-GETMAIN.
  7989
  7990     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7991     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7992     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7993
  7994     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7995        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7996        GO TO 0105-READ-ACCT
  7997     END-IF
  7998
  7999     IF PB-CARRIER NOT = SPACES
  8000        IF PB-CARRIER NOT = AM-VG-CARRIER
  8001           GO TO 0105-READ-ACCT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 147
* EL050.cbl
  8002
  8003     IF PB-STATE NOT = SPACES
  8004        IF PB-STATE NOT = AM-VG-STATE
  8005           GO TO 0105-READ-ACCT.
  8006
  8007     IF PB-GROUPING NOT = SPACES
  8008        IF PB-GROUPING NOT = AM-VG-GROUPING
  8009           GO TO 0105-READ-ACCT.
  8010
  8011     MOVE 'X'                 TO DATE-RANGE-SW.
  8012
  8013     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8014        MOVE 'X'                 TO DATE-RANGE-SW
  8015        GO TO 0105-READ-ACCT.
  8016
  8017     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8018        GO TO 0105-READ-ACCT.
  8019
  8020     GO TO 0180-ACCOUNT-FOUND.
  8021
  8022 0102-ACCT-GETMAIN.
  8023     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8024     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8025
  8026 0105-READ-ACCT.
  8027     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8028     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8029     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8030     MOVE PB-STATE               TO ACCT-STATE.
  8031     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8032     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8033
  8034     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8035
  8036     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8037
  8038 0110-FIND-ACCT-TOLERANCES-LOOP.
  8039     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8040
  8041     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8042        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8043        GO TO 0199-ACCT-NOT-FOUND
  8044     END-IF
  8045     IF PB-CARRIER NOT = SPACES
  8046        IF PB-CARRIER NOT = AM-VG-CARRIER
  8047           GO TO 0199-ACCT-NOT-FOUND.
  8048
  8049     IF PB-STATE NOT = SPACES
  8050        IF PB-STATE NOT = AM-VG-STATE
  8051           GO TO 0199-ACCT-NOT-FOUND.
  8052
  8053     IF PB-GROUPING NOT = SPACES
  8054        IF PB-GROUPING NOT = AM-VG-GROUPING
  8055           GO TO 0199-ACCT-NOT-FOUND.
  8056
  8057     MOVE 'X'                    TO DATE-RANGE-SW.
  8058
  8059     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 148
* EL050.cbl
  8060        MOVE 'X'                 TO DATE-RANGE-SW
  8061        GO TO 0199-ACCT-NOT-FOUND.
  8062
  8063     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8064        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8065
  8066 0180-ACCOUNT-FOUND.
  8067     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8068     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8069     MOVE AM-STATE               TO PB-SV-STATE.
  8070     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8071
  8072     IF AM-CANCEL-FEE  NOT NUMERIC
  8073        MOVE ZEROS TO AM-CANCEL-FEE.
  8074
  8075     IF AM-MAX-MON-BEN NOT NUMERIC
  8076        MOVE ZEROS TO AM-MAX-MON-BEN.
  8077
  8078     IF AM-MAX-TOT-BEN NOT NUMERIC
  8079        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8080
  8081     IF AM-CLP-TOL-PCT NOT NUMERIC
  8082        MOVE +0                  TO AM-CLP-TOL-PCT
  8083     END-IF
  8084     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8085        MOVE +0                  TO AM-SPP-LEASE-COMM
  8086     END-IF
  8087     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8088        MOVE ER-2611             TO   WS-ERROR
  8089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8090
  8091     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8092        MOVE ER-2621             TO   WS-ERROR
  8093        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8094
  8095     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8096        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8097        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8098        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8099         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8100
  8101     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8102     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8103     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8104     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8105     IF AM-CLP-TOL-PCT NOT = ZEROS
  8106        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8107     END-IF
  8108     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8109        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8110     END-IF
  8111*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8112*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8113*                                   WS-ADMIN-FEES
  8114*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8115*          (SUB5 > +10)
  8116*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8117*             AND (AM-A-COM (SUB5) NUMERIC)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 149
* EL050.cbl
  8118*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8119*                + (AM-A-COM (SUB5) * 1000)
  8120*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8121*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8122*                + (AM-A-COM (SUB5) * 1000)
  8123*             END-IF
  8124*             IF AM-COM-TYP (SUB5) = 'N'
  8125*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8126*                + (AM-A-COM (SUB5) * 1000)
  8127*             END-IF
  8128*          END-IF
  8129*       END-PERFORM
  8130*    END-IF
  8131     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8132        AND (PB-ISSUE)
  8133        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8134                                    ws-cred-union-fees
  8135        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8136           (SUB5 > +10)
  8137           MOVE +0 TO WS-WK-RATE
  8138           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8139                                   'O' OR 'S')
  8140              IF (AM-A-COM (SUB5) NUMERIC)
  8141                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8142                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8143              ELSE
  8144                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8145                 IF PB-ISSUE
  8146                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8147                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8148                 ELSE
  8149                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8150                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8151                 END-IF
  8152                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8153                 MOVE ZEROS             TO WS-SUB1
  8154                                           WS-COMMISSION
  8155                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8156                 MOVE '0530'               TO CTBL-SW
  8157                 MOVE ' '                  TO WS-CTBL-READ-SW
  8158                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8159                 IF FIRST-TIME-THROUGH
  8160                    MOVE 'AA'              TO CTBL-BEN-CODE
  8161                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8162                 END-IF
  8163                 IF CTBL-TABLE-FOUND
  8164                    IF PB-ISSUE
  8165                       COMPUTE WS-COMM-CK-AMT =
  8166                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8167                    ELSE
  8168                       COMPUTE WS-COMM-CK-AMT =
  8169                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8170                    END-IF
  8171                    PERFORM 8800-GET-COMP-RATE
  8172                              THRU 8800-EXIT
  8173                 END-IF
  8174              END-IF
  8175              if am-com-typ (sub5) = 'O' or 'S'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 150
* EL050.cbl
  8176                 compute ws-cred-union-fees rounded =
  8177                    ws-cred-union-fees +
  8178                    (pb-i-ah-premium-amt * ws-wk-rate)
  8179              else
  8180                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8181                + (WS-WK-RATE * 1000)
  8182              end-if
  8183           END-IF
  8184        END-PERFORM
  8185     END-IF
  8186     IF PB-COMPANY-ID EQUAL 'CRI'
  8187         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8188
  8189     IF PB-COMPANY-ID EQUAL 'NCL'
  8190         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8191     END-IF
  8192
  8193     GO TO 0200-READ-CERT.
  8194
  8195 0199-ACCT-NOT-FOUND.
  8196
  8197     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8198
  8199     IF DATE-RANGE-SW NOT = SPACES
  8200        MOVE ER-2601             TO WS-ERROR
  8201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8202     ELSE
  8203        MOVE ER-2619             TO WS-ERROR
  8204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8205
  8206     GO TO 9990-RETURN.
  8207
  8208 0200-READ-CERT.
  8209
  8210     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8211     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8212     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8213     MOVE PB-SV-STATE            TO CERT-STATE.
  8214     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8215     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8216     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8217
  8218     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8219
  8220     IF CERT-WAS-NOT-FOUND
  8221        GO TO 0299-CERT-NOT-FOUND.
  8222
  8223     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8224        MOVE ER-2759             TO WS-ERROR
  8225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8226        GO TO 0298-UNLOCK-RETURN.
  8227
  8228     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8229         MOVE ER-2758            TO WS-ERROR
  8230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8231         GO TO 0298-UNLOCK-RETURN.
  8232
  8233     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 151
* EL050.cbl
  8234        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8235           IF CERT-WAS-CREATED-FOR-CLAIM
  8236              NEXT SENTENCE
  8237            ELSE
  8238              MOVE ER-2626       TO WS-ERROR
  8239              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8240              GO TO 0298-UNLOCK-RETURN.
  8241
  8242     IF NOT PB-CANCELLATION
  8243        GO TO 0300-CONTINUE-EDIT.
  8244
  8245     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8246     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8247     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8248     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8249     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8250     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8251
  8252     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8253     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8254     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8255     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8256     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8257     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8258     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8259     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8260     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8261
  8262     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8263     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8264     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8265     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8266     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8267     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8268     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8269
  8270     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8271     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8272
  8273     MOVE CM-CREDIT-INTERFACE-SW-1
  8274                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8275     MOVE CM-CREDIT-INTERFACE-SW-2
  8276                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8277
  8278     IF CM-O-B-COVERAGE
  8279         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8280
  8281     IF CM-LIVES NOT NUMERIC
  8282         MOVE ZERO                TO CM-LIVES.
  8283
  8284     IF CM-BILLED NOT NUMERIC
  8285         MOVE ZERO                TO CM-BILLED.
  8286
  8287     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8288         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8289         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8290         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8291         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 152
* EL050.cbl
  8292         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8293         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8294         MOVE CM-LIVES             TO PB-CI-LIVES
  8295*The next line causes a problem with my change  I dont think it is
  8296*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8297
  8298     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8299     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8300     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8301     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8302     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8303     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8304
  8305     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8306     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8307     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8308     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8309
  8310     IF CM-LIFE-COMM-PCT NUMERIC
  8311         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8312     ELSE
  8313         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8314
  8315     IF CM-AH-COMM-PCT NUMERIC
  8316         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8317     ELSE
  8318         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8319
  8320     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8321
  8322     IF CM-LOAN-APR       NOT NUMERIC
  8323           MOVE ZERO               TO CM-LOAN-APR.
  8324
  8325     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8326           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8327
  8328     IF CM-LOAN-TERM      NOT NUMERIC
  8329           MOVE ZERO               TO CM-LOAN-TERM.
  8330
  8331     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8332           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8333
  8334     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8335           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8336
  8337     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8338     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8339     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8340     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8341     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8342     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8343     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8344     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8345     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8346     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8347     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8348     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8349
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 153
* EL050.cbl
  8350     IF CM-STATE = CM-SSN-STATE
  8351         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8352
  8353     IF CM-STATE NOT = CM-MEMB-STATE
  8354         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8355
  8356     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8357
  8358     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8359        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8360        IF CM-ADDL-CLP NOT NUMERIC
  8361           MOVE +0               TO CM-ADDL-CLP
  8362        END-IF
  8363        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8364        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8365           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8366        END-IF
  8367     END-IF
  8368     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8369        MOVE +0                  TO WS-ADMIN-FEES
  8370                                    WS-CSO-ADMIN-FEE
  8371                                    WS-COMM-AND-MFEE
  8372                                    WS-1ST-YR-ALLOW
  8373        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8374           (SUB5 > +10)
  8375           MOVE +0 TO WS-WK-RATE
  8376           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8377              IF (AM-A-COM (SUB5) NUMERIC)
  8378                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8379                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8380              ELSE
  8381                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8382                 IF PB-ISSUE
  8383                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8384                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8385                 ELSE
  8386                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8387                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8388                 END-IF
  8389                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8390                 MOVE ZEROS             TO WS-SUB1
  8391                                           WS-COMMISSION
  8392                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8393                 MOVE '0530'               TO CTBL-SW
  8394                 MOVE ' '                  TO WS-CTBL-READ-SW
  8395                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8396                 IF FIRST-TIME-THROUGH
  8397                    MOVE 'AA'              TO CTBL-BEN-CODE
  8398                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8399                 END-IF
  8400                 IF CTBL-TABLE-FOUND
  8401                    IF PB-ISSUE
  8402                       COMPUTE WS-COMM-CK-AMT =
  8403                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8404                    ELSE
  8405                       COMPUTE WS-COMM-CK-AMT =
  8406                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8407                    END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 154
* EL050.cbl
  8408                    PERFORM 8800-GET-COMP-RATE
  8409                              THRU 8800-EXIT
  8410                 END-IF
  8411              END-IF
  8412              IF AM-COM-TYP (SUB5) = 'I'
  8413                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8414                   + (WS-WK-RATE * 1000)
  8415              END-IF
  8416              IF AM-COM-TYP (SUB5) = 'N'
  8417                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8418                   + (WS-WK-RATE * 1000)
  8419              END-IF
  8420              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8421                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8422                   + (WS-WK-RATE * 1000)
  8423              END-IF
  8424              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8425                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8426                   + (WS-WK-RATE * 1000)
  8427              END-IF
  8428           END-IF
  8429        END-PERFORM
  8430     END-IF
  8431     GO TO 0300-CONTINUE-EDIT.
  8432
  8433 0298-UNLOCK-RETURN.
  8434      PERFORM 9250-UNLOCK-RETURN
  8435      GO TO 9990-RETURN.
  8436
  8437 0299-CERT-NOT-FOUND.
  8438
  8439     MOVE '1'                     TO CERT-STATUS-SW.
  8440
  8441     IF PB-COMPANY-ID = 'UCL'
  8442         IF WS-ERROR = ER-2799
  8443             GO TO 3000-CONTINUE-EDIT.
  8444
  8445     IF NOT PB-CANCELLATION
  8446         GO TO 0300-CONTINUE-EDIT.
  8447
  8448     MOVE ER-2726                  TO  WS-ERROR.
  8449     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8450     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8451     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8452                                    PB-CI-LF-TERM
  8453                                    PB-C-LF-REM-TERM
  8454                                    PB-CI-AH-TERM
  8455                                    PB-C-AH-REM-TERM
  8456                                    PB-CI-LF-BENEFIT-CD
  8457                                    PB-CI-LF-BENEFIT-AMT
  8458                                    PB-CI-LF-ALT-BENEFIT-AMT
  8459                                    PB-CI-LF-PREMIUM-AMT
  8460                                    PB-CI-LF-ALT-PREMIUM-AMT
  8461                                    PB-CI-AH-BENEFIT-CD
  8462                                    PB-CI-AH-BENEFIT-AMT
  8463                                    PB-CI-AH-PREMIUM-AMT
  8464                                    PB-CI-PAY-FREQUENCY
  8465                                    PB-CI-LOAN-APR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 155
* EL050.cbl
  8466                                    PB-CI-LOAN-TERM
  8467                                    PB-CI-LIFE-COMMISSION
  8468                                    PB-CI-AH-COMMISSION
  8469                                    PB-CI-CURR-SEQ
  8470                                    PB-CI-AH-CANCEL-AMT
  8471                                    PB-CI-LF-CANCEL-AMT
  8472                                    PB-CI-RATE-DEV-PCT-LF
  8473                                    PB-CI-RATE-DEV-PCT-AH
  8474                                    PB-CI-EXTENTION-DAYS
  8475                                    PB-CI-TERM-IN-DAYS
  8476                                    PB-CI-LIVES
  8477                                    PB-CI-LF-CRIT-PER
  8478                                    PB-CI-AH-CRIT-PER
  8479                                    PB-CI-ADDL-CLP
  8480                                    PB-CI-DDF-IU-RATE-UP.
  8481
  8482     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8483                                    PB-CI-AH-SETTLEMENT-DT
  8484                                    PB-CI-DEATH-DT
  8485                                    PB-CI-LF-PRIOR-CANCEL-DT
  8486                                    PB-CI-AH-PRIOR-CANCEL-DT
  8487                                    PB-CI-ENTRY-DT
  8488                                    PB-CI-LF-EXPIRE-DT
  8489                                    PB-CI-AH-EXPIRE-DT
  8490                                    PB-CI-LOAN-1ST-PMT-DT.
  8491
  8492     IF ACCOUNT-MAST-FOUND
  8493        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8494        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8495
  8496
  8497 0300-CONTINUE-EDIT.
  8498
  8499     IF PB-ISSUE
  8500        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8501            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8502
  8503     IF PB-ISSUE
  8504        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8505            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8506
  8507     IF PB-ISSUE
  8508       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8509          (AM-NO-AH-ONLY)
  8510           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8511               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8512                   MOVE ER-2679 TO WS-ERROR
  8513                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8514
  8515     IF PB-ISSUE
  8516        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8517        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8518        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8519     ELSE
  8520        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8521        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8522        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8523
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 156
* EL050.cbl
  8524     MOVE 'N'                    TO PLAN-MASTER-SW
  8525                                    PLAN-MASTER-LIFE-SW
  8526                                    FORM-MASTER-SW
  8527                                    WS-APP-CERT-SW.
  8528
  8529     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8530                                    WS-PL-TOL-LF-REFUND
  8531                                    WS-PL-REF-OVS-AMT
  8532                                    WS-PL-TOL-LF-PREM-PCT
  8533                                    WS-PL-TOL-LF-REFUND-PCT
  8534                                    WS-PL-REF-OVS-PCT
  8535                                    WS-PL-TOL-LF-CLAIM.
  8536
  8537     IF PB-COMPANY-ID = 'NCL'
  8538       IF PB-ISSUE
  8539         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8540             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8541             IF FORM-MASTER-FOUND
  8542                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8543
  8544     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8545        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8546
  8547********************** MON CODE **********************
  8548     IF PB-COMPANY-ID = 'MON'
  8549     IF PB-ISSUE
  8550     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8551        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8552             PB-I-LOAN-APR = ZERO)
  8553               MOVE 14.0         TO PB-I-LOAN-APR.
  8554******************************************************
  8555
  8556     IF PB-COMPANY-ID = 'NCL'
  8557       IF PB-ISSUE
  8558           IF FORM-MASTER-FOUND
  8559             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8560                AM-DISMBR-COVERAGE
  8561                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8562                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8563                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8564                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8565                                           PB-I-LIFE-BENEFIT-CD.
  8566
  8567     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8568
  8569     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8570         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8571         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8572         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8573         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8574         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8575           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8576             GO TO 0301-LIFE-BENEFIT-SEARCH
  8577         ELSE
  8578             NEXT SENTENCE
  8579     ELSE
  8580         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8581
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 157
* EL050.cbl
  8582     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8583     MOVE '4'                    TO CNTL-REC-TYPE.
  8584     MOVE +0                     TO CNTL-SEQ-NO.
  8585     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8586
  8587     MOVE '1' TO RC-SW-2.
  8588     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8589
  8590     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8591        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8592         GO TO 0305-BENEFIT-NOT-FOUND.
  8593
  8594     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8595
  8596 0301-LIFE-BENEFIT-SEARCH.
  8597
  8598     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8599
  8600     IF NO-BENEFIT-FOUND
  8601        GO TO 0305-BENEFIT-NOT-FOUND.
  8602
  8603     IF WS-BEN-CD = '99'
  8604        GO TO 0305-BENEFIT-NOT-FOUND.
  8605
  8606     IF PB-COMPANY-ID = 'NCL'
  8607         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8608             GO TO 0304-LIFE-BENEFIT-FOUND.
  8609
  8610     MOVE +1                     TO SUB5.
  8611     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8612
  8613* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8614* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8615     IF PB-COMPANY-ID = 'DMD'
  8616         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8617
  8618 0302-EDIT-ACCT-LF-BENEFITS.
  8619
  8620     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8621        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8622           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8623                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8624           GO TO 03XX-GET-LIFE-ERPLAN.
  8625
  8626     IF SUB5 LESS THAN +20
  8627        ADD +1                   TO SUB5
  8628        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8629
  8630     MOVE +1                     TO SUB5.
  8631
  8632     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8633        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8634
  8635 0303-EDIT-DMD-EXTRA-BENEFITS.
  8636
  8637     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8638        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8639           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 158
* EL050.cbl
  8640                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8641           GO TO 03XX-GET-LIFE-ERPLAN.
  8642
  8643     IF SUB5 LESS THAN +30
  8644        ADD +1                   TO SUB5
  8645        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8646
  8647     MOVE +1                     TO SUB5.
  8648
  8649 03XX-EDIT-FOR-NINETY-LF.
  8650
  8651***************************************************************
  8652*                                                             *
  8653*    NINETY BENEFIT PLAN TYPES:                               *
  8654*                                                             *
  8655*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8656*      92 = ALL GROUP REDUCING BENEFITS                       *
  8657*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8658*      94 = ALL GROUP LEVEL BENEFITS                          *
  8659*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8660*           BENEFIT CONTROLS.                                 *
  8661*      99 = ALL BENEFITS                                      *
  8662*                                                             *
  8663***************************************************************
  8664
  8665     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8666                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8667
  8668     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8669       AND
  8670        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8671        GO TO 03XX-GET-LIFE-ERPLAN.
  8672
  8673     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8674       AND
  8675        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8676        IF CF-REDUCING (SUB3)
  8677           IF (PB-I-INDV-GRP-OVRD = 'I')
  8678              OR
  8679           ((AM-IG = '1') AND
  8680           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8681              OR
  8682           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8683           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8684           (AM-IG NOT = '2'))
  8685              GO TO 03XX-GET-LIFE-ERPLAN.
  8686
  8687     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8688       AND
  8689        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8690        IF CF-REDUCING (SUB3)
  8691           IF (PB-I-INDV-GRP-OVRD = 'G')
  8692              OR
  8693           ((AM-IG = '2') AND
  8694           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8695              OR
  8696           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8697           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 159
* EL050.cbl
  8698           (AM-IG NOT = '1'))
  8699              GO TO 03XX-GET-LIFE-ERPLAN.
  8700
  8701     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8702       AND
  8703        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8704        IF CF-LEVEL    (SUB3)
  8705           IF (PB-I-INDV-GRP-OVRD = 'I')
  8706              OR
  8707           ((AM-IG = '1') AND
  8708           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8709              OR
  8710           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8711           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8712            (AM-IG NOT = '2'))
  8713              GO TO 03XX-GET-LIFE-ERPLAN.
  8714
  8715     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8716       AND
  8717        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8718        IF CF-LEVEL    (SUB3)
  8719           IF (PB-I-INDV-GRP-OVRD = 'G')
  8720              OR
  8721           ((AM-IG = '2') AND
  8722           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8723              OR
  8724           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8725           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8726           (AM-IG NOT = '1'))
  8727              GO TO 03XX-GET-LIFE-ERPLAN.
  8728
  8729     IF SUB5 LESS THAN +20
  8730        ADD +1                   TO SUB5
  8731        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8732
  8733     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8734
  8735     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8736        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8737
  8738     MOVE +1                     TO SUB5.
  8739
  8740 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8741
  8742     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8743                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8744
  8745     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8746       AND
  8747        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8748        GO TO 03XX-GET-LIFE-ERPLAN.
  8749
  8750     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8751       AND
  8752        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8753        IF CF-REDUCING (SUB3)
  8754           IF (PB-I-INDV-GRP-OVRD = 'I')
  8755              OR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 160
* EL050.cbl
  8756           ((AM-IG = '1') AND
  8757           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8758              OR
  8759           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8760           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8761           (AM-IG NOT = '2'))
  8762              GO TO 03XX-GET-LIFE-ERPLAN.
  8763
  8764     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8765       AND
  8766        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8767        IF CF-REDUCING (SUB3)
  8768           IF (PB-I-INDV-GRP-OVRD = 'G')
  8769              OR
  8770           ((AM-IG = '2') AND
  8771           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8772              OR
  8773           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8774           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8775           (AM-IG NOT = '1'))
  8776              GO TO 03XX-GET-LIFE-ERPLAN.
  8777
  8778     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8779       AND
  8780        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8781        IF CF-LEVEL    (SUB3)
  8782           IF (PB-I-INDV-GRP-OVRD = 'I')
  8783              OR
  8784           ((AM-IG = '1') AND
  8785           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8786              OR
  8787           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8788           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8789            (AM-IG NOT = '2'))
  8790              GO TO 03XX-GET-LIFE-ERPLAN.
  8791
  8792     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8793       AND
  8794        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8795        IF CF-LEVEL    (SUB3)
  8796           IF (PB-I-INDV-GRP-OVRD = 'G')
  8797              OR
  8798           ((AM-IG = '2') AND
  8799           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8800              OR
  8801           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8802           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8803           (AM-IG NOT = '1'))
  8804              GO TO 03XX-GET-LIFE-ERPLAN.
  8805
  8806     IF SUB5 LESS THAN +30
  8807        ADD +1                   TO SUB5
  8808        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8809
  8810     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8811
  8812 03XX-EDIT-FOR-NINETY-LF-CONT.
  8813
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 161
* EL050.cbl
  8814     MOVE +99                    TO SUB5.
  8815
  8816     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8817        IF PB-ISSUE
  8818           MOVE ER-1924          TO  WS-ERROR
  8819           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8820
  8821     GO TO 0304-LIFE-BENEFIT-FOUND.
  8822
  8823 03XX-GET-LIFE-ERPLAN.
  8824
  8825     IF WK-PLAN-ADDR EQUAL +0
  8826        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8827
  8828     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8829     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8830     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8831     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8832     MOVE 'Y'                    TO PLAN-MASTER-SW
  8833                                    PLAN-MASTER-LIFE-SW.
  8834     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8835
  8836 03XX-ERPLAN-LIFE-GETMAIN.
  8837
  8838     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8839     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8840
  8841 03XX-ERPLAN-LIFE-READ.
  8842
  8843     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8844     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8845     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8846     MOVE PB-SV-STATE            TO PLAN-STATE.
  8847     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8848     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8849     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8850     MOVE WS-SAVE-BENEFIT-REVISION
  8851                                 TO PLAN-REVISION-NO.
  8852
  8853     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8854     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8855
  8856     IF PB-COMPANY-ID = 'NCL'
  8857       IF NOT LF-PLAN-MASTER-FOUND
  8858         IF NOT PB-POLICY-IS-DECLINED  AND
  8859            NOT PB-POLICY-IS-VOIDED
  8860             MOVE  ER-1921         TO  WS-ERROR
  8861             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8862             GO TO 0304-LIFE-BENEFIT-FOUND.
  8863
  8864     IF NOT LF-PLAN-MASTER-FOUND
  8865        GO TO 0304-LIFE-BENEFIT-FOUND.
  8866
  8867 XXXX-CHECK-LF-PLAN-KEY.
  8868
  8869     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8870        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8871        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 162
* EL050.cbl
  8872        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8873        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8874        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8875        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8876        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8877        MOVE 'N'                 TO PLAN-MASTER-SW
  8878          GO TO 03XX-ERPLAN-LIFE-READ.
  8879
  8880     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8881
  8882     IF  PB-CANCELLATION
  8883         GO TO  0303-LF-ACCT-BEN-FOUND.
  8884
  8885     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8886        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8887           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8888           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8889              MOVE ER-2644             TO WS-ERROR
  8890              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8891           ELSE
  8892              NEXT SENTENCE
  8893        ELSE
  8894           IF PB-COMPANY-ID NOT = 'NCL'
  8895              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8896                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8897
  8898 0303-LF-ACCT-BEN-FOUND.
  8899
  8900     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8901
  8902     IF PL-DEV-CODE NOT = SPACES
  8903        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8904
  8905     IF PL-DEV-PCT NUMERIC AND
  8906        PL-DEV-PCT NOT = ZEROS
  8907        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8908
  8909     IF PL-TOL-PREM-AMT GREATER THAN +0
  8910        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8911
  8912     IF PL-TOL-REF-AMT GREATER THAN +0
  8913        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8914
  8915     IF PL-TOL-PREM-PCT GREATER THAN +0
  8916        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8917
  8918     IF PL-TOL-REF-PCT GREATER THAN +0
  8919        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8920
  8921     IF PL-TOL-CLM-AMT GREATER THAN +0
  8922        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8923
  8924     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8925                          PL-OVER-SHORT-AMT > +0
  8926        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8927
  8928     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8929                          PL-OVER-SHORT-PCT > +0
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 163
* EL050.cbl
  8930        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8931
  8932     IF PL-SALES-TAX NUMERIC AND
  8933                          PL-SALES-TAX > +0
  8934         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8935
  8936     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8937        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8938                                    WS-IG-OVRD-AM.
  8939
  8940 0304-LIFE-BENEFIT-FOUND.
  8941
  8942     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8943
  8944     IF PB-ISSUE
  8945        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8946     ELSE
  8947        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8948
  8949     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8950     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8951     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8952     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8953     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8954                                         WS-LF-REFUND-CALC.
  8955     if (ws-lf-earnings-calc = '5')
  8956        and (pb-i-loan-apr = zeros)
  8957        and (benefit-code-chg)
  8958        move +99.9999 to pb-i-loan-apr
  8959     end-if
  8960
  8961     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8962        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8963
  8964     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8965        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8966     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8967
  8968     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8969     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8970     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8971     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8972     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8973     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8974
  8975     IF PB-COMPANY-ID = 'NCL'  AND
  8976        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8977         NEXT SENTENCE
  8978     ELSE
  8979         IF SUB5 NOT GREATER THAN +20
  8980            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8981               MOVE WS-SAVE-BENEFIT-REM-TERM
  8982                                      TO WS-AM-LF-BENE-REM-TERM
  8983                                         EC-BR-LF-REM-TERM-CALC.
  8984
  8985     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8986     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8987
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 164
* EL050.cbl
  8988     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8989
  8990 0305-BENEFIT-NOT-FOUND.
  8991
  8992     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8993     MOVE ER-2604                TO WS-ERROR.
  8994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8995
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 165
* EL050.cbl
  8997
  8998 0310-FIND-AH-BENEFIT-RECORD.
  8999
  9000     MOVE 'N'                    TO PLAN-MASTER-SW
  9001                                    PLAN-MASTER-AH-SW.
  9002
  9003     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9004                                    WS-PL-TOL-AH-REFUND
  9005                                    WS-AH-PL-REF-OVS-AMT
  9006                                    WS-PL-TOL-AH-PREM-PCT
  9007                                    WS-PL-TOL-AH-REFUND-PCT
  9008                                    WS-AH-PL-REF-OVS-PCT
  9009                                    WS-PL-TOL-AH-CLAIM.
  9010     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9011
  9012
  9013     if pb-issue
  9014        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9015           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9016        end-if
  9017        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9018           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9019           GO TO 0399-BENEFIT-NOT-FOUND
  9020        end-if
  9021     end-if
  9022
  9023     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9024        GO TO 0400-FIND-CARRIER.
  9025
  9026     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9027
  9028     IF WK-AH-BEN-ADDR NOT = ZEROS
  9029         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9030         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9031         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9032         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9033           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9034             GO TO 0311-AH-BENEFIT-SEARCH
  9035         ELSE
  9036             NEXT SENTENCE
  9037     ELSE
  9038         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9039
  9040     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9041     MOVE '5'                    TO CNTL-REC-TYPE.
  9042     MOVE +0                     TO CNTL-SEQ-NO.
  9043     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9044
  9045     MOVE '2' TO RC-SW-2.
  9046     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9047
  9048     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9049        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9050          GO TO 0399-BENEFIT-NOT-FOUND.
  9051
  9052     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9053
  9054 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 166
* EL050.cbl
  9055
  9056     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9057
  9058     IF NO-BENEFIT-FOUND
  9059         GO TO 0399-BENEFIT-NOT-FOUND.
  9060
  9061     IF WS-BEN-CD = '99'
  9062        GO TO 0399-BENEFIT-NOT-FOUND.
  9063
  9064     IF PB-COMPANY-ID  =  'NCL'
  9065         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9066             GO TO 0314-A-H-BENEFIT-FOUND.
  9067
  9068     MOVE +1                     TO SUB5.
  9069     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9070
  9071* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9072* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9073     IF PB-COMPANY-ID = 'DMD'
  9074         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9075
  9076 0312-EDIT-ACCT-AH-BENEFITS.
  9077
  9078     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9079        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9080           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9081                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9082           GO TO 03XX-GET-AH-ERPLAN.
  9083
  9084     IF SUB5 LESS THAN +20
  9085        ADD +1                   TO SUB5
  9086        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9087
  9088     MOVE +1                     TO SUB5.
  9089
  9090     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9091        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9092
  9093 0313-EDIT-DMD-EXTRA-BENEFITS.
  9094
  9095     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9096        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9097           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9098                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9099           GO TO 03XX-GET-AH-ERPLAN.
  9100
  9101     IF SUB5 LESS THAN +30
  9102        ADD +1                   TO SUB5
  9103        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9104
  9105     MOVE +1                     TO SUB5.
  9106
  9107 03XX-EDIT-FOR-NINETY-AH.
  9108
  9109***************************************************************
  9110*                                                             *
  9111*    NINETY BENEFIT PLAN TYPES:                               *
  9112*                                                             *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 167
* EL050.cbl
  9113*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9114*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9115*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9116*           BENEFIT CONTROLS.                                 *
  9117*      99 = ALL BENEFITS.                                     *
  9118*                                                             *
  9119***************************************************************
  9120
  9121     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9122                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9123
  9124     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9125       AND
  9126        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9127        GO TO 03XX-GET-AH-ERPLAN.
  9128
  9129     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9130       AND
  9131        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9132           IF (PB-I-INDV-GRP-OVRD = 'I')
  9133              OR
  9134           ((AM-IG = '1') AND
  9135           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9136              OR
  9137           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9138           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9139           (AM-IG NOT = '2'))
  9140              GO TO 03XX-GET-AH-ERPLAN.
  9141
  9142     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9143       AND
  9144        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9145           IF (PB-I-INDV-GRP-OVRD = 'G')
  9146              OR
  9147           ((AM-IG = '2') AND
  9148           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9149              OR
  9150           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9151           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9152           (AM-IG NOT = '1'))
  9153              GO TO 03XX-GET-AH-ERPLAN.
  9154
  9155     IF SUB5 LESS THAN +20
  9156        ADD +1                   TO SUB5
  9157        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9158
  9159     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9160        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9161
  9162     MOVE +1                    TO SUB5.
  9163
  9164 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9165
  9166     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9167                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9168
  9169     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9170       AND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 168
* EL050.cbl
  9171        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9172        GO TO 03XX-GET-AH-ERPLAN.
  9173
  9174     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9175       AND
  9176        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9177           IF (PB-I-INDV-GRP-OVRD = 'I')
  9178              OR
  9179           ((AM-IG = '1') AND
  9180           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9181              OR
  9182           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9183           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9184           (AM-IG NOT = '2'))
  9185              GO TO 03XX-GET-AH-ERPLAN.
  9186
  9187     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9188       AND
  9189        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9190           IF (PB-I-INDV-GRP-OVRD = 'G')
  9191              OR
  9192           ((AM-IG = '2') AND
  9193           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9194              OR
  9195           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9196           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9197           (AM-IG NOT = '1'))
  9198              GO TO 03XX-GET-AH-ERPLAN.
  9199
  9200     IF SUB5 LESS THAN +30
  9201        ADD +1                   TO SUB5
  9202        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9203
  9204 03XX-EDIT-FOR-NINETY-AH-CONT.
  9205
  9206     MOVE +99                    TO SUB5.
  9207
  9208     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9209
  9210     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9211        IF PB-ISSUE
  9212           MOVE ER-1925          TO  WS-ERROR
  9213           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9214
  9215     GO TO 0314-A-H-BENEFIT-FOUND.
  9216
  9217 03XX-GET-AH-ERPLAN.
  9218
  9219     IF WK-PLAN-ADDR EQUAL +0
  9220         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9221
  9222     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9223     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9224     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9225     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9226     MOVE 'Y'                    TO PLAN-MASTER-SW
  9227                                    PLAN-MASTER-AH-SW.
  9228*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 169
* EL050.cbl
  9229     GO TO 03XX-ERPLAN-AH-READ.
  9230
  9231 03XX-ERPLAN-AH-GETMAIN.
  9232
  9233     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9234     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9235
  9236 03XX-ERPLAN-AH-READ.
  9237
  9238     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9239     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9240     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9241     MOVE PB-SV-STATE            TO PLAN-STATE.
  9242     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9243     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9244     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9245     MOVE WS-SAVE-BENEFIT-REVISION
  9246                                 TO PLAN-REVISION-NO.
  9247
  9248     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9249     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9250
  9251     IF PB-COMPANY-ID = 'NCL'
  9252       IF NOT AH-PLAN-MASTER-FOUND
  9253         IF NOT PB-POLICY-IS-DECLINED  AND
  9254            NOT PB-POLICY-IS-VOIDED
  9255             MOVE  ER-1922         TO  WS-ERROR
  9256             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9257             GO TO 0314-A-H-BENEFIT-FOUND.
  9258
  9259     IF NOT AH-PLAN-MASTER-FOUND
  9260        GO TO 0314-A-H-BENEFIT-FOUND.
  9261
  9262 XXXX-CHECK-AH-PLAN-KEY.
  9263
  9264     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9265        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9266        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9267        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9268        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9269        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9270        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9271        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9272        MOVE 'N'                 TO PLAN-MASTER-SW
  9273          GO TO 03XX-ERPLAN-AH-READ.
  9274
  9275     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9276
  9277     IF  PB-CANCELLATION
  9278         GO TO  0313-AH-ACCT-BEN-FOUND.
  9279
  9280     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9281       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9282          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9283          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9284             MOVE ER-2644             TO WS-ERROR
  9285             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9286          ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 170
* EL050.cbl
  9287             NEXT SENTENCE
  9288       ELSE
  9289          IF PB-COMPANY-ID NOT = 'NCL'
  9290             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9291                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9292
  9293 0313-AH-ACCT-BEN-FOUND.
  9294
  9295     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9296
  9297     IF PL-DEV-CODE NOT = SPACES
  9298        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9299
  9300     IF PL-DEV-PCT NUMERIC AND
  9301        PL-DEV-PCT NOT = ZEROS
  9302        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9303
  9304     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9305        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9306
  9307     IF PL-TOL-REF-AMT NOT EQUAL +0
  9308        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9309
  9310     IF PL-TOL-PREM-PCT GREATER THAN +0
  9311        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9312
  9313     IF PL-TOL-REF-PCT GREATER THAN +0
  9314        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9315
  9316     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9317        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9318
  9319     IF PL-OVER-SHORT-AMT NUMERIC AND
  9320                          PL-OVER-SHORT-AMT > +0
  9321        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9322
  9323     IF PL-OVER-SHORT-PCT NUMERIC AND
  9324                          PL-OVER-SHORT-PCT > +0
  9325        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9326
  9327     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9328        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9329        IF WS-IG-OVRD-AM EQUAL SPACES
  9330            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9331
  9332 0314-A-H-BENEFIT-FOUND.
  9333
  9334     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9335
  9336     IF PB-ISSUE
  9337        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9338       ELSE
  9339        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9340
  9341     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9342     if cf-maximum-benefits (sub3) numeric
  9343        move cf-maximum-benefits (sub3)
  9344                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 171
* EL050.cbl
  9345     else
  9346        move zeros               to ws-ah-max-bens
  9347     end-if
  9348     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9349     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9350     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9351                                         WS-AH-REFUND-CALC.
  9352
  9353     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9354        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9355
  9356     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9357        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9358     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9359
  9360     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9361     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9362     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9363     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9364     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9365     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9366
  9367     IF PB-COMPANY-ID = 'NCL'  AND
  9368        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9369         NEXT SENTENCE
  9370     ELSE
  9371         IF SUB5 NOT GREATER THAN +20
  9372            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9373                MOVE WS-SAVE-BENEFIT-REM-TERM
  9374                                      TO WS-AM-AH-BENE-REM-TERM
  9375                                         EC-BR-AH-REM-TERM-CALC.
  9376
  9377     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9378     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9379
  9380     GO TO 0400-FIND-CARRIER.
  9381
  9382 0399-BENEFIT-NOT-FOUND.
  9383
  9384     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9385     MOVE ER-2605                TO WS-ERROR.
  9386     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9387
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 172
* EL050.cbl
  9389
  9390 0400-FIND-CARRIER.
  9391
  9392     MOVE PB-SV-CARRIER          TO WS-CARR.
  9393
  9394     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9395     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9396     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9397     MOVE '6'                    TO CNTL-REC-TYPE.
  9398
  9399*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9400     MOVE SPACE                  TO WS-DMD-RATING-SW
  9401                                    EC-BR-DMD-RATING-SW.
  9402
  9403     MOVE '2'                    TO RC-SW-1.
  9404     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9405
  9406     IF NOT CF-CARRIER-MASTER
  9407        GO TO 0400-CARRIER-NOT-FOUND.
  9408
  9409 0400-BUILD-CARR-TOL.
  9410
  9411     IF CF-CR-TOL-PREM NUMERIC AND
  9412        CF-CR-TOL-PREM GREATER THAN +0
  9413        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9414                                    WS-TOL-AH-PREM.
  9415
  9416     IF CF-CR-TOL-REFUND NUMERIC AND
  9417        CF-CR-TOL-REFUND GREATER THAN +0
  9418        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9419                                    WS-TOL-AH-REFUND.
  9420
  9421     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9422        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9423        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9424                                    WS-AH-REFUND-OVS-AMT.
  9425
  9426     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9427        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9428        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9429                                    WS-AH-REFUND-OVS-PCT.
  9430
  9431     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9432        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9433        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9434                                    WS-TOL-AH-PREM-PCT.
  9435
  9436     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9437        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9438        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9439                                     WS-TOL-AH-REFUND-PCT.
  9440
  9441     IF CF-COMPANY-ID EQUAL 'DMD'
  9442         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9443                                    EC-BR-DMD-RATING-SW.
  9444
  9445     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9446     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 173
* EL050.cbl
  9447        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9448     END-IF
  9449     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9450        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9451     END-IF
  9452     IF WS-TOL-CLP-PCT = ZEROS
  9453        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9454     END-IF
  9455
  9456     IF WS-SPP-LEASE-COMM = ZEROS
  9457        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9458     END-IF
  9459     GO TO 0400-FIND-ERPDEF.
  9460
  9461 0400-CARRIER-NOT-FOUND.
  9462
  9463     MOVE ER-2602                TO WS-ERROR.
  9464     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9465
  9466 0400-FIND-ERPDEF.
  9467*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9468     IF (PB-COMPANY-ID = 'DCC')
  9469        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9470        CONTINUE
  9471     ELSE
  9472        GO TO 0400-FIND-ERCOMP
  9473     END-IF
  9474     MOVE ' '                    TO PDEF-MASTER-SW
  9475     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9476     MOVE PB-STATE               TO ERPDEF-STATE
  9477     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9478        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9479     END-IF
  9480     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9481     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9482     IF PB-ISSUE
  9483        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9484     ELSE
  9485        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9486     END-IF
  9487     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9488     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9489     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9490     IF PDEF-MASTER-FOUND
  9491        MOVE 'N'                 TO PDEF-MASTER-SW
  9492        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9493        IF PDEF-MASTER-FOUND
  9494           IF (ERPDEF-KEY-SAVE (1:16) =
  9495                        PD-CONTROL-PRIMARY (1:16))
  9496              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9497              CONTINUE
  9498           ELSE
  9499              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9500              IF (ERPDEF-KEY-SAVE (1:16) =
  9501                        PD-CONTROL-PRIMARY (1:16))
  9502                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9503                 CONTINUE
  9504              ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 174
* EL050.cbl
  9505                 MOVE 'N'        TO PDEF-MASTER-SW
  9506              END-IF
  9507           END-IF
  9508        END-IF
  9509        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9510     END-IF
  9511     IF PDEF-MASTER-FOUND
  9512        IF PD-TRUNCATED = 'Y'
  9513           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9514        END-IF
  9515     END-IF
  9516     .
  9517 0400-FIND-ERCOMP.
  9518     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9519        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9520           (WS-SUB1 > +10)
  9521           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9522                 OR 'A' OR 'N'
  9523              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9524              MOVE PB-CARRIER    TO COMP-CARRIER
  9525              MOVE PB-GROUPING   TO COMP-GROUPING
  9526              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9527              MOVE AM-AGT (WS-SUB1)
  9528                                 TO COMP-FIN-RESP
  9529              MOVE 'G'           TO COMP-TYPE
  9530              PERFORM 8582-READ-COMPENSATION-MASTER
  9531                                 THRU 8582-EXIT
  9532              IF COMP-MASTER-FOUND
  9533                 IF CO-GA-INACTIVE
  9534                    MOVE ER-2763 TO WS-ERROR
  9535                    PERFORM 9900-ERROR-FORMAT
  9536                                 THRU 9900-EXIT
  9537                    MOVE +11     TO WS-SUB1
  9538                 END-IF
  9539                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9540                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9541                    MOVE ER-2788 TO WS-ERROR
  9542                    PERFORM 9900-ERROR-FORMAT
  9543                                 THRU 9900-EXIT
  9544                    MOVE +11     TO WS-SUB1
  9545                 END-IF
  9546              END-IF
  9547           END-IF
  9548        END-PERFORM
  9549     END-IF
  9550     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9551        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9552           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9553                                    WS-CLP-STATE
  9554        ELSE
  9555           MOVE SPACES           TO PB-I-CLP-STATE
  9556                                    WS-CLP-STATE
  9557        END-IF
  9558     END-IF
  9559
  9560     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9561        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9562        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 175
* EL050.cbl
  9563        CONTINUE
  9564     ELSE
  9565        GO TO 0400-FIND-STATE-RECORD
  9566     END-IF
  9567     MOVE SPACES                 TO WS-CLP-STATE
  9568     MOVE +0                     TO WS-BANK-FEE
  9569                                    WS-BANK-LFEE
  9570                                    WS-BANK-NOCHRGB
  9571
  9572     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9573     IF (PB-ISSUE)
  9574        AND (PB-I-BANK-NUMBER NOT =
  9575            SPACES AND ZEROS AND LOW-VALUES)
  9576        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9577     ELSE
  9578        IF (PB-CANCELLATION)
  9579           AND (PB-CI-BANK-NUMBER NOT =
  9580                SPACES AND ZEROS AND LOW-VALUES)
  9581           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9582        END-IF
  9583     END-IF
  9584     IF COMP-FIN-RESP NOT = LOW-VALUES
  9585        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9586        MOVE PB-CARRIER          TO COMP-CARRIER
  9587        MOVE PB-GROUPING         TO COMP-GROUPING
  9588        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9589        MOVE 'B'                 TO COMP-TYPE
  9590        PERFORM 8582-READ-COMPENSATION-MASTER
  9591                                 THRU 8582-EXIT
  9592        IF COMP-MASTER-FOUND
  9593           IF CO-MAX-BANK-FEE NOT NUMERIC
  9594              MOVE +0            TO CO-MAX-BANK-FEE
  9595           END-IF
  9596           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9597              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9598           END-IF
  9599           IF CO-GA-INACTIVE
  9600              MOVE ER-2763       TO WS-ERROR
  9601              PERFORM 9900-ERROR-FORMAT
  9602                                 THRU 9900-EXIT
  9603           END-IF
  9604           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9605              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9606              MOVE ER-2788 TO WS-ERROR
  9607              PERFORM 9900-ERROR-FORMAT
  9608                                 THRU 9900-EXIT
  9609              MOVE +11     TO WS-SUB1
  9610           END-IF
  9611           IF WS-AH-BEN-CATEGORY = 'G'
  9612              MOVE CO-MAX-BANK-FEE
  9613                                 TO WS-BANK-FEE
  9614                                    PB-I-BANK-FEE
  9615           ELSE
  9616              MOVE CO-MAX-BANK-FEE-LEASE
  9617                                 TO WS-BANK-LFEE
  9618                                    PB-I-BANK-FEE
  9619           END-IF
  9620           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 176
* EL050.cbl
  9621              AND (WS-AH-REFUND-CALC = 'G'))
  9622                        OR
  9623              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9624              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9625              CONTINUE
  9626           ELSE
  9627              MOVE ER-2789 TO WS-ERROR
  9628              PERFORM 9900-ERROR-FORMAT
  9629                                 THRU 9900-EXIT
  9630           END-IF
  9631           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9632                                    PB-I-CLP-STATE
  9633           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9634           MOVE CO-CARRIER       TO BXRF-CARRIER
  9635           MOVE CO-GROUPING      TO BXRF-GROUPING
  9636           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9637           MOVE BXRF-MAX-REC-LENGTH
  9638                                 TO BXRF-REC-LENGTH
  9639           PERFORM 8584-READ-BANK-CROSS-REF
  9640                                 THRU 8584-EXIT
  9641           IF BXRF-MASTER-FOUND
  9642              MOVE ' '           TO BANK-ACCT-SW
  9643              MOVE BK-BANK-POINTER-CNT
  9644                                 TO BK-BANK-POINTER-CNT
  9645              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9646                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9647                 OR (BANK-ACCT-FOUND)
  9648                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9649                    AND (BK-AM-EXP-DT (WS-SUB1)
  9650                                 > PB-CERT-EFF-DT)
  9651                    AND (BK-AM-EFF-DT (WS-SUB1)
  9652                                 NOT > PB-CERT-EFF-DT)
  9653                    SET BANK-ACCT-FOUND TO TRUE
  9654                 END-IF
  9655              END-PERFORM
  9656              IF NOT BANK-ACCT-FOUND
  9657                 MOVE ZEROS      TO WS-BANK-FEE
  9658                                    WS-BANK-LFEE
  9659                 MOVE ER-2869    TO WS-ERROR
  9660                 PERFORM 9900-ERROR-FORMAT
  9661                                 THRU 9900-EXIT
  9662              ELSE
  9663                 PERFORM 5000-PROCESS-REPS
  9664                                 THRU 5000-EXIT
  9665                 IF AGENT-MASTER-FOUND
  9666                    MOVE +0      TO WS-BANK-FEE
  9667                                    WS-BANK-LFEE
  9668*                   MOVE AG-SPP-FEES (1)
  9669*                                TO PB-I-BANK-FEE
  9670*                                   WS-BANK-FEE
  9671                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9672                       (WS-SUB1 > +10)
  9673                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9674                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9675                       END-IF
  9676                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9677                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9678                       END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 177
* EL050.cbl
  9679                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9680                          AG-SPP-FEES (WS-SUB1)
  9681                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9682                          AG-SPP-LFEES (WS-SUB1)
  9683                    END-PERFORM
  9684                    IF WS-AH-BEN-CATEGORY = 'G'
  9685                       MOVE WS-BANK-FEE
  9686                                 TO PB-I-BANK-FEE
  9687                    ELSE
  9688                       MOVE WS-BANK-LFEE
  9689                                 TO PB-I-BANK-FEE
  9690                    END-IF
  9691                 END-IF
  9692              END-IF
  9693           END-IF
  9694        ELSE
  9695           MOVE ER-2879          TO WS-ERROR
  9696           PERFORM 9900-ERROR-FORMAT
  9697                                 THRU 9900-EXIT
  9698        END-IF
  9699     ELSE
  9700        MOVE ER-2879             TO WS-ERROR
  9701        PERFORM 9900-ERROR-FORMAT
  9702                                 THRU 9900-EXIT
  9703     END-IF
  9704     IF WS-AH-BEN-CATEGORY = 'G'
  9705        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9706        + WS-BANK-FEE
  9707     ELSE
  9708        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9709        + WS-BANK-LFEE
  9710     END-IF
  9711     .
  9712 0400-FIND-STATE-RECORD.
  9713
  9714     IF WK-STATE-ADDR NOT = ZEROS
  9715         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9716         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9717         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9718         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9719         IF PB-SV-STATE = CF-STATE-CODE
  9720             GO TO 0405-CONTINUE-EDIT
  9721         ELSE
  9722             NEXT SENTENCE
  9723     ELSE
  9724         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9725
  9726     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9727     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9728     MOVE '3'                    TO CNTL-REC-TYPE.
  9729     MOVE +0                     TO CNTL-SEQ-NO.
  9730
  9731     MOVE '3'                    TO RC-SW-2.
  9732     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9733
  9734     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9735        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9736        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 178
* EL050.cbl
  9737        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9738                                    WS-TOL-AH-CLAIM
  9739                                    WS-MINIMUM-REFUND
  9740                                    WS-TOL-LF-PREM
  9741                                    WS-TOL-AH-PREM
  9742                                    WS-TOL-LF-REFUND
  9743                                    WS-TOL-AH-REFUND
  9744                                    EC-ST-TOL-PREM-PCT
  9745                                    WS-TOL-LF-PREM-PCT
  9746                                    WS-TOL-AH-PREM-PCT
  9747                                    EC-ST-TOL-REFUND-PCT
  9748                                    WS-TOL-LF-REFUND-PCT
  9749                                    WS-TOL-AH-REFUND-PCT
  9750                                    EC-ST-TOL-PREM
  9751                                    EC-ST-TOL-REFUND
  9752                                    EC-ST-FST-PMT-DAYS-MAX
  9753                                    WS-FREE-LOOK-PERIOD
  9754                                    WS-ST-LF-PREM-TAX
  9755                                    WS-ST-AH-PREM-TAX-I
  9756                                    WS-ST-AH-PREM-TAX-G
  9757                                    WS-BANK-FEE
  9758                                    WS-BANK-LFEE
  9759                                    WS-TOL-CLP-PCT
  9760                                    WS-SPP-LEASE-COMM
  9761                                    WS-INT-PERIODS
  9762                                    WS-EXTRA-PMTS
  9763        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9764                                    EC-ST-FST-PMT-DAYS-CHG
  9765                                    WS-LF-REM-TERM-CALC
  9766                                    WS-LF-REFUND-CALC
  9767                                    EC-ST-LF-REM-TERM-CALC
  9768                                    EC-ST-LF-REFUND-CALC
  9769                                    WS-AH-REM-TERM-CALC
  9770                                    WS-AH-REFUND-CALC
  9771                                    WS-LF-BEN-CATEGORY
  9772                                    WS-AH-BEN-CATEGORY
  9773                                    WS-CLP-STATE
  9774                                    WS-ST-REFUND-CLAIM-FLAG
  9775                                    WS-ST-CAUSAL-STATE
  9776                                    ws-st-agent-sig-edit
  9777                                    EC-ST-AH-REM-TERM-CALC
  9778                                    EC-ST-AH-REFUND-CALC
  9779          GO TO 0499-STATE-NOT-FOUND.
  9780
  9781     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9782
  9783 0405-CONTINUE-EDIT.
  9784
  9785     if pb-company-id = 'AHL'
  9786        continue
  9787     else
  9788        IF PB-CERT-PRIME NOT NUMERIC
  9789           MOVE ER-2722          TO WS-ERROR
  9790           PERFORM 9900-ERROR-FORMAT
  9791                                 THRU 9900-EXIT
  9792        end-if
  9793     END-IF
  9794*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 179
* EL050.cbl
  9795*       MOVE +0                  TO SUB3
  9796*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9797*       IF SUB3 > +0
  9798*          MOVE ER-2722          TO WS-ERROR
  9799*          PERFORM 9900-ERROR-FORMAT
  9800*                                THRU 9900-EXIT
  9801*       END-IF
  9802*    END-IF
  9803*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9804*       IF PB-CERT-PRIME NOT NUMERIC
  9805*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9806*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9807*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9808*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9809*
  9810*          MOVE ER-2722          TO WS-ERROR
  9811*          PERFORM 9900-ERROR-FORMAT
  9812*                                THRU 9900-EXIT
  9813*       END-IF
  9814*    END-IF
  9815
  9816     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9817
  9818     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9819        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9820                                    WS-TOL-AH-CLAIM.
  9821
  9822     IF CF-ST-REFUND-MIN NOT NUMERIC
  9823        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9824
  9825     IF CF-ST-REFUND-MIN NOT = ZEROS
  9826        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9827
  9828     IF CF-ST-TOL-PREM  NOT = ZEROS
  9829        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9830                                    WS-TOL-AH-PREM
  9831        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9832
  9833     IF CF-ST-TOL-REFUND NOT = ZEROS
  9834        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9835                                    WS-TOL-AH-REFUND
  9836        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9837
  9838     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9839        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9840        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9841                                    WS-AH-REFUND-OVS-AMT
  9842                                    EC-ST-OVR-SHT-AMT.
  9843
  9844     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9845        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9846        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9847                                    WS-TOL-LF-PREM-PCT
  9848                                    WS-TOL-AH-PREM-PCT.
  9849
  9850     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9851        CF-ST-TOL-REF-PCT GREATER THAN +0
  9852        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 180
* EL050.cbl
  9853                                    WS-TOL-LF-REFUND-PCT
  9854                                    WS-TOL-AH-REFUND-PCT.
  9855
  9856     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9857        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9858        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9859                                    WS-AH-REFUND-OVS-PCT
  9860                                    EC-ST-OVR-SHT-PCT.
  9861
  9862     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9863     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9864
  9865     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9866          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9867
  9868     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9869     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9870     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9871
  9872     IF CF-ST-LF-PREM-TAX NUMERIC
  9873        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9874     END-IF
  9875     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9876        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9877     END-IF
  9878     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9879        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9880     END-IF
  9881
  9882     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9883         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9884     END-IF.
  9885
  9886     IF CF-ST-CAUSAL-STATE > SPACES
  9887         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9888     END-IF.
  9889     if cf-st-extra-interest-periods not numeric
  9890        move zeros               to cf-st-extra-interest-periods
  9891     end-if
  9892     if cf-st-extra-payments not numeric
  9893        move zeros               to cf-st-extra-payments
  9894     end-if
  9895
  9896     move cf-st-extra-interest-periods
  9897                                 to ws-int-periods
  9898     move cf-st-extra-payments   to ws-extra-pmts
  9899     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9900     move cf-st-net-only-state   to ws-net-only-state
  9901     IF WS-LF-BENEFIT-CD = ZEROS
  9902        GO TO 0410-CHECK-AH.
  9903
  9904     IF CF-ST-RT-CALC NOT = SPACES
  9905        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9906                                    EC-ST-LF-REM-TERM-CALC
  9907     END-IF
  9908
  9909     IF WS-LF-COVERAGE-TYPE = 'R'
  9910        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 181
* EL050.cbl
  9911           IF CF-ST-RF-LN-CALC > '0'
  9912              MOVE CF-ST-RF-LN-CALC
  9913                                 TO WS-LF-REFUND-CALC
  9914                                    EC-ST-LF-REFUND-CALC
  9915           END-IF
  9916        ELSE
  9917           IF CF-ST-RF-LR-CALC > '0'
  9918              MOVE CF-ST-RF-LR-CALC
  9919                                 TO WS-LF-REFUND-CALC
  9920                                    EC-ST-LF-REFUND-CALC
  9921           END-IF
  9922        END-IF
  9923     ELSE
  9924        IF CF-ST-RF-LL-CALC > '0'
  9925           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9926                                    EC-ST-LF-REFUND-CALC
  9927        END-IF
  9928     END-IF
  9929
  9930     IF CF-ST-RT-CALC NOT = SPACES
  9931        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9932                                    EC-ST-LF-REM-TERM-CALC
  9933     END-IF
  9934
  9935     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9936     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9937
  9938     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9939
  9940     IF NO-BENEFIT-FOUND
  9941        GO TO 0410-CHECK-AH.
  9942
  9943     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9944        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9945                                 TO EC-ST-LF-REM-TERM-CALC
  9946                                    WS-LF-REM-TERM-CALC
  9947     END-IF
  9948
  9949     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9950        MOVE CF-ST-REFUND-CALC (SUB3)
  9951                                 TO WS-LF-REFUND-CALC
  9952                                    EC-ST-LF-REFUND-CALC
  9953     END-IF
  9954*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9955     if cf-st-extra-periods (sub3) not numeric
  9956        move zeros               to cf-st-extra-periods (sub3)
  9957     end-if
  9958     if cf-st-extra-periods (sub3) > zeros
  9959        if ws-lf-ben-category = 'P'
  9960           move cf-st-extra-periods (sub3)
  9961                                 to ws-extra-pmts
  9962        else
  9963           if ws-lf-ben-category = 'I'
  9964              move cf-st-extra-periods (sub3)
  9965                                 to ws-int-periods
  9966           end-if
  9967        end-if
  9968     end-if
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 182
* EL050.cbl
  9969     .
  9970 0410-CHECK-AH.
  9971
  9972     IF WS-AH-BENEFIT-CD = ZEROS
  9973        GO TO 0500-SET-ACCOUNT.
  9974
  9975     IF CF-ST-RT-CALC NOT = SPACES
  9976        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9977                                    EC-ST-AH-REM-TERM-CALC
  9978     END-IF
  9979
  9980     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9981        IF CF-ST-RF-CP-CALC > '0'
  9982           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9983                                    EC-ST-AH-REFUND-CALC
  9984        END-IF
  9985     ELSE
  9986        IF CF-ST-RF-AH-CALC > '0'
  9987           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9988                                    EC-ST-AH-REFUND-CALC
  9989        END-IF
  9990     END-IF
  9991     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9992     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9993
  9994     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9995
  9996     IF NO-BENEFIT-FOUND
  9997        GO TO 0500-SET-ACCOUNT.
  9998
  9999     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10000        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10001                                 TO WS-AH-REM-TERM-CALC
 10002                                    EC-ST-AH-REM-TERM-CALC
 10003     END-IF
 10004
 10005     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10006        MOVE CF-ST-REFUND-CALC (SUB3)
 10007                                 TO WS-AH-REFUND-CALC
 10008                                    EC-ST-AH-REFUND-CALC
 10009     END-IF
 10010
 10011*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10012
 10013     GO TO 0500-SET-ACCOUNT.
 10014
 10015 0499-STATE-NOT-FOUND.
 10016
 10017     MOVE ER-2603                TO WS-ERROR.
 10018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10019
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 183
* EL050.cbl
 10021
 10022 0500-SET-ACCOUNT.
 10023*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10024     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10025        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10026        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10027        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10028        MOVE '3'                 TO CNTL-REC-TYPE
 10029        MOVE +0                  TO CNTL-SEQ-NO
 10030
 10031        MOVE '3'                 TO RC-SW-2
 10032        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10033
 10034        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10035           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10036           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10037           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10038                                    WS-ST-AH-PREM-TAX-I
 10039                                    WS-ST-AH-PREM-TAX-G
 10040        ELSE
 10041           IF CF-ST-LF-PREM-TAX NUMERIC
 10042              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10043           END-IF
 10044           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10045              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10046           END-IF
 10047           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10048              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10049           END-IF
 10050        END-IF
 10051        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10052     END-IF
 10053*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10054*  FOR DCC ONLY
 10055     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10056
 10057     MOVE ' '                    TO STAT-MASTER-SW
 10058     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10059     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10060     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10061     MOVE PB-STATE               TO ELSTAT-STATE
 10062     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10063        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10064     END-IF
 10065
 10066     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10067     SET BIN-TO-GREG             TO TRUE
 10068     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10069     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10070     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10071
 10072     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10073     IF STAT-MASTER-FOUND
 10074        MOVE 'N'                 TO STAT-MASTER-SW
 10075        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10076        IF STAT-MASTER-FOUND
 10077           IF (ELSTAT-KEY-SAVE (1:12) =
 10078                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 184
* EL050.cbl
 10079              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10080                 MOVE 'F'        TO STAT-MASTER-SW
 10081              ELSE
 10082                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10083                 IF (STAT-MASTER-FOUND)
 10084                    AND (ELSTAT-KEY-SAVE (1:12) =
 10085                        SF-CONTROL-PRIMARY (1:12))
 10086                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10087                    MOVE 'F'     TO STAT-MASTER-SW
 10088                 END-IF
 10089              END-IF
 10090           END-IF
 10091        END-IF
 10092     END-IF
 10093
 10094     IF STAT-MASTER-SW = 'F'
 10095        IF (SF-ST-LF-PREM-TAX NUMERIC)
 10096           and (sf-st-lf-prem-tax > zeros)
 10097           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10098        END-IF
 10099        IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10100           and (sf-st-ah-prem-tax-i > zeros)
 10101           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10102        END-IF
 10103        IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10104           and (sf-st-ah-prem-tax-g > zeros)
 10105           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10106        END-IF
 10107     END-IF
 10108
 10109     END-IF
 10110     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10111        AND (PB-ISSUE)
 10112        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10113        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10114        AND (AM-GPCD = 06)
 10115        MOVE 'Y'                 TO WS-GOOD-HIN
 10116        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10117           MOVE PB-I-VIN         TO WS-WORK-VIN
 10118           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10119              (V1 > 16)
 10120              IF WS-WORK-VIN (V1:1) NUMERIC
 10121                 MOVE WS-WORK-VIN-N (V1)
 10122                                 TO WS-ROW-B-VAL (V1)
 10123              ELSE
 10124                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10125                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10126                    OR (V2 > 26)
 10127                 END-PERFORM
 10128                 IF V2 < 27
 10129                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10130                 ELSE
 10131                    MOVE 'N'     TO WS-GOOD-HIN
 10132                 END-IF
 10133              END-IF
 10134              COMPUTE WS-ROW-D-VAL (V1) =
 10135                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10136              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 185
* EL050.cbl
 10137                 WS-ROW-D-VAL (V1)
 10138           END-PERFORM
 10139           MOVE ZEROS            TO WS-VIN-REMAINDER
 10140           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10141             REMAINDER WS-VIN-REMAINDER
 10142           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10143              CONTINUE
 10144           ELSE
 10145              MOVE 'N'           TO WS-GOOD-HIN
 10146           END-IF
 10147        ELSE
 10148           MOVE 'N'              TO WS-GOOD-HIN
 10149        END-IF
 10150        IF WS-GOOD-HIN NOT = 'Y'
 10151           MOVE ER-3826           TO WS-ERROR
 10152           PERFORM 9900-ERROR-FORMAT
 10153                                 THRU 9900-EXIT
 10154        END-IF
 10155     END-IF
 10156     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10157        AND (PB-ISSUE)
 10158        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10159        AND (AM-GPCD NOT = 06)
 10160        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10161           perform 3400-edit-vin thru 3400-exit
 10162        ELSE
 10163          MOVE ER-3826           TO WS-ERROR
 10164          PERFORM 9900-ERROR-FORMAT
 10165                                 THRU 9900-EXIT
 10166        END-IF
 10167     END-IF
 10168     if (pb-company-id = 'CID')
 10169        and (pb-issue)
 10170        and (pb-i-vin not = spaces and low-values and zeros)
 10171        perform 3400-edit-vin    thru 3400-exit
 10172     end-if
 10173******************************************************************
 10174******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10175******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10176******* METHODS.
 10177******************************************************************
 10178     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10179        IF PB-CANCELLATION
 10180           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10181              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10182                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10183                IF FORM-MASTER-FOUND
 10184                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10185******************************************************************
 10186
 10187     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10188     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10189
 10190     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10191     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10192     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10193     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10194
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 186
* EL050.cbl
 10195
 10196     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10197     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10198     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10199
 10200     IF AM-LF-OB-RATE NOT NUMERIC
 10201         MOVE ZERO               TO AM-LF-OB-RATE.
 10202
 10203     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10204         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10205
 10206     IF AM-AH-OB-RATE NOT NUMERIC
 10207         MOVE ZERO               TO AM-AH-OB-RATE.
 10208
 10209     IF WS-LF-JOINT-INDICATOR = 'J'
 10210         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10211     ELSE
 10212         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10213
 10214     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10215
 10216     IF WS-IG-OVRD-AM  EQUAL SPACE
 10217         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10218
 10219     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10220         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10221                                       WS-IG-OVRD
 10222     ELSE
 10223         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10224             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10225                                       WS-IG-OVRD
 10226         ELSE
 10227             MOVE AM-IG             TO WS-IG-OVRD-AH
 10228                                       WS-IG-OVRD.
 10229
 10230     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10231         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10232                                       WS-IG-OVRD
 10233     ELSE
 10234         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10235             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10236                                       WS-IG-OVRD
 10237         ELSE
 10238             MOVE AM-IG             TO WS-IG-OVRD-LF
 10239                                       WS-IG-OVRD.
 10240
 10241     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10242     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10243     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10244     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10245*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10246     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10247                                              TO 'PRLDSFCTIA'.
 10248
 10249     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10250     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10251     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10252     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 187
* EL050.cbl
 10253
 10254     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10255     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10256     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10257     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10258     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10259     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10260     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10261
 10262     IF WS-ACCT-AH-DEV-PCT > +0
 10263        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10264     ELSE
 10265        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10266
 10267     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10268        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10269     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10270        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10271
 10272        IF AM-EARN-METHOD-L = 'S'
 10273            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10274                                        WS-LF-REFUND-CALC.
 10275
 10276        IF AM-EARN-METHOD-R = 'S'
 10277            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10278                                        WS-LF-REFUND-CALC.
 10279
 10280     IF WS-LF-COVERAGE-TYPE = 'R'
 10281         IF AM-EARN-METHOD-R = 'R'
 10282            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10283                                    WS-LF-REFUND-CALC.
 10284     IF WS-LF-COVERAGE-TYPE = 'R'
 10285         IF AM-EARN-METHOD-R = 'P'
 10286            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10287                                    WS-LF-REFUND-CALC.
 10288     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10289         IF AM-EARN-METHOD-L = 'R'
 10290            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10291                                    WS-LF-REFUND-CALC.
 10292     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10293         IF AM-EARN-METHOD-L = 'P'
 10294            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10295                                    WS-LF-REFUND-CALC.
 10296     IF WS-LF-COVERAGE-TYPE = 'R'
 10297         IF AM-EARN-METHOD-R = 'A'
 10298            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10299                                    WS-LF-REFUND-CALC.
 10300     IF WS-LF-COVERAGE-TYPE = 'R'
 10301         IF AM-EARN-METHOD-R = 'M'
 10302            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10303                                    WS-LF-REFUND-CALC.
 10304     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10305         IF AM-EARN-METHOD-L = 'A'
 10306            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10307                                    WS-LF-REFUND-CALC.
 10308     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10309         IF AM-EARN-METHOD-L = 'M'
 10310            MOVE '8'             TO EC-AM-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 188
* EL050.cbl
 10311                                    WS-LF-REFUND-CALC.
 10312
 10313     IF AM-EARN-METHOD-A = 'R'
 10314        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10315                                    WS-AH-REFUND-CALC.
 10316     IF AM-EARN-METHOD-A = 'P'
 10317        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10318                                    WS-AH-REFUND-CALC.
 10319     IF AM-EARN-METHOD-A = 'C'
 10320        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10321                                    WS-AH-REFUND-CALC.
 10322     IF AM-EARN-METHOD-A = 'A'
 10323        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10324                                    WS-AH-REFUND-CALC.
 10325     IF AM-EARN-METHOD-A = 'M'
 10326        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10327                                    WS-AH-REFUND-CALC.
 10328     IF AM-EARN-METHOD-A = 'N'
 10329        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10330                                    WS-AH-REFUND-CALC.
 10331     IF AM-EARN-METHOD-A = 'S'
 10332        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10333                                    WS-AH-REFUND-CALC.
 10334
 10335     IF AM-TOL-PREM NOT = ZEROS
 10336        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10337                                    WS-TOL-AH-PREM.
 10338
 10339     IF AM-OVR-SHT-AMT NUMERIC AND
 10340                  AM-OVR-SHT-AMT > 0
 10341        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10342                                    EC-AM-LF-OVR-SHT-AMT
 10343                                    WS-AH-REFUND-OVS-AMT
 10344                                    EC-AM-AH-OVR-SHT-AMT.
 10345
 10346     IF AM-OVR-SHT-PCT NUMERIC AND
 10347                    AM-OVR-SHT-PCT > 0
 10348        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10349                                    EC-AM-LF-OVR-SHT-PCT
 10350                                    WS-AH-REFUND-OVS-PCT
 10351                                    EC-AM-AH-OVR-SHT-PCT.
 10352
 10353     IF AM-TOL-REF-PCT NUMERIC AND
 10354                  AM-TOL-REF-PCT > 0
 10355        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10356                                    WS-TOL-AH-REFUND-PCT.
 10357
 10358     IF AM-TOL-REF  NOT = ZEROS  AND
 10359                  AM-TOL-REF NUMERIC
 10360        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10361                                    EC-AM-LF-TOL-REFUND
 10362                                    WS-TOL-AH-REFUND
 10363                                    EC-AM-AH-TOL-REFUND.
 10364
 10365     IF AM-TOL-CLM  NOT = ZEROS
 10366        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10367                                    WS-TOL-AH-CLAIM.
 10368
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 189
* EL050.cbl
 10369     IF AM-CLP-TOL-PCT NOT NUMERIC
 10370        MOVE +0                  TO AM-CLP-TOL-PCT
 10371     END-IF
 10372
 10373     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10374        MOVE +0                  TO AM-SPP-LEASE-COMM
 10375     END-IF
 10376     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10377        MOVE WS-PL-TOL-LF-PREM-PCT
 10378                                 TO WS-TOL-LF-PREM-PCT.
 10379
 10380     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10381        MOVE WS-PL-TOL-AH-PREM-PCT
 10382                                 TO WS-TOL-AH-PREM-PCT.
 10383
 10384     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10385        MOVE WS-PL-TOL-LF-REFUND-PCT
 10386                                 TO WS-TOL-LF-REFUND-PCT.
 10387
 10388     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10389        MOVE WS-PL-TOL-AH-REFUND-PCT
 10390                                 TO WS-TOL-AH-REFUND-PCT.
 10391
 10392     IF WS-PL-REF-OVS-AMT > +0
 10393        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10394
 10395     IF WS-PL-REF-OVS-PCT > +0
 10396        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10397
 10398     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10399        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10400     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10401        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10402     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10403        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10404     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10405        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10406     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10407        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10408     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10409        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10410
 10411     IF WS-AH-PL-REF-OVS-AMT > +0
 10412        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10413
 10414     IF WS-AH-PL-REF-OVS-PCT > +0
 10415        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10416
 10417     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10418     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10419
 10420     IF PB-CANCELLATION
 10421        GO TO 3000-CONTINUE-EDIT.
 10422
 10423     MOVE +1 TO SUB1.
 10424     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10425     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10426
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 190
* EL050.cbl
 10427     IF CF-COMPANY-ID = 'DMD'
 10428       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10429         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10430        ELSE
 10431         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10432
 10433  0525-FIND-ACCT-COMM.
 10434     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10435        NEXT SENTENCE
 10436      ELSE
 10437         ADD +1 TO SUB1
 10438         IF SUB1 LESS +11
 10439            GO TO 0525-FIND-ACCT-COMM
 10440          ELSE
 10441             GO TO 0560-EDIT-CONTINUE.
 10442
 10443     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10444     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10445                                    PB-I-LIFE-COMMISSION.
 10446***  IF PB-COMPANY-ID = 'CRI'
 10447     IF PB-PREM-ACCTNG-ONLY
 10448         GO TO 0560-EDIT-CONTINUE.
 10449
 10450     MOVE '0530' TO CTBL-SW.
 10451     MOVE ' '    TO WS-CTBL-READ-SW.
 10452
 10453
 10454 0530-GET-AH-COMP.
 10455     IF NO-AH-COVERAGE  OR
 10456        NO-AH-BENEFIT-MATCH
 10457           GO TO 0540-NEXT-READ-STEP.
 10458
 10459     IF AM-A-COM (SUB1) NUMERIC
 10460        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10461         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10462         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10463         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10464         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10465     ELSE
 10466          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10467          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10468          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10469          MOVE ZEROS             TO WS-SUB1
 10470                                    WS-COMMISSION
 10471          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10472          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10473          IF WS-COMMISSION > ZEROS
 10474             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10475             GO TO 0540-NEXT-READ-STEP
 10476          END-IF
 10477          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10478          IF CTBL-TABLE-FOUND
 10479             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10480                                        PB-I-AH-TERM
 10481             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10482             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10483             GO TO 0540-NEXT-READ-STEP
 10484          ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 191
* EL050.cbl
 10485             IF FIRST-TIME-THROUGH
 10486                 GO TO 0530-GET-AH-COMP
 10487             ELSE
 10488                 MOVE ER-2609                TO WS-ERROR
 10489                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10490
 10491 0540-NEXT-READ-STEP.
 10492     MOVE '0540' TO CTBL-SW.
 10493     MOVE ' '    TO WS-CTBL-READ-SW.
 10494
 10495 0540-GET-LF-COMP.
 10496     IF NO-LIFE-COVERAGE  OR
 10497        NO-LF-BENEFIT-MATCH
 10498           GO TO 0560-EDIT-CONTINUE.
 10499
 10500     IF WS-LF-JOINT-INDICATOR = 'J'
 10501        IF AM-J-COM (SUB1) NUMERIC
 10502           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10503           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10504           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10505           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10506           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10507        ELSE
 10508           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10509           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10510           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10511           MOVE ZEROS                TO WS-SUB1
 10512                                        WS-COMMISSION
 10513           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10514           IF WS-COMMISSION > ZEROS
 10515              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10516              GO TO 0560-EDIT-CONTINUE
 10517           END-IF
 10518           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10519           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10520           IF CTBL-TABLE-FOUND
 10521              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10522              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10523              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10524              GO TO 0560-EDIT-CONTINUE
 10525           ELSE
 10526              IF FIRST-TIME-THROUGH
 10527                  GO TO 0540-GET-LF-COMP
 10528              ELSE
 10529                  MOVE ER-2609                TO WS-ERROR
 10530                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10531                  GO TO 0560-EDIT-CONTINUE.
 10532
 10533     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10534        IF AM-L-COM (SUB1) NUMERIC
 10535           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10536           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10537           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10538           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10539           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10540        ELSE
 10541           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10542           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 192
* EL050.cbl
 10543           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10544           MOVE ZEROS                TO WS-SUB1
 10545                                        WS-COMMISSION
 10546           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10547           IF WS-COMMISSION IS GREATER THAN ZEROS
 10548              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10549              GO TO 0560-EDIT-CONTINUE
 10550           END-IF
 10551           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10552           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10553           IF CTBL-TABLE-FOUND
 10554              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10555              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10556              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10557              GO TO 0560-EDIT-CONTINUE
 10558           ELSE
 10559              IF FIRST-TIME-THROUGH
 10560                  GO TO 0540-GET-LF-COMP
 10561              ELSE
 10562                  MOVE ER-2609                TO WS-ERROR
 10563                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10564
 10565*    GO TO 0560-EDIT-CONTINUE.
 10566
 10567 0560-EDIT-CONTINUE.
 10568     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10569                                    WS-AH-PMF-COMM
 10570*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10571*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10572     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10573        (SUB1 > +10)
 10574        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10575           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10576           MOVE '0530'           TO CTBL-SW
 10577           MOVE ' '              TO WS-CTBL-READ-SW
 10578           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10579           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10580           MOVE '0540'           TO CTBL-SW
 10581           MOVE ' '              TO WS-CTBL-READ-SW
 10582           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10583        END-IF
 10584     END-PERFORM
 10585     GO TO 0564-EDIT-CONTINUE
 10586     .
 10587 0561-CHECK-AH.
 10588     IF (NO-AH-COVERAGE)
 10589        OR (NO-AH-BENEFIT-MATCH)
 10590        CONTINUE
 10591     ELSE
 10592        IF (AM-A-COM (SUB1) NUMERIC)
 10593           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10594           IF (AM-COM-TYP (SUB1) = 'A')
 10595              AND (WS-AH-PMF-COMM = ZEROS)
 10596              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10597           END-IF
 10598           CONTINUE
 10599        ELSE
 10600           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 193
* EL050.cbl
 10601           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10602           MOVE PB-AH-OVERRIDE-L1
 10603                                 TO CTBL-BEN-TYPE
 10604           MOVE ZEROS            TO WS-SUB1
 10605                                    WS-COMMISSION
 10606           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10607           PERFORM 8300-READ-CTBL-TABLE
 10608                                 THRU 8300-EXIT
 10609           IF CTBL-TABLE-FOUND
 10610              IF (AM-COM-TYP (SUB1) = 'A')
 10611                 AND (WS-AH-PMF-COMM = ZEROS)
 10612                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10613                                        PB-I-AH-TERM
 10614                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10615                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10616              END-IF
 10617              CONTINUE
 10618           ELSE
 10619              IF FIRST-TIME-THROUGH
 10620                 GO TO 0561-CHECK-AH
 10621              ELSE
 10622                 MOVE ER-2609    TO WS-ERROR
 10623                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10624              END-IF
 10625           END-IF
 10626        END-IF
 10627     END-IF
 10628     .
 10629 0561-EXIT.
 10630     EXIT.
 10631 0563-CHECK-LF.
 10632     IF (NO-LIFE-COVERAGE)
 10633        OR (NO-LF-BENEFIT-MATCH)
 10634        CONTINUE
 10635     ELSE
 10636        IF WS-LF-JOINT-INDICATOR = 'J'
 10637           IF AM-J-COM (SUB1) NUMERIC
 10638              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10639              IF (AM-COM-TYP (SUB1) = 'A')
 10640                 AND (WS-LF-PMF-COMM = ZEROS)
 10641                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10642              END-IF
 10643              CONTINUE
 10644           ELSE
 10645              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10646              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10647              MOVE PB-LIFE-OVERRIDE-L1
 10648                                 TO CTBL-BEN-TYPE
 10649              MOVE ZEROS         TO WS-SUB1
 10650                                    WS-COMMISSION
 10651              MOVE AM-J-COMA (SUB1)
 10652                                 TO CTBL-TABLE
 10653              PERFORM 8300-READ-CTBL-TABLE
 10654                                 THRU 8300-EXIT
 10655              IF CTBL-TABLE-FOUND
 10656                 IF (AM-COM-TYP (SUB1) = 'A')
 10657                    AND (WS-LF-PMF-COMM = ZEROS)
 10658                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 194
* EL050.cbl
 10659                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10660                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10661                 END-IF
 10662                 CONTINUE
 10663              ELSE
 10664                 IF FIRST-TIME-THROUGH
 10665                    GO TO 0563-CHECK-LF
 10666                 ELSE
 10667                    MOVE ER-2609 TO WS-ERROR
 10668                    PERFORM 9900-ERROR-FORMAT
 10669                                 THRU 9900-EXIT
 10670*                   GO TO 0560-EDIT-CONTINUE
 10671                 END-IF
 10672              END-IF
 10673           END-IF
 10674        ELSE
 10675           IF AM-L-COM (SUB1) NUMERIC
 10676              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10677              IF (AM-COM-TYP (SUB1) = 'A')
 10678                 AND (WS-LF-PMF-COMM = ZEROS)
 10679                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10680              END-IF
 10681              CONTINUE
 10682           ELSE
 10683              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10684              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10685              MOVE PB-LIFE-OVERRIDE-L1
 10686                                 TO CTBL-BEN-TYPE
 10687              MOVE ZEROS         TO WS-SUB1
 10688                                    WS-COMMISSION
 10689              MOVE AM-L-COMA (SUB1)
 10690                                 TO CTBL-TABLE
 10691              PERFORM 8300-READ-CTBL-TABLE
 10692                                 THRU 8300-EXIT
 10693              IF CTBL-TABLE-FOUND
 10694                 CONTINUE
 10695              ELSE
 10696                 IF FIRST-TIME-THROUGH
 10697                    GO TO 0563-CHECK-LF
 10698                 ELSE
 10699                    MOVE ER-2609 TO WS-ERROR
 10700                    PERFORM 9900-ERROR-FORMAT
 10701                                 THRU 9900-EXIT
 10702                 END-IF
 10703              END-IF
 10704           END-IF
 10705        END-IF
 10706     END-IF
 10707     .
 10708 0563-EXIT.
 10709     EXIT.
 10710 0564-EDIT-CONTINUE.
 10711
 10712     IF  PB-COMPANY-ID EQUAL 'DMD'
 10713         IF PB-I-NUM-BILLED EQUAL ZEROS
 10714            MOVE ER-8148       TO WS-ERROR
 10715            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10716
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 195
* EL050.cbl
 10717*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10718*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10719*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10720*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10721*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10722*         IF NO-CONVERSION-ERROR
 10723*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10724*         ELSE
 10725*             IF PB-COMPANY-ID EQUAL 'HAN'
 10726*                 MOVE ZEROS     TO PB-I-AGE.
 10727     IF PB-I-BIRTHDAY > LOW-VALUES
 10728        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10729        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10730        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10731        PERFORM 8500-DATE-CONVERT
 10732                                 THRU 8500-EXIT
 10733        IF NO-CONVERSION-ERROR
 10734           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10735           IF PB-I-AGE > ZEROS
 10736              IF WS-WORK-AGE NOT = PB-I-AGE
 10737                 MOVE ER-9501    TO WS-ERROR
 10738                 PERFORM 9900-ERROR-FORMAT
 10739                                 THRU 9900-EXIT
 10740              END-IF
 10741           ELSE
 10742              MOVE WS-WORK-AGE   TO PB-I-AGE
 10743           END-IF
 10744        END-IF
 10745     END-IF
 10746     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10747                                   WS-INS-AGE-SET
 10748     IF PB-I-AGE = ZEROS
 10749        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10750           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10751                                   WS-INS-AGE-SET
 10752           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10753
 10754     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10755                                   WS-AH-EDIT-AGE.
 10756
 10757     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10758        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10759        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10760        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10761        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10762        IF NO-CONVERSION-ERROR
 10763           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10764           IF PB-I-JOINT-AGE > 0
 10765              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10766                 MOVE ER-9503    TO WS-ERROR
 10767                 PERFORM 9900-ERROR-FORMAT
 10768                                 THRU 9900-EXIT
 10769              END-IF
 10770           ELSE
 10771              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10772           END-IF
 10773        ELSE
 10774           MOVE ZEROS            TO PB-I-JOINT-AGE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 196
* EL050.cbl
 10775        END-IF
 10776     END-IF
 10777     IF PB-I-JOINT-AGE NOT NUMERIC
 10778        MOVE ZERO               TO PB-I-JOINT-AGE.
 10779
 10780     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10781                                   WS-JNT-AGE-SET
 10782     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10783        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10784           (WS-AH-JOINT-INDICATOR = 'J')
 10785           IF PB-I-JOINT-AGE = ZEROS
 10786               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10787                                          WS-JNT-AGE-SET
 10788               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10789           END-IF
 10790        END-IF
 10791     END-IF
 10792
 10793     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10794     IF WS-LF-JOINT-INDICATOR = 'J'
 10795        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10796        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10797            IF  PB-I-JOINT-AGE = ZERO
 10798                MOVE ER-2686       TO WS-ERROR
 10799                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10800            ELSE
 10801                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10802                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10803                    IF PB-COMPANY-ID NOT = 'LBL'
 10804                        MOVE ER-2685    TO WS-ERROR
 10805                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10806
 10807     IF WS-AH-JOINT-INDICATOR = 'J'
 10808        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10809            IF  PB-I-JOINT-AGE = ZERO
 10810                MOVE ER-2686       TO WS-ERROR
 10811                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10812            ELSE
 10813                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10814                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10815                                           WS-EDIT-AGE
 10816                    IF PB-COMPANY-ID NOT = 'LBL'
 10817                        MOVE ER-2685    TO WS-ERROR
 10818                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10819
 10820******************************************************************
 10821*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10822******************************************************************
 10823
 10824     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10825        (WS-AH-SPECIAL-CALC-CD = 'O')
 10826        NEXT SENTENCE
 10827     ELSE
 10828        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10829          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10830           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10831            WS-AH-JOINT-INDICATOR = 'J')  AND
 10832           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 197
* EL050.cbl
 10833            MOVE ER-2627             TO WS-ERROR
 10834            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10835
 10836     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10837        (WS-AH-SPECIAL-CALC-CD = 'O')
 10838         NEXT SENTENCE
 10839     ELSE
 10840         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10841            WS-AH-JOINT-INDICATOR = 'J'
 10842             IF PB-I-JOINT-INSURED = SPACES
 10843                 IF PB-COMPANY-ID NOT = 'JAL'
 10844                     MOVE ER-2696    TO WS-ERROR
 10845                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10846
 10847     IF PB-COMPANY-ID NOT = 'BOA'
 10848        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10849           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10850           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10851               PB-I-JOINT-INSURED NOT = SPACES)
 10852                MOVE ER-2691         TO WS-ERROR
 10853                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10854
 10855     IF PB-COMPANY-ID = 'BOA'
 10856        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10857           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10858            IF PB-I-JOINT-AGE NOT = ZEROS
 10859                MOVE ER-2691         TO WS-ERROR
 10860                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10861
 10862     IF PB-COMPANY-ID = 'CRI'
 10863        IF PB-I-SIG-SW = 'J'
 10864           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10865              WS-AH-JOINT-INDICATOR NOT = 'J'
 10866              MOVE ER-2675       TO WS-ERROR
 10867              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10868
 10869     IF PB-COMPANY-ID = 'CRI'
 10870        IF PB-I-SIG-SW = 'S'
 10871           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10872              WS-AH-JOINT-INDICATOR = 'J'
 10873              MOVE ER-2676       TO WS-ERROR
 10874              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10875
 10876     IF PB-COMPANY-ID = 'CVL'
 10877         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10878            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10879              MOVE ER-2783           TO WS-ERROR
 10880              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10881     IF (WS-LF-JOINT-INDICATOR = 'J')
 10882        AND (WS-AH-JOINT-INDICATOR = 'J')
 10883        AND (PB-I-LF-TERM > 120)
 10884        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10885        MOVE ER-2783             TO WS-ERROR
 10886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10887     END-IF
 10888     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10889
 10890     IF PB-I-INDV-GRP-OVRD = 'I'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 198
* EL050.cbl
 10891        MOVE ER-2666             TO WS-ERROR
 10892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10893        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10894
 10895     IF PB-I-INDV-GRP-OVRD = 'G'
 10896        MOVE ER-2666             TO WS-ERROR
 10897        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10898        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10899
 10900     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10901        NEXT SENTENCE
 10902     ELSE
 10903        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10904
 10905     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10906        IF WS-ERROR = ER-2666
 10907           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10908           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10909
 10910     IF PB-COMPANY-ID = 'CID'
 10911        IF PB-STATE = 'UT' OR 'MO'
 10912           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10913                 OR '76' OR '77')
 10914                      OR
 10915               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10916                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10917                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10918                   OR '2K' OR '2L'))
 10919              AND PB-I-INDV-GRP-CD = 'I'
 10920              MOVE ER-2721             TO WS-ERROR
 10921              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10922           END-IF
 10923        END-IF
 10924     END-IF
 10925
 10926     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10927     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10928        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10929     ELSE
 10930        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10931     END-IF
 10932
 10933*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10934*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10935     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10936                                    ACCOUNT-AH-CK-SW.
 10937
 10938     IF PB-REISSUED-CERT       OR
 10939        PB-REIN-ONLY-CERT      OR
 10940        PB-POLICY-IS-DECLINED  OR
 10941        PB-POLICY-IS-VOIDED
 10942*       OR PB-MONTHLY-CERT
 10943         GO TO 3000-CONTINUE-EDIT.
 10944
 10945     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10946        IF WS-EDIT-AGE           > +65
 10947           MOVE ER-2709          TO WS-ERROR
 10948           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 199
* EL050.cbl
 10949                                 THRU 9900-EXIT
 10950        ELSE
 10951           IF WS-EDIT-AGE        > +55
 10952              MOVE ER-2718       TO WS-ERROR
 10953              PERFORM 9900-ERROR-FORMAT
 10954                                 THRU 9900-EXIT
 10955           END-IF
 10956        END-IF
 10957     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10958        IF WS-EDIT-AGE           > +65
 10959           MOVE ER-2709          TO WS-ERROR
 10960           PERFORM 9900-ERROR-FORMAT
 10961                                 THRU 9900-EXIT
 10962        END-IF
 10963     END-IF
 10964     .
 10965
 10966 0565-LIFE-PLAN-LIMIT-EDITS.
 10967
 10968     IF NOT LF-PLAN-MASTER-FOUND
 10969        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10970                                    EC-AM-LF-MAX-TOT-BEN
 10971        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10972
 10973     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10974
 10975     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10976         IF PL-LM-AGE (1) = ZEROS
 10977             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10978
 10979     IF NO-LF-BENEFIT-MATCH          OR
 10980        WS-LF-BENEFIT-CD = ZEROS     OR
 10981        WS-LF-SPECIAL-CALC-CD = 'M'
 10982        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10983
 10984     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10985     MOVE +1                     TO SUB2.
 10986
 10987     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10988        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10989           MOVE +5   TO SUB2
 10990           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10991              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10992              (PL-LM-AGE (SUB2) EQUAL +0)
 10993              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10994              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10995
 10996     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10997
 10998     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10999                               + PB-I-LF-ALT-BENEFIT-AMT.
 11000
 11001 0568-CHECK-LIFE-ATT-AGE.
 11002
 11003     IF PL-ATT-AGE NUMERIC AND
 11004        PL-ATT-AGE > +0
 11005        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11006     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 200
* EL050.cbl
 11007*    IF PL-ATT-AGE NUMERIC AND
 11008*       PL-ATT-AGE > +0
 11009*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11010*       IF PB-I-BIRTHDAY > LOW-VALUES
 11011*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11012*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11013*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11014*          SET BIN-PLUS-ELAPSED  TO TRUE
 11015*          PERFORM 8500-DATE-CONVERT
 11016*                                THRU 8500-EXIT
 11017*          IF NO-CONVERSION-ERROR
 11018*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11019*             MOVE ER-2669       TO WS-ERROR
 11020*             PERFORM 9900-ERROR-FORMAT
 11021*                                THRU 9900-EXIT
 11022*          END-IF
 11023*       ELSE
 11024*          IF WS-ATT-AGE >= PL-ATT-AGE
 11025*             MOVE ER-2669       TO WS-ERROR
 11026*             PERFORM 9900-ERROR-FORMAT
 11027*                                THRU 9900-EXIT
 11028*          END-IF
 11029*       END-IF
 11030*    END-IF
 11031     .
 11032 0570-CHECK-LIFE-LIMITS.
 11033
 11034     IF PB-COMPANY-ID EQUAL 'CRI'
 11035        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11036           IF SUB2 GREATER THAN +4
 11037              MOVE ER-2637 TO WS-ERROR
 11038              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11039              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11040
 11041     IF PB-COMPANY-ID  =  'NCL'
 11042        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11043            SUB2 GREATER THAN +8
 11044             MOVE 'U'         TO PB-BATCH-ENTRY
 11045             MOVE ER-2637     TO WS-ERROR
 11046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11047             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11048
 11049     IF SUB2 > +8
 11050        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11051           AND (PB-I-SIG-SW = 'Y')
 11052           CONTINUE
 11053        ELSE
 11054           MOVE ER-2637          TO WS-ERROR
 11055           PERFORM 9900-ERROR-FORMAT
 11056                                 THRU 9900-EXIT
 11057        END-IF
 11058        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11059     END-IF
 11060     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11061     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11062     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11063
 11064     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 201
* EL050.cbl
 11065        ADD +1  TO SUB2
 11066        GO TO 0570-CHECK-LIFE-LIMITS.
 11067
 11068     IF PB-COMPANY-ID = 'NCL'
 11069         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11070
 11071     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11072        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11073        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11074           AND (PB-I-SIG-SW = 'Y')
 11075           CONTINUE
 11076        ELSE
 11077           MOVE ER-2637          TO WS-ERROR
 11078           PERFORM 9900-ERROR-FORMAT
 11079                                 THRU 9900-EXIT
 11080        END-IF
 11081     END-IF
 11082     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11083
 11084
 11085 0570-CHECK-NCL-LIFE-LIMITS.
 11086
 11087     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11088        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11089         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11090
 11091     IF APP-CERT-USED
 11092         IF SUB2  LESS THAN  +5
 11093             MOVE +5          TO SUB2
 11094             GO TO 0570-CHECK-LIFE-LIMITS.
 11095
 11096     MOVE ER-2637             TO WS-ERROR.
 11097     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11098
 11099     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11100
 11101 0575-CHECK-NCL-SIG-SWITCH.
 11102
 11103     IF NOT APP-CERT-USED
 11104         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11105
 11106     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11107        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11108        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11109        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11110         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11111
 11112     IF SUB2 GREATER THAN +4
 11113         IF PL-LM-AGE (5) = ZEROS  AND
 11114            PL-LM-AGE (6) = ZEROS  AND
 11115            PL-LM-AGE (7) = ZEROS  AND
 11116            PL-LM-AGE (8) = ZEROS
 11117             MOVE  ER-1927        TO WS-ERROR
 11118             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11119             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11120         ELSE
 11121             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11122                 MOVE  ER-1920    TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 202
* EL050.cbl
 11123                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11124
 11125     IF PB-I-SIG-SW  = 'Y'
 11126       IF NOT PB-I-POLICY-ACCEPTED  AND
 11127          NOT PB-I-POLICY-DECLINED
 11128           MOVE 'U'               TO PB-BATCH-ENTRY
 11129           MOVE  ER-1926          TO WS-ERROR
 11130           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11131
 11132
 11133 0580-AH-PLAN-LIMIT-EDITS.
 11134
 11135     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11136        IF PB-I-AH-BENEFIT-AMT > +1250
 11137           MOVE ER-2702          TO WS-ERROR
 11138           PERFORM 9900-ERROR-FORMAT
 11139                                 THRU 9900-EXIT
 11140        END-IF
 11141     END-IF
 11142
 11143     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11144        AND (PB-MONTHLY-CERT)
 11145        IF PB-I-AH-BENEFIT-AMT > +3000
 11146           MOVE ER-2881          TO WS-ERROR
 11147           PERFORM 9900-ERROR-FORMAT
 11148                                 THRU 9900-EXIT
 11149        END-IF
 11150     END-IF
 11151     IF NOT AH-PLAN-MASTER-FOUND
 11152        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11153        GO TO 3000-CONTINUE-EDIT.
 11154
 11155     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11156
 11157     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11158         IF PL-LM-AGE (1) = ZEROS
 11159             GO TO 3000-CONTINUE-EDIT.
 11160
 11161     IF NO-AH-BENEFIT-MATCH          OR
 11162        WS-AH-BENEFIT-CD = ZEROS     OR
 11163        WS-AH-SPECIAL-CALC-CD = 'M'
 11164        GO TO 3000-CONTINUE-EDIT.
 11165
 11166     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11167     MOVE +1                     TO SUB2.
 11168
 11169     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11170        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11171           MOVE +5 TO SUB2
 11172           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11173              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11174              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11175              (PL-LM-AGE (SUB2) EQUAL +0)
 11176              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11177              GO TO 3000-CONTINUE-EDIT.
 11178
 11179     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11180
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 203
* EL050.cbl
 11181 0590-CHECK-AH-ATT-AGE.
 11182
 11183     IF PL-ATT-AGE NUMERIC AND
 11184        PL-ATT-AGE GREATER THAN +0
 11185        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11186     END-IF
 11187*       IF WS-ATT-AGE >= PL-ATT-AGE
 11188*          MOVE ER-3054          TO WS-ERROR
 11189*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11190     .
 11191 0597-CHECK-AH-LIMITS.
 11192
 11193     IF PB-COMPANY-ID EQUAL 'CRI'
 11194        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11195           IF SUB2 GREATER THAN +4
 11196              MOVE ER-2638       TO WS-ERROR
 11197              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11198              GO TO 3000-CONTINUE-EDIT.
 11199
 11200     IF PB-COMPANY-ID  =  'NCL'
 11201        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11202            SUB2 GREATER THAN +8
 11203             MOVE 'U'            TO PB-BATCH-ENTRY
 11204             MOVE ER-2638        TO WS-ERROR
 11205             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11206             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11207
 11208     IF SUB2 > +8
 11209        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11210           AND (PB-I-SIG-SW = 'Y')
 11211           CONTINUE
 11212        ELSE
 11213           MOVE ER-2638          TO WS-ERROR
 11214           PERFORM 9900-ERROR-FORMAT
 11215                                 THRU 9900-EXIT
 11216        END-IF
 11217        GO TO 3000-CONTINUE-EDIT
 11218     END-IF
 11219
 11220     IF PB-COMPANY-ID = 'CRI'
 11221        IF WS-ERROR = ER-2638
 11222           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11223
 11224     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11225     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11226     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11227     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11228
 11229     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11230        ADD +1                   TO SUB2
 11231        GO TO 0597-CHECK-AH-LIMITS.
 11232
 11233     IF PB-COMPANY-ID = 'NCL'
 11234         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11235
 11236     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11237        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11238        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 204
* EL050.cbl
 11239                                 > PL-LM-AMT (SUB2))
 11240        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11241           AND (PB-I-SIG-SW = 'Y')
 11242           CONTINUE
 11243        ELSE
 11244           MOVE ER-2638          TO WS-ERROR
 11245           PERFORM 9900-ERROR-FORMAT
 11246                                 THRU 9900-EXIT
 11247        END-IF
 11248     END-IF
 11249
 11250     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11251         IF  WS-ERROR    EQUAL    ER-2638
 11252             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11253                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11254                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11255                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11256                MOVE  ER-1910    TO  WS-ERROR
 11257                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11258
 11259     IF PB-COMPANY-ID = 'CRI'
 11260        IF WS-ERROR = ER-2638
 11261            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11262            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11263            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11264
 11265     GO TO 3000-CONTINUE-EDIT.
 11266
 11267 0597-CHECK-NCL-AH-LIMITS.
 11268
 11269     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11270        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11271        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11272                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11273         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11274
 11275     IF APP-CERT-USED
 11276         IF SUB2  LESS THAN  +5
 11277             MOVE +5             TO SUB2
 11278             GO TO 0597-CHECK-AH-LIMITS.
 11279
 11280     MOVE ER-2638                TO WS-ERROR.
 11281     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11282
 11283     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11284
 11285 0599-CHECK-NCL-SIG-SWITCH.
 11286
 11287     IF NOT APP-CERT-USED
 11288         GO TO 3000-CONTINUE-EDIT.
 11289
 11290     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11291        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11292        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11293        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11294         GO TO 3000-CONTINUE-EDIT.
 11295
 11296     IF SUB2 GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 205
* EL050.cbl
 11297         IF PL-LM-AGE (5) = ZEROS  AND
 11298            PL-LM-AGE (6) = ZEROS  AND
 11299            PL-LM-AGE (7) = ZEROS  AND
 11300            PL-LM-AGE (8) = ZEROS
 11301             MOVE  ER-1927        TO WS-ERROR
 11302             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11303             GO TO 3000-CONTINUE-EDIT
 11304         ELSE
 11305             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11306                 MOVE  ER-1920    TO WS-ERROR
 11307                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11308
 11309     IF PB-I-SIG-SW  = 'Y'
 11310       IF NOT PB-I-POLICY-ACCEPTED  AND
 11311          NOT PB-I-POLICY-DECLINED
 11312           MOVE 'U'               TO PB-BATCH-ENTRY
 11313           MOVE  ER-1926          TO WS-ERROR
 11314           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11315
 11316******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 206
* EL050.cbl
 11318
 11319 3000-CONTINUE-EDIT.
 11320
 11321     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11322     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11323     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11324     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11325     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11326
 11327     IF BROWSE-STARTED
 11328        PERFORM 9990-RETURN THRU 9990-EXIT
 11329        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11330
 11331     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11332        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11333        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11334        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11335*       MOVE 1                   TO DC-OPTION-CODE
 11336        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11337        IF DATE-CONVERSION-ERROR
 11338           MOVE ER-2622          TO WS-ERROR
 11339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11340        ELSE
 11341           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11342              MOVE ER-2623       TO WS-ERROR
 11343              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11344           ELSE
 11345              MOVE ER-2622       TO WS-ERROR
 11346              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11347
 11348     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11349     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11350     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11351*    MOVE 1                      TO DC-OPTION-CODE.
 11352     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11353     IF DATE-CONVERSION-ERROR
 11354        GO TO 3005-EDIT-CONTINUE
 11355     ELSE
 11356        IF DC-ELAPSED-DAYS GREATER +180
 11357           MOVE ER-2613          TO WS-ERROR
 11358           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11359        ELSE
 11360           IF DC-ELAPSED-DAYS GREATER +90
 11361              MOVE ER-2612       TO WS-ERROR
 11362              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363           ELSE
 11364             IF DC-ELAPSED-DAYS GREATER +60
 11365                MOVE ER-2614     TO WS-ERROR
 11366                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11367
 11368 3005-EDIT-CONTINUE.
 11369
 11370     IF PB-CANCELLATION
 11371         GO TO 3700-EDIT-CANCEL.
 11372
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 207
* EL050.cbl
 11374******************************************************************
 11375*                  E D I T   I S S U E                           *
 11376******************************************************************
 11377
 11378 3020-EDIT-ISSUE.
 11379
 11380      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11381      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11382      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11383      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11384      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11385
 11386     IF PB-ISSUE-FORCE
 11387        OR PB-ISSUE-DATE-FORCED
 11388        OR PB-FORCE-OFF
 11389        OR PB-OVERCHARGE-FORCE
 11390        CONTINUE
 11391     ELSE
 11392        MOVE ER-2670             TO WS-ERROR
 11393        PERFORM 9900-ERROR-FORMAT
 11394                                 THRU 9900-EXIT
 11395     END-IF
 11396     .
 11397 3022-SET-POLICY-STATUS.
 11398
 11399     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11400
 11401     IF (PB-REISSUED-CERT)
 11402             OR
 11403        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11404         AND (PB-MONTHLY-CERT))
 11405         MOVE '5'                TO PB-I-ENTRY-STATUS
 11406         MOVE 'E'                TO PB-BATCH-ENTRY
 11407     END-IF
 11408
 11409     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11410        IF PB-MONTHLY-CERT
 11411           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11412        END-IF
 11413        IF PB-CASH-CERT
 11414           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11415        END-IF
 11416     END-IF
 11417     IF PB-POLICY-IS-DECLINED
 11418         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11419     IF PB-POLICY-IS-VOIDED
 11420         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11421     IF PB-NEEDS-UNDERWRITING
 11422         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11423     IF PB-REIN-ONLY-CERT
 11424         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11425     IF PB-PREM-ACCTNG-ONLY
 11426         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11427
 11428     MOVE SPACE                  TO PB-I-OB-FLAG.
 11429
 11430     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11431         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 208
* EL050.cbl
 11432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11433         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11434
 11435     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11436        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11437           MOVE 'Z'             TO PB-I-OB-FLAG.
 11438
 11439     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11440        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11441           MOVE 'Z'             TO PB-I-OB-FLAG.
 11442
 11443     IF ACCOUNT-MAST-FOUND
 11444         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11445         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11446         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11447         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11448         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11449         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11450         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11451     END-IF
 11452
 11453     IF ACCOUNT-MAST-FOUND
 11454        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11455         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11456
 11457     IF (ACCOUNT-MAST-FOUND)
 11458*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11459        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11460        IF PB-REISSUED-CERT
 11461           CONTINUE
 11462        ELSE
 11463           MOVE ER-2608          TO WS-ERROR
 11464           PERFORM 9900-ERROR-FORMAT
 11465                                 THRU 9900-EXIT
 11466         END-IF
 11467     END-IF
 11468
 11469     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11470        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11471        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11472
 11473**********   DMD CUSTOM CODE FOLLOWS  **********
 11474 3024-EDIT-DMD-FIELDS.
 11475     IF PB-COMPANY-ID NOT = 'DMD'
 11476        GO TO 3025-EDIT-REINSURANCE.
 11477
 11478*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11479*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11480*** ERROR IF THEY ARE NOT EQUAL.
 11481
 11482     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11483     SET BIN-TO-GREG               TO TRUE.
 11484     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11485     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11486**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11487
 11488     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11489     SET BIN-TO-GREG               TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 209
* EL050.cbl
 11490     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11491     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11492**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11493
 11494     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11495        MOVE ER-8116               TO WS-ERROR
 11496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11497
 11498     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11499
 11500     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11501                                      WK-FULL-CERT-NO.
 11502     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11503
 11504     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11505
 11506     IF PB-VALID-LIFE
 11507        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11508     ELSE
 11509        IF PB-VALID-AH
 11510          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11511
 11512
 11513     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11514     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11515     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11516                                      DCUA-UNDRWRTR-CODE
 11517                                      DCUA-UNDRWRTR-GROUP-CODE
 11518                                      DCUA-RETURN-CODE.
 11519
 11520****************************************************************
 11521*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11522***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11523***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11524***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11525***   TO THIS RECORD.                                        ***
 11526****************************************************************
 11527     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11528     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11529     IF DCUA-SUCCESSFUL-PROCESS
 11530        GO TO 3024-EDIT-DL7-CONT.
 11531
 11532     IF DCUA-RETURN-CODE EQUAL '01'
 11533        MOVE ER-8110               TO WS-ERROR
 11534        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL7-CONT.
 11537
 11538     IF DCUA-RETURN-CODE EQUAL '02'
 11539        MOVE ER-8111               TO WS-ERROR
 11540        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542        GO TO 3024-EDIT-DL7-CONT.
 11543
 11544     IF DCUA-RETURN-CODE EQUAL '03'
 11545        MOVE ER-8074               TO WS-ERROR
 11546        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 210
* EL050.cbl
 11548        GO TO 3024-EDIT-DL7-CONT.
 11549
 11550     IF DCUA-RETURN-CODE EQUAL '04'
 11551        MOVE ER-8075               TO WS-ERROR
 11552        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11554        GO TO 3024-EDIT-DL7-CONT.
 11555
 11556     IF DCUA-RETURN-CODE EQUAL '05'
 11557        MOVE ER-8076               TO WS-ERROR
 11558        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11560        GO TO 3024-EDIT-DL7-CONT.
 11561
 11562     IF DCUA-RETURN-CODE EQUAL '06'
 11563        MOVE ER-8077               TO WS-ERROR
 11564        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL7-CONT.
 11567
 11568     IF DCUA-RETURN-CODE EQUAL '07'
 11569        MOVE ER-8078               TO WS-ERROR
 11570        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL7-CONT.
 11573
 11574     IF DCUA-RETURN-CODE EQUAL 'E1'
 11575        MOVE ER-8079               TO WS-ERROR
 11576        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578        GO TO 3024-EDIT-DL7-CONT.
 11579
 11580     IF DCUA-RETURN-CODE EQUAL 'E2'
 11581        MOVE ER-8080               TO WS-ERROR
 11582        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584        GO TO 3024-EDIT-DL7-CONT.
 11585
 11586     IF DCUA-RETURN-CODE EQUAL 'E3'
 11587        MOVE ER-8098               TO WS-ERROR
 11588        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL7-CONT.
 11591
 11592     IF DCUA-RETURN-CODE EQUAL 'C1'
 11593        MOVE ER-8099               TO WS-ERROR
 11594        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11596        GO TO 3024-EDIT-DL7-CONT.
 11597
 11598     IF DCUA-RETURN-CODE EQUAL 'U1'
 11599        MOVE ER-8109               TO WS-ERROR
 11600        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11602        GO TO 3024-EDIT-DL7-CONT.
 11603
 11604     IF DCUA-RETURN-CODE EQUAL 'N1'
 11605        MOVE ER-8112               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 211
* EL050.cbl
 11606        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608        GO TO 3024-EDIT-DL7-CONT.
 11609
 11610     IF DCUA-RETURN-CODE EQUAL 'N2'
 11611        MOVE ER-8113               TO WS-ERROR
 11612        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL7-CONT.
 11615
 11616     IF DCUA-RETURN-CODE EQUAL 'N3'
 11617        MOVE ER-8114               TO WS-ERROR
 11618        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL7-CONT.
 11621
 11622     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11623     MOVE ER-8097                  TO WS-ERROR.
 11624     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11625     GO TO 3024-EDIT-DL7-CONT.
 11626
 11627 3024-EDIT-DL7-CONT.
 11628
 11629     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11630     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11631     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11632        NEXT SENTENCE
 11633     ELSE
 11634        MOVE ER-9263               TO WS-ERROR
 11635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11636
 11637******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11638******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11639     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11640        NEXT SENTENCE
 11641     ELSE
 11642        MOVE ER-8039               TO WS-ERROR
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11644
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 212
* EL050.cbl
 11646****************************************************************
 11647*** VALIDATE STATE  : DLO022                                 ***
 11648****************************************************************
 11649     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11650     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11651
 11652     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11653     IF DVSC-SUCCESSFUL-EDIT
 11654        GO TO 3024-EDIT-DL22-CONT.
 11655
 11656     IF DVSC-RETURN-CODE EQUAL '01'
 11657        MOVE ER-8300               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL22-CONT.
 11660
 11661     IF DVSC-RETURN-CODE EQUAL '02'
 11662        MOVE ER-8301               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL22-CONT.
 11665
 11666     IF DVSC-RETURN-CODE EQUAL '03'
 11667        MOVE ER-8302               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL22-CONT.
 11670
 11671     IF DVSC-RETURN-CODE EQUAL 'N1'
 11672        MOVE ER-8304               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674        GO TO 3024-EDIT-DL22-CONT.
 11675
 11676     MOVE ER-8303                  TO WS-ERROR
 11677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11678
 11679 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 213
* EL050.cbl
 11681****************************************************************
 11682*** VALIDATE LOAN OFFICER : DLO021                           ***
 11683****************************************************************
 11684
 11685     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11686     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11687     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11688     IF DVLO-SUCCESSFUL-EDIT
 11689        GO TO 3024-EDIT-DL21-CONT.
 11690
 11691     IF DVLO-RETURN-CODE EQUAL '01'
 11692        MOVE ER-8081               TO WS-ERROR
 11693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11694        GO TO 3024-EDIT-DL21-CONT.
 11695
 11696     IF DVLO-RETURN-CODE EQUAL '02'
 11697        MOVE ER-8082               TO WS-ERROR
 11698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699        GO TO 3024-EDIT-DL21-CONT.
 11700
 11701     IF DVLO-RETURN-CODE EQUAL '03'
 11702        MOVE ER-8083               TO WS-ERROR
 11703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11704        GO TO 3024-EDIT-DL21-CONT.
 11705
 11706     IF DVLO-RETURN-CODE EQUAL '04'
 11707        MOVE ER-8084               TO WS-ERROR
 11708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11709        GO TO 3024-EDIT-DL21-CONT.
 11710
 11711     IF DVLO-RETURN-CODE EQUAL '05'
 11712        MOVE ER-8085               TO WS-ERROR
 11713        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11714        GO TO 3024-EDIT-DL21-CONT.
 11715
 11716     MOVE ER-7825                  TO WS-ERROR
 11717     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11718     GO TO 3024-EDIT-DL21-CONT.
 11719
 11720 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 214
* EL050.cbl
 11722
 11723****************************************************************
 11724*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11725****************************************************************
 11726
 11727     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11728     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11729     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11730     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11731     IF DIPF-SUCCESSFUL-EDIT
 11732        GO TO 3024-EDIT-DL02-CONT.
 11733
 11734     IF DIPF-RETURN-CODE EQUAL '01'
 11735        MOVE ER-8086               TO WS-ERROR
 11736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11737        GO TO 3024-EDIT-DL02-CONT.
 11738
 11739     IF DIPF-RETURN-CODE EQUAL '02'
 11740        MOVE ER-8087               TO WS-ERROR
 11741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11742        GO TO 3024-EDIT-DL02-CONT.
 11743
 11744     IF DIPF-RETURN-CODE EQUAL '03'
 11745        MOVE ER-8088               TO WS-ERROR
 11746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747        GO TO 3024-EDIT-DL02-CONT.
 11748
 11749     MOVE ER-8095                  TO WS-ERROR
 11750     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11751     GO TO 3024-EDIT-DL02-CONT.
 11752
 11753 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 215
* EL050.cbl
 11755
 11756****************************************************************
 11757*** VALIDATE BANK ID : DLO003                                ***
 11758****************************************************************
 11759
 11760     MOVE WK-GREG-CENT           TO WCG-CENT.
 11761     MOVE WK-GREG-YYMM           TO WCG-REST.
 11762     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11763        MOVE ER-8040               TO WS-ERROR
 11764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11765
 11766     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11767     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11768     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11769     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11770     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11771     IF DVBI-SUCCESSFUL-EDIT
 11772        GO TO 3024-EDIT-DL03-CONT.
 11773
 11774     IF DVBI-RETURN-CODE EQUAL '01'
 11775        MOVE ER-8089               TO WS-ERROR
 11776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777        GO TO 3024-EDIT-DL03-CONT.
 11778
 11779     IF DVBI-RETURN-CODE EQUAL '02'
 11780        MOVE ER-8090               TO WS-ERROR
 11781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11782        GO TO 3024-EDIT-DL03-CONT.
 11783
 11784     IF DVBI-RETURN-CODE EQUAL '03'
 11785        MOVE ER-8091               TO WS-ERROR
 11786        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11787        GO TO 3024-EDIT-DL03-CONT.
 11788
 11789     IF DVBI-RETURN-CODE EQUAL '04'
 11790        MOVE ER-8092               TO WS-ERROR
 11791        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792        GO TO 3024-EDIT-DL03-CONT.
 11793
 11794     IF DVBI-RETURN-CODE EQUAL '05'
 11795        MOVE ER-8093               TO WS-ERROR
 11796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11797        GO TO 3024-EDIT-DL03-CONT.
 11798
 11799     IF DVBI-RETURN-CODE EQUAL '06'
 11800        MOVE ER-8094               TO WS-ERROR
 11801        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11802        GO TO 3024-EDIT-DL03-CONT.
 11803
 11804     MOVE ER-8096                  TO WS-ERROR
 11805     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11806     GO TO 3024-EDIT-DL03-CONT.
 11807
 11808 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 216
* EL050.cbl
 11810
 11811     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11812        NEXT SENTENCE
 11813     ELSE
 11814        MOVE ER-8042               TO WS-ERROR
 11815        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11816
 11817     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11818     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11819     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11820
 11821     IF DMPF-RETURN-CODE = '01'
 11822        MOVE ER-8067               TO WS-ERROR
 11823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11824        GO TO 3024-EDIT-DL01-CONT.
 11825
 11826     IF DMPF-RETURN-CODE = '02'
 11827        MOVE ER-8068               TO WS-ERROR
 11828        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11829        GO TO 3024-EDIT-DL01-CONT.
 11830
 11831     IF DMPF-RETURN-CODE = '03'
 11832        MOVE ER-8069               TO WS-ERROR
 11833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11834        GO TO 3024-EDIT-DL01-CONT.
 11835
 11836     IF DMPF-RETURN-CODE = 'E1'
 11837        MOVE ER-8070               TO WS-ERROR
 11838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11839        GO TO 3024-EDIT-DL01-CONT.
 11840
 11841     IF DMPF-RETURN-CODE = 'N1'
 11842        MOVE ER-8071               TO WS-ERROR
 11843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11844        GO TO 3024-EDIT-DL01-CONT.
 11845
 11846     IF DMPF-RETURN-CODE NOT = 'OK'
 11847        MOVE ER-8072               TO WS-ERROR
 11848        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11849
 11850 3024-EDIT-DL01-CONT.
 11851******************************************************************
 11852***  VALIDATES RATE CODES : DLO017                             ***
 11853******************************************************************
 11854
 11855      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11856      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11857      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11858      IF DVRC-SUCCESSFUL-EDIT
 11859        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11860        GO TO 3024-CHECK-VALID-RATE.
 11861
 11862      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11863
 11864      IF DVRC-RETURN-CODE EQUAL '01'
 11865         MOVE ER-7817                   TO WS-ERROR
 11866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11867         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 217
* EL050.cbl
 11868
 11869      IF DVRC-RETURN-CODE EQUAL '02'
 11870         MOVE ER-7818                   TO WS-ERROR
 11871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11872         GO TO 3025-EDIT-REINSURANCE.
 11873
 11874      IF DVRC-RETURN-CODE EQUAL '03'
 11875         MOVE ER-7819                   TO WS-ERROR
 11876         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11877         GO TO 3025-EDIT-REINSURANCE.
 11878
 11879       MOVE ER-7820                     TO WS-ERROR.
 11880       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11881       GO TO 3025-EDIT-REINSURANCE.
 11882
 11883******************************************************************
 11884***  GET PREMIUM RATES : DLO011                                ***
 11885******************************************************************
 11886
 11887 3024-CHECK-VALID-RATE.
 11888
 11889     IF VALID-RATE-CODE
 11890        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11891        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11892        MOVE SPACES                TO DPRB-RETURN-CODE
 11893        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11894     ELSE
 11895         GO TO 3025-EDIT-REINSURANCE.
 11896
 11897      IF DPRB-SUCCESSFUL-PROCESS
 11898         IF PB-VALID-LIFE
 11899             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11900             GO TO 3025-EDIT-REINSURANCE
 11901         ELSE
 11902             IF PB-VALID-AH
 11903                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11904                 GO TO 3025-EDIT-REINSURANCE.
 11905
 11906      IF DPRB-RETURN-CODE EQUAL '01'
 11907         MOVE ER-7812                   TO WS-ERROR
 11908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11909         GO TO 3025-EDIT-REINSURANCE.
 11910
 11911      IF DPRB-RETURN-CODE EQUAL '02'
 11912         MOVE ER-7813                   TO WS-ERROR
 11913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11914         GO TO 3025-EDIT-REINSURANCE.
 11915
 11916      IF DPRB-RETURN-CODE EQUAL '03'
 11917         MOVE ER-7814                   TO WS-ERROR
 11918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11919         GO TO 3025-EDIT-REINSURANCE.
 11920
 11921      IF DPRB-RETURN-CODE EQUAL '04'
 11922         IF NOT DPRB-1ST-TIME
 11923            MOVE ER-7815                   TO WS-ERROR
 11924            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11925            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 218
* EL050.cbl
 11926          ELSE
 11927         IF PB-VALID-LIFE
 11928            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11929          ELSE
 11930            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11931         END-IF
 11932         MOVE SPACES                TO DOCC-RETURN-CODE
 11933         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11934         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11935         IF DOCC-RETURN-CODE = 'OK'
 11936             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11937             GO TO 3024-CHECK-VALID-RATE
 11938           ELSE
 11939             MOVE ER-7823               TO WS-ERROR
 11940             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11941             GO TO 3025-EDIT-REINSURANCE.
 11942
 11943       MOVE ER-7816                     TO WS-ERROR.
 11944       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11945       GO TO 3025-EDIT-REINSURANCE.
 11946
 11947**********   DMD CUSTOM CODE ABOVE    **********
 11948
 11949 3025-EDIT-REINSURANCE.
 11950     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11951         GO TO 3027-EDIT-CONTINUE.
 11952
 11953     MOVE LOW-VALUES               TO ERREIN-KEY.
 11954     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11955     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11956                                      REIN-CODE-2
 11957                                      REIN-CODE-3.
 11958     MOVE 'A'                      TO REIN-TYPE.
 11959
 11960     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11961
 11962     MOVE '3026' TO REIN-SW.
 11963     MOVE ' '                   TO WS-REIN-READ-SW.
 11964
 11965     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11966     IF REIN-TABLE-NOT-FOUND
 11967         GO TO 3026-NO-SPEC-TABLE.
 11968
 11969     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11970     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11971                                   WS-NSP-ST-CD-LF.
 11972     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11973                                   WS-NSP-ST-CD-AH.
 11974
 11975     GO TO 3040-EDIT-CONTINUE.
 11976
 11977 3026-NO-SPEC-TABLE.
 11978
 11979     MOVE ER-2664                TO WS-ERROR.
 11980     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11981     GO TO 3040-EDIT-CONTINUE.
 11982
 11983 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 219
* EL050.cbl
 11984
 11985     IF PB-I-REIN-TABLE = SPACES
 11986       GO TO 3040-EDIT-CONTINUE.
 11987
 11988     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11989          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11990          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11991           GO TO 3040-EDIT-CONTINUE.
 11992
 11993     MOVE LOW-VALUES            TO ERREIN-KEY.
 11994     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11995     MOVE 'A'                   TO REIN-TYPE.
 11996     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11997
 11998     MOVE '3028'                TO REIN-SW.
 11999     MOVE ' '                   TO WS-REIN-READ-SW.
 12000
 12001     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12002     IF REIN-TABLE-NOT-FOUND
 12003         GO TO 3028-NO-REIN-TABLE.
 12004
 12005     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12006     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12007                                   WS-NSP-ST-CD-LF.
 12008     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12009                                   WS-NSP-ST-CD-AH.
 12010
 12011     GO TO 3040-EDIT-CONTINUE.
 12012
 12013 3028-NO-REIN-TABLE.
 12014
 12015     MOVE ER-2615                TO WS-ERROR.
 12016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12017     GO TO 3040-EDIT-CONTINUE.
 12018
 12019 3040-EDIT-CONTINUE.
 12020
 12021     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12022         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12023
 12024     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12025         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12026
 12027     IF (NOT PB-REISSUED-CERT)
 12028        AND (NOT PB-MONTHLY-CERT)
 12029        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12030            MOVE '001'           TO PB-I-LF-TERM
 12031            MOVE 'M'             TO PB-I-INSURED-SEX.
 12032
 12033     IF (NOT PB-REISSUED-CERT)
 12034        AND (NOT PB-MONTHLY-CERT)
 12035        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12036            MOVE '001'           TO PB-I-AH-TERM
 12037            MOVE 'M'             TO PB-I-INSURED-SEX.
 12038
 12039 3040-EDIT-1ST-PMT-DT.
 12040     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12041     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 220
* EL050.cbl
 12042         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12043
 12044******************************************************************
 12045*                                                                *
 12046*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12047*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12048*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12049*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12050*                                                                *
 12051******************************************************************
 12052
 12053     IF PB-EFF-DT-PROCESSING
 12054        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12055                                    PB-I-LF-EXPIRE-DT
 12056                                    PB-I-AH-EXPIRE-DT
 12057        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12058        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12059        MOVE ZERO                TO DC-ELAPSED-DAYS
 12060        MOVE +1                  TO DC-ELAPSED-MONTHS
 12061        SET BIN-PLUS-ELAPSED     TO TRUE
 12062*       MOVE 6                   TO DC-OPTION-CODE
 12063        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12064        IF NO-CONVERSION-ERROR
 12065           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12066
 12067******************************************************************
 12068*                                                                *
 12069*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12070*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12071*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12072*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12073*                                                                *
 12074******************************************************************
 12075
 12076     IF PB-EXT-DAYS-PROCESSING
 12077          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12078                                         PB-I-LF-EXPIRE-DT
 12079                                         PB-I-AH-EXPIRE-DT
 12080          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12081          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12082          MOVE +1                     TO DC-ELAPSED-MONTHS
 12083          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12084          SET BIN-PLUS-ELAPSED        TO TRUE
 12085*         MOVE 6                      TO DC-OPTION-CODE
 12086          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12087          IF NO-CONVERSION-ERROR
 12088             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12089
 12090******************************************************************
 12091*                                                                *
 12092*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12093*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12094*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12095*        (EXPIRE DATE - (TERM -1))  *  -1.
 12096*                                                                *
 12097******************************************************************
 12098
 12099     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 221
* EL050.cbl
 12100        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12101           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12102              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12103              MOVE PB-I-AH-TERM      TO WS-TERM
 12104           ELSE
 12105              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12106              MOVE PB-I-LF-TERM      TO WS-TERM
 12107        ELSE
 12108           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12109              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12110              MOVE PB-I-LF-TERM      TO WS-TERM
 12111           ELSE
 12112              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12113              MOVE PB-I-AH-TERM      TO WS-TERM.
 12114
 12115     IF PB-EXPIRE-DT-PROCESSING
 12116        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12117        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12118        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12119        MOVE ZERO                TO DC-ELAPSED-DAYS
 12120                                    DC-ODD-DAYS-OVER
 12121          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12122          SET BIN-PLUS-ELAPSED    TO TRUE
 12123*         MOVE 6                  TO DC-OPTION-CODE
 12124          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12125          IF NO-CONVERSION-ERROR
 12126             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12127
 12128******************************************************************
 12129*                                                                *
 12130*            1ST PAYMENT DATE PROCESSING                         *
 12131*                                                                *
 12132******************************************************************
 12133
 12134     IF PB-1ST-PMT-DT-PROCESSING
 12135        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12136                                    PB-I-AH-EXPIRE-DT
 12137        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12138
 12139     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12140         NEXT SENTENCE
 12141     ELSE
 12142         MOVE ER-2680                 TO WS-ERROR
 12143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12144         GO TO 3060-ORIG-TERM-CHECK.
 12145
 12146     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12147     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12148     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12149*    MOVE 1                      TO DC-OPTION-CODE.
 12150     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12151                                    DC-ELAPSED-DAYS
 12152                                    DC-ODD-DAYS-OVER.
 12153
 12154     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12155
 12156     IF DATE-CONVERSION-ERROR
 12157        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 222
* EL050.cbl
 12158
 12159     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12160     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12161        AND (WS-LF-COVERAGE-TYPE = 'L')
 12162        IF (DC-ELAPSED-MONTHS > 1)
 12163                      OR
 12164           ((DC-ELAPSED-MONTHS = 1)
 12165           AND (DC-ODD-DAYS-OVER > 0))
 12166           MOVE ER-2882          TO WS-ERROR
 12167           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12168        END-IF
 12169     END-IF
 12170     if dc-elapsed-months > 0
 12171        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12172        + dc-odd-days-over
 12173     end-if
 12174     IF PB-EXT-DAYS-PROCESSING
 12175        CONTINUE
 12176     ELSE
 12177        IF DC-ELAPSED-MONTHS = +0
 12178           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12179        ELSE
 12180           IF (WS-LF-EARNINGS-CALC = '4')
 12181              AND (DC-ELAPSED-MONTHS > ZERO)
 12182              AND (DC-ELAPSED-DAYS > ZERO)
 12183              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12184           ELSE
 12185              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12186                                 THRU 6499-EXIT
 12187              MOVE WS-ODD-DAYS-OVER
 12188                                 TO PB-I-EXTENTION-DAYS
 12189           END-IF
 12190        END-IF
 12191     END-IF
 12192******************************************************************
 12193*                                                                *
 12194*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12195*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12196*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12197*            AND ANY ODD DAYS.                                   *
 12198*                                                                *
 12199******************************************************************
 12200
 12201     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12202                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12203     IF WS-LF-EARNINGS-CALC NOT = '4'
 12204        IF DC-ELAPSED-DAYS > ZEROS
 12205           MOVE ER-2681          TO WS-ERROR
 12206           PERFORM 9900-ERROR-FORMAT
 12207                                 THRU 9900-EXIT
 12208        END-IF
 12209     END-IF
 12210
 12211     IF WS-LF-EARNINGS-CALC NOT = '4'
 12212        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12213           MOVE ER-2681          TO WS-ERROR
 12214           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12215
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 223
* EL050.cbl
 12216     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12217        (PB-I-LF-TERM NOT = ZERO) AND
 12218         NOT NO-LIFE-COVERAGE
 12219          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12220          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12221          IF WS-LF-EARNINGS-CALC = '4'
 12222             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12223             PB-I-PAY-FREQUENCY
 12224          END-IF
 12225          MOVE ZERO              TO DC-ELAPSED-DAYS
 12226                                    DC-ODD-DAYS-OVER
 12227          MOVE 1                 TO DC-END-OF-MONTH
 12228          SET BIN-PLUS-ELAPSED        TO TRUE
 12229*         MOVE 6                 TO DC-OPTION-CODE
 12230          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12231          IF NO-CONVERSION-ERROR
 12232             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12233             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12234                (WS-LF-SPECIAL-CALC-CD = 'L')
 12235                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12236                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12237                  MOVE +1             TO DC-ELAPSED-MONTHS
 12238                  SET BIN-PLUS-ELAPSED  TO TRUE
 12239*                 MOVE 6              TO DC-OPTION-CODE
 12240                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12241                  IF NO-CONVERSION-ERROR
 12242                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12243
 12244* okay, i had to move the new att age edit down here because the
 12245* expiration date could get recalculated and i need the exp date
 12246     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12247        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12248        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12249        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12250           AND ZEROS
 12251           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12252           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12253           SET ELAPSED-BETWEEN-BIN TO TRUE
 12254           PERFORM 8500-DATE-CONVERT
 12255                                 THRU 8500-EXIT
 12256           IF NO-CONVERSION-ERROR
 12257              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12258                 MOVE ER-2669       TO WS-ERROR
 12259*                PERFORM 9900-ERROR-FORMAT
 12260*                                THRU 9900-EXIT
 12261              END-IF
 12262           END-IF
 12263        ELSE
 12264           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12265           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12266              MOVE ER-2669       TO WS-ERROR
 12267*             PERFORM 9900-ERROR-FORMAT
 12268*                                THRU 9900-EXIT
 12269           ELSE
 12270              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12271                 MOVE ER-1570    TO WS-ERROR
 12272                 PERFORM 9900-ERROR-FORMAT
 12273                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 224
* EL050.cbl
 12274              END-IF
 12275           END-IF
 12276        END-IF
 12277        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12278           AND ZEROS
 12279           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12280           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12281           SET ELAPSED-BETWEEN-BIN TO TRUE
 12282           PERFORM 8500-DATE-CONVERT
 12283                                 THRU 8500-EXIT
 12284           IF NO-CONVERSION-ERROR
 12285              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12286                 MOVE ER-2669       TO WS-ERROR
 12287*                PERFORM 9900-ERROR-FORMAT
 12288*                                THRU 9900-EXIT
 12289              END-IF
 12290           END-IF
 12291        ELSE
 12292           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12293             (PB-I-LF-TERM / 12)
 12294           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12295              MOVE ER-2669       TO WS-ERROR
 12296*             PERFORM 9900-ERROR-FORMAT
 12297*                                THRU 9900-EXIT
 12298           ELSE
 12299              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12300                 MOVE ER-1571    TO WS-ERROR
 12301                 PERFORM 9900-ERROR-FORMAT
 12302                                 THRU 9900-EXIT
 12303              END-IF
 12304           END-IF
 12305        END-IF
 12306        IF WS-ERROR = ER-2669
 12307           PERFORM 9900-ERROR-FORMAT
 12308                                 THRU 9900-EXIT
 12309        END-IF
 12310     END-IF
 12311     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12312        (PB-I-AH-TERM NOT = ZERO) AND
 12313         NOT NO-AH-COVERAGE
 12314          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12315             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12316             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12317             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12318          ELSE
 12319             IF WS-LF-EARNINGS-CALC = '4'
 12320                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12321                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12322                PB-I-PAY-FREQUENCY
 12323             ELSE
 12324                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12325                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12326             END-IF
 12327          END-IF
 12328          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12329                                         DC-ODD-DAYS-OVER
 12330          MOVE 1                      TO DC-END-OF-MONTH
 12331          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 225
* EL050.cbl
 12332*         MOVE 6                      TO DC-OPTION-CODE
 12333          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12334          IF NO-CONVERSION-ERROR
 12335             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12336     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12337        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12338        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12339        IF PB-I-BIRTHDAY > LOW-VALUES
 12340           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12341           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12342           SET ELAPSED-BETWEEN-BIN TO TRUE
 12343           PERFORM 8500-DATE-CONVERT
 12344                                 THRU 8500-EXIT
 12345           IF NO-CONVERSION-ERROR
 12346              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12347                 MOVE ER-3054       TO WS-ERROR
 12348*                PERFORM 9900-ERROR-FORMAT
 12349*                                THRU 9900-EXIT
 12350              END-IF
 12351           END-IF
 12352        ELSE
 12353           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12354           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12355              MOVE ER-3054       TO WS-ERROR
 12356*             PERFORM 9900-ERROR-FORMAT
 12357*                                THRU 9900-EXIT
 12358           END-IF
 12359        END-IF
 12360        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12361           AND ZEROS
 12362           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12363           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12364           SET ELAPSED-BETWEEN-BIN TO TRUE
 12365           PERFORM 8500-DATE-CONVERT
 12366                                 THRU 8500-EXIT
 12367           IF NO-CONVERSION-ERROR
 12368              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12369                 MOVE ER-3054       TO WS-ERROR
 12370*                PERFORM 9900-ERROR-FORMAT
 12371*                                THRU 9900-EXIT
 12372              END-IF
 12373           END-IF
 12374        ELSE
 12375           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12376             (PB-I-AH-TERM / 12)
 12377           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12378              MOVE ER-3054       TO WS-ERROR
 12379*             PERFORM 9900-ERROR-FORMAT
 12380*                                THRU 9900-EXIT
 12381           END-IF
 12382        END-IF
 12383        IF WS-ERROR = ER-3054
 12384           PERFORM 9900-ERROR-FORMAT
 12385                                 THRU 9900-EXIT
 12386        END-IF
 12387     END-IF
 12388     MOVE SPACE                       TO DC-END-OF-MONTH.
 12389
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 226
* EL050.cbl
 12390     IF PB-COMPANY-ID = 'NCB'
 12391        GO TO 3040-EDIT-EXTENSION-DAYS.
 12392
 12393     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12394       AND
 12395        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12396        NEXT SENTENCE
 12397     ELSE
 12398        GO TO 3040-EDIT-EXTENSION-DAYS.
 12399
 12400     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12401        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12402        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12403     ELSE
 12404        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12405        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12406
 12407     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12408*    MOVE '1'      TO DC-OPTION-CODE
 12409     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12410     IF (NO-CONVERSION-ERROR)
 12411        AND (DC-ELAPSED-MONTHS > +1)
 12412        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12413        MOVE ER-2668   TO WS-ERROR
 12414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12415
 12416 3040-EDIT-EXTENSION-DAYS.
 12417
 12418     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12419        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12420         GO TO 3050-EDIT-TERM-IN-DAYS
 12421     ELSE
 12422         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12423
 12424     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12425         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12426     ELSE
 12427        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12428           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12429           MOVE ER-2681         TO WS-ERROR
 12430           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12431
 12432     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12433        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12434        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12435         GO TO 3060-ORIG-TERM-CHECK.
 12436
 12437     GO TO 3060-ORIG-TERM-CHECK.
 12438
 12439 3050-EDIT-TERM-IN-DAYS.
 12440
 12441     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12442
 12443     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12444         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12445     ELSE
 12446         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12447            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 227
* EL050.cbl
 12448            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12449
 12450     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12451                                       REMAINDER WS-WORK-TERM.
 12452     IF WS-WORK-TERM GREATER THAN ZERO
 12453         ADD +1 TO PB-I-LF-TERM.
 12454
 12455     IF NOT NO-AH-COVERAGE
 12456         MOVE ER-2684            TO WS-ERROR
 12457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12458
 12459
 12460 3060-ORIG-TERM-CHECK.
 12461
 12462******************************************************************
 12463*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12464******************************************************************
 12465
 12466     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12467        NEXT SENTENCE
 12468     ELSE
 12469        IF NOT NO-LIFE-COVERAGE
 12470           IF PB-I-LF-TERM NUMERIC
 12471              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12472              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12473              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12474                  NEXT SENTENCE
 12475           ELSE
 12476              MOVE ER-2647       TO WS-ERROR
 12477              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12478
 12479     IF NOT NO-AH-COVERAGE
 12480         IF PB-I-AH-TERM NUMERIC
 12481            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12482            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12483            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12484             NEXT SENTENCE
 12485          ELSE
 12486              MOVE ER-2658       TO WS-ERROR
 12487              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12488
 12489     IF PB-COMPANY-ID = 'NCB'
 12490        GO TO 3070-LOAN-TERM-CHECK.
 12491
 12492     IF POLICY-HAS-AH
 12493       AND
 12494        POLICY-HAS-LIFE
 12495       AND
 12496        PB-I-LF-TERM NUMERIC
 12497       AND
 12498        PB-I-AH-TERM NUMERIC
 12499        NEXT SENTENCE
 12500     ELSE
 12501        GO TO 3070-LOAN-TERM-CHECK.
 12502
 12503     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12504     IF WS-TEX-FACT-2 LESS THAN +0
 12505        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 228
* EL050.cbl
 12506
 12507     IF WS-TEX-FACT-2 GREATER THAN +1
 12508        MOVE ER-2668             TO WS-ERROR
 12509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12510
 12511 3070-LOAN-TERM-CHECK.
 12512
 12513     IF (WS-LF-BENEFIT-CD = ZERO)
 12514         OR (NO-LF-BENEFIT-MATCH)
 12515            GO TO 3125-EDIT-PMT-FREQ.
 12516*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12517*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12518*          AND 'V' AND 'W' AND 'X'
 12519*          GO TO 3125-EDIT-PMT-FREQ
 12520*       END-IF
 12521*    ELSE
 12522*       IF WS-AH-DCC-TRUNC = 'T'
 12523*          CONTINUE
 12524*       ELSE
 12525*          GO TO 3125-EDIT-PMT-FREQ
 12526*       END-IF
 12527*    END-IF
 12528     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12529                    OR
 12530        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12531        AND (WS-AH-DCC-TRUNC = 'T'))
 12532        CONTINUE
 12533     ELSE
 12534        GO TO 3125-EDIT-PMT-FREQ
 12535     END-IF
 12536     IF PB-I-LOAN-TERM NOT NUMERIC
 12537         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12538
 12539     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12540        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12541*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12542        PB-I-LOAN-TERM NOT GREATER THAN +360
 12543         NEXT SENTENCE
 12544     ELSE
 12545         MOVE ER-2648            TO WS-ERROR
 12546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12547
 12548     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12549        MOVE ER-3058             TO WS-ERROR
 12550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12551     end-if
 12552
 12553     IF WS-STATE-ABBREVIATION = 'NC'
 12554        IF PB-I-LOAN-TERM > +59
 12555           CONTINUE
 12556        ELSE
 12557           MOVE ER-2792          TO WS-ERROR
 12558           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12559        END-IF
 12560     END-IF
 12561
 12562     .
 12563 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 229
* EL050.cbl
 12564     IF (WS-LF-BENEFIT-CD = ZERO)
 12565         OR (NO-LF-BENEFIT-MATCH)
 12566            GO TO 3127-EDIT-LOAN-OFFICER.
 12567     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12568                    OR
 12569        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12570        AND (WS-AH-DCC-TRUNC = 'T'))
 12571                    OR
 12572         (PB-COMPANY-ID = 'AHL')
 12573        CONTINUE
 12574     ELSE
 12575        IF (PB-I-LOAN-TERM > ZEROS)
 12576           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12577           MOVE ER-1575          TO WS-ERROR
 12578           PERFORM 9900-ERROR-FORMAT
 12579                                 THRU 9900-EXIT
 12580        END-IF
 12581     END-IF
 12582     IF WS-LF-EARNINGS-CALC NOT = '4'
 12583         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12584            MOVE ER-2653         TO WS-ERROR
 12585            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12586            GO TO 3127-EDIT-LOAN-OFFICER
 12587         ELSE
 12588            GO TO 3127-EDIT-LOAN-OFFICER.
 12589
 12590     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12591         MOVE ER-2655            TO WS-ERROR
 12592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593         GO TO 3127-EDIT-LOAN-OFFICER.
 12594
 12595     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12596         MOVE ER-2654            TO WS-ERROR
 12597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12598         GO TO 3127-EDIT-LOAN-OFFICER.
 12599
 12600     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12601         GIVING WS-TEX-FACT-2
 12602             REMAINDER WS-TEX-FACT-3.
 12603
 12604*    IF WS-TEX-FACT-3 NOT = ZERO
 12605*       MOVE ER-2654             TO WS-ERROR
 12606*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12607
 12608
 12609 3127-EDIT-LOAN-OFFICER.
 12610
 12611     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12612        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12613           MOVE ER-2690          TO WS-ERROR
 12614           PERFORM 9900-ERROR-FORMAT
 12615                                 THRU 9900-EXIT
 12616        ELSE
 12617           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12618           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12619           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12620           MOVE PB-SV-STATE      TO LOFC-STATE
 12621           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 230
* EL050.cbl
 12622           MOVE PB-I-LOAN-OFFICER
 12623                                 TO LOFC-CODE
 12624           PERFORM 8586-READ-LOAN-OFFICER
 12625                                 THRU 8586-EXIT
 12626           IF (NOT LOFC-MASTER-FOUND)
 12627              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12628              MOVE ER-3006       TO WS-ERROR
 12629              PERFORM 9900-ERROR-FORMAT
 12630                                 THRU 9900-EXIT
 12631           END-IF
 12632        END-IF
 12633     END-IF
 12634     .
 12635 3129-EDIT-APR.
 12636
 12637     IF (WS-LF-BENEFIT-CD = ZERO)
 12638        OR (NO-LF-BENEFIT-MATCH)
 12639        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12640           GO TO 3130-EDIT-AGE
 12641*       ELSE
 12642*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12643*             GO TO 3130-EDIT-AGE
 12644*          END-IF
 12645        END-IF
 12646     END-IF
 12647
 12648     IF (WS-STATE-ABBREVIATION = 'OH')
 12649         AND (PB-I-RATE-CLASS NOT = 'L ')
 12650         AND (PB-I-LF-TERM GREATER THAN 60)
 12651         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12652         GO TO 3129-APR-CONT.
 12653
 12654     IF (WS-STATE-ABBREVIATION = 'RI')
 12655         AND (PB-I-LF-TERM GREATER THAN 60)
 12656         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12657         GO TO 3129-APR-CONT.
 12658
 12659     IF (WS-STATE-ABBREVIATION = 'UT')
 12660         AND (PB-I-LF-TERM GREATER THAN 62)
 12661         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12662         AND (PB-CERT-EFF-DT LESS WS-830901)
 12663         GO TO 3129-APR-CONT.
 12664
 12665     IF PB-COMPANY-ID = 'LAP'
 12666        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12667           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12668              MOVE ER-2656         TO WS-ERROR
 12669              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12670              GO TO 3130-EDIT-AGE.
 12671
 12672     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12673        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12674        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12675        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12676        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12677        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12678         GO TO 3130-EDIT-AGE.
 12679
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 231
* EL050.cbl
 12680 3129-APR-CONT.
 12681     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12682         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12683         GO TO 3130-EDIT-AGE.
 12684
 12685     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12686         WS-AH-BENEFIT-CD (1:1) = 'S')
 12687        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12688        AND (PB-I-LOAN-APR = ZERO)
 12689        MOVE ER-2657             TO WS-ERROR
 12690        PERFORM 9900-ERROR-FORMAT
 12691                                 THRU 9900-EXIT
 12692        GO TO 3130-EDIT-AGE
 12693     END-IF
 12694*    IF PB-I-LOAN-APR = ZERO
 12695*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12696*    END-IF
 12697
 12698     if pb-i-loan-apr = +99.9999
 12699        move er-2656             to ws-error
 12700        PERFORM 9900-ERROR-FORMAT
 12701                                 THRU 9900-EXIT
 12702        GO TO 3130-EDIT-AGE
 12703     end-if
 12704*    IF PB-I-LOAN-APR = ZERO
 12705*       MOVE ER-2656             TO WS-ERROR
 12706*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12707*       GO TO 3130-EDIT-AGE.
 12708
 12709*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12710     if pb-i-loan-apr not = +99.9999
 12711        IF PB-I-LOAN-APR > +30.000
 12712           MOVE ER-2657          TO WS-ERROR
 12713           PERFORM 9900-ERROR-FORMAT
 12714                                 THRU 9900-EXIT
 12715        end-if
 12716     end-if
 12717     .
 12718 3130-EDIT-AGE.
 12719
 12720******************************************************************
 12721*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12722******************************************************************
 12723
 12724     IF NOT NO-LIFE-COVERAGE
 12725        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12726           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12727               MOVE ER-2628             TO WS-ERROR
 12728               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12729
 12730     IF NOT NO-AH-COVERAGE
 12731        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12732           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12733               MOVE ER-2628         TO WS-ERROR
 12734               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12735
 12736 3133-SEX-CODE.
 12737     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 232
* EL050.cbl
 12738         IF WS-DEFAULT-SEX = 'M'
 12739             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12740          ELSE
 12741             IF WS-DEFAULT-SEX = 'F'
 12742             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12743
 12744     IF PB-I-INSURED-SEX = '1'
 12745         MOVE 'M' TO PB-I-INSURED-SEX.
 12746
 12747     IF PB-I-INSURED-SEX = '2'
 12748         MOVE 'F' TO PB-I-INSURED-SEX.
 12749
 12750 3134-SIG-SW-EDIT.
 12751     IF PB-I-SIG-SW = SPACE
 12752         MOVE 'N'                TO  PB-I-SIG-SW.
 12753
 12754     IF PB-COMPANY-ID = 'NCL'
 12755         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12756             NEXT SENTENCE
 12757         ELSE
 12758             MOVE ER-1923        TO  WS-ERROR
 12759             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12760     ELSE
 12761     IF PB-COMPANY-ID = 'CRI'
 12762         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12763             NEXT SENTENCE
 12764         ELSE
 12765             MOVE ER-2606        TO  WS-ERROR
 12766             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12767     ELSE
 12768     IF PB-COMPANY-ID = 'TMS'
 12769         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12770             NEXT SENTENCE
 12771         ELSE
 12772             MOVE ER-2689        TO  WS-ERROR
 12773             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12774     ELSE
 12775         IF PB-I-SIG-SW = 'Y' OR 'N'
 12776             NEXT SENTENCE
 12777         ELSE
 12778             MOVE ER-2651        TO  WS-ERROR
 12779             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12780
 12781     IF PB-COMPANY-ID = 'FLA'
 12782         IF (WS-EDIT-AGE GREATER 54  OR
 12783             WS-AH-EDIT-AGE GREATER 54)  AND
 12784            PB-I-SIG-SW = 'N'
 12785            MOVE ER-2651         TO  WS-ERROR
 12786            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12787
 12788 3135-NAME-EDIT.
 12789
 12790     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12791        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12792        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12793           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12794                                 TO PB-I-JOINT-FIRST-NAME
 12795        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 233
* EL050.cbl
 12796     END-IF
 12797     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12798        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12799        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12800           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12801                                 TO PB-I-JOINT-LAST-NAME
 12802        END-PERFORM
 12803     END-IF
 12804     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12805        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12806        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12807           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12808                                 TO PB-I-INSURED-FIRST-NAME
 12809        END-PERFORM
 12810     END-IF
 12811     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12812        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12813        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12814           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12815                                 TO PB-I-INSURED-LAST-NAME
 12816        END-PERFORM
 12817     END-IF
 12818     IF PB-I-INSURED-LAST-NAME = SPACES
 12819       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12820       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12821           MOVE ER-2660    TO WS-ERROR
 12822           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12823
 12824 3136-EDIT-SEX.
 12825
 12826******************************************************************
 12827*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12828******************************************************************
 12829
 12830     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12831        (WS-AH-SPECIAL-CALC-CD = 'O')
 12832        NEXT SENTENCE
 12833     ELSE
 12834        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12835           NEXT SENTENCE
 12836        ELSE
 12837           MOVE ER-2629            TO WS-ERROR
 12838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12839
 12840 3137-EDIT-EFF-DATE.
 12841
 12842     IF PB-REISSUED-CERT       OR
 12843        PB-POLICY-IS-DECLINED  OR
 12844        PB-POLICY-IS-VOIDED
 12845         GO TO 3139-EDIT-COVERAGE-CODES.
 12846
 12847     MOVE SPACE                  TO WS-2671-SW
 12848                                    WS-2672-SW.
 12849
 12850     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12851         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12852             MOVE ER-2703        TO WS-ERROR
 12853             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 234
* EL050.cbl
 12854             GO TO 3139-EDIT-COVERAGE-CODES.
 12855
 12856     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12857         GO TO 3139-EDIT-COVERAGE-CODES.
 12858
 12859     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12860     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12861*    MOVE '1'                    TO DC-OPTION-CODE.
 12862     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12863     MOVE +0                     TO DC-ELAPSED-MONTHS
 12864                                    DC-ELAPSED-DAYS.
 12865     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12866
 12867     IF DATE-CONVERSION-ERROR
 12868         GO TO 3139-EDIT-COVERAGE-CODES.
 12869
 12870     IF DC-ELAPSED-DAYS GREATER +180
 12871         MOVE ER-2672            TO WS-ERROR
 12872         MOVE 'Y'                TO WS-2672-SW
 12873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12874     END-IF
 12875
 12876     IF WS-ERROR = ER-2671  AND
 12877        PB-COMPANY-ID  = 'LBL'
 12878        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12879        MOVE SPACE               TO WS-2671-SW
 12880        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12881
 12882     IF PB-ISSUE-DATE-FORCED  AND
 12883      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12884         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12885         MOVE ER-2673            TO WS-ERROR
 12886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12887         MOVE SPACE              TO WS-2671-SW
 12888                                    WS-2672-SW.
 12889
 12890     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12891         IF PB-ISSUE-DATE-FORCED
 12892             MOVE ER-2600          TO  WS-ERROR
 12893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12894         ELSE
 12895             MOVE ER-2692          TO  WS-ERROR
 12896             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12897
 12898
 12899 3139-EDIT-COVERAGE-CODES.
 12900
 12901     if pb-company-id not = 'AHL'
 12902        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12903           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12904           MOVE ER-2787          TO WS-ERROR
 12905           PERFORM 9900-ERROR-FORMAT
 12906                                 THRU 9900-EXIT
 12907        END-IF
 12908     end-if
 12909     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12910        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12911                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 235
* EL050.cbl
 12912           MOVE ER-2719          TO WS-ERROR
 12913           PERFORM 9900-ERROR-FORMAT
 12914                                 THRU 9900-EXIT
 12915        END-IF
 12916     END-IF
 12917
 12918     IF PB-POLICY-IS-DECLINED  OR
 12919        PB-POLICY-IS-VOIDED
 12920         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12921
 12922     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12923        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12924         MOVE ER-2630                TO WS-ERROR
 12925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12926
 12927     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12928        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12929        PB-I-LF-PREMIUM-AMT = ZERO
 12930         GO TO 3140-CHECK-AH-FOR-ZERO.
 12931
 12932     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12933        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12934        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12935         GO TO 3140-CHECK-AH-FOR-ZERO.
 12936
 12937     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12938        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12939        MOVE ER-2631             TO WS-ERROR
 12940        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12941     END-IF
 12942
 12943
 12944******************************************************************
 12945*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12946******************************************************************
 12947
 12948     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12949        NEXT SENTENCE
 12950     ELSE
 12951        IF PB-I-LF-BENEFIT-AMT = ZERO
 12952           MOVE ER-2632             TO WS-ERROR
 12953           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12954
 12955
 12956******************************************************************
 12957*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12958******************************************************************
 12959
 12960     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12961        CONTINUE
 12962     ELSE
 12963        IF PB-I-LF-PREMIUM-AMT = ZERO
 12964           IF (NOT PB-COMP-LF-PREM)
 12965              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12966              and (ws-lf-ben-category not = 'C')
 12967              MOVE ER-2633       TO WS-ERROR
 12968              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 236
* EL050.cbl
 12970        END-IF
 12971     END-IF
 12972     .
 12973 3140-CHECK-AH-FOR-ZERO.
 12974
 12975     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12976        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12977        PB-I-AH-PREMIUM-AMT = ZERO
 12978         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12979
 12980     IF PB-COMPANY-ID = 'CSL'  AND
 12981        PB-I-AH-BENEFIT-CD = ZERO  AND
 12982        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12983        PB-I-AH-PREMIUM-AMT = ZERO
 12984         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12985
 12986     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12987        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12988        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12989         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12990
 12991     IF PB-I-AH-BENEFIT-CD = ZERO
 12992         MOVE ER-2634            TO WS-ERROR
 12993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12994
 12995******************************************************************
 12996*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12997******************************************************************
 12998
 12999     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13000        NEXT SENTENCE
 13001     ELSE
 13002        IF PB-I-AH-BENEFIT-AMT = ZERO
 13003           MOVE ER-2635             TO WS-ERROR
 13004           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13005
 13006******************************************************************
 13007*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13008******************************************************************
 13009
 13010     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13011        NEXT SENTENCE
 13012     ELSE
 13013        IF PB-I-AH-PREMIUM-AMT = ZERO
 13014            IF NOT PB-COMP-AH-PREM
 13015                MOVE ER-2636    TO WS-ERROR
 13016                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13017
 13018
 13019 3140-EDIT-MAX-AMT-SIZES.
 13020* CUSTOM CODE FOR CLIENT    'DMD'
 13021     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13022                                     WS-RES-MUNI-TAX
 13023                                     PB-I-STATE-TAX
 13024                                     PB-I-MUNI-TAX.
 13025
 13026     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13027
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 237
* EL050.cbl
 13028     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13029        GO TO 3150-RATE-OUTSTAND-BAL.
 13030
 13031     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13032        GO TO 3150-RATE-OUTSTAND-BAL.
 13033
 13034     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13035        GO TO 3150-RATE-OUTSTAND-BAL.
 13036
 13037     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13038                             OR 'RIC')
 13039        GO TO 3150-RATE-OUTSTAND-BAL.
 13040
 13041     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13042        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13043            GO TO 3150-RATE-OUTSTAND-BAL
 13044        ELSE
 13045           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13046               GO TO 3150-RATE-OUTSTAND-BAL.
 13047
 13048     IF NOT PB-NO-MONTHS-SKIPPED
 13049        GO TO 3150-RATE-OUTSTAND-BAL.
 13050
 13051     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13052        GO TO 3150-RATE-OUTSTAND-BAL.
 13053
 13054     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13055        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13056           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13057             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13058           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13059           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13060              MOVE ER-2693     TO WS-ERROR
 13061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13062              GO TO 3150-RATE-OUTSTAND-BAL
 13063           ELSE
 13064              GO TO 3150-RATE-OUTSTAND-BAL.
 13065
 13066 3150-RATE-OUTSTAND-BAL.
 13067
 13068* DMD RATING TEST
 13069     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13070         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13071         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13072         MOVE ER-2687                 TO WS-ERROR
 13073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13074         MOVE 'B'                     TO PB-I-OB-FLAG
 13075         GO TO 3260-EDIT-CONTINUE.
 13076
 13077     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13078         IF  WS-ERROR    EQUAL    ER-2693
 13079             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13080                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13081                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13082                 MOVE  +0            TO  WS-ERROR.
 13083
 13084     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13085         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 238
* EL050.cbl
 13086             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13087                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13088                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13089                 MOVE  +0            TO  WS-ERROR.
 13090
 13091     IF PLAN-MASTER-AH-SW = 'Y'
 13092        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13093            IF  WS-ERROR    EQUAL    ER-2693
 13094              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13095                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13096                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13097                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13098                 MOVE  ER-1910           TO  WS-ERROR
 13099                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13100
 13101     IF PLAN-MASTER-AH-SW = 'Y'
 13102        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13103            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13104               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13105               MOVE  ER-1910           TO  WS-ERROR
 13106               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13107
 13108     IF PLAN-MASTER-AH-SW = 'Y'
 13109        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13110            IF  WS-ERROR    EQUAL    ER-2693
 13111                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13112                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13113                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13114                 MOVE  +0       TO  WS-ERROR.
 13115
 13116     IF WS-ERROR = ER-2693
 13117        IF PB-COMPANY-ID = 'JAL' AND
 13118           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13119           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13120           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13121
 13122     IF WS-ERROR = ER-2693
 13123        IF PB-COMPANY-ID = 'NCL'  AND
 13124           PB-I-AH-BENEFIT-CD = 'OA'
 13125           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13126           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13127
 13128     IF WS-ERROR = ER-2693
 13129        IF PB-COMPANY-ID = 'CNL' AND
 13130           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13131           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13132           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13133
 13134     IF WS-ERROR = ER-2693
 13135        IF PB-COMPANY-ID = 'HER'
 13136           IF WS-LEVEL
 13137              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13138              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13139
 13140     IF ((LF-BENEFIT-FOUND) AND
 13141         (NOT NO-LIFE-COVERAGE)  AND
 13142         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13143       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 239
* EL050.cbl
 13144             (NOT NO-AH-COVERAGE)    AND
 13145             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13146         NEXT SENTENCE
 13147     ELSE
 13148         GO TO 3215-EDIT-RATES.
 13149
 13150     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13151        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13152           MOVE ER-2674          TO WS-ERROR
 13153           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13154           GO TO 3215-EDIT-RATES.
 13155
 13156     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13157        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13158           MOVE ER-2674          TO WS-ERROR
 13159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13160           GO TO 3215-EDIT-RATES.
 13161
 13162     MOVE 'B'                    TO PB-I-OB-FLAG.
 13163
 13164     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13165         NEXT SENTENCE
 13166     ELSE
 13167         IF NOT NO-LIFE-COVERAGE
 13168             IF WS-ACCT-LF-OB-RT = ZERO
 13169                MOVE ER-2641    TO WS-ERROR
 13170                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13171
 13172     IF PB-COMPANY-ID = 'CRI'
 13173       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13174         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13175         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13176         IF WS-ERROR = ER-2675
 13177            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13178            MOVE ER-2687              TO WS-ERROR
 13179            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13180         ELSE
 13181            MOVE ER-2687              TO WS-ERROR
 13182            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13183
 13184
 13185     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13186         NEXT SENTENCE
 13187     ELSE
 13188       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13189            NEXT SENTENCE
 13190       ELSE
 13191         IF NOT NO-AH-COVERAGE
 13192             IF WS-ACCT-AH-OB-RT = ZERO
 13193                MOVE ER-2642    TO WS-ERROR
 13194                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13195
 13196     IF PB-COMPANY-ID = 'CRI'
 13197       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13198         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13199         IF WS-ERROR = ER-2676
 13200            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13201            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 240
* EL050.cbl
 13202            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13203         ELSE
 13204            MOVE ER-2687              TO WS-ERROR
 13205            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13206
 13207     IF PB-COMPANY-ID NOT = 'GIC'
 13208         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13209            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13210     ELSE
 13211         IF PB-I-LF-PREM-CALC = ZEROS
 13212             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13213                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13214
 13215     IF PB-COMPANY-ID NOT = 'GIC'
 13216         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13217            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13218     ELSE
 13219         IF PB-I-AH-PREM-CALC = ZEROS
 13220             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13221                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13222
 13223     MOVE ZEROS TO PB-I-MORT-CODE.
 13224
 13225     GO TO 3260-EDIT-CONTINUE.
 13226
 13227
 13228 3215-EDIT-RATES.
 13229     IF ACCOUNT-MAST-FOUND
 13230         NEXT SENTENCE
 13231     ELSE
 13232         GO TO 3999-END-EDIT.
 13233
 13234 3220-CHECK-LF-RATES.
 13235
 13236     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13237        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13238        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13239        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13240           AND (NOT WS-LF-CASH))
 13241                           OR
 13242           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13243           AND (NOT WS-AH-CASH)))
 13244                       AND
 13245           (PB-I-ENTRY-STATUS NOT = '5')
 13246           MOVE 'M'              TO PB-BATCH-ENTRY
 13247                                    PB-I-ENTRY-STATUS
 13248        END-IF
 13249     END-IF
 13250     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13251                                    PB-I-AH-PREM-CALC
 13252                                    PB-I-LF-ALT-PREM-CALC
 13253                                    PB-I-LF-ALT-RATE
 13254                                    PB-I-LF-REI-RATE
 13255                                    PB-I-LF-ALT-REI-RATE
 13256                                    PB-I-AH-REI-RATE
 13257                                    PB-I-TOT-FEES-CALC.
 13258
 13259     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 241
* EL050.cbl
 13260        NEXT SENTENCE
 13261     ELSE
 13262        MOVE ZEROS               TO PB-I-LF-RATE
 13263                                    PB-I-AH-RATE.
 13264
 13265     IF PB-I-TOT-FEES NOT NUMERIC
 13266        MOVE ZEROS               TO PB-I-TOT-FEES
 13267     END-IF
 13268     IF PB-I-LIVES NOT NUMERIC
 13269         MOVE ZERO               TO PB-I-LIVES.
 13270
 13271     IF PB-I-NUM-BILLED NOT NUMERIC
 13272         MOVE ZERO               TO PB-I-NUM-BILLED.
 13273
 13274     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13275        MOVE +0                  TO PB-I-LF-PREM-TAX
 13276     END-IF
 13277
 13278     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13279        MOVE +0                  TO PB-I-AH-PREM-TAX
 13280     END-IF
 13281
 13282     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13283        PB-I-PAY-FREQUENCY = ZEROS
 13284            MOVE 12 TO CP-PAY-FREQUENCY
 13285     ELSE
 13286            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13287
 13288     IF PB-I-STATE-TAX NOT NUMERIC
 13289         MOVE ZEROS               TO PB-I-STATE-TAX.
 13290
 13291     IF PB-I-MUNI-TAX NOT NUMERIC
 13292         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13293
 13294     MOVE SPACES                 TO CP-BEN-CATEGORY
 13295     IF PB-COMPANY-ID  = 'CSL'  AND
 13296        PB-I-LF-TERM NOT = ZERO
 13297        COMPUTE WS-PAYMENT-AMT =
 13298             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13299        COMPUTE WS-CSL-AMT1 =
 13300             PB-I-LF-TERM * AM-MAX-MON-BEN
 13301        COMPUTE WS-CSL-AMT2 =
 13302             WS-PAYMENT-AMT * PB-I-LF-TERM
 13303        IF CP-PAY-FREQUENCY NOT = 12
 13304           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13305           MOVE '8' TO WS-CSL-CALC-CD
 13306        ELSE
 13307           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13308              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13309               AM-MAX-TOT-BEN
 13310               MOVE '6' TO WS-CSL-CALC-CD
 13311           ELSE
 13312              IF (WS-CSL-AMT1  GREATER THAN
 13313                 AM-MAX-TOT-BEN) AND
 13314                 (WS-CSL-AMT2  GREATER THAN
 13315                 AM-MAX-TOT-BEN)
 13316                 MOVE '7' TO WS-CSL-CALC-CD
 13317              ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 242
* EL050.cbl
 13318                 MOVE '5' TO WS-CSL-CALC-CD.
 13319
 13320     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13321         NEXT SENTENCE
 13322     ELSE
 13323         GO TO 3300-CHECK-AH-RATES.
 13324
 13325*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13326
 13327     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13328        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13329              OR
 13330           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13331           MOVE ER-2618          TO WS-ERROR
 13332           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13333           GO TO 3300-CHECK-AH-RATES.
 13334
 13335     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13336           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13337                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13338
 13339     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13340         MOVE ER-2687             TO WS-ERROR
 13341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13342         MOVE 'Z000'              TO PB-I-MORT-CODE
 13343         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13344         GO TO 3300-CHECK-AH-RATES.
 13345
 13346     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13347        IF PB-I-LIVES = ZERO
 13348           MOVE ER-2688          TO WS-ERROR
 13349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13350
 13351     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13352
 13353     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13354     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13355     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13356     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13357     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13358     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13359     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13360     MOVE '3'                    TO CP-PROCESS-TYPE.
 13361     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13362     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13363
 13364******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13365     IF PB-COMPANY-ID EQUAL 'CDL'
 13366         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13367            CP-EARN-AS-NET-PAY)
 13368             IF PB-CERT-EFF-DT GREATER  WS-931231
 13369                 MOVE '1'        TO CP-EARNING-METHOD.
 13370*******
 13371
 13372     MOVE PB-SV-STATE            TO CP-STATE.
 13373     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13374     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13375     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 243
* EL050.cbl
 13376     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13377     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13378                                    CP-RATING-BENEFIT-AMT.
 13379     IF CP-STATE-STD-ABBRV = 'OR'
 13380         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13381                                         PB-I-LF-ALT-BENEFIT-AMT.
 13382     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13383     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13384     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13385     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13386     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13387     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13388     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13389     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13390     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13391                                    CP-REMAINING-TERM
 13392                                    CP-LOAN-TERM.
 13393
 13394     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13395         NEXT SENTENCE
 13396     ELSE
 13397         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13398             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13399                                           PB-I-LF-PREMIUM-AMT.
 13400
 13401     IF PB-COMPANY-ID EQUAL 'CSL'
 13402        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13403           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13404                                         PB-I-LF-PREMIUM-AMT.
 13405
 13406     IF PB-COMPANY-ID EQUAL 'NCB'
 13407         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13408            CP-EARN-AS-NET-PAY
 13409             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13410                 PB-I-LF-PREMIUM-AMT.
 13411
 13412     IF (CP-TRUNCATED-LIFE)
 13413        or ((pb-company-id = 'AHL')
 13414           and (pb-i-loan-term > pb-i-lf-term))
 13415        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13416
 13417     IF PB-COMPANY-ID EQUAL 'CRI'
 13418        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13419
 13420     IF CP-TERM-IS-DAYS
 13421         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13422     ELSE
 13423         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13424     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13425        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13426        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13427        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13428        IF WS-LF-BEN-CATEGORY = 'D'
 13429           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13430           MOVE PB-I-LIFE-COMMISSION
 13431                                 TO CP-DCC-ACT-COMM
 13432           MOVE WS-LF-BEN-CATEGORY
 13433                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 244
* EL050.cbl
 13434        END-IF
 13435        IF (CP-BENEFIT-CD (1:1) = 'P')
 13436           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13437           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13438           add pb-i-ah-premium-amt to cp-original-premium
 13439        END-IF
 13440     END-IF
 13441     IF PB-COMPANY-ID = 'CSL'
 13442         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13443         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13444         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13445
 13446     IF PB-COMPANY-ID = 'CSL'
 13447        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13448
 13449     IF (CP-SPECIAL-CALC-CD = 'H')
 13450        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13451         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13452                                    TO CP-ALTERNATE-BENEFIT
 13453         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13454     if (pb-company-id = 'CID')
 13455        and (ws-lf-earnings-calc = '4')
 13456        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13457        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13458        move pb-i-term-type      to cp-pmt-mode
 13459        move pb-i-no-of-payments to cp-no-of-pmts
 13460     end-if
 13461     move ws-net-only-state      to cp-net-only-state
 13462     IF (PB-COMPANY-ID = 'CID')
 13463        AND (WS-LF-EARNINGS-CALC = 'B')
 13464        AND (CP-STATE-STD-ABBRV = 'MN')
 13465        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13466                                 TO CP-ALTERNATE-BENEFIT
 13467        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13468     END-IF
 13469     IF (PB-COMPANY-ID = 'CID')
 13470        AND (WS-LF-EARNINGS-CALC = 'B')
 13471        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13472                                 TO CP-ALTERNATE-BENEFIT
 13473        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13474        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13475*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13476*         pb-i-lf-alt-premium-amt
 13477        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13478        IF WS-LF-BEN-CATEGORY = 'P'
 13479           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13480        ELSE
 13481           IF WS-LF-BEN-CATEGORY = 'I'
 13482              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13483           END-IF
 13484        END-IF
 13485     END-IF
 13486     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13487     MOVE 'R'                   TO CP-RATE-FILE.
 13488     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13489
 13490     IF CP-ERROR-RATE-NOT-FOUND
 13491        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 245
* EL050.cbl
 13492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13493        GO TO 3300-CHECK-AH-RATES.
 13494
 13495     IF PB-COMPANY-ID EQUAL 'CRI'
 13496        IF CP-ERROR-NO-LIMITS-CRI
 13497           IF NOT ACCOUNT-LIFE-CHECKED
 13498              MOVE ER-2607      TO WS-ERROR
 13499              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13500
 13501******************************************************************
 13502*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13503*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13504******************************************************************
 13505
 13506* CALC LIFE AGE AT EXPIRATION.
 13507
 13508     COMPUTE WS-AGE-AT-EXPIRE =
 13509          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13510
 13511*    IF PB-STATE = 'CO' OR 'UT'
 13512*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13513*        MOVE 'F'            TO PB-FATAL-FLAG
 13514*        MOVE ER-2709        TO WS-ERROR
 13515*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13516*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13517
 13518*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13519*        MOVE 'X'            TO PB-FATAL-FLAG
 13520*        MOVE ER-2718        TO WS-ERROR
 13521*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13522*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13523
 13524* CALC A & H AGE AT EXPIRATION.
 13525
 13526     COMPUTE WS-AGE-AT-EXPIRE =
 13527          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13528
 13529*    IF PB-STATE = 'CO' OR 'UT'
 13530*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13531*        MOVE 'F'            TO PB-FATAL-FLAG
 13532*        MOVE ER-2709        TO WS-ERROR
 13533*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13535
 13536*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13537*        MOVE 'X'            TO PB-FATAL-FLAG
 13538*        MOVE ER-2718        TO WS-ERROR
 13539*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13540*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13541
 13542     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13543        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13544
 13545     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13546        and (not pb-monthly-cert)
 13547        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13548     end-if
 13549
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 246
* EL050.cbl
 13550     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13551        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13552
 13553     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13554         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13555         MOVE ER-2639        TO WS-ERROR
 13556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13557
 13558
 13559******************************************************************
 13560*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13561******************************************************************
 13562
 13563 PREMIUM-EDITING-IS-BYPASSED.
 13564     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13565        AND (CP-R-MAX-ATT-AGE > +0)
 13566        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13567        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13568           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13569           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13570           MOVE '1'              TO DC-OPTION-CODE
 13571           PERFORM 8500-DATE-CONVERT
 13572                                 THRU 8500-EXIT
 13573           IF NO-CONVERSION-ERROR
 13574              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13575                 MOVE ER-2661       TO WS-ERROR
 13576*                PERFORM 9900-ERROR-FORMAT
 13577*                                THRU 9900-EXIT
 13578              END-IF
 13579           END-IF
 13580        ELSE
 13581           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13582           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13583              MOVE ER-2661       TO WS-ERROR
 13584*             PERFORM 9900-ERROR-FORMAT
 13585*                                THRU 9900-EXIT
 13586           ELSE
 13587              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13588                 MOVE ER-1570    TO WS-ERROR
 13589                 PERFORM 9900-ERROR-FORMAT
 13590                                 THRU 9900-EXIT
 13591              END-IF
 13592           END-IF
 13593        END-IF
 13594        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13595           MOVE PB-I-JOINT-BIRTHDAY
 13596                                 TO DC-BIN-DATE-1
 13597           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13598           MOVE '1'              TO DC-OPTION-CODE
 13599           PERFORM 8500-DATE-CONVERT
 13600                                 THRU 8500-EXIT
 13601           IF NO-CONVERSION-ERROR
 13602              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13603                 MOVE ER-2661       TO WS-ERROR
 13604*                PERFORM 9900-ERROR-FORMAT
 13605*                                THRU 9900-EXIT
 13606              END-IF
 13607           ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 247
* EL050.cbl
 13608              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13609           END-IF
 13610        ELSE
 13611           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13612             (PB-I-LF-TERM / 12)
 13613           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13614              MOVE ER-2661       TO WS-ERROR
 13615*             PERFORM 9900-ERROR-FORMAT
 13616*                                THRU 9900-EXIT
 13617           ELSE
 13618              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13619                 MOVE ER-1571    TO WS-ERROR
 13620                 PERFORM 9900-ERROR-FORMAT
 13621                                 THRU 9900-EXIT
 13622              END-IF
 13623           END-IF
 13624        END-IF
 13625        IF WS-ERROR = ER-2661
 13626           PERFORM 9900-ERROR-FORMAT
 13627                                 THRU 9900-EXIT
 13628        END-IF
 13629     END-IF
 13630*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13631*       MOVE ER-2661             TO WS-ERROR
 13632*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13633
 13634     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13635        MOVE ER-2662             TO WS-ERROR
 13636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13637
 13638     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13639        MOVE ER-2677             TO WS-ERROR
 13640        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13641
 13642     IF CP-ERROR-LOAN-TERM
 13643        MOVE ER-2648             TO WS-ERROR
 13644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13645
 13646 3221-CHECK-ERROR-RATE-OPEN.
 13647
 13648     IF CP-ERROR-RATE-FILE-NOTOPEN
 13649         GO TO 3990-FILES-NOT-OPEN.
 13650
 13651     IF PB-COMPANY-ID NOT = 'DMD'
 13652        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13653     END-IF
 13654     .
 13655 3221-CONTINUE.
 13656     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13657                                    WS-DCC-AH-RATE
 13658     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13659        IF WS-LF-BEN-CATEGORY = 'D'
 13660           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13661              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13662        END-IF
 13663     END-IF
 13664     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13665*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 248
* EL050.cbl
 13666     IF (PB-COMPANY-ID = 'CID')
 13667        AND (WS-LF-EARNINGS-CALC = 'B')
 13668        AND (CP-STATE-STD-ABBRV = 'MN')
 13669        AND (PB-CERT-EFF-DT > X'A4FF')
 13670        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13671     END-IF
 13672     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13673
 13674     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13675     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13676        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13677        AND (PB-I-POLICY-IS-MONTHLY)
 13678        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13679        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13680     END-IF
 13681     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13682     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13683     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13684     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13685     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13686        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13687        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13688        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13689        MOVE ER-2786             TO WS-ERROR
 13690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13691     END-IF
 13692
 13693     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13694
 13695******************************************************************
 13696*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13697******************************************************************
 13698     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13699        and ((not pb-monthly-cert)
 13700        or (ws-lf-ben-category = 'C'))
 13701        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13702
 13703     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13704        GO TO 3225-CHECK-ALT-LIFE-RATE
 13705     ELSE
 13706       IF PB-I-LF-RATE = ZERO
 13707          MOVE ER-2641          TO WS-ERROR
 13708          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13709
 13710 3225-CHECK-ALT-LIFE-RATE.
 13711
 13712     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13713        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13714        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13715         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13716
 13717     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13718         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13719             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13720                   OR
 13721              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13722              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13723              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 249
* EL050.cbl
 13724             MOVE ER-2720        TO  WS-ERROR
 13725             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13726             GO TO 3225-RATING-CONT
 13727         ELSE
 13728             GO TO 3225-RATING-CONT.
 13729     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13730        AND (AM-GPCD = 01 OR 06 OR 15)
 13731        MOVE ER-2798             TO WS-ERROR
 13732        PERFORM 9900-ERROR-FORMAT
 13733                                 THRU 9900-EXIT
 13734*       GO TO 3225-RATING-CONT
 13735     END-IF
 13736     if (pb-company-id = 'CID')
 13737        and (ws-lf-earnings-calc = 'B')
 13738        and (ws-lf-ben-category = 'P' or 'I')
 13739        and (ws-net-only-state = 'Y')
 13740        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13741        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13742        go to 3225-rating-cont
 13743     end-if
 13744     IF (PB-COMPANY-ID = 'CID')
 13745        AND (WS-LF-EARNINGS-CALC = 'B')
 13746        AND (CP-STATE-STD-ABBRV = 'MN')
 13747        AND (PB-CERT-EFF-DT > X'A4FF')
 13748        GO TO 3225-RATING-CONT
 13749     END-IF
 13750     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13751        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13752           AND (PB-I-POLICY-IS-MONTHLY)
 13753           GO TO 3225-RATING-CONT
 13754        END-IF
 13755     END-IF
 13756
 13757     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13758        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13759        CP-EARN-AS-REG-BALLOON
 13760        NEXT SENTENCE
 13761     ELSE
 13762        MOVE '2'                 TO CP-EARNING-METHOD.
 13763
 13764 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13765
 13766     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13767
 13768     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13769        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13770        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13771         NEXT SENTENCE
 13772     ELSE
 13773         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13774
 13775     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13776     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13777     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13778                                     CP-RATING-BENEFIT-AMT.
 13779     IF CP-STATE-STD-ABBRV = 'OR'
 13780         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13781                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 250
* EL050.cbl
 13782     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13783        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13784     END-IF
 13785     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13786     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13787     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13788                                    CP-REMAINING-TERM
 13789                                    CP-LOAN-TERM.
 13790     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13791        ADD +1                   TO CP-ORIGINAL-TERM
 13792                                    CP-REMAINING-TERM
 13793                                    CP-LOAN-TERM.
 13794
 13795     MOVE 'R'                   TO CP-RATE-FILE.
 13796     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13797
 13798     IF CP-ERROR-RATE-NOT-FOUND
 13799         MOVE ER-2641            TO WS-ERROR
 13800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13801         GO TO 3300-CHECK-AH-RATES.
 13802
 13803     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13804     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13805
 13806     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13807         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13808
 13809     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13810                               + PB-I-LF-ALT-BENEFIT-AMT.
 13811
 13812     IF ACCOUNT-LIFE-CHECKED  OR
 13813        PB-POLICY-IS-VOIDED   OR
 13814        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13815        and (not pb-monthly-cert))
 13816        GO TO 3225-CONTINUE.
 13817
 13818     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13819        GO TO 3225-CONTINUE.
 13820
 13821     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13822                             EC-RT-LF-MAX-TOT-BEN
 13823        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13824        MOVE ER-2639       TO WS-ERROR
 13825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13826
 13827 3225-CONTINUE.
 13828     IF PB-I-LF-ALT-RATE = ZERO
 13829         MOVE ER-2659            TO WS-ERROR
 13830         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13831
 13832     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13833        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13834        MOVE ER-2698             TO WS-ERROR
 13835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13836
 13837 3225-RATING-CONT.
 13838
 13839     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 251
* EL050.cbl
 13840        and (not pb-monthly-cert)
 13841         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13842         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13843         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13844            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13845            CONTINUE
 13846         ELSE
 13847            MOVE ER-2687         TO WS-ERROR
 13848            PERFORM 9900-ERROR-FORMAT
 13849                                 THRU 9900-EXIT
 13850         END-IF
 13851         GO TO 3290-EDIT-LF-REIN-RATE
 13852     END-IF
 13853
 13854* DMD RATING TEST
 13855     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13856         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13857         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13858         MOVE ER-2687                 TO WS-ERROR
 13859         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13860         GO TO 3290-EDIT-LF-REIN-RATE.
 13861
 13862 3230-CLIENT-MORT-CD-SPECIALS.
 13863
 13864     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13865     SET BIN-TO-GREG          TO TRUE.
 13866*    MOVE ' '                 TO DC-OPTION-CODE.
 13867     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13868     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13869
 13870 C-POS-3230-MORT-CD.
 13871     IF PB-COMPANY-ID = 'POS' AND
 13872        PB-SV-CARRIER = '2'
 13873         NEXT SENTENCE
 13874     ELSE
 13875         GO TO C-POS-3240-MORT-CD.
 13876
 13877     IF PB-SV-GROUPING = '030'
 13878        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13879         MOVE '2350' TO PB-I-MORT-CODE
 13880      ELSE
 13881         MOVE '3300' TO PB-I-MORT-CODE.
 13882
 13883
 13884 C-POS-3240-MORT-CD.
 13885     IF PB-COMPANY-ID = 'POS' AND
 13886        PB-SV-CARRIER = '1'
 13887         NEXT SENTENCE
 13888     ELSE
 13889         GO TO 3230-CONTINUE.
 13890
 13891     IF PB-SV-STATE = '45' OR '47'
 13892        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13893         MOVE '5200' TO PB-I-MORT-CODE
 13894     ELSE
 13895         MOVE '8300' TO PB-I-MORT-CODE.
 13896
 13897 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 252
* EL050.cbl
 13898
 13899     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13900        GO TO 3240-CONTINUE
 13901     END-IF
 13902
 13903     IF PB-CERT-EFF-DT > WS-971231
 13904        GO TO 3240-CONTINUE
 13905     END-IF
 13906
 13907     IF LF-BENEFIT-FOUND AND
 13908        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13909         MOVE 'F250'       TO PB-I-MORT-CODE
 13910     ELSE
 13911         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13912             MOVE '7250'   TO PB-I-MORT-CODE
 13913         ELSE
 13914             MOVE '4251'   TO PB-I-MORT-CODE
 13915         END-IF
 13916     END-IF
 13917
 13918     .
 13919 3240-CONTINUE.
 13920
 13921     IF PB-COMPANY-ID NOT = 'GNL'
 13922         GO TO 3256-CONTINUE.
 13923
 13924     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13925         MOVE 'A300' TO PB-I-MORT-CODE
 13926     ELSE
 13927         MOVE '8350' TO PB-I-MORT-CODE.
 13928
 13929 3256-CONTINUE.
 13930     IF PB-COMPANY-ID NOT = 'ABL'
 13931         GO TO 3260-EDIT-CONTINUE.
 13932
 13933     IF PB-I-LF-TERM GREATER THAN 59
 13934         MOVE 'F550' TO PB-I-MORT-CODE
 13935     ELSE
 13936         MOVE 'E550' TO PB-I-MORT-CODE.
 13937
 13938 3260-EDIT-CONTINUE.
 13939     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13940
 13941 3290-EDIT-LF-REIN-RATE.
 13942     IF LF-REIN-NSP-NOT-USED
 13943         GO TO 3290-RATING-CONT.
 13944
 13945     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13946        GO TO 3290-RATING-CONT.
 13947     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13948     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13949     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13950     MOVE '3'                   TO CP-PROCESS-TYPE.
 13951     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13952
 13953******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13954     IF PB-COMPANY-ID EQUAL 'CDL'
 13955         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 253
* EL050.cbl
 13956            CP-EARN-AS-NET-PAY)
 13957             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13958*            MOVE SPACE          TO DC-OPTION-CODE
 13959             SET BIN-TO-GREG     TO TRUE
 13960             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13961***  Y2K PROJ 7744
 13962             IF DC-GREG-DATE-CYMD GREATER 19931231
 13963                 MOVE '1'        TO CP-EARNING-METHOD.
 13964***  Y2K PROJ 7744
 13965*******
 13966
 13967     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13968     MOVE PB-SV-STATE           TO CP-STATE.
 13969     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13970     MOVE ZERO                  TO CP-DEVIATION-CODE
 13971                                   CP-RATE-DEV-PCT.
 13972     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13973     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13974                                   CP-RATING-BENEFIT-AMT.
 13975
 13976************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13977     IF PB-COMPANY-ID EQUAL 'NCB'
 13978         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13979            CP-EARN-AS-NET-PAY
 13980             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13981                 PB-I-LF-PREMIUM-AMT.
 13982************
 13983
 13984     IF CP-STATE-STD-ABBRV = 'OR'
 13985         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13986                                         PB-I-LF-ALT-BENEFIT-AMT.
 13987     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13988     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13989     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13990     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13991     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13992     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13993     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13994     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13995                                   CP-REMAINING-TERM
 13996                                   CP-LOAN-TERM.
 13997     IF CP-TRUNCATED-LIFE
 13998        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13999
 14000     IF CP-TERM-IS-DAYS
 14001         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14002     ELSE
 14003         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14004
 14005     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14006        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14007     END-IF
 14008     IF PB-COMPANY-ID NOT = 'TIC'
 14009          MOVE ZERO          TO CP-CLASS-CODE.
 14010
 14011     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14012
 14013     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 254
* EL050.cbl
 14014     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14015
 14016     IF CP-ERROR-RATE-NOT-FOUND
 14017        IF PB-I-OB
 14018           MOVE ER-2625      TO WS-ERROR
 14019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14020           GO TO 3299-EDIT-CONTINUE
 14021        ELSE
 14022           MOVE ER-2643      TO WS-ERROR
 14023           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14024           GO TO 3299-EDIT-CONTINUE.
 14025
 14026     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14027
 14028     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14029     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14030
 14031     IF PB-I-LF-REI-RATE = ZERO
 14032         MOVE ER-2643        TO WS-ERROR
 14033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14034
 14035 3290-CHECK-ALT-REIN-RATE.
 14036
 14037     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14038        GO TO 3290-RATING-CONT.
 14039
 14040     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14041     MOVE '2'                    TO CP-EARNING-METHOD.
 14042     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14043     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14044     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14045     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14046                                     CP-RATING-BENEFIT-AMT.
 14047     IF CP-STATE-STD-ABBRV = 'OR'
 14048         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14049                                         PB-I-LF-ALT-BENEFIT-AMT.
 14050     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14051        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14052     END-IF
 14053     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14054     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14055     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14056                                    CP-REMAINING-TERM
 14057                                    CP-LOAN-TERM.
 14058     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14059        ADD +1                   TO CP-ORIGINAL-TERM
 14060                                    CP-REMAINING-TERM
 14061                                    CP-LOAN-TERM.
 14062
 14063     MOVE 'R'                   TO CP-RATE-FILE.
 14064     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14065
 14066     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14067
 14068     IF PB-I-LF-ALT-REI-RATE = ZERO
 14069         MOVE ER-2643            TO WS-ERROR
 14070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14071
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 255
* EL050.cbl
 14072 3290-RATING-CONT.
 14073
 14074     IF PB-I-OB
 14075*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14076        GO TO 3300-CHECK-AH-RATES.
 14077
 14078 3299-EDIT-CONTINUE.
 14079
 14080     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14081         NEXT SENTENCE
 14082     ELSE
 14083         MOVE ER-2620           TO WS-ERROR
 14084         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14085
 14086 3300-CHECK-AH-RATES.
 14087     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14088         NEXT SENTENCE
 14089     ELSE
 14090         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14091
 14092     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14093        and (not pb-monthly-cert))
 14094                  or
 14095        ((CF-COMPANY-ID = 'DMD') AND
 14096                (NO-DMD-RATING))
 14097         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14098            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14099            CONTINUE
 14100         ELSE
 14101            MOVE ER-2687         TO WS-ERROR
 14102            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14103         END-IF
 14104         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14105         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14106     END-IF
 14107
 14108     IF PB-I-OB
 14109        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14110
 14111     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14112         MOVE ER-2687             TO WS-ERROR
 14113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14114         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14115         GO TO 3999-END-EDIT.
 14116
 14117*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14118     if pb-company-id = 'AHL'
 14119        go to 3300-skip-crit-per
 14120     end-if
 14121     if (pb-i-ah-crit-per not = zeros)
 14122        and (ws-ah-special-calc-cd not = 'C')
 14123        MOVE ER-1572             TO WS-ERROR
 14124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14125        go to 3300-skip-crit-per
 14126     END-IF
 14127     if (pb-company-id = 'DCC' or 'VPP')
 14128        and (am-dcc-product-code not = spaces)
 14129        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 256
* EL050.cbl
 14130     end-if
 14131     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14132        IF PB-I-AH-CRIT-PER = ZERO
 14133           move ws-ah-max-bens   to pb-i-ah-crit-per
 14134*          MOVE ER-2618       TO WS-ERROR
 14135*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14136*          GO TO 3999-END-EDIT
 14137        END-IF
 14138     END-IF
 14139     if (ws-ah-special-calc-cd = 'C')
 14140        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14141        MOVE ER-1576             TO WS-ERROR
 14142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14143     end-if
 14144
 14145     .
 14146 3300-skip-crit-per.
 14147     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14148     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14149     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14150     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14151     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14152     MOVE PB-SV-STATE            TO CP-STATE.
 14153     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14154     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14155     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14156*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14157     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14158     MOVE '3'                    TO CP-PROCESS-TYPE.
 14159     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14160     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14161                                    CP-RATING-BENEFIT-AMT.
 14162     IF PB-COMPANY-ID = 'CID'
 14163               OR
 14164        CP-STATE-STD-ABBRV = 'OR'
 14165         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14166                                         PB-I-AH-TERM.
 14167     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14168        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14169           AND (PB-I-POLICY-IS-MONTHLY)
 14170           MOVE PB-I-LF-BENEFIT-AMT
 14171                                 TO CP-NET-BENEFIT-AMT
 14172           move pb-i-ah-premium-amt to cp-original-premium
 14173           add pb-i-lf-premium-amt to cp-original-premium
 14174        END-IF
 14175     END-IF
 14176     MOVE SPACES                 TO CP-BEN-CATEGORY
 14177     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14178        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14179        EVALUATE TRUE
 14180           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14181              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14182              MOVE PB-I-LF-BENEFIT-AMT
 14183                                 TO CP-RATING-BENEFIT-AMT
 14184              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14185           WHEN WS-AH-BEN-CATEGORY = 'G'
 14186              MOVE PB-I-UNPAID-CASH-PRICE
 14187                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 257
* EL050.cbl
 14188           WHEN WS-AH-BEN-CATEGORY = 'D'
 14189              MOVE WS-AH-PMF-COMM
 14190                                 TO CP-DCC-PMF-COMM
 14191              MOVE PB-I-AH-COMMISSION
 14192                                 TO CP-DCC-ACT-COMM
 14193        END-EVALUATE
 14194     END-IF
 14195     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14196     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14197     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14198     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14199     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14200     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14201     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14202                                    CP-REMAINING-TERM
 14203                                    WS-WORK-TERM.
 14204     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14205
 14206     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14207     SET BIN-TO-GREG             TO TRUE.
 14208*    MOVE ' '                    TO DC-OPTION-CODE.
 14209     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14210     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14211
 14212     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14213     IF NOT VALID-SKIP-CODE
 14214         MOVE ER-2683            TO WS-ERROR
 14215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14216         GO TO 3320-RATE-CONTINUE.
 14217
 14218     IF PB-NO-MONTHS-SKIPPED
 14219         GO TO 3320-RATE-CONTINUE.
 14220
 14221     MOVE SPACE TO NUMBER-OF-MONTHS.
 14222
 14223     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14224         MOVE 'S'                TO SK-MO (6).
 14225     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14226         MOVE 'S'                TO SK-MO (7).
 14227     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14228         MOVE 'S'                TO SK-MO (8).
 14229     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14230         MOVE 'S'                TO SK-MO (9).
 14231     IF PB-I-SKIP-CODE = 'A'
 14232         MOVE 'S'                TO SK-MO (10).
 14233
 14234     MOVE 1                      TO SUB2.
 14235     MOVE PB-I-AH-TERM           TO SUB3.
 14236     MOVE WS-MONTH               TO SUB1.
 14237     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14238     GO TO 3320-RATE-CONTINUE.
 14239
 14240 3310-GET-SKIP-MO.
 14241     IF SUB1 = 13
 14242         MOVE 1                  TO SUB1.
 14243
 14244     IF SK-MO (SUB1) = 'S'
 14245         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 258
* EL050.cbl
 14246
 14247     ADD 1 TO SUB2
 14248              SUB1.
 14249
 14250 3320-RATE-CONTINUE.
 14251
 14252     IF WS-WORK-TERM = ZERO
 14253         MOVE 1                  TO WS-WORK-TERM.
 14254
 14255     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14256                                    CP-LOAN-TERM.
 14257
 14258     IF PB-COMPANY-ID EQUAL 'DMD'
 14259         NEXT SENTENCE
 14260     ELSE
 14261         MOVE ZERO               TO PB-I-AH-RATE
 14262                                    PB-I-AH-REI-RATE.
 14263
 14264
 14265     IF PB-COMPANY-ID EQUAL 'CRI'
 14266        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14267
 14268     IF PB-COMPANY-ID = 'CSL'
 14269         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14270         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14271         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14272         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14273
 14274     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14275        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14276           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14277              PB-I-RATE-DEV-PCT-LF
 14278        END-IF
 14279        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14280                                 TO CP-ALTERNATE-BENEFIT
 14281        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14282        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14283        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14284     END-IF
 14285     IF (PB-COMPANY-ID = 'CID')
 14286        AND (WS-LF-EARNINGS-CALC = 'B')
 14287        AND (CP-STATE-STD-ABBRV = 'MN')
 14288        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14289     ELSE
 14290        MOVE ' '                 TO CP-AH-BALLOON-SW
 14291     END-IF
 14292     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14293     MOVE 'R'                   TO CP-RATE-FILE.
 14294     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14295
 14296     IF (CP-ERROR-RATE-NOT-FOUND)
 14297        and (not pb-monthly-cert)
 14298        IF PB-I-OB
 14299           MOVE ER-2624          TO WS-ERROR
 14300           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14301           GO TO 3340-CALCULATE-PREMIUM-AMT
 14302        ELSE
 14303          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 259
* EL050.cbl
 14304              NEXT SENTENCE
 14305          ELSE
 14306           MOVE ER-2642          TO WS-ERROR
 14307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14308           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14309
 14310     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14311        CP-ERROR-DIV-BY-ZERO
 14312           MOVE ER-3782          TO WS-ERROR
 14313           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14314
 14315     IF PB-COMPANY-ID EQUAL 'CRI'
 14316        IF CP-ERROR-NO-LIMITS-CRI
 14317           IF NOT ACCOUNT-AH-CHECKED
 14318              MOVE ER-2607          TO WS-ERROR
 14319              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14320
 14321     IF ACCOUNT-AH-CHECKED
 14322        NEXT SENTENCE
 14323     ELSE
 14324       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14325          MOVE ER-2640           TO WS-ERROR
 14326          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14327
 14328     IF PB-COMPANY-ID = 'CRI'
 14329         IF WS-ERROR = ER-2640
 14330             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14331     IF ACCOUNT-AH-CHECKED
 14332        CONTINUE
 14333     ELSE
 14334        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14335           AND (CP-R-MAX-ATT-AGE > +0)
 14336           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14337           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14338              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14339              MOVE PB-I-AH-EXPIRE-DT
 14340                                 TO DC-BIN-DATE-2
 14341              MOVE '1'           TO DC-OPTION-CODE
 14342              PERFORM 8500-DATE-CONVERT
 14343                                 THRU 8500-EXIT
 14344              IF NO-CONVERSION-ERROR
 14345                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14346                    MOVE ER-2661       TO WS-ERROR
 14347*                   PERFORM 9900-ERROR-FORMAT
 14348*                                THRU 9900-EXIT
 14349                 END-IF
 14350              END-IF
 14351           ELSE
 14352              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14353              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14354                 MOVE ER-2661    TO WS-ERROR
 14355*                PERFORM 9900-ERROR-FORMAT
 14356*                                THRU 9900-EXIT
 14357              ELSE
 14358                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14359                    MOVE ER-1570 TO WS-ERROR
 14360                    PERFORM 9900-ERROR-FORMAT
 14361                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 260
* EL050.cbl
 14362                 END-IF
 14363              END-IF
 14364           END-IF
 14365           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14366              MOVE PB-I-JOINT-BIRTHDAY
 14367                                    TO DC-BIN-DATE-1
 14368              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14369              MOVE '1'              TO DC-OPTION-CODE
 14370              PERFORM 8500-DATE-CONVERT
 14371                                    THRU 8500-EXIT
 14372              IF NO-CONVERSION-ERROR
 14373                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14374                    MOVE ER-2661       TO WS-ERROR
 14375*                   PERFORM 9900-ERROR-FORMAT
 14376*                                   THRU 9900-EXIT
 14377                 END-IF
 14378              END-IF
 14379           ELSE
 14380              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14381                (PB-I-AH-TERM / 12)
 14382              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14383                 MOVE ER-2661       TO WS-ERROR
 14384*                PERFORM 9900-ERROR-FORMAT
 14385*                                   THRU 9900-EXIT
 14386              ELSE
 14387                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14388                    MOVE ER-1571 TO WS-ERROR
 14389                    PERFORM 9900-ERROR-FORMAT
 14390                                 THRU 9900-EXIT
 14391                 END-IF
 14392              END-IF
 14393           END-IF
 14394           IF WS-ERROR = ER-2661
 14395              PERFORM 9900-ERROR-FORMAT
 14396                                    THRU 9900-EXIT
 14397           END-IF
 14398        END-IF
 14399     END-IF
 14400*    IF ACCOUNT-AH-CHECKED
 14401*       NEXT SENTENCE
 14402*    ELSE
 14403*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14404*          MOVE ER-2661          TO WS-ERROR
 14405*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14406
 14407     IF ACCOUNT-AH-CHECKED
 14408        NEXT SENTENCE
 14409     ELSE
 14410        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14411           MOVE ER-2663          TO WS-ERROR
 14412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14413
 14414     IF ACCOUNT-AH-CHECKED OR
 14415        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14416         PB-POLICY-IS-VOIDED
 14417        NEXT SENTENCE
 14418     ELSE
 14419        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 261
* EL050.cbl
 14420           MOVE ER-2667            TO WS-ERROR
 14421           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14422
 14423     IF PB-COMPANY-ID = 'CRI'
 14424         IF WS-ERROR = ER-2667
 14425             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14426
 14427     IF ACCOUNT-AH-CHECKED
 14428        NEXT SENTENCE
 14429     ELSE
 14430        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14431           MOVE ER-2678            TO WS-ERROR
 14432           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14433
 14434     IF CP-ERROR-RATE-FILE-NOTOPEN
 14435         GO TO 3990-FILES-NOT-OPEN.
 14436
 14437 3321-CONTINUE.
 14438     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14439     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14440     IF (PB-COMPANY-ID = 'DCC')
 14441        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14442        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14443                                    PB-I-LF-ALT-PREM-CALC
 14444        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14445        IF WS-AH-BEN-CATEGORY = 'G'
 14446           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14447           + PB-I-ADDL-CLP)
 14448           * (1 + WS-TOL-CLP-PCT)
 14449*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14450        ELSE
 14451           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14452           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14453*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14454        END-IF
 14455        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14456                                 TO PB-I-AH-PREM-CALC
 14457        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14458           MOVE ER-8152          TO WS-ERROR
 14459           PERFORM 9900-ERROR-FORMAT
 14460                                 THRU 9900-EXIT
 14461        ELSE
 14462           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14463                 PB-I-ADDL-CLP)
 14464              MOVE ER-8148       TO WS-ERROR
 14465              PERFORM 9900-ERROR-FORMAT
 14466                                 THRU 9900-EXIT
 14467           END-IF
 14468        END-IF
 14469     END-IF
 14470     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14471        AND (PB-I-POLICY-IS-MONTHLY)
 14472        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14473        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14474        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14475           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14476        END-IF
 14477     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 262
* EL050.cbl
 14478     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14479        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14480        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14481        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14482        MOVE ER-2786             TO WS-ERROR
 14483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14484     END-IF
 14485     MOVE +0                     TO PB-I-AH-CLP
 14486     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14487        evaluate true
 14488           when WS-AH-BEN-CATEGORY = 'D'
 14489              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14490                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14491           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14492              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14493           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14494              compute ws-cred-union-fees rounded =
 14495                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14496                    pb-i-ah-commission)
 14497              COMPUTE PB-I-AH-CLP =
 14498                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14499        end-evaluate
 14500     END-IF
 14501     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14502
 14503     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14504         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14505
 14506     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14507         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14508
 14509     if (ws-ah-special-calc-cd = 'E')
 14510        and (pb-monthly-cert)
 14511        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14512     end-if
 14513     IF PB-COMPANY-ID = 'CRI'
 14514         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14515            PB-I-PAYMENT-AMOUNT = ZERO
 14516             NEXT SENTENCE
 14517         ELSE
 14518             COMPUTE PB-I-AH-PREM-CALC =
 14519                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14520                 (CP-PREMIUM-RATE / 100)
 14521             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14522                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14523                                             PB-I-RATE-DEV-PCT-AH.
 14524
 14525     IF (PB-I-AH-RATE  = ZERO)
 14526        and (not pb-monthly-cert)
 14527       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14528           NEXT SENTENCE
 14529       ELSE
 14530         MOVE ER-2642            TO WS-ERROR
 14531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14532
 14533     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14534     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14535     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 263
* EL050.cbl
 14536     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14537     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14538     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14539
 14540     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14541        AND (WS-AH-BEN-CATEGORY = 'G')
 14542        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14543        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14544        IF CP-DEVIATION-CODE NOT = '000'
 14545           MOVE '000'            TO CP-DEVIATION-CODE
 14546           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14547           IF NO-CP-ERROR
 14548              COMPUTE PB-I-DDF-IU-RATE-UP =
 14549              PB-I-AH-CLP - CP-CALC-PREMIUM
 14550           ELSE
 14551              MOVE ER-3057        TO WS-ERROR
 14552              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14553           END-IF
 14554        END-IF
 14555     END-IF
 14556     .
 14557 3335-EDIT-AH-REIN-NSP-RATE.
 14558     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14559        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14560              compute ws-cred-union-fees rounded =
 14561                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14562                    pb-i-ah-commission)
 14563              COMPUTE PB-I-AH-CLP =
 14564                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14565        end-if
 14566     END-IF
 14567     IF AH-REIN-NSP-NOT-USED
 14568         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14569
 14570     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14571     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14572         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14573     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14574     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14575     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14576     MOVE PB-SV-STATE            TO CP-STATE.
 14577     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14578     MOVE ZERO                   TO CP-DEVIATION-CODE
 14579                                    CP-RATE-DEV-PCT.
 14580*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14581     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14582     MOVE '3'                    TO CP-PROCESS-TYPE.
 14583     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14584     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14585                                    CP-RATING-BENEFIT-AMT.
 14586     IF CP-STATE-STD-ABBRV = 'OR'
 14587         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14588                                         PB-I-AH-TERM.
 14589     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14590     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14591     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14592     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14593     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 264
* EL050.cbl
 14594     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14595                                    CP-REMAINING-TERM
 14596                                    WS-WORK-TERM.
 14597     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14598     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14599        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14600     END-IF
 14601     IF  PB-COMPANY-ID = 'TIC'
 14602         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14603            MOVE ZERO TO CP-CLASS-CODE.
 14604
 14605     IF PB-COMPANY-ID NOT = 'TIC'
 14606          MOVE ZERO          TO CP-CLASS-CODE.
 14607
 14608     MOVE ZERO               TO CP-DEVIATION-CODE.
 14609
 14610     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14611
 14612     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14613
 14614     MOVE 'R'                   TO CP-RATE-FILE.
 14615     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14616
 14617     IF CP-ERROR-RATE-NOT-FOUND
 14618         MOVE ER-2645        TO WS-ERROR
 14619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14620         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14621
 14622     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14623
 14624     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14625     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14626
 14627     IF PB-I-AH-REI-RATE = ZERO
 14628         MOVE ER-2645        TO WS-ERROR
 14629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14630
 14631
 14632 3340-CALCULATE-PREMIUM-AMT.
 14633
 14634     IF PB-COMPANY-ID = 'NCL'
 14635         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14636             WS-AH-SPECIAL-CALC-CD = 'O')
 14637             GO TO 3999-END-EDIT.
 14638
 14639     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14640                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14641                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14642                         OR 'AHL'
 14643         NEXT SENTENCE
 14644     ELSE
 14645         IF WS-STATE-ABBREVIATION = 'CT'
 14646             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14647                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14648                 COMPUTE PB-I-LF-PREM-CALC =
 14649                                     PB-I-LF-PREM-CALC * .90
 14650                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14651                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 265
* EL050.cbl
 14652                 COMPUTE PB-I-AH-PREM-CALC =
 14653                                     PB-I-AH-PREM-CALC * .90.
 14654
 14655     IF PB-COMP-LF-PREM
 14656        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14657        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14658
 14659     IF PB-COMP-AH-PREM
 14660        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14661
 14662 3340-CHECK-DCC-TOT-FEES.
 14663     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14664        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14665        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14666        AND (PB-I-POLICY-IS-MONTHLY)
 14667        CONTINUE
 14668     ELSE
 14669        GO TO 3340-EDIT-LF-AH-TOL
 14670     END-IF
 14671     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14672     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14673     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14674        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14675           PB-I-RATE-DEV-PCT-LF
 14676     END-IF
 14677     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14678        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14679           PB-I-RATE-DEV-PCT-AH
 14680     END-IF
 14681     MOVE 'N'                    TO CP-BEN-CATEGORY
 14682     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14683
 14684     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14685     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14686     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14687     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14688     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14689     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14690     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14691     MOVE '3'                    TO CP-PROCESS-TYPE.
 14692     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14693     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14694
 14695     MOVE PB-SV-STATE            TO CP-STATE.
 14696     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14697     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14698     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14699     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14700     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14701                                    CP-RATING-BENEFIT-AMT.
 14702     IF CP-STATE-STD-ABBRV = 'OR'
 14703         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14704                                         PB-I-LF-ALT-BENEFIT-AMT.
 14705     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14706     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14707     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14708     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14709     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 266
* EL050.cbl
 14710     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14711     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14712     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14713     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14714                                    CP-REMAINING-TERM
 14715                                    CP-LOAN-TERM.
 14716     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14717        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14718           PB-I-LF-PREMIUM-AMT
 14719     end-if
 14720
 14721     IF CP-TRUNCATED-LIFE
 14722        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14723
 14724     IF CP-TERM-IS-DAYS
 14725         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14726     ELSE
 14727         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14728
 14729     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14730     IF CP-SPECIAL-CALC-CD = 'H'
 14731         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14732                                    TO CP-ALTERNATE-BENEFIT
 14733         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14734     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14735     MOVE 'R'                    TO CP-RATE-FILE
 14736     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14737     IF NOT CP-ERROR-RATE-NOT-FOUND
 14738        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14739        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14740           AND (CP-BENEFIT-CD (1:1) = 'S')
 14741           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14742                                    PB-I-LF-PREMIUM-AMT
 14743        END-IF
 14744     ELSE
 14745        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14746     END-IF
 14747     .
 14748 3340-EDIT-LF-AH-TOL.
 14749
 14750***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14751***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14752***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14753***
 14754     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14755         PB-I-AH-PREMIUM-AMT
 14756          GIVING WS-CALC-WORK.
 14757
 14758     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14759        AND WS-CALC-WORK NOT = ZERO
 14760         MOVE ER-2649            TO WS-ERROR
 14761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14762
 14763     SUBTRACT PB-I-LF-PREM-CALC
 14764             FROM PB-I-LF-PREMIUM-AMT
 14765                 GIVING WS-UNSIGN-WRK1.
 14766
 14767     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 267
* EL050.cbl
 14768             FROM PB-I-LF-ALT-PREMIUM-AMT
 14769                 GIVING WS-UNSIGN-WRK4.
 14770
 14771     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14772                                + WS-UNSIGN-WRK4.
 14773
 14774     SUBTRACT PB-I-AH-PREM-CALC
 14775             FROM PB-I-AH-PREMIUM-AMT
 14776                 GIVING WS-UNSIGN-WRK2.
 14777
 14778******************************************************************
 14779*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14780******************************************************************
 14781
 14782     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14783         MOVE ZERO TO WS-UNSIGN-WRK1.
 14784
 14785     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14786         MOVE ZERO TO WS-UNSIGN-WRK2.
 14787
 14788     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14789             GIVING WS-UNSIGN-WRK3.
 14790
 14791 3342-CONTINUE.
 14792
 14793     IF (PB-I-LF-RATE = ZERO  AND
 14794         PB-I-AH-RATE = ZERO)
 14795         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14796            WS-AH-SPECIAL-CALC-CD = 'O'
 14797              NEXT SENTENCE
 14798         ELSE
 14799             GO TO 3345-EDIT-CONTINUE.
 14800
 14801     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14802         NEXT SENTENCE
 14803     ELSE
 14804     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14805        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14806           IF (PB-REISSUED-CERT         OR
 14807               PB-POLICY-IS-DECLINED    OR
 14808               PB-POLICY-IS-VOIDED)
 14809              NEXT SENTENCE
 14810           ELSE
 14811              IF WS-PREM-REJECT-SW = SPACE
 14812                 MOVE ER-2652    TO WS-ERROR
 14813                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14814                 GO TO 3344-CHECK-AH
 14815              ELSE
 14816                 MOVE ER-2650    TO WS-ERROR
 14817                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14818                 GO TO 3344-CHECK-AH.
 14819
 14820***
 14821***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14822***
 14823
 14824     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14825         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 268
* EL050.cbl
 14826            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14827             (1 + WS-TOL-LF-PREM-PCT)
 14828         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14829            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14830             (1 - WS-TOL-LF-PREM-PCT)
 14831     ELSE
 14832         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14833         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14834
 14835***
 14836***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14837***
 14838
 14839     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14840         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14841          WS-TOL-LF-PREM.
 14842
 14843     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14844         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14845          WS-TOL-LF-PREM.
 14846
 14847     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14848        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14849
 14850     IF PB-REISSUED-CERT
 14851        or PB-POLICY-IS-DECLINED
 14852        or PB-POLICY-IS-VOIDED
 14853        continue
 14854     ELSE
 14855        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14856              > WS-TOL-LF-HIGH-PREM-AMT)
 14857           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14858              < WS-TOL-LF-LOW-PREM-AMT))
 14859                      or
 14860           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14861              > WS-TOL-LF-HIGH-PREM-PCT)
 14862           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14863              < WS-TOL-LF-LOW-PREM-PCT))
 14864           IF WS-PREM-REJECT-SW = SPACE
 14865              MOVE ER-2652       TO WS-ERROR
 14866              PERFORM 9900-ERROR-FORMAT
 14867                                 THRU 9900-EXIT
 14868           ELSE
 14869              MOVE ER-2650       TO WS-ERROR
 14870              PERFORM 9900-ERROR-FORMAT
 14871                                 THRU 9900-EXIT
 14872           end-if
 14873        end-if
 14874     end-if
 14875
 14876*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14877*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14878*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14879*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14880
 14881     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14882        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14883                      OR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 269
* EL050.cbl
 14884           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14885           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14886           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14887           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14888        END-IF
 14889     END-IF
 14890
 14891     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14892        IF WS-COMP-MAX-CAP GREATER THAN +0
 14893           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14894              IF (PB-REISSUED-CERT         OR
 14895                  PB-POLICY-IS-DECLINED    OR
 14896                  PB-POLICY-IS-VOIDED)
 14897                 NEXT SENTENCE
 14898              ELSE
 14899                  MOVE ER-2646   TO  WS-ERROR
 14900                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14901
 14902 3344-CVL-TOLERANCE-CHECK.
 14903
 14904      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14905          GO TO 3344-CHECK-AH.
 14906
 14907      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14908          GO TO 3344-CHECK-AH.
 14909
 14910      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14911                                     WS-UNSIGN-WRK6.
 14912
 14913      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14914          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14915                                 + PB-I-LF-PREMIUM-AMT
 14916                                 - PB-I-LF-PREM-CALC.
 14917
 14918      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14919          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14920                                 + PB-I-LF-ALT-PREMIUM-AMT
 14921                                 - PB-I-LF-ALT-PREM-CALC.
 14922
 14923      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14924          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14925              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14926                 MOVE ER-2652    TO  WS-ERROR
 14927                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14928              ELSE
 14929                 MOVE ER-2650    TO  WS-ERROR
 14930                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14931
 14932      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14933          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14934              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14935                 MOVE ER-2652    TO  WS-ERROR
 14936                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14937              ELSE
 14938                 MOVE ER-2650    TO  WS-ERROR
 14939                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14940
 14941 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 270
* EL050.cbl
 14942
 14943****************************************************************
 14944***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14945***
 14946
 14947     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14948         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14949             (1 + WS-TOL-AH-PREM-PCT)
 14950         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14951             (1 - WS-TOL-AH-PREM-PCT)
 14952     ELSE
 14953         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14954         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14955
 14956***
 14957***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14958***
 14959
 14960     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14961         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14962
 14963     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14964         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14965
 14966     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14967        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14968
 14969     IF (PB-REISSUED-CERT)
 14970        OR (PB-POLICY-IS-DECLINED)
 14971        OR (PB-POLICY-IS-VOIDED)
 14972        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14973        CONTINUE
 14974     ELSE
 14975        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14976              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14977                          or
 14978           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14979              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14980           IF WS-PREM-REJECT-SW = SPACE
 14981              MOVE ER-3052       TO WS-ERROR
 14982              PERFORM 9900-ERROR-FORMAT
 14983                                 THRU 9900-EXIT
 14984           ELSE
 14985              MOVE ER-3050       TO WS-ERROR
 14986              PERFORM 9900-ERROR-FORMAT
 14987                                 THRU 9900-EXIT
 14988           END-IF
 14989        END-IF
 14990     END-IF
 14991     if (pb-company-id = 'DCC' or 'VPP')
 14992        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14993        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14994        and (pb-i-policy-is-monthly)
 14995        compute ws-tol-ah-high-prem-amt =
 14996           pb-i-tot-fees-calc + ws-tol-ah-prem
 14997        compute ws-tol-ah-low-prem-amt =
 14998           pb-i-tot-fees-calc - ws-tol-ah-prem
 14999        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 271
* EL050.cbl
 15000           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15001              (1 + ws-tol-ah-prem-pct)
 15002           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15003              (1 - ws-tol-ah-prem-pct)
 15004        else
 15005           move +9999999.99      to ws-tol-ah-high-prem-pct
 15006           move +0               to ws-tol-ah-low-prem-pct
 15007        end-if
 15008        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15009            or
 15010           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15011                          or
 15012           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15013           or
 15014           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15015            move er-3049         to ws-error
 15016           perform 9900-error-format
 15017                                 thru 9900-exit
 15018
 15019        end-if
 15020     end-if
 15021     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15022         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15023             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15024             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15025
 15026     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15027        IF WS-COMP-MAX-CAP GREATER THAN +0
 15028           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15029              IF (PB-REISSUED-CERT         OR
 15030                  PB-POLICY-IS-DECLINED    OR
 15031                  PB-POLICY-IS-VOIDED)
 15032                 NEXT SENTENCE
 15033              ELSE
 15034                  MOVE ER-2646   TO  WS-ERROR
 15035                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15036
 15037     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15038        (WS-COMP-MAX-CAP EQUAL +0)
 15039           GO TO 3345-EDIT-CONTINUE.
 15040
 15041     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15042        GREATER THAN WS-COMP-MAX-CAP
 15043           MOVE ER-2646          TO  WS-ERROR
 15044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15045
 15046 3345-EDIT-CONTINUE.
 15047
 15048*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15049*       IF PB-ENTRY-BATCH   NUMERIC
 15050*          IF PB-ISSUE
 15051*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15052*          ELSE
 15053*              IF PB-CANCELLATION
 15054*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15055
 15056*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15057*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 272
* EL050.cbl
 15058*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15059*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15060*        ELSE
 15061*            MOVE  ER-1909            TO  WS-ERROR
 15062*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15063
 15064     IF PB-I-POLICY-ACCEPTED
 15065        IF PB-POLICY-IS-DECLINED  OR
 15066           PB-REISSUED-CERT  OR
 15067           PB-REIN-ONLY-CERT  OR
 15068           PB-POLICY-IS-VOIDED
 15069            MOVE  ER-1891         TO  WS-ERROR
 15070            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15071        ELSE
 15072            MOVE SPACE            TO  PB-BATCH-ENTRY
 15073            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15074
 15075     IF PB-I-POLICY-DECLINED
 15076        IF PB-REISSUED-CERT  OR
 15077           PB-REIN-ONLY-CERT  OR
 15078           PB-POLICY-IS-VOIDED
 15079            MOVE  ER-1906         TO  WS-ERROR
 15080            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15081        ELSE
 15082            MOVE  'D'             TO  PB-BATCH-ENTRY
 15083                                      PB-I-ENTRY-STATUS.
 15084
 15085     IF PB-I-NEEDS-UNDERWRITING
 15086        IF PB-POLICY-IS-DECLINED OR
 15087           PB-REISSUED-CERT  OR
 15088           PB-REIN-ONLY-CERT  OR
 15089           PB-POLICY-IS-VOIDED
 15090            MOVE  ER-1907         TO  WS-ERROR
 15091            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15092        ELSE
 15093            MOVE 'U'              TO  PB-BATCH-ENTRY
 15094                                      PB-I-ENTRY-STATUS.
 15095
 15096     IF PB-NEEDS-UNDERWRITING
 15097        MOVE  ER-1901             TO  WS-ERROR
 15098        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15099     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15100        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15101        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15102        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15103           AND (NOT WS-LF-CASH))
 15104                           OR
 15105           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15106           AND (NOT WS-AH-CASH)))
 15107                       AND
 15108           (PB-I-ENTRY-STATUS NOT = '5')
 15109           MOVE 'M'              TO PB-BATCH-ENTRY
 15110                                    PB-I-ENTRY-STATUS
 15111        END-IF
 15112     END-IF
 15113     move pending-business       to ws-passed-erpndb
 15114     move ' '                    to ws-exceed-limit-yn
 15115     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 273
* EL050.cbl
 15116     display ' el050 exceed ' ws-exceed-limit-yn
 15117     if ws-exceed-limit-yn = 'Y'
 15118        MOVE  ER-9813            TO WS-ERROR
 15119        PERFORM  9900-ERROR-FORMAT
 15120                                 THRU 9900-EXIT
 15121     end-if
 15122     IF  PB-COMPANY-ID NOT = 'NCL'
 15123         GO TO 3999-END-EDIT.
 15124
 15125     IF PB-REISSUED-CERT  OR
 15126        PB-POLICY-IS-DECLINED  OR
 15127        PB-POLICY-IS-VOIDED  OR
 15128        PB-I-OB
 15129         GO TO 3999-END-EDIT.
 15130
 15131     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15132         MOVE  ER-2644            TO  WS-ERROR
 15133         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15134         GO TO 3999-END-EDIT.
 15135
 15136     MOVE 'N'                     TO  FORM-MASTER-SW.
 15137     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15138
 15139     IF NOT FORM-MASTER-FOUND
 15140         GO TO 3999-END-EDIT.
 15141
 15142     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15143                                      FORM-MASTER-AH-SW.
 15144
 15145     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15146         MOVE  +1                 TO SUB6
 15147         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15148
 15149     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15150         MOVE  +1                 TO SUB6
 15151         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15152
 15153     IF LF-FORM-MASTER-FOUND  OR
 15154        AH-FORM-MASTER-FOUND
 15155         GO TO 3360-CHECK-FORM-LIMITS
 15156     ELSE
 15157         GO TO 3999-END-EDIT.
 15158
 15159******************************************************************
 15160*                  3350-GET-ERFORM                               *
 15161*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15162*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15163******************************************************************
 15164
 15165 3350-GET-ERFORM.
 15166
 15167     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15168         GO TO  3350-ERFORM-GETMAIN.
 15169
 15170     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15171     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15172     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15173     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 274
* EL050.cbl
 15174
 15175     IF PB-CANCELLATION
 15176         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15177            PB-SV-STATE          EQUAL   FO-STATE       AND
 15178            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15179              GO TO 3350-EXIT
 15180         ELSE
 15181             NEXT SENTENCE
 15182     ELSE
 15183         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15184            PB-SV-STATE          EQUAL   FO-STATE       AND
 15185            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15186              GO TO 3350-EXIT.
 15187
 15188 3350-ERFORM-GETMAIN.
 15189
 15190     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15191     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15192
 15193 3350-ERFORM-READ.
 15194
 15195     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15196     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15197     IF PB-CANCELLATION
 15198         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15199     ELSE
 15200         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15201     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15202
 15203     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15204
 15205     IF FORM-MASTER-FOUND
 15206       IF PB-CANCELLATION
 15207          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15208             PB-SV-STATE          EQUAL   FO-STATE       AND
 15209             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15210              GO  TO 3350-EXIT
 15211          ELSE
 15212              NEXT SENTENCE
 15213       ELSE
 15214          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15215             PB-SV-STATE          EQUAL   FO-STATE       AND
 15216             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15217              GO  TO 3350-EXIT.
 15218
 15219     MOVE  'N'                    TO  FORM-MASTER-SW.
 15220     MOVE  ER-1895                TO  WS-ERROR.
 15221     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15222
 15223 3350-EXIT.
 15224      EXIT.
 15225
 15226******************************************************************
 15227*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15228*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15229*   VALID FOR THE POLICY FORM USED.                              *
 15230******************************************************************
 15231
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 275
* EL050.cbl
 15232 3355-EDIT-FORM-LF-BENEFITS.
 15233
 15234     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15235        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15236         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15237         GO TO   3355-EXIT.
 15238
 15239     IF  SUB6    LESS THAN   +40
 15240         ADD  +1      TO  SUB6
 15241         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15242
 15243     MOVE  ER-1896         TO  WS-ERROR.
 15244     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15245
 15246 3355-EXIT.
 15247      EXIT.
 15248
 15249******************************************************************
 15250*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15251*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15252*   VALID FOR THE POLICY FORM USED.                              *
 15253******************************************************************
 15254
 15255 3356-EDIT-FORM-AH-BENEFITS.
 15256
 15257     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15258        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15259         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15260         GO TO  3356-EXIT.
 15261
 15262      IF  SUB6    LESS THAN     +40
 15263          ADD  +1      TO  SUB6
 15264          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15265
 15266     MOVE  ER-1897         TO  WS-ERROR.
 15267     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15268
 15269 3356-EXIT.
 15270      EXIT.
 15271
 15272******************************************************************
 15273*                  3357-BENEFIT-SEARCH                           *
 15274*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15275*   CANCELLATIONS ONLY.                                          *
 15276******************************************************************
 15277 3357-BENEFIT-SEARCH.
 15278     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15279         MOVE +1                          TO SUB6
 15280         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15281
 15282     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15283         MOVE +1                          TO SUB6
 15284         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15285
 15286 3357-EXIT.
 15287     EXIT.
 15288
 15289******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 276
* EL050.cbl
 15290*                  3358-BENEFIT-LIFE-SEARCH                      *
 15291*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15292*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15293*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15294******************************************************************
 15295 3358-BENEFIT-LIFE-SEARCH.
 15296     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15297       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15298         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15299           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15300              IF FO-PLAN-REFUND-METHOD (SUB6)
 15301                     IS GREATER THAN SPACES
 15302                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15303                                          WS-LF-REFUND-CALC
 15304                 GO TO 3358-EXIT.
 15305
 15306     IF SUB6 LESS THAN +40
 15307         ADD +1                 TO SUB6
 15308         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15309
 15310 3358-EXIT.
 15311     EXIT.
 15312******************************************************************
 15313*                  3359-BENEFIT-AH-SEARCH                        *
 15314*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15315*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15316*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15317******************************************************************
 15318 3359-BENEFIT-AH-SEARCH.
 15319     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15320       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15321         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15322           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15323              IF FO-PLAN-REFUND-METHOD (SUB6)
 15324                      IS GREATER THAN SPACES
 15325                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15326                                          WS-AH-REFUND-CALC
 15327                 GO TO 3359-EXIT.
 15328
 15329     IF SUB6 LESS THAN +40
 15330         ADD +1                 TO SUB6
 15331         GO TO 3359-BENEFIT-AH-SEARCH.
 15332
 15333 3359-EXIT.
 15334     EXIT.
 15335
 15336******************************************************************
 15337*                  3360-CHECK-FORM-LIMITS                        *
 15338*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15339*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15340******************************************************************
 15341
 15342 3360-CHECK-FORM-LIMITS.
 15343
 15344     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15345         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15346
 15347     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 277
* EL050.cbl
 15348         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15349
 15350 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15351
 15352     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15353       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15354        WS-LF-JOINT-INDICATOR = 'J'  AND
 15355        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15356         IF PB-COMPANY-ID = 'NCL'
 15357            MOVE  ER-1911          TO  WS-ERROR
 15358            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15359         ELSE
 15360            MOVE  ER-1892          TO  WS-ERROR
 15361            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15362
 15363 3360-CHECK-FORM-LF-ATT-AGE.
 15364
 15365     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15366
 15367     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15368         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15369         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15370            IF PB-COMPANY-ID = 'NCL'
 15371                MOVE  ER-1913      TO  WS-ERROR
 15372                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15373            ELSE
 15374                MOVE  ER-1894      TO  WS-ERROR
 15375                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15376
 15377 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15378
 15379     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15380         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15381         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15382            IF PB-COMPANY-ID = 'NCL'
 15383                MOVE  ER-1914      TO  WS-ERROR
 15384                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15385            ELSE
 15386                MOVE  ER-1899      TO  WS-ERROR
 15387                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15388
 15389 3360-CHECK-FORM-LF-TERM-BAMT.
 15390
 15391     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15392         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15393         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15394           IF  PB-COMPANY-ID = 'NCL'
 15395               MOVE  ER-1916       TO  WS-ERROR
 15396               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15397           ELSE
 15398               MOVE  ER-1902       TO  WS-ERROR
 15399               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15400
 15401     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15402                                    PB-I-LF-ALT-BENEFIT-AMT.
 15403
 15404     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15405         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 278
* EL050.cbl
 15406         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15407             IF  PB-COMPANY-ID = 'NCL'
 15408                 MOVE  ER-1918     TO  WS-ERROR
 15409                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15410             ELSE
 15411                 MOVE  ER-1904     TO  WS-ERROR
 15412                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15413
 15414******************************************************************
 15415*                  3360-CHECK-FORM-AH-LIMITS                     *
 15416*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15417*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15418******************************************************************
 15419
 15420 3360-CHECK-FORM-AH-LIMITS.
 15421
 15422     IF NOT AH-FORM-MASTER-FOUND
 15423         GO TO 3999-END-EDIT.
 15424
 15425 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15426
 15427     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15428       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15429        WS-AH-JOINT-INDICATOR = 'J'  AND
 15430        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15431         IF PB-COMPANY-ID = 'NCL'
 15432            MOVE  ER-1912          TO  WS-ERROR
 15433            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15434         ELSE
 15435            MOVE  ER-1893          TO  WS-ERROR
 15436            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15437
 15438 3360-CHECK-FORM-AH-ATT-AGE.
 15439
 15440     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15441
 15442     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15443         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15444         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15445            IF PB-COMPANY-ID = 'NCL'
 15446                MOVE  ER-1913      TO  WS-ERROR
 15447                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15448            ELSE
 15449                MOVE  ER-1894      TO  WS-ERROR
 15450                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15451
 15452 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15453
 15454     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15455         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15456         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15457            IF PB-COMPANY-ID = 'NCL'
 15458                MOVE  ER-1915      TO  WS-ERROR
 15459                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15460            ELSE
 15461                MOVE  ER-1900      TO  WS-ERROR
 15462                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15463
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 279
* EL050.cbl
 15464 3360-CHECK-FORM-AH-TERM-BAMT.
 15465
 15466     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15467         FO-AH-MAX-TERM    GREATER THAN  +0
 15468         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15469             IF  PB-COMPANY-ID = 'NCL'
 15470                 MOVE  ER-1917     TO  WS-ERROR
 15471                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15472             ELSE
 15473                  MOVE  ER-1903    TO  WS-ERROR
 15474                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15475
 15476     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15477         FO-MAX-AH-AMT    GREATER THAN  +0
 15478         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15479             IF  PB-COMPANY-ID = 'NCL'
 15480                 MOVE  ER-1919     TO  WS-ERROR
 15481                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15482             ELSE
 15483                 MOVE  ER-1905     TO  WS-ERROR
 15484                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15485
 15486     GO TO 3999-END-EDIT.
 15487
 15488******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 280
* EL050.cbl
 15490 3400-edit-vin.
 15491
 15492     MOVE PB-I-VIN               TO WS-WORK-VIN
 15493     MOVE +8                     TO V2
 15494     MOVE ZEROS                  TO WS-VIN-TOTAL
 15495     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15496      (V1 > 17)
 15497        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15498           MOVE ER-3825          TO WS-ERROR
 15499           PERFORM 9900-ERROR-FORMAT
 15500                                 THRU 9900-EXIT
 15501        ELSE
 15502           IF V1 = 8
 15503              MOVE 10            TO V2
 15504           END-IF
 15505           IF V1 = 9
 15506              MOVE 0             TO V2
 15507           END-IF
 15508           IF V1 = 10
 15509              MOVE 9             TO V2
 15510           END-IF
 15511           IF WS-WORK-VIN (V1:1) NUMERIC
 15512              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15513               + (WS-WORK-VIN-N (V1) * V2)
 15514           ELSE
 15515              MOVE WS-WORK-VIN (V1:1)
 15516                            TO WS-HEX-BYTE
 15517              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15518              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15519               + (WS-NUM (V3) * V2)
 15520           END-IF
 15521           COMPUTE V2 = V2 - 1
 15522        END-IF
 15523     END-PERFORM
 15524     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15525     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15526        REMAINDER WS-VIN-REMAINDER
 15527     IF ((WS-WORK-VIN (9:1) = 'X')
 15528        AND (WS-VIN-REMAINDER = 10))
 15529                OR
 15530        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15531        CONTINUE
 15532     ELSE
 15533        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15534           MOVE ER-3826          TO WS-ERROR
 15535           PERFORM 9900-ERROR-FORMAT
 15536                                 THRU 9900-EXIT
 15537        ELSE
 15538           MOVE ER-3827          TO WS-ERROR
 15539           PERFORM 9900-ERROR-FORMAT
 15540                                 THRU 9900-EXIT
 15541        END-IF
 15542     END-IF
 15543
 15544     .
 15545 3400-exit.
 15546     exit.
 15547******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 281
* EL050.cbl
 15548*                  E D I T   C A N C E L                         *
 15549******************************************************************
 15550
 15551 3700-EDIT-CANCEL.
 15552     IF PB-COMPANY-ID = 'DMD'
 15553         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15554                                         WS-RES-MUNI-TAX
 15555                                         PB-CI-STATE-TAX
 15556                                         PB-CI-MUNI-TAX
 15557         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15558
 15559*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15560*       IF PB-ENTRY-BATCH  NUMERIC
 15561*          IF PB-CANCELLATION
 15562*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15563*          ELSE
 15564*             IF PB-ISSUE
 15565*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15566
 15567     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15568        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15569     END-IF
 15570*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15571*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15572
 15573     IF CM-ENTRY-STATUS = 'V'
 15574        MOVE ER-2780             TO WS-ERROR
 15575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15576        GO TO 3999-END-EDIT.
 15577
 15578     IF CM-ENTRY-STATUS = 'D'
 15579        MOVE ER-2781             TO WS-ERROR
 15580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15581        GO TO 3999-END-EDIT.
 15582
 15583     IF CM-ENTRY-STATUS = 'U'
 15584        MOVE ER-2782             TO WS-ERROR
 15585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15586
 15587***************************************************************
 15588*                                                             *
 15589*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15590*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15591*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15592*   OF ANOTHER COVERAGE.                                      *
 15593*                                                             *
 15594***************************************************************
 15595
 15596     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15597                                    PB-C-AH-CANCEL-VOID-SW.
 15598
 15599     IF PB-C-LF-CANCEL-AMT = ZERO
 15600        NEXT SENTENCE
 15601     ELSE
 15602        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15603           AND
 15604           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15605               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 282
* EL050.cbl
 15606               MOVE ER-2745           TO WS-ERROR
 15607               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15608
 15609     IF PB-C-AH-CANCEL-AMT = ZERO
 15610        NEXT SENTENCE
 15611     ELSE
 15612        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15613           AND
 15614           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15615               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15616               MOVE ER-2745           TO WS-ERROR
 15617               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15618
 15619     IF WS-LF-EARNINGS-CALC = '4'
 15620        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15621
 15622     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15623     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15624     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15625     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15626     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15627     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15628
 15629     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15630                                      PB-C-AH-REF-CALC.
 15631     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15632
 15633******************************************************************
 15634*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15635*             TO VALIDATE COVERAGE.                              *
 15636******************************************************************
 15637
 15638     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15639        PB-C-LF-CANCEL-AMT = ZEROS
 15640          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15641      ELSE
 15642          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15643
 15644     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15645        PB-C-AH-CANCEL-AMT = ZEROS
 15646          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15647      ELSE
 15648          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15649
 15650     EVALUATE TRUE
 15651         WHEN PB-CANCEL-FORCE             OR
 15652              PB-CANCEL-DATE-FORCED       OR
 15653              PB-FORCE-OFF
 15654                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15655                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15656                  END-IF
 15657         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15658               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15659              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15660                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15661         WHEN OTHER
 15662              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15663                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 283
* EL050.cbl
 15664              ELSE
 15665                 MOVE ER-2749              TO WS-ERROR
 15666              END-IF
 15667              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15668     END-EVALUATE.
 15669
 15670
 15671*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15672*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15673*            MOVE  ER-1909            TO  WS-ERROR
 15674*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15675*        ELSE
 15676*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15677
 15678     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15679     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15680        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15681     ELSE
 15682        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15683     END-IF
 15684     .
 15685 3705-EDIT-CANCEL-DT.
 15686
 15687     IF LF-COVERAGE-CANCELLED
 15688        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15689         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15690         MOVE WS-CURRENT-MONTH-END
 15691                                 TO DC-BIN-DATE-2
 15692         SET ELAPSED-BETWEEN-BIN TO TRUE
 15693*        MOVE 1                  TO DC-OPTION-CODE
 15694         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15695         IF DATE-CONVERSION-ERROR
 15696            NEXT SENTENCE
 15697          ELSE
 15698             IF DC-ELAPSED-DAYS GREATER +180
 15699                IF PB-CANCEL-DATE-FORCED  OR
 15700                   PB-CANCEL-DATE-FORCED-NO-FEE
 15701                      MOVE ER-2751  TO WS-ERROR
 15702                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15703                 ELSE
 15704                   MOVE ER-2752  TO WS-ERROR
 15705                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15706
 15707     IF AH-COVERAGE-CANCELLED
 15708        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15709         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15710         MOVE WS-CURRENT-MONTH-END
 15711                                 TO DC-BIN-DATE-2
 15712         SET ELAPSED-BETWEEN-BIN TO TRUE
 15713*        MOVE 1                  TO DC-OPTION-CODE
 15714         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15715         IF DATE-CONVERSION-ERROR
 15716            NEXT SENTENCE
 15717          ELSE
 15718             IF DC-ELAPSED-DAYS GREATER +180
 15719                IF PB-CANCEL-DATE-FORCED OR
 15720                   PB-CANCEL-DATE-FORCED-NO-FEE
 15721                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 284
* EL050.cbl
 15722                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15723                 ELSE
 15724                   MOVE ER-2752  TO WS-ERROR
 15725                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15726
 15727     IF WS-ERROR = ER-2752
 15728        AND (PB-COMPANY-ID = 'ABL'
 15729         OR  PB-COMPANY-ID = 'FGL'
 15730         OR  PB-COMPANY-ID = 'IST'
 15731         OR  PB-COMPANY-ID = 'JHL'
 15732         OR  PB-COMPANY-ID = 'LAP'
 15733         OR  PB-COMPANY-ID = 'LBL'
 15734         OR  PB-COMPANY-ID = 'NCB'
 15735         OR  PB-COMPANY-ID = 'NLI'
 15736         OR  PB-COMPANY-ID = 'OFI'
 15737         OR  PB-COMPANY-ID = 'PLI'
 15738         OR  PB-COMPANY-ID = 'TAO'
 15739         OR  PB-COMPANY-ID = 'TIC'
 15740         OR  PB-COMPANY-ID = 'HER'
 15741         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15742         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15743            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15744            MOVE ER-2762     TO WS-ERROR
 15745            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15746
 15747     IF LF-COVERAGE-CANCELLED
 15748        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15749        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15750             MOVE ER-2733         TO WS-ERROR
 15751             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15752
 15753     IF AH-COVERAGE-CANCELLED
 15754        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15755        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15756              MOVE ER-2733        TO WS-ERROR
 15757              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15758
 15759     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15760        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15761        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15762           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15763            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15764              IF PB-COMPANY-ID NOT = 'LAP'
 15765               MOVE ER-2704            TO WS-ERROR
 15766               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15767
 15768     IF CERT-WAS-NOT-FOUND
 15769         GO TO 3999-END-EDIT.
 15770
 15771     IF PB-COMPANY-ID EQUAL 'CDC'
 15772        IF LF-COVERAGE-CANCELLED
 15773           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15774            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15775            MOVE PB-C-LF-CANCEL-DT
 15776                                 TO DC-BIN-DATE-2
 15777            SET ELAPSED-BETWEEN-BIN TO TRUE
 15778*           MOVE 1               TO DC-OPTION-CODE
 15779            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 285
* EL050.cbl
 15780            IF DATE-CONVERSION-ERROR
 15781               NEXT SENTENCE
 15782             ELSE
 15783                IF DC-ELAPSED-DAYS GREATER +60
 15784                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15785
 15786     IF PB-COMPANY-ID EQUAL 'CDC'
 15787        IF AH-COVERAGE-CANCELLED
 15788           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15789            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15790            MOVE PB-C-AH-CANCEL-DT
 15791                                 TO DC-BIN-DATE-2
 15792            MOVE +0              TO DC-ELAPSED-DAYS
 15793                                    DC-ELAPSED-MONTHS
 15794            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15795*           MOVE 1               TO DC-OPTION-CODE
 15796            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15797            IF DATE-CONVERSION-ERROR
 15798               NEXT SENTENCE
 15799             ELSE
 15800                IF DC-ELAPSED-DAYS GREATER +60
 15801                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15802
 15803     MOVE +0                     TO DC-ELAPSED-DAYS
 15804                                    DC-ELAPSED-MONTHS.
 15805
 15806     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15807        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15808          MOVE 'Z'                TO PB-CI-OB-FLAG
 15809          MOVE ER-2767            TO WS-ERROR
 15810          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15811          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15812          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15813          GO TO 3775-OVER-REF-CHK
 15814        ELSE
 15815          MOVE ZEROS              TO PB-CI-LIVES
 15816                                     PB-C-LIVES
 15817          IF PB-CI-OB-FLAG NOT = 'B'
 15818             MOVE SPACE           TO PB-CI-OB-FLAG.
 15819
 15820     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15821         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15822     ELSE
 15823         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15824
 15825     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15826        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15827            MOVE ER-2760         TO WS-ERROR
 15828            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15829
 15830     IF LF-COVERAGE-CANCELLED
 15831        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15832         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15833            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15834               MOVE ER-2774       TO WS-ERROR
 15835               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15836
 15837     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 286
* EL050.cbl
 15838        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15839         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15840            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15841               MOVE ER-2775       TO WS-ERROR
 15842               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15843
 15844     IF LF-COVERAGE-CANCELLED
 15845        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15846         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15847            MOVE ER-2776         TO WS-ERROR
 15848            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15849
 15850     IF AH-COVERAGE-CANCELLED
 15851        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15852         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15853            MOVE ER-2777         TO WS-ERROR
 15854            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15855
 15856     IF LF-COVERAGE-CANCELLED
 15857        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15858        if pb-ci-lf-expire-dt = low-values or spaces
 15859           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15860           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15861           MOVE PB-CI-EXTENTION-DAYS
 15862                                 TO DC-ELAPSED-DAYS
 15863           SET BIN-PLUS-ELAPSED  TO TRUE
 15864           PERFORM 8500-DATE-CONVERT
 15865                                 THRU 8500-EXIT
 15866           IF DATE-CONVERSION-ERROR
 15867              move low-values    to dc-bin-date-2
 15868           end-if
 15869        else
 15870           move pb-ci-lf-expire-dt
 15871                                 to dc-bin-date-2
 15872        end-if
 15873        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15874           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15875                             OR  'FIA'
 15876              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15877           ELSE
 15878              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15879              MOVE ER-2731       TO WS-ERROR
 15880              PERFORM 9900-ERROR-FORMAT
 15881                                 THRU 9900-EXIT
 15882           end-if
 15883        end-if
 15884     end-if
 15885*    IF LF-COVERAGE-CANCELLED
 15886*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15887*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15888*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15889*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15890*        SET BIN-PLUS-ELAPSED      TO TRUE
 15891*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15892*        IF DATE-CONVERSION-ERROR
 15893*           NEXT SENTENCE
 15894*         ELSE
 15895*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 287
* EL050.cbl
 15896*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15897*                            OR  'FIA'
 15898*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15899*              ELSE
 15900*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15901*               MOVE ER-2731       TO WS-ERROR
 15902*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15903     .
 15904 3705-EDIT-AH-CANCEL-DT.
 15905     IF AH-COVERAGE-CANCELLED
 15906        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15907        if pb-ci-AH-expire-dt = low-values or spaces
 15908           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15909           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15910           MOVE PB-CI-EXTENTION-DAYS
 15911                                 TO DC-ELAPSED-DAYS
 15912           SET BIN-PLUS-ELAPSED  TO TRUE
 15913           PERFORM 8500-DATE-CONVERT
 15914                                 THRU 8500-EXIT
 15915           IF DATE-CONVERSION-ERROR
 15916              move low-values    to dc-bin-date-2
 15917           end-if
 15918        else
 15919           move pb-ci-ah-expire-dt
 15920                                 to dc-bin-date-2
 15921        end-if
 15922        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15923           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15924                             OR  'FIA'
 15925              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15926           ELSE
 15927              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15928              MOVE ER-2771       TO WS-ERROR
 15929              PERFORM 9900-ERROR-FORMAT
 15930                                 THRU 9900-EXIT
 15931           end-if
 15932        end-if
 15933     end-if
 15934*    IF AH-COVERAGE-CANCELLED
 15935*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15936*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15937*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15938*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15939**       MOVE 6                    TO DC-OPTION-CODE
 15940*        SET BIN-PLUS-ELAPSED      TO TRUE
 15941*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15942*        IF DATE-CONVERSION-ERROR
 15943*           NEXT SENTENCE
 15944*         ELSE
 15945*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15946*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15947*                             OR 'FIA'
 15948*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15949*             ELSE
 15950*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15951*              MOVE ER-2771       TO WS-ERROR
 15952*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15953     .
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 288
* EL050.cbl
 15954 3705-EDIT-CONTINUED.
 15955
 15956*    IF LF-COVERAGE-CANCELLED
 15957*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15958*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15959*            MOVE ER-2727         TO WS-ERROR
 15960*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15961*
 15962*    IF AH-COVERAGE-CANCELLED
 15963*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15964*        IF PB-COMPANY-ID = 'ACE'
 15965*           MOVE ER-2727        TO WS-ERROR
 15966*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15967*        ELSE
 15968*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15969*              MOVE ER-2727     TO WS-ERROR
 15970*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15971
 15972     IF PB-COMPANY-ID = 'ACE'
 15973       IF AH-COVERAGE-CANCELLED
 15974         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15975           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15976              MOVE ER-2732      TO WS-ERROR
 15977              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15978
 15979     IF PB-COMPANY-ID      EQUAL   'HER'
 15980        IF WS-ERROR        EQUAL   ER-2727
 15981            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15982            MOVE  ER-2725          TO  WS-ERROR
 15983            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15984
 15985     IF PB-C-CLAIM-CREATED-CANCEL
 15986            MOVE ER-2748         TO WS-ERROR
 15987            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15988
 15989     IF PB-C-LAST-NAME NOT = SPACES
 15990         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15991            MOVE ER-2747         TO WS-ERROR
 15992            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15993
 15994 3710-EDIT-LUMP-SUM-PRIOR.
 15995
 15996     IF AH-COVERAGE-CANCELLED
 15997         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15998             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15999                MOVE ER-2735    TO WS-ERROR
 16000                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16001
 16002     IF LF-COVERAGE-CANCELLED
 16003         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16004             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16005                MOVE ER-2735    TO WS-ERROR
 16006                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16007
 16008 3710-EDIT-PRIOR-DEATH.
 16009
 16010*    IF LF-COVERAGE-CANCELLED
 16011*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 289
* EL050.cbl
 16012*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16013*           (NOT PB-CI-OB)
 16014*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16015*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16016*                   MOVE ER-2732  TO WS-ERROR
 16017*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16018*
 16019*    IF AH-COVERAGE-CANCELLED
 16020*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16021*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16022*           (NOT PB-CI-OB)
 16023*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16024*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16025*                   MOVE ER-2732  TO WS-ERROR
 16026*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16027
 16028     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16029         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16030            (NOT PB-COMP-LF-CANCEL)
 16031             NEXT SENTENCE
 16032         ELSE
 16033           IF PB-C-LF-CANCEL-VOIDED
 16034              NEXT SENTENCE
 16035           ELSE
 16036              MOVE ER-2753      TO WS-ERROR
 16037              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16038
 16039     IF CANCEL-FUTURE-DT
 16040         GO TO 3999-END-EDIT.
 16041
 16042 3715-GET-REMAIN-TERM-LF.
 16043
 16044     IF NO-LF-BENEFIT-MATCH  OR
 16045        WS-LF-BENEFIT-CD = ZEROS
 16046        GO TO 3730-GET-AH-REMAIN-TERM.
 16047
 16048     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16049     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16050     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16051     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16052     MOVE PB-SV-STATE            TO CP-STATE.
 16053     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16054     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16055     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16056     MOVE '2'                    TO CP-PROCESS-TYPE.
 16057     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16058     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16059     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16060     IF (PB-COMPANY-ID = 'CID')
 16061        AND (CP-STATE-STD-ABBRV = 'WI')
 16062        MOVE '7'                 TO CP-REM-TERM-METHOD
 16063        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16064     ELSE
 16065        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16066        MOVE WS-REM-TRM-CALC-OPTION
 16067                                 TO CP-REM-TRM-CALC-OPTION
 16068     END-IF
 16069**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 290
* EL050.cbl
 16070     IF (PB-COMPANY-ID = 'CID')
 16071        AND (CP-STATE-STD-ABBRV = 'MO')
 16072        AND (PB-CERT-EFF-DT >= X'9B41')
 16073        AND (PB-CERT-EFF-DT <= X'A2FB')
 16074        MOVE '7'                 TO CP-REM-TERM-METHOD
 16075        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16076     END-IF
 16077     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16078                                    CP-LOAN-TERM.
 16079     IF CP-TRUNCATED-LIFE
 16080        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16081
 16082     IF CP-TERM-IS-DAYS
 16083         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16084     ELSE
 16085         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16086
 16087     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16088
 16089     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16090
 16091     IF LF-COVERAGE-CANCELLED
 16092        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16093        NEXT SENTENCE
 16094      ELSE
 16095          GO TO 3730-GET-AH-REMAIN-TERM.
 16096
 16097 3720-GET-LF-REFUND.
 16098
 16099     IF PB-C-LF-CANCEL-VOIDED
 16100        GO TO 3730-GET-AH-REMAIN-TERM
 16101     end-if
 16102
 16103     IF PB-COMPANY-ID EQUAL 'BOA'
 16104         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16105         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16106         GO TO 3730-GET-AH-REMAIN-TERM.
 16107
 16108     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16109        (WS-AH-SPECIAL-CALC-CD = 'M')
 16110         MOVE ER-2767            TO WS-ERROR
 16111         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16112         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16113         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16114         GO TO 3780-UPDATE-CANCEL-CERT.
 16115
 16116*    if (ws-lf-earnings-calc = '6')
 16117*       or (pb-c-lf-refund-override = '6')
 16118*       move cp-remaining-term-1 to cp-remaining-term-2
 16119*    end-if
 16120     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16121
 16122     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16123     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16124     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16125     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16126     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16127     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 291
* EL050.cbl
 16128     IF PB-COMPANY-ID = 'DCC'
 16129        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16130        IF PDEF-MASTER-FOUND
 16131           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16132              (V1 > +8)
 16133              OR (PD-PROD-CODE (V1) = 'L')
 16134           END-PERFORM
 16135           IF V1 < +9
 16136              MOVE PD-MAX-AMT (V1)
 16137                           TO CP-R-MAX-TOT-BEN
 16138                              EC-AM-LF-MAX-TOT-BEN
 16139           END-IF
 16140        ELSE
 16141        MOVE ' '                 TO PDEF-MASTER-SW
 16142        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16143        MOVE PB-STATE            TO ERPDEF-STATE
 16144        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16145           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16146        END-IF
 16147        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16148        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16149        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16150        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16151        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16152        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16153        IF PDEF-MASTER-FOUND
 16154           MOVE 'N'              TO PDEF-MASTER-SW
 16155           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16156           IF PDEF-MASTER-FOUND
 16157              IF (ERPDEF-KEY-SAVE (1:16) =
 16158                           PD-CONTROL-PRIMARY (1:16))
 16159                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16160                 CONTINUE
 16161              ELSE
 16162                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16163                 IF (ERPDEF-KEY-SAVE (1:16) =
 16164                           PD-CONTROL-PRIMARY (1:16))
 16165                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16166                    CONTINUE
 16167                 ELSE
 16168                    MOVE 'N'     TO PDEF-MASTER-SW
 16169                 END-IF
 16170              END-IF
 16171
 16172              IF PDEF-MASTER-FOUND
 16173                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16174                    (V1 > +8)
 16175                    OR (PD-PROD-CODE (V1) = 'L')
 16176                 END-PERFORM
 16177                 IF V1 < +9
 16178                    MOVE PD-MAX-AMT (V1)
 16179                                 TO CP-R-MAX-TOT-BEN
 16180                                    EC-AM-LF-MAX-TOT-BEN
 16181                 END-IF
 16182              END-IF
 16183           END-IF
 16184           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16185        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 292
* EL050.cbl
 16186        END-IF
 16187     END-IF
 16188     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16189
 16190     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16191
 16192     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16193                                    PB-C-LF-REM-TERM.
 16194
 16195     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16196     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16197
 16198     IF PB-COMPANY-ID EQUAL 'FLC'
 16199        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16200           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16201           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16202                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16203                    - CM-LF-ITD-DEATH-AMT
 16204           IF PB-C-LF-REF-CALC LESS THAN +0
 16205              MOVE +0            TO PB-C-LF-REF-CALC
 16206              GO TO 3730-GET-AH-REMAIN-TERM
 16207           ELSE
 16208              GO TO 3730-GET-AH-REMAIN-TERM.
 16209
 16210     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16211                            OR '4' OR '5' OR '6' OR '8'
 16212                            OR '9' OR 'G'
 16213        MOVE PB-C-LF-REFUND-OVERRIDE
 16214                                 TO CP-EARNING-METHOD.
 16215
 16216     if pb-company-id = 'AHL'
 16217        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16218        if cp-class-code = spaces
 16219           move zeros            to cp-class-code
 16220        end-if
 16221     ELSE
 16222        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16223     END-IF
 16224*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16225     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16226     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16227                                    CP-RATING-BENEFIT-AMT.
 16228     IF CP-STATE-STD-ABBRV = 'OR'
 16229         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16230                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16231     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16232     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16233     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16234     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16235     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16236     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16237     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16238     IF WS-DEFAULT-APR NOT NUMERIC
 16239         MOVE ZEROS TO WS-DEFAULT-APR.
 16240****   N O T E   ****
 16241*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16242*      THE OH HARD CODING IN ELCRFNDP
 16243
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 293
* EL050.cbl
 16244     IF PB-COMPANY-ID = 'CID'
 16245        IF CP-STATE-STD-ABBRV = 'OH'
 16246           MOVE WS-LF-EARNINGS-CALC
 16247                                 TO CP-EARNING-METHOD
 16248        END-IF
 16249     END-IF
 16250
 16251****   N O T E   ****
 16252
 16253     IF CP-EARN-AS-NET-PAY
 16254         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16255            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16256                MOVE WS-DEFAULT-APR
 16257                                 TO  CP-LOAN-APR
 16258                MOVE ER-3780     TO  WS-ERROR
 16259                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16260            ELSE
 16261                MOVE ER-3781     TO  WS-ERROR
 16262                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16263*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16264     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16265
 16266     IF CP-REFUND-TYPE-USED NOT = SPACE
 16267         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16268
 16269     IF CP-ERROR-RATE-IS-ZERO OR
 16270        CP-ERROR-RATE-NOT-FOUND
 16271        MOVE ER-2740             TO WS-ERROR
 16272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16273
 16274     IF CP-ERROR-RATE-FILE-NOTOPEN
 16275        MOVE ER-2617             TO WS-ERROR
 16276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16277
 16278     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16279        AND PB-CI-ENTRY-STATUS = 'M'
 16280        MOVE +0                  TO PB-C-LF-REF-CALC
 16281     ELSE
 16282        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16283     END-IF
 16284
 16285     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16286         GO TO 3730-GET-AH-REMAIN-TERM.
 16287
 16288*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16289*       ADD +1                   TO PB-C-LF-REM-TERM
 16290*                                   CP-REMAINING-TERM
 16291*                                   CP-ORIGINAL-TERM.
 16292
 16293     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16294     MOVE '2'                    TO CP-EARNING-METHOD
 16295                                    CP-RATING-METHOD.
 16296     IF PB-COMPANY-ID = 'CID'
 16297        IF (CP-STATE-STD-ABBRV = 'MN')
 16298           AND (PB-CERT-EFF-DT > X'A4FF')
 16299           AND (WS-LF-EARNINGS-CALC = 'B')
 16300           MOVE '5'              TO CP-EARNING-METHOD
 16301           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 294
* EL050.cbl
 16302        END-IF
 16303     END-IF
 16304     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16305                                        CP-REMAINING-BENEFIT
 16306                                        CP-RATING-BENEFIT-AMT.
 16307     IF CP-STATE-STD-ABBRV = 'OR'
 16308         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16309                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16310     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16311     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16312
 16313     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16314
 16315     IF CP-ERROR-RATE-IS-ZERO OR
 16316        CP-ERROR-RATE-NOT-FOUND
 16317        MOVE ER-2740             TO WS-ERROR
 16318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16319
 16320     IF CP-ERROR-RATE-FILE-NOTOPEN
 16321        MOVE ER-2617             TO WS-ERROR
 16322        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16323
 16324     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16325
 16326******************************************************************
 16327
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 295
* EL050.cbl
 16329 3730-GET-AH-REMAIN-TERM.
 16330     IF NO-AH-BENEFIT-MATCH  OR
 16331        WS-AH-BENEFIT-CD = ZEROS
 16332         GO TO 3770-CHECK-REFUNDS.
 16333
 16334     IF PB-CI-AH-LUMP-SUM-DISAB
 16335         IF  PB-C-AH-CANCEL-AMT = ZERO
 16336            IF NOT PB-COMP-AH-CANCEL
 16337             GO TO 3770-CHECK-REFUNDS.
 16338
 16339     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16340     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16341     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16342     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16343     MOVE PB-SV-STATE            TO CP-STATE.
 16344     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16345     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16346     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16347     MOVE '2'                    TO CP-PROCESS-TYPE.
 16348     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16349     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16350     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16351     IF (PB-COMPANY-ID = 'CID')
 16352        AND (CP-STATE-STD-ABBRV = 'WI')
 16353        MOVE '7'                 TO CP-REM-TERM-METHOD
 16354        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16355     ELSE
 16356        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16357        MOVE WS-REM-TRM-CALC-OPTION
 16358                                 TO CP-REM-TRM-CALC-OPTION
 16359     END-IF
 16360     IF (PB-COMPANY-ID = 'CID')
 16361        AND (CP-STATE-STD-ABBRV = 'MO')
 16362        AND (PB-CERT-EFF-DT >= X'9B41')
 16363        AND (PB-CERT-EFF-DT <= X'A2FB')
 16364        MOVE '7'                 TO CP-REM-TERM-METHOD
 16365        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16366     END-IF
 16367     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16368                                    CP-LOAN-TERM.
 16369     IF NOT CP-TERM-IS-DAYS
 16370         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16371
 16372     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16373
 16374     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16375
 16376     IF AH-COVERAGE-CANCELLED
 16377        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16378        NEXT SENTENCE
 16379      ELSE
 16380         GO TO 3770-CHECK-REFUNDS.
 16381
 16382 3740-GET-AH-REFUND.
 16383
 16384     IF PB-C-AH-CANCEL-VOIDED
 16385        GO TO 3780-UPDATE-CANCEL-CERT
 16386     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 296
* EL050.cbl
 16387
 16388     IF PB-COMPANY-ID = 'BOA'
 16389         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16390         GO TO 3770-CHECK-REFUNDS.
 16391
 16392     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16393*    MOVE ' '                    TO DC-OPTION-CODE
 16394     SET BIN-TO-GREG             TO TRUE
 16395     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16396     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16397                                    PB-C-AH-REM-TERM.
 16398     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16399     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16400
 16401     IF PB-COMPANY-ID EQUAL 'FLC'
 16402        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16403           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16404           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16405                    - CM-AH-ITD-AH-PMT)
 16406           IF PB-C-AH-REF-CALC LESS THAN +0
 16407              MOVE +0            TO PB-C-AH-REF-CALC
 16408              GO TO 3770-CHECK-REFUNDS
 16409           ELSE
 16410              GO TO 3770-CHECK-REFUNDS.
 16411
 16412     IF PB-COMPANY-ID = 'DCC'
 16413        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16414            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16415           MOVE 'S'              TO CP-EARNING-METHOD
 16416        END-IF
 16417     END-IF
 16418     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16419                            OR '4' OR '5' OR '6' OR '8'
 16420                            OR '9' OR 'G' OR 'S'
 16421        MOVE PB-C-AH-REFUND-OVERRIDE
 16422                                 TO CP-EARNING-METHOD.
 16423
 16424     if pb-company-id = 'AHL'
 16425        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16426        if cp-class-code = spaces
 16427           move zeros            to cp-class-code
 16428        end-if
 16429     ELSE
 16430        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16431     END-IF
 16432*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16433     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16434     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16435                                    CP-RATING-BENEFIT-AMT.
 16436     IF CP-STATE-STD-ABBRV = 'OR'
 16437         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16438                                         PB-CI-AH-TERM.
 16439     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16440     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16441     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16442     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16443     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16444     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 297
* EL050.cbl
 16445
 16446     IF CP-STATE-STD-ABBRV = 'OH'
 16447        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16448                                AND 'CID' AND 'DCC' and 'VPP'
 16449                                AND 'AHL')
 16450           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16451              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16452              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16453              MOVE '6' TO CP-EARNING-METHOD
 16454           END-IF
 16455        END-IF
 16456        IF PB-COMPANY-ID = 'CID'
 16457           IF NO-LIFE-COVERAGE
 16458              IF CP-CRITICAL-PERIOD
 16459                 MOVE '2'       TO CP-EARNING-METHOD
 16460              ELSE
 16461                 MOVE '6'       TO CP-EARNING-METHOD
 16462              END-IF
 16463           ELSE
 16464              IF WS-LF-COVERAGE-TYPE = 'L'
 16465                 MOVE '2'       TO CP-EARNING-METHOD
 16466              ELSE
 16467                 IF (PB-CI-LF-TERM > +60) OR
 16468                    (WS-LF-EARNINGS-CALC = '5')
 16469                    IF CP-CRITICAL-PERIOD
 16470                       MOVE '2'  TO CP-EARNING-METHOD
 16471                    ELSE
 16472                       MOVE '6'  TO CP-EARNING-METHOD
 16473                    END-IF
 16474                 ELSE
 16475                    MOVE '1'     TO CP-EARNING-METHOD
 16476                 END-IF
 16477              END-IF
 16478           END-IF
 16479        END-IF
 16480     END-IF
 16481
 16482*    IF CP-STATE-STD-ABBRV = 'VA'
 16483*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16484*          IF CP-ORIGINAL-TERM GREATER 61
 16485*             MOVE '6' TO CP-EARNING-METHOD
 16486*          ELSE
 16487*             MOVE '1' TO CP-EARNING-METHOD.
 16488
 16489     IF WS-DEFAULT-APR NOT NUMERIC
 16490         MOVE ZEROS TO WS-DEFAULT-APR.
 16491     IF CP-EARN-AS-NET-PAY
 16492         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16493            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16494                MOVE WS-DEFAULT-APR
 16495                                 TO  CP-LOAN-APR
 16496                MOVE ER-3780     TO  WS-ERROR
 16497                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16498            ELSE
 16499                MOVE ER-3781     TO  WS-ERROR
 16500                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16501     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16502     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 298
* EL050.cbl
 16503        AND CP-CANCEL-REASON = 'R'
 16504        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16505        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16506     END-IF
 16507     IF PB-COMPANY-ID = 'DCC'
 16508        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16509        AND (CP-EARNING-METHOD = 'D')
 16510        AND (CP-CANCEL-REASON NOT = 'R')
 16511        CONTINUE
 16512     ELSE
 16513        GO TO 3750-CONTINUE
 16514     END-IF
 16515     MOVE ' '                    TO DD-IU-SW
 16516     IF NOT PDEF-MASTER-FOUND
 16517        MOVE ' '                 TO PDEF-MASTER-SW
 16518        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16519        MOVE PB-STATE            TO ERPDEF-STATE
 16520        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16521           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16522        END-IF
 16523        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16524        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16525        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16526        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16527        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16528        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16529        IF PDEF-MASTER-FOUND
 16530           MOVE 'N'              TO PDEF-MASTER-SW
 16531           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16532           IF PDEF-MASTER-FOUND
 16533              IF (ERPDEF-KEY-SAVE (1:16) =
 16534                           PD-CONTROL-PRIMARY (1:16))
 16535                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16536                 CONTINUE
 16537              ELSE
 16538                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16539                 IF (ERPDEF-KEY-SAVE (1:16) =
 16540                           PD-CONTROL-PRIMARY (1:16))
 16541                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16542                    CONTINUE
 16543                 ELSE
 16544                    MOVE ER-2740 TO WS-ERROR
 16545                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16546                    GO TO 3770-CHECK-REFUNDS
 16547                 END-IF
 16548              END-IF
 16549           END-IF
 16550           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16551        END-IF
 16552     END-IF
 16553     IF PDEF-MASTER-FOUND
 16554        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16555           (V1 > +8)
 16556           OR (PD-PROD-CODE (V1) = 'I')
 16557        END-PERFORM
 16558        IF V1 < +9
 16559           SET DD-IU-PRESENT        TO TRUE
 16560        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 299
* EL050.cbl
 16561        IF WS-AH-DCC-TRUNC = 'T'
 16562           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16563        ELSE
 16564           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16565        END-IF
 16566        EVALUATE TRUE
 16567           WHEN WS-TERM > +168
 16568              MOVE 15               TO V1
 16569           WHEN WS-TERM > +156
 16570              MOVE 14               TO V1
 16571           WHEN WS-TERM > +144
 16572              MOVE 13               TO V1
 16573           WHEN WS-TERM > +132
 16574              MOVE 12               TO V1
 16575           WHEN WS-TERM > +120
 16576              MOVE 11               TO V1
 16577           WHEN WS-TERM > +108
 16578              MOVE 10               TO V1
 16579           WHEN WS-TERM > +96
 16580              MOVE 9                TO V1
 16581           WHEN WS-TERM > +84
 16582              MOVE 8                TO V1
 16583           WHEN WS-TERM > +72
 16584              MOVE 7                TO V1
 16585           WHEN WS-TERM > +60
 16586              MOVE 6                TO V1
 16587           WHEN WS-TERM > +48
 16588              MOVE 5                TO V1
 16589           WHEN WS-TERM > +36
 16590              MOVE 4                TO V1
 16591           WHEN WS-TERM > +24
 16592              MOVE 3                TO V1
 16593           WHEN WS-TERM > +12
 16594              MOVE 2                TO V1
 16595           WHEN OTHER
 16596              MOVE 1                TO V1
 16597        END-EVALUATE
 16598
 16599        EVALUATE TRUE
 16600*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16601*             < +13)
 16602*             AND (DD-IU-PRESENT)
 16603*             MOVE 2                TO V2
 16604*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16605*             MOVE 1                TO V2
 16606           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16607              MOVE 2                TO V2
 16608           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16609              MOVE 3                TO V2
 16610           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16611              MOVE 4                TO V2
 16612           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16613              MOVE 5                TO V2
 16614           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16615              MOVE 6                TO V2
 16616           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16617              MOVE 7                TO V2
 16618           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 300
* EL050.cbl
 16619              MOVE 8                TO V2
 16620           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16621              MOVE 9                TO V2
 16622           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16623              MOVE 10               TO V2
 16624           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16625              MOVE 11               TO V2
 16626           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16627              MOVE 12               TO V2
 16628           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16629              MOVE 13               TO V2
 16630           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16631              MOVE 14               TO V2
 16632           WHEN OTHER
 16633              MOVE 15               TO V2
 16634        END-EVALUATE
 16635
 16636        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16637                                 TO CP-DDF-LO-FACT
 16638        MOVE PD-UEP-FACTOR (V1 V2)
 16639                                 TO CP-DDF-HI-FACT
 16640
 16641        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16642        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16643        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16644           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16645        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16646        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16647        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16648           + PD-1ST-YR-ADMIN-ALLOW
 16649
 16650        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16651*       IF PI-CLP-YN = 'Y'
 16652*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16653*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16654*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16655*       END-IF
 16656
 16657        IF DD-IU-PRESENT
 16658           MOVE 'I'              TO CP-EARNING-METHOD
 16659        END-IF
 16660        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16661                                     CP-CLP-RATE-UP
 16662        IF CP-IU-RATE-UP NOT = ZEROS
 16663           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16664              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16665           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16666              / (1 - WS-WORK-FACT)
 16667        END-IF
 16668     END-IF
 16669     .
 16670 3750-CONTINUE.
 16671     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16672
 16673     IF CP-REFUND-TYPE-USED NOT = SPACE
 16674         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16675
 16676     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 301
* EL050.cbl
 16677        CP-ERROR-RATE-NOT-FOUND
 16678        MOVE ER-2740             TO WS-ERROR
 16679        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16680
 16681     IF CP-ERROR-RATE-FILE-NOTOPEN
 16682        MOVE ER-2617             TO WS-ERROR
 16683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16684     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16685        AND (PB-CI-ENTRY-STATUS = 'M')
 16686        MOVE +0                  TO PB-C-AH-REF-CALC
 16687     ELSE
 16688        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16689     END-IF
 16690     if pb-company-id = 'VPP'
 16691        MOVE cm-ah-clp           to cp-original-premium
 16692        move zeros               to cp-calc-refund
 16693        perform 7600-get-refund  thru 7600-exit
 16694        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16695           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16696        else
 16697           move zeros            to pb-c-ah-rfnd-clp
 16698        end-if
 16699        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16700           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16701           pb-ci-cancel-fee
 16702     end-if
 16703     IF PB-COMPANY-ID = 'DCC'
 16704        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16705        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16706        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16707        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16708        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16709        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16710        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16711        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16712*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16713     END-IF
 16714     .
 16715 3770-CHECK-REFUNDS.
 16716
 16717     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16718        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16719           MOVE ER-2766          TO WS-ERROR
 16720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16721           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16722           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16723              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16724
 16725     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16726        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16727           MOVE ER-2766          TO WS-ERROR
 16728           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16729           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16730           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16731              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16732
 16733     IF PB-COMP-LF-CANCEL
 16734        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 302
* EL050.cbl
 16735        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16736           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16737              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16738
 16739     IF PB-COMP-AH-CANCEL
 16740        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16741        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16742           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16743              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16744
 16745     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16746             GIVING WS-UNSIGN-WRK1
 16747     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16748             GIVING WS-UNSIGN-WRK2.
 16749
 16750     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16751         MOVE ZERO TO WS-UNSIGN-WRK1.
 16752
 16753     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16754         MOVE ZERO TO WS-UNSIGN-WRK2.
 16755
 16756     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16757
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 303
* EL050.cbl
 16759
 16760 3772-CONTINUE.
 16761
 16762**********************************
 16763*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16764*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16765*** DOUBLES THE TOLERANCE AMOUNT.
 16766***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16767**********************************
 16768     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16769     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16770         IF WS-REF-REJECT-SW = SPACE
 16771             MOVE ER-2754        TO WS-ERROR
 16772             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16773           ELSE
 16774             MOVE ER-2736        TO WS-ERROR
 16775             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16776**********************************
 16777
 16778 3773-CONTINUE.
 16779
 16780     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16781        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16782           MOVE ER-2723          TO WS-ERROR
 16783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16784
 16785     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16786        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16787           MOVE ER-2724          TO WS-ERROR
 16788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16789
 16790     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16791         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16792             (1 + WS-LF-REFUND-OVS-PCT)
 16793     ELSE
 16794         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16795
 16796     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16797         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16798             (1 - WS-TOL-LF-REFUND-PCT)
 16799     ELSE
 16800         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16801
 16802     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16803        AND (PB-CI-ENTRY-STATUS = 'M')
 16804        AND (PB-C-LF-CANCEL-AMT > +0)
 16805        MOVE ER-3843             TO WS-ERROR
 16806        PERFORM 9900-ERROR-FORMAT
 16807                                 THRU 9900-EXIT
 16808     END-IF
 16809     EVALUATE TRUE
 16810        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16811           CONTINUE
 16812        WHEN PB-C-LF-CANCEL-AMT = +0
 16813                 AND PB-C-LF-REF-CALC > +0
 16814           CONTINUE
 16815        WHEN WS-LF-REFUND-OVS-AMT = 0
 16816                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 304
* EL050.cbl
 16817           CONTINUE
 16818        WHEN OTHER
 16819           IF WS-TOL-LF-REFUND  = +0
 16820              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16821           END-IF
 16822           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16823                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16824                          (PB-C-LF-CANCEL-AMT))
 16825              CONTINUE
 16826           ELSE
 16827              IF WS-LF-REFUND-OVS-AMT = +0
 16828                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16829              END-IF
 16830              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16831                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16832                                       PB-C-LF-CANCEL-AMT)
 16833                 CONTINUE
 16834              ELSE
 16835                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16836                   MOVE ER-2754   TO  WS-ERROR
 16837                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16838                 ELSE
 16839                    MOVE ER-2736   TO  WS-ERROR
 16840                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16841                 END-IF
 16842              END-IF
 16843           END-IF
 16844     END-EVALUATE.
 16845
 16846     EVALUATE TRUE
 16847        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16848           CONTINUE
 16849        WHEN PB-C-LF-CANCEL-AMT = +0
 16850                 AND PB-C-LF-REF-CALC > +0
 16851           CONTINUE
 16852        WHEN OTHER
 16853           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16854               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16855              CONTINUE
 16856           ELSE
 16857              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16858               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16859                CONTINUE
 16860              ELSE
 16861                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16862                     MOVE ER-2754   TO  WS-ERROR
 16863                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16864                 ELSE
 16865                     MOVE ER-2736   TO  WS-ERROR
 16866                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16867                 END-IF
 16868              END-IF
 16869           END-IF
 16870     END-EVALUATE.
 16871
 16872     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16873         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16874             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 305
* EL050.cbl
 16875     ELSE
 16876         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16877
 16878     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16879         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16880             (1 - WS-TOL-AH-REFUND-PCT)
 16881     ELSE
 16882         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16883
 16884     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16885        AND (PB-CI-ENTRY-STATUS = 'M')
 16886        AND (PB-C-AH-CANCEL-AMT > +0)
 16887        MOVE ER-3843             TO WS-ERROR
 16888        PERFORM 9900-ERROR-FORMAT
 16889                                 THRU 9900-EXIT
 16890     END-IF
 16891     EVALUATE TRUE
 16892        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16893           CONTINUE
 16894*       WHEN PB-C-AH-REF-CALC = +0 AND
 16895*                  PB-C-AH-CANCEL-AMT > +0
 16896        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16897                   PB-C-AH-REF-CALC > +0
 16898           CONTINUE
 16899        WHEN WS-AH-REFUND-OVS-AMT = +0
 16900                AND WS-TOL-AH-REFUND = +0
 16901           CONTINUE
 16902        WHEN OTHER
 16903           IF WS-TOL-AH-REFUND = +0
 16904              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16905           END-IF
 16906           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16907               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16908                                         PB-C-AH-CANCEL-AMT)
 16909              CONTINUE
 16910           ELSE
 16911              IF WS-AH-REFUND-OVS-AMT = +0
 16912                 MOVE +9999999.99 TO
 16913                         WS-AH-REFUND-OVS-AMT
 16914              END-IF
 16915              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16916                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16917                                         PB-C-AH-CANCEL-AMT)
 16918                 CONTINUE
 16919              ELSE
 16920                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16921                    MOVE ER-2754   TO  WS-ERROR
 16922                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16923                 ELSE
 16924                    MOVE ER-2736   TO  WS-ERROR
 16925                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16926                 END-IF
 16927              END-IF
 16928           END-IF
 16929     END-EVALUATE.
 16930
 16931     EVALUATE TRUE
 16932        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 306
* EL050.cbl
 16933           CONTINUE
 16934*       WHEN PB-C-AH-REF-CALC > +0 AND
 16935*                  PB-C-AH-CANCEL-AMT = +0
 16936        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16937                   PB-C-AH-REF-CALC = +0
 16938           CONTINUE
 16939        WHEN OTHER
 16940           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16941               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16942              CONTINUE
 16943           ELSE
 16944              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16945                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16946                 CONTINUE
 16947              ELSE
 16948                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16949                     MOVE ER-2754   TO  WS-ERROR
 16950                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16951                 ELSE
 16952                     MOVE ER-2736   TO  WS-ERROR
 16953                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16954                 END-IF
 16955              END-IF
 16956           END-IF
 16957     END-EVALUATE.
 16958
 16959     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16960        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16961        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16962           AND  PB-C-LF-REF-CALC < +1.00
 16963           AND  PB-C-AH-REF-CALC < +1.00
 16964           CONTINUE
 16965        ELSE
 16966           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16967              AND (PB-CI-ENTRY-STATUS = 'M')
 16968              CONTINUE
 16969           ELSE
 16970              MOVE ER-2741       TO WS-ERROR
 16971              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16972           END-IF
 16973        END-IF
 16974     END-IF
 16975
 16976     IF (PB-C-LF-CANCEL-AMT = ZERO
 16977        AND WS-LF-BENEFIT-CD NOT = ZERO
 16978        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16979        AND PB-C-LF-REF-CALC NOT = ZERO)
 16980        OR
 16981        (PB-C-LF-CANCEL-AMT = ZERO
 16982        AND WS-LF-BENEFIT-CD NOT = ZERO
 16983        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16984             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16985                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16986                NEXT SENTENCE
 16987             ELSE
 16988                MOVE ER-2739        TO WS-ERROR
 16989                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16990
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 307
* EL050.cbl
 16991     IF (PB-C-AH-CANCEL-AMT = ZERO
 16992        AND WS-AH-BENEFIT-CD NOT = ZERO
 16993        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16994        AND PB-C-AH-REF-CALC NOT = ZERO)
 16995        OR
 16996        (PB-C-AH-CANCEL-AMT = ZERO
 16997        AND WS-AH-BENEFIT-CD NOT = ZERO
 16998        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16999             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17000                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17001                NEXT SENTENCE
 17002             ELSE
 17003                MOVE ER-2738        TO WS-ERROR
 17004                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17005
 17006 3775-OVER-REF-CHK.
 17007
 17008     IF PB-CI-ENTRY-STATUS = '5'
 17009        GO TO 3780-UPDATE-CANCEL-CERT.
 17010
 17011     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17012                              PB-CI-LF-ALT-PREMIUM-AMT.
 17013
 17014     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17015        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17016                                 PB-C-LF-REF-CALC
 17017      ELSE
 17018        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17019                                 PB-C-LF-CANCEL-AMT.
 17020
 17021     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17022        MOVE ER-2755             TO WS-ERROR
 17023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17024
 17025     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17026
 17027     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17028        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17029                                 PB-C-AH-REF-CALC
 17030      ELSE
 17031        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17032                                 PB-C-AH-CANCEL-AMT.
 17033
 17034     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17035        MOVE ER-2778             TO WS-ERROR
 17036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17037
 17038     IF PB-CI-OB-FLAG NOT = 'Z'
 17039        NEXT SENTENCE
 17040       ELSE
 17041         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17042            MOVE ER-2757           TO WS-ERROR
 17043            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17044
 17045 3780-UPDATE-CANCEL-CERT.
 17046
 17047     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17048        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 308
* EL050.cbl
 17049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17050
 17051     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17052         MOVE ER-2729              TO WS-ERROR
 17053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17054
 17055     IF PB-CI-LF-BENEFIT-CD = ZERO
 17056         GO TO 3780-UPDATE-CONT-1.
 17057
 17058     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17059         GO TO 3780-UPDATE-CONT-1.
 17060
 17061     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17062       AND
 17063        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17064       AND
 17065        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17066       AND
 17067        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17068            NEXT SENTENCE
 17069       ELSE
 17070        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17071          AND
 17072***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17073***       AND
 17074           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17075            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17076               MOVE ER-2730      TO WS-ERROR
 17077               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17078               GO TO 3999-END-EDIT
 17079            ELSE
 17080               GO TO 3999-END-EDIT
 17081        ELSE
 17082            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17083               MOVE ER-2765           TO WS-ERROR
 17084               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17085               GO TO 3785-CHECK-NH.
 17086*              GO TO 3999-END-EDIT.
 17087
 17088 3780-UPDATE-CONT-1.
 17089     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17090
 17091     IF PB-CI-AH-BENEFIT-CD = ZERO
 17092         GO TO 3780-UPDATE-CONT-2.
 17093
 17094     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17095         GO TO 3780-UPDATE-CONT-2.
 17096
 17097     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17098
 17099     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17100       AND
 17101        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17102       AND
 17103        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17104       AND
 17105        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17106            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 309
* EL050.cbl
 17107       ELSE
 17108        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17109          AND
 17110***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17111***       AND
 17112           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17113           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17114            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17115               MOVE ER-2773      TO WS-ERROR
 17116               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17117               GO TO 3999-END-EDIT
 17118            ELSE
 17119               GO TO 3999-END-EDIT
 17120            END-IF
 17121           ELSE
 17122             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17123                IF MSTR-CERT-NO = W-CL-CERT-NO
 17124                   MOVE ER-2890 TO WS-ERROR
 17125                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17126                   GO TO 3999-END-EDIT
 17127                ELSE
 17128                   MOVE ER-2898 TO WS-ERROR
 17129                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17130                   GO TO 3999-END-EDIT
 17131                END-IF
 17132             ELSE
 17133                GO TO 3785-CHECK-NH
 17134             END-IF
 17135           END-IF
 17136          ELSE
 17137            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17138              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17139                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17140                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17141                      MOVE ER-2890 TO WS-ERROR
 17142                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17143                      GO TO 3999-END-EDIT
 17144                   ELSE
 17145                      MOVE ER-2898 TO WS-ERROR
 17146                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17147                      GO TO 3999-END-EDIT
 17148                   END-IF
 17149                ELSE
 17150                   MOVE ER-2765 TO WS-ERROR
 17151                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17152                   GO TO 3785-CHECK-NH
 17153                END-IF
 17154              ELSE
 17155               MOVE ER-2765      TO WS-ERROR
 17156               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17157               GO TO 3785-CHECK-NH.
 17158*              GO TO 3999-END-EDIT.
 17159
 17160 3780-UPDATE-CONT-2.
 17161
 17162     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17163        AND WS-LF-BENEFIT-CD = ZERO
 17164           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 310
* EL050.cbl
 17165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17166
 17167     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17168        AND WS-AH-BENEFIT-CD = ZERO
 17169           MOVE ER-2744           TO WS-ERROR
 17170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17171
 17172     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17173        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17174        AND
 17175        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17176         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17177           MOVE ER-2746           TO WS-ERROR
 17178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17179
 17180     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17181       AND
 17182        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17183             MOVE ER-2737        TO WS-ERROR
 17184             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17185
 17186     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17187       AND
 17188        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17189             MOVE ER-2737        TO WS-ERROR
 17190             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17191
 17192     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17193         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17194             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17195             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17196         ELSE
 17197             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17198                 MOVE ER-2768    TO WS-ERROR
 17199                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17200             ELSE
 17201                 MOVE ER-2756    TO WS-ERROR
 17202                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17203
 17204     IF CERT-PEND-ISSUE-RETURNED
 17205        MOVE ER-2772             TO WS-ERROR
 17206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17207 3785-CHECK-NH.
 17208*    IF PB-STATE NOT = 'NH' and 'TN'
 17209     IF PB-STATE NOT = 'NH'
 17210        GO TO 3999-END-EDIT
 17211     END-IF
 17212
 17213     MOVE ER-2796                TO WS-ERROR
 17214     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17215     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17216        OR (CM-NH-INTERFACE-SW = 'Y')
 17217        MOVE ER-2793             TO WS-ERROR
 17218        PERFORM 9900-ERROR-FORMAT
 17219                                 THRU 9900-EXIT
 17220     END-IF
 17221     MOVE +0                     TO WS-PAYMENT-AMT
 17222     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 311
* EL050.cbl
 17223        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17224               PB-C-AH-CANCEL-DT
 17225           GO TO 3999-END-EDIT
 17226        END-IF
 17227     end-if
 17228***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17229***-_-
 17230***-_-   For TN it's only flat cancels
 17231***-_-
 17232***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17233     if pb-state = 'TN'
 17234        if ((pb-c-lf-cancel-dt <> low-values)
 17235           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17236                      or
 17237           ((pb-c-ah-cancel-dt <> low-values)
 17238           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17239           GO TO 3999-END-EDIT
 17240        END-IF
 17241     end-if
 17242     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17243        GO TO 3999-END-EDIT
 17244     END-IF
 17245***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17246***-_-
 17247***-_-   if cancel date within 15 days of effective date, bypass
 17248***-_-
 17249***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17250     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17251     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17252     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17253        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17254     END-IF
 17255     MOVE '1'                    TO DC-OPTION-CODE
 17256     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17257     IF NO-CONVERSION-ERROR
 17258        and pb-state = 'NH'
 17259        IF DC-ELAPSED-DAYS < +16
 17260           GO TO 3999-END-EDIT
 17261        END-IF
 17262     END-IF
 17263***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17264***-_-
 17265***-_-   if cancel date within 30 days of current date then
 17266***-_-   bypass else subtract 15 days from period
 17267***-_-
 17268***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17269     MOVE +0                     TO DC-ELAPSED-DAYS
 17270     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17271     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17272     MOVE '1'                    TO DC-OPTION-CODE
 17273     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17274     IF NO-CONVERSION-ERROR
 17275        IF DC-ELAPSED-DAYS > +30
 17276           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17277        ELSE
 17278           GO TO 3999-END-EDIT
 17279        END-IF
 17280     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 312
* EL050.cbl
 17281        GO TO 3999-END-EDIT
 17282     END-IF
 17283***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17284***-_-
 17285***-_-   'NH' is 10%, TN is 3.5%
 17286***-_-
 17287***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17288     if pb-state = 'NH'
 17289        move +1.10               to ws-work-rate
 17290     else
 17291        move +1.035              to ws-work-rate
 17292     end-if
 17293     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17294        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17295           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17296     IF WS-PAYMENT-AMT < 600.00
 17297        GO TO 3999-END-EDIT
 17298     END-IF
 17299     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17300
 17301     IF (ERMAIL-FOUND = ' ')
 17302         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17303         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17304        GO TO 3999-END-EDIT
 17305     END-IF
 17306     MOVE ER-2795                TO WS-ERROR
 17307     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17308
 17309     GO TO 3999-END-EDIT.
 17310******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 313
* EL050.cbl
 17312 3990-FILES-NOT-OPEN.
 17313
 17314     MOVE ER-2617                TO WS-ERROR.
 17315     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17316     GO TO 9990-RETURN.
 17317
 17318 3999-END-EDIT.
 17319
 17320     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17321
 17322     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17323         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17324         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17325             PERFORM 9250-UNLOCK-RETURN
 17326             GO TO 9990-RETURN
 17327          ELSE
 17328             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17329             GO TO 9990-RETURN.
 17330
 17331     IF PB-CANCELLATION
 17332          GO TO 9990-RETURN.
 17333
 17334     IF CERT-WAS-NOT-FOUND
 17335        MOVE SPACES              TO CERTIFICATE-MASTER.
 17336
 17337     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17338
 17339     IF CERT-WAS-FOUND
 17340         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17341             PERFORM 9250-UNLOCK-RETURN
 17342          ELSE
 17343            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17344      ELSE
 17345         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17346
 17347     if pb-company-id = 'VPP'
 17348        perform 8150-read-elcrtt thru 8150-exit
 17349        if ws-vehicle-odometer numeric
 17350           if ws-vehicle-odometer > 6000
 17351              move er-1583       to ws-error
 17352              PERFORM 9900-ERROR-FORMAT
 17353                                 THRU 9900-EXIT
 17354           end-if
 17355        end-if
 17356     end-if
 17357     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17358        IF ((PB-COMPANY-ID = 'DCC')
 17359           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17360                         or
 17361            (pb-company-id = 'CID' or 'VPP')
 17362            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17363        END-IF
 17364     END-IF.
 17365
 17366     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17367         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17368     END-IF.
 17369     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 314
* EL050.cbl
 17370     perform 8150-read-elcrtt    thru 8150-exit
 17371     if ws-ins-age-defaulted = 'Y'
 17372        move er-1573             to ws-error
 17373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17374     end-if
 17375
 17376     if ws-jnt-age-defaulted = 'Y'
 17377        move er-1574             to ws-error
 17378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17379     end-if
 17380***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17381***                                                           ****
 17382***  Set an error if the state requires verification of agent ****
 17383***  and agent hasn't verified yet and the status is not =    ****
 17384***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17385***  and the entry date > 09/01/2015.                         ****
 17386***                                                           ****
 17387***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17388     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17389        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17390        and (pb-account (9:2) not = 'OB')
 17391        if (ws-st-agent-sig-edit = 'Y')
 17392           and (am-report-code-1 not = 'CONLEY')
 17393           evaluate true
 17394              when cs-agent-edit-status = 'C'
 17395                 move er-1743    to ws-error
 17396                 perform 9900-error-format
 17397                                 thru 9900-exit
 17398              when cs-agent-edit-status = 'S'
 17399                 move er-1744    to ws-error
 17400                 perform 9900-error-format
 17401                                 thru 9900-exit
 17402              when cs-agent-edit-status = 'M'
 17403                 move er-1745    to ws-error
 17404                 perform 9900-error-format
 17405                                 thru 9900-exit
 17406              when cs-agent-edit-status = 'R'
 17407                 move er-1747    to ws-error
 17408                 perform 9900-error-format
 17409                                 thru 9900-exit
 17410              when cs-agent-edit-status = 'N'
 17411                 move er-1748    to ws-error
 17412                 perform 9900-error-format
 17413                                 thru 9900-exit
 17414              when cs-agent-edit-status <> 'V' and 'U' and
 17415                                           'R' and 'N'
 17416                 move er-1746    to ws-error
 17417                 perform 9900-error-format
 17418                                 thru 9900-exit
 17419           end-evaluate
 17420        end-if
 17421     end-if
 17422     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17423     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17424        AND (WS-NO-SECURE-PAY))
 17425                  OR
 17426        (WS-LF-SPECIAL-CALC-CD = 'O'
 17427        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 315
* EL050.cbl
 17428        SET SKIP-ADDR-EDIT       TO TRUE
 17429     END-IF
 17430     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17431        AND (NOT SKIP-ADDR-EDIT)
 17432        MOVE ER-2963             TO WS-ERROR
 17433        PERFORM 9900-ERROR-FORMAT
 17434                                 THRU 9900-EXIT
 17435        GO TO 9990-RETURN
 17436     END-IF
 17437     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17438     IF ERPNDM-FOUND NOT = 'X'
 17439        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17440           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17441           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17442           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17443           AND (NOT SKIP-ADDR-EDIT)
 17444           MOVE ER-2694          TO WS-ERROR
 17445           PERFORM 9900-ERROR-FORMAT
 17446                                 THRU 9900-EXIT
 17447        END-IF
 17448        MOVE ' '                 TO STATE-RECORD-ERROR
 17449        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17450        MOVE PM-STATE            TO CNTL-ACCESS
 17451        MOVE '3'                 TO CNTL-REC-TYPE
 17452        MOVE +0                  TO CNTL-SEQ-NO
 17453        MOVE '0'                 TO RC-SW-2
 17454        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17455        IF (NO-STATE-RECORD)
 17456           OR (CF-RECORD-TYPE NOT = '3')
 17457           OR (PM-STATE NOT = CF-STATE-CODE)
 17458           IF (PM-STATE = SPACES)
 17459              AND (SKIP-ADDR-EDIT)
 17460              CONTINUE
 17461           ELSE
 17462              MOVE ER-2963       TO WS-ERROR
 17463              PERFORM 9900-ERROR-FORMAT
 17464                                 THRU 9900-EXIT
 17465           END-IF
 17466        END-IF
 17467        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17468           MOVE ER-2883          TO WS-ERROR
 17469           PERFORM 9900-ERROR-FORMAT
 17470                                 THRU 9900-EXIT
 17471        END-IF
 17472        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17473           MOVE ' '                 TO STATE-RECORD-ERROR
 17474           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17475           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17476           MOVE '3'                 TO CNTL-REC-TYPE
 17477           MOVE +0                  TO CNTL-SEQ-NO
 17478           MOVE '0'                 TO RC-SW-2
 17479           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17480           IF NO-STATE-RECORD
 17481              OR (CF-RECORD-TYPE NOT = '3')
 17482              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17483              MOVE ER-2964          TO WS-ERROR
 17484              PERFORM 9900-ERROR-FORMAT
 17485                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 316
* EL050.cbl
 17486           END-IF
 17487        END-IF
 17488     ELSE
 17489        IF NOT SKIP-ADDR-EDIT
 17490           MOVE ER-2393          TO WS-ERROR
 17491           PERFORM 9900-ERROR-FORMAT
 17492                                 THRU 9900-EXIT
 17493        END-IF
 17494     END-IF
 17495
 17496     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17497
 17498     IF (ERMAIL-FOUND = ' ' AND
 17499        ERPNDM-FOUND = ' ')
 17500        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17501           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17502           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17503          OR
 17504           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17505          OR
 17506           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17507           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17508           GO TO 3999-UNLOCK-ERMAIL.
 17509
 17510     IF ERPNDM-FOUND = 'X'
 17511        GO TO 3999-UNLOCK-ERMAIL.
 17512
 17513     IF PM-INSURED-LAST-NAME      = SPACES
 17514        AND PM-INSURED-FIRST-NAME = SPACES
 17515        AND PM-ADDRESS-LINE-1     = SPACES
 17516        AND PM-ADDRESS-LINE-2     = SPACES
 17517        AND PM-CITY-STATE         = SPACES
 17518        AND PM-CRED-BENE-NAME     = SPACES
 17519        AND PM-CRED-BENE-ADDR     = SPACES
 17520        AND PM-CRED-BENE-CTYST    = SPACES
 17521        GO TO 3999-UNLOCK-ERMAIL
 17522     END-IF
 17523
 17524     MOVE SPACES                 TO MAILING-DATA.
 17525
 17526     MOVE 'MA'                   TO MA-RECORD-ID.
 17527     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17528     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17529     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17530     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17531     MOVE PB-SV-STATE            TO MA-STATE.
 17532     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17533     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17534
 17535     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17536     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17537
 17538     IF ERMAIL-FOUND = ' '
 17539        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17540     ELSE
 17541        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17542        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17543        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 317
* EL050.cbl
 17544
 17545     GO TO 9990-RETURN.
 17546
 17547 3999-UNLOCK-ERMAIL.
 17548     IF ERMAIL-FOUND = ' '
 17549        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17550
 17551     GO TO 9990-RETURN.
 17552******************************************************************
 17553
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 318
* EL050.cbl
 17555 4000-UPDATE-CANCELLED-CERT.
 17556     IF CERT-WAS-NOT-FOUND
 17557        GO TO 4299-EXIT.
 17558
 17559*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17560     IF PB-C-NH-INT-ON-REFS > ZEROS
 17561        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17562     END-IF
 17563     IF PB-C-REF-INTERFACE-SW = 'Y'
 17564        MOVE PB-C-REF-INTERFACE-SW
 17565                                 TO CM-NH-INTERFACE-SW
 17566     END-IF
 17567     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17568     IF ERMAIL-FOUND = 'X'
 17569        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17570        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17571        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17572        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17573           MOVE ER-2694          TO WS-ERROR
 17574           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17575     END-IF
 17576
 17577     IF PB-C-POST-CARD-IND = 'Y'
 17578        MOVE +8                  TO SUB
 17579*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17580        IF ERMAIL-FOUND = ' '
 17581           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17582              (SUB > +7)
 17583              OR (MA-MAIL-STATUS (SUB) = '1')
 17584           END-PERFORM
 17585        END-IF
 17586        IF (SUB > +7)
 17587           OR (ERMAIL-FOUND = 'X')
 17588           MOVE ER-3789          TO WS-ERROR
 17589           PERFORM 9900-ERROR-FORMAT
 17590                                 THRU 9900-EXIT
 17591        END-IF
 17592     ELSE
 17593        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17594     END-IF
 17595
 17596     IF ERMAIL-FOUND = ' '
 17597        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17598     END-IF.
 17599
 17600     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17601
 17602     IF PB-CI-OB-FLAG = 'Z'
 17603        GO TO 4150-SUMMARY-CERT-CANCEL.
 17604
 17605     IF PB-C-LF-CANCEL-VOIDED
 17606         PERFORM 4200-REVERSE-LF-CANCEL.
 17607     IF PB-C-AH-CANCEL-VOIDED
 17608         PERFORM 4200-REVERSE-AH-CANCEL.
 17609
 17610 4100-APPLY-LF-CANCEL.
 17611
 17612     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 319
* EL050.cbl
 17613
 17614 4100-CHECK-LF-ERRORS.
 17615
 17616     ADD +1                       TO WS-SUB.
 17617
 17618     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17619        IF LF-COVERAGE-CANCELLED
 17620           GO TO 4100-LF-CANCEL-CONT
 17621        ELSE
 17622           GO TO 4100-UPDATE-LF-COVERAGE.
 17623
 17624     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17625                                   ER-2729 OR
 17626                                   ER-2730 OR
 17627                                   ER-2731 OR
 17628                                   ER-2732 OR
 17629                                   ER-2737 OR
 17630                                   ER-2740 OR
 17631                                   ER-2743 OR
 17632                                   ER-2749 OR
 17633                                   ER-2750 OR
 17634                                   ER-2755 OR
 17635                                   ER-2757 OR
 17636                                   ER-2760 OR
 17637                                   ER-2772 OR
 17638                                   ER-2774 OR
 17639                                   ER-2776 OR
 17640                                   ER-2794
 17641        GO TO 4100-UPDATE-LF-COVERAGE.
 17642
 17643     GO TO 4100-CHECK-LF-ERRORS.
 17644
 17645 4100-UPDATE-LF-COVERAGE.
 17646
 17647     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17648     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17649     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17650        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17651     END-IF
 17652     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17653                                      TO CM-CREDIT-INTERFACE-SW-2.
 17654     IF CM-LF-CANCEL-DT = LOW-VALUE
 17655         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17656
 17657     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17658         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17659                                         CM-LF-STATUS-AT-CANCEL.
 17660
 17661     GO TO 4100-APPLY-AH-CANCEL.
 17662
 17663 4100-LF-CANCEL-CONT.
 17664     IF PB-C-LF-CANCEL-VOIDED
 17665         GO TO 4100-APPLY-AH-CANCEL.
 17666
 17667     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17668         GO TO 4100-APPLY-AH-CANCEL.
 17669
 17670     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 320
* EL050.cbl
 17671        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17672           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17673        ELSE
 17674           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17675
 17676     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17677     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17678
 17679     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17680         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17681
 17682     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17683        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17684         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17685         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17686
 17687     IF PB-RECORD-RETURNED
 17688        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17689      ELSE
 17690        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17691
 17692 4100-APPLY-AH-CANCEL.
 17693
 17694     MOVE +0                      TO WS-SUB.
 17695
 17696 4100-CHECK-AH-ERRORS.
 17697
 17698     ADD +1                       TO WS-SUB.
 17699
 17700     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17701        IF AH-COVERAGE-CANCELLED
 17702           GO TO 4100-AH-CANCEL-CONT
 17703        ELSE
 17704           GO TO 4100-UPDATE-AH-COVERAGE.
 17705
 17706     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17707                                   ER-2729 OR
 17708                                   ER-2732 OR
 17709                                   ER-2737 OR
 17710                                   ER-2740 OR
 17711                                   ER-2744 OR
 17712                                   ER-2749 OR
 17713                                   ER-2750 OR
 17714                                   ER-2755 OR
 17715                                   ER-2757 OR
 17716                                   ER-2760 OR
 17717                                   ER-2771 OR
 17718                                   ER-2772 OR
 17719                                   ER-2773 OR
 17720                                   ER-2775 OR
 17721                                   ER-2777 OR
 17722                                   ER-2778 OR
 17723                                   ER-2794
 17724        GO TO 4100-UPDATE-AH-COVERAGE.
 17725
 17726     GO TO 4100-CHECK-AH-ERRORS.
 17727
 17728 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 321
* EL050.cbl
 17729
 17730     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17731     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17732     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17733     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17734                                      TO CM-CREDIT-INTERFACE-SW-2.
 17735     IF CM-AH-CANCEL-DT = LOW-VALUE
 17736         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17737
 17738     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17739         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17740                                         CM-AH-STATUS-AT-CANCEL.
 17741
 17742     IF LF-COVERAGE-CANCELLED
 17743         IF PB-RECORD-RETURNED
 17744              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17745          ELSE
 17746              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17747
 17748     GO TO 4299-EXIT.
 17749
 17750 4100-AH-CANCEL-CONT.
 17751     IF PB-C-AH-CANCEL-VOIDED
 17752         GO TO 4299-EXIT.
 17753
 17754     if cm-credit-interface-sw-2 = ' '
 17755        if pb-fatal-errors or pb-unforced-errors
 17756           move '4'              to cm-credit-interface-sw-2
 17757        else
 17758           move '1'              to cm-credit-interface-sw-2
 17759        end-if
 17760     end-if
 17761     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17762         GO TO 4299-EXIT.
 17763
 17764     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17765        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17766           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17767        ELSE
 17768           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17769
 17770     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17771     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17772
 17773     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17774         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17775
 17776     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17777         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17778         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17779
 17780     IF PB-RECORD-RETURNED
 17781        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17782      ELSE
 17783        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17784
 17785     GO TO 4299-EXIT.
 17786
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 322
* EL050.cbl
 17787 4150-SUMMARY-CERT-CANCEL.
 17788     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17789
 17790     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17791        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17792                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17793     ELSE
 17794        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17795                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17796
 17797     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17798        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17799                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17800     ELSE
 17801        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17802                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17803
 17804     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17805        NEXT SENTENCE
 17806     ELSE
 17807        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17808
 17809     GO TO 4299-EXIT.
 17810
 17811 4200-REVERSE-LF-CANCEL.
 17812     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17813
 17814     IF CM-LF-CANCEL-APPLIED
 17815        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17816        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17817        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17818
 17819     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17820
 17821     IF PB-RECORD-RETURNED
 17822        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17823       ELSE
 17824        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17825
 17826 4200-REVERSE-LF-EXIT.
 17827       EXIT.
 17828
 17829 4200-REVERSE-AH-CANCEL.
 17830     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17831
 17832     IF CM-AH-CANCEL-APPLIED
 17833        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17834        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17835        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17836
 17837     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17838
 17839     IF PB-RECORD-RETURNED
 17840        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17841       ELSE
 17842        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17843
 17844 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 323
* EL050.cbl
 17845       EXIT.
 17846
 17847 4299-EXIT.
 17848       EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 324
* EL050.cbl
 17850
 17851 4500-UPDATE-NEW-CERT.
 17852     IF CERT-WAS-FOUND
 17853         NEXT SENTENCE
 17854       ELSE
 17855         GO TO 4520-BUILD-NEW-KEY.
 17856
 17857     IF  CLASIC-CREATED-CERT
 17858         GO TO 4999-EXIT.
 17859
 17860     IF  CERT-WAS-CREATED-FOR-CLAIM
 17861         GO TO 4520-BUILD-NEW-KEY.
 17862
 17863     IF CERT-ADDED-BATCH
 17864        IF CM-RECORD-ID = 'CM'
 17865            GO TO 4999-EXIT.
 17866
 17867 4520-BUILD-NEW-KEY.
 17868* BUILD CONTROL PRIMARY
 17869
 17870     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17871                                       CM-COMPANY-CD-A1
 17872                                       CM-COMPANY-CD-A2
 17873                                       CM-COMPANY-CD-A4
 17874                                       CM-COMPANY-CD-A5.
 17875
 17876     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17877     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17878     MOVE PB-SV-STATE               TO CM-STATE.
 17879     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17880     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17881     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17882     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17883
 17884     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17885
 17886     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17887     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17888     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17889     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17890
 17891     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17892        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17893
 17894     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17895         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17896         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17897         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17898         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17899     ELSE
 17900         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17901
 17902     IF PB-COMPANY-ID   EQUAL  'CRI'
 17903         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17904         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17905         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17906         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17907         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 325
* EL050.cbl
 17908
 17909     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17910        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17911         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17912
 17913     IF PB-COMPANY-ID  = 'LBL'
 17914        IF PB-I-JOINT-COVERAGE
 17915            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17916                                           PB-I-MEMBER-NO
 17917            GO TO 4550-CONT-CERT-PROCESS.
 17918
 17919     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17920        NEXT SENTENCE
 17921     ELSE
 17922        GO TO 4540-BUILD-MEMBER-NO.
 17923
 17924******************************************************************
 17925*                                                                *
 17926*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17927*    FOR 'MON'.                                                  *
 17928*                                                                *
 17929******************************************************************
 17930
 17931     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17932     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17933     MOVE +1                     TO WS-SUB1
 17934                                    WS-SUB2.
 17935
 17936 4530-EDIT-MEMB-NAME.
 17937
 17938     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17939        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17940        ADD +1                       TO WS-SUB2.
 17941
 17942     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17943        ADD +1                       TO WS-SUB1
 17944        GO TO 4530-EDIT-MEMB-NAME.
 17945
 17946     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17947     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17948     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17949*    MOVE SPACE                      TO DC-OPTION-CODE.
 17950     SET  BIN-TO-GREG                TO TRUE.
 17951     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17952     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17953
 17954     GO TO 4550-CONT-CERT-PROCESS.
 17955
 17956******************************************************************
 17957*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17958******************************************************************
 17959
 17960 4540-BUILD-MEMBER-NO.
 17961
 17962     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17963         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17964         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17965         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 326
* EL050.cbl
 17966         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17967     ELSE
 17968         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17969
 17970     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17971        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17972         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17973
 17974 4550-CONT-CERT-PROCESS.
 17975
 17976*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17977*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17978*    ELSE
 17979*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17980
 17981     IF CERT-WAS-CREATED-FOR-CLAIM
 17982        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17983        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17984
 17985     IF CERT-AND-CLAIM-ONLINE
 17986        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17987        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17988
 17989     MOVE 'CM'                     TO CM-RECORD-ID.
 17990     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17991
 17992     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17993        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17994        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17995     ELSE
 17996        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17997        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17998
 17999     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18000     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18001     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18002     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18003     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18004     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18005     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18006                                      CM-LF-ITD-CANCEL-AMT
 18007                                      CM-LF-ITD-DEATH-AMT
 18008                                      CM-AH-ITD-AH-PMT
 18009                                      CM-AH-ITD-LUMP-PMT
 18010                                      CM-AH-ITD-CANCEL-AMT
 18011                                      CM-LF-NSP-PREMIUM-AMT
 18012                                      CM-AH-NSP-PREMIUM-AMT.
 18013*                                     CM-CLAIM-DEDUCT-WITHHELD
 18014*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18015     if pb-i-loan-apr = +99.9999
 18016        move zeros                 to cm-loan-apr
 18017     else
 18018        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18019     end-if
 18020     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18021     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18022     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18023     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 327
* EL050.cbl
 18024     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18025     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18026     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18027     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18028     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18029     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18030     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18031
 18032     IF PB-I-LIVES NOT NUMERIC
 18033         MOVE ZERO                 TO PB-I-LIVES.
 18034
 18035     IF PB-I-NUM-BILLED NOT NUMERIC
 18036         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18037
 18038     MOVE PB-I-LIVES               TO CM-LIVES.
 18039     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18040
 18041     IF PB-COMPANY-ID EQUAL  'DMD'
 18042         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18043         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18044
 18045     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18046     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18047     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18048     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18049     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18050     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18051
 18052     IF PB-I-LF-POLICY-FEE NUMERIC
 18053        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18054     ELSE
 18055        MOVE +0                    TO CM-LF-POLICY-FEE.
 18056
 18057     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18058        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18059        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18060     ELSE
 18061        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18062
 18063     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18064     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18065     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18066     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18067     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18068     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18069     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18070     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18071     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18072
 18073     IF PB-I-CANCEL-FEE NUMERIC
 18074        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18075     ELSE
 18076        MOVE +0                  TO CM-CANCEL-FEE
 18077     END-IF
 18078
 18079     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18080        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18081     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 328
* EL050.cbl
 18082        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18083
 18084     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18085     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18086
 18087     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18088                                      CM-LF-DEATH-EXIT-DT
 18089                                      CM-AH-SETTLEMENT-EXIT-DT.
 18090
 18091*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18092*                       'TIH' OR 'OFL' OR 'FLA' OR
 18093*                       'TII' OR 'TMS' OR 'CRI' OR
 18094*                       'NCL'
 18095     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18096
 18097     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18098         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18099            MOVE '2'                TO CM-PREMIUM-TYPE.
 18100
 18101     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18102         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18103            MOVE '2'                TO CM-PREMIUM-TYPE.
 18104
 18105     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18106         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18107     ELSE
 18108         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18109         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18110
 18111     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18112     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18113     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18114     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18115     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18116     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18117     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18118     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18119
 18120     IF PB-NO-MONTHS-SKIPPED
 18121         MOVE SPACE                 TO CM-SKIP-CODE
 18122     ELSE
 18123         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18124
 18125     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18126     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18127                                       CM-LF-STATUS-AT-CANCEL.
 18128
 18129     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18130     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18131                                       CM-AH-STATUS-AT-CANCEL.
 18132
 18133     MOVE '1'                       TO CM-ENTRY-STATUS.
 18134
 18135     IF PB-REISSUED-CERT
 18136        MOVE '5'                    TO CM-ENTRY-STATUS.
 18137
 18138     IF PB-MONTHLY-CERT
 18139        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 329
* EL050.cbl
 18140
 18141     IF PB-CASH-CERT
 18142        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18143
 18144     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18145     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18146     IF PB-POLICY-IS-DECLINED
 18147        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18148
 18149     IF PB-POLICY-IS-VOIDED
 18150        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18151
 18152     IF PB-NEEDS-UNDERWRITING
 18153        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18154
 18155     IF PB-REIN-ONLY-CERT
 18156        MOVE '9'                    TO CM-ENTRY-STATUS.
 18157
 18158     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18159         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18160     ELSE
 18161         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18162
 18163     IF PB-RECORD-RETURNED
 18164        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18165      ELSE
 18166        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18167
 18168     IF PB-I-MAIL-ADDRS-PRESENT
 18169        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18170
 18171     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18172                                       CM-ENTRY-DT.
 18173
 18174 4999-EXIT.
 18175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 330
* EL050.cbl
 18177
 18178 5000-PROCESS-REPS.
 18179     MOVE ' '                    TO AGTC-MASTER-SW
 18180     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18181     MOVE CO-TYPE                TO AGTC-TYPE
 18182     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18183     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18184     IF (AGTC-MASTER-SW NOT = 'N')
 18185        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18186        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18187        PERFORM 8583-READ-ERAGTC-NEXT
 18188                                 THRU 8583-EXIT
 18189     END-IF
 18190     IF AGTC-MASTER-SW = 'N'
 18191        CONTINUE
 18192     ELSE
 18193        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18194           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18195              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18196              MOVE 'Y'           TO AGTC-MASTER-SW
 18197           END-IF
 18198        END-IF
 18199     END-IF
 18200     .
 18201 5000-EXIT.
 18202     EXIT.
 18203 6370-EDIT-INPUT-LF-CODE.
 18204     move ' ' to ws-benefit-cd-chg-sw
 18205     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18206        MOVE +1                  TO SUB
 18207        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18208        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18209        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18210        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18211        GO TO 6370-SEARCH-LOOP.
 18212
 18213     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18214
 18215     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18216     MOVE SPACES                 TO CNTL-ACCESS.
 18217*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18218     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18219     MOVE +0                     TO CNTL-SEQ-NO.
 18220     MOVE '4' TO RC-SW-2.
 18221     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18222
 18223     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18224        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18225        GO TO 6370-NO-LF-FOUND.
 18226
 18227     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18228     MOVE +1                     TO SUB.
 18229
 18230 6370-SEARCH-LOOP.
 18231     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18232         GO TO 6370-NO-LF-FOUND.
 18233
 18234     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 331
* EL050.cbl
 18235        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18236           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18237           set benefit-code-chg to true
 18238        end-if
 18239        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18240        GO TO 6370-HER-NET-PAY-CHECK.
 18241
 18242     ADD 1   TO SUB.
 18243*    IF SUB GREATER 120
 18244     IF SUB GREATER 200
 18245         GO TO 6370-NO-LF-FOUND.
 18246
 18247     GO TO 6370-SEARCH-LOOP.
 18248
 18249 6370-NO-LF-FOUND.
 18250
 18251     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18252        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18253        set benefit-code-chg to true
 18254     end-if
 18255     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18256
 18257 6370-HER-NET-PAY-CHECK.
 18258
 18259     IF PB-COMPANY-ID = 'CID'
 18260        IF PB-SV-STATE = 'CA' OR 'MN'
 18261           IF PB-I-LF-BENEFIT-CD = '02'
 18262              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18263           ELSE
 18264              IF PB-I-LF-BENEFIT-CD = '04'
 18265                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18266              END-IF
 18267           END-IF
 18268        END-IF
 18269     END-IF
 18270
 18271     IF PB-COMPANY-ID NOT = 'HER'
 18272         GO TO 6370-EXIT.
 18273
 18274     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18275         GO TO 6370-EXIT.
 18276
 18277     IF PB-I-LF-TERM NOT NUMERIC
 18278         MOVE ZEROS              TO PB-I-LF-TERM.
 18279
 18280     IF PB-I-LOAN-TERM NOT NUMERIC
 18281         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18282
 18283     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18284         GO TO 6370-EXIT.
 18285
 18286     IF PB-I-LF-BENEFIT-CD = '33'
 18287         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18288
 18289     IF PB-I-LF-BENEFIT-CD = '34'
 18290         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18291
 18292 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 332
* EL050.cbl
 18293     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 333
* EL050.cbl
 18295
 18296 6380-EDIT-INPUT-AH-CODE.
 18297     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18298        MOVE +1                  TO SUB
 18299        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18300        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18301        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18302        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18303        GO TO 6380-SEARCH-LOOP.
 18304
 18305     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18306
 18307     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18308     MOVE SPACES                 TO CNTL-ACCESS.
 18309     MOVE 'A'                    TO CNTL-REC-TYPE.
 18310*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18311     MOVE +0                     TO CNTL-SEQ-NO.
 18312     MOVE '5' TO RC-SW-2.
 18313     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18314
 18315     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18316        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18317        GO TO 6380-NO-AH-FOUND.
 18318
 18319     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18320     MOVE +1 TO SUB.
 18321
 18322 6380-SEARCH-LOOP.
 18323     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18324         GO TO 6380-NO-AH-FOUND.
 18325
 18326     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18327         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18328         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18329
 18330     ADD 1   TO SUB.
 18331     IF SUB GREATER THAN 96
 18332*    IF SUB GREATER THAN 300
 18333         GO TO 6380-NO-AH-FOUND.
 18334
 18335     GO TO 6380-SEARCH-LOOP.
 18336
 18337 6380-NO-AH-FOUND.
 18338
 18339     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18340
 18341     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18342         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18343     ELSE
 18344         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18345
 18346 6380-CSO-AH-ONLY-CHECKS.
 18347
 18348     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18349        NEXT SENTENCE
 18350      ELSE
 18351        GO TO 6380-EXIT.
 18352
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 334
* EL050.cbl
 18353     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18354         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18355
 18356
 18357     GO TO 6380-EXIT
 18358     .
 18359 6380-CSO-LIFE-WITH-AH-CHECKS.
 18360
 18361
 18362     .
 18363 6380-EXIT.
 18364     EXIT.
 18365
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 335
* EL050.cbl
 18367
 18368 6400-COMPUTE-EXTENSION-DAYS.
 18369
 18370******************************************************************
 18371*                                                                *
 18372*                   COMPUTE EXTENSION DAYS                       *
 18373*                                                                *
 18374*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18375*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18376*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18377*    THE EXTENSION DAYS.                                         *
 18378*                                                                *
 18379******************************************************************
 18380
 18381     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18382     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18383
 18384******************************************************************
 18385*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18386*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18387******************************************************************
 18388
 18389     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18390        COMPUTE WS-ODD-DAYS-OVER =
 18391               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18392     ELSE
 18393        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18394
 18395     IF WS-ODD-DAYS-OVER = ZEROS
 18396           GO TO 6499-EXIT
 18397     ELSE
 18398        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18399           IF WS-WDF-MONTH = 02
 18400              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18401              ADD 2       TO  WS-ODD-DAYS-OVER
 18402              GO TO 6499-EXIT
 18403           ELSE
 18404              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18405                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18406                 GO TO 6499-EXIT
 18407               ELSE
 18408                 GO TO 6499-EXIT
 18409        ELSE
 18410           GO TO 6499-EXIT.
 18411
 18412 6412-CHECK-TO-DAY.
 18413
 18414        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18415           IF WS-WDT-DAY = 28
 18416              ADD 2              TO WS-ODD-DAYS-OVER
 18417           ELSE
 18418              IF WS-WDT-DAY = 29
 18419                 ADD 1           TO WS-ODD-DAYS-OVER
 18420              ELSE
 18421                 NEXT SENTENCE
 18422        ELSE
 18423           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18424              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 336
* EL050.cbl
 18425
 18426     GO TO 6499-EXIT.
 18427
 18428
 18429 6415-CHECK-LEAP-YEAR.
 18430
 18431     IF DC-DAYS-IN-MONTH = 29
 18432        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18433
 18434 6415-EXIT.
 18435     EXIT.
 18436
 18437 6499-EXIT.
 18438      EXIT.
 18439
 18440 6500-END.
 18441     EXIT.
 18442
 18443
 18444******************************************************************
 18445************* PROCEDURE DIVISION FOR EL050 ***********************
 18446********************** ELC50PD END *******************************
 18447
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 337
* EL050.cbl
 18449
 18450**START***********************************************************
 18451*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18452*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18453******************************************************************
 18454*
 18455 6600-GET-STATE-MUNICIPAL-TAX.
 18456
 18457     IF PB-COMPANY-ID NOT = 'DMD'
 18458         GO TO 6640-EXIT.
 18459
 18460     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18461     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18462     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18463*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18464*
 18465***  Y2K PROJ 7744
 18466     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18467     SET BIN-TO-GREG          TO TRUE.
 18468     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18469
 18470     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18471
 18472     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18473     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18474
 18475
 18476* EXEC CICS HANDLE CONDITION
 18477*        INVREQ    (6610-START-BROWSE)
 18478*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18479*        NOTFND    (6630-END-OF-FILE)
 18480*    END-EXEC.
 18481*    MOVE '"$8JI                 ! # #00018463' TO DFHEIV0
 18482     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18484     MOVE X'2320233030303138343633' TO DFHEIV0(25:11)
 18485     CALL 'kxdfhei1' USING DFHEIV0
 18486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18487
 18488
 18489 6610-START-BROWSE.
 18490
 18491
 18492* EXEC CICS HANDLE CONDITION
 18493*        NOTFND    (6630-END-OF-FILE)
 18494*        DISABLED  (6630-ERRESS-PROBLEM)
 18495*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18496*        ENDFILE   (6630-END-OF-FILE)
 18497*    END-EXEC.
 18498*    MOVE '"$IcJ''                ! $ #00018471' TO DFHEIV0
 18499     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18501     MOVE X'2420233030303138343731' TO DFHEIV0(25:11)
 18502     CALL 'kxdfhei1' USING DFHEIV0
 18503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18504
 18505
 18506
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 338
* EL050.cbl
 18507* EXEC CICS STARTBR
 18508*        DATASET (FILE-ID-ERRESS)
 18509*        RIDFLD  (WS-ERRESS-KEY)
 18510*        GTEQ
 18511*    END-EXEC.
 18512     MOVE 0
 18513       TO DFHEIV11
 18514*    MOVE '&,         G          &   #00018478' TO DFHEIV0
 18515     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18517     MOVE X'2020233030303138343738' TO DFHEIV0(25:11)
 18518     CALL 'kxdfhei1' USING DFHEIV0,
 18519           FILE-ID-ERRESS,
 18520           WS-ERRESS-KEY,
 18521           DFHEIV99,
 18522           DFHEIV11,
 18523           DFHEIV99
 18524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18525
 18526
 18527 6620-READ-NEXT-ERRESS-MASTER.
 18528
 18529
 18530* EXEC CICS HANDLE CONDITION
 18531*        NOTFND    (6630-END-OF-FILE)
 18532*        ENDFILE   (6630-END-OF-FILE)
 18533*        DISABLED  (6630-ERRESS-PROBLEM)
 18534*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18535*    END-EXEC.
 18536*    MOVE '"$I''cJ                ! % #00018486' TO DFHEIV0
 18537     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18539     MOVE X'2520233030303138343836' TO DFHEIV0(25:11)
 18540     CALL 'kxdfhei1' USING DFHEIV0
 18541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18542
 18543
 18544
 18545* EXEC CICS READNEXT
 18546*        DATASET (FILE-ID-ERRESS)
 18547*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18548*        RIDFLD  (WS-ERRESS-KEY)
 18549*    END-EXEC.
 18550     MOVE LENGTH OF
 18551      RESIDENT-STATE-TAX-MASTER
 18552       TO DFHEIV12
 18553     MOVE 0
 18554       TO DFHEIV11
 18555*    MOVE '&.IL                  )   #00018493' TO DFHEIV0
 18556     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18557     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18558     MOVE X'2020233030303138343933' TO DFHEIV0(25:11)
 18559     CALL 'kxdfhei1' USING DFHEIV0,
 18560           FILE-ID-ERRESS,
 18561           RESIDENT-STATE-TAX-MASTER,
 18562           DFHEIV12,
 18563           WS-ERRESS-KEY,
 18564           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 339
* EL050.cbl
 18565           DFHEIV11,
 18566           DFHEIV99,
 18567           DFHEIV99
 18568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18569
 18570
 18571     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18572
 18573* EXEC CICS ENDBR
 18574*            DATASET (FILE-ID-ERRESS)
 18575*       END-EXEC
 18576     MOVE 0
 18577       TO DFHEIV11
 18578*    MOVE '&2                    $   #00018500' TO DFHEIV0
 18579     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18580     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18581     MOVE X'2020233030303138353030' TO DFHEIV0(25:11)
 18582     CALL 'kxdfhei1' USING DFHEIV0,
 18583           FILE-ID-ERRESS,
 18584           DFHEIV11,
 18585           DFHEIV99
 18586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18587        GO TO 6630-END-OF-FILE.
 18588
 18589     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18590        NEXT SENTENCE
 18591      ELSE
 18592        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18593
 18594*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18595*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18596*
 18597     MOVE +2                     TO WS-SUB1.
 18598
 18599     IF PB-ISSUE
 18600     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18601        MOVE +1                  TO WS-SUB1.
 18602
 18603     IF PB-CANCELLATION
 18604     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18605        MOVE +1                  TO WS-SUB1.
 18606*
 18607*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18608*
 18609***  Y2K PROJ 7744
 18610     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18611***  Y2K PROJ 7744
 18612
 18613*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18614* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18615* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18616
 18617     ADD 1                    TO WS-YEAR-YY.
 18618
 18619     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18620         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18621                              TO WS-RES-STATE-TAX
 18622         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 340
* EL050.cbl
 18623                              TO WS-RES-MUNI-TAX
 18624     ELSE
 18625         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18626                              TO WS-RES-STATE-TAX
 18627         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18628                              TO WS-RES-MUNI-TAX.
 18629
 18630*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18631
 18632     IF PB-CANCELLATION
 18633         GO TO 6640-CANCEL-TAX.
 18634
 18635     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18636         COMPUTE PB-I-STATE-TAX ROUNDED =
 18637                                   PB-I-LF-PREMIUM-AMT
 18638                                 * WS-RES-STATE-TAX
 18639         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18640                                   PB-I-LF-PREMIUM-AMT
 18641                                 * WS-RES-MUNI-TAX
 18642     ELSE
 18643     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18644         COMPUTE PB-I-STATE-TAX ROUNDED =
 18645                                   PB-I-AH-PREMIUM-AMT
 18646                                 * WS-RES-STATE-TAX
 18647         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18648                                   PB-I-AH-PREMIUM-AMT
 18649                                 * WS-RES-MUNI-TAX.
 18650
 18651
 18652* EXEC CICS ENDBR
 18653*         DATASET (FILE-ID-ERRESS)
 18654*    END-EXEC.
 18655     MOVE 0
 18656       TO DFHEIV11
 18657*    MOVE '&2                    $   #00018567' TO DFHEIV0
 18658     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18659     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18660     MOVE X'2020233030303138353637' TO DFHEIV0(25:11)
 18661     CALL 'kxdfhei1' USING DFHEIV0,
 18662           FILE-ID-ERRESS,
 18663           DFHEIV11,
 18664           DFHEIV99
 18665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18666
 18667
 18668     GO TO 6640-EXIT.
 18669
 18670 6640-CANCEL-TAX.
 18671     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18672
 18673     IF PB-C-LF-CANCEL-AMT > ZEROS
 18674         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18675                                   PB-C-LF-CANCEL-AMT
 18676                                 * WS-RES-STATE-TAX
 18677         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18678                                   PB-C-LF-CANCEL-AMT
 18679                                *  WS-RES-MUNI-TAX
 18680     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 341
* EL050.cbl
 18681     IF PB-C-AH-CANCEL-AMT > ZEROS
 18682         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18683                                   PB-C-AH-CANCEL-AMT
 18684                                 * WS-RES-STATE-TAX
 18685         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18686                                   PB-C-AH-CANCEL-AMT
 18687                                *  WS-RES-MUNI-TAX.
 18688
 18689
 18690* EXEC CICS ENDBR
 18691*         DATASET (FILE-ID-ERRESS)
 18692*    END-EXEC.
 18693     MOVE 0
 18694       TO DFHEIV11
 18695*    MOVE '&2                    $   #00018592' TO DFHEIV0
 18696     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18697     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18698     MOVE X'2020233030303138353932' TO DFHEIV0(25:11)
 18699     CALL 'kxdfhei1' USING DFHEIV0,
 18700           FILE-ID-ERRESS,
 18701           DFHEIV11,
 18702           DFHEIV99
 18703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18704
 18705
 18706     GO TO 6640-EXIT.
 18707
 18708 6630-END-OF-FILE.
 18709     MOVE ER-8002              TO WS-ERROR.
 18710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18711
 18712     GO TO 6640-EXIT.
 18713
 18714 6630-ERRESS-PROBLEM.
 18715     MOVE ER-8044              TO WS-ERROR.
 18716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18717
 18718 6640-EXIT.
 18719     EXIT.
 18720
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 342
* EL050.cbl
 18722 6650-GET-RES-STATE-COMM.
 18723
 18724     IF PB-COMPANY-ID NOT = 'DMD'
 18725         GO TO 6700-COMM-EXIT.
 18726
 18727     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18728     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18729     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18730     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18731     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18732     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18733     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18734
 18735*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18736*
 18737***  Y2K PROJ 7744
 18738     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18739     SET BIN-TO-GREG          TO TRUE.
 18740     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18741
 18742     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18743***  Y2K PROJ 7744
 18744
 18745     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18746
 18747
 18748* EXEC CICS HANDLE CONDITION
 18749*        INVREQ    (6660-START-BROWSE)
 18750*        DISABLED  (6690-ERRESC-PROBLEM)
 18751*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18752*        NOTFND    (6690-END-OF-FILE)
 18753*    END-EXEC.
 18754*    MOVE '"$8cJI                ! & #00018637' TO DFHEIV0
 18755     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18757     MOVE X'2620233030303138363337' TO DFHEIV0(25:11)
 18758     CALL 'kxdfhei1' USING DFHEIV0
 18759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18760
 18761
 18762
 18763* EXEC CICS RESETBR
 18764*        DATASET (FILE-ID-ERRESC)
 18765*        RIDFLD  (WS-ERRESC-KEY)
 18766*    END-EXEC.
 18767     MOVE 0
 18768       TO DFHEIV11
 18769*    MOVE '&4         G          &   #00018644' TO DFHEIV0
 18770     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18771     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18772     MOVE X'2020233030303138363434' TO DFHEIV0(25:11)
 18773     CALL 'kxdfhei1' USING DFHEIV0,
 18774           FILE-ID-ERRESC,
 18775           WS-ERRESC-KEY,
 18776           DFHEIV99,
 18777           DFHEIV11,
 18778           DFHEIV99
 18779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 343
* EL050.cbl
 18780
 18781
 18782 6660-START-BROWSE.
 18783
 18784
 18785* EXEC CICS HANDLE CONDITION
 18786*        NOTFND    (6690-END-OF-FILE)
 18787*        DISABLED  (6690-ERRESC-PROBLEM)
 18788*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18789*        ENDFILE   (6690-END-OF-FILE)
 18790*    END-EXEC.
 18791*    MOVE '"$IcJ''                ! '' #00018651' TO DFHEIV0
 18792     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18794     MOVE X'2720233030303138363531' TO DFHEIV0(25:11)
 18795     CALL 'kxdfhei1' USING DFHEIV0
 18796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18797
 18798
 18799
 18800* EXEC CICS STARTBR
 18801*        DATASET (FILE-ID-ERRESC)
 18802*        RIDFLD  (WS-ERRESC-KEY)
 18803*        GTEQ
 18804*    END-EXEC.
 18805     MOVE 0
 18806       TO DFHEIV11
 18807*    MOVE '&,         G          &   #00018658' TO DFHEIV0
 18808     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18809     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18810     MOVE X'2020233030303138363538' TO DFHEIV0(25:11)
 18811     CALL 'kxdfhei1' USING DFHEIV0,
 18812           FILE-ID-ERRESC,
 18813           WS-ERRESC-KEY,
 18814           DFHEIV99,
 18815           DFHEIV11,
 18816           DFHEIV99
 18817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18818
 18819
 18820     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18821
 18822 6670-READ-NEXT-ERRESC-MASTER.
 18823
 18824
 18825* EXEC CICS HANDLE CONDITION
 18826*        NOTFND    (6690-END-OF-FILE)
 18827*        DISABLED  (6690-ERRESC-PROBLEM)
 18828*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18829*        ENDFILE   (6690-END-OF-FILE)
 18830*    END-EXEC.
 18831*    MOVE '"$IcJ''                ! ( #00018668' TO DFHEIV0
 18832     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18834     MOVE X'2820233030303138363638' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0
 18836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18837
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 344
* EL050.cbl
 18838
 18839
 18840* EXEC CICS READNEXT
 18841*        DATASET (FILE-ID-ERRESC)
 18842*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18843*        RIDFLD  (ERRESC-RECORD-KEY)
 18844*    END-EXEC.
 18845     MOVE LENGTH OF
 18846      ACCOUNT-RESIDENT-ST-COMMISSION
 18847       TO DFHEIV12
 18848     MOVE 0
 18849       TO DFHEIV11
 18850*    MOVE '&.IL                  )   #00018675' TO DFHEIV0
 18851     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18852     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18853     MOVE X'2020233030303138363735' TO DFHEIV0(25:11)
 18854     CALL 'kxdfhei1' USING DFHEIV0,
 18855           FILE-ID-ERRESC,
 18856           ACCOUNT-RESIDENT-ST-COMMISSION,
 18857           DFHEIV12,
 18858           ERRESC-RECORD-KEY,
 18859           DFHEIV99,
 18860           DFHEIV11,
 18861           DFHEIV99,
 18862           DFHEIV99
 18863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18864
 18865
 18866     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18867        NEXT SENTENCE
 18868     ELSE
 18869
 18870* EXEC CICS ENDBR
 18871*            DATASET (FILE-ID-ERRESC)
 18872*       END-EXEC
 18873     MOVE 0
 18874       TO DFHEIV11
 18875*    MOVE '&2                    $   #00018684' TO DFHEIV0
 18876     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18878     MOVE X'2020233030303138363834' TO DFHEIV0(25:11)
 18879     CALL 'kxdfhei1' USING DFHEIV0,
 18880           FILE-ID-ERRESC,
 18881           DFHEIV11,
 18882           DFHEIV99
 18883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18884        GO TO 6690-END-OF-FILE.
 18885
 18886     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18887
 18888* EXEC CICS ENDBR
 18889*            DATASET (FILE-ID-ERRESC)
 18890*       END-EXEC
 18891     MOVE 0
 18892       TO DFHEIV11
 18893*    MOVE '&2                    $   #00018690' TO DFHEIV0
 18894     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18895     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 345
* EL050.cbl
 18896     MOVE X'2020233030303138363930' TO DFHEIV0(25:11)
 18897     CALL 'kxdfhei1' USING DFHEIV0,
 18898           FILE-ID-ERRESC,
 18899           DFHEIV11,
 18900           DFHEIV99
 18901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18902        GO TO 6690-END-OF-FILE.
 18903
 18904     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18905        NEXT SENTENCE
 18906      ELSE
 18907        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18908
 18909* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18910*
 18911     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18912
 18913     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18914
 18915     IF WS-SUB1 > ZERO
 18916         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18917             PERFORM 6680-SET-COMMISSION
 18918         ELSE
 18919             PERFORM 6680-SET-TABLE-CODE.
 18920
 18921
 18922* EXEC CICS ENDBR
 18923*         DATASET (FILE-ID-ERRESC)
 18924*    END-EXEC.
 18925     MOVE 0
 18926       TO DFHEIV11
 18927*    MOVE '&2                    $   #00018712' TO DFHEIV0
 18928     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18929     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18930     MOVE X'2020233030303138373132' TO DFHEIV0(25:11)
 18931     CALL 'kxdfhei1' USING DFHEIV0,
 18932           FILE-ID-ERRESC,
 18933           DFHEIV11,
 18934           DFHEIV99
 18935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18936
 18937
 18938     GO TO 6700-COMM-EXIT.
 18939
 18940 6680-SET-TABLE-CODE.
 18941     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18942        MOVE ZEROS             TO WS-SUB1
 18943     ELSE
 18944* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18945* TO COMPUTE AH COMMISSION.
 18946        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18947        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18948        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18949        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18950        PERFORM 6680-READ-CTBL-TABLE
 18951        IF WS-CTBL-READ-SW NOT = 'Y'
 18952           MOVE ZEROS          TO WS-SUB1.
 18953
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 346
* EL050.cbl
 18954 6680-READ-CTBL-TABLE.
 18955*
 18956* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18957* TO COMPUTE LIFE COMMISSION
 18958
 18959     IF CTBL-SW = '0540'
 18960        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18961        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18962        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18963
 18964     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18965
 18966     IF CTBL-TABLE-FOUND
 18967        IF CTBL-SW = '0530'
 18968             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18969                                    * PB-I-AH-TERM
 18970             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18971             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18972        ELSE
 18973             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18974             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18975             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18976     ELSE
 18977        IF FIRST-TIME-THROUGH
 18978            GO TO 6680-READ-CTBL-TABLE
 18979        ELSE
 18980            MOVE ZEROS         TO WS-SUB1.
 18981
 18982 6680-SET-COMMISSION.
 18983     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18984           MOVE ZEROS          TO WS-SUB1
 18985       ELSE
 18986           MOVE RESC-COMMISSION-PER (WS-SUB)
 18987                               TO WS-COMMISSION
 18988           IF CTBL-SW = '0530'
 18989               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18990           ELSE
 18991               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18992
 18993 6680-SEARCH-CATEGORY.
 18994     ADD +1                   TO WS-SUB.
 18995     IF WS-SUB > +12
 18996         GO TO 6680-EXIT.
 18997
 18998     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18999          MOVE WS-SUB         TO WS-SUB1
 19000          GO TO 6680-EXIT.
 19001
 19002     GO TO 6680-SEARCH-CATEGORY.
 19003
 19004 6680-EXIT.
 19005     EXIT.
 19006
 19007 6690-END-OF-FILE.
 19008     GO TO 6700-COMM-EXIT.
 19009
 19010 6690-ERRESC-PROBLEM.
 19011      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 347
* EL050.cbl
 19012      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19013
 19014      GO TO 6700-COMM-EXIT.
 19015
 19016 6700-COMM-EXIT.
 19017     EXIT.
 19018
 19019 7000-GET-RATE.
 19020
 19021* EXEC CICS LINK
 19022*        PROGRAM    ('ELRATE')
 19023*        COMMAREA   (CALCULATION-PASS-AREA)
 19024*        LENGTH     (CP-COMM-LENGTH)
 19025*    END-EXEC.
 19026     MOVE 'ELRATE' TO DFHEIV1
 19027*    MOVE '."C                   (   #00018798' TO DFHEIV0
 19028     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19030     MOVE X'2020233030303138373938' TO DFHEIV0(25:11)
 19031     CALL 'kxdfhei1' USING DFHEIV0,
 19032           DFHEIV1,
 19033           CALCULATION-PASS-AREA,
 19034           CP-COMM-LENGTH,
 19035           DFHEIV99,
 19036           DFHEIV99,
 19037           DFHEIV99,
 19038           DFHEIV99
 19039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19040
 19041
 19042 7000-EXIT.
 19043     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 348
* EL050.cbl
 19045 7100-FIND-BENEFIT-IN-STATE.
 19046     MOVE 'N'                    TO BEN-SEARCH-SW.
 19047
 19048     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19049         VARYING SUB3 FROM 1 BY 1 UNTIL
 19050            ((SUB3 GREATER 50) OR
 19051              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19052               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19053
 19054     IF SUB3 NOT = 51
 19055         MOVE 'Y'                TO BEN-SEARCH-SW.
 19056
 19057     GO TO 7199-EXIT.
 19058
 19059 7100-BENEFIT-DUMMY.
 19060
 19061 7100-DUMMY-EXIT.
 19062     EXIT.
 19063
 19064 7199-EXIT.
 19065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 349
* EL050.cbl
 19067 7200-FIND-BENEFIT.
 19068     MOVE 'N'                    TO BEN-SEARCH-SW.
 19069
 19070     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19071         VARYING SUB3 FROM 1 BY 1 UNTIL
 19072            ((SUB3 GREATER 8) OR
 19073            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19074
 19075     IF SUB3 NOT = 9
 19076         MOVE 'Y'                TO BEN-SEARCH-SW.
 19077
 19078     GO TO 7200-EXIT.
 19079
 19080 7200-BENEFIT-DUMMY.
 19081
 19082 7200-DUMMY-EXIT.
 19083     EXIT.
 19084
 19085 7200-EXIT.
 19086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 350
* EL050.cbl
 19088 7250-LOOK-FOR-RESCINDED-CLAIM.
 19089     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19090                                    W-CL-COMP-CD.
 19091     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19092                                    W-CL-CERT-NO.
 19093
 19094
 19095* EXEC CICS HANDLE CONDITION
 19096*        NOTFND  (7250-CONTINUE)
 19097*        ENDFILE (7250-CONTINUE)
 19098*    END-EXEC.
 19099*    MOVE '"$I''                  ! ) #00018856' TO DFHEIV0
 19100     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19102     MOVE X'2920233030303138383536' TO DFHEIV0(25:11)
 19103     CALL 'kxdfhei1' USING DFHEIV0
 19104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19105
 19106
 19107
 19108* EXEC CICS IGNORE CONDITION
 19109*        DUPKEY
 19110*    END-EXEC.
 19111*    MOVE '"*$                   !   #00018861' TO DFHEIV0
 19112     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19114     MOVE X'2020233030303138383631' TO DFHEIV0(25:11)
 19115     CALL 'kxdfhei1' USING DFHEIV0
 19116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19117
 19118
 19119
 19120* EXEC CICS STARTBR
 19121*        DATASET   (CLMS-ID)
 19122*        RIDFLD    (ELMSTR-KEY)
 19123*        GENERIC   EQUAL
 19124*        KEYLENGTH (ELMSTR-LENGTH)
 19125*    END-EXEC.
 19126     MOVE 0
 19127       TO DFHEIV11
 19128*    MOVE '&,   KG    E          &   #00018865' TO DFHEIV0
 19129     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19130     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19131     MOVE X'2020233030303138383635' TO DFHEIV0(25:11)
 19132     CALL 'kxdfhei1' USING DFHEIV0,
 19133           CLMS-ID,
 19134           ELMSTR-KEY,
 19135           ELMSTR-LENGTH,
 19136           DFHEIV11,
 19137           DFHEIV99
 19138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19139
 19140
 19141     MOVE 'Y'                    TO W-BROWSE-SW.
 19142
 19143 7250-NEXT-CLAIM.
 19144
 19145
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 351
* EL050.cbl
 19146* EXEC CICS READNEXT
 19147*        DATASET   (CLMS-ID)
 19148*        RIDFLD    (ELMSTR-KEY)
 19149*        SET       (ADDRESS OF CLAIM-MASTER)
 19150*    END-EXEC.
 19151     MOVE 0
 19152       TO DFHEIV11
 19153*    MOVE '&.S                   )   #00018876' TO DFHEIV0
 19154     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19155     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19156     MOVE X'2020233030303138383736' TO DFHEIV0(25:11)
 19157     CALL 'kxdfhei1' USING DFHEIV0,
 19158           CLMS-ID,
 19159           DFHEIV20,
 19160           DFHEIV99,
 19161           ELMSTR-KEY,
 19162           DFHEIV99,
 19163           DFHEIV11,
 19164           DFHEIV99,
 19165           DFHEIV99
 19166     SET ADDRESS OF CLAIM-MASTER TO
 19167         DFHEIV20
 19168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19169
 19170
 19171     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19172        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19173         GO TO 7250-CONTINUE
 19174     END-IF.
 19175
 19176     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19177        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19178        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19179        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19180        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19181         GO TO 7250-NEXT-CLAIM
 19182     END-IF.
 19183
 19184     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19185        OR (CL-CLAIM-TYPE = 'I')
 19186        OR (CL-CLAIM-TYPE = 'G')
 19187        OR (CL-CLAIM-TYPE = 'F')
 19188          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19189              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19190              GO TO 7250-CONTINUE
 19191          END-IF
 19192     END-IF.
 19193
 19194     GO TO 7250-NEXT-CLAIM.
 19195
 19196 7250-CONTINUE.
 19197
 19198     IF W-BROWSE-SW = 'Y'
 19199
 19200* EXEC CICS ENDBR
 19201*            DATASET   (CLMS-ID)
 19202*        END-EXEC
 19203     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 352
* EL050.cbl
 19204       TO DFHEIV11
 19205*    MOVE '&2                    $   #00018910' TO DFHEIV0
 19206     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19207     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19208     MOVE X'2020233030303138393130' TO DFHEIV0(25:11)
 19209     CALL 'kxdfhei1' USING DFHEIV0,
 19210           CLMS-ID,
 19211           DFHEIV11,
 19212           DFHEIV99
 19213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19214         MOVE 'N' TO W-BROWSE-SW
 19215     END-IF.
 19216
 19217 7250-EXIT.
 19218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 353
* EL050.cbl
 19220 7300-CHECK-FOR-OPEN-CLMS.
 19221
 19222*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19223*    MOVE SPACES                 TO CNTL-ACCESS.
 19224*    MOVE '1'                    TO CNTL-REC-TYPE.
 19225*    MOVE +0                     TO CNTL-SEQ-NO.
 19226
 19227*    MOVE '3'                    TO RC-SW-1.
 19228*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19229
 19230*    IF NOT CF-COMPANY-MASTER
 19231*         PERFORM 0099-COMPANY-NOT-FOUND
 19232*         GO TO 7300-EXIT.
 19233
 19234     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19235                                    W-CL-COMP-CD.
 19236     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19237                                    W-CL-CERT-NO.
 19238
 19239
 19240* EXEC CICS HANDLE CONDITION
 19241*        NOTFND  (7300-CONTINUE)
 19242*        ENDFILE (7300-CONTINUE)
 19243*    END-EXEC.
 19244*    MOVE '"$I''                  ! * #00018938' TO DFHEIV0
 19245     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19247     MOVE X'2A20233030303138393338' TO DFHEIV0(25:11)
 19248     CALL 'kxdfhei1' USING DFHEIV0
 19249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19250
 19251
 19252
 19253* EXEC CICS IGNORE CONDITION
 19254*        DUPKEY
 19255*    END-EXEC.
 19256*    MOVE '"*$                   !   #00018943' TO DFHEIV0
 19257     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303138393433' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0
 19261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19262
 19263
 19264
 19265* EXEC CICS STARTBR
 19266*        DATASET   (CLMS-ID)
 19267*        RIDFLD    (ELMSTR-KEY)
 19268*        GENERIC   EQUAL
 19269*        KEYLENGTH (ELMSTR-LENGTH)
 19270*    END-EXEC.
 19271     MOVE 0
 19272       TO DFHEIV11
 19273*    MOVE '&,   KG    E          &   #00018947' TO DFHEIV0
 19274     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19275     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19276     MOVE X'2020233030303138393437' TO DFHEIV0(25:11)
 19277     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 354
* EL050.cbl
 19278           CLMS-ID,
 19279           ELMSTR-KEY,
 19280           ELMSTR-LENGTH,
 19281           DFHEIV11,
 19282           DFHEIV99
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286     MOVE 'Y'                    TO W-BROWSE-SW.
 19287
 19288 7300-NEXT-CLAIM.
 19289
 19290
 19291* EXEC CICS READNEXT
 19292*        DATASET   (CLMS-ID)
 19293*        RIDFLD    (ELMSTR-KEY)
 19294*        SET       (ADDRESS OF CLAIM-MASTER)
 19295*    END-EXEC.
 19296     MOVE 0
 19297       TO DFHEIV11
 19298*    MOVE '&.S                   )   #00018958' TO DFHEIV0
 19299     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19300     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19301     MOVE X'2020233030303138393538' TO DFHEIV0(25:11)
 19302     CALL 'kxdfhei1' USING DFHEIV0,
 19303           CLMS-ID,
 19304           DFHEIV20,
 19305           DFHEIV99,
 19306           ELMSTR-KEY,
 19307           DFHEIV99,
 19308           DFHEIV11,
 19309           DFHEIV99,
 19310           DFHEIV99
 19311     SET ADDRESS OF CLAIM-MASTER TO
 19312         DFHEIV20
 19313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19314
 19315
 19316     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19317        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19318         GO TO 7300-CONTINUE.
 19319
 19320     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19321        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19322        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19323        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19324        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19325         GO TO 7300-NEXT-CLAIM.
 19326
 19327*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19328     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19329        OR (CL-CLAIM-TYPE = 'I')
 19330        OR (CL-CLAIM-TYPE = 'G')
 19331        OR (CL-CLAIM-TYPE = 'F')
 19332        IF CLAIM-IS-OPEN
 19333           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19334             AND PB-C-AH-CANCEL-DT > SPACES
 19335              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 355
* EL050.cbl
 19336              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19337           END-IF
 19338           EVALUATE TRUE
 19339             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19340                 MOVE ER-2884      TO WS-ERROR
 19341             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19342                 MOVE ER-2887      TO WS-ERROR
 19343             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19344                 MOVE ER-2886      TO WS-ERROR
 19345             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19346                 MOVE ER-2888      TO WS-ERROR
 19347             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19348                 MOVE ER-2885      TO WS-ERROR
 19349             WHEN OTHER
 19350                 MOVE ER-2768      TO WS-ERROR
 19351           END-EVALUATE
 19352           IF PB-C-AH-CANCEL-VOIDED OR
 19353              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19354                NOT AH-COVERAGE-CANCELLED)
 19355               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19356               MOVE ER-2768      TO WS-ERROR
 19357           END-IF
 19358           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19359           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19360              PB-FORCE-CODE NOT EQUAL '8'
 19361               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19362           END-IF
 19363           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19364           GO TO 7300-NEXT-CLAIM
 19365        ELSE
 19366           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19367*****THIS IS A RESCISSION OR REFORMATION
 19368              IF AH-COVERAGE-CANCELLED
 19369                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19370                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19371                    MOVE 1                   TO DC-ELAPSED-DAYS
 19372                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19373                    SET BIN-PLUS-ELAPSED     TO TRUE
 19374                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19375                    IF NO-CONVERSION-ERROR
 19376                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19377                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19378                          MOVE ER-2897 TO WS-ERROR
 19379                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19380                          GO TO 7300-NEXT-CLAIM
 19381                       END-IF
 19382                    END-IF
 19383                 ELSE
 19384                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19385                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19386                         MOVE ER-2890 TO WS-ERROR
 19387                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19388                         GO TO 7300-NEXT-CLAIM
 19389                      ELSE
 19390                         MOVE ER-2898 TO WS-ERROR
 19391                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19392                         GO TO 7300-NEXT-CLAIM
 19393                      END-IF
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 356
* EL050.cbl
 19394                   END-IF
 19395                 END-IF
 19396              END-IF
 19397           ELSE
 19398              IF CL-DENIAL-TYPE = '1'  AND
 19399                 CL-TOTAL-PAID-AMT = 0
 19400                    GO TO 7300-NEXT-CLAIM
 19401              END-IF
 19402              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19403               AND PB-C-AH-CANCEL-DT > SPACES
 19404                 MOVE ER-2756        TO WS-ERROR
 19405                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19406                 GO TO 7300-NEXT-CLAIM
 19407              END-IF
 19408           END-IF
 19409        END-IF
 19410     ELSE
 19411*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19412        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19413           IF (CLAIM-IS-OPEN)
 19414              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19415                 <> zeros
 19416              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19417                 <> zeros)
 19418              MOVE ER-2889      TO WS-ERROR
 19419              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19420              GO TO 7300-NEXT-CLAIM
 19421           ELSE
 19422              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19423*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19424                 IF (LF-COVERAGE-CANCELLED AND
 19425                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19426                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19427                         MOVE ER-2890 TO WS-ERROR
 19428                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19429                         GO TO 7300-NEXT-CLAIM
 19430                      ELSE
 19431                         MOVE ER-2898 TO WS-ERROR
 19432                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19433                         GO TO 7300-NEXT-CLAIM
 19434                      END-IF
 19435                 END-IF
 19436              ELSE
 19437                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19438                    and (CL-TOTAL-PAID-AMT = 0)
 19439                    GO TO 7300-NEXT-CLAIM
 19440                 END-IF
 19441                 IF (
 19442                      (AH-COVERAGE-CANCELLED)
 19443                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19444                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19445                      and (pb-ci-ah-cancel-amt +
 19446                         pb-c-ah-cancel-amt) <> zeros
 19447                    )
 19448                               OR
 19449                    (
 19450                      (LF-COVERAGE-CANCELLED)
 19451                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 357
* EL050.cbl
 19452                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19453                      and (pb-ci-lf-cancel-amt +
 19454                         pb-c-lf-cancel-amt) <> zeros
 19455                    )
 19456                       MOVE ER-2965 TO WS-ERROR
 19457                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19458                       GO TO 7300-NEXT-CLAIM
 19459                 END-IF
 19460                 IF LF-COVERAGE-CANCELLED
 19461                  IF CL-TOTAL-PAID-AMT > 0
 19462                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19463                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19464                        MOVE ER-2891 TO WS-ERROR
 19465                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19466                        GO TO 7300-NEXT-CLAIM
 19467                      END-IF
 19468                    ELSE
 19469****only show this error if cert num matches exactly
 19470                      IF PB-CERT-NO = CL-CERT-NO
 19471                         MOVE ER-2892 TO WS-ERROR
 19472                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19473                         GO TO 7300-NEXT-CLAIM
 19474                      END-IF
 19475                    END-IF
 19476                  END-IF
 19477                 END-IF
 19478              END-IF
 19479           END-IF
 19480        END-IF
 19481     END-IF
 19482
 19483     GO TO 7300-NEXT-CLAIM.
 19484
 19485 7300-CONTINUE.
 19486
 19487     IF W-BROWSE-SW = 'Y'
 19488
 19489* EXEC CICS ENDBR
 19490*            DATASET   (CLMS-ID)
 19491*        END-EXEC.
 19492     MOVE 0
 19493       TO DFHEIV11
 19494*    MOVE '&2                    $   #00019136' TO DFHEIV0
 19495     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19497     MOVE X'2020233030303139313336' TO DFHEIV0(25:11)
 19498     CALL 'kxdfhei1' USING DFHEIV0,
 19499           CLMS-ID,
 19500           DFHEIV11,
 19501           DFHEIV99
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19503
 19504
 19505 7300-EXIT.
 19506     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 358
* EL050.cbl
 19508
 19509 7400-GET-REMAIN-TERM.
 19510
 19511* EXEC CICS LINK
 19512*        PROGRAM    ('ELRTRM')
 19513*        COMMAREA   (CALCULATION-PASS-AREA)
 19514*        LENGTH     (CP-COMM-LENGTH)
 19515*    END-EXEC.
 19516     MOVE 'ELRTRM' TO DFHEIV1
 19517*    MOVE '."C                   (   #00019145' TO DFHEIV0
 19518     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19520     MOVE X'2020233030303139313435' TO DFHEIV0(25:11)
 19521     CALL 'kxdfhei1' USING DFHEIV0,
 19522           DFHEIV1,
 19523           CALCULATION-PASS-AREA,
 19524           CP-COMM-LENGTH,
 19525           DFHEIV99,
 19526           DFHEIV99,
 19527           DFHEIV99,
 19528           DFHEIV99
 19529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19530
 19531
 19532 7400-EXIT.
 19533     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 359
* EL050.cbl
 19535
 19536 7500-GET-REMAIN-AMOUNT.
 19537
 19538* EXEC CICS LINK
 19539*        PROGRAM    ('ELRAMT')
 19540*        COMMAREA   (CALCULATION-PASS-AREA)
 19541*        LENGTH     (CP-COMM-LENGTH)
 19542*    END-EXEC.
 19543     MOVE 'ELRAMT' TO DFHEIV1
 19544*    MOVE '."C                   (   #00019156' TO DFHEIV0
 19545     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19546     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19547     MOVE X'2020233030303139313536' TO DFHEIV0(25:11)
 19548     CALL 'kxdfhei1' USING DFHEIV0,
 19549           DFHEIV1,
 19550           CALCULATION-PASS-AREA,
 19551           CP-COMM-LENGTH,
 19552           DFHEIV99,
 19553           DFHEIV99,
 19554           DFHEIV99,
 19555           DFHEIV99
 19556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19557
 19558
 19559 7500-EXIT.
 19560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 360
* EL050.cbl
 19562
 19563 7600-GET-REFUND.
 19564
 19565* EXEC CICS LINK
 19566*        PROGRAM    ('ELRFND')
 19567*        COMMAREA   (CALCULATION-PASS-AREA)
 19568*        LENGTH     (CP-COMM-LENGTH)
 19569*    END-EXEC.
 19570     MOVE 'ELRFND' TO DFHEIV1
 19571*    MOVE '."C                   (   #00019167' TO DFHEIV0
 19572     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19574     MOVE X'2020233030303139313637' TO DFHEIV0(25:11)
 19575     CALL 'kxdfhei1' USING DFHEIV0,
 19576           DFHEIV1,
 19577           CALCULATION-PASS-AREA,
 19578           CP-COMM-LENGTH,
 19579           DFHEIV99,
 19580           DFHEIV99,
 19581           DFHEIV99,
 19582           DFHEIV99
 19583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19584
 19585
 19586 7600-EXIT.
 19587     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 361
* EL050.cbl
 19589 7700-CALL-DL1.
 19590
 19591* EXEC CICS LINK
 19592*        PROGRAM    ('DLO001')
 19593*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19594*        LENGTH     (DLO001-COMM-LENGTH)
 19595*    END-EXEC.
 19596     MOVE 'DLO001' TO DFHEIV1
 19597*    MOVE '."C                   (   #00019177' TO DFHEIV0
 19598     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19600     MOVE X'2020233030303139313737' TO DFHEIV0(25:11)
 19601     CALL 'kxdfhei1' USING DFHEIV0,
 19602           DFHEIV1,
 19603           WS-DLO-MASTER-POLICY-FORM,
 19604           DLO001-COMM-LENGTH,
 19605           DFHEIV99,
 19606           DFHEIV99,
 19607           DFHEIV99,
 19608           DFHEIV99
 19609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19610
 19611
 19612 7700-EXIT.
 19613     EXIT.
 19614
 19615 7710-CALL-DL2.
 19616
 19617* EXEC CICS LINK
 19618*        PROGRAM    ('DLO002')
 19619*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19620*        LENGTH     (DLO002-COMM-LENGTH)
 19621*    END-EXEC.
 19622     MOVE 'DLO002' TO DFHEIV1
 19623*    MOVE '."C                   (   #00019187' TO DFHEIV0
 19624     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19626     MOVE X'2020233030303139313837' TO DFHEIV0(25:11)
 19627     CALL 'kxdfhei1' USING DFHEIV0,
 19628           DFHEIV1,
 19629           WS-DLO-INTERNAL-POLICY-FORM,
 19630           DLO002-COMM-LENGTH,
 19631           DFHEIV99,
 19632           DFHEIV99,
 19633           DFHEIV99,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638 7710-EXIT.
 19639     EXIT.
 19640
 19641 7720-CALL-DL3.
 19642
 19643* EXEC CICS LINK
 19644*        PROGRAM    ('DLO003')
 19645*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19646*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 362
* EL050.cbl
 19647*    END-EXEC.
 19648     MOVE 'DLO003' TO DFHEIV1
 19649*    MOVE '."C                   (   #00019197' TO DFHEIV0
 19650     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19652     MOVE X'2020233030303139313937' TO DFHEIV0(25:11)
 19653     CALL 'kxdfhei1' USING DFHEIV0,
 19654           DFHEIV1,
 19655           WS-DLO-VALID-BANK-ID,
 19656           DLO003-COMM-LENGTH,
 19657           DFHEIV99,
 19658           DFHEIV99,
 19659           DFHEIV99,
 19660           DFHEIV99
 19661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19662
 19663
 19664 7720-EXIT.
 19665     EXIT.
 19666
 19667 7730-CALL-DL7.
 19668
 19669* EXEC CICS LINK
 19670*        PROGRAM    ('DLO007')
 19671*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19672*        LENGTH     (DLO007-COMM-LENGTH)
 19673*    END-EXEC.
 19674     MOVE 'DLO007' TO DFHEIV1
 19675*    MOVE '."C                   (   #00019207' TO DFHEIV0
 19676     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19677     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19678     MOVE X'2020233030303139323037' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0,
 19680           DFHEIV1,
 19681           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19682           DLO007-COMM-LENGTH,
 19683           DFHEIV99,
 19684           DFHEIV99,
 19685           DFHEIV99,
 19686           DFHEIV99
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19688
 19689
 19690 7730-EXIT.
 19691     EXIT.
 19692
 19693 7740-CALL-DL11.
 19694
 19695* EXEC CICS LINK
 19696*        PROGRAM    ('DLO011')
 19697*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19698*        LENGTH     (DLO011-COMM-LENGTH)
 19699*    END-EXEC.
 19700     MOVE 'DLO011' TO DFHEIV1
 19701*    MOVE '."C                   (   #00019217' TO DFHEIV0
 19702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19704     MOVE X'2020233030303139323137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 363
* EL050.cbl
 19705     CALL 'kxdfhei1' USING DFHEIV0,
 19706           DFHEIV1,
 19707           WS-DLO-PREM-RATES-BEN-TYPE,
 19708           DLO011-COMM-LENGTH,
 19709           DFHEIV99,
 19710           DFHEIV99,
 19711           DFHEIV99,
 19712           DFHEIV99
 19713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19714
 19715
 19716 7740-EXIT.
 19717     EXIT.
 19718
 19719 7750-CALL-DL17.
 19720
 19721* EXEC CICS LINK
 19722*        PROGRAM    ('DLO017')
 19723*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19724*        LENGTH     (DLO017-COMM-LENGTH)
 19725*    END-EXEC.
 19726     MOVE 'DLO017' TO DFHEIV1
 19727*    MOVE '."C                   (   #00019227' TO DFHEIV0
 19728     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19730     MOVE X'2020233030303139323237' TO DFHEIV0(25:11)
 19731     CALL 'kxdfhei1' USING DFHEIV0,
 19732           DFHEIV1,
 19733           WS-DLO-VALID-RATE-CODE,
 19734           DLO017-COMM-LENGTH,
 19735           DFHEIV99,
 19736           DFHEIV99,
 19737           DFHEIV99,
 19738           DFHEIV99
 19739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19740
 19741
 19742 7750-EXIT.
 19743     EXIT.
 19744
 19745 7755-CALL-DL19.
 19746
 19747* EXEC CICS LINK
 19748*        PROGRAM    ('DLO019')
 19749*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19750*        LENGTH     (DLO019-COMM-LENGTH)
 19751*    END-EXEC.
 19752     MOVE 'DLO019' TO DFHEIV1
 19753*    MOVE '."C                   (   #00019237' TO DFHEIV0
 19754     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19756     MOVE X'2020233030303139323337' TO DFHEIV0(25:11)
 19757     CALL 'kxdfhei1' USING DFHEIV0,
 19758           DFHEIV1,
 19759           WS-DLO-ORIG-COV-CAT,
 19760           DLO019-COMM-LENGTH,
 19761           DFHEIV99,
 19762           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 364
* EL050.cbl
 19763           DFHEIV99,
 19764           DFHEIV99
 19765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19766
 19767
 19768 7755-EXIT.
 19769     EXIT.
 19770
 19771 7760-CALL-DL21.
 19772
 19773* EXEC CICS LINK
 19774*        PROGRAM    ('DLO021')
 19775*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19776*        LENGTH     (DLO021-COMM-LENGTH)
 19777*    END-EXEC.
 19778     MOVE 'DLO021' TO DFHEIV1
 19779*    MOVE '."C                   (   #00019247' TO DFHEIV0
 19780     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19782     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 19783     CALL 'kxdfhei1' USING DFHEIV0,
 19784           DFHEIV1,
 19785           WS-DLO-VALID-LOAN-OFFICER,
 19786           DLO021-COMM-LENGTH,
 19787           DFHEIV99,
 19788           DFHEIV99,
 19789           DFHEIV99,
 19790           DFHEIV99
 19791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19792
 19793
 19794 7760-EXIT.
 19795     EXIT.
 19796
 19797 7770-CALL-DL22.
 19798
 19799* EXEC CICS LINK
 19800*        PROGRAM    ('DLO022')
 19801*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19802*        LENGTH     (DLO022-COMM-LENGTH)
 19803*    END-EXEC.
 19804     MOVE 'DLO022' TO DFHEIV1
 19805*    MOVE '."C                   (   #00019257' TO DFHEIV0
 19806     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19808     MOVE X'2020233030303139323537' TO DFHEIV0(25:11)
 19809     CALL 'kxdfhei1' USING DFHEIV0,
 19810           DFHEIV1,
 19811           WS-DLO-VALID-STATE-CODE,
 19812           DLO022-COMM-LENGTH,
 19813           DFHEIV99,
 19814           DFHEIV99,
 19815           DFHEIV99,
 19816           DFHEIV99
 19817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19818
 19819
 19820 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 365
* EL050.cbl
 19821     EXIT.
 19822
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 366
* EL050.cbl
 19824
 19825 7780-CALL-AGG.
 19826
 19827* EXEC CICS LINK
 19828*        PROGRAM    ('ELAGGO')
 19829*        COMMAREA   (WS-PASS-to-pemaggo)
 19830*        LENGTH     (ws-passed-key-LENGTH)
 19831*    END-EXEC.
 19832     MOVE 'ELAGGO' TO DFHEIV1
 19833*    MOVE '."C                   (   #00019269' TO DFHEIV0
 19834     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19836     MOVE X'2020233030303139323639' TO DFHEIV0(25:11)
 19837     CALL 'kxdfhei1' USING DFHEIV0,
 19838           DFHEIV1,
 19839           WS-PASS-to-pemaggo,
 19840           ws-passed-key-LENGTH,
 19841           DFHEIV99,
 19842           DFHEIV99,
 19843           DFHEIV99,
 19844           DFHEIV99
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19846
 19847 7780-EXIT.
 19848     EXIT.
 19849 7800-REWRITE-CERT.
 19850******************************************************************
 19851*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19852*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19853******************************************************************
 19854
 19855     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19856        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19857        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19858        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19859
 19860* EXEC CICS REWRITE
 19861*                  DATASET (CERT-ID)
 19862*                  FROM    (CERTIFICATE-MASTER)
 19863*              END-EXEC
 19864     MOVE LENGTH OF
 19865      CERTIFICATE-MASTER
 19866       TO DFHEIV11
 19867*    MOVE '&& L                  %   #00019286' TO DFHEIV0
 19868     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19869     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19870     MOVE X'2020233030303139323836' TO DFHEIV0(25:11)
 19871     CALL 'kxdfhei1' USING DFHEIV0,
 19872           CERT-ID,
 19873           CERTIFICATE-MASTER,
 19874           DFHEIV11,
 19875           DFHEIV99
 19876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19877        GO TO 7800-EXIT.
 19878
 19879       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19880       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19881
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 367
* EL050.cbl
 19882 7800-EXIT.
 19883      EXIT.
 19884
 19885 7900-DELETE-CERT.
 19886
 19887* EXEC CICS DELETE
 19888*        DATASET (CERT-ID)
 19889*    END-EXEC.
 19890*    MOVE '&(                    &   #00019299' TO DFHEIV0
 19891     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19892     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19893     MOVE X'2020233030303139323939' TO DFHEIV0(25:11)
 19894     CALL 'kxdfhei1' USING DFHEIV0,
 19895           CERT-ID,
 19896           DFHEIV99,
 19897           DFHEIV99,
 19898           DFHEIV99,
 19899           DFHEIV99
 19900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19901
 19902
 19903 7900-EXIT.
 19904     EXIT.
 19905
 19906 8000-WRITE-CERT.
 19907
 19908* EXEC CICS HANDLE CONDITION
 19909*        DUPKEY    (8000-FREE-MAIN)
 19910*    END-EXEC.
 19911*    MOVE '"$$                   ! + #00019307' TO DFHEIV0
 19912     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19914     MOVE X'2B20233030303139333037' TO DFHEIV0(25:11)
 19915     CALL 'kxdfhei1' USING DFHEIV0
 19916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19917
 19918
 19919
 19920* EXEC CICS WRITE
 19921*        DATASET     (CERT-ID)
 19922*        FROM        (CERTIFICATE-MASTER)
 19923*        RIDFLD      (ELCERT-KEY)
 19924*    END-EXEC.
 19925     MOVE LENGTH OF
 19926      CERTIFICATE-MASTER
 19927       TO DFHEIV11
 19928*    MOVE '&$ L                  ''   #00019311' TO DFHEIV0
 19929     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19930     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19931     MOVE X'2020233030303139333131' TO DFHEIV0(25:11)
 19932     CALL 'kxdfhei1' USING DFHEIV0,
 19933           CERT-ID,
 19934           CERTIFICATE-MASTER,
 19935           DFHEIV11,
 19936           ELCERT-KEY,
 19937           DFHEIV99,
 19938           DFHEIV99
 19939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 368
* EL050.cbl
 19940
 19941
 19942 8000-FREE-MAIN.
 19943
 19944 8000-EXIT.
 19945      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 369
* EL050.cbl
 19947
 19948 8100-READ-ERPNDM.
 19949
 19950* EXEC CICS HANDLE CONDITION
 19951*         NOTFND     (8100-NOTFND)
 19952*         ENDFILE    (8100-NOTFND)
 19953*    END-EXEC.
 19954*    MOVE '"$I''                  ! , #00019324' TO DFHEIV0
 19955     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19957     MOVE X'2C20233030303139333234' TO DFHEIV0(25:11)
 19958     CALL 'kxdfhei1' USING DFHEIV0
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19960
 19961
 19962     MOVE SPACES                 TO ERPNDM-FOUND.
 19963     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19964
 19965
 19966* EXEC CICS READ
 19967*         DATASET   (FILE-ERPNDM)
 19968*         RIDFLD    (PM-CONTROL-PRIMARY)
 19969*         INTO      (PENDING-MAILING-DATA)
 19970*    END-EXEC.
 19971     MOVE LENGTH OF
 19972      PENDING-MAILING-DATA
 19973       TO DFHEIV11
 19974*    MOVE '&"IL       E          (   #00019332' TO DFHEIV0
 19975     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19977     MOVE X'2020233030303139333332' TO DFHEIV0(25:11)
 19978     CALL 'kxdfhei1' USING DFHEIV0,
 19979           FILE-ERPNDM,
 19980           PENDING-MAILING-DATA,
 19981           DFHEIV11,
 19982           PM-CONTROL-PRIMARY,
 19983           DFHEIV99,
 19984           DFHEIV99,
 19985           DFHEIV99
 19986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19987
 19988
 19989     GO TO 8100-EXIT.
 19990
 19991 8100-NOTFND.
 19992
 19993     MOVE 'X'                    TO ERPNDM-FOUND.
 19994     MOVE ER-2694                TO WS-ERROR.
 19995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19996     MOVE ER-2883                TO WS-ERROR
 19997     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19998     .
 19999 8100-EXIT.
 20000     EXIT.
 20001
 20002 8110-READ-ERMAIL.
 20003
 20004* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 370
* EL050.cbl
 20005*         NOTFND     (8110-NOTFND)
 20006*         ENDFILE    (8110-NOTFND)
 20007*    END-EXEC.
 20008*    MOVE '"$I''                  ! - #00019352' TO DFHEIV0
 20009     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20011     MOVE X'2D20233030303139333532' TO DFHEIV0(25:11)
 20012     CALL 'kxdfhei1' USING DFHEIV0
 20013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20014
 20015
 20016     MOVE SPACES                 TO ERMAIL-FOUND.
 20017     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20018     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20019     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20020     MOVE PB-SV-STATE            TO MA-STATE.
 20021
 20022
 20023* EXEC CICS READ
 20024*         UPDATE
 20025*         DATASET   (FILE-ERMAIL)
 20026*         RIDFLD    (MA-CONTROL-PRIMARY)
 20027*         INTO      (MAILING-DATA)
 20028*    END-EXEC.
 20029     MOVE LENGTH OF
 20030      MAILING-DATA
 20031       TO DFHEIV11
 20032*    MOVE '&"IL       EU         (   #00019363' TO DFHEIV0
 20033     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20035     MOVE X'2020233030303139333633' TO DFHEIV0(25:11)
 20036     CALL 'kxdfhei1' USING DFHEIV0,
 20037           FILE-ERMAIL,
 20038           MAILING-DATA,
 20039           DFHEIV11,
 20040           MA-CONTROL-PRIMARY,
 20041           DFHEIV99,
 20042           DFHEIV99,
 20043           DFHEIV99
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20045
 20046
 20047     GO TO 8110-EXIT.
 20048
 20049 8110-NOTFND.
 20050     MOVE 'X'                    TO ERMAIL-FOUND.
 20051
 20052 8110-EXIT.
 20053     EXIT.
 20054
 20055 8120-REWRITE-ERMAIL.
 20056
 20057* EXEC CICS REWRITE
 20058*         DATASET    (FILE-ERMAIL)
 20059*         FROM       (MAILING-DATA)
 20060*    END-EXEC.
 20061     MOVE LENGTH OF
 20062      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 371
* EL050.cbl
 20063       TO DFHEIV11
 20064*    MOVE '&& L                  %   #00019379' TO DFHEIV0
 20065     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20066     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20067     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 20068     CALL 'kxdfhei1' USING DFHEIV0,
 20069           FILE-ERMAIL,
 20070           MAILING-DATA,
 20071           DFHEIV11,
 20072           DFHEIV99
 20073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20074
 20075
 20076 8120-EXIT.
 20077     EXIT.
 20078
 20079 8130-WRITE-ERMAIL.
 20080
 20081* EXEC CICS HANDLE CONDITION
 20082*         DUPKEY   (8130-EXIT)
 20083*    END-EXEC.
 20084*    MOVE '"$$                   ! . #00019388' TO DFHEIV0
 20085     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20087     MOVE X'2E20233030303139333838' TO DFHEIV0(25:11)
 20088     CALL 'kxdfhei1' USING DFHEIV0
 20089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20090
 20091
 20092
 20093* EXEC CICS WRITE
 20094*         DATASET     (FILE-ERMAIL)
 20095*         RIDFLD      (MA-CONTROL-PRIMARY)
 20096*         FROM        (MAILING-DATA)
 20097*    END-EXEC.
 20098     MOVE LENGTH OF
 20099      MAILING-DATA
 20100       TO DFHEIV11
 20101*    MOVE '&$ L                  ''   #00019392' TO DFHEIV0
 20102     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20104     MOVE X'2020233030303139333932' TO DFHEIV0(25:11)
 20105     CALL 'kxdfhei1' USING DFHEIV0,
 20106           FILE-ERMAIL,
 20107           MAILING-DATA,
 20108           DFHEIV11,
 20109           MA-CONTROL-PRIMARY,
 20110           DFHEIV99,
 20111           DFHEIV99
 20112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20113
 20114
 20115 8130-EXIT.
 20116     EXIT.
 20117
 20118 8140-UNLOCK-ERMAIL.
 20119
 20120* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 372
* EL050.cbl
 20121*         DATASET   (FILE-ERMAIL)
 20122*    END-EXEC.
 20123*    MOVE '&*                    #   #00019402' TO DFHEIV0
 20124     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20125     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20126     MOVE X'2020233030303139343032' TO DFHEIV0(25:11)
 20127     CALL 'kxdfhei1' USING DFHEIV0,
 20128           FILE-ERMAIL,
 20129           DFHEIV99
 20130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20131
 20132
 20133 8140-EXIT.
 20134     EXIT.
 20135
 20136 8150-read-elcrtt.
 20137
 20138
 20139* EXEC CICS HANDLE CONDITION
 20140*        NOTFND   (8150-exit)
 20141*    END-EXEC
 20142*    MOVE '"$I                   ! / #00019411' TO DFHEIV0
 20143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20145     MOVE X'2F20233030303139343131' TO DFHEIV0(25:11)
 20146     CALL 'kxdfhei1' USING DFHEIV0
 20147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20148
 20149     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20150     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20151
 20152
 20153* EXEC CICS READ
 20154*        DATASET  (CRTT-ID)
 20155*        RIDFLD   (WS-ELCRTT-KEY)
 20156*        INTO     (CERTIFICATE-TRAILERS)
 20157*    END-EXEC
 20158     MOVE LENGTH OF
 20159      CERTIFICATE-TRAILERS
 20160       TO DFHEIV11
 20161*    MOVE '&"IL       E          (   #00019418' TO DFHEIV0
 20162     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20164     MOVE X'2020233030303139343138' TO DFHEIV0(25:11)
 20165     CALL 'kxdfhei1' USING DFHEIV0,
 20166           CRTT-ID,
 20167           CERTIFICATE-TRAILERS,
 20168           DFHEIV11,
 20169           WS-ELCRTT-KEY,
 20170           DFHEIV99,
 20171           DFHEIV99,
 20172           DFHEIV99
 20173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20174
 20175     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20176     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20177     move cs-vehicle-odometer    to ws-vehicle-odometer
 20178
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 373
* EL050.cbl
 20179     .
 20180 8150-exit.
 20181     exit.
 20182 8180-UPDATE-VIN-NUMBER.
 20183
 20184* EXEC CICS HANDLE CONDITION
 20185*        NOTFND   (8180-NOTFND)
 20186*    END-EXEC.
 20187*    MOVE '"$I                   ! 0 #00019432' TO DFHEIV0
 20188     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20190     MOVE X'3020233030303139343332' TO DFHEIV0(25:11)
 20191     CALL 'kxdfhei1' USING DFHEIV0
 20192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20193
 20194
 20195     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20196     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20197
 20198
 20199* EXEC CICS READ
 20200*        UPDATE
 20201*        DATASET  (CRTT-ID)
 20202*        RIDFLD   (WS-ELCRTT-KEY)
 20203*        INTO     (CERTIFICATE-TRAILERS)
 20204*    END-EXEC.
 20205     MOVE LENGTH OF
 20206      CERTIFICATE-TRAILERS
 20207       TO DFHEIV11
 20208*    MOVE '&"IL       EU         (   #00019439' TO DFHEIV0
 20209     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20210     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20211     MOVE X'2020233030303139343339' TO DFHEIV0(25:11)
 20212     CALL 'kxdfhei1' USING DFHEIV0,
 20213           CRTT-ID,
 20214           CERTIFICATE-TRAILERS,
 20215           DFHEIV11,
 20216           WS-ELCRTT-KEY,
 20217           DFHEIV99,
 20218           DFHEIV99,
 20219           DFHEIV99
 20220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20221
 20222
 20223     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20224         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20225
 20226* EXEC CICS REWRITE
 20227*           DATASET  (CRTT-ID)
 20228*           FROM     (CERTIFICATE-TRAILERS)
 20229*        END-EXEC
 20230     MOVE LENGTH OF
 20231      CERTIFICATE-TRAILERS
 20232       TO DFHEIV11
 20233*    MOVE '&& L                  %   #00019448' TO DFHEIV0
 20234     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20235     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20236     MOVE X'2020233030303139343438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 374
* EL050.cbl
 20237     CALL 'kxdfhei1' USING DFHEIV0,
 20238           CRTT-ID,
 20239           CERTIFICATE-TRAILERS,
 20240           DFHEIV11,
 20241           DFHEIV99
 20242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20243     ELSE
 20244
 20245* EXEC CICS UNLOCK
 20246*          DATASET  (CRTT-ID)
 20247*       END-EXEC
 20248*    MOVE '&*                    #   #00019453' TO DFHEIV0
 20249     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20250     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20251     MOVE X'2020233030303139343533' TO DFHEIV0(25:11)
 20252     CALL 'kxdfhei1' USING DFHEIV0,
 20253           CRTT-ID,
 20254           DFHEIV99
 20255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20256     END-IF.
 20257
 20258     GO TO 8180-EXIT.
 20259
 20260 8180-NOTFND.
 20261
 20262     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20263     MOVE 'CS'         TO CS-RECORD-ID.
 20264     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20265     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20266     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20267     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20268
 20269* EXEC CICS WRITE
 20270*       DATASET  (CRTT-ID)
 20271*       RIDFLD   (WS-ELCRTT-KEY)
 20272*       FROM     (CERTIFICATE-TRAILERS)
 20273*    END-EXEC.
 20274     MOVE LENGTH OF
 20275      CERTIFICATE-TRAILERS
 20276       TO DFHEIV11
 20277*    MOVE '&$ L                  ''   #00019468' TO DFHEIV0
 20278     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20279     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20280     MOVE X'2020233030303139343638' TO DFHEIV0(25:11)
 20281     CALL 'kxdfhei1' USING DFHEIV0,
 20282           CRTT-ID,
 20283           CERTIFICATE-TRAILERS,
 20284           DFHEIV11,
 20285           WS-ELCRTT-KEY,
 20286           DFHEIV99,
 20287           DFHEIV99
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291 8180-EXIT.
 20292     EXIT.
 20293
 20294 8190-UPDATE-REFUND-CLAIM-FLAG.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 375
* EL050.cbl
 20295
 20296* EXEC CICS HANDLE CONDITION
 20297*        NOTFND   (8190-NOTFND)
 20298*    END-EXEC.
 20299*    MOVE '"$I                   ! 1 #00019478' TO DFHEIV0
 20300     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20302     MOVE X'3120233030303139343738' TO DFHEIV0(25:11)
 20303     CALL 'kxdfhei1' USING DFHEIV0
 20304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20305
 20306
 20307     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20308     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20309
 20310
 20311* EXEC CICS READ
 20312*        UPDATE
 20313*        DATASET  (CRTT-ID)
 20314*        RIDFLD   (WS-ELCRTT-KEY)
 20315*        INTO     (CERTIFICATE-TRAILERS)
 20316*    END-EXEC.
 20317     MOVE LENGTH OF
 20318      CERTIFICATE-TRAILERS
 20319       TO DFHEIV11
 20320*    MOVE '&"IL       EU         (   #00019485' TO DFHEIV0
 20321     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20322     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20323     MOVE X'2020233030303139343835' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0,
 20325           CRTT-ID,
 20326           CERTIFICATE-TRAILERS,
 20327           DFHEIV11,
 20328           WS-ELCRTT-KEY,
 20329           DFHEIV99,
 20330           DFHEIV99,
 20331           DFHEIV99
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334
 20335     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20336
 20337* EXEC CICS REWRITE
 20338*       DATASET  (CRTT-ID)
 20339*       FROM     (CERTIFICATE-TRAILERS)
 20340*    END-EXEC.
 20341     MOVE LENGTH OF
 20342      CERTIFICATE-TRAILERS
 20343       TO DFHEIV11
 20344*    MOVE '&& L                  %   #00019493' TO DFHEIV0
 20345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139343933' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           CRTT-ID,
 20350           CERTIFICATE-TRAILERS,
 20351           DFHEIV11,
 20352           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 376
* EL050.cbl
 20353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20354
 20355
 20356     GO TO 8190-EXIT.
 20357
 20358 8190-NOTFND.
 20359
 20360     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20361     MOVE 'CS'         TO CS-RECORD-ID.
 20362     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20363     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20364     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20365     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20366
 20367* EXEC CICS WRITE
 20368*       DATASET  (CRTT-ID)
 20369*       RIDFLD   (WS-ELCRTT-KEY)
 20370*       FROM     (CERTIFICATE-TRAILERS)
 20371*    END-EXEC.
 20372     MOVE LENGTH OF
 20373      CERTIFICATE-TRAILERS
 20374       TO DFHEIV11
 20375*    MOVE '&$ L                  ''   #00019508' TO DFHEIV0
 20376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20378     MOVE X'2020233030303139353038' TO DFHEIV0(25:11)
 20379     CALL 'kxdfhei1' USING DFHEIV0,
 20380           CRTT-ID,
 20381           CERTIFICATE-TRAILERS,
 20382           DFHEIV11,
 20383           WS-ELCRTT-KEY,
 20384           DFHEIV99,
 20385           DFHEIV99
 20386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20387
 20388
 20389 8190-EXIT.
 20390     EXIT.
 20391
 20392 8195-UPDATE-AGE-FLAGS.
 20393
 20394* EXEC CICS HANDLE CONDITION
 20395*        NOTFND   (8195-NOTFND)
 20396*    END-EXEC.
 20397*    MOVE '"$I                   ! 2 #00019518' TO DFHEIV0
 20398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20400     MOVE X'3220233030303139353138' TO DFHEIV0(25:11)
 20401     CALL 'kxdfhei1' USING DFHEIV0
 20402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20403
 20404
 20405     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20406     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20407
 20408
 20409* EXEC CICS READ
 20410*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 377
* EL050.cbl
 20411*        DATASET  (CRTT-ID)
 20412*        RIDFLD   (WS-ELCRTT-KEY)
 20413*        INTO     (CERTIFICATE-TRAILERS)
 20414*    END-EXEC.
 20415     MOVE LENGTH OF
 20416      CERTIFICATE-TRAILERS
 20417       TO DFHEIV11
 20418*    MOVE '&"IL       EU         (   #00019525' TO DFHEIV0
 20419     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20420     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20421     MOVE X'2020233030303139353235' TO DFHEIV0(25:11)
 20422     CALL 'kxdfhei1' USING DFHEIV0,
 20423           CRTT-ID,
 20424           CERTIFICATE-TRAILERS,
 20425           DFHEIV11,
 20426           WS-ELCRTT-KEY,
 20427           DFHEIV99,
 20428           DFHEIV99,
 20429           DFHEIV99
 20430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20431
 20432
 20433     IF WS-INS-AGE-SET = 'Y'
 20434        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20435     END-IF
 20436     IF WS-JNT-AGE-SET = 'Y'
 20437        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20438     END-IF
 20439
 20440
 20441* EXEC CICS REWRITE
 20442*       DATASET  (CRTT-ID)
 20443*       FROM     (CERTIFICATE-TRAILERS)
 20444*    END-EXEC.
 20445     MOVE LENGTH OF
 20446      CERTIFICATE-TRAILERS
 20447       TO DFHEIV11
 20448*    MOVE '&& L                  %   #00019539' TO DFHEIV0
 20449     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20450     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20451     MOVE X'2020233030303139353339' TO DFHEIV0(25:11)
 20452     CALL 'kxdfhei1' USING DFHEIV0,
 20453           CRTT-ID,
 20454           CERTIFICATE-TRAILERS,
 20455           DFHEIV11,
 20456           DFHEIV99
 20457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20458
 20459
 20460     GO TO 8195-EXIT.
 20461
 20462 8195-NOTFND.
 20463
 20464     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20465     MOVE 'CS'         TO CS-RECORD-ID.
 20466     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20467     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20468     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 378
* EL050.cbl
 20469     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20470     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20471
 20472* EXEC CICS WRITE
 20473*       DATASET  (CRTT-ID)
 20474*       RIDFLD   (WS-ELCRTT-KEY)
 20475*       FROM     (CERTIFICATE-TRAILERS)
 20476*    END-EXEC.
 20477     MOVE LENGTH OF
 20478      CERTIFICATE-TRAILERS
 20479       TO DFHEIV11
 20480*    MOVE '&$ L                  ''   #00019555' TO DFHEIV0
 20481     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20482     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20483     MOVE X'2020233030303139353535' TO DFHEIV0(25:11)
 20484     CALL 'kxdfhei1' USING DFHEIV0,
 20485           CRTT-ID,
 20486           CERTIFICATE-TRAILERS,
 20487           DFHEIV11,
 20488           WS-ELCRTT-KEY,
 20489           DFHEIV99,
 20490           DFHEIV99
 20491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20492
 20493
 20494 8195-EXIT.
 20495     EXIT.
 20496
 20497 8200-READ-REIN-TABLE.
 20498
 20499* EXEC CICS HANDLE CONDITION
 20500*         NOTFND   (8200-NOTFND)
 20501*    END-EXEC.
 20502*    MOVE '"$I                   ! 3 #00019565' TO DFHEIV0
 20503     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20505     MOVE X'3320233030303139353635' TO DFHEIV0(25:11)
 20506     CALL 'kxdfhei1' USING DFHEIV0
 20507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20508
 20509
 20510
 20511* EXEC CICS READ
 20512*        DATASET     (REIN-ID)
 20513*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20514*        RIDFLD      (ERREIN-KEY)
 20515*    END-EXEC.
 20516*    MOVE '&"S        E          (   #00019569' TO DFHEIV0
 20517     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20519     MOVE X'2020233030303139353639' TO DFHEIV0(25:11)
 20520     CALL 'kxdfhei1' USING DFHEIV0,
 20521           REIN-ID,
 20522           DFHEIV20,
 20523           DFHEIV99,
 20524           ERREIN-KEY,
 20525           DFHEIV99,
 20526           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 379
* EL050.cbl
 20527           DFHEIV99
 20528     SET ADDRESS OF REINSURANCE-RECORD TO
 20529         DFHEIV20
 20530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20531
 20532
 20533     GO TO 8200-EXIT.
 20534
 20535 8200-NOTFND.
 20536     MOVE 'N'             TO WS-REIN-READ-SW.
 20537
 20538 8200-EXIT.
 20539      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 380
* EL050.cbl
 20541
 20542 8300-READ-CTBL-TABLE.
 20543
 20544* EXEC CICS HANDLE CONDITION
 20545*        NOTFND    (8300-NOTFND)
 20546*        DISABLED  (8300-ERRESS-PROBLEM)
 20547*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20548*        ENDFILE   (8300-NOTFND)
 20549*    END-EXEC.
 20550*    MOVE '"$IcJ''                ! 4 #00019585' TO DFHEIV0
 20551     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20553     MOVE X'3420233030303139353835' TO DFHEIV0(25:11)
 20554     CALL 'kxdfhei1' USING DFHEIV0
 20555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20556
 20557
 20558
 20559* EXEC CICS READ
 20560*        DATASET     (CTBL-ID)
 20561*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20562*        RIDFLD      (ERCTBL-KEY)
 20563*    END-EXEC.
 20564*    MOVE '&"S        E          (   #00019592' TO DFHEIV0
 20565     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20567     MOVE X'2020233030303139353932' TO DFHEIV0(25:11)
 20568     CALL 'kxdfhei1' USING DFHEIV0,
 20569           CTBL-ID,
 20570           DFHEIV20,
 20571           DFHEIV99,
 20572           ERCTBL-KEY,
 20573           DFHEIV99,
 20574           DFHEIV99,
 20575           DFHEIV99
 20576     SET ADDRESS OF COMM-TABLE-RECORD TO
 20577         DFHEIV20
 20578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20579
 20580
 20581     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20582
 20583     GO TO 8300-EXIT.
 20584
 20585 8300-NOTFND.
 20586
 20587     IF CTBL-SW = '0530'
 20588         MOVE 'AA'                     TO WS-AH-COMP-CD
 20589         MOVE '0550'                   TO CTBL-SW
 20590         MOVE '1'                      TO WS-CTBL-READ-SW
 20591         GO TO 8300-EXIT.
 20592
 20593     IF CTBL-SW = '0540'
 20594         MOVE 'AA'                     TO WS-LF-COMP-CD
 20595         MOVE '0550'                   TO CTBL-SW
 20596         MOVE '1'                      TO WS-CTBL-READ-SW
 20597         GO TO 8300-EXIT.
 20598
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 381
* EL050.cbl
 20599     IF CTBL-SW = '0550'
 20600         MOVE '2'                      TO WS-CTBL-READ-SW
 20601         GO TO 8300-EXIT.
 20602
 20603     GO TO 8300-EXIT.
 20604
 20605 8300-ERRESS-PROBLEM.
 20606
 20607      MOVE ER-8050              TO WS-ERROR.
 20608      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20609
 20610     GO TO 8300-EXIT.
 20611
 20612 8300-EXIT.
 20613      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 382
* EL050.cbl
 20615
 20616
 20617 8400-GETMAIN-ERFORM.
 20618
 20619
 20620* EXEC CICS   GETMAIN
 20621*        LENGTH  (500)
 20622*        SET     (ADDRESS OF FORM-MASTER)
 20623*    END-EXEC.
 20624     MOVE 500
 20625       TO DFHEIV11
 20626*    MOVE '," L                  $   #00019636' TO DFHEIV0
 20627     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20628     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20629     MOVE X'2020233030303139363336' TO DFHEIV0(25:11)
 20630     CALL 'kxdfhei1' USING DFHEIV0,
 20631           DFHEIV20,
 20632           DFHEIV11,
 20633           DFHEIV99
 20634     SET ADDRESS OF FORM-MASTER TO
 20635         DFHEIV20
 20636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20637
 20638
 20639     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20640
 20641 8400-EXIT.
 20642      EXIT.
 20643
 20644 8450-READ-FORM-MASTER.
 20645
 20646
 20647* EXEC CICS  HANDLE CONDITION
 20648*        NOTFND   (8450-FORM-NOT-FOUND)
 20649*        ENDFILE  (8450-FORM-NOT-FOUND)
 20650*    END-EXEC.
 20651*    MOVE '"$I''                  ! 5 #00019648' TO DFHEIV0
 20652     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20653     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20654     MOVE X'3520233030303139363438' TO DFHEIV0(25:11)
 20655     CALL 'kxdfhei1' USING DFHEIV0
 20656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20657
 20658
 20659
 20660* EXEC CICS   READ
 20661*        DATASET   (FORM-ID)
 20662*        RIDFLD    (ERFORM-KEY)
 20663*        INTO      (FORM-MASTER)
 20664*        GTEQ
 20665*    END-EXEC.
 20666     MOVE LENGTH OF
 20667      FORM-MASTER
 20668       TO DFHEIV11
 20669*    MOVE '&"IL       G          (   #00019653' TO DFHEIV0
 20670     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20672     MOVE X'2020233030303139363533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 383
* EL050.cbl
 20673     CALL 'kxdfhei1' USING DFHEIV0,
 20674           FORM-ID,
 20675           FORM-MASTER,
 20676           DFHEIV11,
 20677           ERFORM-KEY,
 20678           DFHEIV99,
 20679           DFHEIV99,
 20680           DFHEIV99
 20681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20682
 20683
 20684     MOVE  'Y'           TO  FORM-MASTER-SW.
 20685
 20686     GO TO  8450-EXIT.
 20687
 20688 8450-FORM-NOT-FOUND.
 20689
 20690     MOVE  'N'           TO  FORM-MASTER-SW.
 20691
 20692 8450-EXIT.
 20693      EXIT.
 20694
 20695 8500-DATE-CONVERT.
 20696
 20697* EXEC CICS LINK
 20698*        PROGRAM    ('ELDATCV')
 20699*        COMMAREA   (DATE-CONVERSION-DATA)
 20700*        LENGTH     (DC-COMM-LENGTH)
 20701*    END-EXEC.
 20702     MOVE 'ELDATCV' TO DFHEIV1
 20703*    MOVE '."C                   (   #00019672' TO DFHEIV0
 20704     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20705     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20706     MOVE X'2020233030303139363732' TO DFHEIV0(25:11)
 20707     CALL 'kxdfhei1' USING DFHEIV0,
 20708           DFHEIV1,
 20709           DATE-CONVERSION-DATA,
 20710           DC-COMM-LENGTH,
 20711           DFHEIV99,
 20712           DFHEIV99,
 20713           DFHEIV99,
 20714           DFHEIV99
 20715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20716
 20717
 20718 8500-EXIT.
 20719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 384
* EL050.cbl
 20721
 20722 8555-RELOAD-CONTROL-FILE.
 20723     CONTINUE.
 20724
 20725 8555-EXIT.
 20726     EXIT.
 20727
 20728 8557-GETMAIN-ERPLAN.
 20729
 20730
 20731* EXEC CICS GETMAIN
 20732*        LENGTH    (840)
 20733*        SET       (ADDRESS OF PLAN-RECORDS)
 20734*    END-EXEC.
 20735     MOVE 840
 20736       TO DFHEIV11
 20737*    MOVE '," L                  $   #00019690' TO DFHEIV0
 20738     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20739     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20740     MOVE X'2020233030303139363930' TO DFHEIV0(25:11)
 20741     CALL 'kxdfhei1' USING DFHEIV0,
 20742           DFHEIV20,
 20743           DFHEIV11,
 20744           DFHEIV99
 20745     SET ADDRESS OF PLAN-RECORDS TO
 20746         DFHEIV20
 20747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20748
 20749
 20750     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20751
 20752 8557-EXIT.
 20753     EXIT.
 20754
 20755 8560-GETMAIN.
 20756
 20757* EXEC CICS GETMAIN
 20758*        LENGTH    (2000)
 20759*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20760*    END-EXEC.
 20761     MOVE 2000
 20762       TO DFHEIV11
 20763*    MOVE '," L                  $   #00019701' TO DFHEIV0
 20764     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20765     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20766     MOVE X'2020233030303139373031' TO DFHEIV0(25:11)
 20767     CALL 'kxdfhei1' USING DFHEIV0,
 20768           DFHEIV20,
 20769           DFHEIV11,
 20770           DFHEIV99
 20771     SET ADDRESS OF ACCOUNT-MASTER TO
 20772         DFHEIV20
 20773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20774
 20775
 20776     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20777
 20778 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 385
* EL050.cbl
 20779     EXIT.
 20780
 20781 8570-START-ACCOUNT-MASTER.
 20782
 20783* EXEC CICS HANDLE CONDITION
 20784*        NOTFND    (0199-ACCT-NOT-FOUND)
 20785*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20786*    END-EXEC.
 20787*    MOVE '"$I''                  ! 6 #00019712' TO DFHEIV0
 20788     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20790     MOVE X'3620233030303139373132' TO DFHEIV0(25:11)
 20791     CALL 'kxdfhei1' USING DFHEIV0
 20792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20793
 20794
 20795
 20796* EXEC CICS STARTBR
 20797*        DATASET    (ACCT-ID)
 20798*        RIDFLD     (ERACCT-KEY)
 20799*        GTEQ
 20800*    END-EXEC.
 20801     MOVE 0
 20802       TO DFHEIV11
 20803*    MOVE '&,         G          &   #00019717' TO DFHEIV0
 20804     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20805     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20806     MOVE X'2020233030303139373137' TO DFHEIV0(25:11)
 20807     CALL 'kxdfhei1' USING DFHEIV0,
 20808           ACCT-ID,
 20809           ERACCT-KEY,
 20810           DFHEIV99,
 20811           DFHEIV11,
 20812           DFHEIV99
 20813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20814
 20815
 20816 8570-EXIT.
 20817     EXIT.
 20818
 20819 8580-READ-ACCOUNT-MASTER.
 20820
 20821* EXEC CICS HANDLE CONDITION
 20822*        NOTFND    (0199-ACCT-NOT-FOUND)
 20823*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20824*    END-EXEC.
 20825*    MOVE '"$I''                  ! 7 #00019727' TO DFHEIV0
 20826     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20828     MOVE X'3720233030303139373237' TO DFHEIV0(25:11)
 20829     CALL 'kxdfhei1' USING DFHEIV0
 20830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20831
 20832
 20833
 20834* EXEC CICS READNEXT
 20835*        DATASET     (ACCT-ID)
 20836*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 386
* EL050.cbl
 20837*        RIDFLD      (ERACCT-KEY)
 20838*    END-EXEC.
 20839     MOVE LENGTH OF
 20840      ACCOUNT-MASTER
 20841       TO DFHEIV12
 20842     MOVE 0
 20843       TO DFHEIV11
 20844*    MOVE '&.IL                  )   #00019732' TO DFHEIV0
 20845     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20846     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20847     MOVE X'2020233030303139373332' TO DFHEIV0(25:11)
 20848     CALL 'kxdfhei1' USING DFHEIV0,
 20849           ACCT-ID,
 20850           ACCOUNT-MASTER,
 20851           DFHEIV12,
 20852           ERACCT-KEY,
 20853           DFHEIV99,
 20854           DFHEIV11,
 20855           DFHEIV99,
 20856           DFHEIV99
 20857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20858
 20859
 20860 8580-EXIT.
 20861     EXIT.
 20862
 20863 8582-READ-COMPENSATION-MASTER.
 20864
 20865* EXEC CICS HANDLE CONDITION
 20866*        NOTFND    (8582-COMP-NOT-FOUND)
 20867*        ENDFILE   (8582-COMP-NOT-FOUND)
 20868*    END-EXEC.
 20869*    MOVE '"$I''                  ! 8 #00019742' TO DFHEIV0
 20870     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20872     MOVE X'3820233030303139373432' TO DFHEIV0(25:11)
 20873     CALL 'kxdfhei1' USING DFHEIV0
 20874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20875
 20876
 20877
 20878* EXEC CICS READ
 20879*        DATASET     (COMP-ID)
 20880*        INTO        (COMPENSATION-MASTER)
 20881*        RIDFLD      (ERCOMP-KEY)
 20882*    END-EXEC.
 20883     MOVE LENGTH OF
 20884      COMPENSATION-MASTER
 20885       TO DFHEIV11
 20886*    MOVE '&"IL       E          (   #00019747' TO DFHEIV0
 20887     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20889     MOVE X'2020233030303139373437' TO DFHEIV0(25:11)
 20890     CALL 'kxdfhei1' USING DFHEIV0,
 20891           COMP-ID,
 20892           COMPENSATION-MASTER,
 20893           DFHEIV11,
 20894           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 387
* EL050.cbl
 20895           DFHEIV99,
 20896           DFHEIV99,
 20897           DFHEIV99
 20898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20899
 20900
 20901     MOVE 'Y'                    TO COMP-MASTER-SW
 20902
 20903     GO TO 8582-EXIT
 20904     .
 20905 8582-COMP-NOT-FOUND.
 20906
 20907     MOVE 'N'                    TO COMP-MASTER-SW.
 20908
 20909 8582-EXIT.
 20910     EXIT.
 20911
 20912 8583-READ-ERAGTC.
 20913
 20914* EXEC CICS HANDLE CONDITION
 20915*        NOTFND    (8583-AGTC-NOT-FOUND)
 20916*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20917*    END-EXEC.
 20918*    MOVE '"$I''                  ! 9 #00019765' TO DFHEIV0
 20919     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20921     MOVE X'3920233030303139373635' TO DFHEIV0(25:11)
 20922     CALL 'kxdfhei1' USING DFHEIV0
 20923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20924
 20925
 20926
 20927* EXEC CICS STARTBR
 20928*        DATASET    (AGTC-ID)
 20929*        RIDFLD     (ERAGTC-KEY)
 20930*        GTEQ
 20931*    END-EXEC.
 20932     MOVE 0
 20933       TO DFHEIV11
 20934*    MOVE '&,         G          &   #00019770' TO DFHEIV0
 20935     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20936     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20937     MOVE X'2020233030303139373730' TO DFHEIV0(25:11)
 20938     CALL 'kxdfhei1' USING DFHEIV0,
 20939           AGTC-ID,
 20940           ERAGTC-KEY,
 20941           DFHEIV99,
 20942           DFHEIV11,
 20943           DFHEIV99
 20944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20945
 20946
 20947 8583-READ-ERAGTC-NEXT.
 20948
 20949* EXEC CICS READNEXT
 20950*        DATASET     (AGTC-ID)
 20951*        INTO        (AGENT-COMMISSIONS)
 20952*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 388
* EL050.cbl
 20953*    END-EXEC.
 20954     MOVE LENGTH OF
 20955      AGENT-COMMISSIONS
 20956       TO DFHEIV12
 20957     MOVE 0
 20958       TO DFHEIV11
 20959*    MOVE '&.IL                  )   #00019777' TO DFHEIV0
 20960     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20961     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20962     MOVE X'2020233030303139373737' TO DFHEIV0(25:11)
 20963     CALL 'kxdfhei1' USING DFHEIV0,
 20964           AGTC-ID,
 20965           AGENT-COMMISSIONS,
 20966           DFHEIV12,
 20967           ERAGTC-KEY,
 20968           DFHEIV99,
 20969           DFHEIV11,
 20970           DFHEIV99,
 20971           DFHEIV99
 20972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20973
 20974
 20975*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20976
 20977     GO TO 8583-EXIT
 20978     .
 20979 8583-AGTC-NOT-FOUND.
 20980
 20981     MOVE 'N'                    TO AGTC-MASTER-SW.
 20982
 20983 8583-EXIT.
 20984     EXIT.
 20985
 20986 8584-READ-BANK-CROSS-REF.
 20987
 20988* EXEC CICS HANDLE CONDITION
 20989*        NOTFND    (8584-BXRF-NOT-FOUND)
 20990*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20991*    END-EXEC.
 20992*    MOVE '"$I''                  ! : #00019795' TO DFHEIV0
 20993     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20995     MOVE X'3A20233030303139373935' TO DFHEIV0(25:11)
 20996     CALL 'kxdfhei1' USING DFHEIV0
 20997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20998
 20999
 21000
 21001* EXEC CICS READ
 21002*        DATASET     (BXRF-ID)
 21003*        INTO        (BANK-CROSS-REFERENCE)
 21004*        RIDFLD      (ERBXRF-KEY)
 21005*        LENGTH      (BXRF-REC-LENGTH)
 21006*    END-EXEC.
 21007*    MOVE '&"IL       E          (   #00019800' TO DFHEIV0
 21008     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21010     MOVE X'2020233030303139383030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 389
* EL050.cbl
 21011     CALL 'kxdfhei1' USING DFHEIV0,
 21012           BXRF-ID,
 21013           BANK-CROSS-REFERENCE,
 21014           BXRF-REC-LENGTH,
 21015           ERBXRF-KEY,
 21016           DFHEIV99,
 21017           DFHEIV99,
 21018           DFHEIV99
 21019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21020
 21021
 21022     MOVE 'Y'                    TO BXRF-MASTER-SW
 21023
 21024     GO TO 8584-EXIT
 21025     .
 21026 8584-BXRF-NOT-FOUND.
 21027
 21028     MOVE 'N'                    TO BXRF-MASTER-SW.
 21029
 21030 8584-EXIT.
 21031     EXIT.
 21032
 21033 8585-READ-PLAN-MASTER.
 21034
 21035
 21036* EXEC CICS HANDLE CONDITION
 21037*        NOTFND    (8585-PLAN-NOT-FOUND)
 21038*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21039*    END-EXEC.
 21040*    MOVE '"$I''                  ! ; #00019820' TO DFHEIV0
 21041     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21043     MOVE X'3B20233030303139383230' TO DFHEIV0(25:11)
 21044     CALL 'kxdfhei1' USING DFHEIV0
 21045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21046
 21047
 21048
 21049* EXEC CICS READ
 21050*        DATASET     (PLAN-ID)
 21051*        INTO        (PLAN-MASTER)
 21052*        RIDFLD      (ERPLAN-KEY)
 21053*    END-EXEC.
 21054     MOVE LENGTH OF
 21055      PLAN-MASTER
 21056       TO DFHEIV11
 21057*    MOVE '&"IL       E          (   #00019825' TO DFHEIV0
 21058     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21060     MOVE X'2020233030303139383235' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           PLAN-ID,
 21063           PLAN-MASTER,
 21064           DFHEIV11,
 21065           ERPLAN-KEY,
 21066           DFHEIV99,
 21067           DFHEIV99,
 21068           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 390
* EL050.cbl
 21069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21070
 21071
 21072     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21073
 21074     GO TO 8585-EXIT.
 21075
 21076 8585-PLAN-NOT-FOUND.
 21077
 21078     MOVE 'N'                    TO PLAN-MASTER-SW.
 21079
 21080 8585-EXIT.
 21081     EXIT.
 21082
 21083 8586-READ-LOAN-OFFICER.
 21084
 21085* EXEC CICS READ
 21086*        DATASET     (LOFC-ID)
 21087*        INTO        (LOAN-OFFICER-MASTER)
 21088*        RIDFLD      (ERLOFC-KEY)
 21089*        RESP        (WS-RESPONSE)
 21090*    END-EXEC
 21091     MOVE LENGTH OF
 21092      LOAN-OFFICER-MASTER
 21093       TO DFHEIV11
 21094*    MOVE '&"IL       E          (  N#00019843' TO DFHEIV0
 21095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21097     MOVE X'204E233030303139383433' TO DFHEIV0(25:11)
 21098     CALL 'kxdfhei1' USING DFHEIV0,
 21099           LOFC-ID,
 21100           LOAN-OFFICER-MASTER,
 21101           DFHEIV11,
 21102           ERLOFC-KEY,
 21103           DFHEIV99,
 21104           DFHEIV99,
 21105           DFHEIV99
 21106     MOVE EIBRESP  TO WS-RESPONSE
 21107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21108
 21109     IF WS-RESP-NORMAL
 21110        MOVE 'Y'                 TO LOFC-MASTER-SW
 21111     ELSE
 21112        MOVE 'N'                 TO LOFC-MASTER-SW
 21113     END-IF
 21114     .
 21115 8586-EXIT.
 21116     EXIT.
 21117 8587-START-ERPDEF.
 21118
 21119* EXEC CICS STARTBR
 21120*       DATASET   (PDEF-ID)
 21121*       RIDFLD    (ERPDEF-KEY)
 21122*       GTEQ
 21123*       RESP      (WS-RESPONSE)
 21124*    END-EXEC
 21125     MOVE 0
 21126       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 391
* EL050.cbl
 21127*    MOVE '&,         G          &  N#00019859' TO DFHEIV0
 21128     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21129     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21130     MOVE X'204E233030303139383539' TO DFHEIV0(25:11)
 21131     CALL 'kxdfhei1' USING DFHEIV0,
 21132           PDEF-ID,
 21133           ERPDEF-KEY,
 21134           DFHEIV99,
 21135           DFHEIV11,
 21136           DFHEIV99
 21137     MOVE EIBRESP  TO WS-RESPONSE
 21138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21139     IF WS-RESP-NORMAL
 21140        MOVE 'Y'                 TO PDEF-MASTER-SW
 21141     ELSE
 21142        MOVE 'N'                 TO PDEF-MASTER-SW
 21143     END-IF
 21144     .
 21145 8587-EXIT.
 21146     EXIT.
 21147 8588-READ-ERPDEF.
 21148
 21149* EXEC CICS READNEXT
 21150*       DATASET   (PDEF-ID)
 21151*       RIDFLD    (ERPDEF-KEY)
 21152*       INTO      (PRODUCT-MASTER)
 21153*       RESP      (WS-RESPONSE)
 21154*    END-EXEC
 21155     MOVE LENGTH OF
 21156      PRODUCT-MASTER
 21157       TO DFHEIV12
 21158     MOVE 0
 21159       TO DFHEIV11
 21160*    MOVE '&.IL                  )  N#00019874' TO DFHEIV0
 21161     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21162     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21163     MOVE X'204E233030303139383734' TO DFHEIV0(25:11)
 21164     CALL 'kxdfhei1' USING DFHEIV0,
 21165           PDEF-ID,
 21166           PRODUCT-MASTER,
 21167           DFHEIV12,
 21168           ERPDEF-KEY,
 21169           DFHEIV99,
 21170           DFHEIV11,
 21171           DFHEIV99,
 21172           DFHEIV99
 21173     MOVE EIBRESP  TO WS-RESPONSE
 21174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21175     IF WS-RESP-NORMAL
 21176        MOVE 'Y'                 TO PDEF-MASTER-SW
 21177     ELSE
 21178        MOVE 'N'                 TO PDEF-MASTER-SW
 21179     END-IF
 21180     .
 21181 8588-EXIT.
 21182     EXIT.
 21183 8589-ENDBR-ERPDEF.
 21184
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 392
* EL050.cbl
 21185* EXEC CICS ENDBR
 21186*       DATASET   (PDEF-ID)
 21187*    END-EXEC
 21188     MOVE 0
 21189       TO DFHEIV11
 21190*    MOVE '&2                    $   #00019889' TO DFHEIV0
 21191     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21192     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21193     MOVE X'2020233030303139383839' TO DFHEIV0(25:11)
 21194     CALL 'kxdfhei1' USING DFHEIV0,
 21195           PDEF-ID,
 21196           DFHEIV11,
 21197           DFHEIV99
 21198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21199     .
 21200 8589-EXIT.
 21201     EXIT.
 21202 8590-READ-CERT-MASTER.
 21203     IF PB-COMPANY-ID = 'UCL'
 21204         GO TO 8690-READ-CERT-MASTER-UCL.
 21205
 21206
 21207* EXEC CICS HANDLE CONDITION
 21208*         NOTFND    (0299-CERT-NOT-FOUND)
 21209*    END-EXEC.
 21210*    MOVE '"$I                   ! < #00019899' TO DFHEIV0
 21211     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21213     MOVE X'3C20233030303139383939' TO DFHEIV0(25:11)
 21214     CALL 'kxdfhei1' USING DFHEIV0
 21215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21216
 21217
 21218
 21219* EXEC CICS READ
 21220*        DATASET     (CERT-ID)
 21221*        INTO        (CERTIFICATE-MASTER)
 21222*        RIDFLD      (ELCERT-KEY)
 21223*        UPDATE
 21224*    END-EXEC.
 21225     MOVE LENGTH OF
 21226      CERTIFICATE-MASTER
 21227       TO DFHEIV11
 21228*    MOVE '&"IL       EU         (   #00019903' TO DFHEIV0
 21229     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21230     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21231     MOVE X'2020233030303139393033' TO DFHEIV0(25:11)
 21232     CALL 'kxdfhei1' USING DFHEIV0,
 21233           CERT-ID,
 21234           CERTIFICATE-MASTER,
 21235           DFHEIV11,
 21236           ELCERT-KEY,
 21237           DFHEIV99,
 21238           DFHEIV99,
 21239           DFHEIV99
 21240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21241
 21242
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 393
* EL050.cbl
 21243 8590-EXIT.
 21244     EXIT.
 21245
 21246 8690-READ-CERT-MASTER-UCL.
 21247
 21248* EXEC CICS HANDLE CONDITION
 21249*         NOTFND    (8700-READ-CERT-MASTER)
 21250*    END-EXEC.
 21251*    MOVE '"$I                   ! = #00019914' TO DFHEIV0
 21252     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21254     MOVE X'3D20233030303139393134' TO DFHEIV0(25:11)
 21255     CALL 'kxdfhei1' USING DFHEIV0
 21256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21257
 21258
 21259 8690-READ-CERT-CONT.
 21260
 21261* EXEC CICS READ
 21262*        DATASET     (CERT-ID)
 21263*        INTO        (CERTIFICATE-MASTER)
 21264*        RIDFLD      (ELCERT-KEY)
 21265*        UPDATE
 21266*    END-EXEC.
 21267     MOVE LENGTH OF
 21268      CERTIFICATE-MASTER
 21269       TO DFHEIV11
 21270*    MOVE '&"IL       EU         (   #00019919' TO DFHEIV0
 21271     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21272     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21273     MOVE X'2020233030303139393139' TO DFHEIV0(25:11)
 21274     CALL 'kxdfhei1' USING DFHEIV0,
 21275           CERT-ID,
 21276           CERTIFICATE-MASTER,
 21277           DFHEIV11,
 21278           ELCERT-KEY,
 21279           DFHEIV99,
 21280           DFHEIV99,
 21281           DFHEIV99
 21282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21283
 21284
 21285     GO TO 8590-EXIT.
 21286
 21287 8700-READ-CERT-MASTER.
 21288     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21289     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21290
 21291* EXEC CICS HANDLE CONDITION
 21292*         DUPKEY    (8720-COMP-ACCOUNTS)
 21293*         ENDFILE   (8730-END-BROWSE)
 21294*         NOTFND    (8740-NOT-FOUND)
 21295*    END-EXEC.
 21296*    MOVE '"$$''I                 ! > #00019931' TO DFHEIV0
 21297     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21299     MOVE X'3E20233030303139393331' TO DFHEIV0(25:11)
 21300     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 394
* EL050.cbl
 21301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21302
 21303
 21304
 21305* EXEC CICS STARTBR
 21306*        DATASET     ('ELCERT5')
 21307*        RIDFLD      (ELCERT2-KEY)
 21308*        EQUAL
 21309*    END-EXEC.
 21310     MOVE 'ELCERT5' TO DFHEIV1
 21311     MOVE 0
 21312       TO DFHEIV11
 21313*    MOVE '&,         E          &   #00019937' TO DFHEIV0
 21314     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21315     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21316     MOVE X'2020233030303139393337' TO DFHEIV0(25:11)
 21317     CALL 'kxdfhei1' USING DFHEIV0,
 21318           DFHEIV1,
 21319           ELCERT2-KEY,
 21320           DFHEIV99,
 21321           DFHEIV11,
 21322           DFHEIV99
 21323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21324
 21325
 21326 8710-READ-NEXT.
 21327
 21328* EXEC CICS READNEXT
 21329*        DATASET     ('ELCERT5')
 21330*        INTO        (CERTIFICATE-MASTER)
 21331*        RIDFLD      (ELCERT2-KEY)
 21332*    END-EXEC.
 21333     MOVE LENGTH OF
 21334      CERTIFICATE-MASTER
 21335       TO DFHEIV12
 21336     MOVE 'ELCERT5' TO DFHEIV1
 21337     MOVE 0
 21338       TO DFHEIV11
 21339*    MOVE '&.IL                  )   #00019944' TO DFHEIV0
 21340     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21342     MOVE X'2020233030303139393434' TO DFHEIV0(25:11)
 21343     CALL 'kxdfhei1' USING DFHEIV0,
 21344           DFHEIV1,
 21345           CERTIFICATE-MASTER,
 21346           DFHEIV12,
 21347           ELCERT2-KEY,
 21348           DFHEIV99,
 21349           DFHEIV11,
 21350           DFHEIV99,
 21351           DFHEIV99
 21352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21353
 21354
 21355 8720-COMP-ACCOUNTS.
 21356
 21357* EXEC CICS ENTER
 21358*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 395
* EL050.cbl
 21359*         FROM (PB-C-LAST-NAME)
 21360*    END-EXEC.
 21361     MOVE 001
 21362       TO DFHEIV11
 21363*    MOVE ':$F                   %   #00019951' TO DFHEIV0
 21364     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21365     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21366     MOVE X'2020233030303139393531' TO DFHEIV0(25:11)
 21367     CALL 'kxdfhei1' USING DFHEIV0,
 21368           DFHEIV11,
 21369           PB-C-LAST-NAME,
 21370           DFHEIV99,
 21371           DFHEIV99
 21372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21373
 21374
 21375
 21376* EXEC CICS ENTER
 21377*         TRACEID (002)
 21378*         FROM (CM-INSURED-LAST-NAME)
 21379*    END-EXEC.
 21380     MOVE 002
 21381       TO DFHEIV11
 21382*    MOVE ':$F                   %   #00019956' TO DFHEIV0
 21383     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21384     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21385     MOVE X'2020233030303139393536' TO DFHEIV0(25:11)
 21386     CALL 'kxdfhei1' USING DFHEIV0,
 21387           DFHEIV11,
 21388           CM-INSURED-LAST-NAME,
 21389           DFHEIV99,
 21390           DFHEIV99
 21391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21392
 21393
 21394     IF PB-CERT-NO NOT = CM-CERT-NO
 21395         GO TO 8730-END-BROWSE.
 21396
 21397     IF PB-ACCOUNT = CM-ACCOUNT
 21398         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21399             MOVE ER-2799        TO WS-ERROR
 21400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21401             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21402             GO TO 8730-END-BROWSE.
 21403
 21404     GO TO 8710-READ-NEXT.
 21405
 21406 8730-END-BROWSE.
 21407
 21408* EXEC CICS ENDBR
 21409*         DATASET    ('ELCERT5')
 21410*    END-EXEC.
 21411     MOVE 'ELCERT5' TO DFHEIV1
 21412     MOVE 0
 21413       TO DFHEIV11
 21414*    MOVE '&2                    $   #00019974' TO DFHEIV0
 21415     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21416     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 396
* EL050.cbl
 21417     MOVE X'2020233030303139393734' TO DFHEIV0(25:11)
 21418     CALL 'kxdfhei1' USING DFHEIV0,
 21419           DFHEIV1,
 21420           DFHEIV11,
 21421           DFHEIV99
 21422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21423
 21424
 21425 8740-NOT-FOUND.
 21426     GO TO 0299-CERT-NOT-FOUND.
 21427
 21428 8750-START-ELSTAT.
 21429
 21430* EXEC CICS STARTBR
 21431*       DATASET   (STAT-ID)
 21432*       RIDFLD    (ELSTAT-KEY)
 21433*       GTEQ
 21434*       RESP      (WS-RESPONSE)
 21435*    END-EXEC
 21436     MOVE 0
 21437       TO DFHEIV11
 21438*    MOVE '&,         G          &  N#00019982' TO DFHEIV0
 21439     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21441     MOVE X'204E233030303139393832' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0,
 21443           STAT-ID,
 21444           ELSTAT-KEY,
 21445           DFHEIV99,
 21446           DFHEIV11,
 21447           DFHEIV99
 21448     MOVE EIBRESP  TO WS-RESPONSE
 21449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21450     IF WS-RESP-NORMAL
 21451        MOVE 'Y'                 TO STAT-MASTER-SW
 21452     ELSE
 21453        MOVE 'N'                 TO STAT-MASTER-SW
 21454     END-IF
 21455     .
 21456 8750-EXIT.
 21457     EXIT.
 21458 8752-READ-ELSTAT.
 21459
 21460* EXEC CICS READNEXT
 21461*       DATASET   (STAT-ID)
 21462*       RIDFLD    (ELSTAT-KEY)
 21463*       INTO      (STATE-FILE)
 21464*       RESP      (WS-RESPONSE)
 21465*    END-EXEC
 21466     MOVE LENGTH OF
 21467      STATE-FILE
 21468       TO DFHEIV12
 21469     MOVE 0
 21470       TO DFHEIV11
 21471*    MOVE '&.IL                  )  N#00019997' TO DFHEIV0
 21472     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21473     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21474     MOVE X'204E233030303139393937' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 397
* EL050.cbl
 21475     CALL 'kxdfhei1' USING DFHEIV0,
 21476           STAT-ID,
 21477           STATE-FILE,
 21478           DFHEIV12,
 21479           ELSTAT-KEY,
 21480           DFHEIV99,
 21481           DFHEIV11,
 21482           DFHEIV99,
 21483           DFHEIV99
 21484     MOVE EIBRESP  TO WS-RESPONSE
 21485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21486     IF WS-RESP-NORMAL
 21487        MOVE 'Y'                 TO STAT-MASTER-SW
 21488     ELSE
 21489        MOVE 'N'                 TO STAT-MASTER-SW
 21490     END-IF
 21491     .
 21492 8752-EXIT.
 21493     EXIT.
 21494 8800-GET-COMP-RATE.
 21495     MOVE +1 TO IB.
 21496     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21497         ADD +9 TO IB
 21498         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21499             ADD +9 TO IB
 21500             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21501                MOVE ZEROS       TO WS-WK-RATE
 21502                GO TO 8800-EXIT.
 21503
 21504     IF PB-I-AGE GREATER CT-AGE (1)
 21505         ADD +3 TO IB
 21506         IF PB-I-AGE GREATER CT-AGE (2)
 21507             ADD +3 TO IB
 21508             IF PB-I-AGE GREATER CT-AGE (3)
 21509                MOVE ZEROS       TO WS-WK-RATE
 21510                GO TO 8800-EXIT.
 21511
 21512     IF WS-WORK-TERM GREATER CT-TRM (1)
 21513         ADD +1 TO IB
 21514         IF WS-WORK-TERM GREATER CT-TRM (2)
 21515             ADD +1 TO IB
 21516             IF WS-WORK-TERM GREATER CT-TRM (3)
 21517                MOVE ZEROS       TO WS-WK-RATE
 21518                GO TO 8800-EXIT.
 21519
 21520     IF CT-RT (IB) NOT NUMERIC
 21521         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21522         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21523         GO TO 8800-GET-COMP-RATE.
 21524
 21525     MOVE CT-RT (IB) TO WS-WK-RATE.
 21526
 21527 8800-EXIT.
 21528     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 398
* EL050.cbl
 21530 8900-ADDRESS-FILE.
 21531     IF ERACCT-FILE-ADDRESSED
 21532         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21533         GO TO 8900-ADDRESS-EXIT.
 21534
 21535     IF ELCNTL-FILE-ADDRESSED
 21536         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21537         GO TO 8900-ADDRESS-EXIT.
 21538
 21539     IF ERPLAN-FILE-ADDRESSED
 21540         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21541         GO TO 8900-ADDRESS-EXIT.
 21542
 21543     IF ERFORM-FILE-ADDRESSED
 21544         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21545         GO TO 8900-ADDRESS-EXIT.
 21546
 21547 8900-ADDRESS-EXIT.
 21548     EXIT.
 21549
 21550 9000-READ-CONTROL.
 21551
 21552* EXEC CICS HANDLE CONDITION
 21553*        NOTFND    (9000-NOTFND)
 21554*    END-EXEC.
 21555*    MOVE '"$I                   ! ? #00020068' TO DFHEIV0
 21556     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21558     MOVE X'3F20233030303230303638' TO DFHEIV0(25:11)
 21559     CALL 'kxdfhei1' USING DFHEIV0
 21560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21561
 21562
 21563
 21564* EXEC CICS READ
 21565*        DATASET     (CNTL-ID)
 21566*        SET         (ADDRESS OF CONTROL-FILE)
 21567*        RIDFLD      (ELCNTL-KEY)
 21568*        GTEQ
 21569*    END-EXEC.
 21570*    MOVE '&"S        G          (   #00020072' TO DFHEIV0
 21571     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21573     MOVE X'2020233030303230303732' TO DFHEIV0(25:11)
 21574     CALL 'kxdfhei1' USING DFHEIV0,
 21575           CNTL-ID,
 21576           DFHEIV20,
 21577           DFHEIV99,
 21578           ELCNTL-KEY,
 21579           DFHEIV99,
 21580           DFHEIV99,
 21581           DFHEIV99
 21582     SET ADDRESS OF CONTROL-FILE TO
 21583         DFHEIV20
 21584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21585
 21586
 21587     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 399
* EL050.cbl
 21588
 21589 9000-NOTFND.
 21590     IF RC-SW-1 = '1'
 21591        MOVE ER-2616              TO WS-ERROR
 21592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21593        GO TO 9000-EXIT.
 21594
 21595     IF RC-SW-1 = '2'
 21596        MOVE ER-2602              TO WS-ERROR
 21597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21598
 21599 9000-EXIT.
 21600      EXIT.
 21601
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 400
* EL050.cbl
 21603 9100-READ-CONTROL.
 21604
 21605* EXEC CICS HANDLE CONDITION
 21606*        NOTFND  (9100-NOTFND)
 21607*        ENDFILE (9100-NOTFND)
 21608*    END-EXEC.
 21609*    MOVE '"$I''                  ! @ #00020096' TO DFHEIV0
 21610     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21612     MOVE X'4020233030303230303936' TO DFHEIV0(25:11)
 21613     CALL 'kxdfhei1' USING DFHEIV0
 21614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21615
 21616
 21617
 21618* EXEC CICS READ
 21619*        DATASET     (CNTL-ID)
 21620*        INTO        (CONTROL-FILE)
 21621*        RIDFLD      (ELCNTL-KEY)
 21622*        GTEQ
 21623*    END-EXEC.
 21624     MOVE LENGTH OF
 21625      CONTROL-FILE
 21626       TO DFHEIV11
 21627*    MOVE '&"IL       G          (   #00020101' TO DFHEIV0
 21628     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21629     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21630     MOVE X'2020233030303230313031' TO DFHEIV0(25:11)
 21631     CALL 'kxdfhei1' USING DFHEIV0,
 21632           CNTL-ID,
 21633           CONTROL-FILE,
 21634           DFHEIV11,
 21635           ELCNTL-KEY,
 21636           DFHEIV99,
 21637           DFHEIV99,
 21638           DFHEIV99
 21639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21640
 21641
 21642     GO TO 9100-EXIT.
 21643
 21644 9100-NOTFND.
 21645     IF RC-SW-2 = '0'
 21646        MOVE '1'                  TO STATE-RECORD-ERROR
 21647        GO TO 9100-EXIT
 21648     END-IF
 21649     IF RC-SW-2 = '1'
 21650        MOVE '1'                  TO LF-BENEFIT-ERROR
 21651        MOVE ER-2604              TO WS-ERROR
 21652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21653        GO TO 9100-EXIT.
 21654
 21655     IF RC-SW-2 = '2'
 21656        MOVE '1'                  TO AH-BENEFIT-ERROR
 21657        MOVE ER-2605              TO WS-ERROR
 21658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21659        GO TO 9100-EXIT.
 21660
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 401
* EL050.cbl
 21661     IF RC-SW-2 = '3'
 21662         MOVE ER-2603           TO WS-ERROR
 21663         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21664         GO TO 9100-EXIT.
 21665
 21666     IF RC-SW-2 = '4'
 21667         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21668         GO TO 9100-EXIT.
 21669
 21670     IF RC-SW-2 = '5'
 21671         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21672         IF WS-AH-INPUT-CD-1 = SPACE
 21673             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21674         ELSE
 21675             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21676
 21677 9100-EXIT.
 21678      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 402
* EL050.cbl
 21680 9200-CONTROL-GETMAIN.
 21681
 21682* EXEC CICS GETMAIN
 21683*         LENGTH   (750)
 21684*         SET      (ADDRESS OF CONTROL-FILE)
 21685*    END-EXEC.
 21686     MOVE 750
 21687       TO DFHEIV11
 21688*    MOVE '," L                  $   #00020147' TO DFHEIV0
 21689     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21690     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21691     MOVE X'2020233030303230313437' TO DFHEIV0(25:11)
 21692     CALL 'kxdfhei1' USING DFHEIV0,
 21693           DFHEIV20,
 21694           DFHEIV11,
 21695           DFHEIV99
 21696     SET ADDRESS OF CONTROL-FILE TO
 21697         DFHEIV20
 21698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21699
 21700
 21701     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21702
 21703 9200-EXIT.
 21704     EXIT.
 21705
 21706 9250-UNLOCK-RETURN.
 21707
 21708* EXEC CICS UNLOCK
 21709*        DATASET   (CERT-ID)
 21710*    END-EXEC.
 21711*    MOVE '&*                    #   #00020158' TO DFHEIV0
 21712     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21713     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21714     MOVE X'2020233030303230313538' TO DFHEIV0(25:11)
 21715     CALL 'kxdfhei1' USING DFHEIV0,
 21716           CERT-ID,
 21717           DFHEIV99
 21718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21719
 21720
 21721 9300-ABEND.
 21722     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21723
 21724
 21725* EXEC CICS LINK
 21726*        PROGRAM   ('EL004')
 21727*        COMMAREA  (WS-ERROR-LINE)
 21728*        LENGTH    (72)
 21729*    END-EXEC.
 21730     MOVE 'EL004' TO DFHEIV1
 21731     MOVE 72
 21732       TO DFHEIV11
 21733*    MOVE '."C                   (   #00020165' TO DFHEIV0
 21734     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21736     MOVE X'2020233030303230313635' TO DFHEIV0(25:11)
 21737     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 403
* EL050.cbl
 21738           DFHEIV1,
 21739           WS-ERROR-LINE,
 21740           DFHEIV11,
 21741           DFHEIV99,
 21742           DFHEIV99,
 21743           DFHEIV99,
 21744           DFHEIV99
 21745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21746
 21747
 21748     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21749
 21750
 21751* EXEC CICS ABEND
 21752*        ABCODE ('EL50')
 21753*    END-EXEC.
 21754     MOVE 'EL50' TO DFHEIV5
 21755*    MOVE '.,A                   "   #00020173' TO DFHEIV0
 21756     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21757     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21758     MOVE X'2020233030303230313733' TO DFHEIV0(25:11)
 21759     CALL 'kxdfhei1' USING DFHEIV0,
 21760           DFHEIV5
 21761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21762
 21763
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 404
* EL050.cbl
 21765
 21766******************************************************************
 21767*                                                                *
 21768*            E R R O R   F O R M A T   R O U T I N E             *
 21769*                                                                *
 21770******************************************************************
 21771
 21772 9900-ERROR-FORMAT.
 21773
 21774     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21775                    PB-COMMON-ERROR (2) OR
 21776                    PB-COMMON-ERROR (3) OR
 21777                    PB-COMMON-ERROR (4) OR
 21778                    PB-COMMON-ERROR (5) OR
 21779                    PB-COMMON-ERROR (6) OR
 21780                    PB-COMMON-ERROR (7) OR
 21781                    PB-COMMON-ERROR (8) OR
 21782                    PB-COMMON-ERROR (9) OR
 21783                    PB-COMMON-ERROR (10)
 21784        GO TO 9900-EXIT.
 21785
 21786     IF PB-NO-OF-ERRORS = +10
 21787        GO TO 9900-EXIT.
 21788
 21789     ADD +1  TO PB-NO-OF-ERRORS.
 21790     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21791                                       (PB-NO-OF-ERRORS).
 21792 9900-EXIT.
 21793     EXIT.
 21794
 21795 9990-RETURN.
 21796     IF BROWSE-STARTED
 21797
 21798* EXEC CICS ENDBR
 21799*            DATASET  (ACCT-ID)
 21800*       END-EXEC.
 21801     MOVE 0
 21802       TO DFHEIV11
 21803*    MOVE '&2                    $   #00020210' TO DFHEIV0
 21804     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21805     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21806     MOVE X'2020233030303230323130' TO DFHEIV0(25:11)
 21807     CALL 'kxdfhei1' USING DFHEIV0,
 21808           ACCT-ID,
 21809           DFHEIV11,
 21810           DFHEIV99
 21811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21812
 21813
 21814 9990-EXIT.
 21815     EXIT.
 21816
 21817
 21818****Check for CRTO record, add one if not found.
 21819 9991-CHECK-FOR-ELCRTO.
 21820
 21821* EXEC CICS HANDLE CONDITION
 21822*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 405
* EL050.cbl
 21823*         ENDFILE (9991-CRTO-NOT-FOUND)
 21824*     END-EXEC.
 21825*    MOVE '"$I''                  ! A #00020220' TO DFHEIV0
 21826     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21828     MOVE X'4120233030303230323230' TO DFHEIV0(25:11)
 21829     CALL 'kxdfhei1' USING DFHEIV0
 21830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21831
 21832     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21833     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21834     MOVE +0                     TO ELCRTO-SEQ-NO
 21835
 21836
 21837* EXEC CICS READ
 21838*       DATASET   ('ELCRTO')
 21839*       INTO      (ORIGINAL-CERTIFICATE)
 21840*       RIDFLD    (ELCRTO-KEY)
 21841*       GTEQ
 21842*       RESP      (WS-RESPONSE)
 21843*    END-EXEC
 21844     MOVE LENGTH OF
 21845      ORIGINAL-CERTIFICATE
 21846       TO DFHEIV11
 21847     MOVE 'ELCRTO' TO DFHEIV1
 21848*    MOVE '&"IL       G          (  N#00020228' TO DFHEIV0
 21849     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21851     MOVE X'204E233030303230323238' TO DFHEIV0(25:11)
 21852     CALL 'kxdfhei1' USING DFHEIV0,
 21853           DFHEIV1,
 21854           ORIGINAL-CERTIFICATE,
 21855           DFHEIV11,
 21856           ELCRTO-KEY,
 21857           DFHEIV99,
 21858           DFHEIV99,
 21859           DFHEIV99
 21860     MOVE EIBRESP  TO WS-RESPONSE
 21861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21862
 21863     IF WS-RESP-NORMAL
 21864        AND (OC-CONTROL-PRIMARY (1:33) =
 21865                 PB-CONTROL-BY-ACCOUNT (1:33))
 21866        AND (OC-RECORD-TYPE =  'I')
 21867           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21868               GO TO 9991-CHECK-INDICATORS
 21869           ELSE
 21870               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21871               GO TO 9991-CRTO-ADD-REC
 21872           END-IF
 21873     END-IF.
 21874
 21875 9991-CRTO-NOT-FOUND.
 21876
 21877     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21878     MOVE 'OC'                TO OC-RECORD-ID
 21879     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21880                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 406
* EL050.cbl
 21881     MOVE +4096               TO OC-KEY-SEQ-NO.
 21882
 21883 9991-CRTO-ADD-REC.
 21884
 21885     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21886     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21887     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21888     MOVE 'I'                 TO OC-RECORD-TYPE
 21889     IF PB-ISSUE
 21890         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21891         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21892         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21893         MOVE PB-I-AGE               TO OC-INS-AGE
 21894         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21895         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21896         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21897         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21898         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21899         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21900         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21901         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21902         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21903         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21904         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21905         IF PB-I-JOINT-COMMISSION > +0
 21906             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21907         ELSE
 21908             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21909         END-IF
 21910         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21911         MOVE +0                     TO OC-LF-CANCEL-AMT
 21912                                        OC-LF-ITD-CANCEL-AMT
 21913         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21914         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21915         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21916         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21917         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21918         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21919         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21920         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21921         MOVE +0                     TO OC-AH-CANCEL-AMT
 21922                                        OC-AH-ITD-CANCEL-AMT
 21923         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21924         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21925         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21926     ELSE
 21927         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21928         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21929         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21930         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21931         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21932         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21933         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21934         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21935         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21936          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21937             MOVE SPACES             TO OC-LF-BENCD
 21938             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 407
* EL050.cbl
 21939                                        OC-LF-BEN-AMT
 21940                                        OC-LF-PRM-AMT
 21941                                        OC-LF-ALT-BEN-AMT
 21942                                        OC-LF-ALT-PRM-AMT
 21943                                        OC-LF-COMM-PCT
 21944                                        OC-LF-CANCEL-AMT
 21945             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21946             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21947         ELSE
 21948             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21949             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21950             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21951             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21952             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21953             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21954             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21955             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21956             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21957             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21958         END-IF
 21959         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21960         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21961          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21962             MOVE SPACES             TO OC-AH-BENCD
 21963             MOVE ZEROS              TO OC-AH-TERM
 21964                                        OC-AH-BEN-AMT
 21965                                        OC-AH-PRM-AMT
 21966                                        OC-AH-COMM-PCT
 21967                                        OC-AH-CANCEL-AMT
 21968                                        OC-AH-CP
 21969             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21970             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21971         ELSE
 21972             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21973             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21974             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21975             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21976             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21977             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21978             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21979             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21980             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21981         END-IF
 21982         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21983         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21984         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21985         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21986     END-IF
 21987     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21988
 21989     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21990
 21991
 21992* EXEC CICS READ
 21993*         DATASET   (FILE-ERMAIL)
 21994*         RIDFLD    (MA-CONTROL-PRIMARY)
 21995*         INTO      (MAILING-DATA)
 21996*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 408
* EL050.cbl
 21997*    END-EXEC
 21998     MOVE LENGTH OF
 21999      MAILING-DATA
 22000       TO DFHEIV11
 22001*    MOVE '&"IL       E          (  N#00020364' TO DFHEIV0
 22002     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22004     MOVE X'204E233030303230333634' TO DFHEIV0(25:11)
 22005     CALL 'kxdfhei1' USING DFHEIV0,
 22006           FILE-ERMAIL,
 22007           MAILING-DATA,
 22008           DFHEIV11,
 22009           MA-CONTROL-PRIMARY,
 22010           DFHEIV99,
 22011           DFHEIV99,
 22012           DFHEIV99
 22013     MOVE EIBRESP  TO WS-RESPONSE
 22014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22015
 22016     IF WS-RESP-NORMAL
 22017         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22018     END-IF.
 22019
 22020     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22021     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22022
 22023
 22024* EXEC CICS READ
 22025*         DATASET  (CRTT-ID)
 22026*         RIDFLD   (WS-ELCRTT-KEY)
 22027*         INTO     (CERTIFICATE-TRAILERS)
 22028*         RESP     (WS-RESPONSE)
 22029*    END-EXEC
 22030     MOVE LENGTH OF
 22031      CERTIFICATE-TRAILERS
 22032       TO DFHEIV11
 22033*    MOVE '&"IL       E          (  N#00020378' TO DFHEIV0
 22034     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22036     MOVE X'204E233030303230333738' TO DFHEIV0(25:11)
 22037     CALL 'kxdfhei1' USING DFHEIV0,
 22038           CRTT-ID,
 22039           CERTIFICATE-TRAILERS,
 22040           DFHEIV11,
 22041           WS-ELCRTT-KEY,
 22042           DFHEIV99,
 22043           DFHEIV99,
 22044           DFHEIV99
 22045     MOVE EIBRESP  TO WS-RESPONSE
 22046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22047
 22048     IF WS-RESP-NORMAL
 22049         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22050         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22051     END-IF.
 22052
 22053
 22054* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 409
* EL050.cbl
 22055*       DATASET   ('ELCRTO')
 22056*       FROM      (ORIGINAL-CERTIFICATE)
 22057*       RIDFLD    (OC-CONTROL-PRIMARY)
 22058*       RESP      (WS-RESPONSE)
 22059*    END-EXEC.
 22060     MOVE LENGTH OF
 22061      ORIGINAL-CERTIFICATE
 22062       TO DFHEIV11
 22063     MOVE 'ELCRTO' TO DFHEIV1
 22064*    MOVE '&$ L                  ''  N#00020390' TO DFHEIV0
 22065     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22067     MOVE X'204E233030303230333930' TO DFHEIV0(25:11)
 22068     CALL 'kxdfhei1' USING DFHEIV0,
 22069           DFHEIV1,
 22070           ORIGINAL-CERTIFICATE,
 22071           DFHEIV11,
 22072           OC-CONTROL-PRIMARY,
 22073           DFHEIV99,
 22074           DFHEIV99
 22075     MOVE EIBRESP  TO WS-RESPONSE
 22076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22077
 22078
 22079     GO TO 9991-EXIT.
 22080
 22081 9991-CHECK-INDICATORS.
 22082
 22083     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22084         GO TO 9991-EXIT
 22085     END-IF.
 22086
 22087     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22088         GO TO 9991-EXIT
 22089     END-IF.
 22090
 22091
 22092* EXEC CICS READ
 22093*       DATASET   ('ELCRTO')
 22094*       INTO      (ORIGINAL-CERTIFICATE)
 22095*       RIDFLD    (OC-CONTROL-PRIMARY)
 22096*       UPDATE
 22097*       RESP      (WS-RESPONSE)
 22098*    END-EXEC
 22099     MOVE LENGTH OF
 22100      ORIGINAL-CERTIFICATE
 22101       TO DFHEIV11
 22102     MOVE 'ELCRTO' TO DFHEIV1
 22103*    MOVE '&"IL       EU         (  N#00020409' TO DFHEIV0
 22104     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22105     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22106     MOVE X'204E233030303230343039' TO DFHEIV0(25:11)
 22107     CALL 'kxdfhei1' USING DFHEIV0,
 22108           DFHEIV1,
 22109           ORIGINAL-CERTIFICATE,
 22110           DFHEIV11,
 22111           OC-CONTROL-PRIMARY,
 22112           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 410
* EL050.cbl
 22113           DFHEIV99,
 22114           DFHEIV99
 22115     MOVE EIBRESP  TO WS-RESPONSE
 22116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22117     IF WS-RESP-NORMAL
 22118        IF PB-ISSUE
 22119          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22120          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22121          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22122          MOVE PB-I-AGE               TO OC-INS-AGE
 22123          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22124          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22125          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22126          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22127          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22128          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22129          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22130          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22131          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22132          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22133          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22134          IF PB-I-JOINT-COMMISSION > +0
 22135              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22136          ELSE
 22137              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22138          END-IF
 22139          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22140          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22141          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22142          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22143          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22144          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22145          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22146          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22147          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22148
 22149          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22150
 22151* EXEC CICS READ
 22152*             DATASET   (FILE-ERMAIL)
 22153*             RIDFLD    (MA-CONTROL-PRIMARY)
 22154*             INTO      (MAILING-DATA)
 22155*             RESP      (WS-RESPONSE)
 22156*         END-EXEC
 22157     MOVE LENGTH OF
 22158      MAILING-DATA
 22159       TO DFHEIV11
 22160*    MOVE '&"IL       E          (  N#00020449' TO DFHEIV0
 22161     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22163     MOVE X'204E233030303230343439' TO DFHEIV0(25:11)
 22164     CALL 'kxdfhei1' USING DFHEIV0,
 22165           FILE-ERMAIL,
 22166           MAILING-DATA,
 22167           DFHEIV11,
 22168           MA-CONTROL-PRIMARY,
 22169           DFHEIV99,
 22170           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 411
* EL050.cbl
 22171           DFHEIV99
 22172     MOVE EIBRESP  TO WS-RESPONSE
 22173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22174          IF WS-RESP-NORMAL
 22175             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22176          END-IF
 22177
 22178          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22179          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22180
 22181* EXEC CICS READ
 22182*             DATASET  (CRTT-ID)
 22183*             RIDFLD   (WS-ELCRTT-KEY)
 22184*             INTO     (CERTIFICATE-TRAILERS)
 22185*             RESP     (WS-RESPONSE)
 22186*         END-EXEC
 22187     MOVE LENGTH OF
 22188      CERTIFICATE-TRAILERS
 22189       TO DFHEIV11
 22190*    MOVE '&"IL       E          (  N#00020461' TO DFHEIV0
 22191     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22192     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22193     MOVE X'204E233030303230343631' TO DFHEIV0(25:11)
 22194     CALL 'kxdfhei1' USING DFHEIV0,
 22195           CRTT-ID,
 22196           CERTIFICATE-TRAILERS,
 22197           DFHEIV11,
 22198           WS-ELCRTT-KEY,
 22199           DFHEIV99,
 22200           DFHEIV99,
 22201           DFHEIV99
 22202     MOVE EIBRESP  TO WS-RESPONSE
 22203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22204          IF WS-RESP-NORMAL
 22205             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22206                               OC-INS-AGE-DEFAULT-FLAG
 22207             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22208                               OC-JNT-AGE-DEFAULT-FLAG
 22209          END-IF
 22210
 22211        ELSE
 22212          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22213             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22214             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22215             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22216          END-IF
 22217          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22218             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22219             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22220             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22221          END-IF
 22222          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22223        END-IF
 22224
 22225* EXEC CICS REWRITE
 22226*          DATASET   ('ELCRTO')
 22227*          FROM      (ORIGINAL-CERTIFICATE)
 22228*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 412
* EL050.cbl
 22229*       END-EXEC
 22230     MOVE LENGTH OF
 22231      ORIGINAL-CERTIFICATE
 22232       TO DFHEIV11
 22233     MOVE 'ELCRTO' TO DFHEIV1
 22234*    MOVE '&& L                  %  N#00020487' TO DFHEIV0
 22235     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22236     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22237     MOVE X'204E233030303230343837' TO DFHEIV0(25:11)
 22238     CALL 'kxdfhei1' USING DFHEIV0,
 22239           DFHEIV1,
 22240           ORIGINAL-CERTIFICATE,
 22241           DFHEIV11,
 22242           DFHEIV99
 22243     MOVE EIBRESP  TO WS-RESPONSE
 22244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22245     END-IF.
 22246
 22247 9991-EXIT.
 22248     EXIT.
 22249
 22250
 22251 9999-RETURN.
 22252     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22253
 22254
 22255* EXEC CICS RETURN
 22256*    END-EXEC.
 22257*    MOVE '.(                    ''   #00020501' TO DFHEIV0
 22258     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22259     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22260     MOVE X'2020233030303230353031' TO DFHEIV0(25:11)
 22261     CALL 'kxdfhei1' USING DFHEIV0,
 22262           DFHEIV99,
 22263           DFHEIV99,
 22264           DFHEIV99,
 22265           DFHEIV99,
 22266           DFHEIV99,
 22267           DFHEIV99
 22268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22269
 22270
 22271
 22272* GOBACK.
 22273     MOVE '9%                    "   ' TO DFHEIV0
 22274     MOVE 'EL050' TO DFHEIV1
 22275     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22276     GOBACK.
 22277
 22278 9999-DFHBACK SECTION.
 22279     MOVE '9%                    "   ' TO DFHEIV0
 22280     MOVE 'EL050' TO DFHEIV1
 22281     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22282     GOBACK.
 22283 9999-DFHEXIT.
 22284     IF DFHEIGDJ EQUAL 0001
 22285         NEXT SENTENCE
 22286     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 413
* EL050.cbl
 22287         GO TO 9300-ABEND,
 22288               3990-FILES-NOT-OPEN
 22289         DEPENDING ON DFHEIGDI
 22290     ELSE IF DFHEIGDJ EQUAL 3
 22291         GO TO 6610-START-BROWSE,
 22292               6630-ERRESS-PROBLEM,
 22293               6630-END-OF-FILE
 22294         DEPENDING ON DFHEIGDI
 22295     ELSE IF DFHEIGDJ EQUAL 4
 22296         GO TO 6630-END-OF-FILE,
 22297               6630-ERRESS-PROBLEM,
 22298               6630-ERRESS-PROBLEM,
 22299               6630-END-OF-FILE
 22300         DEPENDING ON DFHEIGDI
 22301     ELSE IF DFHEIGDJ EQUAL 5
 22302         GO TO 6630-END-OF-FILE,
 22303               6630-END-OF-FILE,
 22304               6630-ERRESS-PROBLEM,
 22305               6630-ERRESS-PROBLEM
 22306         DEPENDING ON DFHEIGDI
 22307     ELSE IF DFHEIGDJ EQUAL 6
 22308         GO TO 6660-START-BROWSE,
 22309               6690-ERRESC-PROBLEM,
 22310               6690-ERRESC-PROBLEM,
 22311               6690-END-OF-FILE
 22312         DEPENDING ON DFHEIGDI
 22313     ELSE IF DFHEIGDJ EQUAL 7
 22314         GO TO 6690-END-OF-FILE,
 22315               6690-ERRESC-PROBLEM,
 22316               6690-ERRESC-PROBLEM,
 22317               6690-END-OF-FILE
 22318         DEPENDING ON DFHEIGDI
 22319     ELSE IF DFHEIGDJ EQUAL 8
 22320         GO TO 6690-END-OF-FILE,
 22321               6690-ERRESC-PROBLEM,
 22322               6690-ERRESC-PROBLEM,
 22323               6690-END-OF-FILE
 22324         DEPENDING ON DFHEIGDI
 22325     ELSE IF DFHEIGDJ EQUAL 9
 22326         GO TO 7250-CONTINUE,
 22327               7250-CONTINUE
 22328         DEPENDING ON DFHEIGDI
 22329     ELSE IF DFHEIGDJ EQUAL 10
 22330         GO TO 7300-CONTINUE,
 22331               7300-CONTINUE
 22332         DEPENDING ON DFHEIGDI
 22333     ELSE IF DFHEIGDJ EQUAL 11
 22334         GO TO 8000-FREE-MAIN
 22335         DEPENDING ON DFHEIGDI
 22336     ELSE IF DFHEIGDJ EQUAL 12
 22337         GO TO 8100-NOTFND,
 22338               8100-NOTFND
 22339         DEPENDING ON DFHEIGDI
 22340     ELSE IF DFHEIGDJ EQUAL 13
 22341         GO TO 8110-NOTFND,
 22342               8110-NOTFND
 22343         DEPENDING ON DFHEIGDI
 22344     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 414
* EL050.cbl
 22345         GO TO 8130-EXIT
 22346         DEPENDING ON DFHEIGDI
 22347     ELSE IF DFHEIGDJ EQUAL 15
 22348         GO TO 8150-exit
 22349         DEPENDING ON DFHEIGDI
 22350     ELSE IF DFHEIGDJ EQUAL 16
 22351         GO TO 8180-NOTFND
 22352         DEPENDING ON DFHEIGDI
 22353     ELSE IF DFHEIGDJ EQUAL 17
 22354         GO TO 8190-NOTFND
 22355         DEPENDING ON DFHEIGDI
 22356     ELSE IF DFHEIGDJ EQUAL 18
 22357         GO TO 8195-NOTFND
 22358         DEPENDING ON DFHEIGDI
 22359     ELSE IF DFHEIGDJ EQUAL 19
 22360         GO TO 8200-NOTFND
 22361         DEPENDING ON DFHEIGDI
 22362     ELSE IF DFHEIGDJ EQUAL 20
 22363         GO TO 8300-NOTFND,
 22364               8300-ERRESS-PROBLEM,
 22365               8300-ERRESS-PROBLEM,
 22366               8300-NOTFND
 22367         DEPENDING ON DFHEIGDI
 22368     ELSE IF DFHEIGDJ EQUAL 21
 22369         GO TO 8450-FORM-NOT-FOUND,
 22370               8450-FORM-NOT-FOUND
 22371         DEPENDING ON DFHEIGDI
 22372     ELSE IF DFHEIGDJ EQUAL 22
 22373         GO TO 0199-ACCT-NOT-FOUND,
 22374               0199-ACCT-NOT-FOUND
 22375         DEPENDING ON DFHEIGDI
 22376     ELSE IF DFHEIGDJ EQUAL 23
 22377         GO TO 0199-ACCT-NOT-FOUND,
 22378               0199-ACCT-NOT-FOUND
 22379         DEPENDING ON DFHEIGDI
 22380     ELSE IF DFHEIGDJ EQUAL 24
 22381         GO TO 8582-COMP-NOT-FOUND,
 22382               8582-COMP-NOT-FOUND
 22383         DEPENDING ON DFHEIGDI
 22384     ELSE IF DFHEIGDJ EQUAL 25
 22385         GO TO 8583-AGTC-NOT-FOUND,
 22386               8583-AGTC-NOT-FOUND
 22387         DEPENDING ON DFHEIGDI
 22388     ELSE IF DFHEIGDJ EQUAL 26
 22389         GO TO 8584-BXRF-NOT-FOUND,
 22390               8584-BXRF-NOT-FOUND
 22391         DEPENDING ON DFHEIGDI
 22392     ELSE IF DFHEIGDJ EQUAL 27
 22393         GO TO 8585-PLAN-NOT-FOUND,
 22394               8585-PLAN-NOT-FOUND
 22395         DEPENDING ON DFHEIGDI
 22396     ELSE IF DFHEIGDJ EQUAL 28
 22397         GO TO 0299-CERT-NOT-FOUND
 22398         DEPENDING ON DFHEIGDI
 22399     ELSE IF DFHEIGDJ EQUAL 29
 22400         GO TO 8700-READ-CERT-MASTER
 22401         DEPENDING ON DFHEIGDI
 22402     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 27-May-16 10:37 Page 415
* EL050.cbl
 22403         GO TO 8720-COMP-ACCOUNTS,
 22404               8730-END-BROWSE,
 22405               8740-NOT-FOUND
 22406         DEPENDING ON DFHEIGDI
 22407     ELSE IF DFHEIGDJ EQUAL 31
 22408         GO TO 9000-NOTFND
 22409         DEPENDING ON DFHEIGDI
 22410     ELSE IF DFHEIGDJ EQUAL 32
 22411         GO TO 9100-NOTFND,
 22412               9100-NOTFND
 22413         DEPENDING ON DFHEIGDI
 22414     ELSE IF DFHEIGDJ EQUAL 33
 22415         GO TO 9991-CRTO-NOT-FOUND,
 22416               9991-CRTO-NOT-FOUND
 22417         DEPENDING ON DFHEIGDI.
 22418     MOVE '9%                    "   ' TO DFHEIV0
 22419     MOVE 'EL050' TO DFHEIV1
 22420     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22421     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40696     Code:       91544
