* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   1
* EL691.cbl
* Options: int("EL691.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL691.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL691.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL691.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL691.
     5*
     6*AUTHOR.    LOGIC, INC.
     7*           DALLAS, TEXAS.
     8
     9*DATE-COMPILED.
    10
    11*REMARKS.
    12*        THIS PROGRAM PROVIDES THE FUNCTIONS TO BROWSE AND EDIT
    13*    THE DETAIL OF AN ARCHIVED LETTER.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   2
* EL691.cbl
    14
    15*    TRANS ID = EXN1
    16
    17******************************************************************
    18*                   C H A N G E   L O G
    19*
    20* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    21*-----------------------------------------------------------------
    22*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    23* EFFECTIVE    NUMBER
    24*-----------------------------------------------------------------
    25* 071111    2011022800001  AJRA  NAPERSOFT - NEW SCREEN
    26* 100312    2011022800001  AJRA  CHANGE RECEIVED MSG
    27* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTE, ENDT ARCH N
    28* 122612    2012101700002  AJRA  UPDATE BILLING NOTE ON RECEIVED
    29* 100813    2013100700002  AJRA  VERITY RESEND LETTER ID ON CHANGE
    30* 102918  CR2018080300002  PEMA  ADD VOID OB LETTER OPTION
    31******************************************************************
    32
    33 DATA DIVISION.
    34 WORKING-STORAGE SECTION.
    35 01  DFH-START PIC X(04).
    36 77  FILLER  PIC X(32) VALUE '********************************'.
    37 77  FILLER  PIC X(32) VALUE '*    EL691 WORKING STORAGE     *'.
    38 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    39 77  c1                          pic s9(5) comp-3 value +0.
    40 77  n1                          pic s999  comp-3 value +0.
    41 77  w-comment-line-cnt          pic s999 comp-3 value +0.
    42 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    43 77  note-count                  pic s999 comp-3 value +0.
    44 77  ws-build-note-sw            pic x value ' '.
    45     88  finished-with-notes      value 'Y'.
    46 77  ws-ercnot-sw                pic x  value spaces.
    47     88  ercnot-startbr            value 'Y'.
    48
    49 01  P pointer.
    50 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    51 01  var-ptr pointer.
    52 01  env-var-len                 pic 9(4)  binary.
    53 01  rc                          pic 9(9)  binary.
    54
    55 01  WS-KIXSYS.
    56     05  WS-KIX-FIL1             PIC X(10).
    57     05  WS-KIX-APPS             PIC X(10).
    58     05  WS-KIX-ENV              PIC X(10).
    59     05  WS-KIX-MYENV            PIC X(10).
    60     05  WS-KIX-SYS              PIC X(10).
*   61 EXEC SQL
*   62    INCLUDE SQLDA
*   63 END-EXEC
    64 01 SQLDA sync.
    65    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    66    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    67    05 SQLN                  PIC S9(4) COMP-5 value 0.
    68    05 SQLD                  PIC S9(4) COMP-5 value 0.
    69    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    70       10 SQLTYPE            PIC S9(4) COMP-5.
    71       10 SQLLEN             PIC S9(4) COMP-5.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   3
* EL691.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72$IF P64 SET
    73X      *> For 64-bit environments, ensure that SQLDATA is
    74X      *> aligned on an 8-byte boundary.
    75X      10 FILLER             PIC S9(9) COMP-5.
    76$END
    77       10 SQLDATA            USAGE POINTER.
    78       10 SQLIND             USAGE POINTER.
    79       10 SQLNAME.
    80          15 SQLNAMEL        PIC S9(4) COMP-5.
    81          15 SQLNAMEC        PIC X(30).
    82
    83* Values for SQLTYPE
    84
    85 78  ESQL-DATE-CHAR              VALUE 384.
    86 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    87 78  ESQL-DATE-REC               VALUE 386.
    88 78  ESQL-DATE-REC-NULL          VALUE 387.
    89 78  ESQL-TIME-CHAR              VALUE 388.
    90 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    91 78  ESQL-TIME-REC               VALUE 390.
    92 78  ESQL-TIME-REC-NULL          VALUE 391.
    93 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
    94 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
    95 78  ESQL-TIMESTAMP-REC          VALUE 394.
    96 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
    97 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
    98 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
    99 78  ESQL-TS-OFFSET-REC          VALUE 398.
   100 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   101 78  ESQL-LONGVARBINARY          VALUE 404.
   102 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   103 78  ESQL-LONGVARCHAR            VALUE 408.
   104 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   105 78  ESQL-BINARY                 VALUE 444.
   106 78  ESQL-BINARY-NULL            VALUE 445.
   107 78  ESQL-VARBINARY              VALUE 446.
   108 78  ESQL-VARBINARY-NULL         VALUE 447.
   109 78  ESQL-VARCHAR                VALUE 448.
   110 78  ESQL-VARCHAR-NULL           VALUE 449.
   111
   112 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   113 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   114
   115 78  ESQL-CHAR                   VALUE 452.
   116 78  ESQL-CHAR-NULL              VALUE 453.
   117
   118 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   119 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   120
   121 78  ESQL-DOUBLE                 VALUE 480.
   122 78  ESQL-DOUBLE-NULL            VALUE 481.
   123 78  ESQL-REAL                   VALUE 482.
   124 78  ESQL-REAL-NULL              VALUE 483.
   125 78  ESQL-DECIMAL                VALUE 484.
   126 78  ESQL-DECIMAL-NULL           VALUE 485.
   127 78  ESQL-INTEGER                VALUE 496.
   128 78  ESQL-INTEGER-NULL           VALUE 497.
   129 78  ESQL-SMALLINT               VALUE 500.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   4
* EL691.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-SMALLINT-NULL          VALUE 501.
   131 78  ESQL-TINYINT                VALUE 502.
   132 78  ESQL-TINYINT-NULL           VALUE 503.
*  133 EXEC SQL
*  134    INCLUDE SQLCA
*  135 END-EXEC
   136 01 SQLCA.
   137     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   138     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   139     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   140     05  SQLERRM.
   141         49  SQLERRML    PIC S9(4) COMP-5.
   142         49  SQLERRMC    PIC X(70).
   143     05  SQLERRP         PIC X(8).
   144     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   145     05  SQLWARN.
   146         10  SQLWARN0    PIC X.
   147         10  SQLWARN1    PIC X.
   148         10  SQLWARN2    PIC X.
   149         10  SQLWARN3    PIC X.
   150         10  SQLWARN4    PIC X.
   151         10  SQLWARN5    PIC X.
   152         10  SQLWARN6    PIC X.
   153         10  SQLWARN7    PIC X.
   154     05  SQLEXT.
   155         10  SQLWARN8    PIC X.
   156         10  SQLWARN9    PIC X.
   157         10  SQLWARN10   PIC X.
   158         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   159     05  SQLSTATE    PIC X(5).
   160 EXEC SQL
   161    BEGIN DECLARE SECTION
   162 END-EXEC
   163 01  sqlcmd                      pic x(1024).
   164 01  WS-MOE-DATE                 pic x(10).
   165 01  svr                         pic x(32).
   166 01  usr                         pic x(32).
   167 01  pass                        pic x(32).
   168 01  usr-pass                    pic x(64).
   169 01  ws-sql-code                 pic s9(7) value zeros.
   170 01  ws-dis-sql-code             pic -9999999 value zeros.
   171***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   172***                                                            ***
   173***  These indicators are used to determine if a variable      ***
   174***  is passed nulls from sql. The indicator will be -1        ***
   175***  if the value on sql is nulls and +0 if the value is       ***
   176***  something other than nulls. Here is an example on how     ***
   177***  to use the indicator variables.                           ***
   178***                                                            ***
   179***     EXEC SQL                                               ***
   180***        fetch keyword into                                  ***
   181***           :db-Complete-dt :nu-Complete-date,               ***
   182***           :db-app-by     :nu-app-by,                       ***
   183***           :db-app-date   :nu-app-date,                     ***
   184***           :db-app-batch  :nu-app-batch                     ***
   185***     END-EXEC                                               ***
   186***                                                            ***
   187***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   5
* EL691.cbl
   188 01  indicator-vaiables-for-nulls.
   189     05  nu-Complete-date        pic s9(4) comp value +0.
   190 01  key-word-key-data.
   191     05  kd-unique-id            pic 9(7).
   192     05  kd-cert-no              pic x(11).
   193 01  key-word-table-data.
   194     05  db-req-date             pic x(10).
   195     05  db-doc-type             pic x(30).
   196     05  db-Cert-no              pic x(11).
   197     05  db-Print-dt             pic x(10).
   198     05  db-Cert-exp-dt          pic x(10).
   199     05  db-cert-state           pic xx.
   200     05  db-key-word-type        pic x(30).
   201     05  db-key-word-value       pic x(30).
   202     05  db-complete-dt          pic x(10).
   203 EXEC SQL
   204    END DECLARE SECTION
   205 END-EXEC
   206
   207 01  W-WORK-AREAS.
   208     12  ws-sql-update-sw        pic x value ' '.
   209         88  sql-update-succeeded    value 'Y'.
   210         88  sql-update-failed       value 'N'.
   211     12  ws-connect-sw           pic x  value ' '.
   212         88  connected-to-db        value 'Y'.
   213     12  ws-cert-sw              pic x value ' '.
   214         88  cert-found             value 'Y'.
   215     12  FILLER                  PIC  X(18)
   216                                      VALUE 'PROGRAM WORK AREA:'.
   217     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   218     12  W-CALL-PGM              PIC  X(08).
   219     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   220     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   221     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   222
   223     12  W-TIME-IN               PIC S9(07).
   224     12  FILLER REDEFINES W-TIME-IN.
   225         16  FILLER              PIC  X(01).
   226         16  W-TIME-OUT          PIC  9(02)V9(02).
   227         16  FILLER              PIC  X(02).
   228
   229     12  W-DEEDIT-FIELD          PIC  X(15).
   230     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   231
   232     12  W-ERROR-COUNT           PIC S9(3)       VALUE ZERO.
   233     12  W-UPDATE-SW             PIC S9          VALUE ZERO.
   234     12  W-RESEND-DATE           PIC XX    VALUE LOW-VALUES.
   235     12  W-SENT-DATE             PIC XX    VALUE LOW-VALUES.
   236     12  W-FINAL-ACT-DATE        PIC XX    VALUE LOW-VALUES.
   237     12  W-RECEIVED-DATE         PIC XX    VALUE LOW-VALUES.
   238     12  W-STOP-LETTER-DATE      PIC XX    VALUE LOW-VALUES.
   239     12  W-RESPONSE              PIC S9(8)   COMP.
   240         88  RESP-NORMAL                  VALUE +00.
   241         88  RESP-NOTFND                  VALUE +13.
   242         88  RESP-DUPREC                  VALUE +14.
   243         88  RESP-DUPKEY                  VALUE +15.
   244         88  RESP-NOTOPEN                 VALUE +19.
   245         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   6
* EL691.cbl
   246         88  resp-lengtherr               value +22.
   247
   248     12  W-ARCH-SAVE-KEY         PIC  X(03).
   249     12  W-ARCH-KEY.
   250         16  W-ARCH-COMPANY-CD   PIC  X(01).
   251         16  W-ARCH-NUMBER       PIC S9(08)      COMP.
   252
   253     12  W-ARCT-KEY.
   254         16  W-ARCT-COMPANY-CD   PIC  X(01).
   255         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
   256         16  W-ARCT-RECORD-TYPE  PIC  X(01).
   257             88  W-ARCT-COMMENT-DATA   VALUE '3'.
   258         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
   259
   260     12  w-stop-letter-comment   pic x(126) value spaces.
   261     12  w-cert-note-comment     pic x(70) value spaces.
   262     12  W-CERT-NOTE-MSG.
   263         16  FILLER              PIC X(29)
   264             VALUE 'REQUESTED DOCUMENT RECEIVED  '.
   265         16  W-CERT-NOTE-RECV-DT PIC X(8).
   266
   267     12  WS-FIND-BILLING-NOTE.
   268         16  WS-FBN-NOTE         PIC X(25).
   269         16  WS-FBN-LTRID        PIC X(4).
   270
   271     12  WS-RECEIVED-NOTE.
   272         16  FILLER              PIC X(12)
   273             VALUE ' - RECEIVED '.
   274         16  WS-BN-RECV-DATE     PIC X(8).
   275
   276     12  WS-Z-RECORD-IND         PIC X(1) VALUE 'N'.
   277         88 Z-RECORD-FOUND                VALUE 'Y'.
   278         88 Z-RECORD-NOT-FOUND            VALUE 'N'.
   279
   280     12  ELCERT-FILE-ID          PIC  X(08)  VALUE 'ELCERT'.
   281     12  ERCNOT-FILE-ID          PIC  X(08)  VALUE 'ERCNOT'.
   282     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   283     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   284     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   285     12  ERCNOT-KEY.
   286         16  ERCNOT-PARTIAL-KEY.
   287             20 ERCNOT-COMPANY-CD    PIC X.
   288             20 ERCNOT-CARRIER       PIC X.
   289             20 ERCNOT-GROUPING      PIC X(06).
   290             20 ERCNOT-STATE         PIC XX.
   291             20 ERCNOT-ACCOUNT       PIC X(10).
   292             20 ERCNOT-EFF-DT        PIC XX.
   293             20 ERCNOT-CERT-NO.
   294                25 ERCNOT-CERT-PRIME PIC X(10).
   295                25 ERCNOT-CERT-SFX   PIC X.
   296             20 ERCNOT-REC-TYP       PIC X.
   297         16 ERCNOT-SEQ           PIC S9(4) COMP.
   298     12  SV-PRIOR-KEY.
   299         16 SV-COMPANY-CD            PIC X.
   300         16 SV-CARRIER               PIC X.
   301         16 SV-GROUPING              PIC X(06).
   302         16 SV-STATE                 PIC XX.
   303         16 SV-ACCOUNT               PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   7
* EL691.cbl
   304         16 SV-EFF-DT                PIC XX.
   305         16 SV-CERT-NO.
   306            20 SV-CERT-PRIME         PIC X(10).
   307            20 SV-CERT-SFX           PIC X(1).
   308         16 SV-REC-TYP               PIC X.
   309         16  SV-NOTE-SEQUENCE        PIC S9(4) COMP.
   310     12  ELCERT-KEY.
   311         16  ELCERT-COMPANY-CD        PIC X.
   312         16  ELCERT-CARRIER           PIC X.
   313         16  ELCERT-GROUPING          PIC X(6).
   314         16  ELCERT-STATE             PIC XX.
   315         16  ELCERT-ACCOUNT           PIC X(10).
   316         16  ELCERT-EFF-DT            PIC XX.
   317         16  ELCERT-CERT-NO.
   318             20  ELCERT-CERT-PRIME    PIC X(10).
   319             20  ELCERT-CERT-SFX      PIC X.
   320     12  ELEOBC-FILE-ID          PIC X(08)  VALUE 'ELEOBC'.
   321     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   322     12  ELEOBC-KEY.
   323         16  EOBC-COMPANY-CD     PIC X.
   324         16  EOBC-REC-TYPE       PIC X.
   325         16  EOBC-CODE           PIC X(4).
   326         16  FILLER              PIC X(9).
   327     12  ERNOTE-FILE-ID          PIC X(08)  VALUE 'ERNOTE'.
   328     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   329     12  ERNOTE-KEY.
   330         16  ERNOTE-COMPANY-CD   PIC X.
   331         16  ERNOTE-CARRIER      PIC X.
   332         16  ERNOTE-GROUPING     PIC X(6).
   333         16  ERNOTE-STATE        PIC XX.
   334         16  ERNOTE-ACCOUNT      PIC X(10).
   335         16  ERNOTE-CERT-EFF-DT  PIC XX.
   336         16  ERNOTE-CERT-PRIME   PIC X(10).
   337         16  ERNOTE-CERT-SFX     PIC X.
   338     12  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
   339     12  ELLETR-KEY.
   340         16  LETR-PART-KEY.
   341             20  LETR-COMPANY-CD PIC X.
   342             20  LETR-LETTER-ID  PIC X(4).
   343         16  LETR-FILLER         PIC X(8).
   344         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   345     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   346 01  w-comment-line-1            pic x(63) value spaces.
   347 01  w-comment-line-2            pic x(63) value spaces.
   348 01  cert-note-records-holder.
   349     05  cert-note-record occurs 500.
   350         10  filler              pic x(48).
   351         10  cnr-rest            pic x(102).
   352
   353
   354 01  FILLER                      PIC  X(22)
   355                                 VALUE 'INTERFACE AREA STARTS:'.
   356*    COPY ELCINTF.
   357******************************************************************
   358*                                                                *
   359*                                                                *
   360*                            ELCINTF.                            *
   361*                            VMOD=2.017                          *
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   8
* EL691.cbl
   362*                                                                *
   363*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   364*                                                                *
   365*       LENGTH = 1024                                            *
   366*                                                                *
   367******************************************************************
   368*                   C H A N G E   L O G
   369*
   370* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   371*-----------------------------------------------------------------
   372*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   373* EFFECTIVE    NUMBER
   374*-----------------------------------------------------------------
   375* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   376******************************************************************
   377 01  PROGRAM-INTERFACE-BLOCK.
   378     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   379     12  PI-CALLING-PROGRAM              PIC X(8).
   380     12  PI-SAVED-PROGRAM-1              PIC X(8).
   381     12  PI-SAVED-PROGRAM-2              PIC X(8).
   382     12  PI-SAVED-PROGRAM-3              PIC X(8).
   383     12  PI-SAVED-PROGRAM-4              PIC X(8).
   384     12  PI-SAVED-PROGRAM-5              PIC X(8).
   385     12  PI-SAVED-PROGRAM-6              PIC X(8).
   386     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   387     12  PI-COMPANY-ID                   PIC XXX.
   388     12  PI-COMPANY-CD                   PIC X.
   389
   390     12  PI-COMPANY-PASSWORD             PIC X(8).
   391
   392     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   393
   394     12  PI-CONTROL-IN-PROGRESS.
   395         16  PI-CARRIER                  PIC X.
   396         16  PI-GROUPING                 PIC X(6).
   397         16  PI-STATE                    PIC XX.
   398         16  PI-ACCOUNT                  PIC X(10).
   399         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   400                                         PIC X(10).
   401         16  PI-CLAIM-CERT-GRP.
   402             20  PI-CLAIM-NO             PIC X(7).
   403             20  PI-CERT-NO.
   404                 25  PI-CERT-PRIME       PIC X(10).
   405                 25  PI-CERT-SFX         PIC X.
   406             20  PI-CERT-EFF-DT          PIC XX.
   407         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   408             20  PI-PLAN-CODE            PIC X(2).
   409             20  PI-REVISION-NUMBER      PIC X(3).
   410             20  PI-PLAN-EFF-DT          PIC X(2).
   411             20  PI-PLAN-EXP-DT          PIC X(2).
   412             20  FILLER                  PIC X(11).
   413         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   414             20  PI-OE-REFERENCE-1.
   415                 25  PI-OE-REF-1-PRIME   PIC X(18).
   416                 25  PI-OE-REF-1-SUFF    PIC XX.
   417
   418     12  PI-SESSION-IN-PROGRESS          PIC X.
   419         88  CLAIM-SESSION                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page   9
* EL691.cbl
   420         88  CREDIT-SESSION                  VALUE '2'.
   421         88  WARRANTY-SESSION                VALUE '3'.
   422         88  MORTGAGE-SESSION                VALUE '4'.
   423         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   424
   425
   426*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   427
   428     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   429     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   430
   431     12  PI-CREDIT-USER                  PIC X.
   432         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   433         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   434
   435     12  PI-CLAIM-USER                   PIC X.
   436         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   437         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   438
   439     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   440         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   441         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   442         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   443         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   444         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   445
   446     12  PI-PROCESSOR-ID                 PIC X(4).
   447
   448     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   449
   450     12  PI-MEMBER-CAPTION               PIC X(10).
   451
   452     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   453         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   454
   455     12  PI-LIFE-OVERRIDE-L1             PIC X.
   456     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   457     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   458     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   459
   460     12  PI-AH-OVERRIDE-L1               PIC X.
   461     12  PI-AH-OVERRIDE-L2               PIC XX.
   462     12  PI-AH-OVERRIDE-L6               PIC X(6).
   463     12  PI-AH-OVERRIDE-L12              PIC X(12).
   464
   465     12  PI-NEW-SYSTEM                   PIC X(2).
   466
   467     12  PI-PRIMARY-CERT-NO              PIC X(11).
   468     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   469         88  PI-USES-PAID-TO                 VALUE '1'.
   470     12  PI-CRDTCRD-SYSTEM.
   471         16  PI-CRDTCRD-USER             PIC X.
   472             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   473             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   474         16  PI-CC-MONTH-END-DT          PIC XX.
   475     12  PI-PROCESSOR-PRINTER            PIC X(4).
   476
   477     12  PI-OE-REFERENCE-2.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  10
* EL691.cbl
   478         16  PI-OE-REF-2-PRIME           PIC X(10).
   479         16  PI-OE-REF-2-SUFF            PIC X.
   480
   481     12  PI-REM-TRM-CALC-OPTION          PIC X.
   482
   483     12  PI-LANGUAGE-TYPE                PIC X.
   484             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   485             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   486             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   487
   488     12  PI-POLICY-LINKAGE-IND           PIC X.
   489         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   490         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   491                                                   LOW-VALUES.
   492
   493     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   494     12  PI-CLAIM-PW-SESSION             PIC X(1).
   495         88  PI-CLAIM-CREDIT                 VALUE '1'.
   496         88  PI-CLAIM-CONVEN                 VALUE '2'.
   497
   498     12  PI-PROCESSOR-CSR-IND            PIC X.
   499         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   500         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   501
   502     12  FILLER                          PIC X(3).
   503
   504     12  PI-SYSTEM-LEVEL                 PIC X(145).
   505
   506     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   507         PI-SYSTEM-LEVEL.
   508
   509         16  PI-ENTRY-CODES.
   510             20  PI-ENTRY-CD-1           PIC X.
   511             20  PI-ENTRY-CD-2           PIC X.
   512
   513         16  PI-RETURN-CODES.
   514             20  PI-RETURN-CD-1          PIC X.
   515             20  PI-RETURN-CD-2          PIC X.
   516
   517         16  PI-UPDATE-STATUS-SAVE.
   518             20  PI-UPDATE-BY            PIC X(4).
   519             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   520
   521         16  PI-LOWER-CASE-LETTERS       PIC X.
   522             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   523
   524*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   525*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   526*            88  CARRIER-CLM-CNTL            VALUE '2'.
   527
   528         16  PI-CERT-ACCESS-CONTROL      PIC X.
   529             88  ST-ACCNT-CNTL               VALUE ' '.
   530             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   531             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   532             88  ACCNT-CNTL                  VALUE '3'.
   533             88  CARR-ACCNT-CNTL             VALUE '4'.
   534
   535         16  PI-PROCESSOR-CAP-LIST.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  11
* EL691.cbl
   536             20  PI-SYSTEM-CONTROLS.
   537                24 PI-SYSTEM-DISPLAY     PIC X.
   538                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   539                24 PI-SYSTEM-MODIFY      PIC X.
   540                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   541             20  FILLER                  PIC XX.
   542             20  PI-DISPLAY-CAP          PIC X.
   543                 88  DISPLAY-CAP             VALUE 'Y'.
   544             20  PI-MODIFY-CAP           PIC X.
   545                 88  MODIFY-CAP              VALUE 'Y'.
   546             20  PI-MSG-AT-LOGON-CAP     PIC X.
   547                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   548             20  PI-FORCE-CAP            PIC X.
   549                 88  FORCE-CAP               VALUE 'Y'.
   550
   551         16  PI-PROGRAM-CONTROLS.
   552             20  PI-PGM-PRINT-OPT        PIC X.
   553             20  PI-PGM-FORMAT-OPT       PIC X.
   554             20  PI-PGM-PROCESS-OPT      PIC X.
   555             20  PI-PGM-TOTALS-OPT       PIC X.
   556
   557         16  PI-HELP-INTERFACE.
   558             20  PI-LAST-ERROR-NO        PIC X(4).
   559             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   560
   561         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   562             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   563
   564         16  PI-CR-CONTROL-IN-PROGRESS.
   565             20  PI-CR-CARRIER           PIC X.
   566             20  PI-CR-GROUPING          PIC X(6).
   567             20  PI-CR-STATE             PIC XX.
   568             20  PI-CR-ACCOUNT           PIC X(10).
   569             20  PI-CR-FIN-RESP          PIC X(10).
   570             20  PI-CR-TYPE              PIC X.
   571
   572         16  PI-CR-BATCH-NUMBER          PIC X(6).
   573
   574         16  PI-CR-MONTH-END-DT          PIC XX.
   575
   576         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   577             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   578             88  PI-ZERO-CARRIER             VALUE '1'.
   579             88  PI-ZERO-GROUPING            VALUE '2'.
   580             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   581
   582         16  PI-CARRIER-SECURITY         PIC X.
   583             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   584
   585         16  PI-ACCOUNT-SECURITY         PIC X(10).
   586             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   587             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   588
   589         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   590             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   591                                         INDEXED BY PI-ACCESS-NDX
   592                                         PIC X.
   593
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  12
* EL691.cbl
   594         16  PI-GA-BILLING-CONTROL       PIC X.
   595             88  PI-GA-BILLING               VALUE '1'.
   596
   597         16  PI-MAIL-PROCESSING          PIC X.
   598             88  PI-MAIL-YES                 VALUE 'Y'.
   599
   600         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   601
   602         16  PI-AR-SYSTEM.
   603             20  PI-AR-PROCESSING-CNTL   PIC X.
   604                 88  PI-AR-PROCESSING        VALUE 'Y'.
   605             20  PI-AR-SUMMARY-CODE      PIC X(6).
   606             20  PI-AR-MONTH-END-DT      PIC XX.
   607
   608         16  PI-MP-SYSTEM.
   609             20  PI-MORTGAGE-USER            PIC X.
   610                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   611                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   612             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   613                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   614                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   615                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   616                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   617                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   618             20  PI-MP-MONTH-END-DT          PIC XX.
   619             20  PI-MP-REFERENCE-NO.
   620                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   621                 24  PI-MP-REFERENCE-SFX     PIC XX.
   622
   623         16  PI-LABEL-CONTROL            PIC X(01).
   624             88  PI-CREATE-LABELS                    VALUE 'Y'.
   625             88  PI-BYPASS-LABELS                    VALUE 'N'.
   626
   627         16  PI-BILL-GROUPING-CODE       PIC X(01).
   628             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   629
   630         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   631             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   632             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   633
   634         16  FILLER                      PIC X(14).
   635
   636     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   637******************************************************************
   638     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   639*    COPY ELC1042.
   640******************************************************************
   641*                                                                *
   642*                                                                *
   643*                           ELC1042                              *
   644*                            VMOD=2.002                          *
   645*                                                                *
   646*    NOTE                                                        *
   647*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   648*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   649*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   650*        TO THESE PROGRAMS.                                      *
   651*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  13
* EL691.cbl
   652*    NOTE                                                        *
   653*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   654*        USE ONLY!                                               *
   655*                                                                *
   656******************************************************************
   657
   658         16  PI-1042-WA.
   659             20  PI-ACTION       PIC  X(01).
   660                 88 PI-SHOW-MODE           VALUE '1'.
   661                 88 PI-CLEAR-MODE          VALUE '2'.
   662                 88 PI-CREATE-MODE         VALUE '3'.
   663             20  PI-COMM-CONTROL PIC  X(12).
   664             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   665             20  PI-EOF-SW       PIC  X(01).
   666                 88  PI-FILE-EOF           VALUE 'Y'.
   667             20  PI-FILETYP      PIC  X(01).
   668             20  PI-FORM-SQUEEZE-CONTROL
   669                                 PIC  X(01).
   670                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   671                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   672             20  PI-LAST-CONTROL PIC  X(12).
   673             20  PI-TEMP-STOR-ITEMS
   674                                 PIC S9(04) COMP.
   675             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   676             20  PI-UPDATE-SW    PIC  9(01).
   677                 88 ANY-UPDATES            VALUE 1.
   678             20  PI-104-SCREEN-SENT-IND
   679                                 PIC  X(01).
   680                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   681                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   682             20  PI-1042-SCREEN-SENT-IND
   683                                 PIC  X(01).
   684                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   685                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   686             20  PI-1042-ARCHIVE-IND
   687                                 PIC  X(01).
   688                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   689             20  FILLER          PIC  X(29).
   690*    COPY ELC689PI.
   691******************************************************************
   692*                                                                *
   693*                            ELC689PI                            *
   694*                            VMOD=2.003                          *
   695*                                                                *
   696*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   697*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   698*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   699*                                                                *
   700*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   701*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   702*    BETWEEN PROGRAMS.                                           *
   703*                                                                *
   704*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   705*                                                                *
   706*               EL631 - EL689  - EL6891 - EL6892                 *
   707*                                                                *
   708******************************************************************
   709*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  14
* EL691.cbl
   710*
   711* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   712*-----------------------------------------------------------------
   713*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   714* EFFECTIVE    NUMBER
   715*-----------------------------------------------------------------
   716* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   717* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   718* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   719******************************************************************
   720
   721
   722         16  PI-689-WORK-AREA.
   723             20  PI-689-ALT-PRINTER-ID
   724                                 PIC  X(04).
   725             20  PI-689-ARCHIVE-NUMBER
   726                                 PIC  9(08).
   727             20  PI-689-ARCHIVE-SW
   728                                 PIC  X(01).
   729                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   730             20  PI-689-DATA-SOURCE
   731                                 PIC  X(01).
   732                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   733                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   734                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   735                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   736                 88  PI-689-SRC-CHECKS         VALUE '5'.
   737             20  PI-689-ERROR-IND
   738                                 PIC  X(01).
   739                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   740             20  PI-689-ERROR    PIC  9(04).
   741                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   742                 88  PI-689-FATAL-ERROR
   743                     VALUES 0004 0006 0008 0013 0023 0029 0033
   744                            0042 0047 0051 0066 0067 0070
   745                            0168 0169 0174 0175 0176 0177 0179
   746                            0180 0181 0182 0184 0185 0189 0190
   747                            0191
   748                            0215 0279 0280
   749                            0412 0413 0454
   750                            0533 0537
   751                            2055 2114 2208 2209 2216 2232 2369
   752                            2398 2433 2908 2999
   753                            3000 3770 3771 3775
   754                            7250 7365 7367 7368 7369 7370 7371
   755                            7272 7373 7374 7376 7377 7378 7379
   756                            7381 7388 7390 7393 7395 7396 7398
   757                            9095 9096 9281 9298 9299 9320 9327
   758                            9426 9427.
   759                 88  PI-689-STOP-ERROR
   760                     VALUES 0004 0008 0013 0023 0029 0033
   761                            0042 0047 0066 0067 0070
   762                            0168 0169 0174 0175 0176 0177
   763                            0181 0182 0184 0185 0189 0190
   764                            0279 0280
   765                            0412 0413 0454
   766                            2055 2208 2209 2216 2232
   767                            2398 2999
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  15
* EL691.cbl
   768                            3000 3770 3771 3775
   769                            7250 7365 7369 7370 7371
   770                            7272 7373 7374 7376 7377 7378 7379
   771                            7381 7388 7390 7393 7396 7398
   772                            9095 9096 9299 9320 9426.
   773             20  PI-689-FOLLOW-UP-DATE
   774                                 PIC  X(02).
   775             20  PI-689-FORM-NUMBER
   776                                 PIC  X(04).
   777             20  PI-689-LABEL-SOURCE
   778                                 PIC X(01).
   779                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   780                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   781                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   782                 88  PI-689-SOURCE-COMP     VALUE '4'.
   783                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   784                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   785                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   786             20  PI-689-NUMBER-COPIES
   787                                 PIC  9(01).
   788             20  PI-689-NUMBER-LABEL-LINES
   789                                 PIC  9(01).
   790             20  PI-689-NUMBER-TEXT-RECORDS
   791                                 PIC  9(03).
   792             20  PI-689-PRINT-ORDER-SW
   793                                 PIC  X(01).
   794                 88  PI-689-PRINT-FIRST     VALUE '1'.
   795                 88  PI-689-PRINT-SECOND    VALUE '2'.
   796                 88  PI-689-PRINT-LATER     VALUE '3'.
   797                 88  PI-689-PRINT-ONLY      VALUE '4'.
   798             20  PI-689-PRINT-RESTRICTION
   799                                 PIC  X(01).
   800                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   801                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
   802                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   803             20  PI-689-PRINT-SW PIC  X(01).
   804                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   805             20  PI-689-RESEND-DATE-1
   806                                 PIC  X(02).
   807             20  PI-689-RESEND-LETR-1
   808                                 PIC X(4).
   809             20  PI-689-TEMP-STOR-ID
   810                                 PIC  X(08).
   811             20  PI-689-USE-SCREEN-IND
   812                                 PIC  X(01).
   813                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   814             20  PI-689-ARCH-POINTER
   815                                 PIC S9(08) COMP.
   816                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   817             20  PI-689-ARCT-POINTER
   818                                 PIC S9(08) COMP.
   819                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   820             20  PI-689-VARIABLE-DATA-GRP.
   821                 24  PI-689-VARIABLE-DATA-1
   822                                 PIC  X(30).
   823                 24  PI-689-VARIABLE-DATA-2
   824                                 PIC  X(30).
   825                 24  PI-689-VARIABLE-DATA-3
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  16
* EL691.cbl
   826                                 PIC  X(30).
   827                 24  PI-689-VARIABLE-DATA-4
   828                                 PIC  X(30).
   829
   830         16  PI-689-KEY-DATA-FIELDS.
   831             20  PI-689-ACCOUNT  PIC  X(10).
   832             20  PI-689-CARRIER  PIC  X(01).
   833             20  PI-689-CERT-NO.
   834                 24  PI-689-CERT-PRIME
   835                                 PIC  X(10).
   836                 24  PI-689-CERT-SFX
   837                                 PIC  X(01).
   838             20  PI-689-CHG-SEQ-NO
   839                                 PIC S9(04)    COMP.
   840             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
   841                                 PIC  X(02).
   842             20  PI-689-ENTRY-BATCH
   843                                 PIC  X(06).
   844             20  PI-689-EFF-DATE PIC  X(02).
   845             20  PI-689-EXP-DATE PIC  X(02).
   846             20  PI-689-GROUPING PIC  X(06).
   847             20  PI-689-RESP-PERSON
   848                                 PIC  X(10).
   849             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   850             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   851                                 PIC  X(04).
   852             20  PI-689-STATE    PIC  X(02).
   853             20  PI-689-TYPE     PIC  X(01).
   854             20  PI-689-CONTROL  PIC S9(08)    COMP.
   855             20  PI-689-ALT-SEQ-NO
   856                                 PIC S9(04)    COMP.
   857         16  PI-689-DATE-EDIT    PIC  X(08).
   858         16  PI-689-FOLLOW-UP-EDIT
   859                                 PIC  X(08).
   860         16  PI-689-RESEND1-EDIT PIC  X(08).
   861         16  PI-689-SEQ-EDIT     PIC  X(08).
   862         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   863         16  PI-689-LBL-OVERRIDE PIC  X(01).
   864             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   865         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   866         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   867         16  PI-690-WORK-AREA.
   868             20  PI-690-ARCHIVE-TABLE.
   869                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
   870                                 PIC S9(08) COMP.
   871             20  PI-690-CURSOR   PIC S9(04) COMP.
   872             20  PI-690-FIRST-DATA.
   873                 24  PI-690-FIRST-CERT-NO.
   874                     28  PI-690-FIRST-CERT-PRIME
   875                                 PIC  X(10).
   876                     28  PI-690-FIRST-SUFFIX
   877                                 PIC  X(01).
   878                 24  PI-690-FIRST-CARRIER
   879                                 PIC  X(01).
   880                 24  PI-690-FIRST-GROUPING
   881                                 PIC  X(06).
   882                 24  PI-690-FIRST-STATE
   883                                 PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  17
* EL691.cbl
   884                 24  PI-690-FIRST-ACCOUNT
   885                                 PIC  X(10).
   886                 24  PI-690-FIRST-EFFECT-DATE
   887                                 PIC  X(02).
   888                 24  PI-690-FIRST-ENTRY.
   889                     28  PI-690-FIRST-CONTROL-PREFIX
   890                                 PIC  X(02).
   891                     28  PI-690-FIRST-CONTROL
   892                                 PIC S9(08) COMP.
   893                 24  PI-690-FIRST-FORM
   894                                 PIC  X(04).
   895                 24  PI-690-FIRST-PROCESSOR
   896                                 PIC  X(04).
   897                 24  PI-690-FIRST-ARCHIVE-NO
   898                                 PIC S9(08) COMP.
   899             20  PI-690-INIT-DATA.
   900                 24  PI-690-INIT-CERT-NO.
   901                     28  PI-690-INIT-CERT-PRIME
   902                                 PIC  X(10).
   903                     28  PI-690-INIT-SUFFIX
   904                                 PIC  X(01).
   905                 24  PI-690-INIT-CARRIER
   906                                 PIC  X(01).
   907                 24  PI-690-INIT-GROUPING
   908                                 PIC  X(06).
   909                 24  PI-690-INIT-STATE
   910                                 PIC  X(02).
   911                 24  PI-690-INIT-ACCOUNT
   912                                 PIC  X(10).
   913                 24  PI-690-INIT-EFFECT-DATE
   914                                 PIC  X(02).
   915                 24  PI-690-INIT-EFF-DTE
   916                                 PIC  X(08).
   917                 24  PI-690-INIT-ENTRY.
   918                     28  PI-690-INIT-CONTROL-PREFIX
   919                                 PIC  X(02).
   920                     28  PI-690-INIT-CONTROL
   921                                 PIC S9(08) COMP.
   922                 24  PI-690-INIT-FORM
   923                                 PIC  X(04).
   924                 24  PI-690-INIT-PROCESSOR
   925                                 PIC  X(04).
   926                 24  PI-690-INIT-ARCHIVE-NO
   927                                 PIC S9(08) COMP.
   928             20  PI-690-LAST-DATA.
   929                 24  PI-690-LAST-CERT-NO.
   930                     28  PI-690-LAST-CERT-PRIME
   931                                 PIC  X(10).
   932                     28  PI-690-LAST-SUFFIX
   933                                 PIC  X(01).
   934                 24  PI-690-LAST-CARRIER
   935                                 PIC  X(01).
   936                 24  PI-690-LAST-GROUPING
   937                                 PIC  X(06).
   938                 24  PI-690-LAST-STATE
   939                                 PIC  X(02).
   940                 24  PI-690-LAST-ACCOUNT
   941                                 PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  18
* EL691.cbl
   942                 24  PI-690-LAST-EFFECT-DATE
   943                                 PIC  X(02).
   944                 24  PI-690-LAST-ENTRY.
   945                     28  PI-690-LAST-CONTROL-PREFIX
   946                                 PIC  X(02).
   947                     28  PI-690-LAST-CONTROL
   948                                 PIC S9(08) COMP.
   949                 24  PI-690-LAST-FORM
   950                                 PIC  X(04).
   951                 24  PI-690-LAST-PROCESSOR
   952                                 PIC  X(04).
   953                 24  PI-690-LAST-ARCHIVE-NO
   954                                 PIC S9(08) COMP.
   955             20  PI-690-LAST-ARCH-NDX
   956                                 PIC S9(04) COMP.
   957             20  PI-690-BRWS-TYPE-IND
   958                                 PIC  9(01).
   959                 88  PI-690-BRWS-CERTRP               VALUE 1.
   960                 88  PI-690-BRWS-FORM                 VALUE 2.
   961                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
   962                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
   963                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
   964                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
   965             20  PI-690-LAST-BROWSE-IND
   966                                 PIC  X(01).
   967                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
   968                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
   969             20  PI-690-STATUS-SELECTION-IND
   970                                 PIC  X(01).
   971                 88  PI-690-SELECT-ALL       VALUE 'N'.
   972                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
   973                                               'X' 'P' 'V' 'N'.
   974         16  PI-ARCHIVE-COMPLETE    PIC X(01).
   975         16  PI-ARCHIVE-RECEIVED    PIC X(01).
   976         16  PI-ARCHIVE-STOPPED     PIC X(01).
   977         16  PI-ARCHIVE-FINAL       PIC X(01).
   978         16  PI-COMMENT-INDEX       PIC S9(4) COMP.
   979         16  PI-ARCHIVE-LTRID       PIC X(4).
   980         16  pi-create-date         pic x(08).
   981         16  pi-initial-print-date  pic xx.
   982         16  FILLER              PIC X(49).
   983
   984 01  W-CONSTANT-AREA.
   985     12  FILLER                  PIC  X(18)
   986                                 VALUE 'PROGRAM CONSTANTS:'.
   987     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
   988
   989     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
   990     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
   991     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
   992     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
   993     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
   994     12  W-MAP                   PIC  X(08)  VALUE 'EL691A'.
   995     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
   996         16  FILLER              PIC  X(02).
   997         16  W-MAP-NUM           PIC  X(06).
   998     12  W-MAPSET                PIC  X(08)  VALUE 'EL691S'.
   999     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL691'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  19
* EL691.cbl
  1000     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXN1'.
  1001     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
  1002     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
  1003     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
  1004     12  SLASH                   PIC X       VALUE '/'.
  1005     12  W-ZEROS                 PIC  S9(03) VALUE +0 COMP-3.
  1006     12  W-ADD-ARCT              PIC  X      VALUE 'N'.
  1007     12  W-DONE-ADDING           PIC  X      VALUE 'N'.
  1008     12  W-NEED-COMMENT          PIC  X      VALUE 'N'.
  1009
  1010 01  ERROR-MESSAGES.
  1011     12  ER-0000                 PIC  X(04) VALUE '0000'.
  1012     12  ER-0004                 PIC  X(04) VALUE '0004'.
  1013     12  ER-0029                 PIC  X(04) VALUE '0029'.
  1014     12  ER-0051                 PIC  X(04) VALUE '0051'.
  1015     12  ER-0070                 PIC  X(04) VALUE '0070'.
  1016     12  ER-0249                 PIC  X(04) VALUE '0249'.
  1017     12  ER-0295                 PIC  X(04) VALUE '0295'.
  1018     12  ER-0296                 PIC  X(04) VALUE '0296'.
  1019     12  ER-0539                 PIC  X(04) VALUE '0539'.
  1020     12  ER-0895                 PIC  X(04) VALUE '0895'.
  1021     12  ER-0897                 PIC  X(04) VALUE '0897'.
  1022     12  ER-1236                 PIC  X(04) VALUE '1236'.
  1023     12  ER-3112                 PIC  X(04) VALUE '3112'.
  1024     12  ER-7008                 PIC  X(04) VALUE '7008'.
  1025     12  ER-7330                 PIC  X(04) VALUE '7330'.
  1026     12  ER-7331                 PIC  X(04) VALUE '7331'.
  1027     12  ER-7332                 PIC  X(04) VALUE '7332'.
  1028     12  ER-7333                 PIC  X(04) VALUE '7333'.
  1029     12  ER-7334                 PIC  X(04) VALUE '7334'.
  1030     12  ER-7363                 PIC  X(04) VALUE '7363'.
  1031     12  ER-7364                 PIC  X(04) VALUE '7364'.
  1032     12  ER-7371                 PIC  X(04) VALUE '7371'.
  1033     12  ER-7373                 PIC  X(04) VALUE '7373'.
  1034     12  ER-7388                 PIC  X(04) VALUE '7388'.
  1035     12  ER-9097                 PIC  X(04) VALUE '9097'.
  1036     12  ER-9245                 PIC  X(04) VALUE '9245'.
  1037*                                COPY ELCAID.
  1038******************************************************************
  1039*                                                                *
  1040*                            ELCAID.                             *
  1041*                            VMOD=2.001                          *
  1042*                                                                *
  1043*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1044*                                                                *
  1045*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1046*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1047******************************************************************
  1048
  1049 01  DFHAID.
  1050   02  DFHNULL   PIC  X  VALUE  ' '.
  1051   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1052   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1053   02  DFHPEN    PIC  X  VALUE  '='.
  1054   02  DFHOPID   PIC  X  VALUE  'W'.
  1055   02  DFHPA1    PIC  X  VALUE  '%'.
  1056   02  DFHPA2    PIC  X  VALUE  '>'.
  1057   02  DFHPA3    PIC  X  VALUE  ','.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  20
* EL691.cbl
  1058   02  DFHPF1    PIC  X  VALUE  '1'.
  1059   02  DFHPF2    PIC  X  VALUE  '2'.
  1060   02  DFHPF3    PIC  X  VALUE  '3'.
  1061   02  DFHPF4    PIC  X  VALUE  '4'.
  1062   02  DFHPF5    PIC  X  VALUE  '5'.
  1063   02  DFHPF6    PIC  X  VALUE  '6'.
  1064   02  DFHPF7    PIC  X  VALUE  '7'.
  1065   02  DFHPF8    PIC  X  VALUE  '8'.
  1066   02  DFHPF9    PIC  X  VALUE  '9'.
  1067   02  DFHPF10   PIC  X  VALUE  ':'.
  1068   02  DFHPF11   PIC  X  VALUE  '#'.
  1069   02  DFHPF12   PIC  X  VALUE  '@'.
  1070   02  DFHPF13   PIC  X  VALUE  'A'.
  1071   02  DFHPF14   PIC  X  VALUE  'B'.
  1072   02  DFHPF15   PIC  X  VALUE  'C'.
  1073   02  DFHPF16   PIC  X  VALUE  'D'.
  1074   02  DFHPF17   PIC  X  VALUE  'E'.
  1075   02  DFHPF18   PIC  X  VALUE  'F'.
  1076   02  DFHPF19   PIC  X  VALUE  'G'.
  1077   02  DFHPF20   PIC  X  VALUE  'H'.
  1078   02  DFHPF21   PIC  X  VALUE  'I'.
  1079*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1080   02  DFHPF22   PIC  X  VALUE  '['.
  1081   02  DFHPF23   PIC  X  VALUE  '.'.
  1082   02  DFHPF24   PIC  X  VALUE  '<'.
  1083   02  DFHMSRE   PIC  X  VALUE  'X'.
  1084   02  DFHSTRF   PIC  X  VALUE  'h'.
  1085   02  DFHTRIG   PIC  X  VALUE  '"'.
  1086 01  FILLER    REDEFINES DFHAID.
  1087     12  FILLER                  PIC  X(08).
  1088     12  PF-VALUES               PIC  X(01) OCCURS 2.
  1089*                                COPY ELCATTR.
  1090******************************************************************
  1091*                                                                *
  1092*                            ELCATTR.                            *
  1093*                            VMOD=2.001                          *
  1094*                                                                *
  1095*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1096*                                                                *
  1097*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1098*                                                                *
  1099*                   POS 1   P=PROTECTED                          *
  1100*                           U=UNPROTECTED                        *
  1101*                           S=ASKIP                              *
  1102*                   POS 2   A=ALPHA/NUMERIC                      *
  1103*                           N=NUMERIC                            *
  1104*                   POS 3   N=NORMAL                             *
  1105*                           B=BRIGHT                             *
  1106*                           D=DARK                               *
  1107*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1108*                           OF=MODIFIED DATA TAG OFF             *
  1109*                                                                *
  1110*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1111******************************************************************
  1112 01  ATTRIBUTE-LIST.
  1113     12  AL-PABOF            PIC X       VALUE 'Y'.
  1114     12  AL-PABON            PIC X       VALUE 'Z'.
  1115     12  AL-PADOF            PIC X       VALUE '%'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  21
* EL691.cbl
  1116     12  AL-PADON            PIC X       VALUE '_'.
  1117     12  AL-PANOF            PIC X       VALUE '-'.
  1118     12  AL-PANON            PIC X       VALUE '/'.
  1119     12  AL-SABOF            PIC X       VALUE '8'.
  1120     12  AL-SABON            PIC X       VALUE '9'.
  1121     12  AL-SADOF            PIC X       VALUE '@'.
  1122     12  AL-SADON            PIC X       VALUE QUOTE.
  1123     12  AL-SANOF            PIC X       VALUE '0'.
  1124     12  AL-SANON            PIC X       VALUE '1'.
  1125     12  AL-UABOF            PIC X       VALUE 'H'.
  1126     12  AL-UABON            PIC X       VALUE 'I'.
  1127     12  AL-UADOF            PIC X       VALUE '<'.
  1128     12  AL-UADON            PIC X       VALUE '('.
  1129     12  AL-UANOF            PIC X       VALUE ' '.
  1130     12  AL-UANON            PIC X       VALUE 'A'.
  1131     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1132     12  AL-UNBON            PIC X       VALUE 'R'.
  1133     12  AL-UNDOF            PIC X       VALUE '*'.
  1134     12  AL-UNDON            PIC X       VALUE ')'.
  1135     12  AL-UNNOF            PIC X       VALUE '&'.
  1136     12  AL-UNNON            PIC X       VALUE 'J'.
  1137*                                COPY ELCDATE.
  1138******************************************************************
  1139*                                                                *
  1140*                                                                *
  1141*                            ELCDATE.                            *
  1142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1143*                            VMOD=2.003
  1144*                                                                *
  1145*                                                                *
  1146*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1147*                 LENGTH = 200                                   *
  1148******************************************************************
  1149
  1150 01  DATE-CONVERSION-DATA.
  1151     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1152     12  DC-OPTION-CODE                PIC X.
  1153         88  BIN-TO-GREG                VALUE ' '.
  1154         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1155         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1156         88  YMD-GREG-TO-BIN            VALUE '3'.
  1157         88  MDY-GREG-TO-BIN            VALUE '4'.
  1158         88  JULIAN-TO-BIN              VALUE '5'.
  1159         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1160         88  FIND-CENTURY               VALUE '7'.
  1161         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1162         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1163         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1164         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1165         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1166         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1167         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1168         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1169         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1170         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1171         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1172         88  BIN-3-TO-GREG              VALUE 'I'.
  1173         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  22
* EL691.cbl
  1174         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1175         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1176         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1177         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1178         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1179         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1180         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1181         88  THREE-CHARACTER-BIN
  1182                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1183         88  GREGORIAN-TO-BIN
  1184                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1185         88  BIN-TO-GREGORIAN
  1186                  VALUES ' ' '1' 'I' '8' 'G'.
  1187         88  JULIAN-TO-BINARY
  1188                  VALUES '5' 'C' 'E' 'F'.
  1189     12  DC-ERROR-CODE                 PIC X.
  1190         88  NO-CONVERSION-ERROR        VALUE ' '.
  1191         88  DATE-CONVERSION-ERROR
  1192                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1193         88  DATE-IS-ZERO               VALUE '1'.
  1194         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1195         88  DATE-IS-INVALID            VALUE '3'.
  1196         88  DATE1-GREATER-DATE2        VALUE '4'.
  1197         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1198         88  DATE-INVALID-OPTION        VALUE '9'.
  1199         88  INVALID-CENTURY            VALUE 'A'.
  1200         88  ONLY-CENTURY               VALUE 'B'.
  1201         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1202         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1203     12  DC-END-OF-MONTH               PIC X.
  1204         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1205     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1206         88  USE-NORMAL-PROCESS         VALUE ' '.
  1207         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1208         88  ADJUST-UP-100-YRS          VALUE '2'.
  1209     12  FILLER                        PIC X.
  1210     12  DC-CONVERSION-DATES.
  1211         16  DC-BIN-DATE-1             PIC XX.
  1212         16  DC-BIN-DATE-2             PIC XX.
  1213         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1214         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1215                       DC-GREG-DATE-1-EDIT.
  1216             20  DC-EDIT1-MONTH        PIC 99.
  1217             20  SLASH1-1              PIC X.
  1218             20  DC-EDIT1-DAY          PIC 99.
  1219             20  SLASH1-2              PIC X.
  1220             20  DC-EDIT1-YEAR         PIC 99.
  1221         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1222         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1223                     DC-GREG-DATE-2-EDIT.
  1224             20  DC-EDIT2-MONTH        PIC 99.
  1225             20  SLASH2-1              PIC X.
  1226             20  DC-EDIT2-DAY          PIC 99.
  1227             20  SLASH2-2              PIC X.
  1228             20  DC-EDIT2-YEAR         PIC 99.
  1229         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1230         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1231                     DC-GREG-DATE-1-YMD.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  23
* EL691.cbl
  1232             20  DC-YMD-YEAR           PIC 99.
  1233             20  DC-YMD-MONTH          PIC 99.
  1234             20  DC-YMD-DAY            PIC 99.
  1235         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1236         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1237                      DC-GREG-DATE-1-MDY.
  1238             20  DC-MDY-MONTH          PIC 99.
  1239             20  DC-MDY-DAY            PIC 99.
  1240             20  DC-MDY-YEAR           PIC 99.
  1241         16  DC-GREG-DATE-1-ALPHA.
  1242             20  DC-ALPHA-MONTH        PIC X(10).
  1243             20  DC-ALPHA-DAY          PIC 99.
  1244             20  FILLER                PIC XX.
  1245             20  DC-ALPHA-CENTURY.
  1246                 24 DC-ALPHA-CEN-N     PIC 99.
  1247             20  DC-ALPHA-YEAR         PIC 99.
  1248         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1249         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1250         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1251         16  DC-JULIAN-DATE            PIC 9(05).
  1252         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1253                                       PIC 9(05).
  1254         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1255             20  DC-JULIAN-YEAR        PIC 99.
  1256             20  DC-JULIAN-DAYS        PIC 999.
  1257         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1258         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1259         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1260     12  DATE-CONVERSION-VARIBLES.
  1261         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1262         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1263             20  FILLER                PIC 9(3).
  1264             20  HOLD-CEN-1-CCYY.
  1265                 24  HOLD-CEN-1-CC     PIC 99.
  1266                 24  HOLD-CEN-1-YY     PIC 99.
  1267             20  HOLD-CEN-1-MO         PIC 99.
  1268             20  HOLD-CEN-1-DA         PIC 99.
  1269         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1270             20  HOLD-CEN-1-R-MO       PIC 99.
  1271             20  HOLD-CEN-1-R-DA       PIC 99.
  1272             20  HOLD-CEN-1-R-CCYY.
  1273                 24  HOLD-CEN-1-R-CC   PIC 99.
  1274                 24  HOLD-CEN-1-R-YY   PIC 99.
  1275             20  FILLER                PIC 9(3).
  1276         16  HOLD-CENTURY-1-X.
  1277             20  FILLER                PIC X(3)  VALUE SPACES.
  1278             20  HOLD-CEN-1-X-CCYY.
  1279                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1280                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1281             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1282             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1283         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1284             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1285             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1286             20  HOLD-CEN-1-R-X-CCYY.
  1287                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1288                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1289             20  FILLER                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  24
* EL691.cbl
  1290         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1291         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1292         16  DC-JULIAN-DATE-1          PIC 9(07).
  1293         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1294             20  DC-JULIAN-1-CCYY.
  1295                 24  DC-JULIAN-1-CC    PIC 99.
  1296                 24  DC-JULIAN-1-YR    PIC 99.
  1297             20  DC-JULIAN-DA-1        PIC 999.
  1298         16  DC-JULIAN-DATE-2          PIC 9(07).
  1299         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1300             20  DC-JULIAN-2-CCYY.
  1301                 24  DC-JULIAN-2-CC    PIC 99.
  1302                 24  DC-JULIAN-2-YR    PIC 99.
  1303             20  DC-JULIAN-DA-2        PIC 999.
  1304         16  DC-GREG-DATE-A-EDIT.
  1305             20  DC-EDITA-MONTH        PIC 99.
  1306             20  SLASHA-1              PIC X VALUE '/'.
  1307             20  DC-EDITA-DAY          PIC 99.
  1308             20  SLASHA-2              PIC X VALUE '/'.
  1309             20  DC-EDITA-CCYY.
  1310                 24  DC-EDITA-CENT     PIC 99.
  1311                 24  DC-EDITA-YEAR     PIC 99.
  1312         16  DC-GREG-DATE-B-EDIT.
  1313             20  DC-EDITB-MONTH        PIC 99.
  1314             20  SLASHB-1              PIC X VALUE '/'.
  1315             20  DC-EDITB-DAY          PIC 99.
  1316             20  SLASHB-2              PIC X VALUE '/'.
  1317             20  DC-EDITB-CCYY.
  1318                 24  DC-EDITB-CENT     PIC 99.
  1319                 24  DC-EDITB-YEAR     PIC 99.
  1320         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1321         16  DC-GREG-DATE-CYMD-R REDEFINES
  1322                              DC-GREG-DATE-CYMD.
  1323             20  DC-CYMD-CEN           PIC 99.
  1324             20  DC-CYMD-YEAR          PIC 99.
  1325             20  DC-CYMD-MONTH         PIC 99.
  1326             20  DC-CYMD-DAY           PIC 99.
  1327         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1328         16  DC-GREG-DATE-MDCY-R REDEFINES
  1329                              DC-GREG-DATE-MDCY.
  1330             20  DC-MDCY-MONTH         PIC 99.
  1331             20  DC-MDCY-DAY           PIC 99.
  1332             20  DC-MDCY-CEN           PIC 99.
  1333             20  DC-MDCY-YEAR          PIC 99.
  1334    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1335        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1336    12  DC-EL310-DATE                  PIC X(21).
  1337    12  FILLER                         PIC X(28).
  1338*                                COPY ELCTEXT.
  1339******************************************************************
  1340*                                                                *
  1341*                                                                *
  1342*                            ELCTEXT.                            *
  1343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1344*                            VMOD=2.008                          *
  1345*                                                                *
  1346*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1347*                                     FORM LETTERS,              *
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  25
* EL691.cbl
  1348*                                     CERT FORM DISPLAY.
  1349*                                                                *
  1350*   FILE TYPE = VSAM,KSDS                                        *
  1351*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1352*                                                                *
  1353*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1354*       ALTERNATE INDEX = NONE                                   *
  1355*                                                                *
  1356*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1357*       ALTERNATE INDEX = NONE                                   *
  1358*                                                                *
  1359*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1360*       ALTERNATE INDEX = NONE                                   *
  1361*                                                                *
  1362*   LOG = NO                                                     *
  1363*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1364******************************************************************
  1365 01  TEXT-FILES.
  1366     12  TEXT-FILE-ID                PIC XX.
  1367         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1368         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1369         88  HELP-FILE-TEXT             VALUE 'TH'.
  1370
  1371     12  TX-CONTROL-PRIMARY.
  1372         16  TX-COMPANY-CD           PIC X.
  1373             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1374         16  TX-ACCESS-CD-GENL       PIC X(12).
  1375
  1376         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1377             20  TX-LETTER-NO        PIC X(4).
  1378             20  FILLER              PIC X(8).
  1379
  1380         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1381             20  TX-FORM-NO          PIC X(12).
  1382
  1383         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1384             20  TX-HELP-TYPE        PIC X.
  1385                 88  HELP-FOR-GENERAL   VALUE ' '.
  1386                 88  HELP-BY-SCREEN     VALUE 'S'.
  1387                 88  HELP-BY-ERROR      VALUE 'E'.
  1388             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1389                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1390             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1391                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1392             20  FILLER              PIC X(4).
  1393
  1394         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1395
  1396     12  TX-PROCESS-CONTROL          PIC XX.
  1397         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1398
  1399     12  TX-TEXT-LINE                PIC X(70).
  1400
  1401     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1402         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1403         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1404         88  TX-VALID-FORM-SQUEEZE-VALUE
  1405                                        VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  26
* EL691.cbl
  1406
  1407     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1408         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1409         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1410         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1411         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1412         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1413         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1414         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1415                                              'K' 'N' ' '
  1416                                              'Z'.
  1417
  1418     12  TX-ARCHIVE-SW               PIC X.
  1419         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1420         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1421         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1422
  1423     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1424     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1425
  1426     12  TX-BSR-CODE                 PIC X.
  1427         88  TX-BSR-LETTER              VALUE 'B'.
  1428         88  TX-NON-BSR-LETTER          VALUE ' '.
  1429
  1430     12  FILLER                      PIC X.
  1431*****************************************************************
  1432*                                COPY ELCNWA.
  1433*****************************************************************
  1434*                                                               *
  1435*                                                               *
  1436*                            ELCNWA.                            *
  1437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1438*                            VMOD=2.003                         *
  1439*                                                               *
  1440*            M O V E   N A M E   W O R K   A R E A.             *
  1441*                                                               *
  1442*****************************************************************.
  1443
  1444 01  WS-NAME-WORK-AREA.
  1445     05  WS-INSURED-LAST-NAME        PIC X(15).
  1446     05  WS-INSURED-1ST-NAME         PIC X(12).
  1447     05  WS-INSURED-MID-INIT         PIC X.
  1448
  1449     05  WS-NAME-WORK.
  1450         10  WS-NW                   PIC X
  1451             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1452
  1453     05  WS-NAME-WORK2.
  1454         10  WS-NW2                  PIC X
  1455             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1456                                        NWA-INDEX0.
  1457
  1458     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1459                                     COMP-3.
  1460
  1461*                                COPY ELCEMIB.
  1462******************************************************************
  1463*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  27
* EL691.cbl
  1464*                                                                *
  1465*                            ELCEMIB.                            *
  1466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1467*                            VMOD=2.005                          *
  1468*                                                                *
  1469*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1470*                                                                *
  1471******************************************************************
  1472 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1473     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1474     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1475     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1476     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1477     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1478     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1479     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1480     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1481     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1482         88  EMI-NO-ERRORS                    VALUE '1'.
  1483         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1484         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1485     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1486         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1487     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1488         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1489         88  EMI-AREA1-FULL                   VALUE '2'.
  1490     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1491         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1492         88  EMI-AREA2-FULL                   VALUE '2'.
  1493     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1494         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1495         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1496         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1497         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1498         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1499     12  EMI-ERROR-LINES.
  1500         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1501         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1502         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1503         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1504             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1505                 24  EMI-ERR-NUM         PIC X(4).
  1506                 24  EMI-FILLER          PIC X.
  1507                 24  EMI-SEV             PIC X.
  1508                 24  FILLER              PIC X.
  1509             20  FILLER                  PIC X(02).
  1510     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1511         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1512             20  EMI-ERROR-NUMBER    PIC X(4).
  1513             20  EMI-FILL            PIC X.
  1514             20  EMI-SEVERITY        PIC X.
  1515             20  FILLER              PIC X.
  1516             20  EMI-ERROR-TEXT.
  1517                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1518                 24  FILLER          PIC X(55).
  1519     12  EMI-SEVERITY-SAVE           PIC X.
  1520         88  EMI-NOTE                    VALUE 'N'.
  1521         88  EMI-WARNING                 VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  28
* EL691.cbl
  1522         88  EMI-FORCABLE                VALUE 'F'.
  1523         88  EMI-FATAL                   VALUE 'X'.
  1524     12  EMI-MESSAGE-FLAG            PIC X.
  1525         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1526         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1527     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1528     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1529         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1530         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1531         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1532     12  emi-claim-no                pic x(7).
  1533     12  emi-claim-type              pic x(6).
  1534     12  FILLER                      PIC X(124)  VALUE SPACES.
  1535     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1536     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1537     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1538     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1539*                                COPY ERCCNOT.
  1540******************************************************************
  1541*                                                                *
  1542*                            ERCCNOT                             *
  1543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1544*                            VMOD=2.003                          *
  1545*                                                                *
  1546*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1547*                                                                *
  1548*        FILE TYPE= VSAM,KSDS                                    *
  1549*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1550*                                                                *
  1551*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1552*                                                                *
  1553*        LOG = YES                                               *
  1554*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1555*                                                                *
  1556******************************************************************
  1557*                   C H A N G E   L O G
  1558*
  1559* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1560*-----------------------------------------------------------------
  1561*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1562* EFFECTIVE    NUMBER
  1563*-----------------------------------------------------------------
  1564* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1565******************************************************************
  1566
  1567 01  CERT-NOTE-FILE.
  1568     12  CZ-RECORD-ID                PIC  XX.
  1569         88  VALID-CZ-ID                  VALUE 'CZ'.
  1570
  1571     12  CZ-CONTROL-PRIMARY.
  1572         16  CZ-COMPANY-CD           PIC X.
  1573         16  CZ-CARRIER              PIC X.
  1574         16  CZ-GROUPING.
  1575             20 CZ-GROUPING-PREFIX   PIC XXX.
  1576             20 CZ-GROUPING-PRIME    PIC XXX.
  1577         16  CZ-STATE                PIC XX.
  1578         16  CZ-ACCOUNT.
  1579             20 CZ-ACCOUNT-PREFIX    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  29
* EL691.cbl
  1580             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1581         16  CZ-CERT-EFF-DT          PIC XX.
  1582         16  CZ-CERT-NO.
  1583             20  CZ-CERT-PRIME       PIC X(10).
  1584             20  CZ-CERT-SFX         PIC X.
  1585         16  CZ-RECORD-TYPE          PIC X.
  1586             88  CERT-NOTE           VALUE '1'.
  1587             88  CLAIM-CERT-NOTE     VALUE '2'.
  1588         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1589
  1590     12  CZ-LAST-MAINT-DT            PIC XX.
  1591     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1592     12  CZ-LAST-MAINT-USER          PIC X(4).
  1593
  1594     12  CZ-NOTE-INFORMATION.
  1595         16  CZ-NOTE                 PIC X(63).
  1596         16  FILLER                  PIC X(39).
  1597******************************************************************
  1598 01  EMI-SAVE-AREA               PIC X(400).
  1599*                                COPY ELCLOGOF.
  1600******************************************************************
  1601*                                                                *
  1602*                                                                *
  1603*                            ELCLOGOF.                           *
  1604*                            VMOD=2.001                          *
  1605*                                                                *
  1606*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1607*                                                                *
  1608******************************************************************
  1609 01  CLASIC-LOGOFF.
  1610     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1611     12  LOGOFF-TEXT.
  1612         16  FILLER          PIC X(5)    VALUE SPACES.
  1613         16  LOGOFF-MSG.
  1614             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1615             20  FILLER      PIC X       VALUE SPACES.
  1616             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1617         16  FILLER          PIC X(80)
  1618           VALUE '* YOU ARE NOW LOGGED OFF'.
  1619         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1620         16  FILLER          PIC X       VALUE QUOTE.
  1621         16  LOGOFF-SYS-MSG  PIC X(17)
  1622           VALUE 'S CLAS-IC SYSTEM '.
  1623     12  TEXT-MESSAGES.
  1624         16  UNACCESS-MSG    PIC X(29)
  1625             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1626         16  PGMIDERR-MSG    PIC X(17)
  1627             VALUE 'PROGRAM NOT FOUND'.
  1628*                                COPY ELCSCTM.
  1629******************************************************************
  1630*                                                                *
  1631*                                                                *
  1632*                            ELCSCTM                             *
  1633*                            VMOD=2.001                          *
  1634*                                                                *
  1635*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  1636*                                                                *
  1637******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  30
* EL691.cbl
  1638 01  SECURITY-MESSAGE.
  1639     12  FILLER                          PIC X(30)
  1640            VALUE '** LOGIC SECURITY VIOLATION -'.
  1641     12  SM-READ                         PIC X(6).
  1642     12  FILLER                          PIC X(5)
  1643            VALUE ' PGM='.
  1644     12  SM-PGM                          PIC X(6).
  1645     12  FILLER                          PIC X(5)
  1646            VALUE ' OPR='.
  1647     12  SM-PROCESSOR-ID                 PIC X(4).
  1648     12  FILLER                          PIC X(6)
  1649            VALUE ' TERM='.
  1650     12  SM-TERMID                       PIC X(4).
  1651     12  FILLER                          PIC XX   VALUE SPACE.
  1652     12  SM-JUL-DATE                     PIC 9(5).
  1653     12  FILLER                          PIC X    VALUE SPACE.
  1654     12  SM-TIME                         PIC 99.99.
  1655
  1656*                                COPY ELCSCRTY.
  1657******************************************************************
  1658*                                                                *
  1659*                                                                *
  1660*                            ELCSCRTY                            *
  1661*                            VMOD=2.001                          *
  1662*                                                                *
  1663*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1664*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1665*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1666*                                                                *
  1667******************************************************************
  1668 01  SECURITY-CONTROL.
  1669     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1670     12  FILLER                       PIC XX    VALUE 'SC'.
  1671     12  SC-CREDIT-CODES.
  1672         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1673             20  SC-CREDIT-DISPLAY    PIC X.
  1674             20  SC-CREDIT-UPDATE     PIC X.
  1675     12  SC-CLAIMS-CODES.
  1676         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1677             20  SC-CLAIMS-DISPLAY    PIC X.
  1678             20  SC-CLAIMS-UPDATE     PIC X.
  1679*                                COPY EL691S.
  1680 01  EL691AI.
  1681     05  FILLER            PIC  X(0012).
  1682*    -------------------------------
  1683     05  RUNDTEL PIC S9(0004) COMP.
  1684     05  RUNDTEF PIC  X(0001).
  1685     05  FILLER REDEFINES RUNDTEF.
  1686         10  RUNDTEA PIC  X(0001).
  1687     05  RUNDTEI PIC  X(0008).
  1688*    -------------------------------
  1689     05  RUNTIMEL PIC S9(0004) COMP.
  1690     05  RUNTIMEF PIC  X(0001).
  1691     05  FILLER REDEFINES RUNTIMEF.
  1692         10  RUNTIMEA PIC  X(0001).
  1693     05  RUNTIMEI PIC  X(0005).
  1694*    -------------------------------
  1695     05  COMPANYL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  31
* EL691.cbl
  1696     05  COMPANYF PIC  X(0001).
  1697     05  FILLER REDEFINES COMPANYF.
  1698         10  COMPANYA PIC  X(0001).
  1699     05  COMPANYI PIC  X(0003).
  1700*    -------------------------------
  1701     05  USERIDL PIC S9(0004) COMP.
  1702     05  USERIDF PIC  X(0001).
  1703     05  FILLER REDEFINES USERIDF.
  1704         10  USERIDA PIC  X(0001).
  1705     05  USERIDI PIC  X(0004).
  1706*    -------------------------------
  1707     05  CARRIERL PIC S9(0004) COMP.
  1708     05  CARRIERF PIC  X(0001).
  1709     05  FILLER REDEFINES CARRIERF.
  1710         10  CARRIERA PIC  X(0001).
  1711     05  CARRIERI PIC  X(0001).
  1712*    -------------------------------
  1713     05  GROUPL PIC S9(0004) COMP.
  1714     05  GROUPF PIC  X(0001).
  1715     05  FILLER REDEFINES GROUPF.
  1716         10  GROUPA PIC  X(0001).
  1717     05  GROUPI PIC  X(0006).
  1718*    -------------------------------
  1719     05  STATEL PIC S9(0004) COMP.
  1720     05  STATEF PIC  X(0001).
  1721     05  FILLER REDEFINES STATEF.
  1722         10  STATEA PIC  X(0001).
  1723     05  STATEI PIC  X(0002).
  1724*    -------------------------------
  1725     05  ACCTL PIC S9(0004) COMP.
  1726     05  ACCTF PIC  X(0001).
  1727     05  FILLER REDEFINES ACCTF.
  1728         10  ACCTA PIC  X(0001).
  1729     05  ACCTI PIC  X(0010).
  1730*    -------------------------------
  1731     05  CERTL PIC S9(0004) COMP.
  1732     05  CERTF PIC  X(0001).
  1733     05  FILLER REDEFINES CERTF.
  1734         10  CERTA PIC  X(0001).
  1735     05  CERTI PIC  X(0010).
  1736*    -------------------------------
  1737     05  SFXL PIC S9(0004) COMP.
  1738     05  SFXF PIC  X(0001).
  1739     05  FILLER REDEFINES SFXF.
  1740         10  SFXA PIC  X(0001).
  1741     05  SFXI PIC  X(0001).
  1742*    -------------------------------
  1743     05  MAINTL PIC S9(0004) COMP.
  1744     05  MAINTF PIC  X(0001).
  1745     05  FILLER REDEFINES MAINTF.
  1746         10  MAINTA PIC  X(0001).
  1747     05  MAINTI PIC  X(0001).
  1748*    -------------------------------
  1749     05  MAINTBYL PIC S9(0004) COMP.
  1750     05  MAINTBYF PIC  X(0001).
  1751     05  FILLER REDEFINES MAINTBYF.
  1752         10  MAINTBYA PIC  X(0001).
  1753     05  MAINTBYI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  32
* EL691.cbl
  1754*    -------------------------------
  1755     05  MAINTDTL PIC S9(0004) COMP.
  1756     05  MAINTDTF PIC  X(0001).
  1757     05  FILLER REDEFINES MAINTDTF.
  1758         10  MAINTDTA PIC  X(0001).
  1759     05  MAINTDTI PIC  X(0008).
  1760*    -------------------------------
  1761     05  MAINTTML PIC S9(0004) COMP.
  1762     05  MAINTTMF PIC  X(0001).
  1763     05  FILLER REDEFINES MAINTTMF.
  1764         10  MAINTTMA PIC  X(0001).
  1765     05  MAINTTMI PIC  X(0005).
  1766*    -------------------------------
  1767     05  ARCHNOL PIC S9(0004) COMP.
  1768     05  ARCHNOF PIC  X(0001).
  1769     05  FILLER REDEFINES ARCHNOF.
  1770         10  ARCHNOA PIC  X(0001).
  1771     05  ARCHNOI PIC  X(0008).
  1772*    -------------------------------
  1773     05  ENDARCHL PIC S9(0004) COMP.
  1774     05  ENDARCHF PIC  X(0001).
  1775     05  FILLER REDEFINES ENDARCHF.
  1776         10  ENDARCHA PIC  X(0001).
  1777     05  ENDARCHI PIC  X(0008).
  1778*    -------------------------------
  1779     05  FORMNOL PIC S9(0004) COMP.
  1780     05  FORMNOF PIC  X(0001).
  1781     05  FILLER REDEFINES FORMNOF.
  1782         10  FORMNOA PIC  X(0001).
  1783     05  FORMNOI PIC  X(0004).
  1784*    -------------------------------
  1785     05  RESFORML PIC S9(0004) COMP.
  1786     05  RESFORMF PIC  X(0001).
  1787     05  FILLER REDEFINES RESFORMF.
  1788         10  RESFORMA PIC  X(0001).
  1789     05  RESFORMI PIC  X(0004).
  1790*    -------------------------------
  1791     05  CREATDTL PIC S9(0004) COMP.
  1792     05  CREATDTF PIC  X(0001).
  1793     05  FILLER REDEFINES CREATDTF.
  1794         10  CREATDTA PIC  X(0001).
  1795     05  CREATDTI PIC  X(0008).
  1796*    -------------------------------
  1797     05  RESENDL PIC S9(0004) COMP.
  1798     05  RESENDF PIC  X(0001).
  1799     05  FILLER REDEFINES RESENDF.
  1800         10  RESENDA PIC  X(0001).
  1801     05  RESENDI PIC  X(0008).
  1802*    -------------------------------
  1803     05  CREATBYL PIC S9(0004) COMP.
  1804     05  CREATBYF PIC  X(0001).
  1805     05  FILLER REDEFINES CREATBYF.
  1806         10  CREATBYA PIC  X(0001).
  1807     05  CREATBYI PIC  X(0004).
  1808*    -------------------------------
  1809     05  PRINTDTL PIC S9(0004) COMP.
  1810     05  PRINTDTF PIC  X(0001).
  1811     05  FILLER REDEFINES PRINTDTF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  33
* EL691.cbl
  1812         10  PRINTDTA PIC  X(0001).
  1813     05  PRINTDTI PIC  X(0008).
  1814*    -------------------------------
  1815     05  RESPRNTL PIC S9(0004) COMP.
  1816     05  RESPRNTF PIC  X(0001).
  1817     05  FILLER REDEFINES RESPRNTF.
  1818         10  RESPRNTA PIC  X(0001).
  1819     05  RESPRNTI PIC  X(0008).
  1820*    -------------------------------
  1821     05  STCOMPL PIC S9(0004) COMP.
  1822     05  STCOMPF PIC  X(0001).
  1823     05  FILLER REDEFINES STCOMPF.
  1824         10  STCOMPA PIC  X(0001).
  1825     05  STCOMPI PIC  X(0019).
  1826*    -------------------------------
  1827     05  REPLYL PIC S9(0004) COMP.
  1828     05  REPLYF PIC  X(0001).
  1829     05  FILLER REDEFINES REPLYF.
  1830         10  REPLYA PIC  X(0001).
  1831     05  REPLYI PIC  X(0008).
  1832*    -------------------------------
  1833     05  STRECVL PIC S9(0004) COMP.
  1834     05  STRECVF PIC  X(0001).
  1835     05  FILLER REDEFINES STRECVF.
  1836         10  STRECVA PIC  X(0001).
  1837     05  STRECVI PIC  X(0019).
  1838*    -------------------------------
  1839     05  STOPDTEL PIC S9(0004) COMP.
  1840     05  STOPDTEF PIC  X(0001).
  1841     05  FILLER REDEFINES STOPDTEF.
  1842         10  STOPDTEA PIC  X(0001).
  1843     05  STOPDTEI PIC  X(0008).
  1844*    -------------------------------
  1845     05  STSTOPL PIC S9(0004) COMP.
  1846     05  STSTOPF PIC  X(0001).
  1847     05  FILLER REDEFINES STSTOPF.
  1848         10  STSTOPA PIC  X(0001).
  1849     05  STSTOPI PIC  X(0019).
  1850*    -------------------------------
  1851     05  OBVYNL PIC S9(0004) COMP.
  1852     05  OBVYNF PIC  X(0001).
  1853     05  FILLER REDEFINES OBVYNF.
  1854         10  OBVYNA PIC  X(0001).
  1855     05  OBVYNI PIC  X(0001).
  1856*    -------------------------------
  1857     05  FINDATEL PIC S9(0004) COMP.
  1858     05  FINDATEF PIC  X(0001).
  1859     05  FILLER REDEFINES FINDATEF.
  1860         10  FINDATEA PIC  X(0001).
  1861     05  FINDATEI PIC  X(0008).
  1862*    -------------------------------
  1863     05  STFINLL PIC S9(0004) COMP.
  1864     05  STFINLF PIC  X(0001).
  1865     05  FILLER REDEFINES STFINLF.
  1866         10  STFINLA PIC  X(0001).
  1867     05  STFINLI PIC  X(0019).
  1868*    -------------------------------
  1869     05  OBUIDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  34
* EL691.cbl
  1870     05  OBUIDF PIC  X(0001).
  1871     05  FILLER REDEFINES OBUIDF.
  1872         10  OBUIDA PIC  X(0001).
  1873     05  OBUIDI PIC  X(0005).
  1874*    -------------------------------
  1875     05  FINLACTL PIC S9(0004) COMP.
  1876     05  FINLACTF PIC  X(0001).
  1877     05  FILLER REDEFINES FINLACTF.
  1878         10  FINLACTA PIC  X(0001).
  1879     05  FINLACTI PIC  X(0001).
  1880*    -------------------------------
  1881     05  COMMENTL PIC S9(0004) COMP.
  1882     05  COMMENTF PIC  X(0001).
  1883     05  FILLER REDEFINES COMMENTF.
  1884         10  COMMENTA PIC  X(0001).
  1885     05  COMMENTI PIC  X(0069).
  1886*    -------------------------------
  1887     05  ERRMSG1L PIC S9(0004) COMP.
  1888     05  ERRMSG1F PIC  X(0001).
  1889     05  FILLER REDEFINES ERRMSG1F.
  1890         10  ERRMSG1A PIC  X(0001).
  1891     05  ERRMSG1I PIC  X(0079).
  1892*    -------------------------------
  1893     05  ERRMSG2L PIC S9(0004) COMP.
  1894     05  ERRMSG2F PIC  X(0001).
  1895     05  FILLER REDEFINES ERRMSG2F.
  1896         10  ERRMSG2A PIC  X(0001).
  1897     05  ERRMSG2I PIC  X(0079).
  1898 01  EL691AO REDEFINES EL691AI.
  1899     05  FILLER            PIC  X(0012).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  RUNDTEO PIC  X(0008).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  RUNTIMEO PIC  99.99.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  COMPANYO PIC  X(0003).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  USERIDO PIC  X(0004).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  CARRIERO PIC  X(0001).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  GROUPO PIC  X(0006).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  STATEO PIC  X(0002).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  ACCTO PIC  X(0010).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  CERTO PIC  X(0010).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  35
* EL691.cbl
  1928     05  FILLER            PIC  X(0003).
  1929     05  SFXO PIC  X(0001).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  MAINTO PIC  X(0001).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  MAINTBYO PIC  X(0004).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  MAINTDTO PIC  99B99B99.
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  MAINTTMO PIC  99.99.
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  ARCHNOO PIC  X(0008).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  ENDARCHO PIC  X(0008).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  FORMNOO PIC  X(0004).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  RESFORMO PIC  X(0004).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  CREATDTO PIC  99B99B99.
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  RESENDO PIC  99B99B99.
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  CREATBYO PIC  X(0004).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  PRINTDTO PIC  99B99B99.
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  RESPRNTO PIC  99B99B99.
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  STCOMPO PIC  X(0019).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  REPLYO PIC  99B99B99.
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  STRECVO PIC  X(0019).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  STOPDTEO PIC  99B99B99.
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  STSTOPO PIC  X(0019).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  36
* EL691.cbl
  1986     05  OBVYNO PIC  X(0001).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  FINDATEO PIC  99B99B99.
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  STFINLO PIC  X(0019).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  OBUIDO PIC  ZZZ99.
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  FINLACTO PIC  X(0001).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  COMMENTO PIC  X(0069).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  ERRMSG1O PIC  X(0079).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  ERRMSG2O PIC  X(0079).
  2008*    -------------------------------
  2009****************************************************************
  2010*
  2011* Copyright (c) 2007-2013 Dell Inc.
  2012* All rights reserved.
  2013*
  2014****************************************************************
  2015 01  DFHEIV.
  2016   02  DFHEIV0               PIC X(35).
  2017   02  DFHEIV1               PIC X(08).
  2018   02  DFHEIV2               PIC X(08).
  2019   02  DFHEIV3               PIC X(08).
  2020   02  DFHEIV4               PIC X(06).
  2021   02  DFHEIV5               PIC X(04).
  2022   02  DFHEIV6               PIC X(04).
  2023   02  DFHEIV7               PIC X(02).
  2024   02  DFHEIV8               PIC X(02).
  2025   02  DFHEIV9               PIC X(01).
  2026   02  DFHEIV10              PIC S9(7) COMP-3.
  2027   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2028   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2029   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2030   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2031   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2032   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2033   02  DFHEIV17              PIC X(04).
  2034   02  DFHEIV18              PIC X(04).
  2035   02  DFHEIV19              PIC X(04).
  2036   02  DFHEIV20              USAGE IS POINTER.
  2037   02  DFHEIV21              USAGE IS POINTER.
  2038   02  DFHEIV22              USAGE IS POINTER.
  2039   02  DFHEIV23              USAGE IS POINTER.
  2040   02  DFHEIV24              USAGE IS POINTER.
  2041   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2042   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2043   02  DFHEIV27              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  37
* EL691.cbl
  2044   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2045   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2046   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2047   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2048   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2049   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2050   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2051   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2052   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2053   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2054   02  FILLER                PIC X(02).
  2055   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2056   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2057   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2058   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2059   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2060   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2061   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2062 LINKAGE  SECTION.
  2063*****************************************************************
  2064*                                                               *
  2065* Copyright (c) 2007-2013 Dell Inc.                             *
  2066* All rights reserved.                                          *
  2067*                                                               *
  2068*****************************************************************
  2069 01  dfheiblk.
  2070     02  eibtime          pic s9(7) comp-3.
  2071     02  eibdate          pic s9(7) comp-3.
  2072     02  eibtrnid         pic x(4).
  2073     02  eibtaskn         pic s9(7) comp-3.
  2074     02  eibtrmid         pic x(4).
  2075     02  dfheigdi         pic s9(4) comp.
  2076     02  eibcposn         pic s9(4) comp.
  2077     02  eibcalen         pic s9(4) comp.
  2078     02  eibaid           pic x(1).
  2079     02  eibfiller1       pic x(1).
  2080     02  eibfn            pic x(2).
  2081     02  eibfiller2       pic x(2).
  2082     02  eibrcode         pic x(6).
  2083     02  eibfiller3       pic x(2).
  2084     02  eibds            pic x(8).
  2085     02  eibreqid         pic x(8).
  2086     02  eibrsrce         pic x(8).
  2087     02  eibsync          pic x(1).
  2088     02  eibfree          pic x(1).
  2089     02  eibrecv          pic x(1).
  2090     02  eibsend          pic x(1).
  2091     02  eibatt           pic x(1).
  2092     02  eibeoc           pic x(1).
  2093     02  eibfmh           pic x(1).
  2094     02  eibcompl         pic x(1).
  2095     02  eibsig           pic x(1).
  2096     02  eibconf          pic x(1).
  2097     02  eiberr           pic x(1).
  2098     02  eibrldbk         pic x(1).
  2099     02  eiberrcd         pic x(4).
  2100     02  eibsynrb         pic x(1).
  2101     02  eibnodat         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  38
* EL691.cbl
  2102     02  eibfiller5       pic x(2).
  2103     02  eibresp          pic s9(8) comp.
  2104     02  eibresp2         pic s9(8) comp.
  2105     02  dfheigdj         pic s9(4) comp.
  2106     02  dfheigdk         pic s9(4) comp.
  2107 01  DFHCOMMAREA                 PIC X(1024).
  2108*                                COPY ERCARCH.
  2109******************************************************************
  2110*                                                                *
  2111*                            ERCARCH.                            *
  2112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2113*                            VMOD=2.002                          *
  2114*                                                                *
  2115*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2116*                                                                *
  2117*   FILE TYPE = VSAM,KSDS                                        *
  2118*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2119*                                                                *
  2120*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2121*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2122*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2123*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2124*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2125*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2126*                                                                *
  2127*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2128******************************************************************
  2129*                   C H A N G E   L O G
  2130*
  2131* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2132*-----------------------------------------------------------------
  2133*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2134* EFFECTIVE    NUMBER
  2135*-----------------------------------------------------------------
  2136* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2137* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2138* 110612    2012101700002  AJRA  ADD NEW FIELDS
  2139* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  2140******************************************************************
  2141 01  LETTER-ARCHIVE.
  2142     12  LA-RECORD-ID                PIC  X(02).
  2143         88  LA-VALID-ID                VALUE 'LA'.
  2144
  2145     12  LA-CONTROL-PRIMARY.
  2146         16  LA-COMPANY-CD           PIC  X(01).
  2147         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2148
  2149     12  LA-CONTROL-BY-CERT-RESP.
  2150         16  LA-COMPANY-CD-A2        PIC  X(01).
  2151         16  LA-CERT-NO-A2.
  2152             20  LA-CERT-PRIME-A2    PIC  X(10).
  2153             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2154         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2155             20  LA-RESP-PERSON-A2   PIC  X(10).
  2156             20  LA-TYPE-A2          PIC  X(01).
  2157         16  LA-CARRIER-A2           PIC  X(01).
  2158         16  LA-GROUPING-A2          PIC  X(06).
  2159         16  LA-STATE-A2             PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  39
* EL691.cbl
  2160         16  LA-ACCOUNT-A2           PIC  X(10).
  2161         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2162         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2163
  2164     12  LA-CONTROL-BY-FORM.
  2165         16  LA-COMPANY-CD-A3        PIC  X(01).
  2166         16  LA-FORM-A3              PIC  X(04).
  2167         16  LA-CARRIER-A3           PIC  X(01).
  2168         16  LA-GROUPING-A3          PIC  X(06).
  2169         16  LA-STATE-A3             PIC  X(02).
  2170         16  LA-ACCOUNT-A3           PIC  X(10).
  2171         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2172
  2173     12  LA-CONTROL-BY-PROCESSOR.
  2174         16  LA-COMPANY-CD-A4        PIC  X(01).
  2175         16  LA-PROCESSOR-CD         PIC  X(04).
  2176         16  LA-CARRIER-A4           PIC  X(01).
  2177         16  LA-GROUPING-A4          PIC  X(06).
  2178         16  LA-STATE-A4             PIC  X(02).
  2179         16  LA-ACCOUNT-A4           PIC  X(10).
  2180         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2181
  2182     12  LA-CONTROL-BY-KEY-FIELDS.
  2183         16  LA-COMPANY-CD-A5        PIC  X(01).
  2184         16  LA-CARRIER-A5           PIC  X(01).
  2185         16  LA-GROUPING-A5          PIC  X(06).
  2186         16  LA-STATE-A5             PIC  X(02).
  2187         16  LA-ACCOUNT-A5           PIC  X(10).
  2188         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2189
  2190     12  LA-CONTROL-BY-GROUP-CODE.
  2191         16  LA-COMPANY-CD-A6        PIC  X(01).
  2192         16  LA-ENTRY-A6.
  2193             20  LA-FILLER           PIC  X(02).
  2194             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2195         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2196
  2197     12  FILLER                      PIC  X(09).
  2198
  2199     12  LA-HEADER-RECORD.
  2200         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2201         16  LA-CREATION-DATE        PIC  X(02).
  2202         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2203         16  LA-FINAL-ACT-DATE       REDEFINES
  2204               LA-FOLLOW-UP-DATE     PIC  X(02).
  2205         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2206         16  LA-NO-OF-COPIES         PIC S9(01).
  2207         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2208         16  LA-REPLY-DATE           PIC  X(02).
  2209         16  LA-RESEND-DATES.
  2210             20  LA-RESEND-DATE      PIC  X(02).
  2211             20  LA-SENT-DATE        PIC  X(02).
  2212             20  FILLER              PIC  X(08).
  2213         16  LA-SOURCE-INFORMATION.
  2214             20  LA-DATA-SOURCE      PIC  X(01).
  2215             20  LA-ADDR-SOURCE      PIC  X(01).
  2216         16  LA-STATUS               PIC  X(01).
  2217             88  LA-STATUS-ACTIVE         VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  40
* EL691.cbl
  2218             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2219             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2220             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2221             88  LA-STATUS-PURGED         VALUE 'P'.
  2222             88  LA-STATUS-VOIDED         VALUE 'V'.
  2223         16  LA-LAST-RESENT-PRINT-DATE
  2224                                     PIC  X(02).
  2225         16  LA-PRINT-RESTRICTION    PIC  X(01).
  2226             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2227                                          VALUE 'C'.
  2228             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2229                                          VALUE 'F'.
  2230             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2231                                          VALUE 'P'.
  2232         16  LA-PURGED-DATE          PIC  X(02).
  2233         16  LA-VOIDED-DATE          PIC  X(02).
  2234         16  LA-RESEND-LETR          PIC  X(4).
  2235         16  LA-VOID-ONBASE-YN       PIC  X.
  2236         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  2237         16  FILLER                  PIC  X(04).
  2238*        16  LA-RESEND-LETR-2        PIC  X(4).
  2239*        16  LA-RESEND-LETR-3        PIC  X(4).
  2240*        16  FILLER                  PIC  X(59).
  2241         16  LA-ARCHIVE-STATUS       PIC  X.
  2242             88  LA-TEMP                VALUE 'T'.
  2243             88  LA-QWS                 VALUE 'Q'.
  2244             88  LA-BATCH               VALUE 'B'.
  2245         16  LA-FINAL-ACT-IND        PIC  X(1).
  2246         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2247         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  2248         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  2249                                     PIC X(4).
  2250         16  FILLER                  PIC  X(42).
  2251*        16  FILLER                  PIC  X(71).
  2252         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2253         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2254         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2255                                     PIC  X(4).
  2256         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2257
  2258******************************************************************
  2259*                                COPY ERCARCT.
  2260******************************************************************
  2261*                                                                *
  2262*                            ERCARCT.                            *
  2263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2264*                            VMOD=2.002                          *
  2265*                                                                *
  2266*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  2267*                                                                *
  2268*   FILE TYPE = VSAM,KSDS                                        *
  2269*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  2270*                                                                *
  2271*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  2272*                                                                *
  2273*   LOG = NO                                                     *
  2274*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2275******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  41
* EL691.cbl
  2276*                   C H A N G E   L O G
  2277*
  2278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2279*-----------------------------------------------------------------
  2280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2281* EFFECTIVE    NUMBER
  2282*-----------------------------------------------------------------
  2283* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2284******************************************************************
  2285 01  LETTER-ARCHIVE-TEXT.
  2286     12  LT-RECORD-ID                PIC  X(02).
  2287         88  LT-VALID-ID                VALUE 'LT'.
  2288
  2289     12  LT-CONTROL-PRIMARY.
  2290         16  LT-COMPANY-CD           PIC  X(01).
  2291         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  2292         16  LT-RECORD-TYPE          PIC  X(01).
  2293             88  LT-ADDRESS-DATA        VALUE '1'.
  2294             88  LT-TEXT-DATA           VALUE '2'.
  2295             88  LT-COMMENT-DATA        VALUE '3'.
  2296         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  2297
  2298     12  FILLER                      PIC  X(28).
  2299     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  2300
  2301     12  LT-TEXT-RECORD.
  2302         16  LT-LETTER-TEXT OCCURS 20 TIMES
  2303                            INDEXED BY LT-NDX.
  2304             20  LT-TEXT-LINE        PIC  X(70).
  2305             20  LT-SKIP-CONTROL     PIC  X(02).
  2306                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  2307                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  2308             20  FILLER              PIC  X(08).
  2309
  2310     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  2311         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  2312             20  LT-COMMENT-LINE     PIC X(69).
  2313             20  LT-COMMENT-CHG-DT   PIC X(02).
  2314             20  LT-COMMENT-CHG-BY   PIC X(04).
  2315             20  FILLER              PIC X(05).
  2316
  2317*                                COPY ELCCERT.
  2318******************************************************************
  2319*                                                                *
  2320*                            ELCCERT.                            *
  2321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2322*                            VMOD=2.013                          *
  2323*                                                                *
  2324*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2325*                                                                *
  2326*   FILE TYPE = VSAM,KSDS                                        *
  2327*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2328*                                                                *
  2329*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2330*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2331*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2332*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2333*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  42
* EL691.cbl
  2334*                                                                *
  2335*   LOG = YES                                                    *
  2336*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2337******************************************************************
  2338*                   C H A N G E   L O G
  2339*
  2340* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2341*-----------------------------------------------------------------
  2342*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2343* EFFECTIVE    NUMBER
  2344*-----------------------------------------------------------------
  2345* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2346* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2347* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2348* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2349* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2350* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2351* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2352* 032612  CR2011110200001  PEMA  AHL CHANGES
  2353* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2354* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2355* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2356******************************************************************
  2357
  2358 01  CERTIFICATE-MASTER.
  2359     12  CM-RECORD-ID                      PIC XX.
  2360         88  VALID-CM-ID                      VALUE 'CM'.
  2361
  2362     12  CM-CONTROL-PRIMARY.
  2363         16  CM-COMPANY-CD                 PIC X.
  2364         16  CM-CARRIER                    PIC X.
  2365         16  CM-GROUPING.
  2366             20  CM-GROUPING-PREFIX        PIC X(3).
  2367             20  CM-GROUPING-PRIME         PIC X(3).
  2368         16  CM-STATE                      PIC XX.
  2369         16  CM-ACCOUNT.
  2370             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2371             20  CM-ACCOUNT-PRIME          PIC X(6).
  2372         16  CM-CERT-EFF-DT                PIC XX.
  2373         16  CM-CERT-NO.
  2374             20  CM-CERT-PRIME             PIC X(10).
  2375             20  CM-CERT-SFX               PIC X.
  2376
  2377     12  CM-CONTROL-BY-NAME.
  2378         16  CM-COMPANY-CD-A1              PIC X.
  2379         16  CM-INSURED-LAST-NAME          PIC X(15).
  2380         16  CM-INSURED-INITIALS.
  2381             20  CM-INSURED-INITIAL1       PIC X.
  2382             20  CM-INSURED-INITIAL2       PIC X.
  2383
  2384     12  CM-CONTROL-BY-SSN.
  2385         16  CM-COMPANY-CD-A2              PIC X.
  2386         16  CM-SOC-SEC-NO.
  2387             20  CM-SSN-STATE              PIC XX.
  2388             20  CM-SSN-ACCOUNT            PIC X(6).
  2389             20  CM-SSN-LN3.
  2390                 25  CM-INSURED-INITIALS-A2.
  2391                     30 CM-INSURED-INITIAL1-A2   PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  43
* EL691.cbl
  2392                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2393                 25 CM-PART-LAST-NAME-A2         PIC X.
  2394
  2395     12  CM-CONTROL-BY-CERT-NO.
  2396         16  CM-COMPANY-CD-A4              PIC X.
  2397         16  CM-CERT-NO-A4                 PIC X(11).
  2398
  2399     12  CM-CONTROL-BY-MEMB.
  2400         16  CM-COMPANY-CD-A5              PIC X.
  2401         16  CM-MEMBER-NO.
  2402             20  CM-MEMB-STATE             PIC XX.
  2403             20  CM-MEMB-ACCOUNT           PIC X(6).
  2404             20  CM-MEMB-LN4.
  2405                 25  CM-INSURED-INITIALS-A5.
  2406                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2407                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2408                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2409
  2410     12  CM-INSURED-PROFILE-DATA.
  2411         16  CM-INSURED-FIRST-NAME.
  2412             20  CM-INSURED-1ST-INIT       PIC X.
  2413             20  FILLER                    PIC X(9).
  2414         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2415         16  CM-INSURED-SEX                PIC X.
  2416             88  CM-SEX-MALE                  VALUE 'M'.
  2417             88  CM-SEX-FEMAL                 VALUE 'F'.
  2418         16  CM-INSURED-JOINT-AGE          PIC 99.
  2419         16  CM-JOINT-INSURED-NAME.
  2420             20  CM-JT-LAST-NAME           PIC X(15).
  2421             20  CM-JT-FIRST-NAME.
  2422                 24  CM-JT-1ST-INIT        PIC X.
  2423                 24  FILLER                PIC X(9).
  2424             20  CM-JT-INITIAL             PIC X.
  2425
  2426     12  CM-LIFE-DATA.
  2427         16  CM-LF-BENEFIT-CD              PIC XX.
  2428         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2429         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2430         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2431         16  CM-LF-DEV-CODE                PIC XXX.
  2432         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2433         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2434         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2435         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2436         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2437         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2438         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2439         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2440         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2441         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2442         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2443         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2444         16  cm-temp-epiq                  pic xx.
  2445             88  EPIQ-CLASS                  value 'EQ'.
  2446*        16  FILLER                        PIC XX.
  2447
  2448     12  CM-AH-DATA.
  2449         16  CM-AH-BENEFIT-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  44
* EL691.cbl
  2450         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2451         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2452         16  CM-AH-DEV-CODE                PIC XXX.
  2453         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2454         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2455         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2456         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2457         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2458         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2459         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2460         16  CM-AH-PAID-THRU-DT            PIC XX.
  2461             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2462         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2463         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2464         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2465         16  FILLER                        PIC X.
  2466
  2467     12  CM-LOAN-INFORMATION.
  2468         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2469         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2470                                           PIC S9(5)V99  COMP-3.
  2471         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2472         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2473         16  CM-PAY-FREQUENCY              PIC S99.
  2474         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2475         16  CM-RATE-CLASS                 PIC XX.
  2476         16  CM-BENEFICIARY                PIC X(25).
  2477         16  CM-POLICY-FORM-NO             PIC X(12).
  2478         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2479         16  CM-LAST-ADD-ON-DT             PIC XX.
  2480         16  CM-DEDUCTIBLE-AMOUNTS.
  2481             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2482             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2483         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2484             20  CM-RESIDENT-STATE         PIC XX.
  2485             20  CM-RATE-CODE              PIC X(4).
  2486             20  FILLER                    PIC XX.
  2487         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2488             20  CM-LOAN-OFFICER           PIC X(5).
  2489             20  FILLER                    PIC XXX.
  2490         16  CM-CSR-CODE                   PIC XXX.
  2491         16  CM-UNDERWRITING-CODE          PIC X.
  2492             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2493         16  CM-POST-CARD-IND              PIC X.
  2494         16  CM-REF-INTERFACE-SW           PIC X.
  2495         16  CM-PREMIUM-TYPE               PIC X.
  2496             88  CM-SING-PRM                  VALUE '1'.
  2497             88  CM-O-B-COVERAGE              VALUE '2'.
  2498             88  CM-OPEN-END                  VALUE '3'.
  2499         16  CM-IND-GRP-TYPE               PIC X.
  2500             88  CM-INDIVIDUAL                VALUE 'I'.
  2501             88  CM-GROUP                     VALUE 'G'.
  2502         16  CM-SKIP-CODE                  PIC X.
  2503             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2504             88  SKIP-JULY                    VALUE '1'.
  2505             88  SKIP-AUGUST                  VALUE '2'.
  2506             88  SKIP-SEPTEMBER               VALUE '3'.
  2507             88  SKIP-JULY-AUG                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  45
* EL691.cbl
  2508             88  SKIP-AUG-SEPT                VALUE '5'.
  2509             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2510             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2511             88  SKIP-JUNE                    VALUE '8'.
  2512             88  SKIP-JUNE-JULY               VALUE '9'.
  2513             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2514             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2515         16  CM-PAYMENT-MODE               PIC X.
  2516             88  PAY-MONTHLY                  VALUE SPACE.
  2517             88  PAY-WEEKLY                   VALUE '1'.
  2518             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2519             88  PAY-BI-WEEKLY                VALUE '3'.
  2520             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2521         16  CM-LOAN-NUMBER                PIC X(8).
  2522         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2523         16  CM-OLD-LOF                    PIC XXX.
  2524*        16  CM-LOAN-OFFICER               PIC XXX.
  2525         16  CM-REIN-TABLE                 PIC XXX.
  2526         16  CM-SPECIAL-REIN-CODE          PIC X.
  2527         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2528         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2529         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2530
  2531     12  CM-STATUS-DATA.
  2532         16  CM-ENTRY-STATUS               PIC X.
  2533         16  CM-ENTRY-DT                   PIC XX.
  2534
  2535         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2536         16  CM-LF-CANCEL-DT               PIC XX.
  2537         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2538
  2539         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2540         16  CM-LF-DEATH-DT                PIC XX.
  2541         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2542
  2543         16  CM-LF-CURRENT-STATUS          PIC X.
  2544             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2545                                                'M' '4' '5' '9'.
  2546             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2547             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2548             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2549             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2550             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2551             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2552             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2553             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2554             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2555             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2556             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2557             88  CM-LF-DECLINED               VALUE 'D'.
  2558             88  CM-LF-VOIDED                 VALUE 'V'.
  2559
  2560         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2561         16  CM-AH-CANCEL-DT               PIC XX.
  2562         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2563
  2564         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2565         16  CM-AH-SETTLEMENT-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  46
* EL691.cbl
  2566         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2567
  2568         16  CM-AH-CURRENT-STATUS          PIC X.
  2569             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2570                                                'M' '4' '5' '9'.
  2571             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2572             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2573             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2574             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2575             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2576             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2577             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2578             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2579             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2580             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2581             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2582             88  CM-AH-DECLINED               VALUE 'D'.
  2583             88  CM-AH-VOIDED                 VALUE 'V'.
  2584
  2585         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2586             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2587             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2588             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2589         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2590
  2591         16  CM-ENTRY-BATCH                PIC X(6).
  2592         16  CM-LF-EXIT-BATCH              PIC X(6).
  2593         16  CM-AH-EXIT-BATCH              PIC X(6).
  2594         16  CM-LAST-MONTH-END             PIC XX.
  2595
  2596     12  CM-NOTE-SW                        PIC X.
  2597         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2598         88  CERT-NOTES-PRESENT               VALUE '1'.
  2599         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2600         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2601         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2602         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2603         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2604         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2605     12  CM-COMP-EXCP-SW                   PIC X.
  2606         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2607         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2608     12  CM-INSURED-ADDRESS-SW             PIC X.
  2609         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2610         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2611
  2612*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2613     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2614     12  FILLER                            PIC X.
  2615
  2616*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2617     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2618     12  FILLER                            PIC X.
  2619*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2620     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2621
  2622     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2623         88  CERT-ADDED-BATCH                 VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  47
* EL691.cbl
  2624         88  CERT-ADDED-ONLINE                VALUE '1'.
  2625         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2626         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2627         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2628     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2629         88  CERT-AS-LOADED                   VALUE ' '.
  2630         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2631         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2632         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2633         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2634         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2635         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2636         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2637
  2638     12  CM-ACCOUNT-COMM-PCTS.
  2639         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2640         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2641
  2642     12  CM-USER-FIELD                     PIC X.
  2643     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2644     12  CM-CLP-STATE                      PIC XX.
  2645     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2646     12  CM-USER-RESERVED                  PIC XXX.
  2647     12  FILLER REDEFINES CM-USER-RESERVED.
  2648         16  CM-AH-CLASS-CD                PIC XX.
  2649         16  F                             PIC X.
  2650******************************************************************
  2651*                                COPY ELCEOBC.
  2652******************************************************************
  2653*                                                                *
  2654*                                                                *
  2655*                            ELCEOBC                             *
  2656*                            VMOD=2.001                          *
  2657*                                                                *
  2658*   CLAIM SYSTEM EOB CODE TABLE                                  *
  2659*                                                                *
  2660*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2661*   VSAM EOB CODE TABLE                                          *
  2662*                                                                *
  2663*   FILE DESCRIPTION = EOB CODE TABLE                            *
  2664*                                                                *
  2665*   FILE TYPE = VSAM,KSDS                                        *
  2666*   RECORD SIZE = 350   RECFORM = FIX                            *
  2667*                                                                *
  2668*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  2669*                                                                *
  2670*   LOG = NO                                                     *
  2671*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2672*                                                                *
  2673*                                                                *
  2674******************************************************************
  2675*                   C H A N G E   L O G
  2676*
  2677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2678*-----------------------------------------------------------------
  2679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2680* EFFECTIVE    NUMBER
  2681*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  48
* EL691.cbl
  2682* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  2683* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  2684* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  2685******************************************************************
  2686 01  EOB-CODES.
  2687     12  EO-RECORD-ID                      PIC XX.
  2688         88  VALID-DN-ID                      VALUE 'EO'.
  2689     12  EO-CONTROL-PRIMARY.
  2690         16  EO-COMPANY-CD                 PIC X.
  2691         16  EO-RECORD-TYPE                PIC X.
  2692             88  EO-EOB-RECS                  VALUE '1'.
  2693             88  EO-VERIF-RECS                VALUE '2'.
  2694             88  EO-GCE-RECS                  VALUE '3'.
  2695             88  EO-CANC-RECS                 VALUE '4'.
  2696             88  EO-BILL-NOTE-RECS            VALUE '5'.
  2697         16  EO-EOB-CODE                   PIC X(4).
  2698         16  FILLER                        PIC X(9).
  2699     12  EO-MAINT-INFORMATION.
  2700         16  EO-LAST-MAINT-DT              PIC XX.
  2701         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2702         16  EO-LAST-MAINT-USER            PIC X(4).
  2703         16  FILLER                        PIC XX.
  2704     12  EO-DESCRIPTION                    PIC X(275).
  2705     12  FILLER                            PIC X(46).
  2706******************************************************************
  2707*                                COPY ERCNOTE.
  2708******************************************************************
  2709*                                                                *
  2710*                                                                *
  2711*                            ERCNOTE                             *
  2712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2713*                            VMOD=2.003                          *
  2714*                                                                *
  2715*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2716*                                                                *
  2717*        FILE TYPE= VSAM,KSDS                                    *
  2718*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2719*                                                                *
  2720*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2721*                                                                *
  2722*        LOG = YES                                               *
  2723*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2724*                                                                *
  2725******************************************************************
  2726*                   C H A N G E   L O G
  2727*
  2728* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2729*-----------------------------------------------------------------
  2730*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2731* EFFECTIVE    NUMBER
  2732*-----------------------------------------------------------------
  2733* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2734*                                FILE WILL CONTAIN BILLING NOTES O
  2735******************************************************************
  2736
  2737 01  CERTIFICATE-NOTE.
  2738     12  CN-RECORD-ID                PIC  XX.
  2739         88  VALID-CN-ID                  VALUE 'CN'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  49
* EL691.cbl
  2740
  2741     12  CN-CONTROL-PRIMARY.
  2742         16  CN-COMPANY-CD           PIC X.
  2743         16  CN-CARRIER              PIC X.
  2744         16  CN-GROUPING.
  2745             20 CN-GROUPING-PREFIX   PIC XXX.
  2746             20 CN-GROUPING-PRIME    PIC XXX.
  2747         16  CN-STATE                PIC XX.
  2748         16  CN-ACCOUNT.
  2749             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2750             20 CN-ACCOUNT-PRIME     PIC X(6).
  2751         16  CN-CERT-EFF-DT          PIC XX.
  2752         16  CN-CERT-NO.
  2753             20  CN-CERT-PRIME       PIC X(10).
  2754             20  CN-CERT-SFX         PIC X.
  2755
  2756     12  CN-BILLING-START-LINE-NO    PIC 99.
  2757     12  CN-BILLING-END-LINE-NO      PIC 99.
  2758
  2759     12  CN-LINES.
  2760         16  CN-LINE OCCURS 10       PIC X(77).
  2761
  2762     12  CN-LAST-MAINT-DT            PIC XX.
  2763     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2764     12  CN-LAST-MAINT-USER          PIC X(4).
  2765     12  FILLER                      PIC X(6).
  2766******************************************************************
  2767 01  var                         pic x(30).
  2768 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  2769                          LETTER-ARCHIVE-TEXT
  2770                          CERTIFICATE-MASTER EOB-CODES
  2771                          CERTIFICATE-NOTE VAR.
  2772 0000-DFHEXIT SECTION.
  2773     MOVE '9#                    $   ' TO DFHEIV0.
  2774     MOVE 'EL691' TO DFHEIV1.
  2775     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2776     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2777
  2778     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2779     MOVE '5'                    TO DC-OPTION-CODE.
  2780     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  2781     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  2782     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  2783                                    W-CURRENT-SAVE.
  2784
  2785     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2786     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2787                                 TO EMI-SAVE-AREA.
  2788
  2789     IF  EIBCALEN EQUAL 0
  2790         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  2791         GO TO 8300-SEND-TEXT
  2792     END-IF.
  2793     set P to address of KIXSYS
  2794     CALL "getenv" using by value P returning var-ptr
  2795     if var-ptr = null then
  2796        display ' kixsys not set '
  2797     else
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  50
* EL691.cbl
  2798        set address of var to var-ptr
  2799        move 0 to env-var-len
  2800        inspect var tallying env-var-len
  2801          for characters before X'00'
  2802        unstring var (1:env-var-len) delimited by '/'
  2803           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2804              WS-KIX-SYS
  2805        end-unstring
  2806     end-if
  2807     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  2808         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  2809             MOVE PI-SAVED-PROGRAM-5
  2810                                 TO PI-SAVED-PROGRAM-6
  2811             MOVE PI-SAVED-PROGRAM-4
  2812                                 TO PI-SAVED-PROGRAM-5
  2813             MOVE PI-SAVED-PROGRAM-3
  2814                                 TO PI-SAVED-PROGRAM-4
  2815             MOVE PI-SAVED-PROGRAM-2
  2816                                 TO PI-SAVED-PROGRAM-3
  2817             MOVE PI-SAVED-PROGRAM-1
  2818                                 TO PI-SAVED-PROGRAM-2
  2819             MOVE PI-RETURN-TO-PROGRAM
  2820                                 TO PI-SAVED-PROGRAM-1
  2821             MOVE PI-CALLING-PROGRAM
  2822                                 TO PI-RETURN-TO-PROGRAM
  2823             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  2824         ELSE
  2825             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  2826             MOVE PI-RETURN-TO-PROGRAM
  2827                                     TO PI-CALLING-PROGRAM
  2828             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  2829             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  2830             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  2831             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  2832             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  2833             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  2834             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  2835         END-IF
  2836     ELSE
  2837         GO TO 0200-RECEIVE
  2838     END-IF.
  2839
  2840     GO TO 1000-SHOW.
  2841
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  51
* EL691.cbl
  2843
  2844 0200-RECEIVE.
  2845
  2846
  2847* EXEC CICS HANDLE AID
  2848*        CLEAR    (9300-DFHCLEAR)
  2849*        PA1      (9200-PA)
  2850*        PA2      (9200-PA)
  2851*        PA3      (9200-PA)
  2852*    END-EXEC.
  2853*    MOVE '"&=!"#               V! " #00002749' TO DFHEIV0
  2854     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2855     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2856     MOVE X'2220233030303032373439' TO DFHEIV0(25:11)
  2857     CALL 'kxdfhei1' USING DFHEIV0
  2858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2859
  2860
  2861
  2862* EXEC CICS HANDLE CONDITION
  2863*        PGMIDERR (9700-PGMID-ERROR)
  2864*        ERROR    (9800-ABEND)
  2865*    END-EXEC.
  2866*    MOVE '"$L.                  ! # #00002756' TO DFHEIV0
  2867     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2869     MOVE X'2320233030303032373536' TO DFHEIV0(25:11)
  2870     CALL 'kxdfhei1' USING DFHEIV0
  2871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2872
  2873
  2874
  2875* EXEC CICS RECEIVE
  2876*        MAP      (W-MAP)
  2877*        MAPSET   (W-MAPSET)
  2878*        INTO     (EL691AI)
  2879*    END-EXEC.
  2880     MOVE LENGTH OF
  2881      EL691AI
  2882       TO DFHEIV11
  2883*    MOVE '8"T I  L              ''   #00002761' TO DFHEIV0
  2884     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2885     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2886     MOVE X'2020233030303032373631' TO DFHEIV0(25:11)
  2887     CALL 'kxdfhei1' USING DFHEIV0,
  2888           W-MAP,
  2889           EL691AI,
  2890           DFHEIV11,
  2891           W-MAPSET,
  2892           DFHEIV99,
  2893           DFHEIV99
  2894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2895
  2896
  2897     IF  NOT DISPLAY-CAP
  2898         MOVE 'READ'             TO SM-READ
  2899         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2900         MOVE ER-9097            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  52
* EL691.cbl
  2901         MOVE -1                 TO MAINTL
  2902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2903         GO TO 8100-SEND-INITIAL-MAP
  2904     END-IF.
  2905
  2906
  2907 0300-CHECK-PFKEYS.
  2908
  2909     IF  EIBAID EQUAL DFHPF23
  2910         MOVE EIBAID             TO PI-ENTRY-CD-1
  2911         MOVE W-XCTL-005         TO W-CALL-PGM
  2912         GO TO 9400-XCTL
  2913     END-IF.
  2914
  2915     IF  EIBAID EQUAL DFHPF24
  2916         MOVE W-XCTL-626         TO W-CALL-PGM
  2917         GO TO 9400-XCTL
  2918     END-IF.
  2919
  2920     IF  EIBAID EQUAL DFHPF6
  2921         MOVE W-XCTL-1279        TO W-CALL-PGM
  2922         GO TO 9400-XCTL
  2923     END-IF
  2924
  2925     IF  MAINTI EQUAL 'C'  AND
  2926         EIBAID EQUAL DFHENTER
  2927          GO TO 0700-PROCESS-CHANGES
  2928     END-IF.
  2929
  2930     MOVE ER-0029                TO EMI-ERROR.
  2931
  2932
  2933 0320-INPUT-ERROR.
  2934
  2935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2936     MOVE -1                     TO  MAINTL.
  2937     GO TO 8200-SEND-DATAONLY.
  2938
  2939
  2940 0700-PROCESS-CHANGES.
  2941
  2942     IF  NOT MODIFY-CAP
  2943         MOVE 'UPDATE'           TO SM-READ
  2944         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2945         MOVE ER-0070            TO EMI-ERROR
  2946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2947         MOVE -1                 TO MAINTL
  2948         GO TO 8100-SEND-INITIAL-MAP
  2949     END-IF.
  2950
  2951     IF RESFORML > ZEROS
  2952        AND RESFORMI > SPACES
  2953        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  2954        MOVE RESFORMI            TO LETR-LETTER-ID
  2955        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  2956        MOVE SPACES              TO LETR-FILLER
  2957        MOVE 0                   TO LETR-SEQ-NO
  2958        PERFORM 1500-CHECK-Z-RECORD THRU 1500-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  53
* EL691.cbl
  2959        IF Z-RECORD-NOT-FOUND
  2960           MOVE ER-1236          TO EMI-ERROR
  2961           MOVE -1               TO RESFORML
  2962           MOVE AL-UABON         TO RESFORMA
  2963           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2964        END-IF
  2965     END-IF
  2966
  2967     MOVE 'N'                    TO W-NEED-COMMENT.
  2968
  2969     IF RESENDL GREATER ZERO
  2970         MOVE 'Y'                TO W-NEED-COMMENT
  2971         IF RESENDI = SPACES
  2972             MOVE AL-UANON       TO  RESENDA
  2973             MOVE +1             TO  W-UPDATE-SW
  2974             MOVE LOW-VALUES     TO  W-RESEND-DATE
  2975         ELSE
  2976             MOVE RESENDI       TO  W-DEEDIT-FIELD
  2977             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2978             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2979                 MOVE W-DEEDIT-FIELD-V0  TO  RESENDO
  2980                 INSPECT RESENDI CONVERTING SPACES TO SLASH
  2981                 MOVE '4'        TO  DC-OPTION-CODE
  2982                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2983                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2984                 IF DC-ERROR-CODE NOT = SPACES
  2985                     MOVE ER-0295         TO  EMI-ERROR
  2986                     MOVE -1              TO  RESENDL
  2987                     MOVE AL-UABON        TO  RESENDA
  2988                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2989                 ELSE
  2990                     MOVE AL-UANON       TO  RESENDA
  2991                     MOVE +1             TO  W-UPDATE-SW
  2992                     MOVE DC-BIN-DATE-1  TO  W-RESEND-DATE
  2993                 END-IF
  2994             ELSE
  2995                 MOVE ER-0295    TO  EMI-ERROR
  2996                 MOVE -1         TO  RESENDL
  2997                 MOVE AL-UABON   TO  RESENDA
  2998                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2999             END-IF
  3000         END-IF
  3001     END-IF.
  3002
  3003     IF FINDATEL GREATER ZERO
  3004         IF FINDATEI = SPACES
  3005             MOVE AL-UANON       TO  FINDATEA
  3006             MOVE +1             TO  W-UPDATE-SW
  3007             MOVE LOW-VALUES     TO  W-FINAL-ACT-DATE
  3008             MOVE SPACES         TO  PI-ARCHIVE-FINAL
  3009         ELSE
  3010             MOVE 'Y'             TO  PI-ARCHIVE-FINAL
  3011             MOVE FINDATEI        TO  W-DEEDIT-FIELD
  3012             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3013             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3014                 MOVE W-DEEDIT-FIELD-V0  TO  FINDATEO
  3015                 INSPECT FINDATEI CONVERTING SPACES TO SLASH
  3016                 MOVE '4'                 TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  54
* EL691.cbl
  3017                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  3018                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3019                 IF DC-ERROR-CODE NOT = SPACES
  3020                     MOVE ER-0296        TO  EMI-ERROR
  3021                     MOVE -1             TO  FINDATEL
  3022                     MOVE AL-UABON       TO  FINDATEA
  3023                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3024                 ELSE
  3025                     MOVE AL-UANON       TO  FINDATEA
  3026                     MOVE +1             TO  W-UPDATE-SW
  3027                     MOVE DC-BIN-DATE-1  TO  W-FINAL-ACT-DATE
  3028                 END-IF
  3029             ELSE
  3030                 MOVE ER-0296    TO  EMI-ERROR
  3031                 MOVE -1         TO  FINDATEL
  3032                 MOVE AL-UABON   TO  FINDATEA
  3033                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3034             END-IF
  3035         END-IF
  3036     END-IF.
  3037
  3038     IF REPLYL GREATER ZERO
  3039         IF REPLYI = SPACES
  3040             MOVE AL-UANON       TO  REPLYA
  3041             MOVE +1             TO  W-UPDATE-SW
  3042             MOVE LOW-VALUES     TO  W-RECEIVED-DATE
  3043             MOVE SPACES         TO  PI-ARCHIVE-RECEIVED
  3044                                     WS-RECEIVED-NOTE
  3045             PERFORM 4500-UPDATE-BILL-NOTE THRU 4500-EXIT
  3046         ELSE
  3047             MOVE 'Y'            TO  PI-ARCHIVE-RECEIVED
  3048             MOVE REPLYI         TO  W-DEEDIT-FIELD
  3049             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3050             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3051                 MOVE W-DEEDIT-FIELD-V0  TO  REPLYO
  3052                 INSPECT REPLYI CONVERTING SPACES TO SLASH
  3053                 MOVE '4'        TO  DC-OPTION-CODE
  3054                 MOVE W-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  3055                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3056                 IF DC-ERROR-CODE NOT = SPACES
  3057                     MOVE ER-9245        TO  EMI-ERROR
  3058                     MOVE -1             TO  REPLYL
  3059                     MOVE AL-UABON       TO  REPLYA
  3060                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3061                 ELSE
  3062                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  3063                       MOVE ER-0539      TO  EMI-ERROR
  3064                       MOVE -1           TO  REPLYL
  3065                       MOVE AL-UABON     TO  REPLYA
  3066                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3067                   ELSE
  3068                       MOVE AL-UANON     TO  REPLYA
  3069                       MOVE +1           TO  W-UPDATE-SW
  3070                       MOVE DC-BIN-DATE-1 TO W-RECEIVED-DATE
  3071                       MOVE DC-GREG-DATE-1-EDIT TO
  3072                                        W-CERT-NOTE-RECV-DT
  3073                                        WS-BN-RECV-DATE
  3074                   END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  55
* EL691.cbl
  3075                 END-IF
  3076             ELSE
  3077                 MOVE ER-9245    TO  EMI-ERROR
  3078                 MOVE -1         TO  REPLYL
  3079                 MOVE AL-UABON   TO  REPLYA
  3080                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3081             END-IF
  3082         END-IF
  3083     END-IF.
  3084
  3085     IF STOPDTEL GREATER ZERO
  3086         IF STOPDTEI = SPACES
  3087             MOVE AL-UANON       TO  STOPDTEA
  3088             MOVE +1             TO  W-UPDATE-SW
  3089             MOVE LOW-VALUES     TO  W-STOP-LETTER-DATE
  3090             MOVE SPACES         TO  PI-ARCHIVE-STOPPED
  3091             MOVE AL-UANOF       TO  RESENDA
  3092                                     RESFORMA
  3093                                     FINDATEA
  3094                                     FINLACTA
  3095                                     REPLYA
  3096                                     COMMENTA
  3097         ELSE
  3098             MOVE 'Y'            TO  PI-ARCHIVE-STOPPED
  3099             MOVE 'Y'            TO  W-NEED-COMMENT
  3100             MOVE STOPDTEI       TO  W-DEEDIT-FIELD
  3101             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3102             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3103                 MOVE W-DEEDIT-FIELD-V0  TO  STOPDTEO
  3104                 INSPECT STOPDTEI CONVERTING SPACES TO SLASH
  3105                 MOVE '4'        TO  DC-OPTION-CODE
  3106                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  3107                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3108                 IF DC-ERROR-CODE NOT = SPACES
  3109                     MOVE ER-0897         TO  EMI-ERROR
  3110                     MOVE -1              TO  STOPDTEL
  3111                     MOVE AL-UABON        TO  STOPDTEA
  3112                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3113                 ELSE
  3114                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  3115                       MOVE ER-0895      TO  EMI-ERROR
  3116                       MOVE -1           TO  STOPDTEL
  3117                       MOVE AL-UABON     TO  STOPDTEA
  3118                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3119                   ELSE
  3120                     MOVE AL-UANON       TO  STOPDTEA
  3121                     MOVE +1             TO  W-UPDATE-SW
  3122                     MOVE DC-BIN-DATE-1  TO  W-STOP-LETTER-DATE
  3123                   END-IF
  3124                 END-IF
  3125             ELSE
  3126                 MOVE ER-0897    TO  EMI-ERROR
  3127                 MOVE -1         TO  STOPDTEL
  3128                 MOVE AL-UABON   TO  STOPDTEA
  3129                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3130             END-IF
  3131         END-IF
  3132     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  56
* EL691.cbl
  3133
  3134     IF W-NEED-COMMENT = 'Y'  AND
  3135        COMMENTL NOT > ZERO
  3136           MOVE -1         TO  COMMENTL
  3137           MOVE ER-7363    TO  EMI-ERROR
  3138           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3139     END-IF.
  3140     if (stopdtel > zeros)
  3141        and (PI-ARCHIVE-STOPPED = 'Y')
  3142        and (pi-initial-print-date <> low-values)
  3143        if obvyni not = 'Y' AND 'N'
  3144           move -1               to obvynl
  3145           move al-uabon         to obvyna
  3146           move er-7364          to emi-error
  3147           perform 9900-error-format
  3148                                 thru 9900-exit
  3149        end-if
  3150     end-if
  3151     if obvynl > zeros
  3152        and pi-archive-stopped <> 'Y'
  3153        move -1                  to stopdtel
  3154        move al-uabon            to stopdtea
  3155        move er-7333             to emi-error
  3156        perform 9900-error-format
  3157                                 thru 9900-exit
  3158     end-if
  3159     IF COMMENTL GREATER ZERO
  3160      OR  RESFORML GREATER ZERO
  3161      OR  FINLACTL GREATER ZERO
  3162      or obvynl > 0
  3163         MOVE +1          TO  W-UPDATE-SW
  3164     END-IF.
  3165
  3166     IF W-ERROR-COUNT GREATER ZERO
  3167         GO TO 8200-SEND-DATAONLY
  3168     END-IF.
  3169
  3170     IF W-UPDATE-SW NOT GREATER ZERO
  3171         MOVE ER-3112    TO  EMI-ERROR
  3172         MOVE -1         TO  MAINTL
  3173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3174         GO TO 8200-SEND-DATAONLY
  3175     END-IF.
  3176
  3177     IF PI-ARCHIVE-STOPPED = 'Y'
  3178        MOVE AL-SANOF       TO RESENDA
  3179                               RESFORMA
  3180                               FINDATEA
  3181                               FINLACTA
  3182                               REPLYA
  3183*                              COMMENTA
  3184     END-IF.
  3185
  3186     PERFORM 3000-READ-FOR-UPDATE THRU 3000-EXIT.
  3187
  3188     IF RESENDL GREATER ZERO
  3189         MOVE W-RESEND-DATE      TO  LA-RESEND-DATE
  3190     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  57
* EL691.cbl
  3191
  3192     IF FINDATEL GREATER ZERO
  3193         MOVE W-FINAL-ACT-DATE   TO  LA-FINAL-ACT-DATE
  3194     END-IF.
  3195     IF REPLYL GREATER ZERO  *> its really received date
  3196        MOVE W-RECEIVED-DATE     TO LA-REPLY-DATE
  3197        IF W-RECEIVED-DATE <> LOW-VALUES
  3198           move w-cert-note-msg  to w-comment-line-1
  3199           move +1               to w-comment-line-cnt
  3200           PERFORM 4000-ADD-CERT-NOTE
  3201                                 THRU 4099-EXIT
  3202           PERFORM 4500-UPDATE-BILL-NOTE
  3203                                 THRU 4500-EXIT
  3204        END-IF
  3205     END-IF
  3206     IF RESFORML GREATER ZERO
  3207        MOVE RESFORMI            TO  LA-RESEND-LETR
  3208     END-IF.
  3209
  3210     IF FINLACTL GREATER ZERO
  3211        MOVE FINLACTI            TO  LA-FINAL-ACT-IND
  3212     END-IF.
  3213
  3214     IF STOPDTEL GREATER ZERO
  3215        MOVE W-STOP-LETTER-DATE  TO  LA-VOIDED-DATE
  3216     END-IF.
  3217     perform 1620-read-elcert    thru 1620-exit
  3218
  3219     IF (OBVYNL > ZERO)
  3220        and (obvyni <> la-void-onbase-yn)
  3221        if (obvyni = 'N')
  3222           and (la-void-onbase-yn = spaces)
  3223           continue
  3224        else
  3225           if la-initial-print-date <> low-values
  3226              perform 1600-update-obkeywords
  3227                                 thru 1600-exit
  3228           end-if
  3229        end-if
  3230        MOVE OBVYNI              TO LA-VOID-ONBASE-YN
  3231     end-if
  3232
  3233     if (not cert-found)
  3234        or (sql-update-failed)
  3235        or ((la-initial-print-date = low-values)
  3236              and
  3237            (la-void-onbase-yn = 'Y'))
  3238
  3239* exec cics unlock
  3240*          dataset (W-ARCH-FILE-ID)
  3241*       end-exec
  3242*    MOVE '&*                    #   #00003108' TO DFHEIV0
  3243     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3244     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3245     MOVE X'2020233030303033313038' TO DFHEIV0(25:11)
  3246     CALL 'kxdfhei1' USING DFHEIV0,
  3247           W-ARCH-FILE-ID,
  3248           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  58
* EL691.cbl
  3249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3250        if connected-to-db
  3251           move ' '              to ws-connect-sw
  3252           display ' about to disconnect '
  3253           exec sql
  3254              disconnect
  3255           end-exec
  3256        end-if
  3257     end-if
  3258
  3259     if not cert-found
  3260        move er-0249             to emi-error
  3261        move -1                  to maintl
  3262        perform 9900-error-format thru 9900-exit
  3263        go to 8200-send-dataonly
  3264     end-if
  3265
  3266     if sql-update-failed
  3267        move er-7331             to emi-error
  3268        move -1                  to maintl
  3269        perform 9900-error-format thru 9900-exit
  3270        go to 8200-send-dataonly
  3271     end-if
  3272
  3273     if (la-void-onbase-yn = 'Y')
  3274        and (la-initial-print-date = low-values)
  3275        move er-7334             to emi-error
  3276        move -1                  to maintl
  3277        perform 9900-error-format thru 9900-exit
  3278        go to 8200-send-dataonly
  3279     end-if
  3280
  3281     if sql-update-succeeded
  3282        display ' about to commit work '
  3283        exec sql
  3284           commit work
  3285        end-exec
  3286     end-if
  3287     if connected-to-db
  3288        display ' about to disconnect all '
  3289        exec sql
  3290           disconnect
  3291        end-exec
  3292        move ' ' to ws-connect-sw
  3293     end-if
  3294     PERFORM 3100-REWRITE THRU 3100-EXIT.
  3295
  3296     IF COMMENTL NOT GREATER ZERO
  3297
  3298         MOVE ER-0000            TO  EMI-ERROR
  3299         MOVE ' '                TO  MAINTO
  3300         MOVE -1                 TO  MAINTL
  3301         MOVE AL-UANOF           TO  MAINTA
  3302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3303         GO TO 1000-SHOW
  3304     END-IF.
  3305     if (commentl > zeros)
  3306        and (commenti not = spaces)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  59
* EL691.cbl
  3307        move commenti            to w-cert-note-comment
  3308        perform 4160-check-comment thru 4160-exit
  3309        PERFORM 4000-ADD-CERT-NOTE
  3310                                 THRU 4099-EXIT
  3311     end-if
  3312     PERFORM 3200-READ-ARCT-FOR-UPDATE THRU 3200-EXIT.
  3313
  3314     IF PI-COMMENT-INDEX EQUAL +20
  3315         MOVE ER-0051    TO  EMI-ERROR
  3316         MOVE -1         TO  MAINTL
  3317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3318         GO TO 8200-SEND-DATAONLY
  3319     END-IF
  3320
  3321     SET PI-COMMENT-INDEX UP BY +1.
  3322     SET LC-NDX TO PI-COMMENT-INDEX.
  3323     MOVE COMMENTI        TO  LT-COMMENT-LINE (LC-NDX)
  3324     MOVE W-SAVE-BIN-DATE TO  LT-COMMENT-CHG-DT (LC-NDX).
  3325     MOVE PI-PROCESSOR-ID TO  LT-COMMENT-CHG-BY (LC-NDX).
  3326     ADD +1               TO  LT-NUM-LINES-ON-RECORD.
  3327
  3328
  3329     IF W-ADD-ARCT = 'N'
  3330         PERFORM 3300-REWRITE-ARCT THRU 3300-EXIT
  3331     ELSE
  3332         PERFORM 3350-INSERT-ARCT THRU 3350-EXIT
  3333     END-IF.
  3334
  3335
  3336     MOVE ER-0000                TO  EMI-ERROR.
  3337     MOVE ' '                    TO  MAINTO.
  3338     MOVE -1                     TO  MAINTL.
  3339     MOVE AL-UANOF               TO  MAINTA.
  3340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3341     GO TO 1000-SHOW.
  3342
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  60
* EL691.cbl
  3344
  3345 1000-SHOW.
  3346***************************************************************
  3347*     THIS ROUTINE WILL READ THE ARCHIVE FILE WITH THE        *
  3348*     ARCHIVE NUMBER SPECIFIED FROM THE PRIOR SCREEN.         *
  3349***************************************************************
  3350     MOVE LOW-VALUES              TO W-ARCT-KEY.
  3351     MOVE PI-COMPANY-CD           TO W-ARCH-COMPANY-CD
  3352                                     W-ARCT-COMPANY-CD.
  3353     MOVE PI-689-ARCHIVE-NUMBER   TO W-ARCH-NUMBER
  3354                                     W-ARCT-ARCHIVE-NO.
  3355     MOVE '3'                     TO W-ARCT-RECORD-TYPE.
  3356     MOVE +0                      TO W-ARCT-LINE-SEQ-NO.
  3357
  3358
  3359* EXEC CICS HANDLE CONDITION
  3360*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3361*         NOTFND     (1070-ARCH-NOT-FOUND)
  3362*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3363*    END-EXEC.
  3364*    MOVE '"$JI''                 ! $ #00003219' TO DFHEIV0
  3365     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3367     MOVE X'2420233030303033323139' TO DFHEIV0(25:11)
  3368     CALL 'kxdfhei1' USING DFHEIV0
  3369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3370
  3371
  3372
  3373* EXEC CICS READ
  3374*        DATASET (W-ARCH-FILE-ID)
  3375*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3376*        RIDFLD  (W-ARCH-KEY)
  3377*    END-EXEC.
  3378*    MOVE '&"S        E          (   #00003225' TO DFHEIV0
  3379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3381     MOVE X'2020233030303033323235' TO DFHEIV0(25:11)
  3382     CALL 'kxdfhei1' USING DFHEIV0,
  3383           W-ARCH-FILE-ID,
  3384           DFHEIV20,
  3385           DFHEIV99,
  3386           W-ARCH-KEY,
  3387           DFHEIV99,
  3388           DFHEIV99,
  3389           DFHEIV99
  3390     SET ADDRESS OF LETTER-ARCHIVE TO
  3391         DFHEIV20
  3392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3393
  3394
  3395     MOVE LA-FORM-A3             TO FORMNOO.
  3396     MOVE LA-FORM-A3             TO PI-ARCHIVE-LTRID
  3397     MOVE LA-ARCHIVE-NO          TO ARCHNOO.
  3398     MOVE LA-CARRIER-A2          TO CARRIERO.
  3399     MOVE LA-GROUPING-A2         TO GROUPO.
  3400     MOVE LA-STATE-A2            TO STATEO.
  3401     MOVE LA-ACCOUNT-A2          TO ACCTO.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  61
* EL691.cbl
  3402     MOVE LA-CERT-PRIME-A2       TO CERTO.
  3403     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  3404
  3405     IF LA-ENDT-ARCH-NO-X EQUAL LOW-VALUES OR SPACES
  3406          MOVE SPACES            TO ENDARCHO
  3407     ELSE
  3408          MOVE LA-ENDT-ARCH-NO   TO ENDARCHO
  3409     END-IF
  3410
  3411     IF  LA-CREATION-DATE EQUAL LOW-VALUES OR SPACES
  3412         MOVE SPACES             TO CREATDTI
  3413                                    pi-create-date
  3414     ELSE
  3415         MOVE LA-CREATION-DATE   TO DC-BIN-DATE-1
  3416         MOVE ' '                TO DC-OPTION-CODE
  3417         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3418         MOVE DC-GREG-DATE-1-EDIT TO CREATDTI
  3419                                     pi-create-date
  3420     END-IF.
  3421
  3422     MOVE LA-PROCESSOR-CD        TO CREATBYI.
  3423
  3424     IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES OR SPACES
  3425         MOVE SPACES             TO PRINTDTI
  3426         move low-values         to pi-initial-print-date
  3427     ELSE
  3428         move la-initial-print-date
  3429                                 to pi-initial-print-date
  3430         MOVE LA-INITIAL-PRINT-DATE TO DC-BIN-DATE-1
  3431         MOVE ' '                TO DC-OPTION-CODE
  3432         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3433         MOVE DC-GREG-DATE-1-EDIT TO PRINTDTI
  3434     END-IF.
  3435
  3436     IF  LA-RESEND-DATE = LOW-VALUES OR SPACES
  3437         MOVE SPACES             TO RESENDI
  3438     ELSE
  3439         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  3440         MOVE ' '                TO DC-OPTION-CODE
  3441         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3442         MOVE DC-GREG-DATE-1-EDIT TO RESENDI
  3443     END-IF.
  3444
  3445     MOVE LA-RESEND-LETR         TO RESFORMI.
  3446
  3447     IF  LA-SENT-DATE = LOW-VALUES OR SPACES
  3448         MOVE SPACES             TO RESPRNTI
  3449         MOVE SPACES             TO PI-ARCHIVE-COMPLETE
  3450     ELSE
  3451         MOVE 'Y'                TO PI-ARCHIVE-COMPLETE
  3452         MOVE LA-SENT-DATE     TO DC-BIN-DATE-1
  3453         MOVE ' '                TO DC-OPTION-CODE
  3454         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3455         MOVE DC-GREG-DATE-1-EDIT TO RESPRNTI
  3456     END-IF.
  3457
  3458     IF  LA-FINAL-ACT-DATE EQUAL LOW-VALUES OR SPACES
  3459         MOVE SPACES             TO FINDATEI
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  62
* EL691.cbl
  3460         MOVE SPACES             TO PI-ARCHIVE-FINAL
  3461     ELSE
  3462         MOVE 'Y'                TO PI-ARCHIVE-FINAL
  3463         MOVE LA-FINAL-ACT-DATE  TO DC-BIN-DATE-1
  3464         MOVE ' '                TO DC-OPTION-CODE
  3465         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3466         MOVE DC-GREG-DATE-1-EDIT TO FINDATEI
  3467     END-IF.
  3468
  3469     MOVE LA-FINAL-ACT-IND       TO FINLACTI.
  3470
  3471     IF  LA-REPLY-DATE = LOW-VALUES OR SPACES
  3472         MOVE SPACES             TO REPLYI
  3473         MOVE SPACES             TO PI-ARCHIVE-RECEIVED
  3474     ELSE
  3475         MOVE 'Y'                TO PI-ARCHIVE-RECEIVED
  3476         MOVE LA-REPLY-DATE      TO DC-BIN-DATE-1
  3477         MOVE ' '                TO DC-OPTION-CODE
  3478         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3479         MOVE DC-GREG-DATE-1-EDIT TO REPLYI
  3480     END-IF.
  3481
  3482     IF  LA-VOIDED-DATE = LOW-VALUES OR SPACES
  3483         MOVE SPACES             TO STOPDTEI
  3484         MOVE SPACES             TO PI-ARCHIVE-STOPPED
  3485     ELSE
  3486         MOVE 'Y'                TO PI-ARCHIVE-STOPPED
  3487         MOVE LA-VOIDED-DATE     TO DC-BIN-DATE-1
  3488         MOVE ' '                TO DC-OPTION-CODE
  3489         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3490         MOVE DC-GREG-DATE-1-EDIT TO STOPDTEI
  3491     END-IF.
  3492     if LA-VOID-ONBASE-YN not = spaces
  3493        move LA-VOID-ONBASE-YN   to obvyno
  3494     end-if
  3495     if la-onbase-unique-id numeric
  3496        move la-onbase-unique-id to obuido
  3497     end-if
  3498     IF LA-LAST-MAINT-DATE = LOW-VALUES OR SPACES
  3499         MOVE SPACES             TO MAINTDTI
  3500     ELSE
  3501         MOVE LA-LAST-MAINT-DATE TO DC-BIN-DATE-1
  3502         MOVE ' '                TO DC-OPTION-CODE
  3503         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3504         MOVE DC-GREG-DATE-1-EDIT TO MAINTDTI
  3505     END-IF.
  3506
  3507     IF LA-LAST-MAINT-TIMEX = LOW-VALUES OR SPACES
  3508         MOVE ZEROES             TO MAINTTMO
  3509     ELSE
  3510         MOVE LA-LAST-MAINT-TIME TO W-TIME-IN
  3511         MOVE W-TIME-OUT         TO MAINTTMO
  3512     END-IF.
  3513
  3514     MOVE LA-LAST-UPDATED-BY     TO MAINTBYI.
  3515
  3516     IF (LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  3517       OR (LA-VOIDED-DATE  NOT EQUAL LOW-VALUES AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  63
* EL691.cbl
  3518          MOVE AL-SANOF          TO RESENDA
  3519                                    RESFORMA
  3520                                    FINDATEA
  3521                                    FINLACTA
  3522                                    REPLYA
  3523                                    COMMENTA
  3524     END-IF.
  3525
  3526     IF LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES
  3527         MOVE AL-SANOF           TO STOPDTEA
  3528     END-IF.
  3529
  3530
  3531* EXEC CICS HANDLE CONDITION
  3532*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  3533*         NOTFND     (1000-ARCT-NOT-FOUND)
  3534*         ENDFILE    (1000-ARCT-NOT-FOUND)
  3535*    END-EXEC.
  3536*    MOVE '"$JI''                 ! % #00003366' TO DFHEIV0
  3537     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3539     MOVE X'2520233030303033333636' TO DFHEIV0(25:11)
  3540     CALL 'kxdfhei1' USING DFHEIV0
  3541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3542
  3543
  3544
  3545* EXEC CICS READ
  3546*        DATASET  (W-ARCT-FILE-ID)
  3547*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3548*        RIDFLD   (W-ARCT-KEY)
  3549*    END-EXEC.
  3550*    MOVE '&"S        E          (   #00003372' TO DFHEIV0
  3551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3553     MOVE X'2020233030303033333732' TO DFHEIV0(25:11)
  3554     CALL 'kxdfhei1' USING DFHEIV0,
  3555           W-ARCT-FILE-ID,
  3556           DFHEIV20,
  3557           DFHEIV99,
  3558           W-ARCT-KEY,
  3559           DFHEIV99,
  3560           DFHEIV99,
  3561           DFHEIV99
  3562     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3563         DFHEIV20
  3564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3565
  3566
  3567     SET LC-NDX TO W-ZEROS.
  3568     PERFORM 20 TIMES
  3569         SET LC-NDX UP BY +1
  3570         IF LT-COMMENT-LINE (LC-NDX) > SPACES
  3571             MOVE LT-COMMENT-LINE (LC-NDX) TO COMMENTI
  3572             SET PI-COMMENT-INDEX TO LC-NDX
  3573         END-IF
  3574     END-PERFORM.
  3575
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  64
* EL691.cbl
  3576     MOVE -1                     TO MAINTL.
  3577     GO TO 8100-SEND-INITIAL-MAP.
  3578
  3579 1000-ARCT-NOT-FOUND.
  3580
  3581     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3582     MOVE -1                     TO MAINTL.
  3583     GO TO 8100-SEND-INITIAL-MAP.
  3584
  3585 1000-EXIT.
  3586     EXIT.
  3587
  3588
  3589 1070-ARCH-NOT-FOUND.
  3590
  3591     MOVE ER-7371                TO EMI-ERROR.
  3592     MOVE -1                     TO ARCHNOL.
  3593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3594     GO TO 8100-SEND-INITIAL-MAP.
  3595
  3596
  3597 1500-CHECK-Z-RECORD.
  3598
  3599     MOVE 'N' TO WS-Z-RECORD-IND
  3600
  3601
  3602* EXEC CICS STARTBR
  3603*         DATASET    ('ELLETR')
  3604*         RIDFLD     (ELLETR-KEY)
  3605*         GTEQ
  3606*         RESP      (W-RESPONSE)
  3607*    END-EXEC.
  3608     MOVE 'ELLETR' TO DFHEIV1
  3609     MOVE 0
  3610       TO DFHEIV11
  3611*    MOVE '&,         G          &  N#00003412' TO DFHEIV0
  3612     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3614     MOVE X'204E233030303033343132' TO DFHEIV0(25:11)
  3615     CALL 'kxdfhei1' USING DFHEIV0,
  3616           DFHEIV1,
  3617           ELLETR-KEY,
  3618           DFHEIV99,
  3619           DFHEIV11,
  3620           DFHEIV99
  3621     MOVE EIBRESP  TO W-RESPONSE
  3622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3623
  3624     IF NOT RESP-NORMAL
  3625         GO TO 1500-ENDBR
  3626     END-IF.
  3627
  3628 1500-READNEXT.
  3629
  3630
  3631* EXEC CICS READNEXT
  3632*        DATASET   ('ELLETR')
  3633*        INTO      (TEXT-FILES)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  65
* EL691.cbl
  3634*        RIDFLD    (ELLETR-KEY)
  3635*        RESP      (W-RESPONSE)
  3636*    END-EXEC
  3637     MOVE LENGTH OF
  3638      TEXT-FILES
  3639       TO DFHEIV12
  3640     MOVE 'ELLETR' TO DFHEIV1
  3641     MOVE 0
  3642       TO DFHEIV11
  3643*    MOVE '&.IL                  )  N#00003424' TO DFHEIV0
  3644     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3645     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3646     MOVE X'204E233030303033343234' TO DFHEIV0(25:11)
  3647     CALL 'kxdfhei1' USING DFHEIV0,
  3648           DFHEIV1,
  3649           TEXT-FILES,
  3650           DFHEIV12,
  3651           ELLETR-KEY,
  3652           DFHEIV99,
  3653           DFHEIV11,
  3654           DFHEIV99,
  3655           DFHEIV99
  3656     MOVE EIBRESP  TO W-RESPONSE
  3657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3658     IF RESP-NORMAL
  3659        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  3660           GO TO 1500-ENDBR
  3661        END-IF
  3662
  3663        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  3664           MOVE 'Y' TO WS-Z-RECORD-IND
  3665           GO TO 1500-ENDBR
  3666        ELSE
  3667           GO TO 1500-READNEXT
  3668        END-IF
  3669     ELSE
  3670        GO TO 1500-ENDBR
  3671     END-IF.
  3672
  3673 1500-ENDBR.
  3674
  3675
  3676* EXEC CICS ENDBR
  3677*        DATASET     ('ELLETR')
  3678*    END-EXEC.
  3679     MOVE 'ELLETR' TO DFHEIV1
  3680     MOVE 0
  3681       TO DFHEIV11
  3682*    MOVE '&2                    $   #00003447' TO DFHEIV0
  3683     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3684     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3685     MOVE X'2020233030303033343437' TO DFHEIV0(25:11)
  3686     CALL 'kxdfhei1' USING DFHEIV0,
  3687           DFHEIV1,
  3688           DFHEIV11,
  3689           DFHEIV99
  3690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3691
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  66
* EL691.cbl
  3692
  3693 1500-EXIT.
  3694      EXIT.
  3695 1600-update-obkeywords.
  3696
  3697     if not connected-to-db
  3698        perform 1700-CONNECT-TO-DB
  3699                                 thru 1700-exit
  3700     end-if
  3701
  3702*    perform 1620-read-elcert    thru 1620-exit
  3703*    if not cert-found
  3704*       go to 1600-exit
  3705*    end-if
  3706
  3707     if obvyni = 'N'
  3708        if la-onbase-unique-id numeric
  3709           and la-onbase-unique-id > 0
  3710           perform 1610-void-void thru 1610-exit
  3711           go to 1600-exit
  3712        end-if
  3713     end-if
  3714
  3715***  If I get here I assume they are voiding the letter
  3716***  I am using a stored procedure so I can get back the
  3717***  unique id from the insert and update the erarch
  3718***  record with it.  May come in handy down the road
  3719
  3720     if obvyni = 'Y'
  3721        and (la-onbase-unique-id not numeric
  3722           or la-onbase-unique-id = zeros)
  3723        continue
  3724     else
  3725        go to 1600-exit
  3726     end-if
  3727
  3728     move 'CID Certs'            to db-doc-type
  3729     move 'Status'               to db-key-word-type
  3730     move 'V'                    to db-key-word-value
  3731     move cm-state               to db-cert-state
  3732     move cm-cert-prime          to db-cert-no
  3733     move cm-lf-loan-expire-dt   to dc-bin-date-1
  3734     if cm-ah-loan-expire-dt > cm-lf-loan-expire-dt
  3735        move cm-ah-loan-expire-dt
  3736                                 to dc-bin-date-1
  3737     end-if
  3738     move ' '                    to dc-option-code
  3739     perform 9500-LINK-DATE-CONVERT thru 9500-exit
  3740     if no-conversion-error
  3741        move dc-greg-date-a-edit to db-cert-exp-dt
  3742        inspect db-cert-exp-dt
  3743           converting '/' to '-'
  3744     end-if
  3745     move la-initial-print-date  to dc-bin-date-1
  3746     move ' '                    to dc-option-code
  3747     perform 9500-LINK-DATE-CONVERT thru 9500-exit
  3748     if no-conversion-error
  3749        move dc-greg-date-a-edit to db-print-dt
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  67
* EL691.cbl
  3750        inspect db-print-dt
  3751           converting '/' to '-'
  3752     end-if
  3753
  3754     EXEC SQL
  3755        CALL sp_OBKeyWordChgs_ADD
  3756           @DocType       =  :db-doc-type,
  3757           @CertNo        =  :db-cert-no,
  3758           @PrintDt       =  :db-print-dt,
  3759           @CertExpDt     =  :db-cert-exp-dt,
  3760           @CertSt        =  :db-cert-state,
  3761           @KeyWordType   =  :db-key-word-type,
  3762           @KeyWordValue  =  :db-key-word-value,
  3763           @RetValue      = :kd-unique-id OUT
  3764     END-EXEC
  3765
  3766     if sqlcode not = 0
  3767        move sqlcode             to ws-sql-code
  3768        move ws-sql-code         to ws-dis-sql-code
  3769        display ' Error: Cannot INSERT row ' kd-unique-id
  3770        display ' sql return code        ' ws-dis-sql-code
  3771        display ' sql err mess           ' sqlerrmc
  3772        set sql-update-failed to true
  3773     else
  3774        move kd-unique-id        to la-onbase-unique-id
  3775                                    obuido
  3776        set sql-update-succeeded to true
  3777     end-if
  3778
  3779     .
  3780 1600-exit.
  3781     exit.
  3782
  3783 1610-void-void.
  3784
  3785     move la-onbase-unique-id    to kd-unique-id
  3786     EXEC SQL
  3787        SELECT
  3788           RequestDate,
  3789           KeyWordType,
  3790           KeyWordValue,
  3791           CompletionDate
  3792        INTO
  3793           :db-req-date,
  3794           :db-key-word-type,
  3795           :db-key-word-value,
  3796           :db-complete-dt  :nu-Complete-date
  3797        FROM
  3798           OBKeyWordChgs
  3799        where
  3800           :kd-unique-id = UniqueID
  3801     END-EXEC
  3802
  3803     if sqlcode not = 0
  3804        move sqlcode             to ws-sql-code
  3805        move ws-sql-code         to ws-dis-sql-code
  3806        display ' Error: Cannot read row ' kd-unique-id
  3807        display ' sql return code        ' ws-dis-sql-code
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  68
* EL691.cbl
  3808        display ' sql err mess           ' sqlerrmc
  3809        go to 1610-exit
  3810     end-if
  3811     if nu-complete-date = -1
  3812        display ' complete date is null '
  3813     end-if
  3814     if nu-complete-date = -1  *> isnull
  3815        and db-key-word-type = 'Status'
  3816        and obvyni <> 'Y'
  3817        and db-key-word-value = 'V'
  3818
  3819        EXEC SQL
  3820           DELETE
  3821              OBKeyWordChgs
  3822           WHERE
  3823              UniqueID = :kd-unique-id
  3824        END-EXEC
  3825
  3826        if sqlcode = 0
  3827           display ' delete succeeded '
  3828           set sql-update-succeeded to true
  3829           move zeros            to la-onbase-unique-id
  3830        else
  3831           display ' delete not successful ' sqlcode
  3832           set sql-update-failed to true
  3833        end-if
  3834     end-if
  3835
  3836     .
  3837 1610-exit.
  3838     exit.
  3839
  3840 1620-read-elcert.
  3841
  3842     move la-company-cd          to elcert-key
  3843     move la-carrier-a2          to elcert-carrier
  3844     move la-grouping-a2         to elcert-grouping
  3845     move la-state-a2            to elcert-state
  3846     move la-account-a2          to elcert-account
  3847     move la-effect-date-a2      to elcert-eff-dt
  3848     move la-cert-no-a2          to elcert-cert-no
  3849
  3850
  3851* exec cics read
  3852*       dataset    ('ELCERT')
  3853*       ridfld     (elcert-key)
  3854*       SET        (ADDRESS OF CERTIFICATE-MASTER)
  3855*       resp       (w-response)
  3856*    end-exec
  3857     MOVE 'ELCERT' TO DFHEIV1
  3858*    MOVE '&"S        E          (  N#00003608' TO DFHEIV0
  3859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3861     MOVE X'204E233030303033363038' TO DFHEIV0(25:11)
  3862     CALL 'kxdfhei1' USING DFHEIV0,
  3863           DFHEIV1,
  3864           DFHEIV20,
  3865           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  69
* EL691.cbl
  3866           elcert-key,
  3867           DFHEIV99,
  3868           DFHEIV99,
  3869           DFHEIV99
  3870     SET ADDRESS OF CERTIFICATE-MASTER TO
  3871         DFHEIV20
  3872     MOVE EIBRESP  TO w-response
  3873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3874
  3875     if resp-normal
  3876        set cert-found to true
  3877     end-if
  3878
  3879     .
  3880 1620-exit.
  3881     exit.
  3882
  3883 1700-CONNECT-TO-DB.
  3884
  3885     move 'NTSQLTST2_PEMA'       to svr
  3886     move 'sa'                   to usr
  3887     move 'sql2008r2'            to pass
  3888
  3889     if ws-kix-myenv = 'cid1p'
  3890        move 'NTCSO2_Logic'      to svr
  3891        move 'sa'                to usr
  3892        move 'ntcso2'            to pass
  3893     end-if
  3894
  3895     string
  3896         usr delimited space
  3897         "." delimited size
  3898         pass delimited space into usr-pass
  3899     end-string
  3900
  3901     EXEC SQL
  3902        CONNECT TO :svr USER :usr-pass
  3903     END-EXEC
  3904
  3905     if sqlcode not = 0
  3906        move sqlcode             to ws-sql-code
  3907        move ws-sql-code         to ws-dis-sql-code
  3908        display ' Error: Cannot Connect  ' kd-unique-id
  3909        display ' sql return code        ' ws-dis-sql-code
  3910        display ' sql err mess           ' sqlerrmc
  3911        move er-7332             to emi-error
  3912        perform 9900-error-format thru 9900-exit
  3913        go to 8200-send-dataonly
  3914     end-if
  3915
  3916     set connected-to-db to true
  3917     display ' good connection '
  3918
  3919     .
  3920 1700-EXIT.
  3921     EXIT.
  3922 3000-READ-FOR-UPDATE.
  3923
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  70
* EL691.cbl
  3924
  3925* EXEC CICS HANDLE CONDITION
  3926*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3927*         NOTFND     (1070-ARCH-NOT-FOUND)
  3928*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3929*    END-EXEC.
  3930*    MOVE '"$JI''                 ! & #00003664' TO DFHEIV0
  3931     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3933     MOVE X'2620233030303033363634' TO DFHEIV0(25:11)
  3934     CALL 'kxdfhei1' USING DFHEIV0
  3935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3936
  3937
  3938     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
  3939     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCH-NUMBER
  3940
  3941
  3942* EXEC CICS READ
  3943*        DATASET (W-ARCH-FILE-ID)
  3944*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3945*        RIDFLD  (W-ARCH-KEY)
  3946*        UPDATE
  3947*    END-EXEC.
  3948*    MOVE '&"S        EU         (   #00003673' TO DFHEIV0
  3949     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3950     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3951     MOVE X'2020233030303033363733' TO DFHEIV0(25:11)
  3952     CALL 'kxdfhei1' USING DFHEIV0,
  3953           W-ARCH-FILE-ID,
  3954           DFHEIV20,
  3955           DFHEIV99,
  3956           W-ARCH-KEY,
  3957           DFHEIV99,
  3958           DFHEIV99,
  3959           DFHEIV99
  3960     SET ADDRESS OF LETTER-ARCHIVE TO
  3961         DFHEIV20
  3962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3963
  3964
  3965 3000-EXIT.
  3966     EXIT.
  3967
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  71
* EL691.cbl
  3969
  3970 3100-REWRITE.
  3971
  3972     MOVE PI-PROCESSOR-ID        TO  LA-LAST-UPDATED-BY
  3973                                     MAINTBYI.
  3974     MOVE W-SAVE-BIN-DATE        TO  LA-LAST-MAINT-DATE.
  3975     MOVE W-SAVE-DATE            TO  MAINTDTI.
  3976
  3977     MOVE EIBTIME                TO  LA-LAST-MAINT-TIME
  3978                                     W-TIME-IN.
  3979     MOVE W-TIME-OUT             TO  MAINTTMO.
  3980
  3981
  3982* EXEC CICS REWRITE
  3983*        DATASET (W-ARCH-FILE-ID)
  3984*        FROM    (LETTER-ARCHIVE)
  3985*    END-EXEC.
  3986     MOVE LENGTH OF
  3987      LETTER-ARCHIVE
  3988       TO DFHEIV11
  3989*    MOVE '&& L                  %   #00003696' TO DFHEIV0
  3990     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3991     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3992     MOVE X'2020233030303033363936' TO DFHEIV0(25:11)
  3993     CALL 'kxdfhei1' USING DFHEIV0,
  3994           W-ARCH-FILE-ID,
  3995           LETTER-ARCHIVE,
  3996           DFHEIV11,
  3997           DFHEIV99
  3998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3999
  4000
  4001 3100-EXIT.
  4002     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  72
* EL691.cbl
  4004 3200-READ-ARCT-FOR-UPDATE.
  4005
  4006
  4007* EXEC CICS HANDLE CONDITION
  4008*         NOTFND     (3200-NOT-FOUND)
  4009*         ENDFILE    (3200-NOT-FOUND)
  4010*    END-EXEC.
  4011*    MOVE '"$I''                  ! '' #00003706' TO DFHEIV0
  4012     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4014     MOVE X'2720233030303033373036' TO DFHEIV0(25:11)
  4015     CALL 'kxdfhei1' USING DFHEIV0
  4016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4017
  4018
  4019     MOVE PI-COMPANY-CD TO W-ARCT-COMPANY-CD.
  4020     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCT-ARCHIVE-NO.
  4021     MOVE '3'                   TO W-ARCT-RECORD-TYPE.
  4022     MOVE +0                    TO W-ARCT-LINE-SEQ-NO.
  4023
  4024
  4025* EXEC CICS READ
  4026*        DATASET  (W-ARCT-FILE-ID)
  4027*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  4028*        RIDFLD   (W-ARCT-KEY)
  4029*        UPDATE
  4030*    END-EXEC.
  4031*    MOVE '&"S        EU         (   #00003716' TO DFHEIV0
  4032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4033     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4034     MOVE X'2020233030303033373136' TO DFHEIV0(25:11)
  4035     CALL 'kxdfhei1' USING DFHEIV0,
  4036           W-ARCT-FILE-ID,
  4037           DFHEIV20,
  4038           DFHEIV99,
  4039           W-ARCT-KEY,
  4040           DFHEIV99,
  4041           DFHEIV99,
  4042           DFHEIV99
  4043     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  4044         DFHEIV20
  4045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4046
  4047
  4048     MOVE 'N' TO W-ADD-ARCT.
  4049     GO TO 3200-EXIT.
  4050
  4051 3200-NOT-FOUND.
  4052
  4053
  4054* EXEC CICS GETMAIN
  4055*         SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  4056*         LENGTH   (W-ARCT-LENGTH)
  4057*    END-EXEC.
  4058*    MOVE '," L                  $   #00003728' TO DFHEIV0
  4059     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4060     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4061     MOVE X'2020233030303033373238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  73
* EL691.cbl
  4062     CALL 'kxdfhei1' USING DFHEIV0,
  4063           DFHEIV20,
  4064           W-ARCT-LENGTH,
  4065           DFHEIV99
  4066     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  4067         DFHEIV20
  4068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4069
  4070
  4071     MOVE 'Y'                    TO W-ADD-ARCT.
  4072     MOVE LOW-VALUES             TO LETTER-ARCHIVE-TEXT.
  4073     MOVE 'LT'                   TO LT-RECORD-ID.
  4074     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
  4075     MOVE PI-689-ARCHIVE-NUMBER  TO LT-ARCHIVE-NO.
  4076     MOVE '3'                    TO LT-RECORD-TYPE.
  4077     MOVE +0                     TO LT-LINE-SEQ-NO.
  4078     MOVE +0                     TO LT-NUM-LINES-ON-RECORD.
  4079     SET PI-COMMENT-INDEX        TO W-ZEROS.
  4080
  4081 3200-EXIT.
  4082     EXIT.
  4083
  4084 3300-REWRITE-ARCT.
  4085
  4086
  4087* EXEC CICS REWRITE
  4088*        DATASET (W-ARCT-FILE-ID)
  4089*        FROM    (LETTER-ARCHIVE-TEXT)
  4090*    END-EXEC.
  4091     MOVE LENGTH OF
  4092      LETTER-ARCHIVE-TEXT
  4093       TO DFHEIV11
  4094*    MOVE '&& L                  %   #00003748' TO DFHEIV0
  4095     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4096     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4097     MOVE X'2020233030303033373438' TO DFHEIV0(25:11)
  4098     CALL 'kxdfhei1' USING DFHEIV0,
  4099           W-ARCT-FILE-ID,
  4100           LETTER-ARCHIVE-TEXT,
  4101           DFHEIV11,
  4102           DFHEIV99
  4103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4104
  4105
  4106 3300-EXIT.
  4107     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  74
* EL691.cbl
  4109
  4110 3350-INSERT-ARCT.
  4111
  4112* EXEC CICS WRITE
  4113*         DATASET   (W-ARCT-FILE-ID)
  4114*         FROM      (LETTER-ARCHIVE-TEXT)
  4115*         RIDFLD    (LT-CONTROL-PRIMARY)
  4116*    END-EXEC.
  4117     MOVE LENGTH OF
  4118      LETTER-ARCHIVE-TEXT
  4119       TO DFHEIV11
  4120*    MOVE '&$ L                  ''   #00003758' TO DFHEIV0
  4121     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4122     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4123     MOVE X'2020233030303033373538' TO DFHEIV0(25:11)
  4124     CALL 'kxdfhei1' USING DFHEIV0,
  4125           W-ARCT-FILE-ID,
  4126           LETTER-ARCHIVE-TEXT,
  4127           DFHEIV11,
  4128           LT-CONTROL-PRIMARY,
  4129           DFHEIV99,
  4130           DFHEIV99
  4131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4132
  4133
  4134 3350-EXIT.
  4135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  75
* EL691.cbl
  4137
  4138
  4139 4000-ADD-CERT-NOTE.
  4140
  4141     MOVE SPACES                 TO  ERCNOT-KEY
  4142                                     ELCERT-KEY.
  4143     move spaces                 to cert-note-records-holder
  4144                                    ws-build-note-sw
  4145                                    ws-ercnot-sw
  4146     move +0                     to c1
  4147     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  4148                                     ELCERT-COMPANY-CD.
  4149     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  4150                                     ELCERT-CARRIER.
  4151     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  4152                                     ELCERT-GROUPING.
  4153     MOVE PI-STATE               TO  ERCNOT-STATE
  4154                                     ELCERT-STATE.
  4155     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  4156                                     ELCERT-ACCOUNT.
  4157     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  4158                                     ELCERT-EFF-DT.
  4159     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  4160                                     ELCERT-CERT-PRIME.
  4161     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  4162                                     ELCERT-CERT-SFX.
  4163     MOVE '1'                    TO  ERCNOT-REC-TYP
  4164     MOVE ZEROS                  TO  ERCNOT-SEQ.
  4165     MOVE ERCNOT-KEY             TO  SV-PRIOR-KEY.
  4166
  4167* EXEC CICS STARTBR
  4168*       DATASET    ('ERCNOT')
  4169*       RIDFLD     (ercnot-key)
  4170*       GTEQ
  4171*       RESP       (W-RESPONSE)
  4172*    END-EXEC
  4173     MOVE 'ERCNOT' TO DFHEIV1
  4174     MOVE 0
  4175       TO DFHEIV11
  4176*    MOVE '&,         G          &  N#00003796' TO DFHEIV0
  4177     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4178     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4179     MOVE X'204E233030303033373936' TO DFHEIV0(25:11)
  4180     CALL 'kxdfhei1' USING DFHEIV0,
  4181           DFHEIV1,
  4182           ercnot-key,
  4183           DFHEIV99,
  4184           DFHEIV11,
  4185           DFHEIV99
  4186     MOVE EIBRESP  TO W-RESPONSE
  4187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4188
  4189     IF RESP-NORMAL
  4190        set ercnot-startbr to true
  4191*       display ' resp normal startbr '
  4192        perform until finished-with-notes
  4193
  4194* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  76
* EL691.cbl
  4195*             DATASET    ('ERCNOT')
  4196*             RIDFLD     (ercnot-key)
  4197*             INTO       (cert-note-file)
  4198*             resp       (w-response)
  4199*          end-exec
  4200     MOVE LENGTH OF
  4201      cert-note-file
  4202       TO DFHEIV12
  4203     MOVE 'ERCNOT' TO DFHEIV1
  4204     MOVE 0
  4205       TO DFHEIV11
  4206*    MOVE '&.IL                  )  N#00003807' TO DFHEIV0
  4207     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4209     MOVE X'204E233030303033383037' TO DFHEIV0(25:11)
  4210     CALL 'kxdfhei1' USING DFHEIV0,
  4211           DFHEIV1,
  4212           cert-note-file,
  4213           DFHEIV12,
  4214           ercnot-key,
  4215           DFHEIV99,
  4216           DFHEIV11,
  4217           DFHEIV99,
  4218           DFHEIV99
  4219     MOVE EIBRESP  TO w-response
  4220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4221           if (resp-normal)
  4222              and (cz-control-primary (1:33) =
  4223                 sv-prior-key (1:33))
  4224              if cz-record-type = '1'
  4225                 add +1 to c1
  4226                 move cert-note-file
  4227                                 to cert-note-record (c1)
  4228              end-if
  4229           else
  4230              set finished-with-notes to true
  4231           end-if
  4232        end-perform
  4233     end-if
  4234
  4235     if ercnot-startbr
  4236*       display ' about to endbr ercnot '
  4237
  4238* exec cics endbr
  4239*          dataset    ('ERCNOT')
  4240*       end-exec
  4241     MOVE 'ERCNOT' TO DFHEIV1
  4242     MOVE 0
  4243       TO DFHEIV11
  4244*    MOVE '&2                    $   #00003829' TO DFHEIV0
  4245     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4246     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4247     MOVE X'2020233030303033383239' TO DFHEIV0(25:11)
  4248     CALL 'kxdfhei1' USING DFHEIV0,
  4249           DFHEIV1,
  4250           DFHEIV11,
  4251           DFHEIV99
  4252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  77
* EL691.cbl
  4253     end-if
  4254     move c1                     to note-count
  4255
  4256     if c1 = +0
  4257        perform 4100-add-note    thru 4100-exit
  4258     else
  4259        perform 4120-delete-cert-notes
  4260                                 thru 4120-exit
  4261        if resp-normal
  4262           perform 4100-add-note thru 4100-exit
  4263           if resp-normal
  4264              perform 4140-put-back-cert-notes
  4265                                 thru 4140-exit
  4266              if resp-normal
  4267                 display 'NOTE SUCCESSFULLY ADDED'
  4268              else
  4269                 display ' something wrong with put back '
  4270              end-if
  4271           else
  4272              display ' something went wrong with adding note '
  4273           end-if
  4274        else
  4275           display ' something went wrong with generic delete '
  4276        end-if
  4277     end-if
  4278
  4279     .
  4280 4099-EXIT.
  4281     EXIT.
  4282
  4283
  4284 4100-add-note.
  4285
  4286***  Need to check how long the note is
  4287
  4288     if w-comment-line-cnt = +0
  4289        go to 4100-exit
  4290     end-if
  4291
  4292     move 'CZ'                to cert-note-file
  4293     move sv-prior-key        to cz-control-primary
  4294     move '1'                 to cz-record-type
  4295     move +1                  to cz-note-sequence
  4296     move w-save-bin-date     to cz-last-maint-dt
  4297     move eibtime             to cz-last-maint-hhmmss
  4298     move pi-processor-id     to cz-last-maint-user
  4299     move w-comment-line-1    to cz-note
  4300
  4301     .
  4302 4100-write.
  4303
  4304
  4305* exec cics write
  4306*       dataset   ('ERCNOT')
  4307*       from      (cert-note-file)
  4308*       ridfld    (cz-control-primary)
  4309*       resp      (w-response)
  4310*    end-exec
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  78
* EL691.cbl
  4311     MOVE LENGTH OF
  4312      cert-note-file
  4313       TO DFHEIV11
  4314     MOVE 'ERCNOT' TO DFHEIV1
  4315*    MOVE '&$ L                  ''  N#00003883' TO DFHEIV0
  4316     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4317     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4318     MOVE X'204E233030303033383833' TO DFHEIV0(25:11)
  4319     CALL 'kxdfhei1' USING DFHEIV0,
  4320           DFHEIV1,
  4321           cert-note-file,
  4322           DFHEIV11,
  4323           cz-control-primary,
  4324           DFHEIV99,
  4325           DFHEIV99
  4326     MOVE EIBRESP  TO w-response
  4327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4328     if not resp-normal
  4329        display ' error-ercnot-write ' w-response ' '
  4330           cz-control-primary (2:33)
  4331        go to 4100-exit
  4332     else
  4333        display 'NOTE SUCCESSFULLY ADDED'
  4334     end-if
  4335
  4336     if w-comment-line-cnt > +1
  4337        move w-comment-line-2    to cz-note
  4338        add +1 to cz-note-sequence
  4339        move +0                  to w-comment-line-cnt
  4340        go to 4100-write
  4341     end-if
  4342
  4343     .
  4344 4100-exit.
  4345     exit.
  4346
  4347
  4348
  4349 4120-delete-cert-notes.
  4350
  4351     move sv-prior-key (1:33)    to ercnot-key
  4352     move '1'                    to ercnot-rec-typ
  4353     move +0                     to ercnot-seq
  4354
  4355* exec cics delete
  4356*       dataset    ('ERCNOT')
  4357*       keylength  (ws-cert-note-generic-key-len)
  4358*       ridfld     (ercnot-key (1:34))
  4359*       generic
  4360*       resp       (w-response)
  4361*    end-exec
  4362     MOVE 'ERCNOT' TO DFHEIV1
  4363*    MOVE '&(  RKG               &  N#00003915' TO DFHEIV0
  4364     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  4365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4366     MOVE X'204E233030303033393135' TO DFHEIV0(25:11)
  4367     CALL 'kxdfhei1' USING DFHEIV0,
  4368           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  79
* EL691.cbl
  4369           ercnot-key(1 : 34),
  4370           ws-cert-note-generic-key-len,
  4371           DFHEIV99,
  4372           DFHEIV99
  4373     MOVE EIBRESP  TO w-response
  4374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4375
  4376     .
  4377 4120-exit.
  4378     exit.
  4379
  4380 4140-put-back-cert-notes.
  4381
  4382     perform varying c1 from +1 by +1 until
  4383        c1 > note-count
  4384        move cert-note-record (c1)
  4385                                 to cert-note-file
  4386        add +2                   to cz-note-sequence
  4387*       display ' about to write ' cz-control-primary (2:19) ' '
  4388*          cz-control-primary (23:11) ' ' cz-note-sequence ' '
  4389*           cz-record-type ' ' cz-note-information
  4390
  4391* exec cics write
  4392*          dataset ('ERCNOT')
  4393*          FROM    (cert-note-file)
  4394*          ridfld  (cz-control-primary)
  4395*          resp    (w-response)
  4396*       end-exec
  4397     MOVE LENGTH OF
  4398      cert-note-file
  4399       TO DFHEIV11
  4400     MOVE 'ERCNOT' TO DFHEIV1
  4401*    MOVE '&$ L                  ''  N#00003937' TO DFHEIV0
  4402     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4404     MOVE X'204E233030303033393337' TO DFHEIV0(25:11)
  4405     CALL 'kxdfhei1' USING DFHEIV0,
  4406           DFHEIV1,
  4407           cert-note-file,
  4408           DFHEIV11,
  4409           cz-control-primary,
  4410           DFHEIV99,
  4411           DFHEIV99
  4412     MOVE EIBRESP  TO w-response
  4413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4414        if not resp-normal
  4415           display ' error-ercnot-write subsequ ' w-response ' '
  4416              cz-control-primary (2:33)
  4417           move +999             to c1
  4418        end-if
  4419     end-perform
  4420
  4421    .
  4422 4140-exit.
  4423     exit.
  4424
  4425 4160-check-comment.
  4426
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  80
* EL691.cbl
  4427     string
  4428        w-cert-note-comment ' ' delimited by '  '
  4429        la-form-a3 ' ' delimited by size
  4430        la-processor-cd ' ' delimited by size
  4431        pi-create-date delimited by size
  4432           into w-stop-letter-comment
  4433     end-string
  4434
  4435     perform varying n1 from +126 by -1 until
  4436        w-stop-letter-comment(n1:1) <> space
  4437     end-perform
  4438     if n1 < +64
  4439        move +1                  to w-comment-line-cnt
  4440        move w-stop-letter-comment
  4441                                 to w-comment-line-1
  4442        go to 4160-exit
  4443     end-if
  4444
  4445     move +2                     to w-comment-line-cnt
  4446
  4447     perform varying n1 from n1 by -1 until
  4448        ((w-stop-letter-comment(n1:1) = ' ')
  4449            and
  4450         (n1 < +64))
  4451        or (n1 < +1)
  4452     end-perform
  4453
  4454     if n1 < +1
  4455        move w-stop-letter-comment(1:63)
  4456                                 to w-comment-line-1
  4457        move w-stop-letter-comment(64:63)
  4458                                 to w-comment-line-2
  4459     else
  4460        move w-stop-letter-comment(1:n1)
  4461                                 to w-comment-line-1
  4462        move w-stop-letter-comment(n1 + 1:126 - n1)
  4463                                 to w-comment-line-2
  4464     end-if
  4465
  4466     .
  4467 4160-exit.
  4468     exit.
  4469 4500-UPDATE-BILL-NOTE SECTION.
  4470
  4471
  4472* EXEC CICS GETMAIN
  4473*         SET      (ADDRESS OF EOB-CODES)
  4474*         LENGTH   (ELEOBC-LENGTH)
  4475*    END-EXEC
  4476*    MOVE '," L                  $   #00004000' TO DFHEIV0
  4477     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4478     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4479     MOVE X'2020233030303034303030' TO DFHEIV0(25:11)
  4480     CALL 'kxdfhei1' USING DFHEIV0,
  4481           DFHEIV20,
  4482           ELEOBC-LENGTH,
  4483           DFHEIV99
  4484     SET ADDRESS OF EOB-CODES TO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  81
* EL691.cbl
  4485         DFHEIV20
  4486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4487
  4488     MOVE LOW-VALUES             TO ELEOBC-KEY
  4489     MOVE PI-COMPANY-CD          TO EOBC-COMPANY-CD
  4490     MOVE '5'                    TO EOBC-REC-TYPE
  4491
  4492
  4493* EXEC CICS STARTBR
  4494*        DATASET   (ELEOBC-FILE-ID)
  4495*        RIDFLD    (ELEOBC-KEY)
  4496*        GTEQ
  4497*        RESP      (W-RESPONSE)
  4498*    END-EXEC
  4499     MOVE 0
  4500       TO DFHEIV11
  4501*    MOVE '&,         G          &  N#00004009' TO DFHEIV0
  4502     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4503     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4504     MOVE X'204E233030303034303039' TO DFHEIV0(25:11)
  4505     CALL 'kxdfhei1' USING DFHEIV0,
  4506           ELEOBC-FILE-ID,
  4507           ELEOBC-KEY,
  4508           DFHEIV99,
  4509           DFHEIV11,
  4510           DFHEIV99
  4511     MOVE EIBRESP  TO W-RESPONSE
  4512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4513
  4514     IF NOT RESP-NORMAL
  4515        GO TO 4500-EXIT
  4516     END-IF
  4517      .
  4518 4500-READNEXT-ELEOBC.
  4519
  4520
  4521* EXEC CICS READNEXT
  4522*       INTO    (EOB-CODES)
  4523*       DATASET (ELEOBC-FILE-ID)
  4524*       RIDFLD  (ELEOBC-KEY)
  4525*       RESP    (W-RESPONSE)
  4526*    END-EXEC
  4527     MOVE LENGTH OF
  4528      EOB-CODES
  4529       TO DFHEIV12
  4530     MOVE 0
  4531       TO DFHEIV11
  4532*    MOVE '&.IL                  )  N#00004022' TO DFHEIV0
  4533     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4534     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4535     MOVE X'204E233030303034303232' TO DFHEIV0(25:11)
  4536     CALL 'kxdfhei1' USING DFHEIV0,
  4537           ELEOBC-FILE-ID,
  4538           EOB-CODES,
  4539           DFHEIV12,
  4540           ELEOBC-KEY,
  4541           DFHEIV99,
  4542           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  82
* EL691.cbl
  4543           DFHEIV99,
  4544           DFHEIV99
  4545     MOVE EIBRESP  TO W-RESPONSE
  4546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4547
  4548     IF RESP-NORMAL
  4549         IF EO-RECORD-TYPE NOT = '5'
  4550             GO TO 4500-EXIT
  4551         END-IF
  4552     ELSE
  4553         GO TO 4500-EXIT
  4554     END-IF
  4555
  4556     IF EO-RECORD-TYPE = '5' AND
  4557        EO-EOB-CODE = PI-ARCHIVE-LTRID
  4558           CONTINUE
  4559     ELSE
  4560         GO TO 4500-READNEXT-ELEOBC
  4561     END-IF
  4562
  4563     MOVE SPACES TO WS-FIND-BILLING-NOTE
  4564     MOVE EO-DESCRIPTION TO WS-FBN-NOTE
  4565     MOVE PI-ARCHIVE-LTRID TO WS-FBN-LTRID
  4566
  4567
  4568* EXEC CICS GETMAIN
  4569*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  4570*         LENGTH   (ERNOTE-LENGTH)
  4571*    END-EXEC
  4572*    MOVE '," L                  $   #00004048' TO DFHEIV0
  4573     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4574     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4575     MOVE X'2020233030303034303438' TO DFHEIV0(25:11)
  4576     CALL 'kxdfhei1' USING DFHEIV0,
  4577           DFHEIV20,
  4578           ERNOTE-LENGTH,
  4579           DFHEIV99
  4580     SET ADDRESS OF CERTIFICATE-NOTE TO
  4581         DFHEIV20
  4582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4583
  4584     MOVE PI-COMPANY-CD          TO  ERNOTE-COMPANY-CD
  4585     MOVE PI-CARRIER             TO  ERNOTE-CARRIER
  4586     MOVE PI-GROUPING            TO  ERNOTE-GROUPING
  4587     MOVE PI-STATE               TO  ERNOTE-STATE
  4588     MOVE PI-ACCOUNT             TO  ERNOTE-ACCOUNT
  4589     MOVE PI-CERT-EFF-DT         TO  ERNOTE-CERT-EFF-DT
  4590     MOVE PI-CERT-PRIME          TO  ERNOTE-CERT-PRIME
  4591     MOVE PI-CERT-SFX            TO  ERNOTE-CERT-SFX
  4592
  4593
  4594* EXEC CICS READ
  4595*       DATASET    (ERNOTE-FILE-ID)
  4596*       RIDFLD     (ERNOTE-KEY)
  4597*       INTO       (CERTIFICATE-NOTE)
  4598*       RESP       (W-RESPONSE)
  4599*       UPDATE
  4600*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  83
* EL691.cbl
  4601     MOVE LENGTH OF
  4602      CERTIFICATE-NOTE
  4603       TO DFHEIV11
  4604*    MOVE '&"IL       EU         (  N#00004062' TO DFHEIV0
  4605     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4606     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4607     MOVE X'204E233030303034303632' TO DFHEIV0(25:11)
  4608     CALL 'kxdfhei1' USING DFHEIV0,
  4609           ERNOTE-FILE-ID,
  4610           CERTIFICATE-NOTE,
  4611           DFHEIV11,
  4612           ERNOTE-KEY,
  4613           DFHEIV99,
  4614           DFHEIV99,
  4615           DFHEIV99
  4616     MOVE EIBRESP  TO W-RESPONSE
  4617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4618
  4619     IF RESP-NORMAL
  4620       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  4621           (NOTE-SUB > +10) OR
  4622           (CN-LINE (NOTE-SUB) (1:29) =
  4623                             WS-FIND-BILLING-NOTE (1:29))
  4624       END-PERFORM
  4625       IF CN-LINE (NOTE-SUB) (1:29) NOT =
  4626                              WS-FIND-BILLING-NOTE (1:29)
  4627
  4628* EXEC CICS UNLOCK
  4629*           DATASET    (ERNOTE-FILE-ID)
  4630*        END-EXEC
  4631*    MOVE '&*                    #   #00004078' TO DFHEIV0
  4632     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4633     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4634     MOVE X'2020233030303034303738' TO DFHEIV0(25:11)
  4635     CALL 'kxdfhei1' USING DFHEIV0,
  4636           ERNOTE-FILE-ID,
  4637           DFHEIV99
  4638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4639         GO TO 4500-EXIT
  4640       END-IF
  4641
  4642       MOVE WS-RECEIVED-NOTE TO CN-LINE (NOTE-SUB) (50:20)
  4643       MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  4644       MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
  4645       MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  4646
  4647* EXEC CICS REWRITE
  4648*         DATASET    (ERNOTE-FILE-ID)
  4649*         FROM       (CERTIFICATE-NOTE)
  4650*         RESP       (W-RESPONSE)
  4651*      END-EXEC
  4652     MOVE LENGTH OF
  4653      CERTIFICATE-NOTE
  4654       TO DFHEIV11
  4655*    MOVE '&& L                  %  N#00004088' TO DFHEIV0
  4656     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4657     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4658     MOVE X'204E233030303034303838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  84
* EL691.cbl
  4659     CALL 'kxdfhei1' USING DFHEIV0,
  4660           ERNOTE-FILE-ID,
  4661           CERTIFICATE-NOTE,
  4662           DFHEIV11,
  4663           DFHEIV99
  4664     MOVE EIBRESP  TO W-RESPONSE
  4665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4666
  4667       .
  4668
  4669 4500-EXIT.
  4670     EXIT.
  4671
  4672
  4673 4800-CERTIFICATE-UPDATE SECTION.
  4674
  4675
  4676* EXEC CICS HANDLE CONDITION
  4677*        NOTFND   (4899-EXIT)
  4678*    END-EXEC.
  4679*    MOVE '"$I                   ! ( #00004102' TO DFHEIV0
  4680     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4682     MOVE X'2820233030303034313032' TO DFHEIV0(25:11)
  4683     CALL 'kxdfhei1' USING DFHEIV0
  4684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4685
  4686
  4687
  4688* EXEC CICS READ
  4689*    EQUAL
  4690*    DATASET   (ELCERT-FILE-ID)
  4691*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  4692*    RIDFLD    (ELCERT-KEY)
  4693*    UPDATE
  4694*    RESP      (W-RESPONSE)
  4695*    END-EXEC.
  4696*    MOVE '&"S        EU         (  N#00004106' TO DFHEIV0
  4697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4698     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4699     MOVE X'204E233030303034313036' TO DFHEIV0(25:11)
  4700     CALL 'kxdfhei1' USING DFHEIV0,
  4701           ELCERT-FILE-ID,
  4702           DFHEIV20,
  4703           DFHEIV99,
  4704           ELCERT-KEY,
  4705           DFHEIV99,
  4706           DFHEIV99,
  4707           DFHEIV99
  4708     SET ADDRESS OF CERTIFICATE-MASTER TO
  4709         DFHEIV20
  4710     MOVE EIBRESP  TO W-RESPONSE
  4711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4712
  4713
  4714     IF RESP-NORMAL
  4715        IF CM-NOTE-SW = ' '
  4716           MOVE '1'        TO CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  85
* EL691.cbl
  4717        ELSE
  4718           IF CM-NOTE-SW = '2'
  4719              MOVE '3'      TO CM-NOTE-SW
  4720           ELSE
  4721              IF CM-NOTE-SW = '4'
  4722                  MOVE '5'    TO CM-NOTE-SW
  4723              ELSE
  4724                 IF CM-NOTE-SW = '6'
  4725                    MOVE '7'  TO CM-NOTE-SW
  4726                 END-IF
  4727              END-IF
  4728           END-IF
  4729        END-IF
  4730
  4731* EXEC CICS REWRITE
  4732*          FROM      (CERTIFICATE-MASTER)
  4733*          DATASET   (ELCERT-FILE-ID)
  4734*       END-EXEC
  4735     MOVE LENGTH OF
  4736      CERTIFICATE-MASTER
  4737       TO DFHEIV11
  4738*    MOVE '&& L                  %   #00004131' TO DFHEIV0
  4739     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4740     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4741     MOVE X'2020233030303034313331' TO DFHEIV0(25:11)
  4742     CALL 'kxdfhei1' USING DFHEIV0,
  4743           ELCERT-FILE-ID,
  4744           CERTIFICATE-MASTER,
  4745           DFHEIV11,
  4746           DFHEIV99
  4747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4748     END-IF.
  4749
  4750 4899-EXIT.
  4751      EXIT.
  4752
  4753
  4754
  4755 8010-ARCH-NOT-OPEN.
  4756
  4757     MOVE ER-7388                TO EMI-ERROR.
  4758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4759     MOVE -1                     TO MAINTL.
  4760     GO TO 8200-SEND-DATAONLY.
  4761
  4762 8015-ARCT-NOT-OPEN.
  4763
  4764     MOVE ER-7373                TO EMI-ERROR.
  4765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4766     MOVE -1                     TO MAINTL.
  4767     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  86
* EL691.cbl
  4769
  4770 8100-SEND-INITIAL-MAP.
  4771
  4772     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4773
  4774     IF  NOT EMI-NO-ERRORS
  4775         MOVE EMI-MESSAGE-AREA (1)
  4776                                 TO ERRMSG1O
  4777     ELSE
  4778         MOVE SPACES             TO ERRMSG1O
  4779     END-IF.
  4780
  4781
  4782* EXEC CICS SEND
  4783*        MAP    (W-MAP)
  4784*        MAPSET (W-MAPSET)
  4785*        FROM   (EL691AO)
  4786*        ERASE
  4787*        CURSOR
  4788*    END-EXEC.
  4789     MOVE LENGTH OF
  4790      EL691AO
  4791       TO DFHEIV12
  4792     MOVE -1
  4793       TO DFHEIV11
  4794*    MOVE '8$     CT  E    H L F ,   #00004168' TO DFHEIV0
  4795     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4796     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4797     MOVE X'2020233030303034313638' TO DFHEIV0(25:11)
  4798     CALL 'kxdfhei1' USING DFHEIV0,
  4799           W-MAP,
  4800           EL691AO,
  4801           DFHEIV12,
  4802           W-MAPSET,
  4803           DFHEIV99,
  4804           DFHEIV99,
  4805           DFHEIV99,
  4806           DFHEIV11,
  4807           DFHEIV99,
  4808           DFHEIV99,
  4809           DFHEIV99
  4810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4811
  4812
  4813     GO TO 9000-RETURN-TRANS.
  4814
  4815 8100-EXIT.
  4816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  87
* EL691.cbl
  4818
  4819 8200-SEND-DATAONLY.
  4820
  4821     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4822
  4823     IF  NOT EMI-NO-ERRORS
  4824         MOVE EMI-MESSAGE-AREA (1)
  4825                                 TO ERRMSG1O
  4826     ELSE
  4827         MOVE SPACES             TO ERRMSG1O
  4828     END-IF.
  4829
  4830
  4831* EXEC CICS SEND
  4832*        MAP    (W-MAP)
  4833*        MAPSET (W-MAPSET)
  4834*        FROM   (EL691AO)
  4835*        DATAONLY
  4836*        CURSOR
  4837*    END-EXEC.
  4838     MOVE LENGTH OF
  4839      EL691AO
  4840       TO DFHEIV12
  4841     MOVE -1
  4842       TO DFHEIV11
  4843*    MOVE '8$D    CT       H L F ,   #00004193' TO DFHEIV0
  4844     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4845     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4846     MOVE X'2020233030303034313933' TO DFHEIV0(25:11)
  4847     CALL 'kxdfhei1' USING DFHEIV0,
  4848           W-MAP,
  4849           EL691AO,
  4850           DFHEIV12,
  4851           W-MAPSET,
  4852           DFHEIV99,
  4853           DFHEIV99,
  4854           DFHEIV99,
  4855           DFHEIV11,
  4856           DFHEIV99,
  4857           DFHEIV99,
  4858           DFHEIV99
  4859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4860
  4861
  4862     GO TO 9000-RETURN-TRANS.
  4863
  4864 8200-EXIT.
  4865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  88
* EL691.cbl
  4867
  4868 8300-SEND-TEXT.
  4869
  4870
  4871* EXEC CICS SEND TEXT
  4872*        FROM    (LOGOFF-TEXT)
  4873*        LENGTH  (LOGOFF-LENGTH)
  4874*        ERASE
  4875*        FREEKB
  4876*    END-EXEC.
  4877*    MOVE '8&      T  E F  H   F -   #00004209' TO DFHEIV0
  4878     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4879     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4880     MOVE X'2020233030303034323039' TO DFHEIV0(25:11)
  4881     CALL 'kxdfhei1' USING DFHEIV0,
  4882           LOGOFF-TEXT,
  4883           LOGOFF-LENGTH,
  4884           DFHEIV99,
  4885           DFHEIV99,
  4886           DFHEIV99,
  4887           DFHEIV99,
  4888           DFHEIV99,
  4889           DFHEIV99,
  4890           DFHEIV99,
  4891           DFHEIV99,
  4892           DFHEIV99,
  4893           DFHEIV99
  4894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4895
  4896
  4897     GO TO 9000-RETURN-TRANS.
  4898
  4899 8300-EXIT.
  4900     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  89
* EL691.cbl
  4902
  4903 8600-DEEDIT.
  4904
  4905
  4906* EXEC CICS BIF DEEDIT
  4907*         FIELD    (W-DEEDIT-FIELD)
  4908*         LENGTH   (15)
  4909*    END-EXEC.
  4910     MOVE 15
  4911       TO DFHEIV11
  4912*    MOVE '@"L                   #   #00004224' TO DFHEIV0
  4913     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4914     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4915     MOVE X'2020233030303034323234' TO DFHEIV0(25:11)
  4916     CALL 'kxdfhei1' USING DFHEIV0,
  4917           W-DEEDIT-FIELD,
  4918           DFHEIV11
  4919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4920
  4921
  4922 8600-EXIT.
  4923     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  90
* EL691.cbl
  4925
  4926 9000-RETURN-TRANS.
  4927
  4928     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  4929     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
  4930
  4931* EXEC CICS RETURN
  4932*        TRANSID    (W-TRANSACTION)
  4933*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4934*        LENGTH     (PI-COMM-LENGTH)
  4935*    END-EXEC.
  4936*    MOVE '.(CT                  ''   #00004237' TO DFHEIV0
  4937     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4938     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4939     MOVE X'2020233030303034323337' TO DFHEIV0(25:11)
  4940     CALL 'kxdfhei1' USING DFHEIV0,
  4941           W-TRANSACTION,
  4942           PROGRAM-INTERFACE-BLOCK,
  4943           PI-COMM-LENGTH,
  4944           DFHEIV99,
  4945           DFHEIV99,
  4946           DFHEIV99
  4947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4948
  4949
  4950 9000-EXIT.
  4951     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  91
* EL691.cbl
  4953
  4954 9200-PA.
  4955
  4956     MOVE ER-7008                TO EMI-ERROR.
  4957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4958     MOVE -1                     TO MAINTL.
  4959     GO TO 8200-SEND-DATAONLY.
  4960
  4961 9200-EXIT.
  4962     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  92
* EL691.cbl
  4964
  4965 9300-DFHCLEAR.
  4966
  4967     MOVE PI-RETURN-TO-PROGRAM TO W-CALL-PGM.
  4968     GO TO 9400-XCTL.
  4969
  4970 9300-EXIT.
  4971     EXIT.
  4972
  4973 9400-XCTL.
  4974
  4975
  4976* EXEC CICS XCTL
  4977*        PROGRAM  (W-CALL-PGM)
  4978*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4979*        LENGTH   (PI-COMM-LENGTH)
  4980*    END-EXEC.
  4981*    MOVE '.$C                   %   #00004268' TO DFHEIV0
  4982     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4983     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4984     MOVE X'2020233030303034323638' TO DFHEIV0(25:11)
  4985     CALL 'kxdfhei1' USING DFHEIV0,
  4986           W-CALL-PGM,
  4987           PROGRAM-INTERFACE-BLOCK,
  4988           PI-COMM-LENGTH,
  4989           DFHEIV99
  4990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4991
  4992
  4993 9400-EXIT.
  4994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  93
* EL691.cbl
  4996
  4997 9500-LINK-DATE-CONVERT.
  4998
  4999
  5000* EXEC CICS LINK
  5001*        PROGRAM    ('ELDATCV')
  5002*        COMMAREA   (DATE-CONVERSION-DATA)
  5003*        LENGTH     (DC-COMM-LENGTH)
  5004*    END-EXEC.
  5005     MOVE 'ELDATCV' TO DFHEIV1
  5006*    MOVE '."C                   (   #00004280' TO DFHEIV0
  5007     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5009     MOVE X'2020233030303034323830' TO DFHEIV0(25:11)
  5010     CALL 'kxdfhei1' USING DFHEIV0,
  5011           DFHEIV1,
  5012           DATE-CONVERSION-DATA,
  5013           DC-COMM-LENGTH,
  5014           DFHEIV99,
  5015           DFHEIV99,
  5016           DFHEIV99,
  5017           DFHEIV99
  5018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5019
  5020
  5021 9500-EXIT.
  5022     EXIT.
  5023
  5024 9600-FORMAT-DATE-TIME.
  5025
  5026     MOVE W-SAVE-DATE            TO RUNDTEO.
  5027     MOVE EIBTIME                TO W-TIME-IN.
  5028     MOVE W-TIME-OUT             TO RUNTIMEO.
  5029     MOVE PI-COMPANY-ID          TO COMPANYO.
  5030     MOVE PI-PROCESSOR-ID        TO USERIDO.
  5031     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  5032
  5033     IF PI-ARCHIVE-COMPLETE = 'Y'
  5034        MOVE AL-SANOF           TO STCOMPA
  5035        MOVE AL-SADOF           TO STRECVA
  5036                                   STSTOPA
  5037                                   STFINLA
  5038     ELSE
  5039       IF PI-ARCHIVE-RECEIVED = 'Y'
  5040           MOVE AL-SANOF        TO STRECVA
  5041           MOVE AL-SADOF        TO STCOMPA
  5042                                   STSTOPA
  5043                                   STFINLA
  5044       ELSE
  5045         IF PI-ARCHIVE-STOPPED = 'Y'
  5046             MOVE AL-SANOF      TO STSTOPA
  5047             MOVE AL-SADOF      TO STCOMPA
  5048                                   STRECVA
  5049                                   STFINLA
  5050         ELSE
  5051           IF PI-ARCHIVE-FINAL = 'Y'
  5052               MOVE AL-SANOF    TO STFINLA
  5053               MOVE AL-SADOF    TO STCOMPA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  94
* EL691.cbl
  5054                                   STRECVA
  5055                                   STSTOPA
  5056           ELSE
  5057               MOVE AL-SADOF    TO STCOMPA
  5058                                   STRECVA
  5059                                   STSTOPA
  5060                                   STFINLA
  5061           END-IF
  5062         END-IF
  5063       END-IF
  5064     END-IF.
  5065
  5066
  5067 9600-EXIT.
  5068     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  95
* EL691.cbl
  5070
  5071 9700-PGMID-ERROR.
  5072
  5073
  5074* EXEC CICS  HANDLE CONDITION
  5075*        PGMIDERR  (8300-SEND-TEXT)
  5076*    END-EXEC.
  5077*    MOVE '"$L                   ! ) #00004338' TO DFHEIV0
  5078     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5080     MOVE X'2920233030303034333338' TO DFHEIV0(25:11)
  5081     CALL 'kxdfhei1' USING DFHEIV0
  5082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5083
  5084
  5085     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  5086     MOVE ' '                    TO PI-ENTRY-CD-1.
  5087     MOVE W-XCTL-005             TO W-CALL-PGM
  5088                                    LOGOFF-PGM.
  5089     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  5090
  5091     PERFORM 9400-XCTL THRU 9400-EXIT.
  5092
  5093 9700-EXIT.
  5094     EXIT.
  5095
  5096 9800-ABEND.
  5097
  5098     MOVE W-LINK-004             TO W-CALL-PGM.
  5099     MOVE DFHEIBLK               TO EMI-LINE1
  5100
  5101
  5102* EXEC CICS  LINK
  5103*        PROGRAM   (W-CALL-PGM)
  5104*        COMMAREA  (EMI-LINE1)
  5105*        LENGTH    (72)
  5106*    END-EXEC.
  5107     MOVE 72
  5108       TO DFHEIV11
  5109*    MOVE '."C                   (   #00004358' TO DFHEIV0
  5110     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5112     MOVE X'2020233030303034333538' TO DFHEIV0(25:11)
  5113     CALL 'kxdfhei1' USING DFHEIV0,
  5114           W-CALL-PGM,
  5115           EMI-LINE1,
  5116           DFHEIV11,
  5117           DFHEIV99,
  5118           DFHEIV99,
  5119           DFHEIV99,
  5120           DFHEIV99
  5121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5122
  5123
  5124     GO TO 8200-SEND-DATAONLY.
  5125
  5126 9800-EXIT.
  5127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  96
* EL691.cbl
  5129
  5130 9900-ERROR-FORMAT.
  5131
  5132     IF  EMI-ERROR EQUAL ER-9097
  5133         NEXT SENTENCE
  5134     ELSE
  5135         IF  EMI-ERRORS-COMPLETE
  5136                 OR
  5137             EMI-ERROR EQUAL W-LAST-ERROR
  5138             GO TO 9900-EXIT
  5139     END-IF.
  5140
  5141     ADD +1  TO  W-ERROR-COUNT.
  5142     MOVE W-LINK-001             TO W-CALL-PGM.
  5143
  5144
  5145* EXEC CICS LINK
  5146*        PROGRAM    (W-CALL-PGM)
  5147*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  5148*        LENGTH     (EMI-COMM-LENGTH)
  5149*    END-EXEC.
  5150*    MOVE '."C                   (   #00004384' TO DFHEIV0
  5151     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5153     MOVE X'2020233030303034333834' TO DFHEIV0(25:11)
  5154     CALL 'kxdfhei1' USING DFHEIV0,
  5155           W-CALL-PGM,
  5156           ERROR-MESSAGE-INTERFACE-BLOCK,
  5157           EMI-COMM-LENGTH,
  5158           DFHEIV99,
  5159           DFHEIV99,
  5160           DFHEIV99,
  5161           DFHEIV99
  5162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5163
  5164
  5165     MOVE EMI-ERROR              TO W-LAST-ERROR.
  5166
  5167 9900-EXIT.
  5168     EXIT.
  5169
  5170 9905-INITIALIZE-SECURITY.
  5171******************************************************************
  5172*                                                                *
  5173*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  5174*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  5175*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  5176*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  5177*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  5178*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  5179*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  5180*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
  5181*                                                                *
  5182*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
  5183*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  5184*                                                                *
  5185******************************************************************
  5186
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  97
* EL691.cbl
  5187     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  5188         MOVE 'Y'                TO PI-DISPLAY-CAP
  5189                                    PI-MODIFY-CAP
  5190     ELSE
  5191
  5192* EXEC CICS READQ TS
  5193*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5194*            INTO   (SECURITY-CONTROL)
  5195*            LENGTH (SC-COMM-LENGTH)
  5196*            ITEM   (1)
  5197*        END-EXEC
  5198     MOVE 1
  5199       TO DFHEIV11
  5200*    MOVE '*$II   L              ''   #00004416' TO DFHEIV0
  5201     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5202     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5203     MOVE X'2020233030303034343136' TO DFHEIV0(25:11)
  5204     CALL 'kxdfhei1' USING DFHEIV0,
  5205           PI-SECURITY-TEMP-STORE-ID,
  5206           SECURITY-CONTROL,
  5207           SC-COMM-LENGTH,
  5208           DFHEIV11,
  5209           DFHEIV99,
  5210           DFHEIV99
  5211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5212         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  5213                                 TO PI-DISPLAY-CAP
  5214         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  5215                                 TO PI-MODIFY-CAP
  5216     END-IF.
  5217
  5218 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  98
* EL691.cbl
  5220
  5221 9995-SECURITY-VIOLATION.
  5222
  5223     MOVE EIBDATE                TO SM-JUL-DATE.
  5224     MOVE EIBTRMID               TO SM-TERMID.
  5225     MOVE W-THIS-PGM             TO SM-PGM.
  5226     MOVE EIBTIME                TO W-TIME-IN.
  5227     MOVE W-TIME-OUT             TO SM-TIME.
  5228     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
  5229
  5230
  5231* EXEC CICS LINK
  5232*         PROGRAM  ('EL003')
  5233*         COMMAREA (SECURITY-MESSAGE)
  5234*         LENGTH   (80)
  5235*    END-EXEC.
  5236     MOVE 'EL003' TO DFHEIV1
  5237     MOVE 80
  5238       TO DFHEIV11
  5239*    MOVE '."C                   (   #00004440' TO DFHEIV0
  5240     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5242     MOVE X'2020233030303034343430' TO DFHEIV0(25:11)
  5243     CALL 'kxdfhei1' USING DFHEIV0,
  5244           DFHEIV1,
  5245           SECURITY-MESSAGE,
  5246           DFHEIV11,
  5247           DFHEIV99,
  5248           DFHEIV99,
  5249           DFHEIV99,
  5250           DFHEIV99
  5251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5252
  5253
  5254 9995-EXIT.
  5255     EXIT.
  5256
  5257 9999-GOBACK.
  5258
  5259
  5260* GOBACK.
  5261     MOVE '9%                    "   ' TO DFHEIV0
  5262     MOVE 'EL691' TO DFHEIV1
  5263     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5264     GOBACK.
  5265
  5266 9999-EXIT.
  5267     EXIT.
  5268
  5269 9999-DFHBACK SECTION.
  5270     MOVE '9%                    "   ' TO DFHEIV0
  5271     MOVE 'EL691' TO DFHEIV1
  5272     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5273     GOBACK.
  5274 9999-DFHEXIT.
  5275     IF DFHEIGDJ EQUAL 0001
  5276         NEXT SENTENCE
  5277     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 24-Apr-19 08:58 Page  99
* EL691.cbl
  5278         GO TO 9300-DFHCLEAR,
  5279               9200-PA,
  5280               9200-PA,
  5281               9200-PA
  5282         DEPENDING ON DFHEIGDI
  5283     ELSE IF DFHEIGDJ EQUAL 3
  5284         GO TO 9700-PGMID-ERROR,
  5285               9800-ABEND
  5286         DEPENDING ON DFHEIGDI
  5287     ELSE IF DFHEIGDJ EQUAL 4
  5288         GO TO 8010-ARCH-NOT-OPEN,
  5289               1070-ARCH-NOT-FOUND,
  5290               1070-ARCH-NOT-FOUND
  5291         DEPENDING ON DFHEIGDI
  5292     ELSE IF DFHEIGDJ EQUAL 5
  5293         GO TO 8015-ARCT-NOT-OPEN,
  5294               1000-ARCT-NOT-FOUND,
  5295               1000-ARCT-NOT-FOUND
  5296         DEPENDING ON DFHEIGDI
  5297     ELSE IF DFHEIGDJ EQUAL 6
  5298         GO TO 8010-ARCH-NOT-OPEN,
  5299               1070-ARCH-NOT-FOUND,
  5300               1070-ARCH-NOT-FOUND
  5301         DEPENDING ON DFHEIGDI
  5302     ELSE IF DFHEIGDJ EQUAL 7
  5303         GO TO 3200-NOT-FOUND,
  5304               3200-NOT-FOUND
  5305         DEPENDING ON DFHEIGDI
  5306     ELSE IF DFHEIGDJ EQUAL 8
  5307         GO TO 4899-EXIT
  5308         DEPENDING ON DFHEIGDI
  5309     ELSE IF DFHEIGDJ EQUAL 9
  5310         GO TO 8300-SEND-TEXT
  5311         DEPENDING ON DFHEIGDI.
  5312     MOVE '9%                    "   ' TO DFHEIV0
  5313     MOVE 'EL691' TO DFHEIV1
  5314     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5315     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      214652     Code:       17973
