* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 101216  IR2016101000002  PEMA  Fix negative amount also per DJWB
    37*  REMOVE ERROR 3445.
    38* 103116  IR2016102000001  PEMA  Fix zero refund amount.
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    48 77  s1                          pic s999 comp-3 value +0.
    49 77  s2                          pic s999 comp-3 value +0.
    50 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    51 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    53 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    54 77  ws-browse-sw                pic x value spaces.
    55     88  i-say-when                 value 'Y'.
    56 77  ws-delete-sw                pic x value ' '.
    57     88  row-deleted                 value 'Y'.
    58 77  ws-sql-code                 pic s9(7) value zeros.
    59 77  ws-dis-sql-code             pic -9999999 value zeros.
    60 77  ws-match-sw                 pic x  value ' '.
    61     88  found-a-match             value 'Y'.
    62 77  ws-commit-sw                pic x value ' '.
    63     88  tbl-commited                value 'Y'.
    64 01  P pointer.
    65 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    66 01  var-ptr pointer.
    67 01  env-var-len                 pic 9(4)  binary.
    68 01  rc                          pic 9(9)  binary.
    69
    70 01  WS-KIXSYS.
    71     05  WS-KIX-FIL1             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   3
* EL677.cbl
    72     05  WS-KIX-APPS             PIC X(10).
    73     05  WS-KIX-ENV              PIC X(10).
    74     05  WS-KIX-MYENV            PIC X(10).
    75     05  WS-KIX-SYS              PIC X(10).
*   76 EXEC SQL
*   77    INCLUDE SQLDA
*   78 END-EXEC
    79 01 SQLDA sync.
    80    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    81    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    82    05 SQLN                  PIC S9(4) COMP-5 value 0.
    83    05 SQLD                  PIC S9(4) COMP-5 value 0.
    84    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    85       10 SQLTYPE            PIC S9(4) COMP-5.
    86       10 SQLLEN             PIC S9(4) COMP-5.
    87$IF P64 SET
    88X      *> For 64-bit environments, ensure that SQLDATA is
    89X      *> aligned on an 8-byte boundary.
    90X      10 FILLER             PIC S9(9) COMP-5.
    91$END
    92       10 SQLDATA            USAGE POINTER.
    93       10 SQLIND             USAGE POINTER.
    94       10 SQLNAME.
    95          15 SQLNAMEL        PIC S9(4) COMP-5.
    96          15 SQLNAMEC        PIC X(30).
    97
    98* Values for SQLTYPE
    99
   100 78  ESQL-DATE-CHAR              VALUE 384.
   101 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   102 78  ESQL-DATE-REC               VALUE 386.
   103 78  ESQL-DATE-REC-NULL          VALUE 387.
   104 78  ESQL-TIME-CHAR              VALUE 388.
   105 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   106 78  ESQL-TIME-REC               VALUE 390.
   107 78  ESQL-TIME-REC-NULL          VALUE 391.
   108 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   109 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   110 78  ESQL-TIMESTAMP-REC          VALUE 394.
   111 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   112 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   113 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   114 78  ESQL-TS-OFFSET-REC          VALUE 398.
   115 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   116 78  ESQL-LONGVARBINARY          VALUE 404.
   117 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   118 78  ESQL-LONGVARCHAR            VALUE 408.
   119 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   120 78  ESQL-BINARY                 VALUE 444.
   121 78  ESQL-BINARY-NULL            VALUE 445.
   122 78  ESQL-VARBINARY              VALUE 446.
   123 78  ESQL-VARBINARY-NULL         VALUE 447.
   124 78  ESQL-VARCHAR                VALUE 448.
   125 78  ESQL-VARCHAR-NULL           VALUE 449.
   126
   127 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   128 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   129
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHAR                   VALUE 452.
   131 78  ESQL-CHAR-NULL              VALUE 453.
   132
   133 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   134 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   135
   136 78  ESQL-DOUBLE                 VALUE 480.
   137 78  ESQL-DOUBLE-NULL            VALUE 481.
   138 78  ESQL-REAL                   VALUE 482.
   139 78  ESQL-REAL-NULL              VALUE 483.
   140 78  ESQL-DECIMAL                VALUE 484.
   141 78  ESQL-DECIMAL-NULL           VALUE 485.
   142 78  ESQL-INTEGER                VALUE 496.
   143 78  ESQL-INTEGER-NULL           VALUE 497.
   144 78  ESQL-SMALLINT               VALUE 500.
   145 78  ESQL-SMALLINT-NULL          VALUE 501.
   146 78  ESQL-TINYINT                VALUE 502.
   147 78  ESQL-TINYINT-NULL           VALUE 503.
*  148 EXEC SQL
*  149    INCLUDE SQLCA
*  150 END-EXEC
   151 01 SQLCA.
   152     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   153     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   154     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   155     05  SQLERRM.
   156         49  SQLERRML    PIC S9(4) COMP-5.
   157         49  SQLERRMC    PIC X(70).
   158     05  SQLERRP         PIC X(8).
   159     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   160     05  SQLWARN.
   161         10  SQLWARN0    PIC X.
   162         10  SQLWARN1    PIC X.
   163         10  SQLWARN2    PIC X.
   164         10  SQLWARN3    PIC X.
   165         10  SQLWARN4    PIC X.
   166         10  SQLWARN5    PIC X.
   167         10  SQLWARN6    PIC X.
   168         10  SQLWARN7    PIC X.
   169     05  SQLEXT.
   170         10  SQLWARN8    PIC X.
   171         10  SQLWARN9    PIC X.
   172         10  SQLWARN10   PIC X.
   173         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   174     05  SQLSTATE    PIC X(5).
   175 EXEC SQL
   176    BEGIN DECLARE SECTION
   177 END-EXEC
   178 01  ws-paid-bank-work-area.
   179     05  ws-pb-compid            pic x(9).
   180     05  ws-pb-check-no          pic x(10).
   181     05  ws-pb-bad-check-no      pic x(10).
   182     05  ws-check-amount         pic x(10).
   183 01  Paid-Bank-Info.
   184     05  pb-check-no             pic 9(10).
   185     05  pb-tran-type            pic x.
   186     05  pb-bank-acct-desc       pic x(50).
   187     05  pb-amount               pic x(12).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   5
* EL677.cbl
   188     05  pb-paid-date            pic x(25).
   189 01  ws-key-stuff.
   190     05  ws-compid               pic xxx.
   191     05  ws-carrier              pic x.
   192     05  ws-grouping             pic x(6).
   193     05  ws-state                pic xx.
   194     05  ws-account              pic x(10).
   195     05  ws-eff-date             pic x(10).
   196     05  ws-certificate          pic x(10).
   197     05  ws-cert-sfx             pic x.
   198     05  ws-seq-no               pic 999.
   199     05  ws-type                 pic x.
   200     05  ws-check-sub-type       pic x.
   201 01  sqlcmd                      pic x(1024).
   202 01  WS-MOE-DATE                 pic x(10).
   203 01  svr                         pic x(32).
   204 01  usr                         pic x(32).
   205 01  pass                        pic x(32).
   206 01  usr-pass                    pic x(64).
   207 01  ws-disp-code                pic s9(11).
   208***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   209***                                                            ***
   210***  These indicators are used to determine if a variable      ***
   211***  is passed nulls from sql. The indicator will be -1        ***
   212***  if the value on sql is nulls and +0 if the value is       ***
   213***  something other than nulls. Here is an example on how     ***
   214***  to use the indicator variables.                           ***
   215***                                                            ***
   216***     EXEC SQL                                               ***
   217***        fetch checkapp into                                 ***
   218***           :db-app-status :nu-app-status,                   ***
   219***           :db-app-by     :nu-app-by,                       ***
   220***           :db-app-date   :nu-app-date,                     ***
   221***           :db-app-batch  :nu-app-batch                     ***
   222***     END-EXEC                                               ***
   223***                                                            ***
   224***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   225 01  indicator-vaiables-for-nulls.
   226     05  nu-app-status           pic s9(4) comp value +0.
   227     05  nu-app-by               pic s9(4) comp value +0.
   228     05  nu-app-date             pic s9(4) comp value +0.
   229     05  nu-app-batch            pic s9(4) comp value +0.
   230     05  nu-fincar               pic s9(4) comp value +0.
   231 01  daily-check-request-rec.
   232     05  db-compid               pic xxx.
   233     05  db-carrier              pic x.
   234     05  db-grouping             pic x(6).
   235     05  db-state                pic xx.
   236     05  db-account              pic x(10).
   237     05  db-effdate              pic x(10).
   238     05  db-certificate          pic x(10).
   239     05  db-cert-sfx             pic x.
   240     05  db-seq-no               pic 999.
   241     05  db-type                 pic x.
   242     05  db-amount-n             pic 9(7).99.
   243     05  db-amount redefines db-amount-n
   244                                 pic x(10).
   245     05  db-checkno              pic x(15).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   6
* EL677.cbl
   246     05  db-checkdate            pic x(10).
   247     05  db-checkstatus          pic 9(5).
   248     05  db-releasebatch         pic 9(5).
   249     05  db-releasedt            pic x(10).
   250     05  db-releaseby            pic x(4).
   251     05  db-payeename1           pic x(30).
   252     05  db-payeename2           pic x(30).
   253     05  db-payeeaddr1           pic x(30).
   254     05  db-payeeaddr2           pic x(30).
   255     05  db-payeecity            pic x(30).
   256     05  db-payeest              pic xx.
   257     05  db-payeezip             pic x(10).
   258     05  db-fincar               pic x.
   259     05  db-fingrp               pic x(6).
   260     05  db-finresp              pic x(10).
   261     05  db-finacct              pic x(10).
   262     05  db-preparer             pic x(4).
   263     05  db-app-status           pic x(9).
   264     05  dp-app-status-n redefines db-app-status
   265                                 pic 9(9).
   266     05  db-app-by               pic x(20).
   267     05  db-app-date             pic x(30).
   268     05  db-app-batch            pic x(10).
   269     05  db-return-to            pic x(30).
   270     05  db-insured-name         pic x(30).
   271     05  db-check-sub-type       pic x.
   272 EXEC SQL
   273    END DECLARE SECTION
   274 END-EXEC
   275*                            COPY ELCSCTM.
   276******************************************************************
   277*                                                                *
   278*                                                                *
   279*                            ELCSCTM                             *
   280*                            VMOD=2.001                          *
   281*                                                                *
   282*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   283*                                                                *
   284******************************************************************
   285 01  SECURITY-MESSAGE.
   286     12  FILLER                          PIC X(30)
   287            VALUE '** LOGIC SECURITY VIOLATION -'.
   288     12  SM-READ                         PIC X(6).
   289     12  FILLER                          PIC X(5)
   290            VALUE ' PGM='.
   291     12  SM-PGM                          PIC X(6).
   292     12  FILLER                          PIC X(5)
   293            VALUE ' OPR='.
   294     12  SM-PROCESSOR-ID                 PIC X(4).
   295     12  FILLER                          PIC X(6)
   296            VALUE ' TERM='.
   297     12  SM-TERMID                       PIC X(4).
   298     12  FILLER                          PIC XX   VALUE SPACE.
   299     12  SM-JUL-DATE                     PIC 9(5).
   300     12  FILLER                          PIC X    VALUE SPACE.
   301     12  SM-TIME                         PIC 99.99.
   302
   303*                            COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   7
* EL677.cbl
   304******************************************************************
   305*                                                                *
   306*                                                                *
   307*                            ELCSCRTY                            *
   308*                            VMOD=2.001                          *
   309*                                                                *
   310*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   311*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   312*        SAVED IN PI-SECURITY-ADDRESS.                           *
   313*                                                                *
   314******************************************************************
   315 01  SECURITY-CONTROL.
   316     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   317     12  FILLER                       PIC XX    VALUE 'SC'.
   318     12  SC-CREDIT-CODES.
   319         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   320             20  SC-CREDIT-DISPLAY    PIC X.
   321             20  SC-CREDIT-UPDATE     PIC X.
   322     12  SC-CLAIMS-CODES.
   323         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   324             20  SC-CLAIMS-DISPLAY    PIC X.
   325             20  SC-CLAIMS-UPDATE     PIC X.
   326 01  ws-dummy-erchek             pic x(600).
   327 01  filler.
   328     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   329     05  WS-CHECK-AMT-TMPX REDEFINES
   330         WS-CHECK-AMT-TMP        PIC X(10).
   331     05  ws-ind                     pic s9(4) comp value +0.
   332     05  ws-ind-red redefines ws-ind pic xx.
   333     05  ws-display-ind             pic s9(7) value zeros.
   334 01  ws-compare-erchek-key          pic x(33) value low-values.
   335 01  ws-eracct-sw                   pic x value ' '.
   336     88  eracct-found                 value 'Y'.
   337 01  ws-eracct-start-sw             pic x value ' '.
   338     88  eracct-start                 value 'Y'.
   339 01  WS-MISC-AREA.
   340     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   341     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   342     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   343
   344 01  ws-work-amt-alpha           pic x(10).
   345 01  ws-work-amt-num redefines ws-work-amt-alpha
   346                                 pic 9(8)v99.
   347 01  ws-user-defined.
   348     05  ws-user-reason         pic xxx.
   349     05  ws-user-cert-no        pic x(11).
   350     05  ws-user-name           pic x(28).
   351 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   352 01  STANDARD-AREAS.
   353     12  ws-connect-sw               pic x  value ' '.
   354         88  connected-to-db             value 'Y'.
   355     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   356     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   357     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   358     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   359     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   360     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   361     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   8
* EL677.cbl
   362     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   363     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   364     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   365     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   366     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   367     12  TIME-OUT-R  REDEFINES TIME-IN.
   368         16  FILLER                  PIC X.
   369         16  TIME-OUT                PIC 99V99.
   370         16  FILLER                  PIC XX.
   371     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   372     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   373     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   374     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   375     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   376     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   377     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   378     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   379     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   380     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   381     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   382     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   383     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   384     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   385     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   386     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   387     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   388     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   389     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   390     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   391     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   392     12  QID.
   393         16  QID-TERM                PIC X(4)    VALUE SPACES.
   394         16  FILLER                  PIC X(4)    VALUE '677A'.
   395
   396 01  WORK-AREAS.
   397     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   398     12  WS-AM-WK REDEFINES WS-AM-WORK.
   399         16  WS-AM-NUM               PIC S9(7)V99.
   400         16  WS-AM-SIGN              PIC X.
   401     12  WS-CHECK-WORK.
   402         16  FILLER                  PIC X        VALUE SPACE.
   403         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   404     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   405     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   406     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   407     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   408     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   409     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   410     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   411     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   412     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   413     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   414     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   415         WS-DT-DEEDIT-FIELD.
   416         16  FILLER                  PIC X(4).
   417         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   418     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   419     12  WS-DEEDIT-FIELD-V0          REDEFINES
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page   9
* EL677.cbl
   420         WS-DEEDIT-FIELD-A           PIC S9(15).
   421
   422     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   423     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   424         88 WS-CERT-FOUND                        VALUE 'Y'.
   425         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   426     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   427         88 WS-PNDB-FOUND                        VALUE 'Y'.
   428         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   429     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   430         88  WS-PROCESS-CERT                     VALUE 'Y'.
   431     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   432         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   433     12  WS-PY-ENTRY-COMMENT.
   434         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   435         16  FILLER                  PIC X(13)   VALUE
   436            ' MISC. CHECK '.
   437         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   438         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   439     12  WS-PY-REF-COMMENT.
   440         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   441         16  FILLER                  PIC X(13)   VALUE
   442            ' REFUND PYMT '.
   443         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   444         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   445     12  WS-PY-END-COMMENT.
   446         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   447         16  FILLER                  PIC X(13)   VALUE
   448            ' ENDORSEMENT '.
   449         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   450         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   451     12  WS-PY-DED-COMMENT.
   452         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   453         16  FILLER                  PIC X(13)   VALUE
   454            ' STAT DEDUCT '.
   455         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   456         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   457     12  WS-PY-ADDL-COMMENT.
   458         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   459         16  FILLER                  PIC X(13)   VALUE
   460            ' ADDL CHARGE '.
   461         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   462         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   463     12  WS-PY-REVERSAL-COMMENT.
   464         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   465         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   466            ' VOID REFUND '.
   467         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   468         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   469     12  WS-TMS-ENTRY-COMMENT.
   470         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   471         16  FILLER                  PIC XX      VALUE SPACES.
   472         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   473     12  WS-ZIP-CODE.
   474         16  WS-ZIP-PRIME.
   475             20  WS-ZIP-PRI-1ST      PIC X.
   476                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   477             20  FILLER              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  10
* EL677.cbl
   478         16  WS-ZIP-PLUS4            PIC X(4).
   479     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   480         16  WS-CAN-POST1-1          PIC XXX.
   481         16  WS-CAN-POST1-2.
   482             20  WS-CAN-POST-4TH     PIC X.
   483             20  FILLER              PIC XX.
   484         16  FILLER                  PIC XXX.
   485     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   486         16  WS-CAN-POST2-1          PIC XXX.
   487         16  FILLER                  PIC X.
   488         16  WS-CAN-POST2-2          PIC XXX.
   489         16  FILLER                  PIC XX.
   490
   491*                                    COPY ELCNWA.
   492*****************************************************************
   493*                                                               *
   494*                                                               *
   495*                            ELCNWA.                            *
   496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   497*                            VMOD=2.003                         *
   498*                                                               *
   499*            M O V E   N A M E   W O R K   A R E A.             *
   500*                                                               *
   501*****************************************************************.
   502
   503 01  WS-NAME-WORK-AREA.
   504     05  WS-INSURED-LAST-NAME        PIC X(15).
   505     05  WS-INSURED-1ST-NAME         PIC X(12).
   506     05  WS-INSURED-MID-INIT         PIC X.
   507
   508     05  WS-NAME-WORK.
   509         10  WS-NW                   PIC X
   510             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   511
   512     05  WS-NAME-WORK2.
   513         10  WS-NW2                  PIC X
   514             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   515                                        NWA-INDEX0.
   516
   517     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   518                                     COMP-3.
   519
   520 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   521     88  RESP-NORMAL                    VALUE +0.
   522     88  resp-file-notfnd               value +12.
   523     88  RESP-NOTFND                    VALUE +13.
   524     88  resp-duprec                    value +14.
   525     88  resp-dupkey                    value +15.
   526     88  resp-invreq                    value +16.
   527     88  RESP-NOTOPEN                   VALUE +19.
   528     88  RESP-ENDFILE                   VALUE +20.
   529     88  resp-lengtherr                 value +22.
   530 01  ACCESS-KEYS.
   531     12  ELCNTL-KEY.
   532         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   533         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   534         16 ELCNTL-ACCESS.
   535             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  11
* EL677.cbl
   536             20  FILLER              PIC X       VALUE SPACES.
   537             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   538         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   539
   540     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   541
   542     12  ERACCT-KEY.
   543         16  ERACCT-CO               PIC X       VALUE SPACES.
   544         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   545         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   546         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   547         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   548         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   549         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   550
   551     12  SAVE-ERACCT-KEY.
   552         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   553         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   554         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   555         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   556         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   557         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   558         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   559
   560     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   561
   562     12  ERCOMP-KEY.
   563         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   564         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   565         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   566         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   567         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   568         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   569
   570     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   571
   572     12  ELCERT-KEY.
   573         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   574         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   575         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   576         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   577         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   578         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   579         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   580         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   581
   582     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   583
   584     12  ERPNDB-PRIMARY-KEY.
   585         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   586         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   587         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   588         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   589
   590     12  ERPNDB-ALT-KEY.
   591         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   592         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   593         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  12
* EL677.cbl
   594         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   595         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   596         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   597         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   598         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   599         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   600         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   601
   602     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   603
   604     12  ERPNDM-PRIMARY-KEY.
   605         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   606         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   607         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   608         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   609
   610     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   611
   612     12  ERCHEK-KEY.
   613         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   614         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   615         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   616         16  CHEK-STATE              PIC XX      VALUE SPACES.
   617         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   618         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   619         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   620         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   621         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   622
   623     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   624     12  ERPYAJ-KEY.
   625         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   626         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   627         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   628         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   629         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   630         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   631         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   632
   633     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   634
   635 01  ERROR-NUMBERS.
   636     12  ER-0000                     PIC X(4)    VALUE '0000'.
   637     12  ER-0004                     PIC X(4)    VALUE '0004'.
   638     12  ER-0008                     PIC X(4)    VALUE '0008'.
   639     12  ER-0013                     PIC X(4)    VALUE '0013'.
   640     12  ER-0022                     PIC X(4)    VALUE '0022'.
   641     12  ER-0023                     PIC X(4)    VALUE '0023'.
   642     12  ER-0026                     PIC X(4)    VALUE '0026'.
   643     12  ER-0029                     PIC X(4)    VALUE '0029'.
   644     12  ER-0070                     PIC X(4)    VALUE '0070'.
   645     12  ER-0194                     PIC X(4)    VALUE '0194'.
   646     12  ER-0195                     PIC X(4)    VALUE '0195'.
   647     12  ER-0196                     PIC X(4)    VALUE '0196'.
   648     12  ER-0197                     PIC X(4)    VALUE '0197'.
   649     12  ER-0203                     PIC X(4)    VALUE '0203'.
   650     12  ER-0215                     PIC X(4)    VALUE '0215'.
   651     12  ER-0216                     PIC X(4)    VALUE '0216'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  13
* EL677.cbl
   652     12  ER-0433                     PIC X(4)    VALUE '0433'.
   653     12  ER-0565                     PIC X(4)    VALUE '0565'.
   654     12  ER-1159                     PIC X(4)    VALUE '1159'.
   655     12  ER-1162                     PIC X(4)    VALUE '1162'.
   656     12  ER-2056                     PIC X(4)    VALUE '2056'.
   657     12  ER-2208                     PIC X(4)    VALUE '2208'.
   658     12  ER-2209                     PIC X(4)    VALUE '2209'.
   659     12  ER-2210                     PIC X(4)    VALUE '2210'.
   660     12  ER-2230                     PIC X(4)    VALUE '2230'.
   661     12  ER-2237                     PIC X(4)    VALUE '2237'.
   662     12  ER-2238                     PIC X(4)    VALUE '2238'.
   663     12  ER-2294                     PIC X(4)    VALUE '2294'.
   664     12  ER-2394                     PIC X(4)    VALUE '2394'.
   665     12  ER-2438                     PIC X(4)    VALUE '2438'.
   666     12  ER-2439                     PIC X(4)    VALUE '2439'.
   667     12  ER-2583                     PIC X(4)    VALUE '2583'.
   668     12  ER-2600                     PIC X(4)    VALUE '2600'.
   669     12  ER-2726                     PIC X(4)    VALUE '2726'.
   670     12  ER-2905                     PIC X(4)    VALUE '2905'.
   671     12  ER-2906                     PIC X(4)    VALUE '2906'.
   672     12  ER-2907                     PIC X(4)    VALUE '2907'.
   673     12  ER-2908                     PIC X(4)    VALUE '2908'.
   674     12  ER-2909                     PIC X(4)    VALUE '2909'.
   675     12  ER-3044                     PIC X(4)    VALUE '3044'.
   676     12  ER-3046                     PIC X(4)    VALUE '3046'.
   677     12  ER-3047                     PIC X(4)    VALUE '3047'.
   678     12  ER-3445                     PIC X(4)    VALUE '3445'.
   679     12  er-3450                     pic x(4)    value '3450'.
   680     12  er-3451                     pic x(4)    value '3451'.
   681     12  er-3452                     pic x(4)    value '3452'.
   682     12  er-3453                     pic x(4)    value '3453'.
   683     12  er-3454                     pic x(4)    value '3454'.
   684     12  er-3455                     pic x(4)    value '3455'.
   685     12  er-3459                     pic x(4)    value '3459'.
   686     12  ER-7389                     PIC X(4)    VALUE '7389'.
   687     12  ER-9999                     PIC X(4)    VALUE '9999'.
   688*                                    COPY ELCLOGOF.
   689******************************************************************
   690*                                                                *
   691*                                                                *
   692*                            ELCLOGOF.                           *
   693*                            VMOD=2.001                          *
   694*                                                                *
   695*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   696*                                                                *
   697******************************************************************
   698 01  CLASIC-LOGOFF.
   699     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   700     12  LOGOFF-TEXT.
   701         16  FILLER          PIC X(5)    VALUE SPACES.
   702         16  LOGOFF-MSG.
   703             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   704             20  FILLER      PIC X       VALUE SPACES.
   705             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   706         16  FILLER          PIC X(80)
   707           VALUE '* YOU ARE NOW LOGGED OFF'.
   708         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   709         16  FILLER          PIC X       VALUE QUOTE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  14
* EL677.cbl
   710         16  LOGOFF-SYS-MSG  PIC X(17)
   711           VALUE 'S CLAS-IC SYSTEM '.
   712     12  TEXT-MESSAGES.
   713         16  UNACCESS-MSG    PIC X(29)
   714             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   715         16  PGMIDERR-MSG    PIC X(17)
   716             VALUE 'PROGRAM NOT FOUND'.
   717*                                    COPY ELCDATE.
   718******************************************************************
   719*                                                                *
   720*                                                                *
   721*                            ELCDATE.                            *
   722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   723*                            VMOD=2.003
   724*                                                                *
   725*                                                                *
   726*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   727*                 LENGTH = 200                                   *
   728******************************************************************
   729
   730 01  DATE-CONVERSION-DATA.
   731     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   732     12  DC-OPTION-CODE                PIC X.
   733         88  BIN-TO-GREG                VALUE ' '.
   734         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   735         88  EDIT-GREG-TO-BIN           VALUE '2'.
   736         88  YMD-GREG-TO-BIN            VALUE '3'.
   737         88  MDY-GREG-TO-BIN            VALUE '4'.
   738         88  JULIAN-TO-BIN              VALUE '5'.
   739         88  BIN-PLUS-ELAPSED           VALUE '6'.
   740         88  FIND-CENTURY               VALUE '7'.
   741         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   742         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   743         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   744         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   745         88  JULIAN-TO-BIN-3            VALUE 'C'.
   746         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   747         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   748         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   749         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   750         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   751         88  CHECK-LEAP-YEAR            VALUE 'H'.
   752         88  BIN-3-TO-GREG              VALUE 'I'.
   753         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   754         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   755         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   756         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   757         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   758         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   759         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   760         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   761         88  THREE-CHARACTER-BIN
   762                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   763         88  GREGORIAN-TO-BIN
   764                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   765         88  BIN-TO-GREGORIAN
   766                  VALUES ' ' '1' 'I' '8' 'G'.
   767         88  JULIAN-TO-BINARY
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  15
* EL677.cbl
   768                  VALUES '5' 'C' 'E' 'F'.
   769     12  DC-ERROR-CODE                 PIC X.
   770         88  NO-CONVERSION-ERROR        VALUE ' '.
   771         88  DATE-CONVERSION-ERROR
   772                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   773         88  DATE-IS-ZERO               VALUE '1'.
   774         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   775         88  DATE-IS-INVALID            VALUE '3'.
   776         88  DATE1-GREATER-DATE2        VALUE '4'.
   777         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   778         88  DATE-INVALID-OPTION        VALUE '9'.
   779         88  INVALID-CENTURY            VALUE 'A'.
   780         88  ONLY-CENTURY               VALUE 'B'.
   781         88  ONLY-LEAP-YEAR             VALUE 'C'.
   782         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   783     12  DC-END-OF-MONTH               PIC X.
   784         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   785     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   786         88  USE-NORMAL-PROCESS         VALUE ' '.
   787         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   788         88  ADJUST-UP-100-YRS          VALUE '2'.
   789     12  FILLER                        PIC X.
   790     12  DC-CONVERSION-DATES.
   791         16  DC-BIN-DATE-1             PIC XX.
   792         16  DC-BIN-DATE-2             PIC XX.
   793         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   794         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   795                       DC-GREG-DATE-1-EDIT.
   796             20  DC-EDIT1-MONTH        PIC 99.
   797             20  SLASH1-1              PIC X.
   798             20  DC-EDIT1-DAY          PIC 99.
   799             20  SLASH1-2              PIC X.
   800             20  DC-EDIT1-YEAR         PIC 99.
   801         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   802         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   803                     DC-GREG-DATE-2-EDIT.
   804             20  DC-EDIT2-MONTH        PIC 99.
   805             20  SLASH2-1              PIC X.
   806             20  DC-EDIT2-DAY          PIC 99.
   807             20  SLASH2-2              PIC X.
   808             20  DC-EDIT2-YEAR         PIC 99.
   809         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   810         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   811                     DC-GREG-DATE-1-YMD.
   812             20  DC-YMD-YEAR           PIC 99.
   813             20  DC-YMD-MONTH          PIC 99.
   814             20  DC-YMD-DAY            PIC 99.
   815         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   816         16  DC-GREG-DATE-1-MDY-R REDEFINES
   817                      DC-GREG-DATE-1-MDY.
   818             20  DC-MDY-MONTH          PIC 99.
   819             20  DC-MDY-DAY            PIC 99.
   820             20  DC-MDY-YEAR           PIC 99.
   821         16  DC-GREG-DATE-1-ALPHA.
   822             20  DC-ALPHA-MONTH        PIC X(10).
   823             20  DC-ALPHA-DAY          PIC 99.
   824             20  FILLER                PIC XX.
   825             20  DC-ALPHA-CENTURY.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  16
* EL677.cbl
   826                 24 DC-ALPHA-CEN-N     PIC 99.
   827             20  DC-ALPHA-YEAR         PIC 99.
   828         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   829         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   830         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   831         16  DC-JULIAN-DATE            PIC 9(05).
   832         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   833                                       PIC 9(05).
   834         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   835             20  DC-JULIAN-YEAR        PIC 99.
   836             20  DC-JULIAN-DAYS        PIC 999.
   837         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   838         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   839         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   840     12  DATE-CONVERSION-VARIBLES.
   841         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   842         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   843             20  FILLER                PIC 9(3).
   844             20  HOLD-CEN-1-CCYY.
   845                 24  HOLD-CEN-1-CC     PIC 99.
   846                 24  HOLD-CEN-1-YY     PIC 99.
   847             20  HOLD-CEN-1-MO         PIC 99.
   848             20  HOLD-CEN-1-DA         PIC 99.
   849         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   850             20  HOLD-CEN-1-R-MO       PIC 99.
   851             20  HOLD-CEN-1-R-DA       PIC 99.
   852             20  HOLD-CEN-1-R-CCYY.
   853                 24  HOLD-CEN-1-R-CC   PIC 99.
   854                 24  HOLD-CEN-1-R-YY   PIC 99.
   855             20  FILLER                PIC 9(3).
   856         16  HOLD-CENTURY-1-X.
   857             20  FILLER                PIC X(3)  VALUE SPACES.
   858             20  HOLD-CEN-1-X-CCYY.
   859                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   860                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   861             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   862             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   863         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   864             20  HOLD-CEN-1-R-X-MO     PIC XX.
   865             20  HOLD-CEN-1-R-X-DA     PIC XX.
   866             20  HOLD-CEN-1-R-X-CCYY.
   867                 24  HOLD-CEN-1-R-X-CC PIC XX.
   868                 24  HOLD-CEN-1-R-X-YY PIC XX.
   869             20  FILLER                PIC XXX.
   870         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   871         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   872         16  DC-JULIAN-DATE-1          PIC 9(07).
   873         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   874             20  DC-JULIAN-1-CCYY.
   875                 24  DC-JULIAN-1-CC    PIC 99.
   876                 24  DC-JULIAN-1-YR    PIC 99.
   877             20  DC-JULIAN-DA-1        PIC 999.
   878         16  DC-JULIAN-DATE-2          PIC 9(07).
   879         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   880             20  DC-JULIAN-2-CCYY.
   881                 24  DC-JULIAN-2-CC    PIC 99.
   882                 24  DC-JULIAN-2-YR    PIC 99.
   883             20  DC-JULIAN-DA-2        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  17
* EL677.cbl
   884         16  DC-GREG-DATE-A-EDIT.
   885             20  DC-EDITA-MONTH        PIC 99.
   886             20  SLASHA-1              PIC X VALUE '/'.
   887             20  DC-EDITA-DAY          PIC 99.
   888             20  SLASHA-2              PIC X VALUE '/'.
   889             20  DC-EDITA-CCYY.
   890                 24  DC-EDITA-CENT     PIC 99.
   891                 24  DC-EDITA-YEAR     PIC 99.
   892         16  DC-GREG-DATE-B-EDIT.
   893             20  DC-EDITB-MONTH        PIC 99.
   894             20  SLASHB-1              PIC X VALUE '/'.
   895             20  DC-EDITB-DAY          PIC 99.
   896             20  SLASHB-2              PIC X VALUE '/'.
   897             20  DC-EDITB-CCYY.
   898                 24  DC-EDITB-CENT     PIC 99.
   899                 24  DC-EDITB-YEAR     PIC 99.
   900         16  DC-GREG-DATE-CYMD         PIC 9(08).
   901         16  DC-GREG-DATE-CYMD-R REDEFINES
   902                              DC-GREG-DATE-CYMD.
   903             20  DC-CYMD-CEN           PIC 99.
   904             20  DC-CYMD-YEAR          PIC 99.
   905             20  DC-CYMD-MONTH         PIC 99.
   906             20  DC-CYMD-DAY           PIC 99.
   907         16  DC-GREG-DATE-MDCY         PIC 9(08).
   908         16  DC-GREG-DATE-MDCY-R REDEFINES
   909                              DC-GREG-DATE-MDCY.
   910             20  DC-MDCY-MONTH         PIC 99.
   911             20  DC-MDCY-DAY           PIC 99.
   912             20  DC-MDCY-CEN           PIC 99.
   913             20  DC-MDCY-YEAR          PIC 99.
   914    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   915        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   916    12  DC-EL310-DATE                  PIC X(21).
   917    12  FILLER                         PIC X(28).
   918*                                    COPY ELCATTR.
   919******************************************************************
   920*                                                                *
   921*                            ELCATTR.                            *
   922*                            VMOD=2.001                          *
   923*                                                                *
   924*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   925*                                                                *
   926*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   927*                                                                *
   928*                   POS 1   P=PROTECTED                          *
   929*                           U=UNPROTECTED                        *
   930*                           S=ASKIP                              *
   931*                   POS 2   A=ALPHA/NUMERIC                      *
   932*                           N=NUMERIC                            *
   933*                   POS 3   N=NORMAL                             *
   934*                           B=BRIGHT                             *
   935*                           D=DARK                               *
   936*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   937*                           OF=MODIFIED DATA TAG OFF             *
   938*                                                                *
   939*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   940******************************************************************
   941 01  ATTRIBUTE-LIST.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  18
* EL677.cbl
   942     12  AL-PABOF            PIC X       VALUE 'Y'.
   943     12  AL-PABON            PIC X       VALUE 'Z'.
   944     12  AL-PADOF            PIC X       VALUE '%'.
   945     12  AL-PADON            PIC X       VALUE '_'.
   946     12  AL-PANOF            PIC X       VALUE '-'.
   947     12  AL-PANON            PIC X       VALUE '/'.
   948     12  AL-SABOF            PIC X       VALUE '8'.
   949     12  AL-SABON            PIC X       VALUE '9'.
   950     12  AL-SADOF            PIC X       VALUE '@'.
   951     12  AL-SADON            PIC X       VALUE QUOTE.
   952     12  AL-SANOF            PIC X       VALUE '0'.
   953     12  AL-SANON            PIC X       VALUE '1'.
   954     12  AL-UABOF            PIC X       VALUE 'H'.
   955     12  AL-UABON            PIC X       VALUE 'I'.
   956     12  AL-UADOF            PIC X       VALUE '<'.
   957     12  AL-UADON            PIC X       VALUE '('.
   958     12  AL-UANOF            PIC X       VALUE ' '.
   959     12  AL-UANON            PIC X       VALUE 'A'.
   960     12  AL-UNBOF            PIC X       VALUE 'Q'.
   961     12  AL-UNBON            PIC X       VALUE 'R'.
   962     12  AL-UNDOF            PIC X       VALUE '*'.
   963     12  AL-UNDON            PIC X       VALUE ')'.
   964     12  AL-UNNOF            PIC X       VALUE '&'.
   965     12  AL-UNNON            PIC X       VALUE 'J'.
   966*                                    COPY ELCEMIB.
   967******************************************************************
   968*                                                                *
   969*                                                                *
   970*                            ELCEMIB.                            *
   971*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   972*                            VMOD=2.005                          *
   973*                                                                *
   974*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   975*                                                                *
   976******************************************************************
   977 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   978     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   979     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   980     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   981     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   982     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   983     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   984     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   985     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   986     12  EMI-SWITCH1             PIC X        VALUE '1'.
   987         88  EMI-NO-ERRORS                    VALUE '1'.
   988         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   989         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   990     12  EMI-SWITCH2             PIC X        VALUE '1'.
   991         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   992     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   993         88  EMI-AREA1-EMPTY                  VALUE '1'.
   994         88  EMI-AREA1-FULL                   VALUE '2'.
   995     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   996         88  EMI-AREA2-EMPTY                  VALUE '1'.
   997         88  EMI-AREA2-FULL                   VALUE '2'.
   998     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   999         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  19
* EL677.cbl
  1000         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1001         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1002         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1003         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1004     12  EMI-ERROR-LINES.
  1005         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1006         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1007         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1008         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1009             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1010                 24  EMI-ERR-NUM         PIC X(4).
  1011                 24  EMI-FILLER          PIC X.
  1012                 24  EMI-SEV             PIC X.
  1013                 24  FILLER              PIC X.
  1014             20  FILLER                  PIC X(02).
  1015     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1016         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1017             20  EMI-ERROR-NUMBER    PIC X(4).
  1018             20  EMI-FILL            PIC X.
  1019             20  EMI-SEVERITY        PIC X.
  1020             20  FILLER              PIC X.
  1021             20  EMI-ERROR-TEXT.
  1022                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1023                 24  FILLER          PIC X(55).
  1024     12  EMI-SEVERITY-SAVE           PIC X.
  1025         88  EMI-NOTE                    VALUE 'N'.
  1026         88  EMI-WARNING                 VALUE 'W'.
  1027         88  EMI-FORCABLE                VALUE 'F'.
  1028         88  EMI-FATAL                   VALUE 'X'.
  1029     12  EMI-MESSAGE-FLAG            PIC X.
  1030         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1031         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1032     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1033     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1034         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1035         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1036         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1037     12  emi-claim-no                pic x(7).
  1038     12  emi-claim-type              pic x(6).
  1039     12  FILLER                      PIC X(124)  VALUE SPACES.
  1040     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1041     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1042     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1043     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1044*                                    COPY ELCINTF.
  1045******************************************************************
  1046*                                                                *
  1047*                                                                *
  1048*                            ELCINTF.                            *
  1049*                            VMOD=2.017                          *
  1050*                                                                *
  1051*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1052*                                                                *
  1053*       LENGTH = 1024                                            *
  1054*                                                                *
  1055******************************************************************
  1056*                   C H A N G E   L O G
  1057*
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  20
* EL677.cbl
  1058* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1059*-----------------------------------------------------------------
  1060*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1061* EFFECTIVE    NUMBER
  1062*-----------------------------------------------------------------
  1063* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1064******************************************************************
  1065 01  PROGRAM-INTERFACE-BLOCK.
  1066     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1067     12  PI-CALLING-PROGRAM              PIC X(8).
  1068     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1069     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1070     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1071     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1072     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1073     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1074     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1075     12  PI-COMPANY-ID                   PIC XXX.
  1076     12  PI-COMPANY-CD                   PIC X.
  1077
  1078     12  PI-COMPANY-PASSWORD             PIC X(8).
  1079
  1080     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1081
  1082     12  PI-CONTROL-IN-PROGRESS.
  1083         16  PI-CARRIER                  PIC X.
  1084         16  PI-GROUPING                 PIC X(6).
  1085         16  PI-STATE                    PIC XX.
  1086         16  PI-ACCOUNT                  PIC X(10).
  1087         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1088                                         PIC X(10).
  1089         16  PI-CLAIM-CERT-GRP.
  1090             20  PI-CLAIM-NO             PIC X(7).
  1091             20  PI-CERT-NO.
  1092                 25  PI-CERT-PRIME       PIC X(10).
  1093                 25  PI-CERT-SFX         PIC X.
  1094             20  PI-CERT-EFF-DT          PIC XX.
  1095         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1096             20  PI-PLAN-CODE            PIC X(2).
  1097             20  PI-REVISION-NUMBER      PIC X(3).
  1098             20  PI-PLAN-EFF-DT          PIC X(2).
  1099             20  PI-PLAN-EXP-DT          PIC X(2).
  1100             20  FILLER                  PIC X(11).
  1101         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1102             20  PI-OE-REFERENCE-1.
  1103                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1104                 25  PI-OE-REF-1-SUFF    PIC XX.
  1105
  1106     12  PI-SESSION-IN-PROGRESS          PIC X.
  1107         88  CLAIM-SESSION                   VALUE '1'.
  1108         88  CREDIT-SESSION                  VALUE '2'.
  1109         88  WARRANTY-SESSION                VALUE '3'.
  1110         88  MORTGAGE-SESSION                VALUE '4'.
  1111         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1112
  1113
  1114*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1115
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  21
* EL677.cbl
  1116     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1117     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1118
  1119     12  PI-CREDIT-USER                  PIC X.
  1120         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1121         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1122
  1123     12  PI-CLAIM-USER                   PIC X.
  1124         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1125         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1126
  1127     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1128         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1129         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1130         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1131         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1132         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1133
  1134     12  PI-PROCESSOR-ID                 PIC X(4).
  1135
  1136     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1137
  1138     12  PI-MEMBER-CAPTION               PIC X(10).
  1139
  1140     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1141         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1142
  1143     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1144     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1145     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1146     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1147
  1148     12  PI-AH-OVERRIDE-L1               PIC X.
  1149     12  PI-AH-OVERRIDE-L2               PIC XX.
  1150     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1151     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1152
  1153     12  PI-NEW-SYSTEM                   PIC X(2).
  1154
  1155     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1156     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1157         88  PI-USES-PAID-TO                 VALUE '1'.
  1158     12  PI-CRDTCRD-SYSTEM.
  1159         16  PI-CRDTCRD-USER             PIC X.
  1160             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1161             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1162         16  PI-CC-MONTH-END-DT          PIC XX.
  1163     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1164
  1165     12  PI-OE-REFERENCE-2.
  1166         16  PI-OE-REF-2-PRIME           PIC X(10).
  1167         16  PI-OE-REF-2-SUFF            PIC X.
  1168
  1169     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1170
  1171     12  PI-LANGUAGE-TYPE                PIC X.
  1172             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1173             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  22
* EL677.cbl
  1174             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1175
  1176     12  PI-POLICY-LINKAGE-IND           PIC X.
  1177         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1178         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1179                                                   LOW-VALUES.
  1180
  1181     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1182     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1183         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1184         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1185
  1186     12  PI-PROCESSOR-CSR-IND            PIC X.
  1187         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1188         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1189
  1190     12  FILLER                          PIC X(3).
  1191
  1192     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1193
  1194     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1195         PI-SYSTEM-LEVEL.
  1196
  1197         16  PI-ENTRY-CODES.
  1198             20  PI-ENTRY-CD-1           PIC X.
  1199             20  PI-ENTRY-CD-2           PIC X.
  1200
  1201         16  PI-RETURN-CODES.
  1202             20  PI-RETURN-CD-1          PIC X.
  1203             20  PI-RETURN-CD-2          PIC X.
  1204
  1205         16  PI-UPDATE-STATUS-SAVE.
  1206             20  PI-UPDATE-BY            PIC X(4).
  1207             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1208
  1209         16  PI-LOWER-CASE-LETTERS       PIC X.
  1210             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1211
  1212*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1213*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1214*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1215
  1216         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1217             88  ST-ACCNT-CNTL               VALUE ' '.
  1218             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1219             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1220             88  ACCNT-CNTL                  VALUE '3'.
  1221             88  CARR-ACCNT-CNTL             VALUE '4'.
  1222
  1223         16  PI-PROCESSOR-CAP-LIST.
  1224             20  PI-SYSTEM-CONTROLS.
  1225                24 PI-SYSTEM-DISPLAY     PIC X.
  1226                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1227                24 PI-SYSTEM-MODIFY      PIC X.
  1228                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1229             20  FILLER                  PIC XX.
  1230             20  PI-DISPLAY-CAP          PIC X.
  1231                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  23
* EL677.cbl
  1232             20  PI-MODIFY-CAP           PIC X.
  1233                 88  MODIFY-CAP              VALUE 'Y'.
  1234             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1235                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1236             20  PI-FORCE-CAP            PIC X.
  1237                 88  FORCE-CAP               VALUE 'Y'.
  1238
  1239         16  PI-PROGRAM-CONTROLS.
  1240             20  PI-PGM-PRINT-OPT        PIC X.
  1241             20  PI-PGM-FORMAT-OPT       PIC X.
  1242             20  PI-PGM-PROCESS-OPT      PIC X.
  1243             20  PI-PGM-TOTALS-OPT       PIC X.
  1244
  1245         16  PI-HELP-INTERFACE.
  1246             20  PI-LAST-ERROR-NO        PIC X(4).
  1247             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1248
  1249         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1250             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1251
  1252         16  PI-CR-CONTROL-IN-PROGRESS.
  1253             20  PI-CR-CARRIER           PIC X.
  1254             20  PI-CR-GROUPING          PIC X(6).
  1255             20  PI-CR-STATE             PIC XX.
  1256             20  PI-CR-ACCOUNT           PIC X(10).
  1257             20  PI-CR-FIN-RESP          PIC X(10).
  1258             20  PI-CR-TYPE              PIC X.
  1259
  1260         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1261
  1262         16  PI-CR-MONTH-END-DT          PIC XX.
  1263
  1264         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1265             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1266             88  PI-ZERO-CARRIER             VALUE '1'.
  1267             88  PI-ZERO-GROUPING            VALUE '2'.
  1268             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1269
  1270         16  PI-CARRIER-SECURITY         PIC X.
  1271             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1272
  1273         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1274             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1275             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1276
  1277         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1278             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1279                                         INDEXED BY PI-ACCESS-NDX
  1280                                         PIC X.
  1281
  1282         16  PI-GA-BILLING-CONTROL       PIC X.
  1283             88  PI-GA-BILLING               VALUE '1'.
  1284
  1285         16  PI-MAIL-PROCESSING          PIC X.
  1286             88  PI-MAIL-YES                 VALUE 'Y'.
  1287
  1288         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1289
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  24
* EL677.cbl
  1290         16  PI-AR-SYSTEM.
  1291             20  PI-AR-PROCESSING-CNTL   PIC X.
  1292                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1293             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1294             20  PI-AR-MONTH-END-DT      PIC XX.
  1295
  1296         16  PI-MP-SYSTEM.
  1297             20  PI-MORTGAGE-USER            PIC X.
  1298                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1299                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1300             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1301                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1302                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1303                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1304                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1305                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1306             20  PI-MP-MONTH-END-DT          PIC XX.
  1307             20  PI-MP-REFERENCE-NO.
  1308                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1309                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1310
  1311         16  PI-LABEL-CONTROL            PIC X(01).
  1312             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1313             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1314
  1315         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1316             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1317
  1318         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1319             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1320             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1321
  1322         16  FILLER                      PIC X(14).
  1323
  1324     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1325******************************************************************
  1326     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1327         16  PI-EOF-SW               PIC X.
  1328             88  PI-FILE-EOF                     VALUE 'Y'.
  1329         16  PI-PREV-MAINT           PIC X.
  1330         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1331         16  PI-ERCHEK-KEY.
  1332             20  PI-CHEK-COMP-CD     PIC X.
  1333             20  PI-CHEK-CARRIER     PIC X.
  1334             20  PI-CHEK-GROUPING    PIC X(6).
  1335             20  PI-CHEK-STATE       PIC XX.
  1336             20  PI-CHEK-ACCOUNT     PIC X(10).
  1337             20  PI-CHEK-EFF-DT      PIC XX.
  1338             20  PI-CHEK-CERT-NO     PIC X(10).
  1339             20  PI-CHEK-SUF-NO      PIC X.
  1340             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1341         16  PI-ACCOUNT-ADDRESS.
  1342             20  PI-AM-NAME          PIC X(30).
  1343             20  PI-AM-ADDRS         PIC X(30).
  1344             20  PI-AM-CITY-st.
  1345                 24  pi-am-city      PIC X(28).
  1346                 24  pi-am-st        pic xx.
  1347             20  PI-AM-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  25
* EL677.cbl
  1348                 24  PI-AM-ZIP-PRIME PIC X(5).
  1349                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1350         16  PI-PROCESS-CERT-SW          PIC X.
  1351             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1352         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1353             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1354         16  PI-PAYTO1                   PIC X(30).
  1355         16  PI-REFERENCE                PIC X(12).
  1356         16  PI-CANC-DT                  PIC XX.
  1357         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1358         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1359         16  PI-INSURED-NAME             PIC X(28).
  1360         16  PI-PFKEY                    PIC XXX.
  1361             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1362             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1363         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1364         16  PI-TYPE                     PIC X.
  1365         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1366         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1367         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1368         16  pi-chek-rec-cnt             pic s999 comp-3.
  1369         16  pi-am-csr                   pic x(4).
  1370         16  pi-return-to                pic x(30).
  1371         16  pi-prev-ded-comm            pic x.
  1372         16  pi-table-name               pic x(30).
  1373         16  pi-check-cashed             pic x.
  1374         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1375         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1376         16  pi-check-type               pic x.
  1377             88  ws-corr-check              value 'C'.
  1378             88  ws-ref-check               value 'R'.
  1379         16  pi-check-cut                pic x.
  1380         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1381         16  FILLER                      PIC X(306). *> wass 311
  1382*                                    COPY ELCAID.
  1383******************************************************************
  1384*                                                                *
  1385*                            ELCAID.                             *
  1386*                            VMOD=2.001                          *
  1387*                                                                *
  1388*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1389*                                                                *
  1390*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1391*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1392******************************************************************
  1393
  1394 01  DFHAID.
  1395   02  DFHNULL   PIC  X  VALUE  ' '.
  1396   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1397   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1398   02  DFHPEN    PIC  X  VALUE  '='.
  1399   02  DFHOPID   PIC  X  VALUE  'W'.
  1400   02  DFHPA1    PIC  X  VALUE  '%'.
  1401   02  DFHPA2    PIC  X  VALUE  '>'.
  1402   02  DFHPA3    PIC  X  VALUE  ','.
  1403   02  DFHPF1    PIC  X  VALUE  '1'.
  1404   02  DFHPF2    PIC  X  VALUE  '2'.
  1405   02  DFHPF3    PIC  X  VALUE  '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  26
* EL677.cbl
  1406   02  DFHPF4    PIC  X  VALUE  '4'.
  1407   02  DFHPF5    PIC  X  VALUE  '5'.
  1408   02  DFHPF6    PIC  X  VALUE  '6'.
  1409   02  DFHPF7    PIC  X  VALUE  '7'.
  1410   02  DFHPF8    PIC  X  VALUE  '8'.
  1411   02  DFHPF9    PIC  X  VALUE  '9'.
  1412   02  DFHPF10   PIC  X  VALUE  ':'.
  1413   02  DFHPF11   PIC  X  VALUE  '#'.
  1414   02  DFHPF12   PIC  X  VALUE  '@'.
  1415   02  DFHPF13   PIC  X  VALUE  'A'.
  1416   02  DFHPF14   PIC  X  VALUE  'B'.
  1417   02  DFHPF15   PIC  X  VALUE  'C'.
  1418   02  DFHPF16   PIC  X  VALUE  'D'.
  1419   02  DFHPF17   PIC  X  VALUE  'E'.
  1420   02  DFHPF18   PIC  X  VALUE  'F'.
  1421   02  DFHPF19   PIC  X  VALUE  'G'.
  1422   02  DFHPF20   PIC  X  VALUE  'H'.
  1423   02  DFHPF21   PIC  X  VALUE  'I'.
  1424*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1425   02  DFHPF22   PIC  X  VALUE  '['.
  1426   02  DFHPF23   PIC  X  VALUE  '.'.
  1427   02  DFHPF24   PIC  X  VALUE  '<'.
  1428   02  DFHMSRE   PIC  X  VALUE  'X'.
  1429   02  DFHSTRF   PIC  X  VALUE  'h'.
  1430   02  DFHTRIG   PIC  X  VALUE  '"'.
  1431 01  FILLER    REDEFINES DFHAID.
  1432     12  FILLER                      PIC X(8).
  1433     12  PF-VALUES                   PIC X       OCCURS 24.
  1434     12  FILLER                      PIC X(3).
  1435*                                    COPY EL677S.
  1436 01  EL677AI.
  1437     05  FILLER            PIC  X(0012).
  1438*    -------------------------------
  1439     05  DATEL PIC S9(0004) COMP.
  1440     05  DATEF PIC  X(0001).
  1441     05  FILLER REDEFINES DATEF.
  1442         10  DATEA PIC  X(0001).
  1443     05  DATEI PIC  X(0008).
  1444*    -------------------------------
  1445     05  TIMEL PIC S9(0004) COMP.
  1446     05  TIMEF PIC  X(0001).
  1447     05  FILLER REDEFINES TIMEF.
  1448         10  TIMEA PIC  X(0001).
  1449     05  TIMEI PIC  X(0005).
  1450*    -------------------------------
  1451     05  MAINTL PIC S9(0004) COMP.
  1452     05  MAINTF PIC  X(0001).
  1453     05  FILLER REDEFINES MAINTF.
  1454         10  MAINTA PIC  X(0001).
  1455     05  MAINTI PIC  X(0001).
  1456*    -------------------------------
  1457     05  DMAINT1L PIC S9(0004) COMP.
  1458     05  DMAINT1F PIC  X(0001).
  1459     05  FILLER REDEFINES DMAINT1F.
  1460         10  DMAINT1A PIC  X(0001).
  1461     05  DMAINT1I PIC  X(0009).
  1462*    -------------------------------
  1463     05  DMAINT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  27
* EL677.cbl
  1464     05  DMAINT2F PIC  X(0001).
  1465     05  FILLER REDEFINES DMAINT2F.
  1466         10  DMAINT2A PIC  X(0001).
  1467     05  DMAINT2I PIC  X(0029).
  1468*    -------------------------------
  1469     05  CARRIERL PIC S9(0004) COMP.
  1470     05  CARRIERF PIC  X(0001).
  1471     05  FILLER REDEFINES CARRIERF.
  1472         10  CARRIERA PIC  X(0001).
  1473     05  CARRIERI PIC  X(0001).
  1474*    -------------------------------
  1475     05  GROUPL PIC S9(0004) COMP.
  1476     05  GROUPF PIC  X(0001).
  1477     05  FILLER REDEFINES GROUPF.
  1478         10  GROUPA PIC  X(0001).
  1479     05  GROUPI PIC  X(0006).
  1480*    -------------------------------
  1481     05  STATEL PIC S9(0004) COMP.
  1482     05  STATEF PIC  X(0001).
  1483     05  FILLER REDEFINES STATEF.
  1484         10  STATEA PIC  X(0001).
  1485     05  STATEI PIC  X(0002).
  1486*    -------------------------------
  1487     05  ACCTL PIC S9(0004) COMP.
  1488     05  ACCTF PIC  X(0001).
  1489     05  FILLER REDEFINES ACCTF.
  1490         10  ACCTA PIC  X(0001).
  1491     05  ACCTI PIC  X(0010).
  1492*    -------------------------------
  1493     05  EFFDTL PIC S9(0004) COMP.
  1494     05  EFFDTF PIC  X(0001).
  1495     05  FILLER REDEFINES EFFDTF.
  1496         10  EFFDTA PIC  X(0001).
  1497     05  EFFDTI PIC  X(0008).
  1498*    -------------------------------
  1499     05  CERTNOL PIC S9(0004) COMP.
  1500     05  CERTNOF PIC  X(0001).
  1501     05  FILLER REDEFINES CERTNOF.
  1502         10  CERTNOA PIC  X(0001).
  1503     05  CERTNOI PIC  X(0010).
  1504*    -------------------------------
  1505     05  SFXL PIC S9(0004) COMP.
  1506     05  SFXF PIC  X(0001).
  1507     05  FILLER REDEFINES SFXF.
  1508         10  SFXA PIC  X(0001).
  1509     05  SFXI PIC  X(0001).
  1510*    -------------------------------
  1511     05  SEQL PIC S9(0004) COMP.
  1512     05  SEQF PIC  X(0001).
  1513     05  FILLER REDEFINES SEQF.
  1514         10  SEQA PIC  X(0001).
  1515     05  SEQI PIC  99.
  1516*    -------------------------------
  1517     05  PAYTO1L PIC S9(0004) COMP.
  1518     05  PAYTO1F PIC  X(0001).
  1519     05  FILLER REDEFINES PAYTO1F.
  1520         10  PAYTO1A PIC  X(0001).
  1521     05  PAYTO1I PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  28
* EL677.cbl
  1522*    -------------------------------
  1523     05  CREATEDL PIC S9(0004) COMP.
  1524     05  CREATEDF PIC  X(0001).
  1525     05  FILLER REDEFINES CREATEDF.
  1526         10  CREATEDA PIC  X(0001).
  1527     05  CREATEDI PIC  X(0008).
  1528*    -------------------------------
  1529     05  CBYL PIC S9(0004) COMP.
  1530     05  CBYF PIC  X(0001).
  1531     05  FILLER REDEFINES CBYF.
  1532         10  CBYA PIC  X(0001).
  1533     05  CBYI PIC  X(0004).
  1534*    -------------------------------
  1535     05  PAYTO2L PIC S9(0004) COMP.
  1536     05  PAYTO2F PIC  X(0001).
  1537     05  FILLER REDEFINES PAYTO2F.
  1538         10  PAYTO2A PIC  X(0001).
  1539     05  PAYTO2I PIC  X(0030).
  1540*    -------------------------------
  1541     05  PAYEEL PIC S9(0004) COMP.
  1542     05  PAYEEF PIC  X(0001).
  1543     05  FILLER REDEFINES PAYEEF.
  1544         10  PAYEEA PIC  X(0001).
  1545     05  PAYEEI PIC  X(0006).
  1546*    -------------------------------
  1547     05  APVSTATL PIC S9(0004) COMP.
  1548     05  APVSTATF PIC  X(0001).
  1549     05  FILLER REDEFINES APVSTATF.
  1550         10  APVSTATA PIC  X(0001).
  1551     05  APVSTATI PIC  X(0009).
  1552*    -------------------------------
  1553     05  PAYAD1L PIC S9(0004) COMP.
  1554     05  PAYAD1F PIC  X(0001).
  1555     05  FILLER REDEFINES PAYAD1F.
  1556         10  PAYAD1A PIC  X(0001).
  1557     05  PAYAD1I PIC  X(0030).
  1558*    -------------------------------
  1559     05  APVDTL PIC S9(0004) COMP.
  1560     05  APVDTF PIC  X(0001).
  1561     05  FILLER REDEFINES APVDTF.
  1562         10  APVDTA PIC  X(0001).
  1563     05  APVDTI PIC  X(0008).
  1564*    -------------------------------
  1565     05  APVBYL PIC S9(0004) COMP.
  1566     05  APVBYF PIC  X(0001).
  1567     05  FILLER REDEFINES APVBYF.
  1568         10  APVBYA PIC  X(0001).
  1569     05  APVBYI PIC  X(0004).
  1570*    -------------------------------
  1571     05  PAYAD2L PIC S9(0004) COMP.
  1572     05  PAYAD2F PIC  X(0001).
  1573     05  FILLER REDEFINES PAYAD2F.
  1574         10  PAYAD2A PIC  X(0001).
  1575     05  PAYAD2I PIC  X(0030).
  1576*    -------------------------------
  1577     05  VOIDEDL PIC S9(0004) COMP.
  1578     05  VOIDEDF PIC  X(0001).
  1579     05  FILLER REDEFINES VOIDEDF.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  29
* EL677.cbl
  1580         10  VOIDEDA PIC  X(0001).
  1581     05  VOIDEDI PIC  X(0008).
  1582*    -------------------------------
  1583     05  VBYL PIC S9(0004) COMP.
  1584     05  VBYF PIC  X(0001).
  1585     05  FILLER REDEFINES VBYF.
  1586         10  VBYA PIC  X(0001).
  1587     05  VBYI PIC  X(0004).
  1588*    -------------------------------
  1589     05  PAYCTYL PIC S9(0004) COMP.
  1590     05  PAYCTYF PIC  X(0001).
  1591     05  FILLER REDEFINES PAYCTYF.
  1592         10  PAYCTYA PIC  X(0001).
  1593     05  PAYCTYI PIC  X(0028).
  1594*    -------------------------------
  1595     05  PAYSTL PIC S9(0004) COMP.
  1596     05  PAYSTF PIC  X(0001).
  1597     05  FILLER REDEFINES PAYSTF.
  1598         10  PAYSTA PIC  X(0001).
  1599     05  PAYSTI PIC  X(0002).
  1600*    -------------------------------
  1601     05  PRINTEDL PIC S9(0004) COMP.
  1602     05  PRINTEDF PIC  X(0001).
  1603     05  FILLER REDEFINES PRINTEDF.
  1604         10  PRINTEDA PIC  X(0001).
  1605     05  PRINTEDI PIC  X(0008).
  1606*    -------------------------------
  1607     05  PTOZIPL PIC S9(0004) COMP.
  1608     05  PTOZIPF PIC  X(0001).
  1609     05  FILLER REDEFINES PTOZIPF.
  1610         10  PTOZIPA PIC  X(0001).
  1611     05  PTOZIPI PIC  X(0009).
  1612*    -------------------------------
  1613     05  DEDCYNL PIC S9(0004) COMP.
  1614     05  DEDCYNF PIC  X(0001).
  1615     05  FILLER REDEFINES DEDCYNF.
  1616         10  DEDCYNA PIC  X(0001).
  1617     05  DEDCYNI PIC  X(0001).
  1618*    -------------------------------
  1619     05  CASHEDL PIC S9(0004) COMP.
  1620     05  CASHEDF PIC  X(0001).
  1621     05  FILLER REDEFINES CASHEDF.
  1622         10  CASHEDA PIC  X(0001).
  1623     05  CASHEDI PIC  X(0008).
  1624*    -------------------------------
  1625     05  RETTOL PIC S9(0004) COMP.
  1626     05  RETTOF PIC  X(0001).
  1627     05  FILLER REDEFINES RETTOF.
  1628         10  RETTOA PIC  X(0001).
  1629     05  RETTOI PIC  X(0030).
  1630*    -------------------------------
  1631     05  DPREML PIC S9(0004) COMP.
  1632     05  DPREMF PIC  X(0001).
  1633     05  FILLER REDEFINES DPREMF.
  1634         10  DPREMA PIC  X(0001).
  1635     05  DPREMI PIC  X(0005).
  1636*    -------------------------------
  1637     05  PREML PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  30
* EL677.cbl
  1638     05  PREMF PIC  X(0001).
  1639     05  FILLER REDEFINES PREMF.
  1640         10  PREMA PIC  X(0001).
  1641     05  PREMI PIC  X(0008).
  1642*    -------------------------------
  1643     05  DCOMML PIC S9(0004) COMP.
  1644     05  DCOMMF PIC  X(0001).
  1645     05  FILLER REDEFINES DCOMMF.
  1646         10  DCOMMA PIC  X(0001).
  1647     05  DCOMMI PIC  X(0005).
  1648*    -------------------------------
  1649     05  ISSCOMML PIC S9(0004) COMP.
  1650     05  ISSCOMMF PIC  X(0001).
  1651     05  FILLER REDEFINES ISSCOMMF.
  1652         10  ISSCOMMA PIC  X(0001).
  1653     05  ISSCOMMI PIC  X(0008).
  1654*    -------------------------------
  1655     05  DREFL PIC S9(0004) COMP.
  1656     05  DREFF PIC  X(0001).
  1657     05  FILLER REDEFINES DREFF.
  1658         10  DREFA PIC  X(0001).
  1659     05  DREFI PIC  X(0004).
  1660*    -------------------------------
  1661     05  REFL PIC S9(0004) COMP.
  1662     05  REFF PIC  X(0001).
  1663     05  FILLER REDEFINES REFF.
  1664         10  REFA PIC  X(0001).
  1665     05  REFI PIC  X(0008).
  1666*    -------------------------------
  1667     05  DUECOMML PIC S9(0004) COMP.
  1668     05  DUECOMMF PIC  X(0001).
  1669     05  FILLER REDEFINES DUECOMMF.
  1670         10  DUECOMMA PIC  X(0001).
  1671     05  DUECOMMI PIC  X(0007).
  1672*    -------------------------------
  1673     05  UECOMML PIC S9(0004) COMP.
  1674     05  UECOMMF PIC  X(0001).
  1675     05  FILLER REDEFINES UECOMMF.
  1676         10  UECOMMA PIC  X(0001).
  1677     05  UECOMMI PIC  X(0008).
  1678*    -------------------------------
  1679     05  DPREPDL PIC S9(0004) COMP.
  1680     05  DPREPDF PIC  X(0001).
  1681     05  FILLER REDEFINES DPREPDF.
  1682         10  DPREPDA PIC  X(0001).
  1683     05  DPREPDI PIC  X(0006).
  1684*    -------------------------------
  1685     05  PREPDL PIC S9(0004) COMP.
  1686     05  PREPDF PIC  X(0001).
  1687     05  FILLER REDEFINES PREPDF.
  1688         10  PREPDA PIC  X(0001).
  1689     05  PREPDI PIC  X(0008).
  1690*    -------------------------------
  1691     05  AMOUNTL PIC S9(0004) COMP.
  1692     05  AMOUNTF PIC  X(0001).
  1693     05  FILLER REDEFINES AMOUNTF.
  1694         10  AMOUNTA PIC  X(0001).
  1695     05  AMOUNTI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  31
* EL677.cbl
  1696*    -------------------------------
  1697     05  CHECKL PIC S9(0004) COMP.
  1698     05  CHECKF PIC  X(0001).
  1699     05  FILLER REDEFINES CHECKF.
  1700         10  CHECKA PIC  X(0001).
  1701     05  CHECKI PIC  X(0007).
  1702*    -------------------------------
  1703     05  TYPEL PIC S9(0004) COMP.
  1704     05  TYPEF PIC  X(0001).
  1705     05  FILLER REDEFINES TYPEF.
  1706         10  TYPEA PIC  X(0001).
  1707     05  TYPEI PIC  X(0001).
  1708*    -------------------------------
  1709     05  REASONL PIC S9(0004) COMP.
  1710     05  REASONF PIC  X(0001).
  1711     05  FILLER REDEFINES REASONF.
  1712         10  REASONA PIC  X(0001).
  1713     05  REASONI PIC  X(0025).
  1714*    -------------------------------
  1715     05  VREASONL PIC S9(0004) COMP.
  1716     05  VREASONF PIC  X(0001).
  1717     05  FILLER REDEFINES VREASONF.
  1718         10  VREASONA PIC  X(0001).
  1719     05  VREASONI PIC  X(0024).
  1720*    -------------------------------
  1721     05  STUBL PIC S9(0004) COMP.
  1722     05  STUBF PIC  X(0001).
  1723     05  FILLER REDEFINES STUBF.
  1724         10  STUBA PIC  X(0001).
  1725     05  STUBI PIC  X(0030).
  1726*    -------------------------------
  1727     05  TEXT1L PIC S9(0004) COMP.
  1728     05  TEXT1F PIC  X(0001).
  1729     05  FILLER REDEFINES TEXT1F.
  1730         10  TEXT1A PIC  X(0001).
  1731     05  TEXT1I PIC  X(0050).
  1732*    -------------------------------
  1733     05  TEXT2L PIC S9(0004) COMP.
  1734     05  TEXT2F PIC  X(0001).
  1735     05  FILLER REDEFINES TEXT2F.
  1736         10  TEXT2A PIC  X(0001).
  1737     05  TEXT2I PIC  X(0050).
  1738*    -------------------------------
  1739     05  TEXT3L PIC S9(0004) COMP.
  1740     05  TEXT3F PIC  X(0001).
  1741     05  FILLER REDEFINES TEXT3F.
  1742         10  TEXT3A PIC  X(0001).
  1743     05  TEXT3I PIC  X(0040).
  1744*    -------------------------------
  1745     05  ERRMSG1L PIC S9(0004) COMP.
  1746     05  ERRMSG1F PIC  X(0001).
  1747     05  FILLER REDEFINES ERRMSG1F.
  1748         10  ERRMSG1A PIC  X(0001).
  1749     05  ERRMSG1I PIC  X(0079).
  1750*    -------------------------------
  1751     05  ERRMSG2L PIC S9(0004) COMP.
  1752     05  ERRMSG2F PIC  X(0001).
  1753     05  FILLER REDEFINES ERRMSG2F.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  32
* EL677.cbl
  1754         10  ERRMSG2A PIC  X(0001).
  1755     05  ERRMSG2I PIC  X(0079).
  1756*    -------------------------------
  1757     05  PFENTERL PIC S9(0004) COMP.
  1758     05  PFENTERF PIC  X(0001).
  1759     05  FILLER REDEFINES PFENTERF.
  1760         10  PFENTERA PIC  X(0001).
  1761     05  PFENTERI PIC  9(2).
  1762*    -------------------------------
  1763     05  PF357L PIC S9(0004) COMP.
  1764     05  PF357F PIC  X(0001).
  1765     05  FILLER REDEFINES PF357F.
  1766         10  PF357A PIC  X(0001).
  1767     05  PF357I PIC  X(0050).
  1768*    -------------------------------
  1769     05  PF46L PIC S9(0004) COMP.
  1770     05  PF46F PIC  X(0001).
  1771     05  FILLER REDEFINES PF46F.
  1772         10  PF46A PIC  X(0001).
  1773     05  PF46I PIC  X(0033).
  1774 01  EL677AO REDEFINES EL677AI.
  1775     05  FILLER            PIC  X(0012).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  DATEO PIC  X(0008).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  TIMEO PIC  99.99.
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  MAINTO PIC  X(0001).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  DMAINT1O PIC  X(0009).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  DMAINT2O PIC  X(0029).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  CARRIERO PIC  X(0001).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  GROUPO PIC  X(0006).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  STATEO PIC  X(0002).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  ACCTO PIC  X(0010).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  EFFDTO PIC  99B99B99.
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  CERTNOO PIC  X(0010).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  SFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  33
* EL677.cbl
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  SEQO PIC  99.
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  PAYTO1O PIC  X(0030).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  CREATEDO PIC  X(0008).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  CBYO PIC  X(0004).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  PAYTO2O PIC  X(0030).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  PAYEEO PIC  X(0006).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  APVSTATO PIC  X(0009).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  PAYAD1O PIC  X(0030).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  APVDTO PIC  X(0008).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  APVBYO PIC  X(0004).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  PAYAD2O PIC  X(0030).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  VOIDEDO PIC  X(0008).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  VBYO PIC  X(0004).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  PAYCTYO PIC  X(0028).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  PAYSTO PIC  X(0002).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  PRINTEDO PIC  99B99B99.
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  PTOZIPO PIC  X(0009).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  DEDCYNO PIC  X(0001).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  CASHEDO PIC  X(0008).
  1869*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  34
* EL677.cbl
  1870     05  FILLER            PIC  X(0003).
  1871     05  RETTOO PIC  X(0030).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  DPREMO PIC  X(0005).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  PREMO PIC  Z(5).99.
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  DCOMMO PIC  X(0005).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  ISSCOMMO PIC  Z(5).99.
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  DREFO PIC  X(0004).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  REFO PIC  Z(5).99.
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  DUECOMMO PIC  X(0007).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  UECOMMO PIC  Z(5).99.
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  DPREPDO PIC  X(0006).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  PREPDO PIC  Z(5).99.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  AMOUNTO PIC  Z(7).ZZ-.
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  CHECKO PIC  X(0007).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  TYPEO PIC  X(0001).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  REASONO PIC  X(0025).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  VREASONO PIC  X(0024).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  STUBO PIC  X(0030).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  TEXT1O PIC  X(0050).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  TEXT2O PIC  X(0050).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  35
* EL677.cbl
  1928     05  TEXT3O PIC  X(0040).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  ERRMSG1O PIC  X(0079).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  ERRMSG2O PIC  X(0079).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  PFENTERO PIC  99.
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  PF357O PIC  X(0050).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  PF46O PIC  X(0033).
  1944*    -------------------------------
  1945****************************************************************
  1946*
  1947* Copyright (c) 2007 by Clerity Solutions, Inc.
  1948* All rights reserved.
  1949*
  1950****************************************************************
  1951 01  DFHEIV.
  1952   02  DFHEIV0               PIC X(35).
  1953   02  DFHEIV1               PIC X(08).
  1954   02  DFHEIV2               PIC X(08).
  1955   02  DFHEIV3               PIC X(08).
  1956   02  DFHEIV4               PIC X(06).
  1957   02  DFHEIV5               PIC X(04).
  1958   02  DFHEIV6               PIC X(04).
  1959   02  DFHEIV7               PIC X(02).
  1960   02  DFHEIV8               PIC X(02).
  1961   02  DFHEIV9               PIC X(01).
  1962   02  DFHEIV10              PIC S9(7) COMP-3.
  1963   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1964   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1965   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1966   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1967   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1968   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1969   02  DFHEIV17              PIC X(04).
  1970   02  DFHEIV18              PIC X(04).
  1971   02  DFHEIV19              PIC X(04).
  1972   02  DFHEIV20              USAGE IS POINTER.
  1973   02  DFHEIV21              USAGE IS POINTER.
  1974   02  DFHEIV22              USAGE IS POINTER.
  1975   02  DFHEIV23              USAGE IS POINTER.
  1976   02  DFHEIV24              USAGE IS POINTER.
  1977   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1978   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1979   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1980   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1981   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1982   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1983   02  FILLER                PIC X(02).
  1984   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1985   02  DFHEIVL0              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  36
* EL677.cbl
  1986   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1987   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1988   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1989 LINKAGE  SECTION.
  1990*****************************************************************
  1991*                                                               *
  1992* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1993* All rights reserved.                                          *
  1994*                                                               *
  1995*****************************************************************
  1996 01  dfheiblk.
  1997     02  eibtime          pic s9(7) comp-3.
  1998     02  eibdate          pic s9(7) comp-3.
  1999     02  eibtrnid         pic x(4).
  2000     02  eibtaskn         pic s9(7) comp-3.
  2001     02  eibtrmid         pic x(4).
  2002     02  dfheigdi         pic s9(4) comp.
  2003     02  eibcposn         pic s9(4) comp.
  2004     02  eibcalen         pic s9(4) comp.
  2005     02  eibaid           pic x(1).
  2006     02  eibfiller1       pic x(1).
  2007     02  eibfn            pic x(2).
  2008     02  eibfiller2       pic x(2).
  2009     02  eibrcode         pic x(6).
  2010     02  eibfiller3       pic x(2).
  2011     02  eibds            pic x(8).
  2012     02  eibreqid         pic x(8).
  2013     02  eibrsrce         pic x(8).
  2014     02  eibsync          pic x(1).
  2015     02  eibfree          pic x(1).
  2016     02  eibrecv          pic x(1).
  2017     02  eibsend          pic x(1).
  2018     02  eibatt           pic x(1).
  2019     02  eibeoc           pic x(1).
  2020     02  eibfmh           pic x(1).
  2021     02  eibcompl         pic x(1).
  2022     02  eibsig           pic x(1).
  2023     02  eibconf          pic x(1).
  2024     02  eiberr           pic x(1).
  2025     02  eibrldbk         pic x(1).
  2026     02  eiberrcd         pic x(4).
  2027     02  eibsynrb         pic x(1).
  2028     02  eibnodat         pic x(1).
  2029     02  eibfiller5       pic x(2).
  2030     02  eibresp          pic 9(09) comp.
  2031     02  eibresp2         pic 9(09) comp.
  2032     02  dfheigdj         pic s9(4) comp.
  2033     02  dfheigdk         pic s9(4) comp.
  2034 01  DFHCOMMAREA.
  2035     05  filler                  PIC X(1024).
  2036 01  var  pic x(30).
  2037*                                    COPY ELCCNTL.
  2038******************************************************************
  2039*                                                                *
  2040*                                                                *
  2041*                            ELCCNTL.                            *
  2042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2043*                            VMOD=2.059                          *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  37
* EL677.cbl
  2044*                                                                *
  2045*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2046*                                                                *
  2047*   FILE TYPE = VSAM,KSDS                                        *
  2048*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2049*                                                                *
  2050*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2051*       ALTERNATE INDEX = NONE                                   *
  2052*                                                                *
  2053*   LOG = YES                                                    *
  2054*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2055******************************************************************
  2056*                   C H A N G E   L O G
  2057*
  2058* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2059*-----------------------------------------------------------------
  2060*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2061* EFFECTIVE    NUMBER
  2062*-----------------------------------------------------------------
  2063* 082503                   PEMA  ADD BENEFIT GROUP
  2064* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2065* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2066* 092705    2005050300006  PEMA  ADD SPP LEASES
  2067* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2068* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2069* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2070* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2071* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2072* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2073* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2074* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2075* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2076* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2077******************************************************************
  2078*
  2079 01  CONTROL-FILE.
  2080     12  CF-RECORD-ID                       PIC XX.
  2081         88  VALID-CF-ID                        VALUE 'CF'.
  2082
  2083     12  CF-CONTROL-PRIMARY.
  2084         16  CF-COMPANY-ID                  PIC XXX.
  2085         16  CF-RECORD-TYPE                 PIC X.
  2086             88  CF-COMPANY-MASTER              VALUE '1'.
  2087             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2088             88  CF-STATE-MASTER                VALUE '3'.
  2089             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2090             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2091             88  CF-CARRIER-MASTER              VALUE '6'.
  2092             88  CF-MORTALITY-MASTER            VALUE '7'.
  2093             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2094             88  CF-TERMINAL-MASTER             VALUE '9'.
  2095             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2096             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2097             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2098             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2099             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2100             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2101             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  38
* EL677.cbl
  2102             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2103             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2104         16  CF-ACCESS-CD-GENL              PIC X(4).
  2105         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2106             20  CF-PROCESSOR               PIC X(4).
  2107         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2108             20  CF-STATE-CODE              PIC XX.
  2109             20  FILLER                     PIC XX.
  2110         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2111             20  FILLER                     PIC XX.
  2112             20  CF-HI-BEN-IN-REC           PIC XX.
  2113         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2114             20  FILLER                     PIC XXX.
  2115             20  CF-CARRIER-CNTL            PIC X.
  2116         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2117             20  FILLER                     PIC XX.
  2118             20  CF-HI-TYPE-IN-REC          PIC 99.
  2119         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2120             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2121                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2122             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2123             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2124         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2125             20  FILLER                     PIC X.
  2126             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2127         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2128             20  FILLER                     PIC XX.
  2129             20  CF-MORTGAGE-PLAN           PIC XX.
  2130         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2131
  2132     12  CF-LAST-MAINT-DT                   PIC XX.
  2133     12  CF-LAST-MAINT-BY                   PIC X(4).
  2134     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2135
  2136     12  CF-RECORD-BODY                     PIC X(728).
  2137
  2138
  2139****************************************************************
  2140*             COMPANY MASTER RECORD                            *
  2141****************************************************************
  2142
  2143     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2144         16  CF-COMPANY-ADDRESS.
  2145             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2146             20  CF-CL-IN-CARE-OF           PIC X(30).
  2147             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2148             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2149             20  CF-CL-CITY-STATE           PIC X(30).
  2150             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2151             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2152         16  CF-COMPANY-CD                  PIC X.
  2153         16  CF-COMPANY-PASSWORD            PIC X(8).
  2154         16  CF-SECURITY-OPTION             PIC X.
  2155             88  ALL-SECURITY                   VALUE '1'.
  2156             88  COMPANY-VERIFY                 VALUE '2'.
  2157             88  PROCESSOR-VERIFY               VALUE '3'.
  2158             88  NO-SECURITY                    VALUE '4'.
  2159             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  39
* EL677.cbl
  2160         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2161             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2162         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2163             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2164         16  CF-INFORCE-LOCATION            PIC X.
  2165             88  CERTS-ARE-ONLINE               VALUE '1'.
  2166             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2167             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2168         16  CF-LOWER-CASE-LETTERS          PIC X.
  2169         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2170             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2171             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2172             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2173             88  CF-ACCNT-CNTL                  VALUE '3'.
  2174             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2175
  2176         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2177         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2178
  2179         16  CF-LGX-CREDIT-USER             PIC X.
  2180             88  CO-IS-NOT-USER                 VALUE 'N'.
  2181             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2182
  2183         16 CF-CREDIT-CALC-CODES.
  2184             20  CF-CR-REM-TERM-CALC PIC X.
  2185               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2186               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2187               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2188               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2189               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2190               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2191               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2192             20  CF-CR-R78-METHOD           PIC X.
  2193               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2194               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2195
  2196         16  CF-CLAIM-CONTROL-COUNTS.
  2197             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2198                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2199
  2200             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2201                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2202
  2203             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2204                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2205
  2206             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2207                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2208
  2209         16  CF-CURRENT-MONTH-END           PIC XX.
  2210
  2211         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2212             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2213             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2214             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2215             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2216                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2217                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  40
* EL677.cbl
  2218             20  CF-CO-PREM-REJECT-SW       PIC X.
  2219                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2220                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2221             20  CF-CO-REF-REJECT-SW        PIC X.
  2222                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2223                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2224
  2225         16  CF-CO-REPORTING-DT             PIC XX.
  2226         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2227         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2228           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2229           88  CF-CO-MONTH-END                  VALUE '1'.
  2230
  2231         16  CF-LGX-CLAIM-USER              PIC X.
  2232             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2233             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2234
  2235         16  CF-CREDIT-EDIT-CONTROLS.
  2236             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2237             20  CF-MIN-AGE                 PIC 99.
  2238             20  CF-DEFAULT-AGE             PIC 99.
  2239             20  CF-MIN-TERM                PIC S999      COMP-3.
  2240             20  CF-MAX-TERM                PIC S999      COMP-3.
  2241             20  CF-DEFAULT-SEX             PIC X.
  2242             20  CF-JOINT-AGE-INPUT         PIC X.
  2243                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2244             20  CF-BIRTH-DATE-INPUT        PIC X.
  2245                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2246             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2247                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2248                 88  CF-ZERO-CARRIER            VALUE '1'.
  2249                 88  CF-ZERO-GROUPING           VALUE '2'.
  2250                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2251             20  CF-EDIT-SW                 PIC X.
  2252                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2253             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2254             20  CF-CR-PR-METHOD            PIC X.
  2255               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2256               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2257             20  FILLER                     PIC X.
  2258
  2259         16  CF-CREDIT-MISC-CONTROLS.
  2260             20  CF-REIN-TABLE-SW           PIC X.
  2261                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2262             20  CF-COMP-TABLE-SW           PIC X.
  2263                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2264             20  CF-EXPERIENCE-RETENTION-AGE
  2265                                            PIC S9        COMP-3.
  2266             20  CF-CONVERSION-DT           PIC XX.
  2267             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2268             20  CF-RUN-FREQUENCY-SW        PIC X.
  2269                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2270                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2271
  2272             20  CF-CR-CHECK-NO-CONTROL.
  2273                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2274                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2275                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  41
* EL677.cbl
  2276                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2277                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2278                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2279
  2280                 24  CF-CR-CHECK-COUNT       REDEFINES
  2281                     CF-CR-CHECK-COUNTER      PIC X(4).
  2282
  2283                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2284                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2285
  2286                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2287                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2288                 24  CF-MAIL-PROCESSING       PIC X.
  2289                     88  MAIL-PROCESSING          VALUE 'Y'.
  2290
  2291         16  CF-MISC-SYSTEM-CONTROL.
  2292             20  CF-SYSTEM-C                 PIC X.
  2293                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2294             20  CF-SYSTEM-D                 PIC X.
  2295                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2296             20  CF-SOC-SEC-NO-SW            PIC X.
  2297                 88  SOC-SEC-NO-USED             VALUE '1'.
  2298             20  CF-MEMBER-NO-SW             PIC X.
  2299                 88  MEMBER-NO-USED              VALUE '1'.
  2300             20  CF-TAX-ID-NUMBER            PIC X(11).
  2301             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2302             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2303                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2304                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2305                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2306                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2307             20  CF-SYSTEM-E                 PIC X.
  2308                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2309
  2310         16  CF-LGX-LIFE-USER               PIC X.
  2311             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2312             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2313
  2314         16  CF-CR-MONTH-END-DT             PIC XX.
  2315
  2316         16  CF-FILE-MAINT-DATES.
  2317             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2318                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2319             20  CF-LAST-BATCH       REDEFINES
  2320                 CF-LAST-BATCH-NO               PIC X(4).
  2321             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2322             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2323             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2324             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2325             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2326             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2327             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2328             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2329             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2330             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2331
  2332         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2333         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  42
* EL677.cbl
  2334
  2335         16  CF-ALT-MORT-CODE               PIC X(4).
  2336         16  CF-MEMBER-CAPTION              PIC X(10).
  2337
  2338         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2339             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2340             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2341             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2342             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2343             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2344
  2345         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2346
  2347         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2348         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2349         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2350         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2351
  2352         16  CF-AH-OVERRIDE-L1              PIC X.
  2353         16  CF-AH-OVERRIDE-L2              PIC XX.
  2354         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2355         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2356
  2357         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2358         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2359
  2360         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2361         16  CF-AR-LAST-EL860-DT            PIC XX.
  2362         16  CF-MP-MONTH-END-DT             PIC XX.
  2363
  2364         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2365         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2366             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2367
  2368         16  CF-AR-MONTH-END-DT             PIC XX.
  2369
  2370         16  CF-CRDTCRD-USER                PIC X.
  2371             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2372             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2373
  2374         16  CF-CC-MONTH-END-DT             PIC XX.
  2375
  2376         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2377
  2378         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2379             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2380             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2381             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2382         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2383         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2384         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2385         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2386             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2387             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2388         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2389         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2390         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2391             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  43
* EL677.cbl
  2392         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2393
  2394         16  CF-CL-ZIP-CODE.
  2395             20  CF-CL-ZIP-PRIME.
  2396                 24  CF-CL-ZIP-1ST          PIC X.
  2397                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2398                 24  FILLER                 PIC X(4).
  2399             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2400         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2401             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2402             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2403             20  FILLER                     PIC XXX.
  2404
  2405         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2406         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2407         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2408         16  CF-CO-OPTION-START-DATE        PIC XX.
  2409         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2410           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2411                                                      '3' '4'.
  2412           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2413           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2414           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2415           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2416           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2417           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2418
  2419         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2420
  2421         16  CF-PAYMENT-APPROVAL-LEVELS.
  2422             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2423             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2424             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2425             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2426             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2427             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2428
  2429         16  CF-END-USER-REPORTING-USER     PIC X.
  2430             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2431             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2432
  2433         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2434             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2435             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2436
  2437         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2438
  2439         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2440         16  FILLER                         PIC X.
  2441
  2442         16  CF-CREDIT-ARCHIVE-CNTL.
  2443             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2444             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2445             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2446
  2447         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2448
  2449         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  44
* EL677.cbl
  2450             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2451             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2452
  2453         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2454             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2455             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2456
  2457         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2458
  2459         16  CF-CO-ACH-ID-CODE              PIC  X.
  2460             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2461             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2462             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2463         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2464         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2465         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2466         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2467         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2468         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2469         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2470         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2471         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2472                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2473         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2474                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2475
  2476         16  CF-CO-OVER-SHORT.
  2477             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2478             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2479
  2480*         16  FILLER                         PIC X(102).
  2481         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2482             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2483             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2484
  2485         16  CF-AH-APPROVAL-DAYS.
  2486             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2487             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2488             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2489             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2490
  2491         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2492
  2493         16  CF-APPROV-LEV-5.
  2494             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2495             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2496             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2497
  2498         16  FILLER                         PIC X(68).
  2499****************************************************************
  2500*             PROCESSOR/USER RECORD                            *
  2501****************************************************************
  2502
  2503     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2504         16  CF-PROCESSOR-NAME              PIC X(30).
  2505         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2506         16  CF-PROCESSOR-TITLE             PIC X(26).
  2507         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  45
* EL677.cbl
  2508                 88  MESSAGE-YES                VALUE 'Y'.
  2509                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2510
  2511*****************************************************
  2512****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2513****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2514****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2515****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2516*****************************************************
  2517
  2518         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2519             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2520             20  CF-APPLICATION-FORCE       PIC X.
  2521             20  CF-INDIVIDUAL-APP.
  2522                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2523                     28  CF-BROWSE-APP      PIC X.
  2524                     28  CF-UPDATE-APP      PIC X.
  2525
  2526         16  CF-CURRENT-TERM-ON             PIC X(4).
  2527         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2528             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2529             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2530             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2531             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2532             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2533             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2534             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2535         16  CF-PROCESSOR-CARRIER           PIC X.
  2536             88  NO-CARRIER-SECURITY            VALUE ' '.
  2537         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2538             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2539         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2540             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2541         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2542             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2543
  2544         16  CF-PROC-SYS-ACCESS-SW.
  2545             20  CF-PROC-CREDIT-CLAIMS-SW.
  2546                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2547                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2548                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2549                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2550             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2551                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2552                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2553             20  CF-PROC-LIFE-GNRLDGR-SW.
  2554                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2555                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2556                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2557                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2558             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2559                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2560                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2561         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2562             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2563             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2564         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2565
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  46
* EL677.cbl
  2566         16  CF-APPROVAL-LEVEL                  PIC X.
  2567             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2568             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2569             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2570             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2571             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2572
  2573         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2574
  2575         16  CF-LANGUAGE-TYPE                   PIC X.
  2576             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2577             88  CF-LANG-IS-FR                      VALUE 'F'.
  2578
  2579         16  CF-CSR-IND                         PIC X.
  2580         16  FILLER                             PIC X(239).
  2581
  2582****************************************************************
  2583*             PROCESSOR/REMINDERS RECORD                       *
  2584****************************************************************
  2585
  2586     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2587         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2588             20  CF-START-REMIND-DT         PIC XX.
  2589             20  CF-END-REMIND-DT           PIC XX.
  2590             20  CF-REMINDER-TEXT           PIC X(50).
  2591         16  FILLER                         PIC X(296).
  2592
  2593
  2594****************************************************************
  2595*             STATE MASTER RECORD                              *
  2596****************************************************************
  2597
  2598     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2599         16  CF-STATE-ABBREVIATION          PIC XX.
  2600         16  CF-STATE-NAME                  PIC X(25).
  2601         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2602         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2603             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2604             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2605             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2606             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2607                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2608                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2609             20  CF-ST-PREM-REJECT-SW       PIC X.
  2610                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2611                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2612             20  CF-ST-REF-REJECT-SW        PIC X.
  2613                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2614                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2615         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2616         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2617         16  CF-ST-REFUND-RULES.
  2618             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2619             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2620             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2621         16  CF-ST-FST-PMT-EXTENSION.
  2622             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2623             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  47
* EL677.cbl
  2624                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2625                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2626                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2627                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2628         16  CF-ST-STATE-CALL.
  2629             20  CF-ST-CALL-UNEARNED        PIC X.
  2630             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2631             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2632         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2633             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2634             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2635         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2636         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2637         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2638         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2639         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2640         16  FILLER                         PIC X.
  2641         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2642             20  CF-ST-BENEFIT-CD           PIC XX.
  2643             20  CF-ST-BENEFIT-KIND         PIC X.
  2644                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2645                 88  CF-ST-AH-KIND              VALUE 'A'.
  2646             20  CF-ST-REM-TERM-CALC        PIC X.
  2647                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2648                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2649                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2650                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2651                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2652                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2653                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2654                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2655
  2656             20  CF-ST-REFUND-CALC          PIC X.
  2657                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2658                 88  ST-REFD-BY-R78             VALUE '1'.
  2659                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2660                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2661                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2662                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2663                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2664                 88  ST-REFD-UTAH               VALUE '7'.
  2665                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2666                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2667                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2668
  2669             20  CF-ST-EARNING-CALC         PIC X.
  2670                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2671                 88  ST-EARN-BY-R78             VALUE '1'.
  2672                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2673                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2674                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2675                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2676                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2677                 88  ST-EARN-MEAN               VALUE '8'.
  2678                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2679
  2680             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2681                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  48
* EL677.cbl
  2682                 88  ST-OVRD-BY-R78             VALUE '1'.
  2683                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2684                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2685                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2686                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2687                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2688                 88  ST-OVRD-MEAN               VALUE '8'.
  2689                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2690             20  cf-st-extra-periods        pic 9.
  2691*            20  FILLER                     PIC X.
  2692
  2693         16  CF-ST-COMMISSION-CAPS.
  2694             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2695             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2696             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2697             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2698         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2699                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2700
  2701         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2702
  2703         16  CF-ST-STATUTORY-INTEREST.
  2704             20  CF-ST-STAT-DATE-FROM       PIC X.
  2705                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2706                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2707             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2708             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2709             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2710             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2711             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2712
  2713         16  CF-ST-OVER-SHORT.
  2714             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2715             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2716
  2717         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2718
  2719         16  CF-ST-RT-CALC                  PIC X.
  2720
  2721         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2722         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2723         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2724         16  CF-ST-RF-LR-CALC               PIC X.
  2725         16  CF-ST-RF-LL-CALC               PIC X.
  2726         16  CF-ST-RF-LN-CALC               PIC X.
  2727         16  CF-ST-RF-AH-CALC               PIC X.
  2728         16  CF-ST-RF-CP-CALC               PIC X.
  2729*        16  FILLER                         PIC X(206).
  2730*CIDMOD         16  FILLER                         PIC X(192).
  2731         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2732             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2733         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2734         16  CF-ST-VFY-2ND-BENE             PIC X.
  2735         16  CF-ST-CAUSAL-STATE             PIC X.
  2736         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2737         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2738         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2739             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  49
* EL677.cbl
  2740         16  CF-ST-NET-ONLY-STATE           PIC X.
  2741             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2742         16  FILLER                         PIC X(181).
  2743
  2744****************************************************************
  2745*             BENEFIT MASTER RECORD                            *
  2746****************************************************************
  2747
  2748     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2749         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2750             20  CF-BENEFIT-CODE            PIC XX.
  2751             20  CF-BENEFIT-NUMERIC  REDEFINES
  2752                 CF-BENEFIT-CODE            PIC XX.
  2753             20  CF-BENEFIT-ALPHA           PIC XXX.
  2754             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2755             20  CF-BENEFIT-COMMENT         PIC X(10).
  2756
  2757             20  CF-LF-COVERAGE-TYPE        PIC X.
  2758                 88  CF-REDUCING                VALUE 'R'.
  2759                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2760
  2761             20  CF-SPECIAL-CALC-CD         PIC X.
  2762                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2763                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2764                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2765                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2766                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2767                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2768                 88  CF-FARM-PLAN               VALUE 'F'.
  2769                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2770                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2771                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2772                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2773                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2774                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2775                 88  CF-PRUDENTIAL              VALUE 'P'.
  2776                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2777                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2778                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2779                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2780                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2781                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2782
  2783             20  CF-JOINT-INDICATOR         PIC X.
  2784                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2785
  2786*            20  FILLER                     PIC X(12).
  2787             20  cf-maximum-benefits        pic s999 comp-3.
  2788             20  FILLER                     PIC X(09).
  2789             20  CF-BENEFIT-CATEGORY        PIC X.
  2790             20  CF-LOAN-TYPE               PIC X(8).
  2791
  2792             20  CF-CO-REM-TERM-CALC        PIC X.
  2793                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2794                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2795                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2796                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2797                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  50
* EL677.cbl
  2798
  2799             20  CF-CO-EARNINGS-CALC        PIC X.
  2800                 88  CO-EARN-BY-R78             VALUE '1'.
  2801                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2802                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2803                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2804                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2805                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2806                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2807                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2808
  2809             20  CF-CO-REFUND-CALC          PIC X.
  2810                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2811                 88  CO-REFD-BY-R78             VALUE '1'.
  2812                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2813                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2814                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2815                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2816                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2817                 88  CO-REFD-MEAN               VALUE '8'.
  2818                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2819                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2820                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2821
  2822             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2823                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2824                 88  CO-OVRD-BY-R78             VALUE '1'.
  2825                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2826                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2827                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2828                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2829                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2830                 88  CO-OVRD-MEAN               VALUE '8'.
  2831                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2832
  2833             20  CF-CO-BEN-I-G-CD           PIC X.
  2834                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2835                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2836                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2837
  2838         16  FILLER                         PIC X(304).
  2839
  2840
  2841****************************************************************
  2842*             CARRIER MASTER RECORD                            *
  2843****************************************************************
  2844
  2845     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2846         16  CF-ADDRESS-DATA.
  2847             20  CF-MAIL-TO-NAME            PIC X(30).
  2848             20  CF-IN-CARE-OF              PIC X(30).
  2849             20  CF-ADDRESS-LINE-1          PIC X(30).
  2850             20  CF-ADDRESS-LINE-2          PIC X(30).
  2851             20  CF-CITY-STATE              PIC X(30).
  2852             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2853             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2854
  2855         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  51
* EL677.cbl
  2856             20  CF-CLAIM-NO-METHOD         PIC X.
  2857                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2858                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2859                 88  CLAIM-NO-SEQ               VALUE '3'.
  2860                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2861             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2862                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2863                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2864                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2865
  2866         16  CF-CHECK-NO-CONTROL.
  2867             20  CF-CHECK-NO-METHOD         PIC X.
  2868                 88  CHECK-NO-MANUAL            VALUE '1'.
  2869                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2870                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2871                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2872             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2873                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2874
  2875         16  CF-DOMICILE-STATE              PIC XX.
  2876
  2877         16  CF-EXPENSE-CONTROLS.
  2878             20  CF-EXPENSE-METHOD          PIC X.
  2879                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2880                 88  DOLLARS-PER-PMT            VALUE '2'.
  2881                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2882                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2883             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2884             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2885
  2886         16  CF-CORRESPONDENCE-CONTROL.
  2887             20  CF-LETTER-RESEND-OPT       PIC X.
  2888                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2889                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2890             20  FILLER                     PIC X(4).
  2891
  2892         16  CF-RESERVE-CONTROLS.
  2893             20  CF-MANUAL-SW               PIC X.
  2894                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2895             20  CF-FUTURE-SW               PIC X.
  2896                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2897             20  CF-PTC-SW                  PIC X.
  2898                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2899             20  CF-IBNR-SW                 PIC X.
  2900                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2901             20  CF-PTC-LF-SW               PIC X.
  2902                 88  CF-LF-PTC-USED             VALUE '1'.
  2903             20  CF-CDT-ACCESS-METHOD       PIC X.
  2904                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2905                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2906                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2907             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2908
  2909         16  CF-CLAIM-CALC-METHOD           PIC X.
  2910             88  360-PLUS-MONTHS                VALUE '1'.
  2911             88  365-PLUS-MONTHS                VALUE '2'.
  2912             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2913             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  52
* EL677.cbl
  2914             88  365-DAILY                      VALUE '5'.
  2915
  2916         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2917         16  FILLER                         PIC X(11).
  2918
  2919         16  CF-LIMIT-AMOUNTS.
  2920             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2921             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2922             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2923             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2924             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2925             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2926             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2927             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2928             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2929             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2930
  2931         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2932         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2933         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2934
  2935         16  CF-ZIP-CODE.
  2936             20  CF-ZIP-PRIME.
  2937                 24  CF-ZIP-1ST             PIC X.
  2938                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2939                 24  FILLER                 PIC X(4).
  2940             20  CF-ZIP-PLUS4               PIC X(4).
  2941         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2942             20  CF-CAN-POSTAL-1            PIC XXX.
  2943             20  CF-CAN-POSTAL-2            PIC XXX.
  2944             20  FILLER                     PIC XXX.
  2945
  2946         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2947         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2948         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2949
  2950         16  CF-RATING-SWITCH               PIC X.
  2951             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2952             88  CF-NO-RATING                   VALUE 'N'.
  2953
  2954         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2955
  2956         16  CF-CARRIER-OVER-SHORT.
  2957             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2958             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2959
  2960         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2961         16  CF-SECPAY-SWITCH               PIC X.
  2962             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2963             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2964         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2965         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2966         16  FILLER                         PIC X(444).
  2967*        16  FILLER                         PIC X(452).
  2968
  2969
  2970****************************************************************
  2971*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  53
* EL677.cbl
  2972****************************************************************
  2973
  2974     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2975         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2976                                INDEXED BY CF-MORT-NDX.
  2977             20  CF-MORT-TABLE              PIC X(5).
  2978             20  CF-MORT-TABLE-TYPE         PIC X.
  2979                 88  CF-MORT-JOINT              VALUE 'J'.
  2980                 88  CF-MORT-SINGLE             VALUE 'S'.
  2981                 88  CF-MORT-COMBINED           VALUE 'C'.
  2982                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2983                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2984             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2985             20  CF-MORT-AGE-METHOD         PIC XX.
  2986                 88  CF-AGE-LAST                VALUE 'AL'.
  2987                 88  CF-AGE-NEAR                VALUE 'AN'.
  2988             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2989             20  CF-MORT-ADJUSTMENT-DIRECTION
  2990                                            PIC X.
  2991                 88  CF-MINUS                   VALUE '-'.
  2992                 88  CF-PLUS                    VALUE '+'.
  2993             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2994             20  CF-MORT-JOINT-CODE         PIC X.
  2995                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2996             20  CF-MORT-PC-Q               PIC X.
  2997                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2998             20  CF-MORT-TABLE-CODE         PIC X(4).
  2999             20  CF-MORT-COMMENTS           PIC X(15).
  3000             20  FILLER                     PIC X(14).
  3001
  3002         16  FILLER                         PIC X(251).
  3003
  3004
  3005****************************************************************
  3006*             BUSSINESS TYPE MASTER RECORD                     *
  3007****************************************************************
  3008
  3009     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3010* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3011* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3012* AND RECORD 05 IS TYPES 81-99
  3013         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3014             20  CF-BUSINESS-TITLE          PIC  X(19).
  3015             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3016                                            PIC S9V9(4) COMP-3.
  3017             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3018             20  FILLER                     PIC  X.
  3019         16  FILLER                         PIC  X(248).
  3020
  3021
  3022****************************************************************
  3023*             TERMINAL MASTER RECORD                           *
  3024****************************************************************
  3025
  3026     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3027
  3028         16  CF-COMPANY-TERMINALS.
  3029             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  54
* EL677.cbl
  3030                                  PIC X(4).
  3031         16  FILLER               PIC X(248).
  3032
  3033
  3034****************************************************************
  3035*             LIFE EDIT MASTER RECORD                          *
  3036****************************************************************
  3037
  3038     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3039         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3040             20  CF-LIFE-CODE-IN            PIC XX.
  3041             20  CF-LIFE-CODE-OUT           PIC XX.
  3042         16  FILLER                         PIC X(248).
  3043
  3044
  3045****************************************************************
  3046*             AH EDIT MASTER RECORD                            *
  3047****************************************************************
  3048
  3049     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3050         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3051             20  CF-AH-CODE-IN              PIC XXX.
  3052             20  CF-AH-CODE-OUT             PIC XX.
  3053         16  FILLER                         PIC X(248).
  3054
  3055
  3056****************************************************************
  3057*             CREDIBILITY TABLES                               *
  3058****************************************************************
  3059
  3060     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3061         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3062                             INDEXED BY CF-CRDB-NDX.
  3063             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3064             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3065             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3066         16  FILLER                         PIC  X(332).
  3067
  3068
  3069****************************************************************
  3070*             REPORT CUSTOMIZATION RECORD                      *
  3071****************************************************************
  3072
  3073     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3074         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3075             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3076             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3077             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3078**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3079****       A T-TRANSFER.                                   ****
  3080             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3081
  3082         16  FILLER                         PIC XX.
  3083
  3084         16  CF-CARRIER-CNTL-OPT.
  3085             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3086                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3087                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  55
* EL677.cbl
  3088             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3089                                            PIC X.
  3090         16  CF-GROUP-CNTL-OPT.
  3091             20  CF-GROUP-OPT-SEQ           PIC 9.
  3092                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3093                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3094             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3095                                            PIC X(6).
  3096         16  CF-STATE-CNTL-OPT.
  3097             20  CF-STATE-OPT-SEQ           PIC 9.
  3098                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3099                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3100             20  CF-STATE-SELECT OCCURS 3 TIMES
  3101                                            PIC XX.
  3102         16  CF-ACCOUNT-CNTL-OPT.
  3103             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3104                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3105                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3106             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3107                                            PIC X(10).
  3108         16  CF-BUS-TYP-CNTL-OPT.
  3109             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3110                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3111                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3112             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3113                                            PIC XX.
  3114         16  CF-LF-TYP-CNTL-OPT.
  3115             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3116                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3117                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3118             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3119                                            PIC XX.
  3120         16  CF-AH-TYP-CNTL-OPT.
  3121             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3122                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3123                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3124             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3125                                            PIC XX.
  3126         16  CF-REPTCD1-CNTL-OPT.
  3127             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3128                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3129                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3130             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3131                                            PIC X(10).
  3132         16  CF-REPTCD2-CNTL-OPT.
  3133             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3134                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3135                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3136             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3137                                            PIC X(10).
  3138         16  CF-USER1-CNTL-OPT.
  3139             20  CF-USER1-OPT-SEQ           PIC 9.
  3140                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3141                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3142             20  CF-USER1-SELECT OCCURS 3 TIMES
  3143                                            PIC X(10).
  3144         16  CF-USER2-CNTL-OPT.
  3145             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  56
* EL677.cbl
  3146                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3147                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3148             20  CF-USER2-SELECT OCCURS 3 TIMES
  3149                                            PIC X(10).
  3150         16  CF-USER3-CNTL-OPT.
  3151             20  CF-USER3-OPT-SEQ           PIC 9.
  3152                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3153                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3154             20  CF-USER3-SELECT OCCURS 3 TIMES
  3155                                            PIC X(10).
  3156         16  CF-USER4-CNTL-OPT.
  3157             20  CF-USER4-OPT-SEQ           PIC 9.
  3158                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3159                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3160             20  CF-USER4-SELECT OCCURS 3 TIMES
  3161                                            PIC X(10).
  3162         16  CF-USER5-CNTL-OPT.
  3163             20  CF-USER5-OPT-SEQ           PIC 9.
  3164                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3165                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3166             20  CF-USER5-SELECT OCCURS 3 TIMES
  3167                                            PIC X(10).
  3168         16  CF-REINS-CNTL-OPT.
  3169             20  CF-REINS-OPT-SEQ           PIC 9.
  3170                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3171                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3172             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3173                 24  CF-REINS-PRIME         PIC XXX.
  3174                 24  CF-REINS-SUB           PIC XXX.
  3175
  3176         16  CF-AGENT-CNTL-OPT.
  3177             20  CF-AGENT-OPT-SEQ           PIC 9.
  3178                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3179                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3180             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3181                                            PIC X(10).
  3182
  3183         16  FILLER                         PIC X(43).
  3184
  3185         16  CF-LOSS-RATIO-SELECT.
  3186             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3187             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3188         16  CF-ENTRY-DATE-SELECT.
  3189             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3190             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3191         16  CF-EFFECTIVE-DATE-SELECT.
  3192             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3193             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3194
  3195         16  CF-EXCEPTION-LIST-IND          PIC X.
  3196             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3197
  3198         16  FILLER                         PIC X(318).
  3199
  3200****************************************************************
  3201*                  EXCEPTION REPORTING RECORD                  *
  3202****************************************************************
  3203
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  57
* EL677.cbl
  3204     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3205         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3206             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3207
  3208         16  CF-COMBINED-LIFE-AH-OPT.
  3209             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3210             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3211             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3212             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3213
  3214         16  CF-LIFE-OPT.
  3215             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3216             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3217             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3218             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3219             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3220             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3221             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3222             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3223             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3224             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3225
  3226         16  CF-AH-OPT.
  3227             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3228             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3229             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3230             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3231             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3232             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3233             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3234             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3235             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3236             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3237
  3238         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3239             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3240             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3241             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3242
  3243         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3244
  3245         16  FILLER                         PIC X(673).
  3246
  3247
  3248****************************************************************
  3249*             MORTGAGE SYSTEM PLAN RECORD                      *
  3250****************************************************************
  3251
  3252     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3253         16  CF-PLAN-TYPE                   PIC X.
  3254             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3255             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3256             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3257         16  CF-PLAN-ABBREV                 PIC XXX.
  3258         16  CF-PLAN-DESCRIPT               PIC X(10).
  3259         16  CF-PLAN-NOTES                  PIC X(20).
  3260         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3261         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  58
* EL677.cbl
  3262             20  CF-PLAN-TERM-DATA.
  3263                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3264                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3265             20  CF-PLAN-AGE-DATA.
  3266                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3267                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3268                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3269             20  CF-PLAN-BENEFIT-DATA.
  3270                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3271                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3272                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3273                                            PIC S9(7)V99  COMP-3.
  3274         16  CF-PLAN-POLICY-FORMS.
  3275             20  CF-POLICY-FORM             PIC X(12).
  3276             20  CF-MASTER-APPLICATION      PIC X(12).
  3277             20  CF-MASTER-POLICY           PIC X(12).
  3278         16  CF-PLAN-RATING.
  3279             20  CF-RATE-CODE               PIC X(5).
  3280             20  CF-SEX-RATING              PIC X.
  3281                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3282                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3283             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3284             20  CF-SUB-STD-TYPE            PIC X.
  3285                 88  CF-PCT-OF-PREM            VALUE '1'.
  3286                 88  CF-PCT-OF-BENE            VALUE '2'.
  3287         16  CF-PLAN-PREM-TOLERANCES.
  3288             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3289             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3290         16  CF-PLAN-PYMT-TOLERANCES.
  3291             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3292             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3293         16  CF-PLAN-MISC-DATA.
  3294             20  FILLER                     PIC X.
  3295             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3296             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3297         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3298         16  CF-PLAN-IND-GRP                PIC X.
  3299             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3300                                                     '1'.
  3301             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3302                                                     '2'.
  3303         16  CF-MIB-SEARCH-SW               PIC X.
  3304             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3305             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3306             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3307             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3308         16  CF-ALPHA-SEARCH-SW             PIC X.
  3309             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3310             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3311             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3312             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3313             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3314             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3315             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3316             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3317             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3318             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3319                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  59
* EL677.cbl
  3320                                                     'X' 'Y' 'Z'.
  3321         16  CF-EFF-DT-RULE-SW              PIC X.
  3322             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3323             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3324             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3325             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3326             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3327         16  FILLER                         PIC X(4).
  3328         16  CF-HEALTH-QUESTIONS            PIC X.
  3329             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3330         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3331         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3332         16  CF-PLAN-SNGL-JNT               PIC X.
  3333             88  CF-COMBINED-PLAN              VALUE 'C'.
  3334             88  CF-JNT-PLAN                   VALUE 'J'.
  3335             88  CF-SNGL-PLAN                  VALUE 'S'.
  3336         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3337         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3338         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3339         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3340         16  CF-RERATE-CNTL                 PIC  X.
  3341             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3342             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3343             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3344             88  CF-AUTO-RECALC                 VALUE '4'.
  3345         16  CF-BENEFIT-TYPE                PIC  X.
  3346             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3347             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3348         16  CF-POLICY-FEE                  PIC S999V99
  3349                                                    COMP-3.
  3350         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3351         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3352         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3353         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3354         16  FILLER                         PIC  X(32).
  3355         16  CF-TERMINATION-FORM            PIC  X(04).
  3356         16  FILLER                         PIC  X(08).
  3357         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3358                                                       COMP-3.
  3359         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3360         16  CF-ISSUE-LETTER                PIC  X(4).
  3361         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3362         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3363             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3364             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3365         16  CF-MP-REFUND-CALC              PIC X.
  3366             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3367             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3368             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3369             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3370             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3371             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3372             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3373             88  CF-MP-REFD-MEAN                VALUE '8'.
  3374         16  CF-ALT-RATE-CODE               PIC  X(5).
  3375
  3376
  3377         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  60
* EL677.cbl
  3378****************************************************************
  3379*             MORTGAGE COMPANY MASTER RECORD                   *
  3380****************************************************************
  3381
  3382     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3383         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3384         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3385             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3386             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3387             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3388             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3389             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3390
  3391         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3392         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3393         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3394         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3395         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3396
  3397         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3398             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3399         16  CF-MP-RECON-USE-IND            PIC X(1).
  3400             88  CF-MP-USE-RECON             VALUE 'Y'.
  3401         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3402             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3403         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3404             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3405             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3406         16  FILLER                         PIC X(1).
  3407         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3408             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3409         16  CF-MORTG-MIB-VERSION           PIC X.
  3410             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3411             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3412             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3413         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3414             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3415                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3416             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3417                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3418             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3419                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3420             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3421                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3422             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3423                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3424             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3425                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3426         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3427         16  FILLER                         PIC X(7).
  3428         16  CF-MORTG-DESTINATION-SYMBOL.
  3429             20  CF-MORTG-MIB-COMM          PIC X(5).
  3430             20  CF-MORTG-MIB-TERM          PIC X(5).
  3431         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3432             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3433         16  FILLER                         PIC X(03).
  3434         16  CF-MP-CHECK-NO-CONTROL.
  3435             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  61
* EL677.cbl
  3436                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3437                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3438                                                ' ' LOW-VALUES.
  3439                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3440                                               VALUE '3'.
  3441         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3442         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3443         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3444             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3445                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3446             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3447                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3448             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3449                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3450             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3451                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3452             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3453                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3454             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3455                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3456         16  CF-MORTG-BILLING-AREA.
  3457             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3458                                            PIC X.
  3459         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3460         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3461         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3462         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3463             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3464             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3465         16  FILLER                         PIC X.
  3466         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3467             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3468             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3469         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3470         16  FILLER                         PIC X(8).
  3471         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3472         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3473         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3474         16  CF-ACH-COMPANY-ID.
  3475             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3476                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3477                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3478                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3479             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3480         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3481             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3482         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3483             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3484             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3485         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3486         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3487         16  FILLER                         PIC X(536).
  3488
  3489****************************************************************
  3490*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3491****************************************************************
  3492
  3493     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  62
* EL677.cbl
  3494         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3495             20  CF-FEMALE-HEIGHT.
  3496                 24  CF-FEMALE-FT           PIC 99.
  3497                 24  CF-FEMALE-IN           PIC 99.
  3498             20  CF-FEMALE-MIN-WT           PIC 999.
  3499             20  CF-FEMALE-MAX-WT           PIC 999.
  3500         16  FILLER                         PIC X(428).
  3501
  3502     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3503         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3504             20  CF-MALE-HEIGHT.
  3505                 24  CF-MALE-FT             PIC 99.
  3506                 24  CF-MALE-IN             PIC 99.
  3507             20  CF-MALE-MIN-WT             PIC 999.
  3508             20  CF-MALE-MAX-WT             PIC 999.
  3509         16  FILLER                         PIC X(428).
  3510******************************************************************
  3511*             AUTOMATIC ACTIVITY RECORD                          *
  3512******************************************************************
  3513     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3514         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3515             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3516             20  CF-SYS-LETTER-ID           PIC X(04).
  3517             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3518             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3519             20  CF-SYS-RESET-SW            PIC X(01).
  3520             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3521             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3522
  3523         16  FILLER                         PIC X(50).
  3524
  3525         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3526             20  CF-USER-ACTIVE-SW          PIC X(01).
  3527             20  CF-USER-LETTER-ID          PIC X(04).
  3528             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3529             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3530             20  CF-USER-RESET-SW           PIC X(01).
  3531             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3532             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3533             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3534
  3535         16  FILLER                         PIC X(246).
  3536*                                    COPY ERCCHEK.
  3537******************************************************************
  3538*                                                                *
  3539*                                                                *
  3540*                            ERCCHEK                             *
  3541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3542*                            VMOD=2.008                          *
  3543*                                                                *
  3544*   FILE DESCRIPTION = CHECK RECORDS                             *
  3545*                                                                *
  3546*   FILE TYPE = VSAM,KSDS                                        *
  3547*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3548*                                                                *
  3549*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3550*       ALTERNATE INDEX = NONE                                   *
  3551*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  63
* EL677.cbl
  3552*   LOG = YES                                                    *
  3553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3554******************************************************************
  3555*                   C H A N G E   L O G
  3556*
  3557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3558*-----------------------------------------------------------------
  3559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3560* EFFECTIVE    NUMBER
  3561*-----------------------------------------------------------------
  3562* 021414    2003053000001  PEMA  changes for auto chk request
  3563******************************************************************
  3564 01  CHECK-RECORDS.
  3565     12  CH-RECORD-ID                      PIC XX.
  3566         88  VALID-CH-ID                      VALUE 'CH'.
  3567
  3568     12  CH-CONTROL-PRIMARY.
  3569         16  CH-COMPANY-CD                 PIC X.
  3570         16  CH-CARRIER                    PIC X.
  3571         16  CH-GROUPING                   PIC X(6).
  3572         16  CH-STATE                      PIC XX.
  3573         16  CH-ACCOUNT                    PIC X(10).
  3574         16  CH-CERT-EFF-DT                PIC XX.
  3575         16  CH-CERT-NO.
  3576             20  CH-CERT-PRIME             PIC X(10).
  3577             20  CH-CERT-SFX               PIC X.
  3578         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3579
  3580     12  CH-RECORDED-DT                    PIC XX.
  3581     12  CH-RECORDED-BY                    PIC X(4).
  3582     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3583
  3584     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3585     12  CH-CHECK-NO                       PIC X(7).
  3586     12  CH-REASON-FOR-CHECK               PIC X(25).
  3587     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3588     12  FILLER                            PIC X.
  3589
  3590     12  CH-PAYEE-INFO.
  3591         16  CH-PAYEE-NAME-1               PIC X(30).
  3592         16  CH-PAYEE-NAME-2               PIC X(30).
  3593         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3594         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3595         16  CH-PAYEE-CITY-ST.
  3596             20  CH-PAYEE-CITY             PIC X(28).
  3597             20  CH-PAYEE-STATE            PIC XX.
  3598         16  CH-PAYEE-ZIP-CODE.
  3599             20  CH-PAYEE-ZIP.
  3600                 24  CH-ZIP-PRI-1ST        PIC X.
  3601                     88  CH-CANADIAN-POST-CODE
  3602                                           VALUES 'A' THRU 'Z'.
  3603                 24  FILLER                PIC X(4).
  3604             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3605         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3606             20  CH-CAN-POSTAL-1           PIC XXX.
  3607             20  CH-CAN-POSTAL-2           PIC XXX.
  3608             20  FILLER                    PIC XXX.
  3609
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  64
* EL677.cbl
  3610     12  CH-CHECK-STUB-TEXT.
  3611         16  CH-STUB-LINE-1                PIC X(30).
  3612         16  CH-TEXT-LINE-1                PIC X(50).
  3613         16  CH-TEXT-LINE-2                PIC X(50).
  3614         16  CH-TEXT-LINE-3                PIC X(40).
  3615     12  CH-RETURN-TO                      PIC X(30).
  3616
  3617     12  CH-COMPENSATION-CONTROL.
  3618         16  CH-COMP-CARRIER               PIC X.
  3619         16  CH-COMP-GROUPING              PIC X(6).
  3620         16  CH-COMP-FIN-RESP              PIC X(10).
  3621         16  CH-COMP-ACCOUNT               PIC X(10).
  3622
  3623     12  CH-CREDIT-SELECT-DT               PIC XX.
  3624     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3625     12  CH-PAYEE-CODE                     PIC X(6).
  3626
  3627     12  CH-VOID-DATA.
  3628         20  CH-VOID-DT                    PIC XX.
  3629         20  CH-VOID-BY                    PIC X(4).
  3630         20  CH-VOID-REASON                PIC X(25).
  3631
  3632     12  CH-APPROVAL-DATA.
  3633         20  CH-APPROVAL-DT                PIC XX.
  3634         20  CH-APPROVAL-STATUS            PIC X.
  3635             88  CH-IN-LIMBO                  VALUE ' '.
  3636             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3637             88  CH-APPROVED                  VALUE 'A'.
  3638             88  CH-DENIED                    VALUE 'D'.
  3639         20  CH-APPROVED-BY                PIC XXXX.
  3640     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3641             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3642     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3643
  3644     12  ch-released-dt                    pic xx.
  3645     12  ch-check-cashed-dt                pic xx.
  3646     12  FILLER                            PIC X.
  3647*    12  CH-CHECK-REFERENCE                PIC X(12).
  3648     12  CH-CHECK-ORIGIN-SW                PIC X.
  3649             88  CH-REFUND-CHECK              VALUE 'R'.
  3650             88  CH-MAINT-CHECK               VALUE 'M'.
  3651
  3652     12  CH-CANC-DT                        PIC XX.
  3653     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3654     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3655
  3656     12  CH-INSURED-NAME                   PIC X(28).
  3657
  3658     12  ch-released-by                    pic x(4).
  3659     12  ch-csr                            pic x(4).
  3660     12  ch-deduct-commission              pic x.
  3661         88  ch-deduct-comm                  value 'Y'.
  3662         88  ch-do-not-deduct-comm           value 'N'.
  3663
  3664     12  FILLER                            PIC X(11).
  3665*    12  CH-LETTER-TABLE.
  3666*        16  CH-LETTERS OCCURS 3 TIMES
  3667*                       INDEXED BY CH-LT-NDX
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  65
* EL677.cbl
  3668*                                          PIC X(04).
  3669
  3670     12  FILLER                            PIC X(07).
  3671
  3672*                                    COPY ERCACCT.
  3673******************************************************************
  3674*                                                                *
  3675*                                                                *
  3676*                            ERCACCT                             *
  3677*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3678*                            VMOD=2.031                          *
  3679*                                                                *
  3680*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3681*                                                                *
  3682*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3683*   VSAM ACCOUNT MASTER FILES.                                   *
  3684*                                                                *
  3685*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3686*                                                                *
  3687*   FILE TYPE = VSAM,KSDS                                        *
  3688*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3689*                                                                *
  3690*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3691*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3692*                                                                *
  3693*   LOG = NO                                                     *
  3694*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3695*                                                                *
  3696*                                                                *
  3697******************************************************************
  3698*                   C H A N G E   L O G
  3699*
  3700* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3701*-----------------------------------------------------------------
  3702*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3703* EFFECTIVE    NUMBER
  3704*-----------------------------------------------------------------
  3705* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3706* 092705    2005050300006  PEMA  ADD SPP LEASES
  3707* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3708* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3709* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3710* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3711* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3712* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3713******************************************************************
  3714
  3715 01  ACCOUNT-MASTER.
  3716     12  AM-RECORD-ID                      PIC XX.
  3717         88  VALID-AM-ID                      VALUE 'AM'.
  3718
  3719     12  AM-CONTROL-PRIMARY.
  3720         16  AM-COMPANY-CD                 PIC X.
  3721         16  AM-MSTR-CNTRL.
  3722             20  AM-CONTROL-A.
  3723                 24  AM-CARRIER            PIC X.
  3724                 24  AM-GROUPING.
  3725                     28 AM-GROUPING-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  66
* EL677.cbl
  3726                     28 AM-GROUPING-PRIME  PIC XXX.
  3727                 24  AM-STATE              PIC XX.
  3728                 24  AM-ACCOUNT.
  3729                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3730                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3731             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3732                                           PIC X(19).
  3733             20  AM-CNTRL-B.
  3734                 24  AM-EXPIRATION-DT      PIC XX.
  3735                 24  FILLER                PIC X(4).
  3736             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3737                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3738
  3739     12  AM-CONTROL-BY-VAR-GRP.
  3740         16  AM-COMPANY-CD-A1              PIC X.
  3741         16  AM-VG-CARRIER                 PIC X.
  3742         16  AM-VG-GROUPING                PIC X(6).
  3743         16  AM-VG-STATE                   PIC XX.
  3744         16  AM-VG-ACCOUNT                 PIC X(10).
  3745         16  AM-VG-DATE.
  3746             20  AM-VG-EXPIRATION-DT       PIC XX.
  3747             20  FILLER                    PIC X(4).
  3748         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3749                                           PIC 9(11)      COMP-3.
  3750     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3751         16  FILLER                        PIC X(10).
  3752         16  AM-VG-KEY3.
  3753             20  AM-VG3-ACCOUNT            PIC X(10).
  3754             20  AM-VG3-EXP-DT             PIC XX.
  3755         16  FILLER                        PIC X(4).
  3756     12  AM-MAINT-INFORMATION.
  3757         16  AM-LAST-MAINT-DT              PIC XX.
  3758         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3759         16  AM-LAST-MAINT-USER            PIC X(4).
  3760         16  FILLER                        PIC XX.
  3761
  3762     12  AM-EFFECTIVE-DT                   PIC XX.
  3763     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3764
  3765     12  AM-PREV-DATES  COMP-3.
  3766         16  AM-PREV-EXP-DT                PIC 9(11).
  3767         16  AM-PREV-EFF-DT                PIC 9(11).
  3768
  3769     12  AM-REPORT-CODE-1                  PIC X(10).
  3770     12  AM-REPORT-CODE-2                  PIC X(10).
  3771
  3772     12  AM-CITY-CODE                      PIC X(4).
  3773     12  AM-COUNTY-PARISH                  PIC X(6).
  3774
  3775     12  AM-NAME                           PIC X(30).
  3776     12  AM-PERSON                         PIC X(30).
  3777     12  AM-ADDRS                          PIC X(30).
  3778     12  AM-CITY.
  3779         16  AM-ADDR-CITY                  PIC X(28).
  3780         16  AM-ADDR-STATE                 PIC XX.
  3781     12  AM-ZIP.
  3782         16  AM-ZIP-PRIME.
  3783             20  AM-ZIP-PRI-1ST            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  67
* EL677.cbl
  3784                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3785             20  FILLER                    PIC X(4).
  3786         16  AM-ZIP-PLUS4                  PIC X(4).
  3787     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3788         16  AM-CAN-POSTAL-1               PIC XXX.
  3789         16  AM-CAN-POSTAL-2               PIC XXX.
  3790         16  FILLER                        PIC XXX.
  3791     12  AM-TEL-NO.
  3792         16  AM-AREA-CODE                  PIC 999.
  3793         16  AM-TEL-PRE                    PIC 999.
  3794         16  AM-TEL-NBR                    PIC 9(4).
  3795     12  AM-TEL-LOC                        PIC X.
  3796         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3797         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3798
  3799     12  AM-COMM-STRUCTURE.
  3800         16  AM-DEFN-1.
  3801             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3802                 24  AM-AGT.
  3803                     28  AM-AGT-PREFIX     PIC X(4).
  3804                     28  AM-AGT-PRIME      PIC X(6).
  3805                 24  AM-COM-TYP            PIC X.
  3806                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3807                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3808                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3809                 24  AM-RECALC-LV-INDIC    PIC X.
  3810                 24  AM-RETRO-LV-INDIC     PIC X.
  3811                 24  AM-GL-CODES           PIC X.
  3812                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3813                 24  FILLER                PIC X(01).
  3814         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3815             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3816                 24  FILLER                PIC X(11).
  3817                 24  AM-L-COMA             PIC XXX.
  3818                 24  AM-J-COMA             PIC XXX.
  3819                 24  AM-A-COMA             PIC XXX.
  3820                 24  FILLER                PIC X(6).
  3821
  3822     12  AM-COMM-CHANGE-STATUS             PIC X.
  3823         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3824
  3825     12  AM-CSR-CODE                       PIC X(4).
  3826
  3827     12  AM-BILLING-STATUS                 PIC X.
  3828         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3829         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3830     12  AM-AUTO-REFUND-SW                 PIC X.
  3831         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3832         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3833     12  AM-GPCD                           PIC 99.
  3834     12  AM-IG                             PIC X.
  3835         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3836         88  AM-HAS-GROUP                     VALUE '2'.
  3837     12  AM-STATUS                         PIC X.
  3838         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3839         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3840         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3841         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  68
* EL677.cbl
  3842         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3843         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3844         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3845         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3846         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3847         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3848     12  AM-REMIT-TO                       PIC 99.
  3849     12  AM-ID-NO                          PIC X(11).
  3850
  3851     12  AM-CAL-TABLE                      PIC XX.
  3852     12  AM-LF-DEVIATION                   PIC XXX.
  3853     12  AM-AH-DEVIATION                   PIC XXX.
  3854     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3855     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3856     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3857     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3858     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3859     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3860
  3861     12  AM-USER-FIELDS.
  3862         16  AM-FLD-1                      PIC XX.
  3863         16  AM-FLD-2                      PIC XX.
  3864         16  AM-FLD-3                      PIC XX.
  3865         16  AM-FLD-4                      PIC XX.
  3866         16  AM-FLD-5                      PIC XX.
  3867
  3868     12  AM-1ST-PROD-DATE.
  3869         16  AM-1ST-PROD-YR                PIC XX.
  3870         16  AM-1ST-PROD-MO                PIC XX.
  3871         16  AM-1ST-PROD-DA                PIC XX.
  3872     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3873     12  AM-CERTS-PURGED-DATE.
  3874         16  AM-PUR-YR                     PIC XX.
  3875         16  AM-PUR-MO                     PIC XX.
  3876         16  AM-PUR-DA                     PIC XX.
  3877     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3878     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3879     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3880     12  AM-INACTIVE-DATE.
  3881         16  AM-INA-MO                     PIC 99.
  3882         16  AM-INA-DA                     PIC 99.
  3883         16  AM-INA-YR                     PIC 99.
  3884     12  AM-AR-HI-CERT-DATE                PIC XX.
  3885
  3886     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3887     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3888
  3889     12  AM-OB-PAYMENT-MODE                PIC X.
  3890         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3891         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3892         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3893         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3894
  3895     12  AM-AH-ONLY-INDICATOR              PIC X.
  3896         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3897         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3898
  3899     12  AM-EDIT-LOAN-OFC                  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  69
* EL677.cbl
  3900
  3901     12  AM-OVER-SHORT.
  3902         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3903         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3904
  3905     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3906     12  AM-DCC-CLP-STATE                  PIC XX.
  3907
  3908     12  AM-RECALC-COMM                    PIC X.
  3909     12  AM-RECALC-REIN                    PIC X.
  3910
  3911     12  AM-REI-TABLE                      PIC XXX.
  3912     12  AM-REI-ET-LF                      PIC X.
  3913     12  AM-REI-ET-AH                      PIC X.
  3914     12  AM-REI-PE-LF                      PIC X.
  3915     12  AM-REI-PE-AH                      PIC X.
  3916     12  AM-REI-PRT-ST                     PIC X.
  3917     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3918     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3919     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3920     12  AM-REI-GROUP-A                    PIC X(6).
  3921     12  AM-REI-MORT                       PIC X(4).
  3922     12  AM-REI-PRT-OW                     PIC X.
  3923     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3924     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3925     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3926     12  AM-REI-GROUP-B                    PIC X(6).
  3927
  3928     12  AM-TRUST-TYPE                     PIC X(2).
  3929
  3930     12  AM-EMPLOYER-STMT-USED             PIC X.
  3931     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3932
  3933     12  AM-STD-AH-TYPE                    PIC XX.
  3934     12  AM-EARN-METHODS.
  3935         16  AM-EARN-METHOD-R              PIC X.
  3936             88 AM-REF-RL-R78                 VALUE 'R'.
  3937             88 AM-REF-RL-PR                  VALUE 'P'.
  3938             88 AM-REF-RL-MEAN                VALUE 'M'.
  3939             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3940         16  AM-EARN-METHOD-L              PIC X.
  3941             88 AM-REF-LL-R78                 VALUE 'R'.
  3942             88 AM-REF-LL-PR                  VALUE 'P'.
  3943             88 AM-REF-LL-MEAN                VALUE 'M'.
  3944             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3945         16  AM-EARN-METHOD-A              PIC X.
  3946             88 AM-REF-AH-R78                 VALUE 'R'.
  3947             88 AM-REF-AH-PR                  VALUE 'P'.
  3948             88 AM-REF-AH-MEAN                VALUE 'M'.
  3949             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3950             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3951             88 AM-REF-AH-NET                 VALUE 'N'.
  3952
  3953     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3954     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3955     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3956
  3957     12  AM-RET-Y-N                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  70
* EL677.cbl
  3958     12  AM-RET-P-E                        PIC X.
  3959     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3960     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3961     12  AM-RET-GRP                        PIC X(6).
  3962     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3963         16  AM-POOL-PRIME                 PIC XXX.
  3964         16  AM-POOL-SUB                   PIC XXX.
  3965     12  AM-RETRO-EARNINGS.
  3966         16  AM-RET-EARN-R                 PIC X.
  3967         16  AM-RET-EARN-L                 PIC X.
  3968         16  AM-RET-EARN-A                 PIC X.
  3969     12  AM-RET-ST-TAX-USE                 PIC X.
  3970         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3971         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3972     12  AM-RETRO-BEG-EARNINGS.
  3973         16  AM-RET-BEG-EARN-R             PIC X.
  3974         16  AM-RET-BEG-EARN-L             PIC X.
  3975         16  AM-RET-BEG-EARN-A             PIC X.
  3976     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3977     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3978
  3979     12  AM-USER-SELECT-OPTIONS.
  3980         16  AM-USER-SELECT-1              PIC X(10).
  3981         16  AM-USER-SELECT-2              PIC X(10).
  3982         16  AM-USER-SELECT-3              PIC X(10).
  3983         16  AM-USER-SELECT-4              PIC X(10).
  3984         16  AM-USER-SELECT-5              PIC X(10).
  3985
  3986     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3987
  3988     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3989
  3990     12  AM-RPT045A-SWITCH                 PIC X.
  3991         88  RPT045A-OFF                   VALUE 'N'.
  3992
  3993     12  AM-INSURANCE-LIMITS.
  3994         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3995         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3996
  3997     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3998         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3999
  4000     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4001         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4002         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4003
  4004     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4005
  4006     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4007     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4008     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4009     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4010     12  AM-DCC-UEF-STATE                  PIC XX.
  4011     12  FILLER                            PIC XXX.
  4012     12  AM-REPORT-CODE-3                  PIC X(10).
  4013*    12  FILLER                            PIC X(22).
  4014
  4015     12  AM-RESERVE-DATE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  71
* EL677.cbl
  4016         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4017         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4018         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4019
  4020     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4021     12  AM-NOTIFICATION-TYPES.
  4022         16  AM-NOTIF-OF-LETTERS           PIC X.
  4023         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4024         16  AM-NOTIF-OF-REPORTS           PIC X.
  4025         16  AM-NOTIF-OF-STATUS            PIC X.
  4026
  4027     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4028         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4029         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4030         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4031         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4032
  4033     12  AM-BENEFIT-CONTROLS.
  4034         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4035             20  AM-BENEFIT-CODE           PIC XX.
  4036             20  AM-BENEFIT-TYPE           PIC X.
  4037             20  AM-BENEFIT-REVISION       PIC XXX.
  4038             20  AM-BENEFIT-REM-TERM       PIC X.
  4039             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4040             20  FILLER                    PIC XX.
  4041         16  FILLER                        PIC X(80).
  4042
  4043     12  AM-TRANSFER-DATA.
  4044         16  AM-TRANSFERRED-FROM.
  4045             20  AM-TRNFROM-CARRIER        PIC X.
  4046             20  AM-TRNFROM-GROUPING.
  4047                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4048                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4049             20  AM-TRNFROM-STATE          PIC XX.
  4050             20  AM-TRNFROM-ACCOUNT.
  4051                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4052                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4053             20  AM-TRNFROM-DTE            PIC XX.
  4054         16  AM-TRANSFERRED-TO.
  4055             20  AM-TRNTO-CARRIER          PIC X.
  4056             20  AM-TRNTO-GROUPING.
  4057                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4058                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4059             20  AM-TRNTO-STATE            PIC XX.
  4060             20  AM-TRNTO-ACCOUNT.
  4061                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4062                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4063             20  AM-TRNTO-DTE              PIC XX.
  4064         16  FILLER                        PIC X(10).
  4065
  4066     12  AM-SAVED-REMIT-TO                 PIC 99.
  4067
  4068     12  AM-COMM-STRUCTURE-SAVED.
  4069         16  AM-DEFN-1-SAVED.
  4070             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4071                 24  AM-AGT-SV             PIC X(10).
  4072                 24  AM-COM-TYP-SV         PIC X.
  4073                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  72
* EL677.cbl
  4074                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4075                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4076                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4077                 24  FILLER                PIC X.
  4078                 24  AM-GL-CODES-SV        PIC X.
  4079                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4080                 24  FILLER                PIC X.
  4081         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4082             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4083                 24  FILLER                PIC X(11).
  4084                 24  AM-L-COMA-SV          PIC XXX.
  4085                 24  AM-J-COMA-SV          PIC XXX.
  4086                 24  AM-A-COMA-SV          PIC XXX.
  4087                 24  FILLER                PIC X(6).
  4088
  4089     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4090         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4091            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4092            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4093            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4094
  4095     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4096     12  FILLER                            PIC X(120).
  4097
  4098     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4099         16  AM-CONTROL-NAME               PIC X(30).
  4100         16  AM-EXECUTIVE-ONE.
  4101             20  AM-EXEC1-NAME             PIC X(15).
  4102             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4103                                                          COMP-3.
  4104             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4105                                                          COMP-3.
  4106         16  AM-EXECUTIVE-TWO.
  4107             20  AM-EXEC2-NAME             PIC X(15).
  4108             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4109                                                          COMP-3.
  4110             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4111                                                          COMP-3.
  4112
  4113     12  AM-RETRO-ADDITIONAL-DATA.
  4114         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4115         16  AM-RETRO-PREM-P-E             PIC X.
  4116         16  AM-RETRO-CLMS-P-I             PIC X.
  4117         16  AM-RETRO-RET-BRACKET-LF.
  4118             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4119                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4120                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4121             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4122                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4123                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4124             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4125                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4126                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4127         16  AM-RETRO-RET-BRACKET-AH.
  4128             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4129                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4130                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4131                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  73
* EL677.cbl
  4132             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4133                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4134                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4135             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4136                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4137                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4138
  4139     12  AM-COMMENTS.
  4140         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4141
  4142     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4143         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4144         16  AM-FLI-BILLING-CODE           PIC X.
  4145         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4146         16  AM-FLI-UNITED-IDENT           PIC X.
  4147         16  AM-FLI-INTEREST-LOST-DATA.
  4148             20  AM-FLI-BANK-NO            PIC X(5).
  4149             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4150             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4151             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4152         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4153             20  AM-FLI-AGT                PIC X(9).
  4154             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4155             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4156         16  FILLER                        PIC X(102).
  4157
  4158     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4159         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4160             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4161             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4162             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4163             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4164             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4165         16  FILLER                          PIC X(10).
  4166******************************************************************
  4167*                                    COPY ERCCOMP.
  4168******************************************************************
  4169*                                                                *
  4170*                                                                *
  4171*                            ERCCOMP                             *
  4172*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4173*                            VMOD=2.019                          *
  4174*                                                                *
  4175*   ONLINE CREDIT SYSTEM                                         *
  4176*                                                                *
  4177*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4178*                                                                *
  4179*   FILE TYPE = VSAM,KSDS                                        *
  4180*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4181*                                                                *
  4182*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4183*       ALTERNATE PATH = NONE                                    *
  4184*                                                                *
  4185*   LOG = NO                                                     *
  4186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4187*                                                                *
  4188******************************************************************
  4189*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  74
* EL677.cbl
  4190*
  4191* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4192*-----------------------------------------------------------------
  4193*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4194* EFFECTIVE    NUMBER
  4195*-----------------------------------------------------------------
  4196* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4197* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4198* 092205    2005050300006  PEMA  ADD LEASE FEE
  4199* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4200* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4201* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4202* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4203* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4204* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4205******************************************************************
  4206
  4207 01  COMPENSATION-MASTER.
  4208     12  CO-RECORD-ID                          PIC XX.
  4209         88  VALID-CO-ID                          VALUE 'CO'.
  4210
  4211     12  CO-CONTROL-PRIMARY.
  4212         16  CO-COMPANY-CD                     PIC X.
  4213         16  CO-CONTROL.
  4214             20  CO-CTL-1.
  4215                 24  CO-CARR-GROUP.
  4216                     28  CO-CARRIER            PIC X.
  4217                     28  CO-GROUPING.
  4218                         32  CO-GROUP-PREFIX   PIC XXX.
  4219                         32  CO-GROUP-PRIME    PIC XXX.
  4220                 24  CO-RESP-NO.
  4221                     28  CO-RESP-PREFIX        PIC X(4).
  4222                     28  CO-RESP-PRIME         PIC X(6).
  4223             20  CO-CTL-2.
  4224                 24  CO-ACCOUNT.
  4225                     28  CO-ACCT-PREFIX        PIC X(4).
  4226                     28  CO-ACCT-PRIME         PIC X(6).
  4227         16  CO-TYPE                           PIC X.
  4228             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4229             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4230             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4231
  4232     12  CO-MAINT-INFORMATION.
  4233         16  CO-LAST-MAINT-DT                  PIC XX.
  4234         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4235         16  CO-LAST-MAINT-USER                PIC X(4).
  4236     12  FILLER                                PIC XX.
  4237     12  CO-STMT-TYPE                          PIC XXX.
  4238     12  CO-COMP-TYPE                          PIC X.
  4239         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4240     12  CO-STMT-OWNER                         PIC X(4).
  4241     12  CO-BALANCE-CONTROL                    PIC X.
  4242         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4243         88  CO-NO-BALANCE                        VALUE 'N'.
  4244
  4245     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4246         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4247         88  CO-AUTO-GENERATED                    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  75
* EL677.cbl
  4248         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4249
  4250     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4251         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4252         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4253
  4254     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4255     12  CO-GA-DIRECT-DEP                      PIC X.
  4256     12  CO-FUTURE-SPACE                       PIC X.
  4257         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4258
  4259     12  CO-ACCT-NAME                          PIC X(30).
  4260     12  CO-MAIL-NAME                          PIC X(30).
  4261     12  CO-ADDR-1                             PIC X(30).
  4262     12  CO-ADDR-2                             PIC X(30).
  4263     12  CO-ADDR-3.
  4264         16  CO-ADDR-CITY                      PIC X(27).
  4265         16  CO-ADDR-STATE                     PIC XX.
  4266     12  CO-CSO-1099                           PIC X.
  4267     12  CO-ZIP.
  4268         16  CO-ZIP-PRIME.
  4269             20  CO-ZIP-PRI-1ST                PIC X.
  4270                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4271             20  FILLER                        PIC X(4).
  4272         16  CO-ZIP-PLUS4                      PIC X(4).
  4273     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4274         16  CO-CAN-POSTAL-1                   PIC XXX.
  4275         16  CO-CAN-POSTAL-2                   PIC XXX.
  4276         16  FILLER                            PIC XXX.
  4277     12  CO-SOC-SEC                            PIC X(13).
  4278     12  CO-TELEPHONE.
  4279         16  CO-AREA-CODE                      PIC XXX.
  4280         16  CO-PREFIX                         PIC XXX.
  4281         16  CO-PHONE                          PIC X(4).
  4282
  4283     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4284
  4285     12  CO-AR-BAL-LEVEL                       PIC X.
  4286         88  CO-AR-REF-LVL                        VALUE '1'.
  4287         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4288         88  CO-AR-BILL-LVL                       VALUE '2'.
  4289         88  CO-AR-AGT-LVL                        VALUE '3'.
  4290         88  CO-AR-FR-LVL                         VALUE '4'.
  4291
  4292     12  CO-AR-NORMAL-PRINT                    PIC X.
  4293         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4294         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4295
  4296     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4297
  4298     12  CO-AR-REPORTING                       PIC X.
  4299         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4300         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4301
  4302     12  CO-AR-PULL-CHECK                      PIC X.
  4303         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4304         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4305
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  76
* EL677.cbl
  4306     12  CO-AR-BALANCE-PRINT                   PIC X.
  4307         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4308
  4309     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4310         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4311         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4312         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4313
  4314     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4315
  4316     12  CO-USER-CODE                          PIC X.
  4317     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4318
  4319******************************************************************
  4320*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4321*    THE LAST MONTH END RUN.
  4322******************************************************************
  4323
  4324     12  CO-LAST-ACTIVITY-DATE.
  4325         16  CO-ACT-YEAR                       PIC 99.
  4326         16  CO-ACT-MONTH                      PIC 99.
  4327         16  CO-ACT-DAY                        PIC 99.
  4328
  4329     12  CO-LAST-STMT-DT.
  4330         16  CO-LAST-STMT-YEAR                 PIC 99.
  4331         16  CO-LAST-STMT-MONTH                PIC 99.
  4332         16  CO-LAST-STMT-DAY                  PIC 99.
  4333
  4334     12  CO-MO-END-TOTALS.
  4335         16  CO-MONTHLY-TOTALS.
  4336             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4337             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4338             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4339             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4340             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4341
  4342         16  CO-AGING-TOTALS.
  4343             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4344             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4345             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4346             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4347
  4348         16  CO-YTD-TOTALS.
  4349             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4350             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4351
  4352         16  CO-OVER-UNDER-TOTALS.
  4353             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4354             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4355
  4356     12  CO-MISCELLANEOUS-TOTALS.
  4357         16  CO-FICA-TOTALS.
  4358             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4359             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4360
  4361         16  CO-CLAIM-TOTALS.
  4362             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4363             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  77
* EL677.cbl
  4364
  4365******************************************************************
  4366*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4367*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4368******************************************************************
  4369
  4370     12  CO-CURRENT-TOTALS.
  4371         16  CO-CURRENT-LAST-STMT-DT.
  4372             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4373             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4374             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4375
  4376         16  CO-CURRENT-MONTHLY-TOTALS.
  4377             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4378             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4379             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4380             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4381             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4382
  4383         16  CO-CURRENT-AGING-TOTALS.
  4384             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4385             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4386             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4387             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4388
  4389         16  CO-CURRENT-YTD-TOTALS.
  4390             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4391             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4392
  4393     12  CO-PAID-COMM-TOTALS.
  4394         16  CO-YTD-PAID-COMMS.
  4395             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4396             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4397
  4398     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4399         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4400         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4401
  4402     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4403         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4404         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4405         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4406         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4407         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4408         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4409         88  CO-FINAL-LETTER                  VALUE 'F'.
  4410         88  CO-RECONCILING                   VALUE 'R'.
  4411         88  CO-PHONE-CALL                    VALUE 'P'.
  4412         88  CO-LEGAL                         VALUE 'L'.
  4413         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4414         88  CO-WRITE-OFF                     VALUE 'W'.
  4415         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4416
  4417     12  CO-CSR-CODE                       PIC X(4).
  4418
  4419     12  CO-GA-STATUS-INFO.
  4420         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4421         16  CO-GA-TERMINATION-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  78
* EL677.cbl
  4422         16  CO-GA-STATUS-CODE             PIC X.
  4423             88  CO-GA-ACTIVE                 VALUE 'A'.
  4424             88  CO-GA-INACTIVE               VALUE 'I'.
  4425             88  CO-GA-PENDING                VALUE 'P'.
  4426         16  CO-GA-COMMENTS.
  4427             20  CO-GA-COMMENT-1           PIC X(40).
  4428             20  CO-GA-COMMENT-2           PIC X(40).
  4429             20  CO-GA-COMMENT-3           PIC X(40).
  4430             20  CO-GA-COMMENT-4           PIC X(40).
  4431
  4432     12  CO-RPTCD2                         PIC X(10).
  4433     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4434         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4435         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4436
  4437     12  CO-TYPE-AGENT                     PIC X(01).
  4438         88  CO-CORPORATION                   VALUE 'C'.
  4439         88  CO-PARTNERSHIP                   VALUE 'P'.
  4440         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4441         88  CO-TRUST                         VALUE 'T'.
  4442         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4443
  4444     12  CO-FAXNO.
  4445         16  CO-FAX-AREA-CODE                  PIC XXX.
  4446         16  CO-FAX-PREFIX                     PIC XXX.
  4447         16  CO-FAX-PHONE                      PIC X(4).
  4448
  4449     12  CO-BANK-INFORMATION.
  4450         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4451         16  CO-BANK-TRANSIT-NON REDEFINES
  4452             CO-BANK-TRANSIT-NO                PIC 9(8).
  4453
  4454         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4455     12  CO-MISC-DEDUCT-INFO REDEFINES
  4456                  CO-BANK-INFORMATION.
  4457         16  CO-MD-GL-ACCT                     PIC X(10).
  4458         16  CO-MD-DIV                         PIC XX.
  4459         16  CO-MD-CENTER                      PIC X(4).
  4460         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4461         16  CO-CREATE-AP-CHECK                PIC X.
  4462         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4463         16  FILLER                            PIC XXX.
  4464     12  CO-ACH-STATUS                         PIC X.
  4465         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4466         88  CO-ACH-PENDING                        VALUE 'P'.
  4467
  4468     12  CO-BILL-SW                            PIC X.
  4469     12  CO-CONTROL-NAME                       PIC X(30).
  4470     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4471     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4472     12  CO-CLP-STATE                          PIC XX.
  4473     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4474     12  CO-SPP-REFUND-EDIT                    PIC X.
  4475
  4476******************************************************************
  4477*                                    COPY ELCCERT.
  4478******************************************************************
  4479*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  79
* EL677.cbl
  4480*                            ELCCERT.                            *
  4481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4482*                            VMOD=2.013                          *
  4483*                                                                *
  4484*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4485*                                                                *
  4486*   FILE TYPE = VSAM,KSDS                                        *
  4487*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4488*                                                                *
  4489*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4490*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4491*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4492*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4493*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4494*                                                                *
  4495*   LOG = YES                                                    *
  4496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4497******************************************************************
  4498*                   C H A N G E   L O G
  4499*
  4500* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4501*-----------------------------------------------------------------
  4502*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4503* EFFECTIVE    NUMBER
  4504*-----------------------------------------------------------------
  4505* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4506* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4507* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4508* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4509* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4510* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4511* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4512* 032612  CR2011110200001  PEMA  AHL CHANGES
  4513* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4514* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4515******************************************************************
  4516
  4517 01  CERTIFICATE-MASTER.
  4518     12  CM-RECORD-ID                      PIC XX.
  4519         88  VALID-CM-ID                      VALUE 'CM'.
  4520
  4521     12  CM-CONTROL-PRIMARY.
  4522         16  CM-COMPANY-CD                 PIC X.
  4523         16  CM-CARRIER                    PIC X.
  4524         16  CM-GROUPING.
  4525             20  CM-GROUPING-PREFIX        PIC X(3).
  4526             20  CM-GROUPING-PRIME         PIC X(3).
  4527         16  CM-STATE                      PIC XX.
  4528         16  CM-ACCOUNT.
  4529             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4530             20  CM-ACCOUNT-PRIME          PIC X(6).
  4531         16  CM-CERT-EFF-DT                PIC XX.
  4532         16  CM-CERT-NO.
  4533             20  CM-CERT-PRIME             PIC X(10).
  4534             20  CM-CERT-SFX               PIC X.
  4535
  4536     12  CM-CONTROL-BY-NAME.
  4537         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  80
* EL677.cbl
  4538         16  CM-INSURED-LAST-NAME          PIC X(15).
  4539         16  CM-INSURED-INITIALS.
  4540             20  CM-INSURED-INITIAL1       PIC X.
  4541             20  CM-INSURED-INITIAL2       PIC X.
  4542
  4543     12  CM-CONTROL-BY-SSN.
  4544         16  CM-COMPANY-CD-A2              PIC X.
  4545         16  CM-SOC-SEC-NO.
  4546             20  CM-SSN-STATE              PIC XX.
  4547             20  CM-SSN-ACCOUNT            PIC X(6).
  4548             20  CM-SSN-LN3.
  4549                 25  CM-INSURED-INITIALS-A2.
  4550                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4551                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4552                 25 CM-PART-LAST-NAME-A2         PIC X.
  4553
  4554     12  CM-CONTROL-BY-CERT-NO.
  4555         16  CM-COMPANY-CD-A4              PIC X.
  4556         16  CM-CERT-NO-A4                 PIC X(11).
  4557
  4558     12  CM-CONTROL-BY-MEMB.
  4559         16  CM-COMPANY-CD-A5              PIC X.
  4560         16  CM-MEMBER-NO.
  4561             20  CM-MEMB-STATE             PIC XX.
  4562             20  CM-MEMB-ACCOUNT           PIC X(6).
  4563             20  CM-MEMB-LN4.
  4564                 25  CM-INSURED-INITIALS-A5.
  4565                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4566                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4567                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4568
  4569     12  CM-INSURED-PROFILE-DATA.
  4570         16  CM-INSURED-FIRST-NAME.
  4571             20  CM-INSURED-1ST-INIT       PIC X.
  4572             20  FILLER                    PIC X(9).
  4573         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4574         16  CM-INSURED-SEX                PIC X.
  4575             88  CM-SEX-MALE                  VALUE 'M'.
  4576             88  CM-SEX-FEMAL                 VALUE 'F'.
  4577         16  CM-INSURED-JOINT-AGE          PIC 99.
  4578         16  CM-JOINT-INSURED-NAME.
  4579             20  CM-JT-LAST-NAME           PIC X(15).
  4580             20  CM-JT-FIRST-NAME.
  4581                 24  CM-JT-1ST-INIT        PIC X.
  4582                 24  FILLER                PIC X(9).
  4583             20  CM-JT-INITIAL             PIC X.
  4584
  4585     12  CM-LIFE-DATA.
  4586         16  CM-LF-BENEFIT-CD              PIC XX.
  4587         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4588         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4589         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4590         16  CM-LF-DEV-CODE                PIC XXX.
  4591         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4592         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4593         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4594         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4595         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  81
* EL677.cbl
  4596         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4597         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4598         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4599         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4600         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4601         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4602         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4603         16  cm-temp-epiq                  pic xx.
  4604             88  EPIQ-CLASS                  value 'EQ'.
  4605*        16  FILLER                        PIC XX.
  4606
  4607     12  CM-AH-DATA.
  4608         16  CM-AH-BENEFIT-CD              PIC XX.
  4609         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4610         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4611         16  CM-AH-DEV-CODE                PIC XXX.
  4612         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4613         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4614         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4615         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4616         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4617         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4618         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4619         16  CM-AH-PAID-THRU-DT            PIC XX.
  4620             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4621         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4622         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4623         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4624         16  FILLER                        PIC X.
  4625
  4626     12  CM-LOAN-INFORMATION.
  4627         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4628         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4629                                           PIC S9(5)V99  COMP-3.
  4630         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4631         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4632         16  CM-PAY-FREQUENCY              PIC S99.
  4633         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4634         16  CM-RATE-CLASS                 PIC XX.
  4635         16  CM-BENEFICIARY                PIC X(25).
  4636         16  CM-POLICY-FORM-NO             PIC X(12).
  4637         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4638         16  CM-LAST-ADD-ON-DT             PIC XX.
  4639         16  CM-DEDUCTIBLE-AMOUNTS.
  4640             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4641             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4642         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4643             20  CM-RESIDENT-STATE         PIC XX.
  4644             20  CM-RATE-CODE              PIC X(4).
  4645             20  FILLER                    PIC XX.
  4646         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4647             20  CM-LOAN-OFFICER           PIC X(5).
  4648             20  FILLER                    PIC XXX.
  4649         16  CM-CSR-CODE                   PIC XXX.
  4650         16  CM-UNDERWRITING-CODE          PIC X.
  4651             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4652         16  CM-POST-CARD-IND              PIC X.
  4653         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  82
* EL677.cbl
  4654         16  CM-PREMIUM-TYPE               PIC X.
  4655             88  CM-SING-PRM                  VALUE '1'.
  4656             88  CM-O-B-COVERAGE              VALUE '2'.
  4657             88  CM-OPEN-END                  VALUE '3'.
  4658         16  CM-IND-GRP-TYPE               PIC X.
  4659             88  CM-INDIVIDUAL                VALUE 'I'.
  4660             88  CM-GROUP                     VALUE 'G'.
  4661         16  CM-SKIP-CODE                  PIC X.
  4662             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4663             88  SKIP-JULY                    VALUE '1'.
  4664             88  SKIP-AUGUST                  VALUE '2'.
  4665             88  SKIP-SEPTEMBER               VALUE '3'.
  4666             88  SKIP-JULY-AUG                VALUE '4'.
  4667             88  SKIP-AUG-SEPT                VALUE '5'.
  4668             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4669             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4670             88  SKIP-JUNE                    VALUE '8'.
  4671             88  SKIP-JUNE-JULY               VALUE '9'.
  4672             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4673             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4674         16  CM-PAYMENT-MODE               PIC X.
  4675             88  PAY-MONTHLY                  VALUE SPACE.
  4676             88  PAY-WEEKLY                   VALUE '1'.
  4677             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4678             88  PAY-BI-WEEKLY                VALUE '3'.
  4679             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4680         16  CM-LOAN-NUMBER                PIC X(8).
  4681         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4682         16  CM-OLD-LOF                    PIC XXX.
  4683*        16  CM-LOAN-OFFICER               PIC XXX.
  4684         16  CM-REIN-TABLE                 PIC XXX.
  4685         16  CM-SPECIAL-REIN-CODE          PIC X.
  4686         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4687         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4688         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4689
  4690     12  CM-STATUS-DATA.
  4691         16  CM-ENTRY-STATUS               PIC X.
  4692         16  CM-ENTRY-DT                   PIC XX.
  4693
  4694         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4695         16  CM-LF-CANCEL-DT               PIC XX.
  4696         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4697
  4698         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4699         16  CM-LF-DEATH-DT                PIC XX.
  4700         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4701
  4702         16  CM-LF-CURRENT-STATUS          PIC X.
  4703             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4704                                                'M' '4' '5' '9'.
  4705             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4706             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4707             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4708             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4709             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4710             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4711             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  83
* EL677.cbl
  4712             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4713             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4714             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4715             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4716             88  CM-LF-DECLINED               VALUE 'D'.
  4717             88  CM-LF-VOIDED                 VALUE 'V'.
  4718
  4719         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4720         16  CM-AH-CANCEL-DT               PIC XX.
  4721         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4722
  4723         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4724         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4725         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4726
  4727         16  CM-AH-CURRENT-STATUS          PIC X.
  4728             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4729                                                'M' '4' '5' '9'.
  4730             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4731             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4732             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4733             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4734             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4735             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4736             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4737             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4738             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4739             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4740             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4741             88  CM-AH-DECLINED               VALUE 'D'.
  4742             88  CM-AH-VOIDED                 VALUE 'V'.
  4743
  4744         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4745             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4746             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4747             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4748         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4749
  4750         16  CM-ENTRY-BATCH                PIC X(6).
  4751         16  CM-LF-EXIT-BATCH              PIC X(6).
  4752         16  CM-AH-EXIT-BATCH              PIC X(6).
  4753         16  CM-LAST-MONTH-END             PIC XX.
  4754
  4755     12  CM-NOTE-SW                        PIC X.
  4756         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4757         88  CERT-NOTES-PRESENT               VALUE '1'.
  4758         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4759         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4760         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4761         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4762         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4763         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4764     12  CM-COMP-EXCP-SW                   PIC X.
  4765         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4766         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4767     12  CM-INSURED-ADDRESS-SW             PIC X.
  4768         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4769         88  INSURED-ADDR-PRESENT             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  84
* EL677.cbl
  4770
  4771*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4772     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4773     12  FILLER                            PIC X.
  4774
  4775*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4776     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4777     12  FILLER                            PIC X.
  4778*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4779     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4780
  4781     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4782         88  CERT-ADDED-BATCH                 VALUE ' '.
  4783         88  CERT-ADDED-ONLINE                VALUE '1'.
  4784         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4785         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4786         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4787     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4788         88  CERT-AS-LOADED                   VALUE ' '.
  4789         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4790         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4791         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4792         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4793         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4794         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4795         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4796
  4797     12  CM-ACCOUNT-COMM-PCTS.
  4798         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4799         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4800
  4801     12  CM-USER-FIELD                     PIC X.
  4802     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4803     12  CM-CLP-STATE                      PIC XX.
  4804     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4805     12  CM-USER-RESERVED                  PIC XXX.
  4806     12  FILLER REDEFINES CM-USER-RESERVED.
  4807         16  CM-AH-CLASS-CD                PIC XX.
  4808         16  F                             PIC X.
  4809******************************************************************
  4810*                                    COPY ERCPNDB.
  4811******************************************************************
  4812*                                                                *
  4813*                                                                *
  4814*                            ERCPNDB.                            *
  4815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4816*                            VMOD=2.025                          *
  4817*                                                                *
  4818*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4819*                                                                *
  4820******************************************************************
  4821*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4822*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4823******************************************************************
  4824*                                                                *
  4825*                                                                *
  4826*   FILE TYPE = VSAM,KSDS                                        *
  4827*   RECORD SIZE = 585  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  85
* EL677.cbl
  4828*                                                                *
  4829*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4830*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4831*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4832*                                                 RKP=13,LEN=36  *
  4833*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4834*                                      AND CHG-SEQ.)             *
  4835*                                                RKP=49,LEN=11   *
  4836*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4837*                                      AND CHG-SEQ.)             *
  4838*                                                RKP=60,LEN=15   *
  4839*                                                                *
  4840*   LOG = NO                                                     *
  4841*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4842******************************************************************
  4843******************************************************************
  4844*                   C H A N G E   L O G
  4845*
  4846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4847*-----------------------------------------------------------------
  4848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4849* EFFECTIVE    NUMBER
  4850*-----------------------------------------------------------------
  4851* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4852* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4853* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4854* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4855* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4856* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4857* 032306                   PEMA  ADD BOW LOAN NUMBER
  4858* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4859* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4860* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4861* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4862* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4863* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4864* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4865* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4866* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4867* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4868******************************************************************
  4869
  4870 01  PENDING-BUSINESS.
  4871     12  PB-RECORD-ID                     PIC XX.
  4872         88  VALID-PB-ID                        VALUE 'PB'.
  4873
  4874     12  PB-CONTROL-PRIMARY.
  4875         16  PB-COMPANY-CD                PIC X.
  4876         16  PB-ENTRY-BATCH               PIC X(6).
  4877         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4878         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4879
  4880     12  PB-CONTROL-BY-ACCOUNT.
  4881         16  PB-COMPANY-CD-A1             PIC X.
  4882         16  PB-CARRIER                   PIC X.
  4883         16  PB-GROUPING.
  4884             20  PB-GROUPING-PREFIX       PIC XXX.
  4885             20  PB-GROUPING-PRIME        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  86
* EL677.cbl
  4886         16  PB-STATE                     PIC XX.
  4887         16  PB-ACCOUNT.
  4888             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4889             20  PB-ACCOUNT-PRIME         PIC X(6).
  4890         16  PB-CERT-EFF-DT               PIC XX.
  4891         16  PB-CERT-NO.
  4892             20  PB-CERT-PRIME            PIC X(10).
  4893             20  PB-CERT-SFX              PIC X.
  4894         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4895
  4896         16  PB-RECORD-TYPE               PIC X.
  4897             88  PB-MAILING-DATA                VALUE '0'.
  4898             88  PB-ISSUE                       VALUE '1'.
  4899             88  PB-CANCELLATION                VALUE '2'.
  4900             88  PB-BATCH-TRAILER               VALUE '9'.
  4901
  4902     12  PB-CONTROL-BY-ORIG-BATCH.
  4903         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4904         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4905         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4906         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4907
  4908     12  PB-CONTROL-BY-CSR.
  4909         16  PB-CSR-COMPANY-CD            PIC X.
  4910         16  PB-CSR-ID                    PIC X(4).
  4911         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4912         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4913         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4914******************************************************************
  4915*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4916******************************************************************
  4917
  4918     12  PB-LAST-MAINT-DT                 PIC XX.
  4919     12  PB-LAST-MAINT-BY                 PIC X(4).
  4920     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4921
  4922     12  PB-RECORD-BODY                   PIC X(375).
  4923
  4924     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4925         16  PB-CERT-ORIGIN               PIC X.
  4926             88  CLASIC-CREATED-CERT         VALUE '1'.
  4927         16  PB-I-NAME.
  4928             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4929             20  PB-I-INSURED-FIRST-NAME.
  4930                 24  PB-I-INSURED-1ST-INIT PIC X.
  4931                 24  FILLER                PIC X(9).
  4932             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4933         16  PB-I-AGE                     PIC S99   COMP-3.
  4934         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4935         16  PB-I-BIRTHDAY                PIC XX.
  4936         16  PB-I-INSURED-SEX             PIC X.
  4937             88  PB-SEX-MALE     VALUE 'M'.
  4938             88  PB-SEX-FEMALE   VALUE 'F'.
  4939
  4940         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4941         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4942         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4943         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  87
* EL677.cbl
  4944         16  PB-I-SKIP-CODE               PIC X.
  4945             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4946             88  PB-SKIP-JULY              VALUE '1'.
  4947             88  PB-SKIP-AUGUST            VALUE '2'.
  4948             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4949             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4950             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4951             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4952             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4953             88  PB-SKIP-JUNE              VALUE '8'.
  4954             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4955             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4956             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4957         16  PB-I-TERM-TYPE               PIC X.
  4958             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4959             88  PB-PAID-WEEKLY            VALUE 'W'.
  4960             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4961             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4962             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4963         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4964         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4965         16  PB-I-DATA-ENTRY-SW           PIC X.
  4966             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4967             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4968             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4969             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4970         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4971         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4972*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4973         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4974         16  FILLER                       PIC X.
  4975
  4976         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4977             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4978             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4979                                                   '90' THRU '99'.
  4980         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4981                                          PIC XX.
  4982         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4983         16  PB-I-AMOUNT-FINANCED REDEFINES
  4984                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4985         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4986         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4987                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4988         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4989         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4990         16  PB-I-CLP-AMOUNT REDEFINES
  4991                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4992         16  PB-I-LF-CALC-FLAG            PIC X.
  4993             88 PB-COMP-LF-PREM               VALUE '?'.
  4994         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4995         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4996         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4997         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4998         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4999         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5000         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5001         16  PB-I-LF-ABBR                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  88
* EL677.cbl
  5002         16  PB-I-LF-INPUT-CD             PIC XX.
  5003
  5004         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5005             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5006             88  PB-INVALID-AH               VALUE '  ' '00'
  5007                                                   '90' THRU '99'.
  5008         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5009         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5010         16  PB-I-AH-CALC-FLAG            PIC X.
  5011             88 PB-COMP-AH-PREM                  VALUE '?'.
  5012         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5013         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5014         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5015         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5016         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5017         16  PB-I-AH-ABBR                 PIC XXX.
  5018         16  PB-I-AH-INPUT-CD             PIC XXX.
  5019
  5020         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5021         16  PB-I-REIN-TABLE              PIC XXX.
  5022         16  PB-I-BUSINESS-TYPE           PIC 99.
  5023         16  PB-I-INDV-GRP-CD             PIC X.
  5024         16  PB-I-MORT-CODE.
  5025             20  PB-I-TABLE               PIC X.
  5026             20  PB-I-INTEREST            PIC XX.
  5027             20  PB-I-MORT-TYP            PIC X.
  5028         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5029         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5030         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5031         16  PB-I-INDV-GRP-OVRD           PIC X.
  5032         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5033         16  PB-I-SIG-SW                  PIC X.
  5034             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5035         16  PB-I-RATE-CLASS              PIC XX.
  5036         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5037         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5038         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5039         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5040         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5041         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5042         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5043         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5044         16  PB-I-OB-FLAG                 PIC X.
  5045             88  PB-I-OB                      VALUE 'B'.
  5046             88  PB-I-SUMMARY                 VALUE 'Z'.
  5047         16  PB-I-ENTRY-STATUS            PIC X.
  5048             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5049                                              'M' '5' '9' '2'.
  5050             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5051             88  PB-I-POLICY-PENDING          VALUE '2'.
  5052             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5053             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5054             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5055             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5056             88  PB-I-REIN-ONLY               VALUE '9'.
  5057             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5058             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5059             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  89
* EL677.cbl
  5060             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5061         16  PB-I-INT-CODE                PIC X.
  5062             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5063             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5064         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5065         16  PB-I-SOC-SEC-NO              PIC X(11).
  5066         16  PB-I-MEMBER-NO               PIC X(12).
  5067         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5068*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5069         16  PB-I-OLD-LOF                 PIC XXX.
  5070         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5071         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5072         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5073         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5074         16  PB-I-LIFE-INDICATOR          PIC X.
  5075             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5076         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5077         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5078                                          PIC S9(5)V99    COMP-3.
  5079         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5080             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5081             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5082         16  PB-I-1ST-PMT-DT              PIC XX.
  5083         16  PB-I-JOINT-INSURED.
  5084             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5085             20 PB-I-JOINT-FIRST-NAME.
  5086                24  PB-I-JOINT-FIRST-INIT PIC X.
  5087                24  FILLER                PIC X(9).
  5088             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5089*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5090         16  PB-I-BENEFICIARY-NAME.
  5091             20  PB-I-BANK-NUMBER         PIC X(10).
  5092             20  FILLER                   PIC X(15).
  5093         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5094         16  PB-I-REFERENCE               PIC X(12).
  5095         16  FILLER REDEFINES PB-I-REFERENCE.
  5096             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5097             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5098             20  PB-I-CLP-STATE           PIC XX.
  5099         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5100             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5101             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5102             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5103         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5104         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5105         16  PB-I-RESIDENT-STATE          PIC XX.
  5106         16  PB-I-RATE-CODE               PIC X(4).
  5107         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5108         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5109         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5110         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5111         16  PB-I-BANK-NOCHRGB            PIC 99.
  5112         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5113         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5114
  5115     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5116         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5117             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  90
* EL677.cbl
  5118         16  PB-C-CANCEL-ORIGIN           PIC X.
  5119             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5120         16  PB-C-LF-CANCEL-DT            PIC XX.
  5121         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5122         16  PB-C-LF-CALC-REQ             PIC X.
  5123             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5124         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5125         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5126         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5127             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5128         16  PB-C-AH-CANCEL-DT            PIC XX.
  5129         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5130         16  PB-C-AH-CALC-REQ             PIC X.
  5131             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5132         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5133         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5134         16  PB-C-LAST-NAME               PIC X(15).
  5135         16  PB-C-REFUND-SW               PIC X.
  5136             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5137             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5138         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5139         16  PB-C-PAYEE-CODE              PIC X(6).
  5140         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5141         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5142         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5143         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5144         16  PB-C-REFERENCE               PIC X(12).
  5145         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5146         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5147         16  PB-C-POST-CARD-IND           PIC X.
  5148         16  PB-C-CANCEL-REASON           PIC X.
  5149         16  PB-C-REF-INTERFACE-SW        PIC X.
  5150         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5151         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5152         16  FILLER                       PIC X(01).
  5153*        16  FILLER                       PIC X(18).
  5154         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5155*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5156         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5157         16  PB-CANCELED-CERT-DATA.
  5158             20  PB-CI-INSURED-NAME.
  5159                 24  PB-CI-LAST-NAME      PIC X(15).
  5160                 24  PB-CI-INITIALS       PIC XX.
  5161             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5162             20  PB-CI-INSURED-SEX        PIC X.
  5163             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5164             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5165             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5166             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5167             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5168             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5169             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5170             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5171             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5172             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5173             20  PB-CI-RATE-CLASS         PIC XX.
  5174             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5175             20  PB-CI-RATE-DEV-AH        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  91
* EL677.cbl
  5176             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5177             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5178             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5179             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5180             20  PB-CI-LF-ABBR            PIC X(3).
  5181             20  PB-CI-AH-ABBR            PIC X(3).
  5182             20  PB-CI-OB-FLAG            PIC X.
  5183                 88  PB-CI-OB                VALUE 'B'.
  5184             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5185                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5186                                           'M' '4' '5' '9' '2'.
  5187                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5188                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5189                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5190                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5191                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5192                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5193                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5194                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5195                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5196                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5197                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5198                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5199                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5200             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5201                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5202                                           'M' '4' '5' '9' '2'.
  5203                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5204                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5205                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5206                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5207                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5208                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5209                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5210                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5211                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5212                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5213                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5214                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5215                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5216             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5217             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5218             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5219             20  PB-CI-MEMBER-NO          PIC X(12).
  5220             20  PB-CI-INT-CODE           PIC X.
  5221                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5222                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5223             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5224             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5225             20  PB-CI-COMP-EXCP-SW       PIC X.
  5226                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5227                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5228             20  PB-CI-ENTRY-STATUS       PIC X.
  5229             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5230             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5231             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5232             20  PB-CI-DEATH-DT           PIC XX.
  5233             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  92
* EL677.cbl
  5234             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5235             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5236             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5237             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5238             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5239             20  PB-CI-ENTRY-DT              PIC XX.
  5240             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5241             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5242             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5243             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5244             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5245             20  PB-CI-OLD-LOF               PIC XXX.
  5246*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5247             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5248             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5249             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5250             20  PB-CI-INDV-GRP-CD           PIC X.
  5251             20  PB-CI-BENEFICIARY-NAME.
  5252                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5253                 24  FILLER                  PIC X(15).
  5254             20  PB-CI-NOTE-SW               PIC X.
  5255             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5256             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5257             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5258             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5259             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5260             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5261             20  PB-CI-FIRST-NAME            PIC X(10).
  5262             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5263
  5264         16  FILLER                       PIC X(13).
  5265*032306  16  FILLER                       PIC X(27).
  5266*        16  FILLER                       PIC X(46).
  5267
  5268     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5269         16  FILLER                       PIC X(10).
  5270         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5271         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5272         16  PB-M-INSURED-MID-INIT        PIC X.
  5273         16  PB-M-INSURED-AGE             PIC 99.
  5274         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5275         16  PB-M-INSURED-SEX             PIC X.
  5276         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5277         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5278         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5279         16  PB-M-INSURED-CITY-STATE.
  5280             20  PB-M-INSURED-CITY        PIC X(28).
  5281             20  PB-M-INSURED-STATE       PIC XX.
  5282         16  PB-M-INSURED-ZIP-CODE.
  5283             20  PB-M-INSURED-ZIP-PRIME.
  5284                 24  PB-M-INSURED-ZIP-1   PIC X.
  5285                     88  PB-M-CANADIAN-POST-CODE
  5286                                             VALUE 'A' THRU 'Z'.
  5287                 24  FILLER               PIC X(4).
  5288             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5289         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5290                                        PB-M-INSURED-ZIP-CODE.
  5291             20  PM-M-INS-CAN-POST1       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  93
* EL677.cbl
  5292             20  PM-M-INS-CAN-POST2       PIC XXX.
  5293             20  FILLER                   PIC XXX.
  5294         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5295         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5296         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5297         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5298         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5299         16  PB-M-CRED-BENE-CITYST.
  5300             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5301             20  PB-M-CRED-BENE-STATE     PIC XX.
  5302         16  FILLER                       PIC X(92).
  5303
  5304     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5305         16  FILLER                       PIC X(10).
  5306         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5307         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5308         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5309         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5310         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5311         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5312         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5313         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5314         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5315         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5316         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5317         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5318         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5319         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5320         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5321         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5322         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5323         16  PB-ACCOUNT-NAME              PIC X(30).
  5324         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5325         16  PB-REFERENCE                 PIC X(12).
  5326         16  PB-B-RECEIVED-DT             PIC XX.
  5327         16  FILLER                       PIC X(234).
  5328
  5329     12  PB-RECORD-STATUS.
  5330         16  PB-CREDIT-SELECT-DT          PIC XX.
  5331         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5332         16  PB-BILLED-DT                 PIC XX.
  5333         16  PB-BILLING-STATUS            PIC X.
  5334             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5335             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5336             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5337         16  PB-RECORD-BILL               PIC X.
  5338             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5339             88  PB-RECORD-RETURNED           VALUE 'R'.
  5340             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5341             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5342             88  PB-OVERRIDE-AH               VALUE 'A'.
  5343             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5344         16  PB-BATCH-ENTRY               PIC X.
  5345             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5346             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5347             88  PB-REISSUED-CERT             VALUE 'E'.
  5348             88  PB-CASH-CERT                 VALUE 'C'.
  5349             88  PB-MONTHLY-CERT              VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  94
* EL677.cbl
  5350             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5351             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5352             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5353         16  PB-FORCE-CODE                PIC X.
  5354             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5355             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5356             88  PB-CANCEL-FORCE              VALUE '8'.
  5357             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5358             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5359             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5360             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5361             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5362             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5363             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5364         16  PB-FATAL-FLAG                PIC X.
  5365             88  PB-FATAL-ERRORS              VALUE 'X'.
  5366         16  PB-FORCE-ER-CD               PIC X.
  5367             88  PB-FORCE-ERRORS              VALUE 'F'.
  5368             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5369         16  PB-WARN-ER-CD                PIC X.
  5370             88  PB-WARNING-ERRORS            VALUE 'W'.
  5371         16  FILLER                       PIC X.
  5372         16  PB-OUT-BAL-CD                PIC X.
  5373             88  PB-OUT-OF-BAL                VALUE 'O'.
  5374         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5375         16  PB-AH-OVERRIDE-L1            PIC X.
  5376         16  PB-INPUT-DT                  PIC XX.
  5377         16  PB-INPUT-BY                  PIC X(4).
  5378         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5379         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5380         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5381         16  PB-LF-EARNING-METHOD         PIC X.
  5382         16  PB-AH-EARNING-METHOD         PIC X.
  5383         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5384         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5385         16  PB-REIN-CD                   PIC XXX.
  5386         16  PB-LF-REFUND-TYPE            PIC X.
  5387         16  PB-AH-REFUND-TYPE            PIC X.
  5388         16  PB-ACCT-EFF-DT               PIC XX.
  5389         16  PB-ACCT-EXP-DT               PIC XX.
  5390         16  PB-COMPANY-ID                PIC X(3).
  5391         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5392         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5393         16  PB-SV-CARRIER                PIC X.
  5394         16  PB-SV-GROUPING               PIC X(6).
  5395         16  PB-SV-STATE                  PIC XX.
  5396         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5397         16  PB-GA-BILLING-INFO.
  5398             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5399                                          PIC XX.
  5400         16  PB-SV-REMIT-TO  REDEFINES
  5401             PB-GA-BILLING-INFO           PIC X(10).
  5402         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5403         16  PB-I-LOAN-OFFICER            PIC X(5).
  5404         16  PB-I-VIN                     PIC X(17).
  5405
  5406         16  FILLER                       PIC X(04).
  5407         16  IMNET-BYPASS-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  95
* EL677.cbl
  5408
  5409******************************************************************
  5410*                COMMON EDIT ERRORS                              *
  5411******************************************************************
  5412
  5413     12  PB-COMMON-ERRORS.
  5414         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5415                                           PIC S9(4)     COMP.
  5416
  5417******************************************************************
  5418*                                    COPY ERCPNDM.
  5419******************************************************************
  5420*                                                                *
  5421*                                                                *
  5422*                            ERCPNDM                             *
  5423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5424*                            VMOD=2.003                          *
  5425*                                                                *
  5426*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5427*                                                                *
  5428*   FILE TYPE = VSAM,KSDS                                        *
  5429*   RECORD SIZE = 374   RECFORM = FIX                            *
  5430*                                                                *
  5431*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5432*   ALTERNATE PATH    = NOT USED                                 *
  5433*                                                                *
  5434*   LOG = YES                                                    *
  5435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5436******************************************************************
  5437*                   C H A N G E   L O G
  5438*
  5439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5440*-----------------------------------------------------------------
  5441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5442* EFFECTIVE    NUMBER
  5443*-----------------------------------------------------------------
  5444* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5445* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5446* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5447******************************************************************
  5448
  5449 01  PENDING-MAILING-DATA.
  5450     12  PM-RECORD-ID                      PIC XX.
  5451         88  VALID-MA-ID                       VALUE 'PM'.
  5452
  5453     12  PM-CONTROL-PRIMARY.
  5454         16  PM-COMPANY-CD                 PIC X.
  5455         16  PM-ENTRY-BATCH                PIC X(6).
  5456         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5457         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5458
  5459     12  FILLER                            PIC X(14).
  5460
  5461     12  PM-ACCESS-CONTROL.
  5462         16  PM-SOURCE-SYSTEM              PIC XX.
  5463             88  PM-FROM-CREDIT                VALUE 'CR'.
  5464             88  PM-FROM-VSI                   VALUE 'VS'.
  5465             88  PM-FROM-WARRANTY              VALUE 'WA'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  96
* EL677.cbl
  5466             88  PM-FROM-OTHER                 VALUE 'OT'.
  5467         16  PM-RECORD-ADD-DT              PIC XX.
  5468         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5469         16  PM-LAST-MAINT-DT              PIC XX.
  5470         16  PM-LAST-MAINT-BY              PIC XXXX.
  5471         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5472
  5473     12  PM-PROFILE-INFO.
  5474         16  PM-QUALIFY-CODE-1             PIC XX.
  5475         16  PM-QUALIFY-CODE-2             PIC XX.
  5476         16  PM-QUALIFY-CODE-3             PIC XX.
  5477         16  PM-QUALIFY-CODE-4             PIC XX.
  5478         16  PM-QUALIFY-CODE-5             PIC XX.
  5479
  5480         16  PM-INSURED-LAST-NAME          PIC X(15).
  5481         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5482         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5483         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5484         16  PM-INSURED-BIRTH-DT           PIC XX.
  5485         16  PM-INSURED-SEX                PIC X.
  5486             88  PM-SEX-MALE                   VALUE 'M'.
  5487             88  PM-SEX-FEMALE                 VALUE 'F'.
  5488         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5489
  5490         16  PM-ADDRESS-CORRECTED          PIC X.
  5491         16  PM-JOINT-BIRTH-DT             PIC XX.
  5492*        16  FILLER                        PIC X(12).
  5493
  5494         16  PM-ADDRESS-LINE-1             PIC X(30).
  5495         16  PM-ADDRESS-LINE-2             PIC X(30).
  5496         16  PM-CITY-STATE.
  5497             20  PM-CITY                   PIC X(28).
  5498             20  PM-STATE                  PIC XX.
  5499         16  PM-ZIP.
  5500             20  PM-ZIP-CODE.
  5501                 24  PM-ZIP-1              PIC X.
  5502                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5503                 24  FILLER                PIC X(4).
  5504             20  PM-ZIP-PLUS4              PIC X(4).
  5505         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5506             20  PM-CAN-POST1              PIC XXX.
  5507             20  PM-CAN-POST2              PIC XXX.
  5508             20  FILLER                    PIC XXX.
  5509
  5510         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5511
  5512         16  FILLER                        PIC X(03).
  5513
  5514     12  PM-CRED-BENE-INFO.
  5515         16  PM-CRED-BENE-NAME             PIC X(25).
  5516         16  PM-CRED-BENE-ADDR             PIC X(30).
  5517         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5518         16  PM-CRED-BENE-CTYST.
  5519             20  PM-CRED-BENE-CITY         PIC X(28).
  5520             20  PM-CRED-BENE-STATE        PIC XX.
  5521         16  PM-CRED-BENE-ZIP.
  5522             20  PM-CB-ZIP-CODE.
  5523                 24  PM-CB-ZIP-1           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  97
* EL677.cbl
  5524                     88  PM-CB-CANADIAN-POST-CODE
  5525                                  VALUE 'A' THRU 'Z'.
  5526                 24  FILLER                PIC X(4).
  5527             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5528         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5529             20  PM-CB-CAN-POST1           PIC XXX.
  5530             20  PM-CB-CAN-POST2           PIC XXX.
  5531             20  FILLER                    PIC XXX.
  5532     12  PM-POST-CARD-MAIL-DATA.
  5533         16  PM-MAIL-DATA OCCURS 7.
  5534             20  PM-MAIL-TYPE              PIC X.
  5535                 88  PM-12MO-MAILING           VALUE '1'.
  5536                 88  PM-EXP-MAILING            VALUE '2'.
  5537             20  PM-MAIL-STATUS            PIC X.
  5538                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5539                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5540                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5541             20  PM-MAIL-DATE              PIC XX.
  5542     12  FILLER                            PIC XX.
  5543     12  FILLER                            PIC X(12).
  5544*    12  FILLER                            PIC X(30).
  5545
  5546******************************************************************
  5547*                                    COPY ERCMAIL.
  5548******************************************************************
  5549*                                                                *
  5550*                                                                *
  5551*                            ERCMAIL                             *
  5552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5553*                            VMOD=2.003                          *
  5554*                                                                *
  5555*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5556*                                                                *
  5557*   FILE TYPE = VSAM,KSDS                                        *
  5558*   RECORD SIZE = 374   RECFORM = FIX                            *
  5559*                                                                *
  5560*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5561*   ALTERNATE PATH    = NOT USED                                 *
  5562*                                                                *
  5563*   LOG = YES                                                    *
  5564*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5565******************************************************************
  5566*                   C H A N G E   L O G
  5567*
  5568* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5569*-----------------------------------------------------------------
  5570*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5571* EFFECTIVE    NUMBER
  5572*-----------------------------------------------------------------
  5573* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5574* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5575* 111108                   PEMA  ADD CRED BENE ADDR2
  5576******************************************************************
  5577
  5578 01  MAILING-DATA.
  5579     12  MA-RECORD-ID                      PIC XX.
  5580         88  VALID-MA-ID                       VALUE 'MA'.
  5581
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  98
* EL677.cbl
  5582     12  MA-CONTROL-PRIMARY.
  5583         16  MA-COMPANY-CD                 PIC X.
  5584         16  MA-CARRIER                    PIC X.
  5585         16  MA-GROUPING.
  5586             20  MA-GROUPING-PREFIX        PIC XXX.
  5587             20  MA-GROUPING-PRIME         PIC XXX.
  5588         16  MA-STATE                      PIC XX.
  5589         16  MA-ACCOUNT.
  5590             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5591             20  MA-ACCOUNT-PRIME          PIC X(6).
  5592         16  MA-CERT-EFF-DT                PIC XX.
  5593         16  MA-CERT-NO.
  5594             20  MA-CERT-PRIME             PIC X(10).
  5595             20  MA-CERT-SFX               PIC X.
  5596
  5597     12  FILLER                            PIC XX.
  5598
  5599     12  MA-ACCESS-CONTROL.
  5600         16  MA-SOURCE-SYSTEM              PIC XX.
  5601             88  MA-FROM-CREDIT                VALUE 'CR'.
  5602             88  MA-FROM-VSI                   VALUE 'VS'.
  5603             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5604             88  MA-FROM-OTHER                 VALUE 'OT'.
  5605         16  MA-RECORD-ADD-DT              PIC XX.
  5606         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5607         16  MA-LAST-MAINT-DT              PIC XX.
  5608         16  MA-LAST-MAINT-BY              PIC XXXX.
  5609         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5610
  5611     12  MA-PROFILE-INFO.
  5612         16  MA-QUALIFY-CODE-1             PIC XX.
  5613         16  MA-QUALIFY-CODE-2             PIC XX.
  5614         16  MA-QUALIFY-CODE-3             PIC XX.
  5615         16  MA-QUALIFY-CODE-4             PIC XX.
  5616         16  MA-QUALIFY-CODE-5             PIC XX.
  5617
  5618         16  MA-INSURED-LAST-NAME          PIC X(15).
  5619         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5620         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5621         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5622         16  MA-INSURED-BIRTH-DT           PIC XX.
  5623         16  MA-INSURED-SEX                PIC X.
  5624             88  MA-SEX-MALE                   VALUE 'M'.
  5625             88  MA-SEX-FEMALE                 VALUE 'F'.
  5626         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5627
  5628         16  MA-ADDRESS-CORRECTED          PIC X.
  5629         16  MA-JOINT-BIRTH-DT             PIC XX.
  5630*        16  FILLER                        PIC X(12).
  5631
  5632         16  MA-ADDRESS-LINE-1             PIC X(30).
  5633         16  MA-ADDRESS-LINE-2             PIC X(30).
  5634         16  MA-CITY-STATE.
  5635             20  MA-CITY                   PIC X(28).
  5636             20  MA-ADDR-STATE             PIC XX.
  5637         16  MA-ZIP.
  5638             20  MA-ZIP-CODE.
  5639                 24  MA-ZIP-CODE-1ST       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page  99
* EL677.cbl
  5640                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5641                 24  FILLER                PIC X(4).
  5642             20  MA-ZIP-PLUS4              PIC X(4).
  5643         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5644             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5645             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5646             20  FILLER                    PIC X(3).
  5647
  5648         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5649
  5650         16  FILLER                        PIC XXX.
  5651*        16  FILLER                        PIC X(10).
  5652
  5653     12  MA-CRED-BENE-INFO.
  5654         16  MA-CRED-BENE-NAME                 PIC X(25).
  5655         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5656         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5657         16  MA-CRED-BENE-CTYST.
  5658             20  MA-CRED-BENE-CITY             PIC X(28).
  5659             20  MA-CRED-BENE-STATE            PIC XX.
  5660         16  MA-CRED-BENE-ZIP.
  5661             20  MA-CB-ZIP-CODE.
  5662                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5663                     88  MA-CB-CANADIAN-POST-CODE
  5664                                           VALUE 'A' THRU 'Z'.
  5665                 24  FILLER                    PIC X(4).
  5666             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5667         16  MA-CB-CANADIAN-POSTAL-CODE
  5668                            REDEFINES MA-CRED-BENE-ZIP.
  5669             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5670             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5671             20  FILLER                        PIC X(3).
  5672     12  MA-POST-CARD-MAIL-DATA.
  5673         16  MA-MAIL-DATA OCCURS 7.
  5674             20  MA-MAIL-TYPE              PIC X.
  5675                 88  MA-12MO-MAILING           VALUE '1'.
  5676                 88  MA-EXP-MAILING            VALUE '2'.
  5677             20  MA-MAIL-STATUS            PIC X.
  5678                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5679                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5680                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5681             20  MA-MAIL-DATE              PIC XX.
  5682     12  FILLER                            PIC XX.
  5683     12  FILLER                            PIC XX.
  5684*    12  FILLER                            PIC X(30).
  5685******************************************************************
  5686*                                    COPY ERCPYAJ.
  5687******************************************************************
  5688*                                                                *
  5689*                            ERCPYAJ                             *
  5690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5691*                            VMOD=2.015                          *
  5692*                                                                *
  5693*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5694*                                                                *
  5695*                                                                *
  5696*   FILE TYPE = VSAM,KSDS                                        *
  5697*   RECORD SIZE = 200  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 100
* EL677.cbl
  5698*                                                                *
  5699*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5700*       ALTERNATE PATHS = NONE                                   *
  5701*                                                                *
  5702*   LOG = YES                                                    *
  5703*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5704******************************************************************
  5705******************************************************************
  5706*                   C H A N G E   L O G
  5707*
  5708* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5709*-----------------------------------------------------------------
  5710*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5711* EFFECTIVE    NUMBER
  5712*-----------------------------------------------------------------
  5713* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5714* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5715******************************************************************
  5716
  5717 01  PENDING-PAY-ADJ.
  5718     12  PY-RECORD-ID                     PIC XX.
  5719         88  VALID-PY-ID                        VALUE 'PY'.
  5720
  5721     12  PY-CONTROL-PRIMARY.
  5722         16  PY-COMPANY-CD                PIC X.
  5723         16  PY-CARRIER                   PIC X.
  5724         16  PY-GROUPING                  PIC X(6).
  5725         16  PY-FIN-RESP                  PIC X(10).
  5726         16  PY-ACCOUNT                   PIC X(10).
  5727         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5728                                          PIC X(10).
  5729         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5730         16  PY-RECORD-TYPE               PIC X.
  5731             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5732             88  PY-DEPOSIT                   VALUE 'D'.
  5733             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5734             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5735             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5736             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5737             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5738             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5739             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5740             88  PY-FICA-ENTRY                VALUE 'F'.
  5741             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5742             88  PY-POLICY-FEE                VALUE 'W'.
  5743             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5744
  5745     12  PY-PYMT-TYPE                     PIC X.
  5746             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5747             88  PY-REINS-PYMT                VALUE 'R'.
  5748             88  PY-EXP-PYMT                  VALUE 'E'.
  5749
  5750     12  PY-BIL-INV                       PIC X(6).
  5751     12  PY-REF-NO                        PIC X(12).
  5752
  5753     12  PY-LAST-MAINT-DT                 PIC XX.
  5754     12  PY-LAST-MAINT-BY                 PIC X(4).
  5755     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 101
* EL677.cbl
  5756
  5757     12  PY-PYADJ-RECORD.
  5758         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5759         16  PY-ENTRY-COMMENT             PIC X(30).
  5760         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5761             20  PY-GL-ACCOUNT            PIC X(10).
  5762             20  PY-GL-STATE              PIC X(02).
  5763             20  PY-GL-CANC-SW            PIC X(01).
  5764                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5765                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5766             20  PY-GL-COMMENT            PIC X(10).
  5767             20  FILLER      REDEFINES PY-GL-COMMENT.
  5768                 24  PY-GL-CHECK-NO       PIC 9(06).
  5769                 24  FILLER               PIC X(04).
  5770             20  FILLER                   PIC X(07).
  5771         16  PY-SAVE-ACCOUNT              PIC X(10).
  5772         16  PY-SAVE-TYPE                 PIC X(01).
  5773
  5774         16  PY-LETTERS.
  5775             20  PY-LETTER OCCURS 3 TIMES
  5776                           INDEXED BY PY-LET-NDX
  5777                                          PIC X(04).
  5778
  5779         16  PY-ERCOMP-TYPE               PIC X.
  5780             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5781             88  PY-GA-TYPE                   VALUE 'G'.
  5782             88  PY-BANK-TYPE                 VALUE 'B'.
  5783         16  FILLER                       PIC X(05).
  5784
  5785     12  PY-RECORD-STATUS.
  5786         16  PY-CREDIT-SELECT-DT          PIC XX.
  5787         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5788         16  PY-BILLED-DATE               PIC XX.
  5789         16  PY-REPORTED-DT               PIC XX.
  5790         16  PY-PMT-APPLIED               PIC X.
  5791             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5792             88  PY-GA-PMT                    VALUE 'G'.
  5793             88  PY-OVWRITE-PMT               VALUE 'O'.
  5794             88  PY-NON-AR-PMT                VALUE 'N'.
  5795         16  FILLER                       PIC X(5).
  5796         16  PY-INPUT-DT                  PIC XX.
  5797         16  PY-CHECK-NUMBER              PIC X(6).
  5798         16  PY-VOID-SW                   PIC X.
  5799             88  PY-CHECK-VOIDED              VALUE 'V'.
  5800         16  PY-CHECK-ORIGIN-SW           PIC X.
  5801             88  PY-BILLING-CHECK             VALUE 'B'.
  5802             88  PY-REFUND-CHECK              VALUE 'R'.
  5803             88  PY-GA-CHECK                  VALUE 'G'.
  5804             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5805             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5806         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5807         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5808         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5809         16  PY-BILL-FLAG                 PIC X.
  5810             88  PY-BILLED                    VALUE 'B'.
  5811         16  PY-AR-FLAG                   PIC X.
  5812             88  PY-AR-CYCLE                  VALUE 'C'.
  5813             88  PY-AR-MONTH-END              VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 102
* EL677.cbl
  5814         16  PY-AR-DATE                   PIC XX.
  5815
  5816     12  PY-GL-CODES.
  5817         16  PY-GL-DB                     PIC X(14).
  5818         16  PY-GL-CR                     PIC X(14).
  5819         16  PY-GL-FLAG                   PIC X.
  5820         16  PY-GL-DATE                   PIC XX.
  5821
  5822     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5823     12  FILLER                           PIC X(3).
  5824******************************************************************
  5825 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5826                          CHECK-RECORDS ACCOUNT-MASTER
  5827                          COMPENSATION-MASTER
  5828                          CERTIFICATE-MASTER PENDING-BUSINESS
  5829                          PENDING-MAILING-DATA MAILING-DATA
  5830                          PENDING-PAY-ADJ.
  5831 0000-DFHEXIT SECTION.
  5832     MOVE '9#                    $   ' TO DFHEIV0.
  5833     MOVE 'EL677' TO DFHEIV1.
  5834     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5835
  5836     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5837     MOVE '5'                    TO  DC-OPTION-CODE.
  5838     PERFORM 8500-DATE-CONVERT.
  5839     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5840     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5841     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5842
  5843     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5844
  5845     IF PI-AMOUNT NOT NUMERIC
  5846         MOVE ZEROS              TO  PI-AMOUNT.
  5847
  5848     IF EIBCALEN = 0
  5849         GO TO 8800-UNAUTHORIZED-ACCESS.
  5850     set P to address of KIXSYS
  5851     CALL "getenv" using by value P returning var-ptr
  5852     if var-ptr = null then
  5853        display ' kixsys not set '
  5854     else
  5855        set address of var to var-ptr
  5856        move 0 to env-var-len
  5857        inspect var tallying env-var-len
  5858          for characters before X'00'
  5859        unstring var (1:env-var-len) delimited by '/'
  5860           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5861              WS-KIX-SYS
  5862        end-unstring
  5863     end-if
  5864     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5865     MOVE 2                      TO  EMI-SWITCH2.
  5866     MOVE EIBTRMID               TO  QID-TERM.
  5867
  5868     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5869         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5870
  5871     IF PI-CALLING-PROGRAM NOT = THIS-PGM
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 103
* EL677.cbl
  5872         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5873             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5874             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5875             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5876             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5877             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5878             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5879             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5880             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5881         ELSE
  5882             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5883             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5884             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5885             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5886             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5887             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5888             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5889             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5890
  5891     MOVE LOW-VALUES             TO  EL677AI.
  5892
  5893     if eibtrnid not = trans-id
  5894        evaluate true
  5895           when pi-return-to-program = 'EL6315'
  5896              move pi-company-cd to pi-chek-comp-cd
  5897              move pi-carrier    to pi-chek-carrier
  5898              move pi-grouping   to pi-chek-grouping
  5899              move pi-state      to pi-chek-state
  5900              move pi-account    to pi-chek-account
  5901              move pi-cert-eff-dt to pi-chek-eff-dt
  5902              move pi-cert-prime to pi-chek-cert-no
  5903              move pi-cert-sfx   to pi-chek-suf-no
  5904              move +1            to pi-chek-sequence
  5905              move 'C'           to pi-check-type *> Correction
  5906              move 'S'           to mainti
  5907              move +1            to maintl
  5908              move al-uanon      to mainta
  5909              move dfhenter      to eibaid
  5910              go to 5000-browse-file
  5911           when pi-return-to-program = 'EL6318'
  5912              move 'C'           to pi-check-type *> Correction
  5913           when other
  5914              move 'R'           to pi-check-type *> Refund
  5915        end-evaluate
  5916     end-if
  5917     IF EIBTRNID NOT = TRANS-ID
  5918         move pi-processor-id    to pi-return-to
  5919         move +1                 to dedcynl
  5920         move 'N'                to dedcyno
  5921         move al-uanon           to dedcyna
  5922         move dfhpf7             to eibaid
  5923         perform 6800-browse-previous-chek-recs *> totals up prev
  5924                                 thru 6800-exit
  5925         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5926                                                *> pending record
  5927         IF PI-TO-EL677-FROM-EL1273
  5928             MOVE 'S'            TO MAINTI
  5929             MOVE 1              TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 104
* EL677.cbl
  5930             MOVE AL-UABON       TO MAINTA
  5931             MOVE DFHENTER       TO EIBAID
  5932             GO TO 5000-BROWSE-FILE.
  5933
  5934     IF EIBTRNID NOT = TRANS-ID
  5935        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5936           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5937           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5938           IF PI-PROCESS-BENEFICIARY
  5939              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5940           ELSE
  5941              GO TO 6300-BUILD-CERT-SCREEN
  5942           end-if
  5943        ELSE
  5944           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5945              GO TO 8100-SEND-INITIAL-MAP
  5946           ELSE
  5947              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5948              IF PI-PROCESS-BENEFICIARY
  5949                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5950              ELSE
  5951                 GO TO 6300-BUILD-CERT-SCREEN
  5952              end-if
  5953           end-if
  5954        end-if
  5955     end-if
  5956
  5957     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5958                                     PI-CHEK-COMP-CD.
  5959
  5960
  5961* EXEC CICS HANDLE CONDITION
  5962*        PGMIDERR  (9600-PGMID-ERROR)
  5963*        ERROR     (9990-ABEND)
  5964*    END-EXEC.
  5965*    MOVE '"$L.                  ! " #00005863' TO DFHEIV0
  5966     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5968     MOVE X'2220233030303035383633' TO DFHEIV0(25:11)
  5969     CALL 'kxdfhei1' USING DFHEIV0
  5970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5971
  5972
  5973     IF EIBAID = DFHCLEAR
  5974         GO TO 9400-CLEAR.
  5975
  5976     IF PI-PROCESSOR-ID = 'LGXX'
  5977         GO TO 0200-RECEIVE.
  5978
  5979
  5980* EXEC CICS READQ TS
  5981*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5982*        INTO   (SECURITY-CONTROL)
  5983*        LENGTH (SC-COMM-LENGTH)
  5984*        ITEM   (SC-ITEM)
  5985*    END-EXEC.
  5986*    MOVE '*$II   L              ''   #00005874' TO DFHEIV0
  5987     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 105
* EL677.cbl
  5988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5989     MOVE X'2020233030303035383734' TO DFHEIV0(25:11)
  5990     CALL 'kxdfhei1' USING DFHEIV0,
  5991           PI-SECURITY-TEMP-STORE-ID,
  5992           SECURITY-CONTROL,
  5993           SC-COMM-LENGTH,
  5994           SC-ITEM,
  5995           DFHEIV99,
  5996           DFHEIV99
  5997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5998
  5999
  6000     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  6001     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  6002
  6003     IF NOT DISPLAY-CAP
  6004         MOVE 'READ'          TO SM-READ
  6005         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6006         MOVE ER-0070         TO  EMI-ERROR
  6007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6008         GO TO 8100-SEND-INITIAL-MAP.
  6009
  6010 0200-RECEIVE.
  6011     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6012         MOVE ER-1159            TO  EMI-ERROR
  6013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6014         MOVE -1                 TO  PFENTERL
  6015         GO TO 8200-SEND-DATAONLY.
  6016
  6017
  6018* EXEC CICS HANDLE CONDITION
  6019*        MAPFAIL (8100-SEND-INITIAL-MAP)
  6020*    END-EXEC.
  6021*    MOVE '"$?                   ! # #00005898' TO DFHEIV0
  6022     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6024     MOVE X'2320233030303035383938' TO DFHEIV0(25:11)
  6025     CALL 'kxdfhei1' USING DFHEIV0
  6026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6027
  6028
  6029
  6030* EXEC CICS RECEIVE
  6031*        MAP      (EL677A)
  6032*        MAPSET   (MAPSET-NAME)
  6033*        INTO     (EL677AI)
  6034*    END-EXEC.
  6035     MOVE LENGTH OF
  6036      EL677AI
  6037       TO DFHEIV11
  6038*    MOVE '8"T I  L              ''   #00005902' TO DFHEIV0
  6039     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6040     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6041     MOVE X'2020233030303035393032' TO DFHEIV0(25:11)
  6042     CALL 'kxdfhei1' USING DFHEIV0,
  6043           EL677A,
  6044           EL677AI,
  6045           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 106
* EL677.cbl
  6046           MAPSET-NAME,
  6047           DFHEIV99,
  6048           DFHEIV99
  6049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6050
  6051
  6052     IF PFENTERL GREATER ZERO
  6053         IF EIBAID NOT = DFHENTER
  6054             MOVE ER-0004        TO  EMI-ERROR
  6055             MOVE AL-UNBOF       TO  PFENTERA
  6056             MOVE -1             TO  PFENTERL
  6057             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6058             GO TO 8200-SEND-DATAONLY
  6059         ELSE
  6060             IF (PFENTERI NUMERIC) AND
  6061                (PFENTERI GREATER 0 AND LESS 25)
  6062                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6063             ELSE
  6064                 MOVE ER-0029    TO  EMI-ERROR
  6065                 MOVE AL-UNBOF   TO  PFENTERA
  6066                 MOVE -1         TO  PFENTERL
  6067                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6068                 GO TO 8200-SEND-DATAONLY.
  6069 0300-CHECK-PFKEYS.
  6070     IF EIBAID = DFHPF23
  6071         GO TO 8810-PF23.
  6072
  6073     IF EIBAID = DFHPF24
  6074         GO TO 9200-RETURN-MAIN-MENU.
  6075
  6076     IF EIBAID = DFHPF12
  6077         GO TO 9500-PF12.
  6078
  6079     IF EIBAID = DFHPF1 OR DFHPF2
  6080         GO TO 5000-BROWSE-FILE.
  6081
  6082     if PI-TO-EL677-FROM-EL1273
  6083        and (eibaid not = dfhenter)
  6084        go to 0320-input-error
  6085     end-if
  6086     IF EIBAID = DFHPF3
  6087         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6088         MOVE 'PF3'              TO  PI-PFKEY
  6089         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6090         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6091             GO TO 9400-CLEAR
  6092         ELSE
  6093             MOVE XCTL-1273      TO  PGM-NAME
  6094             GO TO 9300-XCTL.
  6095
  6096     IF EIBAID = DFHPF4
  6097         IF NOT FORCE-CAP
  6098             MOVE ER-0433        TO EMI-ERROR
  6099             MOVE -1             TO PFENTERL
  6100             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6101             GO TO 8200-SEND-DATAONLY.
  6102
  6103     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 107
* EL677.cbl
  6104                             DFHPF5 OR DFHPF6 or dfhpf7
  6105         GO TO 1000-EDIT-DATA.
  6106
  6107*    IF EIBAID = DFHPF7
  6108*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6109*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6110*        MOVE XCTL-114           TO  PGM-NAME
  6111*        GO TO 9300-XCTL.
  6112
  6113 0320-INPUT-ERROR.
  6114     MOVE ER-0029                TO  EMI-ERROR.
  6115     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6116     MOVE -1                     TO  PFENTERL.
  6117     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 108
* EL677.cbl
  6119
  6120 1000-EDIT-DATA.
  6121     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6122         MOVE AL-UANON           TO MAINTA
  6123         IF MAINTI = 'C' OR 'V'
  6124             IF PI-PREV-MAINT = 'S'  OR  'C'
  6125                 NEXT SENTENCE
  6126             ELSE
  6127                 MOVE ER-2056    TO  EMI-ERROR
  6128                 MOVE -1         TO  MAINTL
  6129                 MOVE AL-UABON   TO  MAINTA
  6130                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6131                 GO TO 1100-EDIT-COMPLETE
  6132         ELSE
  6133             NEXT SENTENCE
  6134     ELSE
  6135         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6136            NEXT SENTENCE
  6137         ELSE
  6138            MOVE ER-0023            TO  EMI-ERROR
  6139            MOVE -1                 TO  MAINTL
  6140            MOVE AL-UABON           TO  MAINTA
  6141            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6142
  6143     IF MODIFY-CAP
  6144         NEXT SENTENCE
  6145       ELSE
  6146         IF MAINTI NOT = 'S'
  6147            MOVE 'UPDATE'       TO SM-READ
  6148            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6149            MOVE ER-0070        TO EMI-ERROR
  6150            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6151            GO TO 8100-SEND-INITIAL-MAP.
  6152
  6153     if (pi-return-to-program = 'EL1273')
  6154        and (MAINTI not = 'S' and 'V')
  6155        move 'S'                 to mainti
  6156        move +1                  to maintl
  6157        move al-uanon            to mainta
  6158     end-if
  6159     IF CARRIERI NOT = LOW-VALUES
  6160         MOVE AL-UANON           TO  CARRIERA
  6161         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6162         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6163                                     PI-CARRIER
  6164     ELSE
  6165         MOVE -1                 TO  CARRIERL
  6166         MOVE AL-UABON           TO  CARRIERA
  6167         MOVE ER-0194            TO  EMI-ERROR
  6168         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6169
  6170     IF GROUPI NOT = LOW-VALUES
  6171         MOVE AL-UANON           TO  GROUPA
  6172         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6173                                     PI-GROUPING
  6174     ELSE
  6175         MOVE -1                 TO  GROUPL
  6176         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 109
* EL677.cbl
  6177         MOVE ER-0195            TO  EMI-ERROR
  6178         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6179
  6180     IF STATEI NOT = LOW-VALUES
  6181         MOVE AL-UANON           TO  STATEA
  6182         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6183         MOVE STATEI             TO  PI-CHEK-STATE
  6184                                     PI-STATE
  6185     ELSE
  6186         MOVE -1                 TO  STATEL
  6187         MOVE AL-UABON           TO  STATEA
  6188         MOVE ER-0196            TO  EMI-ERROR
  6189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6190
  6191     IF EFFDTL GREATER ZERO
  6192         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6193         PERFORM 8700-DEEDIT
  6194         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6195             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6196             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6197             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6198             MOVE '4'                TO  DC-OPTION-CODE
  6199             PERFORM 8500-DATE-CONVERT
  6200             IF DC-ERROR-CODE NOT = SPACES
  6201                 MOVE ER-0215        TO  EMI-ERROR
  6202                 PERFORM 9900-ERROR-FORMAT
  6203                 MOVE -1             TO  EFFDTL
  6204                 MOVE AL-UABON       TO  EFFDTA
  6205               ELSE
  6206                 MOVE AL-UANON       TO  EFFDTA
  6207                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6208                                         PI-CERT-EFF-DT
  6209           ELSE
  6210             MOVE ER-0215        TO  EMI-ERROR
  6211             PERFORM 9900-ERROR-FORMAT
  6212             MOVE -1             TO  EFFDTL
  6213             MOVE AL-UABON       TO  EFFDTA
  6214       ELSE
  6215         MOVE ER-0216            TO  EMI-ERROR
  6216         PERFORM 9900-ERROR-FORMAT
  6217         MOVE -1                 TO  EFFDTL
  6218         MOVE AL-UABOF           TO  EFFDTA.
  6219
  6220     IF ACCTI NOT = LOW-VALUES
  6221         MOVE AL-UANON           TO  ACCTA
  6222         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6223         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6224                                     PI-ACCOUNT
  6225     ELSE
  6226         MOVE -1                 TO  ACCTL
  6227         MOVE AL-UABON           TO  ACCTA
  6228         MOVE ER-0197            TO  EMI-ERROR
  6229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6230
  6231     IF CERTNOI NOT = LOW-VALUES
  6232         MOVE AL-UANON           TO  CERTNOA
  6233         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6234                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 110
* EL677.cbl
  6235     ELSE
  6236         MOVE -1                 TO  CERTNOL
  6237         MOVE AL-UABON           TO  CERTNOA
  6238         MOVE ER-0203            TO  EMI-ERROR
  6239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6240
  6241     IF SFXI  = LOW-VALUES
  6242         MOVE SPACE              TO  SFXI.
  6243
  6244     MOVE AL-UANON               TO  SFXA.
  6245
  6246     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6247                                     PI-CERT-SFX.
  6248     IF SEQI = LOW-VALUES
  6249         MOVE +1                 TO  SEQI.
  6250
  6251     MOVE AL-UNNON               TO  SEQA.
  6252     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6253
  6254     IF PAYTO1L > 0
  6255         MOVE PAYTO1I            TO  PI-PAYTO1
  6256     ELSE
  6257         MOVE SPACES             TO  PI-PAYTO1.
  6258
  6259     IF AMOUNTL > 0
  6260
  6261* EXEC CICS BIF DEEDIT
  6262*            FIELD   (AMOUNTI)
  6263*            LENGTH  (11)
  6264*        END-EXEC
  6265     MOVE 11
  6266       TO DFHEIV11
  6267*    MOVE '@"L                   #   #00006116' TO DFHEIV0
  6268     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6269     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6270     MOVE X'2020233030303036313136' TO DFHEIV0(25:11)
  6271     CALL 'kxdfhei1' USING DFHEIV0,
  6272           AMOUNTI,
  6273           DFHEIV11
  6274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6275         MOVE AMOUNTI            TO  PI-AMOUNT
  6276     ELSE
  6277         MOVE ZEROS              TO  PI-AMOUNT.
  6278
  6279     IF TYPEL > 0
  6280         MOVE TYPEI              TO  PI-TYPE
  6281     ELSE
  6282         MOVE SPACE              TO  PI-TYPE.
  6283
  6284*    IF REFL > 0
  6285*        MOVE REFI               TO  PI-REFERENCE
  6286*    ELSE
  6287*        MOVE SPACES             TO  PI-REFERENCE.
  6288     if rettol not = zeros
  6289        move rettoi              to pi-return-to
  6290        MOVE AL-UANON            TO  RETTOA
  6291     end-if
  6292     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 111
* EL677.cbl
  6293        if dedcyni = 'Y' OR 'N'
  6294           continue
  6295        else
  6296           move er-3451          to emi-error
  6297           move -1               to dedcynl
  6298           move al-uabon         to dedcyna
  6299           perform 9900-error-format
  6300                                 thru 9900-exit
  6301        end-if
  6302     end-if
  6303
  6304     if mainti = 'V'
  6305        if (vreasonl > zeros)
  6306           and (vreasoni (1:2) not = spaces)
  6307           continue
  6308        else
  6309           move er-3454          to emi-error
  6310           move -1               to vreasonl
  6311           move al-uabon         to vreasona
  6312           perform 9900-error-format
  6313                                 thru 9900-exit
  6314        end-if
  6315     end-if
  6316     if (mainti = 'A')
  6317        and (pi-prev-paid > zeros)
  6318        and (pi-check-type = 'C')
  6319        move er-3459             to emi-error
  6320        move -1                  to maintl
  6321        move al-uabon            to mainta
  6322        perform 9900-error-format
  6323                                 thru 9900-exit
  6324     end-if
  6325     if mainti = 'A'
  6326        continue
  6327     else
  6328        IF MAINTI = 'S'
  6329           or pi-prev-maint = 'S'
  6330           GO TO 1100-EDIT-COMPLETE
  6331        end-if
  6332     end-if
  6333     IF EIBAID = DFHPF5
  6334        IF EMI-ERROR = ZEROS
  6335          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6336        ELSE
  6337          GO TO 1100-EDIT-COMPLETE.
  6338
  6339     IF EIBAID = DFHPF6
  6340        IF EMI-ERROR = ZEROS
  6341           GO TO 6300-BUILD-CERT-SCREEN
  6342         ELSE
  6343           GO TO 1100-EDIT-COMPLETE.
  6344
  6345     IF EIBAID = DFHPF7
  6346        IF EMI-ERROR = ZEROS
  6347           GO TO 6600-build-beneficiary-screen
  6348         ELSE
  6349           GO TO 1100-EDIT-COMPLETE.
  6350
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 112
* EL677.cbl
  6351*    if mainti = 'V'
  6352*       if (vreasonl > zeros)
  6353*          and (vreasoni (1:2) not = spaces)
  6354*          continue
  6355*       else
  6356*          move er-3454          to emi-error
  6357*          move -1               to vreasonl
  6358*          move al-uabon         to vreasona
  6359*          perform 9900-error-format
  6360*                                thru 9900-exit
  6361*       end-if
  6362*    end-if
  6363     IF MAINTI = 'A'
  6364        if (payto1i not = spaces and low-values)
  6365           and (payad1i not = spaces and low-values)
  6366           and (payctyi not = spaces and low-values)
  6367           and (paysti not = spaces and low-values)
  6368           and (ptozipi not = spaces and low-values)
  6369           continue
  6370        else
  6371           MOVE -1               TO PAYTO1L
  6372           MOVE ER-2907          TO EMI-ERROR
  6373           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6374        end-if
  6375     end-if
  6376
  6377     IF MAINTI = 'A'
  6378         IF EIBAID NOT = DFHPF4
  6379             MOVE DFHENTER       TO  EIBAID
  6380             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6381
  6382     IF MAINTI = 'S' OR 'V'
  6383         GO TO 1100-EDIT-COMPLETE.
  6384
  6385     IF PRINTEDL GREATER THAN +0
  6386         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6387         PERFORM 8700-DEEDIT
  6388         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6389             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6390             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6391             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6392             MOVE '4'                TO  DC-OPTION-CODE
  6393             PERFORM 8500-DATE-CONVERT
  6394             IF DC-ERROR-CODE NOT = SPACES
  6395                 MOVE ER-3046        TO  EMI-ERROR
  6396                 PERFORM 9900-ERROR-FORMAT
  6397                 MOVE -1             TO  PRINTEDL
  6398                 MOVE AL-UABON       TO  PRINTEDA
  6399                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6400             ELSE
  6401                 MOVE AL-UANON       TO  PRINTEDA
  6402                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6403         ELSE
  6404             MOVE ER-3046        TO  EMI-ERROR
  6405             PERFORM 9900-ERROR-FORMAT
  6406             MOVE -1             TO  PRINTEDL
  6407             MOVE AL-UABON       TO  PRINTEDA
  6408             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 113
* EL677.cbl
  6409
  6410     IF AMOUNTL = ZEROS
  6411         GO TO 1050-CK-AMT.
  6412
  6413
  6414* EXEC CICS BIF DEEDIT
  6415*        FIELD   (AMOUNTI)
  6416*        LENGTH  (11)
  6417*    END-EXEC.
  6418     MOVE 11
  6419       TO DFHEIV11
  6420*    MOVE '@"L                   #   #00006258' TO DFHEIV0
  6421     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6422     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6423     MOVE X'2020233030303036323538' TO DFHEIV0(25:11)
  6424     CALL 'kxdfhei1' USING DFHEIV0,
  6425           AMOUNTI,
  6426           DFHEIV11
  6427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6428
  6429
  6430     IF AMOUNTI NOT NUMERIC     OR
  6431        AMOUNTI LESS THAN ZERO  OR
  6432       (AMOUNTI = ZEROS  AND
  6433               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6434          MOVE ER-1159            TO  EMI-ERROR
  6435          MOVE -1                 TO  AMOUNTL
  6436          MOVE AL-UNBON           TO  AMOUNTA
  6437          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6438          GO TO 1100-EDIT-COMPLETE.
  6439
  6440     MOVE AMOUNTI                TO  WS-AM-WORK.
  6441
  6442     IF WS-AM-SIGN = SPACES
  6443         MOVE WS-AM-NUM          TO  WS-AMT
  6444         ADD 0                   TO  WS-AMT
  6445       ELSE
  6446         MOVE AMOUNTI            TO  WS-AMT
  6447         ADD 0                   TO  WS-AMT.
  6448
  6449      MOVE WS-AMT                TO  AMOUNTO.
  6450      MOVE AL-UNNON              TO  AMOUNTA.
  6451
  6452 1050-CK-AMT.
  6453     IF AMOUNTL = ZEROS AND
  6454        MAINTI  = 'A'
  6455         MOVE ER-1159            TO  EMI-ERROR
  6456         MOVE -1                 TO  AMOUNTL
  6457         MOVE AL-UNBON           TO  AMOUNTA
  6458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6459
  6460     if pi-amount = pi-prev-paid
  6461         MOVE ER-9999            TO EMI-ERROR
  6462         MOVE -1                 TO maintL
  6463         MOVE AL-UABON           TO maintA
  6464         PERFORM 9900-ERROR-FORMAT
  6465                                 THRU 9900-EXIT
  6466     end-if
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 114
* EL677.cbl
  6467*    MOVE AL-UANON              TO  TYPEA.
  6468
  6469     IF TYPEL GREATER THAN ZEROS
  6470         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6471             NEXT SENTENCE
  6472         ELSE
  6473             MOVE ER-3044    TO  EMI-ERROR
  6474             MOVE -1         TO  TYPEL
  6475             MOVE AL-PABON   TO  TYPEA
  6476             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6477     ELSE
  6478         IF MAINTI  = 'A'
  6479             MOVE ER-3044    TO  EMI-ERROR
  6480             MOVE -1         TO  TYPEL
  6481             MOVE AL-PABON   TO  TYPEA
  6482             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6483
  6484
  6485 1100-EDIT-COMPLETE.
  6486
  6487     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6488       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6489        EIBAID NOT = DFHPF4)
  6490         GO TO 8200-SEND-DATAONLY.
  6491
  6492     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6493
  6494     IF MAINTI = 'A'
  6495         GO TO 2000-ADD-RECORD.
  6496
  6497*    IF MAINTI = 'C' OR 'V'
  6498     IF MAINTI = 'V'
  6499         GO TO 3000-CHANGE-RECORD.
  6500
  6501     IF MAINTI = 'S' or 'C'
  6502         GO TO 5000-BROWSE-FILE.
  6503
  6504     if mainti = 'D'
  6505        go to 3400-delete-record
  6506     end-if
  6507     .
  6508 1200-VERIFY-CARRIER-ID.
  6509     MOVE SPACES                 TO ELCNTL-KEY.
  6510     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6511     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6512     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6513     MOVE +0                     TO ELCNTL-SEQ.
  6514
  6515
  6516* EXEC CICS HANDLE CONDITION
  6517*        NOTFND   (1290-NO-CARRIER)
  6518*    END-EXEC.
  6519*    MOVE '"$I                   ! $ #00006348' TO DFHEIV0
  6520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6522     MOVE X'2420233030303036333438' TO DFHEIV0(25:11)
  6523     CALL 'kxdfhei1' USING DFHEIV0
  6524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 115
* EL677.cbl
  6525
  6526
  6527
  6528* EXEC CICS READ
  6529*        DATASET   (ELCNTL-FILE-ID)
  6530*        SET       (ADDRESS OF CONTROL-FILE)
  6531*        RIDFLD    (ELCNTL-KEY)
  6532*    END-EXEC.
  6533*    MOVE '&"S        E          (   #00006352' TO DFHEIV0
  6534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6536     MOVE X'2020233030303036333532' TO DFHEIV0(25:11)
  6537     CALL 'kxdfhei1' USING DFHEIV0,
  6538           ELCNTL-FILE-ID,
  6539           DFHEIV20,
  6540           DFHEIV99,
  6541           ELCNTL-KEY,
  6542           DFHEIV99,
  6543           DFHEIV99,
  6544           DFHEIV99
  6545     SET ADDRESS OF CONTROL-FILE TO
  6546         DFHEIV20
  6547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6548
  6549
  6550     GO TO 1200-EXIT.
  6551
  6552 1290-NO-CARRIER.
  6553     MOVE ER-2208                TO EMI-ERROR.
  6554     MOVE -1                     TO CARRIERL.
  6555     MOVE AL-UABON               TO CARRIERA.
  6556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6557
  6558 1200-EXIT.
  6559      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 116
* EL677.cbl
  6561 1300-VERIFY-STATE-ID.
  6562     MOVE SPACES                 TO ELCNTL-KEY.
  6563     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6564     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6565     MOVE STATEI                 TO ELCNTL-STATE.
  6566     MOVE +0                     TO ELCNTL-SEQ.
  6567
  6568
  6569* EXEC CICS HANDLE CONDITION
  6570*        NOTFND   (1380-NO-STATE)
  6571*    END-EXEC.
  6572*    MOVE '"$I                   ! % #00006376' TO DFHEIV0
  6573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6575     MOVE X'2520233030303036333736' TO DFHEIV0(25:11)
  6576     CALL 'kxdfhei1' USING DFHEIV0
  6577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6578
  6579
  6580
  6581* EXEC CICS READ
  6582*        DATASET   (ELCNTL-FILE-ID)
  6583*        SET       (ADDRESS OF CONTROL-FILE)
  6584*        RIDFLD    (ELCNTL-KEY)
  6585*    END-EXEC.
  6586*    MOVE '&"S        E          (   #00006380' TO DFHEIV0
  6587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6589     MOVE X'2020233030303036333830' TO DFHEIV0(25:11)
  6590     CALL 'kxdfhei1' USING DFHEIV0,
  6591           ELCNTL-FILE-ID,
  6592           DFHEIV20,
  6593           DFHEIV99,
  6594           ELCNTL-KEY,
  6595           DFHEIV99,
  6596           DFHEIV99,
  6597           DFHEIV99
  6598     SET ADDRESS OF CONTROL-FILE TO
  6599         DFHEIV20
  6600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6601
  6602
  6603     GO TO 1390-EXIT.
  6604
  6605 1380-NO-STATE.
  6606     MOVE ER-2209                TO EMI-ERROR.
  6607     MOVE -1                     TO STATEL.
  6608     MOVE AL-UABON               TO STATEA.
  6609     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6610
  6611 1390-EXIT.
  6612      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 117
* EL677.cbl
  6614
  6615 1400-VERIFY-ACCOUNT.
  6616     IF EIBAID = DFHPF5
  6617         GO TO 1410-BUILD-ACCOUNT-KEY.
  6618
  6619     IF MAINTL GREATER +0
  6620         NEXT SENTENCE
  6621       ELSE
  6622         GO TO 1490-EXIT.
  6623
  6624*    IF MAINTI = 'A' OR 'C' OR 'V'
  6625     IF MAINTI = 'A' OR 'V'
  6626         NEXT SENTENCE
  6627       ELSE
  6628         GO TO 1490-EXIT.
  6629
  6630 1410-BUILD-ACCOUNT-KEY.
  6631     MOVE CARRIERI               TO ERACCT-CARRIER.
  6632     MOVE GROUPI                 TO ERACCT-GROUPING
  6633     MOVE STATEI                 TO ERACCT-STATE.
  6634     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6635     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6636
  6637     MOVE '2'                    TO DC-OPTION-CODE.
  6638     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6639
  6640     PERFORM 8500-DATE-CONVERT.
  6641     IF DATE-CONVERSION-ERROR
  6642        GO TO 1480-ACCOUNT-INVALID.
  6643
  6644     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6645    .
  6646 1420-get-eracct.
  6647     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6648
  6649
  6650* EXEC CICS HANDLE CONDITION
  6651*        NOTFND   (1480-ACCOUNT-INVALID)
  6652*        ENDFILE  (1480-ACCOUNT-INVALID)
  6653*    END-EXEC.
  6654*    MOVE '"$I''                  ! & #00006432' TO DFHEIV0
  6655     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6657     MOVE X'2620233030303036343332' TO DFHEIV0(25:11)
  6658     CALL 'kxdfhei1' USING DFHEIV0
  6659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6660
  6661
  6662
  6663* EXEC CICS STARTBR
  6664*        DATASET   (ERACCT-FILE-ID)
  6665*        RIDFLD    (ERACCT-KEY)
  6666*    END-EXEC.
  6667     MOVE 0
  6668       TO DFHEIV11
  6669*    MOVE '&,         G          &   #00006437' TO DFHEIV0
  6670     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 118
* EL677.cbl
  6672     MOVE X'2020233030303036343337' TO DFHEIV0(25:11)
  6673     CALL 'kxdfhei1' USING DFHEIV0,
  6674           ERACCT-FILE-ID,
  6675           ERACCT-KEY,
  6676           DFHEIV99,
  6677           DFHEIV11,
  6678           DFHEIV99
  6679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6680
  6681
  6682     set eracct-start to true
  6683     .
  6684 1420-READNEXT-ACCOUNT-MASTER.
  6685
  6686* EXEC CICS READNEXT
  6687*        DATASET   (ERACCT-FILE-ID)
  6688*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6689*        RIDFLD    (ERACCT-KEY)
  6690*    END-EXEC.
  6691     MOVE 0
  6692       TO DFHEIV11
  6693*    MOVE '&.S                   )   #00006445' TO DFHEIV0
  6694     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6695     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6696     MOVE X'2020233030303036343435' TO DFHEIV0(25:11)
  6697     CALL 'kxdfhei1' USING DFHEIV0,
  6698           ERACCT-FILE-ID,
  6699           DFHEIV20,
  6700           DFHEIV99,
  6701           ERACCT-KEY,
  6702           DFHEIV99,
  6703           DFHEIV11,
  6704           DFHEIV99,
  6705           DFHEIV99
  6706     SET ADDRESS OF ACCOUNT-MASTER TO
  6707         DFHEIV20
  6708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6709
  6710
  6711*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6712*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6713*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6714*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6715*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6716*         GO TO 1480-ACCOUNT-INVALID.
  6717*
  6718*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6719*        GO TO 1480-ACCOUNT-INVALID.
  6720*
  6721*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6722*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6723
  6724     evaluate true
  6725        when (save-eracct-key (1:20) not =
  6726           am-control-primary (1:20))
  6727           and (not eracct-found)
  6728           go to 1480-account-invalid
  6729        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 119
* EL677.cbl
  6730           am-control-primary (1:20))
  6731           and (eracct-found)
  6732           move ws-hold-eracct-record
  6733                                 to account-master
  6734        when (sv-acct-exp-date < am-effective-dt)
  6735           and (not eracct-found)
  6736           go to 1480-account-invalid
  6737        when sv-acct-exp-date >= am-expiration-dt
  6738           go to 1420-readnext-account-master
  6739        when am-expiration-dt = high-values
  6740           continue
  6741        when other
  6742           set eracct-found to true
  6743           move account-master   to ws-hold-eracct-record
  6744           go to 1420-readnext-account-master
  6745     end-evaluate
  6746     if eracct-start
  6747
  6748* exec cics endbr
  6749*          dataset  (eracct-file-id)
  6750*       end-exec
  6751     MOVE 0
  6752       TO DFHEIV11
  6753*    MOVE '&2                    $   #00006487' TO DFHEIV0
  6754     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6755     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6756     MOVE X'2020233030303036343837' TO DFHEIV0(25:11)
  6757     CALL 'kxdfhei1' USING DFHEIV0,
  6758           eracct-file-id,
  6759           DFHEIV11,
  6760           DFHEIV99
  6761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6762     end-if
  6763*    if am-expiration-dt = high-values
  6764*       continue
  6765*    else
  6766*       move account-master      to ws-hold-eracct-record
  6767*       go to 1420-readnext-account-master
  6768*    end-if
  6769     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6770     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6771     MOVE AM-STATE               TO PI-CR-STATE.
  6772     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6773
  6774     MOVE AM-NAME                TO PI-AM-NAME.
  6775     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6776     MOVE AM-CITY                TO PI-AM-CITY-st
  6777     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6778     move am-csr-code            to pi-am-csr
  6779
  6780     MOVE +0                     TO WS-SUB.
  6781
  6782 1430-FIND-ACC-AGT.
  6783     ADD +1                      TO WS-SUB.
  6784
  6785     IF  WS-SUB GREATER +10
  6786         GO TO 1480-ACCOUNT-INVALID.
  6787
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 120
* EL677.cbl
  6788     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6789         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6790       ELSE
  6791         GO TO 1430-FIND-ACC-AGT.
  6792
  6793     MOVE AL-UANON               TO CARRIERA
  6794                                    GROUPA
  6795                                    STATEA.
  6796
  6797     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6798
  6799     GO TO 1490-EXIT.
  6800
  6801 1480-ACCOUNT-INVALID.
  6802     MOVE -1                     TO CARRIERL
  6803     MOVE AL-UANON               TO CARRIERA
  6804                                    GROUPA
  6805                                    STATEA
  6806                                    ACCTA.
  6807     MOVE ER-2210                TO EMI-ERROR.
  6808     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6809     GO TO 8200-SEND-DATAONLY.
  6810
  6811 1490-EXIT.
  6812      EXIT.
  6813
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 121
* EL677.cbl
  6815 1500-VERIFY-PENDING-BUS-REC.
  6816     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6817     if ws-corr-check
  6818        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6819        go to 1590-exit
  6820     end-if
  6821
  6822* EXEC CICS HANDLE CONDITION
  6823*        NOTFND   (1590-EXIT)
  6824*    END-EXEC.
  6825*    MOVE '"$I                   ! '' #00006549' TO DFHEIV0
  6826     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6828     MOVE X'2720233030303036353439' TO DFHEIV0(25:11)
  6829     CALL 'kxdfhei1' USING DFHEIV0
  6830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6831
  6832
  6833
  6834     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6835     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6836     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6837     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6838     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6839     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6840     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6841     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6842     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6843     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6844
  6845     IF ST-ACCNT-CNTL  OR
  6846        ACCNT-CNTL
  6847          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6848
  6849     IF ST-ACCNT-CNTL      OR
  6850        CARR-ST-ACCNT-CNTL OR
  6851        ACCNT-CNTL         OR
  6852        CARR-ACCNT-CNTL
  6853          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6854
  6855     IF ACCNT-CNTL OR
  6856        CARR-ACCNT-CNTL
  6857          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6858
  6859
  6860* EXEC CICS READ
  6861*         DATASET   (ERPNDB-ALT-FILE-ID)
  6862*         SET       (ADDRESS OF PENDING-BUSINESS)
  6863*         RIDFLD    (ERPNDB-ALT-KEY)
  6864*     END-EXEC.
  6865*    MOVE '&"S        E          (   #00006579' TO DFHEIV0
  6866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6868     MOVE X'2020233030303036353739' TO DFHEIV0(25:11)
  6869     CALL 'kxdfhei1' USING DFHEIV0,
  6870           ERPNDB-ALT-FILE-ID,
  6871           DFHEIV20,
  6872           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 122
* EL677.cbl
  6873           ERPNDB-ALT-KEY,
  6874           DFHEIV99,
  6875           DFHEIV99,
  6876           DFHEIV99
  6877     SET ADDRESS OF PENDING-BUSINESS TO
  6878         DFHEIV20
  6879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6880
  6881
  6882     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6883
  6884     IF PB-C-PAYEE-CODE GREATER SPACES
  6885        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6886
  6887     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6888*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6889
  6890     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6891     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6892
  6893     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6894         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6895     ELSE
  6896         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6897
  6898*    IF MAINTI = 'A' OR 'C'
  6899*      IF PB-C-REFUND-CREATED
  6900*          MOVE -1               TO  MAINTL
  6901*          MOVE ER-3445          TO  EMI-ERROR
  6902*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6903
  6904 1590-EXIT.
  6905      EXIT.
  6906
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 123
* EL677.cbl
  6908 2000-ADD-RECORD.
  6909
  6910* EXEC CICS GETMAIN
  6911*        SET      (ADDRESS OF CHECK-RECORDS)
  6912*        LENGTH   (600)
  6913*        INITIMG  (GETMAIN-SPACE)
  6914*    END-EXEC.
  6915     MOVE 600
  6916       TO DFHEIV11
  6917*    MOVE ',"IL                  $   #00006612' TO DFHEIV0
  6918     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6919     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6920     MOVE X'2020233030303036363132' TO DFHEIV0(25:11)
  6921     CALL 'kxdfhei1' USING DFHEIV0,
  6922           DFHEIV20,
  6923           DFHEIV11,
  6924           GETMAIN-SPACE
  6925     SET ADDRESS OF CHECK-RECORDS TO
  6926         DFHEIV20
  6927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6928
  6929
  6930     MOVE 'CH'                   TO CH-RECORD-ID.
  6931     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6932     MOVE CARRIERI               TO CH-CARRIER.
  6933     MOVE GROUPI                 TO CH-GROUPING.
  6934     MOVE STATEI                 TO CH-STATE.
  6935     MOVE ACCTI                  TO CH-ACCOUNT.
  6936
  6937     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6938     MOVE '2'                    TO DC-OPTION-CODE.
  6939     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6940     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6941
  6942     MOVE CERTNOI                TO CH-CERT-PRIME.
  6943     MOVE SFXI                   TO CH-CERT-SFX.
  6944
  6945     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6946
  6947     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6948                                    ch-released-by
  6949     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6950
  6951     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6952     MOVE '5'                    TO DC-OPTION-CODE.
  6953     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6954     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6955                                    ch-released-dt
  6956
  6957     move 'P'                    to ch-approval-status
  6958
  6959     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6960                                    CH-VOID-DT
  6961                                    CH-CREDIT-ACCEPT-DT
  6962                                    CH-CANC-DT
  6963                                    ch-approval-dt
  6964                                    ch-check-cashed-dt
  6965     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 124
* EL677.cbl
  6966                                    CH-AH-REFUND
  6967*                                   CH-DEDUCT-WITHHELD
  6968*                                   CH-ADDITIONAL-CHARGE.
  6969
  6970     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6971
  6972     if pi-prev-paid not numeric
  6973        move zeros               to pi-prev-paid
  6974     end-if
  6975     if pi-prev-paid-this-month not numeric
  6976        move zeros               to pi-prev-paid-this-month
  6977     end-if
  6978     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6979       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6980        EIBAID NOT = DFHPF4)
  6981         GO TO 8200-SEND-DATAONLY.
  6982
  6983     add ch-amount-paid to pi-prev-paid
  6984     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6985     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6986     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6987     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6988     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6989     move pi-am-csr              to ch-csr
  6990     .
  6991 2100-WRITE-RECORD.
  6992
  6993* exec cics read
  6994*       dataset    (erchek-file-id)
  6995*       into       (ws-dummy-erchek)
  6996*       ridfld     (ch-control-primary)
  6997*       resp       (ws-response)
  6998*    end-exec
  6999     MOVE LENGTH OF
  7000      ws-dummy-erchek
  7001       TO DFHEIV11
  7002*    MOVE '&"IL       E          (  N#00006680' TO DFHEIV0
  7003     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7005     MOVE X'204E233030303036363830' TO DFHEIV0(25:11)
  7006     CALL 'kxdfhei1' USING DFHEIV0,
  7007           erchek-file-id,
  7008           ws-dummy-erchek,
  7009           DFHEIV11,
  7010           ch-control-primary,
  7011           DFHEIV99,
  7012           DFHEIV99,
  7013           DFHEIV99
  7014     MOVE EIBRESP  TO ws-response
  7015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7016     if RESP-NOTFND
  7017        continue
  7018     else
  7019        add +1 to ch-sequence-no
  7020        add 1 to seqi
  7021        go to 2100-write-record
  7022     end-if
  7023     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 125
* EL677.cbl
  7024
  7025* EXEC CICS HANDLE CONDITION
  7026*        DUPREC (2200-DUPREC)
  7027*    END-EXEC.
  7028*    MOVE '"$%                   ! ( #00006694' TO DFHEIV0
  7029     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7030     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7031     MOVE X'2820233030303036363934' TO DFHEIV0(25:11)
  7032     CALL 'kxdfhei1' USING DFHEIV0
  7033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7034
  7035
  7036     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7037     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7038                                    CH-CHECK-QUE-SEQUENCE
  7039
  7040
  7041* EXEC CICS WRITE
  7042*        DATASET  (ERCHEK-FILE-ID)
  7043*        FROM     (CHECK-RECORDS)
  7044*        RIDFLD   (CH-CONTROL-PRIMARY)
  7045*        resp     (ws-response)
  7046*    END-EXEC.
  7047     MOVE LENGTH OF
  7048      CHECK-RECORDS
  7049       TO DFHEIV11
  7050*    MOVE '&$ L                  ''  N#00006702' TO DFHEIV0
  7051     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7052     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7053     MOVE X'204E233030303036373032' TO DFHEIV0(25:11)
  7054     CALL 'kxdfhei1' USING DFHEIV0,
  7055           ERCHEK-FILE-ID,
  7056           CHECK-RECORDS,
  7057           DFHEIV11,
  7058           CH-CONTROL-PRIMARY,
  7059           DFHEIV99,
  7060           DFHEIV99
  7061     MOVE EIBRESP  TO ws-response
  7062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7063
  7064     if resp-normal and pi-check-type = 'C'
  7065        move 'Y'                 to pi-check-cut
  7066     end-if
  7067     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7068             ERCHEK-RECORD-LENGTH + 23.
  7069
  7070     if pi-check-type not = 'C'
  7071        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7072                                 THRU 6200-EXIT
  7073        if resp-normal
  7074           MOVE 'Y'              TO PB-C-REFUND-SW
  7075           add +1 to pi-chek-rec-cnt
  7076           perform 6210-rewrite-pndb
  7077                                 thru 6210-exit
  7078*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7079        end-if
  7080     end-if
  7081*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 126
* EL677.cbl
  7082
  7083     IF EMI-NO-ERRORS
  7084         MOVE ER-0000            TO EMI-ERROR
  7085     ELSE
  7086         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7087            EIBAID = DFHPF4
  7088             MOVE ER-2600        TO EMI-ERROR.
  7089
  7090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7091
  7092     MOVE LOW-VALUES             TO EL677AI.
  7093
  7094     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7095     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7096     MOVE PI-CHEK-STATE          TO STATEO.
  7097     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7098
  7099     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7100     MOVE SPACE                  TO DC-OPTION-CODE.
  7101     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7102     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7103
  7104     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7105     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7106     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7107
  7108     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7109                                    ACCTA     EFFDTA  CERTNOA
  7110                                    SFXA.
  7111     MOVE AL-UNNON               TO SEQA.
  7112     go to 5000-browse-file
  7113     GO TO 8100-SEND-INITIAL-MAP.
  7114
  7115 2200-DUPREC.
  7116     ADD +1 TO CH-SEQUENCE-NO.
  7117     MOVE CH-SEQUENCE-NO         TO SEQO
  7118                                    PI-CHEK-SEQUENCE
  7119                                    CHEK-RECORD-SEQ.
  7120     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 127
* EL677.cbl
  7122
  7123 2500-WRITE-PAY-ADJ.
  7124
  7125     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7126
  7127     IF CH-AMOUNT-PAID = ZEROS
  7128         GO TO 2510-CONTINUE.
  7129     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7130     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7131
  7132 2510-CONTINUE.
  7133
  7134     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7135         GO TO 2580-HANDLE-ELCNTL-FILE.
  7136
  7137 2550-BUILD-ERPYAJ-RECORD.
  7138
  7139
  7140* EXEC CICS GETMAIN
  7141*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7142*        LENGTH  (200)
  7143*        INITIMG (GETMAIN-SPACE)
  7144*    END-EXEC.
  7145     MOVE 200
  7146       TO DFHEIV11
  7147*    MOVE ',"IL                  $   #00006783' TO DFHEIV0
  7148     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7149     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7150     MOVE X'2020233030303036373833' TO DFHEIV0(25:11)
  7151     CALL 'kxdfhei1' USING DFHEIV0,
  7152           DFHEIV20,
  7153           DFHEIV11,
  7154           GETMAIN-SPACE
  7155     SET ADDRESS OF PENDING-PAY-ADJ TO
  7156         DFHEIV20
  7157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7158
  7159
  7160     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7161     MOVE 'PY'                   TO PY-RECORD-ID.
  7162     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7163
  7164     MOVE CARRIERI               TO PY-CARRIER.
  7165     IF PI-ZERO-CARRIER  OR
  7166        PI-ZERO-CAR-GROUP
  7167         MOVE ZERO               TO PY-CARRIER.
  7168
  7169     MOVE GROUPI                 TO PY-GROUPING.
  7170     IF PI-ZERO-GROUPING  OR
  7171        PI-ZERO-CAR-GROUP
  7172         MOVE ZERO               TO PY-GROUPING.
  7173
  7174     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7175     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7176     MOVE 'C'                    TO PY-RECORD-TYPE.
  7177     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7178
  7179     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 128
* EL677.cbl
  7180                                    WS-PY-REF-DATE
  7181                                    WS-PY-END-DATE
  7182                                    WS-PY-DED-DATE
  7183                                    WS-PY-ADDL-DATE.
  7184     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7185     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7186                                    WS-PY-REF-CERT
  7187                                    WS-PY-END-CERT
  7188                                    WS-PY-DED-CERT
  7189                                    WS-PY-ADDL-CERT
  7190                                    WS-TMS-PY-CERT.
  7191     IF SFXI NOT = LOW-VALUES
  7192         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7193                                    WS-PY-REF-SUFFIX
  7194                                    WS-PY-END-SUFFIX
  7195                                    WS-PY-DED-SUFFIX
  7196                                    WS-PY-ADDL-SUFFIX
  7197     ELSE
  7198         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7199                                    WS-PY-REF-SUFFIX
  7200                                    WS-PY-END-SUFFIX
  7201                                    WS-PY-DED-SUFFIX
  7202                                    WS-PY-ADDL-SUFFIX.
  7203
  7204     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7205         MOVE WS-TMS-ENTRY-COMMENT
  7206                                 TO PY-ENTRY-COMMENT
  7207     ELSE
  7208         IF TYPEI EQUAL 'R'
  7209             MOVE WS-PY-REF-COMMENT
  7210                                 TO PY-ENTRY-COMMENT
  7211         ELSE
  7212             IF TYPEI EQUAL 'E'
  7213                 MOVE WS-PY-END-COMMENT
  7214                                 TO PY-ENTRY-COMMENT
  7215             ELSE
  7216                 MOVE WS-PY-ENTRY-COMMENT
  7217                                 TO PY-ENTRY-COMMENT.
  7218
  7219     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7220
  7221     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7222     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7223     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7224                                    PY-INPUT-DT.
  7225*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7226*                                   PY-CHECK-QUE-SEQUENCE.
  7227     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7228                                    PY-REPORTED-DT
  7229                                    PY-CHECK-WRITTEN-DT
  7230                                    PY-BILLED-DATE
  7231                                    PY-AR-DATE
  7232                                    PY-GL-DATE.
  7233     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7234     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7235*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7236
  7237     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 129
* EL677.cbl
  7238         MOVE 'B'                TO PY-PYMT-TYPE
  7239         MOVE 'A'                TO PY-PMT-APPLIED.
  7240
  7241 2559-BUILD-EXIT.
  7242     EXIT.
  7243
  7244 2570-WRITE-ERPYAJ-RECORD.
  7245
  7246
  7247* EXEC CICS HANDLE CONDITION
  7248*        DUPREC (2577-DUPREC)
  7249*    END-EXEC.
  7250*    MOVE '"$%                   ! ) #00006875' TO DFHEIV0
  7251     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7253     MOVE X'2920233030303036383735' TO DFHEIV0(25:11)
  7254     CALL 'kxdfhei1' USING DFHEIV0
  7255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7256
  7257
  7258
  7259* EXEC CICS WRITE
  7260*        DATASET (ERPYAJ-FILE-ID)
  7261*        FROM    (PENDING-PAY-ADJ)
  7262*        RIDFLD  (PY-CONTROL-PRIMARY)
  7263*    END-EXEC.
  7264     MOVE LENGTH OF
  7265      PENDING-PAY-ADJ
  7266       TO DFHEIV11
  7267*    MOVE '&$ L                  ''   #00006879' TO DFHEIV0
  7268     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7269     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7270     MOVE X'2020233030303036383739' TO DFHEIV0(25:11)
  7271     CALL 'kxdfhei1' USING DFHEIV0,
  7272           ERPYAJ-FILE-ID,
  7273           PENDING-PAY-ADJ,
  7274           DFHEIV11,
  7275           PY-CONTROL-PRIMARY,
  7276           DFHEIV99,
  7277           DFHEIV99
  7278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7279
  7280
  7281     GO TO 2579-WRITE-EXIT.
  7282
  7283 2577-DUPREC.
  7284     ADD +1 TO PY-FILE-SEQ-NO.
  7285
  7286     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7287
  7288 2579-WRITE-EXIT.
  7289     EXIT.
  7290
  7291 2580-HANDLE-ELCNTL-FILE.
  7292
  7293     IF CR-CHECK-NO-AUTO-SEQ
  7294         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7295     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 130
* EL677.cbl
  7296
  7297* EXEC CICS UNLOCK
  7298*            DATASET (ELCNTL-FILE-ID)
  7299*        END-EXEC.
  7300*    MOVE '&*                    #   #00006900' TO DFHEIV0
  7301     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7302     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7303     MOVE X'2020233030303036393030' TO DFHEIV0(25:11)
  7304     CALL 'kxdfhei1' USING DFHEIV0,
  7305           ELCNTL-FILE-ID,
  7306           DFHEIV99
  7307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7308
  7309
  7310 2590-EXIT.
  7311      EXIT.
  7312
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 131
* EL677.cbl
  7314
  7315 2600-READ-CONTROL-FILE.
  7316     MOVE SPACES                 TO ELCNTL-KEY.
  7317     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7318     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7319     MOVE +0                     TO ELCNTL-SEQ.
  7320
  7321
  7322* EXEC CICS HANDLE CONDITION
  7323*        NOTFND   (2600-NO-CO-MASTER)
  7324*    END-EXEC.
  7325*    MOVE '"$I                   ! * #00006915' TO DFHEIV0
  7326     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7328     MOVE X'2A20233030303036393135' TO DFHEIV0(25:11)
  7329     CALL 'kxdfhei1' USING DFHEIV0
  7330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7331
  7332
  7333
  7334* EXEC CICS READ
  7335*        DATASET   (ELCNTL-FILE-ID)
  7336*        SET       (ADDRESS OF CONTROL-FILE)
  7337*        RIDFLD    (ELCNTL-KEY)
  7338*    END-EXEC.
  7339*    MOVE '&"S        E          (   #00006919' TO DFHEIV0
  7340     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7341     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7342     MOVE X'2020233030303036393139' TO DFHEIV0(25:11)
  7343     CALL 'kxdfhei1' USING DFHEIV0,
  7344           ELCNTL-FILE-ID,
  7345           DFHEIV20,
  7346           DFHEIV99,
  7347           ELCNTL-KEY,
  7348           DFHEIV99,
  7349           DFHEIV99,
  7350           DFHEIV99
  7351     SET ADDRESS OF CONTROL-FILE TO
  7352         DFHEIV20
  7353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7354
  7355
  7356     GO TO 2600-EXIT
  7357
  7358     .
  7359 2600-NO-CO-MASTER.
  7360     MOVE ER-0022                TO  EMI-ERROR.
  7361     MOVE -1                     TO  CARRIERL.
  7362     MOVE AL-UABON               TO  CARRIERA.
  7363     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7364
  7365 2600-EXIT.
  7366      EXIT.
  7367
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 132
* EL677.cbl
  7369 2650-REWRITE-CONTROL-FILE.
  7370
  7371* EXEC CICS READ
  7372*        DATASET   (ELCNTL-FILE-ID)
  7373*        SET       (ADDRESS OF CONTROL-FILE)
  7374*        RIDFLD    (ELCNTL-KEY)
  7375*        UPDATE
  7376*    END-EXEC.
  7377*    MOVE '&"S        EU         (   #00006939' TO DFHEIV0
  7378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7379     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7380     MOVE X'2020233030303036393339' TO DFHEIV0(25:11)
  7381     CALL 'kxdfhei1' USING DFHEIV0,
  7382           ELCNTL-FILE-ID,
  7383           DFHEIV20,
  7384           DFHEIV99,
  7385           ELCNTL-KEY,
  7386           DFHEIV99,
  7387           DFHEIV99,
  7388           DFHEIV99
  7389     SET ADDRESS OF CONTROL-FILE TO
  7390         DFHEIV20
  7391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7392
  7393
  7394
  7395* EXEC CICS REWRITE
  7396*         DATASET (ELCNTL-FILE-ID)
  7397*         FROM    (CONTROL-FILE)
  7398*     END-EXEC.
  7399     MOVE LENGTH OF
  7400      CONTROL-FILE
  7401       TO DFHEIV11
  7402*    MOVE '&& L                  %   #00006946' TO DFHEIV0
  7403     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7404     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7405     MOVE X'2020233030303036393436' TO DFHEIV0(25:11)
  7406     CALL 'kxdfhei1' USING DFHEIV0,
  7407           ELCNTL-FILE-ID,
  7408           CONTROL-FILE,
  7409           DFHEIV11,
  7410           DFHEIV99
  7411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7412
  7413
  7414 2650-EXIT.
  7415      EXIT.
  7416 2700-WRITE-SQL.
  7417     perform 2710-build-rec      thru 2710-exit
  7418     perform 2720-insert-row     thru 2720-exit
  7419     perform 4300-FINISH-UP-DB   thru 4300-exit
  7420     .
  7421 2700-EXIT.
  7422     EXIT.
  7423 2710-BUILD-REC.
  7424     move spaces                 to daily-check-request-rec
  7425     move pi-company-id          to db-compid
  7426     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 133
* EL677.cbl
  7427                                    db-fincar
  7428     move ch-grouping            to db-grouping
  7429                                    db-fingrp
  7430     move ch-state               to db-state
  7431     move ch-account             to db-account
  7432     move ch-cert-eff-dt         to dc-bin-date-1
  7433     move ' '                    to dc-option-code
  7434     perform 8500-date-convert   thru 8500-exit
  7435     if no-conversion-error
  7436        move dc-greg-date-a-edit to db-effdate
  7437     else
  7438        move spaces              to db-effdate
  7439     end-if
  7440     move ch-cert-prime          to db-certificate
  7441     move ch-cert-sfx            to db-cert-sfx
  7442     move ch-sequence-no         to db-seq-no
  7443     move '1'                    to db-type
  7444                                    db-check-sub-type
  7445     if pi-check-type = 'C'
  7446        move '2'                 to db-check-sub-type
  7447     end-if
  7448     move ch-amount-paid         to db-amount-n
  7449     move zeros                  to db-checkstatus
  7450     move ch-check-que-control   to db-releasebatch
  7451     move save-bin-date          to dc-bin-date-1
  7452     move ' '                    to dc-option-code
  7453     perform 8500-date-convert   thru 8500-exit
  7454     if no-conversion-error
  7455        move dc-greg-date-a-edit to db-releasedt
  7456     else
  7457        move spaces              to db-releasedt
  7458     end-if
  7459     move pi-processor-id        to db-releaseby
  7460     move ch-payee-name-1        to db-payeename1
  7461     move ch-payee-name-2        to db-payeename2
  7462     move ch-payee-address-1     to db-payeeaddr1
  7463     move ch-payee-address-2     to db-payeeaddr2
  7464     move ch-payee-city          to db-payeecity
  7465     move ch-payee-state         to db-payeest
  7466     move ch-payee-zip-code      to db-payeezip
  7467     move ch-comp-fin-resp       to db-finresp
  7468     move ch-comp-account        to db-finacct
  7469     move ch-recorded-by         to db-preparer
  7470     move ch-return-to           to db-return-to
  7471     move pi-table-name          to db-insured-name
  7472     .
  7473 2710-EXIT.
  7474     EXIT.
  7475 2720-INSERT-ROW.
  7476     if not connected-to-db
  7477        perform 4100-CONNECT-TO-DB
  7478                                 thru 4100-exit
  7479     end-if
  7480     EXEC SQL
  7481        INSERT into ChkApp_Check (
  7482           Company,
  7483           CertCarrier,
  7484           CertGroup,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 134
* EL677.cbl
  7485           CertState,
  7486           CertAccount,
  7487           CertEffDate,
  7488           CertNumber,
  7489           CertNumberSuf,
  7490           CheckSeqNbr,
  7491           CheckType,
  7492           CheckAmount,
  7493           ReleaseBatchNbr,
  7494           ReleaseDate,
  7495           ReleasedBy,
  7496           PayeeName1,
  7497           PayeeName2,
  7498           PayeeAddress1,
  7499           PayeeAddress2,
  7500           PayeeCity,
  7501           PayeeState,
  7502           PayeeZip,
  7503           CompCarrier,
  7504           CompGroup,
  7505           CompFinResp,
  7506           CompAccount,
  7507           Preparer,
  7508           ReturnTo,
  7509           InsuredName,
  7510           CheckSubType)
  7511         VALUES (
  7512           :DB-CompId,
  7513           :DB-Carrier,
  7514           :DB-Grouping,
  7515           :DB-State,
  7516           :DB-Account,
  7517           :DB-EffDate,
  7518           :DB-Certificate,
  7519           :db-cert-sfx,
  7520           :DB-Seq-No,
  7521           :DB-Type,
  7522           :db-amount,
  7523           :db-releasebatch,
  7524           :db-releasedt,
  7525           :db-releaseby,
  7526           :db-payeename1,
  7527           :db-payeename2,
  7528           :db-payeeaddr1,
  7529           :db-payeeaddr2,
  7530           :db-payeecity,
  7531           :db-payeest,
  7532           :db-payeezip,
  7533           :db-fincar,
  7534           :db-fingrp,
  7535           :db-finresp,
  7536           :db-finacct,
  7537           :db-preparer,
  7538           :db-return-to,
  7539           :db-insured-name,
  7540           :db-check-sub-type)
  7541     END-EXEC
  7542     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 135
* EL677.cbl
  7543        add +1                   to ch-sequence-no
  7544        move ch-sequence-no      to DB-Seq-No
  7545        go to 2720-insert-row
  7546     end-if
  7547     if sqlcode not = 0
  7548        display "Error: cannot insert row "
  7549        display ' sql return code ' sqlcode
  7550        move sqlcode to ws-sql-code
  7551        move ws-sql-code to ws-dis-sql-code
  7552        display ' dis sql code ' ws-dis-sql-code
  7553        display ' sql err mess    ' sqlerrmc
  7554        move sqlcode to ws-sql-code
  7555        move ws-sql-code to ws-dis-sql-code
  7556        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7557           into EMI-MESSAGE-AREA (1)
  7558        end-string
  7559        display ' msga1 ' emi-message-area (1)
  7560        perform 4300-FINISH-UP-DB thru 4300-exit
  7561        go to 8200-send-dataonly
  7562*       goback
  7563     end-if
  7564     .
  7565 2720-EXIT.
  7566     EXIT.
  7567 3000-CHANGE-RECORD.
  7568
  7569* EXEC CICS HANDLE CONDITION
  7570*        NOTFND (3900-RECORD-NOTFND)
  7571*    END-EXEC.
  7572*    MOVE '"$I                   ! + #00007105' TO DFHEIV0
  7573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7575     MOVE X'2B20233030303037313035' TO DFHEIV0(25:11)
  7576     CALL 'kxdfhei1' USING DFHEIV0
  7577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7578
  7579
  7580
  7581* EXEC CICS READ
  7582*        DATASET  (ERCHEK-FILE-ID)
  7583*        SET      (ADDRESS OF CHECK-RECORDS)
  7584*        RIDFLD   (PI-ERCHEK-KEY)
  7585*        UPDATE
  7586*    END-EXEC.
  7587*    MOVE '&"S        EU         (   #00007109' TO DFHEIV0
  7588     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7589     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7590     MOVE X'2020233030303037313039' TO DFHEIV0(25:11)
  7591     CALL 'kxdfhei1' USING DFHEIV0,
  7592           ERCHEK-FILE-ID,
  7593           DFHEIV20,
  7594           DFHEIV99,
  7595           PI-ERCHEK-KEY,
  7596           DFHEIV99,
  7597           DFHEIV99,
  7598           DFHEIV99
  7599     SET ADDRESS OF CHECK-RECORDS TO
  7600         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 136
* EL677.cbl
  7601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7602
  7603
  7604     IF CH-LF-REFUND NOT NUMERIC
  7605         MOVE ZEROS              TO CH-LF-REFUND.
  7606     IF CH-AH-REFUND NOT NUMERIC
  7607         MOVE ZEROS              TO CH-AH-REFUND.
  7608*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7609*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7610*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7611*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7612
  7613     IF VREASONL NOT = ZEROS
  7614         MOVE VREASONI           TO  CH-VOID-REASON.
  7615
  7616     IF MAINTI = 'V'
  7617        GO TO 3050-void-processing
  7618     end-if
  7619
  7620     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7621
  7622     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7623
  7624     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7625       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7626        EIBAID NOT = DFHPF4)
  7627         GO TO 8200-SEND-DATAONLY.
  7628     go to 3100-rewrite-record
  7629     .
  7630 3050-void-processing.
  7631     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7632     if sqlcode = 0
  7633        perform 4200-get-tbl-row thru 4200-exit
  7634        if sqlcode = 0
  7635           if nu-app-date = -1
  7636              move -1            to maintl
  7637              move er-3453       to emi-error
  7638              move al-uabon      to mainta
  7639              perform 9900-error-format
  7640                                 thru 9900-exit
  7641              perform 4300-FINISH-UP-DB thru 4300-exit
  7642              go to 8200-send-dataonly
  7643           end-if
  7644        end-if
  7645        if connected-to-db
  7646           perform 4300-FINISH-UP-DB thru 4300-exit
  7647        end-if
  7648     end-if
  7649     if (ch-check-written-dt = low-values)
  7650        or (ch-check-no = spaces)
  7651        move -1                  to maintl
  7652        move er-3455             to emi-error
  7653        move al-uabon            to mainta
  7654        perform 9900-error-format
  7655                                 thru 9900-exit
  7656        perform 4300-FINISH-UP-DB thru 4300-exit
  7657        go to 8200-send-dataonly
  7658     end-if
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 137
* EL677.cbl
  7659     .
  7660 3100-REWRITE-RECORD.
  7661     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7662
  7663     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7664     MOVE '5'                    TO DC-OPTION-CODE.
  7665     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7666
  7667     IF MAINTI = 'C'
  7668       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7669     end-if
  7670*      IF MANUAL-CHECK-WRITTEN
  7671*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7672
  7673     IF MAINTI = 'V'
  7674        IF (CH-VOID-DT = LOW-VALUES)
  7675           and (pi-check-cashed = spaces)
  7676           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7677           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7678*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7679           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7680           if pi-chek-rec-cnt = +1
  7681              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7682                                 THRU 6200-EXIT
  7683              if resp-normal
  7684                 MOVE ' '        TO PB-C-REFUND-SW
  7685                 perform 6210-rewrite-pndb
  7686                                 thru 6210-exit
  7687              end-if
  7688           end-if
  7689        ELSE
  7690           MOVE -1               TO MAINTL
  7691           MOVE ER-2583          TO EMI-ERROR
  7692           MOVE AL-UABON         TO MAINTA
  7693           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7694           GO TO 8200-SEND-DATAONLY
  7695        end-if
  7696     end-if
  7697
  7698     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7699
  7700
  7701* EXEC CICS REWRITE
  7702*        DATASET  (ERCHEK-FILE-ID)
  7703*        FROM     (CHECK-RECORDS)
  7704*    END-EXEC.
  7705     MOVE LENGTH OF
  7706      CHECK-RECORDS
  7707       TO DFHEIV11
  7708*    MOVE '&& L                  %   #00007212' TO DFHEIV0
  7709     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7710     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7711     MOVE X'2020233030303037323132' TO DFHEIV0(25:11)
  7712     CALL 'kxdfhei1' USING DFHEIV0,
  7713           ERCHEK-FILE-ID,
  7714           CHECK-RECORDS,
  7715           DFHEIV11,
  7716           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 138
* EL677.cbl
  7717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7718
  7719
  7720     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7721        (MAINTI EQUAL 'C')          AND
  7722        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7723            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7724
  7725     IF EMI-NO-ERRORS
  7726         MOVE ER-0000            TO EMI-ERROR
  7727     ELSE
  7728         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7729            EIBAID = DFHPF4
  7730             MOVE ER-2600        TO EMI-ERROR.
  7731
  7732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7733
  7734     MOVE LOW-VALUES             TO EL677AI.
  7735
  7736     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7737     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7738     MOVE PI-CHEK-STATE          TO STATEO.
  7739     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7740
  7741     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7742     MOVE SPACE                  TO DC-OPTION-CODE.
  7743     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7744     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7745
  7746     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7747     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7748     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7749
  7750     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7751                                     ACCTA   EFFDTA
  7752                                    CERTNOA   SFXA.
  7753
  7754     MOVE AL-UNNON               TO SEQA.
  7755     go to 5000-browse-file
  7756*    GO TO 8100-SEND-INITIAL-MAP.
  7757
  7758     .
  7759 3200-PAY-ADJS-REVERSAL.
  7760
  7761     IF CH-AMOUNT-PAID NOT = ZEROS
  7762         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7763         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7764
  7765     GO TO 3290-EXIT
  7766     .
  7767 3250-BUILD-ERPYAJ-REVERSAL.
  7768
  7769
  7770* EXEC CICS GETMAIN
  7771*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7772*        LENGTH  (200)
  7773*        INITIMG (GETMAIN-SPACE)
  7774*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 139
* EL677.cbl
  7775     MOVE 200
  7776       TO DFHEIV11
  7777*    MOVE ',"IL                  $   #00007266' TO DFHEIV0
  7778     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7779     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7780     MOVE X'2020233030303037323636' TO DFHEIV0(25:11)
  7781     CALL 'kxdfhei1' USING DFHEIV0,
  7782           DFHEIV20,
  7783           DFHEIV11,
  7784           GETMAIN-SPACE
  7785     SET ADDRESS OF PENDING-PAY-ADJ TO
  7786         DFHEIV20
  7787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7788
  7789
  7790     MOVE 'PY'                   TO PY-RECORD-ID.
  7791     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7792
  7793     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7794     IF PI-ZERO-CARRIER  OR
  7795        PI-ZERO-CAR-GROUP
  7796         MOVE ZERO               TO PY-CARRIER.
  7797
  7798     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7799     IF PI-ZERO-GROUPING  OR
  7800        PI-ZERO-CAR-GROUP
  7801         MOVE ZERO               TO PY-GROUPING.
  7802
  7803     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7804     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7805     MOVE 'R'                    TO PY-RECORD-TYPE.
  7806     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7807     move '1825011300'           to py-gl-account
  7808     move 'VOID REFCK'           TO py-gl-comment
  7809     move ch-amount-paid         to py-entry-amt
  7810*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7811
  7812     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7813     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7814
  7815     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7816     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7817     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7818                                    PY-INPUT-DT.
  7819*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7820*                                   PY-CHECK-QUE-SEQUENCE.
  7821     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7822                                    PY-BILLED-DATE
  7823                                    PY-REPORTED-DT
  7824                                    PY-CHECK-WRITTEN-DT
  7825                                    PY-AR-DATE
  7826                                    PY-GL-DATE.
  7827     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7828     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7829*    MOVE 'V'                    TO PY-VOID-SW.
  7830*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7831
  7832     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 140
* EL677.cbl
  7833         MOVE 'B'                TO PY-PYMT-TYPE
  7834         MOVE 'A'                TO PY-PMT-APPLIED.
  7835
  7836 3259-BUILD-EXIT.
  7837     EXIT.
  7838
  7839 3280-WRITE-ERPYAJ-REVERSAL.
  7840
  7841
  7842* EXEC CICS HANDLE CONDITION
  7843*        DUPREC (3287-DUPREC)
  7844*    END-EXEC.
  7845*    MOVE '"$%                   ! , #00007323' TO DFHEIV0
  7846     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7848     MOVE X'2C20233030303037333233' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853
  7854* EXEC CICS WRITE
  7855*        DATASET (ERPYAJ-FILE-ID)
  7856*        FROM    (PENDING-PAY-ADJ)
  7857*        RIDFLD  (PY-CONTROL-PRIMARY)
  7858*    END-EXEC.
  7859     MOVE LENGTH OF
  7860      PENDING-PAY-ADJ
  7861       TO DFHEIV11
  7862*    MOVE '&$ L                  ''   #00007327' TO DFHEIV0
  7863     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7865     MOVE X'2020233030303037333237' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           ERPYAJ-FILE-ID,
  7868           PENDING-PAY-ADJ,
  7869           DFHEIV11,
  7870           PY-CONTROL-PRIMARY,
  7871           DFHEIV99,
  7872           DFHEIV99
  7873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7874
  7875
  7876     GO TO 3289-WRITE-EXIT.
  7877
  7878 3287-DUPREC.
  7879     ADD +1 TO PY-FILE-SEQ-NO.
  7880
  7881     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7882
  7883 3289-WRITE-EXIT.
  7884     EXIT.
  7885
  7886 3290-EXIT.
  7887      EXIT.
  7888
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 141
* EL677.cbl
  7890 3300-UPDATE-ERPYAJ.
  7891
  7892
  7893* EXEC CICS GETMAIN
  7894*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7895*        LENGTH  (200)
  7896*        INITIMG (GETMAIN-SPACE)
  7897*    END-EXEC.
  7898     MOVE 200
  7899       TO DFHEIV11
  7900*    MOVE ',"IL                  $   #00007349' TO DFHEIV0
  7901     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7902     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7903     MOVE X'2020233030303037333439' TO DFHEIV0(25:11)
  7904     CALL 'kxdfhei1' USING DFHEIV0,
  7905           DFHEIV20,
  7906           DFHEIV11,
  7907           GETMAIN-SPACE
  7908     SET ADDRESS OF PENDING-PAY-ADJ TO
  7909         DFHEIV20
  7910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7911
  7912
  7913     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7914     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7915     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7916     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7917     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7918     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7919     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7920
  7921
  7922* EXEC CICS HANDLE CONDITION
  7923*        NOTFND   (3390-EXIT)
  7924*        ENDFILE  (3390-EXIT)
  7925*    END-EXEC.
  7926*    MOVE '"$I''                  ! - #00007363' TO DFHEIV0
  7927     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7929     MOVE X'2D20233030303037333633' TO DFHEIV0(25:11)
  7930     CALL 'kxdfhei1' USING DFHEIV0
  7931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7932
  7933
  7934 3320-READNEXT-ERPYAJ.
  7935
  7936
  7937* EXEC CICS READ
  7938*        DATASET  (ERPYAJ-FILE-ID)
  7939*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7940*        RIDFLD   (ERPYAJ-KEY)
  7941*        GTEQ
  7942*    END-EXEC.
  7943*    MOVE '&"S        G          (   #00007370' TO DFHEIV0
  7944     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7945     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7946     MOVE X'2020233030303037333730' TO DFHEIV0(25:11)
  7947     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 142
* EL677.cbl
  7948           ERPYAJ-FILE-ID,
  7949           DFHEIV20,
  7950           DFHEIV99,
  7951           ERPYAJ-KEY,
  7952           DFHEIV99,
  7953           DFHEIV99,
  7954           DFHEIV99
  7955     SET ADDRESS OF PENDING-PAY-ADJ TO
  7956         DFHEIV20
  7957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7958
  7959
  7960     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7961
  7962     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7963        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7964        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7965        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7966        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7967        (PY-RECORD-TYPE   NOT = 'C')
  7968          GO TO 3390-EXIT.
  7969
  7970     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7971         ADD +1 TO PYAJ-FILE-SEQ-NO
  7972         GO TO 3320-READNEXT-ERPYAJ.
  7973
  7974
  7975* EXEC CICS READ UPDATE
  7976*        DATASET   (ERPYAJ-FILE-ID)
  7977*        RIDFLD    (ERPYAJ-KEY)
  7978*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7979*    END-EXEC.
  7980*    MOVE '&"S        EU         (   #00007391' TO DFHEIV0
  7981     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7982     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7983     MOVE X'2020233030303037333931' TO DFHEIV0(25:11)
  7984     CALL 'kxdfhei1' USING DFHEIV0,
  7985           ERPYAJ-FILE-ID,
  7986           DFHEIV20,
  7987           DFHEIV99,
  7988           ERPYAJ-KEY,
  7989           DFHEIV99,
  7990           DFHEIV99,
  7991           DFHEIV99
  7992     SET ADDRESS OF PENDING-PAY-ADJ TO
  7993         DFHEIV20
  7994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7995
  7996
  7997     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7998     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7999
  8000     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  8001
  8002     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8003     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8004     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  8005
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 143
* EL677.cbl
  8006
  8007* EXEC CICS REWRITE
  8008*        DATASET  (ERPYAJ-FILE-ID)
  8009*        FROM     (PENDING-PAY-ADJ)
  8010*    END-EXEC.
  8011     MOVE LENGTH OF
  8012      PENDING-PAY-ADJ
  8013       TO DFHEIV11
  8014*    MOVE '&& L                  %   #00007406' TO DFHEIV0
  8015     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8016     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8017     MOVE X'2020233030303037343036' TO DFHEIV0(25:11)
  8018     CALL 'kxdfhei1' USING DFHEIV0,
  8019           ERPYAJ-FILE-ID,
  8020           PENDING-PAY-ADJ,
  8021           DFHEIV11,
  8022           DFHEIV99
  8023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8024
  8025
  8026 3390-EXIT.
  8027      EXIT.
  8028
  8029 3400-delete-record.
  8030
  8031* EXEC CICS READ
  8032*        DATASET  (ERCHEK-FILE-ID)
  8033*        SET      (ADDRESS OF CHECK-RECORDS)
  8034*        RIDFLD   (PI-ERCHEK-KEY)
  8035*        UPDATE
  8036*        resp     (ws-response)
  8037*    END-EXEC
  8038*    MOVE '&"S        EU         (  N#00007415' TO DFHEIV0
  8039     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8040     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8041     MOVE X'204E233030303037343135' TO DFHEIV0(25:11)
  8042     CALL 'kxdfhei1' USING DFHEIV0,
  8043           ERCHEK-FILE-ID,
  8044           DFHEIV20,
  8045           DFHEIV99,
  8046           PI-ERCHEK-KEY,
  8047           DFHEIV99,
  8048           DFHEIV99,
  8049           DFHEIV99
  8050     SET ADDRESS OF CHECK-RECORDS TO
  8051         DFHEIV20
  8052     MOVE EIBRESP  TO ws-response
  8053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8054     if (ch-in-limbo or ch-approv-pending)
  8055        and (ch-void-dt = low-values)
  8056        and (ch-check-written-dt = low-values)
  8057        and (ch-credit-accept-dt = low-values)
  8058        perform 3500-check-tbl   thru 3500-exit
  8059        if (row-deleted and tbl-commited)
  8060           or (emi-error = er-3450)
  8061
  8062* exec cics delete
  8063*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 144
* EL677.cbl
  8064*          end-exec
  8065*    MOVE '&(                    &   #00007429' TO DFHEIV0
  8066     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8067     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8068     MOVE X'2020233030303037343239' TO DFHEIV0(25:11)
  8069     CALL 'kxdfhei1' USING DFHEIV0,
  8070           erchek-file-id,
  8071           DFHEIV99,
  8072           DFHEIV99,
  8073           DFHEIV99,
  8074           DFHEIV99
  8075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8076        end-if
  8077     else
  8078        move -1               to maintl
  8079        move er-3452          to emi-error
  8080        move al-uabon         to mainta
  8081        perform 9900-error-format
  8082                                 thru 9900-exit
  8083        go to 8200-send-dataonly
  8084     end-if
  8085     if pi-chek-rec-cnt = +1
  8086        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8087                                 THRU 6200-EXIT
  8088        if resp-normal
  8089           MOVE ' '              TO PB-C-REFUND-SW
  8090           perform 6210-rewrite-pndb
  8091                                 thru 6210-exit
  8092        end-if
  8093     end-if
  8094     MOVE ER-0000            TO EMI-ERROR
  8095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8096     MOVE LOW-VALUES             TO EL677AI.
  8097     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8098     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8099     MOVE PI-CHEK-STATE          TO STATEO.
  8100     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8101     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8102     MOVE SPACE                  TO DC-OPTION-CODE.
  8103     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8104     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8105     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8106     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8107     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8108     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8109                                    ACCTA   EFFDTA
  8110                                    CERTNOA   SFXA.
  8111     MOVE AL-UNNON               TO SEQA.
  8112     GO TO 8100-SEND-INITIAL-MAP
  8113     .
  8114 3400-exit.
  8115     exit.
  8116 3500-check-tbl.
  8117     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8118*    if sqlcode = 0
  8119*       perform 4150-open-cursor    thru 4150-exit
  8120*    end-if
  8121     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 145
* EL677.cbl
  8122        perform 4200-get-tbl-row thru 4200-exit
  8123     end-if
  8124      if sqlcode = 0
  8125         if (nu-app-date = -1)
  8126            or (db-app-status = '2')
  8127            perform 4250-delete-row thru 4250-exit
  8128         else
  8129           MOVE ER-3452            TO  EMI-ERROR
  8130           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8131           MOVE -1                 TO  PFENTERL
  8132           GO TO 8200-SEND-DATAONLY
  8133        end-if
  8134      else
  8135         MOVE ER-3450            TO  EMI-ERROR
  8136         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8137         MOVE -1                 TO  PFENTERL
  8138*        GO TO 8200-SEND-DATAONLY
  8139      end-if
  8140     if connected-to-db
  8141        perform 4300-FINISH-UP-DB thru 4300-exit
  8142     end-if
  8143     .
  8144 3500-exit.
  8145     exit.
  8146 3700-UPDATE-ERCHKQ.
  8147*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8148*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8149*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8150*
  8151*    EXEC CICS HANDLE CONDITION
  8152*        NOTFND (3780-CHECK-NOTFND)
  8153*    END-EXEC.
  8154*
  8155*    EXEC CICS READ
  8156*        DATASET  (ERCHKQ-FILE-ID)
  8157*        SET      (ADDRESS OF CHECK-QUE)
  8158*        RIDFLD   (ERCHKQ-KEY)
  8159*        UPDATE
  8160*    END-EXEC.
  8161*
  8162*    IF MAINTI = 'C'
  8163*        IF MANUAL-CHECK-WRITTEN
  8164*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8165*            MOVE +1                  TO CQ-TIMES-PRINTED
  8166*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8167*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8168*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8169*
  8170*    IF MAINTI = 'V'
  8171*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8172*                                   CQ-VOID-INDICATOR
  8173*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8174*
  8175*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8176*
  8177*    EXEC CICS REWRITE
  8178*        DATASET  (ERCHKQ-FILE-ID)
  8179*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 146
* EL677.cbl
  8180*    END-EXEC.
  8181*
  8182*    GO TO 3790-EXIT.
  8183*
  8184*3780-CHECK-NOTFND.
  8185*    MOVE ER-2905                TO EMI-ERROR.
  8186*    MOVE -1                     TO CARRIERL
  8187*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8188*                                   ACCTA     EFFDTA  CERTNOA
  8189*                                   SFXA      SEQA.
  8190*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8191     .
  8192 3790-EXIT.
  8193      EXIT.
  8194
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 147
* EL677.cbl
  8196
  8197 3900-RECORD-NOTFND.
  8198     MOVE ER-2908                TO EMI-ERROR.
  8199     MOVE -1                     TO CARRIERL
  8200     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8201                                    ACCTA     EFFDTA  CERTNOA
  8202                                    SFXA      SEQA.
  8203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8204     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 148
* EL677.cbl
  8206 4000-ADD-CHANGE.
  8207     IF PAYTO1L NOT = ZEROS
  8208        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8209     END-IF
  8210
  8211     IF PAYTO2L NOT = ZEROS
  8212         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8213
  8214     IF PAYAD1L NOT = ZEROS
  8215         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8216
  8217     IF PAYAD2L NOT = ZEROS
  8218         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8219
  8220     IF PAYctyL NOT = ZEROS
  8221         MOVE payctyi            TO CH-PAYEE-CITY.
  8222
  8223     IF PAYstL NOT = ZEROS
  8224         MOVE paysti            TO CH-PAYEE-state.
  8225
  8226     IF PAYEEI GREATER SPACES
  8227        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8228
  8229     IF PTOZIPL  =  ZEROS
  8230         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8231         GO TO 4000-CK-REST.
  8232
  8233     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8234
  8235     IF NOT WS-CANADIAN-POST-CODE
  8236         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8237         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8238         GO TO 4000-CK-REST.
  8239
  8240     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8241     IF WS-CAN-POST-4TH = SPACE OR '-'
  8242         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8243         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8244     ELSE
  8245         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8246         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8247
  8248 4000-CK-REST.
  8249
  8250     IF RETTOL NOT = ZEROS
  8251        MOVE RETTOI TO CH-RETURN-TO.
  8252     if dedcynl not = zeros
  8253        move dedcyni             to ch-deduct-commission
  8254     end-if
  8255     if dedcynl not = zeros
  8256        if (dedcyni = 'Y')
  8257           or (pi-prev-ded-comm = 'Y')
  8258           compute ws-amt = pi-amount - pi-ue-comm
  8259        else
  8260           if dedcyni = 'N'
  8261              compute ws-amt = pi-amount
  8262           end-if
  8263        end-if
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 149
* EL677.cbl
  8264     end-if
  8265*    if dedcynl not = zeros
  8266*       if (dedcyni = 'Y')
  8267*          or (pi-prev-ded-comm = 'Y')
  8268*          compute ws-amt =
  8269*             pi-refund-on-pending-rec -
  8270*                pi-prev-paid - pi-ue-comm
  8271*       else
  8272*          if dedcyni = 'N'
  8273*             compute ws-amt =
  8274*                pi-refund-on-pending-rec -
  8275*                   pi-prev-paid
  8276*          end-if
  8277*       end-if
  8278*    end-if
  8279     if pi-check-type = 'C'
  8280        compute ws-amt =
  8281           pi-endt-prm-diff - pi-prev-paid
  8282        if (dedcyni = 'Y')
  8283           or (pi-prev-ded-comm = 'Y')
  8284           compute ws-amt =
  8285              ws-amt - pi-ue-comm
  8286        end-if
  8287        if ws-amt <= zeros
  8288           move pi-endt-prm-diff to ws-amt
  8289        end-if
  8290     end-if
  8291     IF AMOUNTL NOT = ZEROS
  8292         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8293         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8294
  8295     IF CHECKL NOT = ZEROS
  8296         MOVE CHECKI             TO CH-CHECK-NO.
  8297
  8298     IF REASONL NOT = ZEROS
  8299         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8300
  8301*    IF DEDAMTL NOT = ZEROS
  8302*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8303*                                   DEDAMTO.
  8304
  8305*    IF ADDLCHGL NOT = ZEROS
  8306*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8307*                                   ADDLCHGO.
  8308
  8309     IF STUBL NOT = ZEROS
  8310         MOVE STUBI              TO CH-STUB-LINE-1.
  8311
  8312     IF TEXT1L NOT = ZEROS
  8313         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8314
  8315     IF TEXT2L NOT = ZEROS
  8316         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8317
  8318     IF TEXT3L NOT = ZEROS
  8319         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8320
  8321     IF TYPEL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 150
* EL677.cbl
  8322         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8323
  8324*    MOVE LETTER1I               TO CH-LETTERS (1).
  8325*    MOVE LETTER2I               TO CH-LETTERS (2).
  8326*    MOVE LETTER3I               TO CH-LETTERS (3).
  8327
  8328*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8329     IF CH-CHECK-ORIGIN-SW = 'R'
  8330         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8331*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
  8332         MOVE PI-CANC-DT             TO CH-CANC-DT
  8333         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8334         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8335     end-if
  8336     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8337*    IF PI-AR-PROCESSING AND
  8338*       REFL NOT = ZERO
  8339*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8340
  8341 4000-EXIT.
  8342      EXIT.
  8343 4100-CONNECT-TO-DB.
  8344     move 'NTSQLTST2_Logic'      to svr
  8345     move 'sa'                   to usr
  8346     move 'sql2008r2'            to pass
  8347
  8348     if ws-kix-myenv = 'cid1p'
  8349        move 'NTCSO2_ChkApprv'   to svr
  8350        move 'sa'                to usr
  8351        move 'ntcso2'            to pass
  8352     end-if
  8353     string
  8354         usr delimited space
  8355         "." delimited size
  8356         pass delimited space into usr-pass
  8357     end-string
  8358     EXEC SQL
  8359        CONNECT TO :svr USER :usr-pass
  8360     END-EXEC
  8361     if sqlcode not = 0
  8362        display "Error: cannot connect "
  8363        display sqlcode
  8364        display sqlerrmc
  8365     end-if
  8366     set connected-to-db to true
  8367     .
  8368 4100-EXIT.
  8369     EXIT.
  8370 4150-open-cursor.
  8371     move pi-company-id          to ws-compid
  8372     move ch-carrier             to ws-carrier
  8373     move ch-grouping            to ws-grouping
  8374     move ch-state               to ws-state
  8375     move ch-account             to ws-account
  8376     move ch-cert-eff-dt         to dc-bin-date-1
  8377     move ' '                    to dc-option-code
  8378     perform 8500-date-convert   thru 8500-exit
  8379     if no-conversion-error
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 151
* EL677.cbl
  8380        move dc-greg-date-a-edit to ws-eff-date
  8381     end-if
  8382     move ch-cert-prime          to ws-certificate
  8383     move ch-cert-sfx            to ws-cert-sfx
  8384     move ch-sequence-no         to ws-seq-no
  8385     move '1'                    to ws-type
  8386                                    ws-check-sub-type
  8387     if pi-check-type = 'C'
  8388        move '2'                 to ws-check-sub-type
  8389     end-if
  8390     EXEC SQL
  8391        DECLARE
  8392           checkapp cursor for
  8393        SELECT
  8394           ApprovalStatus,
  8395           MaintainedBy,
  8396           MaintainedDate,
  8397           ApprovalBatch
  8398        FROM
  8399           ChkApp_Check
  8400        WHERE
  8401           Company           = :ws-compid
  8402           and CertCarrier   = :ws-carrier
  8403           and CertGroup     = :ws-grouping
  8404           and CertState     = :ws-state
  8405           and CertAccount   = :ws-account
  8406           and CertEffDate   = :ws-eff-date
  8407           and CertNumber    = :ws-certificate
  8408           and CertNumberSuf = :ws-cert-sfx
  8409           and CheckSeqNbr   = :ws-seq-no
  8410           and CheckType     = :ws-type
  8411           and CheckSubType  = :ws-check-sub-type
  8412     END-EXEC
  8413     if sqlcode not = 0
  8414        display "Error: cannot declare cursor "
  8415        display ' sql retrun code ' sqlcode
  8416        display ' sql err mess    ' sqlerrmc
  8417        go to 4150-exit
  8418     end-if
  8419     EXEC SQL
  8420        open checkapp
  8421     END-EXEC
  8422     if sqlcode not = 0
  8423        display "Error: cannot open cursor "
  8424        display ' sql retrun code ' sqlcode
  8425        display ' sql err mess    ' sqlerrmc
  8426     end-if
  8427     .
  8428 4150-exit.
  8429     exit.
  8430 4200-get-tbl-row.
  8431***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8432***                                                            ***
  8433***  I'm only expecting one row so no cursor is declared       ***
  8434***                                                            ***
  8435***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8436     move pi-company-id          to ws-compid
  8437     move ch-carrier             to ws-carrier
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 152
* EL677.cbl
  8438     move ch-grouping            to ws-grouping
  8439     move ch-state               to ws-state
  8440     move ch-account             to ws-account
  8441     move ch-cert-eff-dt         to dc-bin-date-1
  8442     move ' '                    to dc-option-code
  8443     perform 8500-date-convert   thru 8500-exit
  8444     if no-conversion-error
  8445        move dc-greg-date-a-edit to ws-eff-date
  8446     end-if
  8447     move ch-cert-prime          to ws-certificate
  8448     move ch-cert-sfx            to ws-cert-sfx
  8449     move ch-sequence-no         to ws-seq-no
  8450     move '1'                    to ws-type
  8451                                    ws-check-sub-type
  8452     if pi-check-type = 'C'
  8453        move '2'                 to ws-check-sub-type
  8454     end-if
  8455     exec sql
  8456        SELECT
  8457           ApprovalStatus,
  8458           MaintainedBy,
  8459           MaintainedDate,
  8460           ApprovalBatch
  8461        INTO
  8462           :db-app-status :nu-app-status,
  8463           :db-app-by :nu-app-by,
  8464           :db-app-date :nu-app-date,
  8465           :db-app-batch :nu-app-batch
  8466        FROM
  8467           ChkApp_Check
  8468        WHERE
  8469           Company           = :ws-compid
  8470           and CertCarrier   = :ws-carrier
  8471           and CertGroup     = :ws-grouping
  8472           and CertState     = :ws-state
  8473           and CertAccount   = :ws-account
  8474           and CertEffDate   = :ws-eff-date
  8475           and CertNumber    = :ws-certificate
  8476           and CertNumberSuf = :ws-cert-sfx
  8477           and CheckSeqNbr   = :ws-seq-no
  8478           and CheckType     = :ws-type
  8479           and CheckSubType  = :ws-check-sub-type
  8480     end-exec
  8481     if sqlcode not = 0
  8482        display "Error: cannot read row "
  8483        display ' sql return code ' sqlcode
  8484        display ' sql err mess    ' sqlerrmc
  8485        go to 4200-exit
  8486     end-if
  8487*    display ' status ' db-app-status
  8488*    display ' by     ' db-app-by
  8489*    display ' date   ' db-app-date
  8490*    display ' batch  ' db-app-batch
  8491*    if nu-app-date = -1
  8492*       display ' approval date is low-values '
  8493*    else
  8494*       display ' approval date is NOT low values '
  8495*    end-if
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 153
* EL677.cbl
  8496     .
  8497 4200-exit.
  8498     exit.
  8499 4250-delete-row.
  8500     EXEC SQL
  8501        DELETE
  8502           from ChkApp_Check
  8503        WHERE
  8504           Company           = :ws-compid
  8505           and CertCarrier   = :ws-carrier
  8506           and CertGroup     = :ws-grouping
  8507           and CertState     = :ws-state
  8508           and CertAccount   = :ws-account
  8509           and CertEffDate   = :ws-eff-date
  8510           and CertNumber    = :ws-certificate
  8511           and CertNumberSuf = :ws-cert-sfx
  8512           and CheckSeqNbr   = :ws-seq-no
  8513           and CheckType     = :ws-type
  8514           and CheckSubType  = :ws-check-sub-type
  8515     END-EXEC
  8516     if sqlcode not = 0
  8517        display "Error: cannot delete row  "
  8518        display ' sql retrun code ' sqlcode
  8519        display ' sql err mess    ' sqlerrmc
  8520        go to 4250-exit
  8521     end-if
  8522     set row-deleted         to true
  8523     EXEC SQL
  8524         commit transaction
  8525     END-EXEC
  8526     if sqlcode not = 0
  8527        display "Error: commit "
  8528        display ' sql return code ' sqlcode
  8529        display ' sql err mess    ' sqlerrmc
  8530        go to 4250-exit
  8531     end-if
  8532     set tbl-commited to true
  8533     .
  8534 4250-exit.
  8535     exit.
  8536 4300-FINISH-UP-DB.
  8537     EXEC SQL
  8538         commit work release
  8539     END-EXEC
  8540     if sqlcode not = 0
  8541        display "Error: commit release "
  8542        display ' sql return code ' sqlcode
  8543        display ' sql err mess    ' sqlerrmc
  8544     end-if
  8545     .
  8546 4300-EXIT.
  8547     EXIT.
  8548 5000-BROWSE-FILE.
  8549
  8550* EXEC CICS HANDLE CONDITION
  8551*        NOTFND   (5560-END-OF-FILE)
  8552*        ENDFILE  (5560-END-OF-FILE)
  8553*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 154
* EL677.cbl
  8554*    MOVE '"$I''                  ! . #00007905' TO DFHEIV0
  8555     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8557     MOVE X'2E20233030303037393035' TO DFHEIV0(25:11)
  8558     CALL 'kxdfhei1' USING DFHEIV0
  8559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8560
  8561
  8562     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8563
  8564     IF SEQI = LOW-VALUES
  8565         MOVE +1                 TO CHEK-RECORD-SEQ.
  8566
  8567     IF EIBAID = DFHPF2
  8568         GO TO 5100-BROWSE-BKWD.
  8569
  8570 5010-READ-LOOP.
  8571     IF EIBAID = DFHPF1
  8572         ADD +1                  TO CHEK-RECORD-SEQ.
  8573
  8574
  8575* EXEC CICS READ
  8576*        DATASET  (ERCHEK-FILE-ID)
  8577*        SET      (ADDRESS OF CHECK-RECORDS)
  8578*        RIDFLD   (ERCHEK-KEY)
  8579*        GTEQ
  8580*    END-EXEC.
  8581*    MOVE '&"S        G          (   #00007922' TO DFHEIV0
  8582     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8584     MOVE X'2020233030303037393232' TO DFHEIV0(25:11)
  8585     CALL 'kxdfhei1' USING DFHEIV0,
  8586           ERCHEK-FILE-ID,
  8587           DFHEIV20,
  8588           DFHEIV99,
  8589           ERCHEK-KEY,
  8590           DFHEIV99,
  8591           DFHEIV99,
  8592           DFHEIV99
  8593     SET ADDRESS OF CHECK-RECORDS TO
  8594         DFHEIV20
  8595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8596
  8597
  8598     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8599         IF EIBAID = DFHENTER
  8600             GO TO 5550-NO-RECORD
  8601         ELSE
  8602             GO TO 5560-END-OF-FILE.
  8603
  8604        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8605           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8606           PI-CHEK-STATE      = CH-STATE       AND
  8607           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8608           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8609           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8610           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8611              GO TO 5500-FORMAT-SCREEN
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 155
* EL677.cbl
  8612            ELSE
  8613              IF EIBAID = DFHPF1
  8614                  GO TO 5560-END-OF-FILE
  8615                ELSE
  8616                  GO TO 5550-NO-RECORD.
  8617
  8618     IF EIBAID = DFHENTER
  8619        IF CHEK-CARRIER    = CH-CARRIER     AND
  8620           CHEK-GROUPING   = CH-GROUPING    AND
  8621           CHEK-STATE      = CH-STATE       AND
  8622           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8623           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8624           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8625           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8626           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8627              GO TO 5500-FORMAT-SCREEN
  8628        ELSE
  8629              GO TO 5550-NO-RECORD.
  8630
  8631     GO TO 5500-FORMAT-SCREEN.
  8632
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 156
* EL677.cbl
  8634
  8635 5100-BROWSE-BKWD.
  8636
  8637* EXEC CICS STARTBR
  8638*        DATASET  (ERCHEK-FILE-ID)
  8639*        RIDFLD   (ERCHEK-KEY)
  8640*    END-EXEC.
  8641     MOVE 0
  8642       TO DFHEIV11
  8643*    MOVE '&,         G          &   #00007967' TO DFHEIV0
  8644     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8645     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8646     MOVE X'2020233030303037393637' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0,
  8648           ERCHEK-FILE-ID,
  8649           ERCHEK-KEY,
  8650           DFHEIV99,
  8651           DFHEIV11,
  8652           DFHEIV99
  8653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8654
  8655
  8656
  8657* EXEC CICS READPREV
  8658*        DATASET  (ERCHEK-FILE-ID)
  8659*        SET      (ADDRESS OF CHECK-RECORDS)
  8660*        RIDFLD   (ERCHEK-KEY)
  8661*    END-EXEC.
  8662     MOVE 0
  8663       TO DFHEIV11
  8664*    MOVE '&0S                   )   #00007972' TO DFHEIV0
  8665     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8666     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8667     MOVE X'2020233030303037393732' TO DFHEIV0(25:11)
  8668     CALL 'kxdfhei1' USING DFHEIV0,
  8669           ERCHEK-FILE-ID,
  8670           DFHEIV20,
  8671           DFHEIV99,
  8672           ERCHEK-KEY,
  8673           DFHEIV99,
  8674           DFHEIV11,
  8675           DFHEIV99,
  8676           DFHEIV99
  8677     SET ADDRESS OF CHECK-RECORDS TO
  8678         DFHEIV20
  8679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8680
  8681
  8682 5110-READ-LOOP.
  8683     IF PI-FILE-EOF
  8684         MOVE SPACE              TO PI-EOF-SW
  8685     ELSE
  8686
  8687* EXEC CICS READPREV
  8688*            DATASET  (ERCHEK-FILE-ID)
  8689*            SET      (ADDRESS OF CHECK-RECORDS)
  8690*            RIDFLD   (ERCHEK-KEY)
  8691*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 157
* EL677.cbl
  8692     MOVE 0
  8693       TO DFHEIV11
  8694*    MOVE '&0S                   )   #00007982' TO DFHEIV0
  8695     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8696     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8697     MOVE X'2020233030303037393832' TO DFHEIV0(25:11)
  8698     CALL 'kxdfhei1' USING DFHEIV0,
  8699           ERCHEK-FILE-ID,
  8700           DFHEIV20,
  8701           DFHEIV99,
  8702           ERCHEK-KEY,
  8703           DFHEIV99,
  8704           DFHEIV11,
  8705           DFHEIV99,
  8706           DFHEIV99
  8707     SET ADDRESS OF CHECK-RECORDS TO
  8708         DFHEIV20
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8710
  8711
  8712     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8713         GO TO 5560-END-OF-FILE.
  8714
  8715        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8716           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8717           PI-CHEK-STATE      = CH-STATE       AND
  8718           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8719           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8720           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8721           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8722              GO TO 5500-FORMAT-SCREEN
  8723            ELSE
  8724              GO TO 5560-END-OF-FILE.
  8725
  8726     GO TO 5500-FORMAT-SCREEN.
  8727
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 158
* EL677.cbl
  8729*                          COPY ELCNPD.
  8730*****************************************************************
  8731*                                                               *
  8732*                                                               *
  8733*                            ELCNPD                             *
  8734*                            VMOD=2.001                         *
  8735*****************************************************************
  8736
  8737 5200-MOVE-NAME.
  8738*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8739*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8740*            BLANKS.                                            *
  8741*                                                               *
  8742*                  FIELD               VALUE                    *
  8743*                                                               *
  8744*                LAST NAME (CL15)      SMITH                    *
  8745*                1ST NAME  (CL12)      JOHN                     *
  8746*                MID NAME  (CL1)       A                        *
  8747*                                                               *
  8748*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8749*         *                                                     *
  8750*         *              JOHN A. SMITH                          *
  8751*         *                                                     *
  8752*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8753*         *  STORAGE COPYBOOK:                                  *
  8754*         *                                                     *
  8755*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8756*         *******************************************************.
  8757
  8758     MOVE SPACES                 TO  WS-NAME-WORK
  8759                                     WS-NAME-WORK2.
  8760     MOVE ZERO                   TO  WS-NAME-SW.
  8761     SET NWA-INDEX TO +1.
  8762
  8763     IF WS-INSURED-1ST-NAME = SPACES  AND
  8764        WS-INSURED-MID-INIT = SPACES
  8765         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8766         GO TO 5200-EXIT.
  8767
  8768     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8769     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8770
  8771     SET NWA-INDEX UP BY +1
  8772     IF WS-INSURED-MID-INIT NOT = SPACES
  8773        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8774        SET NWA-INDEX UP BY +1
  8775        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8776        SET NWA-INDEX UP BY +2.
  8777
  8778     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8779     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8780
  8781
  8782 5200-EXIT.
  8783     EXIT.
  8784
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 159
* EL677.cbl
  8786 5300-MOVE-NAME SECTION.
  8787     IF WS-NAME-SW GREATER THAN +1
  8788         GO TO 5390-EXIT.
  8789
  8790     IF WS-NAME-WORK2 = SPACES
  8791         GO TO 5390-EXIT.
  8792
  8793     SET NWA-INDEX2 TO +1.
  8794     SET NWA-INDEX3 TO +2.
  8795
  8796 5310-MOVE-NAME.
  8797     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8798
  8799     IF NWA-INDEX LESS THAN +30
  8800        SET NWA-INDEX UP BY +1
  8801     ELSE
  8802        ADD +2  TO  WS-NAME-SW
  8803        GO TO 5390-EXIT.
  8804
  8805     IF NWA-INDEX2 LESS THAN +20
  8806         SET NWA-INDEX2 UP BY +1
  8807         SET NWA-INDEX3 UP BY +1.
  8808
  8809     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8810        WS-NW2 (NWA-INDEX3) = SPACES
  8811        GO TO 5390-EXIT.
  8812
  8813     GO TO 5310-MOVE-NAME.
  8814
  8815 5390-EXIT.
  8816     EXIT.
  8817
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 160
* EL677.cbl
  8820 5500-FORMAT-SCREEN.
  8821     MOVE LOW-VALUES             TO  EL677AI.
  8822     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8823     MOVE +1                     TO  MAINTL.
  8824     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8825     MOVE CH-CARRIER             TO  CARRIERO.
  8826     MOVE CH-GROUPING            TO  GROUPO.
  8827     MOVE CH-STATE               TO  STATEO.
  8828     MOVE CH-ACCOUNT             TO  ACCTO.
  8829
  8830     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8831     MOVE SPACE                  TO  DC-OPTION-CODE.
  8832     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8833     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8834
  8835     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8836     MOVE CH-CERT-SFX            TO  SFXO.
  8837     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8838
  8839     MOVE AL-UANON               TO  CARRIERA
  8840                                     GROUPA
  8841                                     STATEA
  8842                                     ACCTA
  8843                                     EFFDTA
  8844                                     CERTNOA
  8845                                     SFXA.
  8846     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8847
  8848     if ch-approval-dt not = low-values
  8849        move ch-approval-dt      to dc-bin-date-1
  8850        move ' '                 to dc-option-code
  8851        perform 8500-date-convert thru 8500-exit
  8852        move dc-greg-date-1-edit to apvdto
  8853     end-if
  8854     evaluate ch-approval-status
  8855        when '2'
  8856           move 'PENDING '       TO APVSTATO
  8857        when 'P'
  8858           move 'PENDING '       TO APVSTATO
  8859        when 'A'
  8860           move 'APPROVED'       to apvstato
  8861        when 'D'
  8862           move 'DENIED'         to apvstato
  8863     end-evaluate
  8864     move ch-approved-by         to apvbyo
  8865*    IF PI-COMPANY-ID = 'TMS'
  8866*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8867*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8868*    ELSE
  8869         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8870         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8871
  8872     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8873     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8874     move ch-payee-city          to payctyo
  8875     move ch-payee-state         to paysto
  8876     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8877
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 161
* EL677.cbl
  8878     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8879         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8880         MOVE AL-UANON           TO  PTOZIPA.
  8881
  8882     MOVE CH-RETURN-TO           TO  RETTOO
  8883*    if ch-check-cashed-dt not = spaces and low-values
  8884*       move ch-check-cashed-dt  to dc-bin-date-1
  8885*       MOVE SPACE               TO  DC-OPTION-CODE
  8886*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8887*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8888*    end-if
  8889     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8890     MOVE SPACE                  TO  DC-OPTION-CODE.
  8891     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8892     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8893
  8894     MOVE CH-RECORDED-BY         TO  CBYO.
  8895
  8896     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8897         NEXT SENTENCE
  8898     ELSE
  8899         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8900         MOVE SPACE                  TO  DC-OPTION-CODE
  8901         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8902         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8903         MOVE CH-VOID-BY             TO  VBYO.
  8904
  8905     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8906         NEXT SENTENCE
  8907     ELSE
  8908         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8909         MOVE SPACE                  TO  DC-OPTION-CODE
  8910         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8911         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8912
  8913     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8914     MOVE AL-SANOF               TO  AMOUNTA.
  8915     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8916     MOVE AL-SANOF               TO  TYPEA.
  8917     MOVE CH-CHECK-NO            TO  CHECKO.
  8918     move ch-deduct-commission   to dedcyno
  8919     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8920     MOVE CH-VOID-REASON         TO  VREASONO.
  8921
  8922     MOVE CH-STUB-LINE-1         TO  STUBO.
  8923     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8924     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8925     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8926     IF CH-LF-REFUND NOT NUMERIC
  8927         MOVE ZEROS              TO CH-LF-REFUND.
  8928     IF CH-AH-REFUND NOT NUMERIC
  8929         MOVE ZEROS              TO CH-AH-REFUND.
  8930     if (ch-check-no not = spaces and low-values)
  8931        and (ch-check-written-dt not = low-values)
  8932        perform 5800-fetch-check-cashed-dt
  8933                                 thru 5800-exit
  8934     end-if
  8935     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 162
* EL677.cbl
  8936        CH-VOID-DT          GREATER LOW-VALUES
  8937        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8938                                     STUBA     TEXT1A   TEXT2A
  8939                                     TEXT3A    PAYTO1A  SFXA
  8940                                     PAYTO2A   PAYAD1A  PAYctyA
  8941                                     paysta    RETTOA   PAYAD2A
  8942                                     PTOZIPA
  8943                                     PRINTEDA
  8944     ELSE
  8945        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8946                                     ACCTA     EFFDTA   CERTNOA
  8947                                     CHECKA    REASONA  VREASONA
  8948                                     STUBA     TEXT1A   TEXT2A
  8949                                     TEXT3A    PAYTO1A  SFXA
  8950                                     PAYTO2A   PAYAD1A  PAYctyA
  8951                                     paysta    RETTOA   PAYAD2A
  8952                                     PRINTEDA.
  8953
  8954     MOVE AL-UNNON               TO SEQA.
  8955     perform 5600-get-erpndb     thru 5600-exit
  8956     perform 5700-get-elcert     thru 5700-exit
  8957*    move pi-prev-paid           to prepdo
  8958     move al-sadof               to drefa
  8959*    if WS-PNDB-FOUND
  8960*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8961*    end-if
  8962     if WS-CERT-FOUND
  8963        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8964           cm-lf-alt-premium-amt
  8965        compute ws-tot-iss-prem  =
  8966           cm-ah-premium-amt + ws-tot-lf-prem
  8967        compute ws-tot-iss-comm =
  8968           (ws-tot-lf-prem * cm-life-comm-pct) +
  8969           (cm-ah-premium-amt * cm-ah-comm-pct)
  8970        compute ws-tot-ref-comm =
  8971           (pi-lf-refund * cm-life-comm-pct) +
  8972           (pi-ah-refund * cm-ah-comm-pct)
  8973        move ws-tot-iss-prem     to premo
  8974        move ws-tot-iss-comm     to isscommo
  8975*       move ws-tot-ref-comm     to uecommo
  8976     end-if
  8977     if PI-TO-EL677-FROM-EL1273
  8978        move zeros               to premo
  8979                                    isscommo
  8980                                    uecommo
  8981                                    prepdo
  8982                                    refo
  8983     end-if
  8984     GO TO 8100-SEND-INITIAL-MAP
  8985     .
  8986 5550-NO-RECORD.
  8987     MOVE ER-1162                TO  EMI-ERROR.
  8988     MOVE -1                     TO  CARRIERL.
  8989     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8990                                     ACCTA     EFFDTA  CERTNOA
  8991                                     SFXA      SEQA.
  8992     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8993
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 163
* EL677.cbl
  8994     IF (NOT PI-TO-EL677-FROM-EL1273)
  8995        and (pi-return-to-program not = 'EL6315')
  8996         GO TO 8200-SEND-DATAONLY.
  8997
  8998     MOVE CHEK-CARRIER           TO  CARRIERO.
  8999     MOVE CHEK-GROUPING          TO  GROUPO.
  9000     MOVE CHEK-STATE             TO  STATEO.
  9001     MOVE CHEK-ACCOUNT           TO  ACCTO.
  9002
  9003     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  9004     MOVE SPACE                  TO  DC-OPTION-CODE.
  9005     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9006     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  9007
  9008     MOVE CHEK-CERT-NO           TO  CERTNOO.
  9009     MOVE CHEK-SUF-NO            TO  SFXO.
  9010     GO TO 8100-SEND-INITIAL-MAP.
  9011
  9012 5560-END-OF-FILE.
  9013     IF EIBAID = DFHPF1
  9014         MOVE 'Y'                TO  PI-EOF-SW
  9015         MOVE ER-2237            TO  EMI-ERROR
  9016     ELSE
  9017     IF EIBAID = DFHENTER
  9018        GO TO 5550-NO-RECORD
  9019     ELSE
  9020*        MOVE SPACES             TO  PI-ERCHEK-KEY
  9021         MOVE ER-2238            TO  EMI-ERROR.
  9022
  9023     MOVE -1                     TO  MAINTL.
  9024     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9025     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 164
* EL677.cbl
  9027 5600-get-erpndb.
  9028     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  9029     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  9030     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  9031     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  9032     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  9033     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  9034     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  9035     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  9036     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  9037     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  9038     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  9039     IF ST-ACCNT-CNTL  OR
  9040        ACCNT-CNTL
  9041          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9042     IF ST-ACCNT-CNTL      OR
  9043        CARR-ST-ACCNT-CNTL OR
  9044        ACCNT-CNTL         OR
  9045        CARR-ACCNT-CNTL
  9046          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9047     IF ACCNT-CNTL OR
  9048        CARR-ACCNT-CNTL
  9049          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9050
  9051* EXEC CICS READ
  9052*         DATASET   (ERPNDB-ALT-FILE-ID)
  9053*         SET       (ADDRESS OF PENDING-BUSINESS)
  9054*         RIDFLD    (ERPNDB-ALT-KEY)
  9055*         resp      (ws-response)
  9056*    END-EXEC
  9057*    MOVE '&"S        E          (  N#00008326' TO DFHEIV0
  9058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9060     MOVE X'204E233030303038333236' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0,
  9062           ERPNDB-ALT-FILE-ID,
  9063           DFHEIV20,
  9064           DFHEIV99,
  9065           ERPNDB-ALT-KEY,
  9066           DFHEIV99,
  9067           DFHEIV99,
  9068           DFHEIV99
  9069     SET ADDRESS OF PENDING-BUSINESS TO
  9070         DFHEIV20
  9071     MOVE EIBRESP  TO ws-response
  9072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9073     if resp-normal
  9074        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9075        compute pi-refund-on-pending-rec =
  9076           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9077     end-if
  9078     .
  9079 5600-exit.
  9080     exit.
  9081 5700-get-elcert.
  9082     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9083     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9084     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 165
* EL677.cbl
  9085     MOVE PI-STATE               TO  ELCERT-STATE.
  9086     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9087     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9088     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9089     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9090     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9091
  9092* EXEC CICS READ
  9093*         DATASET   (ELCERT-FILE-ID)
  9094*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9095*         RIDFLD    (ELCERT-KEY)
  9096*         resp      (ws-response)
  9097*    END-EXEC
  9098*    MOVE '&"S        E          (  N#00008350' TO DFHEIV0
  9099     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9101     MOVE X'204E233030303038333530' TO DFHEIV0(25:11)
  9102     CALL 'kxdfhei1' USING DFHEIV0,
  9103           ELCERT-FILE-ID,
  9104           DFHEIV20,
  9105           DFHEIV99,
  9106           ELCERT-KEY,
  9107           DFHEIV99,
  9108           DFHEIV99,
  9109           DFHEIV99
  9110     SET ADDRESS OF CERTIFICATE-MASTER TO
  9111         DFHEIV20
  9112     MOVE EIBRESP  TO ws-response
  9113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9114     if resp-normal
  9115        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9116     end-if
  9117     .
  9118 5700-exit.
  9119     exit.
  9120 5800-fetch-check-cashed-dt.
  9121     move ' '                    to ws-connect-sw
  9122                                    ws-match-sw
  9123                                    pi-check-cashed
  9124     move 'NTCSO2_PdBnkInfo'     to svr
  9125     move 'sa'                   to usr
  9126     move 'ntcso2'               to pass
  9127     string
  9128         usr delimited space
  9129         "." delimited size
  9130         pass delimited space into usr-pass
  9131     end-string
  9132     EXEC SQL
  9133        CONNECT TO :svr USER :usr-pass
  9134     END-EXEC
  9135     if sqlcode not = 0
  9136        display "Error: cannot connect to pdbnkinfo "
  9137        display sqlcode
  9138        display sqlerrmc
  9139        go to 5800-exit
  9140     end-if
  9141     set connected-to-db to true
  9142     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 166
* EL677.cbl
  9143        move 'CSO - AP%'         to ws-pb-compid
  9144     else
  9145        move 'AHL - AP%'         to ws-pb-compid
  9146     end-if
  9147     move '000'                  to ws-pb-check-no (1:3)
  9148     move ch-check-no            to ws-pb-check-no (4:7)
  9149     move spaces                 to ws-pb-bad-check-no
  9150     perform varying s1 from +1 by +1 until
  9151        (s1 > +10)
  9152        or (ws-pb-check-no (s1:1) not = '0')
  9153     end-perform
  9154     if s1 < +11
  9155        move ws-pb-check-no (s1:11 - s1)
  9156                            to ws-pb-bad-check-no (1: 11 - s1)
  9157     end-if
  9158*    display ' compid **' ws-pb-compid '**'
  9159*    display ' ckno  **' ws-pb-check-no '**'
  9160     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9161     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9162     MOVE SPACES              TO pb-paid-date
  9163
  9164     EXEC SQL
  9165        CALL pbi_GetCashDate_by_TransactionNbr
  9166           @compid          = :ws-pb-compid,
  9167           @checkno         = :ws-pb-check-no,
  9168           @badcheckno      = :ws-pb-bad-check-no,
  9169           @checkamount     = :ws-check-amount,
  9170           @checkcasheddate = :pb-paid-date OUT
  9171     END-EXEC
  9172     if sqlcode not = 0
  9173        display "Error: cannot run stor proc  "
  9174        move sqlcode            to ws-sql-code
  9175        move ws-sql-code to ws-dis-sql-code
  9176        display ' dis sql code ' ws-dis-sql-code
  9177        display ' sql return code ' sqlcode
  9178        display ' sql err mess    ' sqlerrmc
  9179        go to 5800-disconnect
  9180     end-if
  9181***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9182***                                                            ***
  9183***  The following code works just as well as the above        ***
  9184***  stored procedure and just as fast.                        ***
  9185***  Originally, I had declared a cursor and fetched through   ***
  9186***  the record set to find the correct check and that REALLY  ***
  9187***  slowed the response down to ~ 3/4 second.                 ***
  9188***                                                            ***
  9189***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9190*     EXEC SQL
  9191*        SELECT
  9192*           PaidDate
  9193*        INTO
  9194*           :pb-paid-date
  9195*        FROM
  9196*           dbo.cso_pbi_TransactionLookup
  9197*        WHERE
  9198*           (BankAcctDescr like :ws-pb-compid)
  9199*           and (Amount = :ws-check-amount)
  9200*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 167
* EL677.cbl
  9201*                  or
  9202*               (transactionnbr = :ws-pb-bad-check-no))
  9203**          and (CAST(TransactionNbr AS INT) =
  9204**             :ws-pb-check-no-num)
  9205**          and (right('00000' + rtrim(TransactionNbr),10)
  9206**             = :ws-pb-check-no)
  9207**          and (TransactionNbr  = :ws-pb-check-no)
  9208*     END-EXEC
  9209*    display ' chkno  ' pb-check-no
  9210*    display ' desc   ' pb-bank-acct-desc
  9211*    display ' trn typ' pb-tran-type
  9212*    display ' amt   *' pb-amount '**'
  9213*    display ' pd dte ' pb-paid-date
  9214     string pb-paid-date (7:4)
  9215            pb-paid-date (1:2)
  9216            pb-paid-date (4:2)
  9217        delimited by size into dc-greg-date-cymd-r
  9218     end-string
  9219     move 'L'                    to dc-option-code
  9220     perform 8500-date-convert   thru 8500-exit
  9221     if no-conversion-error
  9222*       move dc-bin-date-1       to ws-bin-cashed-dt
  9223        move dc-greg-date-1-edit to cashedo
  9224        move 'Y' to pi-check-cashed
  9225     else
  9226        display ' error cvtdte cash dt ' pb-paid-date ' '
  9227           dc-error-code
  9228     end-if
  9229     .
  9230 5800-disconnect.
  9231     EXEC SQL
  9232        DISCONNECT ALL
  9233     END-EXEC
  9234     if sqlcode not = 0
  9235        display "Error: cannot disconnect pdbnk "
  9236        display ' sql return code ' sqlcode
  9237        display ' sql err mess    ' sqlerrmc
  9238     end-if
  9239     .
  9240 5800-exit.
  9241     exit.
  9242 6000-VERIFY-COMP-MASTER.
  9243
  9244* EXEC CICS HANDLE CONDITION
  9245*        NOTFND   (6070-NO-COMP-MSTR)
  9246*    END-EXEC.
  9247*    MOVE '"$I                   ! / #00008485' TO DFHEIV0
  9248     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9249     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9250     MOVE X'2F20233030303038343835' TO DFHEIV0(25:11)
  9251     CALL 'kxdfhei1' USING DFHEIV0
  9252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9253
  9254
  9255     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9256
  9257     IF NOT PI-ZERO-CARRIER AND
  9258        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 168
* EL677.cbl
  9259         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9260     ELSE
  9261         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9262
  9263     IF NOT PI-ZERO-GROUPING  AND
  9264        NOT PI-ZERO-CAR-GROUP
  9265         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9266     ELSE
  9267         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9268
  9269     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9270     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9271     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9272
  9273
  9274* EXEC CICS READ
  9275*         DATASET   (ERCOMP-FILE-ID)
  9276*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9277*         RIDFLD    (ERCOMP-KEY)
  9278*     END-EXEC.
  9279*    MOVE '&"S        E          (   #00008507' TO DFHEIV0
  9280     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9282     MOVE X'2020233030303038353037' TO DFHEIV0(25:11)
  9283     CALL 'kxdfhei1' USING DFHEIV0,
  9284           ERCOMP-FILE-ID,
  9285           DFHEIV20,
  9286           DFHEIV99,
  9287           ERCOMP-KEY,
  9288           DFHEIV99,
  9289           DFHEIV99,
  9290           DFHEIV99
  9291     SET ADDRESS OF COMPENSATION-MASTER TO
  9292         DFHEIV20
  9293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9294
  9295
  9296     GO TO 6090-EXIT.
  9297
  9298 6070-NO-COMP-MSTR.
  9299     MOVE -1                     TO  CARRIERL.
  9300     MOVE ER-2230                TO  EMI-ERROR.
  9301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9302     GO TO 8200-SEND-DATAONLY.
  9303
  9304 6090-EXIT.
  9305      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 169
* EL677.cbl
  9307 6100-VERIFY-CERTIFICATE.
  9308
  9309* EXEC CICS HANDLE CONDITION
  9310*        NOTFND   (6170-NO-CERTIFICATE)
  9311*    END-EXEC.
  9312*    MOVE '"$I                   ! 0 #00008525' TO DFHEIV0
  9313     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9315     MOVE X'3020233030303038353235' TO DFHEIV0(25:11)
  9316     CALL 'kxdfhei1' USING DFHEIV0
  9317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9318
  9319
  9320     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9321     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9322     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9323     MOVE PI-STATE               TO  ELCERT-STATE.
  9324     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9325     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9326     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9327     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9328
  9329     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9330
  9331     MOVE SPACES                 TO  PI-REFERENCE
  9332*                                    PI-INSURED-NAME.
  9333     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9334     MOVE ZEROS                  TO  PI-LF-REFUND
  9335                                     PI-AH-REFUND.
  9336
  9337
  9338* EXEC CICS READ
  9339*         DATASET   (ELCERT-FILE-ID)
  9340*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9341*         RIDFLD    (ELCERT-KEY)
  9342*     END-EXEC.
  9343*    MOVE '&"S        E          (   #00008546' TO DFHEIV0
  9344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9346     MOVE X'2020233030303038353436' TO DFHEIV0(25:11)
  9347     CALL 'kxdfhei1' USING DFHEIV0,
  9348           ELCERT-FILE-ID,
  9349           DFHEIV20,
  9350           DFHEIV99,
  9351           ELCERT-KEY,
  9352           DFHEIV99,
  9353           DFHEIV99,
  9354           DFHEIV99
  9355     SET ADDRESS OF CERTIFICATE-MASTER TO
  9356         DFHEIV20
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9358
  9359
  9360     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9361
  9362     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9363     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9364     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 170
* EL677.cbl
  9365         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9366     ELSE
  9367         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9368             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9369*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9370
  9371     GO TO 6190-EXIT.
  9372
  9373 6170-NO-CERTIFICATE.
  9374     MOVE -1                     TO  CARRIERL.
  9375     MOVE ER-2726                TO  EMI-ERROR.
  9376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9377
  9378 6190-EXIT.
  9379      EXIT.
  9380
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 171
* EL677.cbl
  9382 6200-UPDATE-PENDING-BUS-REC.
  9383     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9384     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9385     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9386     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9387     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9388     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9389     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9390     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9391     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9392     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9393
  9394     IF ST-ACCNT-CNTL  OR
  9395        ACCNT-CNTL
  9396          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9397
  9398     IF ST-ACCNT-CNTL      OR
  9399        CARR-ST-ACCNT-CNTL OR
  9400        ACCNT-CNTL         OR
  9401        CARR-ACCNT-CNTL
  9402          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9403
  9404     IF ACCNT-CNTL OR
  9405        CARR-ACCNT-CNTL
  9406          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9407
  9408
  9409* EXEC CICS READ
  9410*         DATASET   (ERPNDB-ALT-FILE-ID)
  9411*         SET       (ADDRESS OF PENDING-BUSINESS)
  9412*         RIDFLD    (ERPNDB-ALT-KEY)
  9413*         resp      (ws-response)
  9414*     END-EXEC.
  9415*    MOVE '&"S        E          (  N#00008600' TO DFHEIV0
  9416     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9417     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9418     MOVE X'204E233030303038363030' TO DFHEIV0(25:11)
  9419     CALL 'kxdfhei1' USING DFHEIV0,
  9420           ERPNDB-ALT-FILE-ID,
  9421           DFHEIV20,
  9422           DFHEIV99,
  9423           ERPNDB-ALT-KEY,
  9424           DFHEIV99,
  9425           DFHEIV99,
  9426           DFHEIV99
  9427     SET ADDRESS OF PENDING-BUSINESS TO
  9428         DFHEIV20
  9429     MOVE EIBRESP  TO ws-response
  9430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9431
  9432
  9433     if not resp-normal
  9434        go to 6200-exit
  9435     end-if
  9436     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9437
  9438
  9439* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 172
* EL677.cbl
  9440*         DATASET   (ERPNDB-FILE-ID)
  9441*         SET       (ADDRESS OF PENDING-BUSINESS)
  9442*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9443*         UPDATE
  9444*         resp      (ws-response)
  9445*     END-EXEC.
  9446*    MOVE '&"S        EU         (  N#00008612' TO DFHEIV0
  9447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9448     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9449     MOVE X'204E233030303038363132' TO DFHEIV0(25:11)
  9450     CALL 'kxdfhei1' USING DFHEIV0,
  9451           ERPNDB-FILE-ID,
  9452           DFHEIV20,
  9453           DFHEIV99,
  9454           ERPNDB-PRIMARY-KEY,
  9455           DFHEIV99,
  9456           DFHEIV99,
  9457           DFHEIV99
  9458     SET ADDRESS OF PENDING-BUSINESS TO
  9459         DFHEIV20
  9460     MOVE EIBRESP  TO ws-response
  9461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9462
  9463
  9464 6200-EXIT.
  9465      EXIT.
  9466 6210-rewrite-pndb.
  9467
  9468* EXEC CICS REWRITE
  9469*        DATASET  (ERPNDB-FILE-ID)
  9470*        FROM     (PENDING-BUSINESS)
  9471*    END-EXEC
  9472     MOVE LENGTH OF
  9473      PENDING-BUSINESS
  9474       TO DFHEIV11
  9475*    MOVE '&& L                  %   #00008623' TO DFHEIV0
  9476     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9477     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9478     MOVE X'2020233030303038363233' TO DFHEIV0(25:11)
  9479     CALL 'kxdfhei1' USING DFHEIV0,
  9480           ERPNDB-FILE-ID,
  9481           PENDING-BUSINESS,
  9482           DFHEIV11,
  9483           DFHEIV99
  9484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9485     .
  9486 6210-exit.
  9487     exit.
  9488 6300-BUILD-CERT-SCREEN.
  9489     perform 6700-build-common   thru 6700-exit
  9490     if ws-refund-amount = zeros
  9491        move pi-company-cd       to pi-chek-comp-cd
  9492        move pi-carrier          to pi-chek-carrier
  9493        move pi-grouping         to pi-chek-grouping
  9494        move pi-state            to pi-chek-state
  9495        move pi-account          to pi-chek-account
  9496        move pi-cert-eff-dt      to pi-chek-eff-dt
  9497        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 173
* EL677.cbl
  9498        move pi-cert-sfx         to pi-chek-suf-no
  9499        move +1                  to pi-chek-sequence
  9500             MOVE 'S'            TO MAINTI
  9501             MOVE 1              TO MAINTL
  9502             MOVE AL-UABON       TO MAINTA
  9503             MOVE DFHENTER       TO EIBAID
  9504        go to 5000-browse-file
  9505     end-if
  9506     IF WS-CERT-NOT-FOUND
  9507         GO TO 8100-SEND-INITIAL-MAP.
  9508
  9509*    IF WS-PNDB-FOUND
  9510*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9511*                                   PB-C-AH-CANCEL-AMT
  9512*        MOVE 'R'                TO  TYPEO
  9513*        IF PI-AR-PROCESSING
  9514*            MOVE AL-UANON       TO  REFA
  9515*            MOVE PB-C-REFERENCE TO  REFO
  9516*        END-IF
  9517*    ELSE
  9518*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9519*                                   CM-AH-ITD-CANCEL-AMT.
  9520     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9521     MOVE pi-check-type           TO TYPEO
  9522
  9523     IF PI-COMPANY-ID = 'TMS'
  9524         MOVE WS-NAME-WORK         TO PAYTO1I
  9525                                      PI-PAYTO1
  9526         MOVE AL-UANON             TO PAYTO1A
  9527     ELSE
  9528         MOVE WS-NAME-WORK         TO PAYTO1I
  9529                                      PI-PAYTO1
  9530         MOVE AL-UANON             TO PAYTO1A.
  9531
  9532*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9533*    MOVE AL-UANON                 TO PAYTO1AA.
  9534     move 'N'                    to dedcyni
  9535     move al-uanon               to dedcyna
  9536     move 'INS'                  to payeeo
  9537     move al-panon               to payeea
  9538     IF PI-MAIL-YES
  9539         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9540
  9541     GO TO 8100-SEND-INITIAL-MAP.
  9542
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 174
* EL677.cbl
  9544
  9545 6400-MAILING-ADDRESS.
  9546
  9547* EXEC CICS HANDLE CONDITION
  9548*        NOTFND   (6470-NO-ADDRESS)
  9549*    END-EXEC.
  9550*    MOVE '"$I                   ! 1 #00008688' TO DFHEIV0
  9551     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9553     MOVE X'3120233030303038363838' TO DFHEIV0(25:11)
  9554     CALL 'kxdfhei1' USING DFHEIV0
  9555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9556
  9557
  9558
  9559* EXEC CICS READ
  9560*        DATASET   (ERMAIL-FILE-ID)
  9561*        SET       (ADDRESS OF MAILING-DATA)
  9562*        RIDFLD    (ELCERT-KEY)
  9563*    END-EXEC.
  9564*    MOVE '&"S        E          (   #00008692' TO DFHEIV0
  9565     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9567     MOVE X'2020233030303038363932' TO DFHEIV0(25:11)
  9568     CALL 'kxdfhei1' USING DFHEIV0,
  9569           ERMAIL-FILE-ID,
  9570           DFHEIV20,
  9571           DFHEIV99,
  9572           ELCERT-KEY,
  9573           DFHEIV99,
  9574           DFHEIV99,
  9575           DFHEIV99
  9576     SET ADDRESS OF MAILING-DATA TO
  9577         DFHEIV20
  9578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9579
  9580
  9581     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9582     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9583     move ma-city                to payctyi
  9584     move ma-addr-state          to paysti
  9585     MOVE MA-ZIP                 TO PTOZIPI.
  9586     MOVE AL-UANON               TO PAYAD1A
  9587                                    PAYAD2A
  9588                                    PAYctyA
  9589                                    paysta
  9590                                    PTOZIPA.
  9591
  9592     GO TO 6490-EXIT.
  9593
  9594 6470-NO-ADDRESS.
  9595     MOVE -1                     TO  PAYAD1L.
  9596     MOVE ER-2394                TO  EMI-ERROR.
  9597     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9598
  9599 6490-EXIT.
  9600      EXIT.
  9601
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 175
* EL677.cbl
  9603
  9604 6500-BUILD-ACCOUNT-SCREEN.
  9605     perform 6700-build-common   thru 6700-exit
  9606     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9607     MOVE PI-AM-NAME             TO PAYTO1I
  9608     MOVE SPACES                 TO PAYTO2I
  9609     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9610     MOVE PI-AM-CITY             TO PAYCTYI
  9611     move pi-am-st               to paysti
  9612     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9613     move 'ACCT'                 to payeeo
  9614     move al-panon               to payeea
  9615     MOVE AL-UANON               TO PAYTO1A
  9616                                    PAYTO2A
  9617                                    PAYAD1A
  9618                                    PAYCTYA
  9619                                    paysta
  9620                                    PTOZIPA.
  9621     GO TO 8100-SEND-INITIAL-MAP
  9622     .
  9623 6600-BUILD-BENEFICIARY-SCREEN.
  9624     perform 6700-build-common   thru 6700-exit
  9625     IF WS-CERT-NOT-FOUND
  9626         GO TO 8100-SEND-INITIAL-MAP.
  9627
  9628*    IF WS-PNDB-FOUND
  9629*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9630*                                   PB-C-AH-CANCEL-AMT
  9631*        MOVE 'R'                TO  TYPEO
  9632*        IF PI-AR-PROCESSING
  9633*            MOVE AL-UANON       TO  REFA
  9634*            MOVE PB-C-REFERENCE TO  REFO
  9635*        END-IF
  9636*    ELSE
  9637*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9638*                                   CM-AH-ITD-CANCEL-AMT.
  9639
  9640     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9641     MOVE pi-check-type           TO  TYPEO.
  9642
  9643     IF PI-COMPANY-ID = 'TMS'
  9644         MOVE WS-NAME-WORK         TO PAYTO1I
  9645                                      PI-PAYTO1
  9646         MOVE AL-UANON             TO PAYTO1A
  9647     ELSE
  9648         MOVE WS-NAME-WORK         TO PAYTO1I
  9649                                      PI-PAYTO1
  9650         MOVE AL-UANON             TO PAYTO1A.
  9651
  9652*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9653*    MOVE AL-UANON                 TO PAYTO1AA.
  9654
  9655     move 'N'                    to dedcyni
  9656     move al-uanon               to dedcyna
  9657     move 'BENE'                 to payeeo
  9658     move al-panon               to payeea
  9659     IF PI-MAIL-YES
  9660         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 176
* EL677.cbl
  9661
  9662     GO TO 8100-SEND-INITIAL-MAP.
  9663
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 177
* EL677.cbl
  9665
  9666 6620-MAILING-ADDRESS.
  9667
  9668* EXEC CICS HANDLE CONDITION
  9669*        NOTFND   (6670-NO-beneficiary)
  9670*    END-EXEC.
  9671*    MOVE '"$I                   ! 2 #00008784' TO DFHEIV0
  9672     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9674     MOVE X'3220233030303038373834' TO DFHEIV0(25:11)
  9675     CALL 'kxdfhei1' USING DFHEIV0
  9676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9677
  9678
  9679
  9680* EXEC CICS READ
  9681*        DATASET   (ERMAIL-FILE-ID)
  9682*        SET       (ADDRESS OF MAILING-DATA)
  9683*        RIDFLD    (ELCERT-KEY)
  9684*    END-EXEC.
  9685*    MOVE '&"S        E          (   #00008788' TO DFHEIV0
  9686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9688     MOVE X'2020233030303038373838' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           ERMAIL-FILE-ID,
  9691           DFHEIV20,
  9692           DFHEIV99,
  9693           ELCERT-KEY,
  9694           DFHEIV99,
  9695           DFHEIV99,
  9696           DFHEIV99
  9697     SET ADDRESS OF MAILING-DATA TO
  9698         DFHEIV20
  9699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9700
  9701
  9702     move spaces                 to payto2i
  9703     move ma-cred-bene-name      to payto1i
  9704     MOVE MA-cred-bene-addr      TO PAYad1I.
  9705     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9706     move ma-cred-bene-city      to payctyi
  9707     move ma-cred-bene-state     to paysti
  9708     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9709     MOVE AL-UANON               TO payto1a
  9710                                    PAYTO2A
  9711                                    PAYad1A
  9712                                    payad2a
  9713                                    PAYctyA
  9714                                    paysta
  9715                                    PTOZIPA.
  9716
  9717     GO TO 6690-EXIT.
  9718
  9719 6670-NO-BENEFICIARY.
  9720     MOVE -1                     TO  PAYTO1L.
  9721     MOVE ER-2394                TO  EMI-ERROR.
  9722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 178
* EL677.cbl
  9723
  9724 6690-EXIT.
  9725      EXIT.
  9726 6700-build-common.
  9727     if not eracct-found
  9728        move pi-company-cd       to eracct-co
  9729        move pi-carrier          to eracct-carrier
  9730        move pi-grouping         to eracct-grouping
  9731        move pi-state            to eracct-state
  9732        move pi-account          to eracct-account
  9733        move pi-cert-eff-dt      to eracct-exp-date
  9734        perform 1420-get-eracct  thru 1490-exit
  9735     end-if
  9736*    if WS-PNDB-NOT-FOUND
  9737*       perform 5600-get-erpndb thru 5600-exit
  9738*    end-if
  9739     MOVE LOW-VALUES             TO  EL677AI.
  9740     MOVE 'A'                    TO  MAINTI.
  9741     MOVE AL-UANON               TO  MAINTA.
  9742     MOVE +1                     TO  MAINTL.
  9743     MOVE PI-CARRIER             TO  CARRIERO.
  9744     MOVE PI-GROUPING            TO  GROUPO.
  9745     MOVE PI-STATE               TO  STATEO.
  9746     MOVE PI-ACCOUNT             TO  ACCTO.
  9747     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9748     MOVE PI-CERT-SFX            TO  SFXO.
  9749     MOVE PI-AMOUNT              TO  AMOUNTO.
  9750*    MOVE PI-TYPE                TO  TYPEO.
  9751     move pi-check-type          to  typeo
  9752     move pi-return-to           to  rettoo
  9753*    MOVE PI-REFERENCE           TO  REFO.
  9754     MOVE PI-PAYTO1              TO  PAYTO1O.
  9755     MOVE AL-UANON               TO  CARRIERA
  9756                                     GROUPA
  9757                                     STATEA
  9758                                     ACCTA
  9759                                     CERTNOA
  9760                                     SFXA
  9761                                     PAYTO1A
  9762                                     PAYTO2A
  9763*                                    AMOUNTA
  9764*                                    TYPEA
  9765                                     rettoa.
  9766     move al-panon               to typea
  9767     move al-panon               to amounta
  9768     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9769     MOVE ' '                    TO  DC-OPTION-CODE.
  9770     PERFORM 8500-DATE-CONVERT.
  9771     IF NO-CONVERSION-ERROR
  9772         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9773         MOVE AL-UANON            TO  EFFDTA
  9774         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9775         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9776     ELSE
  9777         GO TO 8200-SEND-DATAONLY.
  9778     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9779         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9780         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 179
* EL677.cbl
  9781     ELSE
  9782         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9783         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9784     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9785     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9786     move spaces to pi-insured-name
  9787     string cm-insured-last-name ' '
  9788            cm-insured-first-name delimited by '  '
  9789        into pi-insured-name
  9790     end-string
  9791     move spaces                 to pi-table-name
  9792     string cm-insured-last-name ', '
  9793            cm-insured-first-name ' '
  9794            cm-insured-initial2
  9795        delimited by '  '
  9796        into
  9797           pi-table-name
  9798     end-string
  9799*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9800     if eibaid = dfhpf5
  9801        move 'Y'                 to dedcyni
  9802        move al-uanon            to dedcyna
  9803     end-if
  9804    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9805       cm-lf-alt-premium-amt
  9806    compute ws-tot-iss-prem  =
  9807       cm-ah-premium-amt + ws-tot-lf-prem
  9808    compute ws-tot-iss-comm =
  9809       (ws-tot-lf-prem * cm-life-comm-pct) +
  9810       (cm-ah-premium-amt * cm-ah-comm-pct)
  9811    compute ws-tot-ref-comm =
  9812       (pi-lf-refund * cm-life-comm-pct) +
  9813       (pi-ah-refund * cm-ah-comm-pct)
  9814     move ws-tot-iss-prem        to premo
  9815     move ws-tot-iss-comm        to isscommo
  9816     move al-sadof               to drefa
  9817                                    refa
  9818*    compute refo = pi-lf-refund + pi-ah-refund
  9819     move pi-prev-paid            to prepdo
  9820     move ws-tot-ref-comm         to uecommo
  9821                                     pi-ue-comm
  9822***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9823***     pi-prev-paid
  9824     compute ws-refund-amount =
  9825        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9826     if (ws-refund-amount + pi-prev-paid) > ws-tot-iss-prem
  9827        compute ws-refund-amount = pi-refund-on-pending-rec -
  9828           pi-prev-paid
  9829     end-if
  9830
  9831     if ws-refund-amount < zeros
  9832        move zeros               to ws-refund-amount
  9833     end-if
  9834     if (dedcyni = 'Y')
  9835        or (pi-prev-ded-comm = 'Y')
  9836        compute ws-refund-amount = ws-refund-amount -
  9837           ws-tot-ref-comm
  9838     end-if
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 180
* EL677.cbl
  9839     if pi-check-type = 'C'
  9840*       move pi-endt-prm-diff    to refo
  9841        move pi-endt-com-diff    to uecommo
  9842                                    pi-ue-comm
  9843        compute ws-refund-amount =
  9844           pi-endt-prm-diff - pi-prev-paid
  9845        if (dedcyni = 'Y')
  9846           or (pi-prev-ded-comm = 'Y')
  9847           compute ws-refund-amount = ws-refund-amount -
  9848              pi-endt-com-diff
  9849        end-if
  9850        if ws-refund-amount <= zeros
  9851           move pi-endt-prm-diff to ws-refund-amount
  9852        end-if
  9853     end-if
  9854     if not WS-CERT-NOT-FOUND
  9855        string
  9856           pi-cert-prime         ' : '
  9857           cm-insured-last-name  ', '
  9858           cm-insured-first-name ' : '
  9859           pi-account            ' : '
  9860           pi-am-csr delimited by '  ' into text1o
  9861        end-string
  9862        move al-uanon            to text1a
  9863        MOVE 'REF'               TO WS-USER-REASON
  9864        if pi-check-type = 'C'
  9865           move 'COR'            to ws-user-reason
  9866        end-if
  9867        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9868        inspect ws-user-cert-no replacing leading zeros
  9869           by spaces
  9870        move pi-insured-name     to ws-user-name
  9871        perform varying s1 from +1 by +1 until
  9872           (s1 > +11)
  9873           or (ws-user-cert-no (s1:1)) <> ' '
  9874        end-perform
  9875        string ws-user-reason  ' ' delimited by size
  9876               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9877                  delimited by size
  9878               cm-insured-last-name ' '
  9879               cm-insured-first-name delimited by '  '
  9880           into stubo
  9881        end-string
  9882        move al-uanon            to stuba
  9883     end-if
  9884     .
  9885 6700-exit.
  9886     exit.
  9887 6800-browse-previous-chek-recs.
  9888***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9889***                                                            ***
  9890**** this should be the first time through, we need to gather  ***
  9891**** all the erchek records for this pending record, add the   ***
  9892**** amounts and make sure this check request will not exceed  ***
  9893**** the collected premium                                     ***
  9894***                                                            ***
  9895***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9896     move zeros                  to pi-prev-paid
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 181
* EL677.cbl
  9897                                    pi-prev-paid-this-month
  9898                                    ws-browse-sw
  9899                                    pi-chek-rec-cnt
  9900     move spaces                 to pi-prev-ded-comm
  9901     move pi-company-cd          to chek-company-cd
  9902     move pi-carrier             to chek-carrier
  9903     move pi-grouping            to chek-grouping
  9904     move pi-state               to chek-state
  9905     move pi-account             to chek-account
  9906     move pi-cert-prime          to chek-cert-no
  9907     move pi-cert-sfx            to chek-suf-no
  9908     move pi-cert-eff-dt         to chek-eff-dt
  9909     move +0                     to chek-record-seq
  9910     move erchek-key             to ws-compare-erchek-key
  9911
  9912* EXEC CICS STARTBR
  9913*       DATASET  (ERCHEK-FILE-ID)
  9914*       RIDFLD   (ERCHEK-KEY)
  9915*       resp     (ws-response)
  9916*    END-EXEC
  9917     MOVE 0
  9918       TO DFHEIV11
  9919*    MOVE '&,         G          &  N#00009003' TO DFHEIV0
  9920     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9921     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9922     MOVE X'204E233030303039303033' TO DFHEIV0(25:11)
  9923     CALL 'kxdfhei1' USING DFHEIV0,
  9924           ERCHEK-FILE-ID,
  9925           ERCHEK-KEY,
  9926           DFHEIV99,
  9927           DFHEIV11,
  9928           DFHEIV99
  9929     MOVE EIBRESP  TO ws-response
  9930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9931     if not resp-normal
  9932        go to 6800-exit
  9933     end-if
  9934     perform until i-say-when
  9935
  9936* EXEC CICS READNEXT
  9937*          DATASET   (ERCHEK-FILE-ID)
  9938*          SET       (ADDRESS OF CHECK-RECORDS)
  9939*          RIDFLD    (ERCHEK-KEY)
  9940*          resp      (ws-response)
  9941*       END-EXEC
  9942     MOVE 0
  9943       TO DFHEIV11
  9944*    MOVE '&.S                   )  N#00009012' TO DFHEIV0
  9945     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9946     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9947     MOVE X'204E233030303039303132' TO DFHEIV0(25:11)
  9948     CALL 'kxdfhei1' USING DFHEIV0,
  9949           ERCHEK-FILE-ID,
  9950           DFHEIV20,
  9951           DFHEIV99,
  9952           ERCHEK-KEY,
  9953           DFHEIV99,
  9954           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 182
* EL677.cbl
  9955           DFHEIV99,
  9956           DFHEIV99
  9957     SET ADDRESS OF CHECK-RECORDS TO
  9958         DFHEIV20
  9959     MOVE EIBRESP  TO ws-response
  9960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9961        if resp-normal
  9962           and erchek-key (1:33) = ws-compare-erchek-key
  9963           if (ch-void-dt = low-values)
  9964              and (not ch-denied)
  9965              evaluate true
  9966                 when (pi-check-type = 'R')
  9967                    and (ch-check-origin-sw <> 'C')
  9968                    compute pi-prev-paid =
  9969                       pi-prev-paid + ch-amount-paid
  9970                    add +1 to pi-chek-rec-cnt
  9971                    move ch-deduct-commission
  9972                                 to pi-prev-ded-comm
  9973                    if ch-credit-select-dt = pi-cr-month-end-dt
  9974                       compute pi-prev-paid-this-month =
  9975                          pi-prev-paid-this-month + ch-amount-paid
  9976                    end-if
  9977              end-evaluate
  9978           end-if
  9979        else
  9980           set i-say-when to true
  9981        end-if
  9982     end-perform
  9983*     perform until i-say-when
  9984*        EXEC CICS READNEXT
  9985*           DATASET   (ERCHEK-FILE-ID)
  9986*           SET       (ADDRESS OF CHECK-RECORDS)
  9987*           RIDFLD    (ERCHEK-KEY)
  9988*           resp      (ws-response)
  9989*        END-EXEC
  9990*        if resp-normal
  9991*           and erchek-key (1:33) = ws-compare-erchek-key
  9992*           if (ch-void-dt = low-values)
  9993*              and (not ch-denied)
  9994*              if (pi-check-type = 'R')
  9995*                 and (ch-check-origin-sw = 'C')
  9996*                 continue
  9997*              else
  9998*                 compute pi-prev-paid = pi-prev-paid +
  9999*                    ch-amount-paid
 10000*                 add +1 to pi-chek-rec-cnt
 10001*                 move ch-deduct-commission
 10002*                                 to pi-prev-ded-comm
 10003*              end-if
 10004*           end-if
 10005*        else
 10006*           set i-say-when to true
 10007*        end-if
 10008*     end-perform
 10009     .
 10010 6800-exit.
 10011     exit.
 10012 7000-SET-PI-AREA.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 183
* EL677.cbl
 10013     MOVE CARRIERI               TO  PI-CARRIER
 10014                                     PI-CHEK-CARRIER.
 10015     MOVE GROUPI                 TO  PI-GROUPING
 10016                                     PI-CHEK-GROUPING.
 10017     MOVE STATEI                 TO  PI-STATE
 10018                                     PI-CHEK-STATE.
 10019     MOVE ACCTI                  TO  PI-ACCOUNT
 10020                                     PI-CHEK-ACCOUNT.
 10021     MOVE CERTNOI                TO  PI-CERT-PRIME
 10022                                     PI-CHEK-CERT-NO.
 10023     IF SFXI NOT = LOW-VALUES
 10024         MOVE SFXI               TO  PI-CERT-SFX
 10025                                     PI-CHEK-SUF-NO
 10026     ELSE
 10027         MOVE SPACE              TO  PI-CERT-SFX
 10028                                     PI-CHEK-SUF-NO.
 10029
 10030     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
 10031     MOVE '2'                    TO  DC-OPTION-CODE.
 10032     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10033     IF DATE-CONVERSION-ERROR
 10034         MOVE ER-0215            TO  EMI-ERROR
 10035         MOVE -1                 TO  EFFDTL
 10036         MOVE AL-UNBON           TO  EFFDTA
 10037         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10038         GO TO 8200-SEND-DATAONLY
 10039     ELSE
 10040         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
 10041                                     PI-CHEK-EFF-DT.
 10042
 10043 7090-EXIT.
 10044      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 184
* EL677.cbl
 10046 7100-CREATE-TEMP-STORAGE.
 10047     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10048
 10049
 10050* EXEC CICS WRITEQ TS
 10051*        QUEUE   (QID)
 10052*        FROM    (PROGRAM-INTERFACE-BLOCK)
 10053*        LENGTH  (PI-COMM-LENGTH)
 10054*    END-EXEC.
 10055*    MOVE '*"                    ''   #00009106' TO DFHEIV0
 10056     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 10057     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10058     MOVE X'2020233030303039313036' TO DFHEIV0(25:11)
 10059     CALL 'kxdfhei1' USING DFHEIV0,
 10060           QID,
 10061           PROGRAM-INTERFACE-BLOCK,
 10062           PI-COMM-LENGTH,
 10063           DFHEIV99,
 10064           DFHEIV99,
 10065           DFHEIV99
 10066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10067
 10068
 10069 7100-EXIT.
 10070      EXIT.
 10071
 10072 7200-RECOVER-TEMP-STORAGE.
 10073
 10074* EXEC CICS READQ TS
 10075*        QUEUE   (QID)
 10076*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10077*        LENGTH  (PI-COMM-LENGTH)
 10078*    END-EXEC.
 10079*    MOVE '*$I    L              ''   #00009116' TO DFHEIV0
 10080     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10081     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10082     MOVE X'2020233030303039313136' TO DFHEIV0(25:11)
 10083     CALL 'kxdfhei1' USING DFHEIV0,
 10084           QID,
 10085           PROGRAM-INTERFACE-BLOCK,
 10086           PI-COMM-LENGTH,
 10087           DFHEIV99,
 10088           DFHEIV99,
 10089           DFHEIV99
 10090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10091
 10092
 10093     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10094
 10095 7200-EXIT.
 10096      EXIT.
 10097
 10098 7300-DELETE-TEMP-STORAGE.
 10099
 10100* EXEC CICS HANDLE CONDITION
 10101*        QIDERR  (7300-EXIT)
 10102*    END-EXEC.
 10103*    MOVE '"$N                   ! 3 #00009128' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 185
* EL677.cbl
 10104     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10106     MOVE X'3320233030303039313238' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10109
 10110
 10111
 10112* EXEC CICS DELETEQ TS
 10113*        QUEUE  (QID)
 10114*    END-EXEC.
 10115*    MOVE '*&                    #   #00009132' TO DFHEIV0
 10116     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10117     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10118     MOVE X'2020233030303039313332' TO DFHEIV0(25:11)
 10119     CALL 'kxdfhei1' USING DFHEIV0,
 10120           QID,
 10121           DFHEIV99
 10122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10123
 10124
 10125 7300-EXIT.
 10126      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 186
* EL677.cbl
 10128 8035-LETR-NOT-OPEN.
 10129
 10130     MOVE ER-0013                TO EMI-ERROR.
 10131*    MOVE -1                     TO LETTER1L
 10132     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10133     GO TO 8200-SEND-DATAONLY.
 10134
 10135 8035-EXIT.
 10136     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 187
* EL677.cbl
 10138 8100-SEND-INITIAL-MAP.
 10139     MOVE SAVE-DATE              TO  DATEO.
 10140     MOVE EIBTIME                TO  TIME-IN.
 10141     MOVE TIME-OUT               TO  TIMEO.
 10142     MOVE -1                     TO  MAINTL
 10143     move al-uanon               to mainta
 10144     if PI-TO-EL677-FROM-EL1273
 10145        move al-sadof            to pf357a
 10146                                    pf46a
 10147                                    dprema
 10148                                    dcomma
 10149                                    drefa
 10150                                    duecomma
 10151                                    dprepda
 10152                                    prema
 10153                                    isscomma
 10154                                    refa
 10155                                    uecomma
 10156                                    prepda
 10157                                    dmaint2a
 10158        move ', VOID(V)'         to dmaint1o
 10159     end-if
 10160     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10161     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10162
 10163
 10164* EXEC CICS SEND
 10165*        MAP      (EL677A)
 10166*        MAPSET   (MAPSET-NAME)
 10167*        FROM     (EL677AO)
 10168*        ERASE
 10169*        CURSOR
 10170*    END-EXEC.
 10171     MOVE LENGTH OF
 10172      EL677AO
 10173       TO DFHEIV12
 10174     MOVE -1
 10175       TO DFHEIV11
 10176*    MOVE '8$     CT  E    H L F ,   #00009174' TO DFHEIV0
 10177     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10178     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10179     MOVE X'2020233030303039313734' TO DFHEIV0(25:11)
 10180     CALL 'kxdfhei1' USING DFHEIV0,
 10181           EL677A,
 10182           EL677AO,
 10183           DFHEIV12,
 10184           MAPSET-NAME,
 10185           DFHEIV99,
 10186           DFHEIV99,
 10187           DFHEIV99,
 10188           DFHEIV11,
 10189           DFHEIV99,
 10190           DFHEIV99,
 10191           DFHEIV99
 10192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10193
 10194
 10195     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 188
* EL677.cbl
 10197 8200-SEND-DATAONLY.
 10198     if connected-to-db
 10199        perform 4300-FINISH-UP-DB thru 4300-exit
 10200     end-if
 10201     MOVE SAVE-DATE              TO  DATEO.
 10202     MOVE EIBTIME                TO  TIME-IN.
 10203     MOVE TIME-OUT               TO  TIMEO.
 10204     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10205     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10206
 10207
 10208* EXEC CICS SEND
 10209*        MAP     (EL677A)
 10210*        MAPSET  (MAPSET-NAME)
 10211*        FROM    (EL677AO)
 10212*        DATAONLY
 10213*        CURSOR
 10214*    END-EXEC.
 10215     MOVE LENGTH OF
 10216      EL677AO
 10217       TO DFHEIV12
 10218     MOVE -1
 10219       TO DFHEIV11
 10220*    MOVE '8$D    CT       H L F ,   #00009194' TO DFHEIV0
 10221     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10222     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10223     MOVE X'2020233030303039313934' TO DFHEIV0(25:11)
 10224     CALL 'kxdfhei1' USING DFHEIV0,
 10225           EL677A,
 10226           EL677AO,
 10227           DFHEIV12,
 10228           MAPSET-NAME,
 10229           DFHEIV99,
 10230           DFHEIV99,
 10231           DFHEIV99,
 10232           DFHEIV11,
 10233           DFHEIV99,
 10234           DFHEIV99,
 10235           DFHEIV99
 10236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10237
 10238
 10239     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 189
* EL677.cbl
 10241 8300-SEND-TEXT.
 10242
 10243* EXEC CICS SEND TEXT
 10244*        FROM     (LOGOFF-TEXT)
 10245*        LENGTH   (LOGOFF-LENGTH)
 10246*        ERASE
 10247*        FREEKB
 10248*    END-EXEC.
 10249*    MOVE '8&      T  E F  H   F -   #00009205' TO DFHEIV0
 10250     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10251     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10252     MOVE X'2020233030303039323035' TO DFHEIV0(25:11)
 10253     CALL 'kxdfhei1' USING DFHEIV0,
 10254           LOGOFF-TEXT,
 10255           LOGOFF-LENGTH,
 10256           DFHEIV99,
 10257           DFHEIV99,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99,
 10261           DFHEIV99,
 10262           DFHEIV99,
 10263           DFHEIV99,
 10264           DFHEIV99,
 10265           DFHEIV99
 10266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10267
 10268
 10269
 10270* EXEC CICS RETURN
 10271*    END-EXEC.
 10272*    MOVE '.(                    ''   #00009212' TO DFHEIV0
 10273     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10275     MOVE X'2020233030303039323132' TO DFHEIV0(25:11)
 10276     CALL 'kxdfhei1' USING DFHEIV0,
 10277           DFHEIV99,
 10278           DFHEIV99,
 10279           DFHEIV99,
 10280           DFHEIV99,
 10281           DFHEIV99,
 10282           DFHEIV99
 10283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10284
 10285
 10286 8500-DATE-CONVERT.
 10287     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10288
 10289
 10290* EXEC CICS LINK
 10291*        PROGRAM    (PGM-NAME)
 10292*        COMMAREA   (DATE-CONVERSION-DATA)
 10293*        LENGTH     (DC-COMM-LENGTH)
 10294*    END-EXEC.
 10295*    MOVE '."C                   (   #00009218' TO DFHEIV0
 10296     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10297     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10298     MOVE X'2020233030303039323138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 190
* EL677.cbl
 10299     CALL 'kxdfhei1' USING DFHEIV0,
 10300           PGM-NAME,
 10301           DATE-CONVERSION-DATA,
 10302           DC-COMM-LENGTH,
 10303           DFHEIV99,
 10304           DFHEIV99,
 10305           DFHEIV99,
 10306           DFHEIV99
 10307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10308
 10309
 10310 8500-EXIT.
 10311      EXIT.
 10312
 10313 8600-DEEDIT.
 10314
 10315* EXEC CICS BIF DEEDIT
 10316*        FIELD   (WS-DEEDIT-FIELD)
 10317*        LENGTH  (10)
 10318*    END-EXEC.
 10319     MOVE 10
 10320       TO DFHEIV11
 10321*    MOVE '@"L                   #   #00009228' TO DFHEIV0
 10322     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10323     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10324     MOVE X'2020233030303039323238' TO DFHEIV0(25:11)
 10325     CALL 'kxdfhei1' USING DFHEIV0,
 10326           WS-DEEDIT-FIELD,
 10327           DFHEIV11
 10328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10329
 10330
 10331 8600-EXIT.
 10332      EXIT.
 10333
 10334 8700-DEEDIT.
 10335
 10336* EXEC CICS BIF DEEDIT
 10337*        FIELD   (WS-DT-DEEDIT-FIELD)
 10338*        LENGTH  (10)
 10339*    END-EXEC.
 10340     MOVE 10
 10341       TO DFHEIV11
 10342*    MOVE '@"L                   #   #00009237' TO DFHEIV0
 10343     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10344     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10345     MOVE X'2020233030303039323337' TO DFHEIV0(25:11)
 10346     CALL 'kxdfhei1' USING DFHEIV0,
 10347           WS-DT-DEEDIT-FIELD,
 10348           DFHEIV11
 10349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10350
 10351
 10352 8700-EXIT.
 10353      EXIT.
 10354
 10355 8800-UNAUTHORIZED-ACCESS.
 10356     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 191
* EL677.cbl
 10357     GO TO 8300-SEND-TEXT.
 10358
 10359 8810-PF23.
 10360     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10361     MOVE XCTL-005               TO  PGM-NAME.
 10362     GO TO 9300-XCTL.
 10363
 10364
 10365 9100-RETURN-TRAN.
 10366     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10367     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10368
 10369* EXEC CICS RETURN
 10370*        TRANSID  (TRANS-ID)
 10371*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10372*        LENGTH   (PI-COMM-LENGTH)
 10373*    END-EXEC.
 10374*    MOVE '.(CT                  ''   #00009258' TO DFHEIV0
 10375     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10376     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10377     MOVE X'2020233030303039323538' TO DFHEIV0(25:11)
 10378     CALL 'kxdfhei1' USING DFHEIV0,
 10379           TRANS-ID,
 10380           PROGRAM-INTERFACE-BLOCK,
 10381           PI-COMM-LENGTH,
 10382           DFHEIV99,
 10383           DFHEIV99,
 10384           DFHEIV99
 10385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10386
 10387
 10388
 10389* GOBACK.
 10390     MOVE '9%                    "   ' TO DFHEIV0
 10391     MOVE 'EL677' TO DFHEIV1
 10392     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10393     GOBACK.
 10394
 10395 9200-RETURN-MAIN-MENU.
 10396     MOVE XCTL-626               TO  PGM-NAME.
 10397     GO TO 9300-XCTL.
 10398
 10399 9300-XCTL.
 10400
 10401* EXEC CICS XCTL
 10402*        PROGRAM    (PGM-NAME)
 10403*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10404*        LENGTH     (PI-COMM-LENGTH)
 10405*    END-EXEC.
 10406*    MOVE '.$C                   %   #00009271' TO DFHEIV0
 10407     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10408     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10409     MOVE X'2020233030303039323731' TO DFHEIV0(25:11)
 10410     CALL 'kxdfhei1' USING DFHEIV0,
 10411           PGM-NAME,
 10412           PROGRAM-INTERFACE-BLOCK,
 10413           PI-COMM-LENGTH,
 10414           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 192
* EL677.cbl
 10415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10416
 10417
 10418 9400-CLEAR.
 10419     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10420     MOVE SPACES                 TO  PI-PFKEY.
 10421     GO TO 9300-XCTL.
 10422
 10423 9500-PF12.
 10424     MOVE XCTL-010               TO  PGM-NAME.
 10425     GO TO 9300-XCTL.
 10426
 10427 9600-PGMID-ERROR.
 10428
 10429* EXEC CICS HANDLE CONDITION
 10430*        PGMIDERR    (8300-SEND-TEXT)
 10431*    END-EXEC.
 10432*    MOVE '"$L                   ! 4 #00009287' TO DFHEIV0
 10433     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10435     MOVE X'3420233030303039323837' TO DFHEIV0(25:11)
 10436     CALL 'kxdfhei1' USING DFHEIV0
 10437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10438
 10439
 10440     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10441     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10442     MOVE XCTL-005               TO  PGM-NAME.
 10443     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10444     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10445
 10446     GO TO 9300-XCTL.
 10447
 10448 9900-ERROR-FORMAT.
 10449     IF NOT EMI-ERRORS-COMPLETE
 10450         MOVE LINK-001           TO  PGM-NAME
 10451
 10452* EXEC CICS LINK
 10453*            PROGRAM    (PGM-NAME)
 10454*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10455*            LENGTH     (EMI-COMM-LENGTH)
 10456*        END-EXEC.
 10457*    MOVE '."C                   (   #00009302' TO DFHEIV0
 10458     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10460     MOVE X'2020233030303039333032' TO DFHEIV0(25:11)
 10461     CALL 'kxdfhei1' USING DFHEIV0,
 10462           PGM-NAME,
 10463           ERROR-MESSAGE-INTERFACE-BLOCK,
 10464           EMI-COMM-LENGTH,
 10465           DFHEIV99,
 10466           DFHEIV99,
 10467           DFHEIV99,
 10468           DFHEIV99
 10469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10470
 10471
 10472 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 193
* EL677.cbl
 10473      EXIT.
 10474
 10475 9990-ABEND.
 10476     MOVE LINK-004               TO  PGM-NAME.
 10477     MOVE DFHEIBLK               TO  EMI-LINE1.
 10478
 10479* EXEC CICS LINK
 10480*        PROGRAM   (PGM-NAME)
 10481*        COMMAREA  (EMI-LINE1)
 10482*        LENGTH    (72)
 10483*    END-EXEC.
 10484     MOVE 72
 10485       TO DFHEIV11
 10486*    MOVE '."C                   (   #00009314' TO DFHEIV0
 10487     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10488     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10489     MOVE X'2020233030303039333134' TO DFHEIV0(25:11)
 10490     CALL 'kxdfhei1' USING DFHEIV0,
 10491           PGM-NAME,
 10492           EMI-LINE1,
 10493           DFHEIV11,
 10494           DFHEIV99,
 10495           DFHEIV99,
 10496           DFHEIV99,
 10497           DFHEIV99
 10498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10499
 10500
 10501     GO TO 8200-SEND-DATAONLY.
 10502
 10503 9995-SECURITY-VIOLATION.
 10504*                            COPY ELCSCTP.
 10505******************************************************************
 10506*                                                                *
 10507*                            ELCSCTP                             *
 10508*                            VMOD=2.001                          *
 10509*                                                                *
 10510*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10511******************************************************************
 10512
 10513
 10514     MOVE EIBDATE          TO SM-JUL-DATE.
 10515     MOVE EIBTRMID         TO SM-TERMID.
 10516     MOVE THIS-PGM         TO SM-PGM.
 10517     MOVE EIBTIME          TO TIME-IN.
 10518     MOVE TIME-OUT         TO SM-TIME.
 10519     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10520
 10521
 10522* EXEC CICS LINK
 10523*         PROGRAM  ('EL003')
 10524*         COMMAREA (SECURITY-MESSAGE)
 10525*         LENGTH   (80)
 10526*    END-EXEC.
 10527     MOVE 'EL003' TO DFHEIV1
 10528     MOVE 80
 10529       TO DFHEIV11
 10530*    MOVE '."C                   (   #00009340' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 194
* EL677.cbl
 10531     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10532     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10533     MOVE X'2020233030303039333430' TO DFHEIV0(25:11)
 10534     CALL 'kxdfhei1' USING DFHEIV0,
 10535           DFHEIV1,
 10536           SECURITY-MESSAGE,
 10537           DFHEIV11,
 10538           DFHEIV99,
 10539           DFHEIV99,
 10540           DFHEIV99,
 10541           DFHEIV99
 10542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10543
 10544
 10545******************************************************************
 10546
 10547
 10548 9995-EXIT.
 10549     EXIT.
 10550
 10551
 10552 9999-DFHBACK SECTION.
 10553     MOVE '9%                    "   ' TO DFHEIV0
 10554     MOVE 'EL677' TO DFHEIV1
 10555     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10556     GOBACK.
 10557 9999-DFHEXIT.
 10558     IF DFHEIGDJ EQUAL 0001
 10559         NEXT SENTENCE
 10560     ELSE IF DFHEIGDJ EQUAL 2
 10561         GO TO 9600-PGMID-ERROR,
 10562               9990-ABEND
 10563         DEPENDING ON DFHEIGDI
 10564     ELSE IF DFHEIGDJ EQUAL 3
 10565         GO TO 8100-SEND-INITIAL-MAP
 10566         DEPENDING ON DFHEIGDI
 10567     ELSE IF DFHEIGDJ EQUAL 4
 10568         GO TO 1290-NO-CARRIER
 10569         DEPENDING ON DFHEIGDI
 10570     ELSE IF DFHEIGDJ EQUAL 5
 10571         GO TO 1380-NO-STATE
 10572         DEPENDING ON DFHEIGDI
 10573     ELSE IF DFHEIGDJ EQUAL 6
 10574         GO TO 1480-ACCOUNT-INVALID,
 10575               1480-ACCOUNT-INVALID
 10576         DEPENDING ON DFHEIGDI
 10577     ELSE IF DFHEIGDJ EQUAL 7
 10578         GO TO 1590-EXIT
 10579         DEPENDING ON DFHEIGDI
 10580     ELSE IF DFHEIGDJ EQUAL 8
 10581         GO TO 2200-DUPREC
 10582         DEPENDING ON DFHEIGDI
 10583     ELSE IF DFHEIGDJ EQUAL 9
 10584         GO TO 2577-DUPREC
 10585         DEPENDING ON DFHEIGDI
 10586     ELSE IF DFHEIGDJ EQUAL 10
 10587         GO TO 2600-NO-CO-MASTER
 10588         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 08-Nov-16 08:15 Page 195
* EL677.cbl
 10589     ELSE IF DFHEIGDJ EQUAL 11
 10590         GO TO 3900-RECORD-NOTFND
 10591         DEPENDING ON DFHEIGDI
 10592     ELSE IF DFHEIGDJ EQUAL 12
 10593         GO TO 3287-DUPREC
 10594         DEPENDING ON DFHEIGDI
 10595     ELSE IF DFHEIGDJ EQUAL 13
 10596         GO TO 3390-EXIT,
 10597               3390-EXIT
 10598         DEPENDING ON DFHEIGDI
 10599     ELSE IF DFHEIGDJ EQUAL 14
 10600         GO TO 5560-END-OF-FILE,
 10601               5560-END-OF-FILE
 10602         DEPENDING ON DFHEIGDI
 10603     ELSE IF DFHEIGDJ EQUAL 15
 10604         GO TO 6070-NO-COMP-MSTR
 10605         DEPENDING ON DFHEIGDI
 10606     ELSE IF DFHEIGDJ EQUAL 16
 10607         GO TO 6170-NO-CERTIFICATE
 10608         DEPENDING ON DFHEIGDI
 10609     ELSE IF DFHEIGDJ EQUAL 17
 10610         GO TO 6470-NO-ADDRESS
 10611         DEPENDING ON DFHEIGDI
 10612     ELSE IF DFHEIGDJ EQUAL 18
 10613         GO TO 6670-NO-beneficiary
 10614         DEPENDING ON DFHEIGDI
 10615     ELSE IF DFHEIGDJ EQUAL 19
 10616         GO TO 7300-EXIT
 10617         DEPENDING ON DFHEIGDI
 10618     ELSE IF DFHEIGDJ EQUAL 20
 10619         GO TO 8300-SEND-TEXT
 10620         DEPENDING ON DFHEIGDI.
 10621     MOVE '9%                    "   ' TO DFHEIV0
 10622     MOVE 'EL677' TO DFHEIV1
 10623     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10624     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142324     Code:       39626
