* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   1
* NSAASBL.cbl
* Options: int("NSAASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSAASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSAASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSAASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSAASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSAASLTR.cl2
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   2
* NSAASBL.cbl
    14* 071111    2011022800001  PEMA  NEW PROGRAM
    15* 102212    2012101700002  AJRA  EXPAND PASSED AREA
    16* 012413    2013012100001  AJRA  ADD AUTO BILLING NOTE
    17* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    18* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
    19******************************************************************
    20 ENVIRONMENT DIVISION.
    21 DATA DIVISION.
    22 working-storage section.
    23 01  DFH-START PIC X(04).
    24 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    25 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    26 77  S1                          PIC S999 COMP-3 VALUE +0.
    27 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    28 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    29 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    30 77  NOTE-SUB                    PIC S9(5) COMP-3 VALUE +0.
    31 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    32     88  NO-CERT-RW                 VALUE 'N'.
    33     88  CERT-RW                    VALUE 'Y'.
    34 01 response-code         pic s9(8) comp.
    35 01 display-response      pic 9(8).
    36 01 bl-index              pic 9(8) comp.
    37 01 max-last-name         pic x(18).
    38 01 first-initial         pic x.
    39 01 name-in-range-flag    pic 9.
    40 01 max-entries           pic s9(8) comp value 100.
    41 01 lower-case    pic x(26) value
    42            "abcdefghijklmnopqrstuvwxyz".
    43 01 upper-case    pic x(26) value
    44            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    45 01  MISC.
    46     12  WS-RESPONSE             PIC S9(8)   COMP.
    47         88  RESP-NORMAL                  VALUE +00.
    48         88  RESP-NOTFND                  VALUE +13.
    49         88  RESP-DUPREC                  VALUE +14.
    50         88  RESP-DUPKEY                  VALUE +15.
    51         88  RESP-NOTOPEN                 VALUE +19.
    52         88  RESP-ENDFILE                 VALUE +20.
    53*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
    54*                         COPY ELCZREC.
    55******************************************************************
    56*                                                                *
    57*                                                                *
    58*                            ELCZREC.                            *
    59*                                                                *
    60*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
    61*                                                                *
    62******************************************************************
    63*-----------------------------------------------------------------
    64*                   C H A N G E   L O G
    65*
    66* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    67*-----------------------------------------------------------------
    68*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    69* EFFECTIVE    NUMBER
    70*-----------------------------------------------------------------
    71* 122011    2011022800001  AJRA  NEW FILE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   3
* NSAASBL.cbl
    72* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    73* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    74* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
    75* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    76*-----------------------------------------------------------------
    77 01  W-Z-CONTROL-DATA.
    78     05  W-NUMBER-OF-COPIES      PIC  9.
    79     05  FILLER                  PIC  X.
    80     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
    81     05  FILLER                  PIC  X.
    82     05  W-DAYS-TO-RESEND        PIC  999.
    83     05  FILLER                  PIC  X.
    84     05  W-FORM-TO-RESEND        PIC  X(4).
    85     05  W-ADD-BAR-CODE          PIC  X.
    86     05  W-PROMPT-LETTER         PIC  X.
    87     05  W-HAS-RETURN-ENV        PIC  X.
    88     05  W-ENCLOSURE-CD          PIC  XXX.
    89     05  W-SIG-FLAG-DEFAULT      PIC  X.
    90     05  W-AUTO-CLOSE-IND        PIC  X.
    91     05  FILLER                  PIC  X.
    92     05  W-LETTER-TO-BENE        PIC  X.
    93     05  FILLER                  PIC  X.
    94     05  W-LETTER-TO-ACCT        PIC  X.
    95     05  FILLER                  PIC  X.
    96     05  W-LETTER-TYPE           PIC  X.
    97     05  FILLER                  PIC  X.
    98     05  W-PRINT-CERTIFICATE     PIC  X.
    99     05  FILLER                  PIC  X.
   100     05  W-REFUND-REQUIRED       PIC  X.
   101     05  FILLER                  PIC  X.
   102     05  W-ONBASE-CODE           PIC  XX.
   103     05  FILLER                  PIC  X.
   104     05  W-ACCT-SUMM             PIC  X.
   105     05  FILLER                  PIC  X.
   106     05  W-CSO-SUMM              PIC  X.
   107     05  FILLER                  PIC  X.
   108     05  W-REASONS-REQUIRED      PIC  X.
   109     05  FILLER                  PIC  X(29).
   110 01  WS-ERARCH-KEY.
   111     05  WS-ERARCH-COMPANY-CD    PIC X.
   112     05  WS-ERARCH-ARCH-NO       PIC S9(8) BINARY.
   113 01  ws-erpndb-key.
   114     05  ws-erpndb-company-cd    pic x.
   115     05  ws-erpndb-batch-no      pic x(6).
   116     05  ws-erpndb-batch-seq-no  pic s9(4) COMP.
   117     05  ws-erpndb-chg-seq-no    pic s9(4) COMP.
   118 01  WS-ERENDT2-KEY.
   119     05  WS-ERENDT-COMPANY-CD    PIC X.
   120     05  WS-ERENDT-ARCH-NO       PIC 9(8) BINARY.
   121 01  WS-NSASEXTR-KEY.
   122     05  WS-EXTR-COMPANY-CD    PIC X.
   123     05  WS-EXTR-ARCH-NO       PIC 9(8) BINARY.
   124     05  WS-EXTR-SEQ-NO        PIC 9(4) BINARY.
   125 01  WS-ELLETR-KEY.
   126     05  WS-ELLETR-COMPANY-CD    PIC X.
   127     05  WS-ELLETR-LETTER-ID     PIC X(12).
   128     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   129
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   4
* NSAASBL.cbl
   130 01  BILL-NOTE-AREA.
   131     12  ws-from-issue-or-cancel pic x.
   132     12  WS-ELEOBC-KEY.
   133         16  WS-EOBC-COMPANY-CD  PIC X.
   134         16  WS-EOBC-REC-TYPE    PIC X.
   135         16  WS-EOBC-CODE        PIC X(4).
   136         16  FILLER              PIC X(9).
   137     12  WS-ERNOTE-KEY.
   138         16  WS-NOTE-COMPANY-CD  PIC X.
   139         16  WS-NOTE-CARRIER     PIC X.
   140         16  WS-NOTE-GROUPING    PIC X(6).
   141         16  WS-NOTE-STATE       PIC XX.
   142         16  WS-NOTE-ACCOUNT     PIC X(10).
   143         16  WS-NOTE-CERT-EFF-DT PIC XX.
   144         16  WS-NOTE-CERT-PRIME  PIC X(10).
   145         16  WS-NOTE-CERT-SFX    PIC X.
   146         16  ws-note-record-type pic x.
   147     12  WS-BILLING-NOTE.
   148         16  WS-BN-NOTE          PIC X(25).
   149         16  WS-BN-LTRID         PIC X(4).
   150         16  FILLER              PIC X(3).
   151         16  WS-BN-DATE          PIC X(8).
   152         16  FILLER              PIC X(3).
   153         16  WS-BN-USERID        PIC X(4).
   154         16  FILLER              PIC X(30).
   155     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   156     12  WS-ELCERT-KEY.
   157         16  WS-CERT-COMPANY-CD  PIC X.
   158         16  WS-CERT-CARRIER     PIC X.
   159         16  WS-CERT-GROUPING    PIC X(6).
   160         16  WS-CERT-STATE       PIC XX.
   161         16  WS-CERT-ACCOUNT     PIC X(10).
   162         16  WS-CERT-CERT-EFF-DT PIC XX.
   163         16  WS-CERT-CERT-PRIME  PIC X(10).
   164         16  WS-CERT-CERT-SFX    PIC X.
   165     12  WS-SAVE-KEY.
   166         16  WS-SV-COMPANY-CD    PIC X.
   167         16  WS-SV-CARRIER       PIC X.
   168         16  WS-SV-GROUPING      PIC X(6).
   169         16  WS-SV-STATE         PIC XX.
   170         16  WS-SV-ACCOUNT       PIC X(10).
   171         16  WS-SV-CERT-EFF-DT   PIC XX.
   172         16  WS-SV-CERT-PRIME    PIC X(10).
   173         16  WS-SV-CERT-SFX      PIC X.
   174     12  WS-SAVE-DATA.
   175         16  WS-SV-LETTER-ID     PIC X(4).
   176         16  WS-SV-PROC-ID       PIC X(4).
   177 01 srch-commarea.
   178*                                copy ELCADLTRSPI.
   179******************************************************************
   180*                   C H A N G E   L O G
   181*
   182* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   183*-----------------------------------------------------------------
   184*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   185* EFFECTIVE    NUMBER
   186*-----------------------------------------------------------------
   187* 060611    2011022800001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   5
* NSAASBL.cbl
   188* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   189* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   190******************************************************************
   191****************************************
   192*  commarea for NaperSoft On Demand Admin services letters
   193*  (business logic input & output)
   194****************************************
   195     03  BL-INPUT.
   196         05  BL-DATA-SRCE        PIC X.
   197         05  BL-LETTER-ID        PIC XXXX.
   198         05  BL-CARRIER          PIC X.
   199         05  BL-GROUP            PIC X(6).
   200         05  BL-STATE            PIC XX.
   201         05  BL-ACCOUNT          PIC X(10).
   202         05  BL-EFF-DT           PIC X(10).
   203         05  BL-CERT-NO          PIC X(11).
   204         05  BL-BATCH-NO         PIC X(6).
   205         05  BL-BATCH-SEQ        PIC 9(8).
   206         05  BL-RESP-NO          PIC X(10).
   207         05  BL-NO-OF-COPIES     PIC 99.
   208         05  BL-PROC-ID          PIC XXXX.
   209         05  BL-COMP-ID          PIC XXX.
   210         05  BL-PRINT-NOW-SW     PIC X.
   211         05  BL-ENC-CD           PIC XXX.
   212         05  BL-RESEND-DT        PIC X(10).
   213         05  BL-FOLLOW-UP-DT     PIC X(10).
   214         05  BL-ARCHIVE-NO       PIC 9(8).
   215         05  BL-FUNC             PIC X(8).
   216         05  BL-COMMENTS         PIC X(100).
   217         05  FILLER REDEFINES BL-COMMENTS.
   218             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   219             10  BL-LETTER-TO-ACCT PIC X.
   220             10  BL-LETTER-TO-BENE PIC X.
   221             10  BL-WRITE-ERARCH   PIC X.
   222                 88  ERARCH-QWS      VALUE 'Q'.
   223                 88  ERARCH-BATCH    VALUE 'B'.
   224                 88  ERARCH-TEMP     VALUE 'T'.
   225             10  BL-PROCESS-TYPE PIC X(07).
   226             10  BL-CERT-FORM-ID PIC X(05).
   227             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   228             10  BL-SOURCE-SCREEN PIC X(8).
   229             10  FILLER          PIC X(25).
   230     03  BL-OUTPUT.
   231         05  BL-STATUS                   PIC X.
   232             88  BL-OK                      VALUE "P".
   233             88  BL-FAIL                  VALUE "F".
   234         05  BL-MESSAGE          PIC X(50).
   235     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   236     03  FILLER                  PIC X(31).
   237*                                COPY ELCDATE.
   238******************************************************************
   239*                                                                *
   240*                                                                *
   241*                            ELCDATE.                            *
   242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   243*                            VMOD=2.003
   244*                                                                *
   245*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   6
* NSAASBL.cbl
   246*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   247*                 LENGTH = 200                                   *
   248******************************************************************
   249
   250 01  DATE-CONVERSION-DATA.
   251     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   252     12  DC-OPTION-CODE                PIC X.
   253         88  BIN-TO-GREG                VALUE ' '.
   254         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   255         88  EDIT-GREG-TO-BIN           VALUE '2'.
   256         88  YMD-GREG-TO-BIN            VALUE '3'.
   257         88  MDY-GREG-TO-BIN            VALUE '4'.
   258         88  JULIAN-TO-BIN              VALUE '5'.
   259         88  BIN-PLUS-ELAPSED           VALUE '6'.
   260         88  FIND-CENTURY               VALUE '7'.
   261         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   262         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   263         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   264         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   265         88  JULIAN-TO-BIN-3            VALUE 'C'.
   266         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   267         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   268         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   269         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   270         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   271         88  CHECK-LEAP-YEAR            VALUE 'H'.
   272         88  BIN-3-TO-GREG              VALUE 'I'.
   273         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   274         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   275         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   276         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   277         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   278         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   279         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   280         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   281         88  THREE-CHARACTER-BIN
   282                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   283         88  GREGORIAN-TO-BIN
   284                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   285         88  BIN-TO-GREGORIAN
   286                  VALUES ' ' '1' 'I' '8' 'G'.
   287         88  JULIAN-TO-BINARY
   288                  VALUES '5' 'C' 'E' 'F'.
   289     12  DC-ERROR-CODE                 PIC X.
   290         88  NO-CONVERSION-ERROR        VALUE ' '.
   291         88  DATE-CONVERSION-ERROR
   292                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   293         88  DATE-IS-ZERO               VALUE '1'.
   294         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   295         88  DATE-IS-INVALID            VALUE '3'.
   296         88  DATE1-GREATER-DATE2        VALUE '4'.
   297         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   298         88  DATE-INVALID-OPTION        VALUE '9'.
   299         88  INVALID-CENTURY            VALUE 'A'.
   300         88  ONLY-CENTURY               VALUE 'B'.
   301         88  ONLY-LEAP-YEAR             VALUE 'C'.
   302         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   303     12  DC-END-OF-MONTH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   7
* NSAASBL.cbl
   304         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   305     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   306         88  USE-NORMAL-PROCESS         VALUE ' '.
   307         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   308         88  ADJUST-UP-100-YRS          VALUE '2'.
   309     12  FILLER                        PIC X.
   310     12  DC-CONVERSION-DATES.
   311         16  DC-BIN-DATE-1             PIC XX.
   312         16  DC-BIN-DATE-2             PIC XX.
   313         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   314         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   315                       DC-GREG-DATE-1-EDIT.
   316             20  DC-EDIT1-MONTH        PIC 99.
   317             20  SLASH1-1              PIC X.
   318             20  DC-EDIT1-DAY          PIC 99.
   319             20  SLASH1-2              PIC X.
   320             20  DC-EDIT1-YEAR         PIC 99.
   321         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   322         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   323                     DC-GREG-DATE-2-EDIT.
   324             20  DC-EDIT2-MONTH        PIC 99.
   325             20  SLASH2-1              PIC X.
   326             20  DC-EDIT2-DAY          PIC 99.
   327             20  SLASH2-2              PIC X.
   328             20  DC-EDIT2-YEAR         PIC 99.
   329         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   330         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   331                     DC-GREG-DATE-1-YMD.
   332             20  DC-YMD-YEAR           PIC 99.
   333             20  DC-YMD-MONTH          PIC 99.
   334             20  DC-YMD-DAY            PIC 99.
   335         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   336         16  DC-GREG-DATE-1-MDY-R REDEFINES
   337                      DC-GREG-DATE-1-MDY.
   338             20  DC-MDY-MONTH          PIC 99.
   339             20  DC-MDY-DAY            PIC 99.
   340             20  DC-MDY-YEAR           PIC 99.
   341         16  DC-GREG-DATE-1-ALPHA.
   342             20  DC-ALPHA-MONTH        PIC X(10).
   343             20  DC-ALPHA-DAY          PIC 99.
   344             20  FILLER                PIC XX.
   345             20  DC-ALPHA-CENTURY.
   346                 24 DC-ALPHA-CEN-N     PIC 99.
   347             20  DC-ALPHA-YEAR         PIC 99.
   348         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   349         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   350         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   351         16  DC-JULIAN-DATE            PIC 9(05).
   352         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   353                                       PIC 9(05).
   354         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   355             20  DC-JULIAN-YEAR        PIC 99.
   356             20  DC-JULIAN-DAYS        PIC 999.
   357         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   358         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   359         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   360     12  DATE-CONVERSION-VARIBLES.
   361         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   8
* NSAASBL.cbl
   362         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   363             20  FILLER                PIC 9(3).
   364             20  HOLD-CEN-1-CCYY.
   365                 24  HOLD-CEN-1-CC     PIC 99.
   366                 24  HOLD-CEN-1-YY     PIC 99.
   367             20  HOLD-CEN-1-MO         PIC 99.
   368             20  HOLD-CEN-1-DA         PIC 99.
   369         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   370             20  HOLD-CEN-1-R-MO       PIC 99.
   371             20  HOLD-CEN-1-R-DA       PIC 99.
   372             20  HOLD-CEN-1-R-CCYY.
   373                 24  HOLD-CEN-1-R-CC   PIC 99.
   374                 24  HOLD-CEN-1-R-YY   PIC 99.
   375             20  FILLER                PIC 9(3).
   376         16  HOLD-CENTURY-1-X.
   377             20  FILLER                PIC X(3)  VALUE SPACES.
   378             20  HOLD-CEN-1-X-CCYY.
   379                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   380                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   381             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   382             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   383         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   384             20  HOLD-CEN-1-R-X-MO     PIC XX.
   385             20  HOLD-CEN-1-R-X-DA     PIC XX.
   386             20  HOLD-CEN-1-R-X-CCYY.
   387                 24  HOLD-CEN-1-R-X-CC PIC XX.
   388                 24  HOLD-CEN-1-R-X-YY PIC XX.
   389             20  FILLER                PIC XXX.
   390         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   391         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   392         16  DC-JULIAN-DATE-1          PIC 9(07).
   393         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   394             20  DC-JULIAN-1-CCYY.
   395                 24  DC-JULIAN-1-CC    PIC 99.
   396                 24  DC-JULIAN-1-YR    PIC 99.
   397             20  DC-JULIAN-DA-1        PIC 999.
   398         16  DC-JULIAN-DATE-2          PIC 9(07).
   399         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   400             20  DC-JULIAN-2-CCYY.
   401                 24  DC-JULIAN-2-CC    PIC 99.
   402                 24  DC-JULIAN-2-YR    PIC 99.
   403             20  DC-JULIAN-DA-2        PIC 999.
   404         16  DC-GREG-DATE-A-EDIT.
   405             20  DC-EDITA-MONTH        PIC 99.
   406             20  SLASHA-1              PIC X VALUE '/'.
   407             20  DC-EDITA-DAY          PIC 99.
   408             20  SLASHA-2              PIC X VALUE '/'.
   409             20  DC-EDITA-CCYY.
   410                 24  DC-EDITA-CENT     PIC 99.
   411                 24  DC-EDITA-YEAR     PIC 99.
   412         16  DC-GREG-DATE-B-EDIT.
   413             20  DC-EDITB-MONTH        PIC 99.
   414             20  SLASHB-1              PIC X VALUE '/'.
   415             20  DC-EDITB-DAY          PIC 99.
   416             20  SLASHB-2              PIC X VALUE '/'.
   417             20  DC-EDITB-CCYY.
   418                 24  DC-EDITB-CENT     PIC 99.
   419                 24  DC-EDITB-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page   9
* NSAASBL.cbl
   420         16  DC-GREG-DATE-CYMD         PIC 9(08).
   421         16  DC-GREG-DATE-CYMD-R REDEFINES
   422                              DC-GREG-DATE-CYMD.
   423             20  DC-CYMD-CEN           PIC 99.
   424             20  DC-CYMD-YEAR          PIC 99.
   425             20  DC-CYMD-MONTH         PIC 99.
   426             20  DC-CYMD-DAY           PIC 99.
   427         16  DC-GREG-DATE-MDCY         PIC 9(08).
   428         16  DC-GREG-DATE-MDCY-R REDEFINES
   429                              DC-GREG-DATE-MDCY.
   430             20  DC-MDCY-MONTH         PIC 99.
   431             20  DC-MDCY-DAY           PIC 99.
   432             20  DC-MDCY-CEN           PIC 99.
   433             20  DC-MDCY-YEAR          PIC 99.
   434    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   435        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   436    12  DC-EL310-DATE                  PIC X(21).
   437    12  FILLER                         PIC X(28).
   438*                                copy ERCPNDB.
   439******************************************************************
   440*                                                                *
   441*                                                                *
   442*                            ERCPNDB.                            *
   443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   444*                            VMOD=2.025                          *
   445*                                                                *
   446*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   447*                                                                *
   448******************************************************************
   449*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   450*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   451******************************************************************
   452*                                                                *
   453*                                                                *
   454*   FILE TYPE = VSAM,KSDS                                        *
   455*   RECORD SIZE = 585  RECFORM = FIXED                           *
   456*                                                                *
   457*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   458*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   459*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   460*                                                 RKP=13,LEN=36  *
   461*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   462*                                      AND CHG-SEQ.)             *
   463*                                                RKP=49,LEN=11   *
   464*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   465*                                      AND CHG-SEQ.)             *
   466*                                                RKP=60,LEN=15   *
   467*                                                                *
   468*   LOG = NO                                                     *
   469*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   470******************************************************************
   471******************************************************************
   472*                   C H A N G E   L O G
   473*
   474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   475*-----------------------------------------------------------------
   476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   477* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  10
* NSAASBL.cbl
   478*-----------------------------------------------------------------
   479* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   480* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   481* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   482* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   483* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   484* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   485* 032306                   PEMA  ADD BOW LOAN NUMBER
   486* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   487* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   488* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   489* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   490* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   491* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   492* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   493* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   494* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   495* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   496* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
   497* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   498* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
   499******************************************************************
   500
   501 01  PENDING-BUSINESS.
   502     12  PB-RECORD-ID                     PIC XX.
   503         88  VALID-PB-ID                        VALUE 'PB'.
   504
   505     12  PB-CONTROL-PRIMARY.
   506         16  PB-COMPANY-CD                PIC X.
   507         16  PB-ENTRY-BATCH               PIC X(6).
   508         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   509         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   510
   511     12  PB-CONTROL-BY-ACCOUNT.
   512         16  PB-COMPANY-CD-A1             PIC X.
   513         16  PB-CARRIER                   PIC X.
   514         16  PB-GROUPING.
   515             20  PB-GROUPING-PREFIX       PIC XXX.
   516             20  PB-GROUPING-PRIME        PIC XXX.
   517         16  PB-STATE                     PIC XX.
   518         16  PB-ACCOUNT.
   519             20  PB-ACCOUNT-PREFIX        PIC X(4).
   520             20  PB-ACCOUNT-PRIME         PIC X(6).
   521         16  PB-CERT-EFF-DT               PIC XX.
   522         16  PB-CERT-NO.
   523             20  PB-CERT-PRIME            PIC X(10).
   524             20  PB-CERT-SFX              PIC X.
   525         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   526
   527         16  PB-RECORD-TYPE               PIC X.
   528             88  PB-MAILING-DATA                VALUE '0'.
   529             88  PB-ISSUE                       VALUE '1'.
   530             88  PB-CANCELLATION                VALUE '2'.
   531             88  PB-BATCH-TRAILER               VALUE '9'.
   532
   533     12  PB-CONTROL-BY-ORIG-BATCH.
   534         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   535         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  11
* NSAASBL.cbl
   536         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   537         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   538
   539     12  PB-CONTROL-BY-CSR.
   540         16  PB-CSR-COMPANY-CD            PIC X.
   541         16  PB-CSR-ID                    PIC X(4).
   542         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   543         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   544         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   545******************************************************************
   546*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   547******************************************************************
   548
   549     12  PB-LAST-MAINT-DT                 PIC XX.
   550     12  PB-LAST-MAINT-BY                 PIC X(4).
   551     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   552
   553     12  PB-RECORD-BODY                   PIC X(375).
   554
   555     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   556         16  PB-CERT-ORIGIN               PIC X.
   557             88  CLASIC-CREATED-CERT         VALUE '1'.
   558         16  PB-I-NAME.
   559             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   560             20  PB-I-INSURED-FIRST-NAME.
   561                 24  PB-I-INSURED-1ST-INIT PIC X.
   562                 24  FILLER                PIC X(9).
   563             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   564         16  PB-I-AGE                     PIC S99   COMP-3.
   565         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   566         16  PB-I-BIRTHDAY                PIC XX.
   567         16  PB-I-INSURED-SEX             PIC X.
   568             88  PB-SEX-MALE     VALUE 'M'.
   569             88  PB-SEX-FEMALE   VALUE 'F'.
   570
   571         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   572         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   573         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   574         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   575         16  PB-I-SKIP-CODE               PIC X.
   576             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   577             88  PB-SKIP-JULY              VALUE '1'.
   578             88  PB-SKIP-AUGUST            VALUE '2'.
   579             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   580             88  PB-SKIP-JULY-AUG          VALUE '4'.
   581             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   582             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   583             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   584             88  PB-SKIP-JUNE              VALUE '8'.
   585             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   586             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   587             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   588         16  PB-I-TERM-TYPE               PIC X.
   589             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   590             88  PB-PAID-WEEKLY            VALUE 'W'.
   591             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   592             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   593             88  PB-PAID-13-YEARLY         VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  12
* NSAASBL.cbl
   594         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   595         16  PB-I-POLICY-FORM-NO          PIC X(12).
   596         16  PB-I-DATA-ENTRY-SW           PIC X.
   597             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   598             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   599             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   600             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   601         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   602         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   603*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   604         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   605         16  PB-I-LETTER-REQD             PIC X.
   606
   607         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   608             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   609             88  PB-INVALID-LIFE             VALUE '  ' '00'
   610                                                   '90' THRU '99'.
   611         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   612                                          PIC XX.
   613         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   614         16  PB-I-AMOUNT-FINANCED REDEFINES
   615                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   616         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   617         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   618                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   619         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   620         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   621         16  PB-I-CLP-AMOUNT REDEFINES
   622                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   623         16  PB-I-LF-CALC-FLAG            PIC X.
   624             88 PB-COMP-LF-PREM               VALUE '?'.
   625         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   626         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   627         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   628         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   629         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   630         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   631         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   632         16  PB-I-LF-ABBR                 PIC XXX.
   633         16  PB-I-LF-INPUT-CD             PIC XX.
   634
   635         16  PB-I-AH-BENEFIT-CD           PIC XX.
   636             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   637             88  PB-INVALID-AH               VALUE '  ' '00'
   638                                                   '90' THRU '99'.
   639         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   640         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   641         16  PB-I-AH-CALC-FLAG            PIC X.
   642             88 PB-COMP-AH-PREM                  VALUE '?'.
   643         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   644         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   645         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
   646         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   647         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   648         16  PB-I-AH-ABBR                 PIC XXX.
   649         16  PB-I-AH-INPUT-CD             PIC XXX.
   650
   651         16  PB-I-SPECIAL-REIN-CODE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  13
* NSAASBL.cbl
   652         16  PB-I-REIN-TABLE              PIC XXX.
   653         16  PB-I-BUSINESS-TYPE           PIC 99.
   654         16  PB-I-INDV-GRP-CD             PIC X.
   655         16  PB-I-MORT-CODE.
   656             20  PB-I-TABLE               PIC X.
   657             20  PB-I-INTEREST            PIC XX.
   658             20  PB-I-MORT-TYP            PIC X.
   659         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   660         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   661         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   662         16  PB-I-INDV-GRP-OVRD           PIC X.
   663         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   664         16  PB-I-SIG-SW                  PIC X.
   665             88  PB-POLICY-SIGNED             VALUE 'Y'.
   666         16  PB-I-RATE-CLASS              PIC XX.
   667         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   668         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   669         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   670         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   671         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   672         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   673         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   674         16  PB-I-BENEFIT-TYPE            PIC XXX.
   675         16  PB-I-OB-FLAG                 PIC X.
   676             88  PB-I-OB                      VALUE 'B'.
   677             88  PB-I-SUMMARY                 VALUE 'Z'.
   678         16  PB-I-ENTRY-STATUS            PIC X.
   679             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   680                                              'M' '5' '9' '2'.
   681             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   682             88  PB-I-POLICY-PENDING          VALUE '2'.
   683             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   684             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   685             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
   686             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   687             88  PB-I-REIN-ONLY               VALUE '9'.
   688             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   689             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   690             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   691             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   692         16  PB-I-INT-CODE                PIC X.
   693             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   694             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   695         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   696         16  PB-I-SOC-SEC-NO              PIC X(11).
   697         16  PB-I-MEMBER-NO               PIC X(12).
   698         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   699*        16  PB-I-LOAN-OFFICER            PIC XXX.
   700         16  PB-I-OLD-LOF                 PIC XXX.
   701         16  PB-I-LF-EXPIRE-DT            PIC XX.
   702         16  PB-I-AH-EXPIRE-DT            PIC XX.
   703         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   704         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   705         16  PB-I-LIFE-INDICATOR          PIC X.
   706             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   707         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   708         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   709                                          PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  14
* NSAASBL.cbl
   710         16  PB-I-MAIL-ADDRS-SW           PIC X.
   711             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   712             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   713         16  PB-I-1ST-PMT-DT              PIC XX.
   714         16  PB-I-JOINT-INSURED.
   715             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   716             20 PB-I-JOINT-FIRST-NAME.
   717                24  PB-I-JOINT-FIRST-INIT PIC X.
   718                24  FILLER                PIC X(9).
   719             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   720*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   721         16  PB-I-BENEFICIARY-NAME.
   722             20  PB-I-BANK-NUMBER         PIC X(10).
   723             20  FILLER                   PIC X(15).
   724         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   725         16  PB-I-REFERENCE               PIC X(12).
   726         16  FILLER REDEFINES PB-I-REFERENCE.
   727             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   728             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   729             20  PB-I-CLP-STATE           PIC XX.
   730         16  PB-I-UNDERWRITING-STATUS     PIC X.
   731             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   732             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   733             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   734         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   735         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   736         16  PB-I-RESIDENT-STATE          PIC XX.
   737         16  PB-I-RATE-CODE               PIC X(4).
   738         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   739         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   740         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   741         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   742         16  PB-I-BANK-NOCHRGB            PIC 99.
   743         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   744         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   745
   746     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   747         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   748             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   749         16  PB-C-CANCEL-ORIGIN           PIC X.
   750             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   751         16  PB-C-LF-CANCEL-DT            PIC XX.
   752         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   753         16  PB-C-LF-CALC-REQ             PIC X.
   754             88 PB-COMP-LF-CANCEL            VALUE '?'.
   755         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   756         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   757         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   758             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   759         16  PB-C-AH-CANCEL-DT            PIC XX.
   760         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   761         16  PB-C-AH-CALC-REQ             PIC X.
   762             88 PB-COMP-AH-CANCEL            VALUE '?'.
   763         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   764         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   765         16  PB-C-LAST-NAME               PIC X(15).
   766         16  PB-C-REFUND-SW               PIC X.
   767             88  PB-C-REFUND-CREATED          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  15
* NSAASBL.cbl
   768             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   769         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   770         16  PB-C-PAYEE-CODE              PIC X(6).
   771         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   772         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   773         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   774         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   775         16  PB-C-REFERENCE               PIC X(12).
   776         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   777         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   778         16  PB-C-POST-CARD-IND           PIC X.
   779         16  PB-C-CANCEL-REASON           PIC X.
   780         16  PB-C-REF-INTERFACE-SW        PIC X.
   781         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   782         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   783         16  FILLER                       PIC X(01).
   784*        16  FILLER                       PIC X(18).
   785         16  PB-C-POLICY-FORM-NO          PIC X(12).
   786*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   787         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
   788         16  PB-CANCELED-CERT-DATA.
   789             20  PB-CI-INSURED-NAME.
   790                 24  PB-CI-LAST-NAME      PIC X(15).
   791                 24  PB-CI-INITIALS       PIC XX.
   792             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   793             20  PB-CI-INSURED-SEX        PIC X.
   794             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   795             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   796             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   797             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   798             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   799             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   800             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   801             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   802             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   803             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   804             20  PB-CI-RATE-CLASS         PIC XX.
   805             20  PB-CI-RATE-DEV-LF        PIC XXX.
   806             20  PB-CI-RATE-DEV-AH        PIC XXX.
   807             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   808             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   809             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   810             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   811             20  PB-CI-LF-ABBR            PIC X(3).
   812             20  PB-CI-AH-ABBR            PIC X(3).
   813             20  PB-CI-OB-FLAG            PIC X.
   814                 88  PB-CI-OB                VALUE 'B'.
   815             20  PB-CI-LF-POLICY-STATUS   PIC X.
   816                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   817                                           'M' '4' '5' '9' '2'.
   818                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   819                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   820                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   821                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   822                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   823                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
   824                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   825                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  16
* NSAASBL.cbl
   826                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   827                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   828                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   829                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   830                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   831             20  PB-CI-AH-POLICY-STATUS   PIC X.
   832                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   833                                           'M' '4' '5' '9' '2'.
   834                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   835                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   836                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   837                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   838                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   839                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
   840                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   841                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   842                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   843                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   844                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   845                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   846                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   847             20  PB-CI-PAY-FREQUENCY      PIC 99.
   848             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   849             20  PB-CI-SOC-SEC-NO         PIC X(11).
   850             20  PB-CI-MEMBER-NO          PIC X(12).
   851             20  PB-CI-INT-CODE           PIC X.
   852                 88  PB-CI-ADD-ON                  VALUE 'A'.
   853                 88  PB-CI-SIMPLE                  VALUE 'S'.
   854             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   855             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   856             20  PB-CI-COMP-EXCP-SW       PIC X.
   857                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   858                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   859             20  PB-CI-ENTRY-STATUS       PIC X.
   860             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   861             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   862             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   863             20  PB-CI-DEATH-DT           PIC XX.
   864             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   865             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   866             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   867             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   868             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   869             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   870             20  PB-CI-ENTRY-DT              PIC XX.
   871             20  PB-CI-ENTRY-BATCH           PIC X(6).
   872             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   873             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   874             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   875             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   876             20  PB-CI-OLD-LOF               PIC XXX.
   877*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   878             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   879             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   880             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   881             20  PB-CI-INDV-GRP-CD           PIC X.
   882             20  PB-CI-BENEFICIARY-NAME.
   883                 24  PB-CI-BANK-NUMBER       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  17
* NSAASBL.cbl
   884                 24  FILLER                  PIC X(15).
   885             20  PB-CI-NOTE-SW               PIC X.
   886             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   887             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   888             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   889             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   890             20  PB-CI-LOAN-OFFICER          PIC X(5).
   891             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   892             20  PB-CI-FIRST-NAME            PIC X(10).
   893             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   894
   895         16  FILLER                       PIC X(13).
   896*032306  16  FILLER                       PIC X(27).
   897*        16  FILLER                       PIC X(46).
   898
   899     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   900         16  FILLER                       PIC X(10).
   901         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   902         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   903         16  PB-M-INSURED-MID-INIT        PIC X.
   904         16  PB-M-INSURED-AGE             PIC 99.
   905         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   906         16  PB-M-INSURED-SEX             PIC X.
   907         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   908         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   909         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   910         16  PB-M-INSURED-CITY-STATE.
   911             20  PB-M-INSURED-CITY        PIC X(28).
   912             20  PB-M-INSURED-STATE       PIC XX.
   913         16  PB-M-INSURED-ZIP-CODE.
   914             20  PB-M-INSURED-ZIP-PRIME.
   915                 24  PB-M-INSURED-ZIP-1   PIC X.
   916                     88  PB-M-CANADIAN-POST-CODE
   917                                             VALUE 'A' THRU 'Z'.
   918                 24  FILLER               PIC X(4).
   919             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   920         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   921                                        PB-M-INSURED-ZIP-CODE.
   922             20  PM-M-INS-CAN-POST1       PIC XXX.
   923             20  PM-M-INS-CAN-POST2       PIC XXX.
   924             20  FILLER                   PIC XXX.
   925         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   926         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   927         16  PB-M-CRED-BENE-NAME          PIC X(30).
   928         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   929         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   930         16  PB-M-CRED-BENE-CITYST.
   931             20  PB-M-CRED-BENE-CITY      PIC X(28).
   932             20  PB-M-CRED-BENE-STATE     PIC XX.
   933         16  FILLER                       PIC X(92).
   934
   935     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   936         16  FILLER                       PIC X(10).
   937         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   938         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   939         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   940         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   941         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  18
* NSAASBL.cbl
   942         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   943         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   944         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   945         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   946         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   947         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   948         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   949         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   950         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   951         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   952         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   953         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   954         16  PB-ACCOUNT-NAME              PIC X(30).
   955         16  PB-PREM-REF-RPT-FLAG         PIC X.
   956         16  PB-REFERENCE                 PIC X(12).
   957         16  PB-B-RECEIVED-DT             PIC XX.
   958         16  FILLER                       PIC X(234).
   959
   960     12  PB-RECORD-STATUS.
   961         16  PB-CREDIT-SELECT-DT          PIC XX.
   962         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   963         16  PB-BILLED-DT                 PIC XX.
   964         16  PB-BILLING-STATUS            PIC X.
   965             88  PB-ENTRY-REVERSED            VALUE 'R'.
   966             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   967             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   968         16  PB-RECORD-BILL               PIC X.
   969             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   970             88  PB-RECORD-RETURNED           VALUE 'R'.
   971             88  PB-RECORD-ENDORSED           VALUE 'E'.
   972             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   973             88  PB-OVERRIDE-AH               VALUE 'A'.
   974             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   975         16  PB-BATCH-ENTRY               PIC X.
   976             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   977             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   978             88  PB-REISSUED-CERT             VALUE 'E'.
   979             88  PB-CASH-CERT                 VALUE 'C'.
   980             88  PB-MONTHLY-CERT              VALUE 'M'.
   981             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   982             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   983             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   984         16  PB-FORCE-CODE                PIC X.
   985             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   986             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   987             88  PB-CANCEL-FORCE              VALUE '8'.
   988             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   989             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   990             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   991             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   992             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   993             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   994             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
   995             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   996         16  PB-FATAL-FLAG                PIC X.
   997             88  PB-FATAL-ERRORS              VALUE 'X'.
   998         16  PB-FORCE-ER-CD               PIC X.
   999             88  PB-FORCE-ERRORS              VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  19
* NSAASBL.cbl
  1000             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1001         16  PB-WARN-ER-CD                PIC X.
  1002             88  PB-WARNING-ERRORS            VALUE 'W'.
  1003         16  FILLER                       PIC X.
  1004         16  PB-OUT-BAL-CD                PIC X.
  1005             88  PB-OUT-OF-BAL                VALUE 'O'.
  1006         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1007         16  PB-AH-OVERRIDE-L1            PIC X.
  1008         16  PB-INPUT-DT                  PIC XX.
  1009         16  PB-INPUT-BY                  PIC X(4).
  1010         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1011         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1012         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1013         16  PB-LF-EARNING-METHOD         PIC X.
  1014         16  PB-AH-EARNING-METHOD         PIC X.
  1015         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1016         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1017         16  PB-REIN-CD                   PIC XXX.
  1018         16  PB-LF-REFUND-TYPE            PIC X.
  1019         16  PB-AH-REFUND-TYPE            PIC X.
  1020         16  PB-ACCT-EFF-DT               PIC XX.
  1021         16  PB-ACCT-EXP-DT               PIC XX.
  1022         16  PB-COMPANY-ID                PIC X(3).
  1023         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1024         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1025         16  PB-SV-CARRIER                PIC X.
  1026         16  PB-SV-GROUPING               PIC X(6).
  1027         16  PB-SV-STATE                  PIC XX.
  1028         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1029         16  PB-GA-BILLING-INFO.
  1030             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1031                                          PIC XX.
  1032         16  PB-SV-REMIT-TO  REDEFINES
  1033             PB-GA-BILLING-INFO           PIC X(10).
  1034         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1035         16  PB-I-LOAN-OFFICER            PIC X(5).
  1036         16  PB-I-VIN                     PIC X(17).
  1037
  1038         16  FILLER                       PIC X(04).
  1039         16  IMNET-BYPASS-SW              PIC X.
  1040
  1041******************************************************************
  1042*                COMMON EDIT ERRORS                              *
  1043******************************************************************
  1044
  1045     12  PB-COMMON-ERRORS.
  1046         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1047                                           PIC S9(4)     COMP.
  1048
  1049******************************************************************
  1050*                                COPY ERCARCH.
  1051******************************************************************
  1052*                                                                *
  1053*                            ERCARCH.                            *
  1054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1055*                            VMOD=2.002                          *
  1056*                                                                *
  1057*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  20
* NSAASBL.cbl
  1058*                                                                *
  1059*   FILE TYPE = VSAM,KSDS                                        *
  1060*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1061*                                                                *
  1062*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1063*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1064*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1065*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1066*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1067*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1068*                                                                *
  1069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1070******************************************************************
  1071*                   C H A N G E   L O G
  1072*
  1073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1074*-----------------------------------------------------------------
  1075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1076* EFFECTIVE    NUMBER
  1077*-----------------------------------------------------------------
  1078* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1079* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1080* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1081* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  1082******************************************************************
  1083 01  LETTER-ARCHIVE.
  1084     12  LA-RECORD-ID                PIC  X(02).
  1085         88  LA-VALID-ID                VALUE 'LA'.
  1086
  1087     12  LA-CONTROL-PRIMARY.
  1088         16  LA-COMPANY-CD           PIC  X(01).
  1089         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1090
  1091     12  LA-CONTROL-BY-CERT-RESP.
  1092         16  LA-COMPANY-CD-A2        PIC  X(01).
  1093         16  LA-CERT-NO-A2.
  1094             20  LA-CERT-PRIME-A2    PIC  X(10).
  1095             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1096         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1097             20  LA-RESP-PERSON-A2   PIC  X(10).
  1098             20  LA-TYPE-A2          PIC  X(01).
  1099         16  LA-CARRIER-A2           PIC  X(01).
  1100         16  LA-GROUPING-A2          PIC  X(06).
  1101         16  LA-STATE-A2             PIC  X(02).
  1102         16  LA-ACCOUNT-A2           PIC  X(10).
  1103         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1104         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1105
  1106     12  LA-CONTROL-BY-FORM.
  1107         16  LA-COMPANY-CD-A3        PIC  X(01).
  1108         16  LA-FORM-A3              PIC  X(04).
  1109         16  LA-CARRIER-A3           PIC  X(01).
  1110         16  LA-GROUPING-A3          PIC  X(06).
  1111         16  LA-STATE-A3             PIC  X(02).
  1112         16  LA-ACCOUNT-A3           PIC  X(10).
  1113         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1114
  1115     12  LA-CONTROL-BY-PROCESSOR.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  21
* NSAASBL.cbl
  1116         16  LA-COMPANY-CD-A4        PIC  X(01).
  1117         16  LA-PROCESSOR-CD         PIC  X(04).
  1118         16  LA-CARRIER-A4           PIC  X(01).
  1119         16  LA-GROUPING-A4          PIC  X(06).
  1120         16  LA-STATE-A4             PIC  X(02).
  1121         16  LA-ACCOUNT-A4           PIC  X(10).
  1122         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1123
  1124     12  LA-CONTROL-BY-KEY-FIELDS.
  1125         16  LA-COMPANY-CD-A5        PIC  X(01).
  1126         16  LA-CARRIER-A5           PIC  X(01).
  1127         16  LA-GROUPING-A5          PIC  X(06).
  1128         16  LA-STATE-A5             PIC  X(02).
  1129         16  LA-ACCOUNT-A5           PIC  X(10).
  1130         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1131
  1132     12  LA-CONTROL-BY-GROUP-CODE.
  1133         16  LA-COMPANY-CD-A6        PIC  X(01).
  1134         16  LA-ENTRY-A6.
  1135             20  LA-FILLER           PIC  X(02).
  1136             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1137         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1138
  1139     12  FILLER                      PIC  X(09).
  1140
  1141     12  LA-HEADER-RECORD.
  1142         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1143         16  LA-CREATION-DATE        PIC  X(02).
  1144         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1145         16  LA-FINAL-ACT-DATE       REDEFINES
  1146               LA-FOLLOW-UP-DATE     PIC  X(02).
  1147         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1148         16  LA-NO-OF-COPIES         PIC S9(01).
  1149         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1150         16  LA-REPLY-DATE           PIC  X(02).
  1151         16  LA-RESEND-DATES.
  1152             20  LA-RESEND-DATE      PIC  X(02).
  1153             20  LA-SENT-DATE        PIC  X(02).
  1154             20  FILLER              PIC  X(08).
  1155         16  LA-SOURCE-INFORMATION.
  1156             20  LA-DATA-SOURCE      PIC  X(01).
  1157             20  LA-ADDR-SOURCE      PIC  X(01).
  1158         16  LA-STATUS               PIC  X(01).
  1159             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1160             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1161             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1162             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1163             88  LA-STATUS-PURGED         VALUE 'P'.
  1164             88  LA-STATUS-VOIDED         VALUE 'V'.
  1165         16  LA-LAST-RESENT-PRINT-DATE
  1166                                     PIC  X(02).
  1167         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1168             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1169                                          VALUE 'C'.
  1170             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1171                                          VALUE 'F'.
  1172             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1173                                          VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  22
* NSAASBL.cbl
  1174         16  LA-PURGED-DATE          PIC  X(02).
  1175         16  LA-VOIDED-DATE          PIC  X(02).
  1176         16  LA-RESEND-LETR          PIC  X(4).
  1177         16  LA-VOID-ONBASE-YN       PIC  X.
  1178         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  1179         16  FILLER                  PIC  X(04).
  1180*        16  LA-RESEND-LETR-2        PIC  X(4).
  1181*        16  LA-RESEND-LETR-3        PIC  X(4).
  1182*        16  FILLER                  PIC  X(59).
  1183         16  LA-ARCHIVE-STATUS       PIC  X.
  1184             88  LA-TEMP                VALUE 'T'.
  1185             88  LA-QWS                 VALUE 'Q'.
  1186             88  LA-BATCH               VALUE 'B'.
  1187         16  LA-FINAL-ACT-IND        PIC  X(1).
  1188         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1189         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  1190         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  1191                                     PIC X(4).
  1192         16  FILLER                  PIC  X(42).
  1193*        16  FILLER                  PIC  X(71).
  1194         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1195         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1196         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1197                                     PIC  X(4).
  1198         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1199
  1200******************************************************************
  1201*                                COPY ERCENDT.
  1202******************************************************************
  1203*                                                                *
  1204*                                                                *
  1205*                            ERCENDT.                            *
  1206*                            VMOD=2.001                          *
  1207*                                                                *
  1208*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1209*                                                                *
  1210*   FILE TYPE = VSAM,KSDS                                        *
  1211*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1212*                                                                *
  1213*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1214*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1215*                                                                *
  1216*   LOG = NO                                                     *
  1217*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1218******************************************************************
  1219*-----------------------------------------------------------------
  1220*                   C H A N G E   L O G
  1221*
  1222* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1223*-----------------------------------------------------------------
  1224*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1225* EFFECTIVE    NUMBER
  1226*-----------------------------------------------------------------
  1227* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1228*                                WITH OPEN CLAIMS
  1229* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1230* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1231* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  23
* NSAASBL.cbl
  1232* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1233*-----------------------------------------------------------------
  1234 01  ENDORSEMENT-RECORD.
  1235     12  EN-RECORD-ID                PIC XX.
  1236         88  VALID-EN-ID                VALUE 'EN'.
  1237     12  EN-CONTROL-PRIMARY.
  1238         16  EN-COMPANY-CD           PIC X.
  1239         16  EN-CARRIER              PIC X.
  1240         16  EN-GROUPING             PIC X(6).
  1241         16  EN-STATE                PIC XX.
  1242         16  EN-ACCOUNT              PIC X(10).
  1243         16  EN-CERT-EFF-DT          PIC XX.
  1244         16  EN-CERT-NO.
  1245             20  EN-CERT-PRIME       PIC X(10).
  1246             20  EN-CERT-SFX         PIC X.
  1247         16  EN-REC-TYPE             PIC X.
  1248             88  EN-ISSUE               VALUE 'I'.
  1249             88  EN-CANCELLATION        VALUE 'C'.
  1250         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1251     12  EN-CONTROL-BY-ARCH-NO.
  1252         16  EN-COMPANY-CD-A1              PIC X.
  1253         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1254     12  EN-LAST-MAINT-DT            PIC XX.
  1255     12  EN-LAST-MAINT-BY            PIC X(4).
  1256     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1257     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1258     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1259         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1260         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1261         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1262         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1263         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1264         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1265         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1266         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1267         16  EN-LF-ORIG-BENCD        PIC XX.
  1268         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1269         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1270         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1271         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1272         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1273         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1274*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1275         16  EN-ORIG-CRED-BENE       PIC X(25).
  1276         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1277         16  FILLER                  PIC X.
  1278         16  EN-AH-ORIG-BENCD        PIC XX.
  1279         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1280         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1281         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1282         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1283*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1284*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1285         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1286         16  F                       PIC X(09).
  1287         16  EN-AH-ORIG-CP           PIC 99.
  1288         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1289         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  24
* NSAASBL.cbl
  1290         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1291         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1292         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1293         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1294         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1295         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1296         16  EN-LF-NEW-BENCD         PIC XX.
  1297         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1298         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1299         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1300         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1301         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1302         16  EN-LF-NEW-EXP-DT        PIC XX.
  1303         16  EN-NEW-CRED-BENE        PIC X(25).
  1304         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1305         16  FILLER                  PIC X.
  1306         16  EN-AH-NEW-BENCD         PIC XX.
  1307         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1308         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1309         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1310         16  EN-AH-NEW-EXP-DT        PIC XX.
  1311*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1312*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1313*        16  F                       PIC X(12).
  1314         16  EN-AH-NEW-CP            PIC 99.
  1315         16  EN-SIG-SW               PIC X.
  1316         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1317         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1318         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1319         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1320         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1321         16  FILLER                  PIC X(33).
  1322     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1323         16  EN-LF-ORIG-REF-DT       PIC XX.
  1324         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1325         16  EN-AH-ORIG-REF-DT       PIC XX.
  1326         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1327         16  EN-LF-NEW-REF-DT        PIC XX.
  1328         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1329         16  EN-AH-NEW-REF-DT        PIC XX.
  1330         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1331         16  EN-FLAG-CERT            PIC X.
  1332         16  EN-INS-LAST-NAME        PIC X(15).
  1333         16  EN-INS-FIRST-NAME       PIC X(10).
  1334         16  EN-INS-MIDDLE-INIT      PIC X.
  1335         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1336         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1337         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1338         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1339         16  FILLER                  PIC X(262).
  1340     12  EN-MONEY-SW             PIC X.
  1341     12  EN-HEALTH-APP           PIC X.
  1342     12  EN-VOUCHER-SW           PIC X.
  1343     12  EN-PAYEE                PIC X(14).
  1344     12  EN-INPUT-DT             PIC XX.
  1345     12  EN-PROCESS-DT           PIC XX.
  1346     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1347     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  25
* NSAASBL.cbl
  1348     12  EN-REASON-CODES.
  1349         16  F OCCURS 12.
  1350             20  EN-REASON-CODE  PIC X(4).
  1351     12  EN-TEMPLATE-USED        PIC X(8).
  1352     12  EN-DOCU-TYPE            PIC X.
  1353         88  EN-VERI-DOCU          VALUE 'V'.
  1354         88  EN-GCE-DOCU           VALUE 'G'.
  1355         88  EN-CANC-DOCU          VALUE 'C'.
  1356     12  EN-COMMENTS1            PIC X(13).
  1357     12  EN-COMMENTS2            PIC X(70).
  1358     12  EN-COMM-CHGBK           PIC X.
  1359         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1360         88  EN-CHG-ACCT           VALUE 'Y'.
  1361     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1362     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1363     12  EN-BATCH-NUMBER         PIC X(6).
  1364     12  EN-ACCT-SUMM            PIC X.
  1365     12  EN-CSO-SUMM             PIC X.
  1366     12  en-check-type           pic x.
  1367     12  FILLER                  PIC X(12).
  1368******************************************************************
  1369*                                COPY NSCASEXTR.
  1370******************************************************************
  1371*                                                                *
  1372*                                                                *
  1373*                            NSCASEXTR.                          *
  1374*                            VMOD=2.001                          *
  1375*                                                                *
  1376*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
  1377*                                                                *
  1378*   FILE TYPE = VSAM,KSDS                                        *
  1379*   RECORD SIZE = 4500 RECFORM = FIXED                           *
  1380*                                                                *
  1381*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
  1382*                                                                *
  1383*   LOG = NO                                                     *
  1384*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1385******************************************************************
  1386*-----------------------------------------------------------------
  1387*                   C H A N G E   L O G
  1388*
  1389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1390*-----------------------------------------------------------------
  1391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1392* EFFECTIVE    NUMBER
  1393*-----------------------------------------------------------------
  1394* 072211    2011022800001  PEMA  NEW FILE
  1395*-----------------------------------------------------------------
  1396 01 NSAS-EXTRACT-RECORD.
  1397    05  NSAS-CONTROL-PRIMARY.
  1398        10  NSAS-COMPANY-CD      PIC X.
  1399        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
  1400        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
  1401    05  NSAS-LETTER-VARIABLES    PIC X(4350).
  1402    05  FILLER                   PIC X(143).
  1403*                                COPY ERCNOTE.
  1404******************************************************************
  1405*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  26
* NSAASBL.cbl
  1406*                                                                *
  1407*                            ERCNOTE                             *
  1408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1409*                            VMOD=2.003                          *
  1410*                                                                *
  1411*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  1412*                                                                *
  1413*        FILE TYPE= VSAM,KSDS                                    *
  1414*        RECORD SIZE = 825    RECFORM = FIXED                    *
  1415*                                                                *
  1416*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  1417*                                                                *
  1418*        LOG = YES                                               *
  1419*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1420*                                                                *
  1421******************************************************************
  1422*                   C H A N G E   L O G
  1423*
  1424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1425*-----------------------------------------------------------------
  1426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1427* EFFECTIVE    NUMBER
  1428*-----------------------------------------------------------------
  1429* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  1430*                                FILE WILL CONTAIN BILLING NOTES O
  1431* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  1432******************************************************************
  1433
  1434 01  CERTIFICATE-NOTE.
  1435     12  CN-RECORD-ID                PIC  XX.
  1436         88  VALID-CN-ID                  VALUE 'CN'.
  1437
  1438     12  CN-CONTROL-PRIMARY.
  1439         16  CN-COMPANY-CD           PIC X.
  1440         16  CN-CARRIER              PIC X.
  1441         16  CN-GROUPING.
  1442             20 CN-GROUPING-PREFIX   PIC XXX.
  1443             20 CN-GROUPING-PRIME    PIC XXX.
  1444         16  CN-STATE                PIC XX.
  1445         16  CN-ACCOUNT.
  1446             20 CN-ACCOUNT-PREFIX    PIC X(4).
  1447             20 CN-ACCOUNT-PRIME     PIC X(6).
  1448         16  CN-CERT-EFF-DT          PIC XX.
  1449         16  CN-CERT-NO.
  1450             20  CN-CERT-PRIME       PIC X(10).
  1451             20  CN-CERT-SFX         PIC X.
  1452         16  CN-RECORD-TYPE          PIC X.
  1453             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  1454             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  1455     12  CN-BILLING-START-LINE-NO    PIC 99.
  1456     12  CN-BILLING-END-LINE-NO      PIC 99.
  1457
  1458     12  CN-LINES.
  1459         16  CN-LINE OCCURS 10       PIC X(77).
  1460
  1461     12  CN-LAST-MAINT-DT            PIC XX.
  1462     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1463     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  27
* NSAASBL.cbl
  1464     12  FILLER                      PIC X(5).
  1465******************************************************************
  1466*                                COPY ELCEOBC.
  1467******************************************************************
  1468*                                                                *
  1469*                                                                *
  1470*                            ELCEOBC                             *
  1471*                            VMOD=2.001                          *
  1472*                                                                *
  1473*   CLAIM SYSTEM EOB CODE TABLE                                  *
  1474*                                                                *
  1475*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1476*   VSAM EOB CODE TABLE                                          *
  1477*                                                                *
  1478*   FILE DESCRIPTION = EOB CODE TABLE                            *
  1479*                                                                *
  1480*   FILE TYPE = VSAM,KSDS                                        *
  1481*   RECORD SIZE = 350   RECFORM = FIX                            *
  1482*                                                                *
  1483*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  1484*                                                                *
  1485*   LOG = NO                                                     *
  1486*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1487*                                                                *
  1488*                                                                *
  1489******************************************************************
  1490*                   C H A N G E   L O G
  1491*
  1492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1493*-----------------------------------------------------------------
  1494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1495* EFFECTIVE    NUMBER
  1496*-----------------------------------------------------------------
  1497* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  1498* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  1499* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  1500******************************************************************
  1501 01  EOB-CODES.
  1502     12  EO-RECORD-ID                      PIC XX.
  1503         88  VALID-DN-ID                      VALUE 'EO'.
  1504     12  EO-CONTROL-PRIMARY.
  1505         16  EO-COMPANY-CD                 PIC X.
  1506         16  EO-RECORD-TYPE                PIC X.
  1507             88  EO-EOB-RECS                  VALUE '1'.
  1508             88  EO-VERIF-RECS                VALUE '2'.
  1509             88  EO-GCE-RECS                  VALUE '3'.
  1510             88  EO-CANC-RECS                 VALUE '4'.
  1511             88  EO-BILL-NOTE-RECS            VALUE '5'.
  1512         16  EO-EOB-CODE                   PIC X(4).
  1513         16  FILLER                        PIC X(9).
  1514     12  EO-MAINT-INFORMATION.
  1515         16  EO-LAST-MAINT-DT              PIC XX.
  1516         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1517         16  EO-LAST-MAINT-USER            PIC X(4).
  1518         16  FILLER                        PIC XX.
  1519     12  EO-DESCRIPTION                    PIC X(275).
  1520     12  FILLER                            PIC X(46).
  1521******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  28
* NSAASBL.cbl
  1522*                                COPY ELCCERT.
  1523******************************************************************
  1524*                                                                *
  1525*                            ELCCERT.                            *
  1526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1527*                            VMOD=2.013                          *
  1528*                                                                *
  1529*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1530*                                                                *
  1531*   FILE TYPE = VSAM,KSDS                                        *
  1532*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1533*                                                                *
  1534*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1535*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1536*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1537*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1538*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1539*                                                                *
  1540*   LOG = YES                                                    *
  1541*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1542******************************************************************
  1543*                   C H A N G E   L O G
  1544*
  1545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1546*-----------------------------------------------------------------
  1547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1548* EFFECTIVE    NUMBER
  1549*-----------------------------------------------------------------
  1550* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1551* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1552* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1553* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1554* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1555* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1556* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1557* 032612  CR2011110200001  PEMA  AHL CHANGES
  1558* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1559* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1560* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1561******************************************************************
  1562
  1563 01  CERTIFICATE-MASTER.
  1564     12  CM-RECORD-ID                      PIC XX.
  1565         88  VALID-CM-ID                      VALUE 'CM'.
  1566
  1567     12  CM-CONTROL-PRIMARY.
  1568         16  CM-COMPANY-CD                 PIC X.
  1569         16  CM-CARRIER                    PIC X.
  1570         16  CM-GROUPING.
  1571             20  CM-GROUPING-PREFIX        PIC X(3).
  1572             20  CM-GROUPING-PRIME         PIC X(3).
  1573         16  CM-STATE                      PIC XX.
  1574         16  CM-ACCOUNT.
  1575             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1576             20  CM-ACCOUNT-PRIME          PIC X(6).
  1577         16  CM-CERT-EFF-DT                PIC XX.
  1578         16  CM-CERT-NO.
  1579             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  29
* NSAASBL.cbl
  1580             20  CM-CERT-SFX               PIC X.
  1581
  1582     12  CM-CONTROL-BY-NAME.
  1583         16  CM-COMPANY-CD-A1              PIC X.
  1584         16  CM-INSURED-LAST-NAME          PIC X(15).
  1585         16  CM-INSURED-INITIALS.
  1586             20  CM-INSURED-INITIAL1       PIC X.
  1587             20  CM-INSURED-INITIAL2       PIC X.
  1588
  1589     12  CM-CONTROL-BY-SSN.
  1590         16  CM-COMPANY-CD-A2              PIC X.
  1591         16  CM-SOC-SEC-NO.
  1592             20  CM-SSN-STATE              PIC XX.
  1593             20  CM-SSN-ACCOUNT            PIC X(6).
  1594             20  CM-SSN-LN3.
  1595                 25  CM-INSURED-INITIALS-A2.
  1596                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1597                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1598                 25 CM-PART-LAST-NAME-A2         PIC X.
  1599
  1600     12  CM-CONTROL-BY-CERT-NO.
  1601         16  CM-COMPANY-CD-A4              PIC X.
  1602         16  CM-CERT-NO-A4                 PIC X(11).
  1603
  1604     12  CM-CONTROL-BY-MEMB.
  1605         16  CM-COMPANY-CD-A5              PIC X.
  1606         16  CM-MEMBER-NO.
  1607             20  CM-MEMB-STATE             PIC XX.
  1608             20  CM-MEMB-ACCOUNT           PIC X(6).
  1609             20  CM-MEMB-LN4.
  1610                 25  CM-INSURED-INITIALS-A5.
  1611                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1612                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1613                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1614
  1615     12  CM-INSURED-PROFILE-DATA.
  1616         16  CM-INSURED-FIRST-NAME.
  1617             20  CM-INSURED-1ST-INIT       PIC X.
  1618             20  FILLER                    PIC X(9).
  1619         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1620         16  CM-INSURED-SEX                PIC X.
  1621             88  CM-SEX-MALE                  VALUE 'M'.
  1622             88  CM-SEX-FEMAL                 VALUE 'F'.
  1623         16  CM-INSURED-JOINT-AGE          PIC 99.
  1624         16  CM-JOINT-INSURED-NAME.
  1625             20  CM-JT-LAST-NAME           PIC X(15).
  1626             20  CM-JT-FIRST-NAME.
  1627                 24  CM-JT-1ST-INIT        PIC X.
  1628                 24  FILLER                PIC X(9).
  1629             20  CM-JT-INITIAL             PIC X.
  1630
  1631     12  CM-LIFE-DATA.
  1632         16  CM-LF-BENEFIT-CD              PIC XX.
  1633         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1634         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1635         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1636         16  CM-LF-DEV-CODE                PIC XXX.
  1637         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  30
* NSAASBL.cbl
  1638         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1639         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1640         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1641         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1642         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1643         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1644         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1645         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1646         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1647         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1648         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1649         16  cm-temp-epiq                  pic xx.
  1650             88  EPIQ-CLASS                  value 'EQ'.
  1651*        16  FILLER                        PIC XX.
  1652
  1653     12  CM-AH-DATA.
  1654         16  CM-AH-BENEFIT-CD              PIC XX.
  1655         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1656         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1657         16  CM-AH-DEV-CODE                PIC XXX.
  1658         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1659         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1660         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1661         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1662         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1663         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1664         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1665         16  CM-AH-PAID-THRU-DT            PIC XX.
  1666             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1667         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1668         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1669         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1670         16  FILLER                        PIC X.
  1671
  1672     12  CM-LOAN-INFORMATION.
  1673         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1674         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1675                                           PIC S9(5)V99  COMP-3.
  1676         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1677         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1678         16  CM-PAY-FREQUENCY              PIC S99.
  1679         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1680         16  CM-RATE-CLASS                 PIC XX.
  1681         16  CM-BENEFICIARY                PIC X(25).
  1682         16  CM-POLICY-FORM-NO             PIC X(12).
  1683         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1684         16  CM-LAST-ADD-ON-DT             PIC XX.
  1685         16  CM-DEDUCTIBLE-AMOUNTS.
  1686             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1687             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1688         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1689             20  CM-RESIDENT-STATE         PIC XX.
  1690             20  CM-RATE-CODE              PIC X(4).
  1691             20  FILLER                    PIC XX.
  1692         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1693             20  CM-LOAN-OFFICER           PIC X(5).
  1694             20  FILLER                    PIC XXX.
  1695         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  31
* NSAASBL.cbl
  1696         16  CM-UNDERWRITING-CODE          PIC X.
  1697             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1698         16  CM-POST-CARD-IND              PIC X.
  1699         16  CM-REF-INTERFACE-SW           PIC X.
  1700         16  CM-PREMIUM-TYPE               PIC X.
  1701             88  CM-SING-PRM                  VALUE '1'.
  1702             88  CM-O-B-COVERAGE              VALUE '2'.
  1703             88  CM-OPEN-END                  VALUE '3'.
  1704         16  CM-IND-GRP-TYPE               PIC X.
  1705             88  CM-INDIVIDUAL                VALUE 'I'.
  1706             88  CM-GROUP                     VALUE 'G'.
  1707         16  CM-SKIP-CODE                  PIC X.
  1708             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1709             88  SKIP-JULY                    VALUE '1'.
  1710             88  SKIP-AUGUST                  VALUE '2'.
  1711             88  SKIP-SEPTEMBER               VALUE '3'.
  1712             88  SKIP-JULY-AUG                VALUE '4'.
  1713             88  SKIP-AUG-SEPT                VALUE '5'.
  1714             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1715             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1716             88  SKIP-JUNE                    VALUE '8'.
  1717             88  SKIP-JUNE-JULY               VALUE '9'.
  1718             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1719             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1720         16  CM-PAYMENT-MODE               PIC X.
  1721             88  PAY-MONTHLY                  VALUE SPACE.
  1722             88  PAY-WEEKLY                   VALUE '1'.
  1723             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1724             88  PAY-BI-WEEKLY                VALUE '3'.
  1725             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1726         16  CM-LOAN-NUMBER                PIC X(8).
  1727         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1728         16  CM-OLD-LOF                    PIC XXX.
  1729*        16  CM-LOAN-OFFICER               PIC XXX.
  1730         16  CM-REIN-TABLE                 PIC XXX.
  1731         16  CM-SPECIAL-REIN-CODE          PIC X.
  1732         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1733         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1734         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1735
  1736     12  CM-STATUS-DATA.
  1737         16  CM-ENTRY-STATUS               PIC X.
  1738         16  CM-ENTRY-DT                   PIC XX.
  1739
  1740         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1741         16  CM-LF-CANCEL-DT               PIC XX.
  1742         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1743
  1744         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1745         16  CM-LF-DEATH-DT                PIC XX.
  1746         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1747
  1748         16  CM-LF-CURRENT-STATUS          PIC X.
  1749             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1750                                                'M' '4' '5' '9'.
  1751             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1752             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1753             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  32
* NSAASBL.cbl
  1754             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1755             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1756             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1757             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1758             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1759             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1760             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1761             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1762             88  CM-LF-DECLINED               VALUE 'D'.
  1763             88  CM-LF-VOIDED                 VALUE 'V'.
  1764
  1765         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1766         16  CM-AH-CANCEL-DT               PIC XX.
  1767         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1768
  1769         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1770         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1771         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1772
  1773         16  CM-AH-CURRENT-STATUS          PIC X.
  1774             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1775                                                'M' '4' '5' '9'.
  1776             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1777             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1778             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1779             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1780             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1781             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1782             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1783             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1784             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1785             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1786             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1787             88  CM-AH-DECLINED               VALUE 'D'.
  1788             88  CM-AH-VOIDED                 VALUE 'V'.
  1789
  1790         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1791             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1792             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1793             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1794         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1795
  1796         16  CM-ENTRY-BATCH                PIC X(6).
  1797         16  CM-LF-EXIT-BATCH              PIC X(6).
  1798         16  CM-AH-EXIT-BATCH              PIC X(6).
  1799         16  CM-LAST-MONTH-END             PIC XX.
  1800
  1801     12  CM-NOTE-SW                        PIC X.
  1802         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1803         88  CERT-NOTES-PRESENT               VALUE '1'.
  1804         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1805         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1806         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1807         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1808         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1809         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1810     12  CM-COMP-EXCP-SW                   PIC X.
  1811         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  33
* NSAASBL.cbl
  1812         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1813     12  CM-INSURED-ADDRESS-SW             PIC X.
  1814         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1815         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1816
  1817*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1818     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1819     12  FILLER                            PIC X.
  1820
  1821*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1822     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1823     12  FILLER                            PIC X.
  1824*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1825     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1826
  1827     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1828         88  CERT-ADDED-BATCH                 VALUE ' '.
  1829         88  CERT-ADDED-ONLINE                VALUE '1'.
  1830         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1831         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1832         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1833     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1834         88  CERT-AS-LOADED                   VALUE ' '.
  1835         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1836         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1837         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1838         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1839         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1840         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1841         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1842
  1843     12  CM-ACCOUNT-COMM-PCTS.
  1844         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1845         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1846
  1847     12  CM-USER-FIELD                     PIC X.
  1848     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1849     12  CM-CLP-STATE                      PIC XX.
  1850     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1851     12  CM-USER-RESERVED                  PIC XXX.
  1852     12  FILLER REDEFINES CM-USER-RESERVED.
  1853         16  CM-AH-CLASS-CD                PIC XX.
  1854         16  F                             PIC X.
  1855******************************************************************
  1856****************************************************************
  1857*
  1858* Copyright (c) 2007-2013 Dell Inc.
  1859* All rights reserved.
  1860*
  1861****************************************************************
  1862 01  DFHEIV.
  1863   02  DFHEIV0               PIC X(35).
  1864   02  DFHEIV1               PIC X(08).
  1865   02  DFHEIV2               PIC X(08).
  1866   02  DFHEIV3               PIC X(08).
  1867   02  DFHEIV4               PIC X(06).
  1868   02  DFHEIV5               PIC X(04).
  1869   02  DFHEIV6               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  34
* NSAASBL.cbl
  1870   02  DFHEIV7               PIC X(02).
  1871   02  DFHEIV8               PIC X(02).
  1872   02  DFHEIV9               PIC X(01).
  1873   02  DFHEIV10              PIC S9(7) COMP-3.
  1874   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1875   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1876   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1877   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1878   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1879   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1880   02  DFHEIV17              PIC X(04).
  1881   02  DFHEIV18              PIC X(04).
  1882   02  DFHEIV19              PIC X(04).
  1883   02  DFHEIV20              USAGE IS POINTER.
  1884   02  DFHEIV21              USAGE IS POINTER.
  1885   02  DFHEIV22              USAGE IS POINTER.
  1886   02  DFHEIV23              USAGE IS POINTER.
  1887   02  DFHEIV24              USAGE IS POINTER.
  1888   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1889   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1890   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1891   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1892   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1893   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1894   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1895   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1896   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1897   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1898   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1899   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1900   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1901   02  FILLER                PIC X(02).
  1902   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1903   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1904   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1905   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1906   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1907   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1908   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1909 LINKAGE  SECTION.
  1910*****************************************************************
  1911*                                                               *
  1912* Copyright (c) 2007-2013 Dell Inc.                             *
  1913* All rights reserved.                                          *
  1914*                                                               *
  1915*****************************************************************
  1916 01  dfheiblk.
  1917     02  eibtime          pic s9(7) comp-3.
  1918     02  eibdate          pic s9(7) comp-3.
  1919     02  eibtrnid         pic x(4).
  1920     02  eibtaskn         pic s9(7) comp-3.
  1921     02  eibtrmid         pic x(4).
  1922     02  dfheigdi         pic s9(4) comp.
  1923     02  eibcposn         pic s9(4) comp.
  1924     02  eibcalen         pic s9(4) comp.
  1925     02  eibaid           pic x(1).
  1926     02  eibfiller1       pic x(1).
  1927     02  eibfn            pic x(2).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  35
* NSAASBL.cbl
  1928     02  eibfiller2       pic x(2).
  1929     02  eibrcode         pic x(6).
  1930     02  eibfiller3       pic x(2).
  1931     02  eibds            pic x(8).
  1932     02  eibreqid         pic x(8).
  1933     02  eibrsrce         pic x(8).
  1934     02  eibsync          pic x(1).
  1935     02  eibfree          pic x(1).
  1936     02  eibrecv          pic x(1).
  1937     02  eibsend          pic x(1).
  1938     02  eibatt           pic x(1).
  1939     02  eibeoc           pic x(1).
  1940     02  eibfmh           pic x(1).
  1941     02  eibcompl         pic x(1).
  1942     02  eibsig           pic x(1).
  1943     02  eibconf          pic x(1).
  1944     02  eiberr           pic x(1).
  1945     02  eibrldbk         pic x(1).
  1946     02  eiberrcd         pic x(4).
  1947     02  eibsynrb         pic x(1).
  1948     02  eibnodat         pic x(1).
  1949     02  eibfiller5       pic x(2).
  1950     02  eibresp          pic s9(8) comp.
  1951     02  eibresp2         pic s9(8) comp.
  1952     02  dfheigdj         pic s9(4) comp.
  1953     02  dfheigdk         pic s9(4) comp.
  1954 01 dfhcommarea                  pic x(218).
  1955 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1956 0000-DFHEXIT SECTION.
  1957     MOVE '9#                    $   ' TO DFHEIV0.
  1958     MOVE 'NSAASBL' TO DFHEIV1.
  1959     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1960     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1961     MOVE '5'                    TO DC-OPTION-CODE
  1962     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1963     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  1964     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  1965     MOVE DFHCOMMAREA            TO BL-INPUT
  1966*****************************************************
  1967* Using the information passed to this program,
  1968* it will update the erarch record with a "Q"
  1969* in the status field
  1970*****************************************************
  1971*    DISPLAY ' BL INPUT ' BL-INPUT
  1972     evaluate bl-comp-id
  1973        when 'DCC'
  1974           move X'05'            to ws-erarch-company-cd
  1975        when 'AHL'
  1976           move X'06'            to ws-erarch-company-cd
  1977        when 'VPP'
  1978           move X'07'            to ws-erarch-company-cd
  1979        when other
  1980           move X'04'            to ws-erarch-company-cd
  1981     end-evaluate
  1982     MOVE WS-ERARCH-COMPANY-CD   TO WS-ERENDT-COMPANY-CD
  1983                                    WS-EXTR-COMPANY-CD
  1984                                    ws-erpndb-company-cd
  1985     MOVE BL-ARCHIVE-NO          TO WS-ERARCH-ARCH-NO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  36
* NSAASBL.cbl
  1986                                    WS-ERENDT-ARCH-NO
  1987                                    WS-EXTR-ARCH-NO
  1988     SET BL-FAIL TO TRUE
  1989
  1990* EXEC CICS READ
  1991*         DATASET    ('ERARCH')
  1992*         INTO       (LETTER-ARCHIVE)
  1993*         RIDFLD     (WS-ERARCH-KEY)
  1994*         UPDATE
  1995*         RESP       (WS-RESPONSE)
  1996*    END-EXEC
  1997     MOVE LENGTH OF
  1998      LETTER-ARCHIVE
  1999       TO DFHEIV11
  2000     MOVE 'ERARCH' TO DFHEIV1
  2001*    MOVE '&"IL       EU         (  N#00001986' TO DFHEIV0
  2002     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2003     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2004     MOVE X'204E233030303031393836' TO DFHEIV0(25:11)
  2005     CALL 'kxdfhei1' USING DFHEIV0,
  2006           DFHEIV1,
  2007           LETTER-ARCHIVE,
  2008           DFHEIV11,
  2009           WS-ERARCH-KEY,
  2010           DFHEIV99,
  2011           DFHEIV99,
  2012           DFHEIV99
  2013     MOVE EIBRESP  TO WS-RESPONSE
  2014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2015     IF RESP-NORMAL
  2016        SET BL-OK TO TRUE
  2017        IF (BL-PRINT-NOW-SW = 'P')
  2018           or (bl-process-type = 'cancel')
  2019           PERFORM 0050-DELETE-RECORDS
  2020                                 THRU 0050-EXIT
  2021        ELSE
  2022           IF BL-PROCESS-TYPE = 'process'
  2023              MOVE LA-COMPANY-CD-A2 TO WS-SV-COMPANY-CD
  2024              MOVE LA-CARRIER-A2    TO WS-SV-CARRIER
  2025              MOVE LA-GROUPING-A2   TO WS-SV-GROUPING
  2026              MOVE LA-STATE-A2      TO WS-SV-STATE
  2027              MOVE LA-ACCOUNT-A2    TO WS-SV-ACCOUNT
  2028              MOVE LA-EFFECT-DATE-A2 TO WS-SV-CERT-EFF-DT
  2029              MOVE LA-CERT-PRIME-A2 TO WS-SV-CERT-PRIME
  2030              MOVE LA-CERT-SUFFIX-A2 TO WS-SV-CERT-SFX
  2031              MOVE LA-FORM-A3       TO WS-SV-LETTER-ID
  2032              MOVE LA-PROCESSOR-CD  TO WS-SV-PROC-ID
  2033              MOVE 'Q'           TO LA-ARCHIVE-STATUS
  2034              IF BL-PRINT-NOW-SW = 'Y'
  2035                 MOVE SAVE-BIN-DATE TO LA-INITIAL-PRINT-DATE
  2036                 IF (LA-RESEND-DATE EQUAL LOW-VALUES OR SPACES)
  2037                  AND (LA-FOLLOW-UP-DATE EQUAL
  2038                                 LOW-VALUES OR SPACES)
  2039                    MOVE 'C'             TO LA-STATUS
  2040                 END-IF
  2041              END-IF
  2042           ELSE
  2043              MOVE 'T'           TO LA-ARCHIVE-STATUS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  37
* NSAASBL.cbl
  2044           END-IF
  2045        END-IF
  2046
  2047* EXEC CICS REWRITE
  2048*          FROM      (LETTER-ARCHIVE)
  2049*          DATASET   ('ERARCH')
  2050*          RESP       (WS-RESPONSE)
  2051*       END-EXEC
  2052     MOVE LENGTH OF
  2053      LETTER-ARCHIVE
  2054       TO DFHEIV11
  2055     MOVE 'ERARCH' TO DFHEIV1
  2056*    MOVE '&& L                  %  N#00002024' TO DFHEIV0
  2057     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2058     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2059     MOVE X'204E233030303032303234' TO DFHEIV0(25:11)
  2060     CALL 'kxdfhei1' USING DFHEIV0,
  2061           DFHEIV1,
  2062           LETTER-ARCHIVE,
  2063           DFHEIV11,
  2064           DFHEIV99
  2065     MOVE EIBRESP  TO WS-RESPONSE
  2066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2067        IF BL-PROCESS-TYPE = 'process'
  2068           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  2069        END-IF
  2070     ELSE
  2071        MOVE ' BAD READ UPDATE ON ERARCH '
  2072                                 TO BL-MESSAGE
  2073        display ' bad read on erarch ' ws-response
  2074          ' ' bl-archive-no
  2075     END-IF
  2076     MOVE BL-INPUT               TO DFHCOMMAREA
  2077
  2078* exec cics return end-exec.
  2079*    MOVE '.(                    ''   #00002039' TO DFHEIV0
  2080     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2081     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2082     MOVE X'2020233030303032303339' TO DFHEIV0(25:11)
  2083     CALL 'kxdfhei1' USING DFHEIV0,
  2084           DFHEIV99,
  2085           DFHEIV99,
  2086           DFHEIV99,
  2087           DFHEIV99,
  2088           DFHEIV99,
  2089           DFHEIV99
  2090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2091
  2092 0050-DELETE-RECORDS.
  2093     DISPLAY ' ABOUT TO DELETE RECS ' BL-ARCHIVE-NO ' ' BL-FUNC
  2094     IF BL-FUNC = 'ClmResc' or 'ClmRefo'
  2095        display ' bypass delete ' bl-func
  2096        go to 0050-exit
  2097     end-if
  2098
  2099* EXEC CICS DELETE
  2100*       DATASET    ('ERARCH')
  2101*       RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  38
* NSAASBL.cbl
  2102*    END-EXEC
  2103     MOVE 'ERARCH' TO DFHEIV1
  2104*    MOVE '&(                    &  N#00002046' TO DFHEIV0
  2105     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2106     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2107     MOVE X'204E233030303032303436' TO DFHEIV0(25:11)
  2108     CALL 'kxdfhei1' USING DFHEIV0,
  2109           DFHEIV1,
  2110           DFHEIV99,
  2111           DFHEIV99,
  2112           DFHEIV99,
  2113           DFHEIV99
  2114     MOVE EIBRESP  TO WS-RESPONSE
  2115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2116     IF NOT RESP-NORMAL
  2117        DISPLAY ' BAD DELETE ERARCH ' WS-RESPONSE
  2118        GO TO 0050-EXIT
  2119     END-IF
  2120
  2121* EXEC CICS READ
  2122*         DATASET    ('ERENDT2')
  2123*         INTO       (ENDORSEMENT-RECORD)
  2124*         RIDFLD     (WS-ERENDT2-KEY)
  2125*         UPDATE
  2126*         RESP       (WS-RESPONSE)
  2127*    END-EXEC
  2128     MOVE LENGTH OF
  2129      ENDORSEMENT-RECORD
  2130       TO DFHEIV11
  2131     MOVE 'ERENDT2' TO DFHEIV1
  2132*    MOVE '&"IL       EU         (  N#00002054' TO DFHEIV0
  2133     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2134     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2135     MOVE X'204E233030303032303534' TO DFHEIV0(25:11)
  2136     CALL 'kxdfhei1' USING DFHEIV0,
  2137           DFHEIV1,
  2138           ENDORSEMENT-RECORD,
  2139           DFHEIV11,
  2140           WS-ERENDT2-KEY,
  2141           DFHEIV99,
  2142           DFHEIV99,
  2143           DFHEIV99
  2144     MOVE EIBRESP  TO WS-RESPONSE
  2145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2146     IF NOT RESP-NORMAL
  2147        DISPLAY ' BAD READ ON ERENDT2 ' WS-RESPONSE
  2148     ELSE
  2149
  2150* EXEC CICS DELETE
  2151*          DATASET    ('ERENDT2')
  2152*          RESP       (WS-RESPONSE)
  2153*       END-EXEC
  2154     MOVE 'ERENDT2' TO DFHEIV1
  2155*    MOVE '&(                    &  N#00002064' TO DFHEIV0
  2156     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2157     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2158     MOVE X'204E233030303032303634' TO DFHEIV0(25:11)
  2159     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  39
* NSAASBL.cbl
  2160           DFHEIV1,
  2161           DFHEIV99,
  2162           DFHEIV99,
  2163           DFHEIV99,
  2164           DFHEIV99
  2165     MOVE EIBRESP  TO WS-RESPONSE
  2166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2167        IF NOT RESP-NORMAL
  2168           DISPLAY ' BAD DELETE ON ERENDT2 ' WS-RESPONSE
  2169        END-IF
  2170     END-IF
  2171     MOVE 0                      TO WS-EXTR-SEQ-NO
  2172
  2173* EXEC CICS READ
  2174*         DATASET    ('NSASEXTR')
  2175*         INTO       (NSAS-EXTRACT-RECORD)
  2176*         RIDFLD     (WS-NSASEXTR-KEY)
  2177*         UPDATE
  2178*         RESP       (WS-RESPONSE)
  2179*    END-EXEC
  2180     MOVE LENGTH OF
  2181      NSAS-EXTRACT-RECORD
  2182       TO DFHEIV11
  2183     MOVE 'NSASEXTR' TO DFHEIV1
  2184*    MOVE '&"IL       EU         (  N#00002073' TO DFHEIV0
  2185     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2186     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2187     MOVE X'204E233030303032303733' TO DFHEIV0(25:11)
  2188     CALL 'kxdfhei1' USING DFHEIV0,
  2189           DFHEIV1,
  2190           NSAS-EXTRACT-RECORD,
  2191           DFHEIV11,
  2192           WS-NSASEXTR-KEY,
  2193           DFHEIV99,
  2194           DFHEIV99,
  2195           DFHEIV99
  2196     MOVE EIBRESP  TO WS-RESPONSE
  2197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2198     IF NOT RESP-NORMAL
  2199        DISPLAY ' BAD READ ON 0 NSASEXTR ' WS-RESPONSE
  2200        GO TO 0050-EXIT
  2201     ELSE
  2202
  2203* EXEC CICS DELETE
  2204*          DATASET    ('NSASEXTR')
  2205*          RESP       (WS-RESPONSE)
  2206*       END-EXEC
  2207     MOVE 'NSASEXTR' TO DFHEIV1
  2208*    MOVE '&(                    &  N#00002084' TO DFHEIV0
  2209     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2211     MOVE X'204E233030303032303834' TO DFHEIV0(25:11)
  2212     CALL 'kxdfhei1' USING DFHEIV0,
  2213           DFHEIV1,
  2214           DFHEIV99,
  2215           DFHEIV99,
  2216           DFHEIV99,
  2217           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  40
* NSAASBL.cbl
  2218     MOVE EIBRESP  TO WS-RESPONSE
  2219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2220        IF NOT RESP-NORMAL
  2221           DISPLAY ' BAD DELETE ON 0 NSASEXTR ' WS-RESPONSE
  2222           GO TO 0050-EXIT
  2223        END-IF
  2224     END-IF
  2225     MOVE 1                      TO WS-EXTR-SEQ-NO
  2226
  2227* EXEC CICS READ
  2228*         DATASET    ('NSASEXTR')
  2229*         INTO       (NSAS-EXTRACT-RECORD)
  2230*         RIDFLD     (WS-NSASEXTR-KEY)
  2231*         UPDATE
  2232*         RESP       (WS-RESPONSE)
  2233*    END-EXEC
  2234     MOVE LENGTH OF
  2235      NSAS-EXTRACT-RECORD
  2236       TO DFHEIV11
  2237     MOVE 'NSASEXTR' TO DFHEIV1
  2238*    MOVE '&"IL       EU         (  N#00002094' TO DFHEIV0
  2239     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2240     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2241     MOVE X'204E233030303032303934' TO DFHEIV0(25:11)
  2242     CALL 'kxdfhei1' USING DFHEIV0,
  2243           DFHEIV1,
  2244           NSAS-EXTRACT-RECORD,
  2245           DFHEIV11,
  2246           WS-NSASEXTR-KEY,
  2247           DFHEIV99,
  2248           DFHEIV99,
  2249           DFHEIV99
  2250     MOVE EIBRESP  TO WS-RESPONSE
  2251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2252     IF NOT RESP-NORMAL
  2253        DISPLAY ' BAD READ ON 1 NSASEXTR ' WS-RESPONSE
  2254     ELSE
  2255
  2256* EXEC CICS DELETE
  2257*          DATASET    ('NSASEXTR')
  2258*          RESP       (WS-RESPONSE)
  2259*       END-EXEC
  2260     MOVE 'NSASEXTR' TO DFHEIV1
  2261*    MOVE '&(                    &  N#00002104' TO DFHEIV0
  2262     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2263     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2264     MOVE X'204E233030303032313034' TO DFHEIV0(25:11)
  2265     CALL 'kxdfhei1' USING DFHEIV0,
  2266           DFHEIV1,
  2267           DFHEIV99,
  2268           DFHEIV99,
  2269           DFHEIV99,
  2270           DFHEIV99
  2271     MOVE EIBRESP  TO WS-RESPONSE
  2272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2273        IF NOT RESP-NORMAL
  2274           DISPLAY ' BAD DELETE ON 1 NSASEXTR ' WS-RESPONSE
  2275        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  41
* NSAASBL.cbl
  2276     END-IF
  2277     MOVE 2                      TO WS-EXTR-SEQ-NO
  2278
  2279* EXEC CICS READ
  2280*         DATASET    ('NSASEXTR')
  2281*         INTO       (NSAS-EXTRACT-RECORD)
  2282*         RIDFLD     (WS-NSASEXTR-KEY)
  2283*         UPDATE
  2284*         RESP       (WS-RESPONSE)
  2285*    END-EXEC
  2286     MOVE LENGTH OF
  2287      NSAS-EXTRACT-RECORD
  2288       TO DFHEIV11
  2289     MOVE 'NSASEXTR' TO DFHEIV1
  2290*    MOVE '&"IL       EU         (  N#00002113' TO DFHEIV0
  2291     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2292     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2293     MOVE X'204E233030303032313133' TO DFHEIV0(25:11)
  2294     CALL 'kxdfhei1' USING DFHEIV0,
  2295           DFHEIV1,
  2296           NSAS-EXTRACT-RECORD,
  2297           DFHEIV11,
  2298           WS-NSASEXTR-KEY,
  2299           DFHEIV99,
  2300           DFHEIV99,
  2301           DFHEIV99
  2302     MOVE EIBRESP  TO WS-RESPONSE
  2303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2304     IF NOT RESP-NORMAL
  2305        DISPLAY ' BAD READ ON 2 NSASEXTR ' WS-RESPONSE
  2306     ELSE
  2307
  2308* EXEC CICS DELETE
  2309*          DATASET    ('NSASEXTR')
  2310*          RESP       (WS-RESPONSE)
  2311*       END-EXEC
  2312     MOVE 'NSASEXTR' TO DFHEIV1
  2313*    MOVE '&(                    &  N#00002123' TO DFHEIV0
  2314     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2315     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2316     MOVE X'204E233030303032313233' TO DFHEIV0(25:11)
  2317     CALL 'kxdfhei1' USING DFHEIV0,
  2318           DFHEIV1,
  2319           DFHEIV99,
  2320           DFHEIV99,
  2321           DFHEIV99,
  2322           DFHEIV99
  2323     MOVE EIBRESP  TO WS-RESPONSE
  2324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2325        IF NOT RESP-NORMAL
  2326           DISPLAY ' BAD DELETE ON 2 NSASEXTR ' WS-RESPONSE
  2327        END-IF
  2328     END-IF
  2329     .
  2330 0050-EXIT.
  2331     EXIT.
  2332
  2333
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  42
* NSAASBL.cbl
  2334 0440-ADD-BILLING-NOTE.
  2335
  2336     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  2337     MOVE WS-ERARCH-COMPANY-CD   TO WS-EOBC-COMPANY-CD
  2338     MOVE '5'                    TO WS-EOBC-REC-TYPE
  2339
  2340
  2341* EXEC CICS STARTBR
  2342*        DATASET   ('ELEOBC')
  2343*        RIDFLD    (WS-ELEOBC-KEY)
  2344*        GTEQ
  2345*        RESP      (WS-RESPONSE)
  2346*    END-EXEC
  2347     MOVE 'ELEOBC' TO DFHEIV1
  2348     MOVE 0
  2349       TO DFHEIV11
  2350*    MOVE '&,         G          &  N#00002142' TO DFHEIV0
  2351     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2352     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2353     MOVE X'204E233030303032313432' TO DFHEIV0(25:11)
  2354     CALL 'kxdfhei1' USING DFHEIV0,
  2355           DFHEIV1,
  2356           WS-ELEOBC-KEY,
  2357           DFHEIV99,
  2358           DFHEIV11,
  2359           DFHEIV99
  2360     MOVE EIBRESP  TO WS-RESPONSE
  2361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2362
  2363     IF NOT RESP-NORMAL
  2364        GO TO 0440-EXIT
  2365     END-IF
  2366      .
  2367 0440-READNEXT-ELEOBC.
  2368
  2369
  2370* EXEC CICS READNEXT
  2371*       INTO    (EOB-CODES)
  2372*       DATASET ('ELEOBC')
  2373*       RIDFLD  (WS-ELEOBC-KEY)
  2374*       RESP    (WS-RESPONSE)
  2375*    END-EXEC
  2376     MOVE LENGTH OF
  2377      EOB-CODES
  2378       TO DFHEIV12
  2379     MOVE 'ELEOBC' TO DFHEIV1
  2380     MOVE 0
  2381       TO DFHEIV11
  2382*    MOVE '&.IL                  )  N#00002155' TO DFHEIV0
  2383     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2384     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2385     MOVE X'204E233030303032313535' TO DFHEIV0(25:11)
  2386     CALL 'kxdfhei1' USING DFHEIV0,
  2387           DFHEIV1,
  2388           EOB-CODES,
  2389           DFHEIV12,
  2390           WS-ELEOBC-KEY,
  2391           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  43
* NSAASBL.cbl
  2392           DFHEIV11,
  2393           DFHEIV99,
  2394           DFHEIV99
  2395     MOVE EIBRESP  TO WS-RESPONSE
  2396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2397
  2398     IF RESP-NORMAL
  2399         IF EO-RECORD-TYPE NOT = '5'
  2400             GO TO 0440-EXIT
  2401         END-IF
  2402     ELSE
  2403         GO TO 0440-EXIT
  2404     END-IF
  2405
  2406     IF EO-RECORD-TYPE = '5' AND
  2407        EO-EOB-CODE = WS-SV-LETTER-ID
  2408           CONTINUE
  2409     ELSE
  2410         GO TO 0440-READNEXT-ELEOBC
  2411     END-IF
  2412
  2413     MOVE SPACES         TO WS-BILLING-NOTE
  2414     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  2415     MOVE WS-SV-LETTER-ID TO WS-BN-LTRID
  2416     MOVE SAVE-DATE      TO WS-BN-DATE
  2417     MOVE WS-SV-PROC-ID  TO WS-BN-USERID
  2418     MOVE +25            TO WS-LEN
  2419
  2420     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  2421     .
  2422 0440-EXIT.
  2423     EXIT.
  2424
  2425 0441-UPDATE-BILLING-NOTE.
  2426
  2427     move bl-batch-no            to ws-erpndb-batch-no
  2428     move bl-batch-seq           to ws-erpndb-batch-seq-no
  2429     move +0                     to ws-erpndb-chg-seq-no
  2430
  2431* exec cics read
  2432*       dataset   ('ERPNDB')
  2433*       ridfld    (ws-erpndb-key)
  2434*       into      (pending-business)
  2435*       resp      (ws-response)
  2436*    end-exec
  2437     MOVE LENGTH OF
  2438      pending-business
  2439       TO DFHEIV11
  2440     MOVE 'ERPNDB' TO DFHEIV1
  2441*    MOVE '&"IL       E          (  N#00002194' TO DFHEIV0
  2442     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2444     MOVE X'204E233030303032313934' TO DFHEIV0(25:11)
  2445     CALL 'kxdfhei1' USING DFHEIV0,
  2446           DFHEIV1,
  2447           pending-business,
  2448           DFHEIV11,
  2449           ws-erpndb-key,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  44
* NSAASBL.cbl
  2450           DFHEIV99,
  2451           DFHEIV99,
  2452           DFHEIV99
  2453     MOVE EIBRESP  TO ws-response
  2454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2455     if resp-normal and pb-cancellation
  2456        move '2'                 to ws-from-issue-or-cancel
  2457*       display ' must be from cancel nsaasbl '
  2458     else
  2459        move '1'                 to ws-from-issue-or-cancel
  2460     end-if
  2461
  2462     MOVE WS-SAVE-KEY            TO WS-ERNOTE-KEY
  2463     move ws-from-issue-or-cancel to ws-note-record-type
  2464
  2465*    display ' rid fle b4 ' ws-ernote-key(2:33)
  2466
  2467
  2468* EXEC CICS READ
  2469*       DATASET    ('ERNOTE')
  2470*       RIDFLD     (WS-ERNOTE-KEY)
  2471*       INTO       (CERTIFICATE-NOTE)
  2472*       RESP       (WS-RESPONSE)
  2473*       UPDATE
  2474*    END-EXEC
  2475     MOVE LENGTH OF
  2476      CERTIFICATE-NOTE
  2477       TO DFHEIV11
  2478     MOVE 'ERNOTE' TO DFHEIV1
  2479*    MOVE '&"IL       EU         (  N#00002212' TO DFHEIV0
  2480     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2481     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2482     MOVE X'204E233030303032323132' TO DFHEIV0(25:11)
  2483     CALL 'kxdfhei1' USING DFHEIV0,
  2484           DFHEIV1,
  2485           CERTIFICATE-NOTE,
  2486           DFHEIV11,
  2487           WS-ERNOTE-KEY,
  2488           DFHEIV99,
  2489           DFHEIV99,
  2490           DFHEIV99
  2491     MOVE EIBRESP  TO WS-RESPONSE
  2492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2493
  2494     IF RESP-NORMAL
  2495       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  2496          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  2497       END-IF
  2498       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  2499          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  2500       END-IF
  2501       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  2502           (NOTE-SUB > +10) OR
  2503           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  2504                             WS-BILLING-NOTE (1:WS-LEN))
  2505       END-PERFORM
  2506       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  2507                              WS-BILLING-NOTE (1:WS-LEN)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  45
* NSAASBL.cbl
  2508
  2509* EXEC CICS UNLOCK
  2510*           DATASET    ('ERNOTE')
  2511*        END-EXEC
  2512     MOVE 'ERNOTE' TO DFHEIV1
  2513*    MOVE '&*                    #   #00002234' TO DFHEIV0
  2514     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2515     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2516     MOVE X'2020233030303032323334' TO DFHEIV0(25:11)
  2517     CALL 'kxdfhei1' USING DFHEIV0,
  2518           DFHEIV1,
  2519           DFHEIV99
  2520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2521       ELSE
  2522         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  2523           (NOTE-SUB > +10) OR
  2524           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  2525         END-PERFORM
  2526         IF (NOTE-SUB < +11)
  2527           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  2528              NOTE-SUB <= CN-BILLING-END-LINE-NO
  2529                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  2530           ELSE
  2531             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  2532              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  2533                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  2534                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  2535             ELSE
  2536               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  2537                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  2538                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  2539                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  2540               ELSE
  2541                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  2542                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  2543                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  2544                                       CN-BILLING-START-LINE-NO
  2545                 ELSE
  2546                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  2547                 END-IF
  2548               END-IF
  2549             END-IF
  2550           END-IF
  2551           MOVE WS-SV-PROC-ID       TO CN-LAST-MAINT-USER
  2552           MOVE SAVE-BIN-DATE       TO CN-LAST-MAINT-DT
  2553           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  2554
  2555* EXEC CICS REWRITE
  2556*             DATASET    ('ERNOTE')
  2557*             FROM       (CERTIFICATE-NOTE)
  2558*             RESP       (WS-RESPONSE)
  2559*          END-EXEC
  2560     MOVE LENGTH OF
  2561      CERTIFICATE-NOTE
  2562       TO DFHEIV11
  2563     MOVE 'ERNOTE' TO DFHEIV1
  2564*    MOVE '&& L                  %  N#00002270' TO DFHEIV0
  2565     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  46
* NSAASBL.cbl
  2566     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2567     MOVE X'204E233030303032323730' TO DFHEIV0(25:11)
  2568     CALL 'kxdfhei1' USING DFHEIV0,
  2569           DFHEIV1,
  2570           CERTIFICATE-NOTE,
  2571           DFHEIV11,
  2572           DFHEIV99
  2573     MOVE EIBRESP  TO WS-RESPONSE
  2574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2575           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  2576         END-IF
  2577       END-IF
  2578     ELSE
  2579        MOVE SPACES              TO CERTIFICATE-NOTE
  2580        MOVE 'CN'                TO CN-RECORD-ID
  2581        MOVE WS-SAVE-KEY         TO CN-CONTROL-PRIMARY
  2582                                    WS-ERNOTE-KEY
  2583        move ws-from-issue-or-cancel
  2584                                 to cn-record-type
  2585                                    ws-note-record-type
  2586        MOVE 01                  TO CN-BILLING-START-LINE-NO
  2587                                    CN-BILLING-END-LINE-NO
  2588        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  2589        MOVE WS-SV-PROC-ID       TO CN-LAST-MAINT-USER
  2590        MOVE SAVE-BIN-DATE       TO CN-LAST-MAINT-DT
  2591        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  2592
  2593* EXEC CICS WRITE
  2594*          DATASET    ('ERNOTE')
  2595*          FROM       (CERTIFICATE-NOTE)
  2596*          RIDFLD     (cn-control-primary)
  2597*          RESP       (WS-RESPONSE)
  2598*       END-EXEC
  2599     MOVE LENGTH OF
  2600      CERTIFICATE-NOTE
  2601       TO DFHEIV11
  2602     MOVE 'ERNOTE' TO DFHEIV1
  2603*    MOVE '&$ L                  ''  N#00002292' TO DFHEIV0
  2604     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2605     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2606     MOVE X'204E233030303032323932' TO DFHEIV0(25:11)
  2607     CALL 'kxdfhei1' USING DFHEIV0,
  2608           DFHEIV1,
  2609           CERTIFICATE-NOTE,
  2610           DFHEIV11,
  2611           cn-control-primary,
  2612           DFHEIV99,
  2613           DFHEIV99
  2614     MOVE EIBRESP  TO WS-RESPONSE
  2615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2616
  2617        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  2618     END-IF
  2619
  2620     .
  2621 0441-EXIT.
  2622     EXIT.
  2623
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  47
* NSAASBL.cbl
  2624
  2625 0442-SQUEEZE-IT-IN.
  2626
  2627     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  2628        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  2629           NOTE-SUB = +10
  2630           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  2631           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  2632             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  2633             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  2634             MOVE +9 TO NOTE-SUB
  2635           END-IF
  2636        END-PERFORM
  2637     ELSE
  2638        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  2639           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  2640             UNTIL NOTE-SUB = +1
  2641             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  2642             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  2643                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  2644                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  2645                MOVE +2          TO NOTE-SUB
  2646             END-IF
  2647           END-PERFORM
  2648        END-IF
  2649     END-IF
  2650
  2651     .
  2652 0442-EXIT.
  2653     EXIT.
  2654
  2655 0445-CERTIFICATE-UPDATE.
  2656
  2657     MOVE WS-SAVE-KEY     TO WS-ELCERT-KEY
  2658
  2659* EXEC CICS READ
  2660*        DATASET  ('ELCERT')
  2661*        RIDFLD   (WS-ELCERT-KEY)
  2662*        INTO     (CERTIFICATE-MASTER)
  2663*        RESP     (WS-RESPONSE)
  2664*        UPDATE
  2665*    END-EXEC
  2666     MOVE LENGTH OF
  2667      CERTIFICATE-MASTER
  2668       TO DFHEIV11
  2669     MOVE 'ELCERT' TO DFHEIV1
  2670*    MOVE '&"IL       EU         (  N#00002340' TO DFHEIV0
  2671     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2672     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2673     MOVE X'204E233030303032333430' TO DFHEIV0(25:11)
  2674     CALL 'kxdfhei1' USING DFHEIV0,
  2675           DFHEIV1,
  2676           CERTIFICATE-MASTER,
  2677           DFHEIV11,
  2678           WS-ELCERT-KEY,
  2679           DFHEIV99,
  2680           DFHEIV99,
  2681           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  48
* NSAASBL.cbl
  2682     MOVE EIBRESP  TO WS-RESPONSE
  2683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2684
  2685     IF RESP-NORMAL
  2686        EVALUATE CM-NOTE-SW
  2687           WHEN '2'
  2688           WHEN '3'
  2689           WHEN '6'
  2690           WHEN '7'
  2691              SET NO-CERT-RW     TO TRUE
  2692           WHEN ' '
  2693              MOVE '2'           TO CM-NOTE-SW
  2694           WHEN '1'
  2695              MOVE '3'           TO CM-NOTE-SW
  2696           WHEN '4'
  2697              MOVE '6'           TO CM-NOTE-SW
  2698           WHEN '5'
  2699              MOVE '7'           TO CM-NOTE-SW
  2700        END-EVALUATE
  2701     END-IF
  2702
  2703     IF NOT NO-CERT-RW
  2704
  2705* EXEC CICS REWRITE
  2706*          FROM     (CERTIFICATE-MASTER)
  2707*          DATASET  ('ELCERT')
  2708*          RESP     (WS-RESPONSE)
  2709*       END-EXEC
  2710     MOVE LENGTH OF
  2711      CERTIFICATE-MASTER
  2712       TO DFHEIV11
  2713     MOVE 'ELCERT' TO DFHEIV1
  2714*    MOVE '&& L                  %  N#00002367' TO DFHEIV0
  2715     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2716     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2717     MOVE X'204E233030303032333637' TO DFHEIV0(25:11)
  2718     CALL 'kxdfhei1' USING DFHEIV0,
  2719           DFHEIV1,
  2720           CERTIFICATE-MASTER,
  2721           DFHEIV11,
  2722           DFHEIV99
  2723     MOVE EIBRESP  TO WS-RESPONSE
  2724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2725     ELSE
  2726
  2727* EXEC CICS UNLOCK
  2728*          DATASET  ('ELCERT')
  2729*       END-EXEC
  2730     MOVE 'ELCERT' TO DFHEIV1
  2731*    MOVE '&*                    #   #00002373' TO DFHEIV0
  2732     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2733     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2734     MOVE X'2020233030303032333733' TO DFHEIV0(25:11)
  2735     CALL 'kxdfhei1' USING DFHEIV0,
  2736           DFHEIV1,
  2737           DFHEIV99
  2738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2739     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:20 Page  49
* NSAASBL.cbl
  2740
  2741     .
  2742 0445-EXIT.
  2743     EXIT.
  2744
  2745 9700-DATE-LINK.
  2746
  2747* EXEC CICS LINK
  2748*        PROGRAM   ('ELDATCV')
  2749*        COMMAREA  (DATE-CONVERSION-DATA)
  2750*        LENGTH    (DC-COMM-LENGTH)
  2751*    END-EXEC.
  2752     MOVE 'ELDATCV' TO DFHEIV1
  2753*    MOVE '."C                   (   #00002383' TO DFHEIV0
  2754     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2756     MOVE X'2020233030303032333833' TO DFHEIV0(25:11)
  2757     CALL 'kxdfhei1' USING DFHEIV0,
  2758           DFHEIV1,
  2759           DATE-CONVERSION-DATA,
  2760           DC-COMM-LENGTH,
  2761           DFHEIV99,
  2762           DFHEIV99,
  2763           DFHEIV99,
  2764           DFHEIV99
  2765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2766
  2767 9700-EXIT.
  2768      EXIT.
  2769
  2770 9999-DFHBACK SECTION.
  2771     MOVE '9%                    "   ' TO DFHEIV0
  2772     MOVE 'NSAASBL' TO DFHEIV1
  2773     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2774     GOBACK.
  2775 9999-DFHEXIT.
  2776     IF DFHEIGDJ EQUAL 0001
  2777         NEXT SENTENCE.
  2778     MOVE '9%                    "   ' TO DFHEIV0
  2779     MOVE 'NSAASBL' TO DFHEIV1
  2780     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2781     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16300     Code:        5878
