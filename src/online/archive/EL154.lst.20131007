* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   1
* EL154.cbl
* Options: int("EL154.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL154.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL154.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL154.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL154.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/21/94 15:39:26.
     7*                            VMOD=2.022
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   2
* EL154.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EX28 - SET-UP AUTOMATIC PAYMENTS.
    26*        USED TO CREATE NEW AUTOMATIC PAYMENT SCHEDULES AND/OR
    27*        SIGN-OFF CURRENT SCHEDULES.  ONCE A SCHEDULE HAS BEEN
    28*        CREATED IT MAY ONLY BY REPLACED - NOT CHANGED
    29*        OR DELETED.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 090108    2007041300006  AJRA  ENTER LETTER FORM NUMBER ON SET U
    39* 031809    2009031600001  AJRA  ALLOW IU PAYMENT PAST EXP DATE
    40* 070909    2009060400001  AJRA  ADD AUTO PAY STOP LETTER
    41* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    42******************************************************************
    43
    44 ENVIRONMENT DIVISION.
    45
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   3
* EL154.cbl
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL154 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.022 *********'.
    53 77  P1                          PIC S999 COMP-3 VALUE +0.
    54 77  P2                          PIC S999 COMP-3 VALUE +0.
    55 77  s1                          PIC S999 COMP-3 VALUE +0.
    56 77  s2                          PIC S999 COMP-3 VALUE +0.
    57 77  ws-benefit-expiration-dt    pic xx value low-values.
    58
    59*                            COPY ELCSCTM.
    60******************************************************************
    61*                                                                *
    62*                                                                *
    63*                            ELCSCTM                             *
    64*                            VMOD=2.001                          *
    65*                                                                *
    66*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    67*                                                                *
    68******************************************************************
    69 01  SECURITY-MESSAGE.
    70     12  FILLER                          PIC X(30)
    71            VALUE '** LOGIC SECURITY VIOLATION -'.
    72     12  SM-READ                         PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' PGM='.
    75     12  SM-PGM                          PIC X(6).
    76     12  FILLER                          PIC X(5)
    77            VALUE ' OPR='.
    78     12  SM-PROCESSOR-ID                 PIC X(4).
    79     12  FILLER                          PIC X(6)
    80            VALUE ' TERM='.
    81     12  SM-TERMID                       PIC X(4).
    82     12  FILLER                          PIC XX   VALUE SPACE.
    83     12  SM-JUL-DATE                     PIC 9(5).
    84     12  FILLER                          PIC X    VALUE SPACE.
    85     12  SM-TIME                         PIC 99.99.
    86
    87
    88*                            COPY ELCSCRTY.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCRTY                            *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    96*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    97*        SAVED IN PI-SECURITY-ADDRESS.                           *
    98*                                                                *
    99******************************************************************
   100 01  SECURITY-CONTROL.
   101     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   102     12  FILLER                       PIC XX    VALUE 'SC'.
   103     12  SC-CREDIT-CODES.
   104         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   4
* EL154.cbl
   105             20  SC-CREDIT-DISPLAY    PIC X.
   106             20  SC-CREDIT-UPDATE     PIC X.
   107     12  SC-CLAIMS-CODES.
   108         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   109             20  SC-CLAIMS-DISPLAY    PIC X.
   110             20  SC-CLAIMS-UPDATE     PIC X.
   111
   112 01  WS-DATE-AREA.
   113     05  CURRENT-GREG-DATE   PIC X(8)    VALUE SPACES.
   114     05  CURRENT-BIN-DATE    PIC X(2)    VALUE SPACES.
   115     05  RETRO-ELIM-DATE     PIC XX      VALUE LOW-VALUES.
   116
   117 01  ws-dcc-product-code         pic xxx value spaces.
   118 01  ws-ah-benefit-cd            pic xx  value '00'.
   119 01  ws-monthly-benefit          pic s9(9)v99 comp-3 value +0.
   120 01  ws-max-benefit-amt          pic s9(9)v99 comp-3 value +0.
   121 01  ws-max-benefit-pmts         pic s999 comp-3 value +0.
   122 01  ws-benefits-prev-paid       pic s999 comp-3 value +0.
   123 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   124     88  PDEF-FOUND                   VALUE 'Y'.
   125 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   126     88  ACCT-FOUND                   VALUE 'Y'.
   127 01  ws-cert-trlr-sw             PIC X  VALUE ' '.
   128     88  cert-trlr-found              VALUE 'Y'.
   129 01  STANDARD-AREAS.
   130     12  WS-RESPONSE             PIC S9(8)   COMP.
   131         88  WS-RESP-NORMAL        VALUE +00.
   132         88  WS-RESP-ERROR         VALUE +01.
   133         88  WS-RESP-NOTFND        VALUE +13.
   134         88  WS-RESP-DUPREC        VALUE +14.
   135         88  WS-RESP-ENDFILE       VALUE +20.
   136     12  SC-ITEM             PIC S9(4)   VALUE +1  COMP.
   137     12  SUB-1               PIC S9(4)   VALUE +0  COMP.
   138     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   139     12  MAP-NAME.
   140         16  MAP-PRE         PIC XX      VALUE 'EL'.
   141         16  MAP-NUMBER      PIC X(4)    VALUE '154A'.
   142         16  FILLER          PIC XX      VALUE SPACES.
   143     12  MAPSET-NAME         PIC X(8)    VALUE 'EL154S'.
   144     12  TRANS-ID            PIC X(4)    VALUE 'EX28'.
   145     12  LGXX-ID             PIC X(4)    VALUE 'LGXX'.
   146     12  PGM-NAME            PIC X(8).
   147     12  TIME-IN             PIC S9(7).
   148     12  TIME-OUT-R  REDEFINES TIME-IN.
   149         16  FILLER          PIC X.
   150         16  TIME-OUT        PIC 99V99.
   151         16  FILLER          PIC X(2).
   152     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   153     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   154     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   155
   156     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   157     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   158     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   159     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   160     12  THIS-PGM            PIC X(8)    VALUE 'EL154'.
   161
   162     12  DEEDIT-FIELD            PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   5
* EL154.cbl
   163     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   164
   165     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   166     12  NEFFDTE-SAVE            PIC XX       VALUE LOW-VALUES.
   167     12  NFSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   168     12  NLSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   169     12  NFSTAMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   170     12  NREGPMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   171     12  CURRENT-SAVE            PIC XX       VALUE LOW-VALUES.
   172     12  LETTDTE-SAVE            PIC X(10)    VALUE SPACES.
   173     12  WS-WORK                 PIC S9(5)    VALUE ZERO COMP-3.
   174     12  WS-REMAINDER            PIC S9(5)    VALUE ZERO COMP-3.
   175     12  WS-DAYS-MINUS-TOL       PIC S9(5)    VALUE ZERO COMP-3.
   176     12  WS-DAYS-PLUS-TOL        PIC S9(5)    VALUE ZERO COMP-3.
   177     12  WS-DAILY-BEN-AMT        PIC S9(5)V99 VALUE ZERO COMP-3.
   178     12  WS-AMT-MINUS-TOL        PIC S9(7)V99 VALUE ZERO COMP-3.
   179     12  WS-AMT-PLUS-TOL         PIC S9(7)V99 VALUE ZERO COMP-3.
   180     12  WS-AMT-TOL              PIC S9(5)V99 VALUE ZERO COMP-3.
   181     12  WS-DAY-TOL              PIC S9(05)   VALUE ZERO COMP-3.
   182     12  WS-MAX-AUTO-PMT         PIC S9(7)V99 VALUE ZERO COMP-3.
   183     12  WS-MAX-AUTO-MOS         PIC S999     VALUE ZERO COMP-3.
   184     12  WS-ELAPSED-DAYS         PIC S9(04)   VALUE +0   COMP.
   185     12  WS-REG-PMT              PIC S9(7)V99 VALUE ZERO COMP-3.
   186     12  WS-EXP-DT               PIC XX       VALUE LOW-VALUES.
   187     12  WS-EXP-DT-PLUS7         PIC XX       VALUE LOW-VALUES.
   188     12  WS-CALC-METHOD          PIC X.
   189     12  WS-DAILY-RATE           PIC S9(3)V99.
   190     12  WS-CONFIRM-NEEDED       PIC X.
   191     12  WS-ELIMINATION-SW       PIC X        VALUE SPACES.
   192         88  NO-EFFDTE-ENTERED   VALUE 'N'.
   193     12  WS-BENEFIT-FOUND-SW     PIC X        VALUE SPACES.
   194         88  BENEFIT-FOUND       VALUE 'Y'.
   195     12  WS-ACT-REC-FOUND-SW     PIC X(01)    VALUE 'N'.
   196     12  WS-LETTER-SW            PIC X(01)    VALUE 'N'.
   197     12  WS-LETTER-FORM-NUM      PIC X(04)    VALUE SPACES.
   198     12  WS-END-LETTER-FORM-NUM  PIC X(04)    VALUE SPACES.
   199     12  WS-RESET-SW             PIC X(01)    VALUE 'N'.
   200     12  WS-PAYEE-CODE.
   201         16  WS-PAYEE-CD         PIC X(01).
   202         16  WS-PAYEE-SEQ        PIC X(01).
   203         16  WS-PAYEE-SEQ-NUM REDEFINES
   204             WS-PAYEE-SEQ        PIC 9(01).
   205     12  WS-ACCESS.
   206         16  FILLER              PIC XX       VALUE SPACES.
   207         16  WS-BEN-CD           PIC XX.
   208
   209     12  MISC-HEADING-AREAS.
   210         16  FIRST-PMT-HD1       PIC X(23)    VALUE
   211             'FIRST PAY THRU DATE   :'.
   212         16  FIRST-PMT-HD2       PIC X(23)    VALUE
   213             'FIRST PAY-TO DATE     :'.
   214         16  FIRST-PMT-HD3       PIC X(26)    VALUE
   215             '   FIRST PAY-THRU DATE   :'.
   216         16  FIRST-PMT-HD4       PIC X(26)    VALUE
   217             '   FIRST PAY-TO DATE     :'.
   218         16  LAST-PMT-HD1        PIC X(24)    VALUE
   219             'LAST PAY-THRU DATE     :'.
   220         16  LAST-PMT-HD2        PIC X(24)    VALUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   6
* EL154.cbl
   221             'LAST PAY-TO DATE       :'.
   222         16  LAST-PMT-HD3        PIC X(23)    VALUE
   223             'LAST PAY-THRU DATE    :'.
   224         16  LAST-PMT-HD4        PIC X(23)    VALUE
   225             'LAST PAY-TO DATE      :'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   7
* EL154.cbl
   227 01  ERROR-MESSAGES.
   228     12  ER-0000                 PIC X(4)     VALUE '0000'.
   229     12  ER-0004                 PIC X(4)     VALUE '0004'.
   230     12  ER-0008                 PIC X(4)     VALUE '0008'.
   231     12  ER-0029                 PIC X(4)     VALUE '0029'.
   232     12  ER-0042                 PIC X(4)     VALUE '0042'.
   233     12  ER-0050                 PIC X(4)     VALUE '0050'.
   234     12  ER-0070                 PIC X(4)     VALUE '0070'.
   235     12  ER-0130                 PIC X(4)     VALUE '0130'.
   236     12  ER-0154                 PIC X(4)     VALUE '0154'.
   237     12  ER-0169                 PIC X(4)     VALUE '0169'.
   238     12  ER-0172                 PIC X(4)     VALUE '0172'.
   239     12  ER-0186                 PIC X(4)     VALUE '0186'.
   240     12  ER-0206                 PIC X(4)     VALUE '0206'.
   241     12  ER-0283                 PIC X(4)     VALUE '0283'.
   242     12  ER-0346                 PIC X(4)     VALUE '0346'.
   243     12  ER-0347                 PIC X(4)     VALUE '0347'.
   244     12  ER-0348                 PIC X(4)     VALUE '0348'.
   245     12  ER-0349                 PIC X(4)     VALUE '0349'.
   246     12  ER-0350                 PIC X(4)     VALUE '0350'.
   247     12  ER-0351                 PIC X(4)     VALUE '0351'.
   248     12  ER-0352                 PIC X(4)     VALUE '0352'.
   249     12  ER-0353                 PIC X(4)     VALUE '0353'.
   250     12  ER-0354                 PIC X(4)     VALUE '0354'.
   251     12  ER-0357                 PIC X(4)     VALUE '0357'.
   252     12  ER-0358                 PIC X(4)     VALUE '0358'.
   253     12  ER-0372                 PIC X(4)     VALUE '0372'.
   254     12  ER-0396                 PIC X(4)     VALUE '0396'.
   255     12  ER-0397                 PIC X(4)     VALUE '0397'.
   256     12  ER-0398                 PIC X(4)     VALUE '0398'.
   257     12  ER-0399                 PIC X(4)     VALUE '0399'.
   258     12  ER-0401                 PIC X(4)     VALUE '0401'.
   259     12  ER-0402                 PIC X(4)     VALUE '0402'.
   260     12  ER-0403                 PIC X(4)     VALUE '0403'.
   261     12  ER-0404                 PIC X(4)     VALUE '0404'.
   262     12  ER-0450                 PIC X(4)     VALUE '0450'.
   263     12  ER-0541                 PIC X(4)     VALUE '0541'.
   264     12  ER-0559                 PIC X(4)     VALUE '0559'.
   265     12  ER-0563                 PIC X(4)     VALUE '0563'.
   266     12  ER-0597                 PIC X(4)     VALUE '0597'.
   267     12  ER-0632                 PIC X(4)     VALUE '0632'.
   268     12  ER-0670                 PIC X(4)     VALUE '0670'.
   269     12  ER-0802                 PIC X(4)     VALUE '0802'.
   270     12  ER-0803                 PIC X(4)     VALUE '0803'.
   271     12  ER-0815                 PIC X(4)     VALUE '0815'.
   272     12  ER-0826                 PIC X(4)     VALUE '0826'.
   273     12  ER-0839                 PIC X(4)     VALUE '0839'.
   274     12  ER-1599                 PIC X(4)     VALUE '1599'.
   275     12  er-1657                 pic x(4)     value '1657'.
   276     12  er-1658                 pic x(4)     value '1658'.
   277     12  ER-3396                 PIC X(4)     VALUE '3396'.
   278     12  ER-3397                 PIC X(4)     VALUE '3397'.
   279     12  ER-3537                 PIC X(4)     VALUE '3537'.
   280     12  ER-3801                 PIC X(4)     VALUE '3801'.
   281     12  ER-8200                 PIC X(4)     VALUE '8200'.
   282     12  ER-9483                 PIC X(4)     VALUE '9483'.
   283     12  ER-9883                 PIC X(4)     VALUE '9883'.
   284
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   8
* EL154.cbl
   286 01  ACCESS-KEYS.
   287     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   288     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   289     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   290     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   291     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   292     12  EMPLCY-ID                PIC X(8)    VALUE 'MPPLCY'.
   293
   294     12  CNTL-KEY.
   295         16  CNTL-CO              PIC X(3).
   296         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   297         16  CNTL-GENL.
   298           18 CNTL-GEN1           PIC X(2)    VALUE SPACES.
   299           18 CNTL-GEN2.
   300             20 CNTL-GEN3         PIC X       VALUE SPACES.
   301             20 CNTL-GEN4         PIC X       VALUE SPACES.
   302         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   303
   304     12  ELTRLR-KEY.
   305         16  TRLR-COMP-CD        PIC X.
   306         16  TRLR-CARRIER        PIC X.
   307         16  TRLR-CLAIM-NO       PIC X(7).
   308         16  TRLR-CERT-NO        PIC X(11).
   309         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   310     12  CLAM-KEY.
   311         16  CLAM-CO              PIC X.
   312         16  CLAM-CARRIER         PIC X.
   313         16  CLAM-CLAIM           PIC X(7).
   314         16  CLAM-CERT-NUM        PIC X(11).
   315
   316     12  CLAIM-SAVE-KEY           PIC X(20).
   317
   318     12  ACTV-KEY.
   319         16  ACTV-PARTIAL-KEY.
   320             20  ACTV-CO          PIC X.
   321             20  ACTV-CARRIER     PIC X.
   322             20  ACTV-CLAIM       PIC X(7).
   323             20  ACTV-CERT-NUM    PIC X(11).
   324         16  ACTV-SEQ             PIC S9(4)  COMP.
   325
   326     12  CERT-KEY.
   327         16  CERT-CO             PIC X.
   328         16  CERT-CARRIER        PIC X.
   329         16  CERT-GROUPING       PIC X(6).
   330         16  CERT-STATE          PIC XX.
   331         16  CERT-ACCOUNT        PIC X(10).
   332         16  CERT-EFF-DT         PIC XX.
   333         16  CERT-CERT-NUM       PIC X(11).
   334
   335     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   336     12  ERACCT-KEY.
   337         16  ERACCT-PARTIAL-KEY.
   338             20  ACCT-COMP-CD    PIC X.
   339             20  ACCT-CARRIER    PIC X.
   340             20  ACCT-GROUPING   PIC X(6).
   341             20  ACCT-STATE      PIC XX.
   342             20  ACCT-ACCOUNT    PIC X(10).
   343         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   9
* EL154.cbl
   344         16  FILLER              PIC X(4) VALUE SPACES.
   345     12  EMPLCY-KEY.
   346         16  EMPLCY-COMPANY-CD   PIC X(01).
   347         16  EMPLCY-CARRIER      PIC X(01).
   348         16  EMPLCY-GROUPING     PIC X(06).
   349         16  EMPLCY-STATE        PIC X(02).
   350         16  EMPLCY-PRODUCER     PIC X(10).
   351         16  EMPLCY-EFF-DT       PIC X(02).
   352         16  EMPLCY-REFERENCE-NO PIC X(20).
   353
   354     12  BENE-KEY.
   355         16  BENE-CO             PIC X(01).
   356         16  BENE-REC-TYPE       PIC X(01).
   357         16  BENE-CODE           PIC X(10).
   358 01  ERPDEF-KEY-SAVE             PIC X(18).
   359 01  ERPDEF-KEY.
   360     12  ERPDEF-COMPANY-CD       PIC X.
   361     12  ERPDEF-STATE            PIC XX.
   362     12  ERPDEF-PROD-CD          PIC XXX.
   363     12  F                       PIC X(7).
   364     12  ERPDEF-BEN-TYPE         PIC X.
   365     12  ERPDEF-BEN-CODE         PIC XX.
   366     12  ERPDEF-EXP-DT           PIC XX.
   367
   368 01  ELCRTT-KEY.
   369     05  CTRLR-COMP-CD       PIC X.
   370     05  CTRLR-CARRIER       PIC X.
   371     05  CTRLR-GROUPING      PIC X(6).
   372     05  CTRLR-STATE         PIC X(2).
   373     05  CTRLR-ACCOUNT       PIC X(10).
   374     05  CTRLR-EFF-DT        PIC XX.
   375     05  CTRLR-CERT-NO       PIC X(11).
   376     05  CTRLR-REC-TYPE      PIC X.
   377*                            COPY ELCCALC.
   378******************************************************************
   379*                                                                *
   380*                           ELCCALC.                            *
   381*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   382*                            VMOD=2.025                          *
   383*                                                                *
   384*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   385*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   386*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   387*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   388*                                                                *
   389*  PASSED TO ELRTRM                                              *
   390*  -----------------                                             *
   391*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   392*  ORIGINAL TERM                                                 *
   393*  BEGINNING DATE                                                *
   394*  ENDING DATE                                                   *
   395*  COMPANY I.D.                                                  *
   396*  ACCOUNT MASTER USER FIELD                                     *
   397*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   398*  FREE LOOK DAYS                                                *
   399*                                                                *
   400*  RETURNED FROM ELRTRM                                          *
   401*  ---------------------                                         *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  10
* EL154.cbl
   402*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   403*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   404*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   405*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   406*----------------------------------------------------------------*
   407*  PASSED TO ELRAMT                                              *
   408*  ----------------                                              *
   409*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   410*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   411*  ORIGINAL AMOUNT                                               *
   412*  ALTERNATE BENEFIT (BALLON)                                    *
   413*  A.P.R. - NET PAY ONLY                                         *
   414*  METHOD
   415*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   416*  COMPANY I.D.                                                  *
   417*  BENEFIT TYPE                                                  *
   418*                                                                *
   419*  RETURNED FROM ELRAMT                                          *
   420*  --------------------                                          *
   421*  REMAINING AMOUNT 1 - CURRENT                                  *
   422*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   423*  REMAINING AMOUNT FACTOR
   424*----------------------------------------------------------------*
   425*  PASSED TO ELRESV                                              *
   426*  -----------------                                             *
   427*  CERTIFICATE EFFECTIVE DATE                                    *
   428*  VALUATION DATE                                                *
   429*  PAID THRU DATE                                                *
   430*  BENEFIT                                                       *
   431*  INCURRED DATE                                                 *
   432*  REPORTED DATE                                                 *
   433*  ISSUE AGE                                                     *
   434*  TERM                                                          *
   435*  CDT PERCENT                                                   *
   436*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   437* *CLAIM TYPE (LIFE, A/H)                                        *
   438* *REMAINING BENEFIT (FROM ELRAMT)                               *
   439* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   440*                                                                *
   441*  RETURNED FROM ELRESV                                          *
   442*  --------------------                                          *
   443*  CDT TABLE USED                                                *
   444*  CDT FACTOR USED                                               *
   445*  PAY TO CURRENT RESERVE                                        *
   446*  I.B.N.R. - A/H ONLY                                           *
   447*  FUTURE (ACCRUED) AH ONLY                                      *
   448*----------------------------------------------------------------*
   449*  PASSED TO ELRATE                                              *
   450*  ----------------                                              *
   451*  CERT ISSUE DATE                                               *
   452*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   453*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   454*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   455*  STATE CODE (CLIENT DEFINED)                                   *
   456*  STATE CODE (STANDARD P.O. ABBRV)                              *
   457*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   458*  DEVIATION CODE                                                *
   459*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  11
* EL154.cbl
   460*  ORIGINAL BENEFIT AMOUNT                                       *
   461*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   462*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   463*  BENEFIT KIND (LIFE OR A/H)                                    *
   464*  A.P.R.                                                        *
   465*  METHOD
   466*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   467*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   468*  COMPANY I.D. (3 CHARACTER)                                    *
   469*  BENEFIT CODE                                                  *
   470*  BENEFIT OVERRIDE CODE                                         *
   471*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   472*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   473*  JOINT INDICATOR (CSL ONLY)                                    *
   474*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   475*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   476*                                                                *
   477*  RETURNED FROM ELRATE                                          *
   478*  --------------------                                          *
   479*  CALCULATED PREMIUM                                            *
   480*  PREMIUM RATE                                                  *
   481*  MORTALITY CODE                                                *
   482*  MAX ATTAINED AGE                                              *
   483*  MAX AGE                                                       *
   484*  MAX TERM                                                      *
   485*  MAX MONTHLY BENEFIT                                           *
   486*  MAX TOTAL BENIFIT                                             *
   487*  COMPOSITE RATE (OPEN-END ONLY)                                *
   488*----------------------------------------------------------------*
   489*  PASSED TO ELRFND                                              *
   490*  ----------------                                              *
   491*  CERT ISSUE DATE                                               *
   492*  REFUND DATE                                                   *
   493*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   494*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   495*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   496*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   497*  STATE CODE (CLIENT DEFINED)                                   *
   498*  STATE CODE (STANDARD P.O. ABBRV)                              *
   499*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   500*  DEVIATION CODE                                                *
   501*  ISSUE AGE                                                     *
   502*  ORIGINAL BENEFIT AMOUNT                                       *
   503*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   504*  PROCESS TYPE (CANCEL)                                         *
   505*  BENEFIT KIND (LIFE OR A/H)                                    *
   506*  A.P.R.                                                        *
   507*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   508*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   509*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   510*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   511*  COMPANY I.D. (3 CHARACTER)                                    *
   512*  BENEFIT CODE                                                  *
   513*  BENEFIT OVERRIDE CODE                                         *
   514*                                                                *
   515*  RETURNED FROM ELRFND                                          *
   516*  --------------------                                          *
   517*  CALCULATED REFUND                                             *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  12
* EL154.cbl
   518*----------------------------------------------------------------*
   519*  PASSED TO ELEARN                                              *
   520*  ----------------                                              *
   521*  CERT ISSUE DATE                                               *
   522*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   523*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   524*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   525*  STATE CODE (CLIENT DEFINED)                                   *
   526*  STATE CODE (STANDARD P.O. ABBRV)                              *
   527*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   528*  DEVIATION CODE                                                *
   529*  ISSUE AGE                                                     *
   530*  ORIGINAL BENEFIT AMOUNT                                       *
   531*  BENEFIT KIND (LIFE OR A/H)                                    *
   532*  A.P.R.                                                        *
   533*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   534*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   535*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   536*  COMPANY I.D. (3 CHARACTER)                                    *
   537*  BENEFIT CODE                                                  *
   538*  BENEFIT OVERRIDE CODE                                         *
   539*                                                                *
   540*  RETURNED FROM ELEARN                                          *
   541*  --------------------                                          *
   542*  INDICATED  EARNINGS                                           *
   543*----------------------------------------------------------------*
   544*                 LENGTH = 450                                   *
   545*                                                                *
   546******************************************************************
   547******************************************************************
   548*                   C H A N G E   L O G
   549*
   550* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   551*-----------------------------------------------------------------
   552*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   553* EFFECTIVE    NUMBER
   554*-----------------------------------------------------------------
   555* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   556* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   557* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   558* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   559* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   560* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   561* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   562* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   563* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   564******************************************************************
   565
   566 01  CALCULATION-PASS-AREA.
   567     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   568                                     COMP.
   569
   570     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   571       88  NO-CP-ERROR                             VALUE ZERO.
   572       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   573                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   574       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   575       88  CP-ERROR-IN-DATES                       VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  13
* EL154.cbl
   576       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   577       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   578       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   579       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   580       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   581       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   582       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   583       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   584       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   585       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   586       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   587       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   588       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   589       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   590       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   591
   592     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   593       88  NO-CP-ERROR-2                           VALUE ZERO.
   594***********************  INPUT AREAS ****************************
   595
   596     12  CP-CALCULATION-AREA.
   597         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   598         16  CP-CERT-EFF-DT        PIC XX.
   599         16  CP-VALUATION-DT       PIC XX.
   600         16  CP-PAID-THRU-DT       PIC XX.
   601         16  CP-BENEFIT-TYPE       PIC X.
   602           88  CP-AH                               VALUE 'A' 'D'
   603                                                   'I' 'U'.
   604           88  CP-REDUCING-LIFE                    VALUE 'R'.
   605           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   606         16  CP-INCURRED-DT        PIC XX.
   607         16  CP-REPORTED-DT        PIC XX.
   608         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   609         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   610         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   611                                     COMP-3.
   612         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   613                                     COMP-3.
   614         16  CP-CDT-METHOD         PIC X.
   615           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   616           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   617           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   618         16  CP-CLAIM-TYPE         PIC X.
   619           88  CP-AH-CLAIM                         VALUE 'A'.
   620           88  CP-LIFE-CLAIM                       VALUE 'L'.
   621         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   622                                     COMP-3.
   623         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   624                                     COMP-3.
   625         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   626                                     COMP-3.
   627         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   628                                     COMP-3.
   629         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   630                                     COMP-3.
   631         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   632                                     COMP-3.
   633         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  14
* EL154.cbl
   634                                     COMP-3.
   635         16  CP-REM-TERM-METHOD    PIC X.
   636           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   637           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   638           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   639           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   640           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   641           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   642           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   643         16  CP-EARNING-METHOD     PIC X.
   644           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   645           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   646           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   647           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   648           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   649           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   650           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   651           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   652           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   653           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   654           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   655           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   656           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   657           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   658         16  CP-PROCESS-TYPE       PIC X.
   659           88  CP-CLAIM                            VALUE '1'.
   660           88  CP-CANCEL                           VALUE '2'.
   661           88  CP-ISSUE                            VALUE '3'.
   662         16  CP-SPECIAL-CALC-CD    PIC X.
   663           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   664           88  CP-1-MTH-INTEREST               VALUE ' '.
   665           88  CP-0-MTH-INTEREST               VALUE 'A'.
   666           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   667           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   668           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   669           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   670           88  CP-FARM-PLAN                    VALUE 'F'.
   671           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   672           88  CP-2-MTH-INTEREST               VALUE 'I'.
   673           88  CP-3-MTH-INTEREST               VALUE 'J'.
   674           88  CP-4-MTH-INTEREST               VALUE 'K'.
   675           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   676           88  CP-MORTGAGE-REC                 VALUE 'M'.
   677           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   678           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   679           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   680           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   681                                                     'W' 'X'.
   682           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   683           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   684           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   685           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   686           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   687           88  CP-SUMMARY-REC                  VALUE 'Z'.
   688           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   689           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   690           88  CP-AD-D-BENEFIT                 VALUE '4'.
   691           88  CP-CSL-METH-1                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  15
* EL154.cbl
   692           88  CP-CSL-METH-2                   VALUE '6'.
   693           88  CP-CSL-METH-3                   VALUE '7'.
   694           88  CP-CSL-METH-4                   VALUE '8'.
   695
   696         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   697                                     COMP-3.
   698         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   699         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   700         16  CP-STATE              PIC XX          VALUE SPACE.
   701         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   702         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   703           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   704               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   705         16  CP-R78-OPTION         PIC X.
   706           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   707           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   708
   709         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   710         16  CP-IBNR-RESERVE-SW    PIC X.
   711         16  CP-CLAIM-STATUS       PIC X.
   712         16  CP-RATE-FILE          PIC X.
   713         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   714                                     COMP-3.
   715
   716         16  CP-LIFE-OVERRIDE-CODE PIC X.
   717         16  CP-AH-OVERRIDE-CODE   PIC X.
   718
   719         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   720                                     COMP-3.
   721         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   722                                   PIC S9(5)V99 COMP-3.
   723         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   724                                     COMP-3.
   725         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   726                                     COMP-3.
   727         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   728                                     COMP-3.
   729         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   730                                  PIC S9(7)V99 COMP-3.
   731
   732         16  CP-PAID-FROM-DATE     PIC X(02).
   733         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   734         16  CP-EXT-DAYS-CALC      PIC X.
   735           88  CP-EXT-NO-CHG                   VALUE ' '.
   736           88  CP-EXT-CHG-LF                   VALUE '1'.
   737           88  CP-EXT-CHG-AH                   VALUE '2'.
   738           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   739         16  CP-DOMICILE-STATE     PIC XX.
   740         16  CP-CARRIER            PIC X.
   741         16  CP-REIN-FLAG          PIC X.
   742         16  CP-REM-TRM-CALC-OPTION PIC X.
   743           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   744                      '2' '3' '4' '5'.
   745           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   746           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   747           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   748           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   749           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  16
* EL154.cbl
   750           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   751           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   752           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   753         16  CP-SIG-SWITCH         PIC X.
   754         16  CP-RATING-METHOD      PIC X.
   755           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   756           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   757           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   758           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   759           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   760           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   761           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   762           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   763           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   764         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   765                                     COMP-3.
   766         16  CP-BEN-CATEGORY       PIC X.
   767         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   768         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   769                                   PIC S99V9(5) COMP-3.
   770         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   771         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   772                                   PIC S99V9(5) COMP-3.
   773         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   774         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   775         16  CP-EXPIRE-DT          PIC XX.
   776         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   777         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   778         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   779         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   780         16  CP-DDF-SPEC-CALC      PIC X.
   781             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   782             88  CP-CALC-CLP              VALUE 'C'.
   783         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   784         16  CP-CANCEL-REASON      PIC X.
   785         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   786         16  CP-PMT-MODE           PIC X.
   787         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   788         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   789         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   790         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   791         16  FILLER                PIC X.
   792
   793***************    OUTPUT FROM ELRESV   ************************
   794
   795         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   796
   797         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   798                                     COMP-3.
   799         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   800                                     COMP-3.
   801         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   802                                     COMP-3.
   803         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   804                                     COMP-3.
   805         16  FILLER                PIC X(09).
   806***************    OUTPUT FROM ELRTRM   *************************
   807
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  17
* EL154.cbl
   808         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   809                                     COMP-3.
   810         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   811                                     COMP-3.
   812         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   813                                     COMP-3.
   814         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   815                                     COMP-3.
   816         16  FILLER                PIC X(12).
   817
   818***************    OUTPUT FROM ELRAMT   *************************
   819
   820         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   821                                     COMP-3.
   822         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   823                                     COMP-3.
   824         16  FILLER                PIC X(12).
   825
   826***************    OUTPUT FROM ELRATE   *************************
   827
   828         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   829                                     COMP-3.
   830         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   831                                     COMP-3.
   832         16  CP-MORTALITY-CODE     PIC X(4).
   833         16  CP-RATE-EDIT-FLAG     PIC X.
   834             88  CP-RATES-NEED-APR                  VALUE '1'.
   835         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   836                                     COMP-3.
   837         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   838         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   839         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   840                                   PIC S9(7)V99 COMP-3.
   841         16  FILLER                PIC X(07).
   842
   843***************    OUTPUT FROM ELRFND   *************************
   844
   845         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   846                                     COMP-3.
   847         16  CP-REFUND-TYPE-USED   PIC X.
   848           88  CP-R-AS-R78                         VALUE '1'.
   849           88  CP-R-AS-PRORATA                     VALUE '2'.
   850           88  CP-R-AS-CALIF                       VALUE '3'.
   851           88  CP-R-AS-TEXAS                       VALUE '4'.
   852           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   853           88  CP-R-AS-NET-PAY                     VALUE '5'.
   854           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   855           88  CP-R-AS-MEAN                        VALUE '8'.
   856           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   857           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   858           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   859           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   860           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   861           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   862         16  FILLER                PIC X(12).
   863
   864***************    OUTPUT FROM ELEARN   *************************
   865
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  18
* EL154.cbl
   866         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   867                                     COMP-3.
   868         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   869                                     COMP-3.
   870         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   871                                     COMP-3.
   872         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   873                                     COMP-3.
   874         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   875                                     COMP-3.
   876         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   877                                     COMP-3.
   878         16  CP-EARNING-TYPE-USED  PIC X.
   879           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   880           88  CP-E-AS-R78                         VALUE '1'.
   881           88  CP-E-AS-PRORATA                     VALUE '2'.
   882           88  CP-E-AS-TEXAS                       VALUE '4'.
   883           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   884           88  CP-E-AS-NET-PAY                     VALUE '5'.
   885           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   886           88  CP-E-AS-MEAN                        VALUE '8'.
   887           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   888         16  FILLER                PIC X(12).
   889
   890***************    OUTPUT FROM ELPMNT   *************************
   891
   892         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   893                                     COMP-3.
   894         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   895                                     COMP-3.
   896         16  FILLER                PIC X(12).
   897
   898***************   MISC WORK AREAS    *****************************
   899         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   900                                     COMP-3.
   901         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   902                                     COMP-3.
   903         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   904                                     COMP-3.
   905         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   906                                     COMP-3.
   907         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   908                                     COMP-3.
   909         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   910                                     COMP-3.
   911         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   912             88  OPEN-RATE-FILE                   VALUE 'O'.
   913             88  CLOSE-RATE-FILE                  VALUE 'C'.
   914             88  IO-ERROR                         VALUE 'E'.
   915
   916         16  CP-FIRST-PAY-DATE     PIC XX.
   917
   918         16  CP-JOINT-INDICATOR    PIC X.
   919
   920         16  CP-RESERVE-REMAINING-TERM
   921                                   PIC S9(4)V9    VALUE ZERO
   922                                     COMP-3.
   923
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  19
* EL154.cbl
   924         16  CP-INSURED-BIRTH-DT   PIC XX.
   925
   926         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   927                                     COMP-3.
   928
   929         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   930                                     COMP-3.
   931
   932         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   933                                     COMP-3.
   934
   935         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   936                                     COMP-3.
   937
   938         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   939                                     COMP-3.
   940
   941         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   942                                     COMP-3.
   943
   944         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   945                                     COMP-3.
   946
   947         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   948             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   949
   950         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   951                                     COMP-3.
   952         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   953                                     COMP-3.
   954         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   955         16  FILLER                PIC X(15).
   956******************************************************************
   957
   958
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  20
* EL154.cbl
   960*                            COPY ELCDATE.
   961******************************************************************
   962*                                                                *
   963*                                                                *
   964*                            ELCDATE.                            *
   965*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   966*                            VMOD=2.003
   967*                                                                *
   968*                                                                *
   969*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   970*                 LENGTH = 200                                   *
   971******************************************************************
   972
   973 01  DATE-CONVERSION-DATA.
   974     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   975     12  DC-OPTION-CODE                PIC X.
   976         88  BIN-TO-GREG                VALUE ' '.
   977         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   978         88  EDIT-GREG-TO-BIN           VALUE '2'.
   979         88  YMD-GREG-TO-BIN            VALUE '3'.
   980         88  MDY-GREG-TO-BIN            VALUE '4'.
   981         88  JULIAN-TO-BIN              VALUE '5'.
   982         88  BIN-PLUS-ELAPSED           VALUE '6'.
   983         88  FIND-CENTURY               VALUE '7'.
   984         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   985         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   986         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   987         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   988         88  JULIAN-TO-BIN-3            VALUE 'C'.
   989         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   990         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   991         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   992         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   993         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   994         88  CHECK-LEAP-YEAR            VALUE 'H'.
   995         88  BIN-3-TO-GREG              VALUE 'I'.
   996         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   997         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   998         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   999         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1000         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1001         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1002         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1003         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1004         88  THREE-CHARACTER-BIN
  1005                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1006         88  GREGORIAN-TO-BIN
  1007                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1008         88  BIN-TO-GREGORIAN
  1009                  VALUES ' ' '1' 'I' '8' 'G'.
  1010         88  JULIAN-TO-BINARY
  1011                  VALUES '5' 'C' 'E' 'F'.
  1012     12  DC-ERROR-CODE                 PIC X.
  1013         88  NO-CONVERSION-ERROR        VALUE ' '.
  1014         88  DATE-CONVERSION-ERROR
  1015                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1016         88  DATE-IS-ZERO               VALUE '1'.
  1017         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  21
* EL154.cbl
  1018         88  DATE-IS-INVALID            VALUE '3'.
  1019         88  DATE1-GREATER-DATE2        VALUE '4'.
  1020         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1021         88  DATE-INVALID-OPTION        VALUE '9'.
  1022         88  INVALID-CENTURY            VALUE 'A'.
  1023         88  ONLY-CENTURY               VALUE 'B'.
  1024         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1025         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1026     12  DC-END-OF-MONTH               PIC X.
  1027         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1028     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1029         88  USE-NORMAL-PROCESS         VALUE ' '.
  1030         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1031         88  ADJUST-UP-100-YRS          VALUE '2'.
  1032     12  FILLER                        PIC X.
  1033     12  DC-CONVERSION-DATES.
  1034         16  DC-BIN-DATE-1             PIC XX.
  1035         16  DC-BIN-DATE-2             PIC XX.
  1036         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1037         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1038                       DC-GREG-DATE-1-EDIT.
  1039             20  DC-EDIT1-MONTH        PIC 99.
  1040             20  SLASH1-1              PIC X.
  1041             20  DC-EDIT1-DAY          PIC 99.
  1042             20  SLASH1-2              PIC X.
  1043             20  DC-EDIT1-YEAR         PIC 99.
  1044         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1045         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1046                     DC-GREG-DATE-2-EDIT.
  1047             20  DC-EDIT2-MONTH        PIC 99.
  1048             20  SLASH2-1              PIC X.
  1049             20  DC-EDIT2-DAY          PIC 99.
  1050             20  SLASH2-2              PIC X.
  1051             20  DC-EDIT2-YEAR         PIC 99.
  1052         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1053         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1054                     DC-GREG-DATE-1-YMD.
  1055             20  DC-YMD-YEAR           PIC 99.
  1056             20  DC-YMD-MONTH          PIC 99.
  1057             20  DC-YMD-DAY            PIC 99.
  1058         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1059         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1060                      DC-GREG-DATE-1-MDY.
  1061             20  DC-MDY-MONTH          PIC 99.
  1062             20  DC-MDY-DAY            PIC 99.
  1063             20  DC-MDY-YEAR           PIC 99.
  1064         16  DC-GREG-DATE-1-ALPHA.
  1065             20  DC-ALPHA-MONTH        PIC X(10).
  1066             20  DC-ALPHA-DAY          PIC 99.
  1067             20  FILLER                PIC XX.
  1068             20  DC-ALPHA-CENTURY.
  1069                 24 DC-ALPHA-CEN-N     PIC 99.
  1070             20  DC-ALPHA-YEAR         PIC 99.
  1071         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1072         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1073         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1074         16  DC-JULIAN-DATE            PIC 9(05).
  1075         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  22
* EL154.cbl
  1076                                       PIC 9(05).
  1077         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1078             20  DC-JULIAN-YEAR        PIC 99.
  1079             20  DC-JULIAN-DAYS        PIC 999.
  1080         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1081         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1082         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1083     12  DATE-CONVERSION-VARIBLES.
  1084         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1085         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1086             20  FILLER                PIC 9(3).
  1087             20  HOLD-CEN-1-CCYY.
  1088                 24  HOLD-CEN-1-CC     PIC 99.
  1089                 24  HOLD-CEN-1-YY     PIC 99.
  1090             20  HOLD-CEN-1-MO         PIC 99.
  1091             20  HOLD-CEN-1-DA         PIC 99.
  1092         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1093             20  HOLD-CEN-1-R-MO       PIC 99.
  1094             20  HOLD-CEN-1-R-DA       PIC 99.
  1095             20  HOLD-CEN-1-R-CCYY.
  1096                 24  HOLD-CEN-1-R-CC   PIC 99.
  1097                 24  HOLD-CEN-1-R-YY   PIC 99.
  1098             20  FILLER                PIC 9(3).
  1099         16  HOLD-CENTURY-1-X.
  1100             20  FILLER                PIC X(3)  VALUE SPACES.
  1101             20  HOLD-CEN-1-X-CCYY.
  1102                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1103                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1104             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1105             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1106         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1107             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1108             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1109             20  HOLD-CEN-1-R-X-CCYY.
  1110                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1111                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1112             20  FILLER                PIC XXX.
  1113         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1114         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1115         16  DC-JULIAN-DATE-1          PIC 9(07).
  1116         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1117             20  DC-JULIAN-1-CCYY.
  1118                 24  DC-JULIAN-1-CC    PIC 99.
  1119                 24  DC-JULIAN-1-YR    PIC 99.
  1120             20  DC-JULIAN-DA-1        PIC 999.
  1121         16  DC-JULIAN-DATE-2          PIC 9(07).
  1122         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1123             20  DC-JULIAN-2-CCYY.
  1124                 24  DC-JULIAN-2-CC    PIC 99.
  1125                 24  DC-JULIAN-2-YR    PIC 99.
  1126             20  DC-JULIAN-DA-2        PIC 999.
  1127         16  DC-GREG-DATE-A-EDIT.
  1128             20  DC-EDITA-MONTH        PIC 99.
  1129             20  SLASHA-1              PIC X VALUE '/'.
  1130             20  DC-EDITA-DAY          PIC 99.
  1131             20  SLASHA-2              PIC X VALUE '/'.
  1132             20  DC-EDITA-CCYY.
  1133                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  23
* EL154.cbl
  1134                 24  DC-EDITA-YEAR     PIC 99.
  1135         16  DC-GREG-DATE-B-EDIT.
  1136             20  DC-EDITB-MONTH        PIC 99.
  1137             20  SLASHB-1              PIC X VALUE '/'.
  1138             20  DC-EDITB-DAY          PIC 99.
  1139             20  SLASHB-2              PIC X VALUE '/'.
  1140             20  DC-EDITB-CCYY.
  1141                 24  DC-EDITB-CENT     PIC 99.
  1142                 24  DC-EDITB-YEAR     PIC 99.
  1143         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1144         16  DC-GREG-DATE-CYMD-R REDEFINES
  1145                              DC-GREG-DATE-CYMD.
  1146             20  DC-CYMD-CEN           PIC 99.
  1147             20  DC-CYMD-YEAR          PIC 99.
  1148             20  DC-CYMD-MONTH         PIC 99.
  1149             20  DC-CYMD-DAY           PIC 99.
  1150         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1151         16  DC-GREG-DATE-MDCY-R REDEFINES
  1152                              DC-GREG-DATE-MDCY.
  1153             20  DC-MDCY-MONTH         PIC 99.
  1154             20  DC-MDCY-DAY           PIC 99.
  1155             20  DC-MDCY-CEN           PIC 99.
  1156             20  DC-MDCY-YEAR          PIC 99.
  1157    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1158        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1159    12  DC-EL310-DATE                  PIC X(21).
  1160    12  FILLER                         PIC X(28).
  1161
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  24
* EL154.cbl
  1163*                            COPY ELCLOGOF.
  1164******************************************************************
  1165*                                                                *
  1166*                                                                *
  1167*                            ELCLOGOF.                           *
  1168*                            VMOD=2.001                          *
  1169*                                                                *
  1170*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1171*                                                                *
  1172******************************************************************
  1173 01  CLASIC-LOGOFF.
  1174     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1175     12  LOGOFF-TEXT.
  1176         16  FILLER          PIC X(5)    VALUE SPACES.
  1177         16  LOGOFF-MSG.
  1178             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1179             20  FILLER      PIC X       VALUE SPACES.
  1180             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1181         16  FILLER          PIC X(80)
  1182           VALUE '* YOU ARE NOW LOGGED OFF'.
  1183         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1184         16  FILLER          PIC X       VALUE QUOTE.
  1185         16  LOGOFF-SYS-MSG  PIC X(17)
  1186           VALUE 'S CLAS-IC SYSTEM '.
  1187     12  TEXT-MESSAGES.
  1188         16  UNACCESS-MSG    PIC X(29)
  1189             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1190         16  PGMIDERR-MSG    PIC X(17)
  1191             VALUE 'PROGRAM NOT FOUND'.
  1192
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  25
* EL154.cbl
  1194*                            COPY ELCATTR.
  1195******************************************************************
  1196*                                                                *
  1197*                            ELCATTR.                            *
  1198*                            VMOD=2.001                          *
  1199*                                                                *
  1200*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1201*                                                                *
  1202*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1203*                                                                *
  1204*                   POS 1   P=PROTECTED                          *
  1205*                           U=UNPROTECTED                        *
  1206*                           S=ASKIP                              *
  1207*                   POS 2   A=ALPHA/NUMERIC                      *
  1208*                           N=NUMERIC                            *
  1209*                   POS 3   N=NORMAL                             *
  1210*                           B=BRIGHT                             *
  1211*                           D=DARK                               *
  1212*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1213*                           OF=MODIFIED DATA TAG OFF             *
  1214*                                                                *
  1215*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1216******************************************************************
  1217 01  ATTRIBUTE-LIST.
  1218     12  AL-PABOF            PIC X       VALUE 'Y'.
  1219     12  AL-PABON            PIC X       VALUE 'Z'.
  1220     12  AL-PADOF            PIC X       VALUE '%'.
  1221     12  AL-PADON            PIC X       VALUE '_'.
  1222     12  AL-PANOF            PIC X       VALUE '-'.
  1223     12  AL-PANON            PIC X       VALUE '/'.
  1224     12  AL-SABOF            PIC X       VALUE '8'.
  1225     12  AL-SABON            PIC X       VALUE '9'.
  1226     12  AL-SADOF            PIC X       VALUE '@'.
  1227     12  AL-SADON            PIC X       VALUE QUOTE.
  1228     12  AL-SANOF            PIC X       VALUE '0'.
  1229     12  AL-SANON            PIC X       VALUE '1'.
  1230     12  AL-UABOF            PIC X       VALUE 'H'.
  1231     12  AL-UABON            PIC X       VALUE 'I'.
  1232     12  AL-UADOF            PIC X       VALUE '<'.
  1233     12  AL-UADON            PIC X       VALUE '('.
  1234     12  AL-UANOF            PIC X       VALUE ' '.
  1235     12  AL-UANON            PIC X       VALUE 'A'.
  1236     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1237     12  AL-UNBON            PIC X       VALUE 'R'.
  1238     12  AL-UNDOF            PIC X       VALUE '*'.
  1239     12  AL-UNDON            PIC X       VALUE ')'.
  1240     12  AL-UNNOF            PIC X       VALUE '&'.
  1241     12  AL-UNNON            PIC X       VALUE 'J'.
  1242
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  26
* EL154.cbl
  1244*                            COPY ELCEMIB.
  1245******************************************************************
  1246*                                                                *
  1247*                                                                *
  1248*                            ELCEMIB.                            *
  1249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1250*                            VMOD=2.005                          *
  1251*                                                                *
  1252*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1253*                                                                *
  1254******************************************************************
  1255 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1256     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1257     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1258     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1259     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1260     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1261     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1262     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1263     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1264     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1265         88  EMI-NO-ERRORS                    VALUE '1'.
  1266         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1267         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1268     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1269         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1270     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1271         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1272         88  EMI-AREA1-FULL                   VALUE '2'.
  1273     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1274         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1275         88  EMI-AREA2-FULL                   VALUE '2'.
  1276     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1277         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1278         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1279         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1280         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1281         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1282     12  EMI-ERROR-LINES.
  1283         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1284         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1285         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1286         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1287             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1288                 24  EMI-ERR-NUM         PIC X(4).
  1289                 24  EMI-FILLER          PIC X.
  1290                 24  EMI-SEV             PIC X.
  1291                 24  FILLER              PIC X.
  1292             20  FILLER                  PIC X(02).
  1293     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1294         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1295             20  EMI-ERROR-NUMBER    PIC X(4).
  1296             20  EMI-FILL            PIC X.
  1297             20  EMI-SEVERITY        PIC X.
  1298             20  FILLER              PIC X.
  1299             20  EMI-ERROR-TEXT.
  1300                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1301                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  27
* EL154.cbl
  1302     12  EMI-SEVERITY-SAVE           PIC X.
  1303         88  EMI-NOTE                    VALUE 'N'.
  1304         88  EMI-WARNING                 VALUE 'W'.
  1305         88  EMI-FORCABLE                VALUE 'F'.
  1306         88  EMI-FATAL                   VALUE 'X'.
  1307     12  EMI-MESSAGE-FLAG            PIC X.
  1308         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1309         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1310     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1311     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1312         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1313         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1314         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1315     12  emi-claim-no                pic x(7).
  1316     12  emi-claim-type              pic x(6).
  1317     12  FILLER                      PIC X(124)  VALUE SPACES.
  1318     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1319     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1320     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1321     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  28
* EL154.cbl
  1323*                            COPY ELCLNKLT.
  1324******************************************************************
  1325*                                                                *
  1326*                                                                *
  1327*                           ELCLNKLT                             *
  1328*                            VMOD=2.003                          *
  1329*                                                                *
  1330*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1331*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1332*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1333*                                                                *
  1334*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1335*   COMPLETING THE REQUIRED FIELDS.                              *
  1336*                                                                *
  1337*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1338*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1339*                              9999 INDICATES AN UNKNOWN ABEND   *
  1340*                                   WAS DETECTED.                *
  1341*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1342*                              CODES FOUND IN THE ERROR FILE.    *
  1343******************************************************************
  1344 01  W-1523-LINKDATA.
  1345     12  W-1523-COMMON-PI-DATA.
  1346         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1347         16  FILLER              PIC  X(67).
  1348         16  W-1523-COMPANY-CD   PIC  X(01).
  1349         16  FILLER              PIC  X(10).
  1350         16  W-1523-CONTROL-IN-PROGRESS.
  1351             20  W-1523-CARRIER  PIC  X(01).
  1352             20  W-1523-GROUPING PIC  X(06).
  1353             20  W-1523-STATE    PIC  X(02).
  1354             20  W-1523-ACCOUNT  PIC  X(10).
  1355             20  W-1523-CLAIM-CERT-GRP.
  1356                 24  W-1523-CLAIM-NO
  1357                                 PIC  X(07).
  1358                 24  W-1523-CERT-NO.
  1359                     28  W-1523-CERT-PRIME
  1360                                 PIC  X(10).
  1361                     28  W-1523-CERT-SFX
  1362                                 PIC  X(01).
  1363                 24  W-1523-CERT-EFF-DT
  1364                                 PIC  X(02).
  1365         16  FILLER              PIC X(265).
  1366
  1367     12  W-1523-WORK-AREA.
  1368         16  W-1523-FORM-NUMBER  PIC  X(04).
  1369         16  W-1523-NUMBER-COPIES
  1370                                 PIC  9(01).
  1371         16  W-1523-ADDR-TYPE    PIC  X(02).
  1372         16  W-1523-FOLLOW-UP-DATE
  1373                                 PIC  X(02).
  1374         16  W-1523-RESEND-DATE  PIC  X(02).
  1375         16  W-1523-ERROR-CODE   PIC  9(04).
  1376             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1377             88  W-1523-FATAL-ERROR
  1378                                    VALUES  0006 0013 0042
  1379                                            0154 0168 0169
  1380                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  29
* EL154.cbl
  1381                                            0179 0186 0281
  1382                                            0332 2055 3697
  1383                                            3698 3699 3770
  1384                                            3771 3772 7675
  1385                                            9106 9808 9883
  1386                                            9887.
  1387             88  W-1523-STOP-ERRORS
  1388                                    VALUES  0013 0042 0154
  1389                                            0168 0169 0172
  1390                                            0281 0332 2055
  1391                                            3698 3699 7675
  1392                                            9106 9808 9883
  1393                                            9999.
  1394         16  W-1523-REASON       PIC  X(70).
  1395         16  W-1523-ARCHIVE-NUMBER
  1396                                 PIC  9(08).
  1397     12  W-1523-POINTER-AREA.
  1398         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1399         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1400         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1401         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1402         16  W-1523-PROD-POINTER PIC S9(08) COMP.
  1403
  1404     12  W-1523-LETTER-DATE       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  30
* EL154.cbl
  1406*                            COPY ELCINTF.
  1407******************************************************************
  1408*                                                                *
  1409*                                                                *
  1410*                            ELCINTF.                            *
  1411*                            VMOD=2.017                          *
  1412*                                                                *
  1413*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1414*                                                                *
  1415*       LENGTH = 1024                                            *
  1416*                                                                *
  1417******************************************************************
  1418*                   C H A N G E   L O G
  1419*
  1420* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1421*-----------------------------------------------------------------
  1422*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1423* EFFECTIVE    NUMBER
  1424*-----------------------------------------------------------------
  1425* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1426******************************************************************
  1427 01  PROGRAM-INTERFACE-BLOCK.
  1428     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1429     12  PI-CALLING-PROGRAM              PIC X(8).
  1430     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1431     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1432     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1433     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1434     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1435     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1436     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1437     12  PI-COMPANY-ID                   PIC XXX.
  1438     12  PI-COMPANY-CD                   PIC X.
  1439
  1440     12  PI-COMPANY-PASSWORD             PIC X(8).
  1441
  1442     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1443
  1444     12  PI-CONTROL-IN-PROGRESS.
  1445         16  PI-CARRIER                  PIC X.
  1446         16  PI-GROUPING                 PIC X(6).
  1447         16  PI-STATE                    PIC XX.
  1448         16  PI-ACCOUNT                  PIC X(10).
  1449         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1450                                         PIC X(10).
  1451         16  PI-CLAIM-CERT-GRP.
  1452             20  PI-CLAIM-NO             PIC X(7).
  1453             20  PI-CERT-NO.
  1454                 25  PI-CERT-PRIME       PIC X(10).
  1455                 25  PI-CERT-SFX         PIC X.
  1456             20  PI-CERT-EFF-DT          PIC XX.
  1457         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1458             20  PI-PLAN-CODE            PIC X(2).
  1459             20  PI-REVISION-NUMBER      PIC X(3).
  1460             20  PI-PLAN-EFF-DT          PIC X(2).
  1461             20  PI-PLAN-EXP-DT          PIC X(2).
  1462             20  FILLER                  PIC X(11).
  1463         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  31
* EL154.cbl
  1464             20  PI-OE-REFERENCE-1.
  1465                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1466                 25  PI-OE-REF-1-SUFF    PIC XX.
  1467
  1468     12  PI-SESSION-IN-PROGRESS          PIC X.
  1469         88  CLAIM-SESSION                   VALUE '1'.
  1470         88  CREDIT-SESSION                  VALUE '2'.
  1471         88  WARRANTY-SESSION                VALUE '3'.
  1472         88  MORTGAGE-SESSION                VALUE '4'.
  1473         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1474
  1475
  1476*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1477
  1478     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1479     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1480
  1481     12  PI-CREDIT-USER                  PIC X.
  1482         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1483         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1484
  1485     12  PI-CLAIM-USER                   PIC X.
  1486         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1487         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1488
  1489     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1490         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1491         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1492         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1493         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1494         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1495
  1496     12  PI-PROCESSOR-ID                 PIC X(4).
  1497
  1498     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1499
  1500     12  PI-MEMBER-CAPTION               PIC X(10).
  1501
  1502     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1503         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1504
  1505     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1506     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1507     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1508     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1509
  1510     12  PI-AH-OVERRIDE-L1               PIC X.
  1511     12  PI-AH-OVERRIDE-L2               PIC XX.
  1512     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1513     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1514
  1515     12  PI-NEW-SYSTEM                   PIC X(2).
  1516
  1517     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1518     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1519         88  PI-USES-PAID-TO                 VALUE '1'.
  1520     12  PI-CRDTCRD-SYSTEM.
  1521         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  32
* EL154.cbl
  1522             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1523             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1524         16  PI-CC-MONTH-END-DT          PIC XX.
  1525     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1526
  1527     12  PI-OE-REFERENCE-2.
  1528         16  PI-OE-REF-2-PRIME           PIC X(10).
  1529         16  PI-OE-REF-2-SUFF            PIC X.
  1530
  1531     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1532
  1533     12  PI-LANGUAGE-TYPE                PIC X.
  1534             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1535             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1536             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1537
  1538     12  PI-POLICY-LINKAGE-IND           PIC X.
  1539         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1540         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1541                                                   LOW-VALUES.
  1542
  1543     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1544     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1545         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1546         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1547
  1548     12  PI-PROCESSOR-CSR-IND            PIC X.
  1549         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1550         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1551
  1552     12  FILLER                          PIC X(3).
  1553
  1554     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1555
  1556     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1557         PI-SYSTEM-LEVEL.
  1558
  1559         16  PI-ENTRY-CODES.
  1560             20  PI-ENTRY-CD-1           PIC X.
  1561             20  PI-ENTRY-CD-2           PIC X.
  1562
  1563         16  PI-RETURN-CODES.
  1564             20  PI-RETURN-CD-1          PIC X.
  1565             20  PI-RETURN-CD-2          PIC X.
  1566
  1567         16  PI-UPDATE-STATUS-SAVE.
  1568             20  PI-UPDATE-BY            PIC X(4).
  1569             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1570
  1571         16  PI-LOWER-CASE-LETTERS       PIC X.
  1572             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1573
  1574*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1575*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1576*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1577
  1578         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1579             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  33
* EL154.cbl
  1580             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1581             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1582             88  ACCNT-CNTL                  VALUE '3'.
  1583             88  CARR-ACCNT-CNTL             VALUE '4'.
  1584
  1585         16  PI-PROCESSOR-CAP-LIST.
  1586             20  PI-SYSTEM-CONTROLS.
  1587                24 PI-SYSTEM-DISPLAY     PIC X.
  1588                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1589                24 PI-SYSTEM-MODIFY      PIC X.
  1590                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1591             20  FILLER                  PIC XX.
  1592             20  PI-DISPLAY-CAP          PIC X.
  1593                 88  DISPLAY-CAP             VALUE 'Y'.
  1594             20  PI-MODIFY-CAP           PIC X.
  1595                 88  MODIFY-CAP              VALUE 'Y'.
  1596             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1597                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1598             20  PI-FORCE-CAP            PIC X.
  1599                 88  FORCE-CAP               VALUE 'Y'.
  1600
  1601         16  PI-PROGRAM-CONTROLS.
  1602             20  PI-PGM-PRINT-OPT        PIC X.
  1603             20  PI-PGM-FORMAT-OPT       PIC X.
  1604             20  PI-PGM-PROCESS-OPT      PIC X.
  1605             20  PI-PGM-TOTALS-OPT       PIC X.
  1606
  1607         16  PI-HELP-INTERFACE.
  1608             20  PI-LAST-ERROR-NO        PIC X(4).
  1609             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1610
  1611         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1612             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1613
  1614         16  PI-CR-CONTROL-IN-PROGRESS.
  1615             20  PI-CR-CARRIER           PIC X.
  1616             20  PI-CR-GROUPING          PIC X(6).
  1617             20  PI-CR-STATE             PIC XX.
  1618             20  PI-CR-ACCOUNT           PIC X(10).
  1619             20  PI-CR-FIN-RESP          PIC X(10).
  1620             20  PI-CR-TYPE              PIC X.
  1621
  1622         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1623
  1624         16  PI-CR-MONTH-END-DT          PIC XX.
  1625
  1626         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1627             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1628             88  PI-ZERO-CARRIER             VALUE '1'.
  1629             88  PI-ZERO-GROUPING            VALUE '2'.
  1630             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1631
  1632         16  PI-CARRIER-SECURITY         PIC X.
  1633             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1634
  1635         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1636             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1637             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  34
* EL154.cbl
  1638
  1639         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1640             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1641                                         INDEXED BY PI-ACCESS-NDX
  1642                                         PIC X.
  1643
  1644         16  PI-GA-BILLING-CONTROL       PIC X.
  1645             88  PI-GA-BILLING               VALUE '1'.
  1646
  1647         16  PI-MAIL-PROCESSING          PIC X.
  1648             88  PI-MAIL-YES                 VALUE 'Y'.
  1649
  1650         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1651
  1652         16  PI-AR-SYSTEM.
  1653             20  PI-AR-PROCESSING-CNTL   PIC X.
  1654                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1655             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1656             20  PI-AR-MONTH-END-DT      PIC XX.
  1657
  1658         16  PI-MP-SYSTEM.
  1659             20  PI-MORTGAGE-USER            PIC X.
  1660                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1661                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1662             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1663                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1664                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1665                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1666                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1667                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1668             20  PI-MP-MONTH-END-DT          PIC XX.
  1669             20  PI-MP-REFERENCE-NO.
  1670                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1671                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1672
  1673         16  PI-LABEL-CONTROL            PIC X(01).
  1674             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1675             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1676
  1677         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1678             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1679
  1680         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1681             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1682             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1683
  1684         16  FILLER                      PIC X(14).
  1685
  1686     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1687******************************************************************
  1688     12  PI-REDEF       REDEFINES PI-PROGRAM-WORK-AREA.
  1689         16  PI-BENEFIT-SAVE.
  1690             18  PI-BEN-DAYS      PIC 99.
  1691             18  PI-BEN-TYPE      PIC X.
  1692*00269   16  FILLER               PIC X(637).
  1693         16  PI-AUTO-END-LETTER   PIC X(04).
  1694         16  FILLER               PIC X(633).
  1695
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  35
* EL154.cbl
  1697*                            COPY ELCAID.
  1698******************************************************************
  1699*                                                                *
  1700*                            ELCAID.                             *
  1701*                            VMOD=2.001                          *
  1702*                                                                *
  1703*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1704*                                                                *
  1705*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1706*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1707******************************************************************
  1708
  1709 01  DFHAID.
  1710   02  DFHNULL   PIC  X  VALUE  ' '.
  1711   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1712   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1713   02  DFHPEN    PIC  X  VALUE  '='.
  1714   02  DFHOPID   PIC  X  VALUE  'W'.
  1715   02  DFHPA1    PIC  X  VALUE  '%'.
  1716   02  DFHPA2    PIC  X  VALUE  '>'.
  1717   02  DFHPA3    PIC  X  VALUE  ','.
  1718   02  DFHPF1    PIC  X  VALUE  '1'.
  1719   02  DFHPF2    PIC  X  VALUE  '2'.
  1720   02  DFHPF3    PIC  X  VALUE  '3'.
  1721   02  DFHPF4    PIC  X  VALUE  '4'.
  1722   02  DFHPF5    PIC  X  VALUE  '5'.
  1723   02  DFHPF6    PIC  X  VALUE  '6'.
  1724   02  DFHPF7    PIC  X  VALUE  '7'.
  1725   02  DFHPF8    PIC  X  VALUE  '8'.
  1726   02  DFHPF9    PIC  X  VALUE  '9'.
  1727   02  DFHPF10   PIC  X  VALUE  ':'.
  1728   02  DFHPF11   PIC  X  VALUE  '#'.
  1729   02  DFHPF12   PIC  X  VALUE  '@'.
  1730   02  DFHPF13   PIC  X  VALUE  'A'.
  1731   02  DFHPF14   PIC  X  VALUE  'B'.
  1732   02  DFHPF15   PIC  X  VALUE  'C'.
  1733   02  DFHPF16   PIC  X  VALUE  'D'.
  1734   02  DFHPF17   PIC  X  VALUE  'E'.
  1735   02  DFHPF18   PIC  X  VALUE  'F'.
  1736   02  DFHPF19   PIC  X  VALUE  'G'.
  1737   02  DFHPF20   PIC  X  VALUE  'H'.
  1738   02  DFHPF21   PIC  X  VALUE  'I'.
  1739*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1740   02  DFHPF22   PIC  X  VALUE  '['.
  1741   02  DFHPF23   PIC  X  VALUE  '.'.
  1742   02  DFHPF24   PIC  X  VALUE  '<'.
  1743   02  DFHMSRE   PIC  X  VALUE  'X'.
  1744   02  DFHSTRF   PIC  X  VALUE  'h'.
  1745   02  DFHTRIG   PIC  X  VALUE  '"'.
  1746 01  FILLER    REDEFINES DFHAID.
  1747     12  FILLER              PIC X(8).
  1748     12  PF-VALUES           PIC X       OCCURS 2.
  1749
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  36
* EL154.cbl
  1751*                            COPY EL154S.
  1752 01  EL154AI.
  1753     05  FILLER            PIC  X(0012).
  1754*    -------------------------------
  1755     05  RUNDTEL PIC S9(0004) COMP.
  1756     05  RUNDTEF PIC  X(0001).
  1757     05  FILLER REDEFINES RUNDTEF.
  1758         10  RUNDTEA PIC  X(0001).
  1759     05  RUNDTEI PIC  X(0008).
  1760*    -------------------------------
  1761     05  RUNTIMEL PIC S9(0004) COMP.
  1762     05  RUNTIMEF PIC  X(0001).
  1763     05  FILLER REDEFINES RUNTIMEF.
  1764         10  RUNTIMEA PIC  X(0001).
  1765     05  RUNTIMEI PIC  X(0005).
  1766*    -------------------------------
  1767     05  CLAIML PIC S9(0004) COMP.
  1768     05  CLAIMF PIC  X(0001).
  1769     05  FILLER REDEFINES CLAIMF.
  1770         10  CLAIMA PIC  X(0001).
  1771     05  CLAIMI PIC  X(0007).
  1772*    -------------------------------
  1773     05  CARRL PIC S9(0004) COMP.
  1774     05  CARRF PIC  X(0001).
  1775     05  FILLER REDEFINES CARRF.
  1776         10  CARRA PIC  X(0001).
  1777     05  CARRI PIC  X(0001).
  1778*    -------------------------------
  1779     05  CERTL PIC S9(0004) COMP.
  1780     05  CERTF PIC  X(0001).
  1781     05  FILLER REDEFINES CERTF.
  1782         10  CERTA PIC  X(0001).
  1783     05  CERTI PIC  X(0010).
  1784*    -------------------------------
  1785     05  SUFFIXL PIC S9(0004) COMP.
  1786     05  SUFFIXF PIC  X(0001).
  1787     05  FILLER REDEFINES SUFFIXF.
  1788         10  SUFFIXA PIC  X(0001).
  1789     05  SUFFIXI PIC  X(0001).
  1790*    -------------------------------
  1791     05  CESTDTEL PIC S9(0004) COMP.
  1792     05  CESTDTEF PIC  X(0001).
  1793     05  FILLER REDEFINES CESTDTEF.
  1794         10  CESTDTEA PIC  X(0001).
  1795     05  CESTDTEI PIC  X(0008).
  1796*    -------------------------------
  1797     05  CESTBYL PIC S9(0004) COMP.
  1798     05  CESTBYF PIC  X(0001).
  1799     05  FILLER REDEFINES CESTBYF.
  1800         10  CESTBYA PIC  X(0001).
  1801     05  CESTBYI PIC  X(0004).
  1802*    -------------------------------
  1803     05  FSTHD1L PIC S9(0004) COMP.
  1804     05  FSTHD1F PIC  X(0001).
  1805     05  FILLER REDEFINES FSTHD1F.
  1806         10  FSTHD1A PIC  X(0001).
  1807     05  FSTHD1I PIC  X(0023).
  1808*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  37
* EL154.cbl
  1809     05  CFSTPMTL PIC S9(0004) COMP.
  1810     05  CFSTPMTF PIC  X(0001).
  1811     05  FILLER REDEFINES CFSTPMTF.
  1812         10  CFSTPMTA PIC  X(0001).
  1813     05  CFSTPMTI PIC  X(0008).
  1814*    -------------------------------
  1815     05  CMONTHSL PIC S9(0004) COMP.
  1816     05  CMONTHSF PIC  X(0001).
  1817     05  FILLER REDEFINES CMONTHSF.
  1818         10  CMONTHSA PIC  X(0001).
  1819     05  CMONTHSI PIC  X(0002).
  1820*    -------------------------------
  1821     05  CFSTAMTL PIC S9(0004) COMP.
  1822     05  CFSTAMTF PIC  X(0001).
  1823     05  FILLER REDEFINES CFSTAMTF.
  1824         10  CFSTAMTA PIC  X(0001).
  1825     05  CFSTAMTI PIC  X(0009).
  1826*    -------------------------------
  1827     05  LSTHD1L PIC S9(0004) COMP.
  1828     05  LSTHD1F PIC  X(0001).
  1829     05  FILLER REDEFINES LSTHD1F.
  1830         10  LSTHD1A PIC  X(0001).
  1831     05  LSTHD1I PIC  X(0024).
  1832*    -------------------------------
  1833     05  CLSTPMTL PIC S9(0004) COMP.
  1834     05  CLSTPMTF PIC  X(0001).
  1835     05  FILLER REDEFINES CLSTPMTF.
  1836         10  CLSTPMTA PIC  X(0001).
  1837     05  CLSTPMTI PIC  X(0008).
  1838*    -------------------------------
  1839     05  CLASTL PIC S9(0004) COMP.
  1840     05  CLASTF PIC  X(0001).
  1841     05  FILLER REDEFINES CLASTF.
  1842         10  CLASTA PIC  X(0001).
  1843     05  CLASTI PIC  X(0001).
  1844*    -------------------------------
  1845     05  CREGPMTL PIC S9(0004) COMP.
  1846     05  CREGPMTF PIC  X(0001).
  1847     05  FILLER REDEFINES CREGPMTF.
  1848         10  CREGPMTA PIC  X(0001).
  1849     05  CREGPMTI PIC  X(0009).
  1850*    -------------------------------
  1851     05  CDAYSFL PIC S9(0004) COMP.
  1852     05  CDAYSFF PIC  X(0001).
  1853     05  FILLER REDEFINES CDAYSFF.
  1854         10  CDAYSFA PIC  X(0001).
  1855     05  CDAYSFI PIC  X(0003).
  1856*    -------------------------------
  1857     05  CPAYEEL PIC S9(0004) COMP.
  1858     05  CPAYEEF PIC  X(0001).
  1859     05  FILLER REDEFINES CPAYEEF.
  1860         10  CPAYEEA PIC  X(0001).
  1861     05  CPAYEEI PIC  X(0008).
  1862*    -------------------------------
  1863     05  DAY2PAYL PIC S9(0004) COMP.
  1864     05  DAY2PAYF PIC  X(0001).
  1865     05  FILLER REDEFINES DAY2PAYF.
  1866         10  DAY2PAYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  38
* EL154.cbl
  1867     05  DAY2PAYI PIC  99.
  1868*    -------------------------------
  1869     05  CEFFDTEL PIC S9(0004) COMP.
  1870     05  CEFFDTEF PIC  X(0001).
  1871     05  FILLER REDEFINES CEFFDTEF.
  1872         10  CEFFDTEA PIC  X(0001).
  1873     05  CEFFDTEI PIC  X(0008).
  1874*    -------------------------------
  1875     05  TERML PIC S9(0004) COMP.
  1876     05  TERMF PIC  X(0001).
  1877     05  FILLER REDEFINES TERMF.
  1878         10  TERMA PIC  X(0001).
  1879     05  TERMI PIC  X(0001).
  1880*    -------------------------------
  1881     05  CINDCTRL PIC S9(0004) COMP.
  1882     05  CINDCTRF PIC  X(0001).
  1883     05  FILLER REDEFINES CINDCTRF.
  1884         10  CINDCTRA PIC  X(0001).
  1885     05  CINDCTRI PIC  X(0001).
  1886*    -------------------------------
  1887     05  PRINTL PIC S9(0004) COMP.
  1888     05  PRINTF PIC  X(0001).
  1889     05  FILLER REDEFINES PRINTF.
  1890         10  PRINTA PIC  X(0001).
  1891     05  PRINTI PIC  X(0004).
  1892*    -------------------------------
  1893     05  FSTHD2L PIC S9(0004) COMP.
  1894     05  FSTHD2F PIC  X(0001).
  1895     05  FILLER REDEFINES FSTHD2F.
  1896         10  FSTHD2A PIC  X(0001).
  1897     05  FSTHD2I PIC  X(0023).
  1898*    -------------------------------
  1899     05  NFSTPMTL PIC S9(0004) COMP.
  1900     05  NFSTPMTF PIC  X(0001).
  1901     05  FILLER REDEFINES NFSTPMTF.
  1902         10  NFSTPMTA PIC  X(0001).
  1903     05  NFSTPMTI PIC  X(0008).
  1904*    -------------------------------
  1905     05  NFSTAMTL PIC S9(0004) COMP.
  1906     05  NFSTAMTF PIC  X(0001).
  1907     05  FILLER REDEFINES NFSTAMTF.
  1908         10  NFSTAMTA PIC  X(0001).
  1909     05  NFSTAMTI PIC  S9(8)V99.
  1910*    -------------------------------
  1911     05  LSTHD2L PIC S9(0004) COMP.
  1912     05  LSTHD2F PIC  X(0001).
  1913     05  FILLER REDEFINES LSTHD2F.
  1914         10  LSTHD2A PIC  X(0001).
  1915     05  LSTHD2I PIC  X(0023).
  1916*    -------------------------------
  1917     05  NLSTPMTL PIC S9(0004) COMP.
  1918     05  NLSTPMTF PIC  X(0001).
  1919     05  FILLER REDEFINES NLSTPMTF.
  1920         10  NLSTPMTA PIC  X(0001).
  1921     05  NLSTPMTI PIC  X(0008).
  1922*    -------------------------------
  1923     05  NEFFDTEL PIC S9(0004) COMP.
  1924     05  NEFFDTEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  39
* EL154.cbl
  1925     05  FILLER REDEFINES NEFFDTEF.
  1926         10  NEFFDTEA PIC  X(0001).
  1927     05  NEFFDTEI PIC  X(0008).
  1928*    -------------------------------
  1929     05  NMONTHSL PIC S9(0004) COMP.
  1930     05  NMONTHSF PIC  X(0001).
  1931     05  FILLER REDEFINES NMONTHSF.
  1932         10  NMONTHSA PIC  X(0001).
  1933     05  NMONTHSI PIC  99.
  1934*    -------------------------------
  1935     05  NDAYSFL PIC S9(0004) COMP.
  1936     05  NDAYSFF PIC  X(0001).
  1937     05  FILLER REDEFINES NDAYSFF.
  1938         10  NDAYSFA PIC  X(0001).
  1939     05  NDAYSFI PIC  999.
  1940*    -------------------------------
  1941     05  NPAYEEL PIC S9(0004) COMP.
  1942     05  NPAYEEF PIC  X(0001).
  1943     05  FILLER REDEFINES NPAYEEF.
  1944         10  NPAYEEA PIC  X(0001).
  1945     05  NPAYEEI PIC  X(0002).
  1946*    -------------------------------
  1947     05  NREGAMTL PIC S9(0004) COMP.
  1948     05  NREGAMTF PIC  X(0001).
  1949     05  FILLER REDEFINES NREGAMTF.
  1950         10  NREGAMTA PIC  X(0001).
  1951     05  NREGAMTI PIC  X(0010).
  1952*    -------------------------------
  1953     05  NLASTL PIC S9(0004) COMP.
  1954     05  NLASTF PIC  X(0001).
  1955     05  FILLER REDEFINES NLASTF.
  1956         10  NLASTA PIC  X(0001).
  1957     05  NLASTI PIC  X(0001).
  1958*    -------------------------------
  1959     05  NINDCTRL PIC S9(0004) COMP.
  1960     05  NINDCTRF PIC  X(0001).
  1961     05  FILLER REDEFINES NINDCTRF.
  1962         10  NINDCTRA PIC  X(0001).
  1963     05  NINDCTRI PIC  X(0001).
  1964*    -------------------------------
  1965     05  DAYPAYL PIC S9(0004) COMP.
  1966     05  DAYPAYF PIC  X(0001).
  1967     05  FILLER REDEFINES DAYPAYF.
  1968         10  DAYPAYA PIC  X(0001).
  1969     05  DAYPAYI PIC  99.
  1970*    -------------------------------
  1971     05  NPRINTL PIC S9(0004) COMP.
  1972     05  NPRINTF PIC  X(0001).
  1973     05  FILLER REDEFINES NPRINTF.
  1974         10  NPRINTA PIC  X(0001).
  1975     05  NPRINTI PIC  X(0004).
  1976*    -------------------------------
  1977     05  LETTDTEL PIC S9(0004) COMP.
  1978     05  LETTDTEF PIC  X(0001).
  1979     05  FILLER REDEFINES LETTDTEF.
  1980         10  LETTDTEA PIC  X(0001).
  1981     05  LETTDTEI PIC  X(0008).
  1982*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  40
* EL154.cbl
  1983     05  ENDLETTL PIC S9(0004) COMP.
  1984     05  ENDLETTF PIC  X(0001).
  1985     05  FILLER REDEFINES ENDLETTF.
  1986         10  ENDLETTA PIC  X(0001).
  1987     05  ENDLETTI PIC  X(0004).
  1988*    -------------------------------
  1989     05  ERRMSG1L PIC S9(0004) COMP.
  1990     05  ERRMSG1F PIC  X(0001).
  1991     05  FILLER REDEFINES ERRMSG1F.
  1992         10  ERRMSG1A PIC  X(0001).
  1993     05  ERRMSG1I PIC  X(0079).
  1994*    -------------------------------
  1995     05  ERRMSG2L PIC S9(0004) COMP.
  1996     05  ERRMSG2F PIC  X(0001).
  1997     05  FILLER REDEFINES ERRMSG2F.
  1998         10  ERRMSG2A PIC  X(0001).
  1999     05  ERRMSG2I PIC  X(0079).
  2000*    -------------------------------
  2001     05  ENTERPFL PIC S9(0004) COMP.
  2002     05  ENTERPFF PIC  X(0001).
  2003     05  FILLER REDEFINES ENTERPFF.
  2004         10  ENTERPFA PIC  X(0001).
  2005     05  ENTERPFI PIC  99.
  2006 01  EL154AO REDEFINES EL154AI.
  2007     05  FILLER            PIC  X(0012).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  RUNDTEO PIC  X(0008).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  RUNTIMEO PIC  99.99.
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  CLAIMO PIC  X(0007).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  CARRO PIC  X(0001).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  CERTO PIC  X(0010).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  SUFFIXO PIC  X(0001).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  CESTDTEO PIC  X(0008).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  CESTBYO PIC  X(0004).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  FSTHD1O PIC  X(0023).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  CFSTPMTO PIC  X(0008).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  CMONTHSO PIC  99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  41
* EL154.cbl
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  CFSTAMTO PIC  ZZ,ZZ9.99.
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  LSTHD1O PIC  X(0024).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  CLSTPMTO PIC  X(0008).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  CLASTO PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  CREGPMTO PIC  ZZ,ZZ9.99.
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  CDAYSFO PIC  ZZ9.
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  CPAYEEO PIC  X(0008).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  DAY2PAYO PIC  X(0002).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  CEFFDTEO PIC  X(0008).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  TERMO PIC  X(0001).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  CINDCTRO PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  PRINTO PIC  X(0004).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  FSTHD2O PIC  X(0023).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  NFSTPMTO PIC  99B99B99.
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  NFSTAMTO PIC  ZZ,ZZZ.99-.
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  LSTHD2O PIC  X(0023).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  NLSTPMTO PIC  99B99B99.
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  NEFFDTEO PIC  99B99B99.
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  NMONTHSO PIC  X(0002).
  2098*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  42
* EL154.cbl
  2099     05  FILLER            PIC  X(0003).
  2100     05  NDAYSFO PIC  X(0003).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  NPAYEEO PIC  X(0002).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  NREGAMTO PIC  ZZ,ZZZ.99-.
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  NLASTO PIC  X(0001).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  NINDCTRO PIC  X(0001).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  DAYPAYO PIC  X(0002).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  NPRINTO PIC  X(0004).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  LETTDTEO PIC  99B99B99.
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  ENDLETTO PIC  X(0004).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  ERRMSG1O PIC  X(0079).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  ERRMSG2O PIC  X(0079).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  ENTERPFO PIC  X(0002).
  2134*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  43
* EL154.cbl
  2136****************************************************************
  2137*
  2138* Copyright (c) 2007 by Clerity Solutions, Inc.
  2139* All rights reserved.
  2140*
  2141****************************************************************
  2142 01  DFHEIV.
  2143   02  DFHEIV0               PIC X(35).
  2144   02  DFHEIV1               PIC X(08).
  2145   02  DFHEIV2               PIC X(08).
  2146   02  DFHEIV3               PIC X(08).
  2147   02  DFHEIV4               PIC X(06).
  2148   02  DFHEIV5               PIC X(04).
  2149   02  DFHEIV6               PIC X(04).
  2150   02  DFHEIV7               PIC X(02).
  2151   02  DFHEIV8               PIC X(02).
  2152   02  DFHEIV9               PIC X(01).
  2153   02  DFHEIV10              PIC S9(7) COMP-3.
  2154   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2155   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2156   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2157   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2158   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2159   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2160   02  DFHEIV17              PIC X(04).
  2161   02  DFHEIV18              PIC X(04).
  2162   02  DFHEIV19              PIC X(04).
  2163   02  DFHEIV20              USAGE IS POINTER.
  2164   02  DFHEIV21              USAGE IS POINTER.
  2165   02  DFHEIV22              USAGE IS POINTER.
  2166   02  DFHEIV23              USAGE IS POINTER.
  2167   02  DFHEIV24              USAGE IS POINTER.
  2168   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2169   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2170   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2171   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2172   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2173   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2174   02  FILLER                PIC X(02).
  2175   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2176   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2177   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2178   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2179   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2180 LINKAGE  SECTION.
  2181*****************************************************************
  2182*                                                               *
  2183* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2184* All rights reserved.                                          *
  2185*                                                               *
  2186*****************************************************************
  2187 01  dfheiblk.
  2188     02  eibtime          pic s9(7) comp-3.
  2189     02  eibdate          pic s9(7) comp-3.
  2190     02  eibtrnid         pic x(4).
  2191     02  eibtaskn         pic s9(7) comp-3.
  2192     02  eibtrmid         pic x(4).
  2193     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  44
* EL154.cbl
  2194     02  eibcposn         pic s9(4) comp.
  2195     02  eibcalen         pic s9(4) comp.
  2196     02  eibaid           pic x(1).
  2197     02  eibfiller1       pic x(1).
  2198     02  eibfn            pic x(2).
  2199     02  eibfiller2       pic x(2).
  2200     02  eibrcode         pic x(6).
  2201     02  eibfiller3       pic x(2).
  2202     02  eibds            pic x(8).
  2203     02  eibreqid         pic x(8).
  2204     02  eibrsrce         pic x(8).
  2205     02  eibsync          pic x(1).
  2206     02  eibfree          pic x(1).
  2207     02  eibrecv          pic x(1).
  2208     02  eibsend          pic x(1).
  2209     02  eibatt           pic x(1).
  2210     02  eibeoc           pic x(1).
  2211     02  eibfmh           pic x(1).
  2212     02  eibcompl         pic x(1).
  2213     02  eibsig           pic x(1).
  2214     02  eibconf          pic x(1).
  2215     02  eiberr           pic x(1).
  2216     02  eibrldbk         pic x(1).
  2217     02  eiberrcd         pic x(4).
  2218     02  eibsynrb         pic x(1).
  2219     02  eibnodat         pic x(1).
  2220     02  eibfiller5       pic x(2).
  2221     02  eibresp          pic 9(09) comp.
  2222     02  eibresp2         pic 9(09) comp.
  2223     02  dfheigdj         pic s9(4) comp.
  2224     02  dfheigdk         pic s9(4) comp.
  2225 01  DFHCOMMAREA             PIC X(1024).
  2226
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  45
* EL154.cbl
  2228*                            COPY ELCCNTL.
  2229******************************************************************
  2230*                                                                *
  2231*                                                                *
  2232*                            ELCCNTL.                            *
  2233*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2234*                            VMOD=2.059                          *
  2235*                                                                *
  2236*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2237*                                                                *
  2238*   FILE TYPE = VSAM,KSDS                                        *
  2239*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2240*                                                                *
  2241*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2242*       ALTERNATE INDEX = NONE                                   *
  2243*                                                                *
  2244*   LOG = YES                                                    *
  2245*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2246******************************************************************
  2247*                   C H A N G E   L O G
  2248*
  2249* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2250*-----------------------------------------------------------------
  2251*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2252* EFFECTIVE    NUMBER
  2253*-----------------------------------------------------------------
  2254* 082503                   PEMA  ADD BENEFIT GROUP
  2255* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2256* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2257* 092705    2005050300006  PEMA  ADD SPP LEASES
  2258* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2259* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2260* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2261* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2262* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2263* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2264* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2265* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2266******************************************************************
  2267*
  2268 01  CONTROL-FILE.
  2269     12  CF-RECORD-ID                       PIC XX.
  2270         88  VALID-CF-ID                        VALUE 'CF'.
  2271
  2272     12  CF-CONTROL-PRIMARY.
  2273         16  CF-COMPANY-ID                  PIC XXX.
  2274         16  CF-RECORD-TYPE                 PIC X.
  2275             88  CF-COMPANY-MASTER              VALUE '1'.
  2276             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2277             88  CF-STATE-MASTER                VALUE '3'.
  2278             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2279             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2280             88  CF-CARRIER-MASTER              VALUE '6'.
  2281             88  CF-MORTALITY-MASTER            VALUE '7'.
  2282             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2283             88  CF-TERMINAL-MASTER             VALUE '9'.
  2284             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2285             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  46
* EL154.cbl
  2286             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2287             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2288             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2289             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2290             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2291             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2292             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2293         16  CF-ACCESS-CD-GENL              PIC X(4).
  2294         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2295             20  CF-PROCESSOR               PIC X(4).
  2296         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2297             20  CF-STATE-CODE              PIC XX.
  2298             20  FILLER                     PIC XX.
  2299         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2300             20  FILLER                     PIC XX.
  2301             20  CF-HI-BEN-IN-REC           PIC XX.
  2302         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2303             20  FILLER                     PIC XXX.
  2304             20  CF-CARRIER-CNTL            PIC X.
  2305         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2306             20  FILLER                     PIC XX.
  2307             20  CF-HI-TYPE-IN-REC          PIC 99.
  2308         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2309             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2310                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2311             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2312             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2313         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2314             20  FILLER                     PIC X.
  2315             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2316         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2317             20  FILLER                     PIC XX.
  2318             20  CF-MORTGAGE-PLAN           PIC XX.
  2319         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2320
  2321     12  CF-LAST-MAINT-DT                   PIC XX.
  2322     12  CF-LAST-MAINT-BY                   PIC X(4).
  2323     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2324
  2325     12  CF-RECORD-BODY                     PIC X(728).
  2326
  2327
  2328****************************************************************
  2329*             COMPANY MASTER RECORD                            *
  2330****************************************************************
  2331
  2332     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2333         16  CF-COMPANY-ADDRESS.
  2334             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2335             20  CF-CL-IN-CARE-OF           PIC X(30).
  2336             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2337             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2338             20  CF-CL-CITY-STATE           PIC X(30).
  2339             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2340             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2341         16  CF-COMPANY-CD                  PIC X.
  2342         16  CF-COMPANY-PASSWORD            PIC X(8).
  2343         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  47
* EL154.cbl
  2344             88  ALL-SECURITY                   VALUE '1'.
  2345             88  COMPANY-VERIFY                 VALUE '2'.
  2346             88  PROCESSOR-VERIFY               VALUE '3'.
  2347             88  NO-SECURITY                    VALUE '4'.
  2348             88  ALL-BUT-TERM                   VALUE '5'.
  2349         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2350             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2351         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2352             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2353         16  CF-INFORCE-LOCATION            PIC X.
  2354             88  CERTS-ARE-ONLINE               VALUE '1'.
  2355             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2356             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2357         16  CF-LOWER-CASE-LETTERS          PIC X.
  2358         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2359             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2360             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2361             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2362             88  CF-ACCNT-CNTL                  VALUE '3'.
  2363             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2364
  2365         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2366         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2367
  2368         16  CF-LGX-CREDIT-USER             PIC X.
  2369             88  CO-IS-NOT-USER                 VALUE 'N'.
  2370             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2371
  2372         16 CF-CREDIT-CALC-CODES.
  2373             20  CF-CR-REM-TERM-CALC PIC X.
  2374               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2375               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2376               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2377               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2378               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2379               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2380               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2381             20  CF-CR-R78-METHOD           PIC X.
  2382               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2383               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2384
  2385         16  CF-CLAIM-CONTROL-COUNTS.
  2386             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2387                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2388
  2389             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2390                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2391
  2392             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2393                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2394
  2395             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2396                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2397
  2398         16  CF-CURRENT-MONTH-END           PIC XX.
  2399
  2400         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2401             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  48
* EL154.cbl
  2402             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2403             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2404             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2405                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2406                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2407             20  CF-CO-PREM-REJECT-SW       PIC X.
  2408                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2409                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2410             20  CF-CO-REF-REJECT-SW        PIC X.
  2411                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2412                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2413
  2414         16  CF-CO-REPORTING-DT             PIC XX.
  2415         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2416         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2417           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2418           88  CF-CO-MONTH-END                  VALUE '1'.
  2419
  2420         16  CF-LGX-CLAIM-USER              PIC X.
  2421             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2422             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2423
  2424         16  CF-CREDIT-EDIT-CONTROLS.
  2425             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2426             20  CF-MIN-AGE                 PIC 99.
  2427             20  CF-DEFAULT-AGE             PIC 99.
  2428             20  CF-MIN-TERM                PIC S999      COMP-3.
  2429             20  CF-MAX-TERM                PIC S999      COMP-3.
  2430             20  CF-DEFAULT-SEX             PIC X.
  2431             20  CF-JOINT-AGE-INPUT         PIC X.
  2432                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2433             20  CF-BIRTH-DATE-INPUT        PIC X.
  2434                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2435             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2436                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2437                 88  CF-ZERO-CARRIER            VALUE '1'.
  2438                 88  CF-ZERO-GROUPING           VALUE '2'.
  2439                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2440             20  CF-EDIT-SW                 PIC X.
  2441                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2442             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2443             20  CF-CR-PR-METHOD            PIC X.
  2444               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2445               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2446             20  FILLER                     PIC X.
  2447
  2448         16  CF-CREDIT-MISC-CONTROLS.
  2449             20  CF-REIN-TABLE-SW           PIC X.
  2450                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2451             20  CF-COMP-TABLE-SW           PIC X.
  2452                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2453             20  CF-EXPERIENCE-RETENTION-AGE
  2454                                            PIC S9        COMP-3.
  2455             20  CF-CONVERSION-DT           PIC XX.
  2456             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2457             20  CF-RUN-FREQUENCY-SW        PIC X.
  2458                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2459                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  49
* EL154.cbl
  2460
  2461             20  CF-CR-CHECK-NO-CONTROL.
  2462                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2463                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2464                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2465                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2466                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2467                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2468
  2469                 24  CF-CR-CHECK-COUNT       REDEFINES
  2470                     CF-CR-CHECK-COUNTER      PIC X(4).
  2471
  2472                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2473                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2474
  2475                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2476                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2477                 24  CF-MAIL-PROCESSING       PIC X.
  2478                     88  MAIL-PROCESSING          VALUE 'Y'.
  2479
  2480         16  CF-MISC-SYSTEM-CONTROL.
  2481             20  CF-SYSTEM-C                 PIC X.
  2482                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2483             20  CF-SYSTEM-D                 PIC X.
  2484                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2485             20  CF-SOC-SEC-NO-SW            PIC X.
  2486                 88  SOC-SEC-NO-USED             VALUE '1'.
  2487             20  CF-MEMBER-NO-SW             PIC X.
  2488                 88  MEMBER-NO-USED              VALUE '1'.
  2489             20  CF-TAX-ID-NUMBER            PIC X(11).
  2490             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2491             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2492                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2493                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2494                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2495                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2496             20  CF-SYSTEM-E                 PIC X.
  2497                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2498
  2499         16  CF-LGX-LIFE-USER               PIC X.
  2500             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2501             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2502
  2503         16  CF-CR-MONTH-END-DT             PIC XX.
  2504
  2505         16  CF-FILE-MAINT-DATES.
  2506             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2507                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2508             20  CF-LAST-BATCH       REDEFINES
  2509                 CF-LAST-BATCH-NO               PIC X(4).
  2510             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2511             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2512             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2513             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2514             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2515             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2516             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2517             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  50
* EL154.cbl
  2518             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2519             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2520
  2521         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2522         16  FILLER                         PIC X.
  2523
  2524         16  CF-ALT-MORT-CODE               PIC X(4).
  2525         16  CF-MEMBER-CAPTION              PIC X(10).
  2526
  2527         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2528             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2529             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2530             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2531             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2532             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2533
  2534         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2535
  2536         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2537         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2538         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2539         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2540
  2541         16  CF-AH-OVERRIDE-L1              PIC X.
  2542         16  CF-AH-OVERRIDE-L2              PIC XX.
  2543         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2544         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2545
  2546         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2547         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2548
  2549         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2550         16  CF-AR-LAST-EL860-DT            PIC XX.
  2551         16  CF-MP-MONTH-END-DT             PIC XX.
  2552
  2553         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2554         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2555             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2556
  2557         16  CF-AR-MONTH-END-DT             PIC XX.
  2558
  2559         16  CF-CRDTCRD-USER                PIC X.
  2560             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2561             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2562
  2563         16  CF-CC-MONTH-END-DT             PIC XX.
  2564
  2565         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2566
  2567         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2568             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2569             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2570             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2571         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2572         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2573         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2574         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2575             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  51
* EL154.cbl
  2576             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2577         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2578         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2579         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2580             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2581         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2582
  2583         16  CF-CL-ZIP-CODE.
  2584             20  CF-CL-ZIP-PRIME.
  2585                 24  CF-CL-ZIP-1ST          PIC X.
  2586                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2587                 24  FILLER                 PIC X(4).
  2588             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2589         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2590             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2591             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2592             20  FILLER                     PIC XXX.
  2593
  2594         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2595         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2596         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2597         16  CF-CO-OPTION-START-DATE        PIC XX.
  2598         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2599           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2600                                                      '3' '4'.
  2601           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2602           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2603           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2604           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2605           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2606           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2607
  2608         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2609
  2610         16  CF-PAYMENT-APPROVAL-LEVELS.
  2611             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2612             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2613             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2614             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2615             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2616             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2617
  2618         16  CF-END-USER-REPORTING-USER     PIC X.
  2619             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2620             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2621
  2622         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2623             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2624             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2625
  2626         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2627
  2628         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2629         16  FILLER                         PIC X.
  2630
  2631         16  CF-CREDIT-ARCHIVE-CNTL.
  2632             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2633             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  52
* EL154.cbl
  2634             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2635
  2636         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2637
  2638         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2639             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2640             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2641
  2642         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2643             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2644             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2645
  2646         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2647
  2648         16  CF-CO-ACH-ID-CODE              PIC  X.
  2649             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2650             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2651             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2652         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2653         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2654         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2655         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2656         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2657         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2658         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2659         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2660         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2661                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2662         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2663                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2664
  2665         16  CF-CO-OVER-SHORT.
  2666             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2667             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2668
  2669*         16  FILLER                         PIC X(102).
  2670         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2671             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2672             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2673
  2674         16  CF-AH-APPROVAL-DAYS.
  2675             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2676             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2677             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2678             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2679
  2680         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2681
  2682         16  FILLER                         PIC X(79).
  2683****************************************************************
  2684*             PROCESSOR/USER RECORD                            *
  2685****************************************************************
  2686
  2687     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2688         16  CF-PROCESSOR-NAME              PIC X(30).
  2689         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2690         16  CF-PROCESSOR-TITLE             PIC X(26).
  2691         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  53
* EL154.cbl
  2692                 88  MESSAGE-YES                VALUE 'Y'.
  2693                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2694
  2695*****************************************************
  2696****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2697****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2698****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2699****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2700*****************************************************
  2701
  2702         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2703             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2704             20  CF-APPLICATION-FORCE       PIC X.
  2705             20  CF-INDIVIDUAL-APP.
  2706                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2707                     28  CF-BROWSE-APP      PIC X.
  2708                     28  CF-UPDATE-APP      PIC X.
  2709
  2710         16  CF-CURRENT-TERM-ON             PIC X(4).
  2711         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2712             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2713             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2714             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2715             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2716             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2717             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2718             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2719         16  CF-PROCESSOR-CARRIER           PIC X.
  2720             88  NO-CARRIER-SECURITY            VALUE ' '.
  2721         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2722             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2723         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2724             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2725         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2726             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2727
  2728         16  CF-PROC-SYS-ACCESS-SW.
  2729             20  CF-PROC-CREDIT-CLAIMS-SW.
  2730                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2731                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2732                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2733                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2734             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2735                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2736                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2737             20  CF-PROC-LIFE-GNRLDGR-SW.
  2738                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2739                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2740                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2741                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2742             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2743                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2744                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2745         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2746             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2747             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2748         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2749
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  54
* EL154.cbl
  2750         16  CF-APPROVAL-LEVEL                  PIC X.
  2751             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2752             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2753             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2754             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2755
  2756         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2757
  2758         16  CF-LANGUAGE-TYPE                   PIC X.
  2759             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2760             88  CF-LANG-IS-FR                      VALUE 'F'.
  2761
  2762         16  CF-CSR-IND                         PIC X.
  2763         16  FILLER                             PIC X(239).
  2764
  2765****************************************************************
  2766*             PROCESSOR/REMINDERS RECORD                       *
  2767****************************************************************
  2768
  2769     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2770         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2771             20  CF-START-REMIND-DT         PIC XX.
  2772             20  CF-END-REMIND-DT           PIC XX.
  2773             20  CF-REMINDER-TEXT           PIC X(50).
  2774         16  FILLER                         PIC X(296).
  2775
  2776
  2777****************************************************************
  2778*             STATE MASTER RECORD                              *
  2779****************************************************************
  2780
  2781     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2782         16  CF-STATE-ABBREVIATION          PIC XX.
  2783         16  CF-STATE-NAME                  PIC X(25).
  2784         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2785         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2786             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2787             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2788             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2789             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2790                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2791                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2792             20  CF-ST-PREM-REJECT-SW       PIC X.
  2793                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2794                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2795             20  CF-ST-REF-REJECT-SW        PIC X.
  2796                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2797                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2798         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2799         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2800         16  CF-ST-REFUND-RULES.
  2801             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2802             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2803             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2804         16  CF-ST-FST-PMT-EXTENSION.
  2805             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2806             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2807                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  55
* EL154.cbl
  2808                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2809                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2810                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2811         16  CF-ST-STATE-CALL.
  2812             20  CF-ST-CALL-UNEARNED        PIC X.
  2813             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2814             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2815         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2816             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2817             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2818         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2819         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2820         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2821         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2822         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2823         16  FILLER                         PIC X.
  2824         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2825             20  CF-ST-BENEFIT-CD           PIC XX.
  2826             20  CF-ST-BENEFIT-KIND         PIC X.
  2827                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2828                 88  CF-ST-AH-KIND              VALUE 'A'.
  2829             20  CF-ST-REM-TERM-CALC        PIC X.
  2830                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2831                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2832                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2833                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2834                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2835                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2836                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2837                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2838
  2839             20  CF-ST-REFUND-CALC          PIC X.
  2840                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2841                 88  ST-REFD-BY-R78             VALUE '1'.
  2842                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2843                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2844                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2845                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2846                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2847                 88  ST-REFD-UTAH               VALUE '7'.
  2848                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2849                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2850                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2851
  2852             20  CF-ST-EARNING-CALC         PIC X.
  2853                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2854                 88  ST-EARN-BY-R78             VALUE '1'.
  2855                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2856                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2857                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2858                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2859                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2860                 88  ST-EARN-MEAN               VALUE '8'.
  2861                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2862
  2863             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2864                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2865                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  56
* EL154.cbl
  2866                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2867                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2868                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2869                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2870                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2871                 88  ST-OVRD-MEAN               VALUE '8'.
  2872                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2873             20  FILLER                     PIC X.
  2874
  2875         16  CF-ST-COMMISSION-CAPS.
  2876             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2877             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2878             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2879             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2880         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2881                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2882
  2883         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2884
  2885         16  CF-ST-STATUTORY-INTEREST.
  2886             20  CF-ST-STAT-DATE-FROM       PIC X.
  2887                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2888                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2889             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2890             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2891             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2892             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2893             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2894
  2895         16  CF-ST-OVER-SHORT.
  2896             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2897             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2898
  2899         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2900
  2901         16  CF-ST-RT-CALC                  PIC X.
  2902
  2903         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2904         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2905         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2906         16  CF-ST-RF-LR-CALC               PIC X.
  2907         16  CF-ST-RF-LL-CALC               PIC X.
  2908         16  CF-ST-RF-LN-CALC               PIC X.
  2909         16  CF-ST-RF-AH-CALC               PIC X.
  2910         16  CF-ST-RF-CP-CALC               PIC X.
  2911*        16  FILLER                         PIC X(206).
  2912*CIDMOD         16  FILLER                         PIC X(192).
  2913         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2914             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2915         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2916         16  CF-ST-VFY-2ND-BENE             PIC X.
  2917         16  CF-ST-CAUSAL-STATE             PIC X.
  2918         16  FILLER                         PIC X(185).
  2919
  2920****************************************************************
  2921*             BENEFIT MASTER RECORD                            *
  2922****************************************************************
  2923
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  57
* EL154.cbl
  2924     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2925         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2926             20  CF-BENEFIT-CODE            PIC XX.
  2927             20  CF-BENEFIT-NUMERIC  REDEFINES
  2928                 CF-BENEFIT-CODE            PIC XX.
  2929             20  CF-BENEFIT-ALPHA           PIC XXX.
  2930             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2931             20  CF-BENEFIT-COMMENT         PIC X(10).
  2932
  2933             20  CF-LF-COVERAGE-TYPE        PIC X.
  2934                 88  CF-REDUCING                VALUE 'R'.
  2935                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2936
  2937             20  CF-SPECIAL-CALC-CD         PIC X.
  2938                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2939                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2940                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2941                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2942                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2943                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2944                 88  CF-FARM-PLAN               VALUE 'F'.
  2945                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2946                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2947                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2948                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2949                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2950                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2951                 88  CF-PRUDENTIAL              VALUE 'P'.
  2952                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2953                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2954                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2955                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2956                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2957                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2958
  2959             20  CF-JOINT-INDICATOR         PIC X.
  2960                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2961
  2962*            20  FILLER                     PIC X(12).
  2963             20  FILLER                     PIC X(11).
  2964             20  CF-BENEFIT-CATEGORY        PIC X.
  2965             20  CF-LOAN-TYPE               PIC X(8).
  2966
  2967             20  CF-CO-REM-TERM-CALC        PIC X.
  2968                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2969                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2970                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2971                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2972                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2973
  2974             20  CF-CO-EARNINGS-CALC        PIC X.
  2975                 88  CO-EARN-BY-R78             VALUE '1'.
  2976                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2977                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2978                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2979                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2980                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2981                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  58
* EL154.cbl
  2982                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2983
  2984             20  CF-CO-REFUND-CALC          PIC X.
  2985                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2986                 88  CO-REFD-BY-R78             VALUE '1'.
  2987                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2988                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2989                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2990                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2991                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2992                 88  CO-REFD-MEAN               VALUE '8'.
  2993                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2994                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2995                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2996
  2997             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2998                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2999                 88  CO-OVRD-BY-R78             VALUE '1'.
  3000                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3001                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3002                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3003                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3004                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3005                 88  CO-OVRD-MEAN               VALUE '8'.
  3006                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3007
  3008             20  CF-CO-BEN-I-G-CD           PIC X.
  3009                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3010                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3011                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3012
  3013         16  FILLER                         PIC X(304).
  3014
  3015
  3016****************************************************************
  3017*             CARRIER MASTER RECORD                            *
  3018****************************************************************
  3019
  3020     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3021         16  CF-ADDRESS-DATA.
  3022             20  CF-MAIL-TO-NAME            PIC X(30).
  3023             20  CF-IN-CARE-OF              PIC X(30).
  3024             20  CF-ADDRESS-LINE-1          PIC X(30).
  3025             20  CF-ADDRESS-LINE-2          PIC X(30).
  3026             20  CF-CITY-STATE              PIC X(30).
  3027             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3028             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3029
  3030         16  CF-CLAIM-NO-CONTROL.
  3031             20  CF-CLAIM-NO-METHOD         PIC X.
  3032                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3033                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3034                 88  CLAIM-NO-SEQ               VALUE '3'.
  3035                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3036             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3037                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3038                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3039                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  59
* EL154.cbl
  3040
  3041         16  CF-CHECK-NO-CONTROL.
  3042             20  CF-CHECK-NO-METHOD         PIC X.
  3043                 88  CHECK-NO-MANUAL            VALUE '1'.
  3044                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3045                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3046                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3047             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3048                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3049
  3050         16  CF-DOMICILE-STATE              PIC XX.
  3051
  3052         16  CF-EXPENSE-CONTROLS.
  3053             20  CF-EXPENSE-METHOD          PIC X.
  3054                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3055                 88  DOLLARS-PER-PMT            VALUE '2'.
  3056                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3057                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3058             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3059             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3060
  3061         16  CF-CORRESPONDENCE-CONTROL.
  3062             20  CF-LETTER-RESEND-OPT       PIC X.
  3063                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3064                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3065             20  FILLER                     PIC X(4).
  3066
  3067         16  CF-RESERVE-CONTROLS.
  3068             20  CF-MANUAL-SW               PIC X.
  3069                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3070             20  CF-FUTURE-SW               PIC X.
  3071                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3072             20  CF-PTC-SW                  PIC X.
  3073                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3074             20  CF-IBNR-SW                 PIC X.
  3075                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3076             20  CF-PTC-LF-SW               PIC X.
  3077                 88  CF-LF-PTC-USED             VALUE '1'.
  3078             20  CF-CDT-ACCESS-METHOD       PIC X.
  3079                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3080                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3081                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3082             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3083
  3084         16  CF-CLAIM-CALC-METHOD           PIC X.
  3085             88  360-PLUS-MONTHS                VALUE '1'.
  3086             88  365-PLUS-MONTHS                VALUE '2'.
  3087             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3088             88  360-DAILY                      VALUE '4'.
  3089             88  365-DAILY                      VALUE '5'.
  3090
  3091         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3092         16  FILLER                         PIC X(11).
  3093
  3094         16  CF-LIMIT-AMOUNTS.
  3095             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3096             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3097             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  60
* EL154.cbl
  3098             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3099             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3100             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3101             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3102             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3103             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3104             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3105
  3106         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3107         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3108         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3109
  3110         16  CF-ZIP-CODE.
  3111             20  CF-ZIP-PRIME.
  3112                 24  CF-ZIP-1ST             PIC X.
  3113                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3114                 24  FILLER                 PIC X(4).
  3115             20  CF-ZIP-PLUS4               PIC X(4).
  3116         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3117             20  CF-CAN-POSTAL-1            PIC XXX.
  3118             20  CF-CAN-POSTAL-2            PIC XXX.
  3119             20  FILLER                     PIC XXX.
  3120
  3121         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3122         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3123         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3124
  3125         16  CF-RATING-SWITCH               PIC X.
  3126             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3127             88  CF-NO-RATING                   VALUE 'N'.
  3128
  3129         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3130
  3131         16  CF-CARRIER-OVER-SHORT.
  3132             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3133             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3134
  3135         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3136         16  CF-SECPAY-SWITCH               PIC X.
  3137             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3138             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3139         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3140         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3141         16  FILLER                         PIC X(444).
  3142*        16  FILLER                         PIC X(452).
  3143
  3144
  3145****************************************************************
  3146*             MORTALITY MASTER RECORD                          *
  3147****************************************************************
  3148
  3149     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3150         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3151                                INDEXED BY CF-MORT-NDX.
  3152             20  CF-MORT-TABLE              PIC X(5).
  3153             20  CF-MORT-TABLE-TYPE         PIC X.
  3154                 88  CF-MORT-JOINT              VALUE 'J'.
  3155                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  61
* EL154.cbl
  3156                 88  CF-MORT-COMBINED           VALUE 'C'.
  3157                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3158                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3159             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3160             20  CF-MORT-AGE-METHOD         PIC XX.
  3161                 88  CF-AGE-LAST                VALUE 'AL'.
  3162                 88  CF-AGE-NEAR                VALUE 'AN'.
  3163             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3164             20  CF-MORT-ADJUSTMENT-DIRECTION
  3165                                            PIC X.
  3166                 88  CF-MINUS                   VALUE '-'.
  3167                 88  CF-PLUS                    VALUE '+'.
  3168             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3169             20  CF-MORT-JOINT-CODE         PIC X.
  3170                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3171             20  CF-MORT-PC-Q               PIC X.
  3172                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3173             20  CF-MORT-TABLE-CODE         PIC X(4).
  3174             20  CF-MORT-COMMENTS           PIC X(15).
  3175             20  FILLER                     PIC X(14).
  3176
  3177         16  FILLER                         PIC X(251).
  3178
  3179
  3180****************************************************************
  3181*             BUSSINESS TYPE MASTER RECORD                     *
  3182****************************************************************
  3183
  3184     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3185* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3186* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3187* AND RECORD 05 IS TYPES 81-99
  3188         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3189             20  CF-BUSINESS-TITLE          PIC  X(19).
  3190             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3191                                            PIC S9V9(4) COMP-3.
  3192             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3193             20  FILLER                     PIC  X.
  3194         16  FILLER                         PIC  X(248).
  3195
  3196
  3197****************************************************************
  3198*             TERMINAL MASTER RECORD                           *
  3199****************************************************************
  3200
  3201     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3202
  3203         16  CF-COMPANY-TERMINALS.
  3204             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3205                                  PIC X(4).
  3206         16  FILLER               PIC X(248).
  3207
  3208
  3209****************************************************************
  3210*             LIFE EDIT MASTER RECORD                          *
  3211****************************************************************
  3212
  3213     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  62
* EL154.cbl
  3214         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3215             20  CF-LIFE-CODE-IN            PIC XX.
  3216             20  CF-LIFE-CODE-OUT           PIC XX.
  3217         16  FILLER                         PIC X(248).
  3218
  3219
  3220****************************************************************
  3221*             AH EDIT MASTER RECORD                            *
  3222****************************************************************
  3223
  3224     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3225         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3226             20  CF-AH-CODE-IN              PIC XXX.
  3227             20  CF-AH-CODE-OUT             PIC XX.
  3228         16  FILLER                         PIC X(248).
  3229
  3230
  3231****************************************************************
  3232*             CREDIBILITY TABLES                               *
  3233****************************************************************
  3234
  3235     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3236         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3237                             INDEXED BY CF-CRDB-NDX.
  3238             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3239             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3240             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3241         16  FILLER                         PIC  X(332).
  3242
  3243
  3244****************************************************************
  3245*             REPORT CUSTOMIZATION RECORD                      *
  3246****************************************************************
  3247
  3248     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3249         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3250             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3251             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3252             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3253**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3254****       A T-TRANSFER.                                   ****
  3255             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3256
  3257         16  FILLER                         PIC XX.
  3258
  3259         16  CF-CARRIER-CNTL-OPT.
  3260             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3261                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3262                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3263             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3264                                            PIC X.
  3265         16  CF-GROUP-CNTL-OPT.
  3266             20  CF-GROUP-OPT-SEQ           PIC 9.
  3267                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3268                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3269             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3270                                            PIC X(6).
  3271         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  63
* EL154.cbl
  3272             20  CF-STATE-OPT-SEQ           PIC 9.
  3273                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3274                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3275             20  CF-STATE-SELECT OCCURS 3 TIMES
  3276                                            PIC XX.
  3277         16  CF-ACCOUNT-CNTL-OPT.
  3278             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3279                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3280                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3281             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3282                                            PIC X(10).
  3283         16  CF-BUS-TYP-CNTL-OPT.
  3284             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3285                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3286                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3287             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3288                                            PIC XX.
  3289         16  CF-LF-TYP-CNTL-OPT.
  3290             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3291                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3292                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3293             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3294                                            PIC XX.
  3295         16  CF-AH-TYP-CNTL-OPT.
  3296             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3297                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3298                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3299             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3300                                            PIC XX.
  3301         16  CF-REPTCD1-CNTL-OPT.
  3302             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3303                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3304                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3305             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3306                                            PIC X(10).
  3307         16  CF-REPTCD2-CNTL-OPT.
  3308             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3309                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3310                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3311             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3312                                            PIC X(10).
  3313         16  CF-USER1-CNTL-OPT.
  3314             20  CF-USER1-OPT-SEQ           PIC 9.
  3315                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3316                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3317             20  CF-USER1-SELECT OCCURS 3 TIMES
  3318                                            PIC X(10).
  3319         16  CF-USER2-CNTL-OPT.
  3320             20  CF-USER2-OPT-SEQ           PIC 9.
  3321                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3322                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3323             20  CF-USER2-SELECT OCCURS 3 TIMES
  3324                                            PIC X(10).
  3325         16  CF-USER3-CNTL-OPT.
  3326             20  CF-USER3-OPT-SEQ           PIC 9.
  3327                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3328                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3329             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  64
* EL154.cbl
  3330                                            PIC X(10).
  3331         16  CF-USER4-CNTL-OPT.
  3332             20  CF-USER4-OPT-SEQ           PIC 9.
  3333                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3334                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3335             20  CF-USER4-SELECT OCCURS 3 TIMES
  3336                                            PIC X(10).
  3337         16  CF-USER5-CNTL-OPT.
  3338             20  CF-USER5-OPT-SEQ           PIC 9.
  3339                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3340                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3341             20  CF-USER5-SELECT OCCURS 3 TIMES
  3342                                            PIC X(10).
  3343         16  CF-REINS-CNTL-OPT.
  3344             20  CF-REINS-OPT-SEQ           PIC 9.
  3345                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3346                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3347             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3348                 24  CF-REINS-PRIME         PIC XXX.
  3349                 24  CF-REINS-SUB           PIC XXX.
  3350
  3351         16  CF-AGENT-CNTL-OPT.
  3352             20  CF-AGENT-OPT-SEQ           PIC 9.
  3353                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3354                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3355             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3356                                            PIC X(10).
  3357
  3358         16  FILLER                         PIC X(43).
  3359
  3360         16  CF-LOSS-RATIO-SELECT.
  3361             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3362             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3363         16  CF-ENTRY-DATE-SELECT.
  3364             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3365             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3366         16  CF-EFFECTIVE-DATE-SELECT.
  3367             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3368             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3369
  3370         16  CF-EXCEPTION-LIST-IND          PIC X.
  3371             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3372
  3373         16  FILLER                         PIC X(318).
  3374
  3375****************************************************************
  3376*                  EXCEPTION REPORTING RECORD                  *
  3377****************************************************************
  3378
  3379     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3380         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3381             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3382
  3383         16  CF-COMBINED-LIFE-AH-OPT.
  3384             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3385             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3386             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3387             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  65
* EL154.cbl
  3388
  3389         16  CF-LIFE-OPT.
  3390             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3391             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3392             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3393             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3394             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3395             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3396             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3397             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3398             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3399             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3400
  3401         16  CF-AH-OPT.
  3402             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3403             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3404             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3405             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3406             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3407             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3408             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3409             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3410             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3411             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3412
  3413         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3414             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3415             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3416             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3417
  3418         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3419
  3420         16  FILLER                         PIC X(673).
  3421
  3422
  3423****************************************************************
  3424*             MORTGAGE SYSTEM PLAN RECORD                      *
  3425****************************************************************
  3426
  3427     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3428         16  CF-PLAN-TYPE                   PIC X.
  3429             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3430             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3431             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3432         16  CF-PLAN-ABBREV                 PIC XXX.
  3433         16  CF-PLAN-DESCRIPT               PIC X(10).
  3434         16  CF-PLAN-NOTES                  PIC X(20).
  3435         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3436         16  CF-PLAN-UNDERWRITING.
  3437             20  CF-PLAN-TERM-DATA.
  3438                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3439                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3440             20  CF-PLAN-AGE-DATA.
  3441                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3442                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3443                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3444             20  CF-PLAN-BENEFIT-DATA.
  3445                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  66
* EL154.cbl
  3446                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3447                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3448                                            PIC S9(7)V99  COMP-3.
  3449         16  CF-PLAN-POLICY-FORMS.
  3450             20  CF-POLICY-FORM             PIC X(12).
  3451             20  CF-MASTER-APPLICATION      PIC X(12).
  3452             20  CF-MASTER-POLICY           PIC X(12).
  3453         16  CF-PLAN-RATING.
  3454             20  CF-RATE-CODE               PIC X(5).
  3455             20  CF-SEX-RATING              PIC X.
  3456                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3457                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3458             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3459             20  CF-SUB-STD-TYPE            PIC X.
  3460                 88  CF-PCT-OF-PREM            VALUE '1'.
  3461                 88  CF-PCT-OF-BENE            VALUE '2'.
  3462         16  CF-PLAN-PREM-TOLERANCES.
  3463             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3464             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3465         16  CF-PLAN-PYMT-TOLERANCES.
  3466             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3467             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3468         16  CF-PLAN-MISC-DATA.
  3469             20  FILLER                     PIC X.
  3470             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3471             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3472         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3473         16  CF-PLAN-IND-GRP                PIC X.
  3474             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3475                                                     '1'.
  3476             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3477                                                     '2'.
  3478         16  CF-MIB-SEARCH-SW               PIC X.
  3479             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3480             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3481             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3482             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3483         16  CF-ALPHA-SEARCH-SW             PIC X.
  3484             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3485             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3486             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3487             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3488             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3489             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3490             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3491             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3492             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3493             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3494                                                     'A' 'B' 'C'
  3495                                                     'X' 'Y' 'Z'.
  3496         16  CF-EFF-DT-RULE-SW              PIC X.
  3497             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3498             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3499             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3500             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3501             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3502         16  FILLER                         PIC X(4).
  3503         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  67
* EL154.cbl
  3504             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3505         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3506         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3507         16  CF-PLAN-SNGL-JNT               PIC X.
  3508             88  CF-COMBINED-PLAN              VALUE 'C'.
  3509             88  CF-JNT-PLAN                   VALUE 'J'.
  3510             88  CF-SNGL-PLAN                  VALUE 'S'.
  3511         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3512         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3513         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3514         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3515         16  CF-RERATE-CNTL                 PIC  X.
  3516             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3517             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3518             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3519             88  CF-AUTO-RECALC                 VALUE '4'.
  3520         16  CF-BENEFIT-TYPE                PIC  X.
  3521             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3522             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3523         16  CF-POLICY-FEE                  PIC S999V99
  3524                                                    COMP-3.
  3525         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3526         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3527         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3528         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3529         16  FILLER                         PIC  X(32).
  3530         16  CF-TERMINATION-FORM            PIC  X(04).
  3531         16  FILLER                         PIC  X(08).
  3532         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3533                                                       COMP-3.
  3534         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3535         16  CF-ISSUE-LETTER                PIC  X(4).
  3536         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3537         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3538             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3539             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3540         16  CF-MP-REFUND-CALC              PIC X.
  3541             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3542             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3543             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3544             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3545             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3546             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3547             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3548             88  CF-MP-REFD-MEAN                VALUE '8'.
  3549         16  CF-ALT-RATE-CODE               PIC  X(5).
  3550
  3551
  3552         16  FILLER                         PIC X(498).
  3553****************************************************************
  3554*             MORTGAGE COMPANY MASTER RECORD                   *
  3555****************************************************************
  3556
  3557     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3558         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3559         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3560             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3561             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  68
* EL154.cbl
  3562             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3563             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3564             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3565
  3566         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3567         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3568         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3569         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3570         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3571
  3572         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3573             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3574         16  CF-MP-RECON-USE-IND            PIC X(1).
  3575             88  CF-MP-USE-RECON             VALUE 'Y'.
  3576         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3577             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3578         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3579             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3580             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3581         16  FILLER                         PIC X(1).
  3582         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3583             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3584         16  CF-MORTG-MIB-VERSION           PIC X.
  3585             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3586             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3587             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3588         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3589             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3590                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3591             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3592                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3593             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3594                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3595             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3596                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3597             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3598                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3599             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3600                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3601         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3602         16  FILLER                         PIC X(7).
  3603         16  CF-MORTG-DESTINATION-SYMBOL.
  3604             20  CF-MORTG-MIB-COMM          PIC X(5).
  3605             20  CF-MORTG-MIB-TERM          PIC X(5).
  3606         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3607             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3608         16  FILLER                         PIC X(03).
  3609         16  CF-MP-CHECK-NO-CONTROL.
  3610             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3611                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3612                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3613                                                ' ' LOW-VALUES.
  3614                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3615                                               VALUE '3'.
  3616         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3617         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3618         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3619             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  69
* EL154.cbl
  3620                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3621             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3622                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3623             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3624                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3625             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3626                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3627             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3628                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3629             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3630                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3631         16  CF-MORTG-BILLING-AREA.
  3632             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3633                                            PIC X.
  3634         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3635         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3636         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3637         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3638             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3639             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3640         16  FILLER                         PIC X.
  3641         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3642             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3643             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3644         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3645         16  FILLER                         PIC X(8).
  3646         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3647         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3648         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3649         16  CF-ACH-COMPANY-ID.
  3650             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3651                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3652                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3653                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3654             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3655         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3656             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3657         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3658             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3659             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3660         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3661         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3662         16  FILLER                         PIC X(536).
  3663
  3664****************************************************************
  3665*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3666****************************************************************
  3667
  3668     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3669         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3670             20  CF-FEMALE-HEIGHT.
  3671                 24  CF-FEMALE-FT           PIC 99.
  3672                 24  CF-FEMALE-IN           PIC 99.
  3673             20  CF-FEMALE-MIN-WT           PIC 999.
  3674             20  CF-FEMALE-MAX-WT           PIC 999.
  3675         16  FILLER                         PIC X(428).
  3676
  3677     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  70
* EL154.cbl
  3678         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3679             20  CF-MALE-HEIGHT.
  3680                 24  CF-MALE-FT             PIC 99.
  3681                 24  CF-MALE-IN             PIC 99.
  3682             20  CF-MALE-MIN-WT             PIC 999.
  3683             20  CF-MALE-MAX-WT             PIC 999.
  3684         16  FILLER                         PIC X(428).
  3685******************************************************************
  3686*             AUTOMATIC ACTIVITY RECORD                          *
  3687******************************************************************
  3688     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3689         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3690             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3691             20  CF-SYS-LETTER-ID           PIC X(04).
  3692             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3693             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3694             20  CF-SYS-RESET-SW            PIC X(01).
  3695             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3696             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3697
  3698         16  FILLER                         PIC X(50).
  3699
  3700         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3701             20  CF-USER-ACTIVE-SW          PIC X(01).
  3702             20  CF-USER-LETTER-ID          PIC X(04).
  3703             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3704             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3705             20  CF-USER-RESET-SW           PIC X(01).
  3706             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3707             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3708             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3709
  3710         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  71
* EL154.cbl
  3712*                            COPY ELCMSTR.
  3713******************************************************************
  3714*                                                                *
  3715*                            ELCMSTR.                            *
  3716*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3717*                            VMOD=2.012                          *
  3718*                                                                *
  3719*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3720*                                                                *
  3721*   FILE TYPE = VSAM,KSDS                                        *
  3722*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3723*                                                                *
  3724*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3725*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3726*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3727*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3728*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3729*                                                 RKP=75,LEN=21  *
  3730*                                                                *
  3731*   **** NOTE ****                                               *
  3732*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3733*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3734*                                                                *
  3735*   LOG = YES                                                    *
  3736*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3737******************************************************************
  3738*                   C H A N G E   L O G
  3739*
  3740* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3741*-----------------------------------------------------------------
  3742*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3743* EFFECTIVE    NUMBER
  3744*-----------------------------------------------------------------
  3745* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3746* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3747* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3748******************************************************************
  3749 01  CLAIM-MASTER.
  3750     12  CL-RECORD-ID                PIC XX.
  3751         88  VALID-CL-ID         VALUE 'CL'.
  3752
  3753     12  CL-CONTROL-PRIMARY.
  3754         16  CL-COMPANY-CD           PIC X.
  3755         16  CL-CARRIER              PIC X.
  3756         16  CL-CLAIM-NO             PIC X(7).
  3757         16  CL-CERT-NO.
  3758             20  CL-CERT-PRIME       PIC X(10).
  3759             20  CL-CERT-SFX         PIC X.
  3760
  3761     12  CL-CONTROL-BY-NAME.
  3762         16  CL-COMPANY-CD-A1        PIC X.
  3763         16  CL-INSURED-LAST-NAME    PIC X(15).
  3764         16  CL-INSURED-NAME.
  3765             20  CL-INSURED-1ST-NAME PIC X(12).
  3766             20  CL-INSURED-MID-INIT PIC X.
  3767
  3768     12  CL-CONTROL-BY-SSN.
  3769         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  72
* EL154.cbl
  3770         16  CL-SOC-SEC-NO.
  3771             20  CL-SSN-STATE        PIC XX.
  3772             20  CL-SSN-ACCOUNT      PIC X(6).
  3773             20  CL-SSN-LN3          PIC X(3).
  3774
  3775     12  CL-CONTROL-BY-CERT-NO.
  3776         16  CL-COMPANY-CD-A4        PIC X.
  3777         16  CL-CERT-NO-A4.
  3778             20  CL-CERT-A4-PRIME    PIC X(10).
  3779             20  CL-CERT-A4-SFX      PIC X.
  3780
  3781     12  CL-CONTROL-BY-CCN.
  3782         16  CL-COMPANY-CD-A5        PIC X.
  3783         16  CL-CCN-A5.
  3784             20  CL-CCN.
  3785                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3786                 24  CL-CCN-PRIME-A5 PIC X(12).
  3787             20  CL-CCN-FILLER-A5    PIC X(4).
  3788
  3789     12  CL-INSURED-PROFILE-DATA.
  3790         16  CL-INSURED-BIRTH-DT     PIC XX.
  3791         16  CL-INSURED-SEX-CD       PIC X.
  3792             88  INSURED-IS-MALE        VALUE 'M'.
  3793             88  INSURED-IS-FEMALE      VALUE 'F'.
  3794             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3795         16  CL-INSURED-OCC-CD       PIC X(6).
  3796         16  FILLER                  PIC X(5).
  3797
  3798     12  CL-PROCESSING-INFO.
  3799         16  CL-PROCESSOR-ID         PIC X(4).
  3800         16  CL-CLAIM-STATUS         PIC X.
  3801             88  CLAIM-IS-OPEN          VALUE 'O'.
  3802             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3803         16  CL-CLAIM-TYPE           PIC X.
  3804*            88  AH-CLAIM               VALUE 'A'.
  3805*            88  LIFE-CLAIM             VALUE 'L'.
  3806*            88  PROPERTY-CLAIM         VALUE 'P'.
  3807*            88  IUI-CLAIM              VALUE 'I'.
  3808*            88  GAP-CLAIM              VALUE 'G'.
  3809         16  CL-CLAIM-PREM-TYPE      PIC X.
  3810             88  SINGLE-PREMIUM         VALUE '1'.
  3811             88  O-B-COVERAGE           VALUE '2'.
  3812             88  OPEN-END-COVERAGE      VALUE '3'.
  3813         16  CL-INCURRED-DT          PIC XX.
  3814         16  CL-REPORTED-DT          PIC XX.
  3815         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3816         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3817         16  CL-LAST-PMT-DT          PIC XX.
  3818         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3819         16  CL-PAID-THRU-DT         PIC XX.
  3820         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3821         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3822         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3823         16  CL-PMT-CALC-METHOD      PIC X.
  3824             88  CL-360-DAY-YR          VALUE '1'.
  3825             88  CL-365-DAY-YR          VALUE '2'.
  3826             88  CL-FULL-MONTHS         VALUE '3'.
  3827         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  73
* EL154.cbl
  3828
  3829         16  CL-PRIME-CERT-NO.
  3830             20  CL-PRIME-CERT-PRIME PIC X(10).
  3831             20  CL-PRIME-CERT-SFX   PIC X.
  3832
  3833         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3834             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3835             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3836
  3837         16  CL-MICROFILM-NO         PIC X(10).
  3838         16  CL-PROG-FORM-TYPE       PIC X.
  3839         16  CL-LAST-ADD-ON-DT       PIC XX.
  3840
  3841         16  CL-LAST-REOPEN-DT       PIC XX.
  3842         16  CL-LAST-CLOSE-DT        PIC XX.
  3843         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3844             88  FINAL-PAID             VALUE '1'.
  3845             88  CLAIM-DENIED           VALUE '2'.
  3846             88  AUTO-CLOSE             VALUE '3'.
  3847             88  MANUAL-CLOSE           VALUE '4'.
  3848             88  BENEFITS-CHANGED       VALUE 'C'.
  3849             88  SETUP-ERRORS           VALUE 'E'.
  3850         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3851         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3852         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3853             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3854         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3855         16  FILLER                  PIC X.
  3856
  3857     12  CL-CERTIFICATE-DATA.
  3858         16  CL-CERT-ORIGIN          PIC X.
  3859             88  CERT-WAS-ONLINE        VALUE '1'.
  3860             88  CERT-WAS-CREATED       VALUE '2'.
  3861             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3862         16  CL-CERT-KEY-DATA.
  3863             20  CL-CERT-CARRIER     PIC X.
  3864             20  CL-CERT-GROUPING    PIC X(6).
  3865             20  CL-CERT-STATE       PIC XX.
  3866             20  CL-CERT-ACCOUNT.
  3867                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3868                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3869             20  CL-CERT-EFF-DT      PIC XX.
  3870
  3871     12  CL-STATUS-CONTROLS.
  3872         16  CL-PRIORITY-CD          PIC X.
  3873             88  CONFIDENTIAL-DATA      VALUE '8'.
  3874             88  HIGHEST-PRIORITY       VALUE '9'.
  3875         16  CL-SUPV-ATTN-CD         PIC X.
  3876             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3877             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3878         16  CL-PURGED-DT            PIC XX.
  3879         16  CL-RESTORED-DT          PIC XX.
  3880         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3881         16  CL-NEXT-RESEND-DT       PIC XX.
  3882         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3883         16  CL-CRITICAL-PERIOD      PIC 99.
  3884*        16  FILLER                  PIC XX.
  3885         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  74
* EL154.cbl
  3886         16  CL-LAST-MAINT-USER      PIC X(4).
  3887         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3888         16  CL-LAST-MAINT-TYPE      PIC X.
  3889             88  CLAIM-SET-UP           VALUE ' '.
  3890             88  PAYMENT-MADE           VALUE '1'.
  3891             88  LETTER-SENT            VALUE '2'.
  3892             88  MASTER-WAS-ALTERED     VALUE '3'.
  3893             88  MASTER-WAS-RESTORED    VALUE '4'.
  3894             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3895             88  FILE-CONVERTED         VALUE '6'.
  3896             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3897             88  ERROR-CORRECTION       VALUE 'E'.
  3898         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3899         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3900         16  CL-BENEFICIARY          PIC X(10).
  3901         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3902         16  CL-DENIAL-TYPE          PIC X.
  3903             88  CL-TYPE-DENIAL          VALUE '1'.
  3904             88  CL-TYPE-RESCISSION      VALUE '2'.
  3905             88  CL-TYPE-REFORMATION     VALUE '3'.
  3906             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3907             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3908         16  CL-CRIT-PER-RECURRENT   PIC X.
  3909         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3910         16  CL-RTW-DT               PIC XX.
  3911
  3912     12  CL-TRAILER-CONTROLS.
  3913         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3914             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3915             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3916             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3917         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3918         16  FILLER                  PIC XX.
  3919         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3920         16  CL-ADDRESS-TRAILER-CNT.
  3921             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3922                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3923             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3924                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3925             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3926                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3927             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3928                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3929             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3930                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3931             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3932                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3933             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3934                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3935
  3936     12  CL-CV-REFERENCE-NO.
  3937         16  CL-CV-REFNO-PRIME       PIC X(18).
  3938         16  CL-CV-REFNO-SFX         PIC XX.
  3939
  3940     12  CL-FILE-LOCATION            PIC X(4).
  3941
  3942     12  CL-PROCESS-ERRORS.
  3943         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  75
* EL154.cbl
  3944             88  NO-FATAL-ERRORS        VALUE ZERO.
  3945         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3946             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3947
  3948     12  CL-PRODUCT-CD               PIC X.
  3949
  3950     12  CL-CURRENT-KEY-DATA.
  3951         16  CL-CURRENT-CARRIER      PIC X.
  3952         16  CL-CURRENT-GROUPING     PIC X(6).
  3953         16  CL-CURRENT-STATE        PIC XX.
  3954         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3955
  3956     12  CL-ASSOCIATES               PIC X.
  3957         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3958         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3959         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3960         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3961
  3962     12  CL-ACTIVITY-CODE            PIC 99.
  3963     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3964     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3965
  3966     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3967     12  CL-LAG-REPORT-CODE          PIC 9.
  3968     12  CL-LOAN-TYPE                PIC XX.
  3969     12  CL-LEGAL-STATE              PIC XX.
  3970
  3971     12  CL-YESNOSW                  PIC X.
  3972     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3973         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3974         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3975         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3976     12  cl-insured-claim            pic x.
  3977         88  cl-claim-on-primary         value 'P'.
  3978         88  cl-claim-on-secondary       value 'S'.
  3979     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  76
* EL154.cbl
  3981*                            COPY ELCTRLR.
  3982******************************************************************
  3983*                                                                *
  3984*                            ELCTRLR.                            *
  3985*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3986*                            VMOD=2.014                          *
  3987*                                                                *
  3988*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3989*                                                                *
  3990*   FILE TYPE = VSAM,KSDS                                        *
  3991*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3992*                                                                *
  3993*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3994*       ALTERNATE INDEX = NONE                                   *
  3995*                                                                *
  3996*   LOG = YES                                                    *
  3997*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3998******************************************************************
  3999*                   C H A N G E   L O G
  4000*
  4001* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4002*-----------------------------------------------------------------
  4003*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4004* EFFECTIVE    NUMBER
  4005*-----------------------------------------------------------------
  4006* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4007* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4008* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4009* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4010* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4011* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4012* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4013* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4014* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4015* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4016* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4017* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4018* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4019* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4020* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4021* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4022******************************************************************
  4023 01  ACTIVITY-TRAILERS.
  4024     12  AT-RECORD-ID                    PIC XX.
  4025         88  VALID-AT-ID                       VALUE 'AT'.
  4026
  4027     12  AT-CONTROL-PRIMARY.
  4028         16  AT-COMPANY-CD               PIC X.
  4029         16  AT-CARRIER                  PIC X.
  4030         16  AT-CLAIM-NO                 PIC X(7).
  4031         16  AT-CERT-NO.
  4032             20  AT-CERT-PRIME           PIC X(10).
  4033             20  AT-CERT-SFX             PIC X.
  4034         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4035             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4036             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4037             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4038             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  77
* EL154.cbl
  4039             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4040             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4041             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4042             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4043             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4044             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4045             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4046             88  AT-BENEFICIARY-TRL           VALUE +91.
  4047             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4048             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4049             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4050             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4051
  4052     12  AT-TRAILER-TYPE                 PIC X.
  4053         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4054         88  PAYMENT-TR                       VALUE '2'.
  4055         88  AUTO-PAY-TR                      VALUE '3'.
  4056         88  CORRESPONDENCE-TR                VALUE '4'.
  4057         88  ADDRESS-TR                       VALUE '5'.
  4058         88  GENERAL-INFO-TR                  VALUE '6'.
  4059         88  AUTO-PROMPT-TR                   VALUE '7'.
  4060         88  DENIAL-TR                        VALUE '8'.
  4061         88  INCURRED-CHG-TR                  VALUE '9'.
  4062         88  FORM-CONTROL-TR                  VALUE 'A'.
  4063
  4064     12  AT-RECORDED-DT                  PIC XX.
  4065     12  AT-RECORDED-BY                  PIC X(4).
  4066     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4067
  4068     12  AT-TRAILER-BODY                 PIC X(165).
  4069
  4070     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4071         16  AT-RESERVE-CONTROLS.
  4072             20  AT-MANUAL-SW            PIC X.
  4073                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4074             20  AT-FUTURE-SW            PIC X.
  4075                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4076             20  AT-PTC-SW               PIC X.
  4077                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4078             20  AT-IBNR-SW              PIC X.
  4079                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4080             20  AT-PTC-LF-SW            PIC X.
  4081                 88  AT-LF-PTC-USED          VALUE '1'.
  4082             20  AT-CDT-ACCESS-METHOD    PIC X.
  4083                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4084                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4085                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4086             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4087         16  AT-LAST-COMPUTED-DT         PIC XX.
  4088         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4089         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4090         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4091         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4092         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4093         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4094         16  AT-EXPENSE-CONTROLS.
  4095             20  AT-EXPENSE-METHOD       PIC X.
  4096                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  78
* EL154.cbl
  4097                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4098                 88  PERCENT-OF-PMT           VALUE '3'.
  4099                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4100             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4101             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4102         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4103         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4104
  4105         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4106         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4107
  4108*        16  FILLER                      PIC X(53).
  4109         16  FILLER                      PIC X(47).
  4110
  4111         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4112         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4113
  4114         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4115             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4116             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4117*                    C = CLOSED
  4118*                    O = OPEN
  4119             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4120*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4121
  4122     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4123         16  AT-PAYMENT-TYPE             PIC X.
  4124             88  PARTIAL-PAYMENT                VALUE '1'.
  4125             88  FINAL-PAYMENT                  VALUE '2'.
  4126             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4127             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4128             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4129             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4130             88  VOIDED-PAYMENT                 VALUE '9'.
  4131             88  TRANSFER                       VALUE 'T'.
  4132             88  LIFE-INTEREST                  VALUE 'I'.
  4133
  4134         16  AT-CLAIM-TYPE               PIC X.
  4135             88  PAID-FOR-AH                    VALUE 'A'.
  4136             88  PAID-FOR-LIFE                  VALUE 'L'.
  4137             88  PAID-FOR-IUI                   VALUE 'I'.
  4138             88  PAID-FOR-GAP                   VALUE 'G'.
  4139         16  AT-CLAIM-PREM-TYPE          PIC X.
  4140             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4141             88  AT-O-B-COVERAGE                VALUE '2'.
  4142             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4143         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4144         16  AT-CHECK-NO                 PIC X(7).
  4145         16  AT-PAID-FROM-DT             PIC XX.
  4146         16  AT-PAID-THRU-DT             PIC XX.
  4147         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4148         16  FILLER                      PIC X.
  4149         16  AT-PAYEES-NAME              PIC X(30).
  4150         16  AT-PAYMENT-ORIGIN           PIC X.
  4151             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4152             88  ONLINE-AUTO-PMT                VALUE '2'.
  4153             88  OFFLINE-PMT                    VALUE '3'.
  4154         16  AT-CHECK-WRITTEN-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  79
* EL154.cbl
  4155         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4156         16  AT-VOID-DATA.
  4157             20  AT-VOID-DT              PIC XX.
  4158*00144       20  AT-VOID-REASON          PIC X(30).
  4159             20  AT-VOID-REASON          PIC X(26).
  4160         16  AT-PMT-APPROVED-BY          PIC X(04).
  4161         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4162         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4163         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4164                                         PIC S99V9(5)  COMP-3.
  4165         16  AT-CREDIT-INTERFACE.
  4166             20  AT-PMT-SELECT-DT        PIC XX.
  4167                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4168             20  AT-PMT-ACCEPT-DT        PIC XX.
  4169                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4170             20  AT-VOID-SELECT-DT       PIC XX.
  4171                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4172             20  AT-VOID-ACCEPT-DT       PIC XX.
  4173                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4174
  4175         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4176                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4177                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4178         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4179
  4180         16  AT-FORCE-CONTROL            PIC X.
  4181             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4182         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4183         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4184         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4185         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4186         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4187         16  AT-BENEFIT-TYPE             PIC X.
  4188
  4189         16  AT-EXPENSE-TYPE             PIC X.
  4190         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4191
  4192         16  AT-PAYEE-TYPE-CD.
  4193             20  AT-PAYEE-TYPE           PIC X.
  4194                 88  INSURED-PAID           VALUE 'I'.
  4195                 88  BENEFICIARY-PAID       VALUE 'B'.
  4196                 88  ACCOUNT-PAID           VALUE 'A'.
  4197                 88  OTHER-1-PAID           VALUE 'O'.
  4198                 88  OTHER-2-PAID           VALUE 'Q'.
  4199                 88  DOCTOR-PAID            VALUE 'P'.
  4200                 88  EMPLOYER-PAID          VALUE 'E'.
  4201             20  AT-PAYEE-SEQ            PIC X.
  4202
  4203         16  AT-CASH-PAYMENT             PIC X.
  4204         16  AT-GROUPED-PAYMENT          PIC X.
  4205         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4206         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4207         16  AT-APPROVED-LEVEL           PIC X.
  4208         16  AT-VOID-TYPE                PIC X.
  4209             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4210             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4211         16  AT-AIG-UNEMP-IND            PIC X.
  4212             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  80
* EL154.cbl
  4213         16  AT-ASSOCIATES               PIC X.
  4214             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4215             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4216
  4217         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4218         16  AT-CV-PMT-CODE              PIC X.
  4219             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4220             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4221             88  FULL-ADD-PAYMENT           VALUE '3'.
  4222             88  HALF-ADD-PAYMENT           VALUE '4'.
  4223             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4224             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4225             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4226             88  ADDL-PAYMENT               VALUE '8'.
  4227
  4228         16  AT-EOB-CODE1                PIC XXX.
  4229         16  AT-EOB-CODE2                PIC XXX.
  4230         16  AT-EOB-CODE3                PIC XXX.
  4231         16  FILLER REDEFINES AT-EOB-CODE3.
  4232             20  AT-PRINT-CLM-FORM       PIC X.
  4233             20  AT-PRINT-SURVEY         PIC X.
  4234             20  FILLER                  PIC X.
  4235         16  AT-EOB-CODE4                PIC XXX.
  4236         16  FILLER REDEFINES AT-EOB-CODE4.
  4237             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4238             20  FILLER                  PIC X.
  4239         16  AT-EOB-CODE5                PIC XXX.
  4240         16  FILLER REDEFINES AT-EOB-CODE5.
  4241             20  AT-PMT-PROOF-DT         PIC XX.
  4242             20  FILLER                  PIC X.
  4243
  4244         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4245             88  AT-PRINT-EOB            VALUE 'Y'.
  4246
  4247         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4248         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4249
  4250     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4251         16  AT-SCHEDULE-START-DT        PIC XX.
  4252         16  AT-SCHEDULE-END-DT          PIC XX.
  4253         16  AT-TERMINATED-DT            PIC XX.
  4254         16  AT-LAST-PMT-TYPE            PIC X.
  4255             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4256             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4257         16  AT-FIRST-PMT-DATA.
  4258             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4259             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4260             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4261         16  AT-REGULAR-PMT-DATA.
  4262             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4263             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4264             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4265         16  AT-AUTO-PAYEE-CD.
  4266             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4267                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4268                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4269                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4270                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  81
* EL154.cbl
  4271                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4272             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4273         16  AT-AUTO-PAY-DAY             PIC 99.
  4274         16  AT-AUTO-CASH                PIC X.
  4275             88  AT-CASH                      VALUE 'Y'.
  4276             88  AT-NON-CASH                  VALUE 'N'.
  4277*        16  FILLER                      PIC X(129).
  4278         16  AT-AUTO-END-LETTER          PIC X(4).
  4279         16  FILLER                      PIC X(125).
  4280
  4281         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4282         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4283
  4284     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4285         16  AT-LETTER-SENT-DT           PIC XX.
  4286         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4287         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4288         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4289         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4290         16  AT-LETTER-ORIGIN            PIC X.
  4291             88  ONLINE-CREATION              VALUE '1' '3'.
  4292             88  OFFLINE-CREATION             VALUE '2' '4'.
  4293             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4294             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4295         16  AT-STD-LETTER-FORM          PIC X(4).
  4296         16  AT-REASON-TEXT              PIC X(70).
  4297         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4298         16  AT-ADDRESEE-TYPE            PIC X.
  4299              88  INSURED-ADDRESEE            VALUE 'I'.
  4300              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4301              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4302              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4303              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4304              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4305              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4306         16  AT-ADDRESSEE-NAME           PIC X(30).
  4307         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4308         16  AT-RESEND-PRINT-DATE        PIC XX.
  4309         16  AT-CORR-SOL-UNSOL           PIC X.
  4310         16  AT-LETTER-PURGED-DT         PIC XX.
  4311*
  4312*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4313*
  4314         16  AT-CSO-REDEFINITION.
  4315             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4316             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4317             20  AT-LETTER-TO-BENE       PIC X(1).
  4318             20  AT-STOP-LETTER-DT       PIC X(2).
  4319             20  FILLER                  PIC X(19).
  4320*             20  FILLER                  PIC X(27).
  4321             20  AT-CSO-LETTER-STATUS    PIC X.
  4322                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4323                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4324                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4325             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4326             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4327*
  4328*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  82
* EL154.cbl
  4329*
  4330*        16  FILLER                      PIC X(26).
  4331*
  4332*        16  AT-DMD-BSR-CODE             PIC X.
  4333*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4334*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4335*
  4336*        16  AT-DMD-LETTER-STATUS        PIC X.
  4337*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4338*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4339*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4340*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4341*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4342
  4343         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4344         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4345
  4346     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4347         16  AT-ADDRESS-TYPE             PIC X.
  4348             88  INSURED-ADDRESS               VALUE 'I'.
  4349             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4350             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4351             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4352             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4353             88  OTHER-ADDRESS-1               VALUE 'O'.
  4354             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4355         16  AT-MAIL-TO-NAME             PIC X(30).
  4356         16  AT-ADDRESS-LINE-1           PIC X(30).
  4357         16  AT-ADDRESS-LINE-2           PIC X(30).
  4358         16  AT-CITY-STATE.
  4359             20  AT-CITY                 PIC X(28).
  4360             20  AT-STATE                PIC XX.
  4361         16  AT-ZIP.
  4362             20  AT-ZIP-CODE.
  4363                 24  AT-ZIP-1ST          PIC X.
  4364                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4365                 24  FILLER              PIC X(4).
  4366             20  AT-ZIP-PLUS4            PIC X(4).
  4367         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4368             20  AT-CAN-POSTAL-1         PIC XXX.
  4369             20  AT-CAN-POSTAL-2         PIC XXX.
  4370             20  FILLER                  PIC XXX.
  4371         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4372*         16  FILLER                      PIC X(23).
  4373         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4374         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4375         16  FILLER                      PIC X(13).
  4376         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4377         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4378
  4379     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4380         16  AT-INFO-LINE-1              PIC X(60).
  4381         16  FILLER REDEFINES AT-INFO-LINE-1.
  4382             20  AT-NOTE-ERROR-NO OCCURS 15
  4383                                         PIC X(4).
  4384         16  AT-INFO-LINE-2              PIC X(60).
  4385         16  AT-INFO-TRAILER-TYPE        PIC X.
  4386             88  AT-ERRORS-NOTE          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  83
* EL154.cbl
  4387             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4388             88  AT-CALL-NOTE            VALUE 'C'.
  4389             88  AT-MAINT-NOTE           VALUE 'M'.
  4390             88  AT-CERT-CHANGE          VALUE 'X'.
  4391             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4392             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4393         16  AT-CALL-TYPE                PIC X.
  4394             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4395             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4396         16  AT-NOTE-CONTINUATION        PIC X.
  4397             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4398         16  AT-EOB-CODES-EXIST          PIC X.
  4399             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4400         16  FILLER                      PIC X(35).
  4401         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4402         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4403
  4404     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4405         16  AT-PROMPT-LINE-1            PIC X(60).
  4406         16  AT-PROMPT-LINE-2            PIC X(60).
  4407         16  AT-PROMPT-START-DT          PIC XX.
  4408         16  AT-PROMPT-END-DT            PIC XX.
  4409         16  FILLER                      PIC X(35).
  4410         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4411         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4412
  4413     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4414         16  AT-DENIAL-INFO-1            PIC X(60).
  4415         16  AT-DENIAL-INFO-2            PIC X(60).
  4416         16  AT-DENIAL-DT                PIC XX.
  4417         16  AT-RETRACTION-DT            PIC XX.
  4418         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4419*         16  FILLER                      PIC X(31).
  4420         16  AT-DENIAL-PROOF-DT          PIC XX.
  4421         16  FILLER                      PIC X(29).
  4422         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4423         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4424
  4425     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4426         16  AT-OLD-INCURRED-DT          PIC XX.
  4427         16  AT-OLD-REPORTED-DT          PIC XX.
  4428         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4429         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4430         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4431         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4432         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4433         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4434         16  FILLER                      PIC X(26).
  4435         16  AT-OLD-DIAG-CODE            PIC X(6).
  4436         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4437         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4438         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4439         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4440         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4441         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4442         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4443         16  FILLER                      PIC X(25).
  4444         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  84
* EL154.cbl
  4445
  4446     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4447         16  AT-FORM-SEND-ON-DT          PIC XX.
  4448         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4449         16  AT-FORM-RE-SEND-DT          PIC XX.
  4450         16  AT-FORM-ANSWERED-DT         PIC XX.
  4451         16  AT-FORM-PRINTED-DT          PIC XX.
  4452         16  AT-FORM-REPRINT-DT          PIC XX.
  4453         16  AT-FORM-TYPE                PIC X.
  4454             88  INITIAL-FORM                  VALUE '1'.
  4455             88  PROGRESS-FORM                 VALUE '2'.
  4456         16  AT-INSTRUCT-LN-1            PIC X(28).
  4457         16  AT-INSTRUCT-LN-2            PIC X(28).
  4458         16  AT-INSTRUCT-LN-3            PIC X(28).
  4459         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4460         16  AT-FORM-ADDRESS             PIC X.
  4461             88  FORM-TO-INSURED              VALUE 'I'.
  4462             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4463             88  FORM-TO-OTHER-1              VALUE 'O'.
  4464             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4465         16  AT-RELATED-1.
  4466             20 AT-REL-CARR-1            PIC X.
  4467             20 AT-REL-CLAIM-1           PIC X(7).
  4468             20 AT-REL-CERT-1            PIC X(11).
  4469         16  AT-RELATED-2.
  4470             20 AT-REL-CARR-2            PIC X.
  4471             20 AT-REL-CLAIM-2           PIC X(7).
  4472             20 AT-REL-CERT-2            PIC X(11).
  4473         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4474         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4475         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4476         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4477         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4478         16  AT-STOP-FORM-DT             PIC X(2).
  4479
  4480         16  FILLER                      PIC X(09).
  4481         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4482         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4483******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  85
* EL154.cbl
  4485*                            COPY ELCCERT.
  4486******************************************************************
  4487*                                                                *
  4488*                            ELCCERT.                            *
  4489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4490*                            VMOD=2.013                          *
  4491*                                                                *
  4492*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4493*                                                                *
  4494*   FILE TYPE = VSAM,KSDS                                        *
  4495*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4496*                                                                *
  4497*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4498*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4499*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4500*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4501*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4502*                                                                *
  4503*   LOG = YES                                                    *
  4504*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4505******************************************************************
  4506*                   C H A N G E   L O G
  4507*
  4508* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4509*-----------------------------------------------------------------
  4510*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4511* EFFECTIVE    NUMBER
  4512*-----------------------------------------------------------------
  4513* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4514* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4515* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4516* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4517* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4518* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4519* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4520* 032612  CR2011110200001  PEMA  AHL CHANGES
  4521******************************************************************
  4522
  4523 01  CERTIFICATE-MASTER.
  4524     12  CM-RECORD-ID                      PIC XX.
  4525         88  VALID-CM-ID                      VALUE 'CM'.
  4526
  4527     12  CM-CONTROL-PRIMARY.
  4528         16  CM-COMPANY-CD                 PIC X.
  4529         16  CM-CARRIER                    PIC X.
  4530         16  CM-GROUPING.
  4531             20  CM-GROUPING-PREFIX        PIC X(3).
  4532             20  CM-GROUPING-PRIME         PIC X(3).
  4533         16  CM-STATE                      PIC XX.
  4534         16  CM-ACCOUNT.
  4535             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4536             20  CM-ACCOUNT-PRIME          PIC X(6).
  4537         16  CM-CERT-EFF-DT                PIC XX.
  4538         16  CM-CERT-NO.
  4539             20  CM-CERT-PRIME             PIC X(10).
  4540             20  CM-CERT-SFX               PIC X.
  4541
  4542     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  86
* EL154.cbl
  4543         16  CM-COMPANY-CD-A1              PIC X.
  4544         16  CM-INSURED-LAST-NAME          PIC X(15).
  4545         16  CM-INSURED-INITIALS.
  4546             20  CM-INSURED-INITIAL1       PIC X.
  4547             20  CM-INSURED-INITIAL2       PIC X.
  4548
  4549     12  CM-CONTROL-BY-SSN.
  4550         16  CM-COMPANY-CD-A2              PIC X.
  4551         16  CM-SOC-SEC-NO.
  4552             20  CM-SSN-STATE              PIC XX.
  4553             20  CM-SSN-ACCOUNT            PIC X(6).
  4554             20  CM-SSN-LN3.
  4555                 25  CM-INSURED-INITIALS-A2.
  4556                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4557                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4558                 25 CM-PART-LAST-NAME-A2         PIC X.
  4559
  4560     12  CM-CONTROL-BY-CERT-NO.
  4561         16  CM-COMPANY-CD-A4              PIC X.
  4562         16  CM-CERT-NO-A4                 PIC X(11).
  4563
  4564     12  CM-CONTROL-BY-MEMB.
  4565         16  CM-COMPANY-CD-A5              PIC X.
  4566         16  CM-MEMBER-NO.
  4567             20  CM-MEMB-STATE             PIC XX.
  4568             20  CM-MEMB-ACCOUNT           PIC X(6).
  4569             20  CM-MEMB-LN4.
  4570                 25  CM-INSURED-INITIALS-A5.
  4571                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4572                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4573                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4574
  4575     12  CM-INSURED-PROFILE-DATA.
  4576         16  CM-INSURED-FIRST-NAME.
  4577             20  CM-INSURED-1ST-INIT       PIC X.
  4578             20  FILLER                    PIC X(9).
  4579         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4580         16  CM-INSURED-SEX                PIC X.
  4581             88  CM-SEX-MALE                  VALUE 'M'.
  4582             88  CM-SEX-FEMAL                 VALUE 'F'.
  4583         16  CM-INSURED-JOINT-AGE          PIC 99.
  4584         16  CM-JOINT-INSURED-NAME.
  4585             20  CM-JT-LAST-NAME           PIC X(15).
  4586             20  CM-JT-FIRST-NAME.
  4587                 24  CM-JT-1ST-INIT        PIC X.
  4588                 24  FILLER                PIC X(9).
  4589             20  CM-JT-INITIAL             PIC X.
  4590
  4591     12  CM-LIFE-DATA.
  4592         16  CM-LF-BENEFIT-CD              PIC XX.
  4593         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4594         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4595         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4596         16  CM-LF-DEV-CODE                PIC XXX.
  4597         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4598         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4599         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4600         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  87
* EL154.cbl
  4601         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4602         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4603         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4604         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4605         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4606         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4607         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4608         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4609         16  FILLER                        PIC XX.
  4610
  4611     12  CM-AH-DATA.
  4612         16  CM-AH-BENEFIT-CD              PIC XX.
  4613         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4614         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4615         16  CM-AH-DEV-CODE                PIC XXX.
  4616         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4617         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4618         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4619         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4620         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4621         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4622         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4623         16  CM-AH-PAID-THRU-DT            PIC XX.
  4624             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4625         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4626         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4627         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4628         16  FILLER                        PIC X.
  4629
  4630     12  CM-LOAN-INFORMATION.
  4631         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4632         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4633                                           PIC S9(5)V99  COMP-3.
  4634         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4635         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4636         16  CM-PAY-FREQUENCY              PIC S99.
  4637         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4638         16  CM-RATE-CLASS                 PIC XX.
  4639         16  CM-BENEFICIARY                PIC X(25).
  4640         16  CM-POLICY-FORM-NO             PIC X(12).
  4641         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4642         16  CM-LAST-ADD-ON-DT             PIC XX.
  4643         16  CM-DEDUCTIBLE-AMOUNTS.
  4644             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4645             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4646         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4647             20  CM-RESIDENT-STATE         PIC XX.
  4648             20  CM-RATE-CODE              PIC X(4).
  4649             20  FILLER                    PIC XX.
  4650         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4651             20  CM-LOAN-OFFICER           PIC X(5).
  4652             20  FILLER                    PIC XXX.
  4653         16  CM-CSR-CODE                   PIC XXX.
  4654         16  CM-UNDERWRITING-CODE          PIC X.
  4655             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4656         16  CM-POST-CARD-IND              PIC X.
  4657         16  CM-NH-INTERFACE-SW            PIC X.
  4658         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  88
* EL154.cbl
  4659             88  CM-SING-PRM                  VALUE '1'.
  4660             88  CM-O-B-COVERAGE              VALUE '2'.
  4661             88  CM-OPEN-END                  VALUE '3'.
  4662         16  CM-IND-GRP-TYPE               PIC X.
  4663             88  CM-INDIVIDUAL                VALUE 'I'.
  4664             88  CM-GROUP                     VALUE 'G'.
  4665         16  CM-SKIP-CODE                  PIC X.
  4666             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4667             88  SKIP-JULY                    VALUE '1'.
  4668             88  SKIP-AUGUST                  VALUE '2'.
  4669             88  SKIP-SEPTEMBER               VALUE '3'.
  4670             88  SKIP-JULY-AUG                VALUE '4'.
  4671             88  SKIP-AUG-SEPT                VALUE '5'.
  4672             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4673             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4674             88  SKIP-JUNE                    VALUE '8'.
  4675             88  SKIP-JUNE-JULY               VALUE '9'.
  4676             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4677             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4678         16  CM-PAYMENT-MODE               PIC X.
  4679             88  PAY-MONTHLY                  VALUE SPACE.
  4680             88  PAY-WEEKLY                   VALUE '1'.
  4681             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4682             88  PAY-BI-WEEKLY                VALUE '3'.
  4683             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4684         16  CM-LOAN-NUMBER                PIC X(8).
  4685         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4686         16  CM-OLD-LOF                    PIC XXX.
  4687*        16  CM-LOAN-OFFICER               PIC XXX.
  4688         16  CM-REIN-TABLE                 PIC XXX.
  4689         16  CM-SPECIAL-REIN-CODE          PIC X.
  4690         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4691         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4692         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4693
  4694     12  CM-STATUS-DATA.
  4695         16  CM-ENTRY-STATUS               PIC X.
  4696         16  CM-ENTRY-DT                   PIC XX.
  4697
  4698         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4699         16  CM-LF-CANCEL-DT               PIC XX.
  4700         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4701
  4702         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4703         16  CM-LF-DEATH-DT                PIC XX.
  4704         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4705
  4706         16  CM-LF-CURRENT-STATUS          PIC X.
  4707             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4708                                                'M' '4' '5' '9'.
  4709             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4710             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4711             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4712             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4713             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4714             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4715             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4716             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  89
* EL154.cbl
  4717             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4718             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4719             88  CM-LF-DECLINED               VALUE 'D'.
  4720             88  CM-LF-VOIDED                 VALUE 'V'.
  4721
  4722         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4723         16  CM-AH-CANCEL-DT               PIC XX.
  4724         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4725
  4726         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4727         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4728         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4729
  4730         16  CM-AH-CURRENT-STATUS          PIC X.
  4731             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4732                                                'M' '4' '5' '9'.
  4733             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4734             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4735             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4736             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4737             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4738             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4739             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4740             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4741             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4742             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4743             88  CM-AH-DECLINED               VALUE 'D'.
  4744             88  CM-AH-VOIDED                 VALUE 'V'.
  4745
  4746         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4747             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4748             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4749             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4750         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4751
  4752         16  CM-ENTRY-BATCH                PIC X(6).
  4753         16  CM-LF-EXIT-BATCH              PIC X(6).
  4754         16  CM-AH-EXIT-BATCH              PIC X(6).
  4755         16  CM-LAST-MONTH-END             PIC XX.
  4756
  4757     12  CM-NOTE-SW                        PIC X.
  4758         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4759         88  CERT-NOTES-PRESENT               VALUE '1'.
  4760         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4761         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4762         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4763         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4764         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4765         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4766     12  CM-COMP-EXCP-SW                   PIC X.
  4767         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4768         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4769     12  CM-INSURED-ADDRESS-SW             PIC X.
  4770         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4771         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4772
  4773*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4774     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  90
* EL154.cbl
  4775     12  FILLER                            PIC X.
  4776
  4777*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4778     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4779     12  FILLER                            PIC X.
  4780*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4781     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4782
  4783     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4784         88  CERT-ADDED-BATCH                 VALUE ' '.
  4785         88  CERT-ADDED-ONLINE                VALUE '1'.
  4786         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4787         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4788         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4789     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4790         88  CERT-AS-LOADED                   VALUE ' '.
  4791         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4792         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4793         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4794         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4795         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4796         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4797         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4798
  4799     12  CM-ACCOUNT-COMM-PCTS.
  4800         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4801         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4802
  4803     12  CM-USER-FIELD                     PIC X.
  4804     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4805     12  CM-CLP-STATE                      PIC XX.
  4806     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4807     12  CM-USER-RESERVED                  PIC XXX.
  4808     12  FILLER REDEFINES CM-USER-RESERVED.
  4809         16  CM-AH-CLASS-CD                PIC XX.
  4810         16  F                             PIC X.
  4811******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  91
* EL154.cbl
  4813*                            COPY ELCBENE.
  4814******************************************************************
  4815*                                                                *
  4816*                            ELCBENE.                            *
  4817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4818*                            VMOD=2.006                          *
  4819*                                                                *
  4820*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  4821*                                                                *
  4822*   FILE TYPE = VSAM,KSDS                                        *
  4823*   RECORD SIZE = 500   RECFORM = FIX                            *
  4824*                                                                *
  4825*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  4826*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  4827*                                                                *
  4828*   LOG = YES                                                    *
  4829*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4830*                                                                *
  4831*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  4832******************************************************************
  4833
  4834 01  BENEFICIARY-MASTER.
  4835     12  BE-RECORD-ID                PIC XX.
  4836         88  VALID-BE-ID                VALUE 'BE'.
  4837
  4838     12  BE-CONTROL-PRIMARY.
  4839         16  BE-COMPANY-CD           PIC X.
  4840         16  BE-RECORD-TYPE          PIC X.
  4841             88  BENEFICIARY-RECORD  VALUE 'B'.
  4842             88  ADJUSTOR-RECORD     VALUE 'A'.
  4843         16  BE-BENEFICIARY          PIC X(10).
  4844     12  BE-CONTROL-BY-NAME.
  4845         16  BE-COMPANY-CD-A1        PIC X.
  4846         16  BE-RECORD-TYPE-A1       PIC X.
  4847         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  4848         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  4849
  4850     12  BE-LAST-MAINT-DT            PIC XX.
  4851     12  BE-LAST-MAINT-BY            PIC X(4).
  4852     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4853
  4854     12  BE-ADDRESS-DATA.
  4855         16  BE-MAIL-TO-NAME         PIC X(30).
  4856         16  BE-ADDRESS-LINE-1       PIC X(30).
  4857         16  BE-ADDRESS-LINE-2       PIC X(30).
  4858         16  BE-ADDRESS-LINE-3       PIC X(30).
  4859         16  BE-CITY-STATE.
  4860             20  BE-CITY             PIC X(28).
  4861             20  BE-STATE            PIC XX.
  4862         16  BE-ZIP-CODE.
  4863             20  BE-ZIP-PRIME.
  4864                 24  BE-ZIP-1ST      PIC X.
  4865                     88  BE-CANADIAN-POST-CODE
  4866                                         VALUE 'A' THRU 'Z'.
  4867                 24  FILLER          PIC X(4).
  4868             20  BE-ZIP-PLUS4        PIC X(4).
  4869         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  4870             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  92
* EL154.cbl
  4871             20  BE-CAN-POSTAL-2     PIC XXX.
  4872             20  FILLER              PIC XXX.
  4873         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  4874         16  BE-GROUP-CHECKS-Y-N     PIC X.
  4875
  4876******************************************************************
  4877*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  4878*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  4879******************************************************************
  4880     12  BE-CARRIER                  PIC X.
  4881
  4882     12  BE-ADDRESS-DATA2.
  4883         16  BE-MAIL-TO-NAME2        PIC X(30).
  4884         16  BE-ADDRESS-LINE-12      PIC X(30).
  4885         16  BE-ADDRESS-LINE-22      PIC X(30).
  4886         16  BE-ADDRESS-LINE-32      PIC X(30).
  4887         16  BE-CITY-STATE2.
  4888             20  BE-CITY2            PIC X(28).
  4889             20  BE-STATE2           PIC XX.
  4890         16  BE-ZIP-CODE2.
  4891             20  BE-ZIP-PRIME2.
  4892                 24  BE-ZIP-1ST2     PIC X.
  4893                     88  BE-CANADIAN-POST-CODE2
  4894                                         VALUE 'A' THRU 'Z'.
  4895                 24  FILLER          PIC X(4).
  4896             20  BE-ZIP-PLUS42       PIC X(4).
  4897         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  4898             20  BE-CAN-POSTAL-12    PIC XXX.
  4899             20  BE-CAN-POSTAL-22    PIC XXX.
  4900             20  FILLER              PIC XXX.
  4901         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  4902         16  BE-BILLING-STMT-DATA.
  4903             20  BE-BSR              PIC X.
  4904                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  4905                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  4906             20  BE-BSR-FROM         PIC X(30).
  4907             20  BE-BSR-DEPT         PIC X(30).
  4908             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  4909             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  4910             20  BE-OUTPUT-TYPE      PIC X.
  4911                 88  BE-FAX-OUTPUT         VALUE 'F'.
  4912                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  4913
  4914     12  FILLER                      PIC X(28).
  4915******************************************************************
  4916*                            COPY ERCACCT.
  4917******************************************************************
  4918*                                                                *
  4919*                                                                *
  4920*                            ERCACCT                             *
  4921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4922*                            VMOD=2.031                          *
  4923*                                                                *
  4924*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4925*                                                                *
  4926*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4927*   VSAM ACCOUNT MASTER FILES.                                   *
  4928*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  93
* EL154.cbl
  4929*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4930*                                                                *
  4931*   FILE TYPE = VSAM,KSDS                                        *
  4932*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4933*                                                                *
  4934*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4935*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4936*                                                                *
  4937*   LOG = NO                                                     *
  4938*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4939*                                                                *
  4940*                                                                *
  4941******************************************************************
  4942*                   C H A N G E   L O G
  4943*
  4944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4945*-----------------------------------------------------------------
  4946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4947* EFFECTIVE    NUMBER
  4948*-----------------------------------------------------------------
  4949* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4950* 092705    2005050300006  PEMA  ADD SPP LEASES
  4951* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4952* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4953* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4954* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4955* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4956******************************************************************
  4957
  4958 01  ACCOUNT-MASTER.
  4959     12  AM-RECORD-ID                      PIC XX.
  4960         88  VALID-AM-ID                      VALUE 'AM'.
  4961
  4962     12  AM-CONTROL-PRIMARY.
  4963         16  AM-COMPANY-CD                 PIC X.
  4964         16  AM-MSTR-CNTRL.
  4965             20  AM-CONTROL-A.
  4966                 24  AM-CARRIER            PIC X.
  4967                 24  AM-GROUPING.
  4968                     28 AM-GROUPING-PREFIX PIC XXX.
  4969                     28 AM-GROUPING-PRIME  PIC XXX.
  4970                 24  AM-STATE              PIC XX.
  4971                 24  AM-ACCOUNT.
  4972                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4973                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4974             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4975                                           PIC X(19).
  4976             20  AM-CNTRL-B.
  4977                 24  AM-EXPIRATION-DT      PIC XX.
  4978                 24  FILLER                PIC X(4).
  4979             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4980                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4981
  4982     12  AM-CONTROL-BY-VAR-GRP.
  4983         16  AM-COMPANY-CD-A1              PIC X.
  4984         16  AM-VG-CARRIER                 PIC X.
  4985         16  AM-VG-GROUPING                PIC X(6).
  4986         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  94
* EL154.cbl
  4987         16  AM-VG-ACCOUNT                 PIC X(10).
  4988         16  AM-VG-DATE.
  4989             20  AM-VG-EXPIRATION-DT       PIC XX.
  4990             20  FILLER                    PIC X(4).
  4991         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4992                                           PIC 9(11)      COMP-3.
  4993     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4994         16  FILLER                        PIC X(10).
  4995         16  AM-VG-KEY3.
  4996             20  AM-VG3-ACCOUNT            PIC X(10).
  4997             20  AM-VG3-EXP-DT             PIC XX.
  4998         16  FILLER                        PIC X(4).
  4999     12  AM-MAINT-INFORMATION.
  5000         16  AM-LAST-MAINT-DT              PIC XX.
  5001         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5002         16  AM-LAST-MAINT-USER            PIC X(4).
  5003         16  FILLER                        PIC XX.
  5004
  5005     12  AM-EFFECTIVE-DT                   PIC XX.
  5006     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5007
  5008     12  AM-PREV-DATES  COMP-3.
  5009         16  AM-PREV-EXP-DT                PIC 9(11).
  5010         16  AM-PREV-EFF-DT                PIC 9(11).
  5011
  5012     12  AM-REPORT-CODE-1                  PIC X(10).
  5013     12  AM-REPORT-CODE-2                  PIC X(10).
  5014
  5015     12  AM-CITY-CODE                      PIC X(4).
  5016     12  AM-COUNTY-PARISH                  PIC X(6).
  5017
  5018     12  AM-NAME                           PIC X(30).
  5019     12  AM-PERSON                         PIC X(30).
  5020     12  AM-ADDRS                          PIC X(30).
  5021     12  AM-CITY.
  5022         16  AM-ADDR-CITY                  PIC X(28).
  5023         16  AM-ADDR-STATE                 PIC XX.
  5024     12  AM-ZIP.
  5025         16  AM-ZIP-PRIME.
  5026             20  AM-ZIP-PRI-1ST            PIC X.
  5027                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5028             20  FILLER                    PIC X(4).
  5029         16  AM-ZIP-PLUS4                  PIC X(4).
  5030     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5031         16  AM-CAN-POSTAL-1               PIC XXX.
  5032         16  AM-CAN-POSTAL-2               PIC XXX.
  5033         16  FILLER                        PIC XXX.
  5034     12  AM-TEL-NO.
  5035         16  AM-AREA-CODE                  PIC 999.
  5036         16  AM-TEL-PRE                    PIC 999.
  5037         16  AM-TEL-NBR                    PIC 9(4).
  5038     12  AM-TEL-LOC                        PIC X.
  5039         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5040         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5041
  5042     12  AM-COMM-STRUCTURE.
  5043         16  AM-DEFN-1.
  5044             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  95
* EL154.cbl
  5045                 24  AM-AGT.
  5046                     28  AM-AGT-PREFIX     PIC X(4).
  5047                     28  AM-AGT-PRIME      PIC X(6).
  5048                 24  AM-COM-TYP            PIC X.
  5049                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5050                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5051                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5052                 24  AM-RECALC-LV-INDIC    PIC X.
  5053                 24  AM-RETRO-LV-INDIC     PIC X.
  5054                 24  AM-GL-CODES           PIC X.
  5055                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5056                 24  FILLER                PIC X(01).
  5057         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5058             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5059                 24  FILLER                PIC X(11).
  5060                 24  AM-L-COMA             PIC XXX.
  5061                 24  AM-J-COMA             PIC XXX.
  5062                 24  AM-A-COMA             PIC XXX.
  5063                 24  FILLER                PIC X(6).
  5064
  5065     12  AM-COMM-CHANGE-STATUS             PIC X.
  5066         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5067
  5068     12  AM-CSR-CODE                       PIC X(4).
  5069
  5070     12  AM-BILLING-STATUS                 PIC X.
  5071         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5072         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5073     12  AM-AUTO-REFUND-SW                 PIC X.
  5074         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5075         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5076     12  AM-GPCD                           PIC 99.
  5077     12  AM-IG                             PIC X.
  5078         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5079         88  AM-HAS-GROUP                     VALUE '2'.
  5080     12  AM-STATUS                         PIC X.
  5081         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5082         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5083         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5084         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5085         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5086         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5087     12  AM-REMIT-TO                       PIC 99.
  5088     12  AM-ID-NO                          PIC X(11).
  5089
  5090     12  AM-CAL-TABLE                      PIC XX.
  5091     12  AM-LF-DEVIATION                   PIC XXX.
  5092     12  AM-AH-DEVIATION                   PIC XXX.
  5093     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5094     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5095     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5096     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5097     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5098     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5099
  5100     12  AM-USER-FIELDS.
  5101         16  AM-FLD-1                      PIC XX.
  5102         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  96
* EL154.cbl
  5103         16  AM-FLD-3                      PIC XX.
  5104         16  AM-FLD-4                      PIC XX.
  5105         16  AM-FLD-5                      PIC XX.
  5106
  5107     12  AM-1ST-PROD-DATE.
  5108         16  AM-1ST-PROD-YR                PIC XX.
  5109         16  AM-1ST-PROD-MO                PIC XX.
  5110         16  AM-1ST-PROD-DA                PIC XX.
  5111     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5112     12  AM-CERTS-PURGED-DATE.
  5113         16  AM-PUR-YR                     PIC XX.
  5114         16  AM-PUR-MO                     PIC XX.
  5115         16  AM-PUR-DA                     PIC XX.
  5116     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5117     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5118     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5119     12  AM-INACTIVE-DATE.
  5120         16  AM-INA-MO                     PIC 99.
  5121         16  AM-INA-DA                     PIC 99.
  5122         16  AM-INA-YR                     PIC 99.
  5123     12  AM-AR-HI-CERT-DATE                PIC XX.
  5124
  5125     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5126     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5127
  5128     12  AM-OB-PAYMENT-MODE                PIC X.
  5129         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5130         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5131         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5132         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5133
  5134     12  AM-AH-ONLY-INDICATOR              PIC X.
  5135         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5136         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5137
  5138     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5139
  5140     12  AM-OVER-SHORT.
  5141         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5142         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5143
  5144     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5145     12  AM-DCC-CLP-STATE                  PIC XX.
  5146
  5147     12  AM-RECALC-COMM                    PIC X.
  5148     12  AM-RECALC-REIN                    PIC X.
  5149
  5150     12  AM-REI-TABLE                      PIC XXX.
  5151     12  AM-REI-ET-LF                      PIC X.
  5152     12  AM-REI-ET-AH                      PIC X.
  5153     12  AM-REI-PE-LF                      PIC X.
  5154     12  AM-REI-PE-AH                      PIC X.
  5155     12  AM-REI-PRT-ST                     PIC X.
  5156     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5157     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5158     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5159     12  AM-REI-GROUP-A                    PIC X(6).
  5160     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  97
* EL154.cbl
  5161     12  AM-REI-PRT-OW                     PIC X.
  5162     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5163     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5164     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5165     12  AM-REI-GROUP-B                    PIC X(6).
  5166
  5167     12  AM-TRUST-TYPE                     PIC X(2).
  5168
  5169     12  AM-EMPLOYER-STMT-USED             PIC X.
  5170     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5171
  5172     12  AM-STD-AH-TYPE                    PIC XX.
  5173     12  AM-EARN-METHODS.
  5174         16  AM-EARN-METHOD-R              PIC X.
  5175             88 AM-REF-RL-R78                 VALUE 'R'.
  5176             88 AM-REF-RL-PR                  VALUE 'P'.
  5177             88 AM-REF-RL-MEAN                VALUE 'M'.
  5178             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5179         16  AM-EARN-METHOD-L              PIC X.
  5180             88 AM-REF-LL-R78                 VALUE 'R'.
  5181             88 AM-REF-LL-PR                  VALUE 'P'.
  5182             88 AM-REF-LL-MEAN                VALUE 'M'.
  5183             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5184         16  AM-EARN-METHOD-A              PIC X.
  5185             88 AM-REF-AH-R78                 VALUE 'R'.
  5186             88 AM-REF-AH-PR                  VALUE 'P'.
  5187             88 AM-REF-AH-MEAN                VALUE 'M'.
  5188             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5189             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5190             88 AM-REF-AH-NET                 VALUE 'N'.
  5191
  5192     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5193     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5194     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5195
  5196     12  AM-RET-Y-N                        PIC X.
  5197     12  AM-RET-P-E                        PIC X.
  5198     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5199     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5200     12  AM-RET-GRP                        PIC X(6).
  5201     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5202         16  AM-POOL-PRIME                 PIC XXX.
  5203         16  AM-POOL-SUB                   PIC XXX.
  5204     12  AM-RETRO-EARNINGS.
  5205         16  AM-RET-EARN-R                 PIC X.
  5206         16  AM-RET-EARN-L                 PIC X.
  5207         16  AM-RET-EARN-A                 PIC X.
  5208     12  AM-RET-ST-TAX-USE                 PIC X.
  5209         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5210         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5211     12  AM-RETRO-BEG-EARNINGS.
  5212         16  AM-RET-BEG-EARN-R             PIC X.
  5213         16  AM-RET-BEG-EARN-L             PIC X.
  5214         16  AM-RET-BEG-EARN-A             PIC X.
  5215     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5216     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5217
  5218     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  98
* EL154.cbl
  5219         16  AM-USER-SELECT-1              PIC X(10).
  5220         16  AM-USER-SELECT-2              PIC X(10).
  5221         16  AM-USER-SELECT-3              PIC X(10).
  5222         16  AM-USER-SELECT-4              PIC X(10).
  5223         16  AM-USER-SELECT-5              PIC X(10).
  5224
  5225     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5226
  5227     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5228
  5229     12  AM-RPT045A-SWITCH                 PIC X.
  5230         88  RPT045A-OFF                   VALUE 'N'.
  5231
  5232     12  AM-INSURANCE-LIMITS.
  5233         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5234         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5235
  5236     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5237         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5238
  5239     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5240         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5241         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5242
  5243     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5244
  5245     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5246     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5247     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5248     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5249     12  AM-DCC-UEF-STATE                  PIC XX.
  5250     12  FILLER                            PIC XXX.
  5251     12  AM-REPORT-CODE-3                  PIC X(10).
  5252*    12  FILLER                            PIC X(22).
  5253
  5254     12  AM-RESERVE-DATE.
  5255         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5256         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5257         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5258
  5259     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5260     12  AM-NOTIFICATION-TYPES.
  5261         16  AM-NOTIF-OF-LETTERS           PIC X.
  5262         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5263         16  AM-NOTIF-OF-REPORTS           PIC X.
  5264         16  AM-NOTIF-OF-STATUS            PIC X.
  5265
  5266     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5267         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5268         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5269         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5270         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5271
  5272     12  AM-BENEFIT-CONTROLS.
  5273         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5274             20  AM-BENEFIT-CODE           PIC XX.
  5275             20  AM-BENEFIT-TYPE           PIC X.
  5276             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  99
* EL154.cbl
  5277             20  AM-BENEFIT-REM-TERM       PIC X.
  5278             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5279             20  FILLER                    PIC XX.
  5280         16  FILLER                        PIC X(80).
  5281
  5282     12  AM-TRANSFER-DATA.
  5283         16  AM-TRANSFERRED-FROM.
  5284             20  AM-TRNFROM-CARRIER        PIC X.
  5285             20  AM-TRNFROM-GROUPING.
  5286                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5287                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5288             20  AM-TRNFROM-STATE          PIC XX.
  5289             20  AM-TRNFROM-ACCOUNT.
  5290                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5291                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5292             20  AM-TRNFROM-DTE            PIC XX.
  5293         16  AM-TRANSFERRED-TO.
  5294             20  AM-TRNTO-CARRIER          PIC X.
  5295             20  AM-TRNTO-GROUPING.
  5296                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5297                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5298             20  AM-TRNTO-STATE            PIC XX.
  5299             20  AM-TRNTO-ACCOUNT.
  5300                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5301                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5302             20  AM-TRNTO-DTE              PIC XX.
  5303         16  FILLER                        PIC X(10).
  5304
  5305     12  AM-SAVED-REMIT-TO                 PIC 99.
  5306
  5307     12  AM-COMM-STRUCTURE-SAVED.
  5308         16  AM-DEFN-1-SAVED.
  5309             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5310                 24  AM-AGT-SV             PIC X(10).
  5311                 24  AM-COM-TYP-SV         PIC X.
  5312                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5313                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5314                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5315                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5316                 24  FILLER                PIC X.
  5317                 24  AM-GL-CODES-SV        PIC X.
  5318                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5319                 24  FILLER                PIC X.
  5320         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5321             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5322                 24  FILLER                PIC X(11).
  5323                 24  AM-L-COMA-SV          PIC XXX.
  5324                 24  AM-J-COMA-SV          PIC XXX.
  5325                 24  AM-A-COMA-SV          PIC XXX.
  5326                 24  FILLER                PIC X(6).
  5327
  5328     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5329         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5330            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5331            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5332            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5333
  5334     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 100
* EL154.cbl
  5335     12  FILLER                            PIC X(120).
  5336
  5337     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5338         16  AM-CONTROL-NAME               PIC X(30).
  5339         16  AM-EXECUTIVE-ONE.
  5340             20  AM-EXEC1-NAME             PIC X(15).
  5341             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5342                                                          COMP-3.
  5343             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5344                                                          COMP-3.
  5345         16  AM-EXECUTIVE-TWO.
  5346             20  AM-EXEC2-NAME             PIC X(15).
  5347             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5348                                                          COMP-3.
  5349             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5350                                                          COMP-3.
  5351
  5352     12  AM-RETRO-ADDITIONAL-DATA.
  5353         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5354         16  AM-RETRO-PREM-P-E             PIC X.
  5355         16  AM-RETRO-CLMS-P-I             PIC X.
  5356         16  AM-RETRO-RET-BRACKET-LF.
  5357             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5358                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5359                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5360             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5361                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5362                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5363             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5364                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5365                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5366         16  AM-RETRO-RET-BRACKET-AH.
  5367             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5368                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5369                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5370                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5371             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5372                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5373                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5374             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5375                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5376                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5377
  5378     12  AM-COMMENTS.
  5379         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5380
  5381     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5382         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5383         16  AM-FLI-BILLING-CODE           PIC X.
  5384         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5385         16  AM-FLI-UNITED-IDENT           PIC X.
  5386         16  AM-FLI-INTEREST-LOST-DATA.
  5387             20  AM-FLI-BANK-NO            PIC X(5).
  5388             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5389             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5390             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5391         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5392             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 101
* EL154.cbl
  5393             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5394             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5395         16  FILLER                        PIC X(102).
  5396
  5397     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5398         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5399             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5400             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5401             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5402             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5403             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5404         16  FILLER                          PIC X(10).
  5405******************************************************************
  5406*                            COPY ERCPDEF.
  5407******************************************************************
  5408*                                                                *
  5409*                                                                *
  5410*                            ERCPDEF.                            *
  5411*                                                                *
  5412*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5413*                                                                *
  5414*    FILE TYPE = VSAM,KSDS                                       *
  5415*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5416*                                                                *
  5417*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5418*                                                                *
  5419*    LOG = YES                                                   *
  5420*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5421******************************************************************
  5422 01  PRODUCT-MASTER.
  5423    12  PD-RECORD-ID                 PIC X(02).
  5424        88  VALID-PD-ID                  VALUE 'PD'.
  5425    12  PD-CONTROL-PRIMARY.
  5426        16  PD-COMPANY-CD            PIC X.
  5427        16  PD-STATE                 PIC XX.
  5428        16  PD-PRODUCT-CD            PIC XXX.
  5429        16  PD-FILLER                PIC X(7).
  5430        16  PD-BEN-TYPE              PIC X.
  5431        16  PD-BEN-CODE              PIC XX.
  5432        16  PD-PROD-EXP-DT           PIC XX.
  5433    12  FILLER                       PIC X(50).
  5434    12  PD-PRODUCT-DATA OCCURS 8.
  5435        16  PD-PROD-CODE             PIC X.
  5436            88  PD-PROD-LIFE           VALUE 'L'.
  5437            88  PD-PROD-PROP           VALUE 'P'.
  5438            88  PD-PROD-AH             VALUE 'A'.
  5439            88  PD-PROD-IU             VALUE 'I'.
  5440            88  PD-PROD-GAP            VALUE 'G'.
  5441        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5442        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5443        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5444        16  PD-MAX-TERM              PIC S999        COMP-3.
  5445        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5446        16  FILLER                   PIC X.
  5447        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5448        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5449        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5450        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 102
* EL154.cbl
  5451        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5452        16  PD-REC-CRIT-PERIOD       PIC X.
  5453        16  PD-RTW-MOS               PIC 99.
  5454        16  FILLER                   PIC X(5).
  5455    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5456    12  PD-TERM-LIMITS OCCURS 15.
  5457        16  PD-LOW-TERM              PIC S999        COMP-3.
  5458        16  PD-HI-TERM               PIC S999        COMP-3.
  5459*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5460    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5461        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5462        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5463    12  PD-EARN-FACTORS.
  5464        16  FILLER OCCURS 15.
  5465            20  FILLER OCCURS 15.
  5466                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5467    12  PD-PRODUCT-DESC              PIC X(80).
  5468    12  PD-TRUNCATED                 PIC X.
  5469    12  FILLER                       PIC X(59).
  5470    12  PD-MAINT-INFORMATION.
  5471        16  PD-LAST-MAINT-DT         PIC X(02).
  5472        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5473        16  PD-LAST-MAINT-BY         PIC X(04).
  5474*                            copy ELCCRTT.
  5475******************************************************************
  5476*                                                                *
  5477*                            ELCCRTT.                            *
  5478*                                                                *
  5479*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5480*                                                                *
  5481*   FILE TYPE = VSAM,KSDS                                        *
  5482*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5483*                                                                *
  5484*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5485*                                                                *
  5486*   LOG = YES                                                    *
  5487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5488******************************************************************
  5489*                   C H A N G E   L O G
  5490*
  5491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5492*-----------------------------------------------------------------
  5493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5494* EFFECTIVE    NUMBER
  5495*-----------------------------------------------------------------
  5496* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5497* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5498* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5499* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5500* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5501******************************************************************
  5502
  5503 01  CERTIFICATE-TRAILERS.
  5504     12  CS-RECORD-ID                      PIC XX.
  5505         88  VALID-CS-ID                      VALUE 'CS'.
  5506
  5507     12  CS-CONTROL-PRIMARY.
  5508         16  CS-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 103
* EL154.cbl
  5509         16  CS-CARRIER                    PIC X.
  5510         16  CS-GROUPING                   PIC X(6).
  5511         16  CS-STATE                      PIC XX.
  5512         16  CS-ACCOUNT                    PIC X(10).
  5513         16  CS-CERT-EFF-DT                PIC XX.
  5514         16  CS-CERT-NO.
  5515             20  CS-CERT-PRIME             PIC X(10).
  5516             20  CS-CERT-SFX               PIC X.
  5517         16  CS-TRAILER-TYPE               PIC X.
  5518             88  COMM-TRLR           VALUE 'A'.
  5519             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5520             88  CERT-DATA-TRLR      VALUE 'C'.
  5521
  5522     12  CS-DATA-AREA                      PIC X(516).
  5523
  5524     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5525         16  CS-BANK-COMMISSION-AREA.
  5526             20  CS-BANK-COMMS       OCCURS 10.
  5527                 24  CS-AGT                PIC X(10).
  5528                 24  CS-COM-TYP            PIC X.
  5529                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5530                 24  CS-RECALC-LV-INDIC    PIC X.
  5531                 24  FILLER                PIC X(10).
  5532         16  FILLER                        PIC X(256).
  5533
  5534     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5535****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5536****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5537         16  CS-MB-CLAIM-DATA OCCURS 2.
  5538             20  FILLER OCCURS 10.
  5539                 24  CS-CLAIM-TYPE         PIC X.
  5540                     88  CS-AH-CLM           VALUE 'A'.
  5541                     88  CS-IU-CLM           VALUE 'I'.
  5542                     88  CS-GP-CLM           VALUE 'G'.
  5543                     88  CS-LF-CLM           VALUE 'L'.
  5544                     88  CS-PR-CLM           VALUE 'P'.
  5545                 24  CS-BANK               PIC S999 COMP-3.
  5546                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5547                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5548                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5549         16  FILLER                        PIC X(216).
  5550     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5551         16  CS-VIN-NUMBER                 PIC X(17).
  5552         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5553         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5554         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5555         16  FILLER                        PIC X(496).
  5556******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 104
* EL154.cbl
  5558*                            COPY MPCPLCY.
  5559******************************************************************
  5560*                                                                *
  5561*                           MPCPLCY                              *
  5562*                            VMOD=1.024                          *
  5563*                                                                *
  5564*   FILE DESCRIPTION = POLICY MASTER                             *
  5565*                                                                *
  5566*   FILE TYPE = VSAM,KSDS                                        *
  5567*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5568*                                                                *
  5569*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5570*       ALTERNATE PATH2 = ** NOT USED **                         *
  5571*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5572*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5573*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5574*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5575*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5576*                                                                *
  5577*   LOG = YES                                                    *
  5578*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5579******************************************************************
  5580**WARNING*********************************************************
  5581**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  5582**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  5583**                             MPCPHSTD                          *
  5584**                             MPCPHSTC                          *
  5585**                             MPCPHSTT                          *
  5586**                                                               *
  5587******************************************************************
  5588
  5589 01  POLICY-MASTER.
  5590     12  PM-RECORD-ID                      PIC XX.
  5591         88  VALID-PM-ID                      VALUE 'PM'.
  5592
  5593******************************************************************
  5594*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  5595******************************************************************
  5596
  5597     12  PM-CONTROL-PRIMARY.
  5598         16  PM-PRODUCER-PRIMARY.
  5599             20  PM-PROD-PRIMARY.
  5600                 24  PM-COMPANY-CD         PIC X.
  5601                 24  PM-CGSP-KEY.
  5602                     28  PM-CARRIER        PIC X.
  5603                     28  PM-GROUPING.
  5604                         32  PM-GROUPING-PREFIX
  5605                                           PIC X(3).
  5606                         32  PM-GROUPING-PRIME
  5607                                           PIC X(3).
  5608                     28  PM-STATE          PIC X(2).
  5609                     28  PM-PRODUCER.
  5610                         32  PM-PRODUCER-PREFIX
  5611                                           PIC X(4).
  5612                         32  PM-PRODUCER-PRIME
  5613                                           PIC X(6).
  5614             20  PM-POLICY-EFF-DT              PIC XX.
  5615         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 105
* EL154.cbl
  5616             20  PM-REFNO-PRIME            PIC X(18).
  5617             20  PM-REFNO-SFX              PIC XX.
  5618
  5619******************************************************************
  5620*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5621******************************************************************
  5622
  5623     12  PM-CONTROL-BY-SSN.
  5624         16  PM-COMPANY-CD-A3              PIC X.
  5625         16  PM-SOC-SEC-NO.
  5626             20  PM-SSN-STATE              PIC XX.
  5627             20  PM-SSN-PRODUCER           PIC X(6).
  5628             20  PM-SSN-LN3.
  5629                 25  PM-INSURED-INITIALS-A3.
  5630                     30 PM-INSURED-INITIAL1-A3 PIC X.
  5631                     30 PM-INSURED-INITIAL2-A3 PIC X.
  5632                 25 PM-PART-LAST-NAME-A3         PIC X.
  5633         16  PM-DATE-A3                     PIC XX.
  5634         16  PM-TIME-A3                     PIC S9(04)   COMP.
  5635
  5636******************************************************************
  5637*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  5638******************************************************************
  5639
  5640     12  PM-CONTROL-BY-POLICY-NO.
  5641         16  PM-COMPANY-CD-A4              PIC X.
  5642         16  PM-POLICY-NO-A4.
  5643             20  PM-POLICY-PRIME-A4        PIC X(18).
  5644             20  PM-POLICY-SFX-A4          PIC XX.
  5645         16  PM-DATE-A4                    PIC XX.
  5646         16  PM-TIME-A4                    PIC S9(04)   COMP.
  5647
  5648******************************************************************
  5649*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  5650******************************************************************
  5651
  5652     12  PM-CONTROL-BY-ACCOUNT.
  5653         16  PM-COMPANY-CD-A5              PIC X.
  5654         16  PM-BANK-ACCOUNT-NUMBER        PIC X(20).
  5655         16  PM-DATE-A5                    PIC XX.
  5656         16  PM-TIME-A5                    PIC S9(07)   COMP.
  5657
  5658******************************************************************
  5659*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  5660******************************************************************
  5661
  5662     12  PM-CONTROL-BY-TRANSIT.
  5663         16  PM-COMPANY-CD-A6              PIC X.
  5664         16  PM-BANK-TRANSIT-NUMBER.
  5665             20  PM-FEDERAL-NUMBER         PIC X(4).
  5666             20  PM-BANK-NUMBER            PIC X(4).
  5667         16  PM-DATE-A6                    PIC XX.
  5668         16  PM-TIME-A6                    PIC S9(07)   COMP.
  5669
  5670******************************************************************
  5671*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  5672******************************************************************
  5673
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 106
* EL154.cbl
  5674     12  PM-CONTROL-BY-LOAN-NO.
  5675         16  PM-COMPANY-CD-A7              PIC X.
  5676         16  PM-LOAN-NUMBER                PIC X(20).
  5677         16  PM-DATE-A7                    PIC XX.
  5678         16  PM-TIME-A7                    PIC S9(07)   COMP.
  5679
  5680******************************************************************
  5681*                 FILE SYNCHRONIZATION DATA                      *
  5682******************************************************************
  5683
  5684     12  FILLER                            PIC X(05).
  5685     12  PM-FILE-SYNCH-DATA.
  5686         16  PM-LAST-CHANGE-DT             PIC XX.
  5687         16  PM-LAST-CHANGE-TIME           PIC S9(7)    COMP.
  5688         16  PM-LAST-CHANGE-PROCESSOR      PIC X(4).
  5689     12  FILLER                            PIC X(05).
  5690
  5691******************************************************************
  5692*                    INSUREDS PROFILE DATA                       *
  5693******************************************************************
  5694
  5695     12  PM-INSURED-PROFILE-DATA.
  5696         16  PM-INSURED-NAME.
  5697             20  PM-INSURED-LAST-NAME     PIC X(15).
  5698             20  PM-INSURED-FIRST-NAME.
  5699                 24  PM-INSURED-1ST-INIT PIC X.
  5700                 24  FILLER               PIC X(9).
  5701             20  PM-INSURED-MIDDLE-INIT PIC X.
  5702         16  PM-INSURED-ADDRESS.
  5703             20  PM-ADDRESS-LINE-1         PIC X(30).
  5704             20  PM-ADDRESS-LINE-2         PIC X(30).
  5705             20  PM-CITY                   PIC X(25).
  5706             20  PM-RESIDENT-STATE         PIC XX.
  5707             20  PM-ZIP-CD.
  5708                 24  PM-ZIP-FIRST-FIVE     PIC X(5).
  5709                 24  PM-ZIP-PLUS-FOUR      PIC X(4).
  5710         16  PM-INSURED-PERSONAL.
  5711             20  PM-INSURED-OCC-CLASS      PIC X.
  5712                 88  PM-PREFERRED            VALUE '1'.
  5713                 88  PM-STANDARD             VALUE '2'.
  5714                 88  PM-HAZARDOUS            VALUE '3'.
  5715                 88  PM-VERY-HAZARDOUS       VALUE '4'.
  5716                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  5717                 88  PM-NOT-OCC              VALUE '6'.
  5718                 88  PM-OCC-UNKNOWN          VALUE '9'.
  5719             20  PM-INSURED-OCC-CD         PIC X(3).
  5720             20  PM-INSURED-OCC-CD-NUM REDEFINES
  5721                 PM-INSURED-OCC-CD         PIC 9(3).
  5722             20  PM-INSURED-SEX            PIC X.
  5723                 88  PM-INSURED-SEX-MALE      VALUE 'M'.
  5724                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  5725             20  PM-INSURED-BIRTH-DT       PIC XX.
  5726             20  PM-INSURED-ISSUE-AGE      PIC S9(3)     COMP-3.
  5727             20  PM-INSURED-HEIGHT-FT      PIC S9(3)     COMP-3.
  5728             20  PM-INSURED-HEIGHT-IN      PIC S9(3)     COMP-3.
  5729             20  PM-INSURED-WEIGHT         PIC S9(3)     COMP-3.
  5730             20  PM-INSURED-BIRTH-STATE PIC XX.
  5731             20  PM-INSURED-PHONE-NO       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 107
* EL154.cbl
  5732             20  PM-INSURED-RATED-AGE      PIC S9(3)     COMP-3.
  5733         16  PM-INS-LANGUAGE-IND           PIC X(01).
  5734             88  PM-ENGLISH                           VALUE 'E'.
  5735             88  PM-FRENCH                            VALUE 'F'.
  5736             88  PM-SPANISH                           VALUE 'S'.
  5737         16  PM-INSURED-TOT-BENEFIT        PIC S9(7)V99  COMP-3.
  5738
  5739         16  PM-INSURED-AGE-IND            PIC X(01).
  5740             88  PM-INSURED-AGE-75-REACHED            VALUE 'Y'.
  5741     12  FILLER                            PIC X(13).
  5742
  5743******************************************************************
  5744*                JOINT INSUREDS PROFILE DATA                     *
  5745******************************************************************
  5746
  5747     12  PM-JOINT-PROFILE-DATA.
  5748         16  PM-JOINT-NAME.
  5749             20  PM-JOINT-LAST-NAME        PIC X(15).
  5750             20  PM-JOINT-FIRST-NAME.
  5751                 24  PM-JOINT-1ST-INIT     PIC X.
  5752                 24  FILLER                PIC X(9).
  5753             20  PM-JOINT-MIDDLE-INIT      PIC X.
  5754         16  PM-JOINT-SOC-SEC-NO.
  5755             20  PM-JT-SSN-STATE           PIC XX.
  5756             20  PM-JT-SSN-PRODUCER        PIC X(6).
  5757             20  PM-JT-SSN-LN3.
  5758                 25  PM-JT-INSURED-INITIALS-A3.
  5759                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  5760                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  5761                 25 PM-JT-PART-LAST-NAME-A3        PIC X.
  5762         16  PM-JOINT-PERSONAL.
  5763             20  PM-JOINT-OCC-CLASS        PIC X.
  5764                 88 PM-JNT-PREFERRED          VALUE '1'.
  5765                 88 PM-JNT-STANDARD           VALUE '2'.
  5766                 88 PM-JNT-HAZARDOUS          VALUE '3'.
  5767                 88 PM-JNT-VERY-HAZARDOUS     VALUE '4'.
  5768                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  5769                 88 PM-JNT-NOT-OCC            VALUE '6'.
  5770                 88 PM-JNT-OCC-UNKNOWN        VALUE '9'.
  5771             20  PM-JOINT-OCC-CD           PIC X(3).
  5772             20  PM-JOINT-SEX              PIC X.
  5773                 88  PM-JOINT-SEX-MALE        VALUE 'M'.
  5774                 88  PM-JOINT-SEX-FEMALE      VALUE 'F'.
  5775             20  PM-JOINT-BIRTH-DT         PIC XX.
  5776             20  PM-JOINT-ISSUE-AGE        PIC S9(3)     COMP-3.
  5777             20  PM-JOINT-HEIGHT-FT        PIC S9(3)     COMP-3.
  5778             20  PM-JOINT-HEIGHT-IN        PIC S9(3)     COMP-3.
  5779             20  PM-JOINT-WEIGHT           PIC S9(3)     COMP-3.
  5780             20  PM-JOINT-BIRTH-STATE      PIC XX.
  5781             20  PM-JOINT-RATED-AGE        PIC S9(3)     COMP-3.
  5782         16  PM-JOINT-TOT-BENEFIT          PIC S9(7)V99  COMP-3.
  5783         16  PM-JOINT-AGE-IND              PIC X(01).
  5784             88  PM-JOINT-AGE-75-REACHED              VALUE 'Y'.
  5785
  5786     12  FILLER                            PIC X(12).
  5787
  5788******************************************************************
  5789*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 108
* EL154.cbl
  5790******************************************************************
  5791
  5792     12  PM-INS-COVERAGE-DATA.
  5793         16  PM-FREE-PERIOD                PIC S9(03)    COMP-3.
  5794         16  PM-LOAN-TERM                  PIC S9(3)     COMP-3.
  5795         16  PM-LOAN-APR                   PIC S9V9999   COMP-3.
  5796         16  PM-LOAN-DT                    PIC XX.
  5797         16  PM-LOAN-PYMT                  PIC S9(5)V99  COMP-3.
  5798         16  PM-LOAN-BALC                  PIC S9(7)V99  COMP-3.
  5799         16  PM-INS-BENEFIT-MONTHS         PIC S9(3)     COMP-3.
  5800         16  PM-INS-MONTH-BENEFIT          PIC S9(7)V99  COMP-3.
  5801         16  PM-INS-TOTAL-BENEFIT          PIC S9(7)V99  COMP-3.
  5802         16  PM-INS-PLAN-TYPE              PIC X.
  5803             88  PM-AH-MORT-PLAN              VALUE 'A'.
  5804             88  PM-AD-D-MORT-PLAN            VALUE 'E'.
  5805             88  PM-DISMEM-MORT-PLAN          VALUE 'D'.
  5806             88  PM-LIFE-MORT-PLAN            VALUE 'L'.
  5807         16  PM-INS-PLAN-CD                PIC XX.
  5808         16  PM-INS-PLAN-REVISION          PIC X(3).
  5809         16  PM-INS-POLICY-FORM            PIC X(12).
  5810         16  PM-INS-MSTR-POLICY.
  5811             20  PM-FREE-TYPE              PIC X(04).
  5812             20  FILLER                    PIC X(08).
  5813         16  PM-INS-MSTR-APP.
  5814             20  FILLER                    PIC X(11).
  5815             20  PM-INS-B-C-TYPE           PIC X(01).
  5816         16  PM-INS-RATE-CD                PIC X(5).
  5817         16  PM-INS-SEX-RATING             PIC X.
  5818             88  PM-NOT-SEX-RATED              VALUE '1'.
  5819             88  PM-SEX-RATED                  VALUE '2'.
  5820         16  PM-INS-SUBSTANDARD-PCT        PIC S9V9999   COMP-3.
  5821         16  PM-INS-SUBSTANDARD-TYPE       PIC X.
  5822         16  PM-INS-TERMINATION-DT         PIC XX.
  5823         16  PM-INS-MONTH-PREMIUM      PIC S9(5)V999999  COMP-3.
  5824         16  PM-INS-CALC-MO-PREM       PIC S9(5)V999999  COMP-3.
  5825         16  PM-REINSURANCE-TABLE          PIC X(3).
  5826         16  PM-MORTALITY-CD               PIC X(4).
  5827         16  PM-INS-TYPE                   PIC X.
  5828             88  PM-INDIVIDUAL                VALUES ARE '1' 'I'.
  5829             88  PM-GROUP                     VALUES ARE '2' 'G'.
  5830         16  PM-LOAN-OFFICER               PIC X(5).
  5831         16  PM-POLICY-FEE                 PIC S9(3)V99 COMP-3.
  5832         16  PM-DEPENDENT-COUNT            PIC S99      COMP-3.
  5833         16  PM-CWA-AMOUNT                 PIC S9(5)V99  COMP-3.
  5834         16  PM-LAST-AUTO-RERATE-DT        PIC XX.
  5835         16  PM-PREM-FINANCED-SW           PIC X.
  5836             88  PM-PREM-FINANCED              VALUE 'Y'.
  5837             88  PM-PREM-NOT-FINANCED          VALUE 'N'.
  5838
  5839         16  PM-INS-TERM-LETTER-IND        PIC X.
  5840             88  PM-TERM-INITIALIZED           VALUE 'Y'.
  5841         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99     COMP-3.
  5842     12  FILLER                            PIC X(11).
  5843
  5844******************************************************************
  5845*                    POLICY BILLING DATA                         *
  5846******************************************************************
  5847
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 109
* EL154.cbl
  5848     12  PM-BILLING-DATA.
  5849         16  PM-BILLING-MODE               PIC X(1).
  5850             88  PM-ANNUAL                    VALUE '1'.
  5851             88  PM-SEMI-ANNUAL               VALUE '2'.
  5852             88  PM-QUARTERLY                 VALUE '3'.
  5853             88  PM-MONTHLY                   VALUE '4'.
  5854             88  PM-BI-MONTHLY                VALUE '5'.
  5855             88  PM-SINGLE-PREM               VALUE '6'.
  5856         16  PM-BILLING-SCHEDULE           PIC X(1).
  5857         16  PM-BILLING-SW                 PIC X(1).
  5858             88  PM-FIRST-BILLING             VALUE 'Y'.
  5859             88  PM-PAID-IN-ADVANCE           VALUE 'A'.
  5860             88  PM-POLICY-FEE-REFUNDED       VALUE 'F'.
  5861         16  PM-BILLING-TYPE               PIC X(1).
  5862             88  PM-LIST-BILL                 VALUE '1'.
  5863             88  PM-TAPE-BILL                 VALUE '2'.
  5864             88  PM-TAPE-LIST-BILL            VALUE '3'.
  5865             88  PM-GROUP-BILL          VALUE ARE '1' '2' '3'.
  5866             88  PM-DIRECT-BILL               VALUE '4'.
  5867             88  PM-PAC-BILL            VALUE ARE '5' 'C' 'S'.
  5868             88  PM-CHARGE-CARD-BILL          VALUE '6'.
  5869             88  PM-INDIV-BILL
  5870                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  5871             88  PM-GRP-PLCY-BILL             VALUE '7'.
  5872             88  PM-GRP-PLCY-PAC              VALUE '8'.
  5873             88  PM-GRP-PLCY-CR-CRD           VALUE '9'.
  5874             88  PM-GRP-PLCY            VALUE ARE '7' '8' '9'.
  5875             88  PM-GRP-PROD                  VALUE 'A'.
  5876             88  PM-EFT-CHECKING              VALUE 'C'.
  5877             88  PM-EFT-SAVINGS               VALUE 'S'.
  5878         16  PM-PAYMENT-AMT                PIC S9(5)V99  COMP-3.
  5879         16  PM-OVER-SHORT-AMT             PIC S9(5)V99  COMP-3.
  5880         16  PM-LAST-BILL-DT               PIC XX.
  5881         16  PM-LAST-BILL-AMT              PIC S9(5)V99  COMP-3.
  5882         16  PM-BILL-TO-DT                 PIC XX.
  5883         16  PM-LAST-PYMT-DT               PIC XX.
  5884         16  PM-PAID-TO-DT                 PIC XX.
  5885         16  PM-PYMT-INVOICE-NUMBER        PIC X(6).
  5886         16  PM-MONTHS-PAID                PIC S9(3)     COMP-3.
  5887         16  PM-TOTAL-PREM-RECVD           PIC S9(7)V99  COMP-3.
  5888         16  PM-BILLING-GROUPING-CODE      PIC X(6).
  5889         16  PM-CHARGE-CARD-EXP-DT         PIC X(2).
  5890         16  PM-CHARGE-CARD-TYPE           PIC X(2).
  5891             88  PM-VISA                      VALUE 'VI'.
  5892             88  PM-MSTR-CARD                 VALUE 'MC'.
  5893             88  PM-DINERS-CLUB               VALUE 'DN'.
  5894             88  PM-DISCOVER                  VALUE 'DS'.
  5895             88  PM-CARTE-BLANCHE             VALUE 'CB'.
  5896             88  PM-AMERICAN-EXPRESS          VALUE 'AE'.
  5897         16  PM-BILL-INVOICE-NUMBER        PIC X(6).
  5898         16  PM-BILL-DAY                   PIC S99       COMP-3.
  5899         16  PM-RES-PREM-TAX           PIC S9(3)V999999  COMP-3.
  5900     12  FILLER                            PIC X(15).
  5901
  5902******************************************************************
  5903*                     CLAIM PAYMENT DATA                         *
  5904******************************************************************
  5905
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 110
* EL154.cbl
  5906     12  PM-CLAIM-PAYMENT-DATA.
  5907         16  PM-CLAIM-BENEFICIARY-NAME     PIC X(25).
  5908         16  PM-CLAIM-INTERFACE-SW         PIC X.
  5909             88  PM-NO-CLAIM-ATTACHED         VALUE SPACE.
  5910             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  5911             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  5912             88  PM-CLAIM-CLOSED              VALUE '3'.
  5913             88  PM-ACTIVE-CLAIM              VALUE '1' '2'.
  5914             88  PM-CLAIM-ATTACHED            VALUE '1' '2' '3'.
  5915         16  PM-CLAIM-INCURRED-DT          PIC XX.
  5916         16  PM-CLAIM-PAID-TO-DT           PIC XX.
  5917         16  PM-CLAIM-PAYMENT-CNT          PIC S9(3)     COMP-3.
  5918         16  PM-CLAIM-LAST-PAYMENT-AMT     PIC S9(7)V99  COMP-3.
  5919         16  PM-CLAIM-EXPENSES-ITD         PIC S9(7)V99  COMP-3.
  5920         16  PM-CLAIM-PAYMENTS-ITD         PIC S9(7)V99  COMP-3.
  5921         16  PM-CLAIM-ACCUMULATOR          PIC S9(7)V99  COMP-3.
  5922         16  PM-CLAIM-ATTACH-CNT           PIC S9(3)     COMP-3.
  5923         16  PM-CLAIM-LIFE-ITD             PIC S9(7)V99  COMP-3.
  5924         16  PM-CLAIM-AH-ITD               PIC S9(7)V99  COMP-3.
  5925         16  PM-CLAIM-RIDER-ITD            PIC S9(7)V99  COMP-3.
  5926
  5927     12  FILLER                            PIC X(03).
  5928
  5929******************************************************************
  5930*                POLICY STATUS AND DISPOSITION                   *
  5931******************************************************************
  5932
  5933     12  PM-STATUS-DISPOSITION-DATA.
  5934         16  PM-ISSUE-EOM-DT               PIC XX.
  5935         16  PM-REPLACEMENT-SWITCH         PIC X.
  5936         16  PM-APPL-SIGN-DT               PIC XX.
  5937         16  PM-UNDERWRITER                PIC X(3).
  5938         16  PM-ENTRY-PROCESSOR            PIC X(4).
  5939         16  PM-ENTRY-STATUS               PIC X.
  5940             88  PM-NORMAL                    VALUE '1'.
  5941             88  PM-TAKE-OVER                 VALUE '2'.
  5942             88  PM-CONVERSION                VALUE '4'.
  5943             88  PM-RE-ISSUE                  VALUE '5'.
  5944             88  PM-REINSURANCE-ONLY          VALUE '9'.
  5945         16  PM-ENTRY-DT                   PIC XX.
  5946         16  PM-ENTRY-TIME                 PIC S9(7) COMP-3.
  5947         16  PM-EXIT-DT                    PIC XX.
  5948         16  PM-CURRENT-STATUS             PIC X.
  5949             88  PM-LAPSE                     VALUE '0'.
  5950             88  PM-ACTIVE                    VALUE '1'.
  5951             88  PM-PENDING-ISSUE             VALUE '2'.
  5952             88  PM-DECLINED                  VALUE '3'.
  5953             88  PM-PENDING-CANCEL            VALUE '4'.
  5954             88  PM-PENDING-ISSUE-ERROR       VALUE '5'.
  5955             88  PM-CLAIM-APPLIED             VALUE '6'.
  5956             88  PM-CANCEL                    VALUE '7'.
  5957             88  PM-PENDING-UNWTR-REVW        VALUE '8'.
  5958             88  PM-PENDING-CANCEL-ERROR      VALUE '9'.
  5959             88  PM-CANCEL-TRANSFER           VALUE 'C'.
  5960             88  PM-CLAIM-SETTLEMENT          VALUE 'F'.
  5961             88  PM-TERMINATE                 VALUE 'T'.
  5962** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  5963** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 111
* EL154.cbl
  5964** THESE GROUPS.
  5965             88  PM-TYPE-STAT-1
  5966                     VALUES ARE '0' '1' '4' '6' '7' '9'
  5967                                'C' 'F' 'T'.
  5968             88  PM-TYPE-STAT-2
  5969                     VALUES ARE '2' '3' '5' '8'.
  5970             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  5971             88  PM-PENDING-STATUS
  5972                                VALUES ARE '2' '4' '5' '8' '9'.
  5973             88  PM-PENDING-ISSUE-STATUS
  5974                                VALUES ARE '2' '5' '8'.
  5975             88  PM-CANCEL-STATUS
  5976                                VALUES ARE '4' '7' '9' 'C'.
  5977         16  PM-CANCEL-CAUSE-CD            PIC X(3).
  5978         16  PM-CANCEL-DT                  PIC XX.
  5979         16  PM-REFUND-AMT                 PIC S9(5)V99  COMP-3.
  5980         16  PM-CALC-REFUND-AMT            PIC S9(5)V99  COMP-3.
  5981         16  PM-DECLINE-CD                 PIC X(3).
  5982         16  PM-DECLINE-DT                 PIC XX.
  5983         16  PM-LAST-LAPSE-DT              PIC XX.
  5984         16  PM-LAST-REINSTATE-DT          PIC XX.
  5985         16  PM-SECURITY-ACCESS-CODE       PIC X.
  5986         16  PM-PREV-CONTROL-PRIMARY.
  5987             20  PM-PREV-COMPANY-CD             PIC X.
  5988             20  PM-PREV-CARRIER                PIC X.
  5989             20  PM-PREV-GROUPING.
  5990                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  5991                 24  PM-PREV-GROUPING-PRIME     PIC X(3).
  5992             20  PM-PREV-STATE                  PIC XX.
  5993             20  PM-PREV-PRODUCER.
  5994                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  5995                 24  PM-PREV-PRODUCER-PRIME     PIC X(6).
  5996             20  PM-PREV-POLICY-EFF-DT          PIC XX.
  5997             20  PM-PREV-REFERENCE-NUMBER.
  5998                 24  PM-PREV-REFNO-PRIME        PIC X(18).
  5999                 24  PM-PREV-REFNO-SFX          PIC XX.
  6000         16  PM-ACTION-DT                  PIC XX.
  6001         16  PM-ACTION-CODE                PIC X(3).
  6002         16  PM-ACTION-DT-2                PIC XX.
  6003         16  PM-ACTION-CODE-2              PIC X(3).
  6004         16  PM-ACTION-DT-3                PIC XX.
  6005         16  PM-ACTION-CODE-3              PIC X(3).
  6006         16  PM-ACTION-DT-4                PIC XX.
  6007         16  PM-ACTION-CODE-4              PIC X(3).
  6008         16  PM-ACTION-DT-5                PIC XX.
  6009         16  PM-ACTION-CODE-5              PIC X(3).
  6010
  6011         16  PM-KEY-CHANGE                 PIC X.
  6012                 88  PM-NO-KEY-CHG      VALUES ARE ' ' 'N'.
  6013                 88  PM-KEY-CHG              VALUE 'Y'.
  6014         16  PM-KEY-CHANGE-DT              PIC XX.
  6015
  6016         16  PM-RTI-INDICATOR              PIC X.
  6017         16  PM-REASON-CODE                PIC X(3).
  6018         16  PM-IN-OUT-PROCESSING-IND      PIC X(1).
  6019             88  PM-IN-OUT-PROCESSING      VALUE 'Y'.
  6020             88  PM-NOT-IN-OUT-PROCESSING  VALUE SPACES.
  6021
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 112
* EL154.cbl
  6022     12  FILLER                            PIC X(12).
  6023
  6024******************************************************************
  6025*                 AGENT AND COMMISSION DATA                      *
  6026******************************************************************
  6027
  6028     12  PM-COMMISSION-DATA.
  6029         16  PM-REMIT-TO                   PIC S9(3) COMP-3.
  6030         16  PM-COMM-CHANGE-SW             PIC X.
  6031                 88  PM-COMMISSION-CHANGE     VALUE 'Y'.
  6032         16  PM-AGENT-INFORMATION OCCURS     5 TIMES.
  6033             20  PM-AGENT-NUMBER           PIC X(10).
  6034             20  PM-AGENT-TYPE             PIC X.
  6035                 88  PM-PRODUCER-LEVEL-AGENT
  6036                                              VALUES ARE 'C' 'D'.
  6037                 88  PM-AGENT-GROSS           VALUE 'C'.
  6038                 88  PM-AGENT-REINS           VALUE 'R'.
  6039                 88  PM-AGENT-GROSS-REINS     VALUE 'D'.
  6040                 88  PM-OVERWRITE-GROSS       VALUE 'O'.
  6041                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6042                 88  PM-OVERWRITE-REINS       VALUE 'T'.
  6043                 88  PM-REINS-ONLY            VALUE 'W'.
  6044             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6045                 88  PM-GENERATE-BILL         VALUE 'B'.
  6046                 88  PM-GENERATE-PAID         VALUE 'P'.
  6047             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6048             20  PM-COMP-1ST-YEAR-TYPE     PIC X(1).
  6049                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6050                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6051                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6052             20  PM-RENEWAL-DATA.
  6053                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6054                     28  PM-RENEW-MONTHS     PIC S999    COMP-3.
  6055                     28  PM-RENEW-COMMISSION
  6056                                             PIC S99V999 COMP-3.
  6057                     28  PM-RENEW-TYPE       PIC X(1).
  6058                         88  PM-COMP-RENEW-PERCENT      VALUE '1'.
  6059                         88  PM-COMP-RENEW-DOLLARS      VALUE '2'.
  6060                         88  PM-COMP-RENEW-NOT-USED     VALUE '3'.
  6061             20  PM-COMP-RECALC-FLAG       PIC X(1).
  6062                 88  PM-BYPASS-RECALC         VALUE 'N'.
  6063     12  FILLER                            PIC X(20).
  6064******************************************************************
  6065*             CUSTOMER DATA                                      *
  6066******************************************************************
  6067     12  PM-CUSTOMER-ID                    PIC X(20).
  6068******************************************************************
  6069     12  FILLER                            PIC X(43).
  6070******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 113
* EL154.cbl
  6072 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  6073                          CLAIM-MASTER ACTIVITY-TRAILERS
  6074                          CERTIFICATE-MASTER BENEFICIARY-MASTER
  6075                          ACCOUNT-MASTER PRODUCT-MASTER
  6076                          CERTIFICATE-TRAILERS POLICY-MASTER.
  6077 0000-DFHEXIT SECTION.
  6078     MOVE '9#                    $   ' TO DFHEIV0.
  6079     MOVE 'EL154' TO DFHEIV1.
  6080     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6081     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6082     MOVE '5'                   TO DC-OPTION-CODE.
  6083     PERFORM 9700-DATE-LINK.
  6084     MOVE DC-GREG-DATE-1-EDIT   TO  CURRENT-GREG-DATE.
  6085     MOVE DC-BIN-DATE-1         TO  CURRENT-BIN-DATE.
  6086
  6087
  6088     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6089     MOVE 2 TO EMI-NUMBER-OF-LINES.
  6090     IF EIBCALEN = 0
  6091         GO TO 8800-UNAUTHORIZED-ACCESS.
  6092
  6093     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6094         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6095             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6096             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6097             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6098             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6099             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6100             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6101             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6102             MOVE THIS-PGM  TO PI-CALLING-PROGRAM
  6103             MOVE LOW-VALUES TO EL154AO
  6104             GO TO 7000-BUILD-SCREEN.
  6105
  6106
  6107* EXEC CICS HANDLE CONDITION
  6108*        NOTOPEN(8860-CLAM-NOT-OPEN)
  6109*        PGMIDERR(9600-PGMID-ERROR)
  6110*        ERROR(9990-ABEND)
  6111*        END-EXEC.
  6112*    MOVE '"$JL.                 ! " #00006102' TO DFHEIV0
  6113     MOVE X'22244A4C2E20202020202020' TO DFHEIV0(1:12)
  6114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6115     MOVE X'2220233030303036313032' TO DFHEIV0(25:11)
  6116     CALL 'kxdfhei1' USING DFHEIV0
  6117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6118
  6119
  6120     IF EIBAID = DFHCLEAR
  6121         GO TO 9400-CLEAR.
  6122
  6123     IF PI-PROCESSOR-ID = 'LGXX'
  6124         GO TO 0200-RECEIVE.
  6125
  6126
  6127* EXEC CICS READQ TS
  6128*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6129*        INTO    (SECURITY-CONTROL)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 114
* EL154.cbl
  6130*        LENGTH  (SC-COMM-LENGTH)
  6131*        ITEM    (SC-ITEM)
  6132*    END-EXEC.
  6133*    MOVE '*$II   L              ''   #00006114' TO DFHEIV0
  6134     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6135     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6136     MOVE X'2020233030303036313134' TO DFHEIV0(25:11)
  6137     CALL 'kxdfhei1' USING DFHEIV0,
  6138           PI-SECURITY-TEMP-STORE-ID,
  6139           SECURITY-CONTROL,
  6140           SC-COMM-LENGTH,
  6141           SC-ITEM,
  6142           DFHEIV99,
  6143           DFHEIV99
  6144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6145
  6146
  6147     MOVE SC-CLAIMS-DISPLAY (9)   TO  PI-DISPLAY-CAP.
  6148     MOVE SC-CLAIMS-UPDATE  (9)   TO  PI-MODIFY-CAP.
  6149
  6150     IF NOT MODIFY-CAP
  6151         MOVE 'UPDATE'            TO  SM-READ
  6152         PERFORM 9995-SECURITY-VIOLATION
  6153         MOVE ER-0070             TO  EMI-ERROR
  6154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6155         GO TO 8100-SEND-INITIAL-MAP.
  6156
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 115
* EL154.cbl
  6158 0200-RECEIVE.
  6159     MOVE LOW-VALUES TO EL154AI.
  6160     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6161         MOVE ER-0008 TO EMI-ERROR
  6162         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6163         GO TO 8200-SEND-DATAONLY.
  6164
  6165
  6166* EXEC CICS RECEIVE
  6167*        MAP(MAP-NAME)
  6168*        MAPSET(MAPSET-NAME)
  6169*        INTO(EL154AI)
  6170*        END-EXEC.
  6171     MOVE LENGTH OF
  6172      EL154AI
  6173       TO DFHEIV11
  6174*    MOVE '8"T I  L              ''   #00006139' TO DFHEIV0
  6175     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6177     MOVE X'2020233030303036313339' TO DFHEIV0(25:11)
  6178     CALL 'kxdfhei1' USING DFHEIV0,
  6179           MAP-NAME,
  6180           EL154AI,
  6181           DFHEIV11,
  6182           MAPSET-NAME,
  6183           DFHEIV99,
  6184           DFHEIV99
  6185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6186
  6187
  6188     IF ENTERPFL = 0
  6189         GO TO 0300-CHECK-PFKEYS.
  6190     IF EIBAID NOT = DFHENTER
  6191         MOVE ER-0004 TO EMI-ERROR
  6192         GO TO 0320-INPUT-ERROR.
  6193
  6194     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  6195         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6196     ELSE
  6197         MOVE ER-0029 TO EMI-ERROR
  6198         GO TO 0320-INPUT-ERROR.
  6199
  6200 0300-CHECK-PFKEYS.
  6201
  6202     IF EIBAID = DFHPF23
  6203         GO TO 8810-PF23.
  6204     IF EIBAID = DFHPF24
  6205         GO TO 9200-RETURN-MAIN-MENU.
  6206     IF EIBAID = DFHPF12
  6207         GO TO 9500-PF12.
  6208     IF EIBAID EQUAL DFHPF1
  6209        GO TO 0400-PAGE-FORWARD.
  6210     IF EIBAID EQUAL DFHPF2
  6211        GO TO 0700-PAGE-BACKWARD.
  6212     IF EIBAID EQUAL DFHPF3
  6213        MOVE CURRENT-BIN-DATE TO CURRENT-SAVE
  6214        IF TERMI = 'A'
  6215            GO TO 2000-ADD-ONLY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 116
* EL154.cbl
  6216        ELSE
  6217        IF TERMI = 'N'
  6218            GO TO 3000-TERMINATE-AND-GENERATE.
  6219     IF (TERML NOT = 0) AND (EIBAID NOT = DFHENTER)
  6220         MOVE ER-0050 TO EMI-ERROR
  6221         GO TO 0320-INPUT-ERROR.
  6222     IF EIBAID = DFHENTER
  6223         GO TO 0330-EDIT-DATA.
  6224
  6225     MOVE ER-0029 TO EMI-ERROR.
  6226 0320-INPUT-ERROR.
  6227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6228     MOVE AL-UNBON TO ENTERPFA.
  6229     IF ENTERPFL = 0
  6230         MOVE -1 TO TERML
  6231     ELSE
  6232         MOVE -1 TO ENTERPFL.
  6233
  6234     GO TO 8200-SEND-DATAONLY.
  6235
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 117
* EL154.cbl
  6237 0330-EDIT-DATA.
  6238     IF NOT MODIFY-CAP
  6239           MOVE ER-0070          TO EMI-ERROR
  6240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6241           MOVE LOW-VALUES       TO EL154AO
  6242           GO TO 8100-SEND-INITIAL-MAP.
  6243
  6244     MOVE CURRENT-BIN-DATE       TO CURRENT-SAVE
  6245
  6246     IF TERMI = 'Y'
  6247         GO TO 1000-DELETE-CURRENT.
  6248     IF TERMI = 'A'
  6249         GO TO 2000-ADD-ONLY.
  6250     IF TERMI = 'N'
  6251         GO TO 3000-TERMINATE-AND-GENERATE.
  6252     MOVE ER-0347                TO EMI-ERROR.
  6253     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6254     MOVE -1                     TO TERML.
  6255     MOVE AL-UABON               TO TERMA.
  6256     GO TO 8200-SEND-DATAONLY.
  6257
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 118
* EL154.cbl
  6259 0400-PAGE-FORWARD.
  6260
  6261* EXEC CICS HANDLE CONDITION
  6262*         NOTFND    (8850-CLAM-END-FILE)
  6263*         ENDFILE   (8850-CLAM-END-FILE)
  6264*    END-EXEC.
  6265*    MOVE '"$I''                  ! # #00006217' TO DFHEIV0
  6266     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6268     MOVE X'2320233030303036323137' TO DFHEIV0(25:11)
  6269     CALL 'kxdfhei1' USING DFHEIV0
  6270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6271
  6272
  6273     MOVE PI-CARRIER      TO CLAM-CARRIER
  6274     MOVE PI-COMPANY-CD   TO CLAM-CO
  6275     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6276     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6277     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6278
  6279
  6280* EXEC CICS STARTBR
  6281*         DATASET   ('ELMSTR')
  6282*         RIDFLD    (CLAM-KEY)
  6283*    END-EXEC.
  6284     MOVE 'ELMSTR' TO DFHEIV1
  6285     MOVE 0
  6286       TO DFHEIV11
  6287*    MOVE '&,         G          &   #00006228' TO DFHEIV0
  6288     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6289     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6290     MOVE X'2020233030303036323238' TO DFHEIV0(25:11)
  6291     CALL 'kxdfhei1' USING DFHEIV0,
  6292           DFHEIV1,
  6293           CLAM-KEY,
  6294           DFHEIV99,
  6295           DFHEIV11,
  6296           DFHEIV99
  6297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6298
  6299
  6300 0450-READ-NEXT-CLAIM.
  6301
  6302
  6303* EXEC CICS READNEXT
  6304*         DATASET   ('ELMSTR')
  6305*         RIDFLD    (CLAM-KEY)
  6306*         SET       (ADDRESS OF CLAIM-MASTER)
  6307*    END-EXEC.
  6308     MOVE 'ELMSTR' TO DFHEIV1
  6309     MOVE 0
  6310       TO DFHEIV11
  6311*    MOVE '&.S                   )   #00006235' TO DFHEIV0
  6312     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6313     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6314     MOVE X'2020233030303036323335' TO DFHEIV0(25:11)
  6315     CALL 'kxdfhei1' USING DFHEIV0,
  6316           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 119
* EL154.cbl
  6317           DFHEIV20,
  6318           DFHEIV99,
  6319           CLAM-KEY,
  6320           DFHEIV99,
  6321           DFHEIV11,
  6322           DFHEIV99,
  6323           DFHEIV99
  6324     SET ADDRESS OF CLAIM-MASTER TO
  6325         DFHEIV20
  6326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6327
  6328
  6329     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6330        GO TO 8850-CLAM-END-FILE.
  6331
  6332     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6333        GO TO 0450-READ-NEXT-CLAIM.
  6334
  6335     IF PI-CARRIER-SECURITY GREATER SPACES
  6336         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6337             GO TO 0450-READ-NEXT-CLAIM.
  6338
  6339     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6340         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6341             GO TO 0450-READ-NEXT-CLAIM.
  6342
  6343     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6344         GO TO 0450-READ-NEXT-CLAIM.
  6345
  6346     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6347     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6348     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6349     MOVE CL-CERT-STATE       TO PI-STATE
  6350     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6351     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6352     MOVE CL-CERT-NO          TO PI-CERT-NO
  6353
  6354     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6355         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6356
  6357
  6358* EXEC CICS ENDBR
  6359*         DATASET    ('ELMSTR')
  6360*    END-EXEC.
  6361     MOVE 'ELMSTR' TO DFHEIV1
  6362     MOVE 0
  6363       TO DFHEIV11
  6364*    MOVE '&2                    $   #00006269' TO DFHEIV0
  6365     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6367     MOVE X'2020233030303036323639' TO DFHEIV0(25:11)
  6368     CALL 'kxdfhei1' USING DFHEIV0,
  6369           DFHEIV1,
  6370           DFHEIV11,
  6371           DFHEIV99
  6372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6373
  6374
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 120
* EL154.cbl
  6375     MOVE LOW-VALUES TO EL154AO.
  6376     GO TO 7000-BUILD-SCREEN.
  6377
  6378 0700-PAGE-BACKWARD.
  6379
  6380
  6381* EXEC CICS HANDLE CONDITION
  6382*         NOTFND    (8850-CLAM-END-FILE)
  6383*         ENDFILE   (8850-CLAM-END-FILE)
  6384*    END-EXEC.
  6385*    MOVE '"$I''                  ! $ #00006278' TO DFHEIV0
  6386     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6388     MOVE X'2420233030303036323738' TO DFHEIV0(25:11)
  6389     CALL 'kxdfhei1' USING DFHEIV0
  6390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6391
  6392
  6393     MOVE PI-CARRIER      TO CLAM-CARRIER
  6394     MOVE PI-COMPANY-CD   TO CLAM-CO
  6395     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6396     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6397     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6398
  6399
  6400* EXEC CICS STARTBR
  6401*         DATASET   ('ELMSTR')
  6402*         RIDFLD    (CLAM-KEY)
  6403*    END-EXEC.
  6404     MOVE 'ELMSTR' TO DFHEIV1
  6405     MOVE 0
  6406       TO DFHEIV11
  6407*    MOVE '&,         G          &   #00006289' TO DFHEIV0
  6408     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6409     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6410     MOVE X'2020233030303036323839' TO DFHEIV0(25:11)
  6411     CALL 'kxdfhei1' USING DFHEIV0,
  6412           DFHEIV1,
  6413           CLAM-KEY,
  6414           DFHEIV99,
  6415           DFHEIV11,
  6416           DFHEIV99
  6417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6418
  6419
  6420 0750-READ-PREV-CLAIM.
  6421
  6422
  6423* EXEC CICS READPREV
  6424*         DATASET   ('ELMSTR')
  6425*         RIDFLD    (CLAM-KEY)
  6426*         SET       (ADDRESS OF CLAIM-MASTER)
  6427*    END-EXEC.
  6428     MOVE 'ELMSTR' TO DFHEIV1
  6429     MOVE 0
  6430       TO DFHEIV11
  6431*    MOVE '&0S                   )   #00006296' TO DFHEIV0
  6432     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 121
* EL154.cbl
  6433     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6434     MOVE X'2020233030303036323936' TO DFHEIV0(25:11)
  6435     CALL 'kxdfhei1' USING DFHEIV0,
  6436           DFHEIV1,
  6437           DFHEIV20,
  6438           DFHEIV99,
  6439           CLAM-KEY,
  6440           DFHEIV99,
  6441           DFHEIV11,
  6442           DFHEIV99,
  6443           DFHEIV99
  6444     SET ADDRESS OF CLAIM-MASTER TO
  6445         DFHEIV20
  6446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6447
  6448
  6449     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6450        GO TO 8850-CLAM-END-FILE.
  6451
  6452     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6453        GO TO 0750-READ-PREV-CLAIM.
  6454
  6455     IF PI-CARRIER-SECURITY GREATER SPACES
  6456         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6457             GO TO 0750-READ-PREV-CLAIM.
  6458
  6459     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6460         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6461             GO TO 0750-READ-PREV-CLAIM.
  6462
  6463     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6464         GO TO 0750-READ-PREV-CLAIM.
  6465
  6466     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6467     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6468     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6469     MOVE CL-CERT-STATE       TO PI-STATE
  6470     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6471     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6472     MOVE CL-CERT-NO          TO PI-CERT-NO
  6473
  6474     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6475         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6476
  6477
  6478* EXEC CICS ENDBR
  6479*         DATASET    ('ELMSTR')
  6480*    END-EXEC.
  6481     MOVE 'ELMSTR' TO DFHEIV1
  6482     MOVE 0
  6483       TO DFHEIV11
  6484*    MOVE '&2                    $   #00006330' TO DFHEIV0
  6485     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6486     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6487     MOVE X'2020233030303036333330' TO DFHEIV0(25:11)
  6488     CALL 'kxdfhei1' USING DFHEIV0,
  6489           DFHEIV1,
  6490           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 122
* EL154.cbl
  6491           DFHEIV99
  6492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6493
  6494
  6495     MOVE LOW-VALUES TO EL154AO.
  6496     GO TO 7000-BUILD-SCREEN.
  6497
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 123
* EL154.cbl
  6499 1000-DELETE-CURRENT.
  6500     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6501     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6502
  6503     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6504     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6505     MOVE ZEROS                  TO CL-AUTO-PAY-SEQ.
  6506     MOVE LOW-VALUES             TO CL-NEXT-AUTO-PAY-DT.
  6507
  6508     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6509
  6510     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6511
  6512     MOVE SPACES TO WS-END-LETTER-FORM-NUM.
  6513*    IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6514     IF PRINTL IS GREATER THAN +0
  6515         MOVE PRINTI   TO PI-AUTO-END-LETTER
  6516     END-IF.
  6517     IF PI-AUTO-END-LETTER IS GREATER THAN SPACES
  6518         IF PI-AUTO-END-LETTER IS EQUAL TO 'N   '
  6519             GO TO 1000-FINISH-DELETE
  6520         ELSE
  6521             MOVE PI-AUTO-END-LETTER TO WS-END-LETTER-FORM-NUM
  6522             MOVE 'Y'    TO WS-ACT-REC-FOUND-SW
  6523                            WS-LETTER-SW
  6524         END-IF
  6525     END-IF.
  6526
  6527     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6528         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6529             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6530
  6531 1000-FINISH-DELETE.
  6532
  6533     IF EMI-NO-ERRORS
  6534         GO TO 8200-SEND-DATAONLY.
  6535
  6536     MOVE LOW-VALUES             TO EL154AO.
  6537     MOVE -1                     TO TERML.
  6538     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 124
* EL154.cbl
  6540 2000-ADD-ONLY.
  6541     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6542     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6543     IF NOT EMI-NO-ERRORS
  6544        GO TO 8200-SEND-DATAONLY.
  6545
  6546     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6547     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6548     IF NOT EMI-NO-ERRORS
  6549         GO TO 8200-SEND-DATAONLY.
  6550
  6551     IF CL-AUTO-PAY-SEQ  NOT = ZEROS
  6552        MOVE ER-0372             TO EMI-ERROR
  6553        MOVE -1                  TO NEFFDTEL
  6554        MOVE AL-UABON            TO NEFFDTEA
  6555        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6556        GO TO 8200-SEND-DATAONLY.
  6557
  6558     PERFORM 6400-PAYMENT-CALCULATION  THRU 6499-EXIT.
  6559
  6560     IF NFSTAMT-SAVE IS EQUAL TO +0
  6561         MOVE ER-0350            TO  EMI-ERROR
  6562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6563         MOVE -1                 TO  NFSTAMTL
  6564         MOVE AL-UNBON           TO  NFSTAMTA
  6565         GO TO 8200-SEND-DATAONLY.
  6566
  6567     IF EIBAID NOT = DFHPF3
  6568         GO TO 3500-CONFIRM-DATA.
  6569
  6570
  6571* EXEC CICS HANDLE CONDITION
  6572*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6573*        END-EXEC.
  6574*    MOVE '"$J                   ! % #00006409' TO DFHEIV0
  6575     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  6576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6577     MOVE X'2520233030303036343039' TO DFHEIV0(25:11)
  6578     CALL 'kxdfhei1' USING DFHEIV0
  6579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6580
  6581
  6582     PERFORM 4100-BUILD-AUTO-PAY THRU 4199-EXIT.
  6583
  6584     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6585
  6586     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6587
  6588     MOVE SPACES TO WS-LETTER-FORM-NUM.
  6589*     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6590         IF NPRINTL IS GREATER THAN +0
  6591            IF NPRINTI IS EQUAL TO 'N   '
  6592                GO TO 2000-FINISH-ADD
  6593            ELSE
  6594                MOVE NPRINTI TO WS-LETTER-FORM-NUM
  6595                MOVE 'Y' TO WS-ACT-REC-FOUND-SW
  6596                            WS-LETTER-SW.
  6597
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 125
* EL154.cbl
  6598     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6599         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6600             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6601
  6602 2000-FINISH-ADD.
  6603
  6604     IF EMI-NO-ERRORS
  6605         GO TO 8200-SEND-DATAONLY.
  6606
  6607     MOVE LOW-VALUES             TO EL154AO.
  6608     GO TO 7000-BUILD-SCREEN.
  6609
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 126
* EL154.cbl
  6611 3000-TERMINATE-AND-GENERATE.
  6612     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6613     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6614     IF NOT EMI-NO-ERRORS
  6615         GO TO 8200-SEND-DATAONLY.
  6616
  6617     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6618     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6619     IF NOT EMI-NO-ERRORS
  6620         GO TO 8200-SEND-DATAONLY.
  6621
  6622     PERFORM 6400-PAYMENT-CALCULATION THRU 6499-EXIT.
  6623
  6624     IF EIBAID NOT = DFHPF3
  6625         GO TO 3500-CONFIRM-DATA.
  6626
  6627     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6628     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6629
  6630     PERFORM 4100-BUILD-AUTO-PAY  THRU 4199-EXIT.
  6631
  6632     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6633
  6634     IF EMI-NO-ERRORS
  6635         GO TO 8200-SEND-DATAONLY.
  6636
  6637     MOVE LOW-VALUES TO EL154AO.
  6638     GO TO 7000-BUILD-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 127
* EL154.cbl
  6640 3500-CONFIRM-DATA.
  6641
  6642     MOVE -1                     TO  ENTERPFL.
  6643     MOVE ER-0670                TO  EMI-ERROR.
  6644     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6645     GO TO 8200-SEND-DATAONLY.
  6646
  6647 4000-DELETE-AUTO-PAY.
  6648
  6649* EXEC CICS HANDLE CONDITION
  6650*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6651*        NOTFND(4099-EXIT)
  6652*        END-EXEC.
  6653*    MOVE '"$JI                  ! & #00006479' TO DFHEIV0
  6654     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  6655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6656     MOVE X'2620233030303036343739' TO DFHEIV0(25:11)
  6657     CALL 'kxdfhei1' USING DFHEIV0
  6658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6659
  6660
  6661
  6662* EXEC CICS READ
  6663*        UPDATE
  6664*        DATASET(ACTV-ID)
  6665*        SET(ADDRESS OF ACTIVITY-TRAILERS)
  6666*        RIDFLD(ACTV-KEY)
  6667*        END-EXEC.
  6668*    MOVE '&"S        EU         (   #00006484' TO DFHEIV0
  6669     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6670     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6671     MOVE X'2020233030303036343834' TO DFHEIV0(25:11)
  6672     CALL 'kxdfhei1' USING DFHEIV0,
  6673           ACTV-ID,
  6674           DFHEIV20,
  6675           DFHEIV99,
  6676           ACTV-KEY,
  6677           DFHEIV99,
  6678           DFHEIV99,
  6679           DFHEIV99
  6680     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6681         DFHEIV20
  6682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6683
  6684
  6685     IF PRINTL > ZEROS
  6686         MOVE PRINTI             TO AT-AUTO-END-LETTER
  6687     END-IF.
  6688
  6689     MOVE CURRENT-SAVE           TO AT-TERMINATED-DT
  6690                                    AT-AUTO-PAY-LAST-MAINT-DT
  6691     MOVE PI-PROCESSOR-ID        TO AT-AUTO-PAY-LAST-UPDATED-BY
  6692     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  6693
  6694* EXEC CICS REWRITE
  6695*        DATASET(ACTV-ID)
  6696*        FROM(ACTIVITY-TRAILERS)
  6697*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 128
* EL154.cbl
  6698     MOVE LENGTH OF
  6699      ACTIVITY-TRAILERS
  6700       TO DFHEIV11
  6701*    MOVE '&& L                  %   #00006499' TO DFHEIV0
  6702     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6703     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6704     MOVE X'2020233030303036343939' TO DFHEIV0(25:11)
  6705     CALL 'kxdfhei1' USING DFHEIV0,
  6706           ACTV-ID,
  6707           ACTIVITY-TRAILERS,
  6708           DFHEIV11,
  6709           DFHEIV99
  6710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6711
  6712
  6713 4099-EXIT.
  6714      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 129
* EL154.cbl
  6716 4100-BUILD-AUTO-PAY.
  6717******************************************************************
  6718*               CREATE AUTO PAY TRAILER
  6719******************************************************************
  6720
  6721     SUBTRACT 1                  FROM CL-TRAILER-SEQ-CNT.
  6722     MOVE CL-TRAILER-SEQ-CNT     TO ACTV-SEQ
  6723                                    CL-AUTO-PAY-SEQ.
  6724
  6725* EXEC CICS GETMAIN
  6726*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  6727*         LENGTH    (TRLR-LENGTH)
  6728*         INITIMG   (GETMAIN-SPACE)
  6729*    END-EXEC.
  6730*    MOVE ',"IL                  $   #00006515' TO DFHEIV0
  6731     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6732     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6733     MOVE X'2020233030303036353135' TO DFHEIV0(25:11)
  6734     CALL 'kxdfhei1' USING DFHEIV0,
  6735           DFHEIV20,
  6736           TRLR-LENGTH,
  6737           GETMAIN-SPACE
  6738     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6739         DFHEIV20
  6740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6741
  6742
  6743     MOVE ZEROS                  TO AT-DAYS-IN-REG-PMT.
  6744     MOVE NEFFDTE-SAVE           TO AT-SCHEDULE-START-DT.
  6745     MOVE NFSTPMT-SAVE           TO AT-1ST-PAY-THRU-DT
  6746                                    CL-NEXT-AUTO-PAY-DT.
  6747     MOVE DAYPAYI                TO AT-AUTO-PAY-DAY.
  6748     MOVE NLSTPMT-SAVE           TO AT-SCHEDULE-END-DT.
  6749     MOVE NFSTAMT-SAVE           TO AT-FIRST-PMT-AMT.
  6750     MOVE NDAYSFI                TO AT-DAYS-IN-1ST-PMT.
  6751
  6752*    IF PI-USES-PAID-TO
  6753*        MOVE NFSTPMT-SAVE       TO  DC-BIN-DATE-1
  6754*        MOVE '6'                TO  DC-OPTION-CODE
  6755*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6756*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6757*        PERFORM 9700-DATE-LINK
  6758*        IF NO-CONVERSION-ERROR
  6759*            MOVE DC-BIN-DATE-2  TO  AT-1ST-PAY-THRU-DT
  6760*                                    CL-NEXT-AUTO-PAY-DT
  6761*        ELSE
  6762*            MOVE LOW-VALUES     TO  AT-1ST-PAY-THRU-DT
  6763*                                    CL-NEXT-AUTO-PAY-DT
  6764*    ELSE
  6765*        MOVE NFSTPMT-SAVE       TO  AT-1ST-PAY-THRU-DT
  6766*                                    CL-NEXT-AUTO-PAY-DT.
  6767
  6768*    IF PI-USES-PAID-TO
  6769*        MOVE NLSTPMT-SAVE       TO  DC-BIN-DATE-1
  6770*        MOVE '6'                TO  DC-OPTION-CODE
  6771*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6772*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6773*        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 130
* EL154.cbl
  6774*        IF NO-CONVERSION-ERROR
  6775*            MOVE DC-BIN-DATE-2  TO  AT-SCHEDULE-END-DT
  6776*        ELSE
  6777*            MOVE LOW-VALUES     TO  AT-SCHEDULE-END-DT
  6778*    ELSE
  6779*        MOVE NLSTPMT-SAVE       TO  AT-SCHEDULE-END-DT.
  6780
  6781     IF NLASTI = 'Y'
  6782        MOVE 'F'                 TO AT-LAST-PMT-TYPE
  6783     ELSE
  6784        MOVE 'P'                 TO AT-LAST-PMT-TYPE.
  6785
  6786     MOVE NMONTHSI               TO AT-INTERVAL-MONTHS.
  6787     MOVE NREGPMT-SAVE           TO AT-REGULAR-PMT-AMT.
  6788
  6789     MOVE WS-PAYEE-CODE          TO AT-AUTO-PAYEE-CD.
  6790
  6791     IF NINDCTRI    IS EQUAL TO  'N'
  6792         MOVE 'N'                TO AT-AUTO-CASH
  6793     ELSE
  6794         MOVE 'Y'                TO AT-AUTO-CASH.
  6795
  6796     MOVE ENDLETTI               TO AT-AUTO-END-LETTER.
  6797
  6798     IF PI-COMPANY-ID = 'CSL'
  6799        IF PI-CARRIER = 'A' OR 'B' OR 'C' OR '1' OR '2' OR
  6800                        '3' OR '4'
  6801         INSPECT AT-AUTO-PAYEE-CD CONVERTING 'IBA' TO 'IOA'.
  6802
  6803     MOVE LOW-VALUE              TO AT-TERMINATED-DT.
  6804     MOVE 'AT'                   TO AT-RECORD-ID.
  6805     MOVE  3                     TO AT-TRAILER-TYPE.
  6806     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  6807                                    AT-AUTO-PAY-LAST-MAINT-DT
  6808     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  6809                                    AT-AUTO-PAY-LAST-UPDATED-BY
  6810     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  6811     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  6812
  6813
  6814* EXEC CICS WRITE
  6815*         DATASET(ACTV-ID)
  6816*         FROM   (ACTIVITY-TRAILERS)
  6817*         RIDFLD (AT-CONTROL-PRIMARY)
  6818*         END-EXEC.
  6819     MOVE LENGTH OF
  6820      ACTIVITY-TRAILERS
  6821       TO DFHEIV11
  6822*    MOVE '&$ L                  ''   #00006591' TO DFHEIV0
  6823     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6824     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6825     MOVE X'2020233030303036353931' TO DFHEIV0(25:11)
  6826     CALL 'kxdfhei1' USING DFHEIV0,
  6827           ACTV-ID,
  6828           ACTIVITY-TRAILERS,
  6829           DFHEIV11,
  6830           AT-CONTROL-PRIMARY,
  6831           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 131
* EL154.cbl
  6832           DFHEIV99
  6833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6834
  6835
  6836 4199-EXIT.
  6837      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 132
* EL154.cbl
  6839 5000-READ-CLAIM.
  6840
  6841* EXEC CICS READ
  6842*        UPDATE
  6843*        DATASET(CLAM-ID)
  6844*        SET    (ADDRESS OF CLAIM-MASTER)
  6845*        RIDFLD (CLAM-KEY)
  6846*        END-EXEC.
  6847*    MOVE '&"S        EU         (   #00006601' TO DFHEIV0
  6848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6849     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6850     MOVE X'2020233030303036363031' TO DFHEIV0(25:11)
  6851     CALL 'kxdfhei1' USING DFHEIV0,
  6852           CLAM-ID,
  6853           DFHEIV20,
  6854           DFHEIV99,
  6855           CLAM-KEY,
  6856           DFHEIV99,
  6857           DFHEIV99,
  6858           DFHEIV99
  6859     SET ADDRESS OF CLAIM-MASTER TO
  6860         DFHEIV20
  6861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6862
  6863
  6864 5099-EXIT.
  6865      EXIT.
  6866
  6867 5200-REWRITE.
  6868
  6869* EXEC CICS HANDLE CONDITION
  6870*        DUPKEY
  6871*        END-EXEC.
  6872*    MOVE '"$                   ! '' #00006612' TO DFHEIV0
  6873     MOVE X'222494202020202020202020' TO DFHEIV0(1:12)
  6874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6875     MOVE X'2720233030303036363132' TO DFHEIV0(25:11)
  6876     CALL 'kxdfhei1' USING DFHEIV0
  6877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6878
  6879
  6880     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
  6881     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
  6882     MOVE CURRENT-SAVE           TO CL-LAST-MAINT-DT.
  6883
  6884* EXEC CICS REWRITE
  6885*        DATASET(CLAM-ID)
  6886*        FROM   (CLAIM-MASTER)
  6887*        END-EXEC.
  6888     MOVE LENGTH OF
  6889      CLAIM-MASTER
  6890       TO DFHEIV11
  6891*    MOVE '&& L                  %   #00006619' TO DFHEIV0
  6892     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6893     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6894     MOVE X'2020233030303036363139' TO DFHEIV0(25:11)
  6895     CALL 'kxdfhei1' USING DFHEIV0,
  6896           CLAM-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 133
* EL154.cbl
  6897           CLAIM-MASTER,
  6898           DFHEIV11,
  6899           DFHEIV99
  6900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6901
  6902
  6903*    MOVE 1                      TO EMI-NUMBER-OF-LINES.
  6904     MOVE ER-0000                TO EMI-ERROR.
  6905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6906
  6907 5299-EXIT.
  6908      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 134
* EL154.cbl
  6910 5900-VERIFY-ALL-FIELDS.
  6911******************************************************************
  6912*       PRELIMINARY EDITS TO VERIFY THAT THE REQUIRED FIELDS     *
  6913*       HAVE DATA ENTERED IN THEM                                *
  6914******************************************************************
  6915
  6916     IF DAYPAYL EQUAL +0
  6917        MOVE ZEROS TO DAYPAYI.
  6918
  6919     IF NEFFDTEL EQUAL +0
  6920        MOVE LOW-VALUES TO NEFFDTEI.
  6921
  6922     IF NFSTAMTL EQUAL +0
  6923        MOVE ZEROS TO NFSTAMTI
  6924                      NFSTAMTO.
  6925
  6926     IF NDAYSFL EQUAL +0
  6927        MOVE ZEROS TO NDAYSFI.
  6928
  6929     IF NFSTAMTL EQUAL +0
  6930        IF NDAYSFL NOT EQUAL +0
  6931           MOVE +0        TO NDAYSFL
  6932           MOVE ZEROS     TO NDAYSFI.
  6933
  6934     IF NMONTHSL = ZEROS
  6935        MOVE -1                  TO NMONTHSL
  6936        GO TO 5910-REQUIRED-ERROR.
  6937
  6938     IF NFSTPMTL = ZEROS
  6939        MOVE -1                  TO NFSTPMTL
  6940        GO TO 5910-REQUIRED-ERROR.
  6941
  6942     IF NLSTPMTL = ZEROS
  6943        MOVE -1                  TO NLSTPMTL
  6944        GO TO 5910-REQUIRED-ERROR.
  6945
  6946     IF NLASTL = ZEROS
  6947        MOVE -1                  TO NLASTL
  6948        GO TO 5910-REQUIRED-ERROR.
  6949
  6950     IF NPAYEEL = ZEROS
  6951        MOVE -1                  TO NPAYEEL
  6952        GO TO 5910-REQUIRED-ERROR.
  6953
  6954     IF LETTDTEL EQUAL +0
  6955        MOVE LOW-VALUES TO LETTDTEI.
  6956
  6957     IF (PI-COMPANY-ID  =  'AIG' OR  'AUK') AND
  6958        (NINDCTRL =  ZEROS)
  6959           MOVE -1               TO NINDCTRL
  6960           GO TO 5910-REQUIRED-ERROR.
  6961
  6962     GO TO 5999-EXIT.
  6963
  6964 5910-REQUIRED-ERROR.
  6965     MOVE ER-0358                TO EMI-ERROR.
  6966     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6967
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 135
* EL154.cbl
  6968 5999-EXIT.
  6969      EXIT.
  6970
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 136
* EL154.cbl
  6972 6000-EDIT-INPUT-DATA.
  6973******************************************************
  6974*    IF THE EFFECTIVE OR "PAID FROM" WAS NOT         *
  6975*    ENTERED, THEN USE THE INCURRED OR LAST PAID     *
  6976*    THRU DATE                                       *
  6977******************************************************
  6978
  6979     MOVE SPACES TO WS-ELIMINATION-SW.
  6980
  6981     IF NEFFDTEL NOT = ZEROS
  6982        MOVE NEFFDTEI            TO DEEDIT-FIELD
  6983        PERFORM 8600-DEEDIT
  6984        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  6985        MOVE '4'                 TO DC-OPTION-CODE
  6986        PERFORM 9700-DATE-LINK
  6987        IF DATE-CONVERSION-ERROR
  6988           MOVE ER-0348          TO EMI-ERROR
  6989           MOVE -1               TO NEFFDTEL
  6990           MOVE AL-UABON         TO NEFFDTEA
  6991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6992        ELSE
  6993           MOVE DEEDIT-FIELD-V0  TO NEFFDTEO
  6994           INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  6995           MOVE AL-UANON         TO NEFFDTEA
  6996           MOVE DC-BIN-DATE-1    TO NEFFDTE-SAVE
  6997     ELSE
  6998        IF CL-PAID-THRU-DT EQUAL LOW-VALUES
  6999           MOVE 'N' TO WS-ELIMINATION-SW
  7000           MOVE CL-INCURRED-DT TO NEFFDTE-SAVE
  7001                                  DC-BIN-DATE-1
  7002           MOVE ' ' TO DC-OPTION-CODE
  7003           PERFORM 9700-DATE-LINK
  7004           IF NO-CONVERSION-ERROR
  7005              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7006              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7007           ELSE
  7008              MOVE LOW-VALUES TO NEFFDTE-SAVE
  7009        ELSE
  7010           MOVE CL-PAID-THRU-DT TO DC-BIN-DATE-1
  7011           MOVE +1 TO DC-ELAPSED-DAYS
  7012           MOVE +0 TO DC-ELAPSED-MONTHS
  7013           MOVE '6' TO DC-OPTION-CODE
  7014           PERFORM 9700-DATE-LINK
  7015           IF NO-CONVERSION-ERROR
  7016              MOVE DC-BIN-DATE-2 TO NEFFDTE-SAVE
  7017              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7018              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7019           ELSE
  7020              MOVE LOW-VALUES TO NEFFDTE-SAVE.
  7021
  7022******************************************************************
  7023*       EDIT FIRST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7024*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7025*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7026******************************************************************
  7027
  7028     IF NFSTPMTL NOT = ZEROS
  7029        MOVE NFSTPMTI            TO DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 137
* EL154.cbl
  7030        PERFORM 8600-DEEDIT
  7031        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7032        MOVE '4'                 TO DC-OPTION-CODE
  7033        PERFORM 9700-DATE-LINK
  7034        IF DATE-CONVERSION-ERROR
  7035           MOVE ER-0349          TO EMI-ERROR
  7036           MOVE -1               TO NFSTPMTL
  7037           MOVE AL-UABON         TO NFSTPMTA
  7038           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7039          ELSE
  7040           MOVE DEEDIT-FIELD-V0  TO NFSTPMTO
  7041           INSPECT NFSTPMTI CONVERTING SPACES TO '/'
  7042           MOVE AL-UANON         TO NFSTPMTA.
  7043*          MOVE DC-BIN-DATE-1    TO NFSTPMT-SAVE.
  7044
  7045     IF PI-USES-PAID-TO
  7046         MOVE '6'                TO  DC-OPTION-CODE
  7047         MOVE -1                 TO  DC-ELAPSED-DAYS
  7048         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7049         PERFORM 9700-DATE-LINK
  7050         IF NO-CONVERSION-ERROR
  7051             MOVE DC-BIN-DATE-2  TO  NFSTPMT-SAVE
  7052         ELSE
  7053             MOVE ER-0349        TO  EMI-ERROR
  7054             MOVE -1             TO  NFSTPMTL
  7055             MOVE AL-UABON       TO  NFSTPMTA
  7056             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7057     ELSE
  7058         MOVE DC-BIN-DATE-1      TO  NFSTPMT-SAVE.
  7059
  7060******************************************************************
  7061*       EDIT LAST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7062*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7063*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7064******************************************************************
  7065
  7066     IF NLSTPMTL NOT = ZEROS
  7067        MOVE NLSTPMTI            TO DEEDIT-FIELD
  7068        PERFORM 8600-DEEDIT
  7069        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7070        MOVE '4'                 TO DC-OPTION-CODE
  7071        PERFORM 9700-DATE-LINK
  7072        IF DATE-CONVERSION-ERROR
  7073           MOVE ER-0354          TO EMI-ERROR
  7074           MOVE -1               TO NLSTPMTL
  7075           MOVE AL-UABON         TO NLSTPMTA
  7076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7077          ELSE
  7078           MOVE DEEDIT-FIELD-V0  TO NLSTPMTO
  7079           INSPECT NLSTPMTI CONVERTING SPACES TO '/'
  7080           MOVE AL-UANON         TO NLSTPMTA.
  7081
  7082     IF PI-USES-PAID-TO
  7083         MOVE '6'                TO  DC-OPTION-CODE
  7084         MOVE -1                 TO  DC-ELAPSED-DAYS
  7085         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7086         PERFORM 9700-DATE-LINK
  7087         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 138
* EL154.cbl
  7088             MOVE DC-BIN-DATE-2  TO  NLSTPMT-SAVE
  7089         ELSE
  7090             MOVE ER-0354        TO  EMI-ERROR
  7091             MOVE -1             TO  NLSTPMTL
  7092             MOVE AL-UABON       TO  NLSTPMTA
  7093             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7094     ELSE
  7095         MOVE DC-BIN-DATE-1      TO  NLSTPMT-SAVE.
  7096
  7097******************************************************************
  7098*       EDIT FIRST PAYMENT AMOUNT
  7099******************************************************************
  7100
  7101     IF NFSTAMTL NOT = ZEROS
  7102
  7103* EXEC CICS BIF DEEDIT
  7104*          FIELD (NFSTAMTI)
  7105*          LENGTH(10)
  7106*       END-EXEC
  7107     MOVE 10
  7108       TO DFHEIV11
  7109*    MOVE '@"L                   #   #00006823' TO DFHEIV0
  7110     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7111     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7112     MOVE X'2020233030303036383233' TO DFHEIV0(25:11)
  7113     CALL 'kxdfhei1' USING DFHEIV0,
  7114           NFSTAMTI,
  7115           DFHEIV11
  7116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7117        IF NFSTAMTI NOT NUMERIC
  7118           MOVE ER-0350          TO EMI-ERROR
  7119           MOVE -1               TO NFSTAMTL
  7120           MOVE AL-UNBON         TO NFSTAMTA
  7121           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7122        ELSE
  7123           MOVE NFSTAMTI         TO NFSTAMT-SAVE
  7124                                    NFSTAMTO
  7125           MOVE AL-UNNON         TO NFSTAMTA
  7126        end-if
  7127     end-if
  7128******************************************************************
  7129*       EDIT DAY TO PAY
  7130******************************************************************
  7131
  7132     IF DAYPAYL NOT EQUAL +0
  7133        IF DAYPAYI NUMERIC AND
  7134           DAYPAYI LESS THAN 32
  7135           MOVE AL-UNNON         TO DAYPAYA
  7136        ELSE
  7137           MOVE ER-0632          TO EMI-ERROR
  7138           MOVE -1               TO DAYPAYL
  7139           MOVE AL-UNBON         TO DAYPAYA
  7140           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7141
  7142******************************************************************
  7143*       EDIT NUMBER OF DAYS IN FIRST PAYMENT PERIOD
  7144******************************************************************
  7145
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 139
* EL154.cbl
  7146     IF NDAYSFL NOT = ZEROS
  7147        IF NDAYSFI NOT NUMERIC
  7148           MOVE ER-0351          TO EMI-ERROR
  7149           MOVE -1               TO NDAYSFL
  7150           MOVE AL-UNBON         TO NDAYSFA
  7151           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7152        ELSE
  7153           MOVE AL-UNNON         TO NDAYSFA.
  7154
  7155******************************************************************
  7156*       EDIT NUMBER OF MONTHS BETWEEN PAYMENTS
  7157******************************************************************
  7158
  7159     IF NMONTHSL EQUAL +0
  7160        MOVE +1                  TO NMONTHSL
  7161        MOVE 1                   TO NMONTHSI.
  7162
  7163     IF NMONTHSL NOT = ZEROS
  7164        IF NMONTHSI NOT NUMERIC
  7165           MOVE ER-0353          TO EMI-ERROR
  7166           MOVE -1               TO NMONTHSL
  7167           MOVE AL-UNBON         TO NMONTHSA
  7168           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7169        ELSE
  7170           IF NMONTHSI NOT GREATER THAN ZERO
  7171              MOVE ER-0353          TO EMI-ERROR
  7172              MOVE -1               TO NMONTHSL
  7173              MOVE AL-UNBON         TO NMONTHSA
  7174              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7175              ELSE
  7176              MOVE AL-UNNON         TO NMONTHSA.
  7177
  7178******************************************************************
  7179*       EDIT PAYEE CODE
  7180******************************************************************
  7181
  7182     MOVE NPAYEEI TO WS-PAYEE-CODE.
  7183
  7184     IF WS-PAYEE-SEQ NOT NUMERIC
  7185        MOVE ER-0357          TO EMI-ERROR
  7186        MOVE -1               TO NPAYEEL
  7187        MOVE AL-UNBON         TO NPAYEEA
  7188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7189        GO TO 6300-EXIT.
  7190
  7191     IF WS-PAYEE-CD EQUAL 'I' AND
  7192        WS-PAYEE-SEQ-NUM EQUAL 0
  7193        MOVE ER-0357          TO EMI-ERROR
  7194        MOVE -1               TO NPAYEEL
  7195        MOVE AL-UNBON         TO NPAYEEA
  7196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7197
  7198     IF WS-PAYEE-SEQ-NUM GREATER THAN 9
  7199        MOVE ER-0357          TO EMI-ERROR
  7200        MOVE -1               TO NPAYEEL
  7201        MOVE AL-UNBON         TO NPAYEEA
  7202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7203
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 140
* EL154.cbl
  7204     IF NPAYEEL NOT EQUAL +0
  7205        IF WS-PAYEE-CD = ('I' OR 'B' OR 'A')
  7206           MOVE AL-UNNON         TO NPAYEEA
  7207        ELSE
  7208           MOVE ER-0357          TO EMI-ERROR
  7209           MOVE -1               TO NPAYEEL
  7210           MOVE AL-UNBON         TO NPAYEEA
  7211           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7212
  7213******************************************************************
  7214*       EDIT LAST PAYMENT TYPE
  7215******************************************************************
  7216
  7217     IF NLASTL NOT = ZEROS
  7218        IF NLASTI = 'Y' OR 'N'
  7219           MOVE AL-UANON         TO NLASTA
  7220        ELSE
  7221           MOVE ER-0352          TO EMI-ERROR
  7222           MOVE -1               TO NLASTL
  7223           MOVE AL-UABON         TO NLASTA
  7224           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7225
  7226******************************************************************
  7227*       EDIT CASH / NON CASH INDICATOR
  7228******************************************************************
  7229
  7230     IF NINDCTRL NOT =  ZEROS
  7231        IF NINDCTRI  = 'Y' OR 'N'
  7232           MOVE AL-UANON         TO NINDCTRA
  7233        ELSE
  7234           MOVE ER-0815          TO EMI-ERROR
  7235           MOVE -1               TO NINDCTRL
  7236           MOVE AL-UABON         TO NINDCTRA
  7237           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7238
  7239     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7240         IF (CL-ASSOCIATES IS EQUAL TO 'A' OR 'N')
  7241             IF NINDCTRI IS EQUAL TO 'N'
  7242                 MOVE ER-3537    TO  EMI-ERROR
  7243                 MOVE -1         TO  NINDCTRL
  7244                 MOVE AL-UABON   TO  NINDCTRA
  7245                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7246
  7247******************************************************************
  7248*       EDIT LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7249******************************************************************
  7250
  7251     IF NPRINTL IS NOT EQUAL TO +0
  7252*01157         IF NPRINTI IS EQUAL TO 'N'
  7253           MOVE AL-UANON         TO  NPRINTA
  7254*01159         ELSE
  7255*01160            MOVE ER-0826          TO  EMI-ERROR
  7256*01161            MOVE -1               TO  NPRINTL
  7257*01162            MOVE AL-UABON         TO  NPRINTA
  7258*01163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7259     END-IF.
  7260
  7261******************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 141
* EL154.cbl
  7262*    IF THE AUTO LETTER DATE IS ENTERED IT IS USED   *
  7263*    TO RESOLVE VAIABLE @@AUTOPYDT IN THE LETTER     *
  7264*    FORM THAT IS ENTERED IN THE PRINT LETTER FIELD. *
  7265******************************************************
  7266
  7267     IF LETTDTEL NOT = ZEROS
  7268        MOVE LETTDTEI            TO DEEDIT-FIELD
  7269        PERFORM 8600-DEEDIT
  7270        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7271        MOVE '4'                 TO DC-OPTION-CODE
  7272        PERFORM 9700-DATE-LINK
  7273        IF DATE-CONVERSION-ERROR
  7274           MOVE ER-3801          TO EMI-ERROR
  7275           MOVE -1               TO LETTDTEL
  7276           MOVE AL-UABON         TO LETTDTEA
  7277           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7278        ELSE
  7279           MOVE DEEDIT-FIELD-V0  TO LETTDTEO
  7280           INSPECT LETTDTEI CONVERTING SPACES TO '/'
  7281           MOVE AL-UANON         TO LETTDTEA
  7282           MOVE DC-GREG-DATE-A-EDIT TO LETTDTE-SAVE
  7283        END-IF
  7284     ELSE
  7285         MOVE SPACES TO LETTDTE-SAVE
  7286     END-IF.
  7287
  7288******************************************************************
  7289*       EDIT END LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7290******************************************************************
  7291     IF ENDLETTL NOT = ZEROS
  7292             MOVE AL-UANON          TO ENDLETTA
  7293     ELSE
  7294         IF NPRINTL NOT = ZEROS
  7295             IF NPRINTI NOT = 'N   '
  7296                 MOVE ER-3397    TO EMI-ERROR
  7297                 MOVE -1         TO ENDLETTL
  7298                 MOVE AL-UABON   TO ENDLETTA
  7299                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7300             END-IF
  7301         END-IF
  7302     END-IF.
  7303
  7304     IF NOT EMI-NO-ERRORS
  7305        GO TO 6300-EXIT.
  7306
  7307     IF PI-PROCESSOR-ID  =  LGXX-ID
  7308        GO TO 6150-READ-CARRIER.
  7309
  7310******************************************************************
  7311*       READ PROCESSOR RECORD ON THE CONTROL FILE TO GET THE
  7312*       PROCESSOR LIMITS
  7313******************************************************************
  7314
  7315
  7316* EXEC CICS HANDLE CONDITION
  7317*         NOTFND (6150-READ-CARRIER)
  7318*         NOTOPEN(8890-CNTL-NOT-OPEN)
  7319*         END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 142
* EL154.cbl
  7320*    MOVE '"$IJ                  ! ( #00007025' TO DFHEIV0
  7321     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7323     MOVE X'2820233030303037303235' TO DFHEIV0(25:11)
  7324     CALL 'kxdfhei1' USING DFHEIV0
  7325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7326
  7327
  7328
  7329* EXEC CICS READ
  7330*         DATASET(CNTL-ID)
  7331*         RIDFLD (CNTL-KEY)
  7332*         SET    (ADDRESS OF CONTROL-FILE)
  7333*         END-EXEC.
  7334*    MOVE '&"S        E          (   #00007030' TO DFHEIV0
  7335     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7336     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7337     MOVE X'2020233030303037303330' TO DFHEIV0(25:11)
  7338     CALL 'kxdfhei1' USING DFHEIV0,
  7339           CNTL-ID,
  7340           DFHEIV20,
  7341           DFHEIV99,
  7342           CNTL-KEY,
  7343           DFHEIV99,
  7344           DFHEIV99,
  7345           DFHEIV99
  7346     SET ADDRESS OF CONTROL-FILE TO
  7347         DFHEIV20
  7348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7349
  7350
  7351     MOVE CF-PROC-CALC-AMT-TOL       TO WS-AMT-TOL.
  7352     MOVE CF-PROC-CALC-DAYS-TOL      TO WS-DAY-TOL.
  7353     MOVE CF-PROC-MAX-AUTO-PMT       TO WS-MAX-AUTO-PMT.
  7354     MOVE CF-PROC-MAX-AUTO-MOS       TO WS-MAX-AUTO-MOS.
  7355     MOVE CF-PROC-MAX-REG-PMT        TO WS-REG-PMT.
  7356
  7357  6150-READ-CARRIER.
  7358******************************************************************
  7359*       READ THE CARRIER RECORD TO GET PAYMENT TOLERANCES
  7360******************************************************************
  7361
  7362     MOVE '6'                    TO CNTL-RECORD-TYPE.
  7363     MOVE SPACES                 TO CNTL-GENL.
  7364
  7365     IF CONTROL-IS-ACTUAL-CARRIER
  7366         MOVE PI-CARRIER                 TO CNTL-GEN4
  7367     ELSE
  7368         MOVE PI-CARRIER-CONTROL-LEVEL   TO CNTL-GEN4.
  7369
  7370
  7371* EXEC CICS HANDLE CONDITION
  7372*         NOTFND(6180-READ-CERT)
  7373*         END-EXEC.
  7374*    MOVE '"$I                   ! ) #00007055' TO DFHEIV0
  7375     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7376     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7377     MOVE X'2920233030303037303535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 143
* EL154.cbl
  7378     CALL 'kxdfhei1' USING DFHEIV0
  7379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7380
  7381
  7382
  7383* EXEC CICS READ
  7384*         DATASET(CNTL-ID)
  7385*         RIDFLD (CNTL-KEY)
  7386*         SET    (ADDRESS OF CONTROL-FILE)
  7387*         END-EXEC.
  7388*    MOVE '&"S        E          (   #00007059' TO DFHEIV0
  7389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7391     MOVE X'2020233030303037303539' TO DFHEIV0(25:11)
  7392     CALL 'kxdfhei1' USING DFHEIV0,
  7393           CNTL-ID,
  7394           DFHEIV20,
  7395           DFHEIV99,
  7396           CNTL-KEY,
  7397           DFHEIV99,
  7398           DFHEIV99,
  7399           DFHEIV99
  7400     SET ADDRESS OF CONTROL-FILE TO
  7401         DFHEIV20
  7402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7403
  7404
  7405     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
  7406
  7407     IF WS-AMT-TOL = ZERO
  7408        MOVE CF-CALC-AMT-TOL     TO WS-AMT-TOL.
  7409
  7410     IF WS-DAY-TOL = ZEROS
  7411        MOVE CF-CALC-DAYS-TOL    TO WS-DAY-TOL.
  7412
  7413     IF WS-MAX-AUTO-PMT = ZEROS
  7414        MOVE CF-MAX-AUTO-PMT     TO WS-MAX-AUTO-PMT.
  7415
  7416     IF WS-MAX-AUTO-MOS = ZEROS
  7417        MOVE CF-MAX-AUTO-MOS     TO WS-MAX-AUTO-MOS.
  7418
  7419     IF WS-REG-PMT = ZEROS
  7420        MOVE CF-MAX-REG-PMT      TO WS-REG-PMT.
  7421
  7422 6180-READ-CERT.
  7423
  7424     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7425         GO TO 6190-READ-EMPLCY.
  7426
  7427
  7428* EXEC CICS HANDLE CONDITION
  7429*         NOTOPEN   (8880-CERT-NOT-OPEN)
  7430*         NOTFND    (6185-CERT-NOT-FOUND)
  7431*         END-EXEC.
  7432*    MOVE '"$JI                  ! * #00007087' TO DFHEIV0
  7433     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7435     MOVE X'2A20233030303037303837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 144
* EL154.cbl
  7436     CALL 'kxdfhei1' USING DFHEIV0
  7437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7438
  7439
  7440
  7441* EXEC CICS READ
  7442*         DATASET(CERT-ID)
  7443*         RIDFLD (CERT-KEY)
  7444*         SET    (ADDRESS OF CERTIFICATE-MASTER)
  7445*         END-EXEC.
  7446*    MOVE '&"S        E          (   #00007092' TO DFHEIV0
  7447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7449     MOVE X'2020233030303037303932' TO DFHEIV0(25:11)
  7450     CALL 'kxdfhei1' USING DFHEIV0,
  7451           CERT-ID,
  7452           DFHEIV20,
  7453           DFHEIV99,
  7454           CERT-KEY,
  7455           DFHEIV99,
  7456           DFHEIV99,
  7457           DFHEIV99
  7458     SET ADDRESS OF CERTIFICATE-MASTER TO
  7459         DFHEIV20
  7460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7461
  7462
  7463     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7464         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  7465         MOVE '6'                    TO  DC-OPTION-CODE
  7466         MOVE '1'                    TO  DC-END-OF-MONTH
  7467         MOVE +0                     TO  DC-ELAPSED-DAYS
  7468                                         DC-ODD-DAYS-OVER
  7469         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  7470         PERFORM 9700-DATE-LINK
  7471         IF NO-CONVERSION-ERROR
  7472             MOVE DC-BIN-DATE-2      TO  WS-EXP-DT
  7473         ELSE
  7474             MOVE LOW-VALUES         TO  WS-EXP-DT
  7475     ELSE
  7476         MOVE CM-AH-LOAN-EXPIRE-DT   TO  WS-EXP-DT.
  7477
  7478     move cm-ah-benefit-amt      to ws-monthly-benefit
  7479     move cm-ah-benefit-cd       to ws-ah-benefit-cd
  7480     GO TO 6200-START-FINAL-EDITS.
  7481
  7482 6185-CERT-NOT-FOUND.
  7483     MOVE ER-0206                TO EMI-ERROR.
  7484     MOVE -1                     TO NEFFDTEL.
  7485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7486     GO TO 6300-EXIT.
  7487
  7488 6190-READ-EMPLCY.
  7489
  7490
  7491* EXEC CICS HANDLE CONDITION
  7492*        NOTOPEN   (8885-EMPLCY-NOT-OPEN)
  7493*        NOTFND    (6195-EMPLCY-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 145
* EL154.cbl
  7494*    END-EXEC.
  7495*    MOVE '"$JI                  ! + #00007125' TO DFHEIV0
  7496     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7498     MOVE X'2B20233030303037313235' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0
  7500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7501
  7502
  7503     MOVE CL-CV-REFERENCE-NO     TO  EMPLCY-REFERENCE-NO.
  7504
  7505
  7506* EXEC CICS READ
  7507*        DATASET   (EMPLCY-ID)
  7508*        RIDFLD    (EMPLCY-KEY)
  7509*        SET       (ADDRESS OF POLICY-MASTER)
  7510*    END-EXEC.
  7511*    MOVE '&"S        E          (   #00007132' TO DFHEIV0
  7512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7514     MOVE X'2020233030303037313332' TO DFHEIV0(25:11)
  7515     CALL 'kxdfhei1' USING DFHEIV0,
  7516           EMPLCY-ID,
  7517           DFHEIV20,
  7518           DFHEIV99,
  7519           EMPLCY-KEY,
  7520           DFHEIV99,
  7521           DFHEIV99,
  7522           DFHEIV99
  7523     SET ADDRESS OF POLICY-MASTER TO
  7524         DFHEIV20
  7525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7526
  7527
  7528     MOVE PM-INS-TERMINATION-DT  TO  WS-EXP-DT.
  7529     GO TO 6200-START-FINAL-EDITS.
  7530
  7531 6195-EMPLCY-NOT-FOUND.
  7532
  7533     MOVE ER-9483                TO  EMI-ERROR.
  7534     MOVE -1                     TO  NEFFDTEL.
  7535     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7536     GO TO 6300-EXIT.
  7537
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 146
* EL154.cbl
  7539 6200-START-FINAL-EDITS.
  7540
  7541******************************************************************
  7542****** VERIFY ELIMINATION PERIOD
  7543******************************************************************
  7544
  7545     IF CL-PAID-THRU-DT NOT EQUAL LOW-VALUES
  7546          GO TO 6225-CONTINUE-EDIT.
  7547
  7548     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7549         GO TO 6225-CONTINUE-EDIT.
  7550
  7551     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  7552     MOVE WS-ACCESS              TO CNTL-GENL.
  7553     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7554     MOVE '5'                    TO CNTL-RECORD-TYPE.
  7555     MOVE ZEROS                  TO CNTL-SEQ.
  7556
  7557     IF WS-BEN-CD = ZEROS
  7558         MOVE ER-0283            TO EMI-ERROR
  7559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7560         MOVE -1                 TO NFSTPMTL
  7561         MOVE AL-UNBON           TO NFSTPMTA
  7562         GO TO 6300-EXIT.
  7563
  7564     PERFORM 7200-LOCATE-BENEFIT THRU 7200-EXIT.
  7565
  7566     IF NOT BENEFIT-FOUND
  7567         MOVE ER-0283            TO EMI-ERROR
  7568         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7569         MOVE -1                 TO NFSTPMTL
  7570         MOVE AL-UNBON           TO NFSTPMTA
  7571         GO TO 6300-EXIT.
  7572
  7573     MOVE CF-BENEFIT-ALPHA (SUB-1) TO PI-BENEFIT-SAVE.
  7574
  7575     IF PI-BEN-DAYS NOT NUMERIC
  7576        MOVE ZEROS               TO PI-BEN-DAYS.
  7577
  7578     IF PI-BEN-TYPE = 'R'
  7579         IF PI-BEN-DAYS IS EQUAL TO ZEROS
  7580             NEXT SENTENCE
  7581         ELSE
  7582             SUBTRACT 1 FROM PI-BEN-DAYS.
  7583
  7584     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  7585     MOVE PI-BEN-DAYS            TO DC-ELAPSED-DAYS.
  7586     MOVE +0                     TO DC-ELAPSED-MONTHS.
  7587     MOVE '6'                    TO DC-OPTION-CODE.
  7588     PERFORM 9700-DATE-LINK.
  7589     MOVE DC-BIN-DATE-2          TO RETRO-ELIM-DATE.
  7590     IF NO-EFFDTE-ENTERED
  7591        IF PI-BEN-TYPE EQUAL 'E'
  7592          MOVE  SPACES              TO  WS-ELIMINATION-SW
  7593          MOVE  DC-BIN-DATE-2       TO  NEFFDTE-SAVE
  7594          MOVE  DC-GREG-DATE-1-MDY  TO  NEFFDTEO
  7595          INSPECT NEFFDTEI CONVERTING SPACES TO '/'.
  7596
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 147
* EL154.cbl
  7597     IF PI-BEN-TYPE = 'E'
  7598         IF RETRO-ELIM-DATE GREATER THAN NEFFDTE-SAVE
  7599             MOVE ER-0541            TO EMI-ERROR
  7600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7601             MOVE -1                 TO NEFFDTEL
  7602             MOVE AL-UNBON           TO NEFFDTEA.
  7603
  7604     IF PI-BEN-TYPE = 'R'
  7605         IF RETRO-ELIM-DATE GREATER THAN NFSTPMT-SAVE
  7606             MOVE ER-0541            TO EMI-ERROR
  7607             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7608             MOVE -1                 TO NEFFDTEL
  7609             MOVE AL-UNBON           TO NEFFDTEA.
  7610
  7611
  7612 6225-CONTINUE-EDIT.
  7613******************************************************
  7614*VERIFY THAT THE LAST PAYMENT DATE IS NOT BEYOND     *
  7615*THE EXPIRATION DATE.                                *
  7616******************************************************
  7617* FOR BIU ALLOW PAYMENT PAST EXP + 7 MONTHS
  7618     MOVE WS-EXP-DT TO DC-BIN-DATE-1.
  7619     MOVE 6         TO DC-OPTION-CODE.
  7620     MOVE 0         TO DC-ELAPSED-DAYS.
  7621     MOVE 7         TO DC-ELAPSED-MONTHS.
  7622     PERFORM 9700-DATE-LINK.
  7623     IF NO-CONVERSION-ERROR
  7624         MOVE DC-BIN-DATE-2 TO WS-EXP-DT-PLUS7
  7625     ELSE
  7626         MOVE WS-EXP-DT     TO WS-EXP-DT-PLUS7
  7627     END-IF.
  7628
  7629     IF NLSTPMT-SAVE GREATER THAN WS-EXP-DT
  7630       IF CL-CERT-ACCOUNT (9:2) = 'BI' AND
  7631                      NLSTPMT-SAVE <= WS-EXP-DT-PLUS7
  7632         IF PI-LAST-ERROR-NO EQUAL ER-3396 OR ER-0670
  7633             CONTINUE
  7634         ELSE
  7635             MOVE ER-3396             TO EMI-ERROR
  7636             MOVE AL-UABON            TO NLSTPMTA
  7637             MOVE -1                  TO NLSTPMTL
  7638             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7639         END-IF
  7640       ELSE
  7641        MOVE ER-0396             TO EMI-ERROR
  7642        MOVE AL-UABON            TO NLSTPMTA
  7643        MOVE -1                  TO NLSTPMTL
  7644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7645        GO TO 6300-EXIT.
  7646
  7647******************************************************
  7648*VERIFY THAT THE LAST PAYMENT DATE IS GREATER THAN   *
  7649*THE FIRST PAYMENT DATE.                             *
  7650******************************************************
  7651
  7652     IF NLSTPMT-SAVE NOT GREATER THAN NFSTPMT-SAVE
  7653        MOVE ER-0559             TO EMI-ERROR
  7654        MOVE AL-UABON            TO NLSTPMTA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 148
* EL154.cbl
  7655        MOVE -1                  TO NLSTPMTL
  7656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7657        GO TO 6300-EXIT.
  7658
  7659******************************************************
  7660*    MAKE SURE THE DIFFERENCE BETWEEN THE FIRST      *
  7661*    PAYMENT DATE AND LAST PAYMENT DATE IS           *
  7662*    DIVISABLE BY THE INTERVAL OF MONTHS,            *
  7663*    AND THE DURATION IS IN FULL MONTH PMTS.         *
  7664******************************************************
  7665     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  7666     MOVE NLSTPMT-SAVE           TO DC-BIN-DATE-2.
  7667     MOVE '1'                    TO DC-OPTION-CODE.
  7668     PERFORM 9700-DATE-LINK.
  7669     DIVIDE DC-ELAPSED-MONTHS BY NMONTHSI GIVING WS-WORK
  7670            REMAINDER WS-REMAINDER.
  7671     IF WS-REMAINDER NOT = 0
  7672        MOVE ER-0397             TO EMI-ERROR
  7673        MOVE -1                  TO NMONTHSL
  7674        MOVE AL-UNBON            TO NMONTHSA
  7675        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7676        GO TO 6300-EXIT.
  7677
  7678     IF DC-ODD-DAYS-OVER GREATER THAN +0
  7679        MOVE ER-0597             TO EMI-ERROR
  7680        MOVE -1                  TO NLSTPMTL
  7681        MOVE AL-UNBON            TO NLSTPMTA
  7682                                    NFSTPMTA
  7683        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7684        GO TO 6300-EXIT.
  7685
  7686******************************************************
  7687*    VERIFY THAT FIRST PAYMENT DATE IS NOT LESS      *
  7688*    THAN THE CURRENT DATE.                          *
  7689******************************************************
  7690     IF NFSTPMT-SAVE LESS THAN CURRENT-SAVE
  7691        MOVE ER-0563             TO EMI-ERROR
  7692        MOVE -1                  TO NFSTPMTL
  7693        MOVE AL-UNBON            TO NFSTPMTA
  7694        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7695        GO TO 6300-EXIT.
  7696
  7697******************************************************
  7698*                                                    *
  7699*    EDIT THE NUMBER OF DAYS IN FIRST PAYMENT        *
  7700*                                                    *
  7701******************************************************
  7702
  7703     MOVE NEFFDTE-SAVE       TO DC-BIN-DATE-1
  7704     MOVE -1                 TO DC-ELAPSED-DAYS
  7705     MOVE +0                 TO DC-ELAPSED-MONTHS
  7706     MOVE '6'                TO DC-OPTION-CODE
  7707     PERFORM 9700-DATE-LINK
  7708     IF NO-CONVERSION-ERROR
  7709        MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1.
  7710
  7711     MOVE NFSTPMT-SAVE       TO DC-BIN-DATE-2
  7712     MOVE +0                 TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 149
* EL154.cbl
  7713                                DC-ELAPSED-DAYS
  7714     MOVE '1'                TO DC-OPTION-CODE
  7715     PERFORM 9700-DATE-LINK
  7716     IF NO-CONVERSION-ERROR
  7717        MOVE DC-ELAPSED-DAYS  TO WS-ELAPSED-DAYS.
  7718
  7719     IF NDAYSFL EQUAL +0
  7720       OR
  7721        NDAYSFI NOT NUMERIC
  7722       OR
  7723        NDAYSFI EQUAL ZEROS
  7724        MOVE DC-ELAPSED-DAYS  TO NDAYSFI.
  7725
  7726     IF DATE1-GREATER-DATE2
  7727        MOVE ER-0450 TO EMI-ERROR
  7728        MOVE -1      TO NEFFDTEL
  7729        MOVE AL-UABON TO NEFFDTEA
  7730        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7731        GO TO 6300-EXIT.
  7732
  7733     ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL
  7734     SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL
  7735     IF WS-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7736        WS-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7737        NDAYSFI = ZEROS
  7738         MOVE ER-0398             TO EMI-ERROR
  7739         MOVE -1                  TO NDAYSFL
  7740         MOVE AL-UNBON            TO NDAYSFA
  7741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7742         GO TO 6300-EXIT.
  7743
  7744******************************************************
  7745*                                                    *
  7746*    VERIFY OR CALCULATE THE FIRST PAYMENT AMOUNT    *
  7747*                                                    *
  7748******************************************************
  7749
  7750     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  7751     MOVE NEFFDTE-SAVE          TO CP-PAID-FROM-DATE.
  7752     MOVE NFSTPMT-SAVE          TO CP-PAID-THRU-DT.
  7753     MOVE WS-CALC-METHOD        TO CP-CLAIM-CALC-METHOD.
  7754
  7755     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7756         MOVE PM-PRODUCER           TO CP-ACCOUNT-NUMBER
  7757         MOVE PM-INS-MONTH-BENEFIT  TO  CP-ORIGINAL-BENEFIT
  7758     ELSE
  7759         MOVE CM-AH-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  7760         MOVE CM-ACCOUNT            TO CP-ACCOUNT-NUMBER.
  7761
  7762
  7763* EXEC CICS LINK
  7764*         PROGRAM   ('ELPMNT')
  7765*         COMMAREA  (CALCULATION-PASS-AREA)
  7766*         LENGTH    (CP-COMM-LENGTH)
  7767*    END-EXEC.
  7768     MOVE 'ELPMNT' TO DFHEIV1
  7769*    MOVE '."C                   (   #00007372' TO DFHEIV0
  7770     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 150
* EL154.cbl
  7771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7772     MOVE X'2020233030303037333732' TO DFHEIV0(25:11)
  7773     CALL 'kxdfhei1' USING DFHEIV0,
  7774           DFHEIV1,
  7775           CALCULATION-PASS-AREA,
  7776           CP-COMM-LENGTH,
  7777           DFHEIV99,
  7778           DFHEIV99,
  7779           DFHEIV99,
  7780           DFHEIV99
  7781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7782
  7783
  7784     IF CP-CLAIM-PAYMENT NOT NUMERIC
  7785        MOVE +0 TO CP-CLAIM-PAYMENT.
  7786
  7787     IF CP-ACTUAL-DAYS NOT NUMERIC
  7788        MOVE +0 TO CP-ACTUAL-DAYS.
  7789
  7790     IF NFSTAMT-SAVE EQUAL +0
  7791        MOVE CP-CLAIM-PAYMENT TO NFSTAMT-SAVE
  7792                                 NFSTAMTO.
  7793
  7794     IF NDAYSFI EQUAL ZEROS
  7795        MOVE CP-ACTUAL-DAYS   TO NDAYSFI.
  7796
  7797
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 151
* EL154.cbl
  7799******************************************************
  7800*    VERIFY THAT DAYS IN FIRST PAY PERIOD IS REALLY  *
  7801*    THE DIFFERENCE BETWEEN THE IST PAYMENT DATE     *
  7802*    AND THE EFFECTIVE DATE                          *
  7803******************************************************
  7804*    MOVE NEFFDTE-SAVE           TO DC-BIN-DATE-1.
  7805*    MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-2.
  7806*    MOVE '1'                    TO DC-OPTION-CODE.
  7807*    PERFORM 9700-DATE-LINK.
  7808*    IF DATE1-GREATER-DATE2
  7809*       MOVE ER-0450 TO EMI-ERROR
  7810*       MOVE -1      TO NEFFDTEL
  7811*       MOVE AL-UABON TO NEFFDTEA
  7812*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7813*       GO TO 6300-EXIT.
  7814*
  7815*    ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL.
  7816*    SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL.
  7817*    IF DC-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7818*       DC-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7819*       NDAYSFI = ZEROS
  7820*        MOVE ER-0398             TO EMI-ERROR
  7821*        MOVE -1                  TO NDAYSFL
  7822*        MOVE AL-UNBON            TO NDAYSFA
  7823*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7824*        GO TO 6300-EXIT.
  7825*
  7826******************************************************
  7827*   VERIFY THAT THE FIRST PAYMENT AMOUNT IS WITHIN   *
  7828*   THE TOLERANCE OF THE DAILY BENEFITS              *
  7829******************************************************
  7830*    IF CL-PMT-CALC-METHOD = '2' OR '5'
  7831*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 365
  7832*    ELSE
  7833*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 360.
  7834
  7835     IF WS-AMT-TOL NOT = ZEROS
  7836        COMPUTE WS-AMT-PLUS-TOL = (NFSTAMT-SAVE + WS-AMT-TOL)
  7837        COMPUTE WS-AMT-MINUS-TOL = (NFSTAMT-SAVE - WS-AMT-TOL)
  7838        IF CP-CLAIM-PAYMENT LESS THAN WS-AMT-MINUS-TOL OR
  7839           CP-CLAIM-PAYMENT GREATER THAN WS-AMT-PLUS-TOL OR
  7840           NFSTAMT-SAVE = +0
  7841           MOVE ER-0399          TO EMI-ERROR
  7842           MOVE -1               TO NFSTAMTL
  7843           MOVE AL-UNBON         TO NFSTAMTA
  7844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7845           GO TO 6300-EXIT.
  7846
  7847******************************************************
  7848*   VERIFY THERE IS AN ADDR TRAILER AVAILABLE        *
  7849*   FOR THE PAYEE CODE SPECIFIED                     *
  7850******************************************************
  7851     IF (WS-PAYEE-CD EQUAL 'I' AND
  7852        WS-PAYEE-SEQ-NUM GREATER THAN CL-INSURED-ADDR-CNT)
  7853       OR
  7854        (WS-PAYEE-CD EQUAL 'B' AND
  7855        WS-PAYEE-SEQ-NUM GREATER THAN CL-BENIF-ADDR-CNT)
  7856       OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 152
* EL154.cbl
  7857        (WS-PAYEE-CD EQUAL 'A' AND
  7858        WS-PAYEE-SEQ-NUM GREATER THAN CL-ACCOUNT-ADDR-CNT)
  7859        GO TO 6250-ADDR-ERROR.
  7860
  7861     IF (WS-PAYEE-CD EQUAL 'I')
  7862       OR
  7863        ((WS-PAYEE-CD EQUAL 'B' OR 'A') AND
  7864        (WS-PAYEE-SEQ-NUM GREATER THAN 0))
  7865        GO TO 6260-CONT.
  7866
  7867     IF WS-PAYEE-CD EQUAL 'A'
  7868        GO TO 6260-CONT.
  7869
  7870     IF (WS-PAYEE-CD EQUAL 'B' AND
  7871        CL-BENEFICIARY EQUAL SPACES)
  7872        GO TO 6250-ADDR-ERROR.
  7873
  7874     MOVE PI-COMPANY-CD          TO BENE-CO.
  7875     MOVE 'B'                    TO BENE-REC-TYPE.
  7876     MOVE CL-BENEFICIARY         TO BENE-CODE.
  7877
  7878
  7879* EXEC CICS HANDLE CONDITION
  7880*         NOTFND   (6250-ADDR-ERROR)
  7881*         END-EXEC.
  7882*    MOVE '"$I                   ! , #00007472' TO DFHEIV0
  7883     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7885     MOVE X'2C20233030303037343732' TO DFHEIV0(25:11)
  7886     CALL 'kxdfhei1' USING DFHEIV0
  7887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7888
  7889
  7890
  7891* EXEC CICS READ
  7892*         DATASET     (BENE-ID)
  7893*         SET         (ADDRESS OF BENEFICIARY-MASTER)
  7894*         RIDFLD      (BENE-KEY)
  7895*         END-EXEC.
  7896*    MOVE '&"S        E          (   #00007476' TO DFHEIV0
  7897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7899     MOVE X'2020233030303037343736' TO DFHEIV0(25:11)
  7900     CALL 'kxdfhei1' USING DFHEIV0,
  7901           BENE-ID,
  7902           DFHEIV20,
  7903           DFHEIV99,
  7904           BENE-KEY,
  7905           DFHEIV99,
  7906           DFHEIV99,
  7907           DFHEIV99
  7908     SET ADDRESS OF BENEFICIARY-MASTER TO
  7909         DFHEIV20
  7910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7911
  7912
  7913     GO TO 6260-CONT.
  7914
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 153
* EL154.cbl
  7915 6250-ADDR-ERROR.
  7916     IF (PI-COMPANY-ID EQUAL 'AIG' OR 'AUK' OR 'CIG' OR 'CUK')
  7917         IF (WS-PAYEE-CD EQUAL 'B')   AND
  7918            (WS-PAYEE-SEQ-NUM EQUAL 9)
  7919             GO TO 6260-CONT.
  7920
  7921     MOVE ER-0401         TO EMI-ERROR.
  7922     MOVE -1              TO NPAYEEL.
  7923     MOVE AL-UNBON        TO NPAYEEA.
  7924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7925
  7926 6260-CONT.
  7927******************************************************
  7928*   VERIFY THAT THE EFFECTIVE DATE IS NOT            *
  7929*   BEFORE THE INCURRED DATE                         *
  7930******************************************************
  7931     IF NEFFDTE-SAVE LESS THAN CL-INCURRED-DT
  7932        MOVE ER-0402             TO EMI-ERROR
  7933        MOVE -1                  TO NEFFDTEL
  7934        MOVE AL-UABON            TO NEFFDTEA
  7935        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7936
  7937******************************************************
  7938*   VERIFY THAT THE CLAIM HAS NOT BEEN CLOSED.       *
  7939******************************************************
  7940     IF CLAIM-IS-CLOSED
  7941        MOVE ER-1599            TO EMI-ERROR
  7942        MOVE -1                  TO TERML
  7943        MOVE AL-UABON            TO TERMA
  7944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7945
  7946******************************************************
  7947*  VERIFY THAT THE EFFECTIVE DATE IS                 *
  7948*  SUBSEQUENT TO THE PAID-THRU DATE                  *
  7949******************************************************
  7950     IF NEFFDTE-SAVE NOT GREATER THAN CL-PAID-THRU-DT
  7951        MOVE ER-0403             TO EMI-ERROR
  7952        MOVE -1                  TO NEFFDTEL
  7953        MOVE AL-UABON            TO NEFFDTEA
  7954        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7955
  7956******************************************************
  7957*  VERIFY THAT THE NUMBER OF MONTHS BETWEEN          *
  7958*  THE EFFECTIVE DATE AND THE LAST PAYMENT DATE      *
  7959*  IS NOT GREATER THAN THE MAXIMUM ALLOWED           *
  7960******************************************************
  7961     IF WS-MAX-AUTO-MOS NOT = ZEROS
  7962        MOVE NEFFDTE-SAVE        TO DC-BIN-DATE-1
  7963        MOVE NLSTPMT-SAVE        TO DC-BIN-DATE-2
  7964        MOVE '1'                 TO DC-OPTION-CODE
  7965        PERFORM 9700-DATE-LINK
  7966        IF DC-ELAPSED-MONTHS GREATER THAN WS-MAX-AUTO-MOS
  7967           MOVE ER-0404             TO EMI-ERROR
  7968           MOVE -1                  TO NEFFDTEL
  7969           MOVE AL-UABON            TO NEFFDTEA NLSTPMTA
  7970           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7971
  7972******************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 154
* EL154.cbl
  7973*  VERIFY THAT THE CERTIFICATE DOES NOT HAVE A       *
  7974*  CURRENT STATUS OF '8' (CANCEL APPLIED)            *
  7975******************************************************
  7976
  7977     IF PI-COMPANY-ID IS EQUAL TO 'HAN' OR 'LGX'
  7978         IF CM-AH-CANCEL-APPLIED
  7979             MOVE ER-0839            TO  EMI-ERROR
  7980             MOVE -1                 TO  ENTERPFL
  7981             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7982******************************************************************
  7983*   check to see if the pd thru dates are past the benefit exp dt
  7984******************************************************************
  7985
  7986     if pi-company-id not = 'DCC'
  7987        GO TO 6300-EXIT
  7988     END-IF
  7989
  7990     perform 6320-read-acct      thru 6320-exit
  7991     perform 6340-GET-DDF-FACTORS
  7992                                 thru 6340-exit
  7993     if ws-max-benefit-amt not = zeros
  7994        and ws-max-benefit-amt < ws-monthly-benefit
  7995        move ws-max-benefit-amt  to ws-monthly-benefit
  7996     end-if
  7997     perform 6350-get-cert-trlr  thru 6350-exit
  7998
  7999     if (nfstamt-save = zeros)
  8000        or (nfstamt-save = cp-claim-payment)
  8001        move ws-monthly-benefit  to nfstamt-save
  8002                                    nfstamto
  8003     end-if
  8004
  8005     if nfstamt-save > ws-monthly-benefit
  8006        move er-1657             to emi-error
  8007        move -1                  to nfstamtl
  8008        move al-unbon            to nfstamta
  8009        perform 9900-error-format
  8010                                 thru 9900-exit
  8011     end-if
  8012
  8013     if nfstamt-save = zeros
  8014        move ws-monthly-benefit to nfstamt-save
  8015     end-if
  8016
  8017     IF CL-CRITICAL-PERIOD NOT = ZEROS
  8018        move cl-critical-period  to dc-elapsed-months
  8019        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  8020        MOVE ZEROS               TO DC-ELAPSED-DAYS
  8021        MOVE '6'                 TO DC-OPTION-CODE
  8022        PERFORM 9700-DATE-LINK
  8023        MOVE DC-BIN-DATE-2       TO ws-BENEFIT-EXPIRATION-DT
  8024     END-IF
  8025
  8026     if nlstpmt-save > ws-benefit-expiration-dt
  8027        move er-1658             to emi-error
  8028        move -1                  to nlstpmtl
  8029        move al-uabon            to nlstpmta
  8030        perform 9900-error-format thru 9900-exit
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 155
* EL154.cbl
  8031     end-if
  8032
  8033     MOVE cl-control-primary     TO ELTRLR-KEY
  8034     MOVE +95                    TO TRLR-SEQ-NO
  8035
  8036* EXEC CICS READ
  8037*       DATASET  ('ELTRLR')
  8038*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8039*       RIDFLD   (ELTRLR-KEY)
  8040*       RESP     (WS-RESPONSE)
  8041*    END-EXEC
  8042     MOVE 'ELTRLR' TO DFHEIV1
  8043*    MOVE '&"S        E          (  N#00007604' TO DFHEIV0
  8044     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8046     MOVE X'204E233030303037363034' TO DFHEIV0(25:11)
  8047     CALL 'kxdfhei1' USING DFHEIV0,
  8048           DFHEIV1,
  8049           DFHEIV20,
  8050           DFHEIV99,
  8051           ELTRLR-KEY,
  8052           DFHEIV99,
  8053           DFHEIV99,
  8054           DFHEIV99
  8055     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8056         DFHEIV20
  8057     MOVE EIBRESP  TO WS-RESPONSE
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8059
  8060     if ws-resp-normal
  8061        perform varying s1 from +1 by +1 until
  8062           at-note-error-no (s1) = spaces
  8063           if at-note-error-no (s1) not = '1661' and '1662'
  8064           move at-note-error-no (s1)
  8065                                 to emi-error
  8066           if at-note-error-no (s1) = '1653'
  8067              evaluate true
  8068                 when cl-claim-type = 'L'
  8069                    move '  LF  '
  8070                                 to emi-claim-type
  8071                 when cl-claim-type = 'I'
  8072                    move '  IU  '
  8073                                 to emi-claim-type
  8074                 when other
  8075                    move '  AH  '
  8076                                 to emi-claim-type
  8077              end-evaluate
  8078           end-if
  8079           move -1               to nlstpmtl
  8080           PERFORM 9900-ERROR-FORMAT
  8081                                 THRU 9900-EXIT
  8082           end-if
  8083        end-perform
  8084     end-if
  8085
  8086     .
  8087 6300-EXIT.
  8088      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 156
* EL154.cbl
  8089 6320-read-acct.
  8090
  8091     move spaces              to WS-ACCT-RECORD-SW
  8092                                 ws-dcc-product-code
  8093
  8094     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
  8095     MOVE PI-CARRIER          TO ACCT-CARRIER
  8096     MOVE PI-GROUPING         TO ACCT-GROUPING
  8097     MOVE PI-STATE            TO ACCT-STATE
  8098     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
  8099     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
  8100     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
  8101
  8102
  8103* EXEC CICS READ
  8104*       DATASET ('ERACCT')
  8105*       RIDFLD  (ERACCT-KEY)
  8106*       SET     (ADDRESS OF ACCOUNT-MASTER)
  8107*       GTEQ
  8108*       resp    (WS-RESPONSE)
  8109*    END-EXEC
  8110     MOVE 'ERACCT' TO DFHEIV1
  8111*    MOVE '&"S        G          (  N#00007653' TO DFHEIV0
  8112     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8114     MOVE X'204E233030303037363533' TO DFHEIV0(25:11)
  8115     CALL 'kxdfhei1' USING DFHEIV0,
  8116           DFHEIV1,
  8117           DFHEIV20,
  8118           DFHEIV99,
  8119           ERACCT-KEY,
  8120           DFHEIV99,
  8121           DFHEIV99,
  8122           DFHEIV99
  8123     SET ADDRESS OF ACCOUNT-MASTER TO
  8124         DFHEIV20
  8125     MOVE EIBRESP  TO WS-RESPONSE
  8126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8127     IF WS-RESP-NORMAL
  8128        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
  8129        and pi-cert-eff-dt < am-expiration-dt
  8130        and pi-cert-eff-dt >= am-effective-dt
  8131        move am-dcc-product-code to ws-dcc-product-code
  8132        set acct-found           to true
  8133     end-if
  8134
  8135     .
  8136 6320-exit.
  8137     exit.
  8138
  8139 6340-GET-DDF-FACTORS.
  8140
  8141     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8142     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8143     MOVE pi-state               TO ERPDEF-STATE
  8144     MOVE WS-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8145     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8146     MOVE ws-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 157
* EL154.cbl
  8147     MOVE pi-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8148
  8149     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8150
  8151
  8152* EXEC CICS STARTBR
  8153*        DATASET  ('ERPDEF')
  8154*        RIDFLD   (ERPDEF-KEY)
  8155*        GTEQ
  8156*        RESP     (WS-RESPONSE)
  8157*    END-EXEC
  8158     MOVE 'ERPDEF' TO DFHEIV1
  8159     MOVE 0
  8160       TO DFHEIV11
  8161*    MOVE '&,         G          &  N#00007684' TO DFHEIV0
  8162     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8163     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8164     MOVE X'204E233030303037363834' TO DFHEIV0(25:11)
  8165     CALL 'kxdfhei1' USING DFHEIV0,
  8166           DFHEIV1,
  8167           ERPDEF-KEY,
  8168           DFHEIV99,
  8169           DFHEIV11,
  8170           DFHEIV99
  8171     MOVE EIBRESP  TO WS-RESPONSE
  8172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8173
  8174     IF NOT WS-RESP-NORMAL
  8175        GO TO 6340-EXIT
  8176     END-IF
  8177
  8178     .
  8179 6340-READNEXT.
  8180
  8181
  8182* EXEC CICS READNEXT
  8183*       DATASET  ('ERPDEF')
  8184*       SET      (ADDRESS OF PRODUCT-MASTER)
  8185*       RIDFLD   (ERPDEF-KEY)
  8186*       RESP     (WS-RESPONSE)
  8187*    END-EXEC
  8188     MOVE 'ERPDEF' TO DFHEIV1
  8189     MOVE 0
  8190       TO DFHEIV11
  8191*    MOVE '&.S                   )  N#00007698' TO DFHEIV0
  8192     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8193     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8194     MOVE X'204E233030303037363938' TO DFHEIV0(25:11)
  8195     CALL 'kxdfhei1' USING DFHEIV0,
  8196           DFHEIV1,
  8197           DFHEIV20,
  8198           DFHEIV99,
  8199           ERPDEF-KEY,
  8200           DFHEIV99,
  8201           DFHEIV11,
  8202           DFHEIV99,
  8203           DFHEIV99
  8204     SET ADDRESS OF PRODUCT-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 158
* EL154.cbl
  8205         DFHEIV20
  8206     MOVE EIBRESP  TO WS-RESPONSE
  8207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8208
  8209     IF NOT WS-RESP-NORMAL
  8210        GO TO 6340-ENDBR
  8211     END-IF
  8212
  8213     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8214        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8215           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8216        ELSE
  8217           GO TO 6340-READNEXT
  8218        END-IF
  8219     ELSE
  8220        GO TO 6340-ENDBR
  8221     END-IF
  8222
  8223     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8224        (P1 > +8)
  8225        OR (PD-PROD-CODE (P1) = cl-claim-type)
  8226     END-PERFORM
  8227     IF P1 < +9
  8228        MOVE PD-MAX-AMT (P1)     TO ws-max-benefit-amt
  8229        move pd-crit-period (p1) to ws-max-benefit-pmts
  8230     END-IF
  8231
  8232     .
  8233 6340-ENDBR.
  8234
  8235
  8236* EXEC CICS ENDBR
  8237*       DATASET  ('ERPDEF')
  8238*    END-EXEC
  8239     MOVE 'ERPDEF' TO DFHEIV1
  8240     MOVE 0
  8241       TO DFHEIV11
  8242*    MOVE '&2                    $   #00007731' TO DFHEIV0
  8243     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8245     MOVE X'2020233030303037373331' TO DFHEIV0(25:11)
  8246     CALL 'kxdfhei1' USING DFHEIV0,
  8247           DFHEIV1,
  8248           DFHEIV11,
  8249           DFHEIV99
  8250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8251
  8252     .
  8253 6340-EXIT.
  8254     EXIT.
  8255
  8256 6350-get-cert-trlr.
  8257
  8258     move spaces                 to ws-cert-trlr-sw
  8259     move zeros                  to ws-benefits-prev-paid
  8260     move cl-cert-key-data       to elcrtt-key (2:21)
  8261     move cl-company-cd          to ctrlr-comp-cd
  8262     move cl-cert-no             to ctrlr-cert-no
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 159
* EL154.cbl
  8263     move 'B'                    to ctrlr-rec-type
  8264
  8265
  8266* EXEC CICS READ
  8267*       DATASET  ('ELCRTT')
  8268*       set      (address of CERTIFICATE-TRAILERS)
  8269*       RIDFLD   (ELCRTT-KEY)
  8270*       RESP     (WS-RESPONSE)
  8271*    END-EXEC
  8272     MOVE 'ELCRTT' TO DFHEIV1
  8273*    MOVE '&"S        E          (  N#00007748' TO DFHEIV0
  8274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8276     MOVE X'204E233030303037373438' TO DFHEIV0(25:11)
  8277     CALL 'kxdfhei1' USING DFHEIV0,
  8278           DFHEIV1,
  8279           DFHEIV20,
  8280           DFHEIV99,
  8281           ELCRTT-KEY,
  8282           DFHEIV99,
  8283           DFHEIV99,
  8284           DFHEIV99
  8285     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8286         DFHEIV20
  8287     MOVE EIBRESP  TO WS-RESPONSE
  8288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8289     IF not WS-RESP-NORMAL
  8290        go to 6350-exit
  8291     end-if
  8292
  8293     set cert-trlr-found         to true
  8294*    if cl-insured-claim = 'P'
  8295*       move +1 to s1
  8296*    else
  8297*       MOVE +2 to s1
  8298*    end-if
  8299
  8300     move +1 to s1
  8301     evaluate cl-claim-type
  8302        when 'A'
  8303           move +1 to s2
  8304        when 'I'
  8305           move +2 to s2
  8306        when 'G'
  8307           move +3 to s2
  8308        when 'L'
  8309           move +4 to s2
  8310        when 'P'
  8311           move +5 to s2
  8312     end-evaluate
  8313
  8314     compute ws-benefits-prev-paid =
  8315        (cs-total-paid (s1 s2) / ws-monthly-benefit)
  8316
  8317     .
  8318 6350-exit.
  8319     exit.
  8320 6400-PAYMENT-CALCULATION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 160
* EL154.cbl
  8321
  8322     IF WS-CALC-METHOD = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  8323         IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  8324             COMPUTE NREGPMT-SAVE ROUNDED =
  8325                 (PM-INS-MONTH-BENEFIT * NMONTHSI)
  8326             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8327             GO TO 6499-EXIT
  8328         ELSE
  8329             COMPUTE NREGPMT-SAVE ROUNDED =
  8330                 (ws-monthly-benefit * NMONTHSI)
  8331             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8332             GO TO 6499-EXIT.
  8333
  8334     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8335     MOVE +0                     TO DC-ELAPSED-DAYS.
  8336     MOVE NMONTHSI               TO DC-ELAPSED-MONTHS.
  8337     MOVE '6'                    TO DC-OPTION-CODE.
  8338     PERFORM 9700-DATE-LINK.
  8339
  8340     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8341     MOVE '1'                    TO DC-OPTION-CODE.
  8342     PERFORM 9700-DATE-LINK.
  8343
  8344     IF (PI-COMPANY-ID  = 'FIA' AND
  8345        CL-CERT-ACCOUNT = '0000011043')
  8346        COMPUTE WS-DAILY-RATE ROUNDED =
  8347                             (CM-AH-BENEFIT-AMT * 13) / 365
  8348        COMPUTE NREGPMT-SAVE ROUNDED =
  8349                             WS-DAILY-RATE * DC-ELAPSED-DAYS
  8350        MOVE NREGPMT-SAVE  TO  NREGAMTO
  8351        GO TO 6499-EXIT.
  8352
  8353*    IF WS-CALC-METHOD = '4'
  8354*       COMPUTE WS-DAILY-RATE ROUNDED =
  8355*                            (CM-AH-BENEFIT-AMT / 30)
  8356*       COMPUTE NREGPMT-SAVE ROUNDED =
  8357*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8358*
  8359*    IF WS-CALC-METHOD = '5'
  8360*       COMPUTE WS-DAILY-RATE ROUNDED =
  8361*                            (CM-AH-BENEFIT-AMT * 12) / 365
  8362*       COMPUTE NREGPMT-SAVE ROUNDED =
  8363*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8364
  8365 6499-EXIT.
  8366      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 161
* EL154.cbl
  8368 6900-SET-CODES.
  8369     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  8370                                    ACTV-CLAIM.
  8371
  8372     MOVE PI-COMPANY-ID          TO CNTL-CO.
  8373
  8374     MOVE PI-COMPANY-CD          TO CLAM-CO
  8375                                    ACTV-CO
  8376                                    CERT-CO
  8377                                    EMPLCY-COMPANY-CD.
  8378
  8379     MOVE PI-CARRIER             TO CLAM-CARRIER
  8380                                    ACTV-CARRIER
  8381                                    CERT-CARRIER
  8382                                    EMPLCY-CARRIER.
  8383
  8384     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  8385                                    ACTV-CERT-NUM
  8386                                    CERT-CERT-NUM.
  8387
  8388     MOVE PI-GROUPING            TO CERT-GROUPING
  8389                                    EMPLCY-GROUPING.
  8390     MOVE PI-STATE               TO CERT-STATE
  8391                                    EMPLCY-STATE.
  8392     MOVE PI-ACCOUNT             TO CERT-ACCOUNT
  8393                                    EMPLCY-PRODUCER.
  8394     MOVE PI-CERT-EFF-DT         TO CERT-EFF-DT
  8395                                    EMPLCY-EFF-DT.
  8396     MOVE '2'                    TO CNTL-RECORD-TYPE.
  8397     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
  8398     MOVE ZEROS                  TO CNTL-SEQ.
  8399
  8400 6999-EXIT.
  8401      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 162
* EL154.cbl
  8403 7000-BUILD-SCREEN.
  8404     PERFORM 6900-SET-CODES.
  8405
  8406
  8407* EXEC CICS HANDLE CONDITION
  8408*         NOTOPEN(8860-CLAM-NOT-OPEN)
  8409*         NOTFND (7090-CLAIM-NOT-FOUND)
  8410*         END-EXEC.
  8411*    MOVE '"$JI                  ! - #00007871' TO DFHEIV0
  8412     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8414     MOVE X'2D20233030303037383731' TO DFHEIV0(25:11)
  8415     CALL 'kxdfhei1' USING DFHEIV0
  8416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8417
  8418
  8419
  8420* EXEC CICS READ
  8421*         DATASET(CLAM-ID)
  8422*         SET    (ADDRESS OF CLAIM-MASTER)
  8423*         RIDFLD (CLAM-KEY)
  8424*         END-EXEC.
  8425*    MOVE '&"S        E          (   #00007876' TO DFHEIV0
  8426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8428     MOVE X'2020233030303037383736' TO DFHEIV0(25:11)
  8429     CALL 'kxdfhei1' USING DFHEIV0,
  8430           CLAM-ID,
  8431           DFHEIV20,
  8432           DFHEIV99,
  8433           CLAM-KEY,
  8434           DFHEIV99,
  8435           DFHEIV99,
  8436           DFHEIV99
  8437     SET ADDRESS OF CLAIM-MASTER TO
  8438         DFHEIV20
  8439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8440
  8441
  8442     MOVE CL-CLAIM-NO            TO CLAIMO
  8443     MOVE CL-CERT-PRIME          TO CERTO
  8444     MOVE CL-CERT-SFX            TO SUFFIXO
  8445     MOVE CL-CARRIER             TO CARRO
  8446     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  8447
  8448     IF ACTV-SEQ = ZEROS
  8449        GO TO 7080-NO-TRAILER.
  8450
  8451
  8452* EXEC CICS HANDLE CONDITION
  8453*         NOTOPEN(8870-ACTV-NOT-OPEN)
  8454*         NOTFND (7080-NO-TRAILER)
  8455*         END-EXEC.
  8456*    MOVE '"$JI                  ! . #00007891' TO DFHEIV0
  8457     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8459     MOVE X'2E20233030303037383931' TO DFHEIV0(25:11)
  8460     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 163
* EL154.cbl
  8461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8462
  8463
  8464
  8465* EXEC CICS READ
  8466*         DATASET(ACTV-ID)
  8467*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  8468*         RIDFLD (ACTV-KEY)
  8469*    END-EXEC.
  8470*    MOVE '&"S        E          (   #00007896' TO DFHEIV0
  8471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8473     MOVE X'2020233030303037383936' TO DFHEIV0(25:11)
  8474     CALL 'kxdfhei1' USING DFHEIV0,
  8475           ACTV-ID,
  8476           DFHEIV20,
  8477           DFHEIV99,
  8478           ACTV-KEY,
  8479           DFHEIV99,
  8480           DFHEIV99,
  8481           DFHEIV99
  8482     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8483         DFHEIV20
  8484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8485
  8486
  8487     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
  8488     MOVE SPACE                  TO DC-OPTION-CODE.
  8489     PERFORM 9700-DATE-LINK.
  8490     MOVE DC-GREG-DATE-1-EDIT    TO CESTDTEI.
  8491
  8492
  8493     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
  8494     MOVE SPACE                  TO DC-OPTION-CODE.
  8495     PERFORM 9700-DATE-LINK.
  8496     MOVE DC-GREG-DATE-1-EDIT    TO CEFFDTEI.
  8497
  8498     IF AT-AUTO-PAY-DAY NUMERIC
  8499         MOVE AT-AUTO-PAY-DAY    TO DAY2PAYI
  8500     ELSE
  8501         MOVE ZEROS              TO DAY2PAYI.
  8502
  8503     IF PI-USES-PAID-TO
  8504         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8505         MOVE '6'                     TO  DC-OPTION-CODE
  8506         MOVE +1                      TO  DC-ELAPSED-DAYS
  8507         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8508         PERFORM 9700-DATE-LINK
  8509         IF NO-CONVERSION-ERROR
  8510             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
  8511         ELSE
  8512             MOVE LOW-VALUES          TO  CFSTPMTI
  8513     ELSE
  8514         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8515         MOVE SPACE                   TO  DC-OPTION-CODE
  8516         PERFORM 9700-DATE-LINK
  8517         IF NO-CONVERSION-ERROR
  8518             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 164
* EL154.cbl
  8519         ELSE
  8520             MOVE LOW-VALUES          TO  CFSTPMTI.
  8521
  8522     IF PI-USES-PAID-TO
  8523         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8524         MOVE '6'                     TO  DC-OPTION-CODE
  8525         MOVE +1                      TO  DC-ELAPSED-DAYS
  8526         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8527         PERFORM 9700-DATE-LINK
  8528         IF NO-CONVERSION-ERROR
  8529             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8530         ELSE
  8531             MOVE LOW-VALUES          TO  CLSTPMTI
  8532     ELSE
  8533         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8534         MOVE SPACE                   TO  DC-OPTION-CODE
  8535         MOVE +0                      TO  DC-ELAPSED-DAYS
  8536                                          DC-ELAPSED-MONTHS
  8537         PERFORM 9700-DATE-LINK
  8538         IF NO-CONVERSION-ERROR
  8539             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8540         ELSE
  8541             MOVE LOW-VALUES          TO  CLSTPMTI.
  8542
  8543     MOVE AT-FIRST-PMT-AMT       TO CFSTAMTO.
  8544     MOVE AT-DAYS-IN-1ST-PMT     TO CDAYSFO.
  8545
  8546     IF AT-LAST-PMT-TYPE = 'F'
  8547        MOVE 'Y'                 TO CLASTO
  8548     ELSE
  8549        MOVE 'N'                 TO CLASTO.
  8550
  8551     MOVE AT-RECORDED-BY         TO CESTBYO.
  8552     MOVE AT-REGULAR-PMT-AMT     TO CREGPMTO.
  8553     MOVE AT-AUTO-CASH           TO CINDCTRO.
  8554
  8555     MOVE AT-AUTO-END-LETTER     TO PRINTI
  8556                                    PI-AUTO-END-LETTER.
  8557
  8558     IF AT-AUTO-PAYEE-TYPE EQUAL 'I'
  8559        MOVE 'INSURED'           TO CPAYEEO
  8560     ELSE
  8561     IF AT-AUTO-PAYEE-TYPE EQUAL 'B'
  8562        MOVE 'BENEFIC'           TO CPAYEEO
  8563     ELSE
  8564     IF AT-AUTO-PAYEE-TYPE EQUAL 'A'
  8565        MOVE 'ACCOUNT'           TO CPAYEEO.
  8566
  8567     MOVE AT-INTERVAL-MONTHS     TO CMONTHSO.
  8568     MOVE -1                     TO TERML.
  8569     GO TO 8100-SEND-INITIAL-MAP.
  8570
  8571 7080-NO-TRAILER.
  8572     MOVE 'A'                    TO TERMI.
  8573     MOVE AL-PADON               TO TERMA
  8574                                    PRINTA.
  8575     MOVE -1                     TO NFSTPMTL.
  8576     MOVE ER-0346                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 165
* EL154.cbl
  8577     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8578     GO TO 8100-SEND-INITIAL-MAP.
  8579
  8580 7090-CLAIM-NOT-FOUND.
  8581     MOVE ER-0186                TO EMI-ERROR.
  8582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8583     GO TO 8100-SEND-INITIAL-MAP.
  8584
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 166
* EL154.cbl
  8586 7100-CHECK-AUTO-ACTIVITY.
  8587
  8588
  8589* EXEC CICS HANDLE CONDITION
  8590*        NOTFND   (7100-NOT-FOUND)
  8591*    END-EXEC.
  8592*    MOVE '"$I                   ! / #00008003' TO DFHEIV0
  8593     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8595     MOVE X'2F20233030303038303033' TO DFHEIV0(25:11)
  8596     CALL 'kxdfhei1' USING DFHEIV0
  8597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8598
  8599
  8600     MOVE PI-COMPANY-ID          TO  CNTL-CO.
  8601     MOVE 'T'                    TO  CNTL-RECORD-TYPE.
  8602     MOVE SPACES                 TO  CNTL-GENL.
  8603     MOVE +0                     TO  CNTL-SEQ.
  8604
  8605
  8606* EXEC CICS READ
  8607*        DATASET   (CNTL-ID)
  8608*        RIDFLD    (CNTL-KEY)
  8609*        SET       (ADDRESS OF CONTROL-FILE)
  8610*    END-EXEC.
  8611*    MOVE '&"S        E          (   #00008012' TO DFHEIV0
  8612     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8614     MOVE X'2020233030303038303132' TO DFHEIV0(25:11)
  8615     CALL 'kxdfhei1' USING DFHEIV0,
  8616           CNTL-ID,
  8617           DFHEIV20,
  8618           DFHEIV99,
  8619           CNTL-KEY,
  8620           DFHEIV99,
  8621           DFHEIV99,
  8622           DFHEIV99
  8623     SET ADDRESS OF CONTROL-FILE TO
  8624         DFHEIV20
  8625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8626
  8627
  8628     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
  8629
  8630 7100-CHECK-SYSTEM-ACTIVITY.
  8631
  8632     IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  8633         MOVE CL-ACTIVITY-CODE             TO  SUB-1
  8634         IF SUB-1 IS GREATER THAN +9
  8635             SUBTRACT +9 FROM SUB-1
  8636             MOVE CF-USER-RESET-SW (SUB-1) TO  WS-RESET-SW
  8637         ELSE
  8638             MOVE CF-SYS-RESET-SW  (SUB-1) TO  WS-RESET-SW
  8639     ELSE
  8640         MOVE 'Y'                          TO  WS-RESET-SW.
  8641
  8642     IF TERMI IS EQUAL TO 'A'
  8643         IF (CF-SYS-ACTIVE-SW (5) IS EQUAL TO 'N' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 167
* EL154.cbl
  8644             MOVE 'N'                TO  WS-LETTER-SW
  8645                                         WS-RESET-SW
  8646             GO TO 7100-EXIT.
  8647
  8648     IF TERMI IS EQUAL TO 'A'
  8649         IF (CF-SYS-LETTER-ID (5) EQUAL SPACES OR LOW-VALUES)
  8650             MOVE 'N'                TO  WS-LETTER-SW
  8651         ELSE
  8652             MOVE 'Y'                TO  WS-LETTER-SW.
  8653
  8654     IF TERMI IS EQUAL TO 'Y'
  8655         IF (CF-SYS-ACTIVE-SW (6) IS EQUAL TO 'N' OR ' ')
  8656             MOVE 'N'                TO  WS-LETTER-SW
  8657                                         WS-RESET-SW
  8658             GO TO 7100-EXIT.
  8659
  8660     IF TERMI IS EQUAL TO 'Y'
  8661         IF (CF-SYS-LETTER-ID (6) EQUAL SPACES OR LOW-VALUES)
  8662             MOVE 'N'                TO  WS-LETTER-SW
  8663         ELSE
  8664             MOVE 'Y'                TO  WS-LETTER-SW.
  8665
  8666     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  8667         GO TO 7100-EXIT.
  8668
  8669     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  8670        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  8671         GO TO 7100-EXIT.
  8672
  8673     IF WS-RESET-SW IS EQUAL TO 'N'
  8674         GO TO 7100-EXIT.
  8675
  8676     MOVE CURRENT-BIN-DATE           TO  CL-ACTIVITY-MAINT-DT.
  8677
  8678     IF TERMI IS EQUAL TO 'A'
  8679         MOVE 05                     TO  CL-ACTIVITY-CODE
  8680         MOVE 'AUTO'                 TO  CL-ACTIVITY-MAINT-TYPE
  8681     ELSE
  8682         MOVE 06                     TO  CL-ACTIVITY-CODE
  8683         MOVE 'TERM'                 TO  CL-ACTIVITY-MAINT-TYPE.
  8684
  8685     GO TO 7100-EXIT.
  8686
  8687 7100-NOT-FOUND.
  8688
  8689     MOVE 'N'                        TO  WS-ACT-REC-FOUND-SW
  8690                                         WS-LETTER-SW.
  8691
  8692 7100-EXIT.
  8693     EXIT.
  8694
  8695 7150-CREATE-AUTO-LETTER.
  8696
  8697     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
  8698     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
  8699
  8700     IF TERMI IS EQUAL TO 'A'
  8701         IF WS-LETTER-FORM-NUM > SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 168
* EL154.cbl
  8702            MOVE WS-LETTER-FORM-NUM     TO  W-1523-FORM-NUMBER
  8703         ELSE
  8704         MOVE CF-SYS-LETTER-ID (5)   TO  W-1523-FORM-NUMBER
  8705         END-IF
  8706     ELSE
  8707         IF WS-END-LETTER-FORM-NUM > SPACES
  8708             MOVE WS-END-LETTER-FORM-NUM TO W-1523-FORM-NUMBER
  8709         ELSE
  8710         MOVE CF-SYS-LETTER-ID (6)   TO  W-1523-FORM-NUMBER.
  8711
  8712     IF TERMI IS EQUAL TO 'A'
  8713       IF CF-SYS-RESEND-DAYS (5) IS NOT EQUAL TO ZEROS
  8714         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8715         MOVE '6'                    TO  DC-OPTION-CODE
  8716         MOVE CF-SYS-RESEND-DAYS (5) TO  DC-ELAPSED-DAYS
  8717         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8718         PERFORM 9700-DATE-LINK
  8719         IF NO-CONVERSION-ERROR
  8720             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8721         ELSE
  8722             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8723
  8724
  8725     IF TERMI IS EQUAL TO 'A'
  8726       IF CF-SYS-FOLLOW-UP-DAYS (5) IS NOT EQUAL TO ZEROS
  8727         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8728         MOVE '6'                    TO  DC-OPTION-CODE
  8729         MOVE CF-SYS-FOLLOW-UP-DAYS (5)  TO  DC-ELAPSED-DAYS
  8730         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8731         PERFORM 9700-DATE-LINK
  8732         IF NO-CONVERSION-ERROR
  8733             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8734         ELSE
  8735             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8736
  8737     IF TERMI IS EQUAL TO 'Y'
  8738       IF CF-SYS-RESEND-DAYS (6) IS NOT EQUAL TO ZEROS
  8739         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8740         MOVE '6'                    TO  DC-OPTION-CODE
  8741         MOVE CF-SYS-RESEND-DAYS (6) TO  DC-ELAPSED-DAYS
  8742         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8743         PERFORM 9700-DATE-LINK
  8744         IF NO-CONVERSION-ERROR
  8745             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8746         ELSE
  8747             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8748
  8749
  8750     IF TERMI IS EQUAL TO 'Y'
  8751       IF CF-SYS-FOLLOW-UP-DAYS (6) IS NOT EQUAL TO ZEROS
  8752         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8753         MOVE '6'                    TO  DC-OPTION-CODE
  8754         MOVE CF-SYS-FOLLOW-UP-DAYS (6)  TO  DC-ELAPSED-DAYS
  8755         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8756         PERFORM 9700-DATE-LINK
  8757         IF NO-CONVERSION-ERROR
  8758             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8759         ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 169
* EL154.cbl
  8760             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8761
  8762     MOVE LETTDTE-SAVE               TO W-1523-LETTER-DATE.
  8763
  8764
  8765* EXEC CICS LINK
  8766*        PROGRAM    (LINK-1523)
  8767*        COMMAREA   (W-1523-LINKDATA)
  8768*        LENGTH     (W-1523-COMM-LENGTH)
  8769*    END-EXEC.
  8770*    MOVE '."C                   (   #00008154' TO DFHEIV0
  8771     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8773     MOVE X'2020233030303038313534' TO DFHEIV0(25:11)
  8774     CALL 'kxdfhei1' USING DFHEIV0,
  8775           LINK-1523,
  8776           W-1523-LINKDATA,
  8777           W-1523-COMM-LENGTH,
  8778           DFHEIV99,
  8779           DFHEIV99,
  8780           DFHEIV99,
  8781           DFHEIV99
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8783
  8784
  8785     IF W-1523-ERROR-CODE IS EQUAL TO ZEROS
  8786         GO TO 7150-EXIT.
  8787
  8788     IF W-1523-FATAL-ERROR
  8789         MOVE ER-0802                TO  EMI-ERROR
  8790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8791         GO TO 7150-EXIT.
  8792
  8793     IF W-1523-ERROR-CODE IS EQUAL TO 0191
  8794         MOVE ER-0803                TO  EMI-ERROR
  8795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8796
  8797 7150-EXIT.
  8798     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 170
* EL154.cbl
  8800 7200-LOCATE-BENEFIT.
  8801     MOVE SPACES TO WS-BENEFIT-FOUND-SW.
  8802
  8803
  8804* EXEC CICS HANDLE CONDITION
  8805*        ENDFILE(7200-EXIT)
  8806*        NOTFND(7200-EXIT)
  8807*        END-EXEC.
  8808*    MOVE '"$''I                  ! 0 #00008178' TO DFHEIV0
  8809     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8811     MOVE X'3020233030303038313738' TO DFHEIV0(25:11)
  8812     CALL 'kxdfhei1' USING DFHEIV0
  8813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8814
  8815
  8816
  8817* EXEC CICS READ
  8818*        DATASET(CNTL-ID)
  8819*        SET(ADDRESS OF CONTROL-FILE)
  8820*        RIDFLD(CNTL-KEY)
  8821*        GTEQ
  8822*        END-EXEC.
  8823*    MOVE '&"S        G          (   #00008183' TO DFHEIV0
  8824     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8825     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8826     MOVE X'2020233030303038313833' TO DFHEIV0(25:11)
  8827     CALL 'kxdfhei1' USING DFHEIV0,
  8828           CNTL-ID,
  8829           DFHEIV20,
  8830           DFHEIV99,
  8831           CNTL-KEY,
  8832           DFHEIV99,
  8833           DFHEIV99,
  8834           DFHEIV99
  8835     SET ADDRESS OF CONTROL-FILE TO
  8836         DFHEIV20
  8837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8838
  8839
  8840     IF (CNTL-CO NOT = CF-COMPANY-ID)   OR
  8841        (CNTL-RECORD-TYPE NOT = CF-RECORD-TYPE)
  8842           GO TO 7200-EXIT.
  8843
  8844     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  8845         VARYING SUB-1 FROM 1 BY 1 UNTIL
  8846            ((SUB-1 GREATER 8) OR
  8847            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  8848
  8849     IF SUB-1 NOT = 9
  8850         MOVE 'Y' TO WS-BENEFIT-FOUND-SW.
  8851
  8852     GO TO 7200-EXIT.
  8853
  8854 7200-BENEFIT-DUMMY.
  8855
  8856 7200-DUMMY-EXIT.
  8857     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 171
* EL154.cbl
  8858
  8859 7200-EXIT.
  8860     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 172
* EL154.cbl
  8862 8100-SEND-INITIAL-MAP.
  8863     MOVE CURRENT-GREG-DATE      TO RUNDTEO.
  8864     MOVE EIBTIME                TO TIME-IN.
  8865     MOVE TIME-OUT               TO RUNTIMEO.
  8866     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8867     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8868
  8869     IF PI-USES-PAID-TO
  8870         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  8871                                     FSTHD2O
  8872         MOVE LAST-PMT-HD2       TO  LSTHD1O
  8873         MOVE LAST-PMT-HD4       TO  LSTHD2O
  8874     ELSE
  8875         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  8876                                     FSTHD2O
  8877         MOVE LAST-PMT-HD1       TO  LSTHD1O
  8878         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  8879
  8880
  8881* EXEC CICS SEND
  8882*        MAP(MAP-NAME)
  8883*        MAPSET(MAPSET-NAME)
  8884*        FROM(EL154AO)
  8885*        ERASE
  8886*        CURSOR
  8887*        END-EXEC.
  8888     MOVE LENGTH OF
  8889      EL154AO
  8890       TO DFHEIV12
  8891     MOVE -1
  8892       TO DFHEIV11
  8893*    MOVE '8$     CT  E    H L F ,   #00008230' TO DFHEIV0
  8894     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8895     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8896     MOVE X'2020233030303038323330' TO DFHEIV0(25:11)
  8897     CALL 'kxdfhei1' USING DFHEIV0,
  8898           MAP-NAME,
  8899           EL154AO,
  8900           DFHEIV12,
  8901           MAPSET-NAME,
  8902           DFHEIV99,
  8903           DFHEIV99,
  8904           DFHEIV99,
  8905           DFHEIV11,
  8906           DFHEIV99,
  8907           DFHEIV99,
  8908           DFHEIV99
  8909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8910
  8911
  8912     MOVE 'EL154   ' TO PI-CALLING-PROGRAM.
  8913     GO TO 9100-RETURN-TRAN.
  8914
  8915 8200-SEND-DATAONLY.
  8916     MOVE CURRENT-GREG-DATE TO RUNDTEO.
  8917     MOVE EIBTIME           TO TIME-IN.
  8918     MOVE TIME-OUT          TO RUNTIMEO.
  8919     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 173
* EL154.cbl
  8920     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8921
  8922     IF PI-USES-PAID-TO
  8923         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  8924                                     FSTHD2O
  8925         MOVE LAST-PMT-HD2       TO  LSTHD1O
  8926         MOVE LAST-PMT-HD4       TO  LSTHD2O
  8927     ELSE
  8928         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  8929                                     FSTHD2O
  8930         MOVE LAST-PMT-HD1       TO  LSTHD1O
  8931         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  8932
  8933
  8934* EXEC CICS SEND
  8935*        MAP(MAP-NAME)
  8936*        MAPSET(MAPSET-NAME)
  8937*        FROM(EL154AO)
  8938*        DATAONLY
  8939*        ERASEAUP
  8940*        CURSOR
  8941*        END-EXEC.
  8942     MOVE LENGTH OF
  8943      EL154AO
  8944       TO DFHEIV12
  8945     MOVE -1
  8946       TO DFHEIV11
  8947*    MOVE '8$D    CT  A    H L F ,   #00008259' TO DFHEIV0
  8948     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8949     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8950     MOVE X'2020233030303038323539' TO DFHEIV0(25:11)
  8951     CALL 'kxdfhei1' USING DFHEIV0,
  8952           MAP-NAME,
  8953           EL154AO,
  8954           DFHEIV12,
  8955           MAPSET-NAME,
  8956           DFHEIV99,
  8957           DFHEIV99,
  8958           DFHEIV99,
  8959           DFHEIV11,
  8960           DFHEIV99,
  8961           DFHEIV99,
  8962           DFHEIV99
  8963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8964
  8965
  8966     GO TO 9100-RETURN-TRAN.
  8967
  8968 8300-SEND-TEXT.
  8969
  8970* EXEC CICS SEND TEXT
  8971*        FROM(LOGOFF-TEXT)
  8972*        LENGTH(LOGOFF-LENGTH)
  8973*        ERASE
  8974*        FREEKB
  8975*        END-EXEC.
  8976*    MOVE '8&      T  E F  H   F -   #00008271' TO DFHEIV0
  8977     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 174
* EL154.cbl
  8978     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8979     MOVE X'2020233030303038323731' TO DFHEIV0(25:11)
  8980     CALL 'kxdfhei1' USING DFHEIV0,
  8981           LOGOFF-TEXT,
  8982           LOGOFF-LENGTH,
  8983           DFHEIV99,
  8984           DFHEIV99,
  8985           DFHEIV99,
  8986           DFHEIV99,
  8987           DFHEIV99,
  8988           DFHEIV99,
  8989           DFHEIV99,
  8990           DFHEIV99,
  8991           DFHEIV99,
  8992           DFHEIV99
  8993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8994
  8995
  8996
  8997* EXEC CICS RETURN
  8998*        END-EXEC.
  8999*    MOVE '.(                    ''   #00008278' TO DFHEIV0
  9000     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9001     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9002     MOVE X'2020233030303038323738' TO DFHEIV0(25:11)
  9003     CALL 'kxdfhei1' USING DFHEIV0,
  9004           DFHEIV99,
  9005           DFHEIV99,
  9006           DFHEIV99,
  9007           DFHEIV99,
  9008           DFHEIV99,
  9009           DFHEIV99
  9010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9011
  9012
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 175
* EL154.cbl
  9014 8600-DEEDIT.
  9015
  9016* EXEC CICS BIF DEEDIT
  9017*         FIELD(DEEDIT-FIELD)
  9018*         LENGTH(15)
  9019*         END-EXEC.
  9020     MOVE 15
  9021       TO DFHEIV11
  9022*    MOVE '@"L                   #   #00008283' TO DFHEIV0
  9023     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9024     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9025     MOVE X'2020233030303038323833' TO DFHEIV0(25:11)
  9026     CALL 'kxdfhei1' USING DFHEIV0,
  9027           DEEDIT-FIELD,
  9028           DFHEIV11
  9029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9030
  9031
  9032 8800-UNAUTHORIZED-ACCESS.
  9033     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  9034     GO TO 8300-SEND-TEXT.
  9035
  9036 8810-PF23.
  9037     MOVE EIBAID TO PI-ENTRY-CD-1.
  9038     MOVE XCTL-005 TO PGM-NAME.
  9039     GO TO 9300-XCTL.
  9040
  9041
  9042 8850-CLAM-END-FILE.
  9043     MOVE -1                     TO  ENTERPFL.
  9044     MOVE ER-0130 TO EMI-ERROR.
  9045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9046     GO TO 8200-SEND-DATAONLY.
  9047
  9048 8860-CLAM-NOT-OPEN.
  9049     MOVE -1                     TO  ENTERPFL.
  9050     MOVE ER-0154 TO EMI-ERROR.
  9051     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9052     GO TO 8200-SEND-DATAONLY.
  9053
  9054 8870-ACTV-NOT-OPEN.
  9055     MOVE -1                     TO  ENTERPFL.
  9056     MOVE ER-0172 TO EMI-ERROR.
  9057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9058     GO TO 8200-SEND-DATAONLY.
  9059
  9060 8880-CERT-NOT-OPEN.
  9061     MOVE -1                     TO  ENTERPFL.
  9062     MOVE ER-0169                TO EMI-ERROR.
  9063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9064     GO TO 8200-SEND-DATAONLY.
  9065
  9066 8885-EMPLCY-NOT-OPEN.
  9067     MOVE -1                     TO  ENTERPFL.
  9068     MOVE ER-9883                TO  EMI-ERROR.
  9069     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9070     GO TO 8200-SEND-DATAONLY.
  9071
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 176
* EL154.cbl
  9072 8890-CNTL-NOT-OPEN.
  9073     MOVE -1                     TO  ENTERPFL.
  9074     MOVE ER-0042                TO EMI-ERROR.
  9075     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9076     GO TO 8200-SEND-DATAONLY.
  9077
  9078 9000-RETURN-CICS.
  9079
  9080* EXEC CICS RETURN
  9081*        END-EXEC.
  9082*    MOVE '.(                    ''   #00008335' TO DFHEIV0
  9083     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9084     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9085     MOVE X'2020233030303038333335' TO DFHEIV0(25:11)
  9086     CALL 'kxdfhei1' USING DFHEIV0,
  9087           DFHEIV99,
  9088           DFHEIV99,
  9089           DFHEIV99,
  9090           DFHEIV99,
  9091           DFHEIV99,
  9092           DFHEIV99
  9093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9094
  9095
  9096 9100-RETURN-TRAN.
  9097     MOVE    EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  9098     MOVE '154A' TO PI-CURRENT-SCREEN-NO.
  9099
  9100* EXEC CICS RETURN
  9101*        TRANSID(TRANS-ID)
  9102*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9103*        LENGTH(PI-COMM-LENGTH)
  9104*        END-EXEC.
  9105*    MOVE '.(CT                  ''   #00008341' TO DFHEIV0
  9106     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9107     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9108     MOVE X'2020233030303038333431' TO DFHEIV0(25:11)
  9109     CALL 'kxdfhei1' USING DFHEIV0,
  9110           TRANS-ID,
  9111           PROGRAM-INTERFACE-BLOCK,
  9112           PI-COMM-LENGTH,
  9113           DFHEIV99,
  9114           DFHEIV99,
  9115           DFHEIV99
  9116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9117
  9118
  9119 9200-RETURN-MAIN-MENU.
  9120     MOVE XCTL-126 TO PGM-NAME.
  9121     GO TO 9300-XCTL.
  9122
  9123 9300-XCTL.
  9124
  9125* EXEC CICS XCTL
  9126*        PROGRAM(PGM-NAME)
  9127*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9128*        LENGTH(PI-COMM-LENGTH)
  9129*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 177
* EL154.cbl
  9130*    MOVE '.$C                   %   #00008352' TO DFHEIV0
  9131     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9132     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9133     MOVE X'2020233030303038333532' TO DFHEIV0(25:11)
  9134     CALL 'kxdfhei1' USING DFHEIV0,
  9135           PGM-NAME,
  9136           PROGRAM-INTERFACE-BLOCK,
  9137           PI-COMM-LENGTH,
  9138           DFHEIV99
  9139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9140
  9141
  9142 9400-CLEAR.
  9143     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  9144     GO TO 9300-XCTL.
  9145
  9146 9500-PF12.
  9147     MOVE XCTL-010 TO PGM-NAME.
  9148     GO TO 9300-XCTL.
  9149
  9150 9600-PGMID-ERROR.
  9151
  9152* EXEC CICS HANDLE CONDITION
  9153*        PGMIDERR(8300-SEND-TEXT)
  9154*        END-EXEC.
  9155*    MOVE '"$L                   ! 1 #00008367' TO DFHEIV0
  9156     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9158     MOVE X'3120233030303038333637' TO DFHEIV0(25:11)
  9159     CALL 'kxdfhei1' USING DFHEIV0
  9160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9161
  9162
  9163     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  9164     MOVE ' '          TO PI-ENTRY-CD-1.
  9165     MOVE XCTL-005     TO PGM-NAME.
  9166     MOVE PGM-NAME     TO LOGOFF-PGM.
  9167     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  9168     GO TO 9300-XCTL.
  9169
  9170 9700-DATE-LINK.
  9171     MOVE LINK-ELDATCV TO PGM-NAME
  9172
  9173* EXEC CICS LINK
  9174*        PROGRAM    (PGM-NAME)
  9175*        COMMAREA   (DATE-CONVERSION-DATA)
  9176*        LENGTH     (DC-COMM-LENGTH)
  9177*        END-EXEC.
  9178*    MOVE '."C                   (   #00008380' TO DFHEIV0
  9179     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9181     MOVE X'2020233030303038333830' TO DFHEIV0(25:11)
  9182     CALL 'kxdfhei1' USING DFHEIV0,
  9183           PGM-NAME,
  9184           DATE-CONVERSION-DATA,
  9185           DC-COMM-LENGTH,
  9186           DFHEIV99,
  9187           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 178
* EL154.cbl
  9188           DFHEIV99,
  9189           DFHEIV99
  9190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9191
  9192
  9193 9900-ERROR-FORMAT.
  9194     IF NOT EMI-ERRORS-COMPLETE
  9195         MOVE LINK-001 TO PGM-NAME
  9196
  9197* EXEC CICS LINK
  9198*            PROGRAM(PGM-NAME)
  9199*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  9200*            LENGTH(EMI-COMM-LENGTH)
  9201*            END-EXEC.
  9202*    MOVE '."C                   (   #00008389' TO DFHEIV0
  9203     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9204     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9205     MOVE X'2020233030303038333839' TO DFHEIV0(25:11)
  9206     CALL 'kxdfhei1' USING DFHEIV0,
  9207           PGM-NAME,
  9208           ERROR-MESSAGE-INTERFACE-BLOCK,
  9209           EMI-COMM-LENGTH,
  9210           DFHEIV99,
  9211           DFHEIV99,
  9212           DFHEIV99,
  9213           DFHEIV99
  9214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9215
  9216
  9217 9900-EXIT.
  9218     EXIT.
  9219
  9220 9990-ABEND.
  9221     MOVE LINK-004 TO PGM-NAME.
  9222     MOVE DFHEIBLK TO EMI-LINE1.
  9223
  9224* EXEC CICS LINK
  9225*        PROGRAM(PGM-NAME)
  9226*        COMMAREA(EMI-LINE1)
  9227*        LENGTH(72)
  9228*        END-EXEC.
  9229     MOVE 72
  9230       TO DFHEIV11
  9231*    MOVE '."C                   (   #00008401' TO DFHEIV0
  9232     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9234     MOVE X'2020233030303038343031' TO DFHEIV0(25:11)
  9235     CALL 'kxdfhei1' USING DFHEIV0,
  9236           PGM-NAME,
  9237           EMI-LINE1,
  9238           DFHEIV11,
  9239           DFHEIV99,
  9240           DFHEIV99,
  9241           DFHEIV99,
  9242           DFHEIV99
  9243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9244
  9245
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 179
* EL154.cbl
  9246     GO TO 8200-SEND-DATAONLY.
  9247
  9248* GOBACK.
  9249     MOVE '9%                    "   ' TO DFHEIV0
  9250     MOVE 'EL154' TO DFHEIV1
  9251     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9252     GOBACK.
  9253
  9254 9995-SECURITY-VIOLATION.
  9255*                            COPY ELCSCTP.
  9256******************************************************************
  9257*                                                                *
  9258*                            ELCSCTP                             *
  9259*                            VMOD=2.001                          *
  9260*                                                                *
  9261*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9262******************************************************************
  9263
  9264
  9265     MOVE EIBDATE          TO SM-JUL-DATE.
  9266     MOVE EIBTRMID         TO SM-TERMID.
  9267     MOVE THIS-PGM         TO SM-PGM.
  9268     MOVE EIBTIME          TO TIME-IN.
  9269     MOVE TIME-OUT         TO SM-TIME.
  9270     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9271
  9272
  9273* EXEC CICS LINK
  9274*         PROGRAM  ('EL003')
  9275*         COMMAREA (SECURITY-MESSAGE)
  9276*         LENGTH   (80)
  9277*    END-EXEC.
  9278     MOVE 'EL003' TO DFHEIV1
  9279     MOVE 80
  9280       TO DFHEIV11
  9281*    MOVE '."C                   (   #00008428' TO DFHEIV0
  9282     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9284     MOVE X'2020233030303038343238' TO DFHEIV0(25:11)
  9285     CALL 'kxdfhei1' USING DFHEIV0,
  9286           DFHEIV1,
  9287           SECURITY-MESSAGE,
  9288           DFHEIV11,
  9289           DFHEIV99,
  9290           DFHEIV99,
  9291           DFHEIV99,
  9292           DFHEIV99
  9293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9294
  9295
  9296******************************************************************
  9297
  9298
  9299 9995-EXIT.
  9300     EXIT.
  9301
  9302
  9303 9999-DFHBACK SECTION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 180
* EL154.cbl
  9304     MOVE '9%                    "   ' TO DFHEIV0
  9305     MOVE 'EL154' TO DFHEIV1
  9306     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9307     GOBACK.
  9308 9999-DFHEXIT.
  9309     IF DFHEIGDJ EQUAL 0001
  9310         NEXT SENTENCE
  9311     ELSE IF DFHEIGDJ EQUAL 2
  9312         GO TO 8860-CLAM-NOT-OPEN,
  9313               9600-PGMID-ERROR,
  9314               9990-ABEND
  9315         DEPENDING ON DFHEIGDI
  9316     ELSE IF DFHEIGDJ EQUAL 3
  9317         GO TO 8850-CLAM-END-FILE,
  9318               8850-CLAM-END-FILE
  9319         DEPENDING ON DFHEIGDI
  9320     ELSE IF DFHEIGDJ EQUAL 4
  9321         GO TO 8850-CLAM-END-FILE,
  9322               8850-CLAM-END-FILE
  9323         DEPENDING ON DFHEIGDI
  9324     ELSE IF DFHEIGDJ EQUAL 5
  9325         GO TO 8870-ACTV-NOT-OPEN
  9326         DEPENDING ON DFHEIGDI
  9327     ELSE IF DFHEIGDJ EQUAL 6
  9328         GO TO 8870-ACTV-NOT-OPEN,
  9329               4099-EXIT
  9330         DEPENDING ON DFHEIGDI
  9331     ELSE IF DFHEIGDJ EQUAL 7
  9332         GO TO 9999-DFHBACK
  9333         DEPENDING ON DFHEIGDI
  9334     ELSE IF DFHEIGDJ EQUAL 8
  9335         GO TO 6150-READ-CARRIER,
  9336               8890-CNTL-NOT-OPEN
  9337         DEPENDING ON DFHEIGDI
  9338     ELSE IF DFHEIGDJ EQUAL 9
  9339         GO TO 6180-READ-CERT
  9340         DEPENDING ON DFHEIGDI
  9341     ELSE IF DFHEIGDJ EQUAL 10
  9342         GO TO 8880-CERT-NOT-OPEN,
  9343               6185-CERT-NOT-FOUND
  9344         DEPENDING ON DFHEIGDI
  9345     ELSE IF DFHEIGDJ EQUAL 11
  9346         GO TO 8885-EMPLCY-NOT-OPEN,
  9347               6195-EMPLCY-NOT-FOUND
  9348         DEPENDING ON DFHEIGDI
  9349     ELSE IF DFHEIGDJ EQUAL 12
  9350         GO TO 6250-ADDR-ERROR
  9351         DEPENDING ON DFHEIGDI
  9352     ELSE IF DFHEIGDJ EQUAL 13
  9353         GO TO 8860-CLAM-NOT-OPEN,
  9354               7090-CLAIM-NOT-FOUND
  9355         DEPENDING ON DFHEIGDI
  9356     ELSE IF DFHEIGDJ EQUAL 14
  9357         GO TO 8870-ACTV-NOT-OPEN,
  9358               7080-NO-TRAILER
  9359         DEPENDING ON DFHEIGDI
  9360     ELSE IF DFHEIGDJ EQUAL 15
  9361         GO TO 7100-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 181
* EL154.cbl
  9362         DEPENDING ON DFHEIGDI
  9363     ELSE IF DFHEIGDJ EQUAL 16
  9364         GO TO 7200-EXIT,
  9365               7200-EXIT
  9366         DEPENDING ON DFHEIGDI
  9367     ELSE IF DFHEIGDJ EQUAL 17
  9368         GO TO 8300-SEND-TEXT
  9369         DEPENDING ON DFHEIGDI.
  9370     MOVE '9%                    "   ' TO DFHEIV0
  9371     MOVE 'EL154' TO DFHEIV1
  9372     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9373     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5964     Code:       18931
