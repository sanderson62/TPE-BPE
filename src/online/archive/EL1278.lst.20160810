* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57* 050713  CR2011062300001  PEMA  REM CHG FOR EXT DYS FOR ROA REF
    58* 041514  CR2012110200003  AJRA  REMOVE PF11 FROM SCREEN,
    59*                                CANCEL QUOTE SCRIPT WILL DO PF11
    60* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    61* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
    62******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   3
* EL1278.cbl
    64 ENVIRONMENT DIVISION.
    65 DATA DIVISION.
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68 77  FILLER  PIC  X(32) VALUE '********************************'.
    69 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    70 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    71 77  S1                          PIC S999 COMP-3 VALUE +0.
    72 77  P1                          PIC S999 COMP-3 VALUE +0.
    73 77  P2                          PIC S999 COMP-3 VALUE +0.
    74 77  C0                          PIC S999 COMP-3 VALUE +0.
    75 77  C1                          PIC S999 COMP-3 VALUE +0.
    76 77  C2                          PIC S999 COMP-3 VALUE +0.
    77 77  C3                          PIC S999 COMP-3 VALUE +0.
    78 77  WS-STOP-SW                  PIC X  VALUE ' '.
    79     88  I-SAY-TO-STOP      VALUE 'Y'.
    80 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    81     88  OPEN-LF-CLAIM              VALUE 'Y'.
    82 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    83     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    84 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    85     88  OPEN-AH-CLAIM              VALUE 'Y'.
    86 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    87     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    88 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    89     88  FOUND-A-CLAIM              VALUE 'Y'.
    90 77  WS-ST-REF-IND               PIC X.
    91 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    92 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    93 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    94 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    95 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    96 77  DD-IU-SW                    PIC X   VALUE ' '.
    97     88  DD-IU-PRESENT                 VALUE 'Y'.
    98 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    99 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   100 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   101 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   102 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   103 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   104 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   105 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   106 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   107     88  NO-CERT-RW                 VALUE 'N'.
   108     88  CERT-RW                    VALUE 'Y'.
   109 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   110     88  ERMAIL-FOUND                 VALUE 'Y'.
   111 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   112
   113*                            COPY ELCSCTM.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCTM                             *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   121*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   4
* EL1278.cbl
   122******************************************************************
   123 01  SECURITY-MESSAGE.
   124     12  FILLER                          PIC X(30)
   125            VALUE '** LOGIC SECURITY VIOLATION -'.
   126     12  SM-READ                         PIC X(6).
   127     12  FILLER                          PIC X(5)
   128            VALUE ' PGM='.
   129     12  SM-PGM                          PIC X(6).
   130     12  FILLER                          PIC X(5)
   131            VALUE ' OPR='.
   132     12  SM-PROCESSOR-ID                 PIC X(4).
   133     12  FILLER                          PIC X(6)
   134            VALUE ' TERM='.
   135     12  SM-TERMID                       PIC X(4).
   136     12  FILLER                          PIC XX   VALUE SPACE.
   137     12  SM-JUL-DATE                     PIC 9(5).
   138     12  FILLER                          PIC X    VALUE SPACE.
   139     12  SM-TIME                         PIC 99.99.
   140
   141
   142*                            COPY ELCSCRTY.
   143******************************************************************
   144*                                                                *
   145*                                                                *
   146*                            ELCSCRTY                            *
   147*                            VMOD=2.001                          *
   148*                                                                *
   149*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   150*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   151*        SAVED IN PI-SECURITY-ADDRESS.                           *
   152*                                                                *
   153******************************************************************
   154 01  SECURITY-CONTROL.
   155     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   156     12  FILLER                       PIC XX    VALUE 'SC'.
   157     12  SC-CREDIT-CODES.
   158         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   159             20  SC-CREDIT-DISPLAY    PIC X.
   160             20  SC-CREDIT-UPDATE     PIC X.
   161     12  SC-CLAIMS-CODES.
   162         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   163             20  SC-CLAIMS-DISPLAY    PIC X.
   164             20  SC-CLAIMS-UPDATE     PIC X.
   165
   166 01  FILLER          COMP-3.
   167     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   168     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   169     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   170     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   171     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   172     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   173     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   174     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   175     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   176
   177 01  WS-DATE-AREA.
   178     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   179     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   5
* EL1278.cbl
   180     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   181     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   182     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   183     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   184
   185 01  ERPDEF-KEY-SAVE             PIC X(18).
   186 01  ERPDEF-KEY.
   187     12  ERPDEF-COMPANY-CD       PIC X.
   188     12  ERPDEF-STATE            PIC XX.
   189     12  ERPDEF-PROD-CD          PIC XXX.
   190     12  F                       PIC X(7).
   191     12  ERPDEF-BEN-TYPE         PIC X.
   192     12  ERPDEF-BEN-CODE         PIC XX.
   193     12  ERPDEF-EXP-DT           PIC XX.
   194 01  ELMSTR-KEY.
   195     12  ELMSTR-COMP-CD          PIC X.
   196     12  ELMSTR-CERT-NO          PIC X(11).
   197 01  ELCRTT-KEY.
   198     12  ELCRTT-PRIMARY          PIC X(33).
   199     12  ELCRTT-REC-TYPE         PIC X(1).
   200
   201 01  ELCRTO-KEY.
   202     05  ELCRTO-COMPANY-CD       PIC X.
   203     05  ELCRTO-CARRIER          PIC X.
   204     05  ELCRTO-GROUPING         PIC X(6).
   205     05  ELCRTO-STATE            PIC XX.
   206     05  ELCRTO-ACCOUNT          PIC X(10).
   207     05  ELCRTO-CERT-EFF-DT      PIC XX.
   208     05  ELCRTO-CERT-NO.
   209         10  ELCRTO-CERT-PRIME   PIC X(10).
   210         10  ELCRTO-CERT-SFX     PIC X.
   211     05  ELCRTO-RECORD-TYPE      PIC X.
   212     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   213
   214 01  STANDARD-AREAS.
   215     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   216     12  SUB3                    PIC S9(04) COMP VALUE +0.
   217     12  SUB4                    PIC S9(04) COMP VALUE +0.
   218     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   219     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   220     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   221     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   222     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   223     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   224     12  PGM-NAME                PIC  X(08).
   225     12  TIME-IN                 PIC S9(07).
   226     12  TIME-OUT-R  REDEFINES  TIME-IN.
   227         16  FILLER              PIC  X(01).
   228         16  TIME-OUT            PIC  9(02)V99.
   229         16  FILLER              PIC  X(02).
   230     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   231     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   232     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   233     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   234     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   235     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   236     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   237     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   6
* EL1278.cbl
   238     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   239     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   240     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   241     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   242     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   243     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   244     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   245     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   246     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   247     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   248         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   249     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   250         88  BROWSE-STARTED                      VALUE 'Y'.
   251     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   252         88  FORM-FOUND                          VALUE 'Y'.
   253     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   254         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   255     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   256         88  WS-REDUCING                         VALUE 'R'.
   257         88  WS-LEVEL                            VALUE 'L'  'P'.
   258     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   259         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   260     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   261         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   262     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   263     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   264         'CLAIM PMTS'.
   265     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   266         'ITD REFUND'.
   267     12  WS-ACCESS.
   268         16  FILLER              PIC  X(02).
   269         16  WS-BEN-CD           PIC  X(02).
   270     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   271     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   272     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   273     12  WS-LOOKUP-TYPE          PIC  X(01).
   274     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   275     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   276     12  WS-CALC-CD              PIC  X(01).
   277     12  DEEDIT-FIELD            PIC  X(15).
   278     12  DEEDIT-FIELD-V0  REDEFINES
   279         DEEDIT-FIELD            PIC S9(15).
   280     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   281     12  RETURN-FROM             PIC  X(08).
   282     12  QID.
   283         16  QID-TERM            PIC  X(04).
   284         16  FILLER              PIC  X(04)      VALUE '127H'.
   285     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   286         88  FIRST-ENTRY                         VALUE 'Y'.
   287     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   288         88  PDEF-FOUND                          VALUE 'Y'.
   289     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   290         88  CERT-FOUND                          VALUE 'Y'.
   291         88  CERT-NOT-FOUND                      VALUE 'N'.
   292     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   293         88  CNTL-FOUND                          VALUE 'Y'.
   294         88  CNTL-NOT-FOUND                      VALUE 'N'.
   295     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   7
* EL1278.cbl
   296         88  BEN-FOUND                           VALUE 'Y'.
   297     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   298         88  STATE-FOUND                         VALUE 'Y'.
   299     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   300         88  ST-BEN-FOUND                        VALUE 'Y'.
   301     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   302         88  ACCT-FOUND                          VALUE 'Y'.
   303     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   304         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   305     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   306                                                 VALUE ZERO.
   307         88  BENEFIT-FOUND                       VALUE +1.
   308     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   309                                                 VALUE ZERO.
   310     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   311                                                 VALUE ZERO.
   312     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   313     12  WS-SUB1                 PIC S99    COMP.
   314     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   315     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   316     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   317     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   318     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   319     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   320     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   321     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   322     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   323     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   324     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   325     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   326     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   327     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   328     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   329     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   330     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   331     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   332     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   333     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   334     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   335     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   336     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   337     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   338     12  ERROR-MESSAGES.
   339         16  ER-0000             PIC  X(04)      VALUE '0000'.
   340         16  ER-0004             PIC  X(04)      VALUE '0004'.
   341         16  ER-0008             PIC  X(04)      VALUE '0008'.
   342         16  ER-0028             PIC  X(04)      VALUE '0028'.
   343         16  ER-0029             PIC  X(04)      VALUE '0029'.
   344         16  ER-0070             PIC  X(04)      VALUE '0070'.
   345         16  ER-0142             PIC  X(04)      VALUE '0142'.
   346         16  ER-0214             PIC  X(04)      VALUE '0214'.
   347         16  ER-0681             PIC  X(04)      VALUE '0681'.
   348         16  ER-0682             PIC  X(04)      VALUE '0682'.
   349         16  ER-0683             PIC  X(04)      VALUE '0683'.
   350         16  ER-0684             PIC  X(04)      VALUE '0684'.
   351         16  ER-2227             PIC  X(04)      VALUE '2227'.
   352         16  ER-2601             PIC  X(04)      VALUE '2601'.
   353         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   8
* EL1278.cbl
   354         16  ER-2617             PIC  X(04)      VALUE '2617'.
   355         16  ER-2619             PIC  X(04)      VALUE '2619'.
   356         16  ER-2740             PIC  X(04)      VALUE '2740'.
   357         16  ER-2756             PIC  X(04)      VALUE '2756'.
   358         16  ER-2768             PIC  X(04)      VALUE '2768'.
   359         16  ER-2774             PIC  X(04)      VALUE '2774'.
   360         16  ER-2775             PIC  X(04)      VALUE '2775'.
   361         16  ER-2965             PIC  X(04)      VALUE '2965'.
   362         16  ER-2966             PIC  X(04)      VALUE '2966'.
   363         16  ER-2967             PIC  X(04)      VALUE '2967'.
   364         16  ER-2968             PIC  X(04)      VALUE '2968'.
   365         16  ER-2969             PIC  X(04)      VALUE '2969'.
   366         16  ER-3037             PIC  X(04)      VALUE '3037'.
   367         16  ER-3038             PIC  X(04)      VALUE '3038'.
   368         16  ER-3039             PIC  X(04)      VALUE '3039'.
   369         16  ER-3780             PIC  X(04)      VALUE '3780'.
   370         16  ER-3781             PIC  X(04)      VALUE '3781'.
   371         16  ER-3830             PIC  X(04)      VALUE '3830'.
   372         16  ER-8160             PIC  X(04)      VALUE '8160'.
   373         16  ER-8161             PIC  X(04)      VALUE '8161'.
   374         16  ER-9999             PIC  X(04)      VALUE '9999'.
   375     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   376     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   377     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   378     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   379
   380     12  WS-RESPONSE             PIC S9(8)       COMP.
   381         88  WS-RESP-NORMAL                      VALUE +00.
   382         88  WS-RESP-NOTFND                      VALUE +13.
   383         88  WS-RESP-DUPREC                      VALUE +14.
   384         88  WS-RESP-DUPKEY                      VALUE +15.
   385         88  WS-RESP-NOTOPEN                     VALUE +19.
   386         88  WS-RESP-ENDFILE                     VALUE +20.
   387
   388     12  WS-01-CANCEL-ERR        PIC X(25)
   389         VALUE 'CANCEL DATE ERROR'.
   390     12  WS-02-CANCEL-ERR        PIC X(25)
   391         VALUE 'CERT NOT FOUND'.
   392     12  WS-04-CANCEL-ERR        PIC X(25)
   393         VALUE 'CANCEL AMOUNT ERROR'.
   394     12  WS-05-CANCEL-ERR        PIC X(25)
   395         VALUE 'CANCEL OPTION ERROR'.
   396     12  WS-06-CANCEL-ERR        PIC X(25)
   397         VALUE 'PREVIOUSLY CANCELLED'.
   398     12  WS-07-CANCEL-ERR        PIC X(25)
   399         VALUE 'INVALID DATA'.
   400     12  WS-08-CANCEL-ERR        PIC X(25)
   401         VALUE 'NO ACCOUNT MASTER'.
   402     12  WS-09-CANCEL-ERR        PIC X(25)
   403         VALUE 'SUFFIX ALREADY EXISTS'.
   404     12  WS-99-CANCEL-ERR        PIC X(25)
   405         VALUE 'MISC CANCEL ERROR'.
   406
   407 01  WS-SAVE-ALLOWABLE-BENEFIT.
   408     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   409     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   410     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   411     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   9
* EL1278.cbl
   412     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   413     16  FILLER                    PIC XX.
   414 01  CTBL-KEY-SAVE               PIC X(5).
   415 01  CTBL-KEY.
   416     05  CTBL-COMPANY-CD         PIC X.
   417     05  CTBL-TABLE              PIC XXX.
   418     05  CTBL-BEN-TYPE           PIC X.
   419     05  CTBL-BEN-CODE           PIC XX.
   420 01  CANCEL-GEN-PASS-AREA.
   421     05  CG-OPTION-CODE          PIC X.
   422         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   423         88  CG-FLAT-CANCEL        VALUE '1'.
   424         88  CG-CANCEL             VALUE '2'.
   425         88  CG-CANCEL-REISSUE     VALUE '3'.
   426     05  CG-ERROR-CODE           PIC 99.
   427         88  CG-SUCCESS            VALUE 00.
   428         88  CG-DATE-ERROR         VALUE 01.
   429         88  CG-CERT-NOT-FOUND     VALUE 02.
   430         88  CG-AMOUNT-ERROR       VALUE 04.
   431         88  CG-OPTION-ERROR       VALUE 05.
   432         88  CG-PREV-CAN           VALUE 06.
   433         88  CG-INVALID-DATA       VALUE 07.
   434         88  CG-NO-ACCT-MSTR       VALUE 08.
   435         88  CG-SFX-A-EXIST        VALUE 09.
   436         88  CG-MISC-ERROR         VALUE 99.
   437     05  CG-COMPANY-ID           PIC XXX.
   438     05  CG-PROC-ID              PIC XXXX.
   439     05  CG-CURRENT-DT           PIC XX.
   440     05  CG-MONTH-END-DT         PIC XX.
   441     05  CG-CERT-KEY.
   442         10  CG-CERT-COMPANY-CD  PIC X.
   443         10  CG-CERT-CARRIER     PIC X.
   444         10  CG-CERT-GROUP       PIC X(6).
   445         10  CG-CERT-STATE       PIC XX.
   446         10  CG-CERT-ACCOUNT     PIC X(10).
   447         10  CG-CERT-EFF-DT      PIC XX.
   448         10  CG-CERT-CERT-NO     PIC X(11).
   449     05  CG-LF-CAN-DATA.
   450         10  CG-LF-CAN-DT        PIC XX.
   451         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   452     05  CG-AH-CAN-DATA.
   453         10  CG-AH-CAN-DT        PIC XX.
   454         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   455     05  CG-CERT-PROFILE-DATA.
   456         10  CG-INS-LNAME        PIC X(15).
   457         10  CG-INS-FNAME        PIC X(10).
   458         10  CG-INS-MID-INIT     PIC X.
   459         10  CG-INS-AGE          PIC 99.
   460         10  CG-JNT-LNAME        PIC X(15).
   461         10  CG-JNT-FNAME        PIC X(10).
   462         10  CG-JNT-MID-INIT     PIC X.
   463         10  CG-JNT-AGE          PIC 99.
   464     05  CG-LF-ISS-DATA.
   465         10  CG-LF-BENCD         PIC XX.
   466         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   467         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   468     05  CG-AH-ISS-DATA.
   469         10  CG-AH-BENCD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  10
* EL1278.cbl
   470         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   471     05  CG-BATCH-NO             PIC X(6).
   472     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   473     05  FILLER                  PIC X(306).
   474 01  WS-CAN-QUOTE-NOTE.
   475     12  WS-CN-CANCEL-DT         PIC  X(09).
   476     12  FILLER                  PIC  X(10)      VALUE
   477         'RF QUOTE: '.
   478     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   479     12  FILLER                  PIC  X(4)       VALUE
   480         ' LF '.
   481     12  WS-CN-LF-REF-METH       PIC  X.
   482     12  FILLER                  PIC  X          VALUE ','.
   483     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   484     12  FILLER                  PIC  X(5)       VALUE
   485         ' AH '.
   486     12  WS-CN-AH-REF-METH       PIC  X.
   487     12  FILLER                  PIC  XX         VALUE ','.
   488     12  FILLER                  PIC  X(6)       VALUE
   489         'TOTAL '.
   490     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   491     12  FILLER                  PIC  X(01)      VALUE ' '.
   492     12  WS-CN-DT-QUOTED         PIC  X(08).
   493     12  FILLER                  PIC  X(01)      VALUE ';'.
   494     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   495
   496 01  WS-CM-CONTROL-PRIMARY.
   497     12  WS-CM-COMPANY-CD        PIC  X(01).
   498     12  WS-CM-CARRIER           PIC  X(01).
   499     12  WS-CM-GROUPING          PIC  X(06).
   500     12  WS-CM-STATE             PIC  X(02).
   501     12  WS-CM-ACCOUNT           PIC  X(10).
   502     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   503     12  WS-CM-CERT-NO.
   504         16  WS-CM-CERT-PRIME    PIC  X(10).
   505         16  WS-CM-CERT-SFX      PIC  X(01).
   506
   507 01  WS-MA-CONTROL-PRIMARY.
   508     12  WS-MA-COMPANY-CD        PIC  X(01).
   509     12  WS-MA-CARRIER           PIC  X(01).
   510     12  WS-MA-GROUPING          PIC  X(06).
   511     12  WS-MA-STATE             PIC  X(02).
   512     12  WS-MA-ACCOUNT           PIC  X(10).
   513     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   514     12  WS-MA-CERT-NO.
   515         16  WS-MA-CERT-PRIME    PIC  X(10).
   516         16  WS-MA-CERT-SFX      PIC  X(01).
   517 01  WS-CF-CONTROL-PRIMARY.
   518     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   519     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   520*        88  COMPANY-MASTER                      VALUE '1'.
   521*        88  STATE-MASTER                        VALUE '3'.
   522*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   523*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   524     12  WS-CF-ACCESS.
   525         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   526         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   527             20  FILLER          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  11
* EL1278.cbl
   528             20  WS-CF-CARRIER   PIC  X(01).
   529     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   530
   531 01  WS-AM-CONTROL-PRIMARY.
   532     12  WS-AM-COMPANY-CD        PIC  X(01).
   533     12  WS-AM-CARRIER           PIC  X(01).
   534     12  WS-AM-GROUPING          PIC  X(06).
   535     12  WS-AM-STATE             PIC  X(02).
   536     12  WS-AM-ACCOUNT           PIC  X(10).
   537     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   538     12  WS-AM-FILLER            PIC  X(04).
   539
   540 01  WS-CN-CONTROL-PRIMARY.
   541     12  WS-CN-COMPANY-CD        PIC  X(01).
   542     12  WS-CN-CARRIER           PIC  X(01).
   543     12  WS-CN-GROUPING          PIC  X(06).
   544     12  WS-CN-STATE             PIC  X(02).
   545     12  WS-CN-ACCOUNT           PIC  X(10).
   546     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   547     12  WS-CN-CERT-NO.
   548         16  WS-CN-CERT-PRIME    PIC  X(10).
   549         16  WS-CN-CERT-SFX      PIC  X.
   550     12  WS-CN-REC-TYPE          PIC X.
   551     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   552
   553 01  WS-FO-CONTROL-PRIMARY.
   554     12  WS-FO-COMPANY-CD        PIC  X(01).
   555     12  WS-FO-STATE             PIC  X(02).
   556     12  WS-FO-FORM-ID           PIC  X(12).
   557     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  12
* EL1278.cbl
   559*                            COPY ERCCNOT.
   560******************************************************************
   561*                                                                *
   562*                            ERCCNOT                             *
   563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   564*                            VMOD=2.003                          *
   565*                                                                *
   566*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   567*                                                                *
   568*        FILE TYPE= VSAM,KSDS                                    *
   569*        RECORD SIZE = 150    RECFORM = FIXED                    *
   570*                                                                *
   571*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   572*                                                                *
   573*        LOG = YES                                               *
   574*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   575*                                                                *
   576******************************************************************
   577*                   C H A N G E   L O G
   578*
   579* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   580*-----------------------------------------------------------------
   581*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   582* EFFECTIVE    NUMBER
   583*-----------------------------------------------------------------
   584* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   585******************************************************************
   586
   587 01  CERT-NOTE-FILE.
   588     12  CZ-RECORD-ID                PIC  XX.
   589         88  VALID-CZ-ID                  VALUE 'CZ'.
   590
   591     12  CZ-CONTROL-PRIMARY.
   592         16  CZ-COMPANY-CD           PIC X.
   593         16  CZ-CARRIER              PIC X.
   594         16  CZ-GROUPING.
   595             20 CZ-GROUPING-PREFIX   PIC XXX.
   596             20 CZ-GROUPING-PRIME    PIC XXX.
   597         16  CZ-STATE                PIC XX.
   598         16  CZ-ACCOUNT.
   599             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   600             20 CZ-ACCOUNT-PRIME     PIC X(6).
   601         16  CZ-CERT-EFF-DT          PIC XX.
   602         16  CZ-CERT-NO.
   603             20  CZ-CERT-PRIME       PIC X(10).
   604             20  CZ-CERT-SFX         PIC X.
   605         16  CZ-RECORD-TYPE          PIC X.
   606             88  CERT-NOTE           VALUE '1'.
   607             88  CLAIM-CERT-NOTE     VALUE '2'.
   608         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   609
   610     12  CZ-LAST-MAINT-DT            PIC XX.
   611     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   612     12  CZ-LAST-MAINT-USER          PIC X(4).
   613
   614     12  CZ-NOTE-INFORMATION.
   615         16  CZ-NOTE                 PIC X(63).
   616         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  13
* EL1278.cbl
   617******************************************************************
   618*                            COPY ELCDATE.
   619******************************************************************
   620*                                                                *
   621*                                                                *
   622*                            ELCDATE.                            *
   623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   624*                            VMOD=2.003
   625*                                                                *
   626*                                                                *
   627*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   628*                 LENGTH = 200                                   *
   629******************************************************************
   630
   631 01  DATE-CONVERSION-DATA.
   632     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   633     12  DC-OPTION-CODE                PIC X.
   634         88  BIN-TO-GREG                VALUE ' '.
   635         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   636         88  EDIT-GREG-TO-BIN           VALUE '2'.
   637         88  YMD-GREG-TO-BIN            VALUE '3'.
   638         88  MDY-GREG-TO-BIN            VALUE '4'.
   639         88  JULIAN-TO-BIN              VALUE '5'.
   640         88  BIN-PLUS-ELAPSED           VALUE '6'.
   641         88  FIND-CENTURY               VALUE '7'.
   642         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   643         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   644         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   645         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   646         88  JULIAN-TO-BIN-3            VALUE 'C'.
   647         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   648         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   649         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   650         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   651         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   652         88  CHECK-LEAP-YEAR            VALUE 'H'.
   653         88  BIN-3-TO-GREG              VALUE 'I'.
   654         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   655         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   656         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   657         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   658         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   659         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   660         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   661         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   662         88  THREE-CHARACTER-BIN
   663                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   664         88  GREGORIAN-TO-BIN
   665                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   666         88  BIN-TO-GREGORIAN
   667                  VALUES ' ' '1' 'I' '8' 'G'.
   668         88  JULIAN-TO-BINARY
   669                  VALUES '5' 'C' 'E' 'F'.
   670     12  DC-ERROR-CODE                 PIC X.
   671         88  NO-CONVERSION-ERROR        VALUE ' '.
   672         88  DATE-CONVERSION-ERROR
   673                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   674         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  14
* EL1278.cbl
   675         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   676         88  DATE-IS-INVALID            VALUE '3'.
   677         88  DATE1-GREATER-DATE2        VALUE '4'.
   678         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   679         88  DATE-INVALID-OPTION        VALUE '9'.
   680         88  INVALID-CENTURY            VALUE 'A'.
   681         88  ONLY-CENTURY               VALUE 'B'.
   682         88  ONLY-LEAP-YEAR             VALUE 'C'.
   683         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   684     12  DC-END-OF-MONTH               PIC X.
   685         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   686     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   687         88  USE-NORMAL-PROCESS         VALUE ' '.
   688         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   689         88  ADJUST-UP-100-YRS          VALUE '2'.
   690     12  FILLER                        PIC X.
   691     12  DC-CONVERSION-DATES.
   692         16  DC-BIN-DATE-1             PIC XX.
   693         16  DC-BIN-DATE-2             PIC XX.
   694         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   695         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   696                       DC-GREG-DATE-1-EDIT.
   697             20  DC-EDIT1-MONTH        PIC 99.
   698             20  SLASH1-1              PIC X.
   699             20  DC-EDIT1-DAY          PIC 99.
   700             20  SLASH1-2              PIC X.
   701             20  DC-EDIT1-YEAR         PIC 99.
   702         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   703         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   704                     DC-GREG-DATE-2-EDIT.
   705             20  DC-EDIT2-MONTH        PIC 99.
   706             20  SLASH2-1              PIC X.
   707             20  DC-EDIT2-DAY          PIC 99.
   708             20  SLASH2-2              PIC X.
   709             20  DC-EDIT2-YEAR         PIC 99.
   710         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   711         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   712                     DC-GREG-DATE-1-YMD.
   713             20  DC-YMD-YEAR           PIC 99.
   714             20  DC-YMD-MONTH          PIC 99.
   715             20  DC-YMD-DAY            PIC 99.
   716         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   717         16  DC-GREG-DATE-1-MDY-R REDEFINES
   718                      DC-GREG-DATE-1-MDY.
   719             20  DC-MDY-MONTH          PIC 99.
   720             20  DC-MDY-DAY            PIC 99.
   721             20  DC-MDY-YEAR           PIC 99.
   722         16  DC-GREG-DATE-1-ALPHA.
   723             20  DC-ALPHA-MONTH        PIC X(10).
   724             20  DC-ALPHA-DAY          PIC 99.
   725             20  FILLER                PIC XX.
   726             20  DC-ALPHA-CENTURY.
   727                 24 DC-ALPHA-CEN-N     PIC 99.
   728             20  DC-ALPHA-YEAR         PIC 99.
   729         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   730         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   731         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   732         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  15
* EL1278.cbl
   733         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   734                                       PIC 9(05).
   735         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   736             20  DC-JULIAN-YEAR        PIC 99.
   737             20  DC-JULIAN-DAYS        PIC 999.
   738         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   739         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   740         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   741     12  DATE-CONVERSION-VARIBLES.
   742         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   743         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   744             20  FILLER                PIC 9(3).
   745             20  HOLD-CEN-1-CCYY.
   746                 24  HOLD-CEN-1-CC     PIC 99.
   747                 24  HOLD-CEN-1-YY     PIC 99.
   748             20  HOLD-CEN-1-MO         PIC 99.
   749             20  HOLD-CEN-1-DA         PIC 99.
   750         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   751             20  HOLD-CEN-1-R-MO       PIC 99.
   752             20  HOLD-CEN-1-R-DA       PIC 99.
   753             20  HOLD-CEN-1-R-CCYY.
   754                 24  HOLD-CEN-1-R-CC   PIC 99.
   755                 24  HOLD-CEN-1-R-YY   PIC 99.
   756             20  FILLER                PIC 9(3).
   757         16  HOLD-CENTURY-1-X.
   758             20  FILLER                PIC X(3)  VALUE SPACES.
   759             20  HOLD-CEN-1-X-CCYY.
   760                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   761                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   762             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   763             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   764         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   765             20  HOLD-CEN-1-R-X-MO     PIC XX.
   766             20  HOLD-CEN-1-R-X-DA     PIC XX.
   767             20  HOLD-CEN-1-R-X-CCYY.
   768                 24  HOLD-CEN-1-R-X-CC PIC XX.
   769                 24  HOLD-CEN-1-R-X-YY PIC XX.
   770             20  FILLER                PIC XXX.
   771         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   772         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   773         16  DC-JULIAN-DATE-1          PIC 9(07).
   774         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   775             20  DC-JULIAN-1-CCYY.
   776                 24  DC-JULIAN-1-CC    PIC 99.
   777                 24  DC-JULIAN-1-YR    PIC 99.
   778             20  DC-JULIAN-DA-1        PIC 999.
   779         16  DC-JULIAN-DATE-2          PIC 9(07).
   780         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   781             20  DC-JULIAN-2-CCYY.
   782                 24  DC-JULIAN-2-CC    PIC 99.
   783                 24  DC-JULIAN-2-YR    PIC 99.
   784             20  DC-JULIAN-DA-2        PIC 999.
   785         16  DC-GREG-DATE-A-EDIT.
   786             20  DC-EDITA-MONTH        PIC 99.
   787             20  SLASHA-1              PIC X VALUE '/'.
   788             20  DC-EDITA-DAY          PIC 99.
   789             20  SLASHA-2              PIC X VALUE '/'.
   790             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  16
* EL1278.cbl
   791                 24  DC-EDITA-CENT     PIC 99.
   792                 24  DC-EDITA-YEAR     PIC 99.
   793         16  DC-GREG-DATE-B-EDIT.
   794             20  DC-EDITB-MONTH        PIC 99.
   795             20  SLASHB-1              PIC X VALUE '/'.
   796             20  DC-EDITB-DAY          PIC 99.
   797             20  SLASHB-2              PIC X VALUE '/'.
   798             20  DC-EDITB-CCYY.
   799                 24  DC-EDITB-CENT     PIC 99.
   800                 24  DC-EDITB-YEAR     PIC 99.
   801         16  DC-GREG-DATE-CYMD         PIC 9(08).
   802         16  DC-GREG-DATE-CYMD-R REDEFINES
   803                              DC-GREG-DATE-CYMD.
   804             20  DC-CYMD-CEN           PIC 99.
   805             20  DC-CYMD-YEAR          PIC 99.
   806             20  DC-CYMD-MONTH         PIC 99.
   807             20  DC-CYMD-DAY           PIC 99.
   808         16  DC-GREG-DATE-MDCY         PIC 9(08).
   809         16  DC-GREG-DATE-MDCY-R REDEFINES
   810                              DC-GREG-DATE-MDCY.
   811             20  DC-MDCY-MONTH         PIC 99.
   812             20  DC-MDCY-DAY           PIC 99.
   813             20  DC-MDCY-CEN           PIC 99.
   814             20  DC-MDCY-YEAR          PIC 99.
   815    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   816        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   817    12  DC-EL310-DATE                  PIC X(21).
   818    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  17
* EL1278.cbl
   820*                            COPY ELCLOGOF.
   821******************************************************************
   822*                                                                *
   823*                                                                *
   824*                            ELCLOGOF.                           *
   825*                            VMOD=2.001                          *
   826*                                                                *
   827*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   828*                                                                *
   829******************************************************************
   830 01  CLASIC-LOGOFF.
   831     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   832     12  LOGOFF-TEXT.
   833         16  FILLER          PIC X(5)    VALUE SPACES.
   834         16  LOGOFF-MSG.
   835             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   836             20  FILLER      PIC X       VALUE SPACES.
   837             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   838         16  FILLER          PIC X(80)
   839           VALUE '* YOU ARE NOW LOGGED OFF'.
   840         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   841         16  FILLER          PIC X       VALUE QUOTE.
   842         16  LOGOFF-SYS-MSG  PIC X(17)
   843           VALUE 'S CLAS-IC SYSTEM '.
   844     12  TEXT-MESSAGES.
   845         16  UNACCESS-MSG    PIC X(29)
   846             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   847         16  PGMIDERR-MSG    PIC X(17)
   848             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  18
* EL1278.cbl
   850*                            COPY ELCATTR.
   851******************************************************************
   852*                                                                *
   853*                            ELCATTR.                            *
   854*                            VMOD=2.001                          *
   855*                                                                *
   856*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   857*                                                                *
   858*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   859*                                                                *
   860*                   POS 1   P=PROTECTED                          *
   861*                           U=UNPROTECTED                        *
   862*                           S=ASKIP                              *
   863*                   POS 2   A=ALPHA/NUMERIC                      *
   864*                           N=NUMERIC                            *
   865*                   POS 3   N=NORMAL                             *
   866*                           B=BRIGHT                             *
   867*                           D=DARK                               *
   868*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   869*                           OF=MODIFIED DATA TAG OFF             *
   870*                                                                *
   871*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   872******************************************************************
   873 01  ATTRIBUTE-LIST.
   874     12  AL-PABOF            PIC X       VALUE 'Y'.
   875     12  AL-PABON            PIC X       VALUE 'Z'.
   876     12  AL-PADOF            PIC X       VALUE '%'.
   877     12  AL-PADON            PIC X       VALUE '_'.
   878     12  AL-PANOF            PIC X       VALUE '-'.
   879     12  AL-PANON            PIC X       VALUE '/'.
   880     12  AL-SABOF            PIC X       VALUE '8'.
   881     12  AL-SABON            PIC X       VALUE '9'.
   882     12  AL-SADOF            PIC X       VALUE '@'.
   883     12  AL-SADON            PIC X       VALUE QUOTE.
   884     12  AL-SANOF            PIC X       VALUE '0'.
   885     12  AL-SANON            PIC X       VALUE '1'.
   886     12  AL-UABOF            PIC X       VALUE 'H'.
   887     12  AL-UABON            PIC X       VALUE 'I'.
   888     12  AL-UADOF            PIC X       VALUE '<'.
   889     12  AL-UADON            PIC X       VALUE '('.
   890     12  AL-UANOF            PIC X       VALUE ' '.
   891     12  AL-UANON            PIC X       VALUE 'A'.
   892     12  AL-UNBOF            PIC X       VALUE 'Q'.
   893     12  AL-UNBON            PIC X       VALUE 'R'.
   894     12  AL-UNDOF            PIC X       VALUE '*'.
   895     12  AL-UNDON            PIC X       VALUE ')'.
   896     12  AL-UNNOF            PIC X       VALUE '&'.
   897     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  19
* EL1278.cbl
   899*                            COPY ELCEMIB.
   900******************************************************************
   901*                                                                *
   902*                                                                *
   903*                            ELCEMIB.                            *
   904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   905*                            VMOD=2.005                          *
   906*                                                                *
   907*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   908*                                                                *
   909******************************************************************
   910 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   911     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   912     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   913     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   914     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   915     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   916     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   917     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   918     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   919     12  EMI-SWITCH1             PIC X        VALUE '1'.
   920         88  EMI-NO-ERRORS                    VALUE '1'.
   921         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   922         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   923     12  EMI-SWITCH2             PIC X        VALUE '1'.
   924         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   925     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   926         88  EMI-AREA1-EMPTY                  VALUE '1'.
   927         88  EMI-AREA1-FULL                   VALUE '2'.
   928     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   929         88  EMI-AREA2-EMPTY                  VALUE '1'.
   930         88  EMI-AREA2-FULL                   VALUE '2'.
   931     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   932         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   933         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   934         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   935         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   936         88  EMI-BYPASS-FATALS                VALUE 'X'.
   937     12  EMI-ERROR-LINES.
   938         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   939         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   940         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   941         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   942             20  EMI-ERR-CODES OCCURS 10 TIMES.
   943                 24  EMI-ERR-NUM         PIC X(4).
   944                 24  EMI-FILLER          PIC X.
   945                 24  EMI-SEV             PIC X.
   946                 24  FILLER              PIC X.
   947             20  FILLER                  PIC X(02).
   948     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   949         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   950             20  EMI-ERROR-NUMBER    PIC X(4).
   951             20  EMI-FILL            PIC X.
   952             20  EMI-SEVERITY        PIC X.
   953             20  FILLER              PIC X.
   954             20  EMI-ERROR-TEXT.
   955                 24  EMI-TEXT-VARIABLE   PIC X(10).
   956                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  20
* EL1278.cbl
   957     12  EMI-SEVERITY-SAVE           PIC X.
   958         88  EMI-NOTE                    VALUE 'N'.
   959         88  EMI-WARNING                 VALUE 'W'.
   960         88  EMI-FORCABLE                VALUE 'F'.
   961         88  EMI-FATAL                   VALUE 'X'.
   962     12  EMI-MESSAGE-FLAG            PIC X.
   963         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   964         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   965     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   966     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   967         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   968         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   969         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   970     12  emi-claim-no                pic x(7).
   971     12  emi-claim-type              pic x(6).
   972     12  FILLER                      PIC X(124)  VALUE SPACES.
   973     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   974     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   975     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   976     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  21
* EL1278.cbl
   978 01  WS-PASS-631.
   979     12  WS-PASS-WORK-AREA         PIC X(384).
   980     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   981     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   982*        COPY ELC631PI.
   983******************************************************************
   984*                                                                *
   985*                                                                *
   986*                            ELC631PI                            *
   987*                            VMOD=2.012                          *
   988*                                                                *
   989*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   990*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   991*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   992*                                                                *
   993*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   994*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   995*    BETWEEN PROGRAMS.                                           *
   996*                                                                *
   997*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   998*                                                                *
   999*               EL631 - EL6311 - EL6312 - EL6313                 *
  1000*                                                                *
  1001******************************************************************
  1002*                   C H A N G E   L O G
  1003*
  1004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1005*-----------------------------------------------------------------
  1006*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1007* EFFECTIVE    NUMBER
  1008*-----------------------------------------------------------------
  1009* 021414    2003053000001  PEMA  changes for auto chk request
  1010******************************************************************
  1011
  1012         16  PI-631-DATA.
  1013             20  PI-ERPNDB-KEY.
  1014                 24  PI-PB-COMPANY-CD     PIC X.
  1015                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1016                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1017                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1018
  1019             20  PI-ERPNDB-ALT-KEY.
  1020                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1021                 24  PI-PB-CARRIER        PIC X.
  1022                 24  PI-PB-GROUPING       PIC X(6).
  1023                 24  PI-PB-STATE          PIC XX.
  1024                 24  PI-PB-ACCOUNT        PIC X(10).
  1025                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1026                 24  PI-PB-CERT-NO.
  1027                     28  PI-PB-CERT-PRIME PIC X(10).
  1028                     28  PI-PB-CERT-SFX   PIC X.
  1029                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1030                 24  PI-PB-RECORD-TYPE    PIC X.
  1031
  1032             20  PI-ERPNDB-CSR-KEY.
  1033                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1034                 24  PI-PB-CSR-ID             PIC X(4).
  1035                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  22
* EL1278.cbl
  1036                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1037                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1038
  1039             20  PI-BROWSE-TYPE               PIC X.
  1040                 88  PI-FILE-BROWSE             VALUE ' '.
  1041                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1042                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1043                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1044                 88  PI-CSR-BROWSE              VALUE '4'.
  1045
  1046             20  PI-MAINT-FUNCTION            PIC X.
  1047                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1048                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1049                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1050                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1051                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1052                 88  PI-PF5-FUNCTION            VALUE '5'.
  1053                 88  PI-PF6-FUNCTION            VALUE '6'.
  1054
  1055             20  PI-FILE-SWITCHES.
  1056                 24  PI-ALL-ISSUES-SW         PIC X.
  1057                     88  ALL-ISSUES             VALUE 'Y'.
  1058                 24  PI-ALL-CANCELS-SW        PIC X.
  1059                     88  ALL-CANCELS            VALUE 'Y'.
  1060                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1061                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1062                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1063                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1064                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1065                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1066                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1067                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1068                 24  PI-HOLD-REC-SW           PIC X.
  1069                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1070                 24  PI-CHANGE-REC-SW         PIC X.
  1071                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1072                 24  PI-CHK-REQ-REC-SW        PIC X.
  1073                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1074                 24  PI-ISSUE-WARNING-SW      PIC X.
  1075                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1076                 24  PI-CANCEL-WARNING-SW     PIC X.
  1077                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1078             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1079                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1080             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1081                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1082
  1083             20  PI-MAP-NAME                  PIC X(8).
  1084
  1085             20  PI-CURSOR                    PIC S9(4) COMP.
  1086
  1087             20  PI-PREV-ALT-KEY              PIC X(36).
  1088             20  PI-PREV-CSR-KEY              PIC X(15).
  1089             20  PI-PREV-KEY.
  1090                 24  PI-PREV-COMPANY-CD       PIC X.
  1091                 24  PI-PREV-BATCH            PIC X(6).
  1092                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1093                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  23
* EL1278.cbl
  1094             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1095             20  PI-BROWSE-SW                 PIC X.
  1096                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1097                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1098             20  PI-SV-CARRIER                PIC X.
  1099             20  PI-SV-GROUPING               PIC X(6).
  1100             20  PI-SV-STATE                  PIC XX.
  1101             20  PI-EDIT-SW                   PIC X.
  1102             20  PI-DISPLAY-SW                PIC XX.
  1103                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1104                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1105             20  PI-CRITERIA-DATA             PIC X(350).
  1106             20  PI-BMODE                     PIC X.
  1107             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1108             20  PI-BPMTS                     PIC S999     COMP-3.
  1109             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1110             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1111             20  PI-CSR-SESSION-SW            PIC X.
  1112                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1113             20  PI-ERRORS-SW                 PIC X.
  1114                 88  FATAL-ERRORS               VALUE 'X'.
  1115*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1116             20  pi-unforced-sw               pic x.
  1117                 88  unforced-errors            value 'X'.
  1118             20  FILLER                       PIC X(4).
  1119
  1120         16  FILLER                PIC X(94).
  1121
  1122
  1123*                            COPY ELCINTF.
  1124******************************************************************
  1125*                                                                *
  1126*                                                                *
  1127*                            ELCINTF.                            *
  1128*                            VMOD=2.017                          *
  1129*                                                                *
  1130*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1131*                                                                *
  1132*       LENGTH = 1024                                            *
  1133*                                                                *
  1134******************************************************************
  1135*                   C H A N G E   L O G
  1136*
  1137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1138*-----------------------------------------------------------------
  1139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1140* EFFECTIVE    NUMBER
  1141*-----------------------------------------------------------------
  1142* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1143******************************************************************
  1144 01  PROGRAM-INTERFACE-BLOCK.
  1145     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1146     12  PI-CALLING-PROGRAM              PIC X(8).
  1147     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1148     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1149     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1150     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1151     12  PI-SAVED-PROGRAM-5              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  24
* EL1278.cbl
  1152     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1153     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1154     12  PI-COMPANY-ID                   PIC XXX.
  1155     12  PI-COMPANY-CD                   PIC X.
  1156
  1157     12  PI-COMPANY-PASSWORD             PIC X(8).
  1158
  1159     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1160
  1161     12  PI-CONTROL-IN-PROGRESS.
  1162         16  PI-CARRIER                  PIC X.
  1163         16  PI-GROUPING                 PIC X(6).
  1164         16  PI-STATE                    PIC XX.
  1165         16  PI-ACCOUNT                  PIC X(10).
  1166         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1167                                         PIC X(10).
  1168         16  PI-CLAIM-CERT-GRP.
  1169             20  PI-CLAIM-NO             PIC X(7).
  1170             20  PI-CERT-NO.
  1171                 25  PI-CERT-PRIME       PIC X(10).
  1172                 25  PI-CERT-SFX         PIC X.
  1173             20  PI-CERT-EFF-DT          PIC XX.
  1174         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1175             20  PI-PLAN-CODE            PIC X(2).
  1176             20  PI-REVISION-NUMBER      PIC X(3).
  1177             20  PI-PLAN-EFF-DT          PIC X(2).
  1178             20  PI-PLAN-EXP-DT          PIC X(2).
  1179             20  FILLER                  PIC X(11).
  1180         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1181             20  PI-OE-REFERENCE-1.
  1182                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1183                 25  PI-OE-REF-1-SUFF    PIC XX.
  1184
  1185     12  PI-SESSION-IN-PROGRESS          PIC X.
  1186         88  CLAIM-SESSION                   VALUE '1'.
  1187         88  CREDIT-SESSION                  VALUE '2'.
  1188         88  WARRANTY-SESSION                VALUE '3'.
  1189         88  MORTGAGE-SESSION                VALUE '4'.
  1190         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1191
  1192
  1193*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1194
  1195     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1196     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1197
  1198     12  PI-CREDIT-USER                  PIC X.
  1199         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1200         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1201
  1202     12  PI-CLAIM-USER                   PIC X.
  1203         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1204         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1205
  1206     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1207         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1208         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1209         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  25
* EL1278.cbl
  1210         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1211         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1212
  1213     12  PI-PROCESSOR-ID                 PIC X(4).
  1214
  1215     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1216
  1217     12  PI-MEMBER-CAPTION               PIC X(10).
  1218
  1219     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1220         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1221
  1222     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1223     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1224     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1225     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1226
  1227     12  PI-AH-OVERRIDE-L1               PIC X.
  1228     12  PI-AH-OVERRIDE-L2               PIC XX.
  1229     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1230     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1231
  1232     12  PI-NEW-SYSTEM                   PIC X(2).
  1233
  1234     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1235     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1236         88  PI-USES-PAID-TO                 VALUE '1'.
  1237     12  PI-CRDTCRD-SYSTEM.
  1238         16  PI-CRDTCRD-USER             PIC X.
  1239             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1240             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1241         16  PI-CC-MONTH-END-DT          PIC XX.
  1242     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1243
  1244     12  PI-OE-REFERENCE-2.
  1245         16  PI-OE-REF-2-PRIME           PIC X(10).
  1246         16  PI-OE-REF-2-SUFF            PIC X.
  1247
  1248     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1249
  1250     12  PI-LANGUAGE-TYPE                PIC X.
  1251             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1252             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1253             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1254
  1255     12  PI-POLICY-LINKAGE-IND           PIC X.
  1256         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1257         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1258                                                   LOW-VALUES.
  1259
  1260     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1261     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1262         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1263         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1264
  1265     12  PI-PROCESSOR-CSR-IND            PIC X.
  1266         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1267         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  26
* EL1278.cbl
  1268
  1269     12  FILLER                          PIC X(3).
  1270
  1271     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1272
  1273     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1274         PI-SYSTEM-LEVEL.
  1275
  1276         16  PI-ENTRY-CODES.
  1277             20  PI-ENTRY-CD-1           PIC X.
  1278             20  PI-ENTRY-CD-2           PIC X.
  1279
  1280         16  PI-RETURN-CODES.
  1281             20  PI-RETURN-CD-1          PIC X.
  1282             20  PI-RETURN-CD-2          PIC X.
  1283
  1284         16  PI-UPDATE-STATUS-SAVE.
  1285             20  PI-UPDATE-BY            PIC X(4).
  1286             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1287
  1288         16  PI-LOWER-CASE-LETTERS       PIC X.
  1289             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1290
  1291*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1292*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1293*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1294
  1295         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1296             88  ST-ACCNT-CNTL               VALUE ' '.
  1297             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1298             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1299             88  ACCNT-CNTL                  VALUE '3'.
  1300             88  CARR-ACCNT-CNTL             VALUE '4'.
  1301
  1302         16  PI-PROCESSOR-CAP-LIST.
  1303             20  PI-SYSTEM-CONTROLS.
  1304                24 PI-SYSTEM-DISPLAY     PIC X.
  1305                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1306                24 PI-SYSTEM-MODIFY      PIC X.
  1307                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1308             20  FILLER                  PIC XX.
  1309             20  PI-DISPLAY-CAP          PIC X.
  1310                 88  DISPLAY-CAP             VALUE 'Y'.
  1311             20  PI-MODIFY-CAP           PIC X.
  1312                 88  MODIFY-CAP              VALUE 'Y'.
  1313             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1314                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1315             20  PI-FORCE-CAP            PIC X.
  1316                 88  FORCE-CAP               VALUE 'Y'.
  1317
  1318         16  PI-PROGRAM-CONTROLS.
  1319             20  PI-PGM-PRINT-OPT        PIC X.
  1320             20  PI-PGM-FORMAT-OPT       PIC X.
  1321             20  PI-PGM-PROCESS-OPT      PIC X.
  1322             20  PI-PGM-TOTALS-OPT       PIC X.
  1323
  1324         16  PI-HELP-INTERFACE.
  1325             20  PI-LAST-ERROR-NO        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  27
* EL1278.cbl
  1326             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1327
  1328         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1329             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1330
  1331         16  PI-CR-CONTROL-IN-PROGRESS.
  1332             20  PI-CR-CARRIER           PIC X.
  1333             20  PI-CR-GROUPING          PIC X(6).
  1334             20  PI-CR-STATE             PIC XX.
  1335             20  PI-CR-ACCOUNT           PIC X(10).
  1336             20  PI-CR-FIN-RESP          PIC X(10).
  1337             20  PI-CR-TYPE              PIC X.
  1338
  1339         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1340
  1341         16  PI-CR-MONTH-END-DT          PIC XX.
  1342
  1343         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1344             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1345             88  PI-ZERO-CARRIER             VALUE '1'.
  1346             88  PI-ZERO-GROUPING            VALUE '2'.
  1347             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1348
  1349         16  PI-CARRIER-SECURITY         PIC X.
  1350             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1351
  1352         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1353             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1354             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1355
  1356         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1357             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1358                                         INDEXED BY PI-ACCESS-NDX
  1359                                         PIC X.
  1360
  1361         16  PI-GA-BILLING-CONTROL       PIC X.
  1362             88  PI-GA-BILLING               VALUE '1'.
  1363
  1364         16  PI-MAIL-PROCESSING          PIC X.
  1365             88  PI-MAIL-YES                 VALUE 'Y'.
  1366
  1367         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1368
  1369         16  PI-AR-SYSTEM.
  1370             20  PI-AR-PROCESSING-CNTL   PIC X.
  1371                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1372             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1373             20  PI-AR-MONTH-END-DT      PIC XX.
  1374
  1375         16  PI-MP-SYSTEM.
  1376             20  PI-MORTGAGE-USER            PIC X.
  1377                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1378                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1379             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1380                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1381                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1382                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1383                 88  PI-MP-PROD-CNTL                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  28
* EL1278.cbl
  1384                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1385             20  PI-MP-MONTH-END-DT          PIC XX.
  1386             20  PI-MP-REFERENCE-NO.
  1387                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1388                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1389
  1390         16  PI-LABEL-CONTROL            PIC X(01).
  1391             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1392             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1393
  1394         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1395             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1396
  1397         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1398             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1399             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1400
  1401         16  FILLER                      PIC X(14).
  1402
  1403     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1404******************************************************************
  1405     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1406         16  FILLER                PIC  X(500).
  1407         16  PI-PEND-SW            PIC  X(01).
  1408         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1409         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1410         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1411         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1412         16  PI-EARNING-METHOD-LF  PIC  X.
  1413         16  PI-EARNING-METHOD-AH  PIC  X.
  1414         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1415         16  PI-LF-REFUND-METH     PIC  X.
  1416         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1417         16  PI-AH-REFUND-METH     PIC  X.
  1418         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1419         16  PI-MODIFY-CERT-CAP    PIC  X.
  1420             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1421         16  PI-CLP-YN             PIC X.
  1422         16  PI-CANCEL-REASON      PIC X.
  1423         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  29
* EL1278.cbl
  1425*                            COPY ELCAID.
  1426******************************************************************
  1427*                                                                *
  1428*                            ELCAID.                             *
  1429*                            VMOD=2.001                          *
  1430*                                                                *
  1431*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1432*                                                                *
  1433*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1434*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1435******************************************************************
  1436
  1437 01  DFHAID.
  1438   02  DFHNULL   PIC  X  VALUE  ' '.
  1439   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1440   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1441   02  DFHPEN    PIC  X  VALUE  '='.
  1442   02  DFHOPID   PIC  X  VALUE  'W'.
  1443   02  DFHPA1    PIC  X  VALUE  '%'.
  1444   02  DFHPA2    PIC  X  VALUE  '>'.
  1445   02  DFHPA3    PIC  X  VALUE  ','.
  1446   02  DFHPF1    PIC  X  VALUE  '1'.
  1447   02  DFHPF2    PIC  X  VALUE  '2'.
  1448   02  DFHPF3    PIC  X  VALUE  '3'.
  1449   02  DFHPF4    PIC  X  VALUE  '4'.
  1450   02  DFHPF5    PIC  X  VALUE  '5'.
  1451   02  DFHPF6    PIC  X  VALUE  '6'.
  1452   02  DFHPF7    PIC  X  VALUE  '7'.
  1453   02  DFHPF8    PIC  X  VALUE  '8'.
  1454   02  DFHPF9    PIC  X  VALUE  '9'.
  1455   02  DFHPF10   PIC  X  VALUE  ':'.
  1456   02  DFHPF11   PIC  X  VALUE  '#'.
  1457   02  DFHPF12   PIC  X  VALUE  '@'.
  1458   02  DFHPF13   PIC  X  VALUE  'A'.
  1459   02  DFHPF14   PIC  X  VALUE  'B'.
  1460   02  DFHPF15   PIC  X  VALUE  'C'.
  1461   02  DFHPF16   PIC  X  VALUE  'D'.
  1462   02  DFHPF17   PIC  X  VALUE  'E'.
  1463   02  DFHPF18   PIC  X  VALUE  'F'.
  1464   02  DFHPF19   PIC  X  VALUE  'G'.
  1465   02  DFHPF20   PIC  X  VALUE  'H'.
  1466   02  DFHPF21   PIC  X  VALUE  'I'.
  1467*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1468   02  DFHPF22   PIC  X  VALUE  '['.
  1469   02  DFHPF23   PIC  X  VALUE  '.'.
  1470   02  DFHPF24   PIC  X  VALUE  '<'.
  1471   02  DFHMSRE   PIC  X  VALUE  'X'.
  1472   02  DFHSTRF   PIC  X  VALUE  'h'.
  1473   02  DFHTRIG   PIC  X  VALUE  '"'.
  1474
  1475 01  FILLER  REDEFINES  DFHAID.
  1476     12  FILLER                  PIC  X(08).
  1477     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  30
* EL1278.cbl
  1479*                            COPY EL1278S.
  1480 01  EL127HI.
  1481     05  FILLER            PIC  X(0012).
  1482*    -------------------------------
  1483     05  HDATEL PIC S9(0004) COMP.
  1484     05  HDATEF PIC  X(0001).
  1485     05  FILLER REDEFINES HDATEF.
  1486         10  HDATEA PIC  X(0001).
  1487     05  HDATEI PIC  X(0008).
  1488*    -------------------------------
  1489     05  HTIMEL PIC S9(0004) COMP.
  1490     05  HTIMEF PIC  X(0001).
  1491     05  FILLER REDEFINES HTIMEF.
  1492         10  HTIMEA PIC  X(0001).
  1493     05  HTIMEI PIC  999V99.
  1494*    -------------------------------
  1495     05  CMPNYIDL PIC S9(0004) COMP.
  1496     05  CMPNYIDF PIC  X(0001).
  1497     05  FILLER REDEFINES CMPNYIDF.
  1498         10  CMPNYIDA PIC  X(0001).
  1499     05  CMPNYIDI PIC  X(0003).
  1500*    -------------------------------
  1501     05  USERIDL PIC S9(0004) COMP.
  1502     05  USERIDF PIC  X(0001).
  1503     05  FILLER REDEFINES USERIDF.
  1504         10  USERIDA PIC  X(0001).
  1505     05  USERIDI PIC  X(0004).
  1506*    -------------------------------
  1507     05  HCARIERL PIC S9(0004) COMP.
  1508     05  HCARIERF PIC  X(0001).
  1509     05  FILLER REDEFINES HCARIERF.
  1510         10  HCARIERA PIC  X(0001).
  1511     05  HCARIERI PIC  X(0001).
  1512*    -------------------------------
  1513     05  HGROUPL PIC S9(0004) COMP.
  1514     05  HGROUPF PIC  X(0001).
  1515     05  FILLER REDEFINES HGROUPF.
  1516         10  HGROUPA PIC  X(0001).
  1517     05  HGROUPI PIC  X(0006).
  1518*    -------------------------------
  1519     05  HSTATEL PIC S9(0004) COMP.
  1520     05  HSTATEF PIC  X(0001).
  1521     05  FILLER REDEFINES HSTATEF.
  1522         10  HSTATEA PIC  X(0001).
  1523     05  HSTATEI PIC  X(0002).
  1524*    -------------------------------
  1525     05  HACCTNOL PIC S9(0004) COMP.
  1526     05  HACCTNOF PIC  X(0001).
  1527     05  FILLER REDEFINES HACCTNOF.
  1528         10  HACCTNOA PIC  X(0001).
  1529     05  HACCTNOI PIC  X(0010).
  1530*    -------------------------------
  1531     05  HEFFDTL PIC S9(0004) COMP.
  1532     05  HEFFDTF PIC  X(0001).
  1533     05  FILLER REDEFINES HEFFDTF.
  1534         10  HEFFDTA PIC  X(0001).
  1535     05  HEFFDTI PIC  X(0008).
  1536*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  31
* EL1278.cbl
  1537     05  HCERTNOL PIC S9(0004) COMP.
  1538     05  HCERTNOF PIC  X(0001).
  1539     05  FILLER REDEFINES HCERTNOF.
  1540         10  HCERTNOA PIC  X(0001).
  1541     05  HCERTNOI PIC  X(0010).
  1542*    -------------------------------
  1543     05  HCRTSFXL PIC S9(0004) COMP.
  1544     05  HCRTSFXF PIC  X(0001).
  1545     05  FILLER REDEFINES HCRTSFXF.
  1546         10  HCRTSFXA PIC  X(0001).
  1547     05  HCRTSFXI PIC  X(0001).
  1548*    -------------------------------
  1549     05  HLNAMEL PIC S9(0004) COMP.
  1550     05  HLNAMEF PIC  X(0001).
  1551     05  FILLER REDEFINES HLNAMEF.
  1552         10  HLNAMEA PIC  X(0001).
  1553     05  HLNAMEI PIC  X(0015).
  1554*    -------------------------------
  1555     05  HFNAMEL PIC S9(0004) COMP.
  1556     05  HFNAMEF PIC  X(0001).
  1557     05  FILLER REDEFINES HFNAMEF.
  1558         10  HFNAMEA PIC  X(0001).
  1559     05  HFNAMEI PIC  X(0010).
  1560*    -------------------------------
  1561     05  HINITL PIC S9(0004) COMP.
  1562     05  HINITF PIC  X(0001).
  1563     05  FILLER REDEFINES HINITF.
  1564         10  HINITA PIC  X(0001).
  1565     05  HINITI PIC  X(0001).
  1566*    -------------------------------
  1567     05  LCLMDTHL PIC S9(0004) COMP.
  1568     05  LCLMDTHF PIC  X(0001).
  1569     05  FILLER REDEFINES LCLMDTHF.
  1570         10  LCLMDTHA PIC  X(0001).
  1571     05  LCLMDTHI PIC  X(0022).
  1572*    -------------------------------
  1573     05  LCLMDTL PIC S9(0004) COMP.
  1574     05  LCLMDTF PIC  X(0001).
  1575     05  FILLER REDEFINES LCLMDTF.
  1576         10  LCLMDTA PIC  X(0001).
  1577     05  LCLMDTI PIC  X(0008).
  1578*    -------------------------------
  1579     05  HPCYNL PIC S9(0004) COMP.
  1580     05  HPCYNF PIC  X(0001).
  1581     05  FILLER REDEFINES HPCYNF.
  1582         10  HPCYNA PIC  X(0001).
  1583     05  HPCYNI PIC  X(0001).
  1584*    -------------------------------
  1585     05  ACLMDTHL PIC S9(0004) COMP.
  1586     05  ACLMDTHF PIC  X(0001).
  1587     05  FILLER REDEFINES ACLMDTHF.
  1588         10  ACLMDTHA PIC  X(0001).
  1589     05  ACLMDTHI PIC  X(0023).
  1590*    -------------------------------
  1591     05  ACLMDTL PIC S9(0004) COMP.
  1592     05  ACLMDTF PIC  X(0001).
  1593     05  FILLER REDEFINES ACLMDTF.
  1594         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  32
* EL1278.cbl
  1595     05  ACLMDTI PIC  X(0008).
  1596*    -------------------------------
  1597     05  PMTHDL PIC S9(0004) COMP.
  1598     05  PMTHDF PIC  X(0001).
  1599     05  FILLER REDEFINES PMTHDF.
  1600         10  PMTHDA PIC  X(0001).
  1601     05  PMTHDI PIC  X(0010).
  1602*    -------------------------------
  1603     05  CNCDTHDL PIC S9(0004) COMP.
  1604     05  CNCDTHDF PIC  X(0001).
  1605     05  FILLER REDEFINES CNCDTHDF.
  1606         10  CNCDTHDA PIC  X(0001).
  1607     05  CNCDTHDI PIC  X(0007).
  1608*    -------------------------------
  1609     05  HLKINDL PIC S9(0004) COMP.
  1610     05  HLKINDF PIC  X(0001).
  1611     05  FILLER REDEFINES HLKINDF.
  1612         10  HLKINDA PIC  X(0001).
  1613     05  HLKINDI PIC  X(0002).
  1614*    -------------------------------
  1615     05  HLCDL PIC S9(0004) COMP.
  1616     05  HLCDF PIC  X(0001).
  1617     05  FILLER REDEFINES HLCDF.
  1618         10  HLCDA PIC  X(0001).
  1619     05  HLCDI PIC  X(0002).
  1620*    -------------------------------
  1621     05  HLEDESCL PIC S9(0004) COMP.
  1622     05  HLEDESCF PIC  X(0001).
  1623     05  FILLER REDEFINES HLEDESCF.
  1624         10  HLEDESCA PIC  X(0001).
  1625     05  HLEDESCI PIC  X(0003).
  1626*    -------------------------------
  1627     05  HLTERML PIC S9(0004) COMP.
  1628     05  HLTERMF PIC  X(0001).
  1629     05  FILLER REDEFINES HLTERMF.
  1630         10  HLTERMA PIC  X(0001).
  1631     05  HLTERMI PIC  9(3).
  1632*    -------------------------------
  1633     05  HLREML PIC S9(0004) COMP.
  1634     05  HLREMF PIC  X(0001).
  1635     05  FILLER REDEFINES HLREMF.
  1636         10  HLREMA PIC  X(0001).
  1637     05  HLREMI PIC  X(0003).
  1638*    -------------------------------
  1639     05  HLPREML PIC S9(0004) COMP.
  1640     05  HLPREMF PIC  X(0001).
  1641     05  FILLER REDEFINES HLPREMF.
  1642         10  HLPREMA PIC  X(0001).
  1643     05  HLPREMI PIC  X(0011).
  1644*    -------------------------------
  1645     05  HLITDRL PIC S9(0004) COMP.
  1646     05  HLITDRF PIC  X(0001).
  1647     05  FILLER REDEFINES HLITDRF.
  1648         10  HLITDRA PIC  X(0001).
  1649     05  HLITDRI PIC  X(0011).
  1650*    -------------------------------
  1651     05  HLREFNDL PIC S9(0004) COMP.
  1652     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  33
* EL1278.cbl
  1653     05  FILLER REDEFINES HLREFNDF.
  1654         10  HLREFNDA PIC  X(0001).
  1655     05  HLREFNDI PIC  X(0011).
  1656*    -------------------------------
  1657     05  HLCANCL PIC S9(0004) COMP.
  1658     05  HLCANCF PIC  X(0001).
  1659     05  FILLER REDEFINES HLCANCF.
  1660         10  HLCANCA PIC  X(0001).
  1661     05  HLCANCI PIC  X(0008).
  1662*    -------------------------------
  1663     05  HLCAL1L PIC S9(0004) COMP.
  1664     05  HLCAL1F PIC  X(0001).
  1665     05  FILLER REDEFINES HLCAL1F.
  1666         10  HLCAL1A PIC  X(0001).
  1667     05  HLCAL1I PIC  X(0001).
  1668*    -------------------------------
  1669     05  HLCALCL PIC S9(0004) COMP.
  1670     05  HLCALCF PIC  X(0001).
  1671     05  FILLER REDEFINES HLCALCF.
  1672         10  HLCALCA PIC  X(0001).
  1673     05  HLCALCI PIC  X(0012).
  1674*    -------------------------------
  1675     05  HAKINDL PIC S9(0004) COMP.
  1676     05  HAKINDF PIC  X(0001).
  1677     05  FILLER REDEFINES HAKINDF.
  1678         10  HAKINDA PIC  X(0001).
  1679     05  HAKINDI PIC  X(0002).
  1680*    -------------------------------
  1681     05  HACDL PIC S9(0004) COMP.
  1682     05  HACDF PIC  X(0001).
  1683     05  FILLER REDEFINES HACDF.
  1684         10  HACDA PIC  X(0001).
  1685     05  HACDI PIC  X(0002).
  1686*    -------------------------------
  1687     05  HAEDESCL PIC S9(0004) COMP.
  1688     05  HAEDESCF PIC  X(0001).
  1689     05  FILLER REDEFINES HAEDESCF.
  1690         10  HAEDESCA PIC  X(0001).
  1691     05  HAEDESCI PIC  X(0003).
  1692*    -------------------------------
  1693     05  HATERML PIC S9(0004) COMP.
  1694     05  HATERMF PIC  X(0001).
  1695     05  FILLER REDEFINES HATERMF.
  1696         10  HATERMA PIC  X(0001).
  1697     05  HATERMI PIC  9(3).
  1698*    -------------------------------
  1699     05  HAREML PIC S9(0004) COMP.
  1700     05  HAREMF PIC  X(0001).
  1701     05  FILLER REDEFINES HAREMF.
  1702         10  HAREMA PIC  X(0001).
  1703     05  HAREMI PIC  X(0003).
  1704*    -------------------------------
  1705     05  HAPREML PIC S9(0004) COMP.
  1706     05  HAPREMF PIC  X(0001).
  1707     05  FILLER REDEFINES HAPREMF.
  1708         10  HAPREMA PIC  X(0001).
  1709     05  HAPREMI PIC  X(0011).
  1710*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  34
* EL1278.cbl
  1711     05  HAITDRL PIC S9(0004) COMP.
  1712     05  HAITDRF PIC  X(0001).
  1713     05  FILLER REDEFINES HAITDRF.
  1714         10  HAITDRA PIC  X(0001).
  1715     05  HAITDRI PIC  X(0011).
  1716*    -------------------------------
  1717     05  HAREFNDL PIC S9(0004) COMP.
  1718     05  HAREFNDF PIC  X(0001).
  1719     05  FILLER REDEFINES HAREFNDF.
  1720         10  HAREFNDA PIC  X(0001).
  1721     05  HAREFNDI PIC  X(0011).
  1722*    -------------------------------
  1723     05  HACANCL PIC S9(0004) COMP.
  1724     05  HACANCF PIC  X(0001).
  1725     05  FILLER REDEFINES HACANCF.
  1726         10  HACANCA PIC  X(0001).
  1727     05  HACANCI PIC  X(0008).
  1728*    -------------------------------
  1729     05  HACAL1L PIC S9(0004) COMP.
  1730     05  HACAL1F PIC  X(0001).
  1731     05  FILLER REDEFINES HACAL1F.
  1732         10  HACAL1A PIC  X(0001).
  1733     05  HACAL1I PIC  X(0001).
  1734*    -------------------------------
  1735     05  HACALCL PIC S9(0004) COMP.
  1736     05  HACALCF PIC  X(0001).
  1737     05  FILLER REDEFINES HACALCF.
  1738         10  HACALCA PIC  X(0001).
  1739     05  HACALCI PIC  X(0012).
  1740*    -------------------------------
  1741     05  CANFEEHL PIC S9(0004) COMP.
  1742     05  CANFEEHF PIC  X(0001).
  1743     05  FILLER REDEFINES CANFEEHF.
  1744         10  CANFEEHA PIC  X(0001).
  1745     05  CANFEEHI PIC  X(0012).
  1746*    -------------------------------
  1747     05  CANFEEL PIC S9(0004) COMP.
  1748     05  CANFEEF PIC  X(0001).
  1749     05  FILLER REDEFINES CANFEEF.
  1750         10  CANFEEA PIC  X(0001).
  1751     05  CANFEEI PIC  X(0006).
  1752*    -------------------------------
  1753     05  TOPREML PIC S9(0004) COMP.
  1754     05  TOPREMF PIC  X(0001).
  1755     05  FILLER REDEFINES TOPREMF.
  1756         10  TOPREMA PIC  X(0001).
  1757     05  TOPREMI PIC  X(0011).
  1758*    -------------------------------
  1759     05  TOITDRL PIC S9(0004) COMP.
  1760     05  TOITDRF PIC  X(0001).
  1761     05  FILLER REDEFINES TOITDRF.
  1762         10  TOITDRA PIC  X(0001).
  1763     05  TOITDRI PIC  X(0011).
  1764*    -------------------------------
  1765     05  TORFNDL PIC S9(0004) COMP.
  1766     05  TORFNDF PIC  X(0001).
  1767     05  FILLER REDEFINES TORFNDF.
  1768         10  TORFNDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  35
* EL1278.cbl
  1769     05  TORFNDI PIC  X(0011).
  1770*    -------------------------------
  1771     05  CANREAHL PIC S9(0004) COMP.
  1772     05  CANREAHF PIC  X(0001).
  1773     05  FILLER REDEFINES CANREAHF.
  1774         10  CANREAHA PIC  X(0001).
  1775     05  CANREAHI PIC  X(0015).
  1776*    -------------------------------
  1777     05  CANREAL PIC S9(0004) COMP.
  1778     05  CANREAF PIC  X(0001).
  1779     05  FILLER REDEFINES CANREAF.
  1780         10  CANREAA PIC  X(0001).
  1781     05  CANREAI PIC  X(0001).
  1782*    -------------------------------
  1783     05  CLPYNHL PIC S9(0004) COMP.
  1784     05  CLPYNHF PIC  X(0001).
  1785     05  FILLER REDEFINES CLPYNHF.
  1786         10  CLPYNHA PIC  X(0001).
  1787     05  CLPYNHI PIC  X(0005).
  1788*    -------------------------------
  1789     05  CLPYNL PIC S9(0004) COMP.
  1790     05  CLPYNF PIC  X(0001).
  1791     05  FILLER REDEFINES CLPYNF.
  1792         10  CLPYNA PIC  X(0001).
  1793     05  CLPYNI PIC  X(0001).
  1794*    -------------------------------
  1795     05  REFDUEHL PIC S9(0004) COMP.
  1796     05  REFDUEHF PIC  X(0001).
  1797     05  FILLER REDEFINES REFDUEHF.
  1798         10  REFDUEHA PIC  X(0001).
  1799     05  REFDUEHI PIC  X(0018).
  1800*    -------------------------------
  1801     05  REFDUEL PIC S9(0004) COMP.
  1802     05  REFDUEF PIC  X(0001).
  1803     05  FILLER REDEFINES REFDUEF.
  1804         10  REFDUEA PIC  X(0001).
  1805     05  REFDUEI PIC  X(0010).
  1806*    -------------------------------
  1807     05  HLREDL PIC S9(0004) COMP.
  1808     05  HLREDF PIC  X(0001).
  1809     05  FILLER REDEFINES HLREDF.
  1810         10  HLREDA PIC  X(0001).
  1811     05  HLREDI PIC  X(0014).
  1812*    -------------------------------
  1813     05  FREMTRML PIC S9(0004) COMP.
  1814     05  FREMTRMF PIC  X(0001).
  1815     05  FILLER REDEFINES FREMTRMF.
  1816         10  FREMTRMA PIC  X(0001).
  1817     05  FREMTRMI PIC  X(0003).
  1818*    -------------------------------
  1819     05  HERMSG1L PIC S9(0004) COMP.
  1820     05  HERMSG1F PIC  X(0001).
  1821     05  FILLER REDEFINES HERMSG1F.
  1822         10  HERMSG1A PIC  X(0001).
  1823     05  HERMSG1I PIC  X(0079).
  1824*    -------------------------------
  1825     05  HERMSG2L PIC S9(0004) COMP.
  1826     05  HERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  36
* EL1278.cbl
  1827     05  FILLER REDEFINES HERMSG2F.
  1828         10  HERMSG2A PIC  X(0001).
  1829     05  HERMSG2I PIC  X(0079).
  1830*    -------------------------------
  1831     05  HPFKEYL PIC S9(0004) COMP.
  1832     05  HPFKEYF PIC  X(0001).
  1833     05  FILLER REDEFINES HPFKEYF.
  1834         10  HPFKEYA PIC  X(0001).
  1835     05  HPFKEYI PIC  99.
  1836*    -------------------------------
  1837     05  PFKEY11L PIC S9(0004) COMP.
  1838     05  PFKEY11F PIC  X(0001).
  1839     05  FILLER REDEFINES PFKEY11F.
  1840         10  PFKEY11A PIC  X(0001).
  1841     05  PFKEY11I PIC  X(0014).
  1842 01  EL127HO REDEFINES EL127HI.
  1843     05  FILLER            PIC  X(0012).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  HDATEO PIC  X(0008).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  HTIMEO PIC  99.99.
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  CMPNYIDO PIC  X(0003).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  USERIDO PIC  X(0004).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  HCARIERO PIC  X(0001).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  HGROUPO PIC  X(0006).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  HSTATEO PIC  X(0002).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  HACCTNOO PIC  X(0010).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  HEFFDTO PIC  X(0008).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  HCERTNOO PIC  X(0010).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  HCRTSFXO PIC  X(0001).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  HLNAMEO PIC  X(0015).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  HFNAMEO PIC  X(0010).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  37
* EL1278.cbl
  1885     05  HINITO PIC  X(0001).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  LCLMDTHO PIC  X(0022).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  LCLMDTO PIC  X(0008).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  HPCYNO PIC  X(0001).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  ACLMDTHO PIC  X(0023).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  ACLMDTO PIC  X(0008).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  PMTHDO PIC  X(0010).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  CNCDTHDO PIC  X(0007).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  HLKINDO PIC  X(0002).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  HLCDO PIC  X(0002).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  HLEDESCO PIC  X(0003).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  HLTERMO PIC  ZZ9.
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  HLREMO PIC  ZZ9.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  HLCANCO PIC  X(0008).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  HLCAL1O PIC  X(0001).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  HLCALCO PIC  X(0012).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  HAKINDO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  38
* EL1278.cbl
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  HACDO PIC  X(0002).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  HAEDESCO PIC  X(0003).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  HATERMO PIC  ZZ9.
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  HAREMO PIC  ZZ9.
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  HACANCO PIC  X(0008).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  HACAL1O PIC  X(0001).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  HACALCO PIC  X(0012).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  CANFEEHO PIC  X(0012).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  CANFEEO PIC  ZZ9.99.
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  CANREAHO PIC  X(0015).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  CANREAO PIC  X(0001).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  CLPYNHO PIC  X(0005).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  CLPYNO PIC  X(0001).
  2000*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  39
* EL1278.cbl
  2001     05  FILLER            PIC  X(0003).
  2002     05  REFDUEHO PIC  X(0018).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  REFDUEO PIC  ZZZ,ZZ9.99.
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  FREMTRMO PIC  ZZ9.
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  HERMSG1O PIC  X(0079).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  HERMSG2O PIC  X(0079).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  HPFKEYO PIC  99.
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  PFKEY11O PIC  X(0014).
  2024*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  40
* EL1278.cbl
  2026*                            COPY ELCCALC.
  2027******************************************************************
  2028*                                                                *
  2029*                           ELCCALC.                            *
  2030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2031*                            VMOD=2.025                          *
  2032*                                                                *
  2033*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2034*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2035*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2036*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2037*                                                                *
  2038*  PASSED TO ELRTRM                                              *
  2039*  -----------------                                             *
  2040*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2041*  ORIGINAL TERM                                                 *
  2042*  BEGINNING DATE                                                *
  2043*  ENDING DATE                                                   *
  2044*  COMPANY I.D.                                                  *
  2045*  ACCOUNT MASTER USER FIELD                                     *
  2046*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2047*  FREE LOOK DAYS                                                *
  2048*                                                                *
  2049*  RETURNED FROM ELRTRM                                          *
  2050*  ---------------------                                         *
  2051*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2052*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2053*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2054*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2055*----------------------------------------------------------------*
  2056*  PASSED TO ELRAMT                                              *
  2057*  ----------------                                              *
  2058*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2059*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2060*  ORIGINAL AMOUNT                                               *
  2061*  ALTERNATE BENEFIT (BALLON)                                    *
  2062*  A.P.R. - NET PAY ONLY                                         *
  2063*  METHOD
  2064*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2065*  COMPANY I.D.                                                  *
  2066*  BENEFIT TYPE                                                  *
  2067*                                                                *
  2068*  RETURNED FROM ELRAMT                                          *
  2069*  --------------------                                          *
  2070*  REMAINING AMOUNT 1 - CURRENT                                  *
  2071*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2072*  REMAINING AMOUNT FACTOR
  2073*----------------------------------------------------------------*
  2074*  PASSED TO ELRESV                                              *
  2075*  -----------------                                             *
  2076*  CERTIFICATE EFFECTIVE DATE                                    *
  2077*  VALUATION DATE                                                *
  2078*  PAID THRU DATE                                                *
  2079*  BENEFIT                                                       *
  2080*  INCURRED DATE                                                 *
  2081*  REPORTED DATE                                                 *
  2082*  ISSUE AGE                                                     *
  2083*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  41
* EL1278.cbl
  2084*  CDT PERCENT                                                   *
  2085*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2086* *CLAIM TYPE (LIFE, A/H)                                        *
  2087* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2088* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2089*                                                                *
  2090*  RETURNED FROM ELRESV                                          *
  2091*  --------------------                                          *
  2092*  CDT TABLE USED                                                *
  2093*  CDT FACTOR USED                                               *
  2094*  PAY TO CURRENT RESERVE                                        *
  2095*  I.B.N.R. - A/H ONLY                                           *
  2096*  FUTURE (ACCRUED) AH ONLY                                      *
  2097*----------------------------------------------------------------*
  2098*  PASSED TO ELRATE                                              *
  2099*  ----------------                                              *
  2100*  CERT ISSUE DATE                                               *
  2101*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2102*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2103*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2104*  STATE CODE (CLIENT DEFINED)                                   *
  2105*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2106*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2107*  DEVIATION CODE                                                *
  2108*  ISSUE AGE                                                     *
  2109*  ORIGINAL BENEFIT AMOUNT                                       *
  2110*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2111*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2112*  BENEFIT KIND (LIFE OR A/H)                                    *
  2113*  A.P.R.                                                        *
  2114*  METHOD
  2115*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2116*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2117*  COMPANY I.D. (3 CHARACTER)                                    *
  2118*  BENEFIT CODE                                                  *
  2119*  BENEFIT OVERRIDE CODE                                         *
  2120*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2121*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2122*  JOINT INDICATOR (CSL ONLY)                                    *
  2123*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2124*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2125*                                                                *
  2126*  RETURNED FROM ELRATE                                          *
  2127*  --------------------                                          *
  2128*  CALCULATED PREMIUM                                            *
  2129*  PREMIUM RATE                                                  *
  2130*  MORTALITY CODE                                                *
  2131*  MAX ATTAINED AGE                                              *
  2132*  MAX AGE                                                       *
  2133*  MAX TERM                                                      *
  2134*  MAX MONTHLY BENEFIT                                           *
  2135*  MAX TOTAL BENIFIT                                             *
  2136*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2137*----------------------------------------------------------------*
  2138*  PASSED TO ELRFND                                              *
  2139*  ----------------                                              *
  2140*  CERT ISSUE DATE                                               *
  2141*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  42
* EL1278.cbl
  2142*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2143*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2144*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2145*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2146*  STATE CODE (CLIENT DEFINED)                                   *
  2147*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2148*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2149*  DEVIATION CODE                                                *
  2150*  ISSUE AGE                                                     *
  2151*  ORIGINAL BENEFIT AMOUNT                                       *
  2152*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2153*  PROCESS TYPE (CANCEL)                                         *
  2154*  BENEFIT KIND (LIFE OR A/H)                                    *
  2155*  A.P.R.                                                        *
  2156*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2157*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2158*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2159*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2160*  COMPANY I.D. (3 CHARACTER)                                    *
  2161*  BENEFIT CODE                                                  *
  2162*  BENEFIT OVERRIDE CODE                                         *
  2163*                                                                *
  2164*  RETURNED FROM ELRFND                                          *
  2165*  --------------------                                          *
  2166*  CALCULATED REFUND                                             *
  2167*----------------------------------------------------------------*
  2168*  PASSED TO ELEARN                                              *
  2169*  ----------------                                              *
  2170*  CERT ISSUE DATE                                               *
  2171*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2172*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2173*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2174*  STATE CODE (CLIENT DEFINED)                                   *
  2175*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2176*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2177*  DEVIATION CODE                                                *
  2178*  ISSUE AGE                                                     *
  2179*  ORIGINAL BENEFIT AMOUNT                                       *
  2180*  BENEFIT KIND (LIFE OR A/H)                                    *
  2181*  A.P.R.                                                        *
  2182*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2183*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2184*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2185*  COMPANY I.D. (3 CHARACTER)                                    *
  2186*  BENEFIT CODE                                                  *
  2187*  BENEFIT OVERRIDE CODE                                         *
  2188*                                                                *
  2189*  RETURNED FROM ELEARN                                          *
  2190*  --------------------                                          *
  2191*  INDICATED  EARNINGS                                           *
  2192*----------------------------------------------------------------*
  2193*                 LENGTH = 450                                   *
  2194*                                                                *
  2195******************************************************************
  2196******************************************************************
  2197*                   C H A N G E   L O G
  2198*
  2199* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  43
* EL1278.cbl
  2200*-----------------------------------------------------------------
  2201*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2202* EFFECTIVE    NUMBER
  2203*-----------------------------------------------------------------
  2204* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2205* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2206* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2207* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2208* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2209* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2210* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2211* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2212* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2213* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2214* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2215******************************************************************
  2216
  2217 01  CALCULATION-PASS-AREA.
  2218     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2219                                     COMP.
  2220
  2221     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2222       88  NO-CP-ERROR                             VALUE ZERO.
  2223       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2224                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2225       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2226       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2227       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2228       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2229       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2230       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2231       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2232       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2233       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2234       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2235       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2236       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2237       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2238       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2239       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2240       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2241       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2242
  2243     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2244       88  NO-CP-ERROR-2                           VALUE ZERO.
  2245***********************  INPUT AREAS ****************************
  2246
  2247     12  CP-CALCULATION-AREA.
  2248         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2249         16  CP-CERT-EFF-DT        PIC XX.
  2250         16  CP-VALUATION-DT       PIC XX.
  2251         16  CP-PAID-THRU-DT       PIC XX.
  2252         16  CP-BENEFIT-TYPE       PIC X.
  2253           88  CP-AH                               VALUE 'A' 'D'
  2254                                                   'I' 'U'.
  2255           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2256           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2257         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  44
* EL1278.cbl
  2258         16  CP-REPORTED-DT        PIC XX.
  2259         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2260         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2261         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2262                                     COMP-3.
  2263         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2264                                     COMP-3.
  2265         16  CP-CDT-METHOD         PIC X.
  2266           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2267           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2268           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2269         16  CP-CLAIM-TYPE         PIC X.
  2270           88  CP-AH-CLAIM                         VALUE 'A'.
  2271           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2272         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2273                                     COMP-3.
  2274         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2275                                     COMP-3.
  2276         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2277                                     COMP-3.
  2278         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2279                                     COMP-3.
  2280         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2281                                     COMP-3.
  2282         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2283                                     COMP-3.
  2284         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2285                                     COMP-3.
  2286         16  CP-REM-TERM-METHOD    PIC X.
  2287           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2288           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2289           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2290           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2291           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2292           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2293           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2294         16  CP-EARNING-METHOD     PIC X.
  2295           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2296           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2297           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2298           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2299           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2300           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2301           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2302           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2303           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2304           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2305           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2306           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2307           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2308           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2309         16  CP-PROCESS-TYPE       PIC X.
  2310           88  CP-CLAIM                            VALUE '1'.
  2311           88  CP-CANCEL                           VALUE '2'.
  2312           88  CP-ISSUE                            VALUE '3'.
  2313         16  CP-SPECIAL-CALC-CD    PIC X.
  2314           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2315           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  45
* EL1278.cbl
  2316           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2317           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2318           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2319           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2320           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2321           88  CP-FARM-PLAN                    VALUE 'F'.
  2322           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2323           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2324           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2325           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2326           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2327           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2328           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2329           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2330           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2331           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2332                                                     'W' 'X'.
  2333           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2334           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2335           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2336           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2337           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2338           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2339           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2340           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2341           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2342           88  CP-CSL-METH-1                   VALUE '5'.
  2343           88  CP-CSL-METH-2                   VALUE '6'.
  2344           88  CP-CSL-METH-3                   VALUE '7'.
  2345           88  CP-CSL-METH-4                   VALUE '8'.
  2346
  2347         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2348                                     COMP-3.
  2349         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2350         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2351         16  CP-STATE              PIC XX          VALUE SPACE.
  2352         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2353         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2354           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2355               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2356         16  CP-R78-OPTION         PIC X.
  2357           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2358           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2359
  2360         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2361         16  CP-IBNR-RESERVE-SW    PIC X.
  2362         16  CP-CLAIM-STATUS       PIC X.
  2363         16  CP-RATE-FILE          PIC X.
  2364         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2365                                     COMP-3.
  2366
  2367         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2368         16  CP-AH-OVERRIDE-CODE   PIC X.
  2369
  2370         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2371                                     COMP-3.
  2372         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2373                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  46
* EL1278.cbl
  2374         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2375                                     COMP-3.
  2376         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2377                                     COMP-3.
  2378         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2379                                     COMP-3.
  2380         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2381                                  PIC S9(7)V99 COMP-3.
  2382
  2383         16  CP-PAID-FROM-DATE     PIC X(02).
  2384         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2385         16  CP-EXT-DAYS-CALC      PIC X.
  2386           88  CP-EXT-NO-CHG                   VALUE ' '.
  2387           88  CP-EXT-CHG-LF                   VALUE '1'.
  2388           88  CP-EXT-CHG-AH                   VALUE '2'.
  2389           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2390         16  CP-DOMICILE-STATE     PIC XX.
  2391         16  CP-CARRIER            PIC X.
  2392         16  CP-REIN-FLAG          PIC X.
  2393         16  CP-REM-TRM-CALC-OPTION PIC X.
  2394           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2395                      '2' '3' '4' '5'.
  2396           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2397           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2398           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2399           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2400           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2401           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2402           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2403           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2404         16  CP-SIG-SWITCH         PIC X.
  2405         16  CP-RATING-METHOD      PIC X.
  2406           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2407           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2408           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2409           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2410           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2411           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2412           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2413           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2414           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2415         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2416                                     COMP-3.
  2417         16  CP-BEN-CATEGORY       PIC X.
  2418         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2419         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2420                                   PIC S99V9(5) COMP-3.
  2421         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2422         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2423                                   PIC S99V9(5) COMP-3.
  2424         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2425         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2426         16  CP-EXPIRE-DT          PIC XX.
  2427         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2428         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2429         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2430         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2431         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  47
* EL1278.cbl
  2432             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2433             88  CP-CALC-CLP              VALUE 'C'.
  2434         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2435         16  CP-CANCEL-REASON      PIC X.
  2436         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2437         16  CP-PMT-MODE           PIC X.
  2438         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2439         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2440         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2441         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2442         16  FILLER                PIC X.
  2443
  2444***************    OUTPUT FROM ELRESV   ************************
  2445
  2446         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2447
  2448         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2449                                     COMP-3.
  2450         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2451                                     COMP-3.
  2452         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2453                                     COMP-3.
  2454         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2455                                     COMP-3.
  2456         16  FILLER                PIC X(09).
  2457***************    OUTPUT FROM ELRTRM   *************************
  2458
  2459         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2460                                     COMP-3.
  2461         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2462                                     COMP-3.
  2463         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2464                                     COMP-3.
  2465         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2466                                     COMP-3.
  2467         16  FILLER                PIC X(12).
  2468
  2469***************    OUTPUT FROM ELRAMT   *************************
  2470
  2471         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2472                                     COMP-3.
  2473         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2474                                     COMP-3.
  2475         16  FILLER                PIC X(12).
  2476
  2477***************    OUTPUT FROM ELRATE   *************************
  2478
  2479         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2480                                     COMP-3.
  2481         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2482                                     COMP-3.
  2483         16  CP-MORTALITY-CODE     PIC X(4).
  2484         16  CP-RATE-EDIT-FLAG     PIC X.
  2485             88  CP-RATES-NEED-APR                  VALUE '1'.
  2486         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2487                                     COMP-3.
  2488         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2489         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  48
* EL1278.cbl
  2490         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2491                                   PIC S9(7)V99 COMP-3.
  2492         16  FILLER                PIC X(07).
  2493
  2494***************    OUTPUT FROM ELRFND   *************************
  2495
  2496         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2497                                     COMP-3.
  2498         16  CP-REFUND-TYPE-USED   PIC X.
  2499           88  CP-R-AS-R78                         VALUE '1'.
  2500           88  CP-R-AS-PRORATA                     VALUE '2'.
  2501           88  CP-R-AS-CALIF                       VALUE '3'.
  2502           88  CP-R-AS-TEXAS                       VALUE '4'.
  2503           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2504           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2505           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2506           88  CP-R-AS-MEAN                        VALUE '8'.
  2507           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2508           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2509           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2510           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2511           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2512           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2513         16  FILLER                PIC X(12).
  2514
  2515***************    OUTPUT FROM ELEARN   *************************
  2516
  2517         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2518                                     COMP-3.
  2519         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2520                                     COMP-3.
  2521         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2522                                     COMP-3.
  2523         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2524                                     COMP-3.
  2525         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2526                                     COMP-3.
  2527         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2528                                     COMP-3.
  2529         16  CP-EARNING-TYPE-USED  PIC X.
  2530           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2531           88  CP-E-AS-R78                         VALUE '1'.
  2532           88  CP-E-AS-PRORATA                     VALUE '2'.
  2533           88  CP-E-AS-TEXAS                       VALUE '4'.
  2534           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2535           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2536           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2537           88  CP-E-AS-MEAN                        VALUE '8'.
  2538           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2539         16  FILLER                PIC X(12).
  2540
  2541***************    OUTPUT FROM ELPMNT   *************************
  2542
  2543         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2544                                     COMP-3.
  2545         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2546                                     COMP-3.
  2547         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  49
* EL1278.cbl
  2548
  2549***************   MISC WORK AREAS    *****************************
  2550         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2551                                     COMP-3.
  2552         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2553                                     COMP-3.
  2554         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2555                                     COMP-3.
  2556         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2557                                     COMP-3.
  2558         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2559                                     COMP-3.
  2560         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2561                                     COMP-3.
  2562         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2563             88  OPEN-RATE-FILE                   VALUE 'O'.
  2564             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2565             88  IO-ERROR                         VALUE 'E'.
  2566
  2567         16  CP-FIRST-PAY-DATE     PIC XX.
  2568
  2569         16  CP-JOINT-INDICATOR    PIC X.
  2570
  2571         16  CP-RESERVE-REMAINING-TERM
  2572                                   PIC S9(4)V9    VALUE ZERO
  2573                                     COMP-3.
  2574
  2575         16  CP-INSURED-BIRTH-DT   PIC XX.
  2576
  2577         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2578                                     COMP-3.
  2579
  2580         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2581                                     COMP-3.
  2582
  2583         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2584                                     COMP-3.
  2585
  2586         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2587                                     COMP-3.
  2588
  2589         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2590                                     COMP-3.
  2591
  2592         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2593                                     COMP-3.
  2594
  2595         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2596                                     COMP-3.
  2597
  2598         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2599             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2600
  2601         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2602                                     COMP-3.
  2603         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2604                                     COMP-3.
  2605         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  50
* EL1278.cbl
  2606         16  cp-extra-periods      pic 9 value zeros.
  2607         16  cp-net-only-state     pic x value spaces.
  2608         16  FILLER                PIC X(13).
  2609******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  51
* EL1278.cbl
  2611*                            COPY ERCNOTE.
  2612******************************************************************
  2613*                                                                *
  2614*                                                                *
  2615*                            ERCNOTE                             *
  2616*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2617*                            VMOD=2.003                          *
  2618*                                                                *
  2619*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2620*                                                                *
  2621*        FILE TYPE= VSAM,KSDS                                    *
  2622*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2623*                                                                *
  2624*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2625*                                                                *
  2626*        LOG = YES                                               *
  2627*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2628*                                                                *
  2629******************************************************************
  2630*                   C H A N G E   L O G
  2631*
  2632* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2633*-----------------------------------------------------------------
  2634*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2635* EFFECTIVE    NUMBER
  2636*-----------------------------------------------------------------
  2637* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2638*                                FILE WILL CONTAIN BILLING NOTES O
  2639******************************************************************
  2640
  2641 01  CERTIFICATE-NOTE.
  2642     12  CN-RECORD-ID                PIC  XX.
  2643         88  VALID-CN-ID                  VALUE 'CN'.
  2644
  2645     12  CN-CONTROL-PRIMARY.
  2646         16  CN-COMPANY-CD           PIC X.
  2647         16  CN-CARRIER              PIC X.
  2648         16  CN-GROUPING.
  2649             20 CN-GROUPING-PREFIX   PIC XXX.
  2650             20 CN-GROUPING-PRIME    PIC XXX.
  2651         16  CN-STATE                PIC XX.
  2652         16  CN-ACCOUNT.
  2653             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2654             20 CN-ACCOUNT-PRIME     PIC X(6).
  2655         16  CN-CERT-EFF-DT          PIC XX.
  2656         16  CN-CERT-NO.
  2657             20  CN-CERT-PRIME       PIC X(10).
  2658             20  CN-CERT-SFX         PIC X.
  2659
  2660     12  CN-BILLING-START-LINE-NO    PIC 99.
  2661     12  CN-BILLING-END-LINE-NO      PIC 99.
  2662
  2663     12  CN-LINES.
  2664         16  CN-LINE OCCURS 10       PIC X(77).
  2665
  2666     12  CN-LAST-MAINT-DT            PIC XX.
  2667     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2668     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  52
* EL1278.cbl
  2669     12  FILLER                      PIC X(6).
  2670******************************************************************
  2671*                            COPY ERCCTBL.
  2672******************************************************************
  2673*                                                                *
  2674*                                                                *
  2675*                            ERCCTBL                             *
  2676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2677*                            VMOD=2.003
  2678*                                                                *
  2679*   ONLINE CREDIT SYSTEM                                         *
  2680*                                                                *
  2681*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2682*                                                                *
  2683*   FILE TYPE = VSAM,KSDS                                        *
  2684*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2685*                                                                *
  2686*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2687*       ALTERNATE PATH = NONE                                    *
  2688*                                                                *
  2689*   LOG = NO                                                     *
  2690*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2691*                                                                *
  2692*                                                                *
  2693******************************************************************
  2694
  2695 01  COMM-TABLE-RECORD.
  2696     12  CT-RECORD-ID                      PIC XX.
  2697         88  VALID-CT-ID                      VALUE 'CT'.
  2698
  2699     12  CT-CONTROL-PRIMARY.
  2700         16  CT-COMPANY-CD                 PIC X.
  2701         16  CT-TABLE                      PIC XXX.
  2702         16  CT-CNTRL-2.
  2703             20  CT-BEN-TYPE               PIC X.
  2704             20  CT-BEN-CODE               PIC XX.
  2705
  2706     12  CT-MAINT-INFORMATION.
  2707         16  CT-LAST-MAINT-DT              PIC XX.
  2708         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2709         16  CT-LAST-MAINT-USER            PIC X(4).
  2710         16  FILLER                        PIC X(31).
  2711
  2712     12  CT-LIMITS.
  2713         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2714
  2715         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2716
  2717         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2718
  2719     12  CT-RATES.
  2720         16  CT-RTX          OCCURS 27 TIMES.
  2721             20  CT-RT                     PIC SV9(5)     COMP-3.
  2722             20  CT-RT-R   REDEFINES
  2723                 CT-RT                     PIC XXX.
  2724
  2725     12  FILLER                            PIC  X(42).
  2726
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  53
* EL1278.cbl
  2727******************************************************************
  2728
  2729****************************************************************
  2730*
  2731* Copyright (c) 2007 by Clerity Solutions, Inc.
  2732* All rights reserved.
  2733*
  2734****************************************************************
  2735 01  DFHEIV.
  2736   02  DFHEIV0               PIC X(35).
  2737   02  DFHEIV1               PIC X(08).
  2738   02  DFHEIV2               PIC X(08).
  2739   02  DFHEIV3               PIC X(08).
  2740   02  DFHEIV4               PIC X(06).
  2741   02  DFHEIV5               PIC X(04).
  2742   02  DFHEIV6               PIC X(04).
  2743   02  DFHEIV7               PIC X(02).
  2744   02  DFHEIV8               PIC X(02).
  2745   02  DFHEIV9               PIC X(01).
  2746   02  DFHEIV10              PIC S9(7) COMP-3.
  2747   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2748   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2749   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2750   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2751   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2752   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2753   02  DFHEIV17              PIC X(04).
  2754   02  DFHEIV18              PIC X(04).
  2755   02  DFHEIV19              PIC X(04).
  2756   02  DFHEIV20              USAGE IS POINTER.
  2757   02  DFHEIV21              USAGE IS POINTER.
  2758   02  DFHEIV22              USAGE IS POINTER.
  2759   02  DFHEIV23              USAGE IS POINTER.
  2760   02  DFHEIV24              USAGE IS POINTER.
  2761   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2762   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2763   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2764   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2765   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2766   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2767   02  FILLER                PIC X(02).
  2768   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2769   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2770   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2771   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2772   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2773 LINKAGE  SECTION.
  2774*****************************************************************
  2775*                                                               *
  2776* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2777* All rights reserved.                                          *
  2778*                                                               *
  2779*****************************************************************
  2780 01  dfheiblk.
  2781     02  eibtime          pic s9(7) comp-3.
  2782     02  eibdate          pic s9(7) comp-3.
  2783     02  eibtrnid         pic x(4).
  2784     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  54
* EL1278.cbl
  2785     02  eibtrmid         pic x(4).
  2786     02  dfheigdi         pic s9(4) comp.
  2787     02  eibcposn         pic s9(4) comp.
  2788     02  eibcalen         pic s9(4) comp.
  2789     02  eibaid           pic x(1).
  2790     02  eibfiller1       pic x(1).
  2791     02  eibfn            pic x(2).
  2792     02  eibfiller2       pic x(2).
  2793     02  eibrcode         pic x(6).
  2794     02  eibfiller3       pic x(2).
  2795     02  eibds            pic x(8).
  2796     02  eibreqid         pic x(8).
  2797     02  eibrsrce         pic x(8).
  2798     02  eibsync          pic x(1).
  2799     02  eibfree          pic x(1).
  2800     02  eibrecv          pic x(1).
  2801     02  eibsend          pic x(1).
  2802     02  eibatt           pic x(1).
  2803     02  eibeoc           pic x(1).
  2804     02  eibfmh           pic x(1).
  2805     02  eibcompl         pic x(1).
  2806     02  eibsig           pic x(1).
  2807     02  eibconf          pic x(1).
  2808     02  eiberr           pic x(1).
  2809     02  eibrldbk         pic x(1).
  2810     02  eiberrcd         pic x(4).
  2811     02  eibsynrb         pic x(1).
  2812     02  eibnodat         pic x(1).
  2813     02  eibfiller5       pic x(2).
  2814     02  eibresp          pic 9(09) comp.
  2815     02  eibresp2         pic 9(09) comp.
  2816     02  dfheigdj         pic s9(4) comp.
  2817     02  dfheigdk         pic s9(4) comp.
  2818
  2819 01  DFHCOMMAREA                 PIC  X(1024).
  2820
  2821*01 PARMLIST .
  2822*    12  FILLER                  PIC S9(08)      COMP.
  2823*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2824*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2825*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2826*                            COPY ELCCNTL.
  2827******************************************************************
  2828*                                                                *
  2829*                                                                *
  2830*                            ELCCNTL.                            *
  2831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2832*                            VMOD=2.059                          *
  2833*                                                                *
  2834*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2835*                                                                *
  2836*   FILE TYPE = VSAM,KSDS                                        *
  2837*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2838*                                                                *
  2839*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2840*       ALTERNATE INDEX = NONE                                   *
  2841*                                                                *
  2842*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  55
* EL1278.cbl
  2843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2844******************************************************************
  2845*                   C H A N G E   L O G
  2846*
  2847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2848*-----------------------------------------------------------------
  2849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2850* EFFECTIVE    NUMBER
  2851*-----------------------------------------------------------------
  2852* 082503                   PEMA  ADD BENEFIT GROUP
  2853* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2854* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2855* 092705    2005050300006  PEMA  ADD SPP LEASES
  2856* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2857* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2858* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2859* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2860* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2861* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2862* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2863* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2864* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2865* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2866******************************************************************
  2867*
  2868 01  CONTROL-FILE.
  2869     12  CF-RECORD-ID                       PIC XX.
  2870         88  VALID-CF-ID                        VALUE 'CF'.
  2871
  2872     12  CF-CONTROL-PRIMARY.
  2873         16  CF-COMPANY-ID                  PIC XXX.
  2874         16  CF-RECORD-TYPE                 PIC X.
  2875             88  CF-COMPANY-MASTER              VALUE '1'.
  2876             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2877             88  CF-STATE-MASTER                VALUE '3'.
  2878             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2879             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2880             88  CF-CARRIER-MASTER              VALUE '6'.
  2881             88  CF-MORTALITY-MASTER            VALUE '7'.
  2882             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2883             88  CF-TERMINAL-MASTER             VALUE '9'.
  2884             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2885             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2886             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2887             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2888             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2889             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2890             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2891             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2892             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2893         16  CF-ACCESS-CD-GENL              PIC X(4).
  2894         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2895             20  CF-PROCESSOR               PIC X(4).
  2896         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2897             20  CF-STATE-CODE              PIC XX.
  2898             20  FILLER                     PIC XX.
  2899         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2900             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  56
* EL1278.cbl
  2901             20  CF-HI-BEN-IN-REC           PIC XX.
  2902         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2903             20  FILLER                     PIC XXX.
  2904             20  CF-CARRIER-CNTL            PIC X.
  2905         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2906             20  FILLER                     PIC XX.
  2907             20  CF-HI-TYPE-IN-REC          PIC 99.
  2908         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2909             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2910                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2911             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2912             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2913         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2914             20  FILLER                     PIC X.
  2915             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2916         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2917             20  FILLER                     PIC XX.
  2918             20  CF-MORTGAGE-PLAN           PIC XX.
  2919         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2920
  2921     12  CF-LAST-MAINT-DT                   PIC XX.
  2922     12  CF-LAST-MAINT-BY                   PIC X(4).
  2923     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2924
  2925     12  CF-RECORD-BODY                     PIC X(728).
  2926
  2927
  2928****************************************************************
  2929*             COMPANY MASTER RECORD                            *
  2930****************************************************************
  2931
  2932     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2933         16  CF-COMPANY-ADDRESS.
  2934             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2935             20  CF-CL-IN-CARE-OF           PIC X(30).
  2936             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2937             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2938             20  CF-CL-CITY-STATE           PIC X(30).
  2939             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2940             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2941         16  CF-COMPANY-CD                  PIC X.
  2942         16  CF-COMPANY-PASSWORD            PIC X(8).
  2943         16  CF-SECURITY-OPTION             PIC X.
  2944             88  ALL-SECURITY                   VALUE '1'.
  2945             88  COMPANY-VERIFY                 VALUE '2'.
  2946             88  PROCESSOR-VERIFY               VALUE '3'.
  2947             88  NO-SECURITY                    VALUE '4'.
  2948             88  ALL-BUT-TERM                   VALUE '5'.
  2949         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2950             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2951         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2952             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2953         16  CF-INFORCE-LOCATION            PIC X.
  2954             88  CERTS-ARE-ONLINE               VALUE '1'.
  2955             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2956             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2957         16  CF-LOWER-CASE-LETTERS          PIC X.
  2958         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  57
* EL1278.cbl
  2959             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2960             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2961             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2962             88  CF-ACCNT-CNTL                  VALUE '3'.
  2963             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2964
  2965         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2966         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2967
  2968         16  CF-LGX-CREDIT-USER             PIC X.
  2969             88  CO-IS-NOT-USER                 VALUE 'N'.
  2970             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2971
  2972         16 CF-CREDIT-CALC-CODES.
  2973             20  CF-CR-REM-TERM-CALC PIC X.
  2974               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2975               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2976               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2977               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2978               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2979               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2980               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2981             20  CF-CR-R78-METHOD           PIC X.
  2982               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2983               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2984
  2985         16  CF-CLAIM-CONTROL-COUNTS.
  2986             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2987                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2988
  2989             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2990                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2991
  2992             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2993                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2994
  2995             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2996                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2997
  2998         16  CF-CURRENT-MONTH-END           PIC XX.
  2999
  3000         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3001             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3002             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3003             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3004             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3005                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3006                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3007             20  CF-CO-PREM-REJECT-SW       PIC X.
  3008                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3009                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3010             20  CF-CO-REF-REJECT-SW        PIC X.
  3011                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3012                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3013
  3014         16  CF-CO-REPORTING-DT             PIC XX.
  3015         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3016         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  58
* EL1278.cbl
  3017           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3018           88  CF-CO-MONTH-END                  VALUE '1'.
  3019
  3020         16  CF-LGX-CLAIM-USER              PIC X.
  3021             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3022             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3023
  3024         16  CF-CREDIT-EDIT-CONTROLS.
  3025             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3026             20  CF-MIN-AGE                 PIC 99.
  3027             20  CF-DEFAULT-AGE             PIC 99.
  3028             20  CF-MIN-TERM                PIC S999      COMP-3.
  3029             20  CF-MAX-TERM                PIC S999      COMP-3.
  3030             20  CF-DEFAULT-SEX             PIC X.
  3031             20  CF-JOINT-AGE-INPUT         PIC X.
  3032                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3033             20  CF-BIRTH-DATE-INPUT        PIC X.
  3034                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3035             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3036                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3037                 88  CF-ZERO-CARRIER            VALUE '1'.
  3038                 88  CF-ZERO-GROUPING           VALUE '2'.
  3039                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3040             20  CF-EDIT-SW                 PIC X.
  3041                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3042             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3043             20  CF-CR-PR-METHOD            PIC X.
  3044               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3045               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3046             20  FILLER                     PIC X.
  3047
  3048         16  CF-CREDIT-MISC-CONTROLS.
  3049             20  CF-REIN-TABLE-SW           PIC X.
  3050                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3051             20  CF-COMP-TABLE-SW           PIC X.
  3052                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3053             20  CF-EXPERIENCE-RETENTION-AGE
  3054                                            PIC S9        COMP-3.
  3055             20  CF-CONVERSION-DT           PIC XX.
  3056             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3057             20  CF-RUN-FREQUENCY-SW        PIC X.
  3058                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3059                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3060
  3061             20  CF-CR-CHECK-NO-CONTROL.
  3062                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3063                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3064                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3065                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3066                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3067                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3068
  3069                 24  CF-CR-CHECK-COUNT       REDEFINES
  3070                     CF-CR-CHECK-COUNTER      PIC X(4).
  3071
  3072                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3073                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3074
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  59
* EL1278.cbl
  3075                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3076                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3077                 24  CF-MAIL-PROCESSING       PIC X.
  3078                     88  MAIL-PROCESSING          VALUE 'Y'.
  3079
  3080         16  CF-MISC-SYSTEM-CONTROL.
  3081             20  CF-SYSTEM-C                 PIC X.
  3082                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3083             20  CF-SYSTEM-D                 PIC X.
  3084                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3085             20  CF-SOC-SEC-NO-SW            PIC X.
  3086                 88  SOC-SEC-NO-USED             VALUE '1'.
  3087             20  CF-MEMBER-NO-SW             PIC X.
  3088                 88  MEMBER-NO-USED              VALUE '1'.
  3089             20  CF-TAX-ID-NUMBER            PIC X(11).
  3090             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3091             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3092                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3093                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3094                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3095                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3096             20  CF-SYSTEM-E                 PIC X.
  3097                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3098
  3099         16  CF-LGX-LIFE-USER               PIC X.
  3100             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3101             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3102
  3103         16  CF-CR-MONTH-END-DT             PIC XX.
  3104
  3105         16  CF-FILE-MAINT-DATES.
  3106             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3107                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3108             20  CF-LAST-BATCH       REDEFINES
  3109                 CF-LAST-BATCH-NO               PIC X(4).
  3110             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3111             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3112             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3113             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3114             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3115             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3116             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3117             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3118             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3119             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3120
  3121         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3122         16  FILLER                         PIC X.
  3123
  3124         16  CF-ALT-MORT-CODE               PIC X(4).
  3125         16  CF-MEMBER-CAPTION              PIC X(10).
  3126
  3127         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3128             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3129             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3130             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3131             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3132             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  60
* EL1278.cbl
  3133
  3134         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3135
  3136         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3137         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3138         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3139         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3140
  3141         16  CF-AH-OVERRIDE-L1              PIC X.
  3142         16  CF-AH-OVERRIDE-L2              PIC XX.
  3143         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3144         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3145
  3146         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3147         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3148
  3149         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3150         16  CF-AR-LAST-EL860-DT            PIC XX.
  3151         16  CF-MP-MONTH-END-DT             PIC XX.
  3152
  3153         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3154         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3155             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3156
  3157         16  CF-AR-MONTH-END-DT             PIC XX.
  3158
  3159         16  CF-CRDTCRD-USER                PIC X.
  3160             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3161             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3162
  3163         16  CF-CC-MONTH-END-DT             PIC XX.
  3164
  3165         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3166
  3167         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3168             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3169             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3170             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3171         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3172         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3173         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3174         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3175             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3176             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3177         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3178         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3179         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3180             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3181         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3182
  3183         16  CF-CL-ZIP-CODE.
  3184             20  CF-CL-ZIP-PRIME.
  3185                 24  CF-CL-ZIP-1ST          PIC X.
  3186                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3187                 24  FILLER                 PIC X(4).
  3188             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3189         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3190             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  61
* EL1278.cbl
  3191             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3192             20  FILLER                     PIC XXX.
  3193
  3194         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3195         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3196         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3197         16  CF-CO-OPTION-START-DATE        PIC XX.
  3198         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3199           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3200                                                      '3' '4'.
  3201           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3202           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3203           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3204           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3205           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3206           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3207
  3208         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3209
  3210         16  CF-PAYMENT-APPROVAL-LEVELS.
  3211             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3212             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3213             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3214             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3215             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3216             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3217
  3218         16  CF-END-USER-REPORTING-USER     PIC X.
  3219             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3220             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3221
  3222         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3223             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3224             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3225
  3226         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3227
  3228         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3229         16  FILLER                         PIC X.
  3230
  3231         16  CF-CREDIT-ARCHIVE-CNTL.
  3232             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3233             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3234             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3235
  3236         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3237
  3238         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3239             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3240             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3241
  3242         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3243             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3244             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3245
  3246         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3247
  3248         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  62
* EL1278.cbl
  3249             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3250             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3251             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3252         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3253         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3254         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3255         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3256         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3257         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3258         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3259         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3260         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3261                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3262         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3263                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3264
  3265         16  CF-CO-OVER-SHORT.
  3266             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3267             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3268
  3269*         16  FILLER                         PIC X(102).
  3270         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3271             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3272             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3273
  3274         16  CF-AH-APPROVAL-DAYS.
  3275             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3276             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3277             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3278             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3279
  3280         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3281
  3282         16  CF-APPROV-LEV-5.
  3283             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3284             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3285             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3286
  3287         16  FILLER                         PIC X(68).
  3288****************************************************************
  3289*             PROCESSOR/USER RECORD                            *
  3290****************************************************************
  3291
  3292     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3293         16  CF-PROCESSOR-NAME              PIC X(30).
  3294         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3295         16  CF-PROCESSOR-TITLE             PIC X(26).
  3296         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3297                 88  MESSAGE-YES                VALUE 'Y'.
  3298                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3299
  3300*****************************************************
  3301****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3302****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3303****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3304****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3305*****************************************************
  3306
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  63
* EL1278.cbl
  3307         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3308             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3309             20  CF-APPLICATION-FORCE       PIC X.
  3310             20  CF-INDIVIDUAL-APP.
  3311                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3312                     28  CF-BROWSE-APP      PIC X.
  3313                     28  CF-UPDATE-APP      PIC X.
  3314
  3315         16  CF-CURRENT-TERM-ON             PIC X(4).
  3316         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3317             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3318             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3319             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3320             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3321             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3322             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3323             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3324         16  CF-PROCESSOR-CARRIER           PIC X.
  3325             88  NO-CARRIER-SECURITY            VALUE ' '.
  3326         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3327             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3328         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3329             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3330         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3331             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3332
  3333         16  CF-PROC-SYS-ACCESS-SW.
  3334             20  CF-PROC-CREDIT-CLAIMS-SW.
  3335                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3336                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3337                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3338                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3339             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3340                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3341                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3342             20  CF-PROC-LIFE-GNRLDGR-SW.
  3343                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3344                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3345                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3346                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3347             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3348                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3349                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3350         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3351             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3352             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3353         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3354
  3355         16  CF-APPROVAL-LEVEL                  PIC X.
  3356             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3357             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3358             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3359             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3360             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3361
  3362         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3363
  3364         16  CF-LANGUAGE-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  64
* EL1278.cbl
  3365             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3366             88  CF-LANG-IS-FR                      VALUE 'F'.
  3367
  3368         16  CF-CSR-IND                         PIC X.
  3369         16  FILLER                             PIC X(239).
  3370
  3371****************************************************************
  3372*             PROCESSOR/REMINDERS RECORD                       *
  3373****************************************************************
  3374
  3375     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3376         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3377             20  CF-START-REMIND-DT         PIC XX.
  3378             20  CF-END-REMIND-DT           PIC XX.
  3379             20  CF-REMINDER-TEXT           PIC X(50).
  3380         16  FILLER                         PIC X(296).
  3381
  3382
  3383****************************************************************
  3384*             STATE MASTER RECORD                              *
  3385****************************************************************
  3386
  3387     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3388         16  CF-STATE-ABBREVIATION          PIC XX.
  3389         16  CF-STATE-NAME                  PIC X(25).
  3390         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3391         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3392             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3393             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3394             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3395             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3396                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3397                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3398             20  CF-ST-PREM-REJECT-SW       PIC X.
  3399                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3400                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3401             20  CF-ST-REF-REJECT-SW        PIC X.
  3402                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3403                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3404         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3405         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3406         16  CF-ST-REFUND-RULES.
  3407             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3408             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3409             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3410         16  CF-ST-FST-PMT-EXTENSION.
  3411             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3412             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3413                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3414                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3415                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3416                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3417         16  CF-ST-STATE-CALL.
  3418             20  CF-ST-CALL-UNEARNED        PIC X.
  3419             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3420             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3421         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3422             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  65
* EL1278.cbl
  3423             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3424         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3425         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3426         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3427         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3428         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3429         16  FILLER                         PIC X.
  3430         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3431             20  CF-ST-BENEFIT-CD           PIC XX.
  3432             20  CF-ST-BENEFIT-KIND         PIC X.
  3433                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3434                 88  CF-ST-AH-KIND              VALUE 'A'.
  3435             20  CF-ST-REM-TERM-CALC        PIC X.
  3436                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3437                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3438                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3439                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3440                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3441                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3442                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3443                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3444
  3445             20  CF-ST-REFUND-CALC          PIC X.
  3446                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3447                 88  ST-REFD-BY-R78             VALUE '1'.
  3448                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3449                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3450                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3451                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3452                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3453                 88  ST-REFD-UTAH               VALUE '7'.
  3454                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3455                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3456                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3457
  3458             20  CF-ST-EARNING-CALC         PIC X.
  3459                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3460                 88  ST-EARN-BY-R78             VALUE '1'.
  3461                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3462                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3463                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3464                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3465                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3466                 88  ST-EARN-MEAN               VALUE '8'.
  3467                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3468
  3469             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3470                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3471                 88  ST-OVRD-BY-R78             VALUE '1'.
  3472                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3473                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3474                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3475                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3476                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3477                 88  ST-OVRD-MEAN               VALUE '8'.
  3478                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3479             20  cf-st-extra-periods        pic 9.
  3480*            20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  66
* EL1278.cbl
  3481
  3482         16  CF-ST-COMMISSION-CAPS.
  3483             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3484             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3485             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3486             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3487         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3488                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3489
  3490         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3491
  3492         16  CF-ST-STATUTORY-INTEREST.
  3493             20  CF-ST-STAT-DATE-FROM       PIC X.
  3494                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3495                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3496             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3497             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3498             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3499             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3500             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3501
  3502         16  CF-ST-OVER-SHORT.
  3503             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3504             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3505
  3506         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3507
  3508         16  CF-ST-RT-CALC                  PIC X.
  3509
  3510         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3511         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3512         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3513         16  CF-ST-RF-LR-CALC               PIC X.
  3514         16  CF-ST-RF-LL-CALC               PIC X.
  3515         16  CF-ST-RF-LN-CALC               PIC X.
  3516         16  CF-ST-RF-AH-CALC               PIC X.
  3517         16  CF-ST-RF-CP-CALC               PIC X.
  3518*        16  FILLER                         PIC X(206).
  3519*CIDMOD         16  FILLER                         PIC X(192).
  3520         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3521             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3522         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3523         16  CF-ST-VFY-2ND-BENE             PIC X.
  3524         16  CF-ST-CAUSAL-STATE             PIC X.
  3525         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3526         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3527         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3528             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3529         16  CF-ST-NET-ONLY-STATE           PIC X.
  3530             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3531         16  FILLER                         PIC X(181).
  3532
  3533****************************************************************
  3534*             BENEFIT MASTER RECORD                            *
  3535****************************************************************
  3536
  3537     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3538         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  67
* EL1278.cbl
  3539             20  CF-BENEFIT-CODE            PIC XX.
  3540             20  CF-BENEFIT-NUMERIC  REDEFINES
  3541                 CF-BENEFIT-CODE            PIC XX.
  3542             20  CF-BENEFIT-ALPHA           PIC XXX.
  3543             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3544             20  CF-BENEFIT-COMMENT         PIC X(10).
  3545
  3546             20  CF-LF-COVERAGE-TYPE        PIC X.
  3547                 88  CF-REDUCING                VALUE 'R'.
  3548                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3549
  3550             20  CF-SPECIAL-CALC-CD         PIC X.
  3551                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3552                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3553                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3554                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3555                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3556                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3557                 88  CF-FARM-PLAN               VALUE 'F'.
  3558                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3559                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3560                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3561                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3562                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3563                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3564                 88  CF-PRUDENTIAL              VALUE 'P'.
  3565                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3566                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3567                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3568                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3569                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3570                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3571
  3572             20  CF-JOINT-INDICATOR         PIC X.
  3573                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3574
  3575*            20  FILLER                     PIC X(12).
  3576             20  cf-maximum-benefits        pic s999 comp-3.
  3577             20  FILLER                     PIC X(09).
  3578             20  CF-BENEFIT-CATEGORY        PIC X.
  3579             20  CF-LOAN-TYPE               PIC X(8).
  3580
  3581             20  CF-CO-REM-TERM-CALC        PIC X.
  3582                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3583                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3584                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3585                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3586                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3587
  3588             20  CF-CO-EARNINGS-CALC        PIC X.
  3589                 88  CO-EARN-BY-R78             VALUE '1'.
  3590                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3591                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3592                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3593                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3594                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3595                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3596                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  68
* EL1278.cbl
  3597
  3598             20  CF-CO-REFUND-CALC          PIC X.
  3599                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3600                 88  CO-REFD-BY-R78             VALUE '1'.
  3601                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3602                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3603                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3604                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3605                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3606                 88  CO-REFD-MEAN               VALUE '8'.
  3607                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3608                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3609                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3610
  3611             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3612                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3613                 88  CO-OVRD-BY-R78             VALUE '1'.
  3614                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3615                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3616                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3617                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3618                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3619                 88  CO-OVRD-MEAN               VALUE '8'.
  3620                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3621
  3622             20  CF-CO-BEN-I-G-CD           PIC X.
  3623                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3624                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3625                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3626
  3627         16  FILLER                         PIC X(304).
  3628
  3629
  3630****************************************************************
  3631*             CARRIER MASTER RECORD                            *
  3632****************************************************************
  3633
  3634     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3635         16  CF-ADDRESS-DATA.
  3636             20  CF-MAIL-TO-NAME            PIC X(30).
  3637             20  CF-IN-CARE-OF              PIC X(30).
  3638             20  CF-ADDRESS-LINE-1          PIC X(30).
  3639             20  CF-ADDRESS-LINE-2          PIC X(30).
  3640             20  CF-CITY-STATE              PIC X(30).
  3641             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3642             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3643
  3644         16  CF-CLAIM-NO-CONTROL.
  3645             20  CF-CLAIM-NO-METHOD         PIC X.
  3646                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3647                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3648                 88  CLAIM-NO-SEQ               VALUE '3'.
  3649                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3650             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3651                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3652                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3653                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3654
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  69
* EL1278.cbl
  3655         16  CF-CHECK-NO-CONTROL.
  3656             20  CF-CHECK-NO-METHOD         PIC X.
  3657                 88  CHECK-NO-MANUAL            VALUE '1'.
  3658                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3659                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3660                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3661             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3662                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3663
  3664         16  CF-DOMICILE-STATE              PIC XX.
  3665
  3666         16  CF-EXPENSE-CONTROLS.
  3667             20  CF-EXPENSE-METHOD          PIC X.
  3668                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3669                 88  DOLLARS-PER-PMT            VALUE '2'.
  3670                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3671                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3672             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3673             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3674
  3675         16  CF-CORRESPONDENCE-CONTROL.
  3676             20  CF-LETTER-RESEND-OPT       PIC X.
  3677                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3678                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3679             20  FILLER                     PIC X(4).
  3680
  3681         16  CF-RESERVE-CONTROLS.
  3682             20  CF-MANUAL-SW               PIC X.
  3683                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3684             20  CF-FUTURE-SW               PIC X.
  3685                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3686             20  CF-PTC-SW                  PIC X.
  3687                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3688             20  CF-IBNR-SW                 PIC X.
  3689                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3690             20  CF-PTC-LF-SW               PIC X.
  3691                 88  CF-LF-PTC-USED             VALUE '1'.
  3692             20  CF-CDT-ACCESS-METHOD       PIC X.
  3693                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3694                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3695                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3696             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3697
  3698         16  CF-CLAIM-CALC-METHOD           PIC X.
  3699             88  360-PLUS-MONTHS                VALUE '1'.
  3700             88  365-PLUS-MONTHS                VALUE '2'.
  3701             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3702             88  360-DAILY                      VALUE '4'.
  3703             88  365-DAILY                      VALUE '5'.
  3704
  3705         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3706         16  FILLER                         PIC X(11).
  3707
  3708         16  CF-LIMIT-AMOUNTS.
  3709             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3710             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3711             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3712             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  70
* EL1278.cbl
  3713             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3714             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3715             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3716             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3717             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3718             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3719
  3720         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3721         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3722         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3723
  3724         16  CF-ZIP-CODE.
  3725             20  CF-ZIP-PRIME.
  3726                 24  CF-ZIP-1ST             PIC X.
  3727                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3728                 24  FILLER                 PIC X(4).
  3729             20  CF-ZIP-PLUS4               PIC X(4).
  3730         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3731             20  CF-CAN-POSTAL-1            PIC XXX.
  3732             20  CF-CAN-POSTAL-2            PIC XXX.
  3733             20  FILLER                     PIC XXX.
  3734
  3735         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3736         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3737         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3738
  3739         16  CF-RATING-SWITCH               PIC X.
  3740             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3741             88  CF-NO-RATING                   VALUE 'N'.
  3742
  3743         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3744
  3745         16  CF-CARRIER-OVER-SHORT.
  3746             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3747             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3748
  3749         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3750         16  CF-SECPAY-SWITCH               PIC X.
  3751             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3752             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3753         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3754         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3755         16  FILLER                         PIC X(444).
  3756*        16  FILLER                         PIC X(452).
  3757
  3758
  3759****************************************************************
  3760*             MORTALITY MASTER RECORD                          *
  3761****************************************************************
  3762
  3763     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3764         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3765                                INDEXED BY CF-MORT-NDX.
  3766             20  CF-MORT-TABLE              PIC X(5).
  3767             20  CF-MORT-TABLE-TYPE         PIC X.
  3768                 88  CF-MORT-JOINT              VALUE 'J'.
  3769                 88  CF-MORT-SINGLE             VALUE 'S'.
  3770                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  71
* EL1278.cbl
  3771                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3772                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3773             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3774             20  CF-MORT-AGE-METHOD         PIC XX.
  3775                 88  CF-AGE-LAST                VALUE 'AL'.
  3776                 88  CF-AGE-NEAR                VALUE 'AN'.
  3777             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3778             20  CF-MORT-ADJUSTMENT-DIRECTION
  3779                                            PIC X.
  3780                 88  CF-MINUS                   VALUE '-'.
  3781                 88  CF-PLUS                    VALUE '+'.
  3782             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3783             20  CF-MORT-JOINT-CODE         PIC X.
  3784                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3785             20  CF-MORT-PC-Q               PIC X.
  3786                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3787             20  CF-MORT-TABLE-CODE         PIC X(4).
  3788             20  CF-MORT-COMMENTS           PIC X(15).
  3789             20  FILLER                     PIC X(14).
  3790
  3791         16  FILLER                         PIC X(251).
  3792
  3793
  3794****************************************************************
  3795*             BUSSINESS TYPE MASTER RECORD                     *
  3796****************************************************************
  3797
  3798     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3799* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3800* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3801* AND RECORD 05 IS TYPES 81-99
  3802         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3803             20  CF-BUSINESS-TITLE          PIC  X(19).
  3804             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3805                                            PIC S9V9(4) COMP-3.
  3806             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3807             20  FILLER                     PIC  X.
  3808         16  FILLER                         PIC  X(248).
  3809
  3810
  3811****************************************************************
  3812*             TERMINAL MASTER RECORD                           *
  3813****************************************************************
  3814
  3815     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3816
  3817         16  CF-COMPANY-TERMINALS.
  3818             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3819                                  PIC X(4).
  3820         16  FILLER               PIC X(248).
  3821
  3822
  3823****************************************************************
  3824*             LIFE EDIT MASTER RECORD                          *
  3825****************************************************************
  3826
  3827     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3828         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  72
* EL1278.cbl
  3829             20  CF-LIFE-CODE-IN            PIC XX.
  3830             20  CF-LIFE-CODE-OUT           PIC XX.
  3831         16  FILLER                         PIC X(248).
  3832
  3833
  3834****************************************************************
  3835*             AH EDIT MASTER RECORD                            *
  3836****************************************************************
  3837
  3838     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3839         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3840             20  CF-AH-CODE-IN              PIC XXX.
  3841             20  CF-AH-CODE-OUT             PIC XX.
  3842         16  FILLER                         PIC X(248).
  3843
  3844
  3845****************************************************************
  3846*             CREDIBILITY TABLES                               *
  3847****************************************************************
  3848
  3849     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3850         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3851                             INDEXED BY CF-CRDB-NDX.
  3852             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3853             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3854             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3855         16  FILLER                         PIC  X(332).
  3856
  3857
  3858****************************************************************
  3859*             REPORT CUSTOMIZATION RECORD                      *
  3860****************************************************************
  3861
  3862     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3863         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3864             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3865             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3866             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3867**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3868****       A T-TRANSFER.                                   ****
  3869             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3870
  3871         16  FILLER                         PIC XX.
  3872
  3873         16  CF-CARRIER-CNTL-OPT.
  3874             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3875                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3876                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3877             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3878                                            PIC X.
  3879         16  CF-GROUP-CNTL-OPT.
  3880             20  CF-GROUP-OPT-SEQ           PIC 9.
  3881                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3882                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3883             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3884                                            PIC X(6).
  3885         16  CF-STATE-CNTL-OPT.
  3886             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  73
* EL1278.cbl
  3887                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3888                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3889             20  CF-STATE-SELECT OCCURS 3 TIMES
  3890                                            PIC XX.
  3891         16  CF-ACCOUNT-CNTL-OPT.
  3892             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3893                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3894                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3895             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3896                                            PIC X(10).
  3897         16  CF-BUS-TYP-CNTL-OPT.
  3898             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3899                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3900                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3901             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3902                                            PIC XX.
  3903         16  CF-LF-TYP-CNTL-OPT.
  3904             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3905                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3906                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3907             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3908                                            PIC XX.
  3909         16  CF-AH-TYP-CNTL-OPT.
  3910             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3911                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3912                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3913             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3914                                            PIC XX.
  3915         16  CF-REPTCD1-CNTL-OPT.
  3916             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3917                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3918                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3919             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3920                                            PIC X(10).
  3921         16  CF-REPTCD2-CNTL-OPT.
  3922             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3923                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3924                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3925             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3926                                            PIC X(10).
  3927         16  CF-USER1-CNTL-OPT.
  3928             20  CF-USER1-OPT-SEQ           PIC 9.
  3929                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3930                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3931             20  CF-USER1-SELECT OCCURS 3 TIMES
  3932                                            PIC X(10).
  3933         16  CF-USER2-CNTL-OPT.
  3934             20  CF-USER2-OPT-SEQ           PIC 9.
  3935                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3936                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3937             20  CF-USER2-SELECT OCCURS 3 TIMES
  3938                                            PIC X(10).
  3939         16  CF-USER3-CNTL-OPT.
  3940             20  CF-USER3-OPT-SEQ           PIC 9.
  3941                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3942                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3943             20  CF-USER3-SELECT OCCURS 3 TIMES
  3944                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  74
* EL1278.cbl
  3945         16  CF-USER4-CNTL-OPT.
  3946             20  CF-USER4-OPT-SEQ           PIC 9.
  3947                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3948                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3949             20  CF-USER4-SELECT OCCURS 3 TIMES
  3950                                            PIC X(10).
  3951         16  CF-USER5-CNTL-OPT.
  3952             20  CF-USER5-OPT-SEQ           PIC 9.
  3953                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3954                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3955             20  CF-USER5-SELECT OCCURS 3 TIMES
  3956                                            PIC X(10).
  3957         16  CF-REINS-CNTL-OPT.
  3958             20  CF-REINS-OPT-SEQ           PIC 9.
  3959                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3960                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3961             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3962                 24  CF-REINS-PRIME         PIC XXX.
  3963                 24  CF-REINS-SUB           PIC XXX.
  3964
  3965         16  CF-AGENT-CNTL-OPT.
  3966             20  CF-AGENT-OPT-SEQ           PIC 9.
  3967                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3968                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3969             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3970                                            PIC X(10).
  3971
  3972         16  FILLER                         PIC X(43).
  3973
  3974         16  CF-LOSS-RATIO-SELECT.
  3975             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3976             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3977         16  CF-ENTRY-DATE-SELECT.
  3978             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3979             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3980         16  CF-EFFECTIVE-DATE-SELECT.
  3981             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3982             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3983
  3984         16  CF-EXCEPTION-LIST-IND          PIC X.
  3985             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3986
  3987         16  FILLER                         PIC X(318).
  3988
  3989****************************************************************
  3990*                  EXCEPTION REPORTING RECORD                  *
  3991****************************************************************
  3992
  3993     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3994         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3995             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3996
  3997         16  CF-COMBINED-LIFE-AH-OPT.
  3998             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3999             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4000             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4001             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4002
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  75
* EL1278.cbl
  4003         16  CF-LIFE-OPT.
  4004             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4005             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4006             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4007             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4008             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4009             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4010             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4011             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4012             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4013             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4014
  4015         16  CF-AH-OPT.
  4016             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4017             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4018             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4019             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4020             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4021             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4022             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4023             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4024             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4025             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4026
  4027         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4028             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4029             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4030             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4031
  4032         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4033
  4034         16  FILLER                         PIC X(673).
  4035
  4036
  4037****************************************************************
  4038*             MORTGAGE SYSTEM PLAN RECORD                      *
  4039****************************************************************
  4040
  4041     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4042         16  CF-PLAN-TYPE                   PIC X.
  4043             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4044             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4045             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4046         16  CF-PLAN-ABBREV                 PIC XXX.
  4047         16  CF-PLAN-DESCRIPT               PIC X(10).
  4048         16  CF-PLAN-NOTES                  PIC X(20).
  4049         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4050         16  CF-PLAN-UNDERWRITING.
  4051             20  CF-PLAN-TERM-DATA.
  4052                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4053                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4054             20  CF-PLAN-AGE-DATA.
  4055                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4056                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4057                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4058             20  CF-PLAN-BENEFIT-DATA.
  4059                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4060                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  76
* EL1278.cbl
  4061                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4062                                            PIC S9(7)V99  COMP-3.
  4063         16  CF-PLAN-POLICY-FORMS.
  4064             20  CF-POLICY-FORM             PIC X(12).
  4065             20  CF-MASTER-APPLICATION      PIC X(12).
  4066             20  CF-MASTER-POLICY           PIC X(12).
  4067         16  CF-PLAN-RATING.
  4068             20  CF-RATE-CODE               PIC X(5).
  4069             20  CF-SEX-RATING              PIC X.
  4070                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4071                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4072             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4073             20  CF-SUB-STD-TYPE            PIC X.
  4074                 88  CF-PCT-OF-PREM            VALUE '1'.
  4075                 88  CF-PCT-OF-BENE            VALUE '2'.
  4076         16  CF-PLAN-PREM-TOLERANCES.
  4077             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4078             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4079         16  CF-PLAN-PYMT-TOLERANCES.
  4080             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4081             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4082         16  CF-PLAN-MISC-DATA.
  4083             20  FILLER                     PIC X.
  4084             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4085             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4086         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4087         16  CF-PLAN-IND-GRP                PIC X.
  4088             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4089                                                     '1'.
  4090             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4091                                                     '2'.
  4092         16  CF-MIB-SEARCH-SW               PIC X.
  4093             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4094             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4095             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4096             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4097         16  CF-ALPHA-SEARCH-SW             PIC X.
  4098             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4099             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4100             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4101             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4102             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4103             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4104             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4105             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4106             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4107             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4108                                                     'A' 'B' 'C'
  4109                                                     'X' 'Y' 'Z'.
  4110         16  CF-EFF-DT-RULE-SW              PIC X.
  4111             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4112             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4113             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4114             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4115             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4116         16  FILLER                         PIC X(4).
  4117         16  CF-HEALTH-QUESTIONS            PIC X.
  4118             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  77
* EL1278.cbl
  4119         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4120         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4121         16  CF-PLAN-SNGL-JNT               PIC X.
  4122             88  CF-COMBINED-PLAN              VALUE 'C'.
  4123             88  CF-JNT-PLAN                   VALUE 'J'.
  4124             88  CF-SNGL-PLAN                  VALUE 'S'.
  4125         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4126         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4127         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4128         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4129         16  CF-RERATE-CNTL                 PIC  X.
  4130             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4131             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4132             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4133             88  CF-AUTO-RECALC                 VALUE '4'.
  4134         16  CF-BENEFIT-TYPE                PIC  X.
  4135             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4136             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4137         16  CF-POLICY-FEE                  PIC S999V99
  4138                                                    COMP-3.
  4139         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4140         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4141         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4142         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4143         16  FILLER                         PIC  X(32).
  4144         16  CF-TERMINATION-FORM            PIC  X(04).
  4145         16  FILLER                         PIC  X(08).
  4146         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4147                                                       COMP-3.
  4148         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4149         16  CF-ISSUE-LETTER                PIC  X(4).
  4150         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4151         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4152             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4153             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4154         16  CF-MP-REFUND-CALC              PIC X.
  4155             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4156             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4157             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4158             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4159             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4160             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4161             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4162             88  CF-MP-REFD-MEAN                VALUE '8'.
  4163         16  CF-ALT-RATE-CODE               PIC  X(5).
  4164
  4165
  4166         16  FILLER                         PIC X(498).
  4167****************************************************************
  4168*             MORTGAGE COMPANY MASTER RECORD                   *
  4169****************************************************************
  4170
  4171     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4172         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4173         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4174             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4175             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4176             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  78
* EL1278.cbl
  4177             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4178             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4179
  4180         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4181         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4182         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4183         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4184         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4185
  4186         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4187             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4188         16  CF-MP-RECON-USE-IND            PIC X(1).
  4189             88  CF-MP-USE-RECON             VALUE 'Y'.
  4190         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4191             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4192         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4193             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4194             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4195         16  FILLER                         PIC X(1).
  4196         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4197             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4198         16  CF-MORTG-MIB-VERSION           PIC X.
  4199             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4200             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4201             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4202         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4203             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4204                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4205             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4206                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4207             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4208                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4209             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4210                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4211             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4212                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4213             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4214                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4215         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4216         16  FILLER                         PIC X(7).
  4217         16  CF-MORTG-DESTINATION-SYMBOL.
  4218             20  CF-MORTG-MIB-COMM          PIC X(5).
  4219             20  CF-MORTG-MIB-TERM          PIC X(5).
  4220         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4221             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4222         16  FILLER                         PIC X(03).
  4223         16  CF-MP-CHECK-NO-CONTROL.
  4224             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4225                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4226                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4227                                                ' ' LOW-VALUES.
  4228                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4229                                               VALUE '3'.
  4230         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4231         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4232         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4233             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4234                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  79
* EL1278.cbl
  4235             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4236                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4237             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4238                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4239             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4240                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4241             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4242                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4243             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4244                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4245         16  CF-MORTG-BILLING-AREA.
  4246             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4247                                            PIC X.
  4248         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4249         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4250         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4251         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4252             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4253             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4254         16  FILLER                         PIC X.
  4255         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4256             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4257             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4258         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4259         16  FILLER                         PIC X(8).
  4260         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4261         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4262         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4263         16  CF-ACH-COMPANY-ID.
  4264             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4265                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4266                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4267                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4268             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4269         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4270             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4271         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4272             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4273             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4274         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4275         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4276         16  FILLER                         PIC X(536).
  4277
  4278****************************************************************
  4279*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4280****************************************************************
  4281
  4282     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4283         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4284             20  CF-FEMALE-HEIGHT.
  4285                 24  CF-FEMALE-FT           PIC 99.
  4286                 24  CF-FEMALE-IN           PIC 99.
  4287             20  CF-FEMALE-MIN-WT           PIC 999.
  4288             20  CF-FEMALE-MAX-WT           PIC 999.
  4289         16  FILLER                         PIC X(428).
  4290
  4291     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4292         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  80
* EL1278.cbl
  4293             20  CF-MALE-HEIGHT.
  4294                 24  CF-MALE-FT             PIC 99.
  4295                 24  CF-MALE-IN             PIC 99.
  4296             20  CF-MALE-MIN-WT             PIC 999.
  4297             20  CF-MALE-MAX-WT             PIC 999.
  4298         16  FILLER                         PIC X(428).
  4299******************************************************************
  4300*             AUTOMATIC ACTIVITY RECORD                          *
  4301******************************************************************
  4302     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4303         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4304             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4305             20  CF-SYS-LETTER-ID           PIC X(04).
  4306             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4307             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4308             20  CF-SYS-RESET-SW            PIC X(01).
  4309             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4310             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4311
  4312         16  FILLER                         PIC X(50).
  4313
  4314         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4315             20  CF-USER-ACTIVE-SW          PIC X(01).
  4316             20  CF-USER-LETTER-ID          PIC X(04).
  4317             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4318             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4319             20  CF-USER-RESET-SW           PIC X(01).
  4320             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4321             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4322             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4323
  4324         16  FILLER                         PIC X(246).
  4325*                            COPY ERCACCT.
  4326******************************************************************
  4327*                                                                *
  4328*                                                                *
  4329*                            ERCACCT                             *
  4330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4331*                            VMOD=2.031                          *
  4332*                                                                *
  4333*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4334*                                                                *
  4335*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4336*   VSAM ACCOUNT MASTER FILES.                                   *
  4337*                                                                *
  4338*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4339*                                                                *
  4340*   FILE TYPE = VSAM,KSDS                                        *
  4341*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4342*                                                                *
  4343*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4344*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4345*                                                                *
  4346*   LOG = NO                                                     *
  4347*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4348*                                                                *
  4349*                                                                *
  4350******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  81
* EL1278.cbl
  4351*                   C H A N G E   L O G
  4352*
  4353* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4354*-----------------------------------------------------------------
  4355*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4356* EFFECTIVE    NUMBER
  4357*-----------------------------------------------------------------
  4358* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4359* 092705    2005050300006  PEMA  ADD SPP LEASES
  4360* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4361* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4362* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4363* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4364* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4365******************************************************************
  4366
  4367 01  ACCOUNT-MASTER.
  4368     12  AM-RECORD-ID                      PIC XX.
  4369         88  VALID-AM-ID                      VALUE 'AM'.
  4370
  4371     12  AM-CONTROL-PRIMARY.
  4372         16  AM-COMPANY-CD                 PIC X.
  4373         16  AM-MSTR-CNTRL.
  4374             20  AM-CONTROL-A.
  4375                 24  AM-CARRIER            PIC X.
  4376                 24  AM-GROUPING.
  4377                     28 AM-GROUPING-PREFIX PIC XXX.
  4378                     28 AM-GROUPING-PRIME  PIC XXX.
  4379                 24  AM-STATE              PIC XX.
  4380                 24  AM-ACCOUNT.
  4381                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4382                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4383             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4384                                           PIC X(19).
  4385             20  AM-CNTRL-B.
  4386                 24  AM-EXPIRATION-DT      PIC XX.
  4387                 24  FILLER                PIC X(4).
  4388             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4389                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4390
  4391     12  AM-CONTROL-BY-VAR-GRP.
  4392         16  AM-COMPANY-CD-A1              PIC X.
  4393         16  AM-VG-CARRIER                 PIC X.
  4394         16  AM-VG-GROUPING                PIC X(6).
  4395         16  AM-VG-STATE                   PIC XX.
  4396         16  AM-VG-ACCOUNT                 PIC X(10).
  4397         16  AM-VG-DATE.
  4398             20  AM-VG-EXPIRATION-DT       PIC XX.
  4399             20  FILLER                    PIC X(4).
  4400         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4401                                           PIC 9(11)      COMP-3.
  4402     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4403         16  FILLER                        PIC X(10).
  4404         16  AM-VG-KEY3.
  4405             20  AM-VG3-ACCOUNT            PIC X(10).
  4406             20  AM-VG3-EXP-DT             PIC XX.
  4407         16  FILLER                        PIC X(4).
  4408     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  82
* EL1278.cbl
  4409         16  AM-LAST-MAINT-DT              PIC XX.
  4410         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4411         16  AM-LAST-MAINT-USER            PIC X(4).
  4412         16  FILLER                        PIC XX.
  4413
  4414     12  AM-EFFECTIVE-DT                   PIC XX.
  4415     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4416
  4417     12  AM-PREV-DATES  COMP-3.
  4418         16  AM-PREV-EXP-DT                PIC 9(11).
  4419         16  AM-PREV-EFF-DT                PIC 9(11).
  4420
  4421     12  AM-REPORT-CODE-1                  PIC X(10).
  4422     12  AM-REPORT-CODE-2                  PIC X(10).
  4423
  4424     12  AM-CITY-CODE                      PIC X(4).
  4425     12  AM-COUNTY-PARISH                  PIC X(6).
  4426
  4427     12  AM-NAME                           PIC X(30).
  4428     12  AM-PERSON                         PIC X(30).
  4429     12  AM-ADDRS                          PIC X(30).
  4430     12  AM-CITY.
  4431         16  AM-ADDR-CITY                  PIC X(28).
  4432         16  AM-ADDR-STATE                 PIC XX.
  4433     12  AM-ZIP.
  4434         16  AM-ZIP-PRIME.
  4435             20  AM-ZIP-PRI-1ST            PIC X.
  4436                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4437             20  FILLER                    PIC X(4).
  4438         16  AM-ZIP-PLUS4                  PIC X(4).
  4439     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4440         16  AM-CAN-POSTAL-1               PIC XXX.
  4441         16  AM-CAN-POSTAL-2               PIC XXX.
  4442         16  FILLER                        PIC XXX.
  4443     12  AM-TEL-NO.
  4444         16  AM-AREA-CODE                  PIC 999.
  4445         16  AM-TEL-PRE                    PIC 999.
  4446         16  AM-TEL-NBR                    PIC 9(4).
  4447     12  AM-TEL-LOC                        PIC X.
  4448         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4449         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4450
  4451     12  AM-COMM-STRUCTURE.
  4452         16  AM-DEFN-1.
  4453             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4454                 24  AM-AGT.
  4455                     28  AM-AGT-PREFIX     PIC X(4).
  4456                     28  AM-AGT-PRIME      PIC X(6).
  4457                 24  AM-COM-TYP            PIC X.
  4458                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4459                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4460                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4461                 24  AM-RECALC-LV-INDIC    PIC X.
  4462                 24  AM-RETRO-LV-INDIC     PIC X.
  4463                 24  AM-GL-CODES           PIC X.
  4464                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4465                 24  FILLER                PIC X(01).
  4466         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  83
* EL1278.cbl
  4467             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4468                 24  FILLER                PIC X(11).
  4469                 24  AM-L-COMA             PIC XXX.
  4470                 24  AM-J-COMA             PIC XXX.
  4471                 24  AM-A-COMA             PIC XXX.
  4472                 24  FILLER                PIC X(6).
  4473
  4474     12  AM-COMM-CHANGE-STATUS             PIC X.
  4475         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4476
  4477     12  AM-CSR-CODE                       PIC X(4).
  4478
  4479     12  AM-BILLING-STATUS                 PIC X.
  4480         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4481         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4482     12  AM-AUTO-REFUND-SW                 PIC X.
  4483         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4484         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4485     12  AM-GPCD                           PIC 99.
  4486     12  AM-IG                             PIC X.
  4487         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4488         88  AM-HAS-GROUP                     VALUE '2'.
  4489     12  AM-STATUS                         PIC X.
  4490         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4491         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4492         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4493         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4494         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4495         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4496     12  AM-REMIT-TO                       PIC 99.
  4497     12  AM-ID-NO                          PIC X(11).
  4498
  4499     12  AM-CAL-TABLE                      PIC XX.
  4500     12  AM-LF-DEVIATION                   PIC XXX.
  4501     12  AM-AH-DEVIATION                   PIC XXX.
  4502     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4503     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4504     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4505     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4506     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4507     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4508
  4509     12  AM-USER-FIELDS.
  4510         16  AM-FLD-1                      PIC XX.
  4511         16  AM-FLD-2                      PIC XX.
  4512         16  AM-FLD-3                      PIC XX.
  4513         16  AM-FLD-4                      PIC XX.
  4514         16  AM-FLD-5                      PIC XX.
  4515
  4516     12  AM-1ST-PROD-DATE.
  4517         16  AM-1ST-PROD-YR                PIC XX.
  4518         16  AM-1ST-PROD-MO                PIC XX.
  4519         16  AM-1ST-PROD-DA                PIC XX.
  4520     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4521     12  AM-CERTS-PURGED-DATE.
  4522         16  AM-PUR-YR                     PIC XX.
  4523         16  AM-PUR-MO                     PIC XX.
  4524         16  AM-PUR-DA                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  84
* EL1278.cbl
  4525     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4526     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4527     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4528     12  AM-INACTIVE-DATE.
  4529         16  AM-INA-MO                     PIC 99.
  4530         16  AM-INA-DA                     PIC 99.
  4531         16  AM-INA-YR                     PIC 99.
  4532     12  AM-AR-HI-CERT-DATE                PIC XX.
  4533
  4534     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4535     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4536
  4537     12  AM-OB-PAYMENT-MODE                PIC X.
  4538         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4539         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4540         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4541         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4542
  4543     12  AM-AH-ONLY-INDICATOR              PIC X.
  4544         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4545         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4546
  4547     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4548
  4549     12  AM-OVER-SHORT.
  4550         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4551         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4552
  4553     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4554     12  AM-DCC-CLP-STATE                  PIC XX.
  4555
  4556     12  AM-RECALC-COMM                    PIC X.
  4557     12  AM-RECALC-REIN                    PIC X.
  4558
  4559     12  AM-REI-TABLE                      PIC XXX.
  4560     12  AM-REI-ET-LF                      PIC X.
  4561     12  AM-REI-ET-AH                      PIC X.
  4562     12  AM-REI-PE-LF                      PIC X.
  4563     12  AM-REI-PE-AH                      PIC X.
  4564     12  AM-REI-PRT-ST                     PIC X.
  4565     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4566     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4567     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4568     12  AM-REI-GROUP-A                    PIC X(6).
  4569     12  AM-REI-MORT                       PIC X(4).
  4570     12  AM-REI-PRT-OW                     PIC X.
  4571     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4572     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4573     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4574     12  AM-REI-GROUP-B                    PIC X(6).
  4575
  4576     12  AM-TRUST-TYPE                     PIC X(2).
  4577
  4578     12  AM-EMPLOYER-STMT-USED             PIC X.
  4579     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4580
  4581     12  AM-STD-AH-TYPE                    PIC XX.
  4582     12  AM-EARN-METHODS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  85
* EL1278.cbl
  4583         16  AM-EARN-METHOD-R              PIC X.
  4584             88 AM-REF-RL-R78                 VALUE 'R'.
  4585             88 AM-REF-RL-PR                  VALUE 'P'.
  4586             88 AM-REF-RL-MEAN                VALUE 'M'.
  4587             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4588         16  AM-EARN-METHOD-L              PIC X.
  4589             88 AM-REF-LL-R78                 VALUE 'R'.
  4590             88 AM-REF-LL-PR                  VALUE 'P'.
  4591             88 AM-REF-LL-MEAN                VALUE 'M'.
  4592             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4593         16  AM-EARN-METHOD-A              PIC X.
  4594             88 AM-REF-AH-R78                 VALUE 'R'.
  4595             88 AM-REF-AH-PR                  VALUE 'P'.
  4596             88 AM-REF-AH-MEAN                VALUE 'M'.
  4597             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4598             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4599             88 AM-REF-AH-NET                 VALUE 'N'.
  4600
  4601     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4602     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4603     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4604
  4605     12  AM-RET-Y-N                        PIC X.
  4606     12  AM-RET-P-E                        PIC X.
  4607     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4608     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4609     12  AM-RET-GRP                        PIC X(6).
  4610     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4611         16  AM-POOL-PRIME                 PIC XXX.
  4612         16  AM-POOL-SUB                   PIC XXX.
  4613     12  AM-RETRO-EARNINGS.
  4614         16  AM-RET-EARN-R                 PIC X.
  4615         16  AM-RET-EARN-L                 PIC X.
  4616         16  AM-RET-EARN-A                 PIC X.
  4617     12  AM-RET-ST-TAX-USE                 PIC X.
  4618         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4619         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4620     12  AM-RETRO-BEG-EARNINGS.
  4621         16  AM-RET-BEG-EARN-R             PIC X.
  4622         16  AM-RET-BEG-EARN-L             PIC X.
  4623         16  AM-RET-BEG-EARN-A             PIC X.
  4624     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4625     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4626
  4627     12  AM-USER-SELECT-OPTIONS.
  4628         16  AM-USER-SELECT-1              PIC X(10).
  4629         16  AM-USER-SELECT-2              PIC X(10).
  4630         16  AM-USER-SELECT-3              PIC X(10).
  4631         16  AM-USER-SELECT-4              PIC X(10).
  4632         16  AM-USER-SELECT-5              PIC X(10).
  4633
  4634     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4635
  4636     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4637
  4638     12  AM-RPT045A-SWITCH                 PIC X.
  4639         88  RPT045A-OFF                   VALUE 'N'.
  4640
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  86
* EL1278.cbl
  4641     12  AM-INSURANCE-LIMITS.
  4642         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4643         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4644
  4645     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4646         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4647
  4648     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4649         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4650         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4651
  4652     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4653
  4654     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4655     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4656     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4657     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4658     12  AM-DCC-UEF-STATE                  PIC XX.
  4659     12  FILLER                            PIC XXX.
  4660     12  AM-REPORT-CODE-3                  PIC X(10).
  4661*    12  FILLER                            PIC X(22).
  4662
  4663     12  AM-RESERVE-DATE.
  4664         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4665         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4666         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4667
  4668     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4669     12  AM-NOTIFICATION-TYPES.
  4670         16  AM-NOTIF-OF-LETTERS           PIC X.
  4671         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4672         16  AM-NOTIF-OF-REPORTS           PIC X.
  4673         16  AM-NOTIF-OF-STATUS            PIC X.
  4674
  4675     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4676         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4677         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4678         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4679         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4680
  4681     12  AM-BENEFIT-CONTROLS.
  4682         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4683             20  AM-BENEFIT-CODE           PIC XX.
  4684             20  AM-BENEFIT-TYPE           PIC X.
  4685             20  AM-BENEFIT-REVISION       PIC XXX.
  4686             20  AM-BENEFIT-REM-TERM       PIC X.
  4687             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4688             20  FILLER                    PIC XX.
  4689         16  FILLER                        PIC X(80).
  4690
  4691     12  AM-TRANSFER-DATA.
  4692         16  AM-TRANSFERRED-FROM.
  4693             20  AM-TRNFROM-CARRIER        PIC X.
  4694             20  AM-TRNFROM-GROUPING.
  4695                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4696                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4697             20  AM-TRNFROM-STATE          PIC XX.
  4698             20  AM-TRNFROM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  87
* EL1278.cbl
  4699                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4700                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4701             20  AM-TRNFROM-DTE            PIC XX.
  4702         16  AM-TRANSFERRED-TO.
  4703             20  AM-TRNTO-CARRIER          PIC X.
  4704             20  AM-TRNTO-GROUPING.
  4705                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4706                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4707             20  AM-TRNTO-STATE            PIC XX.
  4708             20  AM-TRNTO-ACCOUNT.
  4709                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4710                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4711             20  AM-TRNTO-DTE              PIC XX.
  4712         16  FILLER                        PIC X(10).
  4713
  4714     12  AM-SAVED-REMIT-TO                 PIC 99.
  4715
  4716     12  AM-COMM-STRUCTURE-SAVED.
  4717         16  AM-DEFN-1-SAVED.
  4718             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4719                 24  AM-AGT-SV             PIC X(10).
  4720                 24  AM-COM-TYP-SV         PIC X.
  4721                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4722                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4723                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4724                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4725                 24  FILLER                PIC X.
  4726                 24  AM-GL-CODES-SV        PIC X.
  4727                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4728                 24  FILLER                PIC X.
  4729         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4730             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4731                 24  FILLER                PIC X(11).
  4732                 24  AM-L-COMA-SV          PIC XXX.
  4733                 24  AM-J-COMA-SV          PIC XXX.
  4734                 24  AM-A-COMA-SV          PIC XXX.
  4735                 24  FILLER                PIC X(6).
  4736
  4737     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4738         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4739            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4740            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4741            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4742
  4743     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4744     12  FILLER                            PIC X(120).
  4745
  4746     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4747         16  AM-CONTROL-NAME               PIC X(30).
  4748         16  AM-EXECUTIVE-ONE.
  4749             20  AM-EXEC1-NAME             PIC X(15).
  4750             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4751                                                          COMP-3.
  4752             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4753                                                          COMP-3.
  4754         16  AM-EXECUTIVE-TWO.
  4755             20  AM-EXEC2-NAME             PIC X(15).
  4756             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  88
* EL1278.cbl
  4757                                                          COMP-3.
  4758             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4759                                                          COMP-3.
  4760
  4761     12  AM-RETRO-ADDITIONAL-DATA.
  4762         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4763         16  AM-RETRO-PREM-P-E             PIC X.
  4764         16  AM-RETRO-CLMS-P-I             PIC X.
  4765         16  AM-RETRO-RET-BRACKET-LF.
  4766             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4767                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4768                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4769             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4770                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4771                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4772             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4773                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4774                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4775         16  AM-RETRO-RET-BRACKET-AH.
  4776             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4777                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4778                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4779                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4780             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4781                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4782                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4783             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4784                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4785                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4786
  4787     12  AM-COMMENTS.
  4788         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4789
  4790     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4791         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4792         16  AM-FLI-BILLING-CODE           PIC X.
  4793         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4794         16  AM-FLI-UNITED-IDENT           PIC X.
  4795         16  AM-FLI-INTEREST-LOST-DATA.
  4796             20  AM-FLI-BANK-NO            PIC X(5).
  4797             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4798             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4799             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4800         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4801             20  AM-FLI-AGT                PIC X(9).
  4802             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4803             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4804         16  FILLER                        PIC X(102).
  4805
  4806     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4807         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4808             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4809             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4810             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4811             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4812             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4813         16  FILLER                          PIC X(10).
  4814******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  89
* EL1278.cbl
  4815*                            COPY ELCCERT.
  4816******************************************************************
  4817*                                                                *
  4818*                            ELCCERT.                            *
  4819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4820*                            VMOD=2.013                          *
  4821*                                                                *
  4822*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4823*                                                                *
  4824*   FILE TYPE = VSAM,KSDS                                        *
  4825*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4826*                                                                *
  4827*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4828*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4829*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4830*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4831*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4832*                                                                *
  4833*   LOG = YES                                                    *
  4834*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4835******************************************************************
  4836*                   C H A N G E   L O G
  4837*
  4838* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4839*-----------------------------------------------------------------
  4840*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4841* EFFECTIVE    NUMBER
  4842*-----------------------------------------------------------------
  4843* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4844* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4845* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4846* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4847* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4848* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4849* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4850* 032612  CR2011110200001  PEMA  AHL CHANGES
  4851* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4852* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4853******************************************************************
  4854
  4855 01  CERTIFICATE-MASTER.
  4856     12  CM-RECORD-ID                      PIC XX.
  4857         88  VALID-CM-ID                      VALUE 'CM'.
  4858
  4859     12  CM-CONTROL-PRIMARY.
  4860         16  CM-COMPANY-CD                 PIC X.
  4861         16  CM-CARRIER                    PIC X.
  4862         16  CM-GROUPING.
  4863             20  CM-GROUPING-PREFIX        PIC X(3).
  4864             20  CM-GROUPING-PRIME         PIC X(3).
  4865         16  CM-STATE                      PIC XX.
  4866         16  CM-ACCOUNT.
  4867             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4868             20  CM-ACCOUNT-PRIME          PIC X(6).
  4869         16  CM-CERT-EFF-DT                PIC XX.
  4870         16  CM-CERT-NO.
  4871             20  CM-CERT-PRIME             PIC X(10).
  4872             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  90
* EL1278.cbl
  4873
  4874     12  CM-CONTROL-BY-NAME.
  4875         16  CM-COMPANY-CD-A1              PIC X.
  4876         16  CM-INSURED-LAST-NAME          PIC X(15).
  4877         16  CM-INSURED-INITIALS.
  4878             20  CM-INSURED-INITIAL1       PIC X.
  4879             20  CM-INSURED-INITIAL2       PIC X.
  4880
  4881     12  CM-CONTROL-BY-SSN.
  4882         16  CM-COMPANY-CD-A2              PIC X.
  4883         16  CM-SOC-SEC-NO.
  4884             20  CM-SSN-STATE              PIC XX.
  4885             20  CM-SSN-ACCOUNT            PIC X(6).
  4886             20  CM-SSN-LN3.
  4887                 25  CM-INSURED-INITIALS-A2.
  4888                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4889                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4890                 25 CM-PART-LAST-NAME-A2         PIC X.
  4891
  4892     12  CM-CONTROL-BY-CERT-NO.
  4893         16  CM-COMPANY-CD-A4              PIC X.
  4894         16  CM-CERT-NO-A4                 PIC X(11).
  4895
  4896     12  CM-CONTROL-BY-MEMB.
  4897         16  CM-COMPANY-CD-A5              PIC X.
  4898         16  CM-MEMBER-NO.
  4899             20  CM-MEMB-STATE             PIC XX.
  4900             20  CM-MEMB-ACCOUNT           PIC X(6).
  4901             20  CM-MEMB-LN4.
  4902                 25  CM-INSURED-INITIALS-A5.
  4903                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4904                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4905                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4906
  4907     12  CM-INSURED-PROFILE-DATA.
  4908         16  CM-INSURED-FIRST-NAME.
  4909             20  CM-INSURED-1ST-INIT       PIC X.
  4910             20  FILLER                    PIC X(9).
  4911         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4912         16  CM-INSURED-SEX                PIC X.
  4913             88  CM-SEX-MALE                  VALUE 'M'.
  4914             88  CM-SEX-FEMAL                 VALUE 'F'.
  4915         16  CM-INSURED-JOINT-AGE          PIC 99.
  4916         16  CM-JOINT-INSURED-NAME.
  4917             20  CM-JT-LAST-NAME           PIC X(15).
  4918             20  CM-JT-FIRST-NAME.
  4919                 24  CM-JT-1ST-INIT        PIC X.
  4920                 24  FILLER                PIC X(9).
  4921             20  CM-JT-INITIAL             PIC X.
  4922
  4923     12  CM-LIFE-DATA.
  4924         16  CM-LF-BENEFIT-CD              PIC XX.
  4925         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4926         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4927         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4928         16  CM-LF-DEV-CODE                PIC XXX.
  4929         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4930         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  91
* EL1278.cbl
  4931         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4932         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4933         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4934         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4935         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4936         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4937         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4938         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4939         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4940         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4941         16  cm-temp-epiq                  pic xx.
  4942             88  EPIQ-CLASS                  value 'EQ'.
  4943*        16  FILLER                        PIC XX.
  4944
  4945     12  CM-AH-DATA.
  4946         16  CM-AH-BENEFIT-CD              PIC XX.
  4947         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4948         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4949         16  CM-AH-DEV-CODE                PIC XXX.
  4950         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4951         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4952         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4953         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4954         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4955         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4956         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4957         16  CM-AH-PAID-THRU-DT            PIC XX.
  4958             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4959         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4960         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4961         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4962         16  FILLER                        PIC X.
  4963
  4964     12  CM-LOAN-INFORMATION.
  4965         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4966         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4967                                           PIC S9(5)V99  COMP-3.
  4968         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4969         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4970         16  CM-PAY-FREQUENCY              PIC S99.
  4971         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4972         16  CM-RATE-CLASS                 PIC XX.
  4973         16  CM-BENEFICIARY                PIC X(25).
  4974         16  CM-POLICY-FORM-NO             PIC X(12).
  4975         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4976         16  CM-LAST-ADD-ON-DT             PIC XX.
  4977         16  CM-DEDUCTIBLE-AMOUNTS.
  4978             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4979             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4980         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4981             20  CM-RESIDENT-STATE         PIC XX.
  4982             20  CM-RATE-CODE              PIC X(4).
  4983             20  FILLER                    PIC XX.
  4984         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4985             20  CM-LOAN-OFFICER           PIC X(5).
  4986             20  FILLER                    PIC XXX.
  4987         16  CM-CSR-CODE                   PIC XXX.
  4988         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  92
* EL1278.cbl
  4989             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4990         16  CM-POST-CARD-IND              PIC X.
  4991         16  CM-NH-INTERFACE-SW            PIC X.
  4992         16  CM-PREMIUM-TYPE               PIC X.
  4993             88  CM-SING-PRM                  VALUE '1'.
  4994             88  CM-O-B-COVERAGE              VALUE '2'.
  4995             88  CM-OPEN-END                  VALUE '3'.
  4996         16  CM-IND-GRP-TYPE               PIC X.
  4997             88  CM-INDIVIDUAL                VALUE 'I'.
  4998             88  CM-GROUP                     VALUE 'G'.
  4999         16  CM-SKIP-CODE                  PIC X.
  5000             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5001             88  SKIP-JULY                    VALUE '1'.
  5002             88  SKIP-AUGUST                  VALUE '2'.
  5003             88  SKIP-SEPTEMBER               VALUE '3'.
  5004             88  SKIP-JULY-AUG                VALUE '4'.
  5005             88  SKIP-AUG-SEPT                VALUE '5'.
  5006             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5007             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5008             88  SKIP-JUNE                    VALUE '8'.
  5009             88  SKIP-JUNE-JULY               VALUE '9'.
  5010             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5011             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5012         16  CM-PAYMENT-MODE               PIC X.
  5013             88  PAY-MONTHLY                  VALUE SPACE.
  5014             88  PAY-WEEKLY                   VALUE '1'.
  5015             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5016             88  PAY-BI-WEEKLY                VALUE '3'.
  5017             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5018         16  CM-LOAN-NUMBER                PIC X(8).
  5019         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5020         16  CM-OLD-LOF                    PIC XXX.
  5021*        16  CM-LOAN-OFFICER               PIC XXX.
  5022         16  CM-REIN-TABLE                 PIC XXX.
  5023         16  CM-SPECIAL-REIN-CODE          PIC X.
  5024         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5025         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5026         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5027
  5028     12  CM-STATUS-DATA.
  5029         16  CM-ENTRY-STATUS               PIC X.
  5030         16  CM-ENTRY-DT                   PIC XX.
  5031
  5032         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5033         16  CM-LF-CANCEL-DT               PIC XX.
  5034         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5035
  5036         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5037         16  CM-LF-DEATH-DT                PIC XX.
  5038         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5039
  5040         16  CM-LF-CURRENT-STATUS          PIC X.
  5041             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5042                                                'M' '4' '5' '9'.
  5043             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5044             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5045             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5046             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  93
* EL1278.cbl
  5047             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5048             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5049             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5050             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5051             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5052             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5053             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5054             88  CM-LF-DECLINED               VALUE 'D'.
  5055             88  CM-LF-VOIDED                 VALUE 'V'.
  5056
  5057         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5058         16  CM-AH-CANCEL-DT               PIC XX.
  5059         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5060
  5061         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5062         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5063         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5064
  5065         16  CM-AH-CURRENT-STATUS          PIC X.
  5066             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5067                                                'M' '4' '5' '9'.
  5068             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5069             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5070             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5071             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5072             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5073             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5074             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5075             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5076             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5077             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5078             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5079             88  CM-AH-DECLINED               VALUE 'D'.
  5080             88  CM-AH-VOIDED                 VALUE 'V'.
  5081
  5082         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5083             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5084             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5085             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5086         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5087
  5088         16  CM-ENTRY-BATCH                PIC X(6).
  5089         16  CM-LF-EXIT-BATCH              PIC X(6).
  5090         16  CM-AH-EXIT-BATCH              PIC X(6).
  5091         16  CM-LAST-MONTH-END             PIC XX.
  5092
  5093     12  CM-NOTE-SW                        PIC X.
  5094         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5095         88  CERT-NOTES-PRESENT               VALUE '1'.
  5096         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5097         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5098         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5099         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5100         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5101         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5102     12  CM-COMP-EXCP-SW                   PIC X.
  5103         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5104         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  94
* EL1278.cbl
  5105     12  CM-INSURED-ADDRESS-SW             PIC X.
  5106         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5107         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5108
  5109*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5110     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5111     12  FILLER                            PIC X.
  5112
  5113*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5114     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5115     12  FILLER                            PIC X.
  5116*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5117     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5118
  5119     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5120         88  CERT-ADDED-BATCH                 VALUE ' '.
  5121         88  CERT-ADDED-ONLINE                VALUE '1'.
  5122         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5123         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5124         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5125     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5126         88  CERT-AS-LOADED                   VALUE ' '.
  5127         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5128         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5129         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5130         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5131         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5132         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5133         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5134
  5135     12  CM-ACCOUNT-COMM-PCTS.
  5136         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5137         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5138
  5139     12  CM-USER-FIELD                     PIC X.
  5140     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5141     12  CM-CLP-STATE                      PIC XX.
  5142     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5143     12  CM-USER-RESERVED                  PIC XXX.
  5144     12  FILLER REDEFINES CM-USER-RESERVED.
  5145         16  CM-AH-CLASS-CD                PIC XX.
  5146         16  F                             PIC X.
  5147******************************************************************
  5148*                            COPY ERCMAIL.
  5149******************************************************************
  5150*                                                                *
  5151*                                                                *
  5152*                            ERCMAIL                             *
  5153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5154*                            VMOD=2.003                          *
  5155*                                                                *
  5156*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5157*                                                                *
  5158*   FILE TYPE = VSAM,KSDS                                        *
  5159*   RECORD SIZE = 374   RECFORM = FIX                            *
  5160*                                                                *
  5161*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5162*   ALTERNATE PATH    = NOT USED                                 *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  95
* EL1278.cbl
  5163*                                                                *
  5164*   LOG = YES                                                    *
  5165*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5166******************************************************************
  5167*                   C H A N G E   L O G
  5168*
  5169* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5170*-----------------------------------------------------------------
  5171*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5172* EFFECTIVE    NUMBER
  5173*-----------------------------------------------------------------
  5174* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5175* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5176* 111108                   PEMA  ADD CRED BENE ADDR2
  5177******************************************************************
  5178
  5179 01  MAILING-DATA.
  5180     12  MA-RECORD-ID                      PIC XX.
  5181         88  VALID-MA-ID                       VALUE 'MA'.
  5182
  5183     12  MA-CONTROL-PRIMARY.
  5184         16  MA-COMPANY-CD                 PIC X.
  5185         16  MA-CARRIER                    PIC X.
  5186         16  MA-GROUPING.
  5187             20  MA-GROUPING-PREFIX        PIC XXX.
  5188             20  MA-GROUPING-PRIME         PIC XXX.
  5189         16  MA-STATE                      PIC XX.
  5190         16  MA-ACCOUNT.
  5191             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5192             20  MA-ACCOUNT-PRIME          PIC X(6).
  5193         16  MA-CERT-EFF-DT                PIC XX.
  5194         16  MA-CERT-NO.
  5195             20  MA-CERT-PRIME             PIC X(10).
  5196             20  MA-CERT-SFX               PIC X.
  5197
  5198     12  FILLER                            PIC XX.
  5199
  5200     12  MA-ACCESS-CONTROL.
  5201         16  MA-SOURCE-SYSTEM              PIC XX.
  5202             88  MA-FROM-CREDIT                VALUE 'CR'.
  5203             88  MA-FROM-VSI                   VALUE 'VS'.
  5204             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5205             88  MA-FROM-OTHER                 VALUE 'OT'.
  5206         16  MA-RECORD-ADD-DT              PIC XX.
  5207         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5208         16  MA-LAST-MAINT-DT              PIC XX.
  5209         16  MA-LAST-MAINT-BY              PIC XXXX.
  5210         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5211
  5212     12  MA-PROFILE-INFO.
  5213         16  MA-QUALIFY-CODE-1             PIC XX.
  5214         16  MA-QUALIFY-CODE-2             PIC XX.
  5215         16  MA-QUALIFY-CODE-3             PIC XX.
  5216         16  MA-QUALIFY-CODE-4             PIC XX.
  5217         16  MA-QUALIFY-CODE-5             PIC XX.
  5218
  5219         16  MA-INSURED-LAST-NAME          PIC X(15).
  5220         16  MA-INSURED-FIRST-NAME         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  96
* EL1278.cbl
  5221         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5222         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5223         16  MA-INSURED-BIRTH-DT           PIC XX.
  5224         16  MA-INSURED-SEX                PIC X.
  5225             88  MA-SEX-MALE                   VALUE 'M'.
  5226             88  MA-SEX-FEMALE                 VALUE 'F'.
  5227         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5228
  5229         16  MA-ADDRESS-CORRECTED          PIC X.
  5230         16  MA-JOINT-BIRTH-DT             PIC XX.
  5231*        16  FILLER                        PIC X(12).
  5232
  5233         16  MA-ADDRESS-LINE-1             PIC X(30).
  5234         16  MA-ADDRESS-LINE-2             PIC X(30).
  5235         16  MA-CITY-STATE.
  5236             20  MA-CITY                   PIC X(28).
  5237             20  MA-ADDR-STATE             PIC XX.
  5238         16  MA-ZIP.
  5239             20  MA-ZIP-CODE.
  5240                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5241                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5242                 24  FILLER                PIC X(4).
  5243             20  MA-ZIP-PLUS4              PIC X(4).
  5244         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5245             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5246             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5247             20  FILLER                    PIC X(3).
  5248
  5249         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5250
  5251         16  FILLER                        PIC XXX.
  5252*        16  FILLER                        PIC X(10).
  5253
  5254     12  MA-CRED-BENE-INFO.
  5255         16  MA-CRED-BENE-NAME                 PIC X(25).
  5256         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5257         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5258         16  MA-CRED-BENE-CTYST.
  5259             20  MA-CRED-BENE-CITY             PIC X(28).
  5260             20  MA-CRED-BENE-STATE            PIC XX.
  5261         16  MA-CRED-BENE-ZIP.
  5262             20  MA-CB-ZIP-CODE.
  5263                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5264                     88  MA-CB-CANADIAN-POST-CODE
  5265                                           VALUE 'A' THRU 'Z'.
  5266                 24  FILLER                    PIC X(4).
  5267             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5268         16  MA-CB-CANADIAN-POSTAL-CODE
  5269                            REDEFINES MA-CRED-BENE-ZIP.
  5270             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5271             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5272             20  FILLER                        PIC X(3).
  5273     12  MA-POST-CARD-MAIL-DATA.
  5274         16  MA-MAIL-DATA OCCURS 7.
  5275             20  MA-MAIL-TYPE              PIC X.
  5276                 88  MA-12MO-MAILING           VALUE '1'.
  5277                 88  MA-EXP-MAILING            VALUE '2'.
  5278             20  MA-MAIL-STATUS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  97
* EL1278.cbl
  5279                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5280                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5281                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5282             20  MA-MAIL-DATE              PIC XX.
  5283     12  FILLER                            PIC XX.
  5284     12  FILLER                            PIC XX.
  5285*    12  FILLER                            PIC X(30).
  5286******************************************************************
  5287*                            COPY ELCCRTO.
  5288******************************************************************
  5289*                                                                *
  5290*                            ELCCRTO.                            *
  5291*                                                                *
  5292*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5293*                                                                *
  5294*   FILE TYPE = VSAM,KSDS                                        *
  5295*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5296*                                                                *
  5297*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5298*                                                                *
  5299*   LOG = YES                                                    *
  5300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5301******************************************************************
  5302*                   C H A N G E   L O G
  5303*
  5304* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5305*-----------------------------------------------------------------
  5306*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5307* EFFECTIVE    NUMBER
  5308*-----------------------------------------------------------------
  5309* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5310* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5311* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5312* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5313* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5314******************************************************************
  5315 01  ORIGINAL-CERTIFICATE.
  5316     12  OC-RECORD-ID                      PIC XX.
  5317         88  VALID-OC-ID                      VALUE 'OC'.
  5318     12  OC-CONTROL-PRIMARY.
  5319         16  OC-COMPANY-CD                 PIC X.
  5320         16  OC-CARRIER                    PIC X.
  5321         16  OC-GROUPING                   PIC X(6).
  5322         16  OC-STATE                      PIC XX.
  5323         16  OC-ACCOUNT                    PIC X(10).
  5324         16  OC-CERT-EFF-DT                PIC XX.
  5325         16  OC-CERT-NO.
  5326             20  OC-CERT-PRIME             PIC X(10).
  5327             20  OC-CERT-SFX               PIC X.
  5328         16  OC-RECORD-TYPE                PIC X.
  5329         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5330     12  OC-LAST-MAINT-DT                  PIC XX.
  5331     12  OC-LAST-MAINT-BY                  PIC X(4).
  5332     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5333     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5334     12  FILLER                            PIC X(49).
  5335     12  OC-ORIG-REC.
  5336         16  OC-INS-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  98
* EL1278.cbl
  5337         16  OC-INS-FIRST-NAME             PIC X(10).
  5338         16  OC-INS-MIDDLE-INIT            PIC X.
  5339         16  OC-INS-AGE                    PIC S999     COMP-3.
  5340         16  OC-JNT-LAST-NAME              PIC X(15).
  5341         16  OC-JNT-FIRST-NAME             PIC X(10).
  5342         16  OC-JNT-MIDDLE-INIT            PIC X.
  5343         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5344         16  OC-LF-BENCD                   PIC XX.
  5345         16  OC-LF-TERM                    PIC S999      COMP-3.
  5346         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5347         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5348         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5349         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5350         16  OC-LF-EXP-DT                  PIC XX.
  5351         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5352         16  OC-LF-CANCEL-DT               PIC XX.
  5353         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5354         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5355         16  OC-AH-BENCD                   PIC XX.
  5356         16  OC-AH-TERM                    PIC S999      COMP-3.
  5357         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5358         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5359         16  OC-AH-EXP-DT                  PIC XX.
  5360         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5361         16  OC-AH-CP                      PIC 99.
  5362         16  OC-AH-CANCEL-DT               PIC XX.
  5363         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5364         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5365         16  OC-CRED-BENE-NAME             PIC X(25).
  5366         16  OC-1ST-PMT-DT                 PIC XX.
  5367         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5368         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5369         16  OC-ISSUE-TRAN-IND             PIC X.
  5370         16  OC-CANCEL-TRAN-IND            PIC X.
  5371         16  FILLER                        PIC X(211).
  5372
  5373     12  FILLER                            PIC X(50).
  5374******************************************************************
  5375*                            COPY ERCFORM.
  5376******************************************************************
  5377*                                                                *
  5378*                                                                *
  5379*                            ERCFORM.                            *
  5380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5381*                            VMOD=2.003                          *
  5382*                                                                *
  5383*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5384*                                                                *
  5385*    FILE TYPE = VSAM,KSDS                                       *
  5386*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5387*                                                                *
  5388*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5389*                                                                *
  5390*    LOG = YES                                                   *
  5391*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5392******************************************************************
  5393 01  FORM-MASTER.
  5394    12  FO-RECORD-ID                 PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  99
* EL1278.cbl
  5395        88  VALID-FO-ID                  VALUE 'FO'.
  5396
  5397    12  FO-CONTROL-PRIMARY.
  5398        16  FO-COMPANY-CD            PIC X(01).
  5399        16  FO-STATE                 PIC X(02).
  5400        16  FO-FORM-ID               PIC X(12).
  5401        16  FO-FORM-EXP-DT           PIC X(02).
  5402
  5403    12  FO-POLICY-FORM-DATA.
  5404        16  FO-IND-GRP-CD            PIC X(01).
  5405        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5406        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5407        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5408        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5409        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5410        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5411        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5412        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5413        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5414        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5415        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5416        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5417        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5418        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5419        16  FO-APP-CERT-USE-CD       PIC X(01).
  5420
  5421    12  FILLER                       PIC X(29).
  5422
  5423    12  FO-FORM-PLAN-TABLE.
  5424        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5425            20  FO-PLAN-TYPE         PIC X(01).
  5426            20  FO-PLAN-ID           PIC X(02).
  5427            20  FO-PLAN-TERM         PIC 9(03).
  5428            20  FO-PLAN-REFUND-METHOD
  5429                                     PIC X.
  5430
  5431    12  FILLER                       PIC X(30).
  5432
  5433    12  FO-COMMENTS-AREA.
  5434        16  FO-COMMENT-LINE-1        PIC X(78).
  5435
  5436    12  FILLER                       PIC X(20).
  5437
  5438    12  FO-MAINT-INFORMATION.
  5439        16  FO-LAST-MAINT-DT         PIC X(02).
  5440        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5441        16  FO-LAST-MAINT-BY         PIC X(04).
  5442*                            COPY ELCMSTR.
  5443******************************************************************
  5444*                                                                *
  5445*                            ELCMSTR.                            *
  5446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5447*                            VMOD=2.012                          *
  5448*                                                                *
  5449*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5450*                                                                *
  5451*   FILE TYPE = VSAM,KSDS                                        *
  5452*   RECORD SIZE = 350  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 100
* EL1278.cbl
  5453*                                                                *
  5454*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5455*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5456*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5457*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5458*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5459*                                                 RKP=75,LEN=21  *
  5460*                                                                *
  5461*   **** NOTE ****                                               *
  5462*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5463*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5464*                                                                *
  5465*   LOG = YES                                                    *
  5466*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5467******************************************************************
  5468*                   C H A N G E   L O G
  5469*
  5470* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5471*-----------------------------------------------------------------
  5472*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5473* EFFECTIVE    NUMBER
  5474*-----------------------------------------------------------------
  5475* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5476* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5477* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  5478* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5479* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5480******************************************************************
  5481 01  CLAIM-MASTER.
  5482     12  CL-RECORD-ID                PIC XX.
  5483         88  VALID-CL-ID         VALUE 'CL'.
  5484
  5485     12  CL-CONTROL-PRIMARY.
  5486         16  CL-COMPANY-CD           PIC X.
  5487         16  CL-CARRIER              PIC X.
  5488         16  CL-CLAIM-NO             PIC X(7).
  5489         16  CL-CERT-NO.
  5490             20  CL-CERT-PRIME       PIC X(10).
  5491             20  CL-CERT-SFX         PIC X.
  5492
  5493     12  CL-CONTROL-BY-NAME.
  5494         16  CL-COMPANY-CD-A1        PIC X.
  5495         16  CL-INSURED-LAST-NAME    PIC X(15).
  5496         16  CL-INSURED-NAME.
  5497             20  CL-INSURED-1ST-NAME PIC X(12).
  5498             20  CL-INSURED-MID-INIT PIC X.
  5499
  5500     12  CL-CONTROL-BY-SSN.
  5501         16  CL-COMPANY-CD-A2        PIC X.
  5502         16  CL-SOC-SEC-NO.
  5503             20  CL-SSN-STATE        PIC XX.
  5504             20  CL-SSN-ACCOUNT      PIC X(6).
  5505             20  CL-SSN-LN3          PIC X(3).
  5506
  5507     12  CL-CONTROL-BY-CERT-NO.
  5508         16  CL-COMPANY-CD-A4        PIC X.
  5509         16  CL-CERT-NO-A4.
  5510             20  CL-CERT-A4-PRIME    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 101
* EL1278.cbl
  5511             20  CL-CERT-A4-SFX      PIC X.
  5512
  5513     12  CL-CONTROL-BY-CCN.
  5514         16  CL-COMPANY-CD-A5        PIC X.
  5515         16  CL-CCN-A5.
  5516             20  CL-CCN.
  5517                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5518                 24  CL-CCN-PRIME-A5 PIC X(12).
  5519             20  CL-CCN-FILLER-A5    PIC X(4).
  5520
  5521     12  CL-INSURED-PROFILE-DATA.
  5522         16  CL-INSURED-BIRTH-DT     PIC XX.
  5523         16  CL-INSURED-SEX-CD       PIC X.
  5524             88  INSURED-IS-MALE        VALUE 'M'.
  5525             88  INSURED-IS-FEMALE      VALUE 'F'.
  5526             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5527         16  CL-INSURED-OCC-CD       PIC X(6).
  5528         16  FILLER                  PIC X(5).
  5529
  5530     12  CL-PROCESSING-INFO.
  5531         16  CL-PROCESSOR-ID         PIC X(4).
  5532         16  CL-CLAIM-STATUS         PIC X.
  5533             88  CLAIM-IS-OPEN          VALUE 'O'.
  5534             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5535         16  CL-CLAIM-TYPE           PIC X.
  5536*            88  AH-CLAIM               VALUE 'A'.
  5537*            88  LIFE-CLAIM             VALUE 'L'.
  5538*            88  PROPERTY-CLAIM         VALUE 'P'.
  5539*            88  IUI-CLAIM              VALUE 'I'.
  5540*            88  GAP-CLAIM              VALUE 'G'.
  5541*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  5542         16  CL-CLAIM-PREM-TYPE      PIC X.
  5543             88  SINGLE-PREMIUM         VALUE '1'.
  5544             88  O-B-COVERAGE           VALUE '2'.
  5545             88  OPEN-END-COVERAGE      VALUE '3'.
  5546         16  CL-INCURRED-DT          PIC XX.
  5547         16  CL-REPORTED-DT          PIC XX.
  5548         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5549         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5550         16  CL-LAST-PMT-DT          PIC XX.
  5551         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5552         16  CL-PAID-THRU-DT         PIC XX.
  5553         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5554         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5555         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5556         16  CL-PMT-CALC-METHOD      PIC X.
  5557             88  CL-360-DAY-YR          VALUE '1'.
  5558             88  CL-365-DAY-YR          VALUE '2'.
  5559             88  CL-FULL-MONTHS         VALUE '3'.
  5560         16  CL-CAUSE-CD             PIC X(6).
  5561
  5562         16  CL-PRIME-CERT-NO.
  5563             20  CL-PRIME-CERT-PRIME PIC X(10).
  5564             20  CL-PRIME-CERT-SFX   PIC X.
  5565
  5566         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5567             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5568             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 102
* EL1278.cbl
  5569
  5570         16  CL-MICROFILM-NO         PIC X(10).
  5571         16  FILLER REDEFINES CL-MICROFILM-NO.
  5572             20  CL-BENEFIT-PERIOD   PIC 99.
  5573             20  FILLER              PIC X(8).
  5574         16  CL-PROG-FORM-TYPE       PIC X.
  5575         16  CL-LAST-ADD-ON-DT       PIC XX.
  5576
  5577         16  CL-LAST-REOPEN-DT       PIC XX.
  5578         16  CL-LAST-CLOSE-DT        PIC XX.
  5579         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5580             88  FINAL-PAID             VALUE '1'.
  5581             88  CLAIM-DENIED           VALUE '2'.
  5582             88  AUTO-CLOSE             VALUE '3'.
  5583             88  MANUAL-CLOSE           VALUE '4'.
  5584             88  BENEFITS-CHANGED       VALUE 'C'.
  5585             88  SETUP-ERRORS           VALUE 'E'.
  5586         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5587         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5588         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5589             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5590         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5591         16  FILLER                  PIC X.
  5592
  5593     12  CL-CERTIFICATE-DATA.
  5594         16  CL-CERT-ORIGIN          PIC X.
  5595             88  CERT-WAS-ONLINE        VALUE '1'.
  5596             88  CERT-WAS-CREATED       VALUE '2'.
  5597             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5598         16  CL-CERT-KEY-DATA.
  5599             20  CL-CERT-CARRIER     PIC X.
  5600             20  CL-CERT-GROUPING    PIC X(6).
  5601             20  CL-CERT-STATE       PIC XX.
  5602             20  CL-CERT-ACCOUNT.
  5603                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5604                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5605             20  CL-CERT-EFF-DT      PIC XX.
  5606
  5607     12  CL-STATUS-CONTROLS.
  5608         16  CL-PRIORITY-CD          PIC X.
  5609             88  CONFIDENTIAL-DATA      VALUE '8'.
  5610             88  HIGHEST-PRIORITY       VALUE '9'.
  5611         16  CL-SUPV-ATTN-CD         PIC X.
  5612             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5613             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5614         16  CL-PURGED-DT            PIC XX.
  5615         16  CL-RESTORED-DT          PIC XX.
  5616         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5617         16  CL-NEXT-RESEND-DT       PIC XX.
  5618         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5619         16  CL-CRITICAL-PERIOD      PIC 99.
  5620*        16  FILLER                  PIC XX.
  5621         16  CL-LAST-MAINT-DT        PIC XX.
  5622         16  CL-LAST-MAINT-USER      PIC X(4).
  5623         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5624         16  CL-LAST-MAINT-TYPE      PIC X.
  5625             88  CLAIM-SET-UP           VALUE ' '.
  5626             88  PAYMENT-MADE           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 103
* EL1278.cbl
  5627             88  LETTER-SENT            VALUE '2'.
  5628             88  MASTER-WAS-ALTERED     VALUE '3'.
  5629             88  MASTER-WAS-RESTORED    VALUE '4'.
  5630             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5631             88  FILE-CONVERTED         VALUE '6'.
  5632             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5633             88  ERROR-CORRECTION       VALUE 'E'.
  5634         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5635         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5636         16  CL-BENEFICIARY          PIC X(10).
  5637         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5638         16  CL-DENIAL-TYPE          PIC X.
  5639             88  CL-TYPE-DENIAL          VALUE '1'.
  5640             88  CL-TYPE-RESCISSION      VALUE '2'.
  5641             88  CL-TYPE-REFORMATION     VALUE '3'.
  5642             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5643             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5644         16  filler                  pic x(5).
  5645*        16  CL-CRIT-PER-RECURRENT   PIC X.
  5646*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  5647*        16  CL-RTW-DT               PIC XX.
  5648
  5649     12  CL-TRAILER-CONTROLS.
  5650         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5651             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5652             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5653             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5654         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5655         16  FILLER                  PIC XX.
  5656         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5657         16  CL-ADDRESS-TRAILER-CNT.
  5658             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5659                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5660             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5661                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5662             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5663                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5664             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5665                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5666             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5667                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5668             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5669                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5670             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5671                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5672
  5673     12  CL-CV-REFERENCE-NO.
  5674         16  CL-CV-REFNO-PRIME       PIC X(18).
  5675         16  CL-CV-REFNO-SFX         PIC XX.
  5676
  5677     12  CL-FILE-LOCATION            PIC X(4).
  5678
  5679     12  CL-PROCESS-ERRORS.
  5680         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5681             88  NO-FATAL-ERRORS        VALUE ZERO.
  5682         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5683             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5684
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 104
* EL1278.cbl
  5685     12  CL-PRODUCT-CD               PIC X.
  5686
  5687     12  CL-CURRENT-KEY-DATA.
  5688         16  CL-CURRENT-CARRIER      PIC X.
  5689         16  CL-CURRENT-GROUPING     PIC X(6).
  5690         16  CL-CURRENT-STATE        PIC XX.
  5691         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5692
  5693     12  CL-ASSOCIATES               PIC X.
  5694         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5695         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5696         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5697         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5698
  5699     12  CL-ACTIVITY-CODE            PIC 99.
  5700     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5701     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5702
  5703     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5704     12  CL-LAG-REPORT-CODE          PIC 9.
  5705     12  CL-LOAN-TYPE                PIC XX.
  5706     12  CL-LEGAL-STATE              PIC XX.
  5707
  5708     12  CL-YESNOSW                  PIC X.
  5709     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  5710         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  5711         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  5712         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  5713     12  cl-insured-type             pic x.
  5714         88  cl-claim-on-primary         value 'P'.
  5715         88  cl-claim-on-co-borrower     value 'C'.
  5716     12  cl-benefit-expiration-dt    PIC XX.
  5717*                            COPY ERCPDEF.
  5718******************************************************************
  5719*                                                                *
  5720*                                                                *
  5721*                            ERCPDEF.                            *
  5722*                                                                *
  5723*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5724*                                                                *
  5725*    FILE TYPE = VSAM,KSDS                                       *
  5726*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5727*                                                                *
  5728*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5729*                                                                *
  5730*    LOG = YES                                                   *
  5731*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5732******************************************************************
  5733*                   C H A N G E   L O G
  5734*
  5735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5736*-----------------------------------------------------------------
  5737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5738* EFFECTIVE    NUMBER
  5739*-----------------------------------------------------------------
  5740* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5741* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5742* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 105
* EL1278.cbl
  5743******************************************************************
  5744 01  PRODUCT-MASTER.
  5745    12  PD-RECORD-ID                 PIC X(02).
  5746        88  VALID-PD-ID                  VALUE 'PD'.
  5747    12  PD-CONTROL-PRIMARY.
  5748        16  PD-COMPANY-CD            PIC X.
  5749        16  PD-STATE                 PIC XX.
  5750        16  PD-PRODUCT-CD            PIC XXX.
  5751        16  PD-FILLER                PIC X(7).
  5752        16  PD-BEN-TYPE              PIC X.
  5753        16  PD-BEN-CODE              PIC XX.
  5754        16  PD-PROD-EXP-DT           PIC XX.
  5755    12  FILLER                       PIC X(50).
  5756    12  PD-PRODUCT-DATA OCCURS 8.
  5757        16  PD-PROD-CODE             PIC X.
  5758            88  PD-PROD-LIFE           VALUE 'L'.
  5759            88  PD-PROD-PROP           VALUE 'P'.
  5760            88  PD-PROD-AH             VALUE 'A'.
  5761            88  PD-PROD-IU             VALUE 'I'.
  5762            88  PD-PROD-GAP            VALUE 'G'.
  5763            88  PD-PROD-FAML           VALUE 'F'.
  5764        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5765        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5766        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5767        16  PD-MAX-TERM              PIC S999        COMP-3.
  5768        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5769        16  FILLER                   PIC X.
  5770        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5771        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5772        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5773        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5774        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5775        16  PD-REC-CRIT-PERIOD       PIC 99.
  5776        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5777            20  PD-RECURRING-YN      PIC X.
  5778            20  FILLER               PIC X.
  5779        16  PD-RTW-MOS               PIC 99.
  5780        16  PD-MAX-EXTENSION         PIC 99.
  5781        16  pd-ben-pct               pic sv999 comp-3.
  5782*       16  FILLER                   PIC XX.
  5783    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5784    12  PD-TERM-LIMITS OCCURS 15.
  5785        16  PD-LOW-TERM              PIC S999        COMP-3.
  5786        16  PD-HI-TERM               PIC S999        COMP-3.
  5787*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5788    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5789        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5790        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5791    12  PD-EARN-FACTORS.
  5792        16  FILLER OCCURS 15.
  5793            20  FILLER OCCURS 15.
  5794                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5795    12  PD-PRODUCT-DESC              PIC X(80).
  5796    12  PD-TRUNCATED                 PIC X.
  5797    12  FILLER                       PIC X(59).
  5798    12  PD-MAINT-INFORMATION.
  5799        16  PD-LAST-MAINT-DT         PIC X(02).
  5800        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 106
* EL1278.cbl
  5801        16  PD-LAST-MAINT-BY         PIC X(04).
  5802*                            COPY ELCCRTT.
  5803******************************************************************
  5804*                                                                *
  5805*                            ELCCRTT.                            *
  5806*                                                                *
  5807*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5808*                                                                *
  5809*   FILE TYPE = VSAM,KSDS                                        *
  5810*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5811*                                                                *
  5812*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5813*                                                                *
  5814*   LOG = YES                                                    *
  5815*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5816******************************************************************
  5817*                   C H A N G E   L O G
  5818*
  5819* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5820*-----------------------------------------------------------------
  5821*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5822* EFFECTIVE    NUMBER
  5823*-----------------------------------------------------------------
  5824* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5825* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5826* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5827* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5828* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5829* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5830* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5831* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5832* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5833******************************************************************
  5834
  5835 01  CERTIFICATE-TRAILERS.
  5836     12  CS-RECORD-ID                      PIC XX.
  5837         88  VALID-CS-ID                      VALUE 'CS'.
  5838
  5839     12  CS-CONTROL-PRIMARY.
  5840         16  CS-COMPANY-CD                 PIC X.
  5841         16  CS-CARRIER                    PIC X.
  5842         16  CS-GROUPING                   PIC X(6).
  5843         16  CS-STATE                      PIC XX.
  5844         16  CS-ACCOUNT                    PIC X(10).
  5845         16  CS-CERT-EFF-DT                PIC XX.
  5846         16  CS-CERT-NO.
  5847             20  CS-CERT-PRIME             PIC X(10).
  5848             20  CS-CERT-SFX               PIC X.
  5849         16  CS-TRAILER-TYPE               PIC X.
  5850             88  COMM-TRLR           VALUE 'A'.
  5851             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5852             88  CERT-DATA-TRLR      VALUE 'C'.
  5853
  5854     12  CS-DATA-AREA                      PIC X(516).
  5855
  5856     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5857         16  CS-BANK-COMMISSION-AREA.
  5858             20  CS-BANK-COMMS       OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 107
* EL1278.cbl
  5859                 24  CS-AGT                PIC X(10).
  5860                 24  CS-COM-TYP            PIC X.
  5861                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5862                 24  CS-RECALC-LV-INDIC    PIC X.
  5863                 24  FILLER                PIC X(10).
  5864         16  FILLER                        PIC X(256).
  5865
  5866     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5867****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5868         16  CS-MB-CLAIM-DATA OCCURS 24.
  5869             20  CS-CLAIM-NO               PIC X(7).
  5870             20  CS-CLAIM-TYPE             PIC X.
  5871                 88  CS-AH-CLM               VALUE 'A'.
  5872                 88  CS-IU-CLM               VALUE 'I'.
  5873                 88  CS-GP-CLM               VALUE 'G'.
  5874                 88  CS-LF-CLM               VALUE 'L'.
  5875                 88  CS-PR-CLM               VALUE 'P'.
  5876                 88  CS-FL-CLM               VALUE 'F'.
  5877             20  CS-INSURED-TYPE           PIC X.
  5878                 88  CS-PRIM-INSURED          VALUE 'P'.
  5879                 88  CS-CO-BORROWER           VALUE 'C'.
  5880             20  CS-BENEFIT-PERIOD         PIC 99.
  5881             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5882             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5883             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5884         16  FILLER                        PIC X(12).
  5885     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5886         16  CS-VIN-NUMBER                 PIC X(17).
  5887         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5888         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5889         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5890         16  cs-agent-name.
  5891             20  cs-agent-fname            pic x(20).
  5892             20  cs-agent-mi               pic x.
  5893             20  cs-agent-lname            pic x(25).
  5894         16  cs-license-no                 pic x(15).
  5895         16  cs-npn-number                 pic x(10).
  5896         16  cs-agent-edit-status          pic x.
  5897             88  cs-ae-refer-to-manager      value 'M'.
  5898             88  cs-ae-cover-sheet           value 'C'.
  5899             88  cs-ae-sig-form              value 'S'.
  5900             88  cs-ae-verified              value 'V'.
  5901             88  cs-unidentified-signature   value 'U'.
  5902             88  cs-cert-returned            value 'R'.
  5903             88  cs-accept-no-commission     value 'N'.
  5904         16  cs-year                       pic 9999.
  5905         16  cs-make                       pic x(20).
  5906         16  cs-model                      pic x(20).
  5907         16  cs-future                     pic x(20).
  5908         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5909         16  FILLER                        PIC X(356). *> was 420
  5910*        16  FILLER                        PIC X(496).
  5911 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5912                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5913                          MAILING-DATA ORIGINAL-CERTIFICATE
  5914                          FORM-MASTER CLAIM-MASTER
  5915                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5916 0000-DFHEXIT SECTION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 108
* EL1278.cbl
  5917     MOVE '9#                    $   ' TO DFHEIV0.
  5918     MOVE 'EL1278' TO DFHEIV1.
  5919     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5920*    SERVICE RELOAD PARMLIST.
  5921
  5922     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5923     MOVE '5'                    TO  DC-OPTION-CODE.
  5924
  5925     PERFORM 9600-DATE-LINK.
  5926
  5927     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5928     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5929     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5930     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5931     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5932     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5933     MOVE EIBTRMID               TO  QID-TERM.
  5934
  5935     IF EIBCALEN  IS EQUAL TO  ZERO
  5936         GO TO 8700-UNAUTHORIZED-ACCESS.
  5937
  5938     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5939         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5940             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5941             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5942             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5943             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5944             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5945             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5946             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5947             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5948         ELSE
  5949             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5950             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5951             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5952             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5953             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5954             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5955             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5956             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5957             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5958
  5959     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5960         GO TO 9300-CLEAR.
  5961
  5962     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5963         NEXT SENTENCE
  5964     ELSE
  5965
  5966* EXEC CICS READQ TS
  5967*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5968*            INTO    (SECURITY-CONTROL)
  5969*            LENGTH  (SC-COMM-LENGTH)
  5970*            ITEM    (SC-ITEM)
  5971*        END-EXEC
  5972*    MOVE '*$II   L              ''   #00005961' TO DFHEIV0
  5973     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5974     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 109
* EL1278.cbl
  5975     MOVE X'2020233030303035393631' TO DFHEIV0(25:11)
  5976     CALL 'kxdfhei1' USING DFHEIV0,
  5977           PI-SECURITY-TEMP-STORE-ID,
  5978           SECURITY-CONTROL,
  5979           SC-COMM-LENGTH,
  5980           SC-ITEM,
  5981           DFHEIV99,
  5982           DFHEIV99
  5983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5984         MOVE SC-CREDIT-DISPLAY (33)
  5985                                 TO  PI-DISPLAY-CAP
  5986         MOVE SC-CREDIT-UPDATE  (33)
  5987                                 TO  PI-MODIFY-CAP
  5988         MOVE SC-CREDIT-UPDATE  (32)
  5989                                 TO  PI-MODIFY-CERT-CAP
  5990         IF NOT  DISPLAY-CAP
  5991             MOVE 'READ'         TO  SM-READ
  5992             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5993             MOVE ER-0070        TO  EMI-ERROR
  5994             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5995             GO TO 8100-SEND-INITIAL-MAP.
  5996
  5997     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5998         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5999         MOVE LOW-VALUES         TO  EL127HI
  6000         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  6001                                     PI-LF-CANCEL-DATE
  6002                                     WS-AH-CANCEL-DATE
  6003                                     PI-AH-CANCEL-DATE
  6004         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  6005                                     PI-LF-CANCEL-DATE-ED
  6006                                     WS-AH-CANCEL-DATE-ED
  6007                                     PI-AH-CANCEL-DATE-ED
  6008         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  6009                                     PI-EARNING-METHOD-AH
  6010         PERFORM 0500-FORMAT-SCREEN
  6011         GO TO 8100-SEND-INITIAL-MAP.
  6012
  6013     IF NOT  MODIFY-CAP
  6014         MOVE 'UPDATE'           TO  SM-READ
  6015         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6016         MOVE ER-0070            TO  EMI-ERROR
  6017         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6018         GO TO 8100-SEND-INITIAL-MAP.
  6019
  6020
  6021* EXEC CICS HANDLE CONDITION
  6022*        PGMIDERR  (9500-PGMID-ERROR)
  6023*        ERROR     (9900-ABEND)
  6024*    END-EXEC.
  6025*    MOVE '"$L.                  ! " #00006003' TO DFHEIV0
  6026     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  6027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6028     MOVE X'2220233030303036303033' TO DFHEIV0(25:11)
  6029     CALL 'kxdfhei1' USING DFHEIV0
  6030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6031
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 110
* EL1278.cbl
  6033 0200-RECEIVE.
  6034     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  6035         MOVE ER-0008            TO  EMI-ERROR
  6036         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6037         MOVE -1                 TO  HLCANCL
  6038         GO TO 8200-SEND-DATAONLY.
  6039
  6040
  6041* EXEC CICS RECEIVE
  6042*        MAP     (MAP-NAME)
  6043*        MAPSET  (MAPSET-NAME)
  6044*        INTO    (EL127HI)
  6045*    END-EXEC.
  6046     MOVE LENGTH OF
  6047      EL127HI
  6048       TO DFHEIV11
  6049*    MOVE '8"T I  L              ''   #00006015' TO DFHEIV0
  6050     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6051     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6052     MOVE X'2020233030303036303135' TO DFHEIV0(25:11)
  6053     CALL 'kxdfhei1' USING DFHEIV0,
  6054           MAP-NAME,
  6055           EL127HI,
  6056           DFHEIV11,
  6057           MAPSET-NAME,
  6058           DFHEIV99,
  6059           DFHEIV99
  6060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6061
  6062
  6063     IF HPFKEYL  IS EQUAL TO  ZERO
  6064         GO TO 0300-CHECK-PFKEYS.
  6065
  6066     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  6067         MOVE ER-0004            TO  EMI-ERROR
  6068         GO TO 0320-INPUT-ERROR.
  6069
  6070     IF HPFKEYI NUMERIC
  6071         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  6072             MOVE PF-VALUES (HPFKEYI)
  6073                                 TO  EIBAID
  6074         ELSE
  6075             MOVE ER-0029        TO  EMI-ERROR
  6076             GO TO 0320-INPUT-ERROR.
  6077
  6078 0300-CHECK-PFKEYS.
  6079     IF EIBAID  IS EQUAL TO  DFHPF23
  6080         GO TO 8800-PF23.
  6081
  6082     IF EIBAID  IS EQUAL TO  DFHPF24
  6083         GO TO 9100-RETURN-MAIN-MENU.
  6084
  6085     IF EIBAID = DFHPF11
  6086        GO TO 1700-WRITE-CERT-NOTE
  6087     END-IF
  6088
  6089     IF EIBAID  IS EQUAL TO  DFHPF12
  6090         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 111
* EL1278.cbl
  6091
  6092     IF EIBAID = DFHENTER OR DFHPF10
  6093        GO TO 0400-EDIT-INPUT-DATA
  6094     END-IF
  6095
  6096     MOVE ER-0029                TO  EMI-ERROR.
  6097
  6098 0320-INPUT-ERROR.
  6099     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6100
  6101     MOVE AL-UNBON               TO  HPFKEYA.
  6102
  6103     IF HPFKEYL  IS EQUAL TO  ZERO
  6104         MOVE -1                 TO  HLCANCL
  6105     ELSE
  6106         MOVE -1                 TO  HPFKEYL.
  6107
  6108     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 112
* EL1278.cbl
  6110 0400-EDIT-INPUT-DATA.
  6111     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  6112                                     WS-NEW-LF-CANCEL-SW.
  6113
  6114     IF (HPCYNL > 0)
  6115        AND (HPCYNI = 'Y' OR 'N')
  6116        PERFORM 1800-READ-ELCERT-UPDATE
  6117                                 THRU 1800-EXIT
  6118        IF WS-RESP-NORMAL
  6119           MOVE HPCYNI           TO CM-POST-CARD-IND
  6120           PERFORM 1810-REWRITE-ELCERT
  6121                                 THRU 1810-EXIT
  6122        END-IF
  6123     END-IF
  6124     IF HLCAL1L GREATER ZERO
  6125         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  6126     IF CLPYNI = 'Y'
  6127        MOVE 'Y'                   TO PI-CLP-YN
  6128        MOVE AL-UANON              TO CLPYNA
  6129     ELSE
  6130        MOVE ' '                   TO PI-CLP-YN
  6131        MOVE AL-UANON              TO CLPYNA
  6132     END-IF
  6133     IF CANREAI = 'R'
  6134        MOVE 'R'                 TO PI-CANCEL-REASON
  6135        MOVE AL-UANON            TO CANREAA
  6136     ELSE
  6137        MOVE ' '                 TO PI-CANCEL-REASON
  6138        MOVE AL-UANON            TO CANREAA
  6139     END-IF
  6140
  6141     IF HLCANCL  IS EQUAL TO  ZERO
  6142       AND HACANCL  IS EQUAL TO  ZERO
  6143         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6144         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6145         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6146         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6147         GO TO 0420-CHECK-ERRORS.
  6148
  6149     IF HLCANCL  IS EQUAL TO  ZERO
  6150         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6151         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6152         GO TO 0410-CHECK-AH-DATE.
  6153
  6154     IF HLCANCI = SPACES
  6155        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  6156                                      WS-LF-CANCEL-DATE
  6157        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  6158                                      WS-LF-CANCEL-DATE-ED
  6159                                      PI-LF-REFUND-METH
  6160        MOVE +0                    TO PI-LF-REFUND-AMT
  6161        GO TO 0410-CHECK-AH-DATE
  6162     END-IF
  6163
  6164     MOVE AL-UNNON               TO  HLCANCA.
  6165     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6166     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6167
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 113
* EL1278.cbl
  6168     PERFORM 8600-DEEDIT.
  6169
  6170     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6171     MOVE '4'                    TO  DC-OPTION-CODE.
  6172
  6173     PERFORM 9600-DATE-LINK.
  6174
  6175     IF DATE-CONVERSION-ERROR
  6176         MOVE -1                 TO  HLCANCL
  6177         MOVE AL-UABON           TO  HLCANCA
  6178         MOVE ER-2227            TO  EMI-ERROR
  6179         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6180     ELSE
  6181        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6182           MOVE -1               TO  HACANCL
  6183           MOVE AL-UABON         TO  HACANCA
  6184           MOVE ER-2774          TO  EMI-ERROR
  6185           PERFORM 9700-ERROR-FORMAT
  6186                                 THRU  9799-EXIT
  6187        ELSE
  6188           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6189                                    PI-LF-CANCEL-DATE
  6190           MOVE DC-GREG-DATE-1-EDIT
  6191                                 TO HLCANCO
  6192                                    WS-LF-CANCEL-DATE-ED
  6193                                    PI-LF-CANCEL-DATE-ED
  6194        END-IF
  6195     END-IF
  6196     .
  6197 0410-CHECK-AH-DATE.
  6198     IF HACAL1L GREATER ZERO
  6199         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6200
  6201     IF HACANCL  IS EQUAL TO  ZERO
  6202         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6203         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6204         GO TO 0420-CHECK-ERRORS.
  6205     IF HACANCI = SPACES
  6206        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6207                                      WS-AH-CANCEL-DATE
  6208        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6209                                      WS-AH-CANCEL-DATE-ED
  6210                                      PI-AH-REFUND-METH
  6211        MOVE +0                    TO PI-AH-REFUND-AMT
  6212        GO TO 0420-CHECK-ERRORS
  6213     END-IF
  6214
  6215     MOVE AL-UNNON               TO  HACANCA.
  6216     MOVE HACANCI                TO  DEEDIT-FIELD.
  6217     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6218
  6219     PERFORM 8600-DEEDIT.
  6220
  6221     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6222     MOVE '4'                    TO  DC-OPTION-CODE.
  6223
  6224     PERFORM 9600-DATE-LINK.
  6225
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 114
* EL1278.cbl
  6226     IF DATE-CONVERSION-ERROR
  6227         MOVE -1                 TO  HACANCL
  6228         MOVE AL-UABON           TO  HACANCA
  6229         MOVE ER-2227            TO  EMI-ERROR
  6230         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6231     ELSE
  6232        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6233           MOVE -1               TO  HACANCL
  6234           MOVE AL-UABON         TO  HACANCA
  6235           MOVE ER-2775          TO  EMI-ERROR
  6236           PERFORM 9700-ERROR-FORMAT
  6237                                 THRU  9799-EXIT
  6238        ELSE
  6239           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6240                                    PI-AH-CANCEL-DATE
  6241           MOVE DC-GREG-DATE-1-EDIT
  6242                                 TO HACANCO
  6243                                    WS-AH-CANCEL-DATE-ED
  6244                                    PI-AH-CANCEL-DATE-ED
  6245        END-IF
  6246     END-IF
  6247     .
  6248 0420-CHECK-ERRORS.
  6249     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6250         NEXT SENTENCE
  6251     ELSE
  6252         GO TO 8200-SEND-DATAONLY.
  6253
  6254     PERFORM 0500-FORMAT-SCREEN.
  6255     IF EIBAID = DFHPF10
  6256        perform 4000-GEN-CANCEL-TRANS
  6257                                 thru 4000-exit
  6258        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6259        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6260        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6261        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6262        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6263        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6264                               PI-ALL-CANCELS-SW
  6265        IF PI-PROCESSOR-IS-CSR
  6266            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6267        ELSE
  6268            MOVE ' '        TO PI-CSR-SESSION-SW
  6269        END-IF
  6270        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6271                               PI-CANCELS-IN-ERROR-SW
  6272                               PI-ONLY-BATCH-HEADERS-SW
  6273                               PI-ALL-OUT-OF-BAL-SW
  6274                               PI-HOLD-REC-SW
  6275                               PI-CHANGE-REC-SW
  6276                               PI-CHK-REQ-REC-SW
  6277                               PI-ISSUE-WARNING-SW
  6278                               PI-CANCEL-WARNING-SW
  6279        MOVE '1'            TO PI-BROWSE-TYPE
  6280        MOVE DFHENTER       TO  EIBAID
  6281
  6282
  6283* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 115
* EL1278.cbl
  6284*           PROGRAM    ('EL6311')
  6285*           COMMAREA   (WS-PASS-631)
  6286*           LENGTH     (1300)
  6287*       END-EXEC
  6288     MOVE 'EL6311' TO DFHEIV1
  6289     MOVE 1300
  6290       TO DFHEIV11
  6291*    MOVE '.$C                   %   #00006240' TO DFHEIV0
  6292     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6293     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6294     MOVE X'2020233030303036323430' TO DFHEIV0(25:11)
  6295     CALL 'kxdfhei1' USING DFHEIV0,
  6296           DFHEIV1,
  6297           WS-PASS-631,
  6298           DFHEIV11,
  6299           DFHEIV99
  6300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6301
  6302*        PERFORM 0500-FORMAT-SCREEN
  6303     END-IF
  6304     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 116
* EL1278.cbl
  6306 0500-FORMAT-SCREEN  SECTION.
  6307     MOVE LOW-VALUES             TO  EL127HO.
  6308     MOVE PI-CARRIER             TO  HCARIERO.
  6309     MOVE PI-GROUPING            TO  HGROUPO.
  6310     MOVE PI-STATE               TO  HSTATEO.
  6311     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6312     MOVE ' '                    TO  DC-OPTION-CODE.
  6313     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6314
  6315     PERFORM 9600-DATE-LINK.
  6316
  6317     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6318     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6319     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6320     MOVE PI-CLP-YN              TO  CLPYNO
  6321     MOVE PI-CANCEL-REASON       TO  CANREAO
  6322     .
  6323 0510-GET-CERT.
  6324     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6325     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6326     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6327     MOVE PI-STATE               TO  WS-CM-STATE.
  6328     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6329     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6330     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6331     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6332
  6333     PERFORM 0900-READ-CERT-FILE.
  6334
  6335     IF CERT-NOT-FOUND
  6336         MOVE -1                 TO  HLCANCL
  6337         MOVE AL-SANON           TO  HLCANCA
  6338         MOVE ER-0214            TO  EMI-ERROR
  6339         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6340         GO TO 8100-SEND-INITIAL-MAP.
  6341
  6342     IF CM-CLAIM-ATTACHED-COUNT = +0
  6343        GO TO 0510-SKIP-CLAIM-CHECK
  6344     END-IF
  6345*    DISPLAY ' STARTING CLAIM TEST '
  6346     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6347     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6348
  6349* EXEC CICS STARTBR
  6350*       DATASET     ('ELMSTR5')
  6351*       RIDFLD      (ELMSTR-KEY)
  6352*       RESP        (WS-RESPONSE)
  6353*    END-EXEC
  6354     MOVE 'ELMSTR5' TO DFHEIV1
  6355     MOVE 0
  6356       TO DFHEIV11
  6357*    MOVE '&,         G          &  N#00006292' TO DFHEIV0
  6358     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6359     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6360     MOVE X'204E233030303036323932' TO DFHEIV0(25:11)
  6361     CALL 'kxdfhei1' USING DFHEIV0,
  6362           DFHEIV1,
  6363           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 117
* EL1278.cbl
  6364           DFHEIV99,
  6365           DFHEIV11,
  6366           DFHEIV99
  6367     MOVE EIBRESP  TO WS-RESPONSE
  6368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6369     IF WS-RESP-NORMAL
  6370     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6371
  6372* EXEC CICS READNEXT
  6373*          DATASET   ('ELMSTR5')
  6374*          RIDFLD    (ELMSTR-KEY)
  6375*          SET       (ADDRESS OF CLAIM-MASTER)
  6376*          RESP      (WS-RESPONSE)
  6377*       END-EXEC
  6378     MOVE 'ELMSTR5' TO DFHEIV1
  6379     MOVE 0
  6380       TO DFHEIV11
  6381*    MOVE '&.S                   )  N#00006299' TO DFHEIV0
  6382     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6383     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6384     MOVE X'204E233030303036323939' TO DFHEIV0(25:11)
  6385     CALL 'kxdfhei1' USING DFHEIV0,
  6386           DFHEIV1,
  6387           DFHEIV20,
  6388           DFHEIV99,
  6389           ELMSTR-KEY,
  6390           DFHEIV99,
  6391           DFHEIV11,
  6392           DFHEIV99,
  6393           DFHEIV99
  6394     SET ADDRESS OF CLAIM-MASTER TO
  6395         DFHEIV20
  6396     MOVE EIBRESP  TO WS-RESPONSE
  6397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6398        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6399           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6400           AND (CM-CERT-NO = CL-CERT-NO)
  6401           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6402              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6403              SET FOUND-A-CLAIM  TO TRUE
  6404              IF CL-CLAIM-TYPE = 'L'
  6405                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6406                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6407                 END-IF
  6408                 IF CLAIM-IS-OPEN
  6409                    SET OPEN-LF-CLAIM TO TRUE
  6410                 ELSE
  6411                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6412                       MOVE CL-LAST-CLOSE-DT
  6413                                 TO WS-LF-LAST-CLOSE-DT
  6414                    END-IF
  6415                    SET CLOSED-LF-CLAIM TO TRUE
  6416                 END-IF
  6417              ELSE
  6418                 IF CLAIM-IS-OPEN
  6419                    MOVE CL-PAID-THRU-DT
  6420                                 TO WS-AH-PAID-THRU-DT
  6421                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 118
* EL1278.cbl
  6422                 ELSE
  6423                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6424                       MOVE CL-PAID-THRU-DT
  6425                                 TO WS-AH-PAID-THRU-DT
  6426                    END-IF
  6427                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6428                       MOVE CL-LAST-CLOSE-DT
  6429                                 TO WS-AH-LAST-CLOSE-DT
  6430                    END-IF
  6431                    SET CLOSED-AH-CLAIM TO TRUE
  6432                 END-IF
  6433              END-IF
  6434           END-IF
  6435        ELSE
  6436           SET I-SAY-TO-STOP TO TRUE
  6437        END-IF
  6438     END-PERFORM
  6439     END-IF
  6440     IF FOUND-A-CLAIM
  6441        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6442           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6443           MOVE ' '              TO DC-OPTION-CODE
  6444           PERFORM 9600-DATE-LINK
  6445           IF NO-CONVERSION-ERROR
  6446              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6447              MOVE AL-SANOF      TO LCLMDTHA
  6448           END-IF
  6449        END-IF
  6450        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6451           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6452           MOVE ' '              TO DC-OPTION-CODE
  6453           PERFORM 9600-DATE-LINK
  6454           IF NO-CONVERSION-ERROR
  6455              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6456              MOVE AL-SANOF      TO ACLMDTHA
  6457           END-IF
  6458        END-IF
  6459        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6460        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6461        MOVE CM-STATE            TO WS-CF-ACCESS
  6462        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6463
  6464* EXEC CICS READ
  6465*          DATASET  (ELCNTL-ID)
  6466*          SET      (ADDRESS OF CONTROL-FILE)
  6467*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6468*          RESP     (WS-RESPONSE)
  6469*       END-EXEC
  6470*    MOVE '&"S        E          (  N#00006370' TO DFHEIV0
  6471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6473     MOVE X'204E233030303036333730' TO DFHEIV0(25:11)
  6474     CALL 'kxdfhei1' USING DFHEIV0,
  6475           ELCNTL-ID,
  6476           DFHEIV20,
  6477           DFHEIV99,
  6478           WS-CF-CONTROL-PRIMARY,
  6479           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 119
* EL1278.cbl
  6480           DFHEIV99,
  6481           DFHEIV99
  6482     SET ADDRESS OF CONTROL-FILE TO
  6483         DFHEIV20
  6484     MOVE EIBRESP  TO WS-RESPONSE
  6485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6486        IF WS-RESP-NORMAL
  6487           MOVE CF-ST-REF-AH-DEATH-IND
  6488                                 TO WS-ST-REF-IND
  6489        END-IF
  6490     END-IF
  6491     .
  6492 0510-SKIP-CLAIM-CHECK.
  6493     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6494     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6495     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6496     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6497
  6498* EXEC CICS READ
  6499*        DATASET  (ERMAIL-ID)
  6500*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6501*        SET      (ADDRESS OF MAILING-DATA)
  6502*        RESP     (WS-RESPONSE)
  6503*    END-EXEC.
  6504*    MOVE '&"S        E          (  N#00006387' TO DFHEIV0
  6505     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6507     MOVE X'204E233030303036333837' TO DFHEIV0(25:11)
  6508     CALL 'kxdfhei1' USING DFHEIV0,
  6509           ERMAIL-ID,
  6510           DFHEIV20,
  6511           DFHEIV99,
  6512           WS-MA-CONTROL-PRIMARY,
  6513           DFHEIV99,
  6514           DFHEIV99,
  6515           DFHEIV99
  6516     SET ADDRESS OF MAILING-DATA TO
  6517         DFHEIV20
  6518     MOVE EIBRESP  TO WS-RESPONSE
  6519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6520
  6521     IF WS-RESP-NORMAL
  6522        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6523           (S1 > +7)
  6524           OR (MA-MAIL-STATUS (S1) = '1')
  6525        END-PERFORM
  6526        IF S1 > +7
  6527           MOVE AL-SANOF         TO HPCYNA
  6528        END-IF
  6529     END-IF
  6530     IF CM-POST-CARD-IND = 'Y'
  6531        MOVE 'Y'                 TO HPCYNO
  6532     ELSE
  6533        MOVE 'N'                 TO HPCYNO
  6534     END-IF
  6535     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6536        OR (NOT CERT-AS-LOADED)
  6537        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 120
* EL1278.cbl
  6538     END-IF
  6539*    IF (CERT-ADDED-BATCH)
  6540*       CONTINUE
  6541*    ELSE
  6542*       MOVE AL-SANOF            TO HPCYNA
  6543*    END-IF
  6544     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6545     MOVE '5'                    TO  DC-OPTION-CODE.
  6546
  6547     PERFORM 9600-DATE-LINK.
  6548
  6549     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6550     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6551     MOVE '1'                    TO  DC-OPTION-CODE.
  6552
  6553     PERFORM 9600-DATE-LINK.
  6554
  6555     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6556
  6557     MOVE ZEROS TO WS-TOT-ITDR.
  6558     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6559
  6560 0510-CHECK-LF-STATUS.
  6561
  6562     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6563         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6564                                    PI-LF-CANCEL-DATE
  6565         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6566                                    PI-LF-CANCEL-DATE-ED
  6567                                    PI-LF-REFUND-METH
  6568         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6569         GO TO 0510-CHECK-AH-STATUS.
  6570
  6571     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6572        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6573          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6574          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6575          IF FIRST-ENTRY
  6576              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6577              MOVE SPACES               TO DC-OPTION-CODE
  6578              PERFORM 9600-DATE-LINK
  6579              IF NOT DATE-CONVERSION-ERROR
  6580                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6581                                            PI-LF-CANCEL-DATE-ED
  6582                                            WS-LF-CANCEL-DATE-ED
  6583                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6584                                            WS-LF-CANCEL-DATE.
  6585
  6586     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6587        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6588          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6589          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6590          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6591        IF FIRST-ENTRY
  6592            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6593            MOVE SPACES               TO DC-OPTION-CODE
  6594            PERFORM 9600-DATE-LINK
  6595            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 121
* EL1278.cbl
  6596                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6597                                          PI-LF-CANCEL-DATE-ED
  6598                                          WS-LF-CANCEL-DATE-ED
  6599                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6600                                          WS-LF-CANCEL-DATE.
  6601
  6602 0510-CHECK-AH-STATUS.
  6603
  6604     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6605         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6606                                    PI-AH-CANCEL-DATE
  6607         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6608                                    PI-AH-CANCEL-DATE-ED
  6609                                    PI-AH-REFUND-METH
  6610         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6611         GO TO 0510-CONT.
  6612
  6613     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6614        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6615          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6616          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6617        IF FIRST-ENTRY
  6618            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6619            MOVE SPACES               TO DC-OPTION-CODE
  6620            PERFORM 9600-DATE-LINK
  6621            IF NOT DATE-CONVERSION-ERROR
  6622                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6623                                            PI-AH-CANCEL-DATE-ED
  6624                                            WS-AH-CANCEL-DATE-ED
  6625                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6626                                            WS-AH-CANCEL-DATE.
  6627
  6628     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6629        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6630          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6631          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6632          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6633         IF FIRST-ENTRY
  6634             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6635             MOVE SPACES               TO DC-OPTION-CODE
  6636             PERFORM 9600-DATE-LINK
  6637             IF NOT DATE-CONVERSION-ERROR
  6638                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6639                                            PI-AH-CANCEL-DATE-ED
  6640                                            WS-AH-CANCEL-DATE-ED
  6641                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6642                                            WS-AH-CANCEL-DATE.
  6643
  6644     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6645         MOVE 'CANC DT'              TO  CNCDTHDO
  6646         GO TO 0510-CONT.
  6647
  6648     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6649         MOVE 'DTH DT '              TO  CNCDTHDO
  6650         IF FIRST-ENTRY
  6651             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6652             MOVE ' '                TO  DC-OPTION-CODE
  6653             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 122
* EL1278.cbl
  6654             IF NOT DATE-CONVERSION-ERROR
  6655                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6656                                             PI-AH-CANCEL-DATE-ED
  6657                                             WS-AH-CANCEL-DATE-ED
  6658                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6659                                             WS-AH-CANCEL-DATE.
  6660
  6661 0510-CONT.
  6662
  6663     IF WS-TOT-ITDR GREATER THAN ZEROS
  6664         MOVE WS-TOT-ITDR TO TOITDRO.
  6665
  6666 0520-GET-COMPANY-RECORD.
  6667     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6668     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6669     MOVE SPACES                 TO  WS-CF-ACCESS.
  6670     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6671
  6672     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6673
  6674     IF CNTL-NOT-FOUND
  6675         MOVE -1                 TO  HLCANCL
  6676         MOVE AL-SANON           TO  HLCANCA
  6677         MOVE ER-2616            TO  EMI-ERROR
  6678         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6679         GO TO 8100-SEND-INITIAL-MAP.
  6680
  6681     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6682       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6683         MOVE CF-LIFE-OVERRIDE-L1
  6684                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6685         MOVE CF-LIFE-OVERRIDE-L2
  6686                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6687         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6688         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6689         MOVE CF-CR-REM-TERM-CALC
  6690                                 TO  WS-CF-CR-REM-TERM-CALC
  6691         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6692         IF CF-DEFAULT-APR NUMERIC
  6693             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6694             GO TO 0525-GET-LF-BENEFIT
  6695         ELSE
  6696             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6697             GO TO 0525-GET-LF-BENEFIT.
  6698
  6699     MOVE -1                     TO  HLCANCL.
  6700     MOVE AL-SANON               TO  HLCANCA.
  6701     MOVE ER-2616                TO  EMI-ERROR.
  6702
  6703     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6704
  6705     GO TO 8100-SEND-INITIAL-MAP.
  6706
  6707 0525-GET-LF-BENEFIT.
  6708
  6709     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6710        GO TO 0527-GET-AH-BENEFIT
  6711     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 123
* EL1278.cbl
  6712
  6713     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6714     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6715                                     HLCDO.
  6716     MOVE WS-CF-LIFE-OVERRIDE-L2
  6717                                 TO  HLKINDO.
  6718
  6719     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6720
  6721     IF BENEFIT-FOUND
  6722         NEXT SENTENCE
  6723     ELSE
  6724         MOVE -1                 TO  HLCDL
  6725         MOVE AL-SANON           TO  HLCDA
  6726         MOVE ER-0028            TO  EMI-ERROR
  6727         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6728         GO TO 8100-SEND-INITIAL-MAP.
  6729
  6730     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6731         MOVE AL-UNNOF           TO  HLTERMA.
  6732
  6733*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6734     MOVE WS-KIND                TO WS-LF-KIND
  6735     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6736                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6737
  6738     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6739         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6740                                 TO  WS-LF-CO-REM-TERM-CALC.
  6741
  6742     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6743         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6744                                 TO  WS-LF-CO-EARNINGS-CALC
  6745                                     WS-LF-CO-REFUND-CALC.
  6746
  6747     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6748         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6749                                 TO  WS-LF-SPECIAL-CALC-CD.
  6750
  6751     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6752         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6753                                 TO  WS-LF-CO-REFUND-CALC.
  6754
  6755 0527-GET-AH-BENEFIT.
  6756
  6757     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6758        GO TO 0530-GET-STATE-RECORD
  6759     END-IF
  6760
  6761     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6762     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6763                                     HACDO.
  6764     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6765
  6766     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6767
  6768     IF BENEFIT-FOUND
  6769         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 124
* EL1278.cbl
  6770     ELSE
  6771         MOVE -1                 TO  HACDL
  6772         MOVE AL-SANON           TO  HACDA
  6773         MOVE ER-0028            TO  EMI-ERROR
  6774         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6775         GO TO 8100-SEND-INITIAL-MAP.
  6776
  6777     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6778         MOVE AL-UNNOF           TO  HATERMA.
  6779
  6780*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6781     MOVE WS-KIND                TO  WS-AH-KIND
  6782
  6783     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6784         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6785                                 TO  WS-AH-CO-REM-TERM-CALC.
  6786
  6787     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6788         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6789                                 TO  WS-AH-CO-EARNINGS-CALC
  6790                                     WS-AH-CO-REFUND-CALC.
  6791
  6792     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6793         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6794                                 TO  WS-AH-SPECIAL-CALC-CD.
  6795
  6796     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6797         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6798                                 TO  WS-AH-CO-REFUND-CALC.
  6799     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6800        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6801                                 TO WS-AH-BEN-CATEGORY
  6802     END-IF
  6803     .
  6804 0530-GET-STATE-RECORD.
  6805     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6806     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6807     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6808     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6809
  6810     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6811
  6812     IF CNTL-NOT-FOUND
  6813         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6814                                     WS-LF-ST-REM-TERM-CALC
  6815         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6816         GO TO 0560-FIND-ACCOUNT.
  6817
  6818     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6819       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6820       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6821         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6822     ELSE
  6823         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6824                                     WS-LF-ST-REM-TERM-CALC
  6825         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6826         GO TO 0560-FIND-ACCOUNT.
  6827
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 125
* EL1278.cbl
  6828     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6829     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6830
  6831     IF CM-LF-BENEFIT-CD  = '00'
  6832         GO TO 0550-GET-AH-BEN-IN-STATE.
  6833
  6834 0540-GET-LF-BEN-IN-STATE.
  6835     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6836     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6837
  6838     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6839     IF CF-ST-RT-CALC NOT = SPACES
  6840        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6841     END-IF
  6842
  6843     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6844        IF CF-ST-RF-LR-CALC > '0'
  6845           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6846        END-IF
  6847        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6848           IF CF-ST-RF-LN-CALC > '0'
  6849              MOVE CF-ST-RF-LN-CALC
  6850                                 TO WS-LF-ST-REFUND-CALC
  6851           END-IF
  6852        END-IF
  6853     ELSE
  6854        IF CF-ST-RF-LL-CALC > '0'
  6855           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6856        END-IF
  6857     END-IF
  6858
  6859     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6860
  6861     IF NO-BENEFIT-FOUND
  6862*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6863         GO TO 0550-GET-AH-BEN-IN-STATE.
  6864
  6865     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6866         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6867                                 TO  WS-LF-ST-REM-TERM-CALC.
  6868
  6869     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6870         MOVE CF-ST-REFUND-CALC (SUB3)
  6871                                 TO  WS-LF-ST-REFUND-CALC.
  6872
  6873 0550-GET-AH-BEN-IN-STATE.
  6874     IF CM-AH-BENEFIT-CD  = '00'
  6875         GO TO 0560-FIND-ACCOUNT.
  6876
  6877     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6878     IF CF-ST-RT-CALC NOT = SPACES
  6879        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6880     END-IF
  6881
  6882     IF CF-ST-RF-AH-CALC > '0'
  6883        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6884     END-IF
  6885     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 126
* EL1278.cbl
  6886        IF CF-ST-RF-CP-CALC > '0'
  6887           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6888        END-IF
  6889     END-IF
  6890
  6891     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6892     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6893
  6894     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6895
  6896     IF NO-BENEFIT-FOUND
  6897*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6898         GO TO 0560-FIND-ACCOUNT.
  6899
  6900     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6901         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6902                                 TO  WS-AH-ST-REM-TERM-CALC.
  6903
  6904     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6905         MOVE CF-ST-REFUND-CALC (SUB3)
  6906                                 TO  WS-AH-ST-REFUND-CALC.
  6907
  6908 0560-FIND-ACCOUNT.
  6909     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6910     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6911     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6912     MOVE CM-STATE               TO  WS-AM-STATE.
  6913     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6914     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6915     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6916
  6917     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6918
  6919     IF ACCT-FOUND
  6920         NEXT SENTENCE
  6921     ELSE
  6922         GO TO 0585-NO-ACCT.
  6923
  6924 0570-READ-NEXT-RANGE.
  6925     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6926
  6927     IF ACCT-FOUND
  6928         NEXT SENTENCE
  6929     ELSE
  6930         GO TO 0580-ACCT-NOT-FOUND.
  6931
  6932     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6933       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6934       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6935       AND CM-STATE  IS EQUAL TO  AM-STATE
  6936       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6937         NEXT SENTENCE
  6938     ELSE
  6939         GO TO 0580-ACCT-NOT-FOUND.
  6940
  6941     MOVE 'X'                    TO  DATE-RANGE-SW.
  6942
  6943     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 127
* EL1278.cbl
  6944         MOVE 'X'                TO  DATE-RANGE-SW
  6945         GO TO 0580-ACCT-NOT-FOUND.
  6946
  6947     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6948         GO TO 0570-READ-NEXT-RANGE.
  6949
  6950     IF WS-BROWSE-STARTED-SW = 'Y'
  6951
  6952* EXEC CICS ENDBR
  6953*          DATASET    ('ERACCT')
  6954*       END-EXEC
  6955     MOVE 'ERACCT' TO DFHEIV1
  6956     MOVE 0
  6957       TO DFHEIV11
  6958*    MOVE '&2                    $   #00006823' TO DFHEIV0
  6959     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6960     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6961     MOVE X'2020233030303036383233' TO DFHEIV0(25:11)
  6962     CALL 'kxdfhei1' USING DFHEIV0,
  6963           DFHEIV1,
  6964           DFHEIV11,
  6965           DFHEIV99
  6966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6967        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6968     END-IF
  6969     MOVE ' '                    TO  DATE-RANGE-SW.
  6970     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6971
  6972     GO TO 0590-SET-ACCOUNT.
  6973
  6974 0580-ACCT-NOT-FOUND.
  6975     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6976         MOVE ER-2601            TO  EMI-ERROR
  6977     ELSE
  6978         MOVE ER-2619            TO  EMI-ERROR.
  6979
  6980     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6981
  6982     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6983
  6984 0585-NO-ACCT.
  6985     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6986     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6987                                     WS-AM-EARN-METHOD-R
  6988                                     WS-AM-EARN-METHOD-A
  6989                                     WS-LF-AM-REM-TERM-CALC
  6990                                     WS-AH-AM-REM-TERM-CALC.
  6991
  6992     GO TO 0600-CHECK-FOR-LIFE.
  6993
  6994 0590-SET-ACCOUNT.
  6995******************************************************************
  6996******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6997******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6998******* METHODS.
  6999******************************************************************
  7000     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  7001     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 128
* EL1278.cbl
  7002     IF PI-COMPANY-ID EQUAL TO 'NCL'
  7003          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  7004                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  7005                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  7006                  IF FORM-FOUND
  7007                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  7008******************************************************************
  7009
  7010     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  7011     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  7012                                     WS-AM-EARN-METHOD-R
  7013                                     WS-AM-EARN-METHOD-A.
  7014
  7015*    EVALUATE AM-EARN-METHOD-R
  7016*       WHEN 'R'
  7017*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  7018*       WHEN 'P'
  7019*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  7020*       WHEN 'C'
  7021*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  7022*       WHEN 'A'
  7023*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  7024*       WHEN 'M'
  7025*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  7026*       WHEN 'S'
  7027*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  7028*    END-EVALUATE.
  7029
  7030*    EVALUATE AM-EARN-METHOD-L
  7031*       WHEN 'R'
  7032*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  7033*       WHEN 'P'
  7034*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  7035*       WHEN 'C'
  7036*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  7037*       WHEN 'A'
  7038*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  7039*       WHEN 'M'
  7040*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  7041*       WHEN 'S'
  7042*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  7043*    END-EVALUATE.
  7044
  7045*    EVALUATE AM-EARN-METHOD-A
  7046*       WHEN 'R'
  7047*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  7048*       WHEN 'P'
  7049*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  7050*       WHEN 'C'
  7051*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  7052*       WHEN 'A'
  7053*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  7054*       WHEN 'M'
  7055*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  7056*       WHEN 'N'
  7057*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  7058*       WHEN 'S'
  7059*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 129
* EL1278.cbl
  7060*    END-EVALUATE.
  7061
  7062     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  7063                                     WS-TOT-LF-PREM
  7064                                     WS-TOT-AH-RFND
  7065                                     WS-TOT-LF-RFND.
  7066
  7067 0600-CHECK-FOR-LIFE.
  7068     IF CM-LF-BENEFIT-CD  = '00'
  7069         GO TO 0640-AH-BENEFIT.
  7070
  7071 0610-GET-LIFE-BENEFIT.
  7072
  7073     IF ACCT-FOUND
  7074         MOVE +1                 TO SUB3
  7075         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  7076     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7077     MOVE WS-LF-KIND             TO  HLEDESCO.
  7078     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7079     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7080        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7081                             + CM-LF-ALT-PREMIUM-AMT
  7082     ELSE
  7083        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7084     END-IF
  7085
  7086     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7087     EVALUATE TRUE
  7088        WHEN ((OPEN-LF-CLAIM)
  7089           OR (CLOSED-LF-CLAIM))
  7090           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7091           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  7092                                    WS-TOT-LF-RFND
  7093                                    PI-LF-REFUND-AMT
  7094           IF CM-AH-BENEFIT-CD NOT = '00'
  7095              MOVE ZEROS         TO HAREFNDO
  7096                                    WS-TOT-AH-RFND
  7097                                    PI-AH-REFUND-AMT
  7098              MOVE SPACES        TO PI-AH-REFUND-METH
  7099           END-IF
  7100           MOVE ER-2965          TO EMI-ERROR
  7101           PERFORM 9700-ERROR-FORMAT
  7102                                 THRU  9799-EXIT
  7103           GO TO 0640-AH-BENEFIT
  7104        WHEN OPEN-LF-CLAIM
  7105           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7106           AND WS-ST-REF-IND = '4'
  7107           MOVE ER-2966          TO EMI-ERROR
  7108           PERFORM 9700-ERROR-FORMAT
  7109                                 THRU  9799-EXIT
  7110        WHEN OPEN-LF-CLAIM
  7111           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7112           AND WS-ST-REF-IND NOT = '4'
  7113           MOVE ER-2967          TO EMI-ERROR
  7114           PERFORM 9700-ERROR-FORMAT
  7115                                 THRU  9799-EXIT
  7116           GO TO 0640-AH-BENEFIT
  7117        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 130
* EL1278.cbl
  7118           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7119           AND WS-ST-REF-IND = '4'
  7120           MOVE ER-2968          TO EMI-ERROR
  7121           PERFORM 9700-ERROR-FORMAT
  7122                                 THRU  9799-EXIT
  7123        WHEN CLOSED-LF-CLAIM
  7124           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7125           AND WS-ST-REF-IND NOT = '4'
  7126           MOVE ER-2969          TO EMI-ERROR
  7127           PERFORM 9700-ERROR-FORMAT
  7128                                 THRU  9799-EXIT
  7129           GO TO 0640-AH-BENEFIT
  7130        WHEN OTHER
  7131           CONTINUE
  7132     END-EVALUATE
  7133     .
  7134 0620-GET-REM-TERM.
  7135     MOVE WS-CF-LIFE-OVERRIDE-L1
  7136                                 TO  CP-LIFE-OVERRIDE-CODE.
  7137     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7138     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7139     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  7140     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7141     MOVE CM-STATE               TO  CP-STATE.
  7142     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7143     MOVE WS-CF-LF-COVERAGE-TYPE
  7144                                 TO  CP-BENEFIT-TYPE.
  7145     MOVE WS-LF-KIND             TO  HLEDESCO.
  7146     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7147     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7148     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7149     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7150     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7151     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7152     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7153     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7154     MOVE WS-CF-CR-REM-TERM-CALC
  7155                                 TO  CP-REM-TERM-METHOD.
  7156
  7157     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7158         MOVE WS-LF-CO-REM-TERM-CALC
  7159                                 TO  CP-REM-TERM-METHOD.
  7160
  7161     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7162         MOVE WS-LF-ST-REM-TERM-CALC
  7163                                 TO  CP-REM-TERM-METHOD.
  7164
  7165     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7166         MOVE WS-LF-AM-REM-TERM-CALC
  7167                                 TO  CP-REM-TERM-METHOD.
  7168
  7169     IF (PI-COMPANY-ID = 'CID')
  7170        AND (CP-STATE-STD-ABBRV = 'WI')
  7171        MOVE '7'                 TO CP-REM-TERM-METHOD
  7172        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7173     END-IF
  7174     IF (PI-COMPANY-ID = 'CID')
  7175        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 131
* EL1278.cbl
  7176        AND (CM-CERT-EFF-DT >= X'9B41')
  7177        AND (CM-CERT-EFF-DT <= X'A2FB')
  7178        MOVE '7'                 TO CP-REM-TERM-METHOD
  7179        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7180     END-IF
  7181     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7182                                     CP-ORIGINAL-TERM
  7183                                     CP-LOAN-TERM.
  7184
  7185     IF CP-TRUNCATED-LIFE
  7186         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7187
  7188     IF CP-TERM-IS-DAYS
  7189         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7190             MOVE CM-LF-TERM-IN-DAYS
  7191                                 TO  CP-TERM-OR-EXT-DAYS
  7192         ELSE
  7193             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7194     ELSE
  7195         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7196             MOVE CM-PMT-EXTENSION-DAYS
  7197                                 TO  CP-TERM-OR-EXT-DAYS
  7198         ELSE
  7199             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7200
  7201*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7202     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7203     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7204     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7205     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7206
  7207
  7208* EXEC CICS READ
  7209*        DATASET  (ELCNTL-ID)
  7210*        SET      (ADDRESS OF CONTROL-FILE)
  7211*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7212*        RESP     (WS-RESPONSE)
  7213*    END-EXEC.
  7214*    MOVE '&"S        E          (  N#00007066' TO DFHEIV0
  7215     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7217     MOVE X'204E233030303037303636' TO DFHEIV0(25:11)
  7218     CALL 'kxdfhei1' USING DFHEIV0,
  7219           ELCNTL-ID,
  7220           DFHEIV20,
  7221           DFHEIV99,
  7222           WS-CF-CONTROL-PRIMARY,
  7223           DFHEIV99,
  7224           DFHEIV99,
  7225           DFHEIV99
  7226     SET ADDRESS OF CONTROL-FILE TO
  7227         DFHEIV20
  7228     MOVE EIBRESP  TO WS-RESPONSE
  7229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7230
  7231
  7232     IF WS-RESP-NOTOPEN
  7233         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 132
* EL1278.cbl
  7234         GO TO 0320-INPUT-ERROR.
  7235
  7236     IF WS-RESP-NOTFND
  7237         MOVE ZERO               TO  CP-FREE-LOOK
  7238     ELSE
  7239         MOVE CF-ST-FREE-LOOK-PERIOD
  7240                                 TO CP-FREE-LOOK.
  7241
  7242     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7243        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7244        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7245     END-IF
  7246
  7247     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7248
  7249     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7250        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7251        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7252        COMPUTE CP-REMAINING-TERM-1 =
  7253                CP-REMAINING-TERM-1 - +1
  7254        COMPUTE CP-REMAINING-TERM-2 =
  7255                CP-REMAINING-TERM-2 - +1
  7256     END-IF
  7257
  7258     IF CP-REMAINING-TERM-1 NEGATIVE
  7259        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7260     END-IF
  7261     IF CP-REMAINING-TERM-2 NEGATIVE
  7262        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7263     END-IF
  7264     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7265
  7266     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7267         GO TO 0640-AH-BENEFIT.
  7268*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7269*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7270
  7271     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7272         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7273             MOVE ER-0681        TO  EMI-ERROR
  7274             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7275
  7276     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7277         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7278             MOVE ER-0682        TO  EMI-ERROR
  7279             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7280
  7281 0630-CONTINUE-LIFE.
  7282
  7283     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7284        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7285        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7286                                    FREMTRMO
  7287     ELSE
  7288        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7289                                     FREMTRMO
  7290     END-IF
  7291     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 133
* EL1278.cbl
  7292     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7293     if pi-company-id = 'AHL'
  7294        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7295        if cp-class-code = spaces
  7296           move zeros            to cp-class-code
  7297        end-if
  7298     ELSE
  7299        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7300     END-IF
  7301     IF (PI-COMPANY-ID = 'DCC')
  7302        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7303        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7304        PERFORM 0730-GET-DDF-FACTORS
  7305                                 THRU 0730-EXIT
  7306        IF PDEF-FOUND
  7307           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7308              (P1 > +8)
  7309              OR (PD-PROD-CODE (P1) = 'L')
  7310           END-PERFORM
  7311           IF P1 < +9
  7312              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7313           END-IF
  7314        END-IF
  7315     END-IF
  7316     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7317
  7318     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7319
  7320     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7321        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7322                             + CM-LF-ALT-PREMIUM-AMT
  7323     ELSE
  7324        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7325     END-IF
  7326
  7327     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7328                                     WS-TOT-LF-PREM.
  7329
  7330     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7331        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7332        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7333     ELSE
  7334        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7335     END-IF
  7336
  7337     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7338     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7339
  7340     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7341         MOVE WS-LF-ST-REFUND-CALC
  7342                                 TO  CP-EARNING-METHOD.
  7343
  7344     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7345         MOVE WS-LF-FO-REFUND-CALC
  7346                                 TO  CP-EARNING-METHOD.
  7347
  7348     if (pi-company-id = 'CID')
  7349        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 134
* EL1278.cbl
  7350        continue
  7351     else
  7352        IF CP-RATING-METHOD = '4'
  7353           MOVE '4'              TO CP-EARNING-METHOD
  7354        END-IF
  7355     end-if
  7356*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7357*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7358*            MOVE WS-AM-EARN-METHOD-R
  7359*                                TO  CP-EARNING-METHOD
  7360*        END-IF
  7361*    ELSE
  7362*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7363*            MOVE WS-AM-EARN-METHOD-L
  7364*                                TO  CP-EARNING-METHOD.
  7365
  7366     if pi-company-id = 'AHL'
  7367        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7368        if cp-class-code = spaces
  7369           move zeros            to cp-class-code
  7370        end-if
  7371     ELSE
  7372        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7373     END-IF
  7374     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7375     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7376                                     CP-RATING-BENEFIT-AMT.
  7377     IF CP-STATE-STD-ABBRV = 'OR'
  7378         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7379                                         CM-LF-ALT-BENEFIT-AMT.
  7380****   N O T E   ****
  7381*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7382*      THE OH HARD CODING IN ELCRFNDP
  7383
  7384     IF PI-COMPANY-ID = 'CID'
  7385        IF CP-STATE-STD-ABBRV = 'OH'
  7386           MOVE WS-LF-CO-EARNINGS-CALC
  7387                                 TO CP-EARNING-METHOD
  7388        END-IF
  7389     END-IF
  7390
  7391****   N O T E   ****
  7392
  7393****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7394****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7395****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7396****     THE APPROPRIATE OPTIONS HERE
  7397*    IF PI-COMPANY-ID = 'CID'
  7398*       IF (CP-STATE-STD-ABBRV = 'MN')
  7399*          AND (CM-CERT-EFF-DT > X'A4FF')
  7400*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7401*          MOVE '5'              TO CP-EARNING-METHOD
  7402*       END-IF
  7403*    END-IF
  7404     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7405     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7406     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7407     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 135
* EL1278.cbl
  7408     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7409     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7410
  7411*    IF CP-EARN-AS-NET-PAY
  7412*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7413*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7414*               MOVE WS-CF-DEFAULT-APR
  7415*                                TO  CP-LOAN-APR
  7416*               MOVE ER-3780     TO  EMI-ERROR
  7417*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7418*           ELSE
  7419*               MOVE ER-3781     TO  EMI-ERROR
  7420*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7421
  7422*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7423*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7424*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7425*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7426*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7427*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7428*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7429*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7430*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7431*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7432*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7433*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7434*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7435*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7436*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7437*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7438*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7439*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7440     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7441
  7442     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7443
  7444     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7445
  7446     IF CP-ERROR-RATE-IS-ZERO
  7447       OR CP-ERROR-RATE-NOT-FOUND
  7448         MOVE ER-2740            TO  EMI-ERROR
  7449         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7450
  7451     IF CP-ERROR-RATE-FILE-NOTOPEN
  7452         MOVE ER-2617            TO  EMI-ERROR
  7453         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7454
  7455     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7456     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7457                                     WS-TOT-LF-RFND
  7458                                     PI-LF-REFUND-AMT.
  7459     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7460
  7461     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7462
  7463     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7464         GO TO 0640-AH-BENEFIT.
  7465
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 136
* EL1278.cbl
  7466*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7467*        ADD +1                  TO  CP-REMAINING-TERM
  7468*                                    CP-ORIGINAL-TERM.
  7469
  7470     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7471     MOVE '2'                    TO  CP-EARNING-METHOD
  7472                                     CP-RATING-METHOD.
  7473     IF PI-COMPANY-ID = 'CID'
  7474        IF (CP-STATE-STD-ABBRV = 'MN')
  7475           AND (CM-CERT-EFF-DT > X'A4FF')
  7476           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7477           MOVE '5'              TO CP-EARNING-METHOD
  7478           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7479        END-IF
  7480     END-IF
  7481     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7482                                     CP-REMAINING-BENEFIT
  7483                                     CP-RATING-BENEFIT-AMT.
  7484     IF CP-STATE-STD-ABBRV = 'OR'
  7485         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7486                                         CM-LF-ALT-BENEFIT-AMT.
  7487     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7488     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7489
  7490     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7491
  7492     IF CP-ERROR-RATE-IS-ZERO
  7493       OR CP-ERROR-RATE-NOT-FOUND
  7494         MOVE ER-2740            TO  EMI-ERROR
  7495         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7496
  7497     IF CP-ERROR-RATE-FILE-NOTOPEN
  7498         MOVE ER-2617            TO  EMI-ERROR
  7499         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7500
  7501     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7502
  7503     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7504                                     WS-TOT-LF-RFND
  7505                                     PI-LF-REFUND-AMT.
  7506
  7507     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7508
  7509 0640-AH-BENEFIT.
  7510     IF CM-AH-BENEFIT-CD = '00'
  7511         GO TO 0680-CONTINUE.
  7512
  7513 0650-GET-AH-BENEFIT.
  7514     IF ACCT-FOUND
  7515         MOVE +1                 TO SUB3
  7516         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7517     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7518     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7519     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7520     MOVE WS-AH-KIND             TO  HAEDESCO.
  7521     EVALUATE TRUE
  7522        WHEN ((OPEN-LF-CLAIM)
  7523           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 137
* EL1278.cbl
  7524           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7525           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7526                                    WS-TOT-AH-RFND
  7527                                    PI-AH-REFUND-AMT
  7528           MOVE SPACES           TO PI-AH-REFUND-METH
  7529           MOVE ER-2965          TO EMI-ERROR
  7530           PERFORM 9700-ERROR-FORMAT
  7531                                 THRU  9799-EXIT
  7532           GO TO 0680-CONTINUE
  7533        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7534           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7535           AND (EMI-ERROR = ER-2965)
  7536           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7537           MOVE ZEROS            TO HAREFNDO
  7538                                    WS-TOT-AH-RFND
  7539                                    PI-AH-REFUND-AMT
  7540           MOVE SPACES           TO PI-AH-REFUND-METH
  7541           GO TO 0680-CONTINUE
  7542        WHEN (OPEN-AH-CLAIM)
  7543           AND (WS-ST-REF-IND = '1')
  7544           MOVE ZEROS            TO HAREFNDO
  7545                                    WS-TOT-AH-RFND
  7546                                    PI-AH-REFUND-AMT
  7547           MOVE ER-3039          TO EMI-ERROR
  7548           PERFORM 9700-ERROR-FORMAT
  7549                                 THRU  9799-EXIT
  7550           GO TO 0680-CONTINUE
  7551        WHEN (OPEN-AH-CLAIM)
  7552           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7553           MOVE ER-3037          TO EMI-ERROR
  7554           PERFORM 9700-ERROR-FORMAT
  7555                                 THRU  9799-EXIT
  7556*          CONTINUE
  7557        WHEN (OPEN-AH-CLAIM)
  7558           AND (WS-ST-REF-IND = '5')
  7559           MOVE ER-3038          TO EMI-ERROR
  7560           PERFORM 9700-ERROR-FORMAT
  7561                                 THRU  9799-EXIT
  7562*          CONTINUE
  7563        WHEN (OPEN-AH-CLAIM)
  7564           AND (WS-ST-REF-IND = ' ')
  7565           MOVE ER-2768          TO EMI-ERROR
  7566           PERFORM 9700-ERROR-FORMAT
  7567                                 THRU  9799-EXIT
  7568        WHEN (CLOSED-AH-CLAIM)
  7569           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7570           MOVE ZEROS            TO HAREFNDO
  7571                                    WS-TOT-AH-RFND
  7572                                    PI-AH-REFUND-AMT
  7573           MOVE ER-2756          TO EMI-ERROR
  7574           PERFORM 9700-ERROR-FORMAT
  7575                                 THRU  9799-EXIT
  7576           IF WS-TOT-LF-RFND > 0
  7577              MOVE ZEROS         TO HLREFNDO
  7578                                    WS-TOT-LF-RFND
  7579                                    PI-LF-REFUND-AMT
  7580              MOVE SPACES        TO PI-LF-REFUND-METH
  7581           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 138
* EL1278.cbl
  7582           GO TO 0680-CONTINUE
  7583*       WHEN OTHER
  7584*          CONTINUE
  7585     END-EVALUATE
  7586     .
  7587 0660-GET-REM-TERM.
  7588     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7589     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7590     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7591     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7592     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7593*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7594     MOVE WS-AH-KIND             TO  HAEDESCO.
  7595     MOVE CM-STATE               TO  CP-STATE.
  7596     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7597     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7598     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7599     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7600     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7601     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7602     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7603     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7604     MOVE WS-CF-CR-REM-TERM-CALC
  7605                                 TO  CP-REM-TERM-METHOD.
  7606
  7607     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7608         MOVE WS-AH-CO-REM-TERM-CALC
  7609                                 TO  CP-REM-TERM-METHOD.
  7610
  7611     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7612         MOVE WS-AH-ST-REM-TERM-CALC
  7613                                 TO  CP-REM-TERM-METHOD.
  7614
  7615     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7616         MOVE WS-AH-AM-REM-TERM-CALC
  7617                                 TO  CP-REM-TERM-METHOD.
  7618     IF (PI-COMPANY-ID = 'CID')
  7619        AND (CP-STATE-STD-ABBRV = 'WI')
  7620        MOVE '7'                 TO CP-REM-TERM-METHOD
  7621        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7622     END-IF
  7623     IF (PI-COMPANY-ID = 'CID')
  7624        AND (CP-STATE-STD-ABBRV = 'MO')
  7625        AND (CM-CERT-EFF-DT >= X'9B41')
  7626        AND (CM-CERT-EFF-DT <= X'A2FB')
  7627        MOVE '7'                 TO CP-REM-TERM-METHOD
  7628        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7629     END-IF
  7630
  7631     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7632                                     CP-ORIGINAL-TERM
  7633                                     CP-LOAN-TERM.
  7634
  7635     IF  NOT  CP-TERM-IS-DAYS
  7636         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7637             MOVE CM-PMT-EXTENSION-DAYS
  7638                                 TO  CP-TERM-OR-EXT-DAYS
  7639         ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 139
* EL1278.cbl
  7640             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7641
  7642*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7643     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7644     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7645     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7646     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7647
  7648
  7649* EXEC CICS READ
  7650*        DATASET  (ELCNTL-ID)
  7651*        SET      (ADDRESS OF CONTROL-FILE)
  7652*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7653*        RESP     (WS-RESPONSE)
  7654*    END-EXEC.
  7655*    MOVE '&"S        E          (  N#00007489' TO DFHEIV0
  7656     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7657     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7658     MOVE X'204E233030303037343839' TO DFHEIV0(25:11)
  7659     CALL 'kxdfhei1' USING DFHEIV0,
  7660           ELCNTL-ID,
  7661           DFHEIV20,
  7662           DFHEIV99,
  7663           WS-CF-CONTROL-PRIMARY,
  7664           DFHEIV99,
  7665           DFHEIV99,
  7666           DFHEIV99
  7667     SET ADDRESS OF CONTROL-FILE TO
  7668         DFHEIV20
  7669     MOVE EIBRESP  TO WS-RESPONSE
  7670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7671
  7672
  7673     IF WS-RESP-NOTOPEN
  7674         MOVE ER-2617            TO  EMI-ERROR
  7675         GO TO 0320-INPUT-ERROR.
  7676
  7677     IF WS-RESP-NOTFND
  7678         MOVE ZERO               TO CP-FREE-LOOK
  7679     ELSE
  7680         MOVE CF-ST-FREE-LOOK-PERIOD
  7681                                 TO CP-FREE-LOOK.
  7682
  7683     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7684
  7685     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7686
  7687     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7688         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7689             MOVE ER-0683        TO  EMI-ERROR
  7690             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7691
  7692     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7693         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7694             MOVE ER-0684        TO  EMI-ERROR
  7695             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7696
  7697 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 140
* EL1278.cbl
  7698     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7699                                     WS-TOT-AH-PREM
  7700     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7701
  7702     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7703         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7704
  7705     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7706        GO TO 0680-CONTINUE.
  7707     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7708     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7709     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7710
  7711     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7712         MOVE WS-AH-ST-REFUND-CALC
  7713                                 TO  CP-EARNING-METHOD.
  7714
  7715     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7716         MOVE WS-AH-FO-REFUND-CALC
  7717                                 TO  CP-EARNING-METHOD.
  7718
  7719*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7720*        MOVE WS-AM-EARN-METHOD-A
  7721*                                TO  CP-EARNING-METHOD.
  7722
  7723     if pi-company-id = 'AHL'
  7724        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7725        if cp-class-code = spaces
  7726           move zeros            to cp-class-code
  7727        end-if
  7728     ELSE
  7729        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7730     END-IF
  7731     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7732     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7733                                     CP-RATING-BENEFIT-AMT.
  7734     IF CP-STATE-STD-ABBRV = 'OR'
  7735         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7736                                         CM-AH-ORIG-TERM.
  7737     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7738     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7739     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7740     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7741     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7742     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7743
  7744     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7745     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7746     MOVE ' '                    TO  DC-OPTION-CODE.
  7747
  7748     PERFORM 9600-DATE-LINK.
  7749
  7750     IF CP-STATE-STD-ABBRV = 'OH'
  7751        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7752         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7753           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7754           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7755             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 141
* EL1278.cbl
  7756         END-IF
  7757        END-IF
  7758        IF PI-COMPANY-ID = 'CID'
  7759           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7760                           LOW-VALUES)
  7761              IF CP-CRITICAL-PERIOD
  7762                 MOVE '2'       TO CP-EARNING-METHOD
  7763              ELSE
  7764                 MOVE '6'       TO CP-EARNING-METHOD
  7765              END-IF
  7766           ELSE
  7767              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7768                 MOVE '2'       TO CP-EARNING-METHOD
  7769              ELSE
  7770                 IF ((CM-LF-ORIG-TERM > 60) AND
  7771                    (CM-RATE-CLASS NOT = 'L '))
  7772                               OR
  7773                    (WS-LF-CO-EARNINGS-CALC = '5')
  7774                    IF CP-CRITICAL-PERIOD
  7775                       MOVE '2'  TO CP-EARNING-METHOD
  7776                    ELSE
  7777                       MOVE '6'  TO CP-EARNING-METHOD
  7778                    END-IF
  7779                 ELSE
  7780                    MOVE '1'     TO CP-EARNING-METHOD
  7781                 END-IF
  7782              END-IF
  7783           END-IF
  7784        END-IF
  7785     END-IF
  7786
  7787     IF CP-STATE-STD-ABBRV = 'VA'
  7788       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7789         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7790            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7791                MOVE '6'            TO  CP-EARNING-METHOD
  7792            ELSE
  7793                MOVE '1'            TO  CP-EARNING-METHOD.
  7794
  7795     IF CP-EARN-AS-NET-PAY
  7796         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7797            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7798                MOVE WS-CF-DEFAULT-APR
  7799                                 TO  CP-LOAN-APR
  7800                MOVE ER-3780     TO  EMI-ERROR
  7801                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7802            ELSE
  7803                MOVE ER-3781     TO  EMI-ERROR
  7804                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7805     IF PI-COMPANY-ID = 'DCC'
  7806        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7807           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7808           MOVE 'S'              TO CP-EARNING-METHOD
  7809        END-IF
  7810     END-IF
  7811     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7812     IF (PI-COMPANY-ID = 'DCC')
  7813        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 142
* EL1278.cbl
  7814        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7815                                    WS-DDF-CSO-ADMIN-FEE
  7816                                    WS-DDF-1ST-YR-TOT-EXP
  7817                                    WS-DDF-COMM-AND-MFEE
  7818        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7819           S1 > +10
  7820           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7821              IF (AM-A-COM (S1) NUMERIC)
  7822                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7823                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7824              ELSE
  7825                 MOVE +0         TO WS-COMM-PCT C0
  7826                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7827                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7828              END-IF
  7829              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7830                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7831                    + WS-COMM-PCT
  7832              END-IF
  7833              IF AM-COM-TYP (S1) = 'N'
  7834                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7835                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7836              END-IF
  7837              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7838                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7839                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7840              END-IF
  7841              IF AM-COM-TYP (S1) = 'I'
  7842                 COMPUTE WS-DDF-COMM-AND-MFEE
  7843                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7844              END-IF
  7845           END-IF
  7846        END-PERFORM
  7847        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7848        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7849        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7850           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7851     END-IF
  7852     IF (PI-COMPANY-ID = 'DCC')
  7853        AND (CP-EARNING-METHOD = 'D')
  7854        AND (PI-CANCEL-REASON NOT = 'R')
  7855        PERFORM 0730-GET-DDF-FACTORS
  7856                                 THRU 0730-EXIT
  7857        IF NOT PDEF-FOUND
  7858           MOVE ER-9999          TO EMI-ERROR
  7859           PERFORM 9700-ERROR-FORMAT
  7860                                 THRU 9799-EXIT
  7861           GO TO 8200-SEND-DATAONLY
  7862        END-IF
  7863        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7864                                 TO CP-DDF-LO-FACT
  7865        MOVE PD-UEP-FACTOR (P1 P2)
  7866                                 TO CP-DDF-HI-FACT
  7867        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7868        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7869        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7870        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7871           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 143
* EL1278.cbl
  7872        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7873        IF PI-CLP-YN = 'Y'
  7874           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7875           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7876                                    CP-DDF-CLP
  7877           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7878        END-IF
  7879        IF DD-IU-PRESENT
  7880           MOVE 'I'              TO CP-EARNING-METHOD
  7881        END-IF
  7882        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7883                                    CP-CLP-RATE-UP
  7884        IF (CP-CALC-GROSS-FEE)
  7885           AND (CP-IU-RATE-UP NOT = ZEROS)
  7886           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7887              / CP-ORIGINAL-PREMIUM)
  7888           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7889              / (1 - TEX-FACT-8)
  7890        END-IF
  7891     END-IF
  7892     if pi-company-id = 'VPP'
  7893        IF PI-CLP-YN = 'Y'
  7894           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7895                                    hapremo
  7896                                    CP-DDF-CLP
  7897        END-IF
  7898     end-if
  7899     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7900
  7901     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7902
  7903     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7904
  7905     IF CP-ERROR-RATE-IS-ZERO
  7906       OR CP-ERROR-RATE-NOT-FOUND
  7907         MOVE ER-2740            TO  EMI-ERROR
  7908         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7909
  7910     IF CP-ERROR-RATE-FILE-NOTOPEN
  7911         MOVE ER-2617            TO  EMI-ERROR
  7912         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7913
  7914     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7915     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7916                                     WS-TOT-AH-RFND
  7917                                     PI-AH-REFUND-AMT.
  7918     if pi-company-id = 'VPP'
  7919        if cp-calc-refund < cm-cancel-fee
  7920           move cp-calc-refund   to cm-cancel-fee
  7921        end-if
  7922        if cp-calc-refund = cm-ah-premium-amt
  7923           move zeros            to cm-cancel-fee
  7924        end-if
  7925        move cm-cancel-fee       to canfeeo
  7926        compute refdueo =
  7927           cp-calc-refund - cm-cancel-fee
  7928     end-if
  7929
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 144
* EL1278.cbl
  7930     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7931
  7932     MOVE AL-UANON               TO  HACANCA.
  7933
  7934 0680-CONTINUE.
  7935     IF BROWSE-STARTED
  7936         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7937         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7938
  7939     IF CM-LF-BENEFIT-CD = '00'
  7940         MOVE -1                 TO  HACANCL
  7941     ELSE
  7942         MOVE -1                 TO  HLCANCL.
  7943
  7944     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7945                           WS-TOT-PREM.
  7946     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7947                           WS-TOT-RFND.
  7948
  7949     MOVE WS-TOT-PREM            TO  TOPREMO.
  7950     MOVE WS-TOT-RFND            TO  TORFNDO.
  7951
  7952 0680-EXIT.
  7953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 145
* EL1278.cbl
  7955 0700-LINK-REM-TERM SECTION.
  7956
  7957* EXEC CICS LINK
  7958*        PROGRAM   (ELRTRM-ID)
  7959*        COMMAREA  (CALCULATION-PASS-AREA)
  7960*        LENGTH    (CP-COMM-LENGTH)
  7961*    END-EXEC.
  7962*    MOVE '."C                   (   #00007779' TO DFHEIV0
  7963     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7964     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7965     MOVE X'2020233030303037373739' TO DFHEIV0(25:11)
  7966     CALL 'kxdfhei1' USING DFHEIV0,
  7967           ELRTRM-ID,
  7968           CALCULATION-PASS-AREA,
  7969           CP-COMM-LENGTH,
  7970           DFHEIV99,
  7971           DFHEIV99,
  7972           DFHEIV99,
  7973           DFHEIV99
  7974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7975
  7976
  7977 0700-EXIT.
  7978     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 146
* EL1278.cbl
  7980 0710-LINK-REM-AMOUNT SECTION.
  7981
  7982* EXEC CICS LINK
  7983*        PROGRAM   (ELRAMT-ID)
  7984*        COMMAREA  (CALCULATION-PASS-AREA)
  7985*        LENGTH    (CP-COMM-LENGTH)
  7986*    END-EXEC.
  7987*    MOVE '."C                   (   #00007789' TO DFHEIV0
  7988     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7990     MOVE X'2020233030303037373839' TO DFHEIV0(25:11)
  7991     CALL 'kxdfhei1' USING DFHEIV0,
  7992           ELRAMT-ID,
  7993           CALCULATION-PASS-AREA,
  7994           CP-COMM-LENGTH,
  7995           DFHEIV99,
  7996           DFHEIV99,
  7997           DFHEIV99,
  7998           DFHEIV99
  7999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8000
  8001
  8002 0710-EXIT.
  8003     EXIT.
  8004 0730-GET-DDF-FACTORS.
  8005     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8006     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8007     MOVE CM-STATE               TO ERPDEF-STATE
  8008     if cm-clp-state <> cm-state and spaces
  8009                  and low-values and zeros
  8010        move cm-clp-state        to erpdef-state
  8011     end-if
  8012     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8013     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8014     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8015     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8016     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8017
  8018* EXEC CICS STARTBR
  8019*        DATASET  ('ERPDEF')
  8020*        RIDFLD   (ERPDEF-KEY)
  8021*        GTEQ
  8022*        RESP     (WS-RESPONSE)
  8023*    END-EXEC
  8024     MOVE 'ERPDEF' TO DFHEIV1
  8025     MOVE 0
  8026       TO DFHEIV11
  8027*    MOVE '&,         G          &  N#00007810' TO DFHEIV0
  8028     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8029     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8030     MOVE X'204E233030303037383130' TO DFHEIV0(25:11)
  8031     CALL 'kxdfhei1' USING DFHEIV0,
  8032           DFHEIV1,
  8033           ERPDEF-KEY,
  8034           DFHEIV99,
  8035           DFHEIV11,
  8036           DFHEIV99
  8037     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 147
* EL1278.cbl
  8038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8039     IF NOT WS-RESP-NORMAL
  8040        GO TO 0730-EXIT
  8041     END-IF
  8042     .
  8043 0730-READNEXT.
  8044
  8045* EXEC CICS READNEXT
  8046*       DATASET  ('ERPDEF')
  8047*       SET      (ADDRESS OF PRODUCT-MASTER)
  8048*       RIDFLD   (ERPDEF-KEY)
  8049*       RESP     (WS-RESPONSE)
  8050*    END-EXEC
  8051     MOVE 'ERPDEF' TO DFHEIV1
  8052     MOVE 0
  8053       TO DFHEIV11
  8054*    MOVE '&.S                   )  N#00007821' TO DFHEIV0
  8055     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8056     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8057     MOVE X'204E233030303037383231' TO DFHEIV0(25:11)
  8058     CALL 'kxdfhei1' USING DFHEIV0,
  8059           DFHEIV1,
  8060           DFHEIV20,
  8061           DFHEIV99,
  8062           ERPDEF-KEY,
  8063           DFHEIV99,
  8064           DFHEIV11,
  8065           DFHEIV99,
  8066           DFHEIV99
  8067     SET ADDRESS OF PRODUCT-MASTER TO
  8068         DFHEIV20
  8069     MOVE EIBRESP  TO WS-RESPONSE
  8070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8071     IF NOT WS-RESP-NORMAL
  8072        GO TO 0730-ENDBR
  8073     END-IF
  8074     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8075        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8076           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8077        ELSE
  8078           GO TO 0730-READNEXT
  8079        END-IF
  8080     ELSE
  8081        GO TO 0730-ENDBR
  8082     END-IF
  8083     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8084        (P1 > +8)
  8085        OR (PD-PROD-CODE (P1) = 'I')
  8086     END-PERFORM
  8087     IF P1 < +9
  8088        SET DD-IU-PRESENT        TO TRUE
  8089     END-IF
  8090     IF CM-LOAN-TERM = ZEROS
  8091        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  8092     END-IF
  8093     IF PD-TRUNCATED = 'Y'
  8094        MOVE CM-LOAN-TERM        TO WS-TERM
  8095     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 148
* EL1278.cbl
  8096        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  8097     END-IF
  8098     EVALUATE TRUE
  8099        WHEN WS-TERM > +168
  8100           MOVE 15               TO P1
  8101        WHEN WS-TERM > +156
  8102           MOVE 14               TO P1
  8103        WHEN WS-TERM > +144
  8104           MOVE 13               TO P1
  8105        WHEN WS-TERM > +132
  8106           MOVE 12               TO P1
  8107        WHEN WS-TERM > +120
  8108           MOVE 11               TO P1
  8109        WHEN WS-TERM > +108
  8110           MOVE 10               TO P1
  8111        WHEN WS-TERM > +96
  8112           MOVE 9                TO P1
  8113        WHEN WS-TERM > +84
  8114           MOVE 8                TO P1
  8115        WHEN WS-TERM > +72
  8116           MOVE 7                TO P1
  8117        WHEN WS-TERM > +60
  8118           MOVE 6                TO P1
  8119        WHEN WS-TERM > +48
  8120           MOVE 5                TO P1
  8121        WHEN WS-TERM > +36
  8122           MOVE 4                TO P1
  8123        WHEN WS-TERM > +24
  8124           MOVE 3                TO P1
  8125        WHEN WS-TERM > +12
  8126           MOVE 2                TO P1
  8127        WHEN OTHER
  8128           MOVE 1                TO P1
  8129     END-EVALUATE
  8130     EVALUATE TRUE
  8131*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  8132*          AND (DD-IU-PRESENT)
  8133*          MOVE 2                TO P2
  8134*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  8135*          MOVE 1                TO P2
  8136        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  8137           MOVE 2                TO P2
  8138        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  8139           MOVE 3                TO P2
  8140        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  8141           MOVE 4                TO P2
  8142        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  8143           MOVE 5                TO P2
  8144        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  8145           MOVE 6                TO P2
  8146        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  8147           MOVE 7                TO P2
  8148        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  8149           MOVE 8                TO P2
  8150        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  8151           MOVE 9                TO P2
  8152        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  8153           MOVE 10               TO P2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 149
* EL1278.cbl
  8154        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  8155           MOVE 11               TO P2
  8156        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  8157           MOVE 12               TO P2
  8158        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  8159           MOVE 13               TO P2
  8160        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  8161           MOVE 14               TO P2
  8162        WHEN OTHER
  8163           MOVE 15               TO P2
  8164     END-EVALUATE
  8165     .
  8166 0730-ENDBR.
  8167
  8168* EXEC CICS ENDBR
  8169*       DATASET  ('ERPDEF')
  8170*    END-EXEC
  8171     MOVE 'ERPDEF' TO DFHEIV1
  8172     MOVE 0
  8173       TO DFHEIV11
  8174*    MOVE '&2                    $   #00007923' TO DFHEIV0
  8175     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8176     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8177     MOVE X'2020233030303037393233' TO DFHEIV0(25:11)
  8178     CALL 'kxdfhei1' USING DFHEIV0,
  8179           DFHEIV1,
  8180           DFHEIV11,
  8181           DFHEIV99
  8182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8183     .
  8184 0730-EXIT.
  8185     EXIT.
  8186 0740-GET-ERCTBL.
  8187     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8188     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8189     MOVE 'A'                    TO CTBL-BEN-TYPE
  8190     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8191     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8192     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8193     IF WS-RESP-NORMAL
  8194        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8195     ELSE
  8196        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8197        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8198        MOVE 'A'                    TO CTBL-BEN-TYPE
  8199        MOVE 'AA'                   TO CTBL-BEN-CODE
  8200        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8201        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8202        IF WS-RESP-NORMAL
  8203           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8204        END-IF
  8205     END-IF
  8206     .
  8207 0740-EXIT.
  8208     EXIT.
  8209 0750-READ-ERCTBL.
  8210
  8211* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 150
* EL1278.cbl
  8212*         INTO    (COMM-TABLE-RECORD)
  8213*         DATASET ('ERCTBL')
  8214*         RIDFLD  (CTBL-KEY)
  8215*         RESP    (WS-RESPONSE)
  8216*    END-EXEC
  8217     MOVE LENGTH OF
  8218      COMM-TABLE-RECORD
  8219       TO DFHEIV11
  8220     MOVE 'ERCTBL' TO DFHEIV1
  8221*    MOVE '&"IL       E          (  N#00007953' TO DFHEIV0
  8222     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8224     MOVE X'204E233030303037393533' TO DFHEIV0(25:11)
  8225     CALL 'kxdfhei1' USING DFHEIV0,
  8226           DFHEIV1,
  8227           COMM-TABLE-RECORD,
  8228           DFHEIV11,
  8229           CTBL-KEY,
  8230           DFHEIV99,
  8231           DFHEIV99,
  8232           DFHEIV99
  8233     MOVE EIBRESP  TO WS-RESPONSE
  8234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8235     .
  8236 0750-EXIT.
  8237     EXIT.
  8238 0760-FIND-COMM.
  8239     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8240        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8241        OR (C1 > +3)
  8242     END-PERFORM
  8243     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8244        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8245        OR (C2 > +3)
  8246     END-PERFORM
  8247     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8248        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8249        OR (C3 > +3)
  8250     END-PERFORM
  8251     IF C1 > +3
  8252        MOVE +1                  TO C1
  8253     END-IF
  8254     IF C2 > +3
  8255        MOVE +1                  TO C2
  8256     END-IF
  8257     IF C3 > +3
  8258        MOVE +1                  TO C3
  8259     END-IF
  8260     IF C1 = +3
  8261        MOVE +18                 TO C0
  8262     ELSE
  8263        IF C1 = +2
  8264           MOVE +9               TO C0
  8265        END-IF
  8266     END-IF
  8267     IF C2 = +3
  8268        ADD +6                   TO C0
  8269     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 151
* EL1278.cbl
  8270        IF C2 = +2
  8271           ADD +3                TO C0
  8272        END-IF
  8273     END-IF
  8274     ADD C3                      TO C0
  8275     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8276     .
  8277 0760-EXIT.
  8278     EXIT.
  8279 0800-LINK-REFUND SECTION.
  8280     IF CP-AH
  8281       IF PI-EARNING-METHOD-AH NOT = SPACES
  8282         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8283        ELSE
  8284         NEXT SENTENCE
  8285      ELSE
  8286       IF PI-EARNING-METHOD-LF NOT = SPACES
  8287         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8288
  8289
  8290* EXEC CICS LINK
  8291*        PROGRAM   (ELRFND-ID)
  8292*        COMMAREA  (CALCULATION-PASS-AREA)
  8293*        LENGTH    (CP-COMM-LENGTH)
  8294*    END-EXEC.
  8295*    MOVE '."C                   (   #00008013' TO DFHEIV0
  8296     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8297     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8298     MOVE X'2020233030303038303133' TO DFHEIV0(25:11)
  8299     CALL 'kxdfhei1' USING DFHEIV0,
  8300           ELRFND-ID,
  8301           CALCULATION-PASS-AREA,
  8302           CP-COMM-LENGTH,
  8303           DFHEIV99,
  8304           DFHEIV99,
  8305           DFHEIV99,
  8306           DFHEIV99
  8307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8308
  8309
  8310 0899-EXIT.
  8311     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 152
* EL1278.cbl
  8313 0900-READ-CERT-FILE  SECTION.
  8314
  8315* EXEC CICS HANDLE CONDITION
  8316*        NOTFND  (0910-NOT-FOUND)
  8317*    END-EXEC.
  8318*    MOVE '"$I                   ! # #00008023' TO DFHEIV0
  8319     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8321     MOVE X'2320233030303038303233' TO DFHEIV0(25:11)
  8322     CALL 'kxdfhei1' USING DFHEIV0
  8323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8324
  8325
  8326
  8327* EXEC CICS READ
  8328*        DATASET  (ELCERT-ID)
  8329*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8330*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8331*    END-EXEC.
  8332*    MOVE '&"S        E          (   #00008027' TO DFHEIV0
  8333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8335     MOVE X'2020233030303038303237' TO DFHEIV0(25:11)
  8336     CALL 'kxdfhei1' USING DFHEIV0,
  8337           ELCERT-ID,
  8338           DFHEIV20,
  8339           DFHEIV99,
  8340           WS-CM-CONTROL-PRIMARY,
  8341           DFHEIV99,
  8342           DFHEIV99,
  8343           DFHEIV99
  8344     SET ADDRESS OF CERTIFICATE-MASTER TO
  8345         DFHEIV20
  8346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8347
  8348
  8349*    SERVICE RELOAD CERTIFICATE-MASTER.
  8350
  8351     GO TO 0999-EXIT.
  8352
  8353 0910-NOT-FOUND.
  8354     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8355
  8356 0999-EXIT.
  8357     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 153
* EL1278.cbl
  8359 1000-READ-CONTROL  SECTION.
  8360
  8361* EXEC CICS HANDLE CONDITION
  8362*        NOTFND   (1010-NOTFND)
  8363*        NOTOPEN  (1020-NOTOPEN)
  8364*    END-EXEC.
  8365*    MOVE '"$IJ                  ! $ #00008044' TO DFHEIV0
  8366     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8368     MOVE X'2420233030303038303434' TO DFHEIV0(25:11)
  8369     CALL 'kxdfhei1' USING DFHEIV0
  8370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8371
  8372
  8373
  8374* EXEC CICS READ
  8375*        DATASET  (ELCNTL-ID)
  8376*        SET      (ADDRESS OF CONTROL-FILE)
  8377*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8378*        GTEQ
  8379*    END-EXEC.
  8380*    MOVE '&"S        G          (   #00008049' TO DFHEIV0
  8381     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8383     MOVE X'2020233030303038303439' TO DFHEIV0(25:11)
  8384     CALL 'kxdfhei1' USING DFHEIV0,
  8385           ELCNTL-ID,
  8386           DFHEIV20,
  8387           DFHEIV99,
  8388           WS-CF-CONTROL-PRIMARY,
  8389           DFHEIV99,
  8390           DFHEIV99,
  8391           DFHEIV99
  8392     SET ADDRESS OF CONTROL-FILE TO
  8393         DFHEIV20
  8394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8395
  8396
  8397*    SERVICE RELOAD CONTROL-FILE.
  8398
  8399     GO TO 1099-EXIT.
  8400
  8401 1010-NOTFND.
  8402     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8403
  8404     GO TO 1099-EXIT.
  8405
  8406 1020-NOTOPEN.
  8407     MOVE ER-2617                TO  EMI-ERROR.
  8408
  8409     GO TO 0320-INPUT-ERROR.
  8410
  8411 1099-EXIT.
  8412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 154
* EL1278.cbl
  8414 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8415     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8416
  8417     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8418         VARYING  SUB3  FROM  1  BY  1
  8419             UNTIL  ((SUB3  IS GREATER THAN  50)
  8420               OR ((CF-ST-BENEFIT-CD (SUB3)
  8421                      IS EQUAL TO  WS-BEN-CD)
  8422               AND (WS-LOOKUP-TYPE
  8423                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8424
  8425     IF SUB3  IS NOT EQUAL TO  51
  8426         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8427
  8428     GO TO 1199-EXIT.
  8429
  8430 1110-BENEFIT-DUMMY.
  8431
  8432 1119-EXIT.
  8433     EXIT.
  8434
  8435 1199-EXIT.
  8436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 155
* EL1278.cbl
  8438 1200-START-ACCOUNT-MASTER  SECTION.
  8439
  8440* EXEC CICS HANDLE CONDITION
  8441*        NOTFND   (1290-ACCT-NOT-FOUND)
  8442*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8443*    END-EXEC.
  8444*    MOVE '"$I''                  ! % #00008098' TO DFHEIV0
  8445     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8447     MOVE X'2520233030303038303938' TO DFHEIV0(25:11)
  8448     CALL 'kxdfhei1' USING DFHEIV0
  8449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8450
  8451
  8452     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8453
  8454
  8455* EXEC CICS STARTBR
  8456*        DATASET  (ERACCT-ID)
  8457*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8458*        GTEQ
  8459*    END-EXEC.
  8460     MOVE 0
  8461       TO DFHEIV11
  8462*    MOVE '&,         G          &   #00008105' TO DFHEIV0
  8463     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8464     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8465     MOVE X'2020233030303038313035' TO DFHEIV0(25:11)
  8466     CALL 'kxdfhei1' USING DFHEIV0,
  8467           ERACCT-ID,
  8468           WS-AM-CONTROL-PRIMARY,
  8469           DFHEIV99,
  8470           DFHEIV11,
  8471           DFHEIV99
  8472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8473
  8474
  8475     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8476     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8477
  8478     GO TO 1299-EXIT.
  8479
  8480 1290-ACCT-NOT-FOUND.
  8481     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8482
  8483 1299-EXIT.
  8484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 156
* EL1278.cbl
  8486 1300-READ-ACCOUNT-MASTER  SECTION.
  8487
  8488* EXEC CICS HANDLE CONDITION
  8489*        NOTFND   (0580-ACCT-NOT-FOUND)
  8490*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8491*    END-EXEC.
  8492*    MOVE '"$I''                  ! & #00008123' TO DFHEIV0
  8493     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8495     MOVE X'2620233030303038313233' TO DFHEIV0(25:11)
  8496     CALL 'kxdfhei1' USING DFHEIV0
  8497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8498
  8499
  8500
  8501* EXEC CICS READNEXT
  8502*        DATASET  (ERACCT-ID)
  8503*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8504*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8505*    END-EXEC.
  8506     MOVE 0
  8507       TO DFHEIV11
  8508*    MOVE '&.S                   )   #00008128' TO DFHEIV0
  8509     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8510     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8511     MOVE X'2020233030303038313238' TO DFHEIV0(25:11)
  8512     CALL 'kxdfhei1' USING DFHEIV0,
  8513           ERACCT-ID,
  8514           DFHEIV20,
  8515           DFHEIV99,
  8516           WS-AM-CONTROL-PRIMARY,
  8517           DFHEIV99,
  8518           DFHEIV11,
  8519           DFHEIV99,
  8520           DFHEIV99
  8521     SET ADDRESS OF ACCOUNT-MASTER TO
  8522         DFHEIV20
  8523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8524
  8525
  8526*    SERVICE RELOAD ACCOUNT-MASTER.
  8527
  8528 1399-EXIT.
  8529     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 157
* EL1278.cbl
  8531 1400-GET-REFUND-TYPE  SECTION.
  8532     IF LIFE-REFUND-SEARCH
  8533         NEXT SENTENCE
  8534     ELSE
  8535         GO TO 1410-AH-REFUND-TYPE.
  8536
  8537     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8538         MOVE SPACES             TO  HLCALCO
  8539                                     HLCAL1O
  8540         GO TO 1499-EXIT.
  8541
  8542     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8543
  8544     EVALUATE TRUE
  8545        WHEN CP-R-AS-REPOSSESSION
  8546           MOVE 'REPOSSESSION'     TO  HLCALCO
  8547        WHEN CP-R-AS-R78
  8548           MOVE 'RULE 78'          TO  HLCALCO
  8549        WHEN  CP-R-AS-PRORATA
  8550           MOVE 'PRO RATA'         TO  HLCALCO
  8551        WHEN CP-R-AS-CALIF
  8552           MOVE 'CALIF'            TO  HLCALCO
  8553        WHEN CP-R-AS-TEXAS
  8554           MOVE 'IRREG'            TO  HLCALCO
  8555        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8556           MOVE 'UTAH'             TO  HLCALCO
  8557        WHEN CP-R-AS-FARM-PLAN
  8558           MOVE 'FARM PLAN'        TO  HLCALCO
  8559        WHEN CP-R-AS-NET-PAY
  8560           MOVE 'NET PAY'          TO  HLCALCO
  8561        WHEN CP-R-AS-ANTICIPATION
  8562           MOVE 'ANTICIPATION'     TO  HLCALCO
  8563        WHEN CP-R-AS-MEAN
  8564           MOVE 'MEAN'             TO  HLCALCO
  8565        WHEN CP-R-AS-SUM-OF-DIGITS
  8566           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8567        WHEN OTHER
  8568           MOVE 'UNDEFINED'        TO  HLCALCO
  8569     END-EVALUATE.
  8570
  8571     GO TO 1499-EXIT.
  8572
  8573 1410-AH-REFUND-TYPE.
  8574     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8575         MOVE SPACES             TO  HACALCO
  8576                                     HACAL1O
  8577         GO TO 1499-EXIT.
  8578
  8579     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8580
  8581     EVALUATE TRUE
  8582        WHEN CP-R-AS-REPOSSESSION
  8583           MOVE 'REPOSSESSION'     TO HACALCO
  8584        WHEN CP-R-AS-R78
  8585           MOVE 'RULE 78'          TO HACALCO
  8586        WHEN CP-R-AS-PRORATA
  8587           MOVE 'PRO RATA'         TO HACALCO
  8588        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 158
* EL1278.cbl
  8589           MOVE 'CALIF'            TO HACALCO
  8590        WHEN CP-R-AS-TEXAS
  8591           MOVE 'IRREG'            TO HACALCO
  8592        WHEN CP-R-AS-FARM-PLAN
  8593           MOVE 'FARM PLAN'        TO HACALCO
  8594        WHEN CP-R-AS-NET-PAY
  8595           MOVE 'NET PAY'          TO HACALCO
  8596        WHEN CP-R-AS-ANTICIPATION
  8597           MOVE 'ANTICIPATION'     TO HACALCO
  8598        WHEN CP-R-AS-MEAN
  8599           MOVE 'MEAN'             TO HACALCO
  8600        WHEN CP-R-AS-SUM-OF-DIGITS
  8601           MOVE 'SUM OF DIGIT'     TO HACALCO
  8602        WHEN CP-GAP-ACTUARIAL
  8603           MOVE 'SP ACTUARIAL'     TO HACALCO
  8604        WHEN CP-R-AS-SPP-DDF
  8605           MOVE 'SPEC DDF'         TO HACALCO
  8606        WHEN CP-R-AS-SPP-DDF-IU
  8607           MOVE 'SPEC DDF IU'      TO HACALCO
  8608        WHEN OTHER
  8609           MOVE 'UNKNOWN'          TO HLCALCO
  8610     END-EVALUATE
  8611     .
  8612 1499-EXIT.
  8613     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 159
* EL1278.cbl
  8615 1500-END-BROWSE  SECTION.
  8616     IF BROWSE-STARTED
  8617
  8618* EXEC CICS ENDBR
  8619*            DATASET  (ERACCT-ID)
  8620*        END-EXEC.
  8621     MOVE 0
  8622       TO DFHEIV11
  8623*    MOVE '&2                    $   #00008225' TO DFHEIV0
  8624     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8626     MOVE X'2020233030303038323235' TO DFHEIV0(25:11)
  8627     CALL 'kxdfhei1' USING DFHEIV0,
  8628           ERACCT-ID,
  8629           DFHEIV11,
  8630           DFHEIV99
  8631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8632
  8633
  8634 1599-EXIT.
  8635     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 160
* EL1278.cbl
  8637 1600-LOCATE-BENEFIT  SECTION.
  8638
  8639* EXEC CICS HANDLE CONDITION
  8640*        NOTFND  (1699-EXIT)
  8641*    END-EXEC.
  8642*    MOVE '"$I                   ! '' #00008233' TO DFHEIV0
  8643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8645     MOVE X'2720233030303038323333' TO DFHEIV0(25:11)
  8646     CALL 'kxdfhei1' USING DFHEIV0
  8647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8648
  8649
  8650     MOVE SPACES                 TO  WS-KIND.
  8651     MOVE ZERO                   TO  WS-NOT-FOUND.
  8652     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8653     MOVE SPACES                 TO  WS-CF-STATE.
  8654     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8655
  8656
  8657* EXEC CICS READ
  8658*        DATASET  (ELCNTL-ID)
  8659*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8660*        SET      (ADDRESS OF CONTROL-FILE)
  8661*        GTEQ
  8662*    END-EXEC.
  8663*    MOVE '&"S        G          (   #00008243' TO DFHEIV0
  8664     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8666     MOVE X'2020233030303038323433' TO DFHEIV0(25:11)
  8667     CALL 'kxdfhei1' USING DFHEIV0,
  8668           ELCNTL-ID,
  8669           DFHEIV20,
  8670           DFHEIV99,
  8671           WS-CF-CONTROL-PRIMARY,
  8672           DFHEIV99,
  8673           DFHEIV99,
  8674           DFHEIV99
  8675     SET ADDRESS OF CONTROL-FILE TO
  8676         DFHEIV20
  8677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8678
  8679
  8680*    SERVICE RELOAD CONTROL-FILE.
  8681
  8682     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8683       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8684         GO TO 1699-EXIT.
  8685
  8686     MOVE +1                     TO  WS-INDEX.
  8687
  8688 1610-LOOKUP-BENEFIT.
  8689     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8690         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8691                                 TO  WS-KIND
  8692         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8693                                 TO  WS-CALC-CD
  8694         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 161
* EL1278.cbl
  8695                                 TO  WS-BENEFIT-DESCRIP
  8696         MOVE +1                 TO  WS-NOT-FOUND
  8697         GO TO 1699-EXIT.
  8698
  8699     IF CF-BENEFIT-CODE (WS-INDEX)
  8700             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8701         GO TO 1699-EXIT.
  8702
  8703     IF WS-INDEX  IS LESS THAN  +8
  8704         ADD +1                  TO  WS-INDEX
  8705         GO TO 1610-LOOKUP-BENEFIT.
  8706
  8707 1699-EXIT.
  8708     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 162
* EL1278.cbl
  8710 1700-WRITE-CERT-NOTE      SECTION.
  8711     IF NOT MODIFY-CERT-CAP
  8712         MOVE 'UPDATE'           TO  SM-READ
  8713         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8714         MOVE ER-0070            TO  EMI-ERROR
  8715         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8716         GO TO 8200-SEND-DATAONLY.
  8717
  8718**MOVE CANCEL QUOTE NOTE INFO
  8719     IF PI-LF-REFUND-AMT NUMERIC
  8720        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8721        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8722     ELSE
  8723        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8724                                    PI-LF-REFUND-AMT
  8725        MOVE SPACE               TO WS-CN-LF-REF-METH
  8726                                    PI-LF-REFUND-METH.
  8727
  8728     IF PI-AH-REFUND-AMT NUMERIC
  8729        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8730        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8731     ELSE
  8732        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8733                                    PI-AH-REFUND-AMT
  8734        MOVE SPACE               TO WS-CN-AH-REF-METH
  8735                                    PI-AH-REFUND-METH.
  8736
  8737     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8738                                   PI-AH-REFUND-AMT.
  8739
  8740     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8741
  8742     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8743     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8744     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8745        MOVE PI-LF-CANCEL-DATE-ED
  8746                                 TO WS-CN-CANCEL-DT
  8747     ELSE
  8748        MOVE PI-AH-CANCEL-DATE-ED
  8749                                 TO WS-CN-CANCEL-DT
  8750     END-IF
  8751     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8752     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8753     MOVE PI-CARRIER             TO CZ-CARRIER
  8754     MOVE PI-GROUPING            TO CZ-GROUPING
  8755     MOVE PI-STATE               TO CZ-STATE
  8756     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8757     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8758     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8759     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8760     MOVE '1'                    TO CZ-RECORD-TYPE
  8761     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8762     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8763     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8764     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8765     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8766     MOVE ' '                    TO WS-STOP-SW
  8767     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 163
* EL1278.cbl
  8768
  8769* EXEC CICS WRITE
  8770*           FROM      (CERT-NOTE-FILE)
  8771*           DATASET   (ERNOTE-ID)
  8772*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8773*           RESP      (WS-RESPONSE)
  8774*       END-EXEC
  8775     MOVE LENGTH OF
  8776      CERT-NOTE-FILE
  8777       TO DFHEIV11
  8778*    MOVE '&$ L                  ''  N#00008338' TO DFHEIV0
  8779     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8780     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8781     MOVE X'204E233030303038333338' TO DFHEIV0(25:11)
  8782     CALL 'kxdfhei1' USING DFHEIV0,
  8783           ERNOTE-ID,
  8784           CERT-NOTE-FILE,
  8785           DFHEIV11,
  8786           CZ-CONTROL-PRIMARY,
  8787           DFHEIV99,
  8788           DFHEIV99
  8789     MOVE EIBRESP  TO WS-RESPONSE
  8790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8791        IF WS-RESP-DUPREC
  8792           ADD +1                TO CZ-NOTE-SEQUENCE
  8793        ELSE
  8794           SET I-SAY-TO-STOP     TO TRUE
  8795        END-IF
  8796     END-PERFORM
  8797     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8798     IF WS-RESP-NORMAL
  8799        EVALUATE CM-NOTE-SW
  8800           WHEN '1'
  8801           WHEN '3'
  8802           WHEN '5'
  8803           WHEN '7'
  8804              SET NO-CERT-RW     TO TRUE
  8805           WHEN ' '
  8806              MOVE '1'           TO CM-NOTE-SW
  8807           WHEN '2'
  8808              MOVE '3'           TO CM-NOTE-SW
  8809           WHEN '4'
  8810              MOVE '5'           TO CM-NOTE-SW
  8811           WHEN '6'
  8812              MOVE '7'           TO CM-NOTE-SW
  8813        END-EVALUATE
  8814     END-IF
  8815     IF NOT NO-CERT-RW
  8816        PERFORM 1810-REWRITE-ELCERT
  8817                                 THRU 1810-EXIT
  8818     ELSE
  8819
  8820* EXEC CICS UNLOCK
  8821*          DATASET    (ELCERT-ID)
  8822*       END-EXEC
  8823*    MOVE '&*                    #   #00008372' TO DFHEIV0
  8824     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8825     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 164
* EL1278.cbl
  8826     MOVE X'2020233030303038333732' TO DFHEIV0(25:11)
  8827     CALL 'kxdfhei1' USING DFHEIV0,
  8828           ELCERT-ID,
  8829           DFHEIV99
  8830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8831     END-IF
  8832     MOVE ER-8160                TO EMI-ERROR.
  8833     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8834     GO TO 8200-SEND-DATAONLY.
  8835
  8836 1799-EXIT.
  8837     EXIT.
  8838 1800-READ-ELCERT-UPDATE.
  8839     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8840     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8841     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8842     MOVE PI-STATE               TO  WS-CM-STATE.
  8843     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8844     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8845     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8846     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8847
  8848* EXEC CICS READ
  8849*        UPDATE
  8850*        DATASET  (ELCERT-ID)
  8851*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8852*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8853*        RESP     (WS-RESPONSE)
  8854*    END-EXEC
  8855*    MOVE '&"S        EU         (  N#00008391' TO DFHEIV0
  8856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8857     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8858     MOVE X'204E233030303038333931' TO DFHEIV0(25:11)
  8859     CALL 'kxdfhei1' USING DFHEIV0,
  8860           ELCERT-ID,
  8861           DFHEIV20,
  8862           DFHEIV99,
  8863           WS-CM-CONTROL-PRIMARY,
  8864           DFHEIV99,
  8865           DFHEIV99,
  8866           DFHEIV99
  8867     SET ADDRESS OF CERTIFICATE-MASTER TO
  8868         DFHEIV20
  8869     MOVE EIBRESP  TO WS-RESPONSE
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8871     .
  8872 1800-EXIT.
  8873     EXIT.
  8874 1810-REWRITE-ELCERT.
  8875
  8876* EXEC CICS REWRITE
  8877*        FROM      (CERTIFICATE-MASTER)
  8878*        DATASET   (ELCERT-ID)
  8879*        RESP     (WS-RESPONSE)
  8880*    END-EXEC.
  8881     MOVE LENGTH OF
  8882      CERTIFICATE-MASTER
  8883       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 165
* EL1278.cbl
  8884*    MOVE '&& L                  %  N#00008402' TO DFHEIV0
  8885     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8886     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8887     MOVE X'204E233030303038343032' TO DFHEIV0(25:11)
  8888     CALL 'kxdfhei1' USING DFHEIV0,
  8889           ELCERT-ID,
  8890           CERTIFICATE-MASTER,
  8891           DFHEIV11,
  8892           DFHEIV99
  8893     MOVE EIBRESP  TO WS-RESPONSE
  8894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8895
  8896     .
  8897 1810-EXIT.
  8898     EXIT.
  8899 4000-GEN-CANCEL-TRANS.
  8900     IF PI-LF-REFUND-AMT NOT NUMERIC
  8901         MOVE +0 TO PI-LF-REFUND-AMT
  8902     END-IF
  8903     IF PI-AH-REFUND-AMT NOT NUMERIC
  8904         MOVE +0 TO PI-AH-REFUND-AMT
  8905     END-IF
  8906
  8907     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8908
  8909     MOVE '2'                    TO CG-OPTION-CODE
  8910     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8911     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8912     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8913     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8914     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8915     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8916     MOVE PI-STATE               TO CG-CERT-STATE
  8917     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8918     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8919     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8920     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8921     MOVE ZEROS                  TO CG-LF-BENCD
  8922                                    CG-AH-BENCD
  8923                                    CG-LF-CAN-AMT
  8924                                    CG-AH-CAN-AMT
  8925     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8926                                    CG-AH-CAN-DT
  8927     MOVE SPACES                 TO CG-BATCH-NO
  8928     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8929       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8930        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8931           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8932           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8933           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8934        END-IF
  8935     END-IF
  8936     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8937       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8938        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8939           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8940           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8941           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 166
* EL1278.cbl
  8942        END-IF
  8943     END-IF
  8944
  8945* EXEC CICS LINK
  8946*        PROGRAM  ('ELCANC')
  8947*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8948*    END-EXEC
  8949     MOVE LENGTH OF
  8950      CANCEL-GEN-PASS-AREA
  8951       TO DFHEIV11
  8952     MOVE 'ELCANC' TO DFHEIV1
  8953*    MOVE '."C                   (   #00008455' TO DFHEIV0
  8954     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8955     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8956     MOVE X'2020233030303038343535' TO DFHEIV0(25:11)
  8957     CALL 'kxdfhei1' USING DFHEIV0,
  8958           DFHEIV1,
  8959           CANCEL-GEN-PASS-AREA,
  8960           DFHEIV11,
  8961           DFHEIV99,
  8962           DFHEIV99,
  8963           DFHEIV99,
  8964           DFHEIV99
  8965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8966     IF CG-SUCCESS
  8967        CONTINUE
  8968     ELSE
  8969        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8970        move '3'                 to emi-switch1
  8971        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8972        EVALUATE TRUE
  8973           WHEN CG-DATE-ERROR
  8974             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8975           WHEN CG-CERT-NOT-FOUND
  8976             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8977           WHEN CG-AMOUNT-ERROR
  8978             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8979           WHEN CG-OPTION-ERROR
  8980             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8981           WHEN CG-PREV-CAN
  8982             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8983           WHEN CG-INVALID-DATA
  8984             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8985           WHEN CG-NO-ACCT-MSTR
  8986             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8987           WHEN CG-SFX-A-EXIST
  8988             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8989           WHEN CG-MISC-ERROR
  8990             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8991           WHEN OTHER
  8992             move ' error - elcanc - return '
  8993                                 to emi-error-text (1) (12:25)
  8994        END-EVALUATE
  8995        go to 8200-send-dataonly
  8996     end-if
  8997     .
  8998 4000-exit.
  8999     exit.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 167
* EL1278.cbl
  9000
  9001 4400-ADD-ORIG-REC.
  9002
  9003     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  9004     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  9005     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  9006     MOVE PI-STATE               TO  WS-CM-STATE.
  9007     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  9008     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  9009     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  9010     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  9011
  9012
  9013* EXEC CICS READ
  9014*        DATASET  (ELCERT-ID)
  9015*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  9016*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9017*        RESP     (WS-RESPONSE)
  9018*    END-EXEC
  9019*    MOVE '&"S        E          (  N#00008505' TO DFHEIV0
  9020     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9022     MOVE X'204E233030303038353035' TO DFHEIV0(25:11)
  9023     CALL 'kxdfhei1' USING DFHEIV0,
  9024           ELCERT-ID,
  9025           DFHEIV20,
  9026           DFHEIV99,
  9027           WS-CM-CONTROL-PRIMARY,
  9028           DFHEIV99,
  9029           DFHEIV99,
  9030           DFHEIV99
  9031     SET ADDRESS OF CERTIFICATE-MASTER TO
  9032         DFHEIV20
  9033     MOVE EIBRESP  TO WS-RESPONSE
  9034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9035     IF WS-RESP-NORMAL
  9036         CONTINUE
  9037     ELSE
  9038        MOVE ER-0142                TO EMI-ERROR
  9039        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  9040        GO TO 8100-SEND-INITIAL-MAP
  9041     END-IF
  9042
  9043******************************************************************
  9044*            A D D   O R I G   C E R T   I N F O                 *
  9045******************************************************************
  9046
  9047     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  9048
  9049     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  9050     MOVE ' '                    TO WS-ERMAIL-SW
  9051
  9052
  9053* EXEC CICS READ
  9054*       DATASET   ('ERMAIL')
  9055*       SET       (ADDRESS OF MAILING-DATA)
  9056*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9057*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 168
* EL1278.cbl
  9058*    END-EXEC
  9059     MOVE 'ERMAIL' TO DFHEIV1
  9060*    MOVE '&"S        E          (  N#00008528' TO DFHEIV0
  9061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9063     MOVE X'204E233030303038353238' TO DFHEIV0(25:11)
  9064     CALL 'kxdfhei1' USING DFHEIV0,
  9065           DFHEIV1,
  9066           DFHEIV20,
  9067           DFHEIV99,
  9068           WS-MA-CONTROL-PRIMARY,
  9069           DFHEIV99,
  9070           DFHEIV99,
  9071           DFHEIV99
  9072     SET ADDRESS OF MAILING-DATA TO
  9073         DFHEIV20
  9074     MOVE EIBRESP  TO WS-RESPONSE
  9075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9076
  9077     IF WS-RESP-NORMAL
  9078        SET ERMAIL-FOUND TO TRUE
  9079     END-IF
  9080
  9081     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  9082     MOVE 'C'                   TO ELCRTT-REC-TYPE
  9083     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  9084
  9085
  9086* EXEC CICS READ
  9087*         DATASET  (ELCRTT-ID)
  9088*         RIDFLD   (ELCRTT-KEY)
  9089*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  9090*         RESP     (WS-RESPONSE)
  9091*    END-EXEC
  9092*    MOVE '&"S        E          (  N#00008543' TO DFHEIV0
  9093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9095     MOVE X'204E233030303038353433' TO DFHEIV0(25:11)
  9096     CALL 'kxdfhei1' USING DFHEIV0,
  9097           ELCRTT-ID,
  9098           DFHEIV20,
  9099           DFHEIV99,
  9100           ELCRTT-KEY,
  9101           DFHEIV99,
  9102           DFHEIV99,
  9103           DFHEIV99
  9104     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  9105         DFHEIV20
  9106     MOVE EIBRESP  TO WS-RESPONSE
  9107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9108
  9109     IF NOT WS-RESP-NORMAL
  9110        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  9111     END-IF
  9112
  9113     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  9114     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  9115     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 169
* EL1278.cbl
  9116
  9117
  9118* EXEC CICS READ
  9119*       DATASET   ('ELCRTO')
  9120*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9121*       RIDFLD    (ELCRTO-KEY)
  9122*       GTEQ
  9123*       RESP      (WS-RESPONSE)
  9124*    END-EXEC
  9125     MOVE 'ELCRTO' TO DFHEIV1
  9126*    MOVE '&"S        G          (  N#00008558' TO DFHEIV0
  9127     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9128     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9129     MOVE X'204E233030303038353538' TO DFHEIV0(25:11)
  9130     CALL 'kxdfhei1' USING DFHEIV0,
  9131           DFHEIV1,
  9132           DFHEIV20,
  9133           DFHEIV99,
  9134           ELCRTO-KEY,
  9135           DFHEIV99,
  9136           DFHEIV99,
  9137           DFHEIV99
  9138     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9139         DFHEIV20
  9140     MOVE EIBRESP  TO WS-RESPONSE
  9141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9142
  9143     IF WS-RESP-NORMAL
  9144        AND (OC-CONTROL-PRIMARY (1:33) =
  9145                 WS-CM-CONTROL-PRIMARY)
  9146        AND (OC-RECORD-TYPE = 'I')
  9147        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  9148
  9149* EXEC CICS READ
  9150*             DATASET   ('ELCRTO')
  9151*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9152*             RIDFLD    (OC-CONTROL-PRIMARY)
  9153*             UPDATE
  9154*             RESP      (WS-RESPONSE)
  9155*          END-EXEC
  9156     MOVE 'ELCRTO' TO DFHEIV1
  9157*    MOVE '&"S        EU         (  N#00008571' TO DFHEIV0
  9158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9159     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9160     MOVE X'204E233030303038353731' TO DFHEIV0(25:11)
  9161     CALL 'kxdfhei1' USING DFHEIV0,
  9162           DFHEIV1,
  9163           DFHEIV20,
  9164           DFHEIV99,
  9165           OC-CONTROL-PRIMARY,
  9166           DFHEIV99,
  9167           DFHEIV99,
  9168           DFHEIV99
  9169     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9170         DFHEIV20
  9171     MOVE EIBRESP  TO WS-RESPONSE
  9172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9173           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 170
* EL1278.cbl
  9174           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9175           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9176           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9177           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9178           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9179           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9180           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9181           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9182            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9183               MOVE SPACES             TO OC-LF-BENCD
  9184               MOVE ZEROS              TO OC-LF-TERM
  9185                                          OC-LF-BEN-AMT
  9186                                          OC-LF-PRM-AMT
  9187                                          OC-LF-ALT-BEN-AMT
  9188                                          OC-LF-ALT-PRM-AMT
  9189                                          OC-LF-COMM-PCT
  9190                                          OC-LF-CANCEL-AMT
  9191               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9192               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9193           ELSE
  9194               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9195               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9196               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9197               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9198               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9199               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9200               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9201               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9202               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9203               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9204           END-IF
  9205           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9206           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9207            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9208               MOVE SPACES             TO OC-AH-BENCD
  9209               MOVE ZEROS              TO OC-AH-TERM
  9210                                          OC-AH-BEN-AMT
  9211                                          OC-AH-PRM-AMT
  9212                                          OC-AH-COMM-PCT
  9213                                          OC-AH-CANCEL-AMT
  9214                                          OC-AH-CP
  9215               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9216               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9217           ELSE
  9218               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9219               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9220               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9221               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9222               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9223               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9224               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9225               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9226               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9227           END-IF
  9228           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9229           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9230           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9231           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 171
* EL1278.cbl
  9232           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9233           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9234           MOVE '5'                    TO DC-OPTION-CODE
  9235           PERFORM 9600-DATE-LINK
  9236           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9237           IF ERMAIL-FOUND
  9238               MOVE MA-CRED-BENE-NAME
  9239                           TO OC-CRED-BENE-NAME
  9240           END-IF
  9241           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9242               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9243                                  OC-INS-AGE-DEFAULT-FLAG
  9244               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9245                                  OC-JNT-AGE-DEFAULT-FLAG
  9246           END-IF
  9247
  9248
  9249* EXEC CICS REWRITE
  9250*             DATASET   ('ELCRTO')
  9251*             FROM      (ORIGINAL-CERTIFICATE)
  9252*             RESP      (WS-RESPONSE)
  9253*          END-EXEC
  9254     MOVE LENGTH OF
  9255      ORIGINAL-CERTIFICATE
  9256       TO DFHEIV11
  9257     MOVE 'ELCRTO' TO DFHEIV1
  9258*    MOVE '&& L                  %  N#00008653' TO DFHEIV0
  9259     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9260     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9261     MOVE X'204E233030303038363533' TO DFHEIV0(25:11)
  9262     CALL 'kxdfhei1' USING DFHEIV0,
  9263           DFHEIV1,
  9264           ORIGINAL-CERTIFICATE,
  9265           DFHEIV11,
  9266           DFHEIV99
  9267     MOVE EIBRESP  TO WS-RESPONSE
  9268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9269           IF NOT WS-RESP-NORMAL
  9270              MOVE ER-3830          TO EMI-ERROR
  9271              PERFORM 9700-ERROR-FORMAT
  9272                                 THRU 9799-EXIT
  9273              GO TO 8200-SEND-DATAONLY
  9274           END-IF
  9275
  9276           GO TO 4400-EXIT
  9277
  9278        ELSE
  9279           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9280        END-IF
  9281     ELSE
  9282        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9283        MOVE 'OC'                TO OC-RECORD-ID
  9284        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9285        MOVE 'I'                 TO OC-RECORD-TYPE
  9286        MOVE +4096               TO OC-KEY-SEQ-NO
  9287     END-IF
  9288
  9289     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 172
* EL1278.cbl
  9290     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9291     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9292     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9293     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9294     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9295     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9296     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9297     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9298      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9299         MOVE SPACES             TO OC-LF-BENCD
  9300         MOVE ZEROS              TO OC-LF-TERM
  9301                                    OC-LF-BEN-AMT
  9302                                    OC-LF-PRM-AMT
  9303                                    OC-LF-ALT-BEN-AMT
  9304                                    OC-LF-ALT-PRM-AMT
  9305                                    OC-LF-COMM-PCT
  9306                                    OC-LF-CANCEL-AMT
  9307         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9308         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9309     ELSE
  9310         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9311         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9312         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9313         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9314         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9315         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9316         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9317         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9318         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9319         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9320     END-IF
  9321     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9322     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9323      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9324         MOVE SPACES             TO OC-AH-BENCD
  9325         MOVE ZEROS              TO OC-AH-TERM
  9326                                    OC-AH-BEN-AMT
  9327                                    OC-AH-PRM-AMT
  9328                                    OC-AH-COMM-PCT
  9329                                    OC-AH-CANCEL-AMT
  9330                                    OC-AH-CP
  9331         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9332         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9333     ELSE
  9334         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9335         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9336         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9337         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9338         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9339         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9340         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9341         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9342         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9343         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9344     END-IF
  9345     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9346     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9347     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 173
* EL1278.cbl
  9348     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9349     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9350     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9351     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9352     MOVE '5'                    TO DC-OPTION-CODE
  9353     PERFORM 9600-DATE-LINK
  9354     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9355     IF ERMAIL-FOUND
  9356         MOVE MA-CRED-BENE-NAME
  9357                     TO OC-CRED-BENE-NAME
  9358     END-IF
  9359     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9360         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9361                            OC-INS-AGE-DEFAULT-FLAG
  9362         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9363                            OC-JNT-AGE-DEFAULT-FLAG
  9364     END-IF
  9365
  9366     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9367     .
  9368 4400-WRITE-ELCRTO.
  9369
  9370
  9371* EXEC CICS WRITE
  9372*       DATASET   ('ELCRTO')
  9373*       FROM      (ORIGINAL-CERTIFICATE)
  9374*       RIDFLD    (OC-CONTROL-PRIMARY)
  9375*       RESP      (WS-RESPONSE)
  9376*    END-EXEC
  9377     MOVE LENGTH OF
  9378      ORIGINAL-CERTIFICATE
  9379       TO DFHEIV11
  9380     MOVE 'ELCRTO' TO DFHEIV1
  9381*    MOVE '&$ L                  ''  N#00008759' TO DFHEIV0
  9382     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9383     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9384     MOVE X'204E233030303038373539' TO DFHEIV0(25:11)
  9385     CALL 'kxdfhei1' USING DFHEIV0,
  9386           DFHEIV1,
  9387           ORIGINAL-CERTIFICATE,
  9388           DFHEIV11,
  9389           OC-CONTROL-PRIMARY,
  9390           DFHEIV99,
  9391           DFHEIV99
  9392     MOVE EIBRESP  TO WS-RESPONSE
  9393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9394
  9395    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9396        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9397        GO TO 4400-WRITE-ELCRTO
  9398    ELSE
  9399        IF NOT WS-RESP-NORMAL
  9400           MOVE ER-3830          TO EMI-ERROR
  9401           PERFORM 9700-ERROR-FORMAT
  9402                                 THRU 9799-EXIT
  9403           GO TO 8200-SEND-DATAONLY
  9404        END-IF
  9405    END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 174
* EL1278.cbl
  9406
  9407     .
  9408 4400-EXIT.
  9409    EXIT.
  9410
  9411
  9412 5000-GET-LF-AM-REM-TERM.
  9413     MOVE +1                     TO SUB3.
  9414
  9415 5100-GET-LF-AM-REM-TERM.
  9416     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9417        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9418           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9419                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9420           GO TO 5300-MOVE-LF-REM-TERM.
  9421
  9422     IF SUB3 LESS THAN +20
  9423        ADD +1                   TO SUB3
  9424        GO TO 5100-GET-LF-AM-REM-TERM.
  9425
  9426     MOVE +1                     TO SUB3.
  9427
  9428     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9429         GO TO 5200-EDIT-FOR-NINETY-LF.
  9430
  9431 5100-GET-LF-DMD-AM-REM-TERM.
  9432
  9433     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9434        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9435           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9436                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9437           GO TO 5300-MOVE-LF-REM-TERM.
  9438
  9439     IF SUB3 LESS THAN +30
  9440        ADD +1                   TO SUB3
  9441        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9442
  9443     MOVE +1                     TO SUB3.
  9444
  9445 5200-EDIT-FOR-NINETY-LF.
  9446
  9447***************************************************************
  9448*                                                             *
  9449*    NINETY BENEFIT PLAN TYPES:                               *
  9450*                                                             *
  9451*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9452*      92 = ALL GROUP REDUCING BENEFITS                       *
  9453*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9454*      94 = ALL GROUP LEVEL BENEFITS                          *
  9455*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9456*           BENEFIT CONTROLS.                                 *
  9457*      99 = ALL BENEFITS                                      *
  9458*                                                             *
  9459***************************************************************
  9460
  9461     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9462                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9463
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 175
* EL1278.cbl
  9464     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9465       AND
  9466        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9467           GO TO 5300-MOVE-LF-REM-TERM.
  9468
  9469     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9470       AND
  9471        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9472        IF CF-REDUCING (WS-INDEX)
  9473           IF CM-INDIVIDUAL
  9474               GO TO 5300-MOVE-LF-REM-TERM.
  9475
  9476     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9477       AND
  9478        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9479        IF CF-REDUCING (WS-INDEX)
  9480           IF CM-GROUP
  9481               GO TO 5300-MOVE-LF-REM-TERM.
  9482
  9483     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9484       AND
  9485        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9486        IF CF-LEVEL (WS-INDEX)
  9487           IF CM-INDIVIDUAL
  9488               GO TO 5300-MOVE-LF-REM-TERM.
  9489
  9490     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9491       AND
  9492        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9493        IF CF-LEVEL (WS-INDEX)
  9494           IF CM-GROUP
  9495               GO TO 5300-MOVE-LF-REM-TERM.
  9496
  9497     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9498       AND
  9499        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9500            GO TO 5300-MOVE-LF-REM-TERM.
  9501
  9502     IF SUB3 LESS THAN +20
  9503        ADD +1           TO SUB3
  9504          GO TO 5200-EDIT-FOR-NINETY-LF.
  9505
  9506     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9507
  9508     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9509         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9510         GO TO 5900-EXIT.
  9511
  9512     MOVE 1                       TO SUB3.
  9513
  9514 5200-EDIT-FOR-DMD-NINETY-LF.
  9515
  9516     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9517                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9518
  9519     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9520       AND
  9521        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 176
* EL1278.cbl
  9522           GO TO 5300-MOVE-LF-REM-TERM.
  9523
  9524     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9525       AND
  9526        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9527        IF CF-REDUCING (WS-INDEX)
  9528           IF CM-INDIVIDUAL
  9529               GO TO 5300-MOVE-LF-REM-TERM.
  9530
  9531     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9532       AND
  9533        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9534        IF CF-REDUCING (WS-INDEX)
  9535           IF CM-GROUP
  9536               GO TO 5300-MOVE-LF-REM-TERM.
  9537
  9538     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9539       AND
  9540        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9541        IF CF-LEVEL (WS-INDEX)
  9542           IF CM-INDIVIDUAL
  9543               GO TO 5300-MOVE-LF-REM-TERM.
  9544
  9545     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9546       AND
  9547        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9548        IF CF-LEVEL (WS-INDEX)
  9549           IF CM-GROUP
  9550               GO TO 5300-MOVE-LF-REM-TERM.
  9551
  9552     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9553       AND
  9554        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9555            GO TO 5300-MOVE-LF-REM-TERM.
  9556
  9557     IF SUB3 LESS THAN +30
  9558        ADD +1                   TO SUB3
  9559          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9560
  9561     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9562
  9563     GO TO 5900-EXIT.
  9564
  9565 5300-MOVE-LF-REM-TERM.
  9566     MOVE WS-SAVE-BENEFIT-REM-TERM
  9567                                 TO WS-LF-AM-REM-TERM-CALC.
  9568
  9569 5900-EXIT.
  9570      EXIT.
  9571
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 177
* EL1278.cbl
  9573
  9574 6000-GET-AH-AM-REM-TERM.
  9575     MOVE +1                     TO SUB3.
  9576
  9577 6100-GET-AH-AM-REM-TERM.
  9578
  9579     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9580        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9581           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9582                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9583           GO TO 6300-MOVE-AH-REM-TERM.
  9584
  9585     IF SUB3 LESS THAN +20
  9586        ADD +1                   TO SUB3
  9587        GO TO 6100-GET-AH-AM-REM-TERM.
  9588
  9589     MOVE +1                     TO SUB3.
  9590
  9591     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9592         GO TO 6200-EDIT-FOR-NINETY-AH.
  9593
  9594 6100-GET-AH-AM-DMD-REM-TERM.
  9595     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9596        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9597           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9598                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9599           GO TO 6300-MOVE-AH-REM-TERM.
  9600
  9601     IF SUB3 LESS THAN +30
  9602        ADD +1                   TO SUB3
  9603        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9604
  9605     MOVE +1                     TO SUB3.
  9606
  9607 6200-EDIT-FOR-NINETY-AH.
  9608
  9609***************************************************************
  9610*                                                             *
  9611*    NINETY BENEFIT PLAN TYPES:                               *
  9612*                                                             *
  9613*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9614*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9615*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9616*           BENEFIT CONTROLS.                                 *
  9617*      99 = ALL BENEFITS.                                     *
  9618*                                                             *
  9619***************************************************************
  9620
  9621     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9622                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9623
  9624     IF AM-BENEFIT-CODE (SUB3) = '99'
  9625       AND
  9626        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9627           GO TO 6300-MOVE-AH-REM-TERM.
  9628
  9629     IF AM-BENEFIT-CODE (SUB3) = '91'
  9630       AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 178
* EL1278.cbl
  9631        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9632           IF CM-INDIVIDUAL
  9633               GO TO 6300-MOVE-AH-REM-TERM.
  9634
  9635     IF AM-BENEFIT-CODE (SUB3) = '92'
  9636       AND
  9637        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9638           IF CM-GROUP
  9639               GO TO 6300-MOVE-AH-REM-TERM.
  9640
  9641     IF AM-BENEFIT-CODE (SUB3) = '98'
  9642       AND
  9643        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9644           GO TO 6300-MOVE-AH-REM-TERM.
  9645
  9646     IF SUB3 LESS THAN +20
  9647        ADD +1                    TO SUB3
  9648        GO TO 6200-EDIT-FOR-NINETY-AH.
  9649
  9650     MOVE +1                      TO SUB3.
  9651
  9652     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9653         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9654         GO TO 6900-EXIT.
  9655
  9656 6200-EDIT-FOR-DMD-NINETY-AH.
  9657
  9658     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9659                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9660
  9661     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9662       AND
  9663        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9664           GO TO 6300-MOVE-AH-REM-TERM.
  9665
  9666     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9667       AND
  9668        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9669           IF CM-INDIVIDUAL
  9670               GO TO 6300-MOVE-AH-REM-TERM.
  9671
  9672     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9673       AND
  9674        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9675           IF CM-GROUP
  9676               GO TO 6300-MOVE-AH-REM-TERM.
  9677
  9678     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9679       AND
  9680        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9681           GO TO 6300-MOVE-AH-REM-TERM.
  9682
  9683     IF SUB3 LESS THAN +30
  9684        ADD +1                   TO SUB3
  9685        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9686
  9687     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9688
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 179
* EL1278.cbl
  9689     GO TO 6900-EXIT.
  9690
  9691 6300-MOVE-AH-REM-TERM.
  9692
  9693     MOVE WS-SAVE-BENEFIT-REM-TERM
  9694                                 TO WS-AH-AM-REM-TERM-CALC.
  9695
  9696 6900-EXIT.
  9697      EXIT.
  9698
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 180
* EL1278.cbl
  9700 7000-GET-ERFORM     SECTION.
  9701
  9702* EXEC CICS HANDLE CONDITION
  9703*        NOTFND  (7000-EXIT)
  9704*    END-EXEC.
  9705*    MOVE '"$I                   ! ( #00009072' TO DFHEIV0
  9706     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9708     MOVE X'2820233030303039303732' TO DFHEIV0(25:11)
  9709     CALL 'kxdfhei1' USING DFHEIV0
  9710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9711
  9712
  9713     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9714     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9715     MOVE PI-STATE               TO  WS-FO-STATE.
  9716     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9717     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9718
  9719
  9720* EXEC CICS READ
  9721*        DATASET  (ERFORM-ID)
  9722*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9723*        SET      (ADDRESS OF FORM-MASTER)
  9724*        GTEQ
  9725*    END-EXEC.
  9726*    MOVE '&"S        G          (   #00009082' TO DFHEIV0
  9727     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9729     MOVE X'2020233030303039303832' TO DFHEIV0(25:11)
  9730     CALL 'kxdfhei1' USING DFHEIV0,
  9731           ERFORM-ID,
  9732           DFHEIV20,
  9733           DFHEIV99,
  9734           WS-FO-CONTROL-PRIMARY,
  9735           DFHEIV99,
  9736           DFHEIV99,
  9737           DFHEIV99
  9738     SET ADDRESS OF FORM-MASTER TO
  9739         DFHEIV20
  9740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9741
  9742
  9743     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9744        PI-STATE          EQUAL FO-STATE      AND
  9745        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9746         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9747         GO TO 7000-EXIT.
  9748 7000-EXIT.
  9749     EXIT.
  9750 7100-BENEFIT-SEARCH SECTION.
  9751
  9752     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9753        MOVE +1                  TO  SUB4
  9754        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9755
  9756     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9757        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 181
* EL1278.cbl
  9758        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9759 7100-EXIT.
  9760     EXIT.
  9761 7150-BENEFIT-LIFE-SEARCH.
  9762     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9763       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9764         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9765          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9766            IF FO-PLAN-REFUND-METHOD (SUB4)
  9767                    IS GREATER THAN SPACES
  9768               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9769                                    WS-LF-FO-REFUND-CALC
  9770               GO TO 7150-EXIT.
  9771
  9772     IF SUB4 LESS THAN +40
  9773         ADD +1              TO SUB4
  9774         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9775
  9776 7150-EXIT.
  9777     EXIT.
  9778 7250-BENEFIT-AH-SEARCH.
  9779     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9780       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9781         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9782          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9783            IF FO-PLAN-REFUND-METHOD (SUB4)
  9784                    IS GREATER THAN SPACES
  9785               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9786                                    WS-AH-FO-REFUND-CALC
  9787               GO TO 7250-EXIT.
  9788
  9789     IF SUB4 LESS THAN +40
  9790         ADD +1              TO SUB4
  9791         GO TO 7250-BENEFIT-AH-SEARCH.
  9792
  9793 7250-EXIT.
  9794     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 182
* EL1278.cbl
  9796
  9797 8100-SEND-INITIAL-MAP  SECTION.
  9798     MOVE SAVE-DATE              TO  HDATEO.
  9799     MOVE EIBTIME                TO  TIME-IN.
  9800     MOVE TIME-OUT               TO  HTIMEO.
  9801     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9802     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9803     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9804     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9805
  9806     IF CM-LF-BENEFIT-CD = '00'
  9807         MOVE -1                 TO  HACANCL
  9808     ELSE
  9809         MOVE -1                 TO  HLCANCL.
  9810
  9811     if pi-company-id = 'VPP'
  9812        move al-sanof            to refdueha
  9813                                    canfeeha
  9814        move al-uanof            to refduea
  9815                                    canfeea
  9816     end-if
  9817     IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9818        MOVE AL-SADOF            TO CANREAHA
  9819                                    CLPYNHA
  9820                                    CANREAA
  9821                                    CLPYNA
  9822     END-IF
  9823
  9824
  9825* EXEC CICS SEND
  9826*        FROM    (EL127HO)
  9827*        MAPSET  (MAPSET-NAME)
  9828*        MAP     (MAP-NAME)
  9829*        CURSOR
  9830*        ERASE
  9831*    END-EXEC.
  9832     MOVE LENGTH OF
  9833      EL127HO
  9834       TO DFHEIV12
  9835     MOVE -1
  9836       TO DFHEIV11
  9837*    MOVE '8$     CT  E    H L F ,   #00009170' TO DFHEIV0
  9838     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9839     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9840     MOVE X'2020233030303039313730' TO DFHEIV0(25:11)
  9841     CALL 'kxdfhei1' USING DFHEIV0,
  9842           MAP-NAME,
  9843           EL127HO,
  9844           DFHEIV12,
  9845           MAPSET-NAME,
  9846           DFHEIV99,
  9847           DFHEIV99,
  9848           DFHEIV99,
  9849           DFHEIV11,
  9850           DFHEIV99,
  9851           DFHEIV99,
  9852           DFHEIV99
  9853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 183
* EL1278.cbl
  9854
  9855
  9856     GO TO 9000-RETURN-TRAN.
  9857
  9858 8200-SEND-DATAONLY  SECTION.
  9859     IF FIRST-ENTRY
  9860         GO TO 8100-SEND-INITIAL-MAP.
  9861
  9862     MOVE SAVE-DATE              TO  HDATEO.
  9863     MOVE EIBTIME                TO  TIME-IN.
  9864     MOVE TIME-OUT               TO  HTIMEO.
  9865     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9866     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9867     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9868     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9869     MOVE -1                     TO  HLCANCL.
  9870
  9871
  9872* EXEC CICS SEND DATAONLY
  9873*        FROM    (EL127HO)
  9874*        MAPSET  (MAPSET-NAME)
  9875*        MAP     (MAP-NAME)
  9876*        CURSOR
  9877*    END-EXEC.
  9878     MOVE LENGTH OF
  9879      EL127HO
  9880       TO DFHEIV12
  9881     MOVE -1
  9882       TO DFHEIV11
  9883*    MOVE '8$D    CT       H L F ,   #00009193' TO DFHEIV0
  9884     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9885     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9886     MOVE X'2020233030303039313933' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           MAP-NAME,
  9889           EL127HO,
  9890           DFHEIV12,
  9891           MAPSET-NAME,
  9892           DFHEIV99,
  9893           DFHEIV99,
  9894           DFHEIV99,
  9895           DFHEIV11,
  9896           DFHEIV99,
  9897           DFHEIV99,
  9898           DFHEIV99
  9899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9900
  9901
  9902     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 184
* EL1278.cbl
  9904 8300-SEND-TEXT  SECTION.
  9905
  9906* EXEC CICS SEND TEXT
  9907*        FROM    (LOGOFF-TEXT)
  9908*        LENGTH  (LOGOFF-LENGTH)
  9909*        ERASE
  9910*        FREEKB
  9911*    END-EXEC.
  9912*    MOVE '8&      T  E F  H   F -   #00009203' TO DFHEIV0
  9913     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9914     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9915     MOVE X'2020233030303039323033' TO DFHEIV0(25:11)
  9916     CALL 'kxdfhei1' USING DFHEIV0,
  9917           LOGOFF-TEXT,
  9918           LOGOFF-LENGTH,
  9919           DFHEIV99,
  9920           DFHEIV99,
  9921           DFHEIV99,
  9922           DFHEIV99,
  9923           DFHEIV99,
  9924           DFHEIV99,
  9925           DFHEIV99,
  9926           DFHEIV99,
  9927           DFHEIV99,
  9928           DFHEIV99
  9929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9930
  9931
  9932
  9933* EXEC CICS RETURN
  9934*    END-EXEC.
  9935*    MOVE '.(                    ''   #00009210' TO DFHEIV0
  9936     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9937     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9938     MOVE X'2020233030303039323130' TO DFHEIV0(25:11)
  9939     CALL 'kxdfhei1' USING DFHEIV0,
  9940           DFHEIV99,
  9941           DFHEIV99,
  9942           DFHEIV99,
  9943           DFHEIV99,
  9944           DFHEIV99,
  9945           DFHEIV99
  9946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9947
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 185
* EL1278.cbl
  9949 8600-DEEDIT  SECTION.
  9950
  9951* EXEC CICS BIF DEEDIT
  9952*        FIELD   (DEEDIT-FIELD)
  9953*        LENGTH  (15)
  9954*    END-EXEC.
  9955     MOVE 15
  9956       TO DFHEIV11
  9957*    MOVE '@"L                   #   #00009214' TO DFHEIV0
  9958     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9959     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9960     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
  9961     CALL 'kxdfhei1' USING DFHEIV0,
  9962           DEEDIT-FIELD,
  9963           DFHEIV11
  9964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9965
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 186
* EL1278.cbl
  9967 8700-UNAUTHORIZED-ACCESS  SECTION.
  9968     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9969
  9970     GO TO 8300-SEND-TEXT.
  9971
  9972 8800-PF23  SECTION.
  9973     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9974     MOVE XCTL-005               TO  PGM-NAME.
  9975
  9976     GO TO 9200-XCTL.
  9977
  9978 8900-RETURN-CICS  SECTION.
  9979
  9980* EXEC CICS RETURN
  9981*    END-EXEC.
  9982*    MOVE '.(                    ''   #00009231' TO DFHEIV0
  9983     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9985     MOVE X'2020233030303039323331' TO DFHEIV0(25:11)
  9986     CALL 'kxdfhei1' USING DFHEIV0,
  9987           DFHEIV99,
  9988           DFHEIV99,
  9989           DFHEIV99,
  9990           DFHEIV99,
  9991           DFHEIV99,
  9992           DFHEIV99
  9993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9994
  9995
  9996 9000-RETURN-TRAN  SECTION.
  9997     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9998     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9999
 10000
 10001* EXEC CICS RETURN
 10002*        TRANSID   (TRANS-ID)
 10003*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10004*        LENGTH    (PI-COMM-LENGTH)
 10005*    END-EXEC.
 10006*    MOVE '.(CT                  ''   #00009238' TO DFHEIV0
 10007     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10008     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10009     MOVE X'2020233030303039323338' TO DFHEIV0(25:11)
 10010     CALL 'kxdfhei1' USING DFHEIV0,
 10011           TRANS-ID,
 10012           PROGRAM-INTERFACE-BLOCK,
 10013           PI-COMM-LENGTH,
 10014           DFHEIV99,
 10015           DFHEIV99,
 10016           DFHEIV99
 10017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10018
 10019
 10020 9100-RETURN-MAIN-MENU  SECTION.
 10021     MOVE XCTL-126               TO  PGM-NAME.
 10022
 10023     GO TO 9200-XCTL.
 10024
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 187
* EL1278.cbl
 10025 9200-XCTL  SECTION.
 10026
 10027* EXEC CICS XCTL
 10028*        PROGRAM   (PGM-NAME)
 10029*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10030*        LENGTH    (PI-COMM-LENGTH)
 10031*    END-EXEC.
 10032*    MOVE '.$C                   %   #00009250' TO DFHEIV0
 10033     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10034     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10035     MOVE X'2020233030303039323530' TO DFHEIV0(25:11)
 10036     CALL 'kxdfhei1' USING DFHEIV0,
 10037           PGM-NAME,
 10038           PROGRAM-INTERFACE-BLOCK,
 10039           PI-COMM-LENGTH,
 10040           DFHEIV99
 10041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10042
 10043
 10044 9300-CLEAR  SECTION.
 10045     MOVE ' '                    TO  PI-PEND-SW.
 10046     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10047
 10048     GO TO 9200-XCTL.
 10049
 10050 9400-PF12  SECTION.
 10051     MOVE XCTL-010               TO  PGM-NAME.
 10052
 10053     GO TO 9200-XCTL.
 10054
 10055 9500-PGMID-ERROR  SECTION.
 10056
 10057* EXEC CICS HANDLE CONDITION
 10058*        PGMIDERR  (8300-SEND-TEXT)
 10059*    END-EXEC.
 10060*    MOVE '"$L                   ! ) #00009268' TO DFHEIV0
 10061     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10063     MOVE X'2920233030303039323638' TO DFHEIV0(25:11)
 10064     CALL 'kxdfhei1' USING DFHEIV0
 10065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10066
 10067
 10068     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10069     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10070     MOVE XCTL-005               TO  PGM-NAME.
 10071     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10072     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10073
 10074     GO TO 9200-XCTL.
 10075
 10076 9600-DATE-LINK  SECTION.
 10077     MOVE LINK-ELDATCV           TO  PGM-NAME
 10078
 10079
 10080* EXEC CICS LINK
 10081*        PROGRAM   (PGM-NAME)
 10082*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 188
* EL1278.cbl
 10083*        LENGTH    (DC-COMM-LENGTH)
 10084*    END-EXEC.
 10085*    MOVE '."C                   (   #00009283' TO DFHEIV0
 10086     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10087     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10088     MOVE X'2020233030303039323833' TO DFHEIV0(25:11)
 10089     CALL 'kxdfhei1' USING DFHEIV0,
 10090           PGM-NAME,
 10091           DATE-CONVERSION-DATA,
 10092           DC-COMM-LENGTH,
 10093           DFHEIV99,
 10094           DFHEIV99,
 10095           DFHEIV99,
 10096           DFHEIV99
 10097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10098
 10099
 10100
 10101 9700-ERROR-FORMAT  SECTION.
 10102     IF NOT EMI-ERRORS-COMPLETE
 10103         MOVE LINK-001               TO  PGM-NAME
 10104
 10105* EXEC CICS LINK
 10106*            PROGRAM   (PGM-NAME)
 10107*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10108*            LENGTH    (EMI-COMM-LENGTH)
 10109*        END-EXEC.
 10110*    MOVE '."C                   (   #00009293' TO DFHEIV0
 10111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10113     MOVE X'2020233030303039323933' TO DFHEIV0(25:11)
 10114     CALL 'kxdfhei1' USING DFHEIV0,
 10115           PGM-NAME,
 10116           ERROR-MESSAGE-INTERFACE-BLOCK,
 10117           EMI-COMM-LENGTH,
 10118           DFHEIV99,
 10119           DFHEIV99,
 10120           DFHEIV99,
 10121           DFHEIV99
 10122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10123
 10124
 10125 9799-EXIT.
 10126     EXIT.
 10127
 10128 9800-SECURITY-VIOLATION  SECTION.
 10129*                            COPY ELCSCTP.
 10130******************************************************************
 10131*                                                                *
 10132*                            ELCSCTP                             *
 10133*                            VMOD=2.001                          *
 10134*                                                                *
 10135*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10136******************************************************************
 10137
 10138
 10139     MOVE EIBDATE          TO SM-JUL-DATE.
 10140     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 189
* EL1278.cbl
 10141     MOVE THIS-PGM         TO SM-PGM.
 10142     MOVE EIBTIME          TO TIME-IN.
 10143     MOVE TIME-OUT         TO SM-TIME.
 10144     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10145
 10146
 10147* EXEC CICS LINK
 10148*         PROGRAM  ('EL003')
 10149*         COMMAREA (SECURITY-MESSAGE)
 10150*         LENGTH   (80)
 10151*    END-EXEC.
 10152     MOVE 'EL003' TO DFHEIV1
 10153     MOVE 80
 10154       TO DFHEIV11
 10155*    MOVE '."C                   (   #00009320' TO DFHEIV0
 10156     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10158     MOVE X'2020233030303039333230' TO DFHEIV0(25:11)
 10159     CALL 'kxdfhei1' USING DFHEIV0,
 10160           DFHEIV1,
 10161           SECURITY-MESSAGE,
 10162           DFHEIV11,
 10163           DFHEIV99,
 10164           DFHEIV99,
 10165           DFHEIV99,
 10166           DFHEIV99
 10167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10168
 10169
 10170******************************************************************
 10171
 10172
 10173 9899-EXIT.
 10174     EXIT.
 10175
 10176 9900-ABEND  SECTION.
 10177     MOVE LINK-004               TO  PGM-NAME.
 10178     MOVE DFHEIBLK               TO  EMI-LINE1.
 10179
 10180
 10181* EXEC CICS LINK
 10182*        PROGRAM   (PGM-NAME)
 10183*        COMMAREA  (EMI-LINE1)
 10184*        LENGTH    (72)
 10185*    END-EXEC.
 10186     MOVE 72
 10187       TO DFHEIV11
 10188*    MOVE '."C                   (   #00009336' TO DFHEIV0
 10189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10191     MOVE X'2020233030303039333336' TO DFHEIV0(25:11)
 10192     CALL 'kxdfhei1' USING DFHEIV0,
 10193           PGM-NAME,
 10194           EMI-LINE1,
 10195           DFHEIV11,
 10196           DFHEIV99,
 10197           DFHEIV99,
 10198           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 190
* EL1278.cbl
 10199           DFHEIV99
 10200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10201
 10202
 10203     MOVE -1                     TO  HLCANCL.
 10204
 10205     GO TO 8200-SEND-DATAONLY.
 10206
 10207 9999-LAST-PARAGRAPH.
 10208
 10209* GOBACK.
 10210     MOVE '9%                    "   ' TO DFHEIV0
 10211     MOVE 'EL1278' TO DFHEIV1
 10212     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10213     GOBACK.
 10214
 10215 9999-DFHBACK SECTION.
 10216     MOVE '9%                    "   ' TO DFHEIV0
 10217     MOVE 'EL1278' TO DFHEIV1
 10218     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10219     GOBACK.
 10220 9999-DFHEXIT.
 10221     IF DFHEIGDJ EQUAL 0001
 10222         NEXT SENTENCE
 10223     ELSE IF DFHEIGDJ EQUAL 2
 10224         GO TO 9500-PGMID-ERROR,
 10225               9900-ABEND
 10226         DEPENDING ON DFHEIGDI
 10227     ELSE IF DFHEIGDJ EQUAL 3
 10228         GO TO 0910-NOT-FOUND
 10229         DEPENDING ON DFHEIGDI
 10230     ELSE IF DFHEIGDJ EQUAL 4
 10231         GO TO 1010-NOTFND,
 10232               1020-NOTOPEN
 10233         DEPENDING ON DFHEIGDI
 10234     ELSE IF DFHEIGDJ EQUAL 5
 10235         GO TO 1290-ACCT-NOT-FOUND,
 10236               1290-ACCT-NOT-FOUND
 10237         DEPENDING ON DFHEIGDI
 10238     ELSE IF DFHEIGDJ EQUAL 6
 10239         GO TO 0580-ACCT-NOT-FOUND,
 10240               0580-ACCT-NOT-FOUND
 10241         DEPENDING ON DFHEIGDI
 10242     ELSE IF DFHEIGDJ EQUAL 7
 10243         GO TO 1699-EXIT
 10244         DEPENDING ON DFHEIGDI
 10245     ELSE IF DFHEIGDJ EQUAL 8
 10246         GO TO 7000-EXIT
 10247         DEPENDING ON DFHEIGDI
 10248     ELSE IF DFHEIGDJ EQUAL 9
 10249         GO TO 8300-SEND-TEXT
 10250         DEPENDING ON DFHEIGDI.
 10251     MOVE '9%                    "   ' TO DFHEIV0
 10252     MOVE 'EL1278' TO DFHEIV1
 10253     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10254     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 191
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8648     Code:       26544
