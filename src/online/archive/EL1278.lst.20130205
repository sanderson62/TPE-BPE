* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   3
* EL1278.cbl
    58 ENVIRONMENT DIVISION.
    59 DATA DIVISION.
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER  PIC  X(32) VALUE '********************************'.
    63 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    64 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    65 77  S1                          PIC S999 COMP-3 VALUE +0.
    66 77  P1                          PIC S999 COMP-3 VALUE +0.
    67 77  P2                          PIC S999 COMP-3 VALUE +0.
    68 77  C0                          PIC S999 COMP-3 VALUE +0.
    69 77  C1                          PIC S999 COMP-3 VALUE +0.
    70 77  C2                          PIC S999 COMP-3 VALUE +0.
    71 77  C3                          PIC S999 COMP-3 VALUE +0.
    72 77  WS-STOP-SW                  PIC X  VALUE ' '.
    73     88  I-SAY-TO-STOP      VALUE 'Y'.
    74 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    75     88  OPEN-LF-CLAIM              VALUE 'Y'.
    76 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    77     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    78 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    79     88  OPEN-AH-CLAIM              VALUE 'Y'.
    80 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    81     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    82 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    83     88  FOUND-A-CLAIM              VALUE 'Y'.
    84 77  WS-ST-REF-IND               PIC X.
    85 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    86 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    87 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    88 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    89 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    90 77  DD-IU-SW                    PIC X   VALUE ' '.
    91     88  DD-IU-PRESENT                 VALUE 'Y'.
    92 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    97 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    98 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    99 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   100 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   101     88  NO-CERT-RW                 VALUE 'N'.
   102     88  CERT-RW                    VALUE 'Y'.
   103 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   104     88  ERMAIL-FOUND                 VALUE 'Y'.
   105 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   106
   107*                            COPY ELCSCTM.
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*                            ELCSCTM                             *
   112*                            VMOD=2.001                          *
   113*                                                                *
   114*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   115*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   4
* EL1278.cbl
   116******************************************************************
   117 01  SECURITY-MESSAGE.
   118     12  FILLER                          PIC X(30)
   119            VALUE '** LOGIC SECURITY VIOLATION -'.
   120     12  SM-READ                         PIC X(6).
   121     12  FILLER                          PIC X(5)
   122            VALUE ' PGM='.
   123     12  SM-PGM                          PIC X(6).
   124     12  FILLER                          PIC X(5)
   125            VALUE ' OPR='.
   126     12  SM-PROCESSOR-ID                 PIC X(4).
   127     12  FILLER                          PIC X(6)
   128            VALUE ' TERM='.
   129     12  SM-TERMID                       PIC X(4).
   130     12  FILLER                          PIC XX   VALUE SPACE.
   131     12  SM-JUL-DATE                     PIC 9(5).
   132     12  FILLER                          PIC X    VALUE SPACE.
   133     12  SM-TIME                         PIC 99.99.
   134
   135
   136*                            COPY ELCSCRTY.
   137******************************************************************
   138*                                                                *
   139*                                                                *
   140*                            ELCSCRTY                            *
   141*                            VMOD=2.001                          *
   142*                                                                *
   143*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   144*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   145*        SAVED IN PI-SECURITY-ADDRESS.                           *
   146*                                                                *
   147******************************************************************
   148 01  SECURITY-CONTROL.
   149     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   150     12  FILLER                       PIC XX    VALUE 'SC'.
   151     12  SC-CREDIT-CODES.
   152         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   153             20  SC-CREDIT-DISPLAY    PIC X.
   154             20  SC-CREDIT-UPDATE     PIC X.
   155     12  SC-CLAIMS-CODES.
   156         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   157             20  SC-CLAIMS-DISPLAY    PIC X.
   158             20  SC-CLAIMS-UPDATE     PIC X.
   159
   160 01  FILLER          COMP-3.
   161     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   162     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   163     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   164     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   165     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   166     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   167     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   168     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   169     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   170
   171 01  WS-DATE-AREA.
   172     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   173     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   5
* EL1278.cbl
   174     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   175     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   176     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   177     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   178
   179 01  ERPDEF-KEY-SAVE             PIC X(18).
   180 01  ERPDEF-KEY.
   181     12  ERPDEF-COMPANY-CD       PIC X.
   182     12  ERPDEF-STATE            PIC XX.
   183     12  ERPDEF-PROD-CD          PIC XXX.
   184     12  F                       PIC X(7).
   185     12  ERPDEF-BEN-TYPE         PIC X.
   186     12  ERPDEF-BEN-CODE         PIC XX.
   187     12  ERPDEF-EXP-DT           PIC XX.
   188 01  ELMSTR-KEY.
   189     12  ELMSTR-COMP-CD          PIC X.
   190     12  ELMSTR-CERT-NO          PIC X(11).
   191 01  ELCRTT-KEY.
   192     12  ELCRTT-PRIMARY          PIC X(33).
   193     12  ELCRTT-REC-TYPE         PIC X(1).
   194
   195 01  ELCRTO-KEY.
   196     05  ELCRTO-COMPANY-CD       PIC X.
   197     05  ELCRTO-CARRIER          PIC X.
   198     05  ELCRTO-GROUPING         PIC X(6).
   199     05  ELCRTO-STATE            PIC XX.
   200     05  ELCRTO-ACCOUNT          PIC X(10).
   201     05  ELCRTO-CERT-EFF-DT      PIC XX.
   202     05  ELCRTO-CERT-NO.
   203         10  ELCRTO-CERT-PRIME   PIC X(10).
   204         10  ELCRTO-CERT-SFX     PIC X.
   205     05  ELCRTO-RECORD-TYPE      PIC X.
   206     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   207
   208 01  STANDARD-AREAS.
   209     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   210     12  SUB3                    PIC S9(04) COMP VALUE +0.
   211     12  SUB4                    PIC S9(04) COMP VALUE +0.
   212     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   213     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   214     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   215     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   216     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   217     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   218     12  PGM-NAME                PIC  X(08).
   219     12  TIME-IN                 PIC S9(07).
   220     12  TIME-OUT-R  REDEFINES  TIME-IN.
   221         16  FILLER              PIC  X(01).
   222         16  TIME-OUT            PIC  9(02)V99.
   223         16  FILLER              PIC  X(02).
   224     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   225     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   226     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   227     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   228     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   229     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   230     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   231     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   6
* EL1278.cbl
   232     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   233     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   234     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   235     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   236     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   237     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   238     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   239     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   240     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   241     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   242         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   243     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   244         88  BROWSE-STARTED                      VALUE 'Y'.
   245     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   246         88  FORM-FOUND                          VALUE 'Y'.
   247     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   248         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   249     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   250         88  WS-REDUCING                         VALUE 'R'.
   251         88  WS-LEVEL                            VALUE 'L'  'P'.
   252     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   253         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   254     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   255         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   256     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   257     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   258         'CLAIM PMTS'.
   259     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   260         'ITD REFUND'.
   261     12  WS-ACCESS.
   262         16  FILLER              PIC  X(02).
   263         16  WS-BEN-CD           PIC  X(02).
   264     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   265     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   266     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   267     12  WS-LOOKUP-TYPE          PIC  X(01).
   268     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   269     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   270     12  WS-CALC-CD              PIC  X(01).
   271     12  DEEDIT-FIELD            PIC  X(15).
   272     12  DEEDIT-FIELD-V0  REDEFINES
   273         DEEDIT-FIELD            PIC S9(15).
   274     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   275     12  RETURN-FROM             PIC  X(08).
   276     12  QID.
   277         16  QID-TERM            PIC  X(04).
   278         16  FILLER              PIC  X(04)      VALUE '127H'.
   279     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   280         88  FIRST-ENTRY                         VALUE 'Y'.
   281     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   282         88  PDEF-FOUND                          VALUE 'Y'.
   283     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   284         88  CERT-FOUND                          VALUE 'Y'.
   285         88  CERT-NOT-FOUND                      VALUE 'N'.
   286     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   287         88  CNTL-FOUND                          VALUE 'Y'.
   288         88  CNTL-NOT-FOUND                      VALUE 'N'.
   289     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   7
* EL1278.cbl
   290         88  BEN-FOUND                           VALUE 'Y'.
   291     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   292         88  STATE-FOUND                         VALUE 'Y'.
   293     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   294         88  ST-BEN-FOUND                        VALUE 'Y'.
   295     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   296         88  ACCT-FOUND                          VALUE 'Y'.
   297     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   298         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   299     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   300                                                 VALUE ZERO.
   301         88  BENEFIT-FOUND                       VALUE +1.
   302     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   303                                                 VALUE ZERO.
   304     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   305                                                 VALUE ZERO.
   306     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   307     12  WS-SUB1                 PIC S99    COMP.
   308     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   309     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   310     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   311     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   312     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   313     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   314     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   315     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   316     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   317     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   318     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   319     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   320     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   321     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   322     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   323     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   324     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   325     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   326     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   327     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   328     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   329     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   330     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   331     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   332     12  ERROR-MESSAGES.
   333         16  ER-0000             PIC  X(04)      VALUE '0000'.
   334         16  ER-0004             PIC  X(04)      VALUE '0004'.
   335         16  ER-0008             PIC  X(04)      VALUE '0008'.
   336         16  ER-0028             PIC  X(04)      VALUE '0028'.
   337         16  ER-0029             PIC  X(04)      VALUE '0029'.
   338         16  ER-0070             PIC  X(04)      VALUE '0070'.
   339         16  ER-0142             PIC  X(04)      VALUE '0142'.
   340         16  ER-0214             PIC  X(04)      VALUE '0214'.
   341         16  ER-0681             PIC  X(04)      VALUE '0681'.
   342         16  ER-0682             PIC  X(04)      VALUE '0682'.
   343         16  ER-0683             PIC  X(04)      VALUE '0683'.
   344         16  ER-0684             PIC  X(04)      VALUE '0684'.
   345         16  ER-2227             PIC  X(04)      VALUE '2227'.
   346         16  ER-2601             PIC  X(04)      VALUE '2601'.
   347         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   8
* EL1278.cbl
   348         16  ER-2617             PIC  X(04)      VALUE '2617'.
   349         16  ER-2619             PIC  X(04)      VALUE '2619'.
   350         16  ER-2740             PIC  X(04)      VALUE '2740'.
   351         16  ER-2756             PIC  X(04)      VALUE '2756'.
   352         16  ER-2768             PIC  X(04)      VALUE '2768'.
   353         16  ER-2774             PIC  X(04)      VALUE '2774'.
   354         16  ER-2775             PIC  X(04)      VALUE '2775'.
   355         16  ER-2965             PIC  X(04)      VALUE '2965'.
   356         16  ER-2966             PIC  X(04)      VALUE '2966'.
   357         16  ER-2967             PIC  X(04)      VALUE '2967'.
   358         16  ER-2968             PIC  X(04)      VALUE '2968'.
   359         16  ER-2969             PIC  X(04)      VALUE '2969'.
   360         16  ER-3037             PIC  X(04)      VALUE '3037'.
   361         16  ER-3038             PIC  X(04)      VALUE '3038'.
   362         16  ER-3039             PIC  X(04)      VALUE '3039'.
   363         16  ER-3780             PIC  X(04)      VALUE '3780'.
   364         16  ER-3781             PIC  X(04)      VALUE '3781'.
   365         16  ER-3830             PIC  X(04)      VALUE '3830'.
   366         16  ER-8160             PIC  X(04)      VALUE '8160'.
   367         16  ER-8161             PIC  X(04)      VALUE '8161'.
   368         16  ER-9999             PIC  X(04)      VALUE '9999'.
   369     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   370     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   371     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   372     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   373
   374     12  WS-RESPONSE             PIC S9(8)       COMP.
   375         88  WS-RESP-NORMAL                      VALUE +00.
   376         88  WS-RESP-NOTFND                      VALUE +13.
   377         88  WS-RESP-DUPREC                      VALUE +14.
   378         88  WS-RESP-DUPKEY                      VALUE +15.
   379         88  WS-RESP-NOTOPEN                     VALUE +19.
   380         88  WS-RESP-ENDFILE                     VALUE +20.
   381
   382     12  WS-01-CANCEL-ERR        PIC X(25)
   383         VALUE 'CANCEL DATE ERROR'.
   384     12  WS-02-CANCEL-ERR        PIC X(25)
   385         VALUE 'CERT NOT FOUND'.
   386     12  WS-04-CANCEL-ERR        PIC X(25)
   387         VALUE 'CANCEL AMOUNT ERROR'.
   388     12  WS-05-CANCEL-ERR        PIC X(25)
   389         VALUE 'CANCEL OPTION ERROR'.
   390     12  WS-06-CANCEL-ERR        PIC X(25)
   391         VALUE 'PREVIOUSLY CANCELLED'.
   392     12  WS-07-CANCEL-ERR        PIC X(25)
   393         VALUE 'INVALID DATA'.
   394     12  WS-08-CANCEL-ERR        PIC X(25)
   395         VALUE 'NO ACCOUNT MASTER'.
   396     12  WS-09-CANCEL-ERR        PIC X(25)
   397         VALUE 'SUFFIX ALREADY EXISTS'.
   398     12  WS-99-CANCEL-ERR        PIC X(25)
   399         VALUE 'MISC CANCEL ERROR'.
   400
   401 01  WS-SAVE-ALLOWABLE-BENEFIT.
   402     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   403     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   404     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   405     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   9
* EL1278.cbl
   406     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   407     16  FILLER                    PIC XX.
   408 01  CTBL-KEY-SAVE               PIC X(5).
   409 01  CTBL-KEY.
   410     05  CTBL-COMPANY-CD         PIC X.
   411     05  CTBL-TABLE              PIC XXX.
   412     05  CTBL-BEN-TYPE           PIC X.
   413     05  CTBL-BEN-CODE           PIC XX.
   414 01  CANCEL-GEN-PASS-AREA.
   415     05  CG-OPTION-CODE          PIC X.
   416         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   417         88  CG-FLAT-CANCEL        VALUE '1'.
   418         88  CG-CANCEL             VALUE '2'.
   419         88  CG-CANCEL-REISSUE     VALUE '3'.
   420     05  CG-ERROR-CODE           PIC 99.
   421         88  CG-SUCCESS            VALUE 00.
   422         88  CG-DATE-ERROR         VALUE 01.
   423         88  CG-CERT-NOT-FOUND     VALUE 02.
   424         88  CG-AMOUNT-ERROR       VALUE 04.
   425         88  CG-OPTION-ERROR       VALUE 05.
   426         88  CG-PREV-CAN           VALUE 06.
   427         88  CG-INVALID-DATA       VALUE 07.
   428         88  CG-NO-ACCT-MSTR       VALUE 08.
   429         88  CG-SFX-A-EXIST        VALUE 09.
   430         88  CG-MISC-ERROR         VALUE 99.
   431     05  CG-COMPANY-ID           PIC XXX.
   432     05  CG-PROC-ID              PIC XXXX.
   433     05  CG-CURRENT-DT           PIC XX.
   434     05  CG-MONTH-END-DT         PIC XX.
   435     05  CG-CERT-KEY.
   436         10  CG-CERT-COMPANY-CD  PIC X.
   437         10  CG-CERT-CARRIER     PIC X.
   438         10  CG-CERT-GROUP       PIC X(6).
   439         10  CG-CERT-STATE       PIC XX.
   440         10  CG-CERT-ACCOUNT     PIC X(10).
   441         10  CG-CERT-EFF-DT      PIC XX.
   442         10  CG-CERT-CERT-NO     PIC X(11).
   443     05  CG-LF-CAN-DATA.
   444         10  CG-LF-CAN-DT        PIC XX.
   445         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   446     05  CG-AH-CAN-DATA.
   447         10  CG-AH-CAN-DT        PIC XX.
   448         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   449     05  CG-CERT-PROFILE-DATA.
   450         10  CG-INS-LNAME        PIC X(15).
   451         10  CG-INS-FNAME        PIC X(10).
   452         10  CG-INS-MID-INIT     PIC X.
   453         10  CG-INS-AGE          PIC 99.
   454         10  CG-JNT-LNAME        PIC X(15).
   455         10  CG-JNT-FNAME        PIC X(10).
   456         10  CG-JNT-MID-INIT     PIC X.
   457         10  CG-JNT-AGE          PIC 99.
   458     05  CG-LF-ISS-DATA.
   459         10  CG-LF-BENCD         PIC XX.
   460         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   461         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   462     05  CG-AH-ISS-DATA.
   463         10  CG-AH-BENCD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  10
* EL1278.cbl
   464         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   465     05  CG-BATCH-NO             PIC X(6).
   466     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   467     05  FILLER                  PIC X(306).
   468 01  WS-CAN-QUOTE-NOTE.
   469     12  WS-CN-DT-QUOTED         PIC  X(09).
   470     12  FILLER                  PIC  X(10)      VALUE
   471         'RF QUOTE: '.
   472     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   473     12  FILLER                  PIC  X(4)       VALUE
   474         ' LF '.
   475     12  WS-CN-LF-REF-METH       PIC  X.
   476     12  FILLER                  PIC  X          VALUE ','.
   477     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   478     12  FILLER                  PIC  X(5)       VALUE
   479         ' AH '.
   480     12  WS-CN-AH-REF-METH       PIC  X.
   481     12  FILLER                  PIC  XX         VALUE ','.
   482     12  FILLER                  PIC  X(6)       VALUE
   483         'TOTAL '.
   484     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   485     12  FILLER                  PIC  X(01)      VALUE ' '.
   486     12  WS-CN-CANCEL-DT         PIC  X(08).
   487     12  FILLER                  PIC  X(01)      VALUE ';'.
   488     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   489
   490 01  WS-CM-CONTROL-PRIMARY.
   491     12  WS-CM-COMPANY-CD        PIC  X(01).
   492     12  WS-CM-CARRIER           PIC  X(01).
   493     12  WS-CM-GROUPING          PIC  X(06).
   494     12  WS-CM-STATE             PIC  X(02).
   495     12  WS-CM-ACCOUNT           PIC  X(10).
   496     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   497     12  WS-CM-CERT-NO.
   498         16  WS-CM-CERT-PRIME    PIC  X(10).
   499         16  WS-CM-CERT-SFX      PIC  X(01).
   500
   501 01  WS-MA-CONTROL-PRIMARY.
   502     12  WS-MA-COMPANY-CD        PIC  X(01).
   503     12  WS-MA-CARRIER           PIC  X(01).
   504     12  WS-MA-GROUPING          PIC  X(06).
   505     12  WS-MA-STATE             PIC  X(02).
   506     12  WS-MA-ACCOUNT           PIC  X(10).
   507     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   508     12  WS-MA-CERT-NO.
   509         16  WS-MA-CERT-PRIME    PIC  X(10).
   510         16  WS-MA-CERT-SFX      PIC  X(01).
   511 01  WS-CF-CONTROL-PRIMARY.
   512     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   513     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   514*        88  COMPANY-MASTER                      VALUE '1'.
   515*        88  STATE-MASTER                        VALUE '3'.
   516*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   517*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   518     12  WS-CF-ACCESS.
   519         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   520         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   521             20  FILLER          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  11
* EL1278.cbl
   522             20  WS-CF-CARRIER   PIC  X(01).
   523     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   524
   525 01  WS-AM-CONTROL-PRIMARY.
   526     12  WS-AM-COMPANY-CD        PIC  X(01).
   527     12  WS-AM-CARRIER           PIC  X(01).
   528     12  WS-AM-GROUPING          PIC  X(06).
   529     12  WS-AM-STATE             PIC  X(02).
   530     12  WS-AM-ACCOUNT           PIC  X(10).
   531     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   532     12  WS-AM-FILLER            PIC  X(04).
   533
   534 01  WS-CN-CONTROL-PRIMARY.
   535     12  WS-CN-COMPANY-CD        PIC  X(01).
   536     12  WS-CN-CARRIER           PIC  X(01).
   537     12  WS-CN-GROUPING          PIC  X(06).
   538     12  WS-CN-STATE             PIC  X(02).
   539     12  WS-CN-ACCOUNT           PIC  X(10).
   540     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   541     12  WS-CN-CERT-NO.
   542         16  WS-CN-CERT-PRIME    PIC  X(10).
   543         16  WS-CN-CERT-SFX      PIC  X.
   544     12  WS-CN-REC-TYPE          PIC X.
   545     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   546
   547 01  WS-FO-CONTROL-PRIMARY.
   548     12  WS-FO-COMPANY-CD        PIC  X(01).
   549     12  WS-FO-STATE             PIC  X(02).
   550     12  WS-FO-FORM-ID           PIC  X(12).
   551     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  12
* EL1278.cbl
   553*                            COPY ERCCNOT.
   554******************************************************************
   555*                                                                *
   556*                            ERCCNOT                             *
   557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   558*                            VMOD=2.003                          *
   559*                                                                *
   560*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   561*                                                                *
   562*        FILE TYPE= VSAM,KSDS                                    *
   563*        RECORD SIZE = 150    RECFORM = FIXED                    *
   564*                                                                *
   565*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   566*                                                                *
   567*        LOG = YES                                               *
   568*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   569*                                                                *
   570******************************************************************
   571*                   C H A N G E   L O G
   572*
   573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   574*-----------------------------------------------------------------
   575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   576* EFFECTIVE    NUMBER
   577*-----------------------------------------------------------------
   578* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   579******************************************************************
   580
   581 01  CERT-NOTE-FILE.
   582     12  CZ-RECORD-ID                PIC  XX.
   583         88  VALID-CZ-ID                  VALUE 'CZ'.
   584
   585     12  CZ-CONTROL-PRIMARY.
   586         16  CZ-COMPANY-CD           PIC X.
   587         16  CZ-CARRIER              PIC X.
   588         16  CZ-GROUPING.
   589             20 CZ-GROUPING-PREFIX   PIC XXX.
   590             20 CZ-GROUPING-PRIME    PIC XXX.
   591         16  CZ-STATE                PIC XX.
   592         16  CZ-ACCOUNT.
   593             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   594             20 CZ-ACCOUNT-PRIME     PIC X(6).
   595         16  CZ-CERT-EFF-DT          PIC XX.
   596         16  CZ-CERT-NO.
   597             20  CZ-CERT-PRIME       PIC X(10).
   598             20  CZ-CERT-SFX         PIC X.
   599         16  CZ-RECORD-TYPE          PIC X.
   600             88  CERT-NOTE           VALUE '1'.
   601             88  CLAIM-CERT-NOTE     VALUE '2'.
   602         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   603
   604     12  CZ-LAST-MAINT-DT            PIC XX.
   605     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   606     12  CZ-LAST-MAINT-USER          PIC X(4).
   607
   608     12  CZ-NOTE-INFORMATION.
   609         16  CZ-NOTE                 PIC X(63).
   610         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  13
* EL1278.cbl
   611******************************************************************
   612*                            COPY ELCDATE.
   613******************************************************************
   614*                                                                *
   615*                                                                *
   616*                            ELCDATE.                            *
   617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   618*                            VMOD=2.003
   619*                                                                *
   620*                                                                *
   621*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   622*                 LENGTH = 200                                   *
   623******************************************************************
   624
   625 01  DATE-CONVERSION-DATA.
   626     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   627     12  DC-OPTION-CODE                PIC X.
   628         88  BIN-TO-GREG                VALUE ' '.
   629         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   630         88  EDIT-GREG-TO-BIN           VALUE '2'.
   631         88  YMD-GREG-TO-BIN            VALUE '3'.
   632         88  MDY-GREG-TO-BIN            VALUE '4'.
   633         88  JULIAN-TO-BIN              VALUE '5'.
   634         88  BIN-PLUS-ELAPSED           VALUE '6'.
   635         88  FIND-CENTURY               VALUE '7'.
   636         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   637         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   638         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   639         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   640         88  JULIAN-TO-BIN-3            VALUE 'C'.
   641         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   642         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   643         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   644         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   645         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   646         88  CHECK-LEAP-YEAR            VALUE 'H'.
   647         88  BIN-3-TO-GREG              VALUE 'I'.
   648         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   649         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   650         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   651         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   652         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   653         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   654         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   655         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   656         88  THREE-CHARACTER-BIN
   657                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   658         88  GREGORIAN-TO-BIN
   659                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   660         88  BIN-TO-GREGORIAN
   661                  VALUES ' ' '1' 'I' '8' 'G'.
   662         88  JULIAN-TO-BINARY
   663                  VALUES '5' 'C' 'E' 'F'.
   664     12  DC-ERROR-CODE                 PIC X.
   665         88  NO-CONVERSION-ERROR        VALUE ' '.
   666         88  DATE-CONVERSION-ERROR
   667                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   668         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  14
* EL1278.cbl
   669         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   670         88  DATE-IS-INVALID            VALUE '3'.
   671         88  DATE1-GREATER-DATE2        VALUE '4'.
   672         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   673         88  DATE-INVALID-OPTION        VALUE '9'.
   674         88  INVALID-CENTURY            VALUE 'A'.
   675         88  ONLY-CENTURY               VALUE 'B'.
   676         88  ONLY-LEAP-YEAR             VALUE 'C'.
   677         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   678     12  DC-END-OF-MONTH               PIC X.
   679         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   680     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   681         88  USE-NORMAL-PROCESS         VALUE ' '.
   682         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   683         88  ADJUST-UP-100-YRS          VALUE '2'.
   684     12  FILLER                        PIC X.
   685     12  DC-CONVERSION-DATES.
   686         16  DC-BIN-DATE-1             PIC XX.
   687         16  DC-BIN-DATE-2             PIC XX.
   688         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   689         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   690                       DC-GREG-DATE-1-EDIT.
   691             20  DC-EDIT1-MONTH        PIC 99.
   692             20  SLASH1-1              PIC X.
   693             20  DC-EDIT1-DAY          PIC 99.
   694             20  SLASH1-2              PIC X.
   695             20  DC-EDIT1-YEAR         PIC 99.
   696         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   697         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   698                     DC-GREG-DATE-2-EDIT.
   699             20  DC-EDIT2-MONTH        PIC 99.
   700             20  SLASH2-1              PIC X.
   701             20  DC-EDIT2-DAY          PIC 99.
   702             20  SLASH2-2              PIC X.
   703             20  DC-EDIT2-YEAR         PIC 99.
   704         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   705         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   706                     DC-GREG-DATE-1-YMD.
   707             20  DC-YMD-YEAR           PIC 99.
   708             20  DC-YMD-MONTH          PIC 99.
   709             20  DC-YMD-DAY            PIC 99.
   710         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   711         16  DC-GREG-DATE-1-MDY-R REDEFINES
   712                      DC-GREG-DATE-1-MDY.
   713             20  DC-MDY-MONTH          PIC 99.
   714             20  DC-MDY-DAY            PIC 99.
   715             20  DC-MDY-YEAR           PIC 99.
   716         16  DC-GREG-DATE-1-ALPHA.
   717             20  DC-ALPHA-MONTH        PIC X(10).
   718             20  DC-ALPHA-DAY          PIC 99.
   719             20  FILLER                PIC XX.
   720             20  DC-ALPHA-CENTURY.
   721                 24 DC-ALPHA-CEN-N     PIC 99.
   722             20  DC-ALPHA-YEAR         PIC 99.
   723         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   724         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   725         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   726         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  15
* EL1278.cbl
   727         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   728                                       PIC 9(05).
   729         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   730             20  DC-JULIAN-YEAR        PIC 99.
   731             20  DC-JULIAN-DAYS        PIC 999.
   732         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   733         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   734         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   735     12  DATE-CONVERSION-VARIBLES.
   736         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   737         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   738             20  FILLER                PIC 9(3).
   739             20  HOLD-CEN-1-CCYY.
   740                 24  HOLD-CEN-1-CC     PIC 99.
   741                 24  HOLD-CEN-1-YY     PIC 99.
   742             20  HOLD-CEN-1-MO         PIC 99.
   743             20  HOLD-CEN-1-DA         PIC 99.
   744         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   745             20  HOLD-CEN-1-R-MO       PIC 99.
   746             20  HOLD-CEN-1-R-DA       PIC 99.
   747             20  HOLD-CEN-1-R-CCYY.
   748                 24  HOLD-CEN-1-R-CC   PIC 99.
   749                 24  HOLD-CEN-1-R-YY   PIC 99.
   750             20  FILLER                PIC 9(3).
   751         16  HOLD-CENTURY-1-X.
   752             20  FILLER                PIC X(3)  VALUE SPACES.
   753             20  HOLD-CEN-1-X-CCYY.
   754                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   755                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   756             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   757             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   758         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   759             20  HOLD-CEN-1-R-X-MO     PIC XX.
   760             20  HOLD-CEN-1-R-X-DA     PIC XX.
   761             20  HOLD-CEN-1-R-X-CCYY.
   762                 24  HOLD-CEN-1-R-X-CC PIC XX.
   763                 24  HOLD-CEN-1-R-X-YY PIC XX.
   764             20  FILLER                PIC XXX.
   765         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   766         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   767         16  DC-JULIAN-DATE-1          PIC 9(07).
   768         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   769             20  DC-JULIAN-1-CCYY.
   770                 24  DC-JULIAN-1-CC    PIC 99.
   771                 24  DC-JULIAN-1-YR    PIC 99.
   772             20  DC-JULIAN-DA-1        PIC 999.
   773         16  DC-JULIAN-DATE-2          PIC 9(07).
   774         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   775             20  DC-JULIAN-2-CCYY.
   776                 24  DC-JULIAN-2-CC    PIC 99.
   777                 24  DC-JULIAN-2-YR    PIC 99.
   778             20  DC-JULIAN-DA-2        PIC 999.
   779         16  DC-GREG-DATE-A-EDIT.
   780             20  DC-EDITA-MONTH        PIC 99.
   781             20  SLASHA-1              PIC X VALUE '/'.
   782             20  DC-EDITA-DAY          PIC 99.
   783             20  SLASHA-2              PIC X VALUE '/'.
   784             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  16
* EL1278.cbl
   785                 24  DC-EDITA-CENT     PIC 99.
   786                 24  DC-EDITA-YEAR     PIC 99.
   787         16  DC-GREG-DATE-B-EDIT.
   788             20  DC-EDITB-MONTH        PIC 99.
   789             20  SLASHB-1              PIC X VALUE '/'.
   790             20  DC-EDITB-DAY          PIC 99.
   791             20  SLASHB-2              PIC X VALUE '/'.
   792             20  DC-EDITB-CCYY.
   793                 24  DC-EDITB-CENT     PIC 99.
   794                 24  DC-EDITB-YEAR     PIC 99.
   795         16  DC-GREG-DATE-CYMD         PIC 9(08).
   796         16  DC-GREG-DATE-CYMD-R REDEFINES
   797                              DC-GREG-DATE-CYMD.
   798             20  DC-CYMD-CEN           PIC 99.
   799             20  DC-CYMD-YEAR          PIC 99.
   800             20  DC-CYMD-MONTH         PIC 99.
   801             20  DC-CYMD-DAY           PIC 99.
   802         16  DC-GREG-DATE-MDCY         PIC 9(08).
   803         16  DC-GREG-DATE-MDCY-R REDEFINES
   804                              DC-GREG-DATE-MDCY.
   805             20  DC-MDCY-MONTH         PIC 99.
   806             20  DC-MDCY-DAY           PIC 99.
   807             20  DC-MDCY-CEN           PIC 99.
   808             20  DC-MDCY-YEAR          PIC 99.
   809    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   810        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   811    12  DC-EL310-DATE                  PIC X(21).
   812    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  17
* EL1278.cbl
   814*                            COPY ELCLOGOF.
   815******************************************************************
   816*                                                                *
   817*                                                                *
   818*                            ELCLOGOF.                           *
   819*                            VMOD=2.001                          *
   820*                                                                *
   821*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   822*                                                                *
   823******************************************************************
   824 01  CLASIC-LOGOFF.
   825     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   826     12  LOGOFF-TEXT.
   827         16  FILLER          PIC X(5)    VALUE SPACES.
   828         16  LOGOFF-MSG.
   829             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   830             20  FILLER      PIC X       VALUE SPACES.
   831             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   832         16  FILLER          PIC X(80)
   833           VALUE '* YOU ARE NOW LOGGED OFF'.
   834         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   835         16  FILLER          PIC X       VALUE QUOTE.
   836         16  LOGOFF-SYS-MSG  PIC X(17)
   837           VALUE 'S CLAS-IC SYSTEM '.
   838     12  TEXT-MESSAGES.
   839         16  UNACCESS-MSG    PIC X(29)
   840             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   841         16  PGMIDERR-MSG    PIC X(17)
   842             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  18
* EL1278.cbl
   844*                            COPY ELCATTR.
   845******************************************************************
   846*                                                                *
   847*                            ELCATTR.                            *
   848*                            VMOD=2.001                          *
   849*                                                                *
   850*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   851*                                                                *
   852*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   853*                                                                *
   854*                   POS 1   P=PROTECTED                          *
   855*                           U=UNPROTECTED                        *
   856*                           S=ASKIP                              *
   857*                   POS 2   A=ALPHA/NUMERIC                      *
   858*                           N=NUMERIC                            *
   859*                   POS 3   N=NORMAL                             *
   860*                           B=BRIGHT                             *
   861*                           D=DARK                               *
   862*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   863*                           OF=MODIFIED DATA TAG OFF             *
   864*                                                                *
   865*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   866******************************************************************
   867 01  ATTRIBUTE-LIST.
   868     12  AL-PABOF            PIC X       VALUE 'Y'.
   869     12  AL-PABON            PIC X       VALUE 'Z'.
   870     12  AL-PADOF            PIC X       VALUE '%'.
   871     12  AL-PADON            PIC X       VALUE '_'.
   872     12  AL-PANOF            PIC X       VALUE '-'.
   873     12  AL-PANON            PIC X       VALUE '/'.
   874     12  AL-SABOF            PIC X       VALUE '8'.
   875     12  AL-SABON            PIC X       VALUE '9'.
   876     12  AL-SADOF            PIC X       VALUE '@'.
   877     12  AL-SADON            PIC X       VALUE QUOTE.
   878     12  AL-SANOF            PIC X       VALUE '0'.
   879     12  AL-SANON            PIC X       VALUE '1'.
   880     12  AL-UABOF            PIC X       VALUE 'H'.
   881     12  AL-UABON            PIC X       VALUE 'I'.
   882     12  AL-UADOF            PIC X       VALUE '<'.
   883     12  AL-UADON            PIC X       VALUE '('.
   884     12  AL-UANOF            PIC X       VALUE ' '.
   885     12  AL-UANON            PIC X       VALUE 'A'.
   886     12  AL-UNBOF            PIC X       VALUE 'Q'.
   887     12  AL-UNBON            PIC X       VALUE 'R'.
   888     12  AL-UNDOF            PIC X       VALUE '*'.
   889     12  AL-UNDON            PIC X       VALUE ')'.
   890     12  AL-UNNOF            PIC X       VALUE '&'.
   891     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  19
* EL1278.cbl
   893*                            COPY ELCEMIB.
   894******************************************************************
   895*                                                                *
   896*                                                                *
   897*                            ELCEMIB.                            *
   898*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   899*                            VMOD=2.005                          *
   900*                                                                *
   901*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   902*                                                                *
   903******************************************************************
   904 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   905     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   906     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   907     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   908     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   909     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   910     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   911     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   912     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   913     12  EMI-SWITCH1             PIC X        VALUE '1'.
   914         88  EMI-NO-ERRORS                    VALUE '1'.
   915         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   916         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   917     12  EMI-SWITCH2             PIC X        VALUE '1'.
   918         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   919     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   920         88  EMI-AREA1-EMPTY                  VALUE '1'.
   921         88  EMI-AREA1-FULL                   VALUE '2'.
   922     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   923         88  EMI-AREA2-EMPTY                  VALUE '1'.
   924         88  EMI-AREA2-FULL                   VALUE '2'.
   925     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   926         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   927         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   928         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   929         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   930         88  EMI-BYPASS-FATALS                VALUE 'X'.
   931     12  EMI-ERROR-LINES.
   932         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   933         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   934         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   935         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   936             20  EMI-ERR-CODES OCCURS 10 TIMES.
   937                 24  EMI-ERR-NUM         PIC X(4).
   938                 24  EMI-FILLER          PIC X.
   939                 24  EMI-SEV             PIC X.
   940                 24  FILLER              PIC X.
   941             20  FILLER                  PIC X(02).
   942     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   943         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   944             20  EMI-ERROR-NUMBER    PIC X(4).
   945             20  EMI-FILL            PIC X.
   946             20  EMI-SEVERITY        PIC X.
   947             20  FILLER              PIC X.
   948             20  EMI-ERROR-TEXT.
   949                 24  EMI-TEXT-VARIABLE   PIC X(10).
   950                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  20
* EL1278.cbl
   951     12  EMI-SEVERITY-SAVE           PIC X.
   952         88  EMI-NOTE                    VALUE 'N'.
   953         88  EMI-WARNING                 VALUE 'W'.
   954         88  EMI-FORCABLE                VALUE 'F'.
   955         88  EMI-FATAL                   VALUE 'X'.
   956     12  EMI-MESSAGE-FLAG            PIC X.
   957         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   958         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   959     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   960     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   961         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   962         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   963         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   964     12  FILLER                      PIC X(137)  VALUE SPACES.
   965     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   966     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   967     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   968     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  21
* EL1278.cbl
   970 01  WS-PASS-631.
   971     12  WS-PASS-WORK-AREA         PIC X(384).
   972     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   973     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   974*        COPY ELC631PI.
   975******************************************************************
   976*                                                                *
   977*                                                                *
   978*                            ELC631PI                            *
   979*                            VMOD=2.012                          *
   980*                                                                *
   981*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   982*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   983*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   984*                                                                *
   985*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   986*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   987*    BETWEEN PROGRAMS.                                           *
   988*                                                                *
   989*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   990*                                                                *
   991*               EL631 - EL6311 - EL6312 - EL6313                 *
   992*                                                                *
   993******************************************************************
   994
   995         16  PI-631-DATA.
   996             20  PI-ERPNDB-KEY.
   997                 24  PI-PB-COMPANY-CD     PIC X.
   998                 24  PI-PB-ENTRY-BATCH    PIC X(6).
   999                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1000                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1001
  1002             20  PI-ERPNDB-ALT-KEY.
  1003                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1004                 24  PI-PB-CARRIER        PIC X.
  1005                 24  PI-PB-GROUPING       PIC X(6).
  1006                 24  PI-PB-STATE          PIC XX.
  1007                 24  PI-PB-ACCOUNT        PIC X(10).
  1008                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1009                 24  PI-PB-CERT-NO.
  1010                     28  PI-PB-CERT-PRIME PIC X(10).
  1011                     28  PI-PB-CERT-SFX   PIC X.
  1012                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1013                 24  PI-PB-RECORD-TYPE    PIC X.
  1014
  1015             20  PI-ERPNDB-CSR-KEY.
  1016                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1017                 24  PI-PB-CSR-ID             PIC X(4).
  1018                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  1019                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1020                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1021
  1022             20  PI-BROWSE-TYPE               PIC X.
  1023                 88  PI-FILE-BROWSE             VALUE ' '.
  1024                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1025                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1026                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1027                 88  PI-CSR-BROWSE              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  22
* EL1278.cbl
  1028
  1029             20  PI-MAINT-FUNCTION            PIC X.
  1030                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1031                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1032                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1033                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1034                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1035                 88  PI-PF5-FUNCTION            VALUE '5'.
  1036                 88  PI-PF6-FUNCTION            VALUE '6'.
  1037
  1038             20  PI-FILE-SWITCHES.
  1039                 24  PI-ALL-ISSUES-SW         PIC X.
  1040                     88  ALL-ISSUES             VALUE 'Y'.
  1041                 24  PI-ALL-CANCELS-SW        PIC X.
  1042                     88  ALL-CANCELS            VALUE 'Y'.
  1043                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1044                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1045                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1046                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1047                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1048                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1049                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1050                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1051                 24  PI-HOLD-REC-SW           PIC X.
  1052                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1053                 24  PI-CHANGE-REC-SW         PIC X.
  1054                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1055                 24  PI-CHK-REQ-REC-SW        PIC X.
  1056                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1057                 24  PI-ISSUE-WARNING-SW      PIC X.
  1058                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1059                 24  PI-CANCEL-WARNING-SW     PIC X.
  1060                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1061             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1062                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1063             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1064                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1065
  1066             20  PI-MAP-NAME                  PIC X(8).
  1067
  1068             20  PI-CURSOR                    PIC S9(4) COMP.
  1069
  1070             20  PI-PREV-ALT-KEY              PIC X(36).
  1071             20  PI-PREV-CSR-KEY              PIC X(15).
  1072             20  PI-PREV-KEY.
  1073                 24  PI-PREV-COMPANY-CD       PIC X.
  1074                 24  PI-PREV-BATCH            PIC X(6).
  1075                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1076                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  1077             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1078             20  PI-BROWSE-SW                 PIC X.
  1079                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1080                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1081             20  PI-SV-CARRIER                PIC X.
  1082             20  PI-SV-GROUPING               PIC X(6).
  1083             20  PI-SV-STATE                  PIC XX.
  1084             20  PI-EDIT-SW                   PIC X.
  1085             20  PI-DISPLAY-SW                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  23
* EL1278.cbl
  1086                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1087                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1088             20  PI-CRITERIA-DATA             PIC X(350).
  1089             20  PI-BMODE                     PIC X.
  1090             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1091             20  PI-BPMTS                     PIC S999     COMP-3.
  1092             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1093             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1094             20  PI-CSR-SESSION-SW            PIC X.
  1095                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1096             20  PI-ERRORS-SW                 PIC X.
  1097                 88  FATAL-ERRORS               VALUE 'X'.
  1098*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1099             20  FILLER                       PIC X(5).
  1100
  1101         16  FILLER                PIC X(94).
  1102
  1103
  1104*                            COPY ELCINTF.
  1105******************************************************************
  1106*                                                                *
  1107*                                                                *
  1108*                            ELCINTF.                            *
  1109*                            VMOD=2.017                          *
  1110*                                                                *
  1111*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1112*                                                                *
  1113*       LENGTH = 1024                                            *
  1114*                                                                *
  1115******************************************************************
  1116*                   C H A N G E   L O G
  1117*
  1118* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1119*-----------------------------------------------------------------
  1120*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1121* EFFECTIVE    NUMBER
  1122*-----------------------------------------------------------------
  1123* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1124******************************************************************
  1125 01  PROGRAM-INTERFACE-BLOCK.
  1126     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1127     12  PI-CALLING-PROGRAM              PIC X(8).
  1128     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1129     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1130     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1131     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1132     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1133     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1134     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1135     12  PI-COMPANY-ID                   PIC XXX.
  1136     12  PI-COMPANY-CD                   PIC X.
  1137
  1138     12  PI-COMPANY-PASSWORD             PIC X(8).
  1139
  1140     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1141
  1142     12  PI-CONTROL-IN-PROGRESS.
  1143         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  24
* EL1278.cbl
  1144         16  PI-GROUPING                 PIC X(6).
  1145         16  PI-STATE                    PIC XX.
  1146         16  PI-ACCOUNT                  PIC X(10).
  1147         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1148                                         PIC X(10).
  1149         16  PI-CLAIM-CERT-GRP.
  1150             20  PI-CLAIM-NO             PIC X(7).
  1151             20  PI-CERT-NO.
  1152                 25  PI-CERT-PRIME       PIC X(10).
  1153                 25  PI-CERT-SFX         PIC X.
  1154             20  PI-CERT-EFF-DT          PIC XX.
  1155         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1156             20  PI-PLAN-CODE            PIC X(2).
  1157             20  PI-REVISION-NUMBER      PIC X(3).
  1158             20  PI-PLAN-EFF-DT          PIC X(2).
  1159             20  PI-PLAN-EXP-DT          PIC X(2).
  1160             20  FILLER                  PIC X(11).
  1161         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1162             20  PI-OE-REFERENCE-1.
  1163                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1164                 25  PI-OE-REF-1-SUFF    PIC XX.
  1165
  1166     12  PI-SESSION-IN-PROGRESS          PIC X.
  1167         88  CLAIM-SESSION                   VALUE '1'.
  1168         88  CREDIT-SESSION                  VALUE '2'.
  1169         88  WARRANTY-SESSION                VALUE '3'.
  1170         88  MORTGAGE-SESSION                VALUE '4'.
  1171         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1172
  1173
  1174*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1175
  1176     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1177     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1178
  1179     12  PI-CREDIT-USER                  PIC X.
  1180         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1181         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1182
  1183     12  PI-CLAIM-USER                   PIC X.
  1184         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1185         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1186
  1187     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1188         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1189         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1190         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1191         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1192         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1193
  1194     12  PI-PROCESSOR-ID                 PIC X(4).
  1195
  1196     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1197
  1198     12  PI-MEMBER-CAPTION               PIC X(10).
  1199
  1200     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1201         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  25
* EL1278.cbl
  1202
  1203     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1204     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1205     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1206     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1207
  1208     12  PI-AH-OVERRIDE-L1               PIC X.
  1209     12  PI-AH-OVERRIDE-L2               PIC XX.
  1210     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1211     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1212
  1213     12  PI-NEW-SYSTEM                   PIC X(2).
  1214
  1215     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1216     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1217         88  PI-USES-PAID-TO                 VALUE '1'.
  1218     12  PI-CRDTCRD-SYSTEM.
  1219         16  PI-CRDTCRD-USER             PIC X.
  1220             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1221             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1222         16  PI-CC-MONTH-END-DT          PIC XX.
  1223     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1224
  1225     12  PI-OE-REFERENCE-2.
  1226         16  PI-OE-REF-2-PRIME           PIC X(10).
  1227         16  PI-OE-REF-2-SUFF            PIC X.
  1228
  1229     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1230
  1231     12  PI-LANGUAGE-TYPE                PIC X.
  1232             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1233             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1234             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1235
  1236     12  PI-POLICY-LINKAGE-IND           PIC X.
  1237         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1238         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1239                                                   LOW-VALUES.
  1240
  1241     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1242     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1243         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1244         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1245
  1246     12  PI-PROCESSOR-CSR-IND            PIC X.
  1247         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1248         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1249
  1250     12  FILLER                          PIC X(3).
  1251
  1252     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1253
  1254     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1255         PI-SYSTEM-LEVEL.
  1256
  1257         16  PI-ENTRY-CODES.
  1258             20  PI-ENTRY-CD-1           PIC X.
  1259             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  26
* EL1278.cbl
  1260
  1261         16  PI-RETURN-CODES.
  1262             20  PI-RETURN-CD-1          PIC X.
  1263             20  PI-RETURN-CD-2          PIC X.
  1264
  1265         16  PI-UPDATE-STATUS-SAVE.
  1266             20  PI-UPDATE-BY            PIC X(4).
  1267             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1268
  1269         16  PI-LOWER-CASE-LETTERS       PIC X.
  1270             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1271
  1272*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1273*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1274*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1275
  1276         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1277             88  ST-ACCNT-CNTL               VALUE ' '.
  1278             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1279             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1280             88  ACCNT-CNTL                  VALUE '3'.
  1281             88  CARR-ACCNT-CNTL             VALUE '4'.
  1282
  1283         16  PI-PROCESSOR-CAP-LIST.
  1284             20  PI-SYSTEM-CONTROLS.
  1285                24 PI-SYSTEM-DISPLAY     PIC X.
  1286                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1287                24 PI-SYSTEM-MODIFY      PIC X.
  1288                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1289             20  FILLER                  PIC XX.
  1290             20  PI-DISPLAY-CAP          PIC X.
  1291                 88  DISPLAY-CAP             VALUE 'Y'.
  1292             20  PI-MODIFY-CAP           PIC X.
  1293                 88  MODIFY-CAP              VALUE 'Y'.
  1294             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1295                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1296             20  PI-FORCE-CAP            PIC X.
  1297                 88  FORCE-CAP               VALUE 'Y'.
  1298
  1299         16  PI-PROGRAM-CONTROLS.
  1300             20  PI-PGM-PRINT-OPT        PIC X.
  1301             20  PI-PGM-FORMAT-OPT       PIC X.
  1302             20  PI-PGM-PROCESS-OPT      PIC X.
  1303             20  PI-PGM-TOTALS-OPT       PIC X.
  1304
  1305         16  PI-HELP-INTERFACE.
  1306             20  PI-LAST-ERROR-NO        PIC X(4).
  1307             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1308
  1309         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1310             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1311
  1312         16  PI-CR-CONTROL-IN-PROGRESS.
  1313             20  PI-CR-CARRIER           PIC X.
  1314             20  PI-CR-GROUPING          PIC X(6).
  1315             20  PI-CR-STATE             PIC XX.
  1316             20  PI-CR-ACCOUNT           PIC X(10).
  1317             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  27
* EL1278.cbl
  1318             20  PI-CR-TYPE              PIC X.
  1319
  1320         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1321
  1322         16  PI-CR-MONTH-END-DT          PIC XX.
  1323
  1324         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1325             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1326             88  PI-ZERO-CARRIER             VALUE '1'.
  1327             88  PI-ZERO-GROUPING            VALUE '2'.
  1328             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1329
  1330         16  PI-CARRIER-SECURITY         PIC X.
  1331             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1332
  1333         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1334             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1335             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1336
  1337         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1338             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1339                                         INDEXED BY PI-ACCESS-NDX
  1340                                         PIC X.
  1341
  1342         16  PI-GA-BILLING-CONTROL       PIC X.
  1343             88  PI-GA-BILLING               VALUE '1'.
  1344
  1345         16  PI-MAIL-PROCESSING          PIC X.
  1346             88  PI-MAIL-YES                 VALUE 'Y'.
  1347
  1348         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1349
  1350         16  PI-AR-SYSTEM.
  1351             20  PI-AR-PROCESSING-CNTL   PIC X.
  1352                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1353             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1354             20  PI-AR-MONTH-END-DT      PIC XX.
  1355
  1356         16  PI-MP-SYSTEM.
  1357             20  PI-MORTGAGE-USER            PIC X.
  1358                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1359                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1360             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1361                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1362                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1363                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1364                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1365                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1366             20  PI-MP-MONTH-END-DT          PIC XX.
  1367             20  PI-MP-REFERENCE-NO.
  1368                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1369                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1370
  1371         16  PI-LABEL-CONTROL            PIC X(01).
  1372             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1373             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1374
  1375         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  28
* EL1278.cbl
  1376             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1377
  1378         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1379             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1380             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1381
  1382         16  FILLER                      PIC X(14).
  1383
  1384     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1385******************************************************************
  1386     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1387         16  FILLER                PIC  X(500).
  1388         16  PI-PEND-SW            PIC  X(01).
  1389         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1390         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1391         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1392         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1393         16  PI-EARNING-METHOD-LF  PIC  X.
  1394         16  PI-EARNING-METHOD-AH  PIC  X.
  1395         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1396         16  PI-LF-REFUND-METH     PIC  X.
  1397         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1398         16  PI-AH-REFUND-METH     PIC  X.
  1399         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1400         16  PI-MODIFY-CERT-CAP    PIC  X.
  1401             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1402         16  PI-CLP-YN             PIC X.
  1403         16  PI-CANCEL-REASON      PIC X.
  1404         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  29
* EL1278.cbl
  1406*                            COPY ELCAID.
  1407******************************************************************
  1408*                                                                *
  1409*                            ELCAID.                             *
  1410*                            VMOD=2.001                          *
  1411*                                                                *
  1412*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1413*                                                                *
  1414*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1415*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1416******************************************************************
  1417
  1418 01  DFHAID.
  1419   02  DFHNULL   PIC  X  VALUE  ' '.
  1420   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1421   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1422   02  DFHPEN    PIC  X  VALUE  '='.
  1423   02  DFHOPID   PIC  X  VALUE  'W'.
  1424   02  DFHPA1    PIC  X  VALUE  '%'.
  1425   02  DFHPA2    PIC  X  VALUE  '>'.
  1426   02  DFHPA3    PIC  X  VALUE  ','.
  1427   02  DFHPF1    PIC  X  VALUE  '1'.
  1428   02  DFHPF2    PIC  X  VALUE  '2'.
  1429   02  DFHPF3    PIC  X  VALUE  '3'.
  1430   02  DFHPF4    PIC  X  VALUE  '4'.
  1431   02  DFHPF5    PIC  X  VALUE  '5'.
  1432   02  DFHPF6    PIC  X  VALUE  '6'.
  1433   02  DFHPF7    PIC  X  VALUE  '7'.
  1434   02  DFHPF8    PIC  X  VALUE  '8'.
  1435   02  DFHPF9    PIC  X  VALUE  '9'.
  1436   02  DFHPF10   PIC  X  VALUE  ':'.
  1437   02  DFHPF11   PIC  X  VALUE  '#'.
  1438   02  DFHPF12   PIC  X  VALUE  '@'.
  1439   02  DFHPF13   PIC  X  VALUE  'A'.
  1440   02  DFHPF14   PIC  X  VALUE  'B'.
  1441   02  DFHPF15   PIC  X  VALUE  'C'.
  1442   02  DFHPF16   PIC  X  VALUE  'D'.
  1443   02  DFHPF17   PIC  X  VALUE  'E'.
  1444   02  DFHPF18   PIC  X  VALUE  'F'.
  1445   02  DFHPF19   PIC  X  VALUE  'G'.
  1446   02  DFHPF20   PIC  X  VALUE  'H'.
  1447   02  DFHPF21   PIC  X  VALUE  'I'.
  1448*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1449   02  DFHPF22   PIC  X  VALUE  '['.
  1450   02  DFHPF23   PIC  X  VALUE  '.'.
  1451   02  DFHPF24   PIC  X  VALUE  '<'.
  1452   02  DFHMSRE   PIC  X  VALUE  'X'.
  1453   02  DFHSTRF   PIC  X  VALUE  'h'.
  1454   02  DFHTRIG   PIC  X  VALUE  '"'.
  1455
  1456 01  FILLER  REDEFINES  DFHAID.
  1457     12  FILLER                  PIC  X(08).
  1458     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  30
* EL1278.cbl
  1460*                            COPY EL1278S.
  1461 01  EL127HI.
  1462     05  FILLER            PIC  X(0012).
  1463*    -------------------------------
  1464     05  HDATEL PIC S9(0004) COMP.
  1465     05  HDATEF PIC  X(0001).
  1466     05  FILLER REDEFINES HDATEF.
  1467         10  HDATEA PIC  X(0001).
  1468     05  HDATEI PIC  X(0008).
  1469*    -------------------------------
  1470     05  HTIMEL PIC S9(0004) COMP.
  1471     05  HTIMEF PIC  X(0001).
  1472     05  FILLER REDEFINES HTIMEF.
  1473         10  HTIMEA PIC  X(0001).
  1474     05  HTIMEI PIC  999V99.
  1475*    -------------------------------
  1476     05  CMPNYIDL PIC S9(0004) COMP.
  1477     05  CMPNYIDF PIC  X(0001).
  1478     05  FILLER REDEFINES CMPNYIDF.
  1479         10  CMPNYIDA PIC  X(0001).
  1480     05  CMPNYIDI PIC  X(0003).
  1481*    -------------------------------
  1482     05  USERIDL PIC S9(0004) COMP.
  1483     05  USERIDF PIC  X(0001).
  1484     05  FILLER REDEFINES USERIDF.
  1485         10  USERIDA PIC  X(0001).
  1486     05  USERIDI PIC  X(0004).
  1487*    -------------------------------
  1488     05  HCARIERL PIC S9(0004) COMP.
  1489     05  HCARIERF PIC  X(0001).
  1490     05  FILLER REDEFINES HCARIERF.
  1491         10  HCARIERA PIC  X(0001).
  1492     05  HCARIERI PIC  X(0001).
  1493*    -------------------------------
  1494     05  HGROUPL PIC S9(0004) COMP.
  1495     05  HGROUPF PIC  X(0001).
  1496     05  FILLER REDEFINES HGROUPF.
  1497         10  HGROUPA PIC  X(0001).
  1498     05  HGROUPI PIC  X(0006).
  1499*    -------------------------------
  1500     05  HSTATEL PIC S9(0004) COMP.
  1501     05  HSTATEF PIC  X(0001).
  1502     05  FILLER REDEFINES HSTATEF.
  1503         10  HSTATEA PIC  X(0001).
  1504     05  HSTATEI PIC  X(0002).
  1505*    -------------------------------
  1506     05  HACCTNOL PIC S9(0004) COMP.
  1507     05  HACCTNOF PIC  X(0001).
  1508     05  FILLER REDEFINES HACCTNOF.
  1509         10  HACCTNOA PIC  X(0001).
  1510     05  HACCTNOI PIC  X(0010).
  1511*    -------------------------------
  1512     05  HEFFDTL PIC S9(0004) COMP.
  1513     05  HEFFDTF PIC  X(0001).
  1514     05  FILLER REDEFINES HEFFDTF.
  1515         10  HEFFDTA PIC  X(0001).
  1516     05  HEFFDTI PIC  X(0008).
  1517*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  31
* EL1278.cbl
  1518     05  HCERTNOL PIC S9(0004) COMP.
  1519     05  HCERTNOF PIC  X(0001).
  1520     05  FILLER REDEFINES HCERTNOF.
  1521         10  HCERTNOA PIC  X(0001).
  1522     05  HCERTNOI PIC  X(0010).
  1523*    -------------------------------
  1524     05  HCRTSFXL PIC S9(0004) COMP.
  1525     05  HCRTSFXF PIC  X(0001).
  1526     05  FILLER REDEFINES HCRTSFXF.
  1527         10  HCRTSFXA PIC  X(0001).
  1528     05  HCRTSFXI PIC  X(0001).
  1529*    -------------------------------
  1530     05  HLNAMEL PIC S9(0004) COMP.
  1531     05  HLNAMEF PIC  X(0001).
  1532     05  FILLER REDEFINES HLNAMEF.
  1533         10  HLNAMEA PIC  X(0001).
  1534     05  HLNAMEI PIC  X(0015).
  1535*    -------------------------------
  1536     05  HFNAMEL PIC S9(0004) COMP.
  1537     05  HFNAMEF PIC  X(0001).
  1538     05  FILLER REDEFINES HFNAMEF.
  1539         10  HFNAMEA PIC  X(0001).
  1540     05  HFNAMEI PIC  X(0010).
  1541*    -------------------------------
  1542     05  HINITL PIC S9(0004) COMP.
  1543     05  HINITF PIC  X(0001).
  1544     05  FILLER REDEFINES HINITF.
  1545         10  HINITA PIC  X(0001).
  1546     05  HINITI PIC  X(0001).
  1547*    -------------------------------
  1548     05  LCLMDTHL PIC S9(0004) COMP.
  1549     05  LCLMDTHF PIC  X(0001).
  1550     05  FILLER REDEFINES LCLMDTHF.
  1551         10  LCLMDTHA PIC  X(0001).
  1552     05  LCLMDTHI PIC  X(0022).
  1553*    -------------------------------
  1554     05  LCLMDTL PIC S9(0004) COMP.
  1555     05  LCLMDTF PIC  X(0001).
  1556     05  FILLER REDEFINES LCLMDTF.
  1557         10  LCLMDTA PIC  X(0001).
  1558     05  LCLMDTI PIC  X(0008).
  1559*    -------------------------------
  1560     05  HPCYNL PIC S9(0004) COMP.
  1561     05  HPCYNF PIC  X(0001).
  1562     05  FILLER REDEFINES HPCYNF.
  1563         10  HPCYNA PIC  X(0001).
  1564     05  HPCYNI PIC  X(0001).
  1565*    -------------------------------
  1566     05  ACLMDTHL PIC S9(0004) COMP.
  1567     05  ACLMDTHF PIC  X(0001).
  1568     05  FILLER REDEFINES ACLMDTHF.
  1569         10  ACLMDTHA PIC  X(0001).
  1570     05  ACLMDTHI PIC  X(0023).
  1571*    -------------------------------
  1572     05  ACLMDTL PIC S9(0004) COMP.
  1573     05  ACLMDTF PIC  X(0001).
  1574     05  FILLER REDEFINES ACLMDTF.
  1575         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  32
* EL1278.cbl
  1576     05  ACLMDTI PIC  X(0008).
  1577*    -------------------------------
  1578     05  PMTHDL PIC S9(0004) COMP.
  1579     05  PMTHDF PIC  X(0001).
  1580     05  FILLER REDEFINES PMTHDF.
  1581         10  PMTHDA PIC  X(0001).
  1582     05  PMTHDI PIC  X(0010).
  1583*    -------------------------------
  1584     05  CNCDTHDL PIC S9(0004) COMP.
  1585     05  CNCDTHDF PIC  X(0001).
  1586     05  FILLER REDEFINES CNCDTHDF.
  1587         10  CNCDTHDA PIC  X(0001).
  1588     05  CNCDTHDI PIC  X(0007).
  1589*    -------------------------------
  1590     05  HLKINDL PIC S9(0004) COMP.
  1591     05  HLKINDF PIC  X(0001).
  1592     05  FILLER REDEFINES HLKINDF.
  1593         10  HLKINDA PIC  X(0001).
  1594     05  HLKINDI PIC  X(0002).
  1595*    -------------------------------
  1596     05  HLCDL PIC S9(0004) COMP.
  1597     05  HLCDF PIC  X(0001).
  1598     05  FILLER REDEFINES HLCDF.
  1599         10  HLCDA PIC  X(0001).
  1600     05  HLCDI PIC  X(0002).
  1601*    -------------------------------
  1602     05  HLEDESCL PIC S9(0004) COMP.
  1603     05  HLEDESCF PIC  X(0001).
  1604     05  FILLER REDEFINES HLEDESCF.
  1605         10  HLEDESCA PIC  X(0001).
  1606     05  HLEDESCI PIC  X(0003).
  1607*    -------------------------------
  1608     05  HLTERML PIC S9(0004) COMP.
  1609     05  HLTERMF PIC  X(0001).
  1610     05  FILLER REDEFINES HLTERMF.
  1611         10  HLTERMA PIC  X(0001).
  1612     05  HLTERMI PIC  9(3).
  1613*    -------------------------------
  1614     05  HLREML PIC S9(0004) COMP.
  1615     05  HLREMF PIC  X(0001).
  1616     05  FILLER REDEFINES HLREMF.
  1617         10  HLREMA PIC  X(0001).
  1618     05  HLREMI PIC  X(0003).
  1619*    -------------------------------
  1620     05  HLPREML PIC S9(0004) COMP.
  1621     05  HLPREMF PIC  X(0001).
  1622     05  FILLER REDEFINES HLPREMF.
  1623         10  HLPREMA PIC  X(0001).
  1624     05  HLPREMI PIC  X(0011).
  1625*    -------------------------------
  1626     05  HLITDRL PIC S9(0004) COMP.
  1627     05  HLITDRF PIC  X(0001).
  1628     05  FILLER REDEFINES HLITDRF.
  1629         10  HLITDRA PIC  X(0001).
  1630     05  HLITDRI PIC  X(0011).
  1631*    -------------------------------
  1632     05  HLREFNDL PIC S9(0004) COMP.
  1633     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  33
* EL1278.cbl
  1634     05  FILLER REDEFINES HLREFNDF.
  1635         10  HLREFNDA PIC  X(0001).
  1636     05  HLREFNDI PIC  X(0011).
  1637*    -------------------------------
  1638     05  HLCANCL PIC S9(0004) COMP.
  1639     05  HLCANCF PIC  X(0001).
  1640     05  FILLER REDEFINES HLCANCF.
  1641         10  HLCANCA PIC  X(0001).
  1642     05  HLCANCI PIC  X(0008).
  1643*    -------------------------------
  1644     05  HLCAL1L PIC S9(0004) COMP.
  1645     05  HLCAL1F PIC  X(0001).
  1646     05  FILLER REDEFINES HLCAL1F.
  1647         10  HLCAL1A PIC  X(0001).
  1648     05  HLCAL1I PIC  X(0001).
  1649*    -------------------------------
  1650     05  HLCALCL PIC S9(0004) COMP.
  1651     05  HLCALCF PIC  X(0001).
  1652     05  FILLER REDEFINES HLCALCF.
  1653         10  HLCALCA PIC  X(0001).
  1654     05  HLCALCI PIC  X(0012).
  1655*    -------------------------------
  1656     05  HAKINDL PIC S9(0004) COMP.
  1657     05  HAKINDF PIC  X(0001).
  1658     05  FILLER REDEFINES HAKINDF.
  1659         10  HAKINDA PIC  X(0001).
  1660     05  HAKINDI PIC  X(0002).
  1661*    -------------------------------
  1662     05  HACDL PIC S9(0004) COMP.
  1663     05  HACDF PIC  X(0001).
  1664     05  FILLER REDEFINES HACDF.
  1665         10  HACDA PIC  X(0001).
  1666     05  HACDI PIC  X(0002).
  1667*    -------------------------------
  1668     05  HAEDESCL PIC S9(0004) COMP.
  1669     05  HAEDESCF PIC  X(0001).
  1670     05  FILLER REDEFINES HAEDESCF.
  1671         10  HAEDESCA PIC  X(0001).
  1672     05  HAEDESCI PIC  X(0003).
  1673*    -------------------------------
  1674     05  HATERML PIC S9(0004) COMP.
  1675     05  HATERMF PIC  X(0001).
  1676     05  FILLER REDEFINES HATERMF.
  1677         10  HATERMA PIC  X(0001).
  1678     05  HATERMI PIC  9(3).
  1679*    -------------------------------
  1680     05  HAREML PIC S9(0004) COMP.
  1681     05  HAREMF PIC  X(0001).
  1682     05  FILLER REDEFINES HAREMF.
  1683         10  HAREMA PIC  X(0001).
  1684     05  HAREMI PIC  X(0003).
  1685*    -------------------------------
  1686     05  HAPREML PIC S9(0004) COMP.
  1687     05  HAPREMF PIC  X(0001).
  1688     05  FILLER REDEFINES HAPREMF.
  1689         10  HAPREMA PIC  X(0001).
  1690     05  HAPREMI PIC  X(0011).
  1691*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  34
* EL1278.cbl
  1692     05  HAITDRL PIC S9(0004) COMP.
  1693     05  HAITDRF PIC  X(0001).
  1694     05  FILLER REDEFINES HAITDRF.
  1695         10  HAITDRA PIC  X(0001).
  1696     05  HAITDRI PIC  X(0011).
  1697*    -------------------------------
  1698     05  HAREFNDL PIC S9(0004) COMP.
  1699     05  HAREFNDF PIC  X(0001).
  1700     05  FILLER REDEFINES HAREFNDF.
  1701         10  HAREFNDA PIC  X(0001).
  1702     05  HAREFNDI PIC  X(0011).
  1703*    -------------------------------
  1704     05  HACANCL PIC S9(0004) COMP.
  1705     05  HACANCF PIC  X(0001).
  1706     05  FILLER REDEFINES HACANCF.
  1707         10  HACANCA PIC  X(0001).
  1708     05  HACANCI PIC  X(0008).
  1709*    -------------------------------
  1710     05  HACAL1L PIC S9(0004) COMP.
  1711     05  HACAL1F PIC  X(0001).
  1712     05  FILLER REDEFINES HACAL1F.
  1713         10  HACAL1A PIC  X(0001).
  1714     05  HACAL1I PIC  X(0001).
  1715*    -------------------------------
  1716     05  HACALCL PIC S9(0004) COMP.
  1717     05  HACALCF PIC  X(0001).
  1718     05  FILLER REDEFINES HACALCF.
  1719         10  HACALCA PIC  X(0001).
  1720     05  HACALCI PIC  X(0012).
  1721*    -------------------------------
  1722     05  TOPREML PIC S9(0004) COMP.
  1723     05  TOPREMF PIC  X(0001).
  1724     05  FILLER REDEFINES TOPREMF.
  1725         10  TOPREMA PIC  X(0001).
  1726     05  TOPREMI PIC  X(0011).
  1727*    -------------------------------
  1728     05  TOITDRL PIC S9(0004) COMP.
  1729     05  TOITDRF PIC  X(0001).
  1730     05  FILLER REDEFINES TOITDRF.
  1731         10  TOITDRA PIC  X(0001).
  1732     05  TOITDRI PIC  X(0011).
  1733*    -------------------------------
  1734     05  TORFNDL PIC S9(0004) COMP.
  1735     05  TORFNDF PIC  X(0001).
  1736     05  FILLER REDEFINES TORFNDF.
  1737         10  TORFNDA PIC  X(0001).
  1738     05  TORFNDI PIC  X(0011).
  1739*    -------------------------------
  1740     05  CANREAHL PIC S9(0004) COMP.
  1741     05  CANREAHF PIC  X(0001).
  1742     05  FILLER REDEFINES CANREAHF.
  1743         10  CANREAHA PIC  X(0001).
  1744     05  CANREAHI PIC  X(0015).
  1745*    -------------------------------
  1746     05  CANREAL PIC S9(0004) COMP.
  1747     05  CANREAF PIC  X(0001).
  1748     05  FILLER REDEFINES CANREAF.
  1749         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  35
* EL1278.cbl
  1750     05  CANREAI PIC  X(0001).
  1751*    -------------------------------
  1752     05  CLPYNHL PIC S9(0004) COMP.
  1753     05  CLPYNHF PIC  X(0001).
  1754     05  FILLER REDEFINES CLPYNHF.
  1755         10  CLPYNHA PIC  X(0001).
  1756     05  CLPYNHI PIC  X(0005).
  1757*    -------------------------------
  1758     05  CLPYNL PIC S9(0004) COMP.
  1759     05  CLPYNF PIC  X(0001).
  1760     05  FILLER REDEFINES CLPYNF.
  1761         10  CLPYNA PIC  X(0001).
  1762     05  CLPYNI PIC  X(0001).
  1763*    -------------------------------
  1764     05  HLREDL PIC S9(0004) COMP.
  1765     05  HLREDF PIC  X(0001).
  1766     05  FILLER REDEFINES HLREDF.
  1767         10  HLREDA PIC  X(0001).
  1768     05  HLREDI PIC  X(0014).
  1769*    -------------------------------
  1770     05  FREMTRML PIC S9(0004) COMP.
  1771     05  FREMTRMF PIC  X(0001).
  1772     05  FILLER REDEFINES FREMTRMF.
  1773         10  FREMTRMA PIC  X(0001).
  1774     05  FREMTRMI PIC  X(0003).
  1775*    -------------------------------
  1776     05  HERMSG1L PIC S9(0004) COMP.
  1777     05  HERMSG1F PIC  X(0001).
  1778     05  FILLER REDEFINES HERMSG1F.
  1779         10  HERMSG1A PIC  X(0001).
  1780     05  HERMSG1I PIC  X(0079).
  1781*    -------------------------------
  1782     05  HERMSG2L PIC S9(0004) COMP.
  1783     05  HERMSG2F PIC  X(0001).
  1784     05  FILLER REDEFINES HERMSG2F.
  1785         10  HERMSG2A PIC  X(0001).
  1786     05  HERMSG2I PIC  X(0079).
  1787*    -------------------------------
  1788     05  HPFKEYL PIC S9(0004) COMP.
  1789     05  HPFKEYF PIC  X(0001).
  1790     05  FILLER REDEFINES HPFKEYF.
  1791         10  HPFKEYA PIC  X(0001).
  1792     05  HPFKEYI PIC  99.
  1793*    -------------------------------
  1794     05  PFKEY11L PIC S9(0004) COMP.
  1795     05  PFKEY11F PIC  X(0001).
  1796     05  FILLER REDEFINES PFKEY11F.
  1797         10  PFKEY11A PIC  X(0001).
  1798     05  PFKEY11I PIC  X(0034).
  1799 01  EL127HO REDEFINES EL127HI.
  1800     05  FILLER            PIC  X(0012).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  HDATEO PIC  X(0008).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  HTIMEO PIC  99.99.
  1807*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  36
* EL1278.cbl
  1808     05  FILLER            PIC  X(0003).
  1809     05  CMPNYIDO PIC  X(0003).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  USERIDO PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  HCARIERO PIC  X(0001).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  HGROUPO PIC  X(0006).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  HSTATEO PIC  X(0002).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  HACCTNOO PIC  X(0010).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  HEFFDTO PIC  X(0008).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  HCERTNOO PIC  X(0010).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  HCRTSFXO PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  HLNAMEO PIC  X(0015).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  HFNAMEO PIC  X(0010).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  HINITO PIC  X(0001).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  LCLMDTHO PIC  X(0022).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  LCLMDTO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  HPCYNO PIC  X(0001).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ACLMDTHO PIC  X(0023).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ACLMDTO PIC  X(0008).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  PMTHDO PIC  X(0010).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  CNCDTHDO PIC  X(0007).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  37
* EL1278.cbl
  1866     05  HLKINDO PIC  X(0002).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  HLCDO PIC  X(0002).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  HLEDESCO PIC  X(0003).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  HLTERMO PIC  ZZ9.
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  HLREMO PIC  ZZ9.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  HLCANCO PIC  X(0008).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  HLCAL1O PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  HLCALCO PIC  X(0012).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  HAKINDO PIC  X(0002).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  HACDO PIC  X(0002).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  HAEDESCO PIC  X(0003).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  HATERMO PIC  ZZ9.
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  HAREMO PIC  ZZ9.
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  38
* EL1278.cbl
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  HACAL1O PIC  X(0001).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  HACALCO PIC  X(0012).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  CANREAHO PIC  X(0015).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  CANREAO PIC  X(0001).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  CLPYNHO PIC  X(0005).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  CLPYNO PIC  X(0001).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  FREMTRMO PIC  ZZ9.
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  HERMSG1O PIC  X(0079).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  HERMSG2O PIC  X(0079).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  HPFKEYO PIC  99.
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  PFKEY11O PIC  X(0034).
  1969*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  39
* EL1278.cbl
  1971*                            COPY ELCCALC.
  1972******************************************************************
  1973*                                                                *
  1974*                           ELCCALC.                            *
  1975*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1976*                            VMOD=2.025                          *
  1977*                                                                *
  1978*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1979*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1980*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1981*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1982*                                                                *
  1983*  PASSED TO ELRTRM                                              *
  1984*  -----------------                                             *
  1985*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1986*  ORIGINAL TERM                                                 *
  1987*  BEGINNING DATE                                                *
  1988*  ENDING DATE                                                   *
  1989*  COMPANY I.D.                                                  *
  1990*  ACCOUNT MASTER USER FIELD                                     *
  1991*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1992*  FREE LOOK DAYS                                                *
  1993*                                                                *
  1994*  RETURNED FROM ELRTRM                                          *
  1995*  ---------------------                                         *
  1996*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1997*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1998*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1999*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2000*----------------------------------------------------------------*
  2001*  PASSED TO ELRAMT                                              *
  2002*  ----------------                                              *
  2003*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2004*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2005*  ORIGINAL AMOUNT                                               *
  2006*  ALTERNATE BENEFIT (BALLON)                                    *
  2007*  A.P.R. - NET PAY ONLY                                         *
  2008*  METHOD
  2009*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2010*  COMPANY I.D.                                                  *
  2011*  BENEFIT TYPE                                                  *
  2012*                                                                *
  2013*  RETURNED FROM ELRAMT                                          *
  2014*  --------------------                                          *
  2015*  REMAINING AMOUNT 1 - CURRENT                                  *
  2016*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2017*  REMAINING AMOUNT FACTOR
  2018*----------------------------------------------------------------*
  2019*  PASSED TO ELRESV                                              *
  2020*  -----------------                                             *
  2021*  CERTIFICATE EFFECTIVE DATE                                    *
  2022*  VALUATION DATE                                                *
  2023*  PAID THRU DATE                                                *
  2024*  BENEFIT                                                       *
  2025*  INCURRED DATE                                                 *
  2026*  REPORTED DATE                                                 *
  2027*  ISSUE AGE                                                     *
  2028*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  40
* EL1278.cbl
  2029*  CDT PERCENT                                                   *
  2030*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2031* *CLAIM TYPE (LIFE, A/H)                                        *
  2032* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2033* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2034*                                                                *
  2035*  RETURNED FROM ELRESV                                          *
  2036*  --------------------                                          *
  2037*  CDT TABLE USED                                                *
  2038*  CDT FACTOR USED                                               *
  2039*  PAY TO CURRENT RESERVE                                        *
  2040*  I.B.N.R. - A/H ONLY                                           *
  2041*  FUTURE (ACCRUED) AH ONLY                                      *
  2042*----------------------------------------------------------------*
  2043*  PASSED TO ELRATE                                              *
  2044*  ----------------                                              *
  2045*  CERT ISSUE DATE                                               *
  2046*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2047*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2048*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2049*  STATE CODE (CLIENT DEFINED)                                   *
  2050*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2051*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2052*  DEVIATION CODE                                                *
  2053*  ISSUE AGE                                                     *
  2054*  ORIGINAL BENEFIT AMOUNT                                       *
  2055*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2056*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2057*  BENEFIT KIND (LIFE OR A/H)                                    *
  2058*  A.P.R.                                                        *
  2059*  METHOD
  2060*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2061*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2062*  COMPANY I.D. (3 CHARACTER)                                    *
  2063*  BENEFIT CODE                                                  *
  2064*  BENEFIT OVERRIDE CODE                                         *
  2065*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2066*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2067*  JOINT INDICATOR (CSL ONLY)                                    *
  2068*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2069*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2070*                                                                *
  2071*  RETURNED FROM ELRATE                                          *
  2072*  --------------------                                          *
  2073*  CALCULATED PREMIUM                                            *
  2074*  PREMIUM RATE                                                  *
  2075*  MORTALITY CODE                                                *
  2076*  MAX ATTAINED AGE                                              *
  2077*  MAX AGE                                                       *
  2078*  MAX TERM                                                      *
  2079*  MAX MONTHLY BENEFIT                                           *
  2080*  MAX TOTAL BENIFIT                                             *
  2081*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2082*----------------------------------------------------------------*
  2083*  PASSED TO ELRFND                                              *
  2084*  ----------------                                              *
  2085*  CERT ISSUE DATE                                               *
  2086*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  41
* EL1278.cbl
  2087*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2088*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2089*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2090*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2091*  STATE CODE (CLIENT DEFINED)                                   *
  2092*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2093*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2094*  DEVIATION CODE                                                *
  2095*  ISSUE AGE                                                     *
  2096*  ORIGINAL BENEFIT AMOUNT                                       *
  2097*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2098*  PROCESS TYPE (CANCEL)                                         *
  2099*  BENEFIT KIND (LIFE OR A/H)                                    *
  2100*  A.P.R.                                                        *
  2101*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2102*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2103*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2104*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2105*  COMPANY I.D. (3 CHARACTER)                                    *
  2106*  BENEFIT CODE                                                  *
  2107*  BENEFIT OVERRIDE CODE                                         *
  2108*                                                                *
  2109*  RETURNED FROM ELRFND                                          *
  2110*  --------------------                                          *
  2111*  CALCULATED REFUND                                             *
  2112*----------------------------------------------------------------*
  2113*  PASSED TO ELEARN                                              *
  2114*  ----------------                                              *
  2115*  CERT ISSUE DATE                                               *
  2116*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2117*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2118*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2119*  STATE CODE (CLIENT DEFINED)                                   *
  2120*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2121*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2122*  DEVIATION CODE                                                *
  2123*  ISSUE AGE                                                     *
  2124*  ORIGINAL BENEFIT AMOUNT                                       *
  2125*  BENEFIT KIND (LIFE OR A/H)                                    *
  2126*  A.P.R.                                                        *
  2127*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2128*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2129*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2130*  COMPANY I.D. (3 CHARACTER)                                    *
  2131*  BENEFIT CODE                                                  *
  2132*  BENEFIT OVERRIDE CODE                                         *
  2133*                                                                *
  2134*  RETURNED FROM ELEARN                                          *
  2135*  --------------------                                          *
  2136*  INDICATED  EARNINGS                                           *
  2137*----------------------------------------------------------------*
  2138*                 LENGTH = 450                                   *
  2139*                                                                *
  2140******************************************************************
  2141******************************************************************
  2142*                   C H A N G E   L O G
  2143*
  2144* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  42
* EL1278.cbl
  2145*-----------------------------------------------------------------
  2146*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2147* EFFECTIVE    NUMBER
  2148*-----------------------------------------------------------------
  2149* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2150* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2151* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2152* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2153* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2154* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2155* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2156* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2157* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2158******************************************************************
  2159
  2160 01  CALCULATION-PASS-AREA.
  2161     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2162                                     COMP.
  2163
  2164     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2165       88  NO-CP-ERROR                             VALUE ZERO.
  2166       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2167                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2168       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2169       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2170       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2171       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2172       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2173       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2174       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2175       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2176       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2177       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2178       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2179       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2180       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2181       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2182       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2183       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2184       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2185
  2186     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2187       88  NO-CP-ERROR-2                           VALUE ZERO.
  2188***********************  INPUT AREAS ****************************
  2189
  2190     12  CP-CALCULATION-AREA.
  2191         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2192         16  CP-CERT-EFF-DT        PIC XX.
  2193         16  CP-VALUATION-DT       PIC XX.
  2194         16  CP-PAID-THRU-DT       PIC XX.
  2195         16  CP-BENEFIT-TYPE       PIC X.
  2196           88  CP-AH                               VALUE 'A' 'D'
  2197                                                   'I' 'U'.
  2198           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2199           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2200         16  CP-INCURRED-DT        PIC XX.
  2201         16  CP-REPORTED-DT        PIC XX.
  2202         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  43
* EL1278.cbl
  2203         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2204         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2205                                     COMP-3.
  2206         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2207                                     COMP-3.
  2208         16  CP-CDT-METHOD         PIC X.
  2209           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2210           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2211           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2212         16  CP-CLAIM-TYPE         PIC X.
  2213           88  CP-AH-CLAIM                         VALUE 'A'.
  2214           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2215         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2216                                     COMP-3.
  2217         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2218                                     COMP-3.
  2219         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2220                                     COMP-3.
  2221         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2222                                     COMP-3.
  2223         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2224                                     COMP-3.
  2225         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2226                                     COMP-3.
  2227         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2228                                     COMP-3.
  2229         16  CP-REM-TERM-METHOD    PIC X.
  2230           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2231           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2232           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2233           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2234           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2235           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2236           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2237         16  CP-EARNING-METHOD     PIC X.
  2238           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2239           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2240           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2241           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2242           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2243           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2244           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2245           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2246           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2247           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2248           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2249           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2250           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2251           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2252         16  CP-PROCESS-TYPE       PIC X.
  2253           88  CP-CLAIM                            VALUE '1'.
  2254           88  CP-CANCEL                           VALUE '2'.
  2255           88  CP-ISSUE                            VALUE '3'.
  2256         16  CP-SPECIAL-CALC-CD    PIC X.
  2257           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2258           88  CP-1-MTH-INTEREST               VALUE ' '.
  2259           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2260           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  44
* EL1278.cbl
  2261           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2262           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2263           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2264           88  CP-FARM-PLAN                    VALUE 'F'.
  2265           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2266           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2267           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2268           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2269           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2270           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2271           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2272           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2273           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2274           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2275                                                     'W' 'X'.
  2276           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2277           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2278           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2279           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2280           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2281           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2282           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2283           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2284           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2285           88  CP-CSL-METH-1                   VALUE '5'.
  2286           88  CP-CSL-METH-2                   VALUE '6'.
  2287           88  CP-CSL-METH-3                   VALUE '7'.
  2288           88  CP-CSL-METH-4                   VALUE '8'.
  2289
  2290         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2291                                     COMP-3.
  2292         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2293         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2294         16  CP-STATE              PIC XX          VALUE SPACE.
  2295         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2296         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2297           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2298               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2299         16  CP-R78-OPTION         PIC X.
  2300           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2301           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2302
  2303         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2304         16  CP-IBNR-RESERVE-SW    PIC X.
  2305         16  CP-CLAIM-STATUS       PIC X.
  2306         16  CP-RATE-FILE          PIC X.
  2307         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2308                                     COMP-3.
  2309
  2310         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2311         16  CP-AH-OVERRIDE-CODE   PIC X.
  2312
  2313         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2314                                     COMP-3.
  2315         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2316                                   PIC S9(5)V99 COMP-3.
  2317         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2318                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  45
* EL1278.cbl
  2319         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2320                                     COMP-3.
  2321         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2322                                     COMP-3.
  2323         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2324                                  PIC S9(7)V99 COMP-3.
  2325
  2326         16  CP-PAID-FROM-DATE     PIC X(02).
  2327         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2328         16  CP-EXT-DAYS-CALC      PIC X.
  2329           88  CP-EXT-NO-CHG                   VALUE ' '.
  2330           88  CP-EXT-CHG-LF                   VALUE '1'.
  2331           88  CP-EXT-CHG-AH                   VALUE '2'.
  2332           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2333         16  CP-DOMICILE-STATE     PIC XX.
  2334         16  CP-CARRIER            PIC X.
  2335         16  CP-REIN-FLAG          PIC X.
  2336         16  CP-REM-TRM-CALC-OPTION PIC X.
  2337           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2338                      '2' '3' '4' '5'.
  2339           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2340           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2341           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2342           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2343           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2344           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2345           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2346           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2347         16  CP-SIG-SWITCH         PIC X.
  2348         16  CP-RATING-METHOD      PIC X.
  2349           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2350           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2351           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2352           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2353           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2354           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2355           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2356           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2357           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2358         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2359                                     COMP-3.
  2360         16  CP-BEN-CATEGORY       PIC X.
  2361         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2362         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2363                                   PIC S99V9(5) COMP-3.
  2364         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2365         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2366                                   PIC S99V9(5) COMP-3.
  2367         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2368         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2369         16  CP-EXPIRE-DT          PIC XX.
  2370         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2371         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2372         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2373         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2374         16  CP-DDF-SPEC-CALC      PIC X.
  2375             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2376             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  46
* EL1278.cbl
  2377         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2378         16  CP-CANCEL-REASON      PIC X.
  2379         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2380         16  CP-PMT-MODE           PIC X.
  2381         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2382         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2383         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2384         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2385         16  FILLER                PIC X.
  2386
  2387***************    OUTPUT FROM ELRESV   ************************
  2388
  2389         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2390
  2391         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2392                                     COMP-3.
  2393         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2394                                     COMP-3.
  2395         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2396                                     COMP-3.
  2397         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2398                                     COMP-3.
  2399         16  FILLER                PIC X(09).
  2400***************    OUTPUT FROM ELRTRM   *************************
  2401
  2402         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2403                                     COMP-3.
  2404         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2405                                     COMP-3.
  2406         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2407                                     COMP-3.
  2408         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2409                                     COMP-3.
  2410         16  FILLER                PIC X(12).
  2411
  2412***************    OUTPUT FROM ELRAMT   *************************
  2413
  2414         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2415                                     COMP-3.
  2416         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2417                                     COMP-3.
  2418         16  FILLER                PIC X(12).
  2419
  2420***************    OUTPUT FROM ELRATE   *************************
  2421
  2422         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2423                                     COMP-3.
  2424         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2425                                     COMP-3.
  2426         16  CP-MORTALITY-CODE     PIC X(4).
  2427         16  CP-RATE-EDIT-FLAG     PIC X.
  2428             88  CP-RATES-NEED-APR                  VALUE '1'.
  2429         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2430                                     COMP-3.
  2431         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2432         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2433         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2434                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  47
* EL1278.cbl
  2435         16  FILLER                PIC X(07).
  2436
  2437***************    OUTPUT FROM ELRFND   *************************
  2438
  2439         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2440                                     COMP-3.
  2441         16  CP-REFUND-TYPE-USED   PIC X.
  2442           88  CP-R-AS-R78                         VALUE '1'.
  2443           88  CP-R-AS-PRORATA                     VALUE '2'.
  2444           88  CP-R-AS-CALIF                       VALUE '3'.
  2445           88  CP-R-AS-TEXAS                       VALUE '4'.
  2446           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2447           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2448           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2449           88  CP-R-AS-MEAN                        VALUE '8'.
  2450           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2451           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2452           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2453           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2454           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2455           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2456         16  FILLER                PIC X(12).
  2457
  2458***************    OUTPUT FROM ELEARN   *************************
  2459
  2460         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2461                                     COMP-3.
  2462         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2463                                     COMP-3.
  2464         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2465                                     COMP-3.
  2466         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2467                                     COMP-3.
  2468         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2469                                     COMP-3.
  2470         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2471                                     COMP-3.
  2472         16  CP-EARNING-TYPE-USED  PIC X.
  2473           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2474           88  CP-E-AS-R78                         VALUE '1'.
  2475           88  CP-E-AS-PRORATA                     VALUE '2'.
  2476           88  CP-E-AS-TEXAS                       VALUE '4'.
  2477           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2478           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2479           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2480           88  CP-E-AS-MEAN                        VALUE '8'.
  2481           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2482         16  FILLER                PIC X(12).
  2483
  2484***************    OUTPUT FROM ELPMNT   *************************
  2485
  2486         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2487                                     COMP-3.
  2488         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2489                                     COMP-3.
  2490         16  FILLER                PIC X(12).
  2491
  2492***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  48
* EL1278.cbl
  2493         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2494                                     COMP-3.
  2495         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2496                                     COMP-3.
  2497         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2498                                     COMP-3.
  2499         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2500                                     COMP-3.
  2501         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2502                                     COMP-3.
  2503         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2504                                     COMP-3.
  2505         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2506             88  OPEN-RATE-FILE                   VALUE 'O'.
  2507             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2508             88  IO-ERROR                         VALUE 'E'.
  2509
  2510         16  CP-FIRST-PAY-DATE     PIC XX.
  2511
  2512         16  CP-JOINT-INDICATOR    PIC X.
  2513
  2514         16  CP-RESERVE-REMAINING-TERM
  2515                                   PIC S9(4)V9    VALUE ZERO
  2516                                     COMP-3.
  2517
  2518         16  CP-INSURED-BIRTH-DT   PIC XX.
  2519
  2520         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2521                                     COMP-3.
  2522
  2523         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2524                                     COMP-3.
  2525
  2526         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2527                                     COMP-3.
  2528
  2529         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2530                                     COMP-3.
  2531
  2532         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2533                                     COMP-3.
  2534
  2535         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2536                                     COMP-3.
  2537
  2538         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2539                                     COMP-3.
  2540
  2541         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2542             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2543
  2544         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2545                                     COMP-3.
  2546         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2547                                     COMP-3.
  2548         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2549         16  FILLER                PIC X(15).
  2550******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  49
* EL1278.cbl
  2552*                            COPY ERCNOTE.
  2553******************************************************************
  2554*                                                                *
  2555*                                                                *
  2556*                            ERCNOTE                             *
  2557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2558*                            VMOD=2.003                          *
  2559*                                                                *
  2560*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2561*                                                                *
  2562*        FILE TYPE= VSAM,KSDS                                    *
  2563*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2564*                                                                *
  2565*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2566*                                                                *
  2567*        LOG = YES                                               *
  2568*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2569*                                                                *
  2570******************************************************************
  2571*                   C H A N G E   L O G
  2572*
  2573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2574*-----------------------------------------------------------------
  2575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2576* EFFECTIVE    NUMBER
  2577*-----------------------------------------------------------------
  2578* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2579*                                FILE WILL CONTAIN BILLING NOTES O
  2580******************************************************************
  2581
  2582 01  CERTIFICATE-NOTE.
  2583     12  CN-RECORD-ID                PIC  XX.
  2584         88  VALID-CN-ID                  VALUE 'CN'.
  2585
  2586     12  CN-CONTROL-PRIMARY.
  2587         16  CN-COMPANY-CD           PIC X.
  2588         16  CN-CARRIER              PIC X.
  2589         16  CN-GROUPING.
  2590             20 CN-GROUPING-PREFIX   PIC XXX.
  2591             20 CN-GROUPING-PRIME    PIC XXX.
  2592         16  CN-STATE                PIC XX.
  2593         16  CN-ACCOUNT.
  2594             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2595             20 CN-ACCOUNT-PRIME     PIC X(6).
  2596         16  CN-CERT-EFF-DT          PIC XX.
  2597         16  CN-CERT-NO.
  2598             20  CN-CERT-PRIME       PIC X(10).
  2599             20  CN-CERT-SFX         PIC X.
  2600
  2601     12  CN-BILLING-START-LINE-NO    PIC 99.
  2602     12  CN-BILLING-END-LINE-NO      PIC 99.
  2603
  2604     12  CN-LINES.
  2605         16  CN-LINE OCCURS 10       PIC X(77).
  2606
  2607     12  CN-LAST-MAINT-DT            PIC XX.
  2608     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2609     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  50
* EL1278.cbl
  2610     12  FILLER                      PIC X(6).
  2611******************************************************************
  2612*                            COPY ERCCTBL.
  2613******************************************************************
  2614*                                                                *
  2615*                                                                *
  2616*                            ERCCTBL                             *
  2617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2618*                            VMOD=2.003
  2619*                                                                *
  2620*   ONLINE CREDIT SYSTEM                                         *
  2621*                                                                *
  2622*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2623*                                                                *
  2624*   FILE TYPE = VSAM,KSDS                                        *
  2625*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2626*                                                                *
  2627*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2628*       ALTERNATE PATH = NONE                                    *
  2629*                                                                *
  2630*   LOG = NO                                                     *
  2631*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2632*                                                                *
  2633*                                                                *
  2634******************************************************************
  2635
  2636 01  COMM-TABLE-RECORD.
  2637     12  CT-RECORD-ID                      PIC XX.
  2638         88  VALID-CT-ID                      VALUE 'CT'.
  2639
  2640     12  CT-CONTROL-PRIMARY.
  2641         16  CT-COMPANY-CD                 PIC X.
  2642         16  CT-TABLE                      PIC XXX.
  2643         16  CT-CNTRL-2.
  2644             20  CT-BEN-TYPE               PIC X.
  2645             20  CT-BEN-CODE               PIC XX.
  2646
  2647     12  CT-MAINT-INFORMATION.
  2648         16  CT-LAST-MAINT-DT              PIC XX.
  2649         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2650         16  CT-LAST-MAINT-USER            PIC X(4).
  2651         16  FILLER                        PIC X(31).
  2652
  2653     12  CT-LIMITS.
  2654         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2655
  2656         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2657
  2658         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2659
  2660     12  CT-RATES.
  2661         16  CT-RTX          OCCURS 27 TIMES.
  2662             20  CT-RT                     PIC SV9(5)     COMP-3.
  2663             20  CT-RT-R   REDEFINES
  2664                 CT-RT                     PIC XXX.
  2665
  2666     12  FILLER                            PIC  X(42).
  2667
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  51
* EL1278.cbl
  2668******************************************************************
  2669
  2670****************************************************************
  2671*
  2672* Copyright (c) 2007 by Clerity Solutions, Inc.
  2673* All rights reserved.
  2674*
  2675****************************************************************
  2676 01  DFHEIV.
  2677   02  DFHEIV0               PIC X(35).
  2678   02  DFHEIV1               PIC X(08).
  2679   02  DFHEIV2               PIC X(08).
  2680   02  DFHEIV3               PIC X(08).
  2681   02  DFHEIV4               PIC X(06).
  2682   02  DFHEIV5               PIC X(04).
  2683   02  DFHEIV6               PIC X(04).
  2684   02  DFHEIV7               PIC X(02).
  2685   02  DFHEIV8               PIC X(02).
  2686   02  DFHEIV9               PIC X(01).
  2687   02  DFHEIV10              PIC S9(7) COMP-3.
  2688   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2689   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2690   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2691   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2692   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2693   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2694   02  DFHEIV17              PIC X(04).
  2695   02  DFHEIV18              PIC X(04).
  2696   02  DFHEIV19              PIC X(04).
  2697   02  DFHEIV20              USAGE IS POINTER.
  2698   02  DFHEIV21              USAGE IS POINTER.
  2699   02  DFHEIV22              USAGE IS POINTER.
  2700   02  DFHEIV23              USAGE IS POINTER.
  2701   02  DFHEIV24              USAGE IS POINTER.
  2702   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2703   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2704   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2705   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2706   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2707   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2708   02  FILLER                PIC X(02).
  2709   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2710   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2711   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2712   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2713   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2714 LINKAGE  SECTION.
  2715*****************************************************************
  2716*                                                               *
  2717* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2718* All rights reserved.                                          *
  2719*                                                               *
  2720*****************************************************************
  2721 01  dfheiblk.
  2722     02  eibtime          pic s9(7) comp-3.
  2723     02  eibdate          pic s9(7) comp-3.
  2724     02  eibtrnid         pic x(4).
  2725     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  52
* EL1278.cbl
  2726     02  eibtrmid         pic x(4).
  2727     02  dfheigdi         pic s9(4) comp.
  2728     02  eibcposn         pic s9(4) comp.
  2729     02  eibcalen         pic s9(4) comp.
  2730     02  eibaid           pic x(1).
  2731     02  eibfiller1       pic x(1).
  2732     02  eibfn            pic x(2).
  2733     02  eibfiller2       pic x(2).
  2734     02  eibrcode         pic x(6).
  2735     02  eibfiller3       pic x(2).
  2736     02  eibds            pic x(8).
  2737     02  eibreqid         pic x(8).
  2738     02  eibrsrce         pic x(8).
  2739     02  eibsync          pic x(1).
  2740     02  eibfree          pic x(1).
  2741     02  eibrecv          pic x(1).
  2742     02  eibsend          pic x(1).
  2743     02  eibatt           pic x(1).
  2744     02  eibeoc           pic x(1).
  2745     02  eibfmh           pic x(1).
  2746     02  eibcompl         pic x(1).
  2747     02  eibsig           pic x(1).
  2748     02  eibconf          pic x(1).
  2749     02  eiberr           pic x(1).
  2750     02  eibrldbk         pic x(1).
  2751     02  eiberrcd         pic x(4).
  2752     02  eibsynrb         pic x(1).
  2753     02  eibnodat         pic x(1).
  2754     02  eibfiller5       pic x(2).
  2755     02  eibresp          pic 9(09) comp.
  2756     02  eibresp2         pic 9(09) comp.
  2757     02  dfheigdj         pic s9(4) comp.
  2758     02  dfheigdk         pic s9(4) comp.
  2759
  2760 01  DFHCOMMAREA                 PIC  X(1024).
  2761
  2762*01 PARMLIST .
  2763*    12  FILLER                  PIC S9(08)      COMP.
  2764*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2765*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2766*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2767*                            COPY ELCCNTL.
  2768******************************************************************
  2769*                                                                *
  2770*                                                                *
  2771*                            ELCCNTL.                            *
  2772*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2773*                            VMOD=2.059                          *
  2774*                                                                *
  2775*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2776*                                                                *
  2777*   FILE TYPE = VSAM,KSDS                                        *
  2778*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2779*                                                                *
  2780*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2781*       ALTERNATE INDEX = NONE                                   *
  2782*                                                                *
  2783*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  53
* EL1278.cbl
  2784*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2785******************************************************************
  2786*                   C H A N G E   L O G
  2787*
  2788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2789*-----------------------------------------------------------------
  2790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2791* EFFECTIVE    NUMBER
  2792*-----------------------------------------------------------------
  2793* 082503                   PEMA  ADD BENEFIT GROUP
  2794* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2795* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2796* 092705    2005050300006  PEMA  ADD SPP LEASES
  2797* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2798* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2799* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2800* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2801* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2802* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2803******************************************************************
  2804*
  2805 01  CONTROL-FILE.
  2806     12  CF-RECORD-ID                       PIC XX.
  2807         88  VALID-CF-ID                        VALUE 'CF'.
  2808
  2809     12  CF-CONTROL-PRIMARY.
  2810         16  CF-COMPANY-ID                  PIC XXX.
  2811         16  CF-RECORD-TYPE                 PIC X.
  2812             88  CF-COMPANY-MASTER              VALUE '1'.
  2813             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2814             88  CF-STATE-MASTER                VALUE '3'.
  2815             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2816             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2817             88  CF-CARRIER-MASTER              VALUE '6'.
  2818             88  CF-MORTALITY-MASTER            VALUE '7'.
  2819             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2820             88  CF-TERMINAL-MASTER             VALUE '9'.
  2821             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2822             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2823             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2824             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2825             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2826             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2827             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2828             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2829             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2830         16  CF-ACCESS-CD-GENL              PIC X(4).
  2831         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2832             20  CF-PROCESSOR               PIC X(4).
  2833         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2834             20  CF-STATE-CODE              PIC XX.
  2835             20  FILLER                     PIC XX.
  2836         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2837             20  FILLER                     PIC XX.
  2838             20  CF-HI-BEN-IN-REC           PIC XX.
  2839         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2840             20  FILLER                     PIC XXX.
  2841             20  CF-CARRIER-CNTL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  54
* EL1278.cbl
  2842         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2843             20  FILLER                     PIC XX.
  2844             20  CF-HI-TYPE-IN-REC          PIC 99.
  2845         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2846             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2847                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2848             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2849             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2850         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2851             20  FILLER                     PIC X.
  2852             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2853         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2854             20  FILLER                     PIC XX.
  2855             20  CF-MORTGAGE-PLAN           PIC XX.
  2856         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2857
  2858     12  CF-LAST-MAINT-DT                   PIC XX.
  2859     12  CF-LAST-MAINT-BY                   PIC X(4).
  2860     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2861
  2862     12  CF-RECORD-BODY                     PIC X(728).
  2863
  2864
  2865****************************************************************
  2866*             COMPANY MASTER RECORD                            *
  2867****************************************************************
  2868
  2869     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2870         16  CF-COMPANY-ADDRESS.
  2871             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2872             20  CF-CL-IN-CARE-OF           PIC X(30).
  2873             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2874             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2875             20  CF-CL-CITY-STATE           PIC X(30).
  2876             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2877             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2878         16  CF-COMPANY-CD                  PIC X.
  2879         16  CF-COMPANY-PASSWORD            PIC X(8).
  2880         16  CF-SECURITY-OPTION             PIC X.
  2881             88  ALL-SECURITY                   VALUE '1'.
  2882             88  COMPANY-VERIFY                 VALUE '2'.
  2883             88  PROCESSOR-VERIFY               VALUE '3'.
  2884             88  NO-SECURITY                    VALUE '4'.
  2885             88  ALL-BUT-TERM                   VALUE '5'.
  2886         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2887             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2888         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2889             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2890         16  CF-INFORCE-LOCATION            PIC X.
  2891             88  CERTS-ARE-ONLINE               VALUE '1'.
  2892             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2893             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2894         16  CF-LOWER-CASE-LETTERS          PIC X.
  2895         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2896             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2897             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2898             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2899             88  CF-ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  55
* EL1278.cbl
  2900             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2901
  2902         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2903         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2904
  2905         16  CF-LGX-CREDIT-USER             PIC X.
  2906             88  CO-IS-NOT-USER                 VALUE 'N'.
  2907             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2908
  2909         16 CF-CREDIT-CALC-CODES.
  2910             20  CF-CR-REM-TERM-CALC PIC X.
  2911               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2912               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2913               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2914               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2915               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2916               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2917               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2918             20  CF-CR-R78-METHOD           PIC X.
  2919               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2920               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2921
  2922         16  CF-CLAIM-CONTROL-COUNTS.
  2923             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2924                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2925
  2926             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2927                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2928
  2929             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2930                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2931
  2932             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2933                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2934
  2935         16  CF-CURRENT-MONTH-END           PIC XX.
  2936
  2937         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2938             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2939             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2940             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2941             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2942                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2943                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2944             20  CF-CO-PREM-REJECT-SW       PIC X.
  2945                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2946                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2947             20  CF-CO-REF-REJECT-SW        PIC X.
  2948                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2949                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2950
  2951         16  CF-CO-REPORTING-DT             PIC XX.
  2952         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2953         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2954           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2955           88  CF-CO-MONTH-END                  VALUE '1'.
  2956
  2957         16  CF-LGX-CLAIM-USER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  56
* EL1278.cbl
  2958             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2959             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2960
  2961         16  CF-CREDIT-EDIT-CONTROLS.
  2962             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2963             20  CF-MIN-AGE                 PIC 99.
  2964             20  CF-DEFAULT-AGE             PIC 99.
  2965             20  CF-MIN-TERM                PIC S999      COMP-3.
  2966             20  CF-MAX-TERM                PIC S999      COMP-3.
  2967             20  CF-DEFAULT-SEX             PIC X.
  2968             20  CF-JOINT-AGE-INPUT         PIC X.
  2969                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2970             20  CF-BIRTH-DATE-INPUT        PIC X.
  2971                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2972             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2973                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2974                 88  CF-ZERO-CARRIER            VALUE '1'.
  2975                 88  CF-ZERO-GROUPING           VALUE '2'.
  2976                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2977             20  CF-EDIT-SW                 PIC X.
  2978                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2979             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2980             20  CF-CR-PR-METHOD            PIC X.
  2981               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2982               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2983             20  FILLER                     PIC X.
  2984
  2985         16  CF-CREDIT-MISC-CONTROLS.
  2986             20  CF-REIN-TABLE-SW           PIC X.
  2987                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2988             20  CF-COMP-TABLE-SW           PIC X.
  2989                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2990             20  CF-EXPERIENCE-RETENTION-AGE
  2991                                            PIC S9        COMP-3.
  2992             20  CF-CONVERSION-DT           PIC XX.
  2993             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2994             20  CF-RUN-FREQUENCY-SW        PIC X.
  2995                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2996                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2997
  2998             20  CF-CR-CHECK-NO-CONTROL.
  2999                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3000                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3001                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3002                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3003                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3004                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3005
  3006                 24  CF-CR-CHECK-COUNT       REDEFINES
  3007                     CF-CR-CHECK-COUNTER      PIC X(4).
  3008
  3009                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3010                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3011
  3012                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3013                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3014                 24  CF-MAIL-PROCESSING       PIC X.
  3015                     88  MAIL-PROCESSING          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  57
* EL1278.cbl
  3016
  3017         16  CF-MISC-SYSTEM-CONTROL.
  3018             20  CF-SYSTEM-C                 PIC X.
  3019                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3020             20  CF-SYSTEM-D                 PIC X.
  3021                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3022             20  CF-SOC-SEC-NO-SW            PIC X.
  3023                 88  SOC-SEC-NO-USED             VALUE '1'.
  3024             20  CF-MEMBER-NO-SW             PIC X.
  3025                 88  MEMBER-NO-USED              VALUE '1'.
  3026             20  CF-TAX-ID-NUMBER            PIC X(11).
  3027             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3028             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3029                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3030                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3031                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3032                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3033             20  CF-SYSTEM-E                 PIC X.
  3034                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3035
  3036         16  CF-LGX-LIFE-USER               PIC X.
  3037             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3038             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3039
  3040         16  CF-CR-MONTH-END-DT             PIC XX.
  3041
  3042         16  CF-FILE-MAINT-DATES.
  3043             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3044                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3045             20  CF-LAST-BATCH       REDEFINES
  3046                 CF-LAST-BATCH-NO               PIC X(4).
  3047             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3048             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3049             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3050             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3051             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3052             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3053             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3054             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3055             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3056             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3057
  3058         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3059         16  FILLER                         PIC X.
  3060
  3061         16  CF-ALT-MORT-CODE               PIC X(4).
  3062         16  CF-MEMBER-CAPTION              PIC X(10).
  3063
  3064         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3065             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3066             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3067             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3068             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3069             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3070
  3071         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3072
  3073         16  CF-LIFE-OVERRIDE-L1            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  58
* EL1278.cbl
  3074         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3075         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3076         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3077
  3078         16  CF-AH-OVERRIDE-L1              PIC X.
  3079         16  CF-AH-OVERRIDE-L2              PIC XX.
  3080         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3081         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3082
  3083         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3084         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3085
  3086         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3087         16  CF-AR-LAST-EL860-DT            PIC XX.
  3088         16  CF-MP-MONTH-END-DT             PIC XX.
  3089
  3090         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3091         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3092             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3093
  3094         16  CF-AR-MONTH-END-DT             PIC XX.
  3095
  3096         16  CF-CRDTCRD-USER                PIC X.
  3097             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3098             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3099
  3100         16  CF-CC-MONTH-END-DT             PIC XX.
  3101
  3102         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3103
  3104         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3105             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3106             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3107             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3108         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3109         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3110         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3111         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3112             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3113             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3114         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3115         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3116         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3117             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3118         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3119
  3120         16  CF-CL-ZIP-CODE.
  3121             20  CF-CL-ZIP-PRIME.
  3122                 24  CF-CL-ZIP-1ST          PIC X.
  3123                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3124                 24  FILLER                 PIC X(4).
  3125             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3126         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3127             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3128             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3129             20  FILLER                     PIC XXX.
  3130
  3131         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  59
* EL1278.cbl
  3132         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3133         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3134         16  CF-CO-OPTION-START-DATE        PIC XX.
  3135         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3136           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3137                                                      '3' '4'.
  3138           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3139           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3140           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3141           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3142           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3143           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3144
  3145         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3146
  3147         16  CF-PAYMENT-APPROVAL-LEVELS.
  3148             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3149             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3150             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3151             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3152             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3153             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3154
  3155         16  CF-END-USER-REPORTING-USER     PIC X.
  3156             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3157             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3158
  3159         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3160             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3161             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3162
  3163         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3164
  3165         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3166         16  FILLER                         PIC X.
  3167
  3168         16  CF-CREDIT-ARCHIVE-CNTL.
  3169             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3170             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3171             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3172
  3173         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3174
  3175         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3176             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3177             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3178
  3179         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3180             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3181             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3182
  3183         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3184
  3185         16  CF-CO-ACH-ID-CODE              PIC  X.
  3186             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3187             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3188             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3189         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  60
* EL1278.cbl
  3190         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3191         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3192         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3193         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3194         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3195         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3196         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3197         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3198                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3199         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3200                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3201
  3202         16  CF-CO-OVER-SHORT.
  3203             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3204             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3205
  3206*         16  FILLER                         PIC X(102).
  3207         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3208             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3209             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3210
  3211         16  CF-AH-APPROVAL-DAYS.
  3212             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3213             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3214             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3215             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3216
  3217         16  FILLER                         PIC X(82).
  3218****************************************************************
  3219*             PROCESSOR/USER RECORD                            *
  3220****************************************************************
  3221
  3222     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3223         16  CF-PROCESSOR-NAME              PIC X(30).
  3224         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3225         16  CF-PROCESSOR-TITLE             PIC X(26).
  3226         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3227                 88  MESSAGE-YES                VALUE 'Y'.
  3228                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3229
  3230*****************************************************
  3231****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3232****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3233****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3234****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3235*****************************************************
  3236
  3237         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3238             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3239             20  CF-APPLICATION-FORCE       PIC X.
  3240             20  CF-INDIVIDUAL-APP.
  3241                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3242                     28  CF-BROWSE-APP      PIC X.
  3243                     28  CF-UPDATE-APP      PIC X.
  3244
  3245         16  CF-CURRENT-TERM-ON             PIC X(4).
  3246         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3247             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  61
* EL1278.cbl
  3248             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3249             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3250             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3251             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3252             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3253             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3254         16  CF-PROCESSOR-CARRIER           PIC X.
  3255             88  NO-CARRIER-SECURITY            VALUE ' '.
  3256         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3257             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3258         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3259             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3260         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3261             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3262
  3263         16  CF-PROC-SYS-ACCESS-SW.
  3264             20  CF-PROC-CREDIT-CLAIMS-SW.
  3265                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3266                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3267                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3268                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3269             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3270                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3271                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3272             20  CF-PROC-LIFE-GNRLDGR-SW.
  3273                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3274                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3275                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3276                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3277             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3278                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3279                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3280         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3281             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3282             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3283         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3284
  3285         16  CF-APPROVAL-LEVEL                  PIC X.
  3286             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3287             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3288             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3289             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3290
  3291         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3292
  3293         16  CF-LANGUAGE-TYPE                   PIC X.
  3294             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3295             88  CF-LANG-IS-FR                      VALUE 'F'.
  3296
  3297         16  CF-CSR-IND                         PIC X.
  3298         16  FILLER                             PIC X(239).
  3299
  3300****************************************************************
  3301*             PROCESSOR/REMINDERS RECORD                       *
  3302****************************************************************
  3303
  3304     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3305         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  62
* EL1278.cbl
  3306             20  CF-START-REMIND-DT         PIC XX.
  3307             20  CF-END-REMIND-DT           PIC XX.
  3308             20  CF-REMINDER-TEXT           PIC X(50).
  3309         16  FILLER                         PIC X(296).
  3310
  3311
  3312****************************************************************
  3313*             STATE MASTER RECORD                              *
  3314****************************************************************
  3315
  3316     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3317         16  CF-STATE-ABBREVIATION          PIC XX.
  3318         16  CF-STATE-NAME                  PIC X(25).
  3319         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3320         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3321             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3322             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3323             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3324             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3325                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3326                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3327             20  CF-ST-PREM-REJECT-SW       PIC X.
  3328                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3329                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3330             20  CF-ST-REF-REJECT-SW        PIC X.
  3331                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3332                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3333         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3334         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3335         16  CF-ST-REFUND-RULES.
  3336             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3337             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3338             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3339         16  CF-ST-FST-PMT-EXTENSION.
  3340             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3341             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3342                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3343                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3344                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3345                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3346         16  CF-ST-STATE-CALL.
  3347             20  CF-ST-CALL-UNEARNED        PIC X.
  3348             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3349             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3350         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3351             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3352             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3353         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3354         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3355         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3356         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3357         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3358         16  FILLER                         PIC X.
  3359         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3360             20  CF-ST-BENEFIT-CD           PIC XX.
  3361             20  CF-ST-BENEFIT-KIND         PIC X.
  3362                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3363                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  63
* EL1278.cbl
  3364             20  CF-ST-REM-TERM-CALC        PIC X.
  3365                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3366                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3367                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3368                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3369                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3370                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3371                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3372                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3373
  3374             20  CF-ST-REFUND-CALC          PIC X.
  3375                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3376                 88  ST-REFD-BY-R78             VALUE '1'.
  3377                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3378                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3379                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3380                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3381                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3382                 88  ST-REFD-UTAH               VALUE '7'.
  3383                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3384                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3385                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3386
  3387             20  CF-ST-EARNING-CALC         PIC X.
  3388                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3389                 88  ST-EARN-BY-R78             VALUE '1'.
  3390                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3391                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3392                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3393                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3394                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3395                 88  ST-EARN-MEAN               VALUE '8'.
  3396                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3397
  3398             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3399                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3400                 88  ST-OVRD-BY-R78             VALUE '1'.
  3401                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3402                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3403                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3404                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3405                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3406                 88  ST-OVRD-MEAN               VALUE '8'.
  3407                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3408             20  FILLER                     PIC X.
  3409
  3410         16  CF-ST-COMMISSION-CAPS.
  3411             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3412             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3413             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3414             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3415         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3416                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3417
  3418         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3419
  3420         16  CF-ST-STATUTORY-INTEREST.
  3421             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  64
* EL1278.cbl
  3422                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3423                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3424             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3425             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3426             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3427             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3428             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3429
  3430         16  CF-ST-OVER-SHORT.
  3431             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3432             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3433
  3434         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3435
  3436         16  CF-ST-RT-CALC                  PIC X.
  3437
  3438         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3439         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3440         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3441         16  CF-ST-RF-LR-CALC               PIC X.
  3442         16  CF-ST-RF-LL-CALC               PIC X.
  3443         16  CF-ST-RF-LN-CALC               PIC X.
  3444         16  CF-ST-RF-AH-CALC               PIC X.
  3445         16  CF-ST-RF-CP-CALC               PIC X.
  3446*        16  FILLER                         PIC X(206).
  3447*CIDMOD         16  FILLER                         PIC X(192).
  3448         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3449             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3450         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3451         16  CF-ST-VFY-2ND-BENE             PIC X.
  3452         16  FILLER                         PIC X(186).
  3453
  3454****************************************************************
  3455*             BENEFIT MASTER RECORD                            *
  3456****************************************************************
  3457
  3458     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3459         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3460             20  CF-BENEFIT-CODE            PIC XX.
  3461             20  CF-BENEFIT-NUMERIC  REDEFINES
  3462                 CF-BENEFIT-CODE            PIC XX.
  3463             20  CF-BENEFIT-ALPHA           PIC XXX.
  3464             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3465             20  CF-BENEFIT-COMMENT         PIC X(10).
  3466
  3467             20  CF-LF-COVERAGE-TYPE        PIC X.
  3468                 88  CF-REDUCING                VALUE 'R'.
  3469                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3470
  3471             20  CF-SPECIAL-CALC-CD         PIC X.
  3472                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3473                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3474                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3475                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3476                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3477                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3478                 88  CF-FARM-PLAN               VALUE 'F'.
  3479                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  65
* EL1278.cbl
  3480                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3481                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3482                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3483                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3484                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3485                 88  CF-PRUDENTIAL              VALUE 'P'.
  3486                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3487                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3488                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3489                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3490                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3491                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3492
  3493             20  CF-JOINT-INDICATOR         PIC X.
  3494                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3495
  3496*            20  FILLER                     PIC X(12).
  3497             20  FILLER                     PIC X(11).
  3498             20  CF-BENEFIT-CATEGORY        PIC X.
  3499             20  CF-LOAN-TYPE               PIC X(8).
  3500
  3501             20  CF-CO-REM-TERM-CALC        PIC X.
  3502                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3503                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3504                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3505                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3506                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3507
  3508             20  CF-CO-EARNINGS-CALC        PIC X.
  3509                 88  CO-EARN-BY-R78             VALUE '1'.
  3510                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3511                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3512                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3513                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3514                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3515                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3516                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3517
  3518             20  CF-CO-REFUND-CALC          PIC X.
  3519                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3520                 88  CO-REFD-BY-R78             VALUE '1'.
  3521                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3522                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3523                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3524                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3525                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3526                 88  CO-REFD-MEAN               VALUE '8'.
  3527                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3528                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3529                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3530
  3531             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3532                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3533                 88  CO-OVRD-BY-R78             VALUE '1'.
  3534                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3535                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3536                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3537                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  66
* EL1278.cbl
  3538                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3539                 88  CO-OVRD-MEAN               VALUE '8'.
  3540                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3541
  3542             20  CF-CO-BEN-I-G-CD           PIC X.
  3543                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3544                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3545                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3546
  3547         16  FILLER                         PIC X(304).
  3548
  3549
  3550****************************************************************
  3551*             CARRIER MASTER RECORD                            *
  3552****************************************************************
  3553
  3554     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3555         16  CF-ADDRESS-DATA.
  3556             20  CF-MAIL-TO-NAME            PIC X(30).
  3557             20  CF-IN-CARE-OF              PIC X(30).
  3558             20  CF-ADDRESS-LINE-1          PIC X(30).
  3559             20  CF-ADDRESS-LINE-2          PIC X(30).
  3560             20  CF-CITY-STATE              PIC X(30).
  3561             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3562             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3563
  3564         16  CF-CLAIM-NO-CONTROL.
  3565             20  CF-CLAIM-NO-METHOD         PIC X.
  3566                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3567                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3568                 88  CLAIM-NO-SEQ               VALUE '3'.
  3569                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3570             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3571                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3572                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3573                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3574
  3575         16  CF-CHECK-NO-CONTROL.
  3576             20  CF-CHECK-NO-METHOD         PIC X.
  3577                 88  CHECK-NO-MANUAL            VALUE '1'.
  3578                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3579                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3580                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3581             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3582                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3583
  3584         16  CF-DOMICILE-STATE              PIC XX.
  3585
  3586         16  CF-EXPENSE-CONTROLS.
  3587             20  CF-EXPENSE-METHOD          PIC X.
  3588                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3589                 88  DOLLARS-PER-PMT            VALUE '2'.
  3590                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3591                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3592             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3593             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3594
  3595         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  67
* EL1278.cbl
  3596             20  CF-LETTER-RESEND-OPT       PIC X.
  3597                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3598                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3599             20  FILLER                     PIC X(4).
  3600
  3601         16  CF-RESERVE-CONTROLS.
  3602             20  CF-MANUAL-SW               PIC X.
  3603                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3604             20  CF-FUTURE-SW               PIC X.
  3605                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3606             20  CF-PTC-SW                  PIC X.
  3607                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3608             20  CF-IBNR-SW                 PIC X.
  3609                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3610             20  CF-PTC-LF-SW               PIC X.
  3611                 88  CF-LF-PTC-USED             VALUE '1'.
  3612             20  CF-CDT-ACCESS-METHOD       PIC X.
  3613                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3614                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3615                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3616             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3617
  3618         16  CF-CLAIM-CALC-METHOD           PIC X.
  3619             88  360-PLUS-MONTHS                VALUE '1'.
  3620             88  365-PLUS-MONTHS                VALUE '2'.
  3621             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3622             88  360-DAILY                      VALUE '4'.
  3623             88  365-DAILY                      VALUE '5'.
  3624
  3625         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3626         16  FILLER                         PIC X(11).
  3627
  3628         16  CF-LIMIT-AMOUNTS.
  3629             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3630             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3631             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3632             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3633             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3634             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3635             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3636             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3637             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3638             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3639
  3640         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3641         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3642         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3643
  3644         16  CF-ZIP-CODE.
  3645             20  CF-ZIP-PRIME.
  3646                 24  CF-ZIP-1ST             PIC X.
  3647                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3648                 24  FILLER                 PIC X(4).
  3649             20  CF-ZIP-PLUS4               PIC X(4).
  3650         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3651             20  CF-CAN-POSTAL-1            PIC XXX.
  3652             20  CF-CAN-POSTAL-2            PIC XXX.
  3653             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  68
* EL1278.cbl
  3654
  3655         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3656         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3657         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3658
  3659         16  CF-RATING-SWITCH               PIC X.
  3660             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3661             88  CF-NO-RATING                   VALUE 'N'.
  3662
  3663         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3664
  3665         16  CF-CARRIER-OVER-SHORT.
  3666             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3667             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3668
  3669         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3670         16  CF-SECPAY-SWITCH               PIC X.
  3671             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3672             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3673         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3674         16  FILLER                         PIC X(448).
  3675*        16  FILLER                         PIC X(452).
  3676
  3677
  3678****************************************************************
  3679*             MORTALITY MASTER RECORD                          *
  3680****************************************************************
  3681
  3682     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3683         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3684                                INDEXED BY CF-MORT-NDX.
  3685             20  CF-MORT-TABLE              PIC X(5).
  3686             20  CF-MORT-TABLE-TYPE         PIC X.
  3687                 88  CF-MORT-JOINT              VALUE 'J'.
  3688                 88  CF-MORT-SINGLE             VALUE 'S'.
  3689                 88  CF-MORT-COMBINED           VALUE 'C'.
  3690                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3691                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3692             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3693             20  CF-MORT-AGE-METHOD         PIC XX.
  3694                 88  CF-AGE-LAST                VALUE 'AL'.
  3695                 88  CF-AGE-NEAR                VALUE 'AN'.
  3696             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3697             20  CF-MORT-ADJUSTMENT-DIRECTION
  3698                                            PIC X.
  3699                 88  CF-MINUS                   VALUE '-'.
  3700                 88  CF-PLUS                    VALUE '+'.
  3701             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3702             20  CF-MORT-JOINT-CODE         PIC X.
  3703                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3704             20  CF-MORT-PC-Q               PIC X.
  3705                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3706             20  CF-MORT-TABLE-CODE         PIC X(4).
  3707             20  CF-MORT-COMMENTS           PIC X(15).
  3708             20  FILLER                     PIC X(14).
  3709
  3710         16  FILLER                         PIC X(251).
  3711
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  69
* EL1278.cbl
  3712
  3713****************************************************************
  3714*             BUSSINESS TYPE MASTER RECORD                     *
  3715****************************************************************
  3716
  3717     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3718* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3719* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3720* AND RECORD 05 IS TYPES 81-99
  3721         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3722             20  CF-BUSINESS-TITLE          PIC  X(19).
  3723             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3724                                            PIC S9V9(4) COMP-3.
  3725             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3726             20  FILLER                     PIC  X.
  3727         16  FILLER                         PIC  X(248).
  3728
  3729
  3730****************************************************************
  3731*             TERMINAL MASTER RECORD                           *
  3732****************************************************************
  3733
  3734     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3735
  3736         16  CF-COMPANY-TERMINALS.
  3737             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3738                                  PIC X(4).
  3739         16  FILLER               PIC X(248).
  3740
  3741
  3742****************************************************************
  3743*             LIFE EDIT MASTER RECORD                          *
  3744****************************************************************
  3745
  3746     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3747         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3748             20  CF-LIFE-CODE-IN            PIC XX.
  3749             20  CF-LIFE-CODE-OUT           PIC XX.
  3750         16  FILLER                         PIC X(248).
  3751
  3752
  3753****************************************************************
  3754*             AH EDIT MASTER RECORD                            *
  3755****************************************************************
  3756
  3757     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3758         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3759             20  CF-AH-CODE-IN              PIC XXX.
  3760             20  CF-AH-CODE-OUT             PIC XX.
  3761         16  FILLER                         PIC X(248).
  3762
  3763
  3764****************************************************************
  3765*             CREDIBILITY TABLES                               *
  3766****************************************************************
  3767
  3768     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3769         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  70
* EL1278.cbl
  3770                             INDEXED BY CF-CRDB-NDX.
  3771             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3772             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3773             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3774         16  FILLER                         PIC  X(332).
  3775
  3776
  3777****************************************************************
  3778*             REPORT CUSTOMIZATION RECORD                      *
  3779****************************************************************
  3780
  3781     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3782         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3783             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3784             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3785             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3786**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3787****       A T-TRANSFER.                                   ****
  3788             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3789
  3790         16  FILLER                         PIC XX.
  3791
  3792         16  CF-CARRIER-CNTL-OPT.
  3793             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3794                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3795                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3796             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3797                                            PIC X.
  3798         16  CF-GROUP-CNTL-OPT.
  3799             20  CF-GROUP-OPT-SEQ           PIC 9.
  3800                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3801                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3802             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3803                                            PIC X(6).
  3804         16  CF-STATE-CNTL-OPT.
  3805             20  CF-STATE-OPT-SEQ           PIC 9.
  3806                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3807                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3808             20  CF-STATE-SELECT OCCURS 3 TIMES
  3809                                            PIC XX.
  3810         16  CF-ACCOUNT-CNTL-OPT.
  3811             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3812                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3813                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3814             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3815                                            PIC X(10).
  3816         16  CF-BUS-TYP-CNTL-OPT.
  3817             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3818                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3819                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3820             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3821                                            PIC XX.
  3822         16  CF-LF-TYP-CNTL-OPT.
  3823             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3824                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3825                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3826             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3827                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  71
* EL1278.cbl
  3828         16  CF-AH-TYP-CNTL-OPT.
  3829             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3830                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3831                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3832             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3833                                            PIC XX.
  3834         16  CF-REPTCD1-CNTL-OPT.
  3835             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3836                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3837                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3838             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3839                                            PIC X(10).
  3840         16  CF-REPTCD2-CNTL-OPT.
  3841             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3842                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3843                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3844             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3845                                            PIC X(10).
  3846         16  CF-USER1-CNTL-OPT.
  3847             20  CF-USER1-OPT-SEQ           PIC 9.
  3848                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3849                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3850             20  CF-USER1-SELECT OCCURS 3 TIMES
  3851                                            PIC X(10).
  3852         16  CF-USER2-CNTL-OPT.
  3853             20  CF-USER2-OPT-SEQ           PIC 9.
  3854                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3855                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3856             20  CF-USER2-SELECT OCCURS 3 TIMES
  3857                                            PIC X(10).
  3858         16  CF-USER3-CNTL-OPT.
  3859             20  CF-USER3-OPT-SEQ           PIC 9.
  3860                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3861                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3862             20  CF-USER3-SELECT OCCURS 3 TIMES
  3863                                            PIC X(10).
  3864         16  CF-USER4-CNTL-OPT.
  3865             20  CF-USER4-OPT-SEQ           PIC 9.
  3866                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3867                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3868             20  CF-USER4-SELECT OCCURS 3 TIMES
  3869                                            PIC X(10).
  3870         16  CF-USER5-CNTL-OPT.
  3871             20  CF-USER5-OPT-SEQ           PIC 9.
  3872                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3873                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3874             20  CF-USER5-SELECT OCCURS 3 TIMES
  3875                                            PIC X(10).
  3876         16  CF-REINS-CNTL-OPT.
  3877             20  CF-REINS-OPT-SEQ           PIC 9.
  3878                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3879                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3880             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3881                 24  CF-REINS-PRIME         PIC XXX.
  3882                 24  CF-REINS-SUB           PIC XXX.
  3883
  3884         16  CF-AGENT-CNTL-OPT.
  3885             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  72
* EL1278.cbl
  3886                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3887                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3888             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3889                                            PIC X(10).
  3890
  3891         16  FILLER                         PIC X(43).
  3892
  3893         16  CF-LOSS-RATIO-SELECT.
  3894             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3895             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3896         16  CF-ENTRY-DATE-SELECT.
  3897             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3898             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3899         16  CF-EFFECTIVE-DATE-SELECT.
  3900             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3901             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3902
  3903         16  CF-EXCEPTION-LIST-IND          PIC X.
  3904             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3905
  3906         16  FILLER                         PIC X(318).
  3907
  3908****************************************************************
  3909*                  EXCEPTION REPORTING RECORD                  *
  3910****************************************************************
  3911
  3912     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3913         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3914             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3915
  3916         16  CF-COMBINED-LIFE-AH-OPT.
  3917             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3918             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3919             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3920             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3921
  3922         16  CF-LIFE-OPT.
  3923             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3924             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3925             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3926             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3927             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3928             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3929             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3930             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3931             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3932             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3933
  3934         16  CF-AH-OPT.
  3935             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3936             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3937             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3938             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3939             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3940             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3941             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3942             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3943             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  73
* EL1278.cbl
  3944             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3945
  3946         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3947             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3948             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3949             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3950
  3951         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3952
  3953         16  FILLER                         PIC X(673).
  3954
  3955
  3956****************************************************************
  3957*             MORTGAGE SYSTEM PLAN RECORD                      *
  3958****************************************************************
  3959
  3960     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3961         16  CF-PLAN-TYPE                   PIC X.
  3962             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3963             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3964             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3965         16  CF-PLAN-ABBREV                 PIC XXX.
  3966         16  CF-PLAN-DESCRIPT               PIC X(10).
  3967         16  CF-PLAN-NOTES                  PIC X(20).
  3968         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3969         16  CF-PLAN-UNDERWRITING.
  3970             20  CF-PLAN-TERM-DATA.
  3971                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3972                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3973             20  CF-PLAN-AGE-DATA.
  3974                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3975                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3976                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3977             20  CF-PLAN-BENEFIT-DATA.
  3978                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3979                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3980                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3981                                            PIC S9(7)V99  COMP-3.
  3982         16  CF-PLAN-POLICY-FORMS.
  3983             20  CF-POLICY-FORM             PIC X(12).
  3984             20  CF-MASTER-APPLICATION      PIC X(12).
  3985             20  CF-MASTER-POLICY           PIC X(12).
  3986         16  CF-PLAN-RATING.
  3987             20  CF-RATE-CODE               PIC X(5).
  3988             20  CF-SEX-RATING              PIC X.
  3989                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3990                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3991             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3992             20  CF-SUB-STD-TYPE            PIC X.
  3993                 88  CF-PCT-OF-PREM            VALUE '1'.
  3994                 88  CF-PCT-OF-BENE            VALUE '2'.
  3995         16  CF-PLAN-PREM-TOLERANCES.
  3996             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3997             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3998         16  CF-PLAN-PYMT-TOLERANCES.
  3999             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4000             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4001         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  74
* EL1278.cbl
  4002             20  FILLER                     PIC X.
  4003             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4004             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4005         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4006         16  CF-PLAN-IND-GRP                PIC X.
  4007             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4008                                                     '1'.
  4009             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4010                                                     '2'.
  4011         16  CF-MIB-SEARCH-SW               PIC X.
  4012             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4013             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4014             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4015             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4016         16  CF-ALPHA-SEARCH-SW             PIC X.
  4017             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4018             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4019             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4020             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4021             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4022             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4023             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4024             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4025             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4026             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4027                                                     'A' 'B' 'C'
  4028                                                     'X' 'Y' 'Z'.
  4029         16  CF-EFF-DT-RULE-SW              PIC X.
  4030             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4031             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4032             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4033             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4034             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4035         16  FILLER                         PIC X(4).
  4036         16  CF-HEALTH-QUESTIONS            PIC X.
  4037             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4038         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4039         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4040         16  CF-PLAN-SNGL-JNT               PIC X.
  4041             88  CF-COMBINED-PLAN              VALUE 'C'.
  4042             88  CF-JNT-PLAN                   VALUE 'J'.
  4043             88  CF-SNGL-PLAN                  VALUE 'S'.
  4044         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4045         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4046         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4047         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4048         16  CF-RERATE-CNTL                 PIC  X.
  4049             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4050             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4051             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4052             88  CF-AUTO-RECALC                 VALUE '4'.
  4053         16  CF-BENEFIT-TYPE                PIC  X.
  4054             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4055             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4056         16  CF-POLICY-FEE                  PIC S999V99
  4057                                                    COMP-3.
  4058         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4059         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  75
* EL1278.cbl
  4060         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4061         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4062         16  FILLER                         PIC  X(32).
  4063         16  CF-TERMINATION-FORM            PIC  X(04).
  4064         16  FILLER                         PIC  X(08).
  4065         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4066                                                       COMP-3.
  4067         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4068         16  CF-ISSUE-LETTER                PIC  X(4).
  4069         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4070         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4071             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4072             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4073         16  CF-MP-REFUND-CALC              PIC X.
  4074             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4075             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4076             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4077             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4078             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4079             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4080             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4081             88  CF-MP-REFD-MEAN                VALUE '8'.
  4082         16  CF-ALT-RATE-CODE               PIC  X(5).
  4083
  4084
  4085         16  FILLER                         PIC X(498).
  4086****************************************************************
  4087*             MORTGAGE COMPANY MASTER RECORD                   *
  4088****************************************************************
  4089
  4090     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4091         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4092         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4093             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4094             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4095             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4096             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4097             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4098
  4099         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4100         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4101         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4102         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4103         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4104
  4105         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4106             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4107         16  CF-MP-RECON-USE-IND            PIC X(1).
  4108             88  CF-MP-USE-RECON             VALUE 'Y'.
  4109         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4110             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4111         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4112             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4113             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4114         16  FILLER                         PIC X(1).
  4115         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4116             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4117         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  76
* EL1278.cbl
  4118             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4119             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4120             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4121         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4122             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4123                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4124             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4125                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4126             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4127                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4128             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4129                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4130             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4131                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4132             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4133                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4134         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4135         16  FILLER                         PIC X(7).
  4136         16  CF-MORTG-DESTINATION-SYMBOL.
  4137             20  CF-MORTG-MIB-COMM          PIC X(5).
  4138             20  CF-MORTG-MIB-TERM          PIC X(5).
  4139         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4140             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4141         16  FILLER                         PIC X(03).
  4142         16  CF-MP-CHECK-NO-CONTROL.
  4143             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4144                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4145                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4146                                                ' ' LOW-VALUES.
  4147                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4148                                               VALUE '3'.
  4149         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4150         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4151         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4152             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4153                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4154             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4155                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4156             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4157                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4158             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4159                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4160             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4161                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4162             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4163                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4164         16  CF-MORTG-BILLING-AREA.
  4165             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4166                                            PIC X.
  4167         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4168         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4169         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4170         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4171             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4172             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4173         16  FILLER                         PIC X.
  4174         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4175             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  77
* EL1278.cbl
  4176             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4177         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4178         16  FILLER                         PIC X(8).
  4179         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4180         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4181         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4182         16  CF-ACH-COMPANY-ID.
  4183             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4184                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4185                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4186                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4187             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4188         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4189             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4190         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4191             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4192             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4193         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4194         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4195         16  FILLER                         PIC X(536).
  4196
  4197****************************************************************
  4198*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4199****************************************************************
  4200
  4201     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4202         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4203             20  CF-FEMALE-HEIGHT.
  4204                 24  CF-FEMALE-FT           PIC 99.
  4205                 24  CF-FEMALE-IN           PIC 99.
  4206             20  CF-FEMALE-MIN-WT           PIC 999.
  4207             20  CF-FEMALE-MAX-WT           PIC 999.
  4208         16  FILLER                         PIC X(428).
  4209
  4210     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4211         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4212             20  CF-MALE-HEIGHT.
  4213                 24  CF-MALE-FT             PIC 99.
  4214                 24  CF-MALE-IN             PIC 99.
  4215             20  CF-MALE-MIN-WT             PIC 999.
  4216             20  CF-MALE-MAX-WT             PIC 999.
  4217         16  FILLER                         PIC X(428).
  4218******************************************************************
  4219*             AUTOMATIC ACTIVITY RECORD                          *
  4220******************************************************************
  4221     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4222         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4223             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4224             20  CF-SYS-LETTER-ID           PIC X(04).
  4225             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4226             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4227             20  CF-SYS-RESET-SW            PIC X(01).
  4228             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4229             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4230
  4231         16  FILLER                         PIC X(50).
  4232
  4233         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  78
* EL1278.cbl
  4234             20  CF-USER-ACTIVE-SW          PIC X(01).
  4235             20  CF-USER-LETTER-ID          PIC X(04).
  4236             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4237             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4238             20  CF-USER-RESET-SW           PIC X(01).
  4239             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4240             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4241             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4242
  4243         16  FILLER                         PIC X(246).
  4244*                            COPY ERCACCT.
  4245******************************************************************
  4246*                                                                *
  4247*                                                                *
  4248*                            ERCACCT                             *
  4249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4250*                            VMOD=2.031                          *
  4251*                                                                *
  4252*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4253*                                                                *
  4254*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4255*   VSAM ACCOUNT MASTER FILES.                                   *
  4256*                                                                *
  4257*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4258*                                                                *
  4259*   FILE TYPE = VSAM,KSDS                                        *
  4260*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4261*                                                                *
  4262*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4263*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4264*                                                                *
  4265*   LOG = NO                                                     *
  4266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4267*                                                                *
  4268*                                                                *
  4269******************************************************************
  4270*                   C H A N G E   L O G
  4271*
  4272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4273*-----------------------------------------------------------------
  4274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4275* EFFECTIVE    NUMBER
  4276*-----------------------------------------------------------------
  4277* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4278* 092705    2005050300006  PEMA  ADD SPP LEASES
  4279* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4280* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4281* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4282* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4283* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4284******************************************************************
  4285
  4286 01  ACCOUNT-MASTER.
  4287     12  AM-RECORD-ID                      PIC XX.
  4288         88  VALID-AM-ID                      VALUE 'AM'.
  4289
  4290     12  AM-CONTROL-PRIMARY.
  4291         16  AM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  79
* EL1278.cbl
  4292         16  AM-MSTR-CNTRL.
  4293             20  AM-CONTROL-A.
  4294                 24  AM-CARRIER            PIC X.
  4295                 24  AM-GROUPING.
  4296                     28 AM-GROUPING-PREFIX PIC XXX.
  4297                     28 AM-GROUPING-PRIME  PIC XXX.
  4298                 24  AM-STATE              PIC XX.
  4299                 24  AM-ACCOUNT.
  4300                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4301                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4302             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4303                                           PIC X(19).
  4304             20  AM-CNTRL-B.
  4305                 24  AM-EXPIRATION-DT      PIC XX.
  4306                 24  FILLER                PIC X(4).
  4307             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4308                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4309
  4310     12  AM-CONTROL-BY-VAR-GRP.
  4311         16  AM-COMPANY-CD-A1              PIC X.
  4312         16  AM-VG-CARRIER                 PIC X.
  4313         16  AM-VG-GROUPING                PIC X(6).
  4314         16  AM-VG-STATE                   PIC XX.
  4315         16  AM-VG-ACCOUNT                 PIC X(10).
  4316         16  AM-VG-DATE.
  4317             20  AM-VG-EXPIRATION-DT       PIC XX.
  4318             20  FILLER                    PIC X(4).
  4319         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4320                                           PIC 9(11)      COMP-3.
  4321     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4322         16  FILLER                        PIC X(10).
  4323         16  AM-VG-KEY3.
  4324             20  AM-VG3-ACCOUNT            PIC X(10).
  4325             20  AM-VG3-EXP-DT             PIC XX.
  4326         16  FILLER                        PIC X(4).
  4327     12  AM-MAINT-INFORMATION.
  4328         16  AM-LAST-MAINT-DT              PIC XX.
  4329         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4330         16  AM-LAST-MAINT-USER            PIC X(4).
  4331         16  FILLER                        PIC XX.
  4332
  4333     12  AM-EFFECTIVE-DT                   PIC XX.
  4334     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4335
  4336     12  AM-PREV-DATES  COMP-3.
  4337         16  AM-PREV-EXP-DT                PIC 9(11).
  4338         16  AM-PREV-EFF-DT                PIC 9(11).
  4339
  4340     12  AM-REPORT-CODE-1                  PIC X(10).
  4341     12  AM-REPORT-CODE-2                  PIC X(10).
  4342
  4343     12  AM-CITY-CODE                      PIC X(4).
  4344     12  AM-COUNTY-PARISH                  PIC X(6).
  4345
  4346     12  AM-NAME                           PIC X(30).
  4347     12  AM-PERSON                         PIC X(30).
  4348     12  AM-ADDRS                          PIC X(30).
  4349     12  AM-CITY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  80
* EL1278.cbl
  4350         16  AM-ADDR-CITY                  PIC X(28).
  4351         16  AM-ADDR-STATE                 PIC XX.
  4352     12  AM-ZIP.
  4353         16  AM-ZIP-PRIME.
  4354             20  AM-ZIP-PRI-1ST            PIC X.
  4355                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4356             20  FILLER                    PIC X(4).
  4357         16  AM-ZIP-PLUS4                  PIC X(4).
  4358     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4359         16  AM-CAN-POSTAL-1               PIC XXX.
  4360         16  AM-CAN-POSTAL-2               PIC XXX.
  4361         16  FILLER                        PIC XXX.
  4362     12  AM-TEL-NO.
  4363         16  AM-AREA-CODE                  PIC 999.
  4364         16  AM-TEL-PRE                    PIC 999.
  4365         16  AM-TEL-NBR                    PIC 9(4).
  4366     12  AM-TEL-LOC                        PIC X.
  4367         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4368         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4369
  4370     12  AM-COMM-STRUCTURE.
  4371         16  AM-DEFN-1.
  4372             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4373                 24  AM-AGT.
  4374                     28  AM-AGT-PREFIX     PIC X(4).
  4375                     28  AM-AGT-PRIME      PIC X(6).
  4376                 24  AM-COM-TYP            PIC X.
  4377                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4378                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4379                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4380                 24  AM-RECALC-LV-INDIC    PIC X.
  4381                 24  AM-RETRO-LV-INDIC     PIC X.
  4382                 24  AM-GL-CODES           PIC X.
  4383                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4384                 24  FILLER                PIC X(01).
  4385         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4386             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4387                 24  FILLER                PIC X(11).
  4388                 24  AM-L-COMA             PIC XXX.
  4389                 24  AM-J-COMA             PIC XXX.
  4390                 24  AM-A-COMA             PIC XXX.
  4391                 24  FILLER                PIC X(6).
  4392
  4393     12  AM-COMM-CHANGE-STATUS             PIC X.
  4394         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4395
  4396     12  AM-CSR-CODE                       PIC X(4).
  4397
  4398     12  AM-BILLING-STATUS                 PIC X.
  4399         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4400         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4401     12  AM-AUTO-REFUND-SW                 PIC X.
  4402         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4403         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4404     12  AM-GPCD                           PIC 99.
  4405     12  AM-IG                             PIC X.
  4406         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4407         88  AM-HAS-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  81
* EL1278.cbl
  4408     12  AM-STATUS                         PIC X.
  4409         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4410         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4411         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4412         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4413         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4414         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4415     12  AM-REMIT-TO                       PIC 99.
  4416     12  AM-ID-NO                          PIC X(11).
  4417
  4418     12  AM-CAL-TABLE                      PIC XX.
  4419     12  AM-LF-DEVIATION                   PIC XXX.
  4420     12  AM-AH-DEVIATION                   PIC XXX.
  4421     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4422     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4423     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4424     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4425     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4426     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4427
  4428     12  AM-USER-FIELDS.
  4429         16  AM-FLD-1                      PIC XX.
  4430         16  AM-FLD-2                      PIC XX.
  4431         16  AM-FLD-3                      PIC XX.
  4432         16  AM-FLD-4                      PIC XX.
  4433         16  AM-FLD-5                      PIC XX.
  4434
  4435     12  AM-1ST-PROD-DATE.
  4436         16  AM-1ST-PROD-YR                PIC XX.
  4437         16  AM-1ST-PROD-MO                PIC XX.
  4438         16  AM-1ST-PROD-DA                PIC XX.
  4439     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4440     12  AM-CERTS-PURGED-DATE.
  4441         16  AM-PUR-YR                     PIC XX.
  4442         16  AM-PUR-MO                     PIC XX.
  4443         16  AM-PUR-DA                     PIC XX.
  4444     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4445     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4446     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4447     12  AM-INACTIVE-DATE.
  4448         16  AM-INA-MO                     PIC 99.
  4449         16  AM-INA-DA                     PIC 99.
  4450         16  AM-INA-YR                     PIC 99.
  4451     12  AM-AR-HI-CERT-DATE                PIC XX.
  4452
  4453     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4454     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4455
  4456     12  AM-OB-PAYMENT-MODE                PIC X.
  4457         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4458         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4459         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4460         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4461
  4462     12  AM-AH-ONLY-INDICATOR              PIC X.
  4463         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4464         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4465
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  82
* EL1278.cbl
  4466     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4467
  4468     12  AM-OVER-SHORT.
  4469         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4470         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4471
  4472     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4473     12  AM-DCC-CLP-STATE                  PIC XX.
  4474
  4475     12  AM-RECALC-COMM                    PIC X.
  4476     12  AM-RECALC-REIN                    PIC X.
  4477
  4478     12  AM-REI-TABLE                      PIC XXX.
  4479     12  AM-REI-ET-LF                      PIC X.
  4480     12  AM-REI-ET-AH                      PIC X.
  4481     12  AM-REI-PE-LF                      PIC X.
  4482     12  AM-REI-PE-AH                      PIC X.
  4483     12  AM-REI-PRT-ST                     PIC X.
  4484     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4485     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4486     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4487     12  AM-REI-GROUP-A                    PIC X(6).
  4488     12  AM-REI-MORT                       PIC X(4).
  4489     12  AM-REI-PRT-OW                     PIC X.
  4490     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4491     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4492     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4493     12  AM-REI-GROUP-B                    PIC X(6).
  4494
  4495     12  AM-TRUST-TYPE                     PIC X(2).
  4496
  4497     12  AM-EMPLOYER-STMT-USED             PIC X.
  4498     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4499
  4500     12  AM-STD-AH-TYPE                    PIC XX.
  4501     12  AM-EARN-METHODS.
  4502         16  AM-EARN-METHOD-R              PIC X.
  4503             88 AM-REF-RL-R78                 VALUE 'R'.
  4504             88 AM-REF-RL-PR                  VALUE 'P'.
  4505             88 AM-REF-RL-MEAN                VALUE 'M'.
  4506             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4507         16  AM-EARN-METHOD-L              PIC X.
  4508             88 AM-REF-LL-R78                 VALUE 'R'.
  4509             88 AM-REF-LL-PR                  VALUE 'P'.
  4510             88 AM-REF-LL-MEAN                VALUE 'M'.
  4511             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4512         16  AM-EARN-METHOD-A              PIC X.
  4513             88 AM-REF-AH-R78                 VALUE 'R'.
  4514             88 AM-REF-AH-PR                  VALUE 'P'.
  4515             88 AM-REF-AH-MEAN                VALUE 'M'.
  4516             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4517             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4518             88 AM-REF-AH-NET                 VALUE 'N'.
  4519
  4520     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4521     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4522     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4523
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  83
* EL1278.cbl
  4524     12  AM-RET-Y-N                        PIC X.
  4525     12  AM-RET-P-E                        PIC X.
  4526     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4527     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4528     12  AM-RET-GRP                        PIC X(6).
  4529     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4530         16  AM-POOL-PRIME                 PIC XXX.
  4531         16  AM-POOL-SUB                   PIC XXX.
  4532     12  AM-RETRO-EARNINGS.
  4533         16  AM-RET-EARN-R                 PIC X.
  4534         16  AM-RET-EARN-L                 PIC X.
  4535         16  AM-RET-EARN-A                 PIC X.
  4536     12  AM-RET-ST-TAX-USE                 PIC X.
  4537         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4538         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4539     12  AM-RETRO-BEG-EARNINGS.
  4540         16  AM-RET-BEG-EARN-R             PIC X.
  4541         16  AM-RET-BEG-EARN-L             PIC X.
  4542         16  AM-RET-BEG-EARN-A             PIC X.
  4543     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4544     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4545
  4546     12  AM-USER-SELECT-OPTIONS.
  4547         16  AM-USER-SELECT-1              PIC X(10).
  4548         16  AM-USER-SELECT-2              PIC X(10).
  4549         16  AM-USER-SELECT-3              PIC X(10).
  4550         16  AM-USER-SELECT-4              PIC X(10).
  4551         16  AM-USER-SELECT-5              PIC X(10).
  4552
  4553     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4554
  4555     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4556
  4557     12  AM-RPT045A-SWITCH                 PIC X.
  4558         88  RPT045A-OFF                   VALUE 'N'.
  4559
  4560     12  AM-INSURANCE-LIMITS.
  4561         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4562         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4563
  4564     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4565         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4566
  4567     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4568         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4569         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4570
  4571     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4572
  4573     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4574     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4575     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4576     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4577     12  AM-DCC-UEF-STATE                  PIC XX.
  4578     12  FILLER                            PIC XXX.
  4579     12  AM-REPORT-CODE-3                  PIC X(10).
  4580*    12  FILLER                            PIC X(22).
  4581
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  84
* EL1278.cbl
  4582     12  AM-RESERVE-DATE.
  4583         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4584         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4585         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4586
  4587     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4588     12  AM-NOTIFICATION-TYPES.
  4589         16  AM-NOTIF-OF-LETTERS           PIC X.
  4590         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4591         16  AM-NOTIF-OF-REPORTS           PIC X.
  4592         16  AM-NOTIF-OF-STATUS            PIC X.
  4593
  4594     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4595         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4596         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4597         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4598         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4599
  4600     12  AM-BENEFIT-CONTROLS.
  4601         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4602             20  AM-BENEFIT-CODE           PIC XX.
  4603             20  AM-BENEFIT-TYPE           PIC X.
  4604             20  AM-BENEFIT-REVISION       PIC XXX.
  4605             20  AM-BENEFIT-REM-TERM       PIC X.
  4606             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4607             20  FILLER                    PIC XX.
  4608         16  FILLER                        PIC X(80).
  4609
  4610     12  AM-TRANSFER-DATA.
  4611         16  AM-TRANSFERRED-FROM.
  4612             20  AM-TRNFROM-CARRIER        PIC X.
  4613             20  AM-TRNFROM-GROUPING.
  4614                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4615                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4616             20  AM-TRNFROM-STATE          PIC XX.
  4617             20  AM-TRNFROM-ACCOUNT.
  4618                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4619                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4620             20  AM-TRNFROM-DTE            PIC XX.
  4621         16  AM-TRANSFERRED-TO.
  4622             20  AM-TRNTO-CARRIER          PIC X.
  4623             20  AM-TRNTO-GROUPING.
  4624                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4625                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4626             20  AM-TRNTO-STATE            PIC XX.
  4627             20  AM-TRNTO-ACCOUNT.
  4628                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4629                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4630             20  AM-TRNTO-DTE              PIC XX.
  4631         16  FILLER                        PIC X(10).
  4632
  4633     12  AM-SAVED-REMIT-TO                 PIC 99.
  4634
  4635     12  AM-COMM-STRUCTURE-SAVED.
  4636         16  AM-DEFN-1-SAVED.
  4637             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4638                 24  AM-AGT-SV             PIC X(10).
  4639                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  85
* EL1278.cbl
  4640                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4641                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4642                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4643                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4644                 24  FILLER                PIC X.
  4645                 24  AM-GL-CODES-SV        PIC X.
  4646                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4647                 24  FILLER                PIC X.
  4648         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4649             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4650                 24  FILLER                PIC X(11).
  4651                 24  AM-L-COMA-SV          PIC XXX.
  4652                 24  AM-J-COMA-SV          PIC XXX.
  4653                 24  AM-A-COMA-SV          PIC XXX.
  4654                 24  FILLER                PIC X(6).
  4655
  4656     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4657         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4658            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4659            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4660            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4661
  4662     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4663     12  FILLER                            PIC X(120).
  4664
  4665     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4666         16  AM-CONTROL-NAME               PIC X(30).
  4667         16  AM-EXECUTIVE-ONE.
  4668             20  AM-EXEC1-NAME             PIC X(15).
  4669             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4670                                                          COMP-3.
  4671             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4672                                                          COMP-3.
  4673         16  AM-EXECUTIVE-TWO.
  4674             20  AM-EXEC2-NAME             PIC X(15).
  4675             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4676                                                          COMP-3.
  4677             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4678                                                          COMP-3.
  4679
  4680     12  AM-RETRO-ADDITIONAL-DATA.
  4681         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4682         16  AM-RETRO-PREM-P-E             PIC X.
  4683         16  AM-RETRO-CLMS-P-I             PIC X.
  4684         16  AM-RETRO-RET-BRACKET-LF.
  4685             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4686                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4687                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4688             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4689                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4690                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4691             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4692                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4693                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4694         16  AM-RETRO-RET-BRACKET-AH.
  4695             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4696                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4697                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  86
* EL1278.cbl
  4698                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4699             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4700                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4701                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4702             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4703                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4704                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4705
  4706     12  AM-COMMENTS.
  4707         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4708
  4709     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4710         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4711         16  AM-FLI-BILLING-CODE           PIC X.
  4712         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4713         16  AM-FLI-UNITED-IDENT           PIC X.
  4714         16  AM-FLI-INTEREST-LOST-DATA.
  4715             20  AM-FLI-BANK-NO            PIC X(5).
  4716             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4717             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4718             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4719         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4720             20  AM-FLI-AGT                PIC X(9).
  4721             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4722             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4723         16  FILLER                        PIC X(102).
  4724
  4725     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4726         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4727             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4728             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4729             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4730             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4731             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4732         16  FILLER                          PIC X(10).
  4733******************************************************************
  4734*                            COPY ELCCERT.
  4735******************************************************************
  4736*                                                                *
  4737*                            ELCCERT.                            *
  4738*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4739*                            VMOD=2.013                          *
  4740*                                                                *
  4741*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4742*                                                                *
  4743*   FILE TYPE = VSAM,KSDS                                        *
  4744*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4745*                                                                *
  4746*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4747*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4748*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4749*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4750*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4751*                                                                *
  4752*   LOG = YES                                                    *
  4753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4754******************************************************************
  4755*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  87
* EL1278.cbl
  4756*
  4757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4758*-----------------------------------------------------------------
  4759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4760* EFFECTIVE    NUMBER
  4761*-----------------------------------------------------------------
  4762* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4763* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4764* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4765* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4766* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4767* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4768* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4769* 032612  CR2011110200001  PEMA  AHL CHANGES
  4770******************************************************************
  4771
  4772 01  CERTIFICATE-MASTER.
  4773     12  CM-RECORD-ID                      PIC XX.
  4774         88  VALID-CM-ID                      VALUE 'CM'.
  4775
  4776     12  CM-CONTROL-PRIMARY.
  4777         16  CM-COMPANY-CD                 PIC X.
  4778         16  CM-CARRIER                    PIC X.
  4779         16  CM-GROUPING.
  4780             20  CM-GROUPING-PREFIX        PIC X(3).
  4781             20  CM-GROUPING-PRIME         PIC X(3).
  4782         16  CM-STATE                      PIC XX.
  4783         16  CM-ACCOUNT.
  4784             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4785             20  CM-ACCOUNT-PRIME          PIC X(6).
  4786         16  CM-CERT-EFF-DT                PIC XX.
  4787         16  CM-CERT-NO.
  4788             20  CM-CERT-PRIME             PIC X(10).
  4789             20  CM-CERT-SFX               PIC X.
  4790
  4791     12  CM-CONTROL-BY-NAME.
  4792         16  CM-COMPANY-CD-A1              PIC X.
  4793         16  CM-INSURED-LAST-NAME          PIC X(15).
  4794         16  CM-INSURED-INITIALS.
  4795             20  CM-INSURED-INITIAL1       PIC X.
  4796             20  CM-INSURED-INITIAL2       PIC X.
  4797
  4798     12  CM-CONTROL-BY-SSN.
  4799         16  CM-COMPANY-CD-A2              PIC X.
  4800         16  CM-SOC-SEC-NO.
  4801             20  CM-SSN-STATE              PIC XX.
  4802             20  CM-SSN-ACCOUNT            PIC X(6).
  4803             20  CM-SSN-LN3.
  4804                 25  CM-INSURED-INITIALS-A2.
  4805                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4806                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4807                 25 CM-PART-LAST-NAME-A2         PIC X.
  4808
  4809     12  CM-CONTROL-BY-CERT-NO.
  4810         16  CM-COMPANY-CD-A4              PIC X.
  4811         16  CM-CERT-NO-A4                 PIC X(11).
  4812
  4813     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  88
* EL1278.cbl
  4814         16  CM-COMPANY-CD-A5              PIC X.
  4815         16  CM-MEMBER-NO.
  4816             20  CM-MEMB-STATE             PIC XX.
  4817             20  CM-MEMB-ACCOUNT           PIC X(6).
  4818             20  CM-MEMB-LN4.
  4819                 25  CM-INSURED-INITIALS-A5.
  4820                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4821                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4822                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4823
  4824     12  CM-INSURED-PROFILE-DATA.
  4825         16  CM-INSURED-FIRST-NAME.
  4826             20  CM-INSURED-1ST-INIT       PIC X.
  4827             20  FILLER                    PIC X(9).
  4828         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4829         16  CM-INSURED-SEX                PIC X.
  4830             88  CM-SEX-MALE                  VALUE 'M'.
  4831             88  CM-SEX-FEMAL                 VALUE 'F'.
  4832         16  CM-INSURED-JOINT-AGE          PIC 99.
  4833         16  CM-JOINT-INSURED-NAME.
  4834             20  CM-JT-LAST-NAME           PIC X(15).
  4835             20  CM-JT-FIRST-NAME.
  4836                 24  CM-JT-1ST-INIT        PIC X.
  4837                 24  FILLER                PIC X(9).
  4838             20  CM-JT-INITIAL             PIC X.
  4839
  4840     12  CM-LIFE-DATA.
  4841         16  CM-LF-BENEFIT-CD              PIC XX.
  4842         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4843         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4844         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4845         16  CM-LF-DEV-CODE                PIC XXX.
  4846         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4847         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4848         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4849         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4850         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4851         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4852         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4853         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4854         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4855         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4856         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4857         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4858         16  FILLER                        PIC XX.
  4859
  4860     12  CM-AH-DATA.
  4861         16  CM-AH-BENEFIT-CD              PIC XX.
  4862         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4863         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4864         16  CM-AH-DEV-CODE                PIC XXX.
  4865         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4866         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4867         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4868         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4869         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4870         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4871         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  89
* EL1278.cbl
  4872         16  CM-AH-PAID-THRU-DT            PIC XX.
  4873             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4874         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4875         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4876         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4877         16  FILLER                        PIC X.
  4878
  4879     12  CM-LOAN-INFORMATION.
  4880         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4881         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4882                                           PIC S9(5)V99  COMP-3.
  4883         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4884         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4885         16  CM-PAY-FREQUENCY              PIC S99.
  4886         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4887         16  CM-RATE-CLASS                 PIC XX.
  4888         16  CM-BENEFICIARY                PIC X(25).
  4889         16  CM-POLICY-FORM-NO             PIC X(12).
  4890         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4891         16  CM-LAST-ADD-ON-DT             PIC XX.
  4892         16  CM-DEDUCTIBLE-AMOUNTS.
  4893             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4894             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4895         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4896             20  CM-RESIDENT-STATE         PIC XX.
  4897             20  CM-RATE-CODE              PIC X(4).
  4898             20  FILLER                    PIC XX.
  4899         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4900             20  CM-LOAN-OFFICER           PIC X(5).
  4901             20  FILLER                    PIC XXX.
  4902         16  CM-CSR-CODE                   PIC XXX.
  4903         16  CM-UNDERWRITING-CODE          PIC X.
  4904             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4905         16  CM-POST-CARD-IND              PIC X.
  4906         16  CM-NH-INTERFACE-SW            PIC X.
  4907         16  CM-PREMIUM-TYPE               PIC X.
  4908             88  CM-SING-PRM                  VALUE '1'.
  4909             88  CM-O-B-COVERAGE              VALUE '2'.
  4910             88  CM-OPEN-END                  VALUE '3'.
  4911         16  CM-IND-GRP-TYPE               PIC X.
  4912             88  CM-INDIVIDUAL                VALUE 'I'.
  4913             88  CM-GROUP                     VALUE 'G'.
  4914         16  CM-SKIP-CODE                  PIC X.
  4915             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4916             88  SKIP-JULY                    VALUE '1'.
  4917             88  SKIP-AUGUST                  VALUE '2'.
  4918             88  SKIP-SEPTEMBER               VALUE '3'.
  4919             88  SKIP-JULY-AUG                VALUE '4'.
  4920             88  SKIP-AUG-SEPT                VALUE '5'.
  4921             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4922             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4923             88  SKIP-JUNE                    VALUE '8'.
  4924             88  SKIP-JUNE-JULY               VALUE '9'.
  4925             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4926             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4927         16  CM-PAYMENT-MODE               PIC X.
  4928             88  PAY-MONTHLY                  VALUE SPACE.
  4929             88  PAY-WEEKLY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  90
* EL1278.cbl
  4930             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4931             88  PAY-BI-WEEKLY                VALUE '3'.
  4932             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4933         16  CM-LOAN-NUMBER                PIC X(8).
  4934         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4935         16  CM-OLD-LOF                    PIC XXX.
  4936*        16  CM-LOAN-OFFICER               PIC XXX.
  4937         16  CM-REIN-TABLE                 PIC XXX.
  4938         16  CM-SPECIAL-REIN-CODE          PIC X.
  4939         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4940         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4941         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4942
  4943     12  CM-STATUS-DATA.
  4944         16  CM-ENTRY-STATUS               PIC X.
  4945         16  CM-ENTRY-DT                   PIC XX.
  4946
  4947         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4948         16  CM-LF-CANCEL-DT               PIC XX.
  4949         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4950
  4951         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4952         16  CM-LF-DEATH-DT                PIC XX.
  4953         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4954
  4955         16  CM-LF-CURRENT-STATUS          PIC X.
  4956             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4957                                                'M' '4' '5' '9'.
  4958             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4959             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4960             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4961             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4962             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4963             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4964             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4965             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4966             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4967             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4968             88  CM-LF-DECLINED               VALUE 'D'.
  4969             88  CM-LF-VOIDED                 VALUE 'V'.
  4970
  4971         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4972         16  CM-AH-CANCEL-DT               PIC XX.
  4973         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4974
  4975         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4976         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4977         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4978
  4979         16  CM-AH-CURRENT-STATUS          PIC X.
  4980             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4981                                                'M' '4' '5' '9'.
  4982             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4983             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4984             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4985             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4986             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4987             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  91
* EL1278.cbl
  4988             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4989             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4990             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4991             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4992             88  CM-AH-DECLINED               VALUE 'D'.
  4993             88  CM-AH-VOIDED                 VALUE 'V'.
  4994
  4995         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4996             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4997             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4998             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4999         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5000
  5001         16  CM-ENTRY-BATCH                PIC X(6).
  5002         16  CM-LF-EXIT-BATCH              PIC X(6).
  5003         16  CM-AH-EXIT-BATCH              PIC X(6).
  5004         16  CM-LAST-MONTH-END             PIC XX.
  5005
  5006     12  CM-NOTE-SW                        PIC X.
  5007         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5008         88  CERT-NOTES-PRESENT               VALUE '1'.
  5009         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5010         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5011         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5012         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5013         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5014         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5015     12  CM-COMP-EXCP-SW                   PIC X.
  5016         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5017         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5018     12  CM-INSURED-ADDRESS-SW             PIC X.
  5019         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5020         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5021
  5022*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5023     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5024     12  FILLER                            PIC X.
  5025
  5026*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5027     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5028     12  FILLER                            PIC X.
  5029*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5030     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5031
  5032     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5033         88  CERT-ADDED-BATCH                 VALUE ' '.
  5034         88  CERT-ADDED-ONLINE                VALUE '1'.
  5035         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5036         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5037         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5038     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5039         88  CERT-AS-LOADED                   VALUE ' '.
  5040         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5041         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5042         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5043         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5044         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5045         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  92
* EL1278.cbl
  5046         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5047
  5048     12  CM-ACCOUNT-COMM-PCTS.
  5049         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5050         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5051
  5052     12  CM-USER-FIELD                     PIC X.
  5053     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5054     12  CM-CLP-STATE                      PIC XX.
  5055     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5056     12  CM-USER-RESERVED                  PIC XXX.
  5057     12  FILLER REDEFINES CM-USER-RESERVED.
  5058         16  CM-AH-CLASS-CD                PIC XX.
  5059         16  F                             PIC X.
  5060******************************************************************
  5061*                            COPY ERCMAIL.
  5062******************************************************************
  5063*                                                                *
  5064*                                                                *
  5065*                            ERCMAIL                             *
  5066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5067*                            VMOD=2.003                          *
  5068*                                                                *
  5069*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5070*                                                                *
  5071*   FILE TYPE = VSAM,KSDS                                        *
  5072*   RECORD SIZE = 374   RECFORM = FIX                            *
  5073*                                                                *
  5074*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5075*   ALTERNATE PATH    = NOT USED                                 *
  5076*                                                                *
  5077*   LOG = YES                                                    *
  5078*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5079******************************************************************
  5080*                   C H A N G E   L O G
  5081*
  5082* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5083*-----------------------------------------------------------------
  5084*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5085* EFFECTIVE    NUMBER
  5086*-----------------------------------------------------------------
  5087* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5088* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5089* 111108                   PEMA  ADD CRED BENE ADDR2
  5090******************************************************************
  5091
  5092 01  MAILING-DATA.
  5093     12  MA-RECORD-ID                      PIC XX.
  5094         88  VALID-MA-ID                       VALUE 'MA'.
  5095
  5096     12  MA-CONTROL-PRIMARY.
  5097         16  MA-COMPANY-CD                 PIC X.
  5098         16  MA-CARRIER                    PIC X.
  5099         16  MA-GROUPING.
  5100             20  MA-GROUPING-PREFIX        PIC XXX.
  5101             20  MA-GROUPING-PRIME         PIC XXX.
  5102         16  MA-STATE                      PIC XX.
  5103         16  MA-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  93
* EL1278.cbl
  5104             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5105             20  MA-ACCOUNT-PRIME          PIC X(6).
  5106         16  MA-CERT-EFF-DT                PIC XX.
  5107         16  MA-CERT-NO.
  5108             20  MA-CERT-PRIME             PIC X(10).
  5109             20  MA-CERT-SFX               PIC X.
  5110
  5111     12  FILLER                            PIC XX.
  5112
  5113     12  MA-ACCESS-CONTROL.
  5114         16  MA-SOURCE-SYSTEM              PIC XX.
  5115             88  MA-FROM-CREDIT                VALUE 'CR'.
  5116             88  MA-FROM-VSI                   VALUE 'VS'.
  5117             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5118             88  MA-FROM-OTHER                 VALUE 'OT'.
  5119         16  MA-RECORD-ADD-DT              PIC XX.
  5120         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5121         16  MA-LAST-MAINT-DT              PIC XX.
  5122         16  MA-LAST-MAINT-BY              PIC XXXX.
  5123         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5124
  5125     12  MA-PROFILE-INFO.
  5126         16  MA-QUALIFY-CODE-1             PIC XX.
  5127         16  MA-QUALIFY-CODE-2             PIC XX.
  5128         16  MA-QUALIFY-CODE-3             PIC XX.
  5129         16  MA-QUALIFY-CODE-4             PIC XX.
  5130         16  MA-QUALIFY-CODE-5             PIC XX.
  5131
  5132         16  MA-INSURED-LAST-NAME          PIC X(15).
  5133         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5134         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5135         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5136         16  MA-INSURED-BIRTH-DT           PIC XX.
  5137         16  MA-INSURED-SEX                PIC X.
  5138             88  MA-SEX-MALE                   VALUE 'M'.
  5139             88  MA-SEX-FEMALE                 VALUE 'F'.
  5140         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5141
  5142         16  MA-ADDRESS-CORRECTED          PIC X.
  5143         16  MA-JOINT-BIRTH-DT             PIC XX.
  5144*        16  FILLER                        PIC X(12).
  5145
  5146         16  MA-ADDRESS-LINE-1             PIC X(30).
  5147         16  MA-ADDRESS-LINE-2             PIC X(30).
  5148         16  MA-CITY-STATE.
  5149             20  MA-CITY                   PIC X(28).
  5150             20  MA-ADDR-STATE             PIC XX.
  5151         16  MA-ZIP.
  5152             20  MA-ZIP-CODE.
  5153                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5154                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5155                 24  FILLER                PIC X(4).
  5156             20  MA-ZIP-PLUS4              PIC X(4).
  5157         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5158             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5159             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5160             20  FILLER                    PIC X(3).
  5161
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  94
* EL1278.cbl
  5162         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5163
  5164         16  FILLER                        PIC XXX.
  5165*        16  FILLER                        PIC X(10).
  5166
  5167     12  MA-CRED-BENE-INFO.
  5168         16  MA-CRED-BENE-NAME                 PIC X(25).
  5169         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5170         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5171         16  MA-CRED-BENE-CTYST.
  5172             20  MA-CRED-BENE-CITY             PIC X(28).
  5173             20  MA-CRED-BENE-STATE            PIC XX.
  5174         16  MA-CRED-BENE-ZIP.
  5175             20  MA-CB-ZIP-CODE.
  5176                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5177                     88  MA-CB-CANADIAN-POST-CODE
  5178                                           VALUE 'A' THRU 'Z'.
  5179                 24  FILLER                    PIC X(4).
  5180             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5181         16  MA-CB-CANADIAN-POSTAL-CODE
  5182                            REDEFINES MA-CRED-BENE-ZIP.
  5183             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5184             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5185             20  FILLER                        PIC X(3).
  5186     12  MA-POST-CARD-MAIL-DATA.
  5187         16  MA-MAIL-DATA OCCURS 7.
  5188             20  MA-MAIL-TYPE              PIC X.
  5189                 88  MA-12MO-MAILING           VALUE '1'.
  5190                 88  MA-EXP-MAILING            VALUE '2'.
  5191             20  MA-MAIL-STATUS            PIC X.
  5192                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5193                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5194                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5195             20  MA-MAIL-DATE              PIC XX.
  5196     12  FILLER                            PIC XX.
  5197     12  FILLER                            PIC XX.
  5198*    12  FILLER                            PIC X(30).
  5199******************************************************************
  5200*                            COPY ELCCRTO.
  5201******************************************************************
  5202*                                                                *
  5203*                            ELCCRTO.                            *
  5204*                                                                *
  5205*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5206*                                                                *
  5207*   FILE TYPE = VSAM,KSDS                                        *
  5208*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5209*                                                                *
  5210*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5211*                                                                *
  5212*   LOG = YES                                                    *
  5213*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5214******************************************************************
  5215*                   C H A N G E   L O G
  5216*
  5217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5218*-----------------------------------------------------------------
  5219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  95
* EL1278.cbl
  5220* EFFECTIVE    NUMBER
  5221*-----------------------------------------------------------------
  5222* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5223* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5224* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5225* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5226******************************************************************
  5227 01  ORIGINAL-CERTIFICATE.
  5228     12  OC-RECORD-ID                      PIC XX.
  5229         88  VALID-OC-ID                      VALUE 'OC'.
  5230     12  OC-CONTROL-PRIMARY.
  5231         16  OC-COMPANY-CD                 PIC X.
  5232         16  OC-CARRIER                    PIC X.
  5233         16  OC-GROUPING                   PIC X(6).
  5234         16  OC-STATE                      PIC XX.
  5235         16  OC-ACCOUNT                    PIC X(10).
  5236         16  OC-CERT-EFF-DT                PIC XX.
  5237         16  OC-CERT-NO.
  5238             20  OC-CERT-PRIME             PIC X(10).
  5239             20  OC-CERT-SFX               PIC X.
  5240         16  OC-RECORD-TYPE                PIC X.
  5241         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5242     12  OC-LAST-MAINT-DT                  PIC XX.
  5243     12  OC-LAST-MAINT-BY                  PIC X(4).
  5244     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5245     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5246     12  FILLER                            PIC X(49).
  5247     12  OC-ORIG-REC.
  5248         16  OC-INS-LAST-NAME              PIC X(15).
  5249         16  OC-INS-FIRST-NAME             PIC X(10).
  5250         16  OC-INS-MIDDLE-INIT            PIC X.
  5251         16  OC-INS-AGE                    PIC S999     COMP-3.
  5252         16  OC-JNT-LAST-NAME              PIC X(15).
  5253         16  OC-JNT-FIRST-NAME             PIC X(10).
  5254         16  OC-JNT-MIDDLE-INIT            PIC X.
  5255         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5256         16  OC-LF-BENCD                   PIC XX.
  5257         16  OC-LF-TERM                    PIC S999      COMP-3.
  5258         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5259         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5260         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5261         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5262         16  OC-LF-EXP-DT                  PIC XX.
  5263         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5264         16  OC-LF-CANCEL-DT               PIC XX.
  5265         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5266         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5267         16  OC-AH-BENCD                   PIC XX.
  5268         16  OC-AH-TERM                    PIC S999      COMP-3.
  5269         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5270         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5271         16  OC-AH-EXP-DT                  PIC XX.
  5272         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5273         16  OC-AH-CP                      PIC 99.
  5274         16  OC-AH-CANCEL-DT               PIC XX.
  5275         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5276         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5277         16  OC-CRED-BENE-NAME             PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  96
* EL1278.cbl
  5278         16  OC-1ST-PMT-DT                 PIC XX.
  5279         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5280         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5281         16  FILLER                        PIC X(213).
  5282
  5283     12  FILLER                            PIC X(50).
  5284******************************************************************
  5285*                            COPY ERCFORM.
  5286******************************************************************
  5287*                                                                *
  5288*                                                                *
  5289*                            ERCFORM.                            *
  5290*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5291*                            VMOD=2.003                          *
  5292*                                                                *
  5293*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5294*                                                                *
  5295*    FILE TYPE = VSAM,KSDS                                       *
  5296*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5297*                                                                *
  5298*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5299*                                                                *
  5300*    LOG = YES                                                   *
  5301*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5302******************************************************************
  5303 01  FORM-MASTER.
  5304    12  FO-RECORD-ID                 PIC X(02).
  5305        88  VALID-FO-ID                  VALUE 'FO'.
  5306
  5307    12  FO-CONTROL-PRIMARY.
  5308        16  FO-COMPANY-CD            PIC X(01).
  5309        16  FO-STATE                 PIC X(02).
  5310        16  FO-FORM-ID               PIC X(12).
  5311        16  FO-FORM-EXP-DT           PIC X(02).
  5312
  5313    12  FO-POLICY-FORM-DATA.
  5314        16  FO-IND-GRP-CD            PIC X(01).
  5315        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5316        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5317        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5318        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5319        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5320        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5321        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5322        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5323        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5324        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5325        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5326        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5327        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5328        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5329        16  FO-APP-CERT-USE-CD       PIC X(01).
  5330
  5331    12  FILLER                       PIC X(29).
  5332
  5333    12  FO-FORM-PLAN-TABLE.
  5334        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5335            20  FO-PLAN-TYPE         PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  97
* EL1278.cbl
  5336            20  FO-PLAN-ID           PIC X(02).
  5337            20  FO-PLAN-TERM         PIC 9(03).
  5338            20  FO-PLAN-REFUND-METHOD
  5339                                     PIC X.
  5340
  5341    12  FILLER                       PIC X(30).
  5342
  5343    12  FO-COMMENTS-AREA.
  5344        16  FO-COMMENT-LINE-1        PIC X(78).
  5345
  5346    12  FILLER                       PIC X(20).
  5347
  5348    12  FO-MAINT-INFORMATION.
  5349        16  FO-LAST-MAINT-DT         PIC X(02).
  5350        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5351        16  FO-LAST-MAINT-BY         PIC X(04).
  5352*                            COPY ELCMSTR.
  5353******************************************************************
  5354*                                                                *
  5355*                            ELCMSTR.                            *
  5356*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5357*                            VMOD=2.012                          *
  5358*                                                                *
  5359*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5360*                                                                *
  5361*   FILE TYPE = VSAM,KSDS                                        *
  5362*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5363*                                                                *
  5364*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5365*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5366*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5367*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5368*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5369*                                                 RKP=75,LEN=21  *
  5370*                                                                *
  5371*   **** NOTE ****                                               *
  5372*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5373*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5374*                                                                *
  5375*   LOG = YES                                                    *
  5376*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5377******************************************************************
  5378*                   C H A N G E   L O G
  5379*
  5380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5381*-----------------------------------------------------------------
  5382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5383* EFFECTIVE    NUMBER
  5384*-----------------------------------------------------------------
  5385* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5386* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5387******************************************************************
  5388 01  CLAIM-MASTER.
  5389     12  CL-RECORD-ID                PIC XX.
  5390         88  VALID-CL-ID         VALUE 'CL'.
  5391
  5392     12  CL-CONTROL-PRIMARY.
  5393         16  CL-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  98
* EL1278.cbl
  5394         16  CL-CARRIER              PIC X.
  5395         16  CL-CLAIM-NO             PIC X(7).
  5396         16  CL-CERT-NO.
  5397             20  CL-CERT-PRIME       PIC X(10).
  5398             20  CL-CERT-SFX         PIC X.
  5399
  5400     12  CL-CONTROL-BY-NAME.
  5401         16  CL-COMPANY-CD-A1        PIC X.
  5402         16  CL-INSURED-LAST-NAME    PIC X(15).
  5403         16  CL-INSURED-NAME.
  5404             20  CL-INSURED-1ST-NAME PIC X(12).
  5405             20  CL-INSURED-MID-INIT PIC X.
  5406
  5407     12  CL-CONTROL-BY-SSN.
  5408         16  CL-COMPANY-CD-A2        PIC X.
  5409         16  CL-SOC-SEC-NO.
  5410             20  CL-SSN-STATE        PIC XX.
  5411             20  CL-SSN-ACCOUNT      PIC X(6).
  5412             20  CL-SSN-LN3          PIC X(3).
  5413
  5414     12  CL-CONTROL-BY-CERT-NO.
  5415         16  CL-COMPANY-CD-A4        PIC X.
  5416         16  CL-CERT-NO-A4.
  5417             20  CL-CERT-A4-PRIME    PIC X(10).
  5418             20  CL-CERT-A4-SFX      PIC X.
  5419
  5420     12  CL-CONTROL-BY-CCN.
  5421         16  CL-COMPANY-CD-A5        PIC X.
  5422         16  CL-CCN-A5.
  5423             20  CL-CCN.
  5424                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5425                 24  CL-CCN-PRIME-A5 PIC X(12).
  5426             20  CL-CCN-FILLER-A5    PIC X(4).
  5427
  5428     12  CL-INSURED-PROFILE-DATA.
  5429         16  CL-INSURED-BIRTH-DT     PIC XX.
  5430         16  CL-INSURED-SEX-CD       PIC X.
  5431             88  INSURED-IS-MALE        VALUE 'M'.
  5432             88  INSURED-IS-FEMALE      VALUE 'F'.
  5433             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5434         16  CL-INSURED-OCC-CD       PIC X(6).
  5435         16  FILLER                  PIC X(5).
  5436
  5437     12  CL-PROCESSING-INFO.
  5438         16  CL-PROCESSOR-ID         PIC X(4).
  5439         16  CL-CLAIM-STATUS         PIC X.
  5440             88  CLAIM-IS-OPEN          VALUE 'O'.
  5441             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5442         16  CL-CLAIM-TYPE           PIC X.
  5443*            88  AH-CLAIM               VALUE 'A'.
  5444*            88  LIFE-CLAIM             VALUE 'L'.
  5445*            88  PROPERTY-CLAIM         VALUE 'P'.
  5446*            88  IUI-CLAIM              VALUE 'I'.
  5447*            88  GAP-CLAIM              VALUE 'G'.
  5448         16  CL-CLAIM-PREM-TYPE      PIC X.
  5449             88  SINGLE-PREMIUM         VALUE '1'.
  5450             88  O-B-COVERAGE           VALUE '2'.
  5451             88  OPEN-END-COVERAGE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  99
* EL1278.cbl
  5452         16  CL-INCURRED-DT          PIC XX.
  5453         16  CL-REPORTED-DT          PIC XX.
  5454         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5455         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5456         16  CL-LAST-PMT-DT          PIC XX.
  5457         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5458         16  CL-PAID-THRU-DT         PIC XX.
  5459         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5460         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5461         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5462         16  CL-PMT-CALC-METHOD      PIC X.
  5463             88  CL-360-DAY-YR          VALUE '1'.
  5464             88  CL-365-DAY-YR          VALUE '2'.
  5465             88  CL-FULL-MONTHS         VALUE '3'.
  5466         16  CL-CAUSE-CD             PIC X(6).
  5467
  5468         16  CL-PRIME-CERT-NO.
  5469             20  CL-PRIME-CERT-PRIME PIC X(10).
  5470             20  CL-PRIME-CERT-SFX   PIC X.
  5471
  5472         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5473             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5474             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5475
  5476         16  CL-MICROFILM-NO         PIC X(10).
  5477         16  CL-PROG-FORM-TYPE       PIC X.
  5478         16  CL-LAST-ADD-ON-DT       PIC XX.
  5479
  5480         16  CL-LAST-REOPEN-DT       PIC XX.
  5481         16  CL-LAST-CLOSE-DT        PIC XX.
  5482         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5483             88  FINAL-PAID             VALUE '1'.
  5484             88  CLAIM-DENIED           VALUE '2'.
  5485             88  AUTO-CLOSE             VALUE '3'.
  5486             88  MANUAL-CLOSE           VALUE '4'.
  5487             88  BENEFITS-CHANGED       VALUE 'C'.
  5488             88  SETUP-ERRORS           VALUE 'E'.
  5489         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5490         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5491         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5492             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5493         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5494         16  FILLER                  PIC X.
  5495
  5496     12  CL-CERTIFICATE-DATA.
  5497         16  CL-CERT-ORIGIN          PIC X.
  5498             88  CERT-WAS-ONLINE        VALUE '1'.
  5499             88  CERT-WAS-CREATED       VALUE '2'.
  5500             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5501         16  CL-CERT-KEY-DATA.
  5502             20  CL-CERT-CARRIER     PIC X.
  5503             20  CL-CERT-GROUPING    PIC X(6).
  5504             20  CL-CERT-STATE       PIC XX.
  5505             20  CL-CERT-ACCOUNT.
  5506                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5507                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5508             20  CL-CERT-EFF-DT      PIC XX.
  5509
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 100
* EL1278.cbl
  5510     12  CL-STATUS-CONTROLS.
  5511         16  CL-PRIORITY-CD          PIC X.
  5512             88  CONFIDENTIAL-DATA      VALUE '8'.
  5513             88  HIGHEST-PRIORITY       VALUE '9'.
  5514         16  CL-SUPV-ATTN-CD         PIC X.
  5515             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5516             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5517         16  CL-PURGED-DT            PIC XX.
  5518         16  CL-RESTORED-DT          PIC XX.
  5519         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5520         16  CL-NEXT-RESEND-DT       PIC XX.
  5521         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5522         16  FILLER                  PIC XX.
  5523         16  CL-LAST-MAINT-DT        PIC XX.
  5524         16  CL-LAST-MAINT-USER      PIC X(4).
  5525         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5526         16  CL-LAST-MAINT-TYPE      PIC X.
  5527             88  CLAIM-SET-UP           VALUE ' '.
  5528             88  PAYMENT-MADE           VALUE '1'.
  5529             88  LETTER-SENT            VALUE '2'.
  5530             88  MASTER-WAS-ALTERED     VALUE '3'.
  5531             88  MASTER-WAS-RESTORED    VALUE '4'.
  5532             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5533             88  FILE-CONVERTED         VALUE '6'.
  5534             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5535             88  ERROR-CORRECTION       VALUE 'E'.
  5536         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5537         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5538         16  CL-BENEFICIARY          PIC X(10).
  5539         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5540         16  CL-DENIAL-TYPE          PIC X.
  5541             88  CL-TYPE-DENIAL          VALUE '1'.
  5542             88  CL-TYPE-RESCISSION      VALUE '2'.
  5543             88  CL-TYPE-REFORMATION     VALUE '3'.
  5544             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5545             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5546         16  FILLER                  PIC X(5).
  5547
  5548     12  CL-TRAILER-CONTROLS.
  5549         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5550             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5551             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5552             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5553         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5554         16  FILLER                  PIC XX.
  5555         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5556         16  CL-ADDRESS-TRAILER-CNT.
  5557             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5558                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5559             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5560                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5561             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5562                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5563             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5564                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5565             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5566                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5567             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 101
* EL1278.cbl
  5568                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5569             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5570                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5571
  5572     12  CL-CV-REFERENCE-NO.
  5573         16  CL-CV-REFNO-PRIME       PIC X(18).
  5574         16  CL-CV-REFNO-SFX         PIC XX.
  5575
  5576     12  CL-FILE-LOCATION            PIC X(4).
  5577
  5578     12  CL-PROCESS-ERRORS.
  5579         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5580             88  NO-FATAL-ERRORS        VALUE ZERO.
  5581         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5582             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5583
  5584     12  CL-PRODUCT-CD               PIC X.
  5585
  5586     12  CL-CURRENT-KEY-DATA.
  5587         16  CL-CURRENT-CARRIER      PIC X.
  5588         16  CL-CURRENT-GROUPING     PIC X(6).
  5589         16  CL-CURRENT-STATE        PIC XX.
  5590         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5591
  5592     12  CL-ASSOCIATES               PIC X.
  5593         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5594         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5595         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5596         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5597
  5598     12  CL-ACTIVITY-CODE            PIC 99.
  5599     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5600     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5601
  5602     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5603     12  CL-LAG-REPORT-CODE          PIC 9.
  5604     12  CL-LOAN-TYPE                PIC XX.
  5605     12  CL-LEGAL-STATE              PIC XX.
  5606
  5607*    12  FILLER                      PIC X(5).
  5608     12  CL-YESNOSW                  PIC X.
  5609     12  FILLER                      PIC X(4).
  5610*                            COPY ERCPDEF.
  5611******************************************************************
  5612*                                                                *
  5613*                                                                *
  5614*                            ERCPDEF.                            *
  5615*                                                                *
  5616*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5617*                                                                *
  5618*    FILE TYPE = VSAM,KSDS                                       *
  5619*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5620*                                                                *
  5621*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5622*                                                                *
  5623*    LOG = YES                                                   *
  5624*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5625******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 102
* EL1278.cbl
  5626 01  PRODUCT-MASTER.
  5627    12  PD-RECORD-ID                 PIC X(02).
  5628        88  VALID-PD-ID                  VALUE 'PD'.
  5629    12  PD-CONTROL-PRIMARY.
  5630        16  PD-COMPANY-CD            PIC X.
  5631        16  PD-STATE                 PIC XX.
  5632        16  PD-PRODUCT-CD            PIC XXX.
  5633        16  PD-FILLER                PIC X(7).
  5634        16  PD-BEN-TYPE              PIC X.
  5635        16  PD-BEN-CODE              PIC XX.
  5636        16  PD-PROD-EXP-DT           PIC XX.
  5637    12  FILLER                       PIC X(50).
  5638    12  PD-PRODUCT-DATA OCCURS 8.
  5639        16  PD-PROD-CODE             PIC X.
  5640            88  PD-PROD-LIFE           VALUE 'L'.
  5641            88  PD-PROD-PROP           VALUE 'P'.
  5642            88  PD-PROD-AH             VALUE 'A'.
  5643            88  PD-PROD-IU             VALUE 'I'.
  5644            88  PD-PROD-GAP            VALUE 'G'.
  5645        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5646        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5647        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5648        16  PD-MAX-TERM              PIC S999        COMP-3.
  5649        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5650        16  FILLER                   PIC X.
  5651        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5652        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5653        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5654        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5655        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5656        16  PD-REC-CRIT-PERIOD       PIC X.
  5657        16  PD-RTW-MOS               PIC 99.
  5658        16  FILLER                   PIC X(5).
  5659    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5660    12  PD-TERM-LIMITS OCCURS 15.
  5661        16  PD-LOW-TERM              PIC S999        COMP-3.
  5662        16  PD-HI-TERM               PIC S999        COMP-3.
  5663*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5664    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5665        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5666        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5667    12  PD-EARN-FACTORS.
  5668        16  FILLER OCCURS 15.
  5669            20  FILLER OCCURS 15.
  5670                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5671    12  PD-PRODUCT-DESC              PIC X(80).
  5672    12  PD-TRUNCATED                 PIC X.
  5673    12  FILLER                       PIC X(59).
  5674    12  PD-MAINT-INFORMATION.
  5675        16  PD-LAST-MAINT-DT         PIC X(02).
  5676        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5677        16  PD-LAST-MAINT-BY         PIC X(04).
  5678*                            COPY ELCCRTT.
  5679******************************************************************
  5680*                                                                *
  5681*                            ELCCRTT.                            *
  5682*                                                                *
  5683*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 103
* EL1278.cbl
  5684*                                                                *
  5685*   FILE TYPE = VSAM,KSDS                                        *
  5686*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5687*                                                                *
  5688*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5689*                                                                *
  5690*   LOG = YES                                                    *
  5691*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5692******************************************************************
  5693*                   C H A N G E   L O G
  5694*
  5695* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5696*-----------------------------------------------------------------
  5697*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5698* EFFECTIVE    NUMBER
  5699*-----------------------------------------------------------------
  5700* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5701* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5702* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5703* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5704******************************************************************
  5705
  5706 01  CERTIFICATE-TRAILERS.
  5707     12  CS-RECORD-ID                      PIC XX.
  5708         88  VALID-CS-ID                      VALUE 'CS'.
  5709
  5710     12  CS-CONTROL-PRIMARY.
  5711         16  CS-COMPANY-CD                 PIC X.
  5712         16  CS-CARRIER                    PIC X.
  5713         16  CS-GROUPING                   PIC X(6).
  5714         16  CS-STATE                      PIC XX.
  5715         16  CS-ACCOUNT                    PIC X(10).
  5716         16  CS-CERT-EFF-DT                PIC XX.
  5717         16  CS-CERT-NO.
  5718             20  CS-CERT-PRIME             PIC X(10).
  5719             20  CS-CERT-SFX               PIC X.
  5720         16  CS-TRAILER-TYPE               PIC X.
  5721             88  COMM-TRLR           VALUE 'A'.
  5722             88  FUTURE-TRLR         VALUE 'B'.
  5723             88  CERT-DATA-TRLR      VALUE 'C'.
  5724
  5725     12  CS-DATA-AREA                      PIC X(516).
  5726
  5727     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5728         16  CS-BANK-COMMISSION-AREA.
  5729             20  CS-BANK-COMMS       OCCURS 10.
  5730                 24  CS-AGT                PIC X(10).
  5731                 24  CS-COM-TYP            PIC X.
  5732                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5733                 24  CS-RECALC-LV-INDIC    PIC X.
  5734                 24  FILLER                PIC X(10).
  5735         16  FILLER                        PIC X(256).
  5736
  5737     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5738         16  CS-VIN-NUMBER                 PIC X(17).
  5739         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5740         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5741         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 104
* EL1278.cbl
  5742         16  FILLER                        PIC X(496).
  5743******************************************************************
  5744 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5745                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5746                          MAILING-DATA ORIGINAL-CERTIFICATE
  5747                          FORM-MASTER CLAIM-MASTER
  5748                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5749 0000-DFHEXIT SECTION.
  5750     MOVE '9#                    $   ' TO DFHEIV0.
  5751     MOVE 'EL1278' TO DFHEIV1.
  5752     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5753*    SERVICE RELOAD PARMLIST.
  5754
  5755     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5756     MOVE '5'                    TO  DC-OPTION-CODE.
  5757
  5758     PERFORM 9600-DATE-LINK.
  5759
  5760     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5761     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5762     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5763     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5764     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5765     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5766     MOVE EIBTRMID               TO  QID-TERM.
  5767
  5768     IF EIBCALEN  IS EQUAL TO  ZERO
  5769         GO TO 8700-UNAUTHORIZED-ACCESS.
  5770
  5771     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5772         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5773             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5774             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5775             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5776             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5777             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5778             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5779             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5780             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5781         ELSE
  5782             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5783             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5784             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5785             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5786             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5787             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5788             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5789             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5790             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5791
  5792     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5793         GO TO 9300-CLEAR.
  5794
  5795     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5796         NEXT SENTENCE
  5797     ELSE
  5798
  5799* EXEC CICS READQ TS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 105
* EL1278.cbl
  5800*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5801*            INTO    (SECURITY-CONTROL)
  5802*            LENGTH  (SC-COMM-LENGTH)
  5803*            ITEM    (SC-ITEM)
  5804*        END-EXEC
  5805*    MOVE '*$II   L              ''   #00005794' TO DFHEIV0
  5806     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5807     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5808     MOVE X'2020233030303035373934' TO DFHEIV0(25:11)
  5809     CALL 'kxdfhei1' USING DFHEIV0,
  5810           PI-SECURITY-TEMP-STORE-ID,
  5811           SECURITY-CONTROL,
  5812           SC-COMM-LENGTH,
  5813           SC-ITEM,
  5814           DFHEIV99,
  5815           DFHEIV99
  5816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5817         MOVE SC-CREDIT-DISPLAY (33)
  5818                                 TO  PI-DISPLAY-CAP
  5819         MOVE SC-CREDIT-UPDATE  (33)
  5820                                 TO  PI-MODIFY-CAP
  5821         MOVE SC-CREDIT-UPDATE  (32)
  5822                                 TO  PI-MODIFY-CERT-CAP
  5823         IF NOT  DISPLAY-CAP
  5824             MOVE 'READ'         TO  SM-READ
  5825             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5826             MOVE ER-0070        TO  EMI-ERROR
  5827             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5828             GO TO 8100-SEND-INITIAL-MAP.
  5829
  5830     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5831         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5832         MOVE LOW-VALUES         TO  EL127HI
  5833         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5834                                     PI-LF-CANCEL-DATE
  5835                                     WS-AH-CANCEL-DATE
  5836                                     PI-AH-CANCEL-DATE
  5837         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5838                                     PI-LF-CANCEL-DATE-ED
  5839                                     WS-AH-CANCEL-DATE-ED
  5840                                     PI-AH-CANCEL-DATE-ED
  5841         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5842                                     PI-EARNING-METHOD-AH
  5843         PERFORM 0500-FORMAT-SCREEN
  5844         GO TO 8100-SEND-INITIAL-MAP.
  5845
  5846     IF NOT  MODIFY-CAP
  5847         MOVE 'UPDATE'           TO  SM-READ
  5848         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5849         MOVE ER-0070            TO  EMI-ERROR
  5850         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5851         GO TO 8100-SEND-INITIAL-MAP.
  5852
  5853
  5854* EXEC CICS HANDLE CONDITION
  5855*        PGMIDERR  (9500-PGMID-ERROR)
  5856*        ERROR     (9900-ABEND)
  5857*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 106
* EL1278.cbl
  5858*    MOVE '"$L.                  ! " #00005836' TO DFHEIV0
  5859     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5861     MOVE X'2220233030303035383336' TO DFHEIV0(25:11)
  5862     CALL 'kxdfhei1' USING DFHEIV0
  5863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5864
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 107
* EL1278.cbl
  5866 0200-RECEIVE.
  5867     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5868         MOVE ER-0008            TO  EMI-ERROR
  5869         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5870         MOVE -1                 TO  HLCANCL
  5871         GO TO 8200-SEND-DATAONLY.
  5872
  5873
  5874* EXEC CICS RECEIVE
  5875*        MAP     (MAP-NAME)
  5876*        MAPSET  (MAPSET-NAME)
  5877*        INTO    (EL127HI)
  5878*    END-EXEC.
  5879     MOVE LENGTH OF
  5880      EL127HI
  5881       TO DFHEIV11
  5882*    MOVE '8"T I  L              ''   #00005848' TO DFHEIV0
  5883     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5885     MOVE X'2020233030303035383438' TO DFHEIV0(25:11)
  5886     CALL 'kxdfhei1' USING DFHEIV0,
  5887           MAP-NAME,
  5888           EL127HI,
  5889           DFHEIV11,
  5890           MAPSET-NAME,
  5891           DFHEIV99,
  5892           DFHEIV99
  5893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5894
  5895
  5896     IF HPFKEYL  IS EQUAL TO  ZERO
  5897         GO TO 0300-CHECK-PFKEYS.
  5898
  5899     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5900         MOVE ER-0004            TO  EMI-ERROR
  5901         GO TO 0320-INPUT-ERROR.
  5902
  5903     IF HPFKEYI NUMERIC
  5904         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5905             MOVE PF-VALUES (HPFKEYI)
  5906                                 TO  EIBAID
  5907         ELSE
  5908             MOVE ER-0029        TO  EMI-ERROR
  5909             GO TO 0320-INPUT-ERROR.
  5910
  5911 0300-CHECK-PFKEYS.
  5912     IF EIBAID  IS EQUAL TO  DFHPF23
  5913         GO TO 8800-PF23.
  5914
  5915     IF EIBAID  IS EQUAL TO  DFHPF24
  5916         GO TO 9100-RETURN-MAIN-MENU.
  5917
  5918     IF EIBAID = DFHPF11
  5919        GO TO 1700-WRITE-CERT-NOTE
  5920     END-IF
  5921
  5922     IF EIBAID  IS EQUAL TO  DFHPF12
  5923         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 108
* EL1278.cbl
  5924
  5925     IF EIBAID = DFHENTER OR DFHPF10
  5926        GO TO 0400-EDIT-INPUT-DATA
  5927     END-IF
  5928
  5929     MOVE ER-0029                TO  EMI-ERROR.
  5930
  5931 0320-INPUT-ERROR.
  5932     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5933
  5934     MOVE AL-UNBON               TO  HPFKEYA.
  5935
  5936     IF HPFKEYL  IS EQUAL TO  ZERO
  5937         MOVE -1                 TO  HLCANCL
  5938     ELSE
  5939         MOVE -1                 TO  HPFKEYL.
  5940
  5941     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 109
* EL1278.cbl
  5943 0400-EDIT-INPUT-DATA.
  5944     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5945                                     WS-NEW-LF-CANCEL-SW.
  5946
  5947     IF (HPCYNL > 0)
  5948        AND (HPCYNI = 'Y' OR 'N')
  5949        PERFORM 1800-READ-ELCERT-UPDATE
  5950                                 THRU 1800-EXIT
  5951        IF WS-RESP-NORMAL
  5952           MOVE HPCYNI           TO CM-POST-CARD-IND
  5953           PERFORM 1810-REWRITE-ELCERT
  5954                                 THRU 1810-EXIT
  5955        END-IF
  5956     END-IF
  5957     IF HLCAL1L GREATER ZERO
  5958         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  5959     IF CLPYNI = 'Y'
  5960        MOVE 'Y'                   TO PI-CLP-YN
  5961        MOVE AL-UANON              TO CLPYNA
  5962     ELSE
  5963        MOVE ' '                   TO PI-CLP-YN
  5964        MOVE AL-UANON              TO CLPYNA
  5965     END-IF
  5966     IF CANREAI = 'R'
  5967        MOVE 'R'                 TO PI-CANCEL-REASON
  5968        MOVE AL-UANON            TO CANREAA
  5969     ELSE
  5970        MOVE ' '                 TO PI-CANCEL-REASON
  5971        MOVE AL-UANON            TO CANREAA
  5972     END-IF
  5973
  5974     IF HLCANCL  IS EQUAL TO  ZERO
  5975       AND HACANCL  IS EQUAL TO  ZERO
  5976         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5977         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5978         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5979         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5980         GO TO 0420-CHECK-ERRORS.
  5981
  5982     IF HLCANCL  IS EQUAL TO  ZERO
  5983         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5984         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5985         GO TO 0410-CHECK-AH-DATE.
  5986
  5987     IF HLCANCI = SPACES
  5988        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  5989                                      WS-LF-CANCEL-DATE
  5990        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  5991                                      WS-LF-CANCEL-DATE-ED
  5992                                      PI-LF-REFUND-METH
  5993        MOVE +0                    TO PI-LF-REFUND-AMT
  5994        GO TO 0410-CHECK-AH-DATE
  5995     END-IF
  5996
  5997     MOVE AL-UNNON               TO  HLCANCA.
  5998     MOVE HLCANCI                TO  DEEDIT-FIELD.
  5999     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6000
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 110
* EL1278.cbl
  6001     PERFORM 8600-DEEDIT.
  6002
  6003     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6004     MOVE '4'                    TO  DC-OPTION-CODE.
  6005
  6006     PERFORM 9600-DATE-LINK.
  6007
  6008     IF DATE-CONVERSION-ERROR
  6009         MOVE -1                 TO  HLCANCL
  6010         MOVE AL-UABON           TO  HLCANCA
  6011         MOVE ER-2227            TO  EMI-ERROR
  6012         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6013     ELSE
  6014        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6015           MOVE -1               TO  HACANCL
  6016           MOVE AL-UABON         TO  HACANCA
  6017           MOVE ER-2774          TO  EMI-ERROR
  6018           PERFORM 9700-ERROR-FORMAT
  6019                                 THRU  9799-EXIT
  6020        ELSE
  6021           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6022                                    PI-LF-CANCEL-DATE
  6023           MOVE DC-GREG-DATE-1-EDIT
  6024                                 TO HLCANCO
  6025                                    WS-LF-CANCEL-DATE-ED
  6026                                    PI-LF-CANCEL-DATE-ED
  6027        END-IF
  6028     END-IF
  6029     .
  6030 0410-CHECK-AH-DATE.
  6031     IF HACAL1L GREATER ZERO
  6032         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6033
  6034     IF HACANCL  IS EQUAL TO  ZERO
  6035         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6036         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6037         GO TO 0420-CHECK-ERRORS.
  6038     IF HACANCI = SPACES
  6039        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6040                                      WS-AH-CANCEL-DATE
  6041        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6042                                      WS-AH-CANCEL-DATE-ED
  6043                                      PI-AH-REFUND-METH
  6044        MOVE +0                    TO PI-AH-REFUND-AMT
  6045        GO TO 0420-CHECK-ERRORS
  6046     END-IF
  6047
  6048     MOVE AL-UNNON               TO  HACANCA.
  6049     MOVE HACANCI                TO  DEEDIT-FIELD.
  6050     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6051
  6052     PERFORM 8600-DEEDIT.
  6053
  6054     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6055     MOVE '4'                    TO  DC-OPTION-CODE.
  6056
  6057     PERFORM 9600-DATE-LINK.
  6058
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 111
* EL1278.cbl
  6059     IF DATE-CONVERSION-ERROR
  6060         MOVE -1                 TO  HACANCL
  6061         MOVE AL-UABON           TO  HACANCA
  6062         MOVE ER-2227            TO  EMI-ERROR
  6063         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6064     ELSE
  6065        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6066           MOVE -1               TO  HACANCL
  6067           MOVE AL-UABON         TO  HACANCA
  6068           MOVE ER-2775          TO  EMI-ERROR
  6069           PERFORM 9700-ERROR-FORMAT
  6070                                 THRU  9799-EXIT
  6071        ELSE
  6072           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6073                                    PI-AH-CANCEL-DATE
  6074           MOVE DC-GREG-DATE-1-EDIT
  6075                                 TO HACANCO
  6076                                    WS-AH-CANCEL-DATE-ED
  6077                                    PI-AH-CANCEL-DATE-ED
  6078        END-IF
  6079     END-IF
  6080     .
  6081 0420-CHECK-ERRORS.
  6082     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6083         NEXT SENTENCE
  6084     ELSE
  6085         GO TO 8200-SEND-DATAONLY.
  6086
  6087     PERFORM 0500-FORMAT-SCREEN.
  6088     IF EIBAID = DFHPF10
  6089        perform 4000-GEN-CANCEL-TRANS
  6090                                 thru 4000-exit
  6091        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6092        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6093        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6094        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6095        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6096        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6097                               PI-ALL-CANCELS-SW
  6098        IF PI-PROCESSOR-IS-CSR
  6099            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6100        ELSE
  6101            MOVE ' '        TO PI-CSR-SESSION-SW
  6102        END-IF
  6103        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6104                               PI-CANCELS-IN-ERROR-SW
  6105                               PI-ONLY-BATCH-HEADERS-SW
  6106                               PI-ALL-OUT-OF-BAL-SW
  6107                               PI-HOLD-REC-SW
  6108                               PI-CHANGE-REC-SW
  6109                               PI-CHK-REQ-REC-SW
  6110                               PI-ISSUE-WARNING-SW
  6111                               PI-CANCEL-WARNING-SW
  6112        MOVE '1'            TO PI-BROWSE-TYPE
  6113        MOVE DFHENTER       TO  EIBAID
  6114
  6115
  6116* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 112
* EL1278.cbl
  6117*           PROGRAM    ('EL6311')
  6118*           COMMAREA   (WS-PASS-631)
  6119*           LENGTH     (1300)
  6120*       END-EXEC
  6121     MOVE 'EL6311' TO DFHEIV1
  6122     MOVE 1300
  6123       TO DFHEIV11
  6124*    MOVE '.$C                   %   #00006073' TO DFHEIV0
  6125     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6126     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6127     MOVE X'2020233030303036303733' TO DFHEIV0(25:11)
  6128     CALL 'kxdfhei1' USING DFHEIV0,
  6129           DFHEIV1,
  6130           WS-PASS-631,
  6131           DFHEIV11,
  6132           DFHEIV99
  6133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6134
  6135*        PERFORM 0500-FORMAT-SCREEN
  6136     END-IF
  6137     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 113
* EL1278.cbl
  6139 0500-FORMAT-SCREEN  SECTION.
  6140     MOVE LOW-VALUES             TO  EL127HO.
  6141     MOVE PI-CARRIER             TO  HCARIERO.
  6142     MOVE PI-GROUPING            TO  HGROUPO.
  6143     MOVE PI-STATE               TO  HSTATEO.
  6144     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6145     MOVE ' '                    TO  DC-OPTION-CODE.
  6146     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6147
  6148     PERFORM 9600-DATE-LINK.
  6149
  6150     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6151     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6152     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6153     MOVE PI-CLP-YN              TO  CLPYNO
  6154     MOVE PI-CANCEL-REASON       TO  CANREAO
  6155     .
  6156 0510-GET-CERT.
  6157     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6158     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6159     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6160     MOVE PI-STATE               TO  WS-CM-STATE.
  6161     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6162     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6163     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6164     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6165
  6166     PERFORM 0900-READ-CERT-FILE.
  6167
  6168     IF CERT-NOT-FOUND
  6169         MOVE -1                 TO  HLCANCL
  6170         MOVE AL-SANON           TO  HLCANCA
  6171         MOVE ER-0214            TO  EMI-ERROR
  6172         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6173         GO TO 8100-SEND-INITIAL-MAP.
  6174
  6175     IF CM-CLAIM-ATTACHED-COUNT = +0
  6176        GO TO 0510-SKIP-CLAIM-CHECK
  6177     END-IF
  6178*    DISPLAY ' STARTING CLAIM TEST '
  6179     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6180     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6181
  6182* EXEC CICS STARTBR
  6183*       DATASET     ('ELMSTR5')
  6184*       RIDFLD      (ELMSTR-KEY)
  6185*       RESP        (WS-RESPONSE)
  6186*    END-EXEC
  6187     MOVE 'ELMSTR5' TO DFHEIV1
  6188     MOVE 0
  6189       TO DFHEIV11
  6190*    MOVE '&,         G          &  N#00006125' TO DFHEIV0
  6191     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6192     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6193     MOVE X'204E233030303036313235' TO DFHEIV0(25:11)
  6194     CALL 'kxdfhei1' USING DFHEIV0,
  6195           DFHEIV1,
  6196           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 114
* EL1278.cbl
  6197           DFHEIV99,
  6198           DFHEIV11,
  6199           DFHEIV99
  6200     MOVE EIBRESP  TO WS-RESPONSE
  6201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6202     IF WS-RESP-NORMAL
  6203     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6204
  6205* EXEC CICS READNEXT
  6206*          DATASET   ('ELMSTR5')
  6207*          RIDFLD    (ELMSTR-KEY)
  6208*          SET       (ADDRESS OF CLAIM-MASTER)
  6209*          RESP      (WS-RESPONSE)
  6210*       END-EXEC
  6211     MOVE 'ELMSTR5' TO DFHEIV1
  6212     MOVE 0
  6213       TO DFHEIV11
  6214*    MOVE '&.S                   )  N#00006132' TO DFHEIV0
  6215     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6216     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6217     MOVE X'204E233030303036313332' TO DFHEIV0(25:11)
  6218     CALL 'kxdfhei1' USING DFHEIV0,
  6219           DFHEIV1,
  6220           DFHEIV20,
  6221           DFHEIV99,
  6222           ELMSTR-KEY,
  6223           DFHEIV99,
  6224           DFHEIV11,
  6225           DFHEIV99,
  6226           DFHEIV99
  6227     SET ADDRESS OF CLAIM-MASTER TO
  6228         DFHEIV20
  6229     MOVE EIBRESP  TO WS-RESPONSE
  6230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6231        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6232           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6233           AND (CM-CERT-NO = CL-CERT-NO)
  6234           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6235              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6236              SET FOUND-A-CLAIM  TO TRUE
  6237              IF CL-CLAIM-TYPE = 'L'
  6238                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6239                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6240                 END-IF
  6241                 IF CLAIM-IS-OPEN
  6242                    SET OPEN-LF-CLAIM TO TRUE
  6243                 ELSE
  6244                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6245                       MOVE CL-LAST-CLOSE-DT
  6246                                 TO WS-LF-LAST-CLOSE-DT
  6247                    END-IF
  6248                    SET CLOSED-LF-CLAIM TO TRUE
  6249                 END-IF
  6250              ELSE
  6251                 IF CLAIM-IS-OPEN
  6252                    MOVE CL-PAID-THRU-DT
  6253                                 TO WS-AH-PAID-THRU-DT
  6254                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 115
* EL1278.cbl
  6255                 ELSE
  6256                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6257                       MOVE CL-PAID-THRU-DT
  6258                                 TO WS-AH-PAID-THRU-DT
  6259                    END-IF
  6260                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6261                       MOVE CL-LAST-CLOSE-DT
  6262                                 TO WS-AH-LAST-CLOSE-DT
  6263                    END-IF
  6264                    SET CLOSED-AH-CLAIM TO TRUE
  6265                 END-IF
  6266              END-IF
  6267           END-IF
  6268        ELSE
  6269           SET I-SAY-TO-STOP TO TRUE
  6270        END-IF
  6271     END-PERFORM
  6272     END-IF
  6273     IF FOUND-A-CLAIM
  6274        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6275           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6276           MOVE ' '              TO DC-OPTION-CODE
  6277           PERFORM 9600-DATE-LINK
  6278           IF NO-CONVERSION-ERROR
  6279              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6280              MOVE AL-SANOF      TO LCLMDTHA
  6281           END-IF
  6282        END-IF
  6283        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6284           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6285           MOVE ' '              TO DC-OPTION-CODE
  6286           PERFORM 9600-DATE-LINK
  6287           IF NO-CONVERSION-ERROR
  6288              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6289              MOVE AL-SANOF      TO ACLMDTHA
  6290           END-IF
  6291        END-IF
  6292        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6293        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6294        MOVE CM-STATE            TO WS-CF-ACCESS
  6295        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6296
  6297* EXEC CICS READ
  6298*          DATASET  (ELCNTL-ID)
  6299*          SET      (ADDRESS OF CONTROL-FILE)
  6300*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6301*          RESP     (WS-RESPONSE)
  6302*       END-EXEC
  6303*    MOVE '&"S        E          (  N#00006203' TO DFHEIV0
  6304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6306     MOVE X'204E233030303036323033' TO DFHEIV0(25:11)
  6307     CALL 'kxdfhei1' USING DFHEIV0,
  6308           ELCNTL-ID,
  6309           DFHEIV20,
  6310           DFHEIV99,
  6311           WS-CF-CONTROL-PRIMARY,
  6312           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 116
* EL1278.cbl
  6313           DFHEIV99,
  6314           DFHEIV99
  6315     SET ADDRESS OF CONTROL-FILE TO
  6316         DFHEIV20
  6317     MOVE EIBRESP  TO WS-RESPONSE
  6318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6319        IF WS-RESP-NORMAL
  6320           MOVE CF-ST-REF-AH-DEATH-IND
  6321                                 TO WS-ST-REF-IND
  6322        END-IF
  6323     END-IF
  6324     .
  6325 0510-SKIP-CLAIM-CHECK.
  6326     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6327     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6328     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6329     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6330
  6331* EXEC CICS READ
  6332*        DATASET  (ERMAIL-ID)
  6333*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6334*        SET      (ADDRESS OF MAILING-DATA)
  6335*        RESP     (WS-RESPONSE)
  6336*    END-EXEC.
  6337*    MOVE '&"S        E          (  N#00006220' TO DFHEIV0
  6338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6340     MOVE X'204E233030303036323230' TO DFHEIV0(25:11)
  6341     CALL 'kxdfhei1' USING DFHEIV0,
  6342           ERMAIL-ID,
  6343           DFHEIV20,
  6344           DFHEIV99,
  6345           WS-MA-CONTROL-PRIMARY,
  6346           DFHEIV99,
  6347           DFHEIV99,
  6348           DFHEIV99
  6349     SET ADDRESS OF MAILING-DATA TO
  6350         DFHEIV20
  6351     MOVE EIBRESP  TO WS-RESPONSE
  6352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6353
  6354     IF WS-RESP-NORMAL
  6355        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6356           (S1 > +7)
  6357           OR (MA-MAIL-STATUS (S1) = '1')
  6358        END-PERFORM
  6359        IF S1 > +7
  6360           MOVE AL-SANOF         TO HPCYNA
  6361        END-IF
  6362     END-IF
  6363     IF CM-POST-CARD-IND = 'Y'
  6364        MOVE 'Y'                 TO HPCYNO
  6365     ELSE
  6366        MOVE 'N'                 TO HPCYNO
  6367     END-IF
  6368     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6369        OR (NOT CERT-AS-LOADED)
  6370        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 117
* EL1278.cbl
  6371     END-IF
  6372*    IF (CERT-ADDED-BATCH)
  6373*       CONTINUE
  6374*    ELSE
  6375*       MOVE AL-SANOF            TO HPCYNA
  6376*    END-IF
  6377     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6378     MOVE '5'                    TO  DC-OPTION-CODE.
  6379
  6380     PERFORM 9600-DATE-LINK.
  6381
  6382     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6383     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6384     MOVE '1'                    TO  DC-OPTION-CODE.
  6385
  6386     PERFORM 9600-DATE-LINK.
  6387
  6388     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6389
  6390     MOVE ZEROS TO WS-TOT-ITDR.
  6391     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6392
  6393 0510-CHECK-LF-STATUS.
  6394
  6395     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6396         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6397                                    PI-LF-CANCEL-DATE
  6398         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6399                                    PI-LF-CANCEL-DATE-ED
  6400                                    PI-LF-REFUND-METH
  6401         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6402         GO TO 0510-CHECK-AH-STATUS.
  6403
  6404     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6405        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6406          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6407          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6408          IF FIRST-ENTRY
  6409              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6410              MOVE SPACES               TO DC-OPTION-CODE
  6411              PERFORM 9600-DATE-LINK
  6412              IF NOT DATE-CONVERSION-ERROR
  6413                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6414                                            PI-LF-CANCEL-DATE-ED
  6415                                            WS-LF-CANCEL-DATE-ED
  6416                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6417                                            WS-LF-CANCEL-DATE.
  6418
  6419     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6420        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6421          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6422          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6423          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6424        IF FIRST-ENTRY
  6425            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6426            MOVE SPACES               TO DC-OPTION-CODE
  6427            PERFORM 9600-DATE-LINK
  6428            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 118
* EL1278.cbl
  6429                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6430                                          PI-LF-CANCEL-DATE-ED
  6431                                          WS-LF-CANCEL-DATE-ED
  6432                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6433                                          WS-LF-CANCEL-DATE.
  6434
  6435 0510-CHECK-AH-STATUS.
  6436
  6437     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6438         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6439                                    PI-AH-CANCEL-DATE
  6440         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6441                                    PI-AH-CANCEL-DATE-ED
  6442                                    PI-AH-REFUND-METH
  6443         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6444         GO TO 0510-CONT.
  6445
  6446     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6447        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6448          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6449          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6450        IF FIRST-ENTRY
  6451            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6452            MOVE SPACES               TO DC-OPTION-CODE
  6453            PERFORM 9600-DATE-LINK
  6454            IF NOT DATE-CONVERSION-ERROR
  6455                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6456                                            PI-AH-CANCEL-DATE-ED
  6457                                            WS-AH-CANCEL-DATE-ED
  6458                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6459                                            WS-AH-CANCEL-DATE.
  6460
  6461     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6462        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6463          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6464          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6465          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6466         IF FIRST-ENTRY
  6467             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6468             MOVE SPACES               TO DC-OPTION-CODE
  6469             PERFORM 9600-DATE-LINK
  6470             IF NOT DATE-CONVERSION-ERROR
  6471                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6472                                            PI-AH-CANCEL-DATE-ED
  6473                                            WS-AH-CANCEL-DATE-ED
  6474                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6475                                            WS-AH-CANCEL-DATE.
  6476
  6477     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6478         MOVE 'CANC DT'              TO  CNCDTHDO
  6479         GO TO 0510-CONT.
  6480
  6481     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6482         MOVE 'DTH DT '              TO  CNCDTHDO
  6483         IF FIRST-ENTRY
  6484             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6485             MOVE ' '                TO  DC-OPTION-CODE
  6486             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 119
* EL1278.cbl
  6487             IF NOT DATE-CONVERSION-ERROR
  6488                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6489                                             PI-AH-CANCEL-DATE-ED
  6490                                             WS-AH-CANCEL-DATE-ED
  6491                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6492                                             WS-AH-CANCEL-DATE.
  6493
  6494 0510-CONT.
  6495
  6496     IF WS-TOT-ITDR GREATER THAN ZEROS
  6497         MOVE WS-TOT-ITDR TO TOITDRO.
  6498
  6499 0520-GET-COMPANY-RECORD.
  6500     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6501     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6502     MOVE SPACES                 TO  WS-CF-ACCESS.
  6503     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6504
  6505     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6506
  6507     IF CNTL-NOT-FOUND
  6508         MOVE -1                 TO  HLCANCL
  6509         MOVE AL-SANON           TO  HLCANCA
  6510         MOVE ER-2616            TO  EMI-ERROR
  6511         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6512         GO TO 8100-SEND-INITIAL-MAP.
  6513
  6514     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6515       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6516         MOVE CF-LIFE-OVERRIDE-L1
  6517                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6518         MOVE CF-LIFE-OVERRIDE-L2
  6519                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6520         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6521         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6522         MOVE CF-CR-REM-TERM-CALC
  6523                                 TO  WS-CF-CR-REM-TERM-CALC
  6524         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6525         IF CF-DEFAULT-APR NUMERIC
  6526             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6527             GO TO 0525-GET-LF-BENEFIT
  6528         ELSE
  6529             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6530             GO TO 0525-GET-LF-BENEFIT.
  6531
  6532     MOVE -1                     TO  HLCANCL.
  6533     MOVE AL-SANON               TO  HLCANCA.
  6534     MOVE ER-2616                TO  EMI-ERROR.
  6535
  6536     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6537
  6538     GO TO 8100-SEND-INITIAL-MAP.
  6539
  6540 0525-GET-LF-BENEFIT.
  6541
  6542     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6543        GO TO 0527-GET-AH-BENEFIT
  6544     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 120
* EL1278.cbl
  6545
  6546     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6547     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6548                                     HLCDO.
  6549     MOVE WS-CF-LIFE-OVERRIDE-L2
  6550                                 TO  HLKINDO.
  6551
  6552     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6553
  6554     IF BENEFIT-FOUND
  6555         NEXT SENTENCE
  6556     ELSE
  6557         MOVE -1                 TO  HLCDL
  6558         MOVE AL-SANON           TO  HLCDA
  6559         MOVE ER-0028            TO  EMI-ERROR
  6560         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6561         GO TO 8100-SEND-INITIAL-MAP.
  6562
  6563     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6564         MOVE AL-UNNOF           TO  HLTERMA.
  6565
  6566*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6567     MOVE WS-KIND                TO WS-LF-KIND
  6568     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6569                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6570
  6571     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6572         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6573                                 TO  WS-LF-CO-REM-TERM-CALC.
  6574
  6575     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6576         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6577                                 TO  WS-LF-CO-EARNINGS-CALC
  6578                                     WS-LF-CO-REFUND-CALC.
  6579
  6580     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6581         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6582                                 TO  WS-LF-SPECIAL-CALC-CD.
  6583
  6584     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6585         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6586                                 TO  WS-LF-CO-REFUND-CALC.
  6587
  6588 0527-GET-AH-BENEFIT.
  6589
  6590     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6591        GO TO 0530-GET-STATE-RECORD
  6592     END-IF
  6593
  6594     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6595     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6596                                     HACDO.
  6597     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6598
  6599     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6600
  6601     IF BENEFIT-FOUND
  6602         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 121
* EL1278.cbl
  6603     ELSE
  6604         MOVE -1                 TO  HACDL
  6605         MOVE AL-SANON           TO  HACDA
  6606         MOVE ER-0028            TO  EMI-ERROR
  6607         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6608         GO TO 8100-SEND-INITIAL-MAP.
  6609
  6610     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6611         MOVE AL-UNNOF           TO  HATERMA.
  6612
  6613*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6614     MOVE WS-KIND                TO  WS-AH-KIND
  6615
  6616     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6617         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6618                                 TO  WS-AH-CO-REM-TERM-CALC.
  6619
  6620     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6621         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6622                                 TO  WS-AH-CO-EARNINGS-CALC
  6623                                     WS-AH-CO-REFUND-CALC.
  6624
  6625     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6626         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6627                                 TO  WS-AH-SPECIAL-CALC-CD.
  6628
  6629     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6630         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6631                                 TO  WS-AH-CO-REFUND-CALC.
  6632     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6633        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6634                                 TO WS-AH-BEN-CATEGORY
  6635     END-IF
  6636     .
  6637 0530-GET-STATE-RECORD.
  6638     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6639     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6640     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6641     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6642
  6643     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6644
  6645     IF CNTL-NOT-FOUND
  6646         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6647                                     WS-LF-ST-REM-TERM-CALC
  6648         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6649         GO TO 0560-FIND-ACCOUNT.
  6650
  6651     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6652       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6653       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6654         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6655     ELSE
  6656         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6657                                     WS-LF-ST-REM-TERM-CALC
  6658         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6659         GO TO 0560-FIND-ACCOUNT.
  6660
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 122
* EL1278.cbl
  6661     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6662     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6663
  6664     IF CM-LF-BENEFIT-CD  = '00'
  6665         GO TO 0550-GET-AH-BEN-IN-STATE.
  6666
  6667 0540-GET-LF-BEN-IN-STATE.
  6668     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6669     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6670
  6671     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6672     IF CF-ST-RT-CALC NOT = SPACES
  6673        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6674     END-IF
  6675
  6676     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6677        IF CF-ST-RF-LR-CALC > '0'
  6678           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6679        END-IF
  6680        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6681           IF CF-ST-RF-LN-CALC > '0'
  6682              MOVE CF-ST-RF-LN-CALC
  6683                                 TO WS-LF-ST-REFUND-CALC
  6684           END-IF
  6685        END-IF
  6686     ELSE
  6687        IF CF-ST-RF-LL-CALC > '0'
  6688           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6689        END-IF
  6690     END-IF
  6691
  6692     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6693
  6694     IF NO-BENEFIT-FOUND
  6695*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6696         GO TO 0550-GET-AH-BEN-IN-STATE.
  6697
  6698     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6699         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6700                                 TO  WS-LF-ST-REM-TERM-CALC.
  6701
  6702     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6703         MOVE CF-ST-REFUND-CALC (SUB3)
  6704                                 TO  WS-LF-ST-REFUND-CALC.
  6705
  6706 0550-GET-AH-BEN-IN-STATE.
  6707     IF CM-AH-BENEFIT-CD  = '00'
  6708         GO TO 0560-FIND-ACCOUNT.
  6709
  6710     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6711     IF CF-ST-RT-CALC NOT = SPACES
  6712        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6713     END-IF
  6714
  6715     IF CF-ST-RF-AH-CALC > '0'
  6716        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6717     END-IF
  6718     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 123
* EL1278.cbl
  6719        IF CF-ST-RF-CP-CALC > '0'
  6720           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6721        END-IF
  6722     END-IF
  6723
  6724     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6725     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6726
  6727     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6728
  6729     IF NO-BENEFIT-FOUND
  6730*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6731         GO TO 0560-FIND-ACCOUNT.
  6732
  6733     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6734         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6735                                 TO  WS-AH-ST-REM-TERM-CALC.
  6736
  6737     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6738         MOVE CF-ST-REFUND-CALC (SUB3)
  6739                                 TO  WS-AH-ST-REFUND-CALC.
  6740
  6741 0560-FIND-ACCOUNT.
  6742     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6743     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6744     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6745     MOVE CM-STATE               TO  WS-AM-STATE.
  6746     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6747     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6748     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6749
  6750     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6751
  6752     IF ACCT-FOUND
  6753         NEXT SENTENCE
  6754     ELSE
  6755         GO TO 0585-NO-ACCT.
  6756
  6757 0570-READ-NEXT-RANGE.
  6758     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6759
  6760     IF ACCT-FOUND
  6761         NEXT SENTENCE
  6762     ELSE
  6763         GO TO 0580-ACCT-NOT-FOUND.
  6764
  6765     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6766       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6767       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6768       AND CM-STATE  IS EQUAL TO  AM-STATE
  6769       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6770         NEXT SENTENCE
  6771     ELSE
  6772         GO TO 0580-ACCT-NOT-FOUND.
  6773
  6774     MOVE 'X'                    TO  DATE-RANGE-SW.
  6775
  6776     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 124
* EL1278.cbl
  6777         MOVE 'X'                TO  DATE-RANGE-SW
  6778         GO TO 0580-ACCT-NOT-FOUND.
  6779
  6780     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6781         GO TO 0570-READ-NEXT-RANGE.
  6782
  6783     IF WS-BROWSE-STARTED-SW = 'Y'
  6784
  6785* EXEC CICS ENDBR
  6786*          DATASET    ('ERACCT')
  6787*       END-EXEC
  6788     MOVE 'ERACCT' TO DFHEIV1
  6789     MOVE 0
  6790       TO DFHEIV11
  6791*    MOVE '&2                    $   #00006656' TO DFHEIV0
  6792     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6793     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6794     MOVE X'2020233030303036363536' TO DFHEIV0(25:11)
  6795     CALL 'kxdfhei1' USING DFHEIV0,
  6796           DFHEIV1,
  6797           DFHEIV11,
  6798           DFHEIV99
  6799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6800        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6801     END-IF
  6802     MOVE ' '                    TO  DATE-RANGE-SW.
  6803     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6804
  6805     GO TO 0590-SET-ACCOUNT.
  6806
  6807 0580-ACCT-NOT-FOUND.
  6808     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6809         MOVE ER-2601            TO  EMI-ERROR
  6810     ELSE
  6811         MOVE ER-2619            TO  EMI-ERROR.
  6812
  6813     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6814
  6815     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6816
  6817 0585-NO-ACCT.
  6818     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6819     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6820                                     WS-AM-EARN-METHOD-R
  6821                                     WS-AM-EARN-METHOD-A
  6822                                     WS-LF-AM-REM-TERM-CALC
  6823                                     WS-AH-AM-REM-TERM-CALC.
  6824
  6825     GO TO 0600-CHECK-FOR-LIFE.
  6826
  6827 0590-SET-ACCOUNT.
  6828******************************************************************
  6829******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6830******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6831******* METHODS.
  6832******************************************************************
  6833     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6834     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 125
* EL1278.cbl
  6835     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6836          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6837                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6838                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6839                  IF FORM-FOUND
  6840                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6841******************************************************************
  6842
  6843     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6844     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6845                                     WS-AM-EARN-METHOD-R
  6846                                     WS-AM-EARN-METHOD-A.
  6847
  6848*    EVALUATE AM-EARN-METHOD-R
  6849*       WHEN 'R'
  6850*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6851*       WHEN 'P'
  6852*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6853*       WHEN 'C'
  6854*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6855*       WHEN 'A'
  6856*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6857*       WHEN 'M'
  6858*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6859*       WHEN 'S'
  6860*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6861*    END-EVALUATE.
  6862
  6863*    EVALUATE AM-EARN-METHOD-L
  6864*       WHEN 'R'
  6865*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6866*       WHEN 'P'
  6867*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6868*       WHEN 'C'
  6869*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6870*       WHEN 'A'
  6871*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6872*       WHEN 'M'
  6873*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6874*       WHEN 'S'
  6875*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6876*    END-EVALUATE.
  6877
  6878*    EVALUATE AM-EARN-METHOD-A
  6879*       WHEN 'R'
  6880*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6881*       WHEN 'P'
  6882*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6883*       WHEN 'C'
  6884*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6885*       WHEN 'A'
  6886*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6887*       WHEN 'M'
  6888*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6889*       WHEN 'N'
  6890*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6891*       WHEN 'S'
  6892*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 126
* EL1278.cbl
  6893*    END-EVALUATE.
  6894
  6895     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6896                                     WS-TOT-LF-PREM
  6897                                     WS-TOT-AH-RFND
  6898                                     WS-TOT-LF-RFND.
  6899
  6900 0600-CHECK-FOR-LIFE.
  6901     IF CM-LF-BENEFIT-CD  = '00'
  6902         GO TO 0640-AH-BENEFIT.
  6903
  6904 0610-GET-LIFE-BENEFIT.
  6905
  6906     IF ACCT-FOUND
  6907         MOVE +1                 TO SUB3
  6908         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6909     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6910     MOVE WS-LF-KIND             TO  HLEDESCO.
  6911     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6912     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6913        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6914                             + CM-LF-ALT-PREMIUM-AMT
  6915     ELSE
  6916        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6917     END-IF
  6918
  6919     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6920     EVALUATE TRUE
  6921        WHEN ((OPEN-LF-CLAIM)
  6922           OR (CLOSED-LF-CLAIM))
  6923           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6924           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6925                                    WS-TOT-LF-RFND
  6926                                    PI-LF-REFUND-AMT
  6927           IF CM-AH-BENEFIT-CD NOT = '00'
  6928              MOVE ZEROS         TO HAREFNDO
  6929                                    WS-TOT-AH-RFND
  6930                                    PI-AH-REFUND-AMT
  6931              MOVE SPACES        TO PI-AH-REFUND-METH
  6932           END-IF
  6933           MOVE ER-2965          TO EMI-ERROR
  6934           PERFORM 9700-ERROR-FORMAT
  6935                                 THRU  9799-EXIT
  6936           GO TO 0640-AH-BENEFIT
  6937        WHEN OPEN-LF-CLAIM
  6938           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6939           AND WS-ST-REF-IND = '4'
  6940           MOVE ER-2966          TO EMI-ERROR
  6941           PERFORM 9700-ERROR-FORMAT
  6942                                 THRU  9799-EXIT
  6943        WHEN OPEN-LF-CLAIM
  6944           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6945           AND WS-ST-REF-IND NOT = '4'
  6946           MOVE ER-2967          TO EMI-ERROR
  6947           PERFORM 9700-ERROR-FORMAT
  6948                                 THRU  9799-EXIT
  6949           GO TO 0640-AH-BENEFIT
  6950        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 127
* EL1278.cbl
  6951           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6952           AND WS-ST-REF-IND = '4'
  6953           MOVE ER-2968          TO EMI-ERROR
  6954           PERFORM 9700-ERROR-FORMAT
  6955                                 THRU  9799-EXIT
  6956        WHEN CLOSED-LF-CLAIM
  6957           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6958           AND WS-ST-REF-IND NOT = '4'
  6959           MOVE ER-2969          TO EMI-ERROR
  6960           PERFORM 9700-ERROR-FORMAT
  6961                                 THRU  9799-EXIT
  6962           GO TO 0640-AH-BENEFIT
  6963        WHEN OTHER
  6964           CONTINUE
  6965     END-EVALUATE
  6966     .
  6967 0620-GET-REM-TERM.
  6968     MOVE WS-CF-LIFE-OVERRIDE-L1
  6969                                 TO  CP-LIFE-OVERRIDE-CODE.
  6970     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6971     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6972     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  6973     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6974     MOVE CM-STATE               TO  CP-STATE.
  6975     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6976     MOVE WS-CF-LF-COVERAGE-TYPE
  6977                                 TO  CP-BENEFIT-TYPE.
  6978     MOVE WS-LF-KIND             TO  HLEDESCO.
  6979     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6980     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6981     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6982     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6983     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6984     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6985     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6986     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6987     MOVE WS-CF-CR-REM-TERM-CALC
  6988                                 TO  CP-REM-TERM-METHOD.
  6989
  6990     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6991         MOVE WS-LF-CO-REM-TERM-CALC
  6992                                 TO  CP-REM-TERM-METHOD.
  6993
  6994     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6995         MOVE WS-LF-ST-REM-TERM-CALC
  6996                                 TO  CP-REM-TERM-METHOD.
  6997
  6998     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  6999         MOVE WS-LF-AM-REM-TERM-CALC
  7000                                 TO  CP-REM-TERM-METHOD.
  7001
  7002     IF (PI-COMPANY-ID = 'CID')
  7003        AND (CP-STATE-STD-ABBRV = 'WI')
  7004        MOVE '7'                 TO CP-REM-TERM-METHOD
  7005        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7006     END-IF
  7007     IF (PI-COMPANY-ID = 'CID')
  7008        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 128
* EL1278.cbl
  7009        AND (CM-CERT-EFF-DT >= X'9B41')
  7010        AND (CM-CERT-EFF-DT <= X'A2FB')
  7011        MOVE '7'                 TO CP-REM-TERM-METHOD
  7012        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7013     END-IF
  7014     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7015                                     CP-ORIGINAL-TERM
  7016                                     CP-LOAN-TERM.
  7017
  7018     IF CP-TRUNCATED-LIFE
  7019         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7020
  7021     IF CP-TERM-IS-DAYS
  7022         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7023             MOVE CM-LF-TERM-IN-DAYS
  7024                                 TO  CP-TERM-OR-EXT-DAYS
  7025         ELSE
  7026             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7027     ELSE
  7028         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7029             MOVE CM-PMT-EXTENSION-DAYS
  7030                                 TO  CP-TERM-OR-EXT-DAYS
  7031         ELSE
  7032             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7033
  7034*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7035     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7036     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7037     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7038     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7039
  7040
  7041* EXEC CICS READ
  7042*        DATASET  (ELCNTL-ID)
  7043*        SET      (ADDRESS OF CONTROL-FILE)
  7044*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7045*        RESP     (WS-RESPONSE)
  7046*    END-EXEC.
  7047*    MOVE '&"S        E          (  N#00006899' TO DFHEIV0
  7048     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7050     MOVE X'204E233030303036383939' TO DFHEIV0(25:11)
  7051     CALL 'kxdfhei1' USING DFHEIV0,
  7052           ELCNTL-ID,
  7053           DFHEIV20,
  7054           DFHEIV99,
  7055           WS-CF-CONTROL-PRIMARY,
  7056           DFHEIV99,
  7057           DFHEIV99,
  7058           DFHEIV99
  7059     SET ADDRESS OF CONTROL-FILE TO
  7060         DFHEIV20
  7061     MOVE EIBRESP  TO WS-RESPONSE
  7062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7063
  7064
  7065     IF WS-RESP-NOTOPEN
  7066         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 129
* EL1278.cbl
  7067         GO TO 0320-INPUT-ERROR.
  7068
  7069     IF WS-RESP-NOTFND
  7070         MOVE ZERO               TO  CP-FREE-LOOK
  7071     ELSE
  7072         MOVE CF-ST-FREE-LOOK-PERIOD
  7073                                 TO CP-FREE-LOOK.
  7074
  7075     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7076        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7077        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7078     END-IF
  7079
  7080     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7081
  7082     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7083        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7084        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7085        COMPUTE CP-REMAINING-TERM-1 =
  7086                CP-REMAINING-TERM-1 - +1
  7087        COMPUTE CP-REMAINING-TERM-2 =
  7088                CP-REMAINING-TERM-2 - +1
  7089     END-IF
  7090
  7091     IF CP-REMAINING-TERM-1 NEGATIVE
  7092        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7093     END-IF
  7094     IF CP-REMAINING-TERM-2 NEGATIVE
  7095        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7096     END-IF
  7097     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7098
  7099     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7100         GO TO 0640-AH-BENEFIT.
  7101*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7102*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7103
  7104     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7105         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7106             MOVE ER-0681        TO  EMI-ERROR
  7107             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7108
  7109     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7110         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7111             MOVE ER-0682        TO  EMI-ERROR
  7112             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7113
  7114 0630-CONTINUE-LIFE.
  7115
  7116     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7117        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7118        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7119                                    FREMTRMO
  7120     ELSE
  7121        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7122                                     FREMTRMO
  7123     END-IF
  7124     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 130
* EL1278.cbl
  7125     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7126     if pi-company-id = 'AHL'
  7127        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7128        if cp-class-code = spaces
  7129           move zeros            to cp-class-code
  7130        end-if
  7131     ELSE
  7132        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7133     END-IF
  7134     IF (PI-COMPANY-ID = 'DCC')
  7135        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7136        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7137        PERFORM 0730-GET-DDF-FACTORS
  7138                                 THRU 0730-EXIT
  7139        IF PDEF-FOUND
  7140           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7141              (P1 > +8)
  7142              OR (PD-PROD-CODE (P1) = 'L')
  7143           END-PERFORM
  7144           IF P1 < +9
  7145              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7146           END-IF
  7147        END-IF
  7148     END-IF
  7149     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7150
  7151     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7152
  7153     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7154        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7155                             + CM-LF-ALT-PREMIUM-AMT
  7156     ELSE
  7157        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7158     END-IF
  7159
  7160     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7161                                     WS-TOT-LF-PREM.
  7162
  7163     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7164        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7165        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7166     ELSE
  7167        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7168     END-IF
  7169
  7170     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7171     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7172
  7173     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7174         MOVE WS-LF-ST-REFUND-CALC
  7175                                 TO  CP-EARNING-METHOD.
  7176
  7177     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7178         MOVE WS-LF-FO-REFUND-CALC
  7179                                 TO  CP-EARNING-METHOD.
  7180
  7181     if (pi-company-id = 'CID')
  7182        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 131
* EL1278.cbl
  7183        continue
  7184     else
  7185        IF CP-RATING-METHOD = '4'
  7186           MOVE '4'              TO CP-EARNING-METHOD
  7187        END-IF
  7188     end-if
  7189*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7190*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7191*            MOVE WS-AM-EARN-METHOD-R
  7192*                                TO  CP-EARNING-METHOD
  7193*        END-IF
  7194*    ELSE
  7195*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7196*            MOVE WS-AM-EARN-METHOD-L
  7197*                                TO  CP-EARNING-METHOD.
  7198
  7199     if pi-company-id = 'AHL'
  7200        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7201        if cp-class-code = spaces
  7202           move zeros            to cp-class-code
  7203        end-if
  7204     ELSE
  7205        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7206     END-IF
  7207     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7208     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7209                                     CP-RATING-BENEFIT-AMT.
  7210     IF CP-STATE-STD-ABBRV = 'OR'
  7211         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7212                                         CM-LF-ALT-BENEFIT-AMT.
  7213****   N O T E   ****
  7214*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7215*      THE OH HARD CODING IN ELCRFNDP
  7216
  7217     IF PI-COMPANY-ID = 'CID'
  7218        IF CP-STATE-STD-ABBRV = 'OH'
  7219           MOVE WS-LF-CO-EARNINGS-CALC
  7220                                 TO CP-EARNING-METHOD
  7221        END-IF
  7222     END-IF
  7223
  7224****   N O T E   ****
  7225
  7226****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7227****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7228****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7229****     THE APPROPRIATE OPTIONS HERE
  7230*    IF PI-COMPANY-ID = 'CID'
  7231*       IF (CP-STATE-STD-ABBRV = 'MN')
  7232*          AND (CM-CERT-EFF-DT > X'A4FF')
  7233*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7234*          MOVE '5'              TO CP-EARNING-METHOD
  7235*       END-IF
  7236*    END-IF
  7237     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7238     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7239     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7240     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 132
* EL1278.cbl
  7241     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7242     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7243
  7244*    IF CP-EARN-AS-NET-PAY
  7245*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7246*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7247*               MOVE WS-CF-DEFAULT-APR
  7248*                                TO  CP-LOAN-APR
  7249*               MOVE ER-3780     TO  EMI-ERROR
  7250*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7251*           ELSE
  7252*               MOVE ER-3781     TO  EMI-ERROR
  7253*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7254
  7255*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7256*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7257*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7258*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7259*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7260*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7261*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7262*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7263*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7264*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7265*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7266*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7267*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7268*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7269*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7270*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7271*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7272     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7273     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7274
  7275     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7276
  7277     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7278
  7279     IF CP-ERROR-RATE-IS-ZERO
  7280       OR CP-ERROR-RATE-NOT-FOUND
  7281         MOVE ER-2740            TO  EMI-ERROR
  7282         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7283
  7284     IF CP-ERROR-RATE-FILE-NOTOPEN
  7285         MOVE ER-2617            TO  EMI-ERROR
  7286         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7287
  7288     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7289     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7290                                     WS-TOT-LF-RFND
  7291                                     PI-LF-REFUND-AMT.
  7292     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7293
  7294     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7295
  7296     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7297         GO TO 0640-AH-BENEFIT.
  7298
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 133
* EL1278.cbl
  7299*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7300*        ADD +1                  TO  CP-REMAINING-TERM
  7301*                                    CP-ORIGINAL-TERM.
  7302
  7303     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7304     MOVE '2'                    TO  CP-EARNING-METHOD
  7305                                     CP-RATING-METHOD.
  7306     IF PI-COMPANY-ID = 'CID'
  7307        IF (CP-STATE-STD-ABBRV = 'MN')
  7308           AND (CM-CERT-EFF-DT > X'A4FF')
  7309           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7310           MOVE '5'              TO CP-EARNING-METHOD
  7311           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7312        END-IF
  7313     END-IF
  7314     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7315                                     CP-REMAINING-BENEFIT
  7316                                     CP-RATING-BENEFIT-AMT.
  7317     IF CP-STATE-STD-ABBRV = 'OR'
  7318         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7319                                         CM-LF-ALT-BENEFIT-AMT.
  7320     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7321     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7322
  7323     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7324
  7325     IF CP-ERROR-RATE-IS-ZERO
  7326       OR CP-ERROR-RATE-NOT-FOUND
  7327         MOVE ER-2740            TO  EMI-ERROR
  7328         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7329
  7330     IF CP-ERROR-RATE-FILE-NOTOPEN
  7331         MOVE ER-2617            TO  EMI-ERROR
  7332         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7333
  7334     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7335
  7336     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7337                                     WS-TOT-LF-RFND
  7338                                     PI-LF-REFUND-AMT.
  7339
  7340     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7341
  7342 0640-AH-BENEFIT.
  7343     IF CM-AH-BENEFIT-CD = '00'
  7344         GO TO 0680-CONTINUE.
  7345
  7346 0650-GET-AH-BENEFIT.
  7347     IF ACCT-FOUND
  7348         MOVE +1                 TO SUB3
  7349         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7350     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7351     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7352     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7353     MOVE WS-AH-KIND             TO  HAEDESCO.
  7354     EVALUATE TRUE
  7355        WHEN ((OPEN-LF-CLAIM)
  7356           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 134
* EL1278.cbl
  7357           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7358           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7359                                    WS-TOT-AH-RFND
  7360                                    PI-AH-REFUND-AMT
  7361           MOVE SPACES           TO PI-AH-REFUND-METH
  7362           MOVE ER-2965          TO EMI-ERROR
  7363           PERFORM 9700-ERROR-FORMAT
  7364                                 THRU  9799-EXIT
  7365           GO TO 0680-CONTINUE
  7366        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7367           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7368           AND (EMI-ERROR = ER-2965)
  7369           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7370           MOVE ZEROS            TO HAREFNDO
  7371                                    WS-TOT-AH-RFND
  7372                                    PI-AH-REFUND-AMT
  7373           MOVE SPACES           TO PI-AH-REFUND-METH
  7374           GO TO 0680-CONTINUE
  7375        WHEN (OPEN-AH-CLAIM)
  7376           AND (WS-ST-REF-IND = '1')
  7377           MOVE ZEROS            TO HAREFNDO
  7378                                    WS-TOT-AH-RFND
  7379                                    PI-AH-REFUND-AMT
  7380           MOVE ER-3039          TO EMI-ERROR
  7381           PERFORM 9700-ERROR-FORMAT
  7382                                 THRU  9799-EXIT
  7383           GO TO 0680-CONTINUE
  7384        WHEN (OPEN-AH-CLAIM)
  7385           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7386           MOVE ER-3037          TO EMI-ERROR
  7387           PERFORM 9700-ERROR-FORMAT
  7388                                 THRU  9799-EXIT
  7389*          CONTINUE
  7390        WHEN (OPEN-AH-CLAIM)
  7391           AND (WS-ST-REF-IND = '5')
  7392           MOVE ER-3038          TO EMI-ERROR
  7393           PERFORM 9700-ERROR-FORMAT
  7394                                 THRU  9799-EXIT
  7395*          CONTINUE
  7396        WHEN (OPEN-AH-CLAIM)
  7397           AND (WS-ST-REF-IND = ' ')
  7398           MOVE ER-2768          TO EMI-ERROR
  7399           PERFORM 9700-ERROR-FORMAT
  7400                                 THRU  9799-EXIT
  7401        WHEN (CLOSED-AH-CLAIM)
  7402           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7403           MOVE ZEROS            TO HAREFNDO
  7404                                    WS-TOT-AH-RFND
  7405                                    PI-AH-REFUND-AMT
  7406           MOVE ER-2756          TO EMI-ERROR
  7407           PERFORM 9700-ERROR-FORMAT
  7408                                 THRU  9799-EXIT
  7409           IF WS-TOT-LF-RFND > 0
  7410              MOVE ZEROS         TO HLREFNDO
  7411                                    WS-TOT-LF-RFND
  7412                                    PI-LF-REFUND-AMT
  7413              MOVE SPACES        TO PI-LF-REFUND-METH
  7414           END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 135
* EL1278.cbl
  7415           GO TO 0680-CONTINUE
  7416*       WHEN OTHER
  7417*          CONTINUE
  7418     END-EVALUATE
  7419     .
  7420 0660-GET-REM-TERM.
  7421     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7422     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7423     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7424     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7425     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7426*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7427     MOVE WS-AH-KIND             TO  HAEDESCO.
  7428     MOVE CM-STATE               TO  CP-STATE.
  7429     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7430     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7431     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7432     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7433     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7434     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7435     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7436     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7437     MOVE WS-CF-CR-REM-TERM-CALC
  7438                                 TO  CP-REM-TERM-METHOD.
  7439
  7440     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7441         MOVE WS-AH-CO-REM-TERM-CALC
  7442                                 TO  CP-REM-TERM-METHOD.
  7443
  7444     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7445         MOVE WS-AH-ST-REM-TERM-CALC
  7446                                 TO  CP-REM-TERM-METHOD.
  7447
  7448     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7449         MOVE WS-AH-AM-REM-TERM-CALC
  7450                                 TO  CP-REM-TERM-METHOD.
  7451     IF (PI-COMPANY-ID = 'CID')
  7452        AND (CP-STATE-STD-ABBRV = 'WI')
  7453        MOVE '7'                 TO CP-REM-TERM-METHOD
  7454        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7455     END-IF
  7456     IF (PI-COMPANY-ID = 'CID')
  7457        AND (CP-STATE-STD-ABBRV = 'MO')
  7458        AND (CM-CERT-EFF-DT >= X'9B41')
  7459        AND (CM-CERT-EFF-DT <= X'A2FB')
  7460        MOVE '7'                 TO CP-REM-TERM-METHOD
  7461        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7462     END-IF
  7463
  7464     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7465                                     CP-ORIGINAL-TERM
  7466                                     CP-LOAN-TERM.
  7467
  7468     IF  NOT  CP-TERM-IS-DAYS
  7469         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7470             MOVE CM-PMT-EXTENSION-DAYS
  7471                                 TO  CP-TERM-OR-EXT-DAYS
  7472         ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 136
* EL1278.cbl
  7473             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7474
  7475*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7476     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7477     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7478     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7479     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7480
  7481
  7482* EXEC CICS READ
  7483*        DATASET  (ELCNTL-ID)
  7484*        SET      (ADDRESS OF CONTROL-FILE)
  7485*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7486*        RESP     (WS-RESPONSE)
  7487*    END-EXEC.
  7488*    MOVE '&"S        E          (  N#00007322' TO DFHEIV0
  7489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7491     MOVE X'204E233030303037333232' TO DFHEIV0(25:11)
  7492     CALL 'kxdfhei1' USING DFHEIV0,
  7493           ELCNTL-ID,
  7494           DFHEIV20,
  7495           DFHEIV99,
  7496           WS-CF-CONTROL-PRIMARY,
  7497           DFHEIV99,
  7498           DFHEIV99,
  7499           DFHEIV99
  7500     SET ADDRESS OF CONTROL-FILE TO
  7501         DFHEIV20
  7502     MOVE EIBRESP  TO WS-RESPONSE
  7503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7504
  7505
  7506     IF WS-RESP-NOTOPEN
  7507         MOVE ER-2617            TO  EMI-ERROR
  7508         GO TO 0320-INPUT-ERROR.
  7509
  7510     IF WS-RESP-NOTFND
  7511         MOVE ZERO               TO CP-FREE-LOOK
  7512     ELSE
  7513         MOVE CF-ST-FREE-LOOK-PERIOD
  7514                                 TO CP-FREE-LOOK.
  7515
  7516     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7517
  7518     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7519
  7520     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7521         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7522             MOVE ER-0683        TO  EMI-ERROR
  7523             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7524
  7525     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7526         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7527             MOVE ER-0684        TO  EMI-ERROR
  7528             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7529
  7530 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 137
* EL1278.cbl
  7531     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7532                                     WS-TOT-AH-PREM.
  7533     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7534
  7535     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7536         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7537
  7538     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7539        GO TO 0680-CONTINUE.
  7540     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7541     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7542     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7543
  7544     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7545         MOVE WS-AH-ST-REFUND-CALC
  7546                                 TO  CP-EARNING-METHOD.
  7547
  7548     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7549         MOVE WS-AH-FO-REFUND-CALC
  7550                                 TO  CP-EARNING-METHOD.
  7551
  7552*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7553*        MOVE WS-AM-EARN-METHOD-A
  7554*                                TO  CP-EARNING-METHOD.
  7555
  7556     if pi-company-id = 'AHL'
  7557        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7558        if cp-class-code = spaces
  7559           move zeros            to cp-class-code
  7560        end-if
  7561     ELSE
  7562        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7563     END-IF
  7564     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7565     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7566                                     CP-RATING-BENEFIT-AMT.
  7567     IF CP-STATE-STD-ABBRV = 'OR'
  7568         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7569                                         CM-AH-ORIG-TERM.
  7570     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7571     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7572     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7573     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7574     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7575     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7576
  7577     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7578     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7579     MOVE ' '                    TO  DC-OPTION-CODE.
  7580
  7581     PERFORM 9600-DATE-LINK.
  7582
  7583     IF CP-STATE-STD-ABBRV = 'OH'
  7584        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7585         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7586           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7587           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7588             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 138
* EL1278.cbl
  7589         END-IF
  7590        END-IF
  7591        IF PI-COMPANY-ID = 'CID'
  7592           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7593                           LOW-VALUES)
  7594              IF CP-CRITICAL-PERIOD
  7595                 MOVE '2'       TO CP-EARNING-METHOD
  7596              ELSE
  7597                 MOVE '6'       TO CP-EARNING-METHOD
  7598              END-IF
  7599           ELSE
  7600              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7601                 MOVE '2'       TO CP-EARNING-METHOD
  7602              ELSE
  7603                 IF ((CM-LF-ORIG-TERM > 60) AND
  7604                    (CM-RATE-CLASS NOT = 'L '))
  7605                               OR
  7606                    (WS-LF-CO-EARNINGS-CALC = '5')
  7607                    IF CP-CRITICAL-PERIOD
  7608                       MOVE '2'  TO CP-EARNING-METHOD
  7609                    ELSE
  7610                       MOVE '6'  TO CP-EARNING-METHOD
  7611                    END-IF
  7612                 ELSE
  7613                    MOVE '1'     TO CP-EARNING-METHOD
  7614                 END-IF
  7615              END-IF
  7616           END-IF
  7617        END-IF
  7618     END-IF
  7619
  7620     IF CP-STATE-STD-ABBRV = 'VA'
  7621       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7622         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7623            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7624                MOVE '6'            TO  CP-EARNING-METHOD
  7625            ELSE
  7626                MOVE '1'            TO  CP-EARNING-METHOD.
  7627
  7628     IF CP-EARN-AS-NET-PAY
  7629         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7630            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7631                MOVE WS-CF-DEFAULT-APR
  7632                                 TO  CP-LOAN-APR
  7633                MOVE ER-3780     TO  EMI-ERROR
  7634                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7635            ELSE
  7636                MOVE ER-3781     TO  EMI-ERROR
  7637                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7638     IF PI-COMPANY-ID = 'DCC'
  7639        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7640           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7641           MOVE 'S'              TO CP-EARNING-METHOD
  7642        END-IF
  7643     END-IF
  7644     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7645     IF (PI-COMPANY-ID = 'DCC')
  7646        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 139
* EL1278.cbl
  7647        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7648                                    WS-DDF-CSO-ADMIN-FEE
  7649                                    WS-DDF-1ST-YR-TOT-EXP
  7650                                    WS-DDF-COMM-AND-MFEE
  7651        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7652           S1 > +10
  7653           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7654              IF (AM-A-COM (S1) NUMERIC)
  7655                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7656                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7657              ELSE
  7658                 MOVE +0         TO WS-COMM-PCT C0
  7659                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7660                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7661              END-IF
  7662              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7663                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7664                    + WS-COMM-PCT
  7665              END-IF
  7666              IF AM-COM-TYP (S1) = 'N'
  7667                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7668                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7669              END-IF
  7670              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7671                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7672                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7673              END-IF
  7674              IF AM-COM-TYP (S1) = 'I'
  7675                 COMPUTE WS-DDF-COMM-AND-MFEE
  7676                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7677              END-IF
  7678           END-IF
  7679        END-PERFORM
  7680        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7681        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7682        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7683           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7684     END-IF
  7685     IF (PI-COMPANY-ID = 'DCC')
  7686        AND (CP-EARNING-METHOD = 'D')
  7687        AND (PI-CANCEL-REASON NOT = 'R')
  7688        PERFORM 0730-GET-DDF-FACTORS
  7689                                 THRU 0730-EXIT
  7690        IF NOT PDEF-FOUND
  7691           MOVE ER-9999          TO EMI-ERROR
  7692           PERFORM 9700-ERROR-FORMAT
  7693                                 THRU 9799-EXIT
  7694           GO TO 8200-SEND-DATAONLY
  7695        END-IF
  7696        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7697                                 TO CP-DDF-LO-FACT
  7698        MOVE PD-UEP-FACTOR (P1 P2)
  7699                                 TO CP-DDF-HI-FACT
  7700        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7701        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7702        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7703        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7704           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 140
* EL1278.cbl
  7705        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7706        IF PI-CLP-YN = 'Y'
  7707           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7708           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7709                                    CP-DDF-CLP
  7710           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7711        END-IF
  7712        IF DD-IU-PRESENT
  7713           MOVE 'I'              TO CP-EARNING-METHOD
  7714        END-IF
  7715        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7716                                    CP-CLP-RATE-UP
  7717        IF (CP-CALC-GROSS-FEE)
  7718           AND (CP-IU-RATE-UP NOT = ZEROS)
  7719           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7720              / CP-ORIGINAL-PREMIUM)
  7721           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7722              / (1 - TEX-FACT-8)
  7723        END-IF
  7724     END-IF
  7725     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7726
  7727     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7728
  7729     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7730
  7731     IF CP-ERROR-RATE-IS-ZERO
  7732       OR CP-ERROR-RATE-NOT-FOUND
  7733         MOVE ER-2740            TO  EMI-ERROR
  7734         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7735
  7736     IF CP-ERROR-RATE-FILE-NOTOPEN
  7737         MOVE ER-2617            TO  EMI-ERROR
  7738         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7739
  7740     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7741     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7742                                     WS-TOT-AH-RFND
  7743                                     PI-AH-REFUND-AMT.
  7744
  7745     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7746
  7747     MOVE AL-UANON               TO  HACANCA.
  7748
  7749 0680-CONTINUE.
  7750     IF BROWSE-STARTED
  7751         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7752         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7753
  7754     IF CM-LF-BENEFIT-CD = '00'
  7755         MOVE -1                 TO  HACANCL
  7756     ELSE
  7757         MOVE -1                 TO  HLCANCL.
  7758
  7759     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7760                           WS-TOT-PREM.
  7761     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7762                           WS-TOT-RFND.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 141
* EL1278.cbl
  7763
  7764     MOVE WS-TOT-PREM            TO  TOPREMO.
  7765     MOVE WS-TOT-RFND            TO  TORFNDO.
  7766
  7767 0680-EXIT.
  7768     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 142
* EL1278.cbl
  7770 0700-LINK-REM-TERM SECTION.
  7771
  7772* EXEC CICS LINK
  7773*        PROGRAM   (ELRTRM-ID)
  7774*        COMMAREA  (CALCULATION-PASS-AREA)
  7775*        LENGTH    (CP-COMM-LENGTH)
  7776*    END-EXEC.
  7777*    MOVE '."C                   (   #00007594' TO DFHEIV0
  7778     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7780     MOVE X'2020233030303037353934' TO DFHEIV0(25:11)
  7781     CALL 'kxdfhei1' USING DFHEIV0,
  7782           ELRTRM-ID,
  7783           CALCULATION-PASS-AREA,
  7784           CP-COMM-LENGTH,
  7785           DFHEIV99,
  7786           DFHEIV99,
  7787           DFHEIV99,
  7788           DFHEIV99
  7789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7790
  7791
  7792 0700-EXIT.
  7793     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 143
* EL1278.cbl
  7795 0710-LINK-REM-AMOUNT SECTION.
  7796
  7797* EXEC CICS LINK
  7798*        PROGRAM   (ELRAMT-ID)
  7799*        COMMAREA  (CALCULATION-PASS-AREA)
  7800*        LENGTH    (CP-COMM-LENGTH)
  7801*    END-EXEC.
  7802*    MOVE '."C                   (   #00007604' TO DFHEIV0
  7803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7805     MOVE X'2020233030303037363034' TO DFHEIV0(25:11)
  7806     CALL 'kxdfhei1' USING DFHEIV0,
  7807           ELRAMT-ID,
  7808           CALCULATION-PASS-AREA,
  7809           CP-COMM-LENGTH,
  7810           DFHEIV99,
  7811           DFHEIV99,
  7812           DFHEIV99,
  7813           DFHEIV99
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816
  7817 0710-EXIT.
  7818     EXIT.
  7819 0730-GET-DDF-FACTORS.
  7820     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7821     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7822     MOVE CM-STATE               TO ERPDEF-STATE
  7823     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7824     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7825     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7826     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7827     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7828
  7829* EXEC CICS STARTBR
  7830*        DATASET  ('ERPDEF')
  7831*        RIDFLD   (ERPDEF-KEY)
  7832*        GTEQ
  7833*        RESP     (WS-RESPONSE)
  7834*    END-EXEC
  7835     MOVE 'ERPDEF' TO DFHEIV1
  7836     MOVE 0
  7837       TO DFHEIV11
  7838*    MOVE '&,         G          &  N#00007621' TO DFHEIV0
  7839     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7840     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7841     MOVE X'204E233030303037363231' TO DFHEIV0(25:11)
  7842     CALL 'kxdfhei1' USING DFHEIV0,
  7843           DFHEIV1,
  7844           ERPDEF-KEY,
  7845           DFHEIV99,
  7846           DFHEIV11,
  7847           DFHEIV99
  7848     MOVE EIBRESP  TO WS-RESPONSE
  7849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7850     IF NOT WS-RESP-NORMAL
  7851        GO TO 0730-EXIT
  7852     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 144
* EL1278.cbl
  7853     .
  7854 0730-READNEXT.
  7855
  7856* EXEC CICS READNEXT
  7857*       DATASET  ('ERPDEF')
  7858*       SET      (ADDRESS OF PRODUCT-MASTER)
  7859*       RIDFLD   (ERPDEF-KEY)
  7860*       RESP     (WS-RESPONSE)
  7861*    END-EXEC
  7862     MOVE 'ERPDEF' TO DFHEIV1
  7863     MOVE 0
  7864       TO DFHEIV11
  7865*    MOVE '&.S                   )  N#00007632' TO DFHEIV0
  7866     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7867     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7868     MOVE X'204E233030303037363332' TO DFHEIV0(25:11)
  7869     CALL 'kxdfhei1' USING DFHEIV0,
  7870           DFHEIV1,
  7871           DFHEIV20,
  7872           DFHEIV99,
  7873           ERPDEF-KEY,
  7874           DFHEIV99,
  7875           DFHEIV11,
  7876           DFHEIV99,
  7877           DFHEIV99
  7878     SET ADDRESS OF PRODUCT-MASTER TO
  7879         DFHEIV20
  7880     MOVE EIBRESP  TO WS-RESPONSE
  7881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7882     IF NOT WS-RESP-NORMAL
  7883        GO TO 0730-ENDBR
  7884     END-IF
  7885     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7886        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7887           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7888        ELSE
  7889           GO TO 0730-READNEXT
  7890        END-IF
  7891     ELSE
  7892        GO TO 0730-ENDBR
  7893     END-IF
  7894     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7895        (P1 > +8)
  7896        OR (PD-PROD-CODE (P1) = 'I')
  7897     END-PERFORM
  7898     IF P1 < +9
  7899        SET DD-IU-PRESENT        TO TRUE
  7900     END-IF
  7901     IF CM-LOAN-TERM = ZEROS
  7902        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7903     END-IF
  7904     IF PD-TRUNCATED = 'Y'
  7905        MOVE CM-LOAN-TERM        TO WS-TERM
  7906     ELSE
  7907        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7908     END-IF
  7909     EVALUATE TRUE
  7910        WHEN WS-TERM > +168
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 145
* EL1278.cbl
  7911           MOVE 15               TO P1
  7912        WHEN WS-TERM > +156
  7913           MOVE 14               TO P1
  7914        WHEN WS-TERM > +144
  7915           MOVE 13               TO P1
  7916        WHEN WS-TERM > +132
  7917           MOVE 12               TO P1
  7918        WHEN WS-TERM > +120
  7919           MOVE 11               TO P1
  7920        WHEN WS-TERM > +108
  7921           MOVE 10               TO P1
  7922        WHEN WS-TERM > +96
  7923           MOVE 9                TO P1
  7924        WHEN WS-TERM > +84
  7925           MOVE 8                TO P1
  7926        WHEN WS-TERM > +72
  7927           MOVE 7                TO P1
  7928        WHEN WS-TERM > +60
  7929           MOVE 6                TO P1
  7930        WHEN WS-TERM > +48
  7931           MOVE 5                TO P1
  7932        WHEN WS-TERM > +36
  7933           MOVE 4                TO P1
  7934        WHEN WS-TERM > +24
  7935           MOVE 3                TO P1
  7936        WHEN WS-TERM > +12
  7937           MOVE 2                TO P1
  7938        WHEN OTHER
  7939           MOVE 1                TO P1
  7940     END-EVALUATE
  7941     EVALUATE TRUE
  7942*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7943*          AND (DD-IU-PRESENT)
  7944*          MOVE 2                TO P2
  7945*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7946*          MOVE 1                TO P2
  7947        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7948           MOVE 2                TO P2
  7949        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7950           MOVE 3                TO P2
  7951        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7952           MOVE 4                TO P2
  7953        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7954           MOVE 5                TO P2
  7955        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7956           MOVE 6                TO P2
  7957        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7958           MOVE 7                TO P2
  7959        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7960           MOVE 8                TO P2
  7961        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7962           MOVE 9                TO P2
  7963        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7964           MOVE 10               TO P2
  7965        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7966           MOVE 11               TO P2
  7967        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7968           MOVE 12               TO P2
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 146
* EL1278.cbl
  7969        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7970           MOVE 13               TO P2
  7971        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7972           MOVE 14               TO P2
  7973        WHEN OTHER
  7974           MOVE 15               TO P2
  7975     END-EVALUATE
  7976     .
  7977 0730-ENDBR.
  7978
  7979* EXEC CICS ENDBR
  7980*       DATASET  ('ERPDEF')
  7981*    END-EXEC
  7982     MOVE 'ERPDEF' TO DFHEIV1
  7983     MOVE 0
  7984       TO DFHEIV11
  7985*    MOVE '&2                    $   #00007734' TO DFHEIV0
  7986     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7987     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7988     MOVE X'2020233030303037373334' TO DFHEIV0(25:11)
  7989     CALL 'kxdfhei1' USING DFHEIV0,
  7990           DFHEIV1,
  7991           DFHEIV11,
  7992           DFHEIV99
  7993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7994     .
  7995 0730-EXIT.
  7996     EXIT.
  7997 0740-GET-ERCTBL.
  7998     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7999     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8000     MOVE 'A'                    TO CTBL-BEN-TYPE
  8001     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8002     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8003     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8004     IF WS-RESP-NORMAL
  8005        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8006     ELSE
  8007        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8008        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8009        MOVE 'A'                    TO CTBL-BEN-TYPE
  8010        MOVE 'AA'                   TO CTBL-BEN-CODE
  8011        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8012        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8013        IF WS-RESP-NORMAL
  8014           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8015        END-IF
  8016     END-IF
  8017     .
  8018 0740-EXIT.
  8019     EXIT.
  8020 0750-READ-ERCTBL.
  8021
  8022* EXEC CICS READ
  8023*         INTO    (COMM-TABLE-RECORD)
  8024*         DATASET ('ERCTBL')
  8025*         RIDFLD  (CTBL-KEY)
  8026*         RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 147
* EL1278.cbl
  8027*    END-EXEC
  8028     MOVE LENGTH OF
  8029      COMM-TABLE-RECORD
  8030       TO DFHEIV11
  8031     MOVE 'ERCTBL' TO DFHEIV1
  8032*    MOVE '&"IL       E          (  N#00007764' TO DFHEIV0
  8033     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8035     MOVE X'204E233030303037373634' TO DFHEIV0(25:11)
  8036     CALL 'kxdfhei1' USING DFHEIV0,
  8037           DFHEIV1,
  8038           COMM-TABLE-RECORD,
  8039           DFHEIV11,
  8040           CTBL-KEY,
  8041           DFHEIV99,
  8042           DFHEIV99,
  8043           DFHEIV99
  8044     MOVE EIBRESP  TO WS-RESPONSE
  8045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8046     .
  8047 0750-EXIT.
  8048     EXIT.
  8049 0760-FIND-COMM.
  8050     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8051        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8052        OR (C1 > +3)
  8053     END-PERFORM
  8054     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8055        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8056        OR (C2 > +3)
  8057     END-PERFORM
  8058     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8059        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8060        OR (C3 > +3)
  8061     END-PERFORM
  8062     IF C1 > +3
  8063        MOVE +1                  TO C1
  8064     END-IF
  8065     IF C2 > +3
  8066        MOVE +1                  TO C2
  8067     END-IF
  8068     IF C3 > +3
  8069        MOVE +1                  TO C3
  8070     END-IF
  8071     IF C1 = +3
  8072        MOVE +18                 TO C0
  8073     ELSE
  8074        IF C1 = +2
  8075           MOVE +9               TO C0
  8076        END-IF
  8077     END-IF
  8078     IF C2 = +3
  8079        ADD +6                   TO C0
  8080     ELSE
  8081        IF C2 = +2
  8082           ADD +3                TO C0
  8083        END-IF
  8084     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 148
* EL1278.cbl
  8085     ADD C3                      TO C0
  8086     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8087     .
  8088 0760-EXIT.
  8089     EXIT.
  8090 0800-LINK-REFUND SECTION.
  8091     IF CP-AH
  8092       IF PI-EARNING-METHOD-AH NOT = SPACES
  8093         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8094        ELSE
  8095         NEXT SENTENCE
  8096      ELSE
  8097       IF PI-EARNING-METHOD-LF NOT = SPACES
  8098         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8099
  8100
  8101* EXEC CICS LINK
  8102*        PROGRAM   (ELRFND-ID)
  8103*        COMMAREA  (CALCULATION-PASS-AREA)
  8104*        LENGTH    (CP-COMM-LENGTH)
  8105*    END-EXEC.
  8106*    MOVE '."C                   (   #00007824' TO DFHEIV0
  8107     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8109     MOVE X'2020233030303037383234' TO DFHEIV0(25:11)
  8110     CALL 'kxdfhei1' USING DFHEIV0,
  8111           ELRFND-ID,
  8112           CALCULATION-PASS-AREA,
  8113           CP-COMM-LENGTH,
  8114           DFHEIV99,
  8115           DFHEIV99,
  8116           DFHEIV99,
  8117           DFHEIV99
  8118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8119
  8120
  8121 0899-EXIT.
  8122     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 149
* EL1278.cbl
  8124 0900-READ-CERT-FILE  SECTION.
  8125
  8126* EXEC CICS HANDLE CONDITION
  8127*        NOTFND  (0910-NOT-FOUND)
  8128*    END-EXEC.
  8129*    MOVE '"$I                   ! # #00007834' TO DFHEIV0
  8130     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8132     MOVE X'2320233030303037383334' TO DFHEIV0(25:11)
  8133     CALL 'kxdfhei1' USING DFHEIV0
  8134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8135
  8136
  8137
  8138* EXEC CICS READ
  8139*        DATASET  (ELCERT-ID)
  8140*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8141*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8142*    END-EXEC.
  8143*    MOVE '&"S        E          (   #00007838' TO DFHEIV0
  8144     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8146     MOVE X'2020233030303037383338' TO DFHEIV0(25:11)
  8147     CALL 'kxdfhei1' USING DFHEIV0,
  8148           ELCERT-ID,
  8149           DFHEIV20,
  8150           DFHEIV99,
  8151           WS-CM-CONTROL-PRIMARY,
  8152           DFHEIV99,
  8153           DFHEIV99,
  8154           DFHEIV99
  8155     SET ADDRESS OF CERTIFICATE-MASTER TO
  8156         DFHEIV20
  8157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8158
  8159
  8160*    SERVICE RELOAD CERTIFICATE-MASTER.
  8161
  8162     GO TO 0999-EXIT.
  8163
  8164 0910-NOT-FOUND.
  8165     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8166
  8167 0999-EXIT.
  8168     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 150
* EL1278.cbl
  8170 1000-READ-CONTROL  SECTION.
  8171
  8172* EXEC CICS HANDLE CONDITION
  8173*        NOTFND   (1010-NOTFND)
  8174*        NOTOPEN  (1020-NOTOPEN)
  8175*    END-EXEC.
  8176*    MOVE '"$IJ                  ! $ #00007855' TO DFHEIV0
  8177     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8179     MOVE X'2420233030303037383535' TO DFHEIV0(25:11)
  8180     CALL 'kxdfhei1' USING DFHEIV0
  8181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8182
  8183
  8184
  8185* EXEC CICS READ
  8186*        DATASET  (ELCNTL-ID)
  8187*        SET      (ADDRESS OF CONTROL-FILE)
  8188*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8189*        GTEQ
  8190*    END-EXEC.
  8191*    MOVE '&"S        G          (   #00007860' TO DFHEIV0
  8192     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8194     MOVE X'2020233030303037383630' TO DFHEIV0(25:11)
  8195     CALL 'kxdfhei1' USING DFHEIV0,
  8196           ELCNTL-ID,
  8197           DFHEIV20,
  8198           DFHEIV99,
  8199           WS-CF-CONTROL-PRIMARY,
  8200           DFHEIV99,
  8201           DFHEIV99,
  8202           DFHEIV99
  8203     SET ADDRESS OF CONTROL-FILE TO
  8204         DFHEIV20
  8205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8206
  8207
  8208*    SERVICE RELOAD CONTROL-FILE.
  8209
  8210     GO TO 1099-EXIT.
  8211
  8212 1010-NOTFND.
  8213     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8214
  8215     GO TO 1099-EXIT.
  8216
  8217 1020-NOTOPEN.
  8218     MOVE ER-2617                TO  EMI-ERROR.
  8219
  8220     GO TO 0320-INPUT-ERROR.
  8221
  8222 1099-EXIT.
  8223     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 151
* EL1278.cbl
  8225 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8226     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8227
  8228     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8229         VARYING  SUB3  FROM  1  BY  1
  8230             UNTIL  ((SUB3  IS GREATER THAN  50)
  8231               OR ((CF-ST-BENEFIT-CD (SUB3)
  8232                      IS EQUAL TO  WS-BEN-CD)
  8233               AND (WS-LOOKUP-TYPE
  8234                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8235
  8236     IF SUB3  IS NOT EQUAL TO  51
  8237         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8238
  8239     GO TO 1199-EXIT.
  8240
  8241 1110-BENEFIT-DUMMY.
  8242
  8243 1119-EXIT.
  8244     EXIT.
  8245
  8246 1199-EXIT.
  8247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 152
* EL1278.cbl
  8249 1200-START-ACCOUNT-MASTER  SECTION.
  8250
  8251* EXEC CICS HANDLE CONDITION
  8252*        NOTFND   (1290-ACCT-NOT-FOUND)
  8253*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8254*    END-EXEC.
  8255*    MOVE '"$I''                  ! % #00007909' TO DFHEIV0
  8256     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8258     MOVE X'2520233030303037393039' TO DFHEIV0(25:11)
  8259     CALL 'kxdfhei1' USING DFHEIV0
  8260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8261
  8262
  8263     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8264
  8265
  8266* EXEC CICS STARTBR
  8267*        DATASET  (ERACCT-ID)
  8268*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8269*        GTEQ
  8270*    END-EXEC.
  8271     MOVE 0
  8272       TO DFHEIV11
  8273*    MOVE '&,         G          &   #00007916' TO DFHEIV0
  8274     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8275     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8276     MOVE X'2020233030303037393136' TO DFHEIV0(25:11)
  8277     CALL 'kxdfhei1' USING DFHEIV0,
  8278           ERACCT-ID,
  8279           WS-AM-CONTROL-PRIMARY,
  8280           DFHEIV99,
  8281           DFHEIV11,
  8282           DFHEIV99
  8283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8284
  8285
  8286     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8287     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8288
  8289     GO TO 1299-EXIT.
  8290
  8291 1290-ACCT-NOT-FOUND.
  8292     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8293
  8294 1299-EXIT.
  8295     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 153
* EL1278.cbl
  8297 1300-READ-ACCOUNT-MASTER  SECTION.
  8298
  8299* EXEC CICS HANDLE CONDITION
  8300*        NOTFND   (0580-ACCT-NOT-FOUND)
  8301*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8302*    END-EXEC.
  8303*    MOVE '"$I''                  ! & #00007934' TO DFHEIV0
  8304     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8306     MOVE X'2620233030303037393334' TO DFHEIV0(25:11)
  8307     CALL 'kxdfhei1' USING DFHEIV0
  8308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8309
  8310
  8311
  8312* EXEC CICS READNEXT
  8313*        DATASET  (ERACCT-ID)
  8314*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8315*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8316*    END-EXEC.
  8317     MOVE 0
  8318       TO DFHEIV11
  8319*    MOVE '&.S                   )   #00007939' TO DFHEIV0
  8320     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8321     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8322     MOVE X'2020233030303037393339' TO DFHEIV0(25:11)
  8323     CALL 'kxdfhei1' USING DFHEIV0,
  8324           ERACCT-ID,
  8325           DFHEIV20,
  8326           DFHEIV99,
  8327           WS-AM-CONTROL-PRIMARY,
  8328           DFHEIV99,
  8329           DFHEIV11,
  8330           DFHEIV99,
  8331           DFHEIV99
  8332     SET ADDRESS OF ACCOUNT-MASTER TO
  8333         DFHEIV20
  8334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8335
  8336
  8337*    SERVICE RELOAD ACCOUNT-MASTER.
  8338
  8339 1399-EXIT.
  8340     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 154
* EL1278.cbl
  8342 1400-GET-REFUND-TYPE  SECTION.
  8343     IF LIFE-REFUND-SEARCH
  8344         NEXT SENTENCE
  8345     ELSE
  8346         GO TO 1410-AH-REFUND-TYPE.
  8347
  8348     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8349         MOVE SPACES             TO  HLCALCO
  8350                                     HLCAL1O
  8351         GO TO 1499-EXIT.
  8352
  8353     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8354
  8355     EVALUATE TRUE
  8356        WHEN CP-R-AS-REPOSSESSION
  8357           MOVE 'REPOSSESSION'     TO  HLCALCO
  8358        WHEN CP-R-AS-R78
  8359           MOVE 'RULE 78'          TO  HLCALCO
  8360        WHEN  CP-R-AS-PRORATA
  8361           MOVE 'PRO RATA'         TO  HLCALCO
  8362        WHEN CP-R-AS-CALIF
  8363           MOVE 'CALIF'            TO  HLCALCO
  8364        WHEN CP-R-AS-TEXAS
  8365           MOVE 'IRREG'            TO  HLCALCO
  8366        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8367           MOVE 'UTAH'             TO  HLCALCO
  8368        WHEN CP-R-AS-FARM-PLAN
  8369           MOVE 'FARM PLAN'        TO  HLCALCO
  8370        WHEN CP-R-AS-NET-PAY
  8371           MOVE 'NET PAY'          TO  HLCALCO
  8372        WHEN CP-R-AS-ANTICIPATION
  8373           MOVE 'ANTICIPATION'     TO  HLCALCO
  8374        WHEN CP-R-AS-MEAN
  8375           MOVE 'MEAN'             TO  HLCALCO
  8376        WHEN CP-R-AS-SUM-OF-DIGITS
  8377           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8378        WHEN OTHER
  8379           MOVE 'UNDEFINED'        TO  HLCALCO
  8380     END-EVALUATE.
  8381
  8382     GO TO 1499-EXIT.
  8383
  8384 1410-AH-REFUND-TYPE.
  8385     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8386         MOVE SPACES             TO  HACALCO
  8387                                     HACAL1O
  8388         GO TO 1499-EXIT.
  8389
  8390     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8391
  8392     EVALUATE TRUE
  8393        WHEN CP-R-AS-REPOSSESSION
  8394           MOVE 'REPOSSESSION'     TO HACALCO
  8395        WHEN CP-R-AS-R78
  8396           MOVE 'RULE 78'          TO HACALCO
  8397        WHEN CP-R-AS-PRORATA
  8398           MOVE 'PRO RATA'         TO HACALCO
  8399        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 155
* EL1278.cbl
  8400           MOVE 'CALIF'            TO HACALCO
  8401        WHEN CP-R-AS-TEXAS
  8402           MOVE 'IRREG'            TO HACALCO
  8403        WHEN CP-R-AS-FARM-PLAN
  8404           MOVE 'FARM PLAN'        TO HACALCO
  8405        WHEN CP-R-AS-NET-PAY
  8406           MOVE 'NET PAY'          TO HACALCO
  8407        WHEN CP-R-AS-ANTICIPATION
  8408           MOVE 'ANTICIPATION'     TO HACALCO
  8409        WHEN CP-R-AS-MEAN
  8410           MOVE 'MEAN'             TO HACALCO
  8411        WHEN CP-R-AS-SUM-OF-DIGITS
  8412           MOVE 'SUM OF DIGIT'     TO HACALCO
  8413        WHEN CP-GAP-ACTUARIAL
  8414           MOVE 'SP ACTUARIAL'     TO HACALCO
  8415        WHEN CP-R-AS-SPP-DDF
  8416           MOVE 'SPEC DDF'         TO HACALCO
  8417        WHEN CP-R-AS-SPP-DDF-IU
  8418           MOVE 'SPEC DDF IU'      TO HACALCO
  8419        WHEN OTHER
  8420           MOVE 'UNKNOWN'          TO HLCALCO
  8421     END-EVALUATE
  8422     .
  8423 1499-EXIT.
  8424     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 156
* EL1278.cbl
  8426 1500-END-BROWSE  SECTION.
  8427     IF BROWSE-STARTED
  8428
  8429* EXEC CICS ENDBR
  8430*            DATASET  (ERACCT-ID)
  8431*        END-EXEC.
  8432     MOVE 0
  8433       TO DFHEIV11
  8434*    MOVE '&2                    $   #00008036' TO DFHEIV0
  8435     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8437     MOVE X'2020233030303038303336' TO DFHEIV0(25:11)
  8438     CALL 'kxdfhei1' USING DFHEIV0,
  8439           ERACCT-ID,
  8440           DFHEIV11,
  8441           DFHEIV99
  8442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8443
  8444
  8445 1599-EXIT.
  8446     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 157
* EL1278.cbl
  8448 1600-LOCATE-BENEFIT  SECTION.
  8449
  8450* EXEC CICS HANDLE CONDITION
  8451*        NOTFND  (1699-EXIT)
  8452*    END-EXEC.
  8453*    MOVE '"$I                   ! '' #00008044' TO DFHEIV0
  8454     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8456     MOVE X'2720233030303038303434' TO DFHEIV0(25:11)
  8457     CALL 'kxdfhei1' USING DFHEIV0
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8459
  8460
  8461     MOVE SPACES                 TO  WS-KIND.
  8462     MOVE ZERO                   TO  WS-NOT-FOUND.
  8463     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8464     MOVE SPACES                 TO  WS-CF-STATE.
  8465     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8466
  8467
  8468* EXEC CICS READ
  8469*        DATASET  (ELCNTL-ID)
  8470*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8471*        SET      (ADDRESS OF CONTROL-FILE)
  8472*        GTEQ
  8473*    END-EXEC.
  8474*    MOVE '&"S        G          (   #00008054' TO DFHEIV0
  8475     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8477     MOVE X'2020233030303038303534' TO DFHEIV0(25:11)
  8478     CALL 'kxdfhei1' USING DFHEIV0,
  8479           ELCNTL-ID,
  8480           DFHEIV20,
  8481           DFHEIV99,
  8482           WS-CF-CONTROL-PRIMARY,
  8483           DFHEIV99,
  8484           DFHEIV99,
  8485           DFHEIV99
  8486     SET ADDRESS OF CONTROL-FILE TO
  8487         DFHEIV20
  8488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8489
  8490
  8491*    SERVICE RELOAD CONTROL-FILE.
  8492
  8493     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8494       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8495         GO TO 1699-EXIT.
  8496
  8497     MOVE +1                     TO  WS-INDEX.
  8498
  8499 1610-LOOKUP-BENEFIT.
  8500     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8501         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8502                                 TO  WS-KIND
  8503         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8504                                 TO  WS-CALC-CD
  8505         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 158
* EL1278.cbl
  8506                                 TO  WS-BENEFIT-DESCRIP
  8507         MOVE +1                 TO  WS-NOT-FOUND
  8508         GO TO 1699-EXIT.
  8509
  8510     IF CF-BENEFIT-CODE (WS-INDEX)
  8511             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8512         GO TO 1699-EXIT.
  8513
  8514     IF WS-INDEX  IS LESS THAN  +8
  8515         ADD +1                  TO  WS-INDEX
  8516         GO TO 1610-LOOKUP-BENEFIT.
  8517
  8518 1699-EXIT.
  8519     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 159
* EL1278.cbl
  8521 1700-WRITE-CERT-NOTE      SECTION.
  8522     IF NOT MODIFY-CERT-CAP
  8523         MOVE 'UPDATE'           TO  SM-READ
  8524         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8525         MOVE ER-0070            TO  EMI-ERROR
  8526         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8527         GO TO 8200-SEND-DATAONLY.
  8528
  8529**MOVE CANCEL QUOTE NOTE INFO
  8530     IF PI-LF-REFUND-AMT NUMERIC
  8531        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8532        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8533     ELSE
  8534        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8535                                    PI-LF-REFUND-AMT
  8536        MOVE SPACE               TO WS-CN-LF-REF-METH
  8537                                    PI-LF-REFUND-METH.
  8538
  8539     IF PI-AH-REFUND-AMT NUMERIC
  8540        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8541        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8542     ELSE
  8543        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8544                                    PI-AH-REFUND-AMT
  8545        MOVE SPACE               TO WS-CN-AH-REF-METH
  8546                                    PI-AH-REFUND-METH.
  8547
  8548     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8549                                   PI-AH-REFUND-AMT.
  8550
  8551     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8552
  8553     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8554     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8555     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8556        MOVE PI-LF-CANCEL-DATE-ED
  8557                                 TO WS-CN-CANCEL-DT
  8558     ELSE
  8559        MOVE PI-AH-CANCEL-DATE-ED
  8560                                 TO WS-CN-CANCEL-DT
  8561     END-IF
  8562     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8563     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8564     MOVE PI-CARRIER             TO CZ-CARRIER
  8565     MOVE PI-GROUPING            TO CZ-GROUPING
  8566     MOVE PI-STATE               TO CZ-STATE
  8567     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8568     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8569     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8570     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8571     MOVE '1'                    TO CZ-RECORD-TYPE
  8572     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8573     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8574     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8575     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8576     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8577     MOVE ' '                    TO WS-STOP-SW
  8578     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 160
* EL1278.cbl
  8579
  8580* EXEC CICS WRITE
  8581*           FROM      (CERT-NOTE-FILE)
  8582*           DATASET   (ERNOTE-ID)
  8583*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8584*           RESP      (WS-RESPONSE)
  8585*       END-EXEC
  8586     MOVE LENGTH OF
  8587      CERT-NOTE-FILE
  8588       TO DFHEIV11
  8589*    MOVE '&$ L                  ''  N#00008149' TO DFHEIV0
  8590     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8591     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8592     MOVE X'204E233030303038313439' TO DFHEIV0(25:11)
  8593     CALL 'kxdfhei1' USING DFHEIV0,
  8594           ERNOTE-ID,
  8595           CERT-NOTE-FILE,
  8596           DFHEIV11,
  8597           CZ-CONTROL-PRIMARY,
  8598           DFHEIV99,
  8599           DFHEIV99
  8600     MOVE EIBRESP  TO WS-RESPONSE
  8601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8602        IF WS-RESP-DUPREC
  8603           ADD +1                TO CZ-NOTE-SEQUENCE
  8604        ELSE
  8605           SET I-SAY-TO-STOP     TO TRUE
  8606        END-IF
  8607     END-PERFORM
  8608     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8609     IF WS-RESP-NORMAL
  8610        EVALUATE CM-NOTE-SW
  8611           WHEN '1'
  8612           WHEN '3'
  8613           WHEN '5'
  8614           WHEN '7'
  8615              SET NO-CERT-RW     TO TRUE
  8616           WHEN ' '
  8617              MOVE '1'           TO CM-NOTE-SW
  8618           WHEN '2'
  8619              MOVE '3'           TO CM-NOTE-SW
  8620           WHEN '4'
  8621              MOVE '5'           TO CM-NOTE-SW
  8622           WHEN '6'
  8623              MOVE '7'           TO CM-NOTE-SW
  8624        END-EVALUATE
  8625     END-IF
  8626     IF NOT NO-CERT-RW
  8627        PERFORM 1810-REWRITE-ELCERT
  8628                                 THRU 1810-EXIT
  8629     ELSE
  8630
  8631* EXEC CICS UNLOCK
  8632*          DATASET    (ELCERT-ID)
  8633*       END-EXEC
  8634*    MOVE '&*                    #   #00008183' TO DFHEIV0
  8635     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8636     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 161
* EL1278.cbl
  8637     MOVE X'2020233030303038313833' TO DFHEIV0(25:11)
  8638     CALL 'kxdfhei1' USING DFHEIV0,
  8639           ELCERT-ID,
  8640           DFHEIV99
  8641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8642     END-IF
  8643     MOVE ER-8160                TO EMI-ERROR.
  8644     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8645     GO TO 8200-SEND-DATAONLY.
  8646
  8647 1799-EXIT.
  8648     EXIT.
  8649 1800-READ-ELCERT-UPDATE.
  8650     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8651     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8652     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8653     MOVE PI-STATE               TO  WS-CM-STATE.
  8654     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8655     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8656     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8657     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8658
  8659* EXEC CICS READ
  8660*        UPDATE
  8661*        DATASET  (ELCERT-ID)
  8662*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8663*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8664*        RESP     (WS-RESPONSE)
  8665*    END-EXEC
  8666*    MOVE '&"S        EU         (  N#00008202' TO DFHEIV0
  8667     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8668     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8669     MOVE X'204E233030303038323032' TO DFHEIV0(25:11)
  8670     CALL 'kxdfhei1' USING DFHEIV0,
  8671           ELCERT-ID,
  8672           DFHEIV20,
  8673           DFHEIV99,
  8674           WS-CM-CONTROL-PRIMARY,
  8675           DFHEIV99,
  8676           DFHEIV99,
  8677           DFHEIV99
  8678     SET ADDRESS OF CERTIFICATE-MASTER TO
  8679         DFHEIV20
  8680     MOVE EIBRESP  TO WS-RESPONSE
  8681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8682     .
  8683 1800-EXIT.
  8684     EXIT.
  8685 1810-REWRITE-ELCERT.
  8686
  8687* EXEC CICS REWRITE
  8688*        FROM      (CERTIFICATE-MASTER)
  8689*        DATASET   (ELCERT-ID)
  8690*        RESP     (WS-RESPONSE)
  8691*    END-EXEC.
  8692     MOVE LENGTH OF
  8693      CERTIFICATE-MASTER
  8694       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 162
* EL1278.cbl
  8695*    MOVE '&& L                  %  N#00008213' TO DFHEIV0
  8696     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8697     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8698     MOVE X'204E233030303038323133' TO DFHEIV0(25:11)
  8699     CALL 'kxdfhei1' USING DFHEIV0,
  8700           ELCERT-ID,
  8701           CERTIFICATE-MASTER,
  8702           DFHEIV11,
  8703           DFHEIV99
  8704     MOVE EIBRESP  TO WS-RESPONSE
  8705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8706
  8707     .
  8708 1810-EXIT.
  8709     EXIT.
  8710 4000-GEN-CANCEL-TRANS.
  8711     IF PI-LF-REFUND-AMT NOT NUMERIC
  8712         MOVE +0 TO PI-LF-REFUND-AMT
  8713     END-IF
  8714     IF PI-AH-REFUND-AMT NOT NUMERIC
  8715         MOVE +0 TO PI-AH-REFUND-AMT
  8716     END-IF
  8717
  8718     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8719
  8720     MOVE '2'                    TO CG-OPTION-CODE
  8721     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8722     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8723     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8724     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8725     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8726     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8727     MOVE PI-STATE               TO CG-CERT-STATE
  8728     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8729     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8730     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8731     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8732     MOVE ZEROS                  TO CG-LF-BENCD
  8733                                    CG-AH-BENCD
  8734                                    CG-LF-CAN-AMT
  8735                                    CG-AH-CAN-AMT
  8736     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8737                                    CG-AH-CAN-DT
  8738     MOVE SPACES                 TO CG-BATCH-NO
  8739     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8740       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8741        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8742           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8743           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8744           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8745        END-IF
  8746     END-IF
  8747     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8748       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8749        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8750           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8751           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8752           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 163
* EL1278.cbl
  8753        END-IF
  8754     END-IF
  8755
  8756* EXEC CICS LINK
  8757*        PROGRAM  ('ELCANC')
  8758*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8759*    END-EXEC
  8760     MOVE LENGTH OF
  8761      CANCEL-GEN-PASS-AREA
  8762       TO DFHEIV11
  8763     MOVE 'ELCANC' TO DFHEIV1
  8764*    MOVE '."C                   (   #00008266' TO DFHEIV0
  8765     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8767     MOVE X'2020233030303038323636' TO DFHEIV0(25:11)
  8768     CALL 'kxdfhei1' USING DFHEIV0,
  8769           DFHEIV1,
  8770           CANCEL-GEN-PASS-AREA,
  8771           DFHEIV11,
  8772           DFHEIV99,
  8773           DFHEIV99,
  8774           DFHEIV99,
  8775           DFHEIV99
  8776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8777     IF CG-SUCCESS
  8778        CONTINUE
  8779     ELSE
  8780        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8781        move '3'                 to emi-switch1
  8782        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8783        EVALUATE TRUE
  8784           WHEN CG-DATE-ERROR
  8785             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8786           WHEN CG-CERT-NOT-FOUND
  8787             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8788           WHEN CG-AMOUNT-ERROR
  8789             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8790           WHEN CG-OPTION-ERROR
  8791             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8792           WHEN CG-PREV-CAN
  8793             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8794           WHEN CG-INVALID-DATA
  8795             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8796           WHEN CG-NO-ACCT-MSTR
  8797             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8798           WHEN CG-SFX-A-EXIST
  8799             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8800           WHEN CG-MISC-ERROR
  8801             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8802           WHEN OTHER
  8803             move ' error - elcanc - return '
  8804                                 to emi-error-text (1) (12:25)
  8805        END-EVALUATE
  8806        go to 8200-send-dataonly
  8807     end-if
  8808     .
  8809 4000-exit.
  8810     exit.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 164
* EL1278.cbl
  8811
  8812 4400-ADD-ORIG-REC.
  8813
  8814     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8815     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8816     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8817     MOVE PI-STATE               TO  WS-CM-STATE.
  8818     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8819     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8820     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8821     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8822
  8823
  8824* EXEC CICS READ
  8825*        DATASET  (ELCERT-ID)
  8826*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8827*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8828*        RESP     (WS-RESPONSE)
  8829*    END-EXEC
  8830*    MOVE '&"S        E          (  N#00008316' TO DFHEIV0
  8831     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8832     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8833     MOVE X'204E233030303038333136' TO DFHEIV0(25:11)
  8834     CALL 'kxdfhei1' USING DFHEIV0,
  8835           ELCERT-ID,
  8836           DFHEIV20,
  8837           DFHEIV99,
  8838           WS-CM-CONTROL-PRIMARY,
  8839           DFHEIV99,
  8840           DFHEIV99,
  8841           DFHEIV99
  8842     SET ADDRESS OF CERTIFICATE-MASTER TO
  8843         DFHEIV20
  8844     MOVE EIBRESP  TO WS-RESPONSE
  8845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8846     IF WS-RESP-NORMAL
  8847         CONTINUE
  8848     ELSE
  8849        MOVE ER-0142                TO EMI-ERROR
  8850        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8851        GO TO 8100-SEND-INITIAL-MAP
  8852     END-IF
  8853
  8854******************************************************************
  8855*            A D D   O R I G   C E R T   I N F O                 *
  8856******************************************************************
  8857
  8858     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8859
  8860     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8861     MOVE ' '                    TO WS-ERMAIL-SW
  8862
  8863
  8864* EXEC CICS READ
  8865*       DATASET   ('ERMAIL')
  8866*       SET       (ADDRESS OF MAILING-DATA)
  8867*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8868*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 165
* EL1278.cbl
  8869*    END-EXEC
  8870     MOVE 'ERMAIL' TO DFHEIV1
  8871*    MOVE '&"S        E          (  N#00008339' TO DFHEIV0
  8872     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8874     MOVE X'204E233030303038333339' TO DFHEIV0(25:11)
  8875     CALL 'kxdfhei1' USING DFHEIV0,
  8876           DFHEIV1,
  8877           DFHEIV20,
  8878           DFHEIV99,
  8879           WS-MA-CONTROL-PRIMARY,
  8880           DFHEIV99,
  8881           DFHEIV99,
  8882           DFHEIV99
  8883     SET ADDRESS OF MAILING-DATA TO
  8884         DFHEIV20
  8885     MOVE EIBRESP  TO WS-RESPONSE
  8886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8887
  8888     IF WS-RESP-NORMAL
  8889        SET ERMAIL-FOUND TO TRUE
  8890     END-IF
  8891
  8892     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  8893     MOVE 'C'                   TO ELCRTT-REC-TYPE
  8894     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  8895
  8896
  8897* EXEC CICS READ
  8898*         DATASET  (ELCRTT-ID)
  8899*         RIDFLD   (ELCRTT-KEY)
  8900*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  8901*         RESP     (WS-RESPONSE)
  8902*    END-EXEC
  8903*    MOVE '&"S        E          (  N#00008354' TO DFHEIV0
  8904     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8906     MOVE X'204E233030303038333534' TO DFHEIV0(25:11)
  8907     CALL 'kxdfhei1' USING DFHEIV0,
  8908           ELCRTT-ID,
  8909           DFHEIV20,
  8910           DFHEIV99,
  8911           ELCRTT-KEY,
  8912           DFHEIV99,
  8913           DFHEIV99,
  8914           DFHEIV99
  8915     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8916         DFHEIV20
  8917     MOVE EIBRESP  TO WS-RESPONSE
  8918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8919
  8920     IF NOT WS-RESP-NORMAL
  8921        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  8922     END-IF
  8923
  8924     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  8925     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  8926     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 166
* EL1278.cbl
  8927
  8928
  8929* EXEC CICS READ
  8930*       DATASET   ('ELCRTO')
  8931*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8932*       RIDFLD    (ELCRTO-KEY)
  8933*       GTEQ
  8934*       RESP      (WS-RESPONSE)
  8935*    END-EXEC
  8936     MOVE 'ELCRTO' TO DFHEIV1
  8937*    MOVE '&"S        G          (  N#00008369' TO DFHEIV0
  8938     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8940     MOVE X'204E233030303038333639' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           DFHEIV1,
  8943           DFHEIV20,
  8944           DFHEIV99,
  8945           ELCRTO-KEY,
  8946           DFHEIV99,
  8947           DFHEIV99,
  8948           DFHEIV99
  8949     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8950         DFHEIV20
  8951     MOVE EIBRESP  TO WS-RESPONSE
  8952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8953
  8954     IF WS-RESP-NORMAL
  8955        AND (OC-CONTROL-PRIMARY (1:33) =
  8956                 WS-CM-CONTROL-PRIMARY)
  8957        AND (OC-RECORD-TYPE = 'I')
  8958        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  8959
  8960* EXEC CICS READ
  8961*             DATASET   ('ELCRTO')
  8962*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8963*             RIDFLD    (OC-CONTROL-PRIMARY)
  8964*             UPDATE
  8965*             RESP      (WS-RESPONSE)
  8966*          END-EXEC
  8967     MOVE 'ELCRTO' TO DFHEIV1
  8968*    MOVE '&"S        EU         (  N#00008382' TO DFHEIV0
  8969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8970     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8971     MOVE X'204E233030303038333832' TO DFHEIV0(25:11)
  8972     CALL 'kxdfhei1' USING DFHEIV0,
  8973           DFHEIV1,
  8974           DFHEIV20,
  8975           DFHEIV99,
  8976           OC-CONTROL-PRIMARY,
  8977           DFHEIV99,
  8978           DFHEIV99,
  8979           DFHEIV99
  8980     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8981         DFHEIV20
  8982     MOVE EIBRESP  TO WS-RESPONSE
  8983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8984           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 167
* EL1278.cbl
  8985           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8986           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8987           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8988           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8989           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8990           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8991           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8992           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8993            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8994               MOVE SPACES             TO OC-LF-BENCD
  8995               MOVE ZEROS              TO OC-LF-TERM
  8996                                          OC-LF-BEN-AMT
  8997                                          OC-LF-PRM-AMT
  8998                                          OC-LF-ALT-BEN-AMT
  8999                                          OC-LF-ALT-PRM-AMT
  9000                                          OC-LF-COMM-PCT
  9001                                          OC-LF-CANCEL-AMT
  9002               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9003               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9004           ELSE
  9005               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9006               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9007               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9008               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9009               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9010               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9011               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9012               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9013               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9014               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9015           END-IF
  9016           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9017           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9018            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9019               MOVE SPACES             TO OC-AH-BENCD
  9020               MOVE ZEROS              TO OC-AH-TERM
  9021                                          OC-AH-BEN-AMT
  9022                                          OC-AH-PRM-AMT
  9023                                          OC-AH-COMM-PCT
  9024                                          OC-AH-CANCEL-AMT
  9025                                          OC-AH-CP
  9026               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9027               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9028           ELSE
  9029               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9030               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9031               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9032               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9033               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9034               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9035               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9036               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9037               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9038           END-IF
  9039           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9040           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9041           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9042           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 168
* EL1278.cbl
  9043           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9044           MOVE '5'                    TO DC-OPTION-CODE
  9045           PERFORM 9600-DATE-LINK
  9046           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9047           IF ERMAIL-FOUND
  9048               MOVE MA-CRED-BENE-NAME
  9049                           TO OC-CRED-BENE-NAME
  9050           END-IF
  9051           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9052               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9053                                  OC-INS-AGE-DEFAULT-FLAG
  9054               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9055                                  OC-JNT-AGE-DEFAULT-FLAG
  9056           END-IF
  9057
  9058
  9059* EXEC CICS REWRITE
  9060*             DATASET   ('ELCRTO')
  9061*             FROM      (ORIGINAL-CERTIFICATE)
  9062*             RESP      (WS-RESPONSE)
  9063*          END-EXEC
  9064     MOVE LENGTH OF
  9065      ORIGINAL-CERTIFICATE
  9066       TO DFHEIV11
  9067     MOVE 'ELCRTO' TO DFHEIV1
  9068*    MOVE '&& L                  %  N#00008463' TO DFHEIV0
  9069     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9070     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9071     MOVE X'204E233030303038343633' TO DFHEIV0(25:11)
  9072     CALL 'kxdfhei1' USING DFHEIV0,
  9073           DFHEIV1,
  9074           ORIGINAL-CERTIFICATE,
  9075           DFHEIV11,
  9076           DFHEIV99
  9077     MOVE EIBRESP  TO WS-RESPONSE
  9078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9079           IF NOT WS-RESP-NORMAL
  9080              MOVE ER-3830          TO EMI-ERROR
  9081              PERFORM 9700-ERROR-FORMAT
  9082                                 THRU 9799-EXIT
  9083              GO TO 8200-SEND-DATAONLY
  9084           END-IF
  9085
  9086           GO TO 4400-EXIT
  9087
  9088        ELSE
  9089           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9090        END-IF
  9091     ELSE
  9092        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9093        MOVE 'OC'                TO OC-RECORD-ID
  9094        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9095        MOVE 'I'                 TO OC-RECORD-TYPE
  9096        MOVE +4096               TO OC-KEY-SEQ-NO
  9097     END-IF
  9098
  9099     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  9100     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 169
* EL1278.cbl
  9101     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9102     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9103     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9104     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9105     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9106     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9107     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9108      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9109         MOVE SPACES             TO OC-LF-BENCD
  9110         MOVE ZEROS              TO OC-LF-TERM
  9111                                    OC-LF-BEN-AMT
  9112                                    OC-LF-PRM-AMT
  9113                                    OC-LF-ALT-BEN-AMT
  9114                                    OC-LF-ALT-PRM-AMT
  9115                                    OC-LF-COMM-PCT
  9116                                    OC-LF-CANCEL-AMT
  9117         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9118         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9119     ELSE
  9120         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9121         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9122         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9123         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9124         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9125         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9126         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9127         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9128         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9129         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9130     END-IF
  9131     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9132     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9133      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9134         MOVE SPACES             TO OC-AH-BENCD
  9135         MOVE ZEROS              TO OC-AH-TERM
  9136                                    OC-AH-BEN-AMT
  9137                                    OC-AH-PRM-AMT
  9138                                    OC-AH-COMM-PCT
  9139                                    OC-AH-CANCEL-AMT
  9140                                    OC-AH-CP
  9141         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9142         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9143     ELSE
  9144         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9145         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9146         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9147         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9148         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9149         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9150         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9151         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9152         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9153         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9154     END-IF
  9155     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9156     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9157     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9158     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 170
* EL1278.cbl
  9159     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9160     MOVE '5'                    TO DC-OPTION-CODE
  9161     PERFORM 9600-DATE-LINK
  9162     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9163     IF ERMAIL-FOUND
  9164         MOVE MA-CRED-BENE-NAME
  9165                     TO OC-CRED-BENE-NAME
  9166     END-IF
  9167     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9168         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9169                            OC-INS-AGE-DEFAULT-FLAG
  9170         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9171                            OC-JNT-AGE-DEFAULT-FLAG
  9172     END-IF
  9173
  9174     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9175     .
  9176 4400-WRITE-ELCRTO.
  9177
  9178
  9179* EXEC CICS WRITE
  9180*       DATASET   ('ELCRTO')
  9181*       FROM      (ORIGINAL-CERTIFICATE)
  9182*       RIDFLD    (OC-CONTROL-PRIMARY)
  9183*       RESP      (WS-RESPONSE)
  9184*    END-EXEC
  9185     MOVE LENGTH OF
  9186      ORIGINAL-CERTIFICATE
  9187       TO DFHEIV11
  9188     MOVE 'ELCRTO' TO DFHEIV1
  9189*    MOVE '&$ L                  ''  N#00008567' TO DFHEIV0
  9190     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9191     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9192     MOVE X'204E233030303038353637' TO DFHEIV0(25:11)
  9193     CALL 'kxdfhei1' USING DFHEIV0,
  9194           DFHEIV1,
  9195           ORIGINAL-CERTIFICATE,
  9196           DFHEIV11,
  9197           OC-CONTROL-PRIMARY,
  9198           DFHEIV99,
  9199           DFHEIV99
  9200     MOVE EIBRESP  TO WS-RESPONSE
  9201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9202
  9203    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9204        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9205        GO TO 4400-WRITE-ELCRTO
  9206    ELSE
  9207        IF NOT WS-RESP-NORMAL
  9208           MOVE ER-3830          TO EMI-ERROR
  9209           PERFORM 9700-ERROR-FORMAT
  9210                                 THRU 9799-EXIT
  9211           GO TO 8200-SEND-DATAONLY
  9212        END-IF
  9213    END-IF
  9214
  9215     .
  9216 4400-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 171
* EL1278.cbl
  9217    EXIT.
  9218
  9219
  9220 5000-GET-LF-AM-REM-TERM.
  9221     MOVE +1                     TO SUB3.
  9222
  9223 5100-GET-LF-AM-REM-TERM.
  9224     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9225        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9226           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9227                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9228           GO TO 5300-MOVE-LF-REM-TERM.
  9229
  9230     IF SUB3 LESS THAN +20
  9231        ADD +1                   TO SUB3
  9232        GO TO 5100-GET-LF-AM-REM-TERM.
  9233
  9234     MOVE +1                     TO SUB3.
  9235
  9236     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9237         GO TO 5200-EDIT-FOR-NINETY-LF.
  9238
  9239 5100-GET-LF-DMD-AM-REM-TERM.
  9240
  9241     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9242        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9243           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9244                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9245           GO TO 5300-MOVE-LF-REM-TERM.
  9246
  9247     IF SUB3 LESS THAN +30
  9248        ADD +1                   TO SUB3
  9249        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9250
  9251     MOVE +1                     TO SUB3.
  9252
  9253 5200-EDIT-FOR-NINETY-LF.
  9254
  9255***************************************************************
  9256*                                                             *
  9257*    NINETY BENEFIT PLAN TYPES:                               *
  9258*                                                             *
  9259*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9260*      92 = ALL GROUP REDUCING BENEFITS                       *
  9261*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9262*      94 = ALL GROUP LEVEL BENEFITS                          *
  9263*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9264*           BENEFIT CONTROLS.                                 *
  9265*      99 = ALL BENEFITS                                      *
  9266*                                                             *
  9267***************************************************************
  9268
  9269     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9270                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9271
  9272     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9273       AND
  9274        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 172
* EL1278.cbl
  9275           GO TO 5300-MOVE-LF-REM-TERM.
  9276
  9277     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9278       AND
  9279        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9280        IF CF-REDUCING (WS-INDEX)
  9281           IF CM-INDIVIDUAL
  9282               GO TO 5300-MOVE-LF-REM-TERM.
  9283
  9284     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9285       AND
  9286        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9287        IF CF-REDUCING (WS-INDEX)
  9288           IF CM-GROUP
  9289               GO TO 5300-MOVE-LF-REM-TERM.
  9290
  9291     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9292       AND
  9293        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9294        IF CF-LEVEL (WS-INDEX)
  9295           IF CM-INDIVIDUAL
  9296               GO TO 5300-MOVE-LF-REM-TERM.
  9297
  9298     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9299       AND
  9300        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9301        IF CF-LEVEL (WS-INDEX)
  9302           IF CM-GROUP
  9303               GO TO 5300-MOVE-LF-REM-TERM.
  9304
  9305     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9306       AND
  9307        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9308            GO TO 5300-MOVE-LF-REM-TERM.
  9309
  9310     IF SUB3 LESS THAN +20
  9311        ADD +1           TO SUB3
  9312          GO TO 5200-EDIT-FOR-NINETY-LF.
  9313
  9314     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9315
  9316     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9317         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9318         GO TO 5900-EXIT.
  9319
  9320     MOVE 1                       TO SUB3.
  9321
  9322 5200-EDIT-FOR-DMD-NINETY-LF.
  9323
  9324     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9325                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9326
  9327     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9328       AND
  9329        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9330           GO TO 5300-MOVE-LF-REM-TERM.
  9331
  9332     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 173
* EL1278.cbl
  9333       AND
  9334        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9335        IF CF-REDUCING (WS-INDEX)
  9336           IF CM-INDIVIDUAL
  9337               GO TO 5300-MOVE-LF-REM-TERM.
  9338
  9339     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9340       AND
  9341        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9342        IF CF-REDUCING (WS-INDEX)
  9343           IF CM-GROUP
  9344               GO TO 5300-MOVE-LF-REM-TERM.
  9345
  9346     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9347       AND
  9348        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9349        IF CF-LEVEL (WS-INDEX)
  9350           IF CM-INDIVIDUAL
  9351               GO TO 5300-MOVE-LF-REM-TERM.
  9352
  9353     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9354       AND
  9355        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9356        IF CF-LEVEL (WS-INDEX)
  9357           IF CM-GROUP
  9358               GO TO 5300-MOVE-LF-REM-TERM.
  9359
  9360     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9361       AND
  9362        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9363            GO TO 5300-MOVE-LF-REM-TERM.
  9364
  9365     IF SUB3 LESS THAN +30
  9366        ADD +1                   TO SUB3
  9367          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9368
  9369     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9370
  9371     GO TO 5900-EXIT.
  9372
  9373 5300-MOVE-LF-REM-TERM.
  9374     MOVE WS-SAVE-BENEFIT-REM-TERM
  9375                                 TO WS-LF-AM-REM-TERM-CALC.
  9376
  9377 5900-EXIT.
  9378      EXIT.
  9379
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 174
* EL1278.cbl
  9381
  9382 6000-GET-AH-AM-REM-TERM.
  9383     MOVE +1                     TO SUB3.
  9384
  9385 6100-GET-AH-AM-REM-TERM.
  9386
  9387     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9388        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9389           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9390                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9391           GO TO 6300-MOVE-AH-REM-TERM.
  9392
  9393     IF SUB3 LESS THAN +20
  9394        ADD +1                   TO SUB3
  9395        GO TO 6100-GET-AH-AM-REM-TERM.
  9396
  9397     MOVE +1                     TO SUB3.
  9398
  9399     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9400         GO TO 6200-EDIT-FOR-NINETY-AH.
  9401
  9402 6100-GET-AH-AM-DMD-REM-TERM.
  9403     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9404        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9405           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9406                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9407           GO TO 6300-MOVE-AH-REM-TERM.
  9408
  9409     IF SUB3 LESS THAN +30
  9410        ADD +1                   TO SUB3
  9411        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9412
  9413     MOVE +1                     TO SUB3.
  9414
  9415 6200-EDIT-FOR-NINETY-AH.
  9416
  9417***************************************************************
  9418*                                                             *
  9419*    NINETY BENEFIT PLAN TYPES:                               *
  9420*                                                             *
  9421*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9422*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9423*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9424*           BENEFIT CONTROLS.                                 *
  9425*      99 = ALL BENEFITS.                                     *
  9426*                                                             *
  9427***************************************************************
  9428
  9429     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9430                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9431
  9432     IF AM-BENEFIT-CODE (SUB3) = '99'
  9433       AND
  9434        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9435           GO TO 6300-MOVE-AH-REM-TERM.
  9436
  9437     IF AM-BENEFIT-CODE (SUB3) = '91'
  9438       AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 175
* EL1278.cbl
  9439        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9440           IF CM-INDIVIDUAL
  9441               GO TO 6300-MOVE-AH-REM-TERM.
  9442
  9443     IF AM-BENEFIT-CODE (SUB3) = '92'
  9444       AND
  9445        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9446           IF CM-GROUP
  9447               GO TO 6300-MOVE-AH-REM-TERM.
  9448
  9449     IF AM-BENEFIT-CODE (SUB3) = '98'
  9450       AND
  9451        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9452           GO TO 6300-MOVE-AH-REM-TERM.
  9453
  9454     IF SUB3 LESS THAN +20
  9455        ADD +1                    TO SUB3
  9456        GO TO 6200-EDIT-FOR-NINETY-AH.
  9457
  9458     MOVE +1                      TO SUB3.
  9459
  9460     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9461         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9462         GO TO 6900-EXIT.
  9463
  9464 6200-EDIT-FOR-DMD-NINETY-AH.
  9465
  9466     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9467                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9468
  9469     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9470       AND
  9471        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9472           GO TO 6300-MOVE-AH-REM-TERM.
  9473
  9474     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9475       AND
  9476        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9477           IF CM-INDIVIDUAL
  9478               GO TO 6300-MOVE-AH-REM-TERM.
  9479
  9480     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9481       AND
  9482        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9483           IF CM-GROUP
  9484               GO TO 6300-MOVE-AH-REM-TERM.
  9485
  9486     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9487       AND
  9488        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9489           GO TO 6300-MOVE-AH-REM-TERM.
  9490
  9491     IF SUB3 LESS THAN +30
  9492        ADD +1                   TO SUB3
  9493        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9494
  9495     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9496
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 176
* EL1278.cbl
  9497     GO TO 6900-EXIT.
  9498
  9499 6300-MOVE-AH-REM-TERM.
  9500
  9501     MOVE WS-SAVE-BENEFIT-REM-TERM
  9502                                 TO WS-AH-AM-REM-TERM-CALC.
  9503
  9504 6900-EXIT.
  9505      EXIT.
  9506
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 177
* EL1278.cbl
  9508 7000-GET-ERFORM     SECTION.
  9509
  9510* EXEC CICS HANDLE CONDITION
  9511*        NOTFND  (7000-EXIT)
  9512*    END-EXEC.
  9513*    MOVE '"$I                   ! ( #00008880' TO DFHEIV0
  9514     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9516     MOVE X'2820233030303038383830' TO DFHEIV0(25:11)
  9517     CALL 'kxdfhei1' USING DFHEIV0
  9518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9519
  9520
  9521     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9522     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9523     MOVE PI-STATE               TO  WS-FO-STATE.
  9524     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9525     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9526
  9527
  9528* EXEC CICS READ
  9529*        DATASET  (ERFORM-ID)
  9530*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9531*        SET      (ADDRESS OF FORM-MASTER)
  9532*        GTEQ
  9533*    END-EXEC.
  9534*    MOVE '&"S        G          (   #00008890' TO DFHEIV0
  9535     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9537     MOVE X'2020233030303038383930' TO DFHEIV0(25:11)
  9538     CALL 'kxdfhei1' USING DFHEIV0,
  9539           ERFORM-ID,
  9540           DFHEIV20,
  9541           DFHEIV99,
  9542           WS-FO-CONTROL-PRIMARY,
  9543           DFHEIV99,
  9544           DFHEIV99,
  9545           DFHEIV99
  9546     SET ADDRESS OF FORM-MASTER TO
  9547         DFHEIV20
  9548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9549
  9550
  9551     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9552        PI-STATE          EQUAL FO-STATE      AND
  9553        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9554         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9555         GO TO 7000-EXIT.
  9556 7000-EXIT.
  9557     EXIT.
  9558 7100-BENEFIT-SEARCH SECTION.
  9559
  9560     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9561        MOVE +1                  TO  SUB4
  9562        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9563
  9564     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9565        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 178
* EL1278.cbl
  9566        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9567 7100-EXIT.
  9568     EXIT.
  9569 7150-BENEFIT-LIFE-SEARCH.
  9570     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9571       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9572         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9573          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9574            IF FO-PLAN-REFUND-METHOD (SUB4)
  9575                    IS GREATER THAN SPACES
  9576               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9577                                    WS-LF-FO-REFUND-CALC
  9578               GO TO 7150-EXIT.
  9579
  9580     IF SUB4 LESS THAN +40
  9581         ADD +1              TO SUB4
  9582         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9583
  9584 7150-EXIT.
  9585     EXIT.
  9586 7250-BENEFIT-AH-SEARCH.
  9587     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9588       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9589         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9590          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9591            IF FO-PLAN-REFUND-METHOD (SUB4)
  9592                    IS GREATER THAN SPACES
  9593               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9594                                    WS-AH-FO-REFUND-CALC
  9595               GO TO 7250-EXIT.
  9596
  9597     IF SUB4 LESS THAN +40
  9598         ADD +1              TO SUB4
  9599         GO TO 7250-BENEFIT-AH-SEARCH.
  9600
  9601 7250-EXIT.
  9602     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 179
* EL1278.cbl
  9604
  9605 8100-SEND-INITIAL-MAP  SECTION.
  9606     MOVE SAVE-DATE              TO  HDATEO.
  9607     MOVE EIBTIME                TO  TIME-IN.
  9608     MOVE TIME-OUT               TO  HTIMEO.
  9609     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9610     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9611     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9612     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9613
  9614     IF CM-LF-BENEFIT-CD = '00'
  9615         MOVE -1                 TO  HACANCL
  9616     ELSE
  9617         MOVE -1                 TO  HLCANCL.
  9618
  9619     IF PI-COMPANY-ID NOT = 'DCC'
  9620        MOVE AL-SADOF            TO CANREAHA
  9621                                    CLPYNHA
  9622                                    CANREAA
  9623                                    CLPYNA
  9624     END-IF
  9625
  9626
  9627* EXEC CICS SEND
  9628*        FROM    (EL127HO)
  9629*        MAPSET  (MAPSET-NAME)
  9630*        MAP     (MAP-NAME)
  9631*        CURSOR
  9632*        ERASE
  9633*    END-EXEC.
  9634     MOVE LENGTH OF
  9635      EL127HO
  9636       TO DFHEIV12
  9637     MOVE -1
  9638       TO DFHEIV11
  9639*    MOVE '8$     CT  E    H L F ,   #00008972' TO DFHEIV0
  9640     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9641     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9642     MOVE X'2020233030303038393732' TO DFHEIV0(25:11)
  9643     CALL 'kxdfhei1' USING DFHEIV0,
  9644           MAP-NAME,
  9645           EL127HO,
  9646           DFHEIV12,
  9647           MAPSET-NAME,
  9648           DFHEIV99,
  9649           DFHEIV99,
  9650           DFHEIV99,
  9651           DFHEIV11,
  9652           DFHEIV99,
  9653           DFHEIV99,
  9654           DFHEIV99
  9655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9656
  9657
  9658     GO TO 9000-RETURN-TRAN.
  9659
  9660 8200-SEND-DATAONLY  SECTION.
  9661     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 180
* EL1278.cbl
  9662         GO TO 8100-SEND-INITIAL-MAP.
  9663
  9664     MOVE SAVE-DATE              TO  HDATEO.
  9665     MOVE EIBTIME                TO  TIME-IN.
  9666     MOVE TIME-OUT               TO  HTIMEO.
  9667     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9668     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9669     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9670     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9671     MOVE -1                     TO  HLCANCL.
  9672
  9673
  9674* EXEC CICS SEND DATAONLY
  9675*        FROM    (EL127HO)
  9676*        MAPSET  (MAPSET-NAME)
  9677*        MAP     (MAP-NAME)
  9678*        CURSOR
  9679*    END-EXEC.
  9680     MOVE LENGTH OF
  9681      EL127HO
  9682       TO DFHEIV12
  9683     MOVE -1
  9684       TO DFHEIV11
  9685*    MOVE '8$D    CT       H L F ,   #00008995' TO DFHEIV0
  9686     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9687     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9688     MOVE X'2020233030303038393935' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           MAP-NAME,
  9691           EL127HO,
  9692           DFHEIV12,
  9693           MAPSET-NAME,
  9694           DFHEIV99,
  9695           DFHEIV99,
  9696           DFHEIV99,
  9697           DFHEIV11,
  9698           DFHEIV99,
  9699           DFHEIV99,
  9700           DFHEIV99
  9701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9702
  9703
  9704     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 181
* EL1278.cbl
  9706 8300-SEND-TEXT  SECTION.
  9707
  9708* EXEC CICS SEND TEXT
  9709*        FROM    (LOGOFF-TEXT)
  9710*        LENGTH  (LOGOFF-LENGTH)
  9711*        ERASE
  9712*        FREEKB
  9713*    END-EXEC.
  9714*    MOVE '8&      T  E F  H   F -   #00009005' TO DFHEIV0
  9715     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9716     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9717     MOVE X'2020233030303039303035' TO DFHEIV0(25:11)
  9718     CALL 'kxdfhei1' USING DFHEIV0,
  9719           LOGOFF-TEXT,
  9720           LOGOFF-LENGTH,
  9721           DFHEIV99,
  9722           DFHEIV99,
  9723           DFHEIV99,
  9724           DFHEIV99,
  9725           DFHEIV99,
  9726           DFHEIV99,
  9727           DFHEIV99,
  9728           DFHEIV99,
  9729           DFHEIV99,
  9730           DFHEIV99
  9731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9732
  9733
  9734
  9735* EXEC CICS RETURN
  9736*    END-EXEC.
  9737*    MOVE '.(                    ''   #00009012' TO DFHEIV0
  9738     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9739     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9740     MOVE X'2020233030303039303132' TO DFHEIV0(25:11)
  9741     CALL 'kxdfhei1' USING DFHEIV0,
  9742           DFHEIV99,
  9743           DFHEIV99,
  9744           DFHEIV99,
  9745           DFHEIV99,
  9746           DFHEIV99,
  9747           DFHEIV99
  9748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9749
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 182
* EL1278.cbl
  9751 8600-DEEDIT  SECTION.
  9752
  9753* EXEC CICS BIF DEEDIT
  9754*        FIELD   (DEEDIT-FIELD)
  9755*        LENGTH  (15)
  9756*    END-EXEC.
  9757     MOVE 15
  9758       TO DFHEIV11
  9759*    MOVE '@"L                   #   #00009016' TO DFHEIV0
  9760     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9761     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9762     MOVE X'2020233030303039303136' TO DFHEIV0(25:11)
  9763     CALL 'kxdfhei1' USING DFHEIV0,
  9764           DEEDIT-FIELD,
  9765           DFHEIV11
  9766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9767
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 183
* EL1278.cbl
  9769 8700-UNAUTHORIZED-ACCESS  SECTION.
  9770     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9771
  9772     GO TO 8300-SEND-TEXT.
  9773
  9774 8800-PF23  SECTION.
  9775     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9776     MOVE XCTL-005               TO  PGM-NAME.
  9777
  9778     GO TO 9200-XCTL.
  9779
  9780 8900-RETURN-CICS  SECTION.
  9781
  9782* EXEC CICS RETURN
  9783*    END-EXEC.
  9784*    MOVE '.(                    ''   #00009033' TO DFHEIV0
  9785     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9786     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9787     MOVE X'2020233030303039303333' TO DFHEIV0(25:11)
  9788     CALL 'kxdfhei1' USING DFHEIV0,
  9789           DFHEIV99,
  9790           DFHEIV99,
  9791           DFHEIV99,
  9792           DFHEIV99,
  9793           DFHEIV99,
  9794           DFHEIV99
  9795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9796
  9797
  9798 9000-RETURN-TRAN  SECTION.
  9799     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9800     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9801
  9802
  9803* EXEC CICS RETURN
  9804*        TRANSID   (TRANS-ID)
  9805*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9806*        LENGTH    (PI-COMM-LENGTH)
  9807*    END-EXEC.
  9808*    MOVE '.(CT                  ''   #00009040' TO DFHEIV0
  9809     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9810     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9811     MOVE X'2020233030303039303430' TO DFHEIV0(25:11)
  9812     CALL 'kxdfhei1' USING DFHEIV0,
  9813           TRANS-ID,
  9814           PROGRAM-INTERFACE-BLOCK,
  9815           PI-COMM-LENGTH,
  9816           DFHEIV99,
  9817           DFHEIV99,
  9818           DFHEIV99
  9819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9820
  9821
  9822 9100-RETURN-MAIN-MENU  SECTION.
  9823     MOVE XCTL-126               TO  PGM-NAME.
  9824
  9825     GO TO 9200-XCTL.
  9826
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 184
* EL1278.cbl
  9827 9200-XCTL  SECTION.
  9828
  9829* EXEC CICS XCTL
  9830*        PROGRAM   (PGM-NAME)
  9831*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9832*        LENGTH    (PI-COMM-LENGTH)
  9833*    END-EXEC.
  9834*    MOVE '.$C                   %   #00009052' TO DFHEIV0
  9835     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9836     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9837     MOVE X'2020233030303039303532' TO DFHEIV0(25:11)
  9838     CALL 'kxdfhei1' USING DFHEIV0,
  9839           PGM-NAME,
  9840           PROGRAM-INTERFACE-BLOCK,
  9841           PI-COMM-LENGTH,
  9842           DFHEIV99
  9843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9844
  9845
  9846 9300-CLEAR  SECTION.
  9847     MOVE ' '                    TO  PI-PEND-SW.
  9848     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9849
  9850     GO TO 9200-XCTL.
  9851
  9852 9400-PF12  SECTION.
  9853     MOVE XCTL-010               TO  PGM-NAME.
  9854
  9855     GO TO 9200-XCTL.
  9856
  9857 9500-PGMID-ERROR  SECTION.
  9858
  9859* EXEC CICS HANDLE CONDITION
  9860*        PGMIDERR  (8300-SEND-TEXT)
  9861*    END-EXEC.
  9862*    MOVE '"$L                   ! ) #00009070' TO DFHEIV0
  9863     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9865     MOVE X'2920233030303039303730' TO DFHEIV0(25:11)
  9866     CALL 'kxdfhei1' USING DFHEIV0
  9867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9868
  9869
  9870     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9871     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9872     MOVE XCTL-005               TO  PGM-NAME.
  9873     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9874     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9875
  9876     GO TO 9200-XCTL.
  9877
  9878 9600-DATE-LINK  SECTION.
  9879     MOVE LINK-ELDATCV           TO  PGM-NAME
  9880
  9881
  9882* EXEC CICS LINK
  9883*        PROGRAM   (PGM-NAME)
  9884*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 185
* EL1278.cbl
  9885*        LENGTH    (DC-COMM-LENGTH)
  9886*    END-EXEC.
  9887*    MOVE '."C                   (   #00009085' TO DFHEIV0
  9888     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9890     MOVE X'2020233030303039303835' TO DFHEIV0(25:11)
  9891     CALL 'kxdfhei1' USING DFHEIV0,
  9892           PGM-NAME,
  9893           DATE-CONVERSION-DATA,
  9894           DC-COMM-LENGTH,
  9895           DFHEIV99,
  9896           DFHEIV99,
  9897           DFHEIV99,
  9898           DFHEIV99
  9899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9900
  9901
  9902
  9903 9700-ERROR-FORMAT  SECTION.
  9904     IF NOT EMI-ERRORS-COMPLETE
  9905         MOVE LINK-001               TO  PGM-NAME
  9906
  9907* EXEC CICS LINK
  9908*            PROGRAM   (PGM-NAME)
  9909*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  9910*            LENGTH    (EMI-COMM-LENGTH)
  9911*        END-EXEC.
  9912*    MOVE '."C                   (   #00009095' TO DFHEIV0
  9913     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9915     MOVE X'2020233030303039303935' TO DFHEIV0(25:11)
  9916     CALL 'kxdfhei1' USING DFHEIV0,
  9917           PGM-NAME,
  9918           ERROR-MESSAGE-INTERFACE-BLOCK,
  9919           EMI-COMM-LENGTH,
  9920           DFHEIV99,
  9921           DFHEIV99,
  9922           DFHEIV99,
  9923           DFHEIV99
  9924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9925
  9926
  9927 9799-EXIT.
  9928     EXIT.
  9929
  9930 9800-SECURITY-VIOLATION  SECTION.
  9931*                            COPY ELCSCTP.
  9932******************************************************************
  9933*                                                                *
  9934*                            ELCSCTP                             *
  9935*                            VMOD=2.001                          *
  9936*                                                                *
  9937*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9938******************************************************************
  9939
  9940
  9941     MOVE EIBDATE          TO SM-JUL-DATE.
  9942     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 186
* EL1278.cbl
  9943     MOVE THIS-PGM         TO SM-PGM.
  9944     MOVE EIBTIME          TO TIME-IN.
  9945     MOVE TIME-OUT         TO SM-TIME.
  9946     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9947
  9948
  9949* EXEC CICS LINK
  9950*         PROGRAM  ('EL003')
  9951*         COMMAREA (SECURITY-MESSAGE)
  9952*         LENGTH   (80)
  9953*    END-EXEC.
  9954     MOVE 'EL003' TO DFHEIV1
  9955     MOVE 80
  9956       TO DFHEIV11
  9957*    MOVE '."C                   (   #00009122' TO DFHEIV0
  9958     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9960     MOVE X'2020233030303039313232' TO DFHEIV0(25:11)
  9961     CALL 'kxdfhei1' USING DFHEIV0,
  9962           DFHEIV1,
  9963           SECURITY-MESSAGE,
  9964           DFHEIV11,
  9965           DFHEIV99,
  9966           DFHEIV99,
  9967           DFHEIV99,
  9968           DFHEIV99
  9969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9970
  9971
  9972******************************************************************
  9973
  9974
  9975 9899-EXIT.
  9976     EXIT.
  9977
  9978 9900-ABEND  SECTION.
  9979     MOVE LINK-004               TO  PGM-NAME.
  9980     MOVE DFHEIBLK               TO  EMI-LINE1.
  9981
  9982
  9983* EXEC CICS LINK
  9984*        PROGRAM   (PGM-NAME)
  9985*        COMMAREA  (EMI-LINE1)
  9986*        LENGTH    (72)
  9987*    END-EXEC.
  9988     MOVE 72
  9989       TO DFHEIV11
  9990*    MOVE '."C                   (   #00009138' TO DFHEIV0
  9991     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9993     MOVE X'2020233030303039313338' TO DFHEIV0(25:11)
  9994     CALL 'kxdfhei1' USING DFHEIV0,
  9995           PGM-NAME,
  9996           EMI-LINE1,
  9997           DFHEIV11,
  9998           DFHEIV99,
  9999           DFHEIV99,
 10000           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 187
* EL1278.cbl
 10001           DFHEIV99
 10002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10003
 10004
 10005     MOVE -1                     TO  HLCANCL.
 10006
 10007     GO TO 8200-SEND-DATAONLY.
 10008
 10009 9999-LAST-PARAGRAPH.
 10010
 10011* GOBACK.
 10012     MOVE '9%                    "   ' TO DFHEIV0
 10013     MOVE 'EL1278' TO DFHEIV1
 10014     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10015     GOBACK.
 10016
 10017 9999-DFHBACK SECTION.
 10018     MOVE '9%                    "   ' TO DFHEIV0
 10019     MOVE 'EL1278' TO DFHEIV1
 10020     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10021     GOBACK.
 10022 9999-DFHEXIT.
 10023     IF DFHEIGDJ EQUAL 0001
 10024         NEXT SENTENCE
 10025     ELSE IF DFHEIGDJ EQUAL 2
 10026         GO TO 9500-PGMID-ERROR,
 10027               9900-ABEND
 10028         DEPENDING ON DFHEIGDI
 10029     ELSE IF DFHEIGDJ EQUAL 3
 10030         GO TO 0910-NOT-FOUND
 10031         DEPENDING ON DFHEIGDI
 10032     ELSE IF DFHEIGDJ EQUAL 4
 10033         GO TO 1010-NOTFND,
 10034               1020-NOTOPEN
 10035         DEPENDING ON DFHEIGDI
 10036     ELSE IF DFHEIGDJ EQUAL 5
 10037         GO TO 1290-ACCT-NOT-FOUND,
 10038               1290-ACCT-NOT-FOUND
 10039         DEPENDING ON DFHEIGDI
 10040     ELSE IF DFHEIGDJ EQUAL 6
 10041         GO TO 0580-ACCT-NOT-FOUND,
 10042               0580-ACCT-NOT-FOUND
 10043         DEPENDING ON DFHEIGDI
 10044     ELSE IF DFHEIGDJ EQUAL 7
 10045         GO TO 1699-EXIT
 10046         DEPENDING ON DFHEIGDI
 10047     ELSE IF DFHEIGDJ EQUAL 8
 10048         GO TO 7000-EXIT
 10049         DEPENDING ON DFHEIGDI
 10050     ELSE IF DFHEIGDJ EQUAL 9
 10051         GO TO 8300-SEND-TEXT
 10052         DEPENDING ON DFHEIGDI.
 10053     MOVE '9%                    "   ' TO DFHEIV0
 10054     MOVE 'EL1278' TO DFHEIV1
 10055     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10056     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 188
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8608     Code:       26290
