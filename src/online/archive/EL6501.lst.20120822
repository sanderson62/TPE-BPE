* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   1
* EL6501.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL6501.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   2
* EL6501.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55******************************************************************
    56
    57 ENVIRONMENT DIVISION.
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   3
* EL6501.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    63 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    64                                   USAGE POINTER.
    65 77  FILLER  PIC X(32)  VALUE '********************************'.
    66 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    67 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    68 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    69     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    70 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    71     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    72 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    73 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    74 01  WS-DEGUG-AREA.
    75     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    76     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    77     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    78     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    79     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    80     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    81     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    82     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    83 01  S1                          PIC S999   VALUE +0    COMP.
    84 01  WS-WORK-FIELD.
    85     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    86 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    87 01  WS-DATE-AREA.
    88     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    89     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    90
    91***DMD CUSTOM CODE *****START
    92     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    93     12  WS-DMD-AGENT            PIC X(10).
    94     12  WS-YYYYMMDD             PIC X(8).
    95     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
    96                                 PIC 9(8).
    97***DMD CUSTOM CODE *****END
    98
    99 01  WS-ACCOUNT-NUM-AREA.
   100     12  WS-ACCOUNT-FILLER       PIC X(06).
   101     12  WS-ACCT-BRANCH-CD       PIC X(04).
   102
   103 01  WS-NAME-AREA.
   104     12  WS-NAME-1-4             PIC X(04).
   105     12  WS-NAME-FILLER          PIC X(26).
   106
   107 01  STANDARD-AREAS.
   108     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   109         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   110     12  WS-RESPONSE             PIC S9(8)   COMP.
   111         88  RESP-NORMAL                  VALUE +00.
   112         88  RESP-NOTFND                  VALUE +13.
   113         88  RESP-DUPREC                  VALUE +14.
   114         88  RESP-DUPKEY                  VALUE +15.
   115         88  RESP-NOTOPEN                 VALUE +19.
   116         88  RESP-ENDFILE                 VALUE +20.
   117
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   4
* EL6501.cbl
   118     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   119     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   120     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   121     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   122     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   123     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   124     12  PGM-NAME                PIC X(8).
   125     12  TIME-IN                 PIC S9(7).
   126     12  TIME-OUT-R REDEFINES TIME-IN.
   127         16  FILLER              PIC X.
   128         16  TIME-OUT            PIC 99V99.
   129         16  FILLER              PIC XX.
   130     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   131     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   132     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   133     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   134     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   135     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   136     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   137     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   138     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   139     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   140     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   141     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   142     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   143     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   144     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   145     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   146     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   147     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   148     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   149     12  FILE-ID                 PIC X(8).
   150     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   151     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   152     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   153     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   154     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   155     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   156     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   157     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   158     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   159     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   160     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   161     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   162     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   163     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   164     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   165     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   166     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   167     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   168     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   169     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   170     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   171*                                copy ERCGXRF.
   172******************************************************************
   173*                                                                *
   174*                                                                *
   175*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   5
* EL6501.cbl
   176*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   177*                            VMOD=2.002                          *
   178*                                                                *
   179*   ONLINE CREDIT SYSTEM                                         *
   180*                                                                *
   181*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   182*                                                                *
   183*   FILE TYPE = VSAM,KSDS                                        *
   184*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   185*                                                                *
   186*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   187*       ALTERNATE PATH = NONE                                    *
   188*                                                                *
   189*   LOG = NO                                                     *
   190*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   191*                                                                *
   192******************************************************************
   193
   194 01  AGENT-CROSS-REFERENCE.
   195     12  GX-RECORD-ID                PIC XX.
   196         88  VALID-GX-ID             VALUE 'GX'.
   197
   198     12  GX-CONTROL-PRIMARY.
   199         16  GX-COMPANY-CD           PIC X.
   200         16  GX-CARRIER              PIC X.
   201         16  GX-GROUPING             PIC X(6).
   202         16  GX-AGENT-NO             PIC X(10).
   203
   204     12  GX-MAINT-INFORMATION.
   205         16  GX-LAST-MAINT-DT        PIC XX.
   206         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   207         16  GX-LAST-MAINT-USER      PIC X(4).
   208         16  FILLER                  PIC X(9).
   209
   210     12  FILLER                      PIC X(37).
   211
   212     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   213
   214     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   215                            DEPENDING ON GX-AGENT-POINTER-CNT.
   216         16  GX-AM-CARRIER           PIC X.
   217         16  GX-AM-GROUPING          PIC X(6).
   218         16  GX-AM-STATE             PIC XX.
   219         16  GX-AM-ACCOUNT           PIC X(10).
   220         16  GX-AM-EXPIRATION-DT     PIC XX.
   221         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   222         16  GX-LAST-BILL-DT         PIC XX.
   223         16  GX-AM-EFF-DT            PIC XX.
   224         16  FILLER                  PIC X(4).
   225
   226******************************************************************
   227 01  WORK-AREAS-AND-SWITCHES.
   228     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   229     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   230     12  WS-ST-COMMISSION-CAPS.
   231         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   232         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   233         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   6
* EL6501.cbl
   234         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   235     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   236     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   237         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
   238
   239     12  COMMISSION-ACCUMS.
   240         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   241         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   242         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   243         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   244
   245     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   246     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   247     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   248     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   249     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   250     12  CURRENT-SAVE            PIC 9(8).
   251     12  BIN-CURRENT-SAVE        PIC XX.
   252     12  CYMD-CURRENT-SAVE       PIC 9(8).
   253     12  SUB                     PIC 99.
   254     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   255     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   256     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   257         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   258
   259     12  WS-EDIT-BEN-CODE        PIC XX.
   260         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   261                                          '90' THRU '99'.
   262
   263     12  WS-KEY-SAVE.
   264           18  WS-ACCT-CCGSA-KEY.
   265             20  WS-ACCT-CO             PIC X.
   266             20  WS-ACCT-CARRIER        PIC X.
   267             20  WS-ACCT-GROUPING       PIC X(6).
   268             20  WS-ACCT-STATE          PIC XX.
   269             20  WS-ACCT-ACCOUNT        PIC X(10).
   270           18  WS-ACCT-EXP-DT           PIC XX.
   271           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   272
   273     12  DEEDIT-FIELD                   PIC X(15).
   274     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   275     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   276     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   277     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   278     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
   279
   280     12  ELCNTL-KEY.
   281         16  CNTL-COMP-ID        PIC XXX.
   282         16  CNTL-REC-TYPE       PIC X.
   283         16  CNTL-ACCESS.
   284             20  FILLER          PIC X(4).
   285         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   286             20  FILLER          PIC XX.
   287             20  CNTL-BUS-TYPE   PIC XX.
   288         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   289             20  FILLER          PIC XX.
   290             20  CNTL-BEN-TYPE   PIC XX.
   291         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   7
* EL6501.cbl
   292
   293     12  REIN-KEY.
   294         16  REIN-COMP-CD        PIC X.
   295         16  REIN-CODE           PIC X.
   296         16  REIN-TABLE          PIC X(3).
   297         16  FILLER              PIC X(3).
   298
   299     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   300     12  COMM-KEY.
   301         16  COMM-COMP-CD        PIC X.
   302         16  COMM-TABLE          PIC XXX.
   303         16  COMM-LF-AH          PIC X.
   304         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   305
   306     12  RQST-KEY.
   307         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   308         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   309
   310     12  RQST3-KEY.
   311         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   312         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   313         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   314         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   315         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   316         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   317         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   318
   319     12  SAVE-RQST3-KEY.
   320         16  FILLER              PIC X     VALUE SPACES.
   321         16  FILLER              PIC X     VALUE SPACES.
   322         16  FILLER              PIC X(6)  VALUE SPACES.
   323         16  FILLER              PIC X(10) VALUE SPACES.
   324         16  FILLER              PIC X(10) VALUE SPACES.
   325         16  FILLER              PIC X(12) VALUE SPACES.
   326         16  FILLER              PIC X(6)  VALUE SPACES.
   327
   328     12  COMP-KEY.
   329         16  COMP-COMPANY-CD     PIC X.
   330         16  COMP-CARRIER        PIC X.
   331         16  COMP-GROUPING       PIC X(6).
   332         16  COMP-RESP-NO        PIC X(10).
   333         16  COMP-ACCOUNT        PIC X(10).
   334         16  COMP-TYPE           PIC X.
   335
   336     12  WS-AXRF-KEY.
   337         16  WS-AXRF-COMPANY-CD  PIC X.
   338         16  WS-AXRF-CARRIER     PIC X.
   339         16  WS-AXRF-GROUPING    PIC X(6).
   340         16  WS-AXRF-AGENT-NO    PIC X(10).
   341
   342     12  GX-AM-CONTROL-PRIMARY.
   343         16  GX-AM-COMPANY-CD    PIC X.
   344         16  GX-REST-OF-KEY      PIC X(20).
   345
   346     12  QID.
   347         16  QID-TERM            PIC X(4).
   348         16  FILLER              PIC X(4)    VALUE '6501'.
   349
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   8
* EL6501.cbl
   350     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   351         88  BROWSE-STARTED         VALUE 'Y'.
   352     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   353         88  FIRST-TIME             VALUE 'Y'.
   354
   355     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   356     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   357     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   358     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   359     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   360     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   361     12  GETMAIN-SW              PIC X       VALUE SPACES.
   362     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   363         88  GETMAIN-ACQUIRED                VALUE 'X'.
   364
   365     12  ER-0000                 PIC X(4)    VALUE '0000'.
   366     12  ER-0002                 PIC X(4)    VALUE '0002'.
   367     12  ER-0004                 PIC X(4)    VALUE '0004'.
   368     12  ER-0008                 PIC X(4)    VALUE '0008'.
   369     12  ER-0023                 PIC X(4)    VALUE '0023'.
   370     12  ER-0029                 PIC X(4)    VALUE '0029'.
   371     12  ER-0033                 PIC X(4)    VALUE '0033'.
   372     12  ER-0144                 PIC X(4)    VALUE '0144'.
   373     12  ER-0070                 PIC X(4)    VALUE '0070'.
   374     12  ER-0250                 PIC X(4)    VALUE '0250'.
   375     12  ER-0348                 PIC X(4)    VALUE '0348'.
   376     12  ER-0454                 PIC X(4)    VALUE '0454'.
   377     12  ER-0625                 PIC X(4)    VALUE '0625'.
   378     12  ER-0759                 PIC X(4)    VALUE '0759'.
   379     12  ER-0788                 PIC X(4)    VALUE '0788'.
   380     12  ER-0852                 PIC X(4)    VALUE '0852'.
   381     12  ER-0899                 PIC X(4)    VALUE '0899'.
   382     12  ER-1778                 PIC X(4)    VALUE '1778'.
   383     12  ER-1817                 PIC X(4)    VALUE '1817'.
   384     12  ER-1883                 PIC X(4)    VALUE '1883'.
   385     12  ER-1884                 PIC X(4)    VALUE '1884'.
   386     12  ER-1885                 PIC X(4)    VALUE '1885'.
   387     12  ER-1886                 PIC X(4)    VALUE '1886'.
   388     12  ER-1887                 PIC X(4)    VALUE '1887'.
   389     12  ER-2045                 PIC X(4)    VALUE '2045'.
   390     12  ER-2071                 PIC X(4)    VALUE '2071'.
   391     12  ER-2131                 PIC X(4)    VALUE '2131'.
   392*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   393     12  ER-2151                 PIC X(4)    VALUE '2151'.
   394     12  ER-2152                 PIC X(4)    VALUE '2152'.
   395     12  ER-2153                 PIC X(4)    VALUE '2153'.
   396     12  ER-2154                 PIC X(4)    VALUE '2154'.
   397     12  ER-2155                 PIC X(4)    VALUE '2155'.
   398     12  ER-2156                 PIC X(4)    VALUE '2156'.
   399     12  ER-2157                 PIC X(4)    VALUE '2157'.
   400     12  ER-2158                 PIC X(4)    VALUE '2158'.
   401     12  ER-2159                 PIC X(4)    VALUE '2159'.
   402     12  ER-2160                 PIC X(4)    VALUE '2160'.
   403     12  ER-2165                 PIC X(4)    VALUE '2165'.
   404     12  ER-2168                 PIC X(4)    VALUE '2168'.
   405     12  ER-2169                 PIC X(4)    VALUE '2169'.
   406     12  ER-2170                 PIC X(4)    VALUE '2170'.
   407     12  ER-2172                 PIC X(4)    VALUE '2172'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   9
* EL6501.cbl
   408     12  ER-2173                 PIC X(4)    VALUE '2173'.
   409     12  ER-2174                 PIC X(4)    VALUE '2174'.
   410     12  ER-2175                 PIC X(4)    VALUE '2175'.
   411     12  ER-2176                 PIC X(4)    VALUE '2176'.
   412     12  ER-2177                 PIC X(4)    VALUE '2177'.
   413     12  ER-2178                 PIC X(4)    VALUE '2178'.
   414     12  ER-2179                 PIC X(4)    VALUE '2179'.
   415     12  ER-2180                 PIC X(4)    VALUE '2180'.
   416     12  ER-2181                 PIC X(4)    VALUE '2181'.
   417     12  ER-2182                 PIC X(4)    VALUE '2182'.
   418     12  ER-2183                 PIC X(4)    VALUE '2183'.
   419     12  ER-2189                 PIC X(4)    VALUE '2189'.
   420     12  ER-2572                 PIC X(4)    VALUE '2572'.
   421     12  ER-2615                 PIC X(4)    VALUE '2615'.
   422     12  ER-2949                 PIC X(4)    VALUE '2949'.
   423     12  ER-2970                 PIC X(4)    VALUE '2970'.
   424     12  ER-4009                 PIC X(4)    VALUE '4009'.
   425     12  ER-4010                 PIC X(4)    VALUE '4010'.
   426     12  ER-4011                 PIC X(4)    VALUE '4011'.
   427     12  ER-4012                 PIC X(4)    VALUE '4012'.
   428     12  ER-7717                 PIC X(4)    VALUE '7717'.
   429     12  ER-9999                 PIC X(4)    VALUE '9999'.
   430     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   431
   432     12  WSS-LINE-LIAB-LIMITS.
   433         16  WSS-LF-LIMITS.
   434             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   435             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   436             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   437                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   438                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   439                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   440         16  WSS-AH-LIMITS.
   441             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   442             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   443             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   444                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   445                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   446                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   447                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   448
   449     12  WSS-COMM-STRUCTURE.
   450         16  WSS-DEFN-1.
   451             20  WSS-AGT-COMMS.
   452                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   453                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   454                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   455                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   456                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   457                 24  FILLER      PIC X(6)     VALUE SPACES.
   458
   459     12  WS-PHONE.
   460         16  WS-PH1              PIC XXX.
   461         16  WS-PH2              PIC XXX.
   462         16  WS-PH3              PIC XXXX.
   463     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   464
   465     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  10
* EL6501.cbl
   466     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   467     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   468     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   469     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   470     12  WS-BUS-TYPE             PIC 99.
   471     12  WS-BUS-ENTRY            PIC 99.
   472     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   473     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   474     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   475     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   476     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   477     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   478     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   479         88  COMMISSION-ERROR    VALUE 1.
   480     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   481     12  AGENT-FIND              PIC X        VALUE SPACES.
   482         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   483         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   484         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   485
   486     12  WS-ZIP-CODE.
   487         16  WS-ZIP-1            PIC X.
   488             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   489         16  WS-ZIP-2-3          PIC XX.
   490         16  WS-ZIP-4            PIC X.
   491         16  WS-ZIP-5            PIC X.
   492         16  WS-ZIP-6            PIC X.
   493         16  FILLER              PIC X(4).
   494     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   495         16  WS-ZIP-AM-1-CODE    PIC X(5).
   496         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   497         16  FILLER              PIC X.
   498     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   499         16  WS-ZIP-AM-2-CODE    PIC X(5).
   500         16  WS-ZIP-AM-2-DASH    PIC X.
   501         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   502     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   503         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   504         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   505         16  FILLER              PIC X(4).
   506     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   507         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   508         16  FILLER              PIC X.
   509         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   510         16  FILLER              PIC XXX.
   511     12  WS-SOC-SEC-WORK.
   512         16  WS-SS-TYPE          PIC X.
   513         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  11
* EL6501.cbl
   515*    COPY ELCSCTM.
   516******************************************************************
   517*                                                                *
   518*                                                                *
   519*                            ELCSCTM                             *
   520*                            VMOD=2.001                          *
   521*                                                                *
   522*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   523*                                                                *
   524******************************************************************
   525 01  SECURITY-MESSAGE.
   526     12  FILLER                          PIC X(30)
   527            VALUE '** LOGIC SECURITY VIOLATION -'.
   528     12  SM-READ                         PIC X(6).
   529     12  FILLER                          PIC X(5)
   530            VALUE ' PGM='.
   531     12  SM-PGM                          PIC X(6).
   532     12  FILLER                          PIC X(5)
   533            VALUE ' OPR='.
   534     12  SM-PROCESSOR-ID                 PIC X(4).
   535     12  FILLER                          PIC X(6)
   536            VALUE ' TERM='.
   537     12  SM-TERMID                       PIC X(4).
   538     12  FILLER                          PIC XX   VALUE SPACE.
   539     12  SM-JUL-DATE                     PIC 9(5).
   540     12  FILLER                          PIC X    VALUE SPACE.
   541     12  SM-TIME                         PIC 99.99.
   542
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  12
* EL6501.cbl
   544*    COPY ELCSCRTY.
   545******************************************************************
   546*                                                                *
   547*                                                                *
   548*                            ELCSCRTY                            *
   549*                            VMOD=2.001                          *
   550*                                                                *
   551*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   552*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   553*        SAVED IN PI-SECURITY-ADDRESS.                           *
   554*                                                                *
   555******************************************************************
   556 01  SECURITY-CONTROL.
   557     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   558     12  FILLER                       PIC XX    VALUE 'SC'.
   559     12  SC-CREDIT-CODES.
   560         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   561             20  SC-CREDIT-DISPLAY    PIC X.
   562             20  SC-CREDIT-UPDATE     PIC X.
   563     12  SC-CLAIMS-CODES.
   564         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   565             20  SC-CLAIMS-DISPLAY    PIC X.
   566             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  13
* EL6501.cbl
   568*    COPY ELCLOGOF.
   569******************************************************************
   570*                                                                *
   571*                                                                *
   572*                            ELCLOGOF.                           *
   573*                            VMOD=2.001                          *
   574*                                                                *
   575*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   576*                                                                *
   577******************************************************************
   578 01  CLASIC-LOGOFF.
   579     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   580     12  LOGOFF-TEXT.
   581         16  FILLER          PIC X(5)    VALUE SPACES.
   582         16  LOGOFF-MSG.
   583             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   584             20  FILLER      PIC X       VALUE SPACES.
   585             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   586         16  FILLER          PIC X(80)
   587           VALUE '* YOU ARE NOW LOGGED OFF'.
   588         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   589         16  FILLER          PIC X       VALUE QUOTE.
   590         16  LOGOFF-SYS-MSG  PIC X(17)
   591           VALUE 'S CLAS-IC SYSTEM '.
   592     12  TEXT-MESSAGES.
   593         16  UNACCESS-MSG    PIC X(29)
   594             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   595         16  PGMIDERR-MSG    PIC X(17)
   596             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  14
* EL6501.cbl
   598*    COPY ELCDATE.
   599******************************************************************
   600*                                                                *
   601*                                                                *
   602*                            ELCDATE.                            *
   603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   604*                            VMOD=2.003
   605*                                                                *
   606*                                                                *
   607*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   608*                 LENGTH = 200                                   *
   609******************************************************************
   610
   611 01  DATE-CONVERSION-DATA.
   612     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   613     12  DC-OPTION-CODE                PIC X.
   614         88  BIN-TO-GREG                VALUE ' '.
   615         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   616         88  EDIT-GREG-TO-BIN           VALUE '2'.
   617         88  YMD-GREG-TO-BIN            VALUE '3'.
   618         88  MDY-GREG-TO-BIN            VALUE '4'.
   619         88  JULIAN-TO-BIN              VALUE '5'.
   620         88  BIN-PLUS-ELAPSED           VALUE '6'.
   621         88  FIND-CENTURY               VALUE '7'.
   622         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   623         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   624         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   625         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   626         88  JULIAN-TO-BIN-3            VALUE 'C'.
   627         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   628         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   629         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   630         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   631         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   632         88  CHECK-LEAP-YEAR            VALUE 'H'.
   633         88  BIN-3-TO-GREG              VALUE 'I'.
   634         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   635         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   636         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   637         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   638         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   639         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   640         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   641         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   642         88  THREE-CHARACTER-BIN
   643                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   644         88  GREGORIAN-TO-BIN
   645                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   646         88  BIN-TO-GREGORIAN
   647                  VALUES ' ' '1' 'I' '8' 'G'.
   648         88  JULIAN-TO-BINARY
   649                  VALUES '5' 'C' 'E' 'F'.
   650     12  DC-ERROR-CODE                 PIC X.
   651         88  NO-CONVERSION-ERROR        VALUE ' '.
   652         88  DATE-CONVERSION-ERROR
   653                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   654         88  DATE-IS-ZERO               VALUE '1'.
   655         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  15
* EL6501.cbl
   656         88  DATE-IS-INVALID            VALUE '3'.
   657         88  DATE1-GREATER-DATE2        VALUE '4'.
   658         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   659         88  DATE-INVALID-OPTION        VALUE '9'.
   660         88  INVALID-CENTURY            VALUE 'A'.
   661         88  ONLY-CENTURY               VALUE 'B'.
   662         88  ONLY-LEAP-YEAR             VALUE 'C'.
   663         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   664     12  DC-END-OF-MONTH               PIC X.
   665         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   666     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   667         88  USE-NORMAL-PROCESS         VALUE ' '.
   668         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   669         88  ADJUST-UP-100-YRS          VALUE '2'.
   670     12  FILLER                        PIC X.
   671     12  DC-CONVERSION-DATES.
   672         16  DC-BIN-DATE-1             PIC XX.
   673         16  DC-BIN-DATE-2             PIC XX.
   674         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   675         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   676                       DC-GREG-DATE-1-EDIT.
   677             20  DC-EDIT1-MONTH        PIC 99.
   678             20  SLASH1-1              PIC X.
   679             20  DC-EDIT1-DAY          PIC 99.
   680             20  SLASH1-2              PIC X.
   681             20  DC-EDIT1-YEAR         PIC 99.
   682         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   683         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   684                     DC-GREG-DATE-2-EDIT.
   685             20  DC-EDIT2-MONTH        PIC 99.
   686             20  SLASH2-1              PIC X.
   687             20  DC-EDIT2-DAY          PIC 99.
   688             20  SLASH2-2              PIC X.
   689             20  DC-EDIT2-YEAR         PIC 99.
   690         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   691         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   692                     DC-GREG-DATE-1-YMD.
   693             20  DC-YMD-YEAR           PIC 99.
   694             20  DC-YMD-MONTH          PIC 99.
   695             20  DC-YMD-DAY            PIC 99.
   696         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   697         16  DC-GREG-DATE-1-MDY-R REDEFINES
   698                      DC-GREG-DATE-1-MDY.
   699             20  DC-MDY-MONTH          PIC 99.
   700             20  DC-MDY-DAY            PIC 99.
   701             20  DC-MDY-YEAR           PIC 99.
   702         16  DC-GREG-DATE-1-ALPHA.
   703             20  DC-ALPHA-MONTH        PIC X(10).
   704             20  DC-ALPHA-DAY          PIC 99.
   705             20  FILLER                PIC XX.
   706             20  DC-ALPHA-CENTURY.
   707                 24 DC-ALPHA-CEN-N     PIC 99.
   708             20  DC-ALPHA-YEAR         PIC 99.
   709         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   710         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   711         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   712         16  DC-JULIAN-DATE            PIC 9(05).
   713         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  16
* EL6501.cbl
   714                                       PIC 9(05).
   715         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   716             20  DC-JULIAN-YEAR        PIC 99.
   717             20  DC-JULIAN-DAYS        PIC 999.
   718         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   719         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   720         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   721     12  DATE-CONVERSION-VARIBLES.
   722         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   723         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   724             20  FILLER                PIC 9(3).
   725             20  HOLD-CEN-1-CCYY.
   726                 24  HOLD-CEN-1-CC     PIC 99.
   727                 24  HOLD-CEN-1-YY     PIC 99.
   728             20  HOLD-CEN-1-MO         PIC 99.
   729             20  HOLD-CEN-1-DA         PIC 99.
   730         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   731             20  HOLD-CEN-1-R-MO       PIC 99.
   732             20  HOLD-CEN-1-R-DA       PIC 99.
   733             20  HOLD-CEN-1-R-CCYY.
   734                 24  HOLD-CEN-1-R-CC   PIC 99.
   735                 24  HOLD-CEN-1-R-YY   PIC 99.
   736             20  FILLER                PIC 9(3).
   737         16  HOLD-CENTURY-1-X.
   738             20  FILLER                PIC X(3)  VALUE SPACES.
   739             20  HOLD-CEN-1-X-CCYY.
   740                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   741                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   743             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   744         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   745             20  HOLD-CEN-1-R-X-MO     PIC XX.
   746             20  HOLD-CEN-1-R-X-DA     PIC XX.
   747             20  HOLD-CEN-1-R-X-CCYY.
   748                 24  HOLD-CEN-1-R-X-CC PIC XX.
   749                 24  HOLD-CEN-1-R-X-YY PIC XX.
   750             20  FILLER                PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   752         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   753         16  DC-JULIAN-DATE-1          PIC 9(07).
   754         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   755             20  DC-JULIAN-1-CCYY.
   756                 24  DC-JULIAN-1-CC    PIC 99.
   757                 24  DC-JULIAN-1-YR    PIC 99.
   758             20  DC-JULIAN-DA-1        PIC 999.
   759         16  DC-JULIAN-DATE-2          PIC 9(07).
   760         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   761             20  DC-JULIAN-2-CCYY.
   762                 24  DC-JULIAN-2-CC    PIC 99.
   763                 24  DC-JULIAN-2-YR    PIC 99.
   764             20  DC-JULIAN-DA-2        PIC 999.
   765         16  DC-GREG-DATE-A-EDIT.
   766             20  DC-EDITA-MONTH        PIC 99.
   767             20  SLASHA-1              PIC X VALUE '/'.
   768             20  DC-EDITA-DAY          PIC 99.
   769             20  SLASHA-2              PIC X VALUE '/'.
   770             20  DC-EDITA-CCYY.
   771                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  17
* EL6501.cbl
   772                 24  DC-EDITA-YEAR     PIC 99.
   773         16  DC-GREG-DATE-B-EDIT.
   774             20  DC-EDITB-MONTH        PIC 99.
   775             20  SLASHB-1              PIC X VALUE '/'.
   776             20  DC-EDITB-DAY          PIC 99.
   777             20  SLASHB-2              PIC X VALUE '/'.
   778             20  DC-EDITB-CCYY.
   779                 24  DC-EDITB-CENT     PIC 99.
   780                 24  DC-EDITB-YEAR     PIC 99.
   781         16  DC-GREG-DATE-CYMD         PIC 9(08).
   782         16  DC-GREG-DATE-CYMD-R REDEFINES
   783                              DC-GREG-DATE-CYMD.
   784             20  DC-CYMD-CEN           PIC 99.
   785             20  DC-CYMD-YEAR          PIC 99.
   786             20  DC-CYMD-MONTH         PIC 99.
   787             20  DC-CYMD-DAY           PIC 99.
   788         16  DC-GREG-DATE-MDCY         PIC 9(08).
   789         16  DC-GREG-DATE-MDCY-R REDEFINES
   790                              DC-GREG-DATE-MDCY.
   791             20  DC-MDCY-MONTH         PIC 99.
   792             20  DC-MDCY-DAY           PIC 99.
   793             20  DC-MDCY-CEN           PIC 99.
   794             20  DC-MDCY-YEAR          PIC 99.
   795    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   796        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   797    12  DC-EL310-DATE                  PIC X(21).
   798    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  18
* EL6501.cbl
   800*    COPY ELCATTR.
   801******************************************************************
   802*                                                                *
   803*                            ELCATTR.                            *
   804*                            VMOD=2.001                          *
   805*                                                                *
   806*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   807*                                                                *
   808*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   809*                                                                *
   810*                   POS 1   P=PROTECTED                          *
   811*                           U=UNPROTECTED                        *
   812*                           S=ASKIP                              *
   813*                   POS 2   A=ALPHA/NUMERIC                      *
   814*                           N=NUMERIC                            *
   815*                   POS 3   N=NORMAL                             *
   816*                           B=BRIGHT                             *
   817*                           D=DARK                               *
   818*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   819*                           OF=MODIFIED DATA TAG OFF             *
   820*                                                                *
   821*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   822******************************************************************
   823 01  ATTRIBUTE-LIST.
   824     12  AL-PABOF            PIC X       VALUE 'Y'.
   825     12  AL-PABON            PIC X       VALUE 'Z'.
   826     12  AL-PADOF            PIC X       VALUE '%'.
   827     12  AL-PADON            PIC X       VALUE '_'.
   828     12  AL-PANOF            PIC X       VALUE '-'.
   829     12  AL-PANON            PIC X       VALUE '/'.
   830     12  AL-SABOF            PIC X       VALUE '8'.
   831     12  AL-SABON            PIC X       VALUE '9'.
   832     12  AL-SADOF            PIC X       VALUE '@'.
   833     12  AL-SADON            PIC X       VALUE QUOTE.
   834     12  AL-SANOF            PIC X       VALUE '0'.
   835     12  AL-SANON            PIC X       VALUE '1'.
   836     12  AL-UABOF            PIC X       VALUE 'H'.
   837     12  AL-UABON            PIC X       VALUE 'I'.
   838     12  AL-UADOF            PIC X       VALUE '<'.
   839     12  AL-UADON            PIC X       VALUE '('.
   840     12  AL-UANOF            PIC X       VALUE ' '.
   841     12  AL-UANON            PIC X       VALUE 'A'.
   842     12  AL-UNBOF            PIC X       VALUE 'Q'.
   843     12  AL-UNBON            PIC X       VALUE 'R'.
   844     12  AL-UNDOF            PIC X       VALUE '*'.
   845     12  AL-UNDON            PIC X       VALUE ')'.
   846     12  AL-UNNOF            PIC X       VALUE '&'.
   847     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  19
* EL6501.cbl
   849*    COPY ELCEMIB.
   850******************************************************************
   851*                                                                *
   852*                                                                *
   853*                            ELCEMIB.                            *
   854*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   855*                            VMOD=2.005                          *
   856*                                                                *
   857*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   858*                                                                *
   859******************************************************************
   860 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   861     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   862     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   863     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   864     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   865     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   866     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   867     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   868     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   869     12  EMI-SWITCH1             PIC X        VALUE '1'.
   870         88  EMI-NO-ERRORS                    VALUE '1'.
   871         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   872         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   873     12  EMI-SWITCH2             PIC X        VALUE '1'.
   874         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   875     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   876         88  EMI-AREA1-EMPTY                  VALUE '1'.
   877         88  EMI-AREA1-FULL                   VALUE '2'.
   878     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   879         88  EMI-AREA2-EMPTY                  VALUE '1'.
   880         88  EMI-AREA2-FULL                   VALUE '2'.
   881     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   882         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   883         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   884         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   885         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   886         88  EMI-BYPASS-FATALS                VALUE 'X'.
   887     12  EMI-ERROR-LINES.
   888         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   889         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   890         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   891         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   892             20  EMI-ERR-CODES OCCURS 10 TIMES.
   893                 24  EMI-ERR-NUM         PIC X(4).
   894                 24  EMI-FILLER          PIC X.
   895                 24  EMI-SEV             PIC X.
   896                 24  FILLER              PIC X.
   897             20  FILLER                  PIC X(02).
   898     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   899         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   900             20  EMI-ERROR-NUMBER    PIC X(4).
   901             20  EMI-FILL            PIC X.
   902             20  EMI-SEVERITY        PIC X.
   903             20  FILLER              PIC X.
   904             20  EMI-ERROR-TEXT.
   905                 24  EMI-TEXT-VARIABLE   PIC X(10).
   906                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  20
* EL6501.cbl
   907     12  EMI-SEVERITY-SAVE           PIC X.
   908         88  EMI-NOTE                    VALUE 'N'.
   909         88  EMI-WARNING                 VALUE 'W'.
   910         88  EMI-FORCABLE                VALUE 'F'.
   911         88  EMI-FATAL                   VALUE 'X'.
   912     12  EMI-MESSAGE-FLAG            PIC X.
   913         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   914         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   915     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   916     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   917         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   918         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   919         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   920     12  FILLER                      PIC X(137)  VALUE SPACES.
   921     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   922     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   923     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   924     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  21
* EL6501.cbl
   926*    COPY ELCINTF.
   927******************************************************************
   928*                                                                *
   929*                                                                *
   930*                            ELCINTF.                            *
   931*                            VMOD=2.017                          *
   932*                                                                *
   933*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   934*                                                                *
   935*       LENGTH = 1024                                            *
   936*                                                                *
   937******************************************************************
   938 01  PROGRAM-INTERFACE-BLOCK.
   939     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   940     12  PI-CALLING-PROGRAM              PIC X(8).
   941     12  PI-SAVED-PROGRAM-1              PIC X(8).
   942     12  PI-SAVED-PROGRAM-2              PIC X(8).
   943     12  PI-SAVED-PROGRAM-3              PIC X(8).
   944     12  PI-SAVED-PROGRAM-4              PIC X(8).
   945     12  PI-SAVED-PROGRAM-5              PIC X(8).
   946     12  PI-SAVED-PROGRAM-6              PIC X(8).
   947     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   948     12  PI-COMPANY-ID                   PIC XXX.
   949     12  PI-COMPANY-CD                   PIC X.
   950
   951     12  PI-COMPANY-PASSWORD             PIC X(8).
   952
   953     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   954
   955     12  PI-CONTROL-IN-PROGRESS.
   956         16  PI-CARRIER                  PIC X.
   957         16  PI-GROUPING                 PIC X(6).
   958         16  PI-STATE                    PIC XX.
   959         16  PI-ACCOUNT                  PIC X(10).
   960         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   961                                         PIC X(10).
   962         16  PI-CLAIM-CERT-GRP.
   963             20  PI-CLAIM-NO             PIC X(7).
   964             20  PI-CERT-NO.
   965                 25  PI-CERT-PRIME       PIC X(10).
   966                 25  PI-CERT-SFX         PIC X.
   967             20  PI-CERT-EFF-DT          PIC XX.
   968         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   969             20  PI-PLAN-CODE            PIC X(2).
   970             20  PI-REVISION-NUMBER      PIC X(3).
   971             20  PI-PLAN-EFF-DT          PIC X(2).
   972             20  PI-PLAN-EXP-DT          PIC X(2).
   973             20  FILLER                  PIC X(11).
   974         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   975             20  PI-OE-REFERENCE-1.
   976                 25  PI-OE-REF-1-PRIME   PIC X(18).
   977                 25  PI-OE-REF-1-SUFF    PIC XX.
   978
   979     12  PI-SESSION-IN-PROGRESS          PIC X.
   980         88  CLAIM-SESSION                   VALUE '1'.
   981         88  CREDIT-SESSION                  VALUE '2'.
   982         88  WARRANTY-SESSION                VALUE '3'.
   983         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  22
* EL6501.cbl
   984         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   985
   986
   987*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   988
   989     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   990     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   991
   992     12  PI-CREDIT-USER                  PIC X.
   993         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   994         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   995
   996     12  PI-CLAIM-USER                   PIC X.
   997         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   998         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   999
  1000     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1001         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1002         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1003         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1004         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1005         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1006
  1007     12  PI-PROCESSOR-ID                 PIC X(4).
  1008
  1009     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1010
  1011     12  PI-MEMBER-CAPTION               PIC X(10).
  1012
  1013     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1014         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1015
  1016     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1017     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1018     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1019     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1020
  1021     12  PI-AH-OVERRIDE-L1               PIC X.
  1022     12  PI-AH-OVERRIDE-L2               PIC XX.
  1023     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1024     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1025
  1026     12  PI-NEW-SYSTEM                   PIC X(2).
  1027
  1028     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1029     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1030         88  PI-USES-PAID-TO                 VALUE '1'.
  1031     12  PI-CRDTCRD-SYSTEM.
  1032         16  PI-CRDTCRD-USER             PIC X.
  1033             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1034             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1035         16  PI-CC-MONTH-END-DT          PIC XX.
  1036     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1037
  1038     12  PI-OE-REFERENCE-2.
  1039         16  PI-OE-REF-2-PRIME           PIC X(10).
  1040         16  PI-OE-REF-2-SUFF            PIC X.
  1041
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  23
* EL6501.cbl
  1042     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1043
  1044     12  PI-LANGUAGE-TYPE                PIC X.
  1045             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1046             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1047             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1048
  1049     12  PI-POLICY-LINKAGE-IND           PIC X.
  1050         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1051         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1052                                                   LOW-VALUES.
  1053
  1054     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1055     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1056         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1057         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1058     12  FILLER                          PIC X(4).
  1059
  1060     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1061
  1062     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1063         PI-SYSTEM-LEVEL.
  1064
  1065         16  PI-ENTRY-CODES.
  1066             20  PI-ENTRY-CD-1           PIC X.
  1067             20  PI-ENTRY-CD-2           PIC X.
  1068
  1069         16  PI-RETURN-CODES.
  1070             20  PI-RETURN-CD-1          PIC X.
  1071             20  PI-RETURN-CD-2          PIC X.
  1072
  1073         16  PI-UPDATE-STATUS-SAVE.
  1074             20  PI-UPDATE-BY            PIC X(4).
  1075             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1076
  1077         16  PI-LOWER-CASE-LETTERS       PIC X.
  1078             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1079
  1080*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1081*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1082*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1083
  1084         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1085             88  ST-ACCNT-CNTL               VALUE ' '.
  1086             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1087             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1088             88  ACCNT-CNTL                  VALUE '3'.
  1089             88  CARR-ACCNT-CNTL             VALUE '4'.
  1090
  1091         16  PI-PROCESSOR-CAP-LIST.
  1092             20  PI-SYSTEM-CONTROLS.
  1093                24 PI-SYSTEM-DISPLAY     PIC X.
  1094                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1095                24 PI-SYSTEM-MODIFY      PIC X.
  1096                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1097             20  FILLER                  PIC XX.
  1098             20  PI-DISPLAY-CAP          PIC X.
  1099                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  24
* EL6501.cbl
  1100             20  PI-MODIFY-CAP           PIC X.
  1101                 88  MODIFY-CAP              VALUE 'Y'.
  1102             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1103                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1104             20  PI-FORCE-CAP            PIC X.
  1105                 88  FORCE-CAP               VALUE 'Y'.
  1106
  1107         16  PI-PROGRAM-CONTROLS.
  1108             20  PI-PGM-PRINT-OPT        PIC X.
  1109             20  PI-PGM-FORMAT-OPT       PIC X.
  1110             20  PI-PGM-PROCESS-OPT      PIC X.
  1111             20  PI-PGM-TOTALS-OPT       PIC X.
  1112
  1113         16  PI-HELP-INTERFACE.
  1114             20  PI-LAST-ERROR-NO        PIC X(4).
  1115             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1116
  1117         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1118             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1119
  1120         16  PI-CR-CONTROL-IN-PROGRESS.
  1121             20  PI-CR-CARRIER           PIC X.
  1122             20  PI-CR-GROUPING          PIC X(6).
  1123             20  PI-CR-STATE             PIC XX.
  1124             20  PI-CR-ACCOUNT           PIC X(10).
  1125             20  PI-CR-FIN-RESP          PIC X(10).
  1126             20  PI-CR-TYPE              PIC X.
  1127
  1128         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1129
  1130         16  PI-CR-MONTH-END-DT          PIC XX.
  1131
  1132         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1133             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1134             88  PI-ZERO-CARRIER             VALUE '1'.
  1135             88  PI-ZERO-GROUPING            VALUE '2'.
  1136             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1137
  1138         16  PI-CARRIER-SECURITY         PIC X.
  1139             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1140
  1141         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1142             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1143             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1144
  1145         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1146             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1147                                         INDEXED BY PI-ACCESS-NDX
  1148                                         PIC X.
  1149
  1150         16  PI-GA-BILLING-CONTROL       PIC X.
  1151             88  PI-GA-BILLING               VALUE '1'.
  1152
  1153         16  PI-MAIL-PROCESSING          PIC X.
  1154             88  PI-MAIL-YES                 VALUE 'Y'.
  1155
  1156         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1157
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  25
* EL6501.cbl
  1158         16  PI-AR-SYSTEM.
  1159             20  PI-AR-PROCESSING-CNTL   PIC X.
  1160                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1161             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1162             20  PI-AR-MONTH-END-DT      PIC XX.
  1163
  1164         16  PI-MP-SYSTEM.
  1165             20  PI-MORTGAGE-USER            PIC X.
  1166                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1167                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1168             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1169                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1170                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1171                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1172                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1173                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1174             20  PI-MP-MONTH-END-DT          PIC XX.
  1175             20  PI-MP-REFERENCE-NO.
  1176                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1177                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1178
  1179         16  PI-LABEL-CONTROL            PIC X(01).
  1180             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1181             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1182
  1183         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1184             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1185
  1186         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1187             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1188             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1189
  1190         16  FILLER                      PIC X(14).
  1191
  1192     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1193******************************************************************
  1194*    COPY ELC650PI.
  1195******************************************************************
  1196*
  1197*                            ELC650PI.
  1198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1199*                            VMOD=2.007
  1200*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1201*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
  1202* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1203*
  1204******************************************************************
  1205
  1206     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1207         16  PI-MAINT                   PIC X.
  1208         16  PI-PREV-ACCOUNT            PIC X(20).
  1209         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1210         16  PI-ACCT-KEY.
  1211             20  PI-ACCT-CCGSA-KEY.
  1212                 24  PI-ACCT-CO             PIC X.
  1213                 24  PI-ACCT-CARRIER        PIC X.
  1214                 24  PI-ACCT-GROUPING       PIC X(6).
  1215                 24  PI-ACCT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  26
* EL6501.cbl
  1216                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1217             20  PI-ACCT-EXP-DT           PIC XX.
  1218             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1219         16  PI-ACCT-ID                 PIC X(8).
  1220         16  PI-PLAN-KEY.
  1221             20  PI-PLAN-ACCT-KEY.
  1222                 24  PI-PLAN-COMPANY-CD PIC X.
  1223                 24  PI-PLAN-CARRIER    PIC X.
  1224                 24  PI-PLAN-GROUP      PIC X(6).
  1225                 24  PI-PLAN-STATE      PIC X(2).
  1226                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1227             20  PI-PLAN-BEN-TYPE       PIC X.
  1228             20  PI-PLAN-BEN            PIC XX.
  1229             20  PI-PLAN-REVISION       PIC X(3).
  1230         16  PI-WS-STATE                PIC XX.
  1231         16  PI-WS-CLASS                PIC XX.
  1232         16  PI-WS-DEV                  PIC X(3).
  1233         16  PI-WS-TYPE                 PIC X.
  1234         16  PI-WS-PLAN                 PIC XX.
  1235
  1236         16  PI-ERPNDB-ALT-KEY.
  1237             20  PI-PB-COMPANY-CD-A1    PIC X.
  1238             20  PI-PB-CARRIER          PIC X.
  1239             20  PI-PB-GROUPING         PIC X(6).
  1240             20  PI-PB-STATE            PIC XX.
  1241             20  PI-PB-ACCOUNT          PIC X(10).
  1242             20  PI-PB-CERT-EFF-DT      PIC XX.
  1243             20  PI-PB-CERT-NO          PIC X(10).
  1244             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1245             20  PI-PB-RECORD-TYPE      PIC X.
  1246
  1247         16  PI-DATE-RANGE-TABLE.
  1248             20  PI-TABLE-ENT OCCURS 32 TIMES
  1249                            INDEXED BY T-INDEX.
  1250                 24  PI-BIN-EFF-DT          PIC XX.
  1251                 24  PI-BIN-EXP-DT          PIC XX.
  1252                 24  PI-BIN-MAINT-DT        PIC XX.
  1253                 24  PI-BIN-LO-CERT         PIC XX.
  1254                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1255                 24  PI-BIN-HI-CERT         PIC XX.
  1256         16  PI-PAGE-NUMBER             PIC S9.
  1257             88  PI-FST-PAGE               VALUE +1.
  1258             88  PI-2ND-PAGE               VALUE +2.
  1259             88  PI-3RD-PAGE               VALUE +3.
  1260             88  PI-LST-PAGE               VALUE +4.
  1261         16  PI-TOTAL-LINES             PIC S99.
  1262         16  PI-LINE-SELECTED    PIC S9.
  1263***  Y2K PROJ 7744
  1264         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1265         16  BIN-EFFCHG-SAVE     PIC XX.
  1266         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1267***  Y2K PROJ 7744
  1268         16  BIN-EXPCHG-SAVE     PIC XX.
  1269         16  PI-RECORD-ADDED-SW  PIC X.
  1270             88  PI-RECORD-ADDED            VALUE '1'.
  1271             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1272         16  PI-ACCNAME          PIC X(30).
  1273         16  PI-COMM-POINTER     PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  27
* EL6501.cbl
  1274         16  PI-SV-MAINT         PIC X.
  1275         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1276         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1277         16  PI-UPDATE-SW        PIC X.
  1278             88  PI-CHANGES-MADE             VALUE '1'.
  1279         16  PI-NOTE-TYPE        PIC X.
  1280             88  PI-ACCT-NOTE                VALUE '1'.
  1281         16  PI-DMD-FILE-SW      PIC X.
  1282             88  END-OF-FILE                 VALUE 'E'.
  1283             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1284             88  FIRST-OCCURS                VALUE 'F'.
  1285         16  PI-DMD-OCCURS       PIC S999.
  1286         16  PI-DMD-SCREEN       PIC X.
  1287             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1288             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1289             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1290         16  PI-NAMEFLG          PIC X.
  1291         16  PI-EL650-DEL-SW     PIC X.
  1292         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1293         16  PI-DCC-PROD-CODE    PIC XXX.
  1294         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  28
* EL6501.cbl
  1296
  1297*    COPY ELCJPFX.
  1298******************************************************************
  1299*                                                                *
  1300*                                                                *
  1301*                            ELCJPFX.                            *
  1302*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1303*                            VMOD=2.002                          *
  1304*                                                                *
  1305*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1306*                                                                *
  1307*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1308*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1309*        ELCNTL - CONTROL FILE                                   *
  1310*        ELMSTR - CLAIM MASTERS                                  *
  1311*        ELTRLR - ACTIVITY TRAILERS                              *
  1312*        ELCHKQ - CHECK QUE                                      *
  1313******************************************************************
  1314 01  JOURNAL-RECORD.
  1315     12  JP-USER-ID                  PIC X(4).
  1316     12  JP-FILE-ID                  PIC X(8).
  1317     12  JP-PROGRAM-ID               PIC X(8).
  1318     12  JP-RECORD-TYPE              PIC X.
  1319         88 JP-ADD              VALUE 'A'.
  1320         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1321         88 JP-AFTER-CHANGE     VALUE 'C'.
  1322         88 JP-DELETE           VALUE 'D'.
  1323         88 JP-GENERIC-DELETE   VALUE 'G'.
  1324         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1325         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1326     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1327     12  JP-RECORD-AREA
  1328
  1329
  1330         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  29
* EL6501.cbl
  1332*    COPY ELCAID.
  1333******************************************************************
  1334*                                                                *
  1335*                            ELCAID.                             *
  1336*                            VMOD=2.001                          *
  1337*                                                                *
  1338*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1339*                                                                *
  1340*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1341*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1342******************************************************************
  1343
  1344 01  DFHAID.
  1345   02  DFHNULL   PIC  X  VALUE  ' '.
  1346   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1347   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1348   02  DFHPEN    PIC  X  VALUE  '='.
  1349   02  DFHOPID   PIC  X  VALUE  'W'.
  1350   02  DFHPA1    PIC  X  VALUE  '%'.
  1351   02  DFHPA2    PIC  X  VALUE  '>'.
  1352   02  DFHPA3    PIC  X  VALUE  ','.
  1353   02  DFHPF1    PIC  X  VALUE  '1'.
  1354   02  DFHPF2    PIC  X  VALUE  '2'.
  1355   02  DFHPF3    PIC  X  VALUE  '3'.
  1356   02  DFHPF4    PIC  X  VALUE  '4'.
  1357   02  DFHPF5    PIC  X  VALUE  '5'.
  1358   02  DFHPF6    PIC  X  VALUE  '6'.
  1359   02  DFHPF7    PIC  X  VALUE  '7'.
  1360   02  DFHPF8    PIC  X  VALUE  '8'.
  1361   02  DFHPF9    PIC  X  VALUE  '9'.
  1362   02  DFHPF10   PIC  X  VALUE  ':'.
  1363   02  DFHPF11   PIC  X  VALUE  '#'.
  1364   02  DFHPF12   PIC  X  VALUE  '@'.
  1365   02  DFHPF13   PIC  X  VALUE  'A'.
  1366   02  DFHPF14   PIC  X  VALUE  'B'.
  1367   02  DFHPF15   PIC  X  VALUE  'C'.
  1368   02  DFHPF16   PIC  X  VALUE  'D'.
  1369   02  DFHPF17   PIC  X  VALUE  'E'.
  1370   02  DFHPF18   PIC  X  VALUE  'F'.
  1371   02  DFHPF19   PIC  X  VALUE  'G'.
  1372   02  DFHPF20   PIC  X  VALUE  'H'.
  1373   02  DFHPF21   PIC  X  VALUE  'I'.
  1374*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1375   02  DFHPF22   PIC  X  VALUE  '['.
  1376   02  DFHPF23   PIC  X  VALUE  '.'.
  1377   02  DFHPF24   PIC  X  VALUE  '<'.
  1378   02  DFHMSRE   PIC  X  VALUE  'X'.
  1379   02  DFHSTRF   PIC  X  VALUE  'h'.
  1380   02  DFHTRIG   PIC  X  VALUE  '"'.
  1381 01  FILLER    REDEFINES DFHAID.
  1382     12  FILLER                  PIC X(8).
  1383     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  30
* EL6501.cbl
  1385*    COPY EL6501S.
  1386 01  EL6501AI.
  1387     05  FILLER            PIC  X(0012).
  1388*    -------------------------------
  1389     05  DATEL PIC S9(0004) COMP.
  1390     05  DATEF PIC  X(0001).
  1391     05  FILLER REDEFINES DATEF.
  1392         10  DATEA PIC  X(0001).
  1393     05  DATEI PIC  X(0008).
  1394*    -------------------------------
  1395     05  TIMEL PIC S9(0004) COMP.
  1396     05  TIMEF PIC  X(0001).
  1397     05  FILLER REDEFINES TIMEF.
  1398         10  TIMEA PIC  X(0001).
  1399     05  TIMEI PIC  X(0005).
  1400*    -------------------------------
  1401     05  CMPNYIDL PIC S9(0004) COMP.
  1402     05  CMPNYIDF PIC  X(0001).
  1403     05  FILLER REDEFINES CMPNYIDF.
  1404         10  CMPNYIDA PIC  X(0001).
  1405     05  CMPNYIDI PIC  X(0003).
  1406*    -------------------------------
  1407     05  USERIDL PIC S9(0004) COMP.
  1408     05  USERIDF PIC  X(0001).
  1409     05  FILLER REDEFINES USERIDF.
  1410         10  USERIDA PIC  X(0001).
  1411     05  USERIDI PIC  X(0004).
  1412*    -------------------------------
  1413     05  MAINTL PIC S9(0004) COMP.
  1414     05  MAINTF PIC  X(0001).
  1415     05  FILLER REDEFINES MAINTF.
  1416         10  MAINTA PIC  X(0001).
  1417     05  MAINTI PIC  X(0001).
  1418*    -------------------------------
  1419     05  CARRL PIC S9(0004) COMP.
  1420     05  CARRF PIC  X(0001).
  1421     05  FILLER REDEFINES CARRF.
  1422         10  CARRA PIC  X(0001).
  1423     05  CARRI PIC  X(0001).
  1424*    -------------------------------
  1425     05  GROUPINL PIC S9(0004) COMP.
  1426     05  GROUPINF PIC  X(0001).
  1427     05  FILLER REDEFINES GROUPINF.
  1428         10  GROUPINA PIC  X(0001).
  1429     05  GROUPINI PIC  X(0006).
  1430*    -------------------------------
  1431     05  STATEL PIC S9(0004) COMP.
  1432     05  STATEF PIC  X(0001).
  1433     05  FILLER REDEFINES STATEF.
  1434         10  STATEA PIC  X(0001).
  1435     05  STATEI PIC  X(0002).
  1436*    -------------------------------
  1437     05  ACCOUNTL PIC S9(0004) COMP.
  1438     05  ACCOUNTF PIC  X(0001).
  1439     05  FILLER REDEFINES ACCOUNTF.
  1440         10  ACCOUNTA PIC  X(0001).
  1441     05  ACCOUNTI PIC  X(0010).
  1442*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  31
* EL6501.cbl
  1443     05  EFFDTEL PIC S9(0004) COMP.
  1444     05  EFFDTEF PIC  X(0001).
  1445     05  FILLER REDEFINES EFFDTEF.
  1446         10  EFFDTEA PIC  X(0001).
  1447     05  EFFDTEI PIC  X(0008).
  1448*    -------------------------------
  1449     05  EXPDTEL PIC S9(0004) COMP.
  1450     05  EXPDTEF PIC  X(0001).
  1451     05  FILLER REDEFINES EXPDTEF.
  1452         10  EXPDTEA PIC  X(0001).
  1453     05  EXPDTEI PIC  X(0008).
  1454*    -------------------------------
  1455     05  MAINTBYL PIC S9(0004) COMP.
  1456     05  MAINTBYF PIC  X(0001).
  1457     05  FILLER REDEFINES MAINTBYF.
  1458         10  MAINTBYA PIC  X(0001).
  1459     05  MAINTBYI PIC  X(0004).
  1460*    -------------------------------
  1461     05  PCONTL PIC S9(0004) COMP.
  1462     05  PCONTF PIC  X(0001).
  1463     05  FILLER REDEFINES PCONTF.
  1464         10  PCONTA PIC  X(0001).
  1465     05  PCONTI PIC  X(0030).
  1466*    -------------------------------
  1467     05  CSRL PIC S9(0004) COMP.
  1468     05  CSRF PIC  X(0001).
  1469     05  FILLER REDEFINES CSRF.
  1470         10  CSRA PIC  X(0001).
  1471     05  CSRI PIC  X(0004).
  1472*    -------------------------------
  1473     05  PDSPLYL PIC S9(0004) COMP.
  1474     05  PDSPLYF PIC  X(0001).
  1475     05  FILLER REDEFINES PDSPLYF.
  1476         10  PDSPLYA PIC  X(0001).
  1477     05  PDSPLYI PIC  X(0006).
  1478*    -------------------------------
  1479     05  PEFFDTEL PIC S9(0004) COMP.
  1480     05  PEFFDTEF PIC  X(0001).
  1481     05  FILLER REDEFINES PEFFDTEF.
  1482         10  PEFFDTEA PIC  X(0001).
  1483     05  PEFFDTEI PIC  X(0008).
  1484*    -------------------------------
  1485     05  PEXPDTEL PIC S9(0004) COMP.
  1486     05  PEXPDTEF PIC  X(0001).
  1487     05  FILLER REDEFINES PEXPDTEF.
  1488         10  PEXPDTEA PIC  X(0001).
  1489     05  PEXPDTEI PIC  X(0008).
  1490*    -------------------------------
  1491     05  NAMEL PIC S9(0004) COMP.
  1492     05  NAMEF PIC  X(0001).
  1493     05  FILLER REDEFINES NAMEF.
  1494         10  NAMEA PIC  X(0001).
  1495     05  NAMEI PIC  X(0030).
  1496*    -------------------------------
  1497     05  TAXNOL PIC S9(0004) COMP.
  1498     05  TAXNOF PIC  X(0001).
  1499     05  FILLER REDEFINES TAXNOF.
  1500         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  32
* EL6501.cbl
  1501     05  TAXNOI PIC  X(0011).
  1502*    -------------------------------
  1503     05  STATUSL PIC S9(0004) COMP.
  1504     05  STATUSF PIC  X(0001).
  1505     05  FILLER REDEFINES STATUSF.
  1506         10  STATUSA PIC  X(0001).
  1507     05  STATUSI PIC  X(0001).
  1508*    -------------------------------
  1509     05  INCAREL PIC S9(0004) COMP.
  1510     05  INCAREF PIC  X(0001).
  1511     05  FILLER REDEFINES INCAREF.
  1512         10  INCAREA PIC  X(0001).
  1513     05  INCAREI PIC  X(0030).
  1514*    -------------------------------
  1515     05  PHONEL PIC S9(0004) COMP.
  1516     05  PHONEF PIC  X(0001).
  1517     05  FILLER REDEFINES PHONEF.
  1518         10  PHONEA PIC  X(0001).
  1519     05  PHONEI PIC  X(0012).
  1520*    -------------------------------
  1521     05  INDGRPL PIC S9(0004) COMP.
  1522     05  INDGRPF PIC  X(0001).
  1523     05  FILLER REDEFINES INDGRPF.
  1524         10  INDGRPA PIC  X(0001).
  1525     05  INDGRPI PIC  X(0001).
  1526*    -------------------------------
  1527     05  ADDR1L PIC S9(0004) COMP.
  1528     05  ADDR1F PIC  X(0001).
  1529     05  FILLER REDEFINES ADDR1F.
  1530         10  ADDR1A PIC  X(0001).
  1531     05  ADDR1I PIC  X(0030).
  1532*    -------------------------------
  1533     05  CONTRL PIC S9(0004) COMP.
  1534     05  CONTRF PIC  X(0001).
  1535     05  FILLER REDEFINES CONTRF.
  1536         10  CONTRA PIC  X(0001).
  1537     05  CONTRI PIC  X(0008).
  1538*    -------------------------------
  1539     05  TYPEL PIC S9(0004) COMP.
  1540     05  TYPEF PIC  X(0001).
  1541     05  FILLER REDEFINES TYPEF.
  1542         10  TYPEA PIC  X(0001).
  1543     05  TYPEI PIC  99.
  1544*    -------------------------------
  1545     05  ACITYL PIC S9(0004) COMP.
  1546     05  ACITYF PIC  X(0001).
  1547     05  FILLER REDEFINES ACITYF.
  1548         10  ACITYA PIC  X(0001).
  1549     05  ACITYI PIC  X(0028).
  1550*    -------------------------------
  1551     05  ASTATEL PIC S9(0004) COMP.
  1552     05  ASTATEF PIC  X(0001).
  1553     05  FILLER REDEFINES ASTATEF.
  1554         10  ASTATEA PIC  X(0001).
  1555     05  ASTATEI PIC  X(0002).
  1556*    -------------------------------
  1557     05  PRODATEL PIC S9(0004) COMP.
  1558     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  33
* EL6501.cbl
  1559     05  FILLER REDEFINES PRODATEF.
  1560         10  PRODATEA PIC  X(0001).
  1561     05  PRODATEI PIC  X(0008).
  1562*    -------------------------------
  1563     05  STDBENL PIC S9(0004) COMP.
  1564     05  STDBENF PIC  X(0001).
  1565     05  FILLER REDEFINES STDBENF.
  1566         10  STDBENA PIC  X(0001).
  1567     05  STDBENI PIC  X(0002).
  1568*    -------------------------------
  1569     05  ZIPL PIC S9(0004) COMP.
  1570     05  ZIPF PIC  X(0001).
  1571     05  FILLER REDEFINES ZIPF.
  1572         10  ZIPA PIC  X(0001).
  1573     05  ZIPI PIC  X(0010).
  1574*    -------------------------------
  1575     05  CTPLABLL PIC S9(0004) COMP.
  1576     05  CTPLABLF PIC  X(0001).
  1577     05  FILLER REDEFINES CTPLABLF.
  1578         10  CTPLABLA PIC  X(0001).
  1579     05  CTPLABLI PIC  X(0010).
  1580*    -------------------------------
  1581     05  CLPTOLPL PIC S9(0004) COMP.
  1582     05  CLPTOLPF PIC  X(0001).
  1583     05  FILLER REDEFINES CLPTOLPF.
  1584         10  CLPTOLPA PIC  X(0001).
  1585     05  CLPTOLPI PIC  S9(02)V9999.
  1586*    -------------------------------
  1587     05  RETROCDL PIC S9(0004) COMP.
  1588     05  RETROCDF PIC  X(0001).
  1589     05  FILLER REDEFINES RETROCDF.
  1590         10  RETROCDA PIC  X(0001).
  1591     05  RETROCDI PIC  X(0003).
  1592*    -------------------------------
  1593     05  BILLCDL PIC S9(0004) COMP.
  1594     05  BILLCDF PIC  X(0001).
  1595     05  FILLER REDEFINES BILLCDF.
  1596         10  BILLCDA PIC  X(0001).
  1597     05  BILLCDI PIC  X(0003).
  1598*    -------------------------------
  1599     05  LCLABLL PIC S9(0004) COMP.
  1600     05  LCLABLF PIC  X(0001).
  1601     05  FILLER REDEFINES LCLABLF.
  1602         10  LCLABLA PIC  X(0001).
  1603     05  LCLABLI PIC  X(0011).
  1604*    -------------------------------
  1605     05  LCOMML PIC S9(0004) COMP.
  1606     05  LCOMMF PIC  X(0001).
  1607     05  FILLER REDEFINES LCOMMF.
  1608         10  LCOMMA PIC  X(0001).
  1609     05  LCOMMI PIC  S9(6)V9(2).
  1610*    -------------------------------
  1611     05  MAXFEEHL PIC S9(0004) COMP.
  1612     05  MAXFEEHF PIC  X(0001).
  1613     05  FILLER REDEFINES MAXFEEHF.
  1614         10  MAXFEEHA PIC  X(0001).
  1615     05  MAXFEEHI PIC  X(0013).
  1616*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  34
* EL6501.cbl
  1617     05  MAXMFEEL PIC S9(0004) COMP.
  1618     05  MAXMFEEF PIC  X(0001).
  1619     05  FILLER REDEFINES MAXMFEEF.
  1620         10  MAXMFEEA PIC  X(0001).
  1621     05  MAXMFEEI PIC  X(0005).
  1622*    -------------------------------
  1623     05  CLPSTHL PIC S9(0004) COMP.
  1624     05  CLPSTHF PIC  X(0001).
  1625     05  FILLER REDEFINES CLPSTHF.
  1626         10  CLPSTHA PIC  X(0001).
  1627     05  CLPSTHI PIC  X(0010).
  1628*    -------------------------------
  1629     05  CLPSTL PIC S9(0004) COMP.
  1630     05  CLPSTF PIC  X(0001).
  1631     05  FILLER REDEFINES CLPSTF.
  1632         10  CLPSTA PIC  X(0001).
  1633     05  CLPSTI PIC  X(0002).
  1634*    -------------------------------
  1635     05  PRODCDHL PIC S9(0004) COMP.
  1636     05  PRODCDHF PIC  X(0001).
  1637     05  FILLER REDEFINES PRODCDHF.
  1638         10  PRODCDHA PIC  X(0001).
  1639     05  PRODCDHI PIC  X(0012).
  1640*    -------------------------------
  1641     05  PRODCDL PIC S9(0004) COMP.
  1642     05  PRODCDF PIC  X(0001).
  1643     05  FILLER REDEFINES PRODCDF.
  1644         10  PRODCDA PIC  X(0001).
  1645     05  PRODCDI PIC  X(0003).
  1646*    -------------------------------
  1647     05  REMITL PIC S9(0004) COMP.
  1648     05  REMITF PIC  X(0001).
  1649     05  FILLER REDEFINES REMITF.
  1650         10  REMITA PIC  X(0001).
  1651     05  REMITI PIC  99.
  1652*    -------------------------------
  1653     05  COMMCALL PIC S9(0004) COMP.
  1654     05  COMMCALF PIC  X(0001).
  1655     05  FILLER REDEFINES COMMCALF.
  1656         10  COMMCALA PIC  X(0001).
  1657     05  COMMCALI PIC  X(0001).
  1658*    -------------------------------
  1659     05  REINTABL PIC S9(0004) COMP.
  1660     05  REINTABF PIC  X(0001).
  1661     05  FILLER REDEFINES REINTABF.
  1662         10  REINTABA PIC  X(0001).
  1663     05  REINTABI PIC  X(0003).
  1664*    -------------------------------
  1665     05  REINCALL PIC S9(0004) COMP.
  1666     05  REINCALF PIC  X(0001).
  1667     05  FILLER REDEFINES REINCALF.
  1668         10  REINCALA PIC  X(0001).
  1669     05  REINCALI PIC  X(0001).
  1670*    -------------------------------
  1671     05  AHHEADL PIC S9(0004) COMP.
  1672     05  AHHEADF PIC  X(0001).
  1673     05  FILLER REDEFINES AHHEADF.
  1674         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  35
* EL6501.cbl
  1675     05  AHHEADI PIC  X(0006).
  1676*    -------------------------------
  1677     05  AGNT1L PIC S9(0004) COMP.
  1678     05  AGNT1F PIC  X(0001).
  1679     05  FILLER REDEFINES AGNT1F.
  1680         10  AGNT1A PIC  X(0001).
  1681     05  AGNT1I PIC  X(0010).
  1682*    -------------------------------
  1683     05  TYPE1L PIC S9(0004) COMP.
  1684     05  TYPE1F PIC  X(0001).
  1685     05  FILLER REDEFINES TYPE1F.
  1686         10  TYPE1A PIC  X(0001).
  1687     05  TYPE1I PIC  X(0001).
  1688*    -------------------------------
  1689     05  SINRT1L PIC S9(0004) COMP.
  1690     05  SINRT1F PIC  X(0001).
  1691     05  FILLER REDEFINES SINRT1F.
  1692         10  SINRT1A PIC  X(0001).
  1693     05  SINRT1I PIC  X(0006).
  1694*    -------------------------------
  1695     05  JNTRT1L PIC S9(0004) COMP.
  1696     05  JNTRT1F PIC  X(0001).
  1697     05  FILLER REDEFINES JNTRT1F.
  1698         10  JNTRT1A PIC  X(0001).
  1699     05  JNTRT1I PIC  X(0006).
  1700*    -------------------------------
  1701     05  AHRT1L PIC S9(0004) COMP.
  1702     05  AHRT1F PIC  X(0001).
  1703     05  FILLER REDEFINES AHRT1F.
  1704         10  AHRT1A PIC  X(0001).
  1705     05  AHRT1I PIC  X(0006).
  1706*    -------------------------------
  1707     05  RECAL1L PIC S9(0004) COMP.
  1708     05  RECAL1F PIC  X(0001).
  1709     05  FILLER REDEFINES RECAL1F.
  1710         10  RECAL1A PIC  X(0001).
  1711     05  RECAL1I PIC  X(0001).
  1712*    -------------------------------
  1713     05  COMM1L PIC S9(0004) COMP.
  1714     05  COMM1F PIC  X(0001).
  1715     05  FILLER REDEFINES COMM1F.
  1716         10  COMM1A PIC  X(0001).
  1717     05  COMM1I PIC  X(0001).
  1718*    -------------------------------
  1719     05  CHGBK1L PIC S9(0004) COMP.
  1720     05  CHGBK1F PIC  X(0001).
  1721     05  FILLER REDEFINES CHGBK1F.
  1722         10  CHGBK1A PIC  X(0001).
  1723     05  CHGBK1I PIC  X(0002).
  1724*    -------------------------------
  1725     05  GLCDE1L PIC S9(0004) COMP.
  1726     05  GLCDE1F PIC  X(0001).
  1727     05  FILLER REDEFINES GLCDE1F.
  1728         10  GLCDE1A PIC  X(0001).
  1729     05  GLCDE1I PIC  X(0001).
  1730*    -------------------------------
  1731     05  AGNT2L PIC S9(0004) COMP.
  1732     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  36
* EL6501.cbl
  1733     05  FILLER REDEFINES AGNT2F.
  1734         10  AGNT2A PIC  X(0001).
  1735     05  AGNT2I PIC  X(0010).
  1736*    -------------------------------
  1737     05  TYPE2L PIC S9(0004) COMP.
  1738     05  TYPE2F PIC  X(0001).
  1739     05  FILLER REDEFINES TYPE2F.
  1740         10  TYPE2A PIC  X(0001).
  1741     05  TYPE2I PIC  X(0001).
  1742*    -------------------------------
  1743     05  SINRT2L PIC S9(0004) COMP.
  1744     05  SINRT2F PIC  X(0001).
  1745     05  FILLER REDEFINES SINRT2F.
  1746         10  SINRT2A PIC  X(0001).
  1747     05  SINRT2I PIC  X(0006).
  1748*    -------------------------------
  1749     05  JNTRT2L PIC S9(0004) COMP.
  1750     05  JNTRT2F PIC  X(0001).
  1751     05  FILLER REDEFINES JNTRT2F.
  1752         10  JNTRT2A PIC  X(0001).
  1753     05  JNTRT2I PIC  X(0006).
  1754*    -------------------------------
  1755     05  AHRT2L PIC S9(0004) COMP.
  1756     05  AHRT2F PIC  X(0001).
  1757     05  FILLER REDEFINES AHRT2F.
  1758         10  AHRT2A PIC  X(0001).
  1759     05  AHRT2I PIC  X(0006).
  1760*    -------------------------------
  1761     05  RECAL2L PIC S9(0004) COMP.
  1762     05  RECAL2F PIC  X(0001).
  1763     05  FILLER REDEFINES RECAL2F.
  1764         10  RECAL2A PIC  X(0001).
  1765     05  RECAL2I PIC  X(0001).
  1766*    -------------------------------
  1767     05  COMM2L PIC S9(0004) COMP.
  1768     05  COMM2F PIC  X(0001).
  1769     05  FILLER REDEFINES COMM2F.
  1770         10  COMM2A PIC  X(0001).
  1771     05  COMM2I PIC  X(0001).
  1772*    -------------------------------
  1773     05  CHGBK2L PIC S9(0004) COMP.
  1774     05  CHGBK2F PIC  X(0001).
  1775     05  FILLER REDEFINES CHGBK2F.
  1776         10  CHGBK2A PIC  X(0001).
  1777     05  CHGBK2I PIC  X(0002).
  1778*    -------------------------------
  1779     05  GLCDE2L PIC S9(0004) COMP.
  1780     05  GLCDE2F PIC  X(0001).
  1781     05  FILLER REDEFINES GLCDE2F.
  1782         10  GLCDE2A PIC  X(0001).
  1783     05  GLCDE2I PIC  X(0001).
  1784*    -------------------------------
  1785     05  AGNT3L PIC S9(0004) COMP.
  1786     05  AGNT3F PIC  X(0001).
  1787     05  FILLER REDEFINES AGNT3F.
  1788         10  AGNT3A PIC  X(0001).
  1789     05  AGNT3I PIC  X(0010).
  1790*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  37
* EL6501.cbl
  1791     05  TYPE3L PIC S9(0004) COMP.
  1792     05  TYPE3F PIC  X(0001).
  1793     05  FILLER REDEFINES TYPE3F.
  1794         10  TYPE3A PIC  X(0001).
  1795     05  TYPE3I PIC  X(0001).
  1796*    -------------------------------
  1797     05  SINRT3L PIC S9(0004) COMP.
  1798     05  SINRT3F PIC  X(0001).
  1799     05  FILLER REDEFINES SINRT3F.
  1800         10  SINRT3A PIC  X(0001).
  1801     05  SINRT3I PIC  X(0006).
  1802*    -------------------------------
  1803     05  JNTRT3L PIC S9(0004) COMP.
  1804     05  JNTRT3F PIC  X(0001).
  1805     05  FILLER REDEFINES JNTRT3F.
  1806         10  JNTRT3A PIC  X(0001).
  1807     05  JNTRT3I PIC  X(0006).
  1808*    -------------------------------
  1809     05  AHRT3L PIC S9(0004) COMP.
  1810     05  AHRT3F PIC  X(0001).
  1811     05  FILLER REDEFINES AHRT3F.
  1812         10  AHRT3A PIC  X(0001).
  1813     05  AHRT3I PIC  X(0006).
  1814*    -------------------------------
  1815     05  RECAL3L PIC S9(0004) COMP.
  1816     05  RECAL3F PIC  X(0001).
  1817     05  FILLER REDEFINES RECAL3F.
  1818         10  RECAL3A PIC  X(0001).
  1819     05  RECAL3I PIC  X(0001).
  1820*    -------------------------------
  1821     05  COMM3L PIC S9(0004) COMP.
  1822     05  COMM3F PIC  X(0001).
  1823     05  FILLER REDEFINES COMM3F.
  1824         10  COMM3A PIC  X(0001).
  1825     05  COMM3I PIC  X(0001).
  1826*    -------------------------------
  1827     05  CHGBK3L PIC S9(0004) COMP.
  1828     05  CHGBK3F PIC  X(0001).
  1829     05  FILLER REDEFINES CHGBK3F.
  1830         10  CHGBK3A PIC  X(0001).
  1831     05  CHGBK3I PIC  X(0002).
  1832*    -------------------------------
  1833     05  GLCDE3L PIC S9(0004) COMP.
  1834     05  GLCDE3F PIC  X(0001).
  1835     05  FILLER REDEFINES GLCDE3F.
  1836         10  GLCDE3A PIC  X(0001).
  1837     05  GLCDE3I PIC  X(0001).
  1838*    -------------------------------
  1839     05  AGNT4L PIC S9(0004) COMP.
  1840     05  AGNT4F PIC  X(0001).
  1841     05  FILLER REDEFINES AGNT4F.
  1842         10  AGNT4A PIC  X(0001).
  1843     05  AGNT4I PIC  X(0010).
  1844*    -------------------------------
  1845     05  TYPE4L PIC S9(0004) COMP.
  1846     05  TYPE4F PIC  X(0001).
  1847     05  FILLER REDEFINES TYPE4F.
  1848         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  38
* EL6501.cbl
  1849     05  TYPE4I PIC  X(0001).
  1850*    -------------------------------
  1851     05  SINRT4L PIC S9(0004) COMP.
  1852     05  SINRT4F PIC  X(0001).
  1853     05  FILLER REDEFINES SINRT4F.
  1854         10  SINRT4A PIC  X(0001).
  1855     05  SINRT4I PIC  X(0006).
  1856*    -------------------------------
  1857     05  JNTRT4L PIC S9(0004) COMP.
  1858     05  JNTRT4F PIC  X(0001).
  1859     05  FILLER REDEFINES JNTRT4F.
  1860         10  JNTRT4A PIC  X(0001).
  1861     05  JNTRT4I PIC  X(0006).
  1862*    -------------------------------
  1863     05  AHRT4L PIC S9(0004) COMP.
  1864     05  AHRT4F PIC  X(0001).
  1865     05  FILLER REDEFINES AHRT4F.
  1866         10  AHRT4A PIC  X(0001).
  1867     05  AHRT4I PIC  X(0006).
  1868*    -------------------------------
  1869     05  RECAL4L PIC S9(0004) COMP.
  1870     05  RECAL4F PIC  X(0001).
  1871     05  FILLER REDEFINES RECAL4F.
  1872         10  RECAL4A PIC  X(0001).
  1873     05  RECAL4I PIC  X(0001).
  1874*    -------------------------------
  1875     05  COMM4L PIC S9(0004) COMP.
  1876     05  COMM4F PIC  X(0001).
  1877     05  FILLER REDEFINES COMM4F.
  1878         10  COMM4A PIC  X(0001).
  1879     05  COMM4I PIC  X(0001).
  1880*    -------------------------------
  1881     05  CHGBK4L PIC S9(0004) COMP.
  1882     05  CHGBK4F PIC  X(0001).
  1883     05  FILLER REDEFINES CHGBK4F.
  1884         10  CHGBK4A PIC  X(0001).
  1885     05  CHGBK4I PIC  X(0002).
  1886*    -------------------------------
  1887     05  GLCDE4L PIC S9(0004) COMP.
  1888     05  GLCDE4F PIC  X(0001).
  1889     05  FILLER REDEFINES GLCDE4F.
  1890         10  GLCDE4A PIC  X(0001).
  1891     05  GLCDE4I PIC  X(0001).
  1892*    -------------------------------
  1893     05  AGNT5L PIC S9(0004) COMP.
  1894     05  AGNT5F PIC  X(0001).
  1895     05  FILLER REDEFINES AGNT5F.
  1896         10  AGNT5A PIC  X(0001).
  1897     05  AGNT5I PIC  X(0010).
  1898*    -------------------------------
  1899     05  TYPE5L PIC S9(0004) COMP.
  1900     05  TYPE5F PIC  X(0001).
  1901     05  FILLER REDEFINES TYPE5F.
  1902         10  TYPE5A PIC  X(0001).
  1903     05  TYPE5I PIC  X(0001).
  1904*    -------------------------------
  1905     05  SINRT5L PIC S9(0004) COMP.
  1906     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  39
* EL6501.cbl
  1907     05  FILLER REDEFINES SINRT5F.
  1908         10  SINRT5A PIC  X(0001).
  1909     05  SINRT5I PIC  X(0006).
  1910*    -------------------------------
  1911     05  JNTRT5L PIC S9(0004) COMP.
  1912     05  JNTRT5F PIC  X(0001).
  1913     05  FILLER REDEFINES JNTRT5F.
  1914         10  JNTRT5A PIC  X(0001).
  1915     05  JNTRT5I PIC  X(0006).
  1916*    -------------------------------
  1917     05  AHRT5L PIC S9(0004) COMP.
  1918     05  AHRT5F PIC  X(0001).
  1919     05  FILLER REDEFINES AHRT5F.
  1920         10  AHRT5A PIC  X(0001).
  1921     05  AHRT5I PIC  X(0006).
  1922*    -------------------------------
  1923     05  RECAL5L PIC S9(0004) COMP.
  1924     05  RECAL5F PIC  X(0001).
  1925     05  FILLER REDEFINES RECAL5F.
  1926         10  RECAL5A PIC  X(0001).
  1927     05  RECAL5I PIC  X(0001).
  1928*    -------------------------------
  1929     05  COMM5L PIC S9(0004) COMP.
  1930     05  COMM5F PIC  X(0001).
  1931     05  FILLER REDEFINES COMM5F.
  1932         10  COMM5A PIC  X(0001).
  1933     05  COMM5I PIC  X(0001).
  1934*    -------------------------------
  1935     05  CHGBK5L PIC S9(0004) COMP.
  1936     05  CHGBK5F PIC  X(0001).
  1937     05  FILLER REDEFINES CHGBK5F.
  1938         10  CHGBK5A PIC  X(0001).
  1939     05  CHGBK5I PIC  X(0002).
  1940*    -------------------------------
  1941     05  GLCDE5L PIC S9(0004) COMP.
  1942     05  GLCDE5F PIC  X(0001).
  1943     05  FILLER REDEFINES GLCDE5F.
  1944         10  GLCDE5A PIC  X(0001).
  1945     05  GLCDE5I PIC  X(0001).
  1946*    -------------------------------
  1947     05  AGNT6L PIC S9(0004) COMP.
  1948     05  AGNT6F PIC  X(0001).
  1949     05  FILLER REDEFINES AGNT6F.
  1950         10  AGNT6A PIC  X(0001).
  1951     05  AGNT6I PIC  X(0010).
  1952*    -------------------------------
  1953     05  TYPE6L PIC S9(0004) COMP.
  1954     05  TYPE6F PIC  X(0001).
  1955     05  FILLER REDEFINES TYPE6F.
  1956         10  TYPE6A PIC  X(0001).
  1957     05  TYPE6I PIC  X(0001).
  1958*    -------------------------------
  1959     05  SINRT6L PIC S9(0004) COMP.
  1960     05  SINRT6F PIC  X(0001).
  1961     05  FILLER REDEFINES SINRT6F.
  1962         10  SINRT6A PIC  X(0001).
  1963     05  SINRT6I PIC  X(0006).
  1964*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  40
* EL6501.cbl
  1965     05  JNTRT6L PIC S9(0004) COMP.
  1966     05  JNTRT6F PIC  X(0001).
  1967     05  FILLER REDEFINES JNTRT6F.
  1968         10  JNTRT6A PIC  X(0001).
  1969     05  JNTRT6I PIC  X(0006).
  1970*    -------------------------------
  1971     05  AHRT6L PIC S9(0004) COMP.
  1972     05  AHRT6F PIC  X(0001).
  1973     05  FILLER REDEFINES AHRT6F.
  1974         10  AHRT6A PIC  X(0001).
  1975     05  AHRT6I PIC  X(0006).
  1976*    -------------------------------
  1977     05  RECAL6L PIC S9(0004) COMP.
  1978     05  RECAL6F PIC  X(0001).
  1979     05  FILLER REDEFINES RECAL6F.
  1980         10  RECAL6A PIC  X(0001).
  1981     05  RECAL6I PIC  X(0001).
  1982*    -------------------------------
  1983     05  COMM6L PIC S9(0004) COMP.
  1984     05  COMM6F PIC  X(0001).
  1985     05  FILLER REDEFINES COMM6F.
  1986         10  COMM6A PIC  X(0001).
  1987     05  COMM6I PIC  X(0001).
  1988*    -------------------------------
  1989     05  CHGBK6L PIC S9(0004) COMP.
  1990     05  CHGBK6F PIC  X(0001).
  1991     05  FILLER REDEFINES CHGBK6F.
  1992         10  CHGBK6A PIC  X(0001).
  1993     05  CHGBK6I PIC  X(0002).
  1994*    -------------------------------
  1995     05  GLCDE6L PIC S9(0004) COMP.
  1996     05  GLCDE6F PIC  X(0001).
  1997     05  FILLER REDEFINES GLCDE6F.
  1998         10  GLCDE6A PIC  X(0001).
  1999     05  GLCDE6I PIC  X(0001).
  2000*    -------------------------------
  2001     05  AGNT7L PIC S9(0004) COMP.
  2002     05  AGNT7F PIC  X(0001).
  2003     05  FILLER REDEFINES AGNT7F.
  2004         10  AGNT7A PIC  X(0001).
  2005     05  AGNT7I PIC  X(0010).
  2006*    -------------------------------
  2007     05  TYPE7L PIC S9(0004) COMP.
  2008     05  TYPE7F PIC  X(0001).
  2009     05  FILLER REDEFINES TYPE7F.
  2010         10  TYPE7A PIC  X(0001).
  2011     05  TYPE7I PIC  X(0001).
  2012*    -------------------------------
  2013     05  SINRT7L PIC S9(0004) COMP.
  2014     05  SINRT7F PIC  X(0001).
  2015     05  FILLER REDEFINES SINRT7F.
  2016         10  SINRT7A PIC  X(0001).
  2017     05  SINRT7I PIC  X(0006).
  2018*    -------------------------------
  2019     05  JNTRT7L PIC S9(0004) COMP.
  2020     05  JNTRT7F PIC  X(0001).
  2021     05  FILLER REDEFINES JNTRT7F.
  2022         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  41
* EL6501.cbl
  2023     05  JNTRT7I PIC  X(0006).
  2024*    -------------------------------
  2025     05  AHRT7L PIC S9(0004) COMP.
  2026     05  AHRT7F PIC  X(0001).
  2027     05  FILLER REDEFINES AHRT7F.
  2028         10  AHRT7A PIC  X(0001).
  2029     05  AHRT7I PIC  X(0006).
  2030*    -------------------------------
  2031     05  RECAL7L PIC S9(0004) COMP.
  2032     05  RECAL7F PIC  X(0001).
  2033     05  FILLER REDEFINES RECAL7F.
  2034         10  RECAL7A PIC  X(0001).
  2035     05  RECAL7I PIC  X(0001).
  2036*    -------------------------------
  2037     05  COMM7L PIC S9(0004) COMP.
  2038     05  COMM7F PIC  X(0001).
  2039     05  FILLER REDEFINES COMM7F.
  2040         10  COMM7A PIC  X(0001).
  2041     05  COMM7I PIC  X(0001).
  2042*    -------------------------------
  2043     05  CHGBK7L PIC S9(0004) COMP.
  2044     05  CHGBK7F PIC  X(0001).
  2045     05  FILLER REDEFINES CHGBK7F.
  2046         10  CHGBK7A PIC  X(0001).
  2047     05  CHGBK7I PIC  X(0002).
  2048*    -------------------------------
  2049     05  GLCDE7L PIC S9(0004) COMP.
  2050     05  GLCDE7F PIC  X(0001).
  2051     05  FILLER REDEFINES GLCDE7F.
  2052         10  GLCDE7A PIC  X(0001).
  2053     05  GLCDE7I PIC  X(0001).
  2054*    -------------------------------
  2055     05  AGNT8L PIC S9(0004) COMP.
  2056     05  AGNT8F PIC  X(0001).
  2057     05  FILLER REDEFINES AGNT8F.
  2058         10  AGNT8A PIC  X(0001).
  2059     05  AGNT8I PIC  X(0010).
  2060*    -------------------------------
  2061     05  TYPE8L PIC S9(0004) COMP.
  2062     05  TYPE8F PIC  X(0001).
  2063     05  FILLER REDEFINES TYPE8F.
  2064         10  TYPE8A PIC  X(0001).
  2065     05  TYPE8I PIC  X(0001).
  2066*    -------------------------------
  2067     05  SINRT8L PIC S9(0004) COMP.
  2068     05  SINRT8F PIC  X(0001).
  2069     05  FILLER REDEFINES SINRT8F.
  2070         10  SINRT8A PIC  X(0001).
  2071     05  SINRT8I PIC  X(0006).
  2072*    -------------------------------
  2073     05  JNTRT8L PIC S9(0004) COMP.
  2074     05  JNTRT8F PIC  X(0001).
  2075     05  FILLER REDEFINES JNTRT8F.
  2076         10  JNTRT8A PIC  X(0001).
  2077     05  JNTRT8I PIC  X(0006).
  2078*    -------------------------------
  2079     05  AHRT8L PIC S9(0004) COMP.
  2080     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  42
* EL6501.cbl
  2081     05  FILLER REDEFINES AHRT8F.
  2082         10  AHRT8A PIC  X(0001).
  2083     05  AHRT8I PIC  X(0006).
  2084*    -------------------------------
  2085     05  RECAL8L PIC S9(0004) COMP.
  2086     05  RECAL8F PIC  X(0001).
  2087     05  FILLER REDEFINES RECAL8F.
  2088         10  RECAL8A PIC  X(0001).
  2089     05  RECAL8I PIC  X(0001).
  2090*    -------------------------------
  2091     05  COMM8L PIC S9(0004) COMP.
  2092     05  COMM8F PIC  X(0001).
  2093     05  FILLER REDEFINES COMM8F.
  2094         10  COMM8A PIC  X(0001).
  2095     05  COMM8I PIC  X(0001).
  2096*    -------------------------------
  2097     05  CHGBK8L PIC S9(0004) COMP.
  2098     05  CHGBK8F PIC  X(0001).
  2099     05  FILLER REDEFINES CHGBK8F.
  2100         10  CHGBK8A PIC  X(0001).
  2101     05  CHGBK8I PIC  X(0002).
  2102*    -------------------------------
  2103     05  GLCDE8L PIC S9(0004) COMP.
  2104     05  GLCDE8F PIC  X(0001).
  2105     05  FILLER REDEFINES GLCDE8F.
  2106         10  GLCDE8A PIC  X(0001).
  2107     05  GLCDE8I PIC  X(0001).
  2108*    -------------------------------
  2109     05  AGNT9L PIC S9(0004) COMP.
  2110     05  AGNT9F PIC  X(0001).
  2111     05  FILLER REDEFINES AGNT9F.
  2112         10  AGNT9A PIC  X(0001).
  2113     05  AGNT9I PIC  X(0010).
  2114*    -------------------------------
  2115     05  TYPE9L PIC S9(0004) COMP.
  2116     05  TYPE9F PIC  X(0001).
  2117     05  FILLER REDEFINES TYPE9F.
  2118         10  TYPE9A PIC  X(0001).
  2119     05  TYPE9I PIC  X(0001).
  2120*    -------------------------------
  2121     05  SINRT9L PIC S9(0004) COMP.
  2122     05  SINRT9F PIC  X(0001).
  2123     05  FILLER REDEFINES SINRT9F.
  2124         10  SINRT9A PIC  X(0001).
  2125     05  SINRT9I PIC  X(0006).
  2126*    -------------------------------
  2127     05  JNTRT9L PIC S9(0004) COMP.
  2128     05  JNTRT9F PIC  X(0001).
  2129     05  FILLER REDEFINES JNTRT9F.
  2130         10  JNTRT9A PIC  X(0001).
  2131     05  JNTRT9I PIC  X(0006).
  2132*    -------------------------------
  2133     05  AHRT9L PIC S9(0004) COMP.
  2134     05  AHRT9F PIC  X(0001).
  2135     05  FILLER REDEFINES AHRT9F.
  2136         10  AHRT9A PIC  X(0001).
  2137     05  AHRT9I PIC  X(0006).
  2138*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  43
* EL6501.cbl
  2139     05  RECAL9L PIC S9(0004) COMP.
  2140     05  RECAL9F PIC  X(0001).
  2141     05  FILLER REDEFINES RECAL9F.
  2142         10  RECAL9A PIC  X(0001).
  2143     05  RECAL9I PIC  X(0001).
  2144*    -------------------------------
  2145     05  COMM9L PIC S9(0004) COMP.
  2146     05  COMM9F PIC  X(0001).
  2147     05  FILLER REDEFINES COMM9F.
  2148         10  COMM9A PIC  X(0001).
  2149     05  COMM9I PIC  X(0001).
  2150*    -------------------------------
  2151     05  CHGBK9L PIC S9(0004) COMP.
  2152     05  CHGBK9F PIC  X(0001).
  2153     05  FILLER REDEFINES CHGBK9F.
  2154         10  CHGBK9A PIC  X(0001).
  2155     05  CHGBK9I PIC  X(0002).
  2156*    -------------------------------
  2157     05  GLCDE9L PIC S9(0004) COMP.
  2158     05  GLCDE9F PIC  X(0001).
  2159     05  FILLER REDEFINES GLCDE9F.
  2160         10  GLCDE9A PIC  X(0001).
  2161     05  GLCDE9I PIC  X(0001).
  2162*    -------------------------------
  2163     05  AGNT10L PIC S9(0004) COMP.
  2164     05  AGNT10F PIC  X(0001).
  2165     05  FILLER REDEFINES AGNT10F.
  2166         10  AGNT10A PIC  X(0001).
  2167     05  AGNT10I PIC  X(0010).
  2168*    -------------------------------
  2169     05  TYPE10L PIC S9(0004) COMP.
  2170     05  TYPE10F PIC  X(0001).
  2171     05  FILLER REDEFINES TYPE10F.
  2172         10  TYPE10A PIC  X(0001).
  2173     05  TYPE10I PIC  X(0001).
  2174*    -------------------------------
  2175     05  SINRT10L PIC S9(0004) COMP.
  2176     05  SINRT10F PIC  X(0001).
  2177     05  FILLER REDEFINES SINRT10F.
  2178         10  SINRT10A PIC  X(0001).
  2179     05  SINRT10I PIC  X(0006).
  2180*    -------------------------------
  2181     05  JNTRT10L PIC S9(0004) COMP.
  2182     05  JNTRT10F PIC  X(0001).
  2183     05  FILLER REDEFINES JNTRT10F.
  2184         10  JNTRT10A PIC  X(0001).
  2185     05  JNTRT10I PIC  X(0006).
  2186*    -------------------------------
  2187     05  AHRT10L PIC S9(0004) COMP.
  2188     05  AHRT10F PIC  X(0001).
  2189     05  FILLER REDEFINES AHRT10F.
  2190         10  AHRT10A PIC  X(0001).
  2191     05  AHRT10I PIC  X(0006).
  2192*    -------------------------------
  2193     05  RECAL10L PIC S9(0004) COMP.
  2194     05  RECAL10F PIC  X(0001).
  2195     05  FILLER REDEFINES RECAL10F.
  2196         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  44
* EL6501.cbl
  2197     05  RECAL10I PIC  X(0001).
  2198*    -------------------------------
  2199     05  COMM10L PIC S9(0004) COMP.
  2200     05  COMM10F PIC  X(0001).
  2201     05  FILLER REDEFINES COMM10F.
  2202         10  COMM10A PIC  X(0001).
  2203     05  COMM10I PIC  X(0001).
  2204*    -------------------------------
  2205     05  CHGBK10L PIC S9(0004) COMP.
  2206     05  CHGBK10F PIC  X(0001).
  2207     05  FILLER REDEFINES CHGBK10F.
  2208         10  CHGBK10A PIC  X(0001).
  2209     05  CHGBK10I PIC  X(0002).
  2210*    -------------------------------
  2211     05  GLCDE10L PIC S9(0004) COMP.
  2212     05  GLCDE10F PIC  X(0001).
  2213     05  FILLER REDEFINES GLCDE10F.
  2214         10  GLCDE10A PIC  X(0001).
  2215     05  GLCDE10I PIC  X(0001).
  2216*    -------------------------------
  2217     05  ERRMSG1L PIC S9(0004) COMP.
  2218     05  ERRMSG1F PIC  X(0001).
  2219     05  FILLER REDEFINES ERRMSG1F.
  2220         10  ERRMSG1A PIC  X(0001).
  2221     05  ERRMSG1I PIC  X(0075).
  2222*    -------------------------------
  2223     05  PFENTERL PIC S9(0004) COMP.
  2224     05  PFENTERF PIC  X(0001).
  2225     05  FILLER REDEFINES PFENTERF.
  2226         10  PFENTERA PIC  X(0001).
  2227     05  PFENTERI PIC  9(2).
  2228*    -------------------------------
  2229     05  PF1PF2L PIC S9(0004) COMP.
  2230     05  PF1PF2F PIC  X(0001).
  2231     05  FILLER REDEFINES PF1PF2F.
  2232         10  PF1PF2A PIC  X(0001).
  2233     05  PF1PF2I PIC  X(0035).
  2234 01  EL6501AO REDEFINES EL6501AI.
  2235     05  FILLER            PIC  X(0012).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  DATEO PIC  X(0008).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  TIMEO PIC  99.99.
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  CMPNYIDO PIC  X(0003).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  USERIDO PIC  X(0004).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  MAINTO PIC  X(0001).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  CARRO PIC  X(0001).
  2254*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  45
* EL6501.cbl
  2255     05  FILLER            PIC  X(0003).
  2256     05  GROUPINO PIC  X(0006).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  STATEO PIC  X(0002).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  ACCOUNTO PIC  X(0010).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  EFFDTEO PIC  X(0008).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  EXPDTEO PIC  99B99B99.
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  MAINTBYO PIC  X(0004).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  PCONTO PIC  X(0030).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  CSRO PIC  X(0004).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  PDSPLYO PIC  X(0006).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  PEFFDTEO PIC  X(0008).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  PEXPDTEO PIC  X(0008).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  NAMEO PIC  X(0030).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  TAXNOO PIC  X(0011).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  STATUSO PIC  X(0001).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  INCAREO PIC  X(0030).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  PHONEO PIC  999B999B9999.
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  INDGRPO PIC  X(0001).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  ADDR1O PIC  X(0030).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  CONTRO PIC  X(0008).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  46
* EL6501.cbl
  2313     05  TYPEO PIC  X(0002).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  ACITYO PIC  X(0028).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  ASTATEO PIC  X(0002).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  PRODATEO PIC  X(0008).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  STDBENO PIC  X(0002).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  ZIPO PIC  X(0010).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  CTPLABLO PIC  X(0010).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  CLPTOLPO PIC  Z.9999.
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  RETROCDO PIC  X(0003).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  BILLCDO PIC  X(0003).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  LCLABLO PIC  X(0011).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  LCOMMO PIC  ZZ99.99-.
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  MAXFEEHO PIC  X(0013).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  MAXMFEEO PIC  Z,Z99.
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  CLPSTHO PIC  X(0010).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  CLPSTO PIC  X(0002).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  PRODCDHO PIC  X(0012).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  PRODCDO PIC  X(0003).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  REMITO PIC  X(0002).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  47
* EL6501.cbl
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  REINTABO PIC  X(0003).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  REINCALO PIC  X(0001).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  AHHEADO PIC  X(0006).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  AGNT1O PIC  X(0010).
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  TYPE1O PIC  X(0001).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  SINRT1O PIC  X(0006).
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
  2391     05  JNTRT1O PIC  X(0006).
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  AHRT1O PIC  X(0006).
  2395*    -------------------------------
  2396     05  FILLER            PIC  X(0003).
  2397     05  RECAL1O PIC  X(0001).
  2398*    -------------------------------
  2399     05  FILLER            PIC  X(0003).
  2400     05  COMM1O PIC  X(0001).
  2401*    -------------------------------
  2402     05  FILLER            PIC  X(0003).
  2403     05  CHGBK1O PIC  X(0002).
  2404*    -------------------------------
  2405     05  FILLER            PIC  X(0003).
  2406     05  GLCDE1O PIC  X(0001).
  2407*    -------------------------------
  2408     05  FILLER            PIC  X(0003).
  2409     05  AGNT2O PIC  X(0010).
  2410*    -------------------------------
  2411     05  FILLER            PIC  X(0003).
  2412     05  TYPE2O PIC  X(0001).
  2413*    -------------------------------
  2414     05  FILLER            PIC  X(0003).
  2415     05  SINRT2O PIC  X(0006).
  2416*    -------------------------------
  2417     05  FILLER            PIC  X(0003).
  2418     05  JNTRT2O PIC  X(0006).
  2419*    -------------------------------
  2420     05  FILLER            PIC  X(0003).
  2421     05  AHRT2O PIC  X(0006).
  2422*    -------------------------------
  2423     05  FILLER            PIC  X(0003).
  2424     05  RECAL2O PIC  X(0001).
  2425*    -------------------------------
  2426     05  FILLER            PIC  X(0003).
  2427     05  COMM2O PIC  X(0001).
  2428*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  48
* EL6501.cbl
  2429     05  FILLER            PIC  X(0003).
  2430     05  CHGBK2O PIC  X(0002).
  2431*    -------------------------------
  2432     05  FILLER            PIC  X(0003).
  2433     05  GLCDE2O PIC  X(0001).
  2434*    -------------------------------
  2435     05  FILLER            PIC  X(0003).
  2436     05  AGNT3O PIC  X(0010).
  2437*    -------------------------------
  2438     05  FILLER            PIC  X(0003).
  2439     05  TYPE3O PIC  X(0001).
  2440*    -------------------------------
  2441     05  FILLER            PIC  X(0003).
  2442     05  SINRT3O PIC  X(0006).
  2443*    -------------------------------
  2444     05  FILLER            PIC  X(0003).
  2445     05  JNTRT3O PIC  X(0006).
  2446*    -------------------------------
  2447     05  FILLER            PIC  X(0003).
  2448     05  AHRT3O PIC  X(0006).
  2449*    -------------------------------
  2450     05  FILLER            PIC  X(0003).
  2451     05  RECAL3O PIC  X(0001).
  2452*    -------------------------------
  2453     05  FILLER            PIC  X(0003).
  2454     05  COMM3O PIC  X(0001).
  2455*    -------------------------------
  2456     05  FILLER            PIC  X(0003).
  2457     05  CHGBK3O PIC  X(0002).
  2458*    -------------------------------
  2459     05  FILLER            PIC  X(0003).
  2460     05  GLCDE3O PIC  X(0001).
  2461*    -------------------------------
  2462     05  FILLER            PIC  X(0003).
  2463     05  AGNT4O PIC  X(0010).
  2464*    -------------------------------
  2465     05  FILLER            PIC  X(0003).
  2466     05  TYPE4O PIC  X(0001).
  2467*    -------------------------------
  2468     05  FILLER            PIC  X(0003).
  2469     05  SINRT4O PIC  X(0006).
  2470*    -------------------------------
  2471     05  FILLER            PIC  X(0003).
  2472     05  JNTRT4O PIC  X(0006).
  2473*    -------------------------------
  2474     05  FILLER            PIC  X(0003).
  2475     05  AHRT4O PIC  X(0006).
  2476*    -------------------------------
  2477     05  FILLER            PIC  X(0003).
  2478     05  RECAL4O PIC  X(0001).
  2479*    -------------------------------
  2480     05  FILLER            PIC  X(0003).
  2481     05  COMM4O PIC  X(0001).
  2482*    -------------------------------
  2483     05  FILLER            PIC  X(0003).
  2484     05  CHGBK4O PIC  X(0002).
  2485*    -------------------------------
  2486     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  49
* EL6501.cbl
  2487     05  GLCDE4O PIC  X(0001).
  2488*    -------------------------------
  2489     05  FILLER            PIC  X(0003).
  2490     05  AGNT5O PIC  X(0010).
  2491*    -------------------------------
  2492     05  FILLER            PIC  X(0003).
  2493     05  TYPE5O PIC  X(0001).
  2494*    -------------------------------
  2495     05  FILLER            PIC  X(0003).
  2496     05  SINRT5O PIC  X(0006).
  2497*    -------------------------------
  2498     05  FILLER            PIC  X(0003).
  2499     05  JNTRT5O PIC  X(0006).
  2500*    -------------------------------
  2501     05  FILLER            PIC  X(0003).
  2502     05  AHRT5O PIC  X(0006).
  2503*    -------------------------------
  2504     05  FILLER            PIC  X(0003).
  2505     05  RECAL5O PIC  X(0001).
  2506*    -------------------------------
  2507     05  FILLER            PIC  X(0003).
  2508     05  COMM5O PIC  X(0001).
  2509*    -------------------------------
  2510     05  FILLER            PIC  X(0003).
  2511     05  CHGBK5O PIC  X(0002).
  2512*    -------------------------------
  2513     05  FILLER            PIC  X(0003).
  2514     05  GLCDE5O PIC  X(0001).
  2515*    -------------------------------
  2516     05  FILLER            PIC  X(0003).
  2517     05  AGNT6O PIC  X(0010).
  2518*    -------------------------------
  2519     05  FILLER            PIC  X(0003).
  2520     05  TYPE6O PIC  X(0001).
  2521*    -------------------------------
  2522     05  FILLER            PIC  X(0003).
  2523     05  SINRT6O PIC  X(0006).
  2524*    -------------------------------
  2525     05  FILLER            PIC  X(0003).
  2526     05  JNTRT6O PIC  X(0006).
  2527*    -------------------------------
  2528     05  FILLER            PIC  X(0003).
  2529     05  AHRT6O PIC  X(0006).
  2530*    -------------------------------
  2531     05  FILLER            PIC  X(0003).
  2532     05  RECAL6O PIC  X(0001).
  2533*    -------------------------------
  2534     05  FILLER            PIC  X(0003).
  2535     05  COMM6O PIC  X(0001).
  2536*    -------------------------------
  2537     05  FILLER            PIC  X(0003).
  2538     05  CHGBK6O PIC  X(0002).
  2539*    -------------------------------
  2540     05  FILLER            PIC  X(0003).
  2541     05  GLCDE6O PIC  X(0001).
  2542*    -------------------------------
  2543     05  FILLER            PIC  X(0003).
  2544     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  50
* EL6501.cbl
  2545*    -------------------------------
  2546     05  FILLER            PIC  X(0003).
  2547     05  TYPE7O PIC  X(0001).
  2548*    -------------------------------
  2549     05  FILLER            PIC  X(0003).
  2550     05  SINRT7O PIC  X(0006).
  2551*    -------------------------------
  2552     05  FILLER            PIC  X(0003).
  2553     05  JNTRT7O PIC  X(0006).
  2554*    -------------------------------
  2555     05  FILLER            PIC  X(0003).
  2556     05  AHRT7O PIC  X(0006).
  2557*    -------------------------------
  2558     05  FILLER            PIC  X(0003).
  2559     05  RECAL7O PIC  X(0001).
  2560*    -------------------------------
  2561     05  FILLER            PIC  X(0003).
  2562     05  COMM7O PIC  X(0001).
  2563*    -------------------------------
  2564     05  FILLER            PIC  X(0003).
  2565     05  CHGBK7O PIC  X(0002).
  2566*    -------------------------------
  2567     05  FILLER            PIC  X(0003).
  2568     05  GLCDE7O PIC  X(0001).
  2569*    -------------------------------
  2570     05  FILLER            PIC  X(0003).
  2571     05  AGNT8O PIC  X(0010).
  2572*    -------------------------------
  2573     05  FILLER            PIC  X(0003).
  2574     05  TYPE8O PIC  X(0001).
  2575*    -------------------------------
  2576     05  FILLER            PIC  X(0003).
  2577     05  SINRT8O PIC  X(0006).
  2578*    -------------------------------
  2579     05  FILLER            PIC  X(0003).
  2580     05  JNTRT8O PIC  X(0006).
  2581*    -------------------------------
  2582     05  FILLER            PIC  X(0003).
  2583     05  AHRT8O PIC  X(0006).
  2584*    -------------------------------
  2585     05  FILLER            PIC  X(0003).
  2586     05  RECAL8O PIC  X(0001).
  2587*    -------------------------------
  2588     05  FILLER            PIC  X(0003).
  2589     05  COMM8O PIC  X(0001).
  2590*    -------------------------------
  2591     05  FILLER            PIC  X(0003).
  2592     05  CHGBK8O PIC  X(0002).
  2593*    -------------------------------
  2594     05  FILLER            PIC  X(0003).
  2595     05  GLCDE8O PIC  X(0001).
  2596*    -------------------------------
  2597     05  FILLER            PIC  X(0003).
  2598     05  AGNT9O PIC  X(0010).
  2599*    -------------------------------
  2600     05  FILLER            PIC  X(0003).
  2601     05  TYPE9O PIC  X(0001).
  2602*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  51
* EL6501.cbl
  2603     05  FILLER            PIC  X(0003).
  2604     05  SINRT9O PIC  X(0006).
  2605*    -------------------------------
  2606     05  FILLER            PIC  X(0003).
  2607     05  JNTRT9O PIC  X(0006).
  2608*    -------------------------------
  2609     05  FILLER            PIC  X(0003).
  2610     05  AHRT9O PIC  X(0006).
  2611*    -------------------------------
  2612     05  FILLER            PIC  X(0003).
  2613     05  RECAL9O PIC  X(0001).
  2614*    -------------------------------
  2615     05  FILLER            PIC  X(0003).
  2616     05  COMM9O PIC  X(0001).
  2617*    -------------------------------
  2618     05  FILLER            PIC  X(0003).
  2619     05  CHGBK9O PIC  X(0002).
  2620*    -------------------------------
  2621     05  FILLER            PIC  X(0003).
  2622     05  GLCDE9O PIC  X(0001).
  2623*    -------------------------------
  2624     05  FILLER            PIC  X(0003).
  2625     05  AGNT10O PIC  X(0010).
  2626*    -------------------------------
  2627     05  FILLER            PIC  X(0003).
  2628     05  TYPE10O PIC  X(0001).
  2629*    -------------------------------
  2630     05  FILLER            PIC  X(0003).
  2631     05  SINRT10O PIC  X(0006).
  2632*    -------------------------------
  2633     05  FILLER            PIC  X(0003).
  2634     05  JNTRT10O PIC  X(0006).
  2635*    -------------------------------
  2636     05  FILLER            PIC  X(0003).
  2637     05  AHRT10O PIC  X(0006).
  2638*    -------------------------------
  2639     05  FILLER            PIC  X(0003).
  2640     05  RECAL10O PIC  X(0001).
  2641*    -------------------------------
  2642     05  FILLER            PIC  X(0003).
  2643     05  COMM10O PIC  X(0001).
  2644*    -------------------------------
  2645     05  FILLER            PIC  X(0003).
  2646     05  CHGBK10O PIC  X(0002).
  2647*    -------------------------------
  2648     05  FILLER            PIC  X(0003).
  2649     05  GLCDE10O PIC  X(0001).
  2650*    -------------------------------
  2651     05  FILLER            PIC  X(0003).
  2652     05  ERRMSG1O PIC  X(0075).
  2653*    -------------------------------
  2654     05  FILLER            PIC  X(0003).
  2655     05  PFENTERO PIC  X(0002).
  2656*    -------------------------------
  2657     05  FILLER            PIC  X(0003).
  2658     05  PF1PF2O PIC  X(0035).
  2659*    -------------------------------
  2660 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  52
* EL6501.cbl
  2661*    12  FILLER                  PIC X(518).
  2662*    12  FILLER                  PIC X(543).
  2663     12  FILLER                  PIC X(546).
  2664     12  MAP-AGENT-AREA.
  2665         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2666             20  AGENTL          PIC S9(4) COMP.
  2667             20  AGENTA          PIC X.
  2668             20  AGENT           PIC X(10).
  2669             20  ATYPEL          PIC S9(4) COMP.
  2670             20  ATYPEA          PIC X.
  2671             20  ATYPE           PIC X.
  2672             20  SINGLEL         PIC S9(4) COMP.
  2673             20  SINGLEA         PIC X.
  2674             20  SINGLE-COMM-T   PIC X(6).
  2675             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2676                 24  SINGLE-COMM-R PIC V9(5).
  2677                 24  SINGLE-DASH   PIC X.
  2678             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2679                                 PIC V9(5)-.
  2680             20  JOINTL          PIC S9(4) COMP.
  2681             20  JOINTA          PIC X.
  2682             20  JOINT-COMM-T    PIC X(6).
  2683             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2684                 24  JOINT-COMM-R PIC V9(5).
  2685                 24  JOINT-DASH   PIC X.
  2686             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2687                                 PIC V9(5)-.
  2688             20  A-HL            PIC S9(4) COMP.
  2689             20  A-HA            PIC X.
  2690             20  A-H-COMM-T      PIC X(6).
  2691             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2692                 24  A-H-COMM-R  PIC V9(5).
  2693                 24  A-H-DASH    PIC X.
  2694             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2695                                 PIC V9(5)-.
  2696             20  RECALL          PIC S9(4) COMP.
  2697             20  RECALA          PIC X.
  2698             20  RECAL           PIC X.
  2699             20  RCOMML          PIC S9(4) COMP.
  2700             20  RCOMMA          PIC X.
  2701             20  RCOMM           PIC X.
  2702             20  CHGBCKL         PIC S9(4) COMP.
  2703             20  CHGBCKA         PIC X.
  2704             20  CHGBCK          PIC X(02).
  2705             20  GLCODEL         PIC S9(4) COMP.
  2706             20  GLCODEA         PIC X.
  2707             20  GLCODE          PIC X.
  2708****************************************************************
  2709*
  2710* Copyright (c) 2007 by Clerity Solutions, Inc.
  2711* All rights reserved.
  2712*
  2713****************************************************************
  2714 01  DFHEIV.
  2715   02  DFHEIV0               PIC X(35).
  2716   02  DFHEIV1               PIC X(08).
  2717   02  DFHEIV2               PIC X(08).
  2718   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  53
* EL6501.cbl
  2719   02  DFHEIV4               PIC X(06).
  2720   02  DFHEIV5               PIC X(04).
  2721   02  DFHEIV6               PIC X(04).
  2722   02  DFHEIV7               PIC X(02).
  2723   02  DFHEIV8               PIC X(02).
  2724   02  DFHEIV9               PIC X(01).
  2725   02  DFHEIV10              PIC S9(7) COMP-3.
  2726   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2727   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2728   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2729   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2730   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2731   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2732   02  DFHEIV17              PIC X(04).
  2733   02  DFHEIV18              PIC X(04).
  2734   02  DFHEIV19              PIC X(04).
  2735   02  DFHEIV20              USAGE IS POINTER.
  2736   02  DFHEIV21              USAGE IS POINTER.
  2737   02  DFHEIV22              USAGE IS POINTER.
  2738   02  DFHEIV23              USAGE IS POINTER.
  2739   02  DFHEIV24              USAGE IS POINTER.
  2740   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2741   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2742   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2743   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2744   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2745   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2746   02  FILLER                PIC X(02).
  2747   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2748   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2749   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2750   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2751   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2752 LINKAGE  SECTION.
  2753*****************************************************************
  2754*                                                               *
  2755* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2756* All rights reserved.                                          *
  2757*                                                               *
  2758*****************************************************************
  2759 01  dfheiblk.
  2760     02  eibtime          pic s9(7) comp-3.
  2761     02  eibdate          pic s9(7) comp-3.
  2762     02  eibtrnid         pic x(4).
  2763     02  eibtaskn         pic s9(7) comp-3.
  2764     02  eibtrmid         pic x(4).
  2765     02  dfheigdi         pic s9(4) comp.
  2766     02  eibcposn         pic s9(4) comp.
  2767     02  eibcalen         pic s9(4) comp.
  2768     02  eibaid           pic x(1).
  2769     02  eibfiller1       pic x(1).
  2770     02  eibfn            pic x(2).
  2771     02  eibfiller2       pic x(2).
  2772     02  eibrcode         pic x(6).
  2773     02  eibfiller3       pic x(2).
  2774     02  eibds            pic x(8).
  2775     02  eibreqid         pic x(8).
  2776     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  54
* EL6501.cbl
  2777     02  eibsync          pic x(1).
  2778     02  eibfree          pic x(1).
  2779     02  eibrecv          pic x(1).
  2780     02  eibsend          pic x(1).
  2781     02  eibatt           pic x(1).
  2782     02  eibeoc           pic x(1).
  2783     02  eibfmh           pic x(1).
  2784     02  eibcompl         pic x(1).
  2785     02  eibsig           pic x(1).
  2786     02  eibconf          pic x(1).
  2787     02  eiberr           pic x(1).
  2788     02  eibrldbk         pic x(1).
  2789     02  eiberrcd         pic x(4).
  2790     02  eibsynrb         pic x(1).
  2791     02  eibnodat         pic x(1).
  2792     02  eibfiller5       pic x(2).
  2793     02  eibresp          pic 9(09) comp.
  2794     02  eibresp2         pic 9(09) comp.
  2795     02  dfheigdj         pic s9(4) comp.
  2796     02  dfheigdk         pic s9(4) comp.
  2797 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  55
* EL6501.cbl
  2799*01 PARMLIST .
  2800*    02  FILLER                  PIC S9(8)   COMP.
  2801*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2802*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2803*    02  REIN-POINTER            PIC S9(8)   COMP.
  2804*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2805*    02  COMM-POINTER            PIC S9(8)   COMP.
  2806*    02  COMP-POINTER            PIC S9(8)   COMP.
  2807*    02  NAME-POINTER            PIC S9(8)   COMP.
  2808*    02  RQST-POINTER            PIC S9(8)   COMP.
  2809*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2810*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2811*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2812*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2813*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2814*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2815*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2816*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2817*    COPY ERCACCT.
  2818******************************************************************
  2819*                                                                *
  2820*                                                                *
  2821*                            ERCACCT                             *
  2822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2823*                            VMOD=2.031                          *
  2824*                                                                *
  2825*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2826*                                                                *
  2827*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2828*   VSAM ACCOUNT MASTER FILES.                                   *
  2829*                                                                *
  2830*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2831*                                                                *
  2832*   FILE TYPE = VSAM,KSDS                                        *
  2833*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2834*                                                                *
  2835*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2836*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2837*                                                                *
  2838*   LOG = NO                                                     *
  2839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2840*                                                                *
  2841*                                                                *
  2842******************************************************************
  2843*                   C H A N G E   L O G
  2844*
  2845* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2846*-----------------------------------------------------------------
  2847*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2848* EFFECTIVE    NUMBER
  2849*-----------------------------------------------------------------
  2850* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2851* 092705    2005050300006  PEMA  ADD SPP LEASES
  2852* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2853* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2854* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2855* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2856* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  56
* EL6501.cbl
  2857******************************************************************
  2858
  2859 01  ACCOUNT-MASTER.
  2860     12  AM-RECORD-ID                      PIC XX.
  2861         88  VALID-AM-ID                      VALUE 'AM'.
  2862
  2863     12  AM-CONTROL-PRIMARY.
  2864         16  AM-COMPANY-CD                 PIC X.
  2865         16  AM-MSTR-CNTRL.
  2866             20  AM-CONTROL-A.
  2867                 24  AM-CARRIER            PIC X.
  2868                 24  AM-GROUPING.
  2869                     28 AM-GROUPING-PREFIX PIC XXX.
  2870                     28 AM-GROUPING-PRIME  PIC XXX.
  2871                 24  AM-STATE              PIC XX.
  2872                 24  AM-ACCOUNT.
  2873                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2874                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2875             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2876                                           PIC X(19).
  2877             20  AM-CNTRL-B.
  2878                 24  AM-EXPIRATION-DT      PIC XX.
  2879                 24  FILLER                PIC X(4).
  2880             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2881                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2882
  2883     12  AM-CONTROL-BY-VAR-GRP.
  2884         16  AM-COMPANY-CD-A1              PIC X.
  2885         16  AM-VG-CARRIER                 PIC X.
  2886         16  AM-VG-GROUPING                PIC X(6).
  2887         16  AM-VG-STATE                   PIC XX.
  2888         16  AM-VG-ACCOUNT                 PIC X(10).
  2889         16  AM-VG-DATE.
  2890             20  AM-VG-EXPIRATION-DT       PIC XX.
  2891             20  FILLER                    PIC X(4).
  2892         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2893                                           PIC 9(11)      COMP-3.
  2894     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2895         16  FILLER                        PIC X(10).
  2896         16  AM-VG-KEY3.
  2897             20  AM-VG3-ACCOUNT            PIC X(10).
  2898             20  AM-VG3-EXP-DT             PIC XX.
  2899         16  FILLER                        PIC X(4).
  2900     12  AM-MAINT-INFORMATION.
  2901         16  AM-LAST-MAINT-DT              PIC XX.
  2902         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2903         16  AM-LAST-MAINT-USER            PIC X(4).
  2904         16  FILLER                        PIC XX.
  2905
  2906     12  AM-EFFECTIVE-DT                   PIC XX.
  2907     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2908
  2909     12  AM-PREV-DATES  COMP-3.
  2910         16  AM-PREV-EXP-DT                PIC 9(11).
  2911         16  AM-PREV-EFF-DT                PIC 9(11).
  2912
  2913     12  AM-REPORT-CODE-1                  PIC X(10).
  2914     12  AM-REPORT-CODE-2                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  57
* EL6501.cbl
  2915
  2916     12  AM-CITY-CODE                      PIC X(4).
  2917     12  AM-COUNTY-PARISH                  PIC X(6).
  2918
  2919     12  AM-NAME                           PIC X(30).
  2920     12  AM-PERSON                         PIC X(30).
  2921     12  AM-ADDRS                          PIC X(30).
  2922     12  AM-CITY.
  2923         16  AM-ADDR-CITY                  PIC X(28).
  2924         16  AM-ADDR-STATE                 PIC XX.
  2925     12  AM-ZIP.
  2926         16  AM-ZIP-PRIME.
  2927             20  AM-ZIP-PRI-1ST            PIC X.
  2928                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2929             20  FILLER                    PIC X(4).
  2930         16  AM-ZIP-PLUS4                  PIC X(4).
  2931     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2932         16  AM-CAN-POSTAL-1               PIC XXX.
  2933         16  AM-CAN-POSTAL-2               PIC XXX.
  2934         16  FILLER                        PIC XXX.
  2935     12  AM-TEL-NO.
  2936         16  AM-AREA-CODE                  PIC 999.
  2937         16  AM-TEL-PRE                    PIC 999.
  2938         16  AM-TEL-NBR                    PIC 9(4).
  2939     12  AM-TEL-LOC                        PIC X.
  2940         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2941         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2942
  2943     12  AM-COMM-STRUCTURE.
  2944         16  AM-DEFN-1.
  2945             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2946                 24  AM-AGT.
  2947                     28  AM-AGT-PREFIX     PIC X(4).
  2948                     28  AM-AGT-PRIME      PIC X(6).
  2949                 24  AM-COM-TYP            PIC X.
  2950                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2951                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2952                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2953                 24  AM-RECALC-LV-INDIC    PIC X.
  2954                 24  AM-RETRO-LV-INDIC     PIC X.
  2955                 24  AM-GL-CODES           PIC X.
  2956                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2957                 24  FILLER                PIC X(01).
  2958         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2959             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2960                 24  FILLER                PIC X(11).
  2961                 24  AM-L-COMA             PIC XXX.
  2962                 24  AM-J-COMA             PIC XXX.
  2963                 24  AM-A-COMA             PIC XXX.
  2964                 24  FILLER                PIC X(6).
  2965
  2966     12  AM-COMM-CHANGE-STATUS             PIC X.
  2967         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2968
  2969     12  AM-CSR-CODE                       PIC X(4).
  2970
  2971     12  AM-BILLING-STATUS                 PIC X.
  2972         88  AM-ACCOUNT-BILLED                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  58
* EL6501.cbl
  2973         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2974     12  AM-AUTO-REFUND-SW                 PIC X.
  2975         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2976         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2977     12  AM-GPCD                           PIC 99.
  2978     12  AM-IG                             PIC X.
  2979         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2980         88  AM-HAS-GROUP                     VALUE '2'.
  2981     12  AM-STATUS                         PIC X.
  2982         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2983         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2984         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2985         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2986         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2987         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2988     12  AM-REMIT-TO                       PIC 99.
  2989     12  AM-ID-NO                          PIC X(11).
  2990
  2991     12  AM-CAL-TABLE                      PIC XX.
  2992     12  AM-LF-DEVIATION                   PIC XXX.
  2993     12  AM-AH-DEVIATION                   PIC XXX.
  2994     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2995     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2996     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2997     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2998     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2999     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3000
  3001     12  AM-USER-FIELDS.
  3002         16  AM-FLD-1                      PIC XX.
  3003         16  AM-FLD-2                      PIC XX.
  3004         16  AM-FLD-3                      PIC XX.
  3005         16  AM-FLD-4                      PIC XX.
  3006         16  AM-FLD-5                      PIC XX.
  3007
  3008     12  AM-1ST-PROD-DATE.
  3009         16  AM-1ST-PROD-YR                PIC XX.
  3010         16  AM-1ST-PROD-MO                PIC XX.
  3011         16  AM-1ST-PROD-DA                PIC XX.
  3012     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3013     12  AM-CERTS-PURGED-DATE.
  3014         16  AM-PUR-YR                     PIC XX.
  3015         16  AM-PUR-MO                     PIC XX.
  3016         16  AM-PUR-DA                     PIC XX.
  3017     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3018     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3019     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3020     12  AM-INACTIVE-DATE.
  3021         16  AM-INA-MO                     PIC 99.
  3022         16  AM-INA-DA                     PIC 99.
  3023         16  AM-INA-YR                     PIC 99.
  3024     12  AM-AR-HI-CERT-DATE                PIC XX.
  3025
  3026     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3027     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3028
  3029     12  AM-OB-PAYMENT-MODE                PIC X.
  3030         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  59
* EL6501.cbl
  3031         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3032         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3033         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3034
  3035     12  AM-AH-ONLY-INDICATOR              PIC X.
  3036         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3037         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3038
  3039     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3040
  3041     12  AM-OVER-SHORT.
  3042         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3043         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3044
  3045     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3046     12  AM-DCC-CLP-STATE                  PIC XX.
  3047
  3048     12  AM-RECALC-COMM                    PIC X.
  3049     12  AM-RECALC-REIN                    PIC X.
  3050
  3051     12  AM-REI-TABLE                      PIC XXX.
  3052     12  AM-REI-ET-LF                      PIC X.
  3053     12  AM-REI-ET-AH                      PIC X.
  3054     12  AM-REI-PE-LF                      PIC X.
  3055     12  AM-REI-PE-AH                      PIC X.
  3056     12  AM-REI-PRT-ST                     PIC X.
  3057     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3058     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3059     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3060     12  AM-REI-GROUP-A                    PIC X(6).
  3061     12  AM-REI-MORT                       PIC X(4).
  3062     12  AM-REI-PRT-OW                     PIC X.
  3063     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3064     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3065     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3066     12  AM-REI-GROUP-B                    PIC X(6).
  3067
  3068     12  AM-TRUST-TYPE                     PIC X(2).
  3069
  3070     12  AM-EMPLOYER-STMT-USED             PIC X.
  3071     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3072
  3073     12  AM-STD-AH-TYPE                    PIC XX.
  3074     12  AM-EARN-METHODS.
  3075         16  AM-EARN-METHOD-R              PIC X.
  3076             88 AM-REF-RL-R78                 VALUE 'R'.
  3077             88 AM-REF-RL-PR                  VALUE 'P'.
  3078             88 AM-REF-RL-MEAN                VALUE 'M'.
  3079             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3080         16  AM-EARN-METHOD-L              PIC X.
  3081             88 AM-REF-LL-R78                 VALUE 'R'.
  3082             88 AM-REF-LL-PR                  VALUE 'P'.
  3083             88 AM-REF-LL-MEAN                VALUE 'M'.
  3084             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3085         16  AM-EARN-METHOD-A              PIC X.
  3086             88 AM-REF-AH-R78                 VALUE 'R'.
  3087             88 AM-REF-AH-PR                  VALUE 'P'.
  3088             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  60
* EL6501.cbl
  3089             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3090             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3091             88 AM-REF-AH-NET                 VALUE 'N'.
  3092
  3093     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3094     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3095     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3096
  3097     12  AM-RET-Y-N                        PIC X.
  3098     12  AM-RET-P-E                        PIC X.
  3099     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3100     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3101     12  AM-RET-GRP                        PIC X(6).
  3102     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3103         16  AM-POOL-PRIME                 PIC XXX.
  3104         16  AM-POOL-SUB                   PIC XXX.
  3105     12  AM-RETRO-EARNINGS.
  3106         16  AM-RET-EARN-R                 PIC X.
  3107         16  AM-RET-EARN-L                 PIC X.
  3108         16  AM-RET-EARN-A                 PIC X.
  3109     12  AM-RET-ST-TAX-USE                 PIC X.
  3110         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3111         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3112     12  AM-RETRO-BEG-EARNINGS.
  3113         16  AM-RET-BEG-EARN-R             PIC X.
  3114         16  AM-RET-BEG-EARN-L             PIC X.
  3115         16  AM-RET-BEG-EARN-A             PIC X.
  3116     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3117     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3118
  3119     12  AM-USER-SELECT-OPTIONS.
  3120         16  AM-USER-SELECT-1              PIC X(10).
  3121         16  AM-USER-SELECT-2              PIC X(10).
  3122         16  AM-USER-SELECT-3              PIC X(10).
  3123         16  AM-USER-SELECT-4              PIC X(10).
  3124         16  AM-USER-SELECT-5              PIC X(10).
  3125
  3126     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3127
  3128     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3129
  3130     12  AM-RPT045A-SWITCH                 PIC X.
  3131         88  RPT045A-OFF                   VALUE 'N'.
  3132
  3133     12  AM-INSURANCE-LIMITS.
  3134         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3135         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3136
  3137     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3138         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3139
  3140     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3141         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3142         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3143
  3144     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3145
  3146     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  61
* EL6501.cbl
  3147     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3148     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3149     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3150     12  AM-DCC-UEF-STATE                  PIC XX.
  3151     12  FILLER                            PIC XXX.
  3152     12  AM-REPORT-CODE-3                  PIC X(10).
  3153*    12  FILLER                            PIC X(22).
  3154
  3155     12  AM-RESERVE-DATE.
  3156         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3157         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3158         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3159
  3160     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3161     12  AM-NOTIFICATION-TYPES.
  3162         16  AM-NOTIF-OF-LETTERS           PIC X.
  3163         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3164         16  AM-NOTIF-OF-REPORTS           PIC X.
  3165         16  AM-NOTIF-OF-STATUS            PIC X.
  3166
  3167     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3168         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3169         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3170         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3171         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3172
  3173     12  AM-BENEFIT-CONTROLS.
  3174         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3175             20  AM-BENEFIT-CODE           PIC XX.
  3176             20  AM-BENEFIT-TYPE           PIC X.
  3177             20  AM-BENEFIT-REVISION       PIC XXX.
  3178             20  AM-BENEFIT-REM-TERM       PIC X.
  3179             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3180             20  FILLER                    PIC XX.
  3181         16  FILLER                        PIC X(80).
  3182
  3183     12  AM-TRANSFER-DATA.
  3184         16  AM-TRANSFERRED-FROM.
  3185             20  AM-TRNFROM-CARRIER        PIC X.
  3186             20  AM-TRNFROM-GROUPING.
  3187                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3188                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3189             20  AM-TRNFROM-STATE          PIC XX.
  3190             20  AM-TRNFROM-ACCOUNT.
  3191                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3192                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3193             20  AM-TRNFROM-DTE            PIC XX.
  3194         16  AM-TRANSFERRED-TO.
  3195             20  AM-TRNTO-CARRIER          PIC X.
  3196             20  AM-TRNTO-GROUPING.
  3197                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3198                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3199             20  AM-TRNTO-STATE            PIC XX.
  3200             20  AM-TRNTO-ACCOUNT.
  3201                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3202                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3203             20  AM-TRNTO-DTE              PIC XX.
  3204         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  62
* EL6501.cbl
  3205
  3206     12  AM-SAVED-REMIT-TO                 PIC 99.
  3207
  3208     12  AM-COMM-STRUCTURE-SAVED.
  3209         16  AM-DEFN-1-SAVED.
  3210             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3211                 24  AM-AGT-SV             PIC X(10).
  3212                 24  AM-COM-TYP-SV         PIC X.
  3213                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3214                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3215                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3216                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3217                 24  FILLER                PIC X.
  3218                 24  AM-GL-CODES-SV        PIC X.
  3219                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3220                 24  FILLER                PIC X.
  3221         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3222             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3223                 24  FILLER                PIC X(11).
  3224                 24  AM-L-COMA-SV          PIC XXX.
  3225                 24  AM-J-COMA-SV          PIC XXX.
  3226                 24  AM-A-COMA-SV          PIC XXX.
  3227                 24  FILLER                PIC X(6).
  3228
  3229     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3230         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3231            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3232            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3233            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3234
  3235     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3236     12  FILLER                            PIC X(120).
  3237
  3238     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3239         16  AM-CONTROL-NAME               PIC X(30).
  3240         16  AM-EXECUTIVE-ONE.
  3241             20  AM-EXEC1-NAME             PIC X(15).
  3242             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3243                                                          COMP-3.
  3244             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3245                                                          COMP-3.
  3246         16  AM-EXECUTIVE-TWO.
  3247             20  AM-EXEC2-NAME             PIC X(15).
  3248             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3249                                                          COMP-3.
  3250             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3251                                                          COMP-3.
  3252
  3253     12  AM-RETRO-ADDITIONAL-DATA.
  3254         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3255         16  AM-RETRO-PREM-P-E             PIC X.
  3256         16  AM-RETRO-CLMS-P-I             PIC X.
  3257         16  AM-RETRO-RET-BRACKET-LF.
  3258             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3259                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3260                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3261             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3262                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  63
* EL6501.cbl
  3263                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3264             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3265                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3266                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3267         16  AM-RETRO-RET-BRACKET-AH.
  3268             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3269                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3270                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3271                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3272             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3273                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3274                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3275             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3276                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3277                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3278
  3279     12  AM-COMMENTS.
  3280         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3281
  3282     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3283         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3284         16  AM-FLI-BILLING-CODE           PIC X.
  3285         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3286         16  AM-FLI-UNITED-IDENT           PIC X.
  3287         16  AM-FLI-INTEREST-LOST-DATA.
  3288             20  AM-FLI-BANK-NO            PIC X(5).
  3289             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3290             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3291             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3292         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3293             20  AM-FLI-AGT                PIC X(9).
  3294             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3295             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3296         16  FILLER                        PIC X(102).
  3297
  3298     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3299         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3300             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3301             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3302             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3303             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3304             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3305         16  FILLER                          PIC X(10).
  3306******************************************************************
  3307*    COPY ELCCNTL.
  3308******************************************************************
  3309*                                                                *
  3310*                                                                *
  3311*                            ELCCNTL.                            *
  3312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3313*                            VMOD=2.059                          *
  3314*                                                                *
  3315*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3316*                                                                *
  3317*   FILE TYPE = VSAM,KSDS                                        *
  3318*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3319*                                                                *
  3320*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  64
* EL6501.cbl
  3321*       ALTERNATE INDEX = NONE                                   *
  3322*                                                                *
  3323*   LOG = YES                                                    *
  3324*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3325******************************************************************
  3326*                   C H A N G E   L O G
  3327*
  3328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3329*-----------------------------------------------------------------
  3330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3331* EFFECTIVE    NUMBER
  3332*-----------------------------------------------------------------
  3333* 082503                   PEMA  ADD BENEFIT GROUP
  3334* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3335* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3336* 092705    2005050300006  PEMA  ADD SPP LEASES
  3337* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3338* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3339* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3340* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3341* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3342******************************************************************
  3343*
  3344 01  CONTROL-FILE.
  3345     12  CF-RECORD-ID                       PIC XX.
  3346         88  VALID-CF-ID                        VALUE 'CF'.
  3347
  3348     12  CF-CONTROL-PRIMARY.
  3349         16  CF-COMPANY-ID                  PIC XXX.
  3350         16  CF-RECORD-TYPE                 PIC X.
  3351             88  CF-COMPANY-MASTER              VALUE '1'.
  3352             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3353             88  CF-STATE-MASTER                VALUE '3'.
  3354             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3355             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3356             88  CF-CARRIER-MASTER              VALUE '6'.
  3357             88  CF-MORTALITY-MASTER            VALUE '7'.
  3358             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3359             88  CF-TERMINAL-MASTER             VALUE '9'.
  3360             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3361             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3362             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3363             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3364             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3365             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3366             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3367             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3368             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3369         16  CF-ACCESS-CD-GENL              PIC X(4).
  3370         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3371             20  CF-PROCESSOR               PIC X(4).
  3372         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3373             20  CF-STATE-CODE              PIC XX.
  3374             20  FILLER                     PIC XX.
  3375         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3376             20  FILLER                     PIC XX.
  3377             20  CF-HI-BEN-IN-REC           PIC XX.
  3378         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  65
* EL6501.cbl
  3379             20  FILLER                     PIC XXX.
  3380             20  CF-CARRIER-CNTL            PIC X.
  3381         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3382             20  FILLER                     PIC XX.
  3383             20  CF-HI-TYPE-IN-REC          PIC 99.
  3384         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3385             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3386                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3387             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3388             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3389         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3390             20  FILLER                     PIC X.
  3391             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3392         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3393             20  FILLER                     PIC XX.
  3394             20  CF-MORTGAGE-PLAN           PIC XX.
  3395         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3396
  3397     12  CF-LAST-MAINT-DT                   PIC XX.
  3398     12  CF-LAST-MAINT-BY                   PIC X(4).
  3399     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3400
  3401     12  CF-RECORD-BODY                     PIC X(728).
  3402
  3403
  3404****************************************************************
  3405*             COMPANY MASTER RECORD                            *
  3406****************************************************************
  3407
  3408     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3409         16  CF-COMPANY-ADDRESS.
  3410             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3411             20  CF-CL-IN-CARE-OF           PIC X(30).
  3412             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3413             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3414             20  CF-CL-CITY-STATE           PIC X(30).
  3415             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3416             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3417         16  CF-COMPANY-CD                  PIC X.
  3418         16  CF-COMPANY-PASSWORD            PIC X(8).
  3419         16  CF-SECURITY-OPTION             PIC X.
  3420             88  ALL-SECURITY                   VALUE '1'.
  3421             88  COMPANY-VERIFY                 VALUE '2'.
  3422             88  PROCESSOR-VERIFY               VALUE '3'.
  3423             88  NO-SECURITY                    VALUE '4'.
  3424             88  ALL-BUT-TERM                   VALUE '5'.
  3425         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3426             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3427         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3428             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3429         16  CF-INFORCE-LOCATION            PIC X.
  3430             88  CERTS-ARE-ONLINE               VALUE '1'.
  3431             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3432             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3433         16  CF-LOWER-CASE-LETTERS          PIC X.
  3434         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3435             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3436             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  66
* EL6501.cbl
  3437             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3438             88  CF-ACCNT-CNTL                  VALUE '3'.
  3439             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3440
  3441         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3442         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3443
  3444         16  CF-LGX-CREDIT-USER             PIC X.
  3445             88  CO-IS-NOT-USER                 VALUE 'N'.
  3446             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3447
  3448         16 CF-CREDIT-CALC-CODES.
  3449             20  CF-CR-REM-TERM-CALC PIC X.
  3450               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3451               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3452               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3453               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3454               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3455               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3456               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3457             20  CF-CR-R78-METHOD           PIC X.
  3458               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3459               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3460
  3461         16  CF-CLAIM-CONTROL-COUNTS.
  3462             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3463                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3464
  3465             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3466                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3467
  3468             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3469                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3470
  3471             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3472                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3473
  3474         16  CF-CURRENT-MONTH-END           PIC XX.
  3475
  3476         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3477             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3478             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3479             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3480             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3481                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3482                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3483             20  CF-CO-PREM-REJECT-SW       PIC X.
  3484                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3485                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3486             20  CF-CO-REF-REJECT-SW        PIC X.
  3487                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3488                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3489
  3490         16  CF-CO-REPORTING-DT             PIC XX.
  3491         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3492         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3493           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3494           88  CF-CO-MONTH-END                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  67
* EL6501.cbl
  3495
  3496         16  CF-LGX-CLAIM-USER              PIC X.
  3497             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3498             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3499
  3500         16  CF-CREDIT-EDIT-CONTROLS.
  3501             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3502             20  CF-MIN-AGE                 PIC 99.
  3503             20  CF-DEFAULT-AGE             PIC 99.
  3504             20  CF-MIN-TERM                PIC S999      COMP-3.
  3505             20  CF-MAX-TERM                PIC S999      COMP-3.
  3506             20  CF-DEFAULT-SEX             PIC X.
  3507             20  CF-JOINT-AGE-INPUT         PIC X.
  3508                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3509             20  CF-BIRTH-DATE-INPUT        PIC X.
  3510                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3511             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3512                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3513                 88  CF-ZERO-CARRIER            VALUE '1'.
  3514                 88  CF-ZERO-GROUPING           VALUE '2'.
  3515                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3516             20  CF-EDIT-SW                 PIC X.
  3517                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3518             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3519             20  CF-CR-PR-METHOD            PIC X.
  3520               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3521               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3522             20  FILLER                     PIC X.
  3523
  3524         16  CF-CREDIT-MISC-CONTROLS.
  3525             20  CF-REIN-TABLE-SW           PIC X.
  3526                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3527             20  CF-COMP-TABLE-SW           PIC X.
  3528                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3529             20  CF-EXPERIENCE-RETENTION-AGE
  3530                                            PIC S9        COMP-3.
  3531             20  CF-CONVERSION-DT           PIC XX.
  3532             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3533             20  CF-RUN-FREQUENCY-SW        PIC X.
  3534                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3535                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3536
  3537             20  CF-CR-CHECK-NO-CONTROL.
  3538                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3539                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3540                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3541                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3542                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3543                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3544
  3545                 24  CF-CR-CHECK-COUNT       REDEFINES
  3546                     CF-CR-CHECK-COUNTER      PIC X(4).
  3547
  3548                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3549                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3550
  3551                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3552                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  68
* EL6501.cbl
  3553                 24  CF-MAIL-PROCESSING       PIC X.
  3554                     88  MAIL-PROCESSING          VALUE 'Y'.
  3555
  3556         16  CF-MISC-SYSTEM-CONTROL.
  3557             20  CF-SYSTEM-C                 PIC X.
  3558                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3559             20  CF-SYSTEM-D                 PIC X.
  3560                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3561             20  CF-SOC-SEC-NO-SW            PIC X.
  3562                 88  SOC-SEC-NO-USED             VALUE '1'.
  3563             20  CF-MEMBER-NO-SW             PIC X.
  3564                 88  MEMBER-NO-USED              VALUE '1'.
  3565             20  CF-TAX-ID-NUMBER            PIC X(11).
  3566             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3567             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3568                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3569                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3570                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3571                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3572             20  CF-SYSTEM-E                 PIC X.
  3573                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3574
  3575         16  CF-LGX-LIFE-USER               PIC X.
  3576             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3577             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3578
  3579         16  CF-CR-MONTH-END-DT             PIC XX.
  3580
  3581         16  CF-FILE-MAINT-DATES.
  3582             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3583                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3584             20  CF-LAST-BATCH       REDEFINES
  3585                 CF-LAST-BATCH-NO               PIC X(4).
  3586             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3587             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3588             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3589             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3590             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3591             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3592             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3593             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3594             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3595             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3596
  3597         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3598         16  FILLER                         PIC X.
  3599
  3600         16  CF-ALT-MORT-CODE               PIC X(4).
  3601         16  CF-MEMBER-CAPTION              PIC X(10).
  3602
  3603         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3604             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3605             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3606             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3607             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3608             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3609
  3610         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  69
* EL6501.cbl
  3611
  3612         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3613         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3614         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3615         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3616
  3617         16  CF-AH-OVERRIDE-L1              PIC X.
  3618         16  CF-AH-OVERRIDE-L2              PIC XX.
  3619         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3620         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3621
  3622         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3623         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3624
  3625         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3626         16  CF-AR-LAST-EL860-DT            PIC XX.
  3627         16  CF-MP-MONTH-END-DT             PIC XX.
  3628
  3629         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3630         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3631             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3632
  3633         16  CF-AR-MONTH-END-DT             PIC XX.
  3634
  3635         16  CF-CRDTCRD-USER                PIC X.
  3636             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3637             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3638
  3639         16  CF-CC-MONTH-END-DT             PIC XX.
  3640
  3641         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3642
  3643         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3644             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3645             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3646             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3647         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3648         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3649         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3650         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3651             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3652             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3653         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3654         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3655         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3656             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3657         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3658
  3659         16  CF-CL-ZIP-CODE.
  3660             20  CF-CL-ZIP-PRIME.
  3661                 24  CF-CL-ZIP-1ST          PIC X.
  3662                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3663                 24  FILLER                 PIC X(4).
  3664             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3665         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3666             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3667             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3668             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  70
* EL6501.cbl
  3669
  3670         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3671         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3672         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3673         16  CF-CO-OPTION-START-DATE        PIC XX.
  3674         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3675           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3676                                                      '3' '4'.
  3677           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3678           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3679           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3680           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3681           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3682           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3683
  3684         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3685
  3686         16  CF-PAYMENT-APPROVAL-LEVELS.
  3687             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3688             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3689             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3690             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3691             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3692             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3693
  3694         16  CF-END-USER-REPORTING-USER     PIC X.
  3695             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3696             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3697
  3698         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3699             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3700             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3701
  3702         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3703
  3704         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3705         16  FILLER                         PIC X.
  3706
  3707         16  CF-CREDIT-ARCHIVE-CNTL.
  3708             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3709             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3710             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3711
  3712         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3713
  3714         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3715             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3716             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3717
  3718         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3719             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3720             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3721
  3722         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3723
  3724         16  CF-CO-ACH-ID-CODE              PIC  X.
  3725             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3726             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  71
* EL6501.cbl
  3727             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3728         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3729         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3730         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3731         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3732         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3733         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3734         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3735         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3736         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3737                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3738         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3739                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3740
  3741         16  CF-CO-OVER-SHORT.
  3742             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3743             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3744
  3745*         16  FILLER                         PIC X(102).
  3746         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3747             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3748             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3749
  3750         16  CF-AH-APPROVAL-DAYS.
  3751             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3752             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3753             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3754             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3755
  3756         16  FILLER                         PIC X(82).
  3757****************************************************************
  3758*             PROCESSOR/USER RECORD                            *
  3759****************************************************************
  3760
  3761     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3762         16  CF-PROCESSOR-NAME              PIC X(30).
  3763         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3764         16  CF-PROCESSOR-TITLE             PIC X(26).
  3765         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3766                 88  MESSAGE-YES                VALUE 'Y'.
  3767                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3768
  3769*****************************************************
  3770****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3771****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3772****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3773****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3774*****************************************************
  3775
  3776         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3777             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3778             20  CF-APPLICATION-FORCE       PIC X.
  3779             20  CF-INDIVIDUAL-APP.
  3780                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3781                     28  CF-BROWSE-APP      PIC X.
  3782                     28  CF-UPDATE-APP      PIC X.
  3783
  3784         16  CF-CURRENT-TERM-ON             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  72
* EL6501.cbl
  3785         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3786             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3787             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3788             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3789             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3790             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3791             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3792             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3793         16  CF-PROCESSOR-CARRIER           PIC X.
  3794             88  NO-CARRIER-SECURITY            VALUE ' '.
  3795         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3796             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3797         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3798             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3799         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3800             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3801
  3802         16  CF-PROC-SYS-ACCESS-SW.
  3803             20  CF-PROC-CREDIT-CLAIMS-SW.
  3804                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3805                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3806                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3807                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3808             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3809                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3810                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3811             20  CF-PROC-LIFE-GNRLDGR-SW.
  3812                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3813                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3814                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3815                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3816             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3817                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3818                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3819         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3820             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3821             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3822         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3823
  3824         16  CF-APPROVAL-LEVEL                  PIC X.
  3825             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3826             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3827             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3828             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3829
  3830         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3831
  3832         16  CF-LANGUAGE-TYPE                   PIC X.
  3833             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3834             88  CF-LANG-IS-FR                      VALUE 'F'.
  3835         16  FILLER                             PIC  X(240).
  3836
  3837****************************************************************
  3838*             PROCESSOR/REMINDERS RECORD                       *
  3839****************************************************************
  3840
  3841     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3842         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  73
* EL6501.cbl
  3843             20  CF-START-REMIND-DT         PIC XX.
  3844             20  CF-END-REMIND-DT           PIC XX.
  3845             20  CF-REMINDER-TEXT           PIC X(50).
  3846         16  FILLER                         PIC X(296).
  3847
  3848
  3849****************************************************************
  3850*             STATE MASTER RECORD                              *
  3851****************************************************************
  3852
  3853     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3854         16  CF-STATE-ABBREVIATION          PIC XX.
  3855         16  CF-STATE-NAME                  PIC X(25).
  3856         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3857         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3858             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3859             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3860             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3861             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3862                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3863                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3864             20  CF-ST-PREM-REJECT-SW       PIC X.
  3865                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3866                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3867             20  CF-ST-REF-REJECT-SW        PIC X.
  3868                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3869                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3870         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3871         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3872         16  CF-ST-REFUND-RULES.
  3873             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3874             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3875             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3876         16  CF-ST-FST-PMT-EXTENSION.
  3877             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3878             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3879                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3880                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3881                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3882                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3883         16  CF-ST-STATE-CALL.
  3884             20  CF-ST-CALL-UNEARNED        PIC X.
  3885             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3886             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3887         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3888             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3889             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3890         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3891         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3892         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3893         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3894         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3895         16  FILLER                         PIC X.
  3896         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3897             20  CF-ST-BENEFIT-CD           PIC XX.
  3898             20  CF-ST-BENEFIT-KIND         PIC X.
  3899                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3900                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  74
* EL6501.cbl
  3901             20  CF-ST-REM-TERM-CALC        PIC X.
  3902                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3903                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3904                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3905                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3906                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3907                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3908                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3909                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3910
  3911             20  CF-ST-REFUND-CALC          PIC X.
  3912                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3913                 88  ST-REFD-BY-R78             VALUE '1'.
  3914                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3915                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3916                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3917                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3918                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3919                 88  ST-REFD-UTAH               VALUE '7'.
  3920                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3921                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3922                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3923
  3924             20  CF-ST-EARNING-CALC         PIC X.
  3925                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3926                 88  ST-EARN-BY-R78             VALUE '1'.
  3927                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3928                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3929                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3930                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3931                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3932                 88  ST-EARN-MEAN               VALUE '8'.
  3933                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3934
  3935             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3936                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3937                 88  ST-OVRD-BY-R78             VALUE '1'.
  3938                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3939                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3940                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3941                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3942                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3943                 88  ST-OVRD-MEAN               VALUE '8'.
  3944                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3945             20  FILLER                     PIC X.
  3946
  3947         16  CF-ST-COMMISSION-CAPS.
  3948             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3949             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3950             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3951             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3952         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3953                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3954
  3955         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3956
  3957         16  CF-ST-STATUTORY-INTEREST.
  3958             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  75
* EL6501.cbl
  3959                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3960                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3961             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3962             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3963             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3964             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3965             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3966
  3967         16  CF-ST-OVER-SHORT.
  3968             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3969             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3970
  3971         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3972
  3973         16  CF-ST-RT-CALC                  PIC X.
  3974
  3975         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3976         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3977         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3978         16  CF-ST-RF-LR-CALC               PIC X.
  3979         16  CF-ST-RF-LL-CALC               PIC X.
  3980         16  CF-ST-RF-LN-CALC               PIC X.
  3981         16  CF-ST-RF-AH-CALC               PIC X.
  3982         16  CF-ST-RF-CP-CALC               PIC X.
  3983*        16  FILLER                         PIC X(206).
  3984*CIDMOD         16  FILLER                         PIC X(192).
  3985         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3986             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3987         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3988         16  CF-ST-VFY-2ND-BENE             PIC X.
  3989         16  FILLER                         PIC X(186).
  3990
  3991****************************************************************
  3992*             BENEFIT MASTER RECORD                            *
  3993****************************************************************
  3994
  3995     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3996         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3997             20  CF-BENEFIT-CODE            PIC XX.
  3998             20  CF-BENEFIT-NUMERIC  REDEFINES
  3999                 CF-BENEFIT-CODE            PIC XX.
  4000             20  CF-BENEFIT-ALPHA           PIC XXX.
  4001             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4002             20  CF-BENEFIT-COMMENT         PIC X(10).
  4003
  4004             20  CF-LF-COVERAGE-TYPE        PIC X.
  4005                 88  CF-REDUCING                VALUE 'R'.
  4006                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4007
  4008             20  CF-SPECIAL-CALC-CD         PIC X.
  4009                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4010                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4011                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4012                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4013                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4014                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4015                 88  CF-FARM-PLAN               VALUE 'F'.
  4016                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  76
* EL6501.cbl
  4017                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4018                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4019                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4020                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4021                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4022                 88  CF-PRUDENTIAL              VALUE 'P'.
  4023                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4024                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4025                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4026                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4027                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4028                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4029
  4030             20  CF-JOINT-INDICATOR         PIC X.
  4031                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4032
  4033*            20  FILLER                     PIC X(12).
  4034             20  FILLER                     PIC X(11).
  4035             20  CF-BENEFIT-CATEGORY        PIC X.
  4036             20  CF-LOAN-TYPE               PIC X(8).
  4037
  4038             20  CF-CO-REM-TERM-CALC        PIC X.
  4039                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4040                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4041                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4042                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4043                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4044
  4045             20  CF-CO-EARNINGS-CALC        PIC X.
  4046                 88  CO-EARN-BY-R78             VALUE '1'.
  4047                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4048                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4049                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4050                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4051                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4052                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4053                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4054
  4055             20  CF-CO-REFUND-CALC          PIC X.
  4056                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4057                 88  CO-REFD-BY-R78             VALUE '1'.
  4058                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4059                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4060                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4061                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4062                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4063                 88  CO-REFD-MEAN               VALUE '8'.
  4064                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4065                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4066                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4067
  4068             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4069                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4070                 88  CO-OVRD-BY-R78             VALUE '1'.
  4071                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4072                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4073                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4074                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  77
* EL6501.cbl
  4075                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4076                 88  CO-OVRD-MEAN               VALUE '8'.
  4077                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4078
  4079             20  CF-CO-BEN-I-G-CD           PIC X.
  4080                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4081                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4082                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4083
  4084         16  FILLER                         PIC X(304).
  4085
  4086
  4087****************************************************************
  4088*             CARRIER MASTER RECORD                            *
  4089****************************************************************
  4090
  4091     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4092         16  CF-ADDRESS-DATA.
  4093             20  CF-MAIL-TO-NAME            PIC X(30).
  4094             20  CF-IN-CARE-OF              PIC X(30).
  4095             20  CF-ADDRESS-LINE-1          PIC X(30).
  4096             20  CF-ADDRESS-LINE-2          PIC X(30).
  4097             20  CF-CITY-STATE              PIC X(30).
  4098             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4099             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4100
  4101         16  CF-CLAIM-NO-CONTROL.
  4102             20  CF-CLAIM-NO-METHOD         PIC X.
  4103                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4104                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4105                 88  CLAIM-NO-SEQ               VALUE '3'.
  4106                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4107             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4108                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4109                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4110                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4111
  4112         16  CF-CHECK-NO-CONTROL.
  4113             20  CF-CHECK-NO-METHOD         PIC X.
  4114                 88  CHECK-NO-MANUAL            VALUE '1'.
  4115                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4116                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4117                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4118             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4119                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4120
  4121         16  CF-DOMICILE-STATE              PIC XX.
  4122
  4123         16  CF-EXPENSE-CONTROLS.
  4124             20  CF-EXPENSE-METHOD          PIC X.
  4125                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4126                 88  DOLLARS-PER-PMT            VALUE '2'.
  4127                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4128                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4129             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4130             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4131
  4132         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  78
* EL6501.cbl
  4133             20  CF-LETTER-RESEND-OPT       PIC X.
  4134                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4135                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4136             20  FILLER                     PIC X(4).
  4137
  4138         16  CF-RESERVE-CONTROLS.
  4139             20  CF-MANUAL-SW               PIC X.
  4140                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4141             20  CF-FUTURE-SW               PIC X.
  4142                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4143             20  CF-PTC-SW                  PIC X.
  4144                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4145             20  CF-IBNR-SW                 PIC X.
  4146                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4147             20  CF-PTC-LF-SW               PIC X.
  4148                 88  CF-LF-PTC-USED             VALUE '1'.
  4149             20  CF-CDT-ACCESS-METHOD       PIC X.
  4150                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4151                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4152                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4153             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4154
  4155         16  CF-CLAIM-CALC-METHOD           PIC X.
  4156             88  360-PLUS-MONTHS                VALUE '1'.
  4157             88  365-PLUS-MONTHS                VALUE '2'.
  4158             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4159             88  360-DAILY                      VALUE '4'.
  4160             88  365-DAILY                      VALUE '5'.
  4161
  4162         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4163         16  FILLER                         PIC X(11).
  4164
  4165         16  CF-LIMIT-AMOUNTS.
  4166             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4167             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4168             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4169             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4170             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4171             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4172             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4173             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4174             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4175             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4176
  4177         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4178         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4179         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4180
  4181         16  CF-ZIP-CODE.
  4182             20  CF-ZIP-PRIME.
  4183                 24  CF-ZIP-1ST             PIC X.
  4184                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4185                 24  FILLER                 PIC X(4).
  4186             20  CF-ZIP-PLUS4               PIC X(4).
  4187         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4188             20  CF-CAN-POSTAL-1            PIC XXX.
  4189             20  CF-CAN-POSTAL-2            PIC XXX.
  4190             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  79
* EL6501.cbl
  4191
  4192         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4193         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4194         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4195
  4196         16  CF-RATING-SWITCH               PIC X.
  4197             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4198             88  CF-NO-RATING                   VALUE 'N'.
  4199
  4200         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4201
  4202         16  CF-CARRIER-OVER-SHORT.
  4203             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4204             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4205
  4206         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4207         16  CF-SECPAY-SWITCH               PIC X.
  4208             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4209             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4210         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4211         16  FILLER                         PIC X(448).
  4212*        16  FILLER                         PIC X(452).
  4213
  4214
  4215****************************************************************
  4216*             MORTALITY MASTER RECORD                          *
  4217****************************************************************
  4218
  4219     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4220         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4221                                INDEXED BY CF-MORT-NDX.
  4222             20  CF-MORT-TABLE              PIC X(5).
  4223             20  CF-MORT-TABLE-TYPE         PIC X.
  4224                 88  CF-MORT-JOINT              VALUE 'J'.
  4225                 88  CF-MORT-SINGLE             VALUE 'S'.
  4226                 88  CF-MORT-COMBINED           VALUE 'C'.
  4227                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4228                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4229             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4230             20  CF-MORT-AGE-METHOD         PIC XX.
  4231                 88  CF-AGE-LAST                VALUE 'AL'.
  4232                 88  CF-AGE-NEAR                VALUE 'AN'.
  4233             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4234             20  CF-MORT-ADJUSTMENT-DIRECTION
  4235                                            PIC X.
  4236                 88  CF-MINUS                   VALUE '-'.
  4237                 88  CF-PLUS                    VALUE '+'.
  4238             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4239             20  CF-MORT-JOINT-CODE         PIC X.
  4240                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4241             20  CF-MORT-PC-Q               PIC X.
  4242                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4243             20  CF-MORT-TABLE-CODE         PIC X(4).
  4244             20  CF-MORT-COMMENTS           PIC X(15).
  4245             20  FILLER                     PIC X(14).
  4246
  4247         16  FILLER                         PIC X(251).
  4248
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  80
* EL6501.cbl
  4249
  4250****************************************************************
  4251*             BUSSINESS TYPE MASTER RECORD                     *
  4252****************************************************************
  4253
  4254     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4255* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4256* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4257* AND RECORD 05 IS TYPES 81-99
  4258         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4259             20  CF-BUSINESS-TITLE          PIC  X(19).
  4260             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4261                                            PIC S9V9(4) COMP-3.
  4262             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4263             20  FILLER                     PIC  X.
  4264         16  FILLER                         PIC  X(248).
  4265
  4266
  4267****************************************************************
  4268*             TERMINAL MASTER RECORD                           *
  4269****************************************************************
  4270
  4271     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4272
  4273         16  CF-COMPANY-TERMINALS.
  4274             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4275                                  PIC X(4).
  4276         16  FILLER               PIC X(248).
  4277
  4278
  4279****************************************************************
  4280*             LIFE EDIT MASTER RECORD                          *
  4281****************************************************************
  4282
  4283     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4284         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4285             20  CF-LIFE-CODE-IN            PIC XX.
  4286             20  CF-LIFE-CODE-OUT           PIC XX.
  4287         16  FILLER                         PIC X(248).
  4288
  4289
  4290****************************************************************
  4291*             AH EDIT MASTER RECORD                            *
  4292****************************************************************
  4293
  4294     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4295         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4296             20  CF-AH-CODE-IN              PIC XXX.
  4297             20  CF-AH-CODE-OUT             PIC XX.
  4298         16  FILLER                         PIC X(248).
  4299
  4300
  4301****************************************************************
  4302*             CREDIBILITY TABLES                               *
  4303****************************************************************
  4304
  4305     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4306         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  81
* EL6501.cbl
  4307                             INDEXED BY CF-CRDB-NDX.
  4308             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4309             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4310             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4311         16  FILLER                         PIC  X(332).
  4312
  4313
  4314****************************************************************
  4315*             REPORT CUSTOMIZATION RECORD                      *
  4316****************************************************************
  4317
  4318     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4319         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4320             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4321             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4322             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4323**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4324****       A T-TRANSFER.                                   ****
  4325             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4326
  4327         16  FILLER                         PIC XX.
  4328
  4329         16  CF-CARRIER-CNTL-OPT.
  4330             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4331                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4332                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4333             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4334                                            PIC X.
  4335         16  CF-GROUP-CNTL-OPT.
  4336             20  CF-GROUP-OPT-SEQ           PIC 9.
  4337                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4338                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4339             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4340                                            PIC X(6).
  4341         16  CF-STATE-CNTL-OPT.
  4342             20  CF-STATE-OPT-SEQ           PIC 9.
  4343                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4344                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4345             20  CF-STATE-SELECT OCCURS 3 TIMES
  4346                                            PIC XX.
  4347         16  CF-ACCOUNT-CNTL-OPT.
  4348             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4349                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4350                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4351             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4352                                            PIC X(10).
  4353         16  CF-BUS-TYP-CNTL-OPT.
  4354             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4355                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4356                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4357             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4358                                            PIC XX.
  4359         16  CF-LF-TYP-CNTL-OPT.
  4360             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4361                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4362                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4363             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4364                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  82
* EL6501.cbl
  4365         16  CF-AH-TYP-CNTL-OPT.
  4366             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4367                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4368                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4369             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4370                                            PIC XX.
  4371         16  CF-REPTCD1-CNTL-OPT.
  4372             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4373                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4374                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4375             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4376                                            PIC X(10).
  4377         16  CF-REPTCD2-CNTL-OPT.
  4378             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4379                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4380                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4381             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4382                                            PIC X(10).
  4383         16  CF-USER1-CNTL-OPT.
  4384             20  CF-USER1-OPT-SEQ           PIC 9.
  4385                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4386                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4387             20  CF-USER1-SELECT OCCURS 3 TIMES
  4388                                            PIC X(10).
  4389         16  CF-USER2-CNTL-OPT.
  4390             20  CF-USER2-OPT-SEQ           PIC 9.
  4391                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4392                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4393             20  CF-USER2-SELECT OCCURS 3 TIMES
  4394                                            PIC X(10).
  4395         16  CF-USER3-CNTL-OPT.
  4396             20  CF-USER3-OPT-SEQ           PIC 9.
  4397                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4398                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4399             20  CF-USER3-SELECT OCCURS 3 TIMES
  4400                                            PIC X(10).
  4401         16  CF-USER4-CNTL-OPT.
  4402             20  CF-USER4-OPT-SEQ           PIC 9.
  4403                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4404                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4405             20  CF-USER4-SELECT OCCURS 3 TIMES
  4406                                            PIC X(10).
  4407         16  CF-USER5-CNTL-OPT.
  4408             20  CF-USER5-OPT-SEQ           PIC 9.
  4409                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4410                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4411             20  CF-USER5-SELECT OCCURS 3 TIMES
  4412                                            PIC X(10).
  4413         16  CF-REINS-CNTL-OPT.
  4414             20  CF-REINS-OPT-SEQ           PIC 9.
  4415                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4416                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4417             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4418                 24  CF-REINS-PRIME         PIC XXX.
  4419                 24  CF-REINS-SUB           PIC XXX.
  4420
  4421         16  CF-AGENT-CNTL-OPT.
  4422             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  83
* EL6501.cbl
  4423                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4424                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4425             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4426                                            PIC X(10).
  4427
  4428         16  FILLER                         PIC X(43).
  4429
  4430         16  CF-LOSS-RATIO-SELECT.
  4431             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4432             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4433         16  CF-ENTRY-DATE-SELECT.
  4434             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4435             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4436         16  CF-EFFECTIVE-DATE-SELECT.
  4437             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4438             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4439
  4440         16  CF-EXCEPTION-LIST-IND          PIC X.
  4441             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4442
  4443         16  FILLER                         PIC X(318).
  4444
  4445****************************************************************
  4446*                  EXCEPTION REPORTING RECORD                  *
  4447****************************************************************
  4448
  4449     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4450         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4451             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4452
  4453         16  CF-COMBINED-LIFE-AH-OPT.
  4454             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4455             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4456             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4457             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4458
  4459         16  CF-LIFE-OPT.
  4460             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4461             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4462             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4463             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4464             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4465             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4466             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4467             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4468             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4469             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4470
  4471         16  CF-AH-OPT.
  4472             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4473             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4474             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4475             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4476             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4477             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4478             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4479             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4480             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  84
* EL6501.cbl
  4481             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4482
  4483         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4484             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4485             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4486             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4487
  4488         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4489
  4490         16  FILLER                         PIC X(673).
  4491
  4492
  4493****************************************************************
  4494*             MORTGAGE SYSTEM PLAN RECORD                      *
  4495****************************************************************
  4496
  4497     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4498         16  CF-PLAN-TYPE                   PIC X.
  4499             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4500             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4501             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4502         16  CF-PLAN-ABBREV                 PIC XXX.
  4503         16  CF-PLAN-DESCRIPT               PIC X(10).
  4504         16  CF-PLAN-NOTES                  PIC X(20).
  4505         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4506         16  CF-PLAN-UNDERWRITING.
  4507             20  CF-PLAN-TERM-DATA.
  4508                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4509                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4510             20  CF-PLAN-AGE-DATA.
  4511                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4512                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4513                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4514             20  CF-PLAN-BENEFIT-DATA.
  4515                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4516                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4517                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4518                                            PIC S9(7)V99  COMP-3.
  4519         16  CF-PLAN-POLICY-FORMS.
  4520             20  CF-POLICY-FORM             PIC X(12).
  4521             20  CF-MASTER-APPLICATION      PIC X(12).
  4522             20  CF-MASTER-POLICY           PIC X(12).
  4523         16  CF-PLAN-RATING.
  4524             20  CF-RATE-CODE               PIC X(5).
  4525             20  CF-SEX-RATING              PIC X.
  4526                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4527                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4528             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4529             20  CF-SUB-STD-TYPE            PIC X.
  4530                 88  CF-PCT-OF-PREM            VALUE '1'.
  4531                 88  CF-PCT-OF-BENE            VALUE '2'.
  4532         16  CF-PLAN-PREM-TOLERANCES.
  4533             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4534             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4535         16  CF-PLAN-PYMT-TOLERANCES.
  4536             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4537             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4538         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  85
* EL6501.cbl
  4539             20  FILLER                     PIC X.
  4540             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4541             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4542         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4543         16  CF-PLAN-IND-GRP                PIC X.
  4544             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4545                                                     '1'.
  4546             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4547                                                     '2'.
  4548         16  CF-MIB-SEARCH-SW               PIC X.
  4549             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4550             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4551             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4552             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4553         16  CF-ALPHA-SEARCH-SW             PIC X.
  4554             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4555             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4556             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4557             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4558             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4559             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4560             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4561             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4562             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4563             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4564                                                     'A' 'B' 'C'
  4565                                                     'X' 'Y' 'Z'.
  4566         16  CF-EFF-DT-RULE-SW              PIC X.
  4567             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4568             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4569             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4570             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4571             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4572         16  FILLER                         PIC X(4).
  4573         16  CF-HEALTH-QUESTIONS            PIC X.
  4574             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4575         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4576         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4577         16  CF-PLAN-SNGL-JNT               PIC X.
  4578             88  CF-COMBINED-PLAN              VALUE 'C'.
  4579             88  CF-JNT-PLAN                   VALUE 'J'.
  4580             88  CF-SNGL-PLAN                  VALUE 'S'.
  4581         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4582         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4583         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4584         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4585         16  CF-RERATE-CNTL                 PIC  X.
  4586             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4587             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4588             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4589             88  CF-AUTO-RECALC                 VALUE '4'.
  4590         16  CF-BENEFIT-TYPE                PIC  X.
  4591             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4592             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4593         16  CF-POLICY-FEE                  PIC S999V99
  4594                                                    COMP-3.
  4595         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4596         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  86
* EL6501.cbl
  4597         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4598         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4599         16  FILLER                         PIC  X(32).
  4600         16  CF-TERMINATION-FORM            PIC  X(04).
  4601         16  FILLER                         PIC  X(08).
  4602         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4603                                                       COMP-3.
  4604         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4605         16  CF-ISSUE-LETTER                PIC  X(4).
  4606         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4607         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4608             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4609             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4610         16  CF-MP-REFUND-CALC              PIC X.
  4611             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4612             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4613             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4614             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4615             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4616             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4617             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4618             88  CF-MP-REFD-MEAN                VALUE '8'.
  4619         16  CF-ALT-RATE-CODE               PIC  X(5).
  4620
  4621
  4622         16  FILLER                         PIC X(498).
  4623****************************************************************
  4624*             MORTGAGE COMPANY MASTER RECORD                   *
  4625****************************************************************
  4626
  4627     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4628         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4629         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4630             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4631             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4632             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4633             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4634             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4635
  4636         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4637         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4638         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4639         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4640         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4641
  4642         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4643             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4644         16  CF-MP-RECON-USE-IND            PIC X(1).
  4645             88  CF-MP-USE-RECON             VALUE 'Y'.
  4646         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4647             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4648         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4649             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4650             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4651         16  FILLER                         PIC X(1).
  4652         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4653             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4654         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  87
* EL6501.cbl
  4655             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4656             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4657             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4658         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4659             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4660                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4661             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4662                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4663             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4664                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4665             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4666                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4667             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4668                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4669             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4670                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4671         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4672         16  FILLER                         PIC X(7).
  4673         16  CF-MORTG-DESTINATION-SYMBOL.
  4674             20  CF-MORTG-MIB-COMM          PIC X(5).
  4675             20  CF-MORTG-MIB-TERM          PIC X(5).
  4676         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4677             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4678         16  FILLER                         PIC X(03).
  4679         16  CF-MP-CHECK-NO-CONTROL.
  4680             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4681                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4682                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4683                                                ' ' LOW-VALUES.
  4684                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4685                                               VALUE '3'.
  4686         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4687         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4688         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4689             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4690                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4691             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4692                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4693             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4694                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4695             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4696                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4697             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4698                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4699             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4700                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4701         16  CF-MORTG-BILLING-AREA.
  4702             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4703                                            PIC X.
  4704         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4705         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4706         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4707         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4708             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4709             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4710         16  FILLER                         PIC X.
  4711         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4712             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  88
* EL6501.cbl
  4713             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4714         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4715         16  FILLER                         PIC X(8).
  4716         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4717         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4718         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4719         16  CF-ACH-COMPANY-ID.
  4720             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4721                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4722                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4723                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4724             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4725         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4726             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4727         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4728             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4729             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4730         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4731         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4732         16  FILLER                         PIC X(536).
  4733
  4734****************************************************************
  4735*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4736****************************************************************
  4737
  4738     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4739         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4740             20  CF-FEMALE-HEIGHT.
  4741                 24  CF-FEMALE-FT           PIC 99.
  4742                 24  CF-FEMALE-IN           PIC 99.
  4743             20  CF-FEMALE-MIN-WT           PIC 999.
  4744             20  CF-FEMALE-MAX-WT           PIC 999.
  4745         16  FILLER                         PIC X(428).
  4746
  4747     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4748         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4749             20  CF-MALE-HEIGHT.
  4750                 24  CF-MALE-FT             PIC 99.
  4751                 24  CF-MALE-IN             PIC 99.
  4752             20  CF-MALE-MIN-WT             PIC 999.
  4753             20  CF-MALE-MAX-WT             PIC 999.
  4754         16  FILLER                         PIC X(428).
  4755******************************************************************
  4756*             AUTOMATIC ACTIVITY RECORD                          *
  4757******************************************************************
  4758     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4759         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4760             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4761             20  CF-SYS-LETTER-ID           PIC X(04).
  4762             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4763             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4764             20  CF-SYS-RESET-SW            PIC X(01).
  4765             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4766             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4767
  4768         16  FILLER                         PIC X(50).
  4769
  4770         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  89
* EL6501.cbl
  4771             20  CF-USER-ACTIVE-SW          PIC X(01).
  4772             20  CF-USER-LETTER-ID          PIC X(04).
  4773             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4774             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4775             20  CF-USER-RESET-SW           PIC X(01).
  4776             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4777             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4778             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4779
  4780         16  FILLER                         PIC X(246).
  4781*    COPY ERCREIN.
  4782******************************************************************
  4783*                                                                *
  4784*                            ERCREIN                             *
  4785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4786*                            VMOD=2.010                          *
  4787*                                                                *
  4788*   ONLINE CREDIT SYSTEM                                         *
  4789*                                                                *
  4790*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4791*                                                                *
  4792*   FILE TYPE = VSAM,KSDS                                        *
  4793*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4794*                                                                *
  4795*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4796*       ALTERNATE PATH = NONE                                    *
  4797*                                                                *
  4798*   LOG = NO                                                     *
  4799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4800*                                                                *
  4801******************************************************************
  4802*                   C H A N G E   L O G
  4803*
  4804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4805*-----------------------------------------------------------------
  4806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4807* EFFECTIVE    NUMBER
  4808*-----------------------------------------------------------------
  4809* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4810* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4811******************************************************************
  4812 01  REINSURANCE-RECORD.
  4813     12  RE-RECORD-ID                      PIC XX.
  4814         88  VALID-RE-ID                      VALUE 'RE'.
  4815
  4816     12  RE-CONTROL-PRIMARY.
  4817         16  RE-COMPANY-CD                 PIC X.
  4818         16  RE-KEY.
  4819             20  RE-CODE                   PIC X.
  4820                 88  RE-TABLE-RECORD          VALUE 'A'.
  4821                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4822             20  RE-TABLE                  PIC XXX.
  4823             20  FILLER                    PIC XXX.
  4824         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4825             20  FILLER                    PIC X.
  4826             20  RE-COMPANY.
  4827                 24  RE-COMP-PRIME         PIC XXX.
  4828                 24  RE-COMP-SUB           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  90
* EL6501.cbl
  4829
  4830     12  RE-MAINT-INFORMATION.
  4831         16  RE-LAST-MAINT-DT              PIC XX.
  4832         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4833         16  RE-LAST-MAINT-USER            PIC X(4).
  4834         16  FILLER                        PIC X(10).
  4835
  4836     12  RE-TABLE-DATA.
  4837         16  RE-100-COMP                   PIC 99.
  4838
  4839         16  RE-COMP-INFO    OCCURS 30 TIMES.
  4840             20  RE-REI-COMP-NO.
  4841                 24  RE-REI-COMP           PIC XXX.
  4842                 24  RE-REI-COMP-SUB       PIC XXX.
  4843             20  RE-LF-QC                  PIC X.
  4844             20  RE-AH-QC                  PIC X.
  4845             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  4846             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  4847             20  RE-LFAGE-LO               PIC 99.
  4848             20  RE-LFAGE-HI               PIC 99.
  4849             20  RE-AHAGE-LO               PIC 99.
  4850             20  RE-AHAGE-HI               PIC 99.
  4851             20  RE-LFTRM-LO               PIC S999       COMP-3.
  4852             20  RE-LFTRM-HI               PIC S999       COMP-3.
  4853             20  RE-AHTRM-LO               PIC S999       COMP-3.
  4854             20  RE-AHTRM-HI               PIC S999       COMP-3.
  4855             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  4856             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  4857             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  4858             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  4859             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  4860             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  4861             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  4862             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  4863             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  4864             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  4865             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  4866             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  4867             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  4868             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  4869             20  RE-LF-BEN-CODE            PIC X.
  4870             20  RE-AH-BEN-CODE            PIC X.
  4871             20  RE-INTERACTIVE            PIC X.
  4872             20  RE-REMAINING              PIC X.
  4873             20  RE-LF-RUNOFF-SW           PIC X.
  4874             20  RE-AH-RUNOFF-SW           PIC X.
  4875             20  FILLER                    PIC X(19).
  4876
  4877         16  RE-COMP-INFO-END              PIC X(6).
  4878         16  RE-NSP-ST-CD-LF               PIC XX.
  4879         16  RE-NSP-ST-CD-AH               PIC XX.
  4880         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  4881             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  4882
  4883         16  FILLER                        PIC X(27).
  4884
  4885     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  4886         16  RE-NAME                       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  91
* EL6501.cbl
  4887         16  RE-LF-PE                      PIC X.
  4888         16  RE-AH-PE                      PIC X.
  4889         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  4890         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  4891         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  4892         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  4893         16  RE-PRT-ST                     PIC X.
  4894         16  RE-PRT-OW                     PIC X.
  4895         16  RE-MORT-CODE                  PIC X(4).
  4896         16  RE-CLAIM-CODE                 PIC X.
  4897         16  RE-ZERO-LF-FEE                PIC X.
  4898         16  RE-ZERO-AH-FEE                PIC X.
  4899         16  RE-CEDE-NAME                  PIC X(30).
  4900         16  RE-LF-COMM                    PIC X.
  4901         16  RE-AH-COMM                    PIC X.
  4902         16  RE-LF-TAX                     PIC X.
  4903         16  RE-AH-TAX                     PIC X.
  4904         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  4905         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  4906         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  4907
  4908         16  RE-COMP-CARRIER-SECURITY      PIC X.
  4909             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  4910
  4911         16  RE-LF-CEDING-FEE-BRACKETS.
  4912             20  RE-LF-FEE-METHOD          PIC X.
  4913                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  4914                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  4915                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  4916                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  4917             20  RE-LF-FEE-BASIS           PIC X.
  4918                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  4919                 88  RE-LF-NET-CEDED               VALUE '2'.
  4920                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  4921                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  4922                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  4923                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  4924                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  4925                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  4926             20  FILLER                    PIC XXX.
  4927             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  4928                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  4929                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  4930
  4931         16  RE-AH-CEDING-FEE-BRACKETS.
  4932             20  RE-AH-FEE-METHOD          PIC X.
  4933                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  4934                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  4935                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  4936                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  4937             20  RE-AH-FEE-BASIS           PIC X.
  4938                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  4939                 88  RE-AH-NET-CEDED               VALUE '2'.
  4940                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  4941                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  4942                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  4943                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  4944                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  92
* EL6501.cbl
  4945                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  4946             20  FILLER                    PIC XXX.
  4947             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  4948                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  4949                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  4950
  4951         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  4952
  4953         16  RE-OLD-CEDING-STMT            PIC X.
  4954
  4955         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  4956         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  4957         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  4958         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  4959         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  4960         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  4961         16  RE-REINS-GROUPING-CODE        PIC X(6).
  4962         16  RE-MORT-SW                    PIC X.
  4963         16  RE-CEDING-TYPE-FLAG           PIC X.
  4964             88  RE-NO-CESSION-TYPE                VALUE ' '.
  4965             88  RE-CEDED                          VALUE 'C'.
  4966             88  RE-ASSUMED                        VALUE 'A'.
  4967             88  RE-PHANTOM                        VALUE 'P'.
  4968
  4969         16  RE-CEDING-STMT-OPT-A          PIC X.
  4970             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  4971         16  RE-CEDING-STMT-OPT-B          PIC X.
  4972             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  4973         16  RE-CEDING-STMT-OPT-C          PIC X.
  4974             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  4975         16  RE-CEDING-STMT-OPT-D          PIC X.
  4976             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  4977         16  RE-CEDING-STMT-OPT-E          PIC X.
  4978             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  4979
  4980         16  RE-PRT-CRSV                   PIC X.
  4981
  4982         16  RE-GL-CENTER                  PIC X(4).
  4983
  4984         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  4985
  4986         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  4987
  4988         16  RE-EARN-STOP-CODE             PIC X.
  4989             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  4990             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  4991
  4992         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  4993             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  4994
  4995         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  4996         16  FILLER                        PIC X(2281).
  4997
  4998         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  4999
  5000******************************************************************
  5001*    COPY ERCCTBL.
  5002******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  93
* EL6501.cbl
  5003*                                                                *
  5004*                                                                *
  5005*                            ERCCTBL                             *
  5006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5007*                            VMOD=2.003
  5008*                                                                *
  5009*   ONLINE CREDIT SYSTEM                                         *
  5010*                                                                *
  5011*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5012*                                                                *
  5013*   FILE TYPE = VSAM,KSDS                                        *
  5014*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5015*                                                                *
  5016*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5017*       ALTERNATE PATH = NONE                                    *
  5018*                                                                *
  5019*   LOG = NO                                                     *
  5020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5021*                                                                *
  5022*                                                                *
  5023******************************************************************
  5024
  5025 01  COMM-TABLE-RECORD.
  5026     12  CT-RECORD-ID                      PIC XX.
  5027         88  VALID-CT-ID                      VALUE 'CT'.
  5028
  5029     12  CT-CONTROL-PRIMARY.
  5030         16  CT-COMPANY-CD                 PIC X.
  5031         16  CT-TABLE                      PIC XXX.
  5032         16  CT-CNTRL-2.
  5033             20  CT-BEN-TYPE               PIC X.
  5034             20  CT-BEN-CODE               PIC XX.
  5035
  5036     12  CT-MAINT-INFORMATION.
  5037         16  CT-LAST-MAINT-DT              PIC XX.
  5038         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5039         16  CT-LAST-MAINT-USER            PIC X(4).
  5040         16  FILLER                        PIC X(31).
  5041
  5042     12  CT-LIMITS.
  5043         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5044
  5045         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5046
  5047         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5048
  5049     12  CT-RATES.
  5050         16  CT-RTX          OCCURS 27 TIMES.
  5051             20  CT-RT                     PIC SV9(5)     COMP-3.
  5052             20  CT-RT-R   REDEFINES
  5053                 CT-RT                     PIC XXX.
  5054
  5055     12  FILLER                            PIC  X(42).
  5056
  5057******************************************************************
  5058*                                COPY ERCACNT.
  5059******************************************************************
  5060*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  94
* EL6501.cbl
  5061*                                                                *
  5062*                            ERCACNT.                            *
  5063*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5064*                            VMOD=2.002                          *
  5065*                                                                *
  5066*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5067*                                                                *
  5068*   FILE TYPE = VSAM,KSDS                                        *
  5069*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5070*                                                                *
  5071*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5072*       ALTERNATE INDEX = NONE                                   *
  5073*                                                                *
  5074*                                                                *
  5075*   LOG = YES                                                    *
  5076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5077******************************************************************
  5078*                   C H A N G E   L O G
  5079*
  5080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5081*-----------------------------------------------------------------
  5082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5083* EFFECTIVE    NUMBER
  5084*-----------------------------------------------------------------
  5085* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5086*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5087******************************************************************
  5088 01  NOTE-FILE.
  5089     12  NT-FILE-ID                  PIC XX.
  5090         88  VALID-NOTE-ID              VALUE 'NT'.
  5091
  5092     12  NT-CONTROL-PRIMARY.
  5093         16  NT-COMPANY-CD           PIC X.
  5094         16  NT-ACCT-NOTE-KEY.
  5095             18  NT-CARRIER              PIC X.
  5096             18  NT-GROUPING             PIC X(06).
  5097             18  NT-STATE                PIC XX.
  5098             18  NT-ACCOUNT              PIC X(10).
  5099         16  NT-RECORD-TYPE          PIC X.
  5100              88  ACCT-NOTE          VALUE '1'.
  5101              88  ACCT-BRANCH-LOC    VALUE '2'.
  5102              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5103         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5104
  5105     12  NT-LAST-MAINT-DT            PIC XX.
  5106     12  NT-LAST-MAINT-BY            PIC X(4).
  5107     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5108
  5109*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5110*     SEQUENCE NUMBERS
  5111     12  NT-NOTE-INFORMATION.
  5112         16  NT-NOTE-LINE            PIC X(60).
  5113         16  FILLER                  PIC X(25).
  5114*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5115     12  NT-LOCATION-INFORMATION REDEFINES
  5116                         NT-NOTE-INFORMATION.
  5117         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5118         16  FILLER                  PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  95
* EL6501.cbl
  5119*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5120*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5121*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5122*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5123*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5124*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5125*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5126     12  NT-SHIPPING-INFORMATION REDEFINES
  5127                         NT-NOTE-INFORMATION.
  5128         16  NT-SHIPPING-LINE        PIC X(60).
  5129         16  NT-SHIP-STATE           PIC XX.
  5130         16  NT-SHIP-ZIP             PIC X(10).
  5131         16  FILLER                  PIC X(13).
  5132*****************************************************************
  5133
  5134 01  COMMISSION-WORK-AREA.
  5135     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5136         10  WK-AM-AGT           PIC X(10).
  5137         10  WK-AM-TYPE          PIC X.
  5138         10  WK-FILLER           PIC X(13).
  5139         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  96
* EL6501.cbl
  5141*    COPY ERCCOMP.
  5142******************************************************************
  5143*                                                                *
  5144*                                                                *
  5145*                            ERCCOMP                             *
  5146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5147*                            VMOD=2.019                          *
  5148*                                                                *
  5149*   ONLINE CREDIT SYSTEM                                         *
  5150*                                                                *
  5151*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5152*                                                                *
  5153*   FILE TYPE = VSAM,KSDS                                        *
  5154*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5155*                                                                *
  5156*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5157*       ALTERNATE PATH = NONE                                    *
  5158*                                                                *
  5159*   LOG = NO                                                     *
  5160*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5161*                                                                *
  5162******************************************************************
  5163*                   C H A N G E   L O G
  5164*
  5165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5166*-----------------------------------------------------------------
  5167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5168* EFFECTIVE    NUMBER
  5169*-----------------------------------------------------------------
  5170* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5171* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5172* 092205    2005050300006  PEMA  ADD LEASE FEE
  5173* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5174* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5175* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5176* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5177* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5178******************************************************************
  5179
  5180 01  COMPENSATION-MASTER.
  5181     12  CO-RECORD-ID                          PIC XX.
  5182         88  VALID-CO-ID                          VALUE 'CO'.
  5183
  5184     12  CO-CONTROL-PRIMARY.
  5185         16  CO-COMPANY-CD                     PIC X.
  5186         16  CO-CONTROL.
  5187             20  CO-CTL-1.
  5188                 24  CO-CARR-GROUP.
  5189                     28  CO-CARRIER            PIC X.
  5190                     28  CO-GROUPING.
  5191                         32  CO-GROUP-PREFIX   PIC XXX.
  5192                         32  CO-GROUP-PRIME    PIC XXX.
  5193                 24  CO-RESP-NO.
  5194                     28  CO-RESP-PREFIX        PIC X(4).
  5195                     28  CO-RESP-PRIME         PIC X(6).
  5196             20  CO-CTL-2.
  5197                 24  CO-ACCOUNT.
  5198                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  97
* EL6501.cbl
  5199                     28  CO-ACCT-PRIME         PIC X(6).
  5200         16  CO-TYPE                           PIC X.
  5201             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5202             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5203             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5204
  5205     12  CO-MAINT-INFORMATION.
  5206         16  CO-LAST-MAINT-DT                  PIC XX.
  5207         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5208         16  CO-LAST-MAINT-USER                PIC X(4).
  5209     12  FILLER                                PIC XX.
  5210     12  CO-STMT-TYPE                          PIC XXX.
  5211     12  CO-COMP-TYPE                          PIC X.
  5212         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5213     12  CO-STMT-OWNER                         PIC X(4).
  5214     12  CO-BALANCE-CONTROL                    PIC X.
  5215         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5216         88  CO-NO-BALANCE                        VALUE 'N'.
  5217
  5218     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5219         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5220         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5221         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5222
  5223     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5224         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5225         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5226
  5227     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5228     12  CO-GA-DIRECT-DEP                      PIC X.
  5229     12  CO-FUTURE-SPACE                       PIC X.
  5230         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5231
  5232     12  CO-ACCT-NAME                          PIC X(30).
  5233     12  CO-MAIL-NAME                          PIC X(30).
  5234     12  CO-ADDR-1                             PIC X(30).
  5235     12  CO-ADDR-2                             PIC X(30).
  5236     12  CO-ADDR-3.
  5237         16  CO-ADDR-CITY                      PIC X(27).
  5238         16  CO-ADDR-STATE                     PIC XX.
  5239     12  CO-CSO-1099                           PIC X.
  5240     12  CO-ZIP.
  5241         16  CO-ZIP-PRIME.
  5242             20  CO-ZIP-PRI-1ST                PIC X.
  5243                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5244             20  FILLER                        PIC X(4).
  5245         16  CO-ZIP-PLUS4                      PIC X(4).
  5246     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5247         16  CO-CAN-POSTAL-1                   PIC XXX.
  5248         16  CO-CAN-POSTAL-2                   PIC XXX.
  5249         16  FILLER                            PIC XXX.
  5250     12  CO-SOC-SEC                            PIC X(13).
  5251     12  CO-TELEPHONE.
  5252         16  CO-AREA-CODE                      PIC XXX.
  5253         16  CO-PREFIX                         PIC XXX.
  5254         16  CO-PHONE                          PIC X(4).
  5255
  5256     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  98
* EL6501.cbl
  5257
  5258     12  CO-AR-BAL-LEVEL                       PIC X.
  5259         88  CO-AR-REF-LVL                        VALUE '1'.
  5260         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5261         88  CO-AR-BILL-LVL                       VALUE '2'.
  5262         88  CO-AR-AGT-LVL                        VALUE '3'.
  5263         88  CO-AR-FR-LVL                         VALUE '4'.
  5264
  5265     12  CO-AR-NORMAL-PRINT                    PIC X.
  5266         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5267         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5268
  5269     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5270
  5271     12  CO-AR-REPORTING                       PIC X.
  5272         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5273         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5274
  5275     12  CO-AR-PULL-CHECK                      PIC X.
  5276         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5277         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5278
  5279     12  CO-AR-BALANCE-PRINT                   PIC X.
  5280         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5281
  5282     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5283         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5284         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5285         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5286
  5287     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5288
  5289     12  CO-USER-CODE                          PIC X.
  5290     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5291
  5292******************************************************************
  5293*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5294*    THE LAST MONTH END RUN.
  5295******************************************************************
  5296
  5297     12  CO-LAST-ACTIVITY-DATE.
  5298         16  CO-ACT-YEAR                       PIC 99.
  5299         16  CO-ACT-MONTH                      PIC 99.
  5300         16  CO-ACT-DAY                        PIC 99.
  5301
  5302     12  CO-LAST-STMT-DT.
  5303         16  CO-LAST-STMT-YEAR                 PIC 99.
  5304         16  CO-LAST-STMT-MONTH                PIC 99.
  5305         16  CO-LAST-STMT-DAY                  PIC 99.
  5306
  5307     12  CO-MO-END-TOTALS.
  5308         16  CO-MONTHLY-TOTALS.
  5309             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5310             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5311             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5312             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5313             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  5314
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  99
* EL6501.cbl
  5315         16  CO-AGING-TOTALS.
  5316             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5317             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5318             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5319             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5320
  5321         16  CO-YTD-TOTALS.
  5322             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5323             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5324
  5325         16  CO-OVER-UNDER-TOTALS.
  5326             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5327             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5328
  5329     12  CO-MISCELLANEOUS-TOTALS.
  5330         16  CO-FICA-TOTALS.
  5331             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5332             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5333
  5334         16  CO-CLAIM-TOTALS.
  5335             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5336             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5337
  5338******************************************************************
  5339*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5340*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5341******************************************************************
  5342
  5343     12  CO-CURRENT-TOTALS.
  5344         16  CO-CURRENT-LAST-STMT-DT.
  5345             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5346             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5347             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5348
  5349         16  CO-CURRENT-MONTHLY-TOTALS.
  5350             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5351             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5352             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5353             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5354             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5355
  5356         16  CO-CURRENT-AGING-TOTALS.
  5357             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5358             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5359             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5360             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5361
  5362         16  CO-CURRENT-YTD-TOTALS.
  5363             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5364             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5365
  5366     12  CO-PAID-COMM-TOTALS.
  5367         16  CO-YTD-PAID-COMMS.
  5368             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5369             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5370
  5371     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  5372         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 100
* EL6501.cbl
  5373         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5374
  5375     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5376         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5377         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5378         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5379         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5380         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5381         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5382         88  CO-FINAL-LETTER                  VALUE 'F'.
  5383         88  CO-RECONCILING                   VALUE 'R'.
  5384         88  CO-PHONE-CALL                    VALUE 'P'.
  5385         88  CO-LEGAL                         VALUE 'L'.
  5386         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5387         88  CO-WRITE-OFF                     VALUE 'W'.
  5388         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5389
  5390     12  CO-CSR-CODE                       PIC X(4).
  5391
  5392     12  CO-GA-STATUS-INFO.
  5393         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5394         16  CO-GA-TERMINATION-DT          PIC XX.
  5395         16  CO-GA-STATUS-CODE             PIC X.
  5396             88  CO-GA-ACTIVE                 VALUE 'A'.
  5397             88  CO-GA-INACTIVE               VALUE 'I'.
  5398             88  CO-GA-PENDING                VALUE 'P'.
  5399         16  CO-GA-COMMENTS.
  5400             20  CO-GA-COMMENT-1           PIC X(40).
  5401             20  CO-GA-COMMENT-2           PIC X(40).
  5402             20  CO-GA-COMMENT-3           PIC X(40).
  5403             20  CO-GA-COMMENT-4           PIC X(40).
  5404
  5405     12  CO-RPTCD2                         PIC X(10).
  5406
  5407     12  CO-TYPE-AGENT                     PIC X(01).
  5408         88  CO-CORPORATION                   VALUE 'C'.
  5409         88  CO-PARTNERSHIP                   VALUE 'P'.
  5410         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5411         88  CO-TRUST                         VALUE 'T'.
  5412         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5413
  5414     12  CO-FAXNO.
  5415         16  CO-FAX-AREA-CODE                  PIC XXX.
  5416         16  CO-FAX-PREFIX                     PIC XXX.
  5417         16  CO-FAX-PHONE                      PIC X(4).
  5418
  5419     12  CO-BANK-INFORMATION.
  5420         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5421         16  CO-BANK-TRANSIT-NON REDEFINES
  5422             CO-BANK-TRANSIT-NO                PIC 9(8).
  5423
  5424         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5425     12  CO-MISC-DEDUCT-INFO REDEFINES
  5426                  CO-BANK-INFORMATION.
  5427         16  CO-MD-GL-ACCT                     PIC X(10).
  5428         16  CO-MD-DIV                         PIC XX.
  5429         16  CO-MD-CENTER                      PIC X(4).
  5430         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 101
* EL6501.cbl
  5431         16  CO-CREATE-AP-CHECK                PIC X.
  5432         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5433         16  FILLER                            PIC XXX.
  5434     12  CO-ACH-STATUS                         PIC X.
  5435         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5436         88  CO-ACH-PENDING                        VALUE 'P'.
  5437
  5438     12  CO-BILL-SW                            PIC X.
  5439     12  CO-CONTROL-NAME                       PIC X(30).
  5440     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5441     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5442     12  CO-CLP-STATE                          PIC XX.
  5443     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5444     12  CO-SPP-REFUND-EDIT                    PIC X.
  5445
  5446******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 102
* EL6501.cbl
  5448*    COPY ERCNAME.
  5449******************************************************************
  5450*                                                                *
  5451*                                                                *
  5452*                            ERCNAME                             *
  5453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5454*                            VMOD=2.003                          *
  5455*                                                                *
  5456*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5457*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5458*                                                                *
  5459*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5460*                                                                *
  5461*   FILE TYPE = VSAM,KSDS                                        *
  5462*   RECORD SIZE = 160   RECFORM = FIX                            *
  5463*                                                                *
  5464*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5465*                                                                *
  5466*   LOG = NO                                                     *
  5467*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5468*                                                                *
  5469*                                                                *
  5470******************************************************************
  5471
  5472 01  NAME-LOOKUP-MASTER.
  5473     12  NL-RECORD-ID                PIC  X(02).
  5474         88  VALID-NL-ID                         VALUE 'NL'.
  5475
  5476     12  NL-RECORD-KEY.
  5477         16  NL-CONTROL-PRIMARY.
  5478             20  NL-COMPANY-CD       PIC  X(01).
  5479             20  NL-NAME             PIC  X(30).
  5480             20  NL-RECORD-TYPE      PIC  X(01).
  5481                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5482                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5483                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5484
  5485         16  NL-ACCOUNT-MASTER.
  5486             20  NL-AM-COMPANY-CD    PIC  X(01).
  5487             20  NL-AM-CARRIER       PIC  X(01).
  5488             20  NL-AM-GROUPING      PIC  X(06).
  5489             20  NL-AM-STATE         PIC  X(02).
  5490             20  NL-AM-ACCOUNT       PIC  X(10).
  5491             20  FILLER              PIC  X(09).
  5492
  5493         16  NL-COMPENSATION-MASTER
  5494                                 REDEFINES  NL-ACCOUNT-MASTER.
  5495             20  NL-CO-COMPANY-CD    PIC  X(01).
  5496             20  NL-CO-CARRIER       PIC  X(01).
  5497             20  NL-CO-GROUPING      PIC  X(06).
  5498             20  NL-CO-RESP-NO       PIC  X(10).
  5499             20  NL-CO-ACCOUNT       PIC  X(10).
  5500             20  NL-CO-TYPE          PIC  X(01).
  5501
  5502         16  NL-REINSURANCE-RECORD
  5503                                 REDEFINES  NL-ACCOUNT-MASTER.
  5504             20  NL-RE-COMPANY-CD    PIC  X(01).
  5505             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 103
* EL6501.cbl
  5506             20  NL-RE-COMPANY.
  5507                 24  NL-RE-COMP      PIC  X(03).
  5508                 24  NL-RE-CO-SUB    PIC  X(03).
  5509             20  NL-RE-TABLE         PIC  X(03).
  5510             20  FILLER              PIC  X(18).
  5511
  5512     12  NL-MAINT-INFORMATION.
  5513         16  NL-LAST-MAINT-DT        PIC  X(02).
  5514         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5515         16  NL-LAST-MAINT-USER      PIC  X(04).
  5516         16  FILLER                  PIC  X(10).
  5517
  5518     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5519         16  NL-RE-LEVEL             PIC  9(02).
  5520
  5521     12  NL-CITY                     PIC  X(15).
  5522     12  NL-ST                       PIC  XX.
  5523
  5524******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 104
* EL6501.cbl
  5526*    COPY ERCRQST.
  5527******************************************************************
  5528*                                                                *
  5529*                                                                *
  5530*                            ERCRQST.                            *
  5531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5532*                            VMOD=2.002                          *
  5533*                                                                *
  5534*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5535*                                                                *
  5536*   FILE TYPE = VSAM,KSDS                                        *
  5537*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5538*                                                                *
  5539*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5540*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5541*                                   ACCOUNT, REF, BATCH)         *
  5542*                                                RKP=9, LEN=38   *
  5543*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5544*                                   ACCOUNT, REF, BATCH)         *
  5545*                                                RKP=47, LEN=46  *
  5546*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5547*                                   BATCH)                       *
  5548*                                                RKP=93, LEN=24  *
  5549*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5550*                                   REF, BATCH)                  *
  5551*                                                RKP=117, LEN=35 *
  5552*   LOG = NO                                                     *
  5553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5554******************************************************************
  5555
  5556 01  AR-REQUEST-RECORD.
  5557     12  RQ-RECORD-ID                     PIC XX.
  5558         88  VALID-RQ-ID                        VALUE 'RQ'.
  5559
  5560     12  RQ-CONTROL-PRIMARY.
  5561         16  RQ-COMPANY-CD                PIC X.
  5562         16  RQ-ENTRY-BATCH               PIC X(6).
  5563
  5564     12  RQ-CONTROL-BY-ACCT-REF.
  5565         16  RQ-COMPANY-CD-A1             PIC X.
  5566         16  RQ-CARRIER-A1                PIC X.
  5567         16  RQ-GROUPING-A1               PIC X(6).
  5568         16  RQ-STATE-A1                  PIC XX.
  5569         16  RQ-ACCOUNT-A1                PIC X(10).
  5570         16  RQ-REFERENCE-A1              PIC X(12).
  5571         16  RQ-BATCH-A1                  PIC X(6).
  5572
  5573     12  RQ-CONTROL-BY-FIN-RESP.
  5574         16  RQ-COMPANY-CD-A2             PIC X.
  5575         16  RQ-CARRIER-A2                PIC X.
  5576         16  RQ-GROUPING-A2               PIC X(6).
  5577         16  RQ-FIN-RESP-A2               PIC X(10).
  5578         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5579         16  RQ-REFERENCE-A2              PIC X(12).
  5580         16  RQ-BATCH-A2                  PIC X(6).
  5581
  5582     12  RQ-CONTROL-BY-ACCT-AGENT.
  5583         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 105
* EL6501.cbl
  5584         16  RQ-CARRIER-A3                PIC X.
  5585         16  RQ-GROUPING-A3               PIC X(6).
  5586         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5587         16  RQ-BATCH-A3                  PIC X(6).
  5588
  5589     12  RQ-CONTROL-BY-SUMMARY.
  5590         16  RQ-COMPANY-CD-A4             PIC X.
  5591         16  RQ-SUMMARY-CODE              PIC X(6).
  5592         16  RQ-ACCOUNT-A4                PIC X(10).
  5593         16  RQ-REFERENCE-A4              PIC X(12).
  5594         16  RQ-BATCH-A4                  PIC X(6).
  5595
  5596     12  RQ-REQUEST-METHOD                PIC X.
  5597         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5598         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5599         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5600         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5601     12  FILLER                           PIC X.
  5602     12  RQ-STATUS                        PIC X.
  5603         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5604         88  RQ-RESUBMIT                      VALUE 'R'.
  5605     12  RQ-PROCESSOR-ID                  PIC X(4).
  5606     12  RQ-ENTRY-DT                      PIC XX.
  5607     12  RQ-MO-END-DT                     PIC XX.
  5608     12  RQ-REQUEST-DT                    PIC XX.
  5609     12  RQ-STMT-DT                       PIC XX.
  5610     12  RQ-REVERSAL-DT                   PIC XX.
  5611     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5612     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5613
  5614     12  FILLER                           PIC X(27).
  5615
  5616******************************************************************
  5617
  5618*EJECT
  5619*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 106
* EL6501.cbl
  5621 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5622                          CONTROL-FILE REINSURANCE-RECORD
  5623                          COMM-TABLE-RECORD NOTE-FILE
  5624                          COMMISSION-WORK-AREA
  5625                          COMPENSATION-MASTER
  5626                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5627 0000-DFHEXIT SECTION.
  5628     MOVE '9#                    $   ' TO DFHEIV0.
  5629     MOVE 'EL6501' TO DFHEIV1.
  5630     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5631     MOVE EIBTRMID              TO QID-TERM.
  5632
  5633     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5634     MOVE '5'                   TO DC-OPTION-CODE.
  5635     PERFORM 9700-DATE-LINK.
  5636     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5637     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5638
  5639***  Y2K PROJ 7744
  5640     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5641                                    CURRENT-SAVE
  5642     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5643                                    CURRENT-SAVE(1:2)
  5644***  Y2K PROJ 7744
  5645
  5646     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5647     IF EIBCALEN = 0
  5648         GO TO 8800-UNAUTHORIZED-ACCESS.
  5649
  5650     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5651     MOVE LOW-VALUES             TO EL6501AI.
  5652
  5653
  5654* EXEC CICS HANDLE CONDITION
  5655*        PGMIDERR  (9600-PGMID-ERROR)
  5656*        ERROR     (9990-ABEND)
  5657*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5658*    END-EXEC.
  5659*    MOVE '"$L.N                 ! " #00005649' TO DFHEIV0
  5660     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5662     MOVE X'2220233030303035363439' TO DFHEIV0(25:11)
  5663     CALL 'kxdfhei1' USING DFHEIV0
  5664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5665
  5666
  5667     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5668         IF PI-CALLING-PROGRAM = XCTL-650
  5669             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5670             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5671             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5672             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5673             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5674             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5675             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5676             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5677             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5678             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 107
* EL6501.cbl
  5679         ELSE
  5680             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5681             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5682             GO TO 0600-DISPLAY-RECORD.
  5683
  5684     IF EIBAID = DFHCLEAR
  5685         GO TO 9400-CLEAR.
  5686
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 108
* EL6501.cbl
  5688 0200-RECEIVE.
  5689     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5690         MOVE ER-0008            TO EMI-ERROR
  5691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5692         MOVE -1                 TO PFENTERL
  5693         GO TO 8200-SEND-DATAONLY.
  5694
  5695
  5696* EXEC CICS RECEIVE
  5697*        MAP      (MAP-NAME)
  5698*        MAPSET   (MAPSET-NAME)
  5699*        INTO     (EL6501AI)
  5700*    END-EXEC.
  5701     MOVE LENGTH OF
  5702      EL6501AI
  5703       TO DFHEIV11
  5704*    MOVE '8"T I  L              ''   #00005683' TO DFHEIV0
  5705     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5707     MOVE X'2020233030303035363833' TO DFHEIV0(25:11)
  5708     CALL 'kxdfhei1' USING DFHEIV0,
  5709           MAP-NAME,
  5710           EL6501AI,
  5711           DFHEIV11,
  5712           MAPSET-NAME,
  5713           DFHEIV99,
  5714           DFHEIV99
  5715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5716
  5717
  5718     IF PFENTERL = 0
  5719         GO TO 0300-CHECK-PFKEYS.
  5720     IF EIBAID NOT = DFHENTER
  5721         MOVE ER-0004            TO EMI-ERROR
  5722         GO TO 0320-INPUT-ERROR.
  5723     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5724         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5725     ELSE
  5726         MOVE ER-0029            TO EMI-ERROR
  5727         GO TO 0320-INPUT-ERROR.
  5728
  5729 0300-CHECK-PFKEYS.
  5730     IF EIBAID = DFHPF23
  5731         GO TO 8810-PF23.
  5732     IF EIBAID = DFHPF24
  5733         GO TO 9200-RETURN-MAIN-MENU.
  5734     IF EIBAID = DFHPF12
  5735         GO TO 9500-PF12.
  5736
  5737* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5738*             MASTER(ERRESC)
  5739*
  5740*    IF  EIBAID = DFHPF10
  5741*        IF PI-COMPANY-ID = 'DMD'
  5742*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5743*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5744*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5745*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 109
* EL6501.cbl
  5746*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5747*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5748*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5749*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5750*           MOVE XCTL-608           TO PGM-NAME
  5751*                                      PI-RETURN-TO-PROGRAM
  5752*                                      PI-CALLING-PROGRAM
  5753*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5754*           GO TO 9300-XCTL.
  5755
  5756     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5757                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5758                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5759         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5760             MOVE ER-0029        TO  EMI-ERROR
  5761             GO TO 0320-INPUT-ERROR
  5762         ELSE
  5763             GO TO 0800-CHECK-MAINT.
  5764
  5765     IF EIBAID = DFHENTER
  5766         GO TO 0330-EDIT-DATA.
  5767
  5768     MOVE ER-0029                TO EMI-ERROR.
  5769
  5770 0320-INPUT-ERROR.
  5771     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5772     MOVE AL-UNBON               TO PFENTERA.
  5773     MOVE -1                     TO PFENTERL.
  5774     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 110
* EL6501.cbl
  5776 0330-EDIT-DATA.
  5777     IF MAINTI  = 'S'
  5778        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5779        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5780        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5781        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5782        MOVE -1                  TO MAINTL
  5783        GO TO 8100-SEND-INITIAL-MAP.
  5784
  5785     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5786     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5787
  5788     IF EMI-ERROR NOT = ZEROS
  5789         MOVE -1                 TO MAINTL
  5790         GO TO 8200-SEND-DATAONLY.
  5791
  5792     IF NOT MODIFY-CAP
  5793         MOVE 'UPDATE'           TO SM-READ
  5794         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5795         MOVE ER-0070            TO EMI-ERROR
  5796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5797         GO TO 8100-SEND-INITIAL-MAP.
  5798
  5799     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5800
  5801     IF MAINTI = 'A'
  5802        GO TO 1000-ADD-A-RECORD.
  5803
  5804     IF MAINTI = 'C'
  5805        IF PI-SV-MAINT  =  'L'
  5806            MOVE -1             TO MAINTL
  5807            MOVE AL-UABON       TO MAINTA
  5808            MOVE ER-0899        TO EMI-ERROR
  5809            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5810            GO TO 8200-SEND-DATAONLY
  5811        ELSE
  5812            GO TO 2000-CHANGE-A-RECORD.
  5813
  5814     IF MAINTI = 'L'
  5815        MOVE 'L'                TO PI-SV-MAINT
  5816        GO TO 3000-CHANGE-ALL-RECORDS.
  5817
  5818     MOVE ER-0023                TO EMI-ERROR.
  5819     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5820     MOVE -1                     TO MAINTL.
  5821     MOVE AL-UABON               TO MAINTA.
  5822     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 111
* EL6501.cbl
  5824 0500-CHECK-MAINT-TYPE.
  5825     IF PI-MAINT = 'A'
  5826        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5827        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5828        MOVE -1                  TO NAMEL
  5829        GO TO 8100-SEND-INITIAL-MAP.
  5830
  5831 0600-DISPLAY-RECORD.
  5832     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5833     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  5834     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  5835     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  5836
  5837     IF PI-MAINT = 'A'
  5838        MOVE -1                  TO NAMEL
  5839     ELSE
  5840        MOVE -1                  TO MAINTL.
  5841
  5842     GO TO 8100-SEND-INITIAL-MAP.
  5843
  5844 0700-FORMAT-KEYDATA.
  5845     MOVE PI-MAINT               TO MAINTI.
  5846
  5847     IF PI-MAINT = 'A'
  5848        MOVE AL-PANON            TO MAINTA
  5849        SET T-INDEX TO 1
  5850     ELSE
  5851        SET T-INDEX              TO PI-LINE-SELECTED
  5852        MOVE AL-UANON            TO MAINTA.
  5853
  5854     IF PI-2ND-PAGE
  5855         SET T-INDEX UP BY 8
  5856     ELSE
  5857     IF PI-3RD-PAGE
  5858         SET T-INDEX UP BY 16
  5859     ELSE
  5860     IF PI-LST-PAGE
  5861         SET T-INDEX UP BY 24.
  5862
  5863     MOVE PI-ACCT-CARRIER        TO CARRI.
  5864     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  5865     MOVE PI-ACCT-STATE          TO STATEI.
  5866     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  5867
  5868     IF PI-ACCT-EXP-DT = LOW-VALUES
  5869        MOVE SPACES              TO EXPDTEI
  5870     ELSE
  5871        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  5872           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  5873           MOVE SPACE               TO DC-OPTION-CODE
  5874           PERFORM 9700-DATE-LINK
  5875           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  5876        ELSE
  5877           MOVE 999999              TO EXPDTEO
  5878           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  5879
  5880***DMD CUSTOM CODE *****START
  5881     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 112
* EL6501.cbl
  5882     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  5883     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  5884     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  5885        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  5886     ELSE
  5887        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  5888***DMD CUSTOM CODE *****END
  5889
  5890     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  5891     MOVE SPACE                   TO DC-OPTION-CODE.
  5892     PERFORM 9700-DATE-LINK.
  5893     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  5894
  5895 0700-EXIT.
  5896      EXIT.
  5897
  5898 0800-CHECK-MAINT.
  5899     IF PI-MAINT = 'A'
  5900        IF PI-RECORD-NOT-CREATED
  5901           MOVE ER-2071          TO EMI-ERROR
  5902           MOVE  -1              TO NAMEL
  5903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5904           GO TO 8200-SEND-DATAONLY.
  5905
  5906     IF  EIBAID = DFHPF1
  5907             AND
  5908         CREDIT-SESSION
  5909         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5910         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5911         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5912         MOVE PI-ACCT-STATE      TO PI-STATE
  5913         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5914         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  5915         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  5916         MOVE XCTL-689           TO PGM-NAME
  5917         GO TO 9300-XCTL.
  5918
  5919     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  5920         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5921         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5922         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5923         MOVE PI-ACCT-STATE      TO PI-STATE
  5924         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5925         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  5926         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  5927         MOVE XCTL-690           TO PGM-NAME
  5928         GO TO 9300-XCTL
  5929     END-IF.
  5930
  5931     IF EIBAID = DFHPF3
  5932             AND
  5933         CREDIT-SESSION
  5934         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5935         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5936         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5937         MOVE PI-ACCT-STATE      TO PI-STATE
  5938         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5939         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 113
* EL6501.cbl
  5940         MOVE XCTL-653           TO PGM-NAME
  5941         GO TO 9300-XCTL.
  5942
  5943     IF EIBAID = DFHPF4
  5944         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  5945         MOVE XCTL-652           TO PGM-NAME
  5946         GO TO 9300-XCTL.
  5947
  5948     IF EIBAID = DFHPF5
  5949         MOVE XCTL-6502          TO PGM-NAME
  5950         GO TO 9300-XCTL.
  5951
  5952     IF EIBAID = DFHPF7
  5953         MOVE XCTL-6504          TO PGM-NAME
  5954         GO TO 9300-XCTL.
  5955
  5956     IF EIBAID = DFHPF8
  5957         MOVE XCTL-6506          TO PGM-NAME
  5958         GO TO 9300-XCTL.
  5959
  5960     IF EIBAID = DFHPF9
  5961        MOVE XCTL-6505           TO PGM-NAME
  5962        GO TO 9300-XCTL.
  5963
  5964     IF EIBAID = DFHPF10
  5965        IF PI-COMPANY-ID = 'DMD'
  5966           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5967           MOVE XCTL-608         TO PGM-NAME
  5968           GO TO 9300-XCTL.
  5969
  5970     MOVE ER-0029                TO EMI-ERROR.
  5971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5972     MOVE AL-UNBON               TO PFENTERA.
  5973     MOVE -1                     TO PFENTERL.
  5974     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 114
* EL6501.cbl
  5976 1000-ADD-A-RECORD.
  5977     IF PI-MAINT = 'A'
  5978        PERFORM 4000-EDITS THRU 4900-EXIT
  5979     ELSE
  5980        MOVE ER-2180             TO EMI-ERROR
  5981        MOVE -1                  TO MAINTL
  5982        MOVE AL-UABON            TO MAINTA
  5983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5984
  5985     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  5986        EMI-FATAL-CTR    GREATER ZERO
  5987         GO TO 8200-SEND-DATAONLY.
  5988
  5989
  5990* EXEC CICS GETMAIN
  5991*         LENGTH   (ACCT-REC-LEN)
  5992*         SET      (ADDRESS OF ACCOUNT-MASTER)
  5993*         INITIMG  (GETMAIN-SPACE)
  5994*    END-EXEC.
  5995*    MOVE ',"IL                  $   #00005960' TO DFHEIV0
  5996     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5998     MOVE X'2020233030303035393630' TO DFHEIV0(25:11)
  5999     CALL 'kxdfhei1' USING DFHEIV0,
  6000           DFHEIV20,
  6001           ACCT-REC-LEN,
  6002           GETMAIN-SPACE
  6003     SET ADDRESS OF ACCOUNT-MASTER TO
  6004         DFHEIV20
  6005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6006
  6007
  6008     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6009                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6010                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6011                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6012                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6013                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6014
  6015     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6016                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6017                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6018                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6019                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6020                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6021                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6022                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6023
  6024     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6025                                    AM-AGT-COMMS (2)
  6026                                    AM-AGT-COMMS (3)
  6027                                    AM-AGT-COMMS (4)
  6028                                    AM-AGT-COMMS (5)
  6029                                    AM-AGT-COMMS (6)
  6030                                    AM-AGT-COMMS (7)
  6031                                    AM-AGT-COMMS (8)
  6032                                    AM-AGT-COMMS (9)
  6033                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 115
* EL6501.cbl
  6034
  6035     IF PI-COMPANY-ID = 'FLI'
  6036         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6037                                    AM-FLI-BANK-1ST-6-PREM
  6038                                    AM-FLI-BANK-CAP-AMT
  6039                                    AM-FLI-AGT-SHARE-PCT (1)
  6040                                    AM-FLI-AGT-SHARE-PCT (2)
  6041                                    AM-FLI-AGT-SHARE-PCT (3)
  6042                                    AM-FLI-AGT-SHARE-PCT (4)
  6043                                    AM-FLI-AGT-SHARE-PCT (5)
  6044                                    AM-FLI-AGT-SHARE-PCT (6)
  6045                                    AM-FLI-AGT-SHARE-PCT (7)
  6046                                    AM-FLI-AGT-SHARE-PCT (8)
  6047                                    AM-FLI-AGT-SHARE-PCT (9)
  6048                                    AM-FLI-AGT-SHARE-PCT (10).
  6049
  6050     MOVE ZEROS                  TO AM-GPCD
  6051                                    AM-LF-RET
  6052                                    AM-AH-RET
  6053                                    AM-LF-OB-RATE
  6054                                    AM-LF-OB-RATE-JNT
  6055                                    AM-AH-OB-RATE
  6056                                    AM-AH-OB-RATE-JNT
  6057                                    AM-REI-FEE-LF
  6058                                    AM-REI-FEE-AH
  6059                                    AM-REI-LF-TAX
  6060                                    AM-REI-PR-PCT
  6061                                    AM-REI-78-PCT
  6062                                    AM-REI-AH-TAX
  6063                                    AM-TOL-PREM
  6064                                    AM-TOL-REF
  6065                                    AM-CLP-TOL-PCT
  6066                                    AM-TOL-CLM
  6067                                    AM-CERTS-PURGED-DATE
  6068                                    AM-HI-CERT-DATE
  6069                                    AM-LO-CERT-DATE
  6070                                    AM-1ST-PROD-DATE
  6071                                    AM-GPCD
  6072                                    AM-CAL-TABLE
  6073                                    AM-LF-DEVIATION
  6074                                    AM-LF-DEVIATION-PCT
  6075                                    AM-AH-DEVIATION
  6076                                    AM-AH-DEVIATION-PCT
  6077                                    AM-ANNIVERSARY-DATE
  6078                                    AM-TEL-NO
  6079                                    AM-ENTRY-DATE
  6080                                    AM-INACTIVE-DATE
  6081                                    AM-RET-MIN-LOSS-L
  6082                                    AM-RET-MIN-LOSS-A
  6083                                    AM-LF-RPT021-EXP-PCT
  6084                                    AM-AH-RPT021-EXP-PCT
  6085                                    AM-MAX-MON-BEN
  6086                                    AM-MAX-TOT-BEN
  6087                                    AM-DCC-MAX-MARKETING-FEE
  6088                                    AM-SPP-LEASE-COMM
  6089                                    AM-RETRO-QUALIFY-LIMIT
  6090                                    AM-RETRO-RET-PCT-LF (1)
  6091                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 116
* EL6501.cbl
  6092                                    AM-RETRO-RET-PCT-LF (3)
  6093                                    AM-RETRO-RET-THRU-LF (1)
  6094                                    AM-RETRO-RET-THRU-LF (2)
  6095                                    AM-RETRO-RET-THRU-LF (3)
  6096                                    AM-RETRO-RET-PCT-AH (1)
  6097                                    AM-RETRO-RET-PCT-AH (2)
  6098                                    AM-RETRO-RET-PCT-AH (3)
  6099                                    AM-RETRO-RET-THRU-AH (1)
  6100                                    AM-RETRO-RET-THRU-AH (2)
  6101                                    AM-RETRO-RET-THRU-AH (3).
  6102
  6103     IF PI-COMPANY-ID = 'DCC'
  6104        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6105     END-IF
  6106     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6107                                    AM-AR-HI-CERT-DATE.
  6108
  6109     MOVE 'AM'                   TO AM-RECORD-ID.
  6110     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6111                                    AM-CONTROL-BY-VAR-GRP.
  6112
  6113     IF ST-ACCNT-CNTL
  6114        MOVE SPACES              TO AM-VG-CARRIER
  6115                                    AM-VG-GROUPING.
  6116     IF CARR-ST-ACCNT-CNTL
  6117        MOVE SPACES              TO AM-VG-GROUPING.
  6118
  6119     IF ACCNT-CNTL
  6120        MOVE SPACES              TO AM-VG-CARRIER
  6121                                    AM-VG-STATE
  6122                                    AM-VG-GROUPING.
  6123
  6124     IF CARR-ACCNT-CNTL
  6125        MOVE SPACES              TO AM-VG-STATE
  6126                                    AM-VG-GROUPING.
  6127
  6128     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6129     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6130     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6131
  6132     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6133     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6134     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6135
  6136     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6137
  6138     IF PI-COMPANY-ID = 'NCL'
  6139         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6140
  6141     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6142        EMI-FATAL-CTR    GREATER ZERO
  6143         GO TO 8200-SEND-DATAONLY.
  6144
  6145     IF PI-COMPANY-ID = 'DCC'
  6146        IF CLPSTL <= ZEROS
  6147           MOVE ER-0144          TO  EMI-ERROR
  6148           MOVE -1               TO  CLPSTL
  6149           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 117
* EL6501.cbl
  6150           PERFORM 9900-ERROR-FORMAT
  6151                                 THRU  9900-EXIT
  6152           GO TO 8200-SEND-DATAONLY
  6153        END-IF
  6154     END-IF
  6155     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6156     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6157
  6158     MOVE +1 TO AXRF-SUB
  6159                COMM-WORK-SUB.
  6160
  6161     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6162     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6163
  6164     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6165
  6166     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6167         NEXT SENTENCE
  6168     ELSE
  6169         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6170
  6171
  6172* EXEC CICS WRITE
  6173*        FROM      (ACCOUNT-MASTER)
  6174*        RIDFLD    (AM-CONTROL-PRIMARY)
  6175*        DATASET   (ACCT-FILE-ID)
  6176*    END-EXEC.
  6177     MOVE LENGTH OF
  6178      ACCOUNT-MASTER
  6179       TO DFHEIV11
  6180*    MOVE '&$ L                  ''   #00006129' TO DFHEIV0
  6181     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6182     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6183     MOVE X'2020233030303036313239' TO DFHEIV0(25:11)
  6184     CALL 'kxdfhei1' USING DFHEIV0,
  6185           ACCT-FILE-ID,
  6186           ACCOUNT-MASTER,
  6187           DFHEIV11,
  6188           AM-CONTROL-PRIMARY,
  6189           DFHEIV99,
  6190           DFHEIV99
  6191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6192
  6193
  6194     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6195
  6196     MOVE PI-MAINT               TO PI-SV-MAINT.
  6197     MOVE 'C'                    TO PI-MAINT.
  6198     MOVE LOW-VALUES             TO EL6501AI.
  6199
  6200     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6201     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6202     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6203
  6204     IF PI-COMPANY-ID = 'NCL'
  6205         MOVE ER-4011            TO EMI-ERROR
  6206      ELSE
  6207         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 118
* EL6501.cbl
  6208
  6209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6210
  6211     MOVE -1                     TO MAINTL.
  6212     MOVE AL-UANON               TO MAINTA.
  6213     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6214     GO TO 8100-SEND-INITIAL-MAP.
  6215
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 119
* EL6501.cbl
  6217 1500-ADD-COMP.
  6218
  6219* EXEC CICS GETMAIN
  6220*         LENGTH   (COMP-REC-LEN)
  6221*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6222*         INITIMG  (GETMAIN-SPACE)
  6223*    END-EXEC.
  6224*    MOVE ',"IL                  $   #00006159' TO DFHEIV0
  6225     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6226     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6227     MOVE X'2020233030303036313539' TO DFHEIV0(25:11)
  6228     CALL 'kxdfhei1' USING DFHEIV0,
  6229           DFHEIV20,
  6230           COMP-REC-LEN,
  6231           GETMAIN-SPACE
  6232     SET ADDRESS OF COMPENSATION-MASTER TO
  6233         DFHEIV20
  6234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6235
  6236
  6237     MOVE SPACES                 TO COMPENSATION-MASTER.
  6238     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6239                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6240                   CO-OV30         CO-OV60      CO-OV90
  6241                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6242                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6243                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6244                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6245                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6246                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6247                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6248                   CO-CURRENT-CUR-PMT
  6249                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6250                   CO-ACT-YEAR        CO-ACT-MONTH
  6251                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6252                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6253                   CO-CURRENT-LAST-STMT-YEAR
  6254                   CO-CURRENT-LAST-STMT-MONTH
  6255                   CO-CURRENT-LAST-STMT-DAY
  6256                   CO-YTD-PAID-COM
  6257                   CO-YTD-PAID-OV.
  6258
  6259     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6260     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6261     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6262     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6263     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6264
  6265     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6266         MOVE ZEROS              TO CO-CARRIER
  6267     ELSE
  6268         MOVE AM-CARRIER         TO CO-CARRIER.
  6269
  6270     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6271         MOVE ZEROS              TO CO-GROUPING
  6272     ELSE
  6273         MOVE AM-GROUPING        TO CO-GROUPING.
  6274
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 120
* EL6501.cbl
  6275     MOVE 'CO'                   TO CO-RECORD-ID
  6276     MOVE 'A'                    TO CO-TYPE.
  6277     MOVE AM-NAME                TO CO-ACCT-NAME.
  6278     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6279     MOVE AM-ADDRS               TO CO-ADDR-1.
  6280*    MOVE AM-CITY                TO CO-ADDR-3.
  6281     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6282     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6283     MOVE AM-ZIP                 TO CO-ZIP.
  6284     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6285     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6286
  6287     IF PI-COMPANY-ID = 'NCL'
  6288         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6289         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6290                         'X' OR 'I'
  6291             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6292             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6293         ELSE
  6294             MOVE SPACE          TO  CO-TYPE-AGENT
  6295             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6296     ELSE
  6297         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6298
  6299     IF AM-REMIT-TO NOT = ZERO
  6300         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6301       ELSE
  6302         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6303
  6304     MOVE +0                      TO AGT-SUB.
  6305
  6306     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6307
  6308     IF VALID-AGT-SW = 'Y'
  6309         NEXT SENTENCE
  6310     ELSE
  6311         GO TO 1500-EXIT.
  6312
  6313     IF CO-RESP-NO = CO-ACCOUNT
  6314         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6315     ELSE
  6316         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6317
  6318     IF PI-AR-PROCESSING
  6319        MOVE 'G'                   TO CO-AR-REPORTING
  6320        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6321        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6322        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6323
  6324     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6325        MOVE 'N'                   TO CO-AR-REPORTING.
  6326
  6327     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6328        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6329
  6330     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6331
  6332
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 121
* EL6501.cbl
  6333* EXEC CICS HANDLE CONDITION
  6334*         DUPREC   (1500-EXIT)
  6335*    END-EXEC.
  6336*    MOVE '"$%                   ! # #00006260' TO DFHEIV0
  6337     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6339     MOVE X'2320233030303036323630' TO DFHEIV0(25:11)
  6340     CALL 'kxdfhei1' USING DFHEIV0
  6341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6342
  6343
  6344
  6345* EXEC CICS WRITE
  6346*        FROM      (COMPENSATION-MASTER)
  6347*        RIDFLD    (CO-CONTROL-PRIMARY)
  6348*        DATASET   (COMP-FILE-ID)
  6349*    END-EXEC.
  6350     MOVE LENGTH OF
  6351      COMPENSATION-MASTER
  6352       TO DFHEIV11
  6353*    MOVE '&$ L                  ''   #00006264' TO DFHEIV0
  6354     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6355     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6356     MOVE X'2020233030303036323634' TO DFHEIV0(25:11)
  6357     CALL 'kxdfhei1' USING DFHEIV0,
  6358           COMP-FILE-ID,
  6359           COMPENSATION-MASTER,
  6360           DFHEIV11,
  6361           CO-CONTROL-PRIMARY,
  6362           DFHEIV99,
  6363           DFHEIV99
  6364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6365
  6366
  6367 1500-EXIT.
  6368      EXIT.
  6369
  6370 1600-FIND-C-AGT.
  6371     ADD 1 TO  AGT-SUB.
  6372     IF AGT-SUB GREATER 10
  6373         MOVE 'N'                TO  VALID-AGT-SW
  6374         GO TO 1600-EXIT.
  6375
  6376************************************************************
  6377**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6378************************************************************
  6379
  6380     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6381         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6382         MOVE 'Y'                TO  VALID-AGT-SW
  6383         GO TO 1600-EXIT
  6384     ELSE
  6385         GO TO 1600-FIND-C-AGT.
  6386
  6387 1600-EXIT.
  6388     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 122
* EL6501.cbl
  6390 1700-CHANGE-COMP.
  6391     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6392     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6393
  6394     IF PI-ZERO-CARRIER
  6395       OR PI-ZERO-CAR-GROUP
  6396         MOVE ZEROS              TO COMP-CARRIER
  6397     ELSE
  6398         MOVE AM-CARRIER         TO COMP-CARRIER.
  6399
  6400     IF PI-ZERO-GROUPING
  6401       OR PI-ZERO-CAR-GROUP
  6402         MOVE ZEROS              TO COMP-GROUPING
  6403     ELSE
  6404         MOVE AM-GROUPING        TO COMP-GROUPING.
  6405
  6406     IF AM-REMIT-TO NOT = ZERO
  6407         MOVE AM-AGT (AM-REMIT-TO)
  6408                                 TO COMP-RESP-NO
  6409     ELSE
  6410         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6411
  6412     MOVE ZERO                   TO AGT-SUB.
  6413
  6414     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6415
  6416     IF VALID-AGT-SW = 'Y'
  6417         NEXT SENTENCE
  6418     ELSE
  6419         GO TO 1799-EXIT.
  6420
  6421     MOVE 'A'                    TO COMP-TYPE.
  6422
  6423
  6424* EXEC CICS HANDLE CONDITION
  6425*         ENDFILE     (1799-EXIT)
  6426*         NOTFND      (1799-EXIT)
  6427*    END-EXEC.
  6428*    MOVE '"$''I                  ! $ #00006326' TO DFHEIV0
  6429     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6431     MOVE X'2420233030303036333236' TO DFHEIV0(25:11)
  6432     CALL 'kxdfhei1' USING DFHEIV0
  6433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6434
  6435
  6436
  6437* EXEC CICS READ
  6438*        UPDATE
  6439*        DATASET   (COMP-FILE-ID)
  6440*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6441*        RIDFLD    (COMP-KEY)
  6442*    END-EXEC.
  6443*    MOVE '&"S        EU         (   #00006331' TO DFHEIV0
  6444     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6445     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6446     MOVE X'2020233030303036333331' TO DFHEIV0(25:11)
  6447     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 123
* EL6501.cbl
  6448           COMP-FILE-ID,
  6449           DFHEIV20,
  6450           DFHEIV99,
  6451           COMP-KEY,
  6452           DFHEIV99,
  6453           DFHEIV99,
  6454           DFHEIV99
  6455     SET ADDRESS OF COMPENSATION-MASTER TO
  6456         DFHEIV20
  6457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6458
  6459
  6460     IF (ON-LAST-DATE-RANGE)
  6461        IF NAMEL GREATER ZEROS
  6462           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6463           MOVE AM-NAME          TO CO-ACCT-NAME
  6464        END-IF
  6465        IF INCAREL GREATER ZEROS
  6466           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6467           MOVE AM-PERSON        TO CO-MAIL-NAME
  6468        END-IF
  6469        IF ADDR1L GREATER ZEROS
  6470           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6471           MOVE AM-ADDRS         TO CO-ADDR-1
  6472        END-IF
  6473        IF ACITYL  GREATER ZEROS
  6474           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6475           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6476        END-IF
  6477        IF ASTATEL  GREATER ZEROS
  6478           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6479           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6480        END-IF
  6481        IF ZIPL GREATER ZEROS
  6482           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6483           MOVE AM-ZIP           TO CO-ZIP
  6484        END-IF
  6485        IF CSRL GREATER ZEROS
  6486           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6487           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6488        END-IF
  6489        IF PHONEL GREATER ZEROS
  6490           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6491           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6492        END-IF
  6493        IF TAXNOL GREATER ZEROS
  6494           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6495           MOVE AM-ID-NO         TO CO-SOC-SEC
  6496        END-IF
  6497        IF AUTO-CANCEL-ACCOUNT
  6498           IF CO-BILL-SW = ' '
  6499              MOVE 'B'           TO CO-BILL-SW
  6500              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6501           END-IF
  6502        END-IF
  6503     END-IF
  6504
  6505     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 124
* EL6501.cbl
  6506         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6507         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6508     END-IF
  6509
  6510     IF CHANGE-WAS-MADE
  6511         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6512         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6513         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6514
  6515     IF NAMEL GREATER THAN ZERO
  6516         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6517
  6518
  6519* EXEC CICS REWRITE
  6520*        FROM      (COMPENSATION-MASTER)
  6521*        DATASET   (COMP-FILE-ID)
  6522*    END-EXEC.
  6523     MOVE LENGTH OF
  6524      COMPENSATION-MASTER
  6525       TO DFHEIV11
  6526*    MOVE '&& L                  %   #00006396' TO DFHEIV0
  6527     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6528     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6529     MOVE X'2020233030303036333936' TO DFHEIV0(25:11)
  6530     CALL 'kxdfhei1' USING DFHEIV0,
  6531           COMP-FILE-ID,
  6532           COMPENSATION-MASTER,
  6533           DFHEIV11,
  6534           DFHEIV99
  6535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6536
  6537
  6538 1799-EXIT.
  6539     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 125
* EL6501.cbl
  6541 1800-FIND-C-AGT.
  6542     ADD 1                       TO  AGT-SUB.
  6543
  6544     IF AGT-SUB GREATER 10
  6545         MOVE 'N'                TO  VALID-AGT-SW
  6546         GO TO 1899-EXIT.
  6547
  6548************************************************************
  6549**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6550************************************************************
  6551
  6552     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6553         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6554         MOVE 'Y'                TO  VALID-AGT-SW
  6555         GO TO 1899-EXIT
  6556     ELSE
  6557         GO TO 1800-FIND-C-AGT.
  6558
  6559 1899-EXIT.
  6560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 126
* EL6501.cbl
  6562 2000-CHANGE-A-RECORD.
  6563     PERFORM 4000-EDITS THRU 4900-EXIT.
  6564
  6565     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6566        EMI-FATAL-CTR    GREATER ZERO
  6567         GO TO 8200-SEND-DATAONLY.
  6568
  6569
  6570* EXEC CICS READ
  6571*        UPDATE
  6572*        DATASET   (ACCT-FILE-ID)
  6573*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6574*        RIDFLD    (PI-ACCT-KEY)
  6575*    END-EXEC.
  6576*    MOVE '&"S        EU         (   #00006432' TO DFHEIV0
  6577     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6578     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6579     MOVE X'2020233030303036343332' TO DFHEIV0(25:11)
  6580     CALL 'kxdfhei1' USING DFHEIV0,
  6581           ACCT-FILE-ID,
  6582           DFHEIV20,
  6583           DFHEIV99,
  6584           PI-ACCT-KEY,
  6585           DFHEIV99,
  6586           DFHEIV99,
  6587           DFHEIV99
  6588     SET ADDRESS OF ACCOUNT-MASTER TO
  6589         DFHEIV20
  6590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6591
  6592
  6593     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6594
  6595     IF NOT PI-AR-PROCESSING
  6596        GO TO 2075-PROCESS-CHANGE.
  6597
  6598     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6599     MOVE +0                     TO SUB1.
  6600
  6601 2075-PROCESS-CHANGE.
  6602     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6603
  6604     IF PI-AR-PROCESSING
  6605        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6606
  6607     IF PI-COMPANY-ID = 'DMD'
  6608     IF AM-ANNIVERSARY-DATE = ZEROS
  6609           MOVE ER-0852             TO EMI-ERROR
  6610           MOVE -1                  TO CONTRL
  6611           MOVE AL-UABON            TO CONTRA
  6612           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6613
  6614     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6615        EMI-FATAL-CTR    GREATER ZERO
  6616         GO TO 8200-SEND-DATAONLY.
  6617
  6618     MOVE +1                     TO AXRF-SUB
  6619                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 127
* EL6501.cbl
  6620     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6621
  6622     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6623     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6624     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6625
  6626     IF ((PI-FST-PAGE)
  6627        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6628                      OR
  6629        ((PI-2ND-PAGE)
  6630        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6631                      OR
  6632        ((PI-3RD-PAGE)
  6633        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6634                      OR
  6635        ((PI-LST-PAGE)
  6636        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6637        SET ON-LAST-DATE-RANGE   TO TRUE
  6638     END-IF
  6639     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6640         NEXT SENTENCE
  6641     ELSE
  6642         IF (ON-LAST-DATE-RANGE)
  6643                          OR
  6644            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6645             (PCONTL > ZERO))
  6646             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6647
  6648     IF NAMEL GREATER THAN ZERO
  6649         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6650
  6651
  6652* EXEC CICS REWRITE
  6653*        FROM      (ACCOUNT-MASTER)
  6654*        DATASET   (ACCT-FILE-ID)
  6655*    END-EXEC.
  6656     MOVE LENGTH OF
  6657      ACCOUNT-MASTER
  6658       TO DFHEIV11
  6659*    MOVE '&& L                  %   #00006497' TO DFHEIV0
  6660     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6661     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6662     MOVE X'2020233030303036343937' TO DFHEIV0(25:11)
  6663     CALL 'kxdfhei1' USING DFHEIV0,
  6664           ACCT-FILE-ID,
  6665           ACCOUNT-MASTER,
  6666           DFHEIV11,
  6667           DFHEIV99
  6668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6669
  6670
  6671     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6672
  6673     IF CSRL GREATER ZEROS
  6674         GO TO 3500-CHANGE-ALL-CSR.
  6675
  6676     MOVE ER-0000                TO EMI-ERROR.
  6677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 128
* EL6501.cbl
  6678     MOVE LOW-VALUES             TO EL6501AI.
  6679
  6680     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6681     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6682     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6683
  6684     MOVE ER-0000                TO EMI-ERROR.
  6685     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6686
  6687     MOVE -1                     TO MAINTL.
  6688     MOVE AL-UANON               TO MAINTA.
  6689     GO TO 8100-SEND-INITIAL-MAP.
  6690
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 129
* EL6501.cbl
  6692 2100-ADD-ACCOUNT-NAME.
  6693
  6694* EXEC CICS HANDLE CONDITION
  6695*         DUPREC   (2100-EXIT)
  6696*    END-EXEC.
  6697*    MOVE '"$%                   ! % #00006524' TO DFHEIV0
  6698     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6700     MOVE X'2520233030303036353234' TO DFHEIV0(25:11)
  6701     CALL 'kxdfhei1' USING DFHEIV0
  6702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6703
  6704
  6705
  6706* EXEC CICS GETMAIN
  6707*         LENGTH   (NAME-REC-LEN)
  6708*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6709*         INITIMG  (GETMAIN-SPACE)
  6710*    END-EXEC.
  6711*    MOVE ',"IL                  $   #00006528' TO DFHEIV0
  6712     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6713     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6714     MOVE X'2020233030303036353238' TO DFHEIV0(25:11)
  6715     CALL 'kxdfhei1' USING DFHEIV0,
  6716           DFHEIV20,
  6717           NAME-REC-LEN,
  6718           GETMAIN-SPACE
  6719     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6720         DFHEIV20
  6721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6722
  6723
  6724     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6725     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6726     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6727     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6728     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6729     MOVE AM-NAME                TO  NL-NAME.
  6730     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6731        MOVE NL-NAME (5:26)      TO NL-NAME
  6732     END-IF
  6733     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6734     MOVE AM-ADDR-STATE          TO  NL-ST.
  6735     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6736     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6737     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6738     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6739     MOVE AM-STATE               TO  NL-AM-STATE.
  6740     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6741
  6742
  6743* EXEC CICS WRITE
  6744*        FROM      (NAME-LOOKUP-MASTER)
  6745*        RIDFLD    (NL-CONTROL-PRIMARY)
  6746*        DATASET   (NAME-FILE-ID)
  6747*    END-EXEC.
  6748     MOVE LENGTH OF
  6749      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 130
* EL6501.cbl
  6750       TO DFHEIV11
  6751*    MOVE '&$ L                  ''   #00006552' TO DFHEIV0
  6752     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6753     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6754     MOVE X'2020233030303036353532' TO DFHEIV0(25:11)
  6755     CALL 'kxdfhei1' USING DFHEIV0,
  6756           NAME-FILE-ID,
  6757           NAME-LOOKUP-MASTER,
  6758           DFHEIV11,
  6759           NL-CONTROL-PRIMARY,
  6760           DFHEIV99,
  6761           DFHEIV99
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6763
  6764
  6765 2100-EXIT.
  6766     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 131
* EL6501.cbl
  6768 2200-ADD-COMPENSATION-NAME.
  6769
  6770* EXEC CICS HANDLE CONDITION
  6771*         DUPREC   (2200-EXIT)
  6772*    END-EXEC.
  6773*    MOVE '"$%                   ! & #00006562' TO DFHEIV0
  6774     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6776     MOVE X'2620233030303036353632' TO DFHEIV0(25:11)
  6777     CALL 'kxdfhei1' USING DFHEIV0
  6778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6779
  6780
  6781
  6782* EXEC CICS GETMAIN
  6783*         LENGTH   (NAME-REC-LEN)
  6784*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6785*         INITIMG  (GETMAIN-SPACE)
  6786*    END-EXEC.
  6787*    MOVE ',"IL                  $   #00006566' TO DFHEIV0
  6788     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6789     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6790     MOVE X'2020233030303036353636' TO DFHEIV0(25:11)
  6791     CALL 'kxdfhei1' USING DFHEIV0,
  6792           DFHEIV20,
  6793           NAME-REC-LEN,
  6794           GETMAIN-SPACE
  6795     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6796         DFHEIV20
  6797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6798
  6799
  6800     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6801     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6802     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6803     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6804     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6805     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6806     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6807        MOVE NL-NAME (5:26)      TO NL-NAME
  6808     END-IF
  6809     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6810     MOVE CO-ADDR-STATE          TO  NL-ST
  6811     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6812     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6813     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6814     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6815     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6816     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6817     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6818
  6819
  6820* EXEC CICS WRITE
  6821*        FROM      (NAME-LOOKUP-MASTER)
  6822*        RIDFLD    (NL-CONTROL-PRIMARY)
  6823*        DATASET   (NAME-FILE-ID)
  6824*    END-EXEC.
  6825     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 132
* EL6501.cbl
  6826      NAME-LOOKUP-MASTER
  6827       TO DFHEIV11
  6828*    MOVE '&$ L                  ''   #00006591' TO DFHEIV0
  6829     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6831     MOVE X'2020233030303036353931' TO DFHEIV0(25:11)
  6832     CALL 'kxdfhei1' USING DFHEIV0,
  6833           NAME-FILE-ID,
  6834           NAME-LOOKUP-MASTER,
  6835           DFHEIV11,
  6836           NL-CONTROL-PRIMARY,
  6837           DFHEIV99,
  6838           DFHEIV99
  6839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6840
  6841
  6842 2200-EXIT.
  6843     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 133
* EL6501.cbl
  6845 3000-CHANGE-ALL-RECORDS.
  6846     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  6847     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  6848
  6849
  6850* EXEC CICS HANDLE CONDITION
  6851*         ENDFILE     (3030-END-FILE)
  6852*    END-EXEC.
  6853*    MOVE '"$''                   ! '' #00006604' TO DFHEIV0
  6854     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6856     MOVE X'2720233030303036363034' TO DFHEIV0(25:11)
  6857     CALL 'kxdfhei1' USING DFHEIV0
  6858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6859
  6860
  6861     PERFORM 6300-STARTBR THRU 6300-EXIT.
  6862
  6863 3010-READ-NEXT.
  6864     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6865
  6866     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  6867        GO TO 3030-END-FILE.
  6868
  6869
  6870* EXEC CICS ENDBR
  6871*        DATASET   (ACCT-FILE-ID)
  6872*    END-EXEC.
  6873     MOVE 0
  6874       TO DFHEIV11
  6875*    MOVE '&2                    $   #00006616' TO DFHEIV0
  6876     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6878     MOVE X'2020233030303036363136' TO DFHEIV0(25:11)
  6879     CALL 'kxdfhei1' USING DFHEIV0,
  6880           ACCT-FILE-ID,
  6881           DFHEIV11,
  6882           DFHEIV99
  6883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6884
  6885     ADD +1                      TO WS-CHANGE-ALL-CNT
  6886
  6887* EXEC CICS READ
  6888*        UPDATE
  6889*        DATASET   (ACCT-FILE-ID)
  6890*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6891*        RIDFLD    (WS-KEY-SAVE)
  6892*    END-EXEC.
  6893*    MOVE '&"S        EU         (   #00006620' TO DFHEIV0
  6894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6896     MOVE X'2020233030303036363230' TO DFHEIV0(25:11)
  6897     CALL 'kxdfhei1' USING DFHEIV0,
  6898           ACCT-FILE-ID,
  6899           DFHEIV20,
  6900           DFHEIV99,
  6901           WS-KEY-SAVE,
  6902           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 134
* EL6501.cbl
  6903           DFHEIV99,
  6904           DFHEIV99
  6905     SET ADDRESS OF ACCOUNT-MASTER TO
  6906         DFHEIV20
  6907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6908
  6909
  6910     IF NAMEL    GREATER THAN ZERO  OR
  6911        INCAREL  GREATER THAN ZERO  OR
  6912        ADDR1L   GREATER THAN ZERO  OR
  6913        ACITYL   GREATER THAN ZERO  OR
  6914        ASTATEL  GREATER THAN ZERO  OR
  6915        ZIPL     GREATER THAN ZERO  OR
  6916        CLPTOLPL GREATER THAN ZERO  OR
  6917        PHONEL   GREATER THAN ZERO
  6918         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  6919
  6920     IF STATUSL > ZERO
  6921        EVALUATE TRUE
  6922           WHEN STATUSI = 'A'
  6923              MOVE '0'           TO AM-STATUS
  6924           WHEN STATUSI = 'I'
  6925              MOVE '1'           TO AM-STATUS
  6926           WHEN (STATUSI = 'C')
  6927              AND (AM-STATUS NOT = '3' AND 'C')
  6928              MOVE '3'           TO AM-STATUS
  6929              SET AUTO-CANCEL-ACCOUNT
  6930                                 TO TRUE
  6931           WHEN (STATUSI = 'C')
  6932              MOVE '3'           TO AM-STATUS
  6933           WHEN STATUSI = 'F'
  6934              MOVE '4'           TO AM-STATUS
  6935           WHEN STATUSI = 'S'
  6936              MOVE '5'           TO AM-STATUS
  6937           WHEN OTHER
  6938              MOVE -1            TO STATUSL
  6939              MOVE AL-UABON      TO STATUSA
  6940              MOVE ER-2153       TO EMI-ERROR
  6941              PERFORM 9900-ERROR-FORMAT
  6942                                 THRU 9900-EXIT
  6943        END-EVALUATE
  6944     END-IF
  6945*    IF STATUSL > ZERO
  6946*       IF STATUSI = 'A'
  6947*          MOVE '0'              TO AM-STATUS
  6948*       ELSE
  6949*          IF STATUSI = 'I'
  6950*             MOVE '1'           TO AM-STATUS
  6951*          ELSE
  6952*             IF STATUSI = 'C'
  6953*                IF AM-STATUS NOT = '3' AND 'C'
  6954*                   SET AUTO-CANCEL-ACCOUNT
  6955*                                TO TRUE
  6956*                END-IF
  6957*                MOVE '3'        TO AM-STATUS
  6958*             ELSE
  6959*                IF STATUSI = 'F'
  6960*                   MOVE '4'     TO AM-STATUS
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 135
* EL6501.cbl
  6961*                ELSE
  6962*                   MOVE -1         TO STATUSL
  6963*                   MOVE AL-UABON   TO STATUSA
  6964*                   MOVE ER-2153    TO EMI-ERROR
  6965*                   PERFORM 9900-ERROR-FORMAT
  6966*                                THRU 9900-EXIT
  6967*                END-IF
  6968*             END-IF
  6969*          END-IF
  6970*       END-IF
  6971*    END-IF
  6972
  6973     IF CSRL GREATER ZERO
  6974        MOVE CSRI                TO AM-CSR-CODE.
  6975     IF NAMEL GREATER THAN ZERO
  6976        MOVE NAMEI               TO AM-NAME.
  6977     IF PCONTL GREATER THAN ZERO
  6978        MOVE PCONTI              TO AM-CONTROL-NAME
  6979     END-IF
  6980     IF INCAREL GREATER ZEROS
  6981        MOVE INCAREI             TO AM-PERSON.
  6982     IF ADDR1L GREATER ZEROS
  6983        MOVE ADDR1I              TO AM-ADDRS.
  6984     IF ACITYL GREATER ZEROS
  6985        MOVE ACITYI             TO AM-ADDR-CITY.
  6986     IF ASTATEL GREATER ZEROS
  6987        MOVE ASTATEI            TO AM-ADDR-STATE.
  6988     IF ZIPL NOT GREATER ZEROS
  6989         GO TO 3015-CONT-CHANGING.
  6990
  6991     MOVE ZIPI                   TO WS-ZIP-CODE.
  6992
  6993     IF WS-CANADIAN-ZIP
  6994         IF WS-ZIP-4 = SPACE  OR  '-'
  6995             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  6996             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  6997         ELSE
  6998             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  6999             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7000     ELSE
  7001         IF WS-ZIP-6 = SPACE  OR  '-'
  7002             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7003             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7004         ELSE
  7005             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7006             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7007
  7008 3015-CONT-CHANGING.
  7009
  7010     IF CLPTOLPL GREATER ZEROS
  7011
  7012* EXEC CICS BIF
  7013*            DEEDIT
  7014*            FIELD    (CLPTOLPI)
  7015*            LENGTH   (6)
  7016*        END-EXEC
  7017     MOVE 6
  7018       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 136
* EL6501.cbl
  7019*    MOVE '@"L                   #   #00006728' TO DFHEIV0
  7020     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7021     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7022     MOVE X'2020233030303036373238' TO DFHEIV0(25:11)
  7023     CALL 'kxdfhei1' USING DFHEIV0,
  7024           CLPTOLPI,
  7025           DFHEIV11
  7026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7027         IF CLPTOLPI NUMERIC
  7028             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7029         ELSE
  7030             MOVE -1                  TO CLPTOLPL
  7031             MOVE AL-UNBON            TO CLPTOLPA
  7032             MOVE ER-1778             TO EMI-ERROR
  7033             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7034         END-IF
  7035     END-IF
  7036
  7037     IF LCOMML > ZEROS
  7038
  7039* EXEC CICS BIF
  7040*            DEEDIT
  7041*            FIELD    (LCOMMI)
  7042*            LENGTH   (8)
  7043*        END-EXEC
  7044     MOVE 8
  7045       TO DFHEIV11
  7046*    MOVE '@"L                   #   #00006744' TO DFHEIV0
  7047     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7048     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7049     MOVE X'2020233030303036373434' TO DFHEIV0(25:11)
  7050     CALL 'kxdfhei1' USING DFHEIV0,
  7051           LCOMMI,
  7052           DFHEIV11
  7053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7054         IF LCOMMI NUMERIC
  7055            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7056         ELSE
  7057            MOVE -1              TO LCOMML
  7058            MOVE AL-UNBON        TO LCOMMA
  7059            MOVE ER-1778         TO EMI-ERROR
  7060            PERFORM 9900-ERROR-FORMAT
  7061                                 THRU 9900-EXIT
  7062         END-IF
  7063     END-IF
  7064
  7065     IF PHONEL GREATER ZEROS
  7066        MOVE PHONEI              TO DEEDIT-FIELD
  7067        PERFORM 8600-DEEDIT
  7068        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  7069        MOVE WS-PH1              TO AM-AREA-CODE
  7070        MOVE WS-PH2              TO AM-TEL-PRE
  7071        MOVE WS-PH3              TO AM-TEL-NBR.
  7072
  7073*    IF PSILFFL GREATER +0
  7074*       MOVE PSILFFI             TO DEEDIT-FIELD
  7075*       PERFORM 8600-DEEDIT
  7076*       IF DEEDIT-FIELD NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 137
* EL6501.cbl
  7077*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7078*
  7079*    IF PSIAHFL GREATER +0
  7080*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7081*       PERFORM 8600-DEEDIT
  7082*       IF DEEDIT-FIELD NUMERIC
  7083*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7084
  7085     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7086     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7087     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7088
  7089     IF ((PI-FST-PAGE)
  7090        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7091                      OR
  7092        ((PI-2ND-PAGE)
  7093        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7094                      OR
  7095        ((PI-3RD-PAGE)
  7096        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7097                      OR
  7098        ((PI-LST-PAGE)
  7099        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7100        SET ON-LAST-DATE-RANGE   TO TRUE
  7101     END-IF
  7102*    IF ((PI-FST-PAGE)
  7103*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7104*                     OR
  7105*       ((PI-2ND-PAGE)
  7106*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7107*                     OR
  7108*       ((PI-3RD-PAGE)
  7109*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7110*                     OR
  7111*       ((PI-LST-PAGE)
  7112*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7113*       SET ON-LAST-DATE-RANGE   TO TRUE
  7114*    END-IF
  7115     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7116     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7117     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7118*    EXEC CICS DELAY
  7119*       INTERVAL (WS-DELAY-INT)
  7120*    END-EXEC
  7121     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7122        CONTINUE
  7123     ELSE
  7124        IF (ON-LAST-DATE-RANGE)
  7125                   OR
  7126           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  7127           (PCONTL > ZERO))
  7128           PERFORM 1700-CHANGE-COMP
  7129                                 THRU 1799-EXIT
  7130        END-IF
  7131     END-IF
  7132
  7133     IF NAMEL GREATER THAN ZERO
  7134         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 138
* EL6501.cbl
  7135
  7136
  7137* EXEC CICS REWRITE
  7138*        FROM      (ACCOUNT-MASTER)
  7139*        DATASET   (ACCT-FILE-ID)
  7140*    END-EXEC.
  7141     MOVE LENGTH OF
  7142      ACCOUNT-MASTER
  7143       TO DFHEIV11
  7144*    MOVE '&& L                  %   #00006831' TO DFHEIV0
  7145     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7146     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7147     MOVE X'2020233030303036383331' TO DFHEIV0(25:11)
  7148     CALL 'kxdfhei1' USING DFHEIV0,
  7149           ACCT-FILE-ID,
  7150           ACCOUNT-MASTER,
  7151           DFHEIV11,
  7152           DFHEIV99
  7153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7154
  7155
  7156     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7157     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7158
  7159     GO TO 3010-READ-NEXT.
  7160
  7161 3030-END-FILE.
  7162     IF BROWSE-STARTED
  7163        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7164
  7165     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7166
  7167     IF AUTO-CANCEL-ACCOUNT
  7168
  7169* EXEC CICS GETMAIN
  7170*          LENGTH   (ERACNT-REC-LEN)
  7171*          SET      (ADDRESS OF NOTE-FILE)
  7172*          INITIMG  (GETMAIN-SPACE)
  7173*          RESP     (WS-RESPONSE)
  7174*       END-EXEC
  7175*    MOVE ',"IL                  $  N#00006848' TO DFHEIV0
  7176     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7178     MOVE X'204E233030303036383438' TO DFHEIV0(25:11)
  7179     CALL 'kxdfhei1' USING DFHEIV0,
  7180           DFHEIV20,
  7181           ERACNT-REC-LEN,
  7182           GETMAIN-SPACE
  7183     SET ADDRESS OF NOTE-FILE TO
  7184         DFHEIV20
  7185     MOVE EIBRESP  TO WS-RESPONSE
  7186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7187        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7188        MOVE '1'                 TO NT-RECORD-TYPE
  7189        MOVE +1                  TO NT-LINE-SEQUENCE
  7190        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7191        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7192        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 139
* EL6501.cbl
  7193        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7194                                 TO NT-NOTE-LINE
  7195        PERFORM WITH TEST AFTER UNTIL
  7196           (NOT RESP-DUPKEY)
  7197           AND (NOT RESP-DUPREC)
  7198
  7199* EXEC CICS WRITE
  7200*             FROM      (NOTE-FILE)
  7201*             RIDFLD    (NT-CONTROL-PRIMARY)
  7202*             DATASET   (ERACNT-FILE-ID)
  7203*             RESP      (WS-RESPONSE)
  7204*          END-EXEC
  7205     MOVE LENGTH OF
  7206      NOTE-FILE
  7207       TO DFHEIV11
  7208*    MOVE '&$ L                  ''  N#00006865' TO DFHEIV0
  7209     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7210     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7211     MOVE X'204E233030303036383635' TO DFHEIV0(25:11)
  7212     CALL 'kxdfhei1' USING DFHEIV0,
  7213           ERACNT-FILE-ID,
  7214           NOTE-FILE,
  7215           DFHEIV11,
  7216           NT-CONTROL-PRIMARY,
  7217           DFHEIV99,
  7218           DFHEIV99
  7219     MOVE EIBRESP  TO WS-RESPONSE
  7220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7221           IF RESP-DUPKEY OR RESP-DUPREC
  7222              ADD +1             TO NT-LINE-SEQUENCE
  7223           END-IF
  7224        END-PERFORM
  7225     END-IF
  7226     IF NOT EMI-NO-ERRORS
  7227         GO TO 8200-SEND-DATAONLY.
  7228
  7229     MOVE -1                     TO NAMEL.
  7230     MOVE ER-0000                TO EMI-ERROR.
  7231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7232     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 140
* EL6501.cbl
  7234 3500-CHANGE-ALL-CSR.
  7235     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7236     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7237                                    WS-ACCT-REST-OF-EXP.
  7238
  7239
  7240* EXEC CICS HANDLE CONDITION
  7241*         ENDFILE     (3530-END-FILE)
  7242*    END-EXEC.
  7243*    MOVE '"$''                   ! ( #00006889' TO DFHEIV0
  7244     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7246     MOVE X'2820233030303036383839' TO DFHEIV0(25:11)
  7247     CALL 'kxdfhei1' USING DFHEIV0
  7248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7249
  7250
  7251     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7252
  7253 3510-READ-NEXT.
  7254     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7255
  7256     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7257        GO TO 3530-END-FILE.
  7258
  7259
  7260* EXEC CICS ENDBR
  7261*        DATASET   (ACCT-FILE-ID)
  7262*    END-EXEC.
  7263     MOVE 0
  7264       TO DFHEIV11
  7265*    MOVE '&2                    $   #00006901' TO DFHEIV0
  7266     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7267     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7268     MOVE X'2020233030303036393031' TO DFHEIV0(25:11)
  7269     CALL 'kxdfhei1' USING DFHEIV0,
  7270           ACCT-FILE-ID,
  7271           DFHEIV11,
  7272           DFHEIV99
  7273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7274
  7275
  7276
  7277* EXEC CICS READ
  7278*        UPDATE
  7279*        DATASET   (ACCT-FILE-ID)
  7280*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7281*        RIDFLD    (WS-KEY-SAVE)
  7282*    END-EXEC.
  7283*    MOVE '&"S        EU         (   #00006905' TO DFHEIV0
  7284     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7285     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7286     MOVE X'2020233030303036393035' TO DFHEIV0(25:11)
  7287     CALL 'kxdfhei1' USING DFHEIV0,
  7288           ACCT-FILE-ID,
  7289           DFHEIV20,
  7290           DFHEIV99,
  7291           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 141
* EL6501.cbl
  7292           DFHEIV99,
  7293           DFHEIV99,
  7294           DFHEIV99
  7295     SET ADDRESS OF ACCOUNT-MASTER TO
  7296         DFHEIV20
  7297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7298
  7299
  7300     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7301     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7302     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7303
  7304     MOVE CSRI                   TO AM-CSR-CODE.
  7305
  7306
  7307* EXEC CICS REWRITE
  7308*        FROM      (ACCOUNT-MASTER)
  7309*        DATASET   (ACCT-FILE-ID)
  7310*    END-EXEC.
  7311     MOVE LENGTH OF
  7312      ACCOUNT-MASTER
  7313       TO DFHEIV11
  7314*    MOVE '&& L                  %   #00006918' TO DFHEIV0
  7315     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7316     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7317     MOVE X'2020233030303036393138' TO DFHEIV0(25:11)
  7318     CALL 'kxdfhei1' USING DFHEIV0,
  7319           ACCT-FILE-ID,
  7320           ACCOUNT-MASTER,
  7321           DFHEIV11,
  7322           DFHEIV99
  7323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7324
  7325
  7326     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7327     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7328
  7329     GO TO 3510-READ-NEXT.
  7330
  7331 3530-END-FILE.
  7332     IF BROWSE-STARTED
  7333        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7334
  7335     MOVE ER-4009                TO EMI-ERROR.
  7336     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7337     MOVE LOW-VALUES             TO EL6501AI.
  7338
  7339     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7340     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7341     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7342
  7343     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7344
  7345     MOVE -1                     TO MAINTL.
  7346     MOVE AL-UANON               TO MAINTA.
  7347     GO TO 8100-SEND-INITIAL-MAP.
  7348
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 142
* EL6501.cbl
  7350 4000-EDITS.
  7351     IF PI-COMPANY-ID = 'NCL'
  7352      IF MAINTI = 'A' OR 'C'
  7353        IF CSRL GREATER ZEROS
  7354            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7355          ELSE
  7356            IF MAINTI = 'A'
  7357                MOVE ER-1883         TO EMI-ERROR
  7358                MOVE -1              TO CSRL
  7359                MOVE AL-UABON        TO CSRA
  7360                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7361
  7362     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7363        IF NAMEL NOT GREATER ZEROS
  7364           IF MAINTI = 'C'
  7365              GO TO 4070-CHECK-STATUS
  7366           ELSE
  7367              MOVE -1               TO  NAMEL
  7368              MOVE AL-UABON         TO  NAMEA
  7369              MOVE ER-2045          TO  EMI-ERROR
  7370              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7371        ELSE
  7372            GO TO 4065-CHECK-ASSOCIATES.
  7373
  7374     IF TYPEL NOT GREATER ZEROS
  7375        IF MAINTI = 'C'
  7376           GO TO 4050-CONTINUE
  7377        ELSE
  7378           GO TO 4020-BUS-TYPE-ERROR.
  7379
  7380     IF TYPEI NOT NUMERIC
  7381        GO TO 4020-BUS-TYPE-ERROR
  7382     ELSE
  7383        IF TYPEI LESS 1 OR GREATER 99
  7384           GO TO 4020-BUS-TYPE-ERROR.
  7385
  7386     MOVE SPACES                 TO ELCNTL-KEY.
  7387
  7388     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7389     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7390     MOVE '8'                    TO CNTL-REC-TYPE.
  7391     MOVE +0                     TO CNTL-SEQ-NO.
  7392
  7393
  7394* EXEC CICS HANDLE CONDITION
  7395*        NOTFND   (4020-BUS-TYPE-ERROR)
  7396*    END-EXEC.
  7397*    MOVE '"$I                   ! ) #00006990' TO DFHEIV0
  7398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7400     MOVE X'2920233030303036393930' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0
  7402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7403
  7404
  7405
  7406* EXEC CICS READ
  7407*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 143
* EL6501.cbl
  7408*        DATASET   (CNTL-FILE-ID)
  7409*        SET       (ADDRESS OF CONTROL-FILE)
  7410*        RIDFLD    (ELCNTL-KEY)
  7411*    END-EXEC.
  7412*    MOVE '&"S        G          (   #00006994' TO DFHEIV0
  7413     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7415     MOVE X'2020233030303036393934' TO DFHEIV0(25:11)
  7416     CALL 'kxdfhei1' USING DFHEIV0,
  7417           CNTL-FILE-ID,
  7418           DFHEIV20,
  7419           DFHEIV99,
  7420           ELCNTL-KEY,
  7421           DFHEIV99,
  7422           DFHEIV99,
  7423           DFHEIV99
  7424     SET ADDRESS OF CONTROL-FILE TO
  7425         DFHEIV20
  7426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7427
  7428
  7429     IF TYPEI LESS 21
  7430        MOVE TYPEI               TO WS-BUS-ENTRY
  7431     ELSE
  7432        DIVIDE TYPEI BY 20
  7433            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7434        IF WS-BUS-ENTRY = ZEROS
  7435           MOVE 20               TO WS-BUS-ENTRY.
  7436
  7437     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7438        GO TO 4050-CONTINUE.
  7439
  7440 4020-BUS-TYPE-ERROR.
  7441     MOVE -1                     TO TYPEL.
  7442     MOVE AL-UNBON               TO TYPEA.
  7443     MOVE ER-2178                TO EMI-ERROR.
  7444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7445
  7446 4050-CONTINUE.
  7447     IF ASTATEL > 0
  7448        MOVE SPACES                 TO  ELCNTL-KEY
  7449        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7450        MOVE '3'                    TO  CNTL-REC-TYPE
  7451        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7452        MOVE +0                     TO  CNTL-SEQ-NO
  7453
  7454* EXEC CICS  READ
  7455*           DATASET  ('ELCNTL')
  7456*           SET      (ADDRESS OF CONTROL-FILE)
  7457*           RIDFLD   (ELCNTL-KEY)
  7458*           RESP     (WS-RESPONSE)
  7459*       END-EXEC
  7460     MOVE 'ELCNTL' TO DFHEIV1
  7461*    MOVE '&"S        E          (  N#00007025' TO DFHEIV0
  7462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7463     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7464     MOVE X'204E233030303037303235' TO DFHEIV0(25:11)
  7465     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 144
* EL6501.cbl
  7466           DFHEIV1,
  7467           DFHEIV20,
  7468           DFHEIV99,
  7469           ELCNTL-KEY,
  7470           DFHEIV99,
  7471           DFHEIV99,
  7472           DFHEIV99
  7473     SET ADDRESS OF CONTROL-FILE TO
  7474         DFHEIV20
  7475     MOVE EIBRESP  TO WS-RESPONSE
  7476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7477        IF NOT RESP-NORMAL
  7478           MOVE ER-0144                TO  EMI-ERROR
  7479           MOVE -1                     TO  ASTATEL
  7480           MOVE AL-UABON               TO  ASTATEA
  7481           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7482        END-IF
  7483     ELSE
  7484        IF MAINTI = 'A'
  7485           MOVE ER-0144                TO  EMI-ERROR
  7486           MOVE -1                     TO  ASTATEL
  7487           MOVE AL-UABON               TO  ASTATEA
  7488           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7489        END-IF
  7490     END-IF
  7491     IF INDGRPL NOT GREATER ZEROS
  7492        IF MAINTI = 'C'
  7493           GO TO 4070-CHECK-STATUS
  7494        ELSE
  7495           GO TO 4060-IG-ERROR.
  7496
  7497     IF INDGRPI = 'I' OR 'G'
  7498        GO TO 4070-CHECK-STATUS.
  7499
  7500 4060-IG-ERROR.
  7501     MOVE -1                     TO INDGRPL.
  7502     MOVE AL-UABON               TO INDGRPA.
  7503     MOVE ER-2152                TO EMI-ERROR.
  7504     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7505
  7506 4065-CHECK-ASSOCIATES.
  7507     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7508        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7509        MOVE  NAMEI              TO  WS-NAME-AREA
  7510     ELSE
  7511        GO TO 4070-CHECK-STATUS.
  7512
  7513     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7514        NEXT SENTENCE
  7515     ELSE
  7516        MOVE -1                  TO  NAMEL
  7517        MOVE AL-UABON            TO  NAMEA
  7518        MOVE ER-0788             TO  EMI-ERROR
  7519        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7520
  7521 4070-CHECK-STATUS.
  7522     IF STATUSL NOT GREATER ZEROS
  7523        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 145
* EL6501.cbl
  7524           GO TO 4090-CHECK-STD-AH-TYPE
  7525        ELSE
  7526           MOVE 'A'              TO STATUSI
  7527           MOVE AL-UANON         TO STATUSA
  7528           GO TO 4090-CHECK-STD-AH-TYPE.
  7529
  7530     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7531        GO TO 4090-CHECK-STD-AH-TYPE.
  7532
  7533 4080-STATUS-ERROR.
  7534     MOVE -1                     TO STATUSL.
  7535     MOVE AL-UABON               TO STATUSA.
  7536     MOVE ER-2153                TO EMI-ERROR.
  7537     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7538
  7539 4090-CHECK-STD-AH-TYPE.
  7540
  7541     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7542         GO TO 4900-EXIT.
  7543
  7544     IF STDBENL NOT GREATER ZEROS
  7545        IF MAINTI = 'C'
  7546*          GO TO 4110-CHECK-REMIT
  7547           GO TO 4100-CHECK-CLPTOLP
  7548        ELSE
  7549           MOVE ZEROS            TO STDBENI
  7550           MOVE AL-UANON         TO STDBENA
  7551*          GO TO 4110-CHECK-REMIT.
  7552           GO TO 4100-CHECK-CLPTOLP.
  7553
  7554     IF STDBENI = SPACES
  7555         MOVE ZEROS               TO STDBENI.
  7556     IF STDBENI = ZEROS
  7557*        GO TO 4110-CHECK-REMIT.
  7558         GO TO 4100-CHECK-CLPTOLP.
  7559
  7560     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7561     IF INVALID-BENEFIT-CODE
  7562        GO TO 4099-STD-BEN-ERROR.
  7563
  7564     MOVE SPACES                 TO ELCNTL-KEY.
  7565
  7566     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7567     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7568     MOVE '5'                    TO CNTL-REC-TYPE.
  7569     MOVE +0                     TO CNTL-SEQ-NO.
  7570
  7571
  7572* EXEC CICS HANDLE CONDITION
  7573*        NOTFND   (4099-STD-BEN-ERROR)
  7574*    END-EXEC.
  7575*    MOVE '"$I                   ! * #00007125' TO DFHEIV0
  7576     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7578     MOVE X'2A20233030303037313235' TO DFHEIV0(25:11)
  7579     CALL 'kxdfhei1' USING DFHEIV0
  7580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7581
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 146
* EL6501.cbl
  7582
  7583
  7584* EXEC CICS READ
  7585*        GTEQ
  7586*        DATASET   (CNTL-FILE-ID)
  7587*        SET       (ADDRESS OF CONTROL-FILE)
  7588*        RIDFLD    (ELCNTL-KEY)
  7589*    END-EXEC.
  7590*    MOVE '&"S        G          (   #00007129' TO DFHEIV0
  7591     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7592     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7593     MOVE X'2020233030303037313239' TO DFHEIV0(25:11)
  7594     CALL 'kxdfhei1' USING DFHEIV0,
  7595           CNTL-FILE-ID,
  7596           DFHEIV20,
  7597           DFHEIV99,
  7598           ELCNTL-KEY,
  7599           DFHEIV99,
  7600           DFHEIV99,
  7601           DFHEIV99
  7602     SET ADDRESS OF CONTROL-FILE TO
  7603         DFHEIV20
  7604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7605
  7606
  7607     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7608        CNTL-REC-TYPE = CF-RECORD-TYPE
  7609         MOVE 1                  TO SUB
  7610     ELSE
  7611         GO TO 4099-STD-BEN-ERROR.
  7612
  7613 4095-CHECK-BEN-TYPE.
  7614     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7615*       GO TO 4110-CHECK-REMIT.
  7616        GO TO 4100-CHECK-CLPTOLP.
  7617
  7618     IF SUB LESS 8
  7619         ADD 1 TO SUB
  7620         GO TO 4095-CHECK-BEN-TYPE.
  7621
  7622 4099-STD-BEN-ERROR.
  7623     MOVE -1                     TO STDBENL.
  7624     MOVE AL-UABON               TO STDBENA.
  7625     MOVE ER-0250                TO EMI-ERROR.
  7626     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7627
  7628 4100-CHECK-CLPTOLP.
  7629
  7630     IF CLPTOLPL > ZERO
  7631
  7632* EXEC CICS BIF
  7633*            DEEDIT
  7634*            FIELD    (CLPTOLPI)
  7635*            LENGTH   (6)
  7636*        END-EXEC
  7637     MOVE 6
  7638       TO DFHEIV11
  7639*    MOVE '@"L                   #   #00007160' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 147
* EL6501.cbl
  7640     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7641     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7642     MOVE X'2020233030303037313630' TO DFHEIV0(25:11)
  7643     CALL 'kxdfhei1' USING DFHEIV0,
  7644           CLPTOLPI,
  7645           DFHEIV11
  7646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7647         IF CLPTOLPI NOT NUMERIC
  7648             MOVE ER-1778        TO EMI-ERROR
  7649             MOVE -1             TO CLPTOLPL
  7650             MOVE AL-UNBON       TO CLPTOLPA
  7651             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7652         END-IF
  7653     END-IF.
  7654     IF LCOMML > ZERO
  7655
  7656* EXEC CICS BIF
  7657*            DEEDIT
  7658*            FIELD    (LCOMMI)
  7659*            LENGTH   (8)
  7660*        END-EXEC
  7661     MOVE 8
  7662       TO DFHEIV11
  7663*    MOVE '@"L                   #   #00007173' TO DFHEIV0
  7664     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7665     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7666     MOVE X'2020233030303037313733' TO DFHEIV0(25:11)
  7667     CALL 'kxdfhei1' USING DFHEIV0,
  7668           LCOMMI,
  7669           DFHEIV11
  7670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7671         IF LCOMMI NOT NUMERIC
  7672             MOVE ER-1778        TO EMI-ERROR
  7673             MOVE -1             TO LCOMML
  7674             MOVE AL-UNBON       TO LCOMMA
  7675             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7676         END-IF
  7677     END-IF
  7678     IF MAXMFEEL > ZEROS
  7679
  7680* EXEC CICS BIF DEEDIT
  7681*          FIELD   (MAXMFEEI)
  7682*          LENGTH  (5)
  7683*       END-EXEC
  7684     MOVE 5
  7685       TO DFHEIV11
  7686*    MOVE '@"L                   #   #00007186' TO DFHEIV0
  7687     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7688     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7689     MOVE X'2020233030303037313836' TO DFHEIV0(25:11)
  7690     CALL 'kxdfhei1' USING DFHEIV0,
  7691           MAXMFEEI,
  7692           DFHEIV11
  7693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7694        IF MAXMFEEI NUMERIC
  7695           MOVE MAXMFEEI         TO WS-WORK-FIELD
  7696           MOVE WS-WORK-NUM      TO MAXMFEEO
  7697        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 148
* EL6501.cbl
  7698           MOVE -1               TO MAXMFEEL
  7699           MOVE AL-UABON         TO MAXMFEEA
  7700           MOVE ER-7717          TO EMI-ERROR
  7701           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7702        END-IF
  7703     END-IF
  7704     IF (CLPSTL > 0)
  7705        IF (CLPSTI NOT = SPACES)
  7706           MOVE SPACES           TO ELCNTL-KEY
  7707           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7708           MOVE '3'              TO CNTL-REC-TYPE
  7709           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7710           MOVE +0               TO CNTL-SEQ-NO
  7711
  7712* EXEC CICS  READ
  7713*              DATASET  ('ELCNTL')
  7714*              SET      (ADDRESS OF CONTROL-FILE)
  7715*              RIDFLD   (ELCNTL-KEY)
  7716*              RESP     (WS-RESPONSE)
  7717*          END-EXEC
  7718     MOVE 'ELCNTL' TO DFHEIV1
  7719*    MOVE '&"S        E          (  N#00007207' TO DFHEIV0
  7720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7721     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7722     MOVE X'204E233030303037323037' TO DFHEIV0(25:11)
  7723     CALL 'kxdfhei1' USING DFHEIV0,
  7724           DFHEIV1,
  7725           DFHEIV20,
  7726           DFHEIV99,
  7727           ELCNTL-KEY,
  7728           DFHEIV99,
  7729           DFHEIV99,
  7730           DFHEIV99
  7731     SET ADDRESS OF CONTROL-FILE TO
  7732         DFHEIV20
  7733     MOVE EIBRESP  TO WS-RESPONSE
  7734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7735           IF NOT RESP-NORMAL
  7736              MOVE ER-0144       TO EMI-ERROR
  7737              MOVE -1            TO CLPSTL
  7738              MOVE AL-UABON      TO CLPSTA
  7739              PERFORM 9900-ERROR-FORMAT
  7740                                 THRU  9900-EXIT
  7741           END-IF
  7742        ELSE
  7743           MOVE ER-0144          TO EMI-ERROR
  7744           MOVE -1               TO CLPSTL
  7745           MOVE AL-UABON         TO CLPSTA
  7746           PERFORM 9900-ERROR-FORMAT
  7747                                 THRU  9900-EXIT
  7748        END-IF
  7749     END-IF
  7750     .
  7751 4110-CHECK-REMIT.
  7752     IF REMITL NOT GREATER ZEROS
  7753        MOVE 1                   TO REMITI
  7754        MOVE AL-UNNON            TO REMITA
  7755        GO TO 4120-REMIT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 149
* EL6501.cbl
  7756
  7757     IF (REMITI NOT NUMERIC)  OR
  7758        (REMITI LESS 1 OR GREATER 10)
  7759           GO TO 4120-REMIT-ERROR.
  7760
  7761 4115-CHECK-AGENT.
  7762     SET M-INDEX                 TO REMITI.
  7763
  7764     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7765        MOVE ER-2156             TO EMI-ERROR
  7766        GO TO 4120-R-ERROR.
  7767
  7768     GO TO 4130-CHECK-CONTRACT.
  7769
  7770 4120-REMIT-ERROR.
  7771     MOVE ER-2155                TO EMI-ERROR.
  7772
  7773 4120-R-ERROR.
  7774     MOVE -1                     TO REMITL.
  7775     MOVE AL-UABON               TO REMITA.
  7776     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7777
  7778 4130-CHECK-CONTRACT.
  7779     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  7780        MOVE CONTRI                TO DEEDIT-FIELD
  7781        PERFORM 8600-DEEDIT
  7782        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7783        MOVE '4'                    TO DC-OPTION-CODE
  7784        PERFORM 9700-DATE-LINK
  7785        IF DATE-CONVERSION-ERROR
  7786           MOVE ER-2157             TO EMI-ERROR
  7787           MOVE -1                  TO CONTRL
  7788           MOVE AL-UABON            TO CONTRA
  7789           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7790        ELSE
  7791***  Y2K PROJ 7744
  7792           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  7793           MOVE AL-UANON            TO CONTRA
  7794           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  7795           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  7796        END-IF
  7797     END-IF.
  7798***  Y2K PROJ 7744
  7799
  7800     IF PI-COMPANY-ID = 'DMD'
  7801       IF PI-MAINT = 'A'
  7802        IF CONTRL = ZERO
  7803           MOVE ER-0852             TO EMI-ERROR
  7804           MOVE -1                  TO CONTRL
  7805           MOVE AL-UABON            TO CONTRA
  7806           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7807
  7808*4131-CHECK-PSI-FACTOR.
  7809*    IF PSILFFL GREATER +0
  7810*       MOVE PSILFFI             TO DEEDIT-FIELD
  7811*       PERFORM 8600-DEEDIT
  7812*       IF DEEDIT-FIELD NUMERIC
  7813*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 150
* EL6501.cbl
  7814*                                   PSILFFO
  7815*       ELSE
  7816*          MOVE ER-9999          TO EMI-ERROR
  7817*          MOVE -1               TO PSILFFL
  7818*          MOVE AL-UABON         TO PSILFFA
  7819*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7820*
  7821*    IF PSIAHFL GREATER +0
  7822*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7823*       PERFORM 8600-DEEDIT
  7824*       IF DEEDIT-FIELD NUMERIC
  7825*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  7826*                                   PSIAHFO
  7827*       ELSE
  7828*          MOVE ER-9999          TO EMI-ERROR
  7829*          MOVE -1               TO PSIAHFL
  7830*          MOVE AL-UABON         TO PSIAHFA
  7831*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7832
  7833 4135-CHECK-PREVIOUS-DATES.
  7834     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  7835        MOVE PEFFDTEI              TO DEEDIT-FIELD
  7836        PERFORM 8600-DEEDIT
  7837        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7838        MOVE '4'                    TO DC-OPTION-CODE
  7839        PERFORM 9700-DATE-LINK
  7840        IF DATE-CONVERSION-ERROR
  7841           MOVE ER-0348             TO EMI-ERROR
  7842           MOVE -1                  TO PEFFDTEL
  7843           MOVE AL-UABON            TO PEFFDTEA
  7844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7845        ELSE
  7846***  Y2K PROJ 7744
  7847           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  7848           MOVE AL-UANON            TO PEFFDTEA
  7849           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  7850           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  7851        END-IF
  7852     END-IF.
  7853
  7854     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  7855        MOVE PEXPDTEI              TO DEEDIT-FIELD
  7856        PERFORM 8600-DEEDIT
  7857        IF DEEDIT-FIELD-V0 NOT LESS 999999
  7858           MOVE '99/99/99'             TO PEXPDTEO
  7859           MOVE 99999999999            TO WS-PEXP-DT
  7860           MOVE AL-UANON               TO PEXPDTEA
  7861        ELSE
  7862           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7863           MOVE '4'                    TO DC-OPTION-CODE
  7864           PERFORM 9700-DATE-LINK
  7865           IF DATE-CONVERSION-ERROR
  7866              MOVE ER-0454             TO EMI-ERROR
  7867              MOVE -1                  TO PEXPDTEL
  7868              MOVE AL-UABON            TO PEXPDTEA
  7869              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7870           ELSE
  7871              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 151
* EL6501.cbl
  7872              MOVE AL-UANON            TO PEXPDTEA
  7873              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  7874              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  7875           END-IF
  7876        END-IF
  7877     END-IF.
  7878***  Y2K PROJ 7744
  7879
  7880     IF COMMCALL NOT GREATER ZEROS
  7881         GO TO 4150-CHECK-REINCAL.
  7882
  7883     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  7884         (EFFCHG-SAVE LESS 841101)       AND
  7885         (COMMCALI = 'Y' OR '1')         AND
  7886         (NOT MODIFY-CAP)
  7887           MOVE -1               TO COMMCALL
  7888           MOVE AL-UABON         TO COMMCALA
  7889           MOVE ER-2189          TO EMI-ERROR
  7890           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7891
  7892     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  7893         GO TO 4150-CHECK-REINCAL.
  7894
  7895 4140-COMMCAL-ERROR.
  7896     MOVE -1                     TO COMMCALL.
  7897     MOVE AL-UABON               TO COMMCALA.
  7898     MOVE ER-2158                TO EMI-ERROR.
  7899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7900
  7901 4150-CHECK-REINCAL.
  7902     IF REINCALL NOT GREATER ZEROS
  7903         GO TO 4170-CHECK-REINTAB.
  7904
  7905     IF REINCALI = 'Y' OR 'N'
  7906        GO TO 4170-CHECK-REINTAB.
  7907
  7908 4160-REINCAL-ERROR.
  7909     MOVE -1                     TO REINCALL.
  7910     MOVE AL-UABON               TO REINCALA.
  7911     MOVE ER-2179                TO EMI-ERROR.
  7912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7913
  7914 4170-CHECK-REINTAB.
  7915     IF REINTABL NOT GREATER ZEROS
  7916        IF PI-COMPANY-ID = 'NCL' AND
  7917           MAINTI = 'A'
  7918                MOVE ER-4010         TO EMI-ERROR
  7919                MOVE -1              TO REINTABL
  7920                MOVE AL-UABON        TO REINTABA
  7921                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7922
  7923     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  7924         GO TO 4410-CHECK-AGENTS.
  7925     IF PI-COMPANY-ID = 'CID'
  7926        IF PI-ACCT-STATE = 'KY'
  7927           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  7928              MOVE -1            TO REINTABL
  7929              MOVE AL-UABON      TO REINTABA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 152
* EL6501.cbl
  7930              MOVE ER-2159       TO EMI-ERROR
  7931              PERFORM 9900-ERROR-FORMAT
  7932                                 THRU 9900-EXIT
  7933           END-IF
  7934        END-IF
  7935     END-IF
  7936     MOVE LOW-VALUES             TO REIN-KEY.
  7937
  7938     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  7939     MOVE 'A'                    TO REIN-CODE.
  7940     MOVE REINTABI               TO REIN-TABLE.
  7941
  7942
  7943* EXEC CICS HANDLE CONDITION
  7944*        NOTFND   (4180-REIN-ERROR)
  7945*    END-EXEC.
  7946*    MOVE '"$I                   ! + #00007420' TO DFHEIV0
  7947     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7949     MOVE X'2B20233030303037343230' TO DFHEIV0(25:11)
  7950     CALL 'kxdfhei1' USING DFHEIV0
  7951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7952
  7953
  7954
  7955* EXEC CICS READ
  7956*        DATASET   (REIN-FILE-ID)
  7957*        SET       (ADDRESS OF REINSURANCE-RECORD)
  7958*        RIDFLD    (REIN-KEY)
  7959*    END-EXEC.
  7960*    MOVE '&"S        E          (   #00007424' TO DFHEIV0
  7961     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7962     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7963     MOVE X'2020233030303037343234' TO DFHEIV0(25:11)
  7964     CALL 'kxdfhei1' USING DFHEIV0,
  7965           REIN-FILE-ID,
  7966           DFHEIV20,
  7967           DFHEIV99,
  7968           REIN-KEY,
  7969           DFHEIV99,
  7970           DFHEIV99,
  7971           DFHEIV99
  7972     SET ADDRESS OF REINSURANCE-RECORD TO
  7973         DFHEIV20
  7974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7975
  7976
  7977     GO TO 4410-CHECK-AGENTS.
  7978
  7979 4180-REIN-ERROR.
  7980     MOVE -1                     TO REINTABL.
  7981     MOVE AL-UABON               TO REINTABA.
  7982     MOVE ER-2615                TO EMI-ERROR.
  7983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7984
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 153
* EL6501.cbl
  7986 4410-CHECK-AGENTS.
  7987     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  7988     SET M-INDEX TO 1.
  7989
  7990     IF PI-COMPANY-ID = 'NCL'
  7991       IF AGENTL (M-INDEX) GREATER ZEROS
  7992         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  7993
  7994 4420-LOOP.
  7995     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  7996        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  7997            ATYPE  (M-INDEX) NOT = SPACES)  OR
  7998           SINGLEL (M-INDEX) GREATER ZEROS  OR
  7999           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8000           A-HL    (M-INDEX) GREATER ZEROS  OR
  8001           RECALL  (M-INDEX) GREATER ZEROS  OR
  8002           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8003           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8004           GLCODEL (M-INDEX) GREATER ZEROS
  8005           MOVE ER-2172          TO EMI-ERROR
  8006           MOVE -1               TO AGENTL (M-INDEX)
  8007           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8008           GO TO 4450-BUMP-INDEX
  8009        ELSE
  8010           GO TO 4450-BUMP-INDEX.
  8011
  8012     IF AGENT (M-INDEX) = ZEROS
  8013         MOVE ER-2970            TO  EMI-ERROR
  8014         MOVE -1                 TO  AGENTL (M-INDEX)
  8015         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8017         GO TO 4450-BUMP-INDEX.
  8018
  8019     IF ATYPEL (M-INDEX) = ZEROS
  8020        MOVE -1                  TO ATYPEL (M-INDEX)
  8021        MOVE ER-2173             TO EMI-ERROR
  8022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8023        GO TO 4430-CHECK-SINGLE.
  8024
  8025     IF ATYPE (M-INDEX) = 'C'
  8026        ADD 1                    TO WS-ACCOUNT-CTR-C
  8027       ELSE
  8028        IF ATYPE (M-INDEX) = 'R'
  8029           ADD 1                 TO WS-ACCOUNT-CTR-R
  8030          ELSE
  8031           IF ATYPE (M-INDEX) = 'D'
  8032              ADD 1                 TO WS-ACCOUNT-CTR-D
  8033             ELSE
  8034              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8035                                OR 'B' OR 'I' OR 'K' OR 'L'
  8036                                OR 'J' OR 'M' OR 'A' OR 'N'
  8037                 NEXT SENTENCE
  8038                ELSE
  8039                 IF ATYPE (M-INDEX) = SPACES
  8040                    NEXT SENTENCE
  8041                   ELSE
  8042                    MOVE ER-2175       TO EMI-ERROR
  8043                    MOVE -1            TO ATYPEL (M-INDEX)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 154
* EL6501.cbl
  8044                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8045                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8046
  8047 4430-CHECK-SINGLE.
  8048     IF SINGLEL (M-INDEX) GREATER ZEROS
  8049        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8050           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8051           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8052           MOVE LOW-VALUES                 TO COMM-FILLER
  8053           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8054           IF COMMISSION-ERROR
  8055              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8056              MOVE -1            TO SINGLEL (M-INDEX)
  8057           ELSE
  8058            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8059              MOVE -1            TO MAINTL
  8060              MOVE ER-1884       TO EMI-ERROR
  8061              PERFORM 9900-ERROR-FORMAT
  8062                                 THRU 9900-EXIT
  8063            END-IF
  8064           END-IF
  8065        END-IF
  8066     END-IF
  8067
  8068     IF JOINTL (M-INDEX) GREATER ZEROS
  8069        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8070           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  8071           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8072           MOVE LOW-VALUES                 TO COMM-FILLER
  8073           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8074           IF COMMISSION-ERROR
  8075              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8076              MOVE -1            TO JOINTL (M-INDEX)
  8077           ELSE
  8078            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  8079              MOVE -1            TO MAINTL
  8080              MOVE ER-1885       TO EMI-ERROR
  8081              PERFORM 9900-ERROR-FORMAT
  8082                                 THRU 9900-EXIT
  8083            END-IF
  8084           END-IF
  8085        END-IF
  8086     END-IF
  8087
  8088     IF A-HL (M-INDEX) GREATER ZEROS
  8089        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8090           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8091           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8092           MOVE LOW-VALUES                 TO COMM-FILLER
  8093           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8094           IF COMMISSION-ERROR
  8095              MOVE AL-UABON      TO A-HA (M-INDEX)
  8096              MOVE -1            TO A-HL (M-INDEX)
  8097           ELSE
  8098            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  8099              MOVE -1            TO MAINTL
  8100              MOVE ER-1886       TO EMI-ERROR
  8101              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 155
* EL6501.cbl
  8102                                 THRU 9900-EXIT
  8103            END-IF
  8104           END-IF
  8105        END-IF
  8106     END-IF
  8107
  8108     IF RECALL (M-INDEX) GREATER ZEROS
  8109         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8110             MOVE AL-UANON       TO RECALA (M-INDEX)
  8111         ELSE
  8112             MOVE -1             TO RECALL (M-INDEX)
  8113             MOVE AL-UABON       TO RECALA (M-INDEX)
  8114             MOVE ER-2158        TO EMI-ERROR
  8115             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8116
  8117     IF RCOMML (M-INDEX) GREATER ZEROS
  8118         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8119             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8120         ELSE
  8121             MOVE -1             TO RCOMML (M-INDEX)
  8122             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8123             MOVE ER-0625        TO EMI-ERROR
  8124             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8125
  8126     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8127         IF  CHGBCK (M-INDEX)    NUMERIC
  8128             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8129         ELSE
  8130             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8131             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8132             MOVE  ER-0759         TO  EMI-ERROR
  8133             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8134
  8135     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8136         IF  GLCODE (M-INDEX)    NUMERIC
  8137             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8138         ELSE
  8139             MOVE  -1              TO  GLCODEL (M-INDEX)
  8140             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8141             MOVE  ER-0759         TO  EMI-ERROR
  8142             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8143
  8144     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8145        AND 'J'
  8146         GO TO 4450-BUMP-INDEX.
  8147
  8148     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8149         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8150
  8151     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8152         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8153
  8154     IF A-H-COMM-R (M-INDEX) NUMERIC
  8155        ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8156     END-IF
  8157     .
  8158 4450-BUMP-INDEX.
  8159     SET M-INDEX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 156
* EL6501.cbl
  8160
  8161     IF M-INDEX NOT = 11
  8162        GO TO 4420-LOOP.
  8163
  8164     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8165        WS-ACCOUNT-CTR-D = ZEROS AND
  8166        WS-ACCOUNT-CTR-R = ZEROS
  8167          MOVE ER-2177             TO EMI-ERROR
  8168          MOVE -1                  TO AGENTL (1)
  8169          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8170          GO TO 4900-EXIT.
  8171
  8172     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8173         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8174        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8175         WS-ACCOUNT-CTR-D  GREATER 0)
  8176           MOVE ER-2174             TO EMI-ERROR
  8177           MOVE -1                  TO AGENTL (1)
  8178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8179           GO TO 4900-EXIT.
  8180
  8181     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8182        WS-ACCOUNT-CTR-R GREATER 1 OR
  8183        WS-ACCOUNT-CTR-D GREATER 1
  8184          MOVE ER-2182             TO EMI-ERROR
  8185          MOVE -1                  TO AGENTL (1)
  8186          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8187          GO TO 4900-EXIT.
  8188
  8189
  8190     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8191         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8192
  8193     IF WS-ST-COMM-CAP-SL = ZEROS
  8194        CONTINUE
  8195     ELSE
  8196      IF SINGLE-COMM-R (1) NUMERIC
  8197        IF (WS-LIMIT-TO-ACCOUNT AND
  8198           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8199                       OR
  8200           (NOT WS-LIMIT-TO-ACCOUNT AND
  8201           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8202           MOVE -1               TO MAINTL
  8203           MOVE ER-1884          TO EMI-ERROR
  8204           PERFORM 9900-ERROR-FORMAT
  8205                                 THRU 9900-EXIT
  8206        END-IF
  8207*     ELSE
  8208*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8209*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8210*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8211*       MOVE LOW-VALUES          TO COMM-FILLER
  8212*       PERFORM 6400-READ-COMMISSION
  8213*                                THRU 6459-EXIT
  8214*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8215*          MOVE -1               TO MAINTL
  8216*          MOVE ER-1884          TO EMI-ERROR
  8217*          PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 157
* EL6501.cbl
  8218*                                THRU 9900-EXIT
  8219*       END-IF
  8220      END-IF
  8221     END-IF
  8222
  8223     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8224        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8225     END-IF
  8226
  8227     IF WS-ST-COMM-CAP-JL = ZEROS
  8228        CONTINUE
  8229     ELSE
  8230        IF JOINT-COMM-R (1) NUMERIC
  8231           IF (WS-LIMIT-TO-ACCOUNT AND
  8232              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8233                       OR
  8234              (NOT WS-LIMIT-TO-ACCOUNT AND
  8235               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8236               MOVE -1           TO MAINTL
  8237               MOVE ER-1885      TO EMI-ERROR
  8238               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8239           END-IF
  8240*       ELSE
  8241*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8242*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8243*          MOVE PI-LIFE-OVERRIDE-L1
  8244*                                TO COMM-LF-AH
  8245*          MOVE LOW-VALUES       TO COMM-FILLER
  8246*          PERFORM 6400-READ-COMMISSION
  8247*                                THRU 6459-EXIT
  8248*          IF EXCEEDS-STATE-MAX
  8249*             MOVE ER-1885       TO EMI-ERROR
  8250*             PERFORM 9900-ERROR-FORMAT
  8251*                                THRU 9900-EXIT
  8252*          END-IF
  8253        END-IF
  8254     END-IF
  8255
  8256     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8257        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8258     END-IF
  8259
  8260     IF WS-ST-COMM-CAP-SA = ZEROS
  8261        CONTINUE
  8262     ELSE
  8263        IF A-H-COMM-R (1) NUMERIC
  8264           IF (WS-LIMIT-TO-ACCOUNT AND
  8265              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8266                           OR
  8267              (NOT WS-LIMIT-TO-ACCOUNT AND
  8268              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8269              MOVE -1            TO MAINTL
  8270              MOVE ER-1886       TO EMI-ERROR
  8271              PERFORM 9900-ERROR-FORMAT
  8272                                 THRU 9900-EXIT
  8273           END-IF
  8274*       ELSE
  8275*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 158
* EL6501.cbl
  8276*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8277*          MOVE PI-AH-OVERRIDE-L1
  8278*                                TO COMM-LF-AH
  8279*          MOVE LOW-VALUES       TO COMM-FILLER
  8280*          PERFORM 6400-READ-COMMISSION
  8281*                                THRU 6459-EXIT
  8282*          IF EXCEEDS-STATE-MAX
  8283*             MOVE ER-1886       TO EMI-ERROR
  8284*             PERFORM 9900-ERROR-FORMAT
  8285*                                THRU 9900-EXIT
  8286*          END-IF
  8287        END-IF
  8288     END-IF
  8289
  8290     IF MAINTI NOT = 'C'
  8291        GO TO 4900-EXIT.
  8292
  8293     IF NOT PI-GA-BILLING
  8294        GO TO 4900-EXIT.
  8295
  8296 4460-CHECK-IF-GA-BILLED.
  8297     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8298
  8299     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8300     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8301     SET M-INDEX TO +1.
  8302     MOVE +1 TO AXRF-SUB.
  8303
  8304 4470-GA-LOOP.
  8305     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8306        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8307        SINGLEL (M-INDEX) GREATER ZERO                OR
  8308        JOINTL  (M-INDEX) GREATER ZERO                OR
  8309        A-HL    (M-INDEX) GREATER ZERO                OR
  8310        RCOMML  (M-INDEX) GREATER ZERO                OR
  8311        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8312        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8313        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8314           MOVE ER-2131   TO EMI-ERROR
  8315           MOVE -1        TO AGENTL (M-INDEX)
  8316           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8317           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8318
  8319     ADD +1 TO AXRF-SUB.
  8320     SET M-INDEX UP BY +1.
  8321
  8322     IF AXRF-SUB NOT = +11
  8323        GO TO 4470-GA-LOOP.
  8324
  8325 4900-EXIT.
  8326      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 159
* EL6501.cbl
  8328 5000-MOVE-TO-RECORD.
  8329
  8330     IF NAMEL   GREATER THAN ZERO  OR
  8331        INCAREL GREATER THAN ZERO  OR
  8332        ADDR1L  GREATER THAN ZERO  OR
  8333        ACITYL  GREATER THAN ZERO  OR
  8334        ASTATEL GREATER THAN ZERO  OR
  8335        ZIPL    GREATER THAN ZERO  OR
  8336        PHONEL  GREATER THAN ZERO  OR
  8337        TAXNOL  GREATER THAN ZERO
  8338         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8339
  8340     IF CSRL GREATER ZEROS
  8341        MOVE CSRI                TO AM-CSR-CODE.
  8342     IF NAMEL GREATER ZEROS
  8343        MOVE NAMEI               TO AM-NAME.
  8344     IF PCONTL GREATER ZEROS
  8345        MOVE PCONTI              TO AM-CONTROL-NAME
  8346     END-IF
  8347     IF INCAREL GREATER ZEROS
  8348        MOVE INCAREI             TO AM-PERSON.
  8349     IF ADDR1L GREATER ZEROS
  8350        MOVE ADDR1I              TO AM-ADDRS.
  8351     IF TAXNOL GREATER ZEROS
  8352        MOVE TAXNOI              TO AM-ID-NO.
  8353     IF PHONEL GREATER ZEROS
  8354        MOVE PHONEI              TO DEEDIT-FIELD
  8355        PERFORM 8600-DEEDIT
  8356        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8357        MOVE WS-PH1              TO AM-AREA-CODE
  8358        MOVE WS-PH2              TO AM-TEL-PRE
  8359        MOVE WS-PH3              TO AM-TEL-NBR.
  8360
  8361     IF ACITYL GREATER ZEROS
  8362        MOVE ACITYI             TO AM-ADDR-CITY.
  8363     IF ASTATEL GREATER ZEROS
  8364        MOVE ASTATEI            TO AM-ADDR-STATE.
  8365
  8366     IF ZIPL NOT GREATER ZEROS
  8367         GO TO 5010-CONT-MOVING.
  8368
  8369     MOVE ZIPI                   TO WS-ZIP-CODE.
  8370
  8371     IF WS-CANADIAN-ZIP
  8372         IF WS-ZIP-4 = SPACE  OR  '-'
  8373             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8374             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8375         ELSE
  8376             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8377             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8378     ELSE
  8379         IF WS-ZIP-6 = SPACE  OR  '-'
  8380             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8381             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8382         ELSE
  8383             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8384             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8385
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 160
* EL6501.cbl
  8386 5010-CONT-MOVING.
  8387     IF TYPEL GREATER ZEROS
  8388        MOVE TYPEI               TO AM-GPCD.
  8389
  8390     IF STDBENL GREATER ZEROS
  8391        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8392
  8393     IF INDGRPL GREATER ZEROS
  8394        MOVE INDGRPI             TO AM-IG
  8395        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8396
  8397     IF STATUSL GREATER ZEROS
  8398        MOVE STATUSI             TO AM-STATUS
  8399        INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8400     END-IF
  8401
  8402     IF CLPTOLPL GREATER ZEROS
  8403        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8404     END-IF.
  8405
  8406     IF PRODCDL > 0
  8407        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8408     END-IF
  8409     IF CLPSTL > 0
  8410        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8411     END-IF
  8412     IF MAXMFEEL > ZEROS
  8413        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8414     END-IF
  8415     IF LCOMML > ZEROS
  8416        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8417     END-IF
  8418
  8419     IF REMITL GREATER ZEROS
  8420        MOVE REMITI              TO AM-REMIT-TO.
  8421     IF CONTRL GREATER ZEROS
  8422        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8423*    IF PSILFFL GREATER +0
  8424*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8425*    IF PSIAHFL GREATER +0
  8426*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8427     IF PEFFDTEL GREATER ZEROS
  8428        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8429     IF PEXPDTEL GREATER ZEROS
  8430        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8431     IF COMMCALL GREATER ZEROS
  8432        MOVE COMMCALI            TO AM-RECALC-COMM
  8433        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8434     ELSE
  8435         IF MAINTI = 'A'
  8436             MOVE 'N'            TO AM-RECALC-COMM.
  8437
  8438     IF REINCALL GREATER ZEROS
  8439        MOVE REINCALI            TO AM-RECALC-REIN
  8440     ELSE
  8441         IF MAINTI = 'A'
  8442             MOVE 'N'            TO AM-RECALC-REIN.
  8443
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 161
* EL6501.cbl
  8444     IF REINTABL GREATER ZEROS
  8445        MOVE REINTABI            TO AM-REI-TABLE.
  8446
  8447     IF PI-MAINT = 'A'
  8448        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8449     END-IF
  8450
  8451     MOVE 1                      TO SUB.
  8452     SET M-INDEX                 TO 1.
  8453
  8454
  8455* EXEC CICS
  8456*         ASKTIME
  8457*    END-EXEC.
  8458*    MOVE '0"                    "   #00007907' TO DFHEIV0
  8459     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8460     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8461     MOVE X'2020233030303037393037' TO DFHEIV0(25:11)
  8462     CALL 'kxdfhei1' USING DFHEIV0,
  8463           DFHEIV99
  8464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8465
  8466
  8467 5000-LOOP.
  8468*    IF PI-COMPANY-ID = 'DCC'
  8469*       IF (M-INDEX = +5)
  8470*          AND ((AGENTL (5) > ZEROS)
  8471*              OR (ATYPEL (5) > ZEROS))
  8472*             MOVE ER-3057         TO EMI-ERROR
  8473*             MOVE -1              TO AGENTL (5)
  8474*             MOVE AL-UABON        TO AGENTA (5)
  8475*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8476*             GO TO 5000-EXIT
  8477*       END-IF
  8478*    END-IF
  8479     IF MAINTI = 'C'
  8480        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8481           (COMMCALI NOT = 'Y' AND '1')                    AND
  8482            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8483           ((AM-AGT (SUB) = ZEROS AND
  8484             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8485                                     ZEROS) AND
  8486           (COMMCALI NOT = 'Y' AND '1')  AND
  8487            AM-HI-CERT-DATE NOT = ZEROS)
  8488              MOVE ER-2181         TO EMI-ERROR
  8489              MOVE -1              TO COMMCALL
  8490              MOVE AL-UABON        TO COMMCALA
  8491              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8492              GO TO 5000-EXIT.
  8493
  8494     IF MAINTI = 'C'
  8495        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8496             ATYPE (M-INDEX)) AND
  8497           (COMMCALI NOT = 'Y' AND '1') AND
  8498            AM-HI-CERT-DATE NOT = ZEROS)
  8499            OR
  8500           ((AM-COM-TYP (SUB) = SPACES AND
  8501             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 162
* EL6501.cbl
  8502           (COMMCALI NOT = 'Y' AND '1')  AND
  8503            AM-HI-CERT-DATE NOT = ZEROS)
  8504              MOVE ER-2181         TO EMI-ERROR
  8505              MOVE -1              TO COMMCALL
  8506              MOVE AL-UABON        TO COMMCALA
  8507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8508              GO TO 5000-EXIT.
  8509
  8510     IF AM-ACCOUNT-BILLED
  8511        IF COMMCALI = 'Y' OR '1'
  8512            MOVE ER-2183         TO EMI-ERROR
  8513            MOVE -1              TO COMMCALL
  8514            MOVE AL-UABON        TO COMMCALA
  8515            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8516            GO TO 5000-EXIT.
  8517
  8518     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8519        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8520        OR
  8521        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8522         ATYPE  (M-INDEX) = SPACES)
  8523           MOVE ZEROS              TO AM-AGT   (SUB)
  8524                                      AM-L-COM (SUB)
  8525                                      AM-J-COM (SUB)
  8526                                      AM-A-COM (SUB)
  8527           MOVE SPACE TO AM-COM-TYP (SUB)
  8528           SET M-INDEX UP BY 1
  8529           ADD 1 TO SUB
  8530           IF SUB = 11
  8531              GO TO 5000-CHECK-MAX-FEES
  8532            ELSE
  8533              GO TO 5000-LOOP.
  8534
  8535     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8536     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8537
  8538     IF SINGLEL (M-INDEX) GREATER ZEROS
  8539        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8540        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8541           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8542          ELSE
  8543           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8544           IF SINGLE-DASH (M-INDEX) = '-'
  8545               MULTIPLY AM-L-COM (SUB) BY -1
  8546                     GIVING AM-L-COM (SUB).
  8547
  8548     IF JOINTL (M-INDEX) GREATER ZEROS
  8549        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8550        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8551           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8552          ELSE
  8553           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8554           IF JOINT-DASH (M-INDEX) = '-'
  8555               MULTIPLY AM-J-COM (SUB) BY -1
  8556                     GIVING AM-J-COM (SUB).
  8557
  8558     IF A-HL (M-INDEX) GREATER ZEROS
  8559        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 163
* EL6501.cbl
  8560        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8561           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8562          ELSE
  8563           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8564           IF A-H-DASH (M-INDEX) = '-'
  8565               MULTIPLY AM-A-COM (SUB) BY -1
  8566                     GIVING AM-A-COM (SUB).
  8567
  8568     IF RECALL (M-INDEX) GREATER ZEROS
  8569         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8570
  8571     IF RCOMML (M-INDEX) GREATER ZEROS
  8572         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8573
  8574     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8575         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8576
  8577     IF GLCODEL (M-INDEX) GREATER ZEROS
  8578         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8579
  8580     SET M-INDEX UP BY 1.
  8581     ADD 1 TO SUB.
  8582     IF M-INDEX NOT = 11
  8583        GO TO 5000-LOOP.
  8584
  8585 5000-CHECK-MAX-FEES.
  8586     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8587        MOVE +1                     TO S1
  8588        PERFORM UNTIL S1 > +10
  8589           IF (AM-A-COM (S1) NUMERIC)
  8590              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8591                     AND 'O')
  8592              AND (AM-COM-TYP (S1) = 'J')
  8593                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8594                    + (AM-A-COM (S1) * +1000)
  8595           END-IF
  8596           ADD +1             TO S1
  8597        END-PERFORM
  8598        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8599           MOVE -1               TO MAXMFEEL
  8600           MOVE AL-UABON         TO MAXMFEEA
  8601           MOVE ER-1817          TO EMI-ERROR
  8602           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8603        END-IF
  8604     END-IF
  8605     .
  8606 5000-EXIT.
  8607      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 164
* EL6501.cbl
  8609
  8610 5100-WRITE-TS.
  8611     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8612
  8613     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8614         MOVE ZEROS              TO PI-CR-CARRIER
  8615     ELSE
  8616         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8617
  8618     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8619         MOVE ZEROS              TO PI-CR-GROUPING
  8620     ELSE
  8621         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8622
  8623     IF AM-REMIT-TO NOT = ZERO
  8624         MOVE AM-AGT (AM-REMIT-TO)
  8625                                 TO PI-CR-FIN-RESP
  8626       ELSE
  8627         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8628
  8629     MOVE 'A'                    TO PI-CR-TYPE.
  8630 5110-AGT-LOOP.
  8631     ADD 1                       TO  AGT-SUB.
  8632     IF AGT-SUB GREATER 10
  8633         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8634         GO TO 5120-WRITE.
  8635
  8636************************************************************
  8637**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8638************************************************************
  8639
  8640     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8641                  OR 'F' OR 'S' OR 'U'
  8642         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8643         GO TO 5120-WRITE
  8644     ELSE
  8645         GO TO 5110-AGT-LOOP.
  8646
  8647 5120-WRITE.
  8648
  8649* EXEC CICS WRITEQ TS
  8650*         QUEUE    (QID)
  8651*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8652*         LENGTH   (WS-COMM-LENGTH)
  8653*         ITEM     (W-ONE)
  8654*    END-EXEC.
  8655*    MOVE '*" I                  ''   #00008092' TO DFHEIV0
  8656     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8657     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8658     MOVE X'2020233030303038303932' TO DFHEIV0(25:11)
  8659     CALL 'kxdfhei1' USING DFHEIV0,
  8660           QID,
  8661           PROGRAM-INTERFACE-BLOCK,
  8662           WS-COMM-LENGTH,
  8663           W-ONE,
  8664           DFHEIV99,
  8665           DFHEIV99
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 165
* EL6501.cbl
  8667
  8668
  8669 5199-EXIT.
  8670     EXIT.
  8671
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 166
* EL6501.cbl
  8673
  8674 5200-RECOVER-TS.
  8675
  8676     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8677                                 XCTL-653 AND
  8678                                 XCTL-689 AND
  8679                                 XCTL-608 AND
  8680                                 XCTL-690
  8681         GO TO 5299-EXIT.
  8682
  8683
  8684* EXEC CICS HANDLE CONDITION
  8685*        QIDERR  (5250-QID-ERROR)
  8686*    END-EXEC.
  8687*    MOVE '"$N                   ! , #00008113' TO DFHEIV0
  8688     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8690     MOVE X'2C20233030303038313133' TO DFHEIV0(25:11)
  8691     CALL 'kxdfhei1' USING DFHEIV0
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8693
  8694
  8695
  8696* EXEC CICS READQ TS
  8697*        QUEUE    (QID)
  8698*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8699*        LENGTH   (WS-COMM-LENGTH)
  8700*        ITEM     (W-ONE)
  8701*    END-EXEC.
  8702*    MOVE '*$II   L              ''   #00008117' TO DFHEIV0
  8703     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8705     MOVE X'2020233030303038313137' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
  8707           QID,
  8708           PROGRAM-INTERFACE-BLOCK,
  8709           WS-COMM-LENGTH,
  8710           W-ONE,
  8711           DFHEIV99,
  8712           DFHEIV99
  8713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8714
  8715
  8716 5200-DELETE-TS.
  8717
  8718
  8719* EXEC CICS DELETEQ TS
  8720*        QUEUE    (QID)
  8721*    END-EXEC.
  8722*    MOVE '*&                    #   #00008126' TO DFHEIV0
  8723     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8724     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8725     MOVE X'2020233030303038313236' TO DFHEIV0(25:11)
  8726     CALL 'kxdfhei1' USING DFHEIV0,
  8727           QID,
  8728           DFHEIV99
  8729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8730
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 167
* EL6501.cbl
  8731
  8732     GO TO 5299-EXIT.
  8733
  8734 5250-QID-ERROR.
  8735     MOVE ER-0033                TO  EMI-ERROR.
  8736     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8737
  8738 5299-EXIT.
  8739     EXIT.
  8740
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 168
* EL6501.cbl
  8742
  8743 5300-UPDATE-REQUEST-FILE.
  8744     MOVE +0                     TO SUB1.
  8745
  8746 5300-FIND-ACCOUNT-AGENT.
  8747     ADD +1                      TO SUB1.
  8748
  8749     IF SUB1 GREATER THAN +10
  8750        MOVE ER-2949             TO EMI-ERROR
  8751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8752        MOVE -1                  TO AGENTL (1)
  8753
  8754* EXEC CICS SYNCPOINT ROLLBACK
  8755*       END-EXEC
  8756*    MOVE '6"R                   !   #00008151' TO DFHEIV0
  8757     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8759     MOVE X'2020233030303038313531' TO DFHEIV0(25:11)
  8760     CALL 'kxdfhei1' USING DFHEIV0
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8762        GO TO 8200-SEND-DATAONLY.
  8763
  8764     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8765
  8766************************************************************
  8767**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8768************************************************************
  8769
  8770     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
  8771        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  8772           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  8773
  8774     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  8775        GO TO 5325-PROCESS-RQST-FILE.
  8776
  8777     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  8778        GO TO 5325-PROCESS-RQST-FILE.
  8779
  8780     GO TO 5399-EXIT.
  8781
  8782 5325-PROCESS-RQST-FILE.
  8783     MOVE LOW-VALUES             TO RQST3-KEY.
  8784     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  8785     MOVE AM-CARRIER             TO RQST3-CARRIER.
  8786     MOVE AM-GROUPING            TO RQST3-GROUPING.
  8787     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  8788     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  8789
  8790
  8791* EXEC CICS HANDLE CONDITION
  8792*        NOTFND(5399-EXIT)
  8793*        ENDFILE(5399-EXIT)
  8794*    END-EXEC.
  8795*    MOVE '"$I''                  ! - #00008181' TO DFHEIV0
  8796     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8798     MOVE X'2D20233030303038313831' TO DFHEIV0(25:11)
  8799     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 169
* EL6501.cbl
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8801
  8802
  8803 5325-PROCESS-REQUEST-FILE.
  8804
  8805* EXEC CICS STARTBR
  8806*         DATASET   (RQST3-FILE-ID)
  8807*         RIDFLD    (RQST3-KEY)
  8808*    END-EXEC.
  8809     MOVE 0
  8810       TO DFHEIV11
  8811*    MOVE '&,         G          &   #00008187' TO DFHEIV0
  8812     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8813     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8814     MOVE X'2020233030303038313837' TO DFHEIV0(25:11)
  8815     CALL 'kxdfhei1' USING DFHEIV0,
  8816           RQST3-FILE-ID,
  8817           RQST3-KEY,
  8818           DFHEIV99,
  8819           DFHEIV11,
  8820           DFHEIV99
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8822
  8823
  8824 5330-READNEXT-REQUEST.
  8825
  8826* EXEC CICS READNEXT
  8827*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  8828*        DATASET(RQST3-FILE-ID)
  8829*        RIDFLD (RQST3-KEY)
  8830*    END-EXEC.
  8831     MOVE 0
  8832       TO DFHEIV11
  8833*    MOVE '&.S                   )   #00008193' TO DFHEIV0
  8834     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8835     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8836     MOVE X'2020233030303038313933' TO DFHEIV0(25:11)
  8837     CALL 'kxdfhei1' USING DFHEIV0,
  8838           RQST3-FILE-ID,
  8839           DFHEIV20,
  8840           DFHEIV99,
  8841           RQST3-KEY,
  8842           DFHEIV99,
  8843           DFHEIV11,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     SET ADDRESS OF AR-REQUEST-RECORD TO
  8847         DFHEIV20
  8848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8849
  8850
  8851     IF RQST3-KEY = SAVE-RQST3-KEY
  8852        GO TO 5330-READNEXT-REQUEST.
  8853
  8854     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  8855
  8856     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  8857        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 170
* EL6501.cbl
  8858
  8859     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  8860        GO TO 5350-REQUESTS-FINISHED.
  8861
  8862     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  8863        GO TO 5350-REQUESTS-FINISHED.
  8864
  8865     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  8866
  8867
  8868* EXEC CICS ENDBR
  8869*        DATASET(RQST3-FILE-ID)
  8870*    END-EXEC.
  8871     MOVE 0
  8872       TO DFHEIV11
  8873*    MOVE '&2                    $   #00008215' TO DFHEIV0
  8874     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8875     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8876     MOVE X'2020233030303038323135' TO DFHEIV0(25:11)
  8877     CALL 'kxdfhei1' USING DFHEIV0,
  8878           RQST3-FILE-ID,
  8879           DFHEIV11,
  8880           DFHEIV99
  8881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8882
  8883
  8884
  8885* EXEC CICS READ
  8886*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  8887*        DATASET(RQST-FILE-ID)
  8888*        RIDFLD (RQST-KEY)
  8889*        UPDATE
  8890*    END-EXEC.
  8891*    MOVE '&"S        EU         (   #00008219' TO DFHEIV0
  8892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8893     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8894     MOVE X'2020233030303038323139' TO DFHEIV0(25:11)
  8895     CALL 'kxdfhei1' USING DFHEIV0,
  8896           RQST-FILE-ID,
  8897           DFHEIV20,
  8898           DFHEIV99,
  8899           RQST-KEY,
  8900           DFHEIV99,
  8901           DFHEIV99,
  8902           DFHEIV99
  8903     SET ADDRESS OF AR-REQUEST-RECORD TO
  8904         DFHEIV20
  8905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8906
  8907
  8908     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  8909     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  8910
  8911
  8912* EXEC CICS REWRITE
  8913*        DATASET   (RQST-FILE-ID)
  8914*        FROM      (AR-REQUEST-RECORD)
  8915*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 171
* EL6501.cbl
  8916     MOVE LENGTH OF
  8917      AR-REQUEST-RECORD
  8918       TO DFHEIV11
  8919*    MOVE '&& L                  %   #00008229' TO DFHEIV0
  8920     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8921     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8922     MOVE X'2020233030303038323239' TO DFHEIV0(25:11)
  8923     CALL 'kxdfhei1' USING DFHEIV0,
  8924           RQST-FILE-ID,
  8925           AR-REQUEST-RECORD,
  8926           DFHEIV11,
  8927           DFHEIV99
  8928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8929
  8930
  8931     GO TO  5325-PROCESS-REQUEST-FILE.
  8932
  8933 5350-REQUESTS-FINISHED.
  8934
  8935* EXEC CICS ENDBR
  8936*        DATASET(RQST3-FILE-ID)
  8937*    END-EXEC.
  8938     MOVE 0
  8939       TO DFHEIV11
  8940*    MOVE '&2                    $   #00008237' TO DFHEIV0
  8941     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8943     MOVE X'2020233030303038323337' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0,
  8945           RQST3-FILE-ID,
  8946           DFHEIV11,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951 5399-EXIT.
  8952     EXIT.
  8953
  8954
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 172
* EL6501.cbl
  8956
  8957 6000-MOVE-TO-SCREEN.
  8958     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  8959
  8960     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  8961     MOVE AM-NAME                TO NAMEO.
  8962     MOVE AM-CONTROL-NAME        TO PCONTO.
  8963     MOVE AM-CSR-CODE            TO CSRO.
  8964     MOVE AM-PERSON              TO INCAREO.
  8965     MOVE AM-ADDRS               TO ADDR1O.
  8966     MOVE AM-ID-NO               TO TAXNOO.
  8967     MOVE AM-TEL-NO              TO WS-PHONE.
  8968     MOVE WS-PHONE-NUM           TO PHONEO.
  8969     INSPECT PHONEI CONVERTING SPACES TO '-'.
  8970     MOVE AM-ADDR-CITY           TO ACITYO
  8971     MOVE AM-ADDR-STATE          TO ASTATEO
  8972
  8973     MOVE SPACES                 TO WS-ZIP-CODE.
  8974     IF AM-CANADIAN-POST-CODE
  8975         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  8976         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  8977     ELSE
  8978         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  8979         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  8980             MOVE '-'            TO WS-ZIP-AM-2-DASH
  8981             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  8982
  8983     MOVE WS-ZIP-CODE            TO ZIPO.
  8984
  8985     MOVE AM-GPCD                TO TYPEO.
  8986     MOVE AM-STD-AH-TYPE         TO STDBENO.
  8987
  8988     MOVE AM-IG                  TO INDGRPO.
  8989     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  8990
  8991     MOVE AM-STATUS              TO STATUSO.
  8992     INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  8993
  8994     MOVE AM-REMIT-TO            TO REMITO.
  8995
  8996     IF PI-AR-PROCESSING
  8997        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  8998           MOVE AL-UNNON         TO REMITA
  8999        ELSE
  9000           MOVE AL-SANON         TO REMITA
  9001     ELSE
  9002        MOVE AL-UNNON            TO REMITA.
  9003
  9004***  Y2K PROJ 7744
  9005     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9006     MOVE '3'                    TO DC-OPTION-CODE.
  9007     PERFORM 9700-DATE-LINK.
  9008     IF DATE-CONVERSION-ERROR
  9009        MOVE SPACES              TO CONTRO
  9010     ELSE
  9011        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9012     END-IF.
  9013***  Y2K PROJ 7744
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 173
* EL6501.cbl
  9014
  9015*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9016*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9017
  9018*    IF AM-LF-PSI-FACTOR NUMERIC
  9019*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9020*
  9021*    IF AM-AH-PSI-FACTOR NUMERIC
  9022*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9023
  9024     MOVE AM-RECALC-COMM         TO COMMCALO.
  9025     MOVE AL-UANON               TO COMMCALA.
  9026     MOVE AM-RECALC-REIN         TO REINCALO.
  9027     MOVE AM-REI-TABLE           TO REINTABO.
  9028     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9029     MOVE '3'                    TO DC-OPTION-CODE.
  9030     PERFORM 9700-DATE-LINK.
  9031     IF DATE-CONVERSION-ERROR
  9032        MOVE SPACES              TO PRODATEO
  9033     ELSE
  9034        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9035
  9036     IF PI-COMPANY-ID = 'DCC'
  9037        IF AM-CLP-TOL-PCT NOT NUMERIC
  9038           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9039        END-IF
  9040        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9041           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9042        END-IF
  9043        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9044        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9045        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9046        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9047        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9048           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9049        END-IF
  9050        MOVE AM-DCC-MAX-MARKETING-FEE
  9051                                 TO MAXMFEEO
  9052     ELSE
  9053        MOVE AL-SADOF            TO CTPLABLA
  9054                                    CLPTOLPA
  9055                                    LCLABLA
  9056                                    LCOMMA
  9057     END-IF
  9058
  9059     IF AM-RET-Y-N = ' '  OR  'N'
  9060         MOVE 'NO '              TO RETROCDO
  9061     ELSE
  9062         MOVE 'YES'              TO RETROCDO.
  9063
  9064     IF AM-ACCOUNT-BILLED
  9065         MOVE 'YES'              TO BILLCDO
  9066     ELSE
  9067         MOVE 'NO '              TO BILLCDO.
  9068
  9069     MOVE AL-UANON               TO RETROCDA.
  9070     MOVE AL-SANON               TO PRODATEA
  9071                                    BILLCDA.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 174
* EL6501.cbl
  9072     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9073     MOVE '3' TO DC-OPTION-CODE.
  9074     PERFORM 9700-DATE-LINK.
  9075     IF DATE-CONVERSION-ERROR
  9076        MOVE SPACES TO PEFFDTEO
  9077     ELSE
  9078        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9079
  9080     IF AM-PREV-EXP-DT NOT = 99999999999
  9081        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9082        MOVE '3' TO DC-OPTION-CODE
  9083        PERFORM 9700-DATE-LINK
  9084        IF DATE-CONVERSION-ERROR
  9085           MOVE SPACES TO PEXPDTEO
  9086        ELSE
  9087           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9088     ELSE
  9089        MOVE '99/99/99' TO PEXPDTEO.
  9090
  9091     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9092        MOVE AL-UANON            TO PEXPDTEA
  9093                                    PEFFDTEA
  9094        MOVE AL-SANOF TO            PDSPLYA.
  9095
  9096     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9097     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9098     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9099
  9100     MOVE 1  TO SUB.
  9101     SET M-INDEX TO 1.
  9102
  9103 6005-LOOP.
  9104     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9105        IF PI-AR-PROCESSING
  9106           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9107              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9108                                   ATYPEA (M-INDEX)
  9109                                   SINGLEA (M-INDEX)
  9110                                   JOINTA (M-INDEX)
  9111                                   A-HA    (M-INDEX)
  9112              GO TO 6010-BUMP-SUB
  9113           ELSE
  9114              GO TO 6010-BUMP-SUB
  9115        ELSE
  9116           GO TO 6010-BUMP-SUB.
  9117
  9118     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9119
  9120***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9121     IF WS-DMD-AGENT = LOW-VALUES
  9122        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9123***DMD ******************************************************
  9124
  9125     IF PI-GA-BILLING
  9126        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9127     MOVE AL-UANON               TO AGENTA (M-INDEX).
  9128
  9129     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 175
* EL6501.cbl
  9130     IF PI-GA-BILLING
  9131        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9132     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9133
  9134     IF (AM-L-COM (SUB) NOT NUMERIC)
  9135        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9136        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9137     ELSE
  9138        IF AM-L-COM (SUB) NOT = ZEROS
  9139           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9140
  9141     IF (AM-J-COM (SUB) NOT NUMERIC)
  9142        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9143        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9144     ELSE
  9145        IF AM-J-COM (SUB) NOT = ZEROS
  9146           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9147
  9148     IF (AM-A-COM (SUB) NOT NUMERIC)
  9149        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9150        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9151     ELSE
  9152        IF AM-A-COM (SUB) NOT = ZEROS
  9153           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9154
  9155************************************************************
  9156**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9157************************************************************
  9158
  9159     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9160            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9161            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9162         GO TO 6006-CONTINUE.
  9163
  9164     IF (AM-L-COM (SUB) NUMERIC)
  9165        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9166         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9167
  9168     IF (AM-J-COM (SUB) NUMERIC)
  9169        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9170         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9171
  9172     IF (AM-A-COM (SUB) NUMERIC)
  9173        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9174        ADD AM-A-COM (SUB) TO COMM-AH-ACCUM
  9175     END-IF
  9176     .
  9177 6006-CONTINUE.
  9178     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9179         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9180
  9181     IF WS-ST-COMM-CAP-SL = ZEROS
  9182        CONTINUE
  9183     ELSE
  9184        IF (AM-L-COM (SUB) NUMERIC)
  9185           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9186           IF (WS-LIMIT-TO-ACCOUNT AND
  9187              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 176
* EL6501.cbl
  9188                       OR
  9189              (NOT WS-LIMIT-TO-ACCOUNT AND
  9190              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9191              MOVE -1            TO MAINTL
  9192              MOVE ER-1884       TO EMI-ERROR
  9193              PERFORM 9900-ERROR-FORMAT
  9194                                 THRU 9900-EXIT
  9195           END-IF
  9196        ELSE
  9197           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9198           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9199           MOVE PI-LIFE-OVERRIDE-L1
  9200                                 TO COMM-LF-AH
  9201           MOVE LOW-VALUES       TO COMM-FILLER
  9202           PERFORM 6400-READ-COMMISSION
  9203                                 THRU 6459-EXIT
  9204           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9205              MOVE -1            TO MAINTL
  9206              MOVE ER-1884       TO EMI-ERROR
  9207              PERFORM 9900-ERROR-FORMAT
  9208                                 THRU 9900-EXIT
  9209           END-IF
  9210        END-IF
  9211     END-IF
  9212
  9213     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9214         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9215
  9216     IF WS-ST-COMM-CAP-JL = ZEROS
  9217        CONTINUE
  9218     ELSE
  9219        IF (AM-J-COM (SUB) NUMERIC)
  9220           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9221           IF (WS-LIMIT-TO-ACCOUNT AND
  9222              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9223                       OR
  9224              (NOT WS-LIMIT-TO-ACCOUNT AND
  9225              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9226              MOVE -1            TO MAINTL
  9227              MOVE ER-1885       TO EMI-ERROR
  9228              PERFORM 9900-ERROR-FORMAT
  9229                                 THRU 9900-EXIT
  9230           END-IF
  9231        ELSE
  9232           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9233           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9234           MOVE PI-LIFE-OVERRIDE-L1
  9235                                 TO COMM-LF-AH
  9236           MOVE LOW-VALUES       TO COMM-FILLER
  9237           PERFORM 6400-READ-COMMISSION
  9238                                 THRU 6459-EXIT
  9239           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9240              MOVE -1            TO MAINTL
  9241              MOVE ER-1885       TO EMI-ERROR
  9242              PERFORM 9900-ERROR-FORMAT
  9243                                 THRU 9900-EXIT
  9244           END-IF
  9245        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 177
* EL6501.cbl
  9246     END-IF
  9247
  9248     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9249         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9250
  9251     IF WS-ST-COMM-CAP-SA = ZEROS
  9252        CONTINUE
  9253     ELSE
  9254        IF (AM-A-COM (SUB) NUMERIC)
  9255           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9256           IF (WS-LIMIT-TO-ACCOUNT AND
  9257              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9258                       OR
  9259              (NOT WS-LIMIT-TO-ACCOUNT AND
  9260              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9261              MOVE -1            TO MAINTL
  9262              MOVE ER-1886       TO EMI-ERROR
  9263              PERFORM 9900-ERROR-FORMAT
  9264                                 THRU 9900-EXIT
  9265           END-IF
  9266        ELSE
  9267           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9268           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9269           MOVE PI-AH-OVERRIDE-L1
  9270                                 TO COMM-LF-AH
  9271           MOVE LOW-VALUES       TO COMM-FILLER
  9272           PERFORM 6400-READ-COMMISSION
  9273                                 THRU 6459-EXIT
  9274           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9275              MOVE -1            TO MAINTL
  9276              MOVE ER-1886       TO EMI-ERROR
  9277              PERFORM 9900-ERROR-FORMAT
  9278                                 THRU 9900-EXIT
  9279           END-IF
  9280        END-IF
  9281     END-IF
  9282
  9283     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9284         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9285
  9286     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9287         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9288
  9289     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9290        NEXT SENTENCE
  9291     ELSE
  9292        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9293
  9294     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9295         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9296
  9297     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9298         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9299
  9300     IF NOT PI-AR-PROCESSING
  9301        GO TO 6010-BUMP-SUB.
  9302
  9303     IF AM-AR-HI-CERT-DATE = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 178
* EL6501.cbl
  9304        GO TO 6010-BUMP-SUB.
  9305
  9306     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9307                                   ATYPEA  (M-INDEX)
  9308                                   SINGLEA (M-INDEX)
  9309                                   JOINTA  (M-INDEX)
  9310                                   A-HA    (M-INDEX).
  9311
  9312 6010-BUMP-SUB.
  9313     ADD 1  TO SUB.
  9314     SET M-INDEX UP BY 1.
  9315     IF SUB LESS 11
  9316        GO TO 6005-LOOP.
  9317
  9318 6099-EXIT.
  9319      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 179
* EL6501.cbl
  9321 6300-STARTBR.
  9322
  9323* EXEC CICS STARTBR
  9324*         DATASET   (ACCT-FILE-ID)
  9325*         RIDFLD    (WS-KEY-SAVE)
  9326*    END-EXEC.
  9327     MOVE 0
  9328       TO DFHEIV11
  9329*    MOVE '&,         G          &   #00008612' TO DFHEIV0
  9330     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9331     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9332     MOVE X'2020233030303038363132' TO DFHEIV0(25:11)
  9333     CALL 'kxdfhei1' USING DFHEIV0,
  9334           ACCT-FILE-ID,
  9335           WS-KEY-SAVE,
  9336           DFHEIV99,
  9337           DFHEIV11,
  9338           DFHEIV99
  9339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9340
  9341
  9342     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9343
  9344 6300-EXIT.
  9345      EXIT.
  9346
  9347 6310-READNEXT.
  9348
  9349* EXEC CICS READNEXT
  9350*         DATASET    (ACCT-FILE-ID)
  9351*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9352*         RIDFLD     (WS-KEY-SAVE)
  9353*    END-EXEC.
  9354     MOVE 0
  9355       TO DFHEIV11
  9356*    MOVE '&.S                   )   #00008623' TO DFHEIV0
  9357     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9358     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9359     MOVE X'2020233030303038363233' TO DFHEIV0(25:11)
  9360     CALL 'kxdfhei1' USING DFHEIV0,
  9361           ACCT-FILE-ID,
  9362           DFHEIV20,
  9363           DFHEIV99,
  9364           WS-KEY-SAVE,
  9365           DFHEIV99,
  9366           DFHEIV11,
  9367           DFHEIV99,
  9368           DFHEIV99
  9369     SET ADDRESS OF ACCOUNT-MASTER TO
  9370         DFHEIV20
  9371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9372
  9373
  9374 6310-EXIT.
  9375      EXIT.
  9376
  9377 6320-ENDBR.
  9378     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 180
* EL6501.cbl
  9379
  9380* EXEC CICS ENDBR
  9381*        DATASET(ACCT-FILE-ID)
  9382*    END-EXEC.
  9383     MOVE 0
  9384       TO DFHEIV11
  9385*    MOVE '&2                    $   #00008634' TO DFHEIV0
  9386     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9387     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9388     MOVE X'2020233030303038363334' TO DFHEIV0(25:11)
  9389     CALL 'kxdfhei1' USING DFHEIV0,
  9390           ACCT-FILE-ID,
  9391           DFHEIV11,
  9392           DFHEIV99
  9393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9394
  9395
  9396 6320-EXIT.
  9397      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 181
* EL6501.cbl
  9399 6400-READ-COMMISSION.
  9400     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9401
  9402* EXEC CICS HANDLE CONDITION
  9403*         NOTFND   (6450-NOT-FOUND)
  9404*    END-EXEC
  9405*    MOVE '"$I                   ! . #00008643' TO DFHEIV0
  9406     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9408     MOVE X'2E20233030303038363433' TO DFHEIV0(25:11)
  9409     CALL 'kxdfhei1' USING DFHEIV0
  9410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9411
  9412
  9413* EXEC CICS READ
  9414*        GTEQ
  9415*        DATASET   (COMM-FILE-ID)
  9416*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9417*        RIDFLD    (COMM-KEY)
  9418*    END-EXEC
  9419*    MOVE '&"S        G          (   #00008647' TO DFHEIV0
  9420     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9421     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9422     MOVE X'2020233030303038363437' TO DFHEIV0(25:11)
  9423     CALL 'kxdfhei1' USING DFHEIV0,
  9424           COMM-FILE-ID,
  9425           DFHEIV20,
  9426           DFHEIV99,
  9427           COMM-KEY,
  9428           DFHEIV99,
  9429           DFHEIV99,
  9430           DFHEIV99
  9431     SET ADDRESS OF COMM-TABLE-RECORD TO
  9432         DFHEIV20
  9433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9434
  9435     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9436        CT-TABLE      = COMM-TABLE    AND
  9437        CT-BEN-TYPE   = COMM-LF-AH
  9438        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9439        GO TO 6459-EXIT
  9440     END-IF
  9441     .
  9442 6450-NOT-FOUND.
  9443     MOVE ER-2176                TO EMI-ERROR.
  9444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9445     MOVE 1  TO WS-COMM-ERROR-SW.
  9446
  9447 6459-EXIT.
  9448      EXIT.
  9449
  9450 6460-CHECK-MAX.
  9451
  9452
  9453* EXEC CICS STARTBR
  9454*         DATASET   (COMM-FILE-ID)
  9455*         RIDFLD    (COMM-KEY)
  9456*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 182
* EL6501.cbl
  9457*    END-EXEC
  9458     MOVE 0
  9459       TO DFHEIV11
  9460*    MOVE '&,         G          &  N#00008671' TO DFHEIV0
  9461     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9462     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9463     MOVE X'204E233030303038363731' TO DFHEIV0(25:11)
  9464     CALL 'kxdfhei1' USING DFHEIV0,
  9465           COMM-FILE-ID,
  9466           COMM-KEY,
  9467           DFHEIV99,
  9468           DFHEIV11,
  9469           DFHEIV99
  9470     MOVE EIBRESP  TO WS-RESPONSE
  9471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9472
  9473     MOVE SPACES          TO WS-STATE-MAX-SW
  9474
  9475     IF RESP-NORMAL
  9476        MOVE LOW-VALUES          TO COMM-FILLER
  9477        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9478        MOVE ZEROS               TO WS-TABLE-MAX
  9479        PERFORM UNTIL
  9480              (NOT RESP-NORMAL) OR
  9481              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9482
  9483* EXEC CICS READNEXT
  9484*             DATASET   (COMM-FILE-ID)
  9485*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9486*             RIDFLD    (COMM-KEY)
  9487*             RESP      (WS-RESPONSE)
  9488*           END-EXEC
  9489     MOVE 0
  9490       TO DFHEIV11
  9491*    MOVE '&.S                   )  N#00008686' TO DFHEIV0
  9492     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9493     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9494     MOVE X'204E233030303038363836' TO DFHEIV0(25:11)
  9495     CALL 'kxdfhei1' USING DFHEIV0,
  9496           COMM-FILE-ID,
  9497           DFHEIV20,
  9498           DFHEIV99,
  9499           COMM-KEY,
  9500           DFHEIV99,
  9501           DFHEIV11,
  9502           DFHEIV99,
  9503           DFHEIV99
  9504     SET ADDRESS OF COMM-TABLE-RECORD TO
  9505         DFHEIV20
  9506     MOVE EIBRESP  TO WS-RESPONSE
  9507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9508            IF (RESP-NORMAL) AND
  9509               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9510               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9511                   (WS-NDX > +27)
  9512                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9513                      MOVE CT-RT (WS-NDX)
  9514                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 183
* EL6501.cbl
  9515                   END-IF
  9516               END-PERFORM
  9517            END-IF
  9518        END-PERFORM
  9519
  9520* EXEC CICS ENDBR
  9521*            DATASET   (COMM-FILE-ID)
  9522*       END-EXEC
  9523     MOVE 0
  9524       TO DFHEIV11
  9525*    MOVE '&2                    $   #00008703' TO DFHEIV0
  9526     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9528     MOVE X'2020233030303038373033' TO DFHEIV0(25:11)
  9529     CALL 'kxdfhei1' USING DFHEIV0,
  9530           COMM-FILE-ID,
  9531           DFHEIV11,
  9532           DFHEIV99
  9533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9534     END-IF
  9535
  9536     .
  9537 6460-EXIT.
  9538      EXIT.
  9539
  9540
  9541 6500-READ-ACCT.
  9542
  9543* EXEC CICS READ
  9544*        GTEQ
  9545*        DATASET   (ACCT-FILE-ID)
  9546*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9547*        RIDFLD    (PI-ACCT-KEY)
  9548*    END-EXEC.
  9549*    MOVE '&"S        G          (   #00008714' TO DFHEIV0
  9550     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9552     MOVE X'2020233030303038373134' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0,
  9554           ACCT-FILE-ID,
  9555           DFHEIV20,
  9556           DFHEIV99,
  9557           PI-ACCT-KEY,
  9558           DFHEIV99,
  9559           DFHEIV99,
  9560           DFHEIV99
  9561     SET ADDRESS OF ACCOUNT-MASTER TO
  9562         DFHEIV20
  9563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9564
  9565
  9566 6599-EXIT.
  9567      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 184
* EL6501.cbl
  9569 6600-UPDATE-MAINT-DT.
  9570     MOVE SPACES                 TO ELCNTL-KEY.
  9571
  9572     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9573     MOVE '1'                    TO CNTL-REC-TYPE.
  9574     MOVE +0                     TO CNTL-SEQ-NO.
  9575
  9576
  9577* EXEC CICS HANDLE CONDITION
  9578*        NOTFND   (6699-EXIT)
  9579*    END-EXEC.
  9580*    MOVE '"$I                   ! / #00008731' TO DFHEIV0
  9581     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9583     MOVE X'2F20233030303038373331' TO DFHEIV0(25:11)
  9584     CALL 'kxdfhei1' USING DFHEIV0
  9585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9586
  9587
  9588
  9589* EXEC CICS READ
  9590*        UPDATE
  9591*        DATASET   (CNTL-FILE-ID)
  9592*        SET       (ADDRESS OF CONTROL-FILE)
  9593*        RIDFLD    (ELCNTL-KEY)
  9594*    END-EXEC.
  9595*    MOVE '&"S        EU         (   #00008735' TO DFHEIV0
  9596     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9597     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9598     MOVE X'2020233030303038373335' TO DFHEIV0(25:11)
  9599     CALL 'kxdfhei1' USING DFHEIV0,
  9600           CNTL-FILE-ID,
  9601           DFHEIV20,
  9602           DFHEIV99,
  9603           ELCNTL-KEY,
  9604           DFHEIV99,
  9605           DFHEIV99,
  9606           DFHEIV99
  9607     SET ADDRESS OF CONTROL-FILE TO
  9608         DFHEIV20
  9609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9610
  9611
  9612     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9613
  9614
  9615* EXEC CICS REWRITE
  9616*        DATASET   (CNTL-FILE-ID)
  9617*        FROM      (CONTROL-FILE)
  9618*    END-EXEC.
  9619     MOVE LENGTH OF
  9620      CONTROL-FILE
  9621       TO DFHEIV11
  9622*    MOVE '&& L                  %   #00008744' TO DFHEIV0
  9623     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9624     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9625     MOVE X'2020233030303038373434' TO DFHEIV0(25:11)
  9626     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 185
* EL6501.cbl
  9627           CNTL-FILE-ID,
  9628           CONTROL-FILE,
  9629           DFHEIV11,
  9630           DFHEIV99
  9631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9632
  9633
  9634 6699-EXIT.
  9635      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 186
* EL6501.cbl
  9637 6700-BUILD-COMM-WORK.
  9638     IF NOT PI-GA-BILLING
  9639         GO TO 6799-EXIT.
  9640
  9641
  9642* EXEC CICS GETMAIN
  9643*         LENGTH   (260)
  9644*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9645*         INITIMG  (GETMAIN-SPACE)
  9646*     END-EXEC.
  9647     MOVE 260
  9648       TO DFHEIV11
  9649*    MOVE ',"IL                  $   #00008756' TO DFHEIV0
  9650     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9651     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9652     MOVE X'2020233030303038373536' TO DFHEIV0(25:11)
  9653     CALL 'kxdfhei1' USING DFHEIV0,
  9654           DFHEIV20,
  9655           DFHEIV11,
  9656           GETMAIN-SPACE
  9657     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9658         DFHEIV20
  9659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9660
  9661     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9662
  9663     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9664     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9665     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9666
  9667     IF PI-MAINT = 'A'
  9668         GO TO 6799-EXIT.
  9669
  9670     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9671     MOVE +1                TO AXRF-SUB.
  9672
  9673 6710-AXRF-LOOP.
  9674     MOVE SPACES         TO AGENT-FIND.
  9675     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9676
  9677     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9678
  9679     IF AGENT-FIND = SPACES
  9680        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9681             WK-GA-BILL-DT (AXRF-SUB)
  9682     ELSE
  9683        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9684
  9685     ADD +1 TO AXRF-SUB.
  9686
  9687     IF AXRF-SUB NOT = +11
  9688        GO TO 6710-AXRF-LOOP.
  9689
  9690 6799-EXIT.
  9691     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 187
* EL6501.cbl
  9693 6800-COMPANY-REC-READ.
  9694     MOVE SPACES                 TO ELCNTL-KEY.
  9695     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9696     MOVE '1'                    TO CNTL-REC-TYPE.
  9697     MOVE +0                     TO CNTL-SEQ-NO.
  9698
  9699* EXEC CICS HANDLE CONDITION
  9700*        NOTFND   (6880-NO-COMP)
  9701*    END-EXEC.
  9702*    MOVE '"$I                   ! 0 #00008798' TO DFHEIV0
  9703     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9705     MOVE X'3020233030303038373938' TO DFHEIV0(25:11)
  9706     CALL 'kxdfhei1' USING DFHEIV0
  9707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9708
  9709
  9710
  9711* EXEC CICS READ
  9712*        DATASET   (CNTL-FILE-ID)
  9713*        SET       (ADDRESS OF CONTROL-FILE)
  9714*        RIDFLD    (ELCNTL-KEY)
  9715*    END-EXEC.
  9716*    MOVE '&"S        E          (   #00008802' TO DFHEIV0
  9717     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9719     MOVE X'2020233030303038383032' TO DFHEIV0(25:11)
  9720     CALL 'kxdfhei1' USING DFHEIV0,
  9721           CNTL-FILE-ID,
  9722           DFHEIV20,
  9723           DFHEIV99,
  9724           ELCNTL-KEY,
  9725           DFHEIV99,
  9726           DFHEIV99,
  9727           DFHEIV99
  9728     SET ADDRESS OF CONTROL-FILE TO
  9729         DFHEIV20
  9730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9731
  9732
  9733     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9734         MOVE ER-2572               TO EMI-ERROR
  9735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9736
  9737     GO TO 6899-EXIT.
  9738
  9739 6880-NO-COMP.
  9740     MOVE ER-0002                TO EMI-ERROR.
  9741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9742
  9743 6899-EXIT.
  9744     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 188
* EL6501.cbl
  9746 6900-READ-AND-CHECK-AXRF.
  9747     IF NOT PI-GA-BILLING
  9748        GO TO 6999-EXIT.
  9749
  9750     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9751     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9752
  9753 6905-AGENT-LEVEL-LOOP.
  9754     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9755     MOVE SPACES TO AGENT-FIND.
  9756     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9757      OR
  9758        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9759      AND
  9760        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9761                             OR 'B' OR 'I'
  9762                             OR 'K' OR 'L' OR 'J' OR 'M'
  9763                                    OR 'A' OR 'N')
  9764                            OR
  9765        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9766                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
  9767                                         OR 'A' OR 'N'))
  9768            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
  9769            IF AGENT-RECORD-NOT-FOUND
  9770               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
  9771           ELSE
  9772            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
  9773               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
  9774           ELSE
  9775        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
  9776              AND 'B' AND 'I'
  9777              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
  9778           (AM-AGT (AXRF-SUB) NOT =
  9779                   WK-AM-AGT (AXRF-SUB))
  9780           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
  9781           GO TO 6910-INC-SUB.
  9782
  9783     MOVE SPACES TO AGENT-FIND.
  9784     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
  9785        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
  9786                               SPACES AND ZEROS)
  9787          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
  9788          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
  9789          PERFORM 6921-READ-AXRF THRU 6929-EXIT
  9790          IF AGENT-FIND = SPACES
  9791              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
  9792
  9793 6910-INC-SUB.
  9794     ADD +1                      TO AXRF-SUB.
  9795     IF AXRF-SUB NOT = +11
  9796        GO TO 6905-AGENT-LEVEL-LOOP.
  9797
  9798     GO TO 6999-EXIT.
  9799
  9800 6920-READ-AXRF-FILE.
  9801*    IF GETMAIN-SW = 'X'
  9802*       GO TO 6920-BUILD-KEY.
  9803*
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 189
* EL6501.cbl
  9804*    EXEC CICS GETMAIN
  9805*         LENGTH   (ERGXRF-REC-LEN)
  9806*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  9807*         INITIMG  (GETMAIN-SPACE)
  9808*    END-EXEC.
  9809*
  9810*    MOVE 'X' TO GETMAIN-SW.
  9811
  9812 6920-BUILD-KEY.
  9813     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
  9814
  9815     IF PI-ZERO-CARRIER
  9816       OR PI-ZERO-CAR-GROUP
  9817         MOVE ZERO               TO WS-AXRF-CARRIER
  9818     ELSE
  9819         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
  9820
  9821     IF PI-ZERO-GROUPING
  9822       OR PI-ZERO-CAR-GROUP
  9823         MOVE ZEROS              TO WS-AXRF-GROUPING
  9824     ELSE
  9825         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
  9826
  9827     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
  9828                                              LOW-VALUES
  9829        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
  9830     ELSE
  9831     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
  9832                                              LOW-VALUES
  9833        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
  9834     ELSE
  9835        MOVE 'X' TO AGENT-FIND
  9836        GO TO 6929-EXIT.
  9837
  9838     MOVE +1 TO GX-AGENT-SUB.
  9839
  9840 6921-READ-AXRF.
  9841
  9842* EXEC CICS HANDLE CONDITION
  9843*         ENDFILE     (6925-NOT-FIND)
  9844*         NOTFND      (6925-NOT-FIND)
  9845*    END-EXEC.
  9846*    MOVE '"$''I                  ! 1 #00008916' TO DFHEIV0
  9847     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9849     MOVE X'3120233030303038393136' TO DFHEIV0(25:11)
  9850     CALL 'kxdfhei1' USING DFHEIV0
  9851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9852
  9853
  9854
  9855* EXEC CICS READ
  9856*        DATASET   (ERGXRF-FILE-ID)
  9857*        LENGTH    (ERGXRF-REC-LEN)
  9858*        INTO      (AGENT-CROSS-REFERENCE)
  9859*        RIDFLD    (WS-AXRF-KEY)
  9860*        EQUAL
  9861*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 190
* EL6501.cbl
  9862*    MOVE '&"IL       E          (   #00008921' TO DFHEIV0
  9863     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9865     MOVE X'2020233030303038393231' TO DFHEIV0(25:11)
  9866     CALL 'kxdfhei1' USING DFHEIV0,
  9867           ERGXRF-FILE-ID,
  9868           AGENT-CROSS-REFERENCE,
  9869           ERGXRF-REC-LEN,
  9870           WS-AXRF-KEY,
  9871           DFHEIV99,
  9872           DFHEIV99,
  9873           DFHEIV99
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9875
  9876
  9877     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  9878
  9879     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
  9880             FROM +1 BY +1 UNTIL
  9881         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
  9882         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
  9883         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
  9884         AND
  9885         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
  9886         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
  9887         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
  9888         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
  9889
  9890     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  9891        MOVE 'Y' TO AGENT-FIND
  9892        GO TO 6929-EXIT.
  9893
  9894     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
  9895        MOVE 'Z' TO AGENT-FIND.
  9896
  9897     GO TO 6929-EXIT.
  9898
  9899 6921-FIND-ACCT-LOOP.
  9900***  DUMMY PARAGRAPH  ***
  9901
  9902 6925-NOT-FIND.
  9903     MOVE 'X' TO AGENT-FIND.
  9904
  9905 6929-EXIT.
  9906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 191
* EL6501.cbl
  9908 6950-ADD-AGENT-RECORD.
  9909     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
  9910        GO TO 6959-EXIT.
  9911
  9912     MOVE +109                   TO ERGXRF-REC-LEN.
  9913
  9914     MOVE +1                     TO GX-AGENT-POINTER-CNT.
  9915     MOVE 'GX'                   TO GX-RECORD-ID.
  9916     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
  9917
  9918     IF PI-ZERO-CARRIER
  9919       OR PI-ZERO-CAR-GROUP
  9920         MOVE ZERO               TO GX-CARRIER
  9921     ELSE
  9922         MOVE AM-CARRIER         TO GX-CARRIER.
  9923
  9924     IF PI-ZERO-GROUPING
  9925       OR PI-ZERO-CAR-GROUP
  9926         MOVE ZERO               TO GX-GROUPING
  9927     ELSE
  9928         MOVE AM-GROUPING        TO GX-GROUPING.
  9929
  9930     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
  9931
  9932     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
  9933     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
  9934     MOVE AM-STATE               TO GX-AM-STATE (1).
  9935     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
  9936     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
  9937     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
  9938     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
  9939     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
  9940
  9941     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
  9942     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
  9943     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
  9944
  9945
  9946* EXEC CICS WRITE
  9947*        FROM      (AGENT-CROSS-REFERENCE)
  9948*        LENGTH    (ERGXRF-REC-LEN)
  9949*        RIDFLD    (GX-CONTROL-PRIMARY)
  9950*        DATASET   (ERGXRF-FILE-ID)
  9951*    END-EXEC.
  9952*    MOVE '&$ L                  ''   #00008997' TO DFHEIV0
  9953     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9955     MOVE X'2020233030303038393937' TO DFHEIV0(25:11)
  9956     CALL 'kxdfhei1' USING DFHEIV0,
  9957           ERGXRF-FILE-ID,
  9958           AGENT-CROSS-REFERENCE,
  9959           ERGXRF-REC-LEN,
  9960           GX-CONTROL-PRIMARY,
  9961           DFHEIV99,
  9962           DFHEIV99
  9963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9964
  9965
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 192
* EL6501.cbl
  9966 6959-EXIT.
  9967      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 193
* EL6501.cbl
  9969 6970-REWRITE-AGENT-RECORD.
  9970     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9971
  9972
  9973* EXEC CICS READ
  9974*        DATASET   (ERGXRF-FILE-ID)
  9975*        INTO      (AGENT-CROSS-REFERENCE)
  9976*        LENGTH    (ERGXRF-REC-LEN)
  9977*        RIDFLD    (WS-AXRF-KEY)
  9978*        EQUAL
  9979*        UPDATE
  9980*    END-EXEC.
  9981*    MOVE '&"IL       EU         (   #00009010' TO DFHEIV0
  9982     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9983     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9984     MOVE X'2020233030303039303130' TO DFHEIV0(25:11)
  9985     CALL 'kxdfhei1' USING DFHEIV0,
  9986           ERGXRF-FILE-ID,
  9987           AGENT-CROSS-REFERENCE,
  9988           ERGXRF-REC-LEN,
  9989           WS-AXRF-KEY,
  9990           DFHEIV99,
  9991           DFHEIV99,
  9992           DFHEIV99
  9993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9994
  9995
  9996     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  9997
  9998     IF ACCT-LEVEL-DIFFERENT
  9999        GO TO 6975-UPDATE-LEVEL-NO.
 10000
 10001     IF GX-AGENT-POINTER-CNT = +1006
 10002         GO TO 6979-EXIT.
 10003
 10004     MOVE +1 TO FIND-AGENT-SUB1.
 10005
 10006 6972-FIND-REC-LOCATION.
 10007     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10008     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10009
 10010     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10011        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10012        NEXT SENTENCE
 10013     ELSE
 10014        ADD +1 TO FIND-AGENT-SUB1
 10015        GO TO 6972-FIND-REC-LOCATION.
 10016
 10017     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10018                                  FIND-AGENT-SUB3.
 10019     ADD +1 TO FIND-AGENT-SUB3.
 10020
 10021     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10022        NEXT SENTENCE
 10023     ELSE
 10024        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10025        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10026        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 194
* EL6501.cbl
 10027
 10028     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10029     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10030
 10031     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10032     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10033
 10034     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10035     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10036     MOVE AM-EXPIRATION-DT TO
 10037                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10038     MOVE AM-EFFECTIVE-DT  TO
 10039                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10040     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10041     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10042
 10043 6975-UPDATE-LEVEL-NO.
 10044     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10045     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10046     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10047     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10048     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10049     if ergxrf-rec-len > +31264
 10050        move +31264               to ergxrf-rec-len
 10051        move +1006                to gx-agent-pointer-cnt
 10052     end-if
 10053
 10054
 10055* EXEC CICS REWRITE
 10056*        FROM      (AGENT-CROSS-REFERENCE)
 10057*        LENGTH    (ERGXRF-REC-LEN)
 10058*        DATASET   (ERGXRF-FILE-ID)
 10059*    END-EXEC.
 10060*    MOVE '&& L                  %   #00009077' TO DFHEIV0
 10061     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10062     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10063     MOVE X'2020233030303039303737' TO DFHEIV0(25:11)
 10064     CALL 'kxdfhei1' USING DFHEIV0,
 10065           ERGXRF-FILE-ID,
 10066           AGENT-CROSS-REFERENCE,
 10067           ERGXRF-REC-LEN,
 10068           DFHEIV99
 10069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10070
 10071
 10072     GO TO 6979-EXIT.
 10073
 10074 6977-BUMP-AXRF-REC.
 10075     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10076          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10077
 10078     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10079
 10080 6979-EXIT.
 10081     EXIT.
 10082
 10083 6999-EXIT.
 10084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 195
* EL6501.cbl
 10086 7000-DELETE-AXRF-REC.
 10087     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10088
 10089
 10090* EXEC CICS HANDLE CONDITION
 10091*         ENDFILE     (7999-EXIT)
 10092*         NOTFND      (7999-EXIT)
 10093*    END-EXEC.
 10094*    MOVE '"$''I                  ! 2 #00009100' TO DFHEIV0
 10095     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10097     MOVE X'3220233030303039313030' TO DFHEIV0(25:11)
 10098     CALL 'kxdfhei1' USING DFHEIV0
 10099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10100
 10101
 10102
 10103* EXEC CICS READ
 10104*        DATASET   (ERGXRF-FILE-ID)
 10105*        INTO      (AGENT-CROSS-REFERENCE)
 10106*        LENGTH    (ERGXRF-REC-LEN)
 10107*        RIDFLD    (WS-AXRF-KEY)
 10108*        EQUAL
 10109*        UPDATE
 10110*    END-EXEC.
 10111*    MOVE '&"IL       EU         (   #00009105' TO DFHEIV0
 10112     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10113     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10114     MOVE X'2020233030303039313035' TO DFHEIV0(25:11)
 10115     CALL 'kxdfhei1' USING DFHEIV0,
 10116           ERGXRF-FILE-ID,
 10117           AGENT-CROSS-REFERENCE,
 10118           ERGXRF-REC-LEN,
 10119           WS-AXRF-KEY,
 10120           DFHEIV99,
 10121           DFHEIV99,
 10122           DFHEIV99
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10127
 10128     IF GX-AGENT-SUB = +0
 10129        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10130        FROM +1 BY +1 UNTIL
 10131         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10132         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10133         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10134         AND
 10135         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10136         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10137         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10138         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10139
 10140     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10141        GO TO 7999-EXIT.
 10142
 10143     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 196
* EL6501.cbl
 10144     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10145                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10146                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10147     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10148     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10149     GO TO 7020-REWRITE-AXRF-RECORD.
 10150
 10151 7010-BUMP-RECORDS.
 10152     ADD +1 TO FIND-AGENT-SUB1.
 10153     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10154          GX-AGENT-POINTER (GX-AGENT-SUB).
 10155
 10156 7020-REWRITE-AXRF-RECORD.
 10157     IF GX-AGENT-POINTER-CNT = +0
 10158
 10159* EXEC CICS DELETE
 10160*            DATASET   (ERGXRF-FILE-ID)
 10161*       END-EXEC
 10162*    MOVE '&(                    &   #00009146' TO DFHEIV0
 10163     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10164     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10165     MOVE X'2020233030303039313436' TO DFHEIV0(25:11)
 10166     CALL 'kxdfhei1' USING DFHEIV0,
 10167           ERGXRF-FILE-ID,
 10168           DFHEIV99,
 10169           DFHEIV99,
 10170           DFHEIV99,
 10171           DFHEIV99
 10172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10173     ELSE
 10174        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10175        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10176        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10177        compute ergxrf-rec-len =
 10178            (gx-agent-pointer-cnt * +31) + +78
 10179        if ergxrf-rec-len > +31264
 10180           move +31264               to ergxrf-rec-len
 10181           move +1006                to gx-agent-pointer-cnt
 10182        end-if
 10183
 10184* EXEC CICS REWRITE
 10185*            FROM      (AGENT-CROSS-REFERENCE)
 10186*            LENGTH    (ERGXRF-REC-LEN)
 10187*            DATASET   (ERGXRF-FILE-ID)
 10188*       END-EXEC.
 10189*    MOVE '&& L                  %   #00009159' TO DFHEIV0
 10190     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10191     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10192     MOVE X'2020233030303039313539' TO DFHEIV0(25:11)
 10193     CALL 'kxdfhei1' USING DFHEIV0,
 10194           ERGXRF-FILE-ID,
 10195           AGENT-CROSS-REFERENCE,
 10196           ERGXRF-REC-LEN,
 10197           DFHEIV99
 10198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10199
 10200
 10201 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 197
* EL6501.cbl
 10202     EXIT.
 10203
 10204*************************************
 10205 8000-STATE-REC-READ.
 10206     MOVE SPACES                 TO ELCNTL-KEY.
 10207     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10208     MOVE '3'                    TO CNTL-REC-TYPE.
 10209     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10210     MOVE +0                     TO CNTL-SEQ-NO.
 10211
 10212* EXEC CICS HANDLE CONDITION
 10213*        NOTFND  (8010-EXIT)
 10214*    END-EXEC.
 10215*    MOVE '"$I                   ! 3 #00009175' TO DFHEIV0
 10216     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10218     MOVE X'3320233030303039313735' TO DFHEIV0(25:11)
 10219     CALL 'kxdfhei1' USING DFHEIV0
 10220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10221
 10222
 10223
 10224* EXEC CICS READ
 10225*        DATASET   (CNTL-FILE-ID)
 10226*        SET       (ADDRESS OF CONTROL-FILE)
 10227*        RIDFLD    (ELCNTL-KEY)
 10228*    END-EXEC.
 10229*    MOVE '&"S        E          (   #00009179' TO DFHEIV0
 10230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10232     MOVE X'2020233030303039313739' TO DFHEIV0(25:11)
 10233     CALL 'kxdfhei1' USING DFHEIV0,
 10234           CNTL-FILE-ID,
 10235           DFHEIV20,
 10236           DFHEIV99,
 10237           ELCNTL-KEY,
 10238           DFHEIV99,
 10239           DFHEIV99,
 10240           DFHEIV99
 10241     SET ADDRESS OF CONTROL-FILE TO
 10242         DFHEIV20
 10243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10244
 10245
 10246     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10247     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10248
 10249 8010-EXIT.
 10250      EXIT.
 10251
 10252 8050-USER-REC-READ.
 10253     MOVE SPACES                 TO ELCNTL-KEY.
 10254     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10255     MOVE '2'                    TO CNTL-REC-TYPE.
 10256     MOVE CSRI                   TO CNTL-ACCESS.
 10257     MOVE +0                     TO CNTL-SEQ-NO.
 10258
 10259* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 198
* EL6501.cbl
 10260*        NOTFND  (8055-NOTFND)
 10261*    END-EXEC.
 10262*    MOVE '"$I                   ! 4 #00009197' TO DFHEIV0
 10263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10265     MOVE X'3420233030303039313937' TO DFHEIV0(25:11)
 10266     CALL 'kxdfhei1' USING DFHEIV0
 10267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10268
 10269
 10270
 10271* EXEC CICS READ
 10272*        DATASET   (CNTL-FILE-ID)
 10273*        SET       (ADDRESS OF CONTROL-FILE)
 10274*        RIDFLD    (ELCNTL-KEY)
 10275*    END-EXEC.
 10276*    MOVE '&"S        E          (   #00009201' TO DFHEIV0
 10277     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10279     MOVE X'2020233030303039323031' TO DFHEIV0(25:11)
 10280     CALL 'kxdfhei1' USING DFHEIV0,
 10281           CNTL-FILE-ID,
 10282           DFHEIV20,
 10283           DFHEIV99,
 10284           ELCNTL-KEY,
 10285           DFHEIV99,
 10286           DFHEIV99,
 10287           DFHEIV99
 10288     SET ADDRESS OF CONTROL-FILE TO
 10289         DFHEIV20
 10290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10291
 10292
 10293     GO TO 8060-EXIT.
 10294
 10295 8055-NOTFND.
 10296     MOVE ER-1883             TO EMI-ERROR.
 10297     MOVE -1                  TO CSRL.
 10298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10299
 10300 8060-EXIT.
 10301      EXIT.
 10302
 10303*************************************
 10304
 10305 8100-SEND-INITIAL-MAP.
 10306     MOVE SAVE-DATE              TO DATEO.
 10307     MOVE EIBTIME                TO TIME-IN.
 10308     MOVE TIME-OUT               TO TIMEO.
 10309     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10310     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10311     MOVE -1                     TO PFENTERL.
 10312     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10313
 10314     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10315
 10316*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10317*       NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 199
* EL6501.cbl
 10318*    ELSE
 10319*       MOVE AL-SADOF            TO PSIHEADA
 10320*                                   PSILFTA
 10321*                                   PSILFCA
 10322*                                   PSIAHTA
 10323*                                   PSIAHCA
 10324*                                   PSILFFA
 10325*                                   PSIAHFA.
 10326
 10327*    IF PI-COMPANY-ID = 'DMD'
 10328*         MOVE AL-SANOF          TO KEY10A.
 10329
 10330     IF PI-COMPANY-ID = 'DCC'
 10331        CONTINUE
 10332     ELSE
 10333        MOVE AL-SADOF            TO CTPLABLA
 10334                                    CLPTOLPA
 10335                                    LCLABLA
 10336                                    LCOMMA
 10337                                    MAXFEEHA
 10338                                    CLPSTHA
 10339                                    PRODCDHA
 10340     END-IF
 10341     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10342        MOVE -1                  TO CSRL.
 10343
 10344     IF  CLAIM-SESSION
 10345         MOVE SPACES             TO PF1PF2O
 10346         MOVE AL-SANOF           TO PF1PF2A.
 10347
 10348
 10349* EXEC CICS SEND
 10350*        MAP      (MAP-NAME)
 10351*        MAPSET   (MAPSET-NAME)
 10352*        FROM     (EL6501AO)
 10353*        ERASE
 10354*        CURSOR
 10355*    END-EXEC.
 10356     MOVE LENGTH OF
 10357      EL6501AO
 10358       TO DFHEIV12
 10359     MOVE -1
 10360       TO DFHEIV11
 10361*    MOVE '8$     CT  E    H L F ,   #00009262' TO DFHEIV0
 10362     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10363     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10364     MOVE X'2020233030303039323632' TO DFHEIV0(25:11)
 10365     CALL 'kxdfhei1' USING DFHEIV0,
 10366           MAP-NAME,
 10367           EL6501AO,
 10368           DFHEIV12,
 10369           MAPSET-NAME,
 10370           DFHEIV99,
 10371           DFHEIV99,
 10372           DFHEIV99,
 10373           DFHEIV11,
 10374           DFHEIV99,
 10375           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 200
* EL6501.cbl
 10376           DFHEIV99
 10377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10378
 10379
 10380     GO TO 9100-RETURN-TRAN.
 10381
 10382 8200-SEND-DATAONLY.
 10383     MOVE SAVE-DATE              TO DATEO.
 10384     MOVE EIBTIME                TO TIME-IN.
 10385     MOVE TIME-OUT               TO TIMEO.
 10386     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10387     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10388     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10389
 10390     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10391
 10392     IF PI-COMPANY-ID = 'DCC'
 10393        CONTINUE
 10394     ELSE
 10395        MOVE AL-SADOF            TO CTPLABLA
 10396                                    CLPTOLPA
 10397                                    LCLABLA
 10398                                    LCOMMA
 10399                                    MAXFEEHA
 10400                                    CLPSTHA
 10401                                    PRODCDHA
 10402     END-IF
 10403     IF  CLAIM-SESSION
 10404         MOVE SPACES             TO PF1PF2O
 10405         MOVE AL-SANOF           TO PF1PF2A.
 10406
 10407
 10408* EXEC CICS SEND
 10409*        MAP      (MAP-NAME)
 10410*        MAPSET   (MAPSET-NAME)
 10411*        FROM     (EL6501AO)
 10412*        DATAONLY
 10413*        CURSOR
 10414*    END-EXEC.
 10415     MOVE LENGTH OF
 10416      EL6501AO
 10417       TO DFHEIV12
 10418     MOVE -1
 10419       TO DFHEIV11
 10420*    MOVE '8$D    CT       H L F ,   #00009297' TO DFHEIV0
 10421     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10422     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10423     MOVE X'2020233030303039323937' TO DFHEIV0(25:11)
 10424     CALL 'kxdfhei1' USING DFHEIV0,
 10425           MAP-NAME,
 10426           EL6501AO,
 10427           DFHEIV12,
 10428           MAPSET-NAME,
 10429           DFHEIV99,
 10430           DFHEIV99,
 10431           DFHEIV99,
 10432           DFHEIV11,
 10433           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 201
* EL6501.cbl
 10434           DFHEIV99,
 10435           DFHEIV99
 10436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10437
 10438
 10439     GO TO 9100-RETURN-TRAN.
 10440
 10441 8300-SEND-TEXT.
 10442
 10443* EXEC CICS SEND TEXT
 10444*        FROM     (LOGOFF-TEXT)
 10445*        LENGTH   (LOGOFF-LENGTH)
 10446*        ERASE
 10447*        FREEKB
 10448*    END-EXEC.
 10449*    MOVE '8&      T  E F  H   F -   #00009308' TO DFHEIV0
 10450     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10451     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10452     MOVE X'2020233030303039333038' TO DFHEIV0(25:11)
 10453     CALL 'kxdfhei1' USING DFHEIV0,
 10454           LOGOFF-TEXT,
 10455           LOGOFF-LENGTH,
 10456           DFHEIV99,
 10457           DFHEIV99,
 10458           DFHEIV99,
 10459           DFHEIV99,
 10460           DFHEIV99,
 10461           DFHEIV99,
 10462           DFHEIV99,
 10463           DFHEIV99,
 10464           DFHEIV99,
 10465           DFHEIV99
 10466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10467
 10468
 10469
 10470* EXEC CICS RETURN
 10471*    END-EXEC.
 10472*    MOVE '.(                    &   #00009315' TO DFHEIV0
 10473     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10474     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10475     MOVE X'2020233030303039333135' TO DFHEIV0(25:11)
 10476     CALL 'kxdfhei1' USING DFHEIV0,
 10477           DFHEIV99,
 10478           DFHEIV99,
 10479           DFHEIV99,
 10480           DFHEIV99,
 10481           DFHEIV99
 10482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10483
 10484
 10485 8600-DEEDIT.
 10486
 10487* EXEC CICS BIF DEEDIT
 10488*         FIELD(DEEDIT-FIELD)
 10489*         LENGTH(15)
 10490*     END-EXEC.
 10491     MOVE 15
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 202
* EL6501.cbl
 10492       TO DFHEIV11
 10493*    MOVE '@"L                   #   #00009319' TO DFHEIV0
 10494     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10495     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10496     MOVE X'2020233030303039333139' TO DFHEIV0(25:11)
 10497     CALL 'kxdfhei1' USING DFHEIV0,
 10498           DEEDIT-FIELD,
 10499           DFHEIV11
 10500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10501
 10502
 10503 8800-UNAUTHORIZED-ACCESS.
 10504     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10505     GO TO 8300-SEND-TEXT.
 10506
 10507 8810-PF23.
 10508     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10509     MOVE XCTL-005               TO PGM-NAME.
 10510     GO TO 9300-XCTL.
 10511
 10512 9100-RETURN-TRAN.
 10513     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10514     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10515
 10516* EXEC CICS RETURN
 10517*        TRANSID    (TRANS-ID)
 10518*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10519*        LENGTH     (WS-COMM-LENGTH)
 10520*    END-EXEC.
 10521*    MOVE '.(CT                  &   #00009336' TO DFHEIV0
 10522     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10523     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10524     MOVE X'2020233030303039333336' TO DFHEIV0(25:11)
 10525     CALL 'kxdfhei1' USING DFHEIV0,
 10526           TRANS-ID,
 10527           PROGRAM-INTERFACE-BLOCK,
 10528           WS-COMM-LENGTH,
 10529           DFHEIV99,
 10530           DFHEIV99
 10531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10532
 10533
 10534 9200-RETURN-MAIN-MENU.
 10535     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10536         MOVE XCTL-126           TO  PGM-NAME
 10537     ELSE
 10538         MOVE XCTL-626           TO  PGM-NAME.
 10539
 10540     GO TO 9300-XCTL.
 10541
 10542 9300-XCTL.
 10543
 10544* EXEC CICS XCTL
 10545*        PROGRAM    (PGM-NAME)
 10546*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10547*        LENGTH     (WS-COMM-LENGTH)
 10548*    END-EXEC.
 10549*    MOVE '.$C                   $   #00009351' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 203
* EL6501.cbl
 10550     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10551     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10552     MOVE X'2020233030303039333531' TO DFHEIV0(25:11)
 10553     CALL 'kxdfhei1' USING DFHEIV0,
 10554           PGM-NAME,
 10555           PROGRAM-INTERFACE-BLOCK,
 10556           WS-COMM-LENGTH
 10557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10558
 10559
 10560 9400-CLEAR.
 10561     IF PI-GA-BILLING
 10562        IF GETMAIN-ACQUIRED
 10563           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10564           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10565
 10566* EXEC CICS FREEMAIN
 10567*               DATA     (COMMISSION-WORK-AREA)
 10568*          END-EXEC.
 10569*    MOVE ',$D                   "   #00009362' TO DFHEIV0
 10570     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10571     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10572     MOVE X'2020233030303039333632' TO DFHEIV0(25:11)
 10573     CALL 'kxdfhei1' USING DFHEIV0,
 10574           COMMISSION-WORK-AREA
 10575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10576
 10577
 10578     MOVE SPACES                 TO PI-SV-MAINT.
 10579     MOVE XCTL-650               TO PGM-NAME.
 10580     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10581     GO TO 9300-XCTL.
 10582
 10583 9500-PF12.
 10584     MOVE XCTL-010               TO PGM-NAME.
 10585     GO TO 9300-XCTL.
 10586
 10587 9600-PGMID-ERROR.
 10588
 10589* EXEC CICS HANDLE CONDITION
 10590*        PGMIDERR    (8300-SEND-TEXT)
 10591*    END-EXEC.
 10592*    MOVE '"$L                   ! 5 #00009376' TO DFHEIV0
 10593     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10595     MOVE X'3520233030303039333736' TO DFHEIV0(25:11)
 10596     CALL 'kxdfhei1' USING DFHEIV0
 10597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10598
 10599
 10600     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10601     MOVE ' '                    TO PI-ENTRY-CD-1.
 10602     MOVE XCTL-005               TO PGM-NAME.
 10603     MOVE PGM-NAME               TO LOGOFF-PGM.
 10604     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10605     GO TO 9300-XCTL.
 10606
 10607 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 204
* EL6501.cbl
 10608     MOVE LINK-ELDATCV           TO PGM-NAME.
 10609
 10610* EXEC CICS LINK
 10611*        PROGRAM    (PGM-NAME)
 10612*        COMMAREA   (DATE-CONVERSION-DATA)
 10613*        LENGTH     (DC-COMM-LENGTH)
 10614*    END-EXEC.
 10615*    MOVE '."C                   ''   #00009389' TO DFHEIV0
 10616     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10617     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10618     MOVE X'2020233030303039333839' TO DFHEIV0(25:11)
 10619     CALL 'kxdfhei1' USING DFHEIV0,
 10620           PGM-NAME,
 10621           DATE-CONVERSION-DATA,
 10622           DC-COMM-LENGTH,
 10623           DFHEIV99,
 10624           DFHEIV99,
 10625           DFHEIV99
 10626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10627
 10628
 10629 9900-ERROR-FORMAT.
 10630     IF NOT EMI-ERRORS-COMPLETE
 10631         MOVE LINK-001           TO PGM-NAME
 10632
 10633* EXEC CICS LINK
 10634*            PROGRAM    (PGM-NAME)
 10635*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10636*            LENGTH     (EMI-COMM-LENGTH)
 10637*        END-EXEC.
 10638*    MOVE '."C                   ''   #00009398' TO DFHEIV0
 10639     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10640     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10641     MOVE X'2020233030303039333938' TO DFHEIV0(25:11)
 10642     CALL 'kxdfhei1' USING DFHEIV0,
 10643           PGM-NAME,
 10644           ERROR-MESSAGE-INTERFACE-BLOCK,
 10645           EMI-COMM-LENGTH,
 10646           DFHEIV99,
 10647           DFHEIV99,
 10648           DFHEIV99
 10649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10650
 10651
 10652 9900-EXIT.
 10653     EXIT.
 10654
 10655 9990-ABEND.
 10656     MOVE LINK-004               TO PGM-NAME.
 10657     MOVE DFHEIBLK               TO EMI-LINE1.
 10658
 10659* EXEC CICS LINK
 10660*        PROGRAM   (PGM-NAME)
 10661*        COMMAREA  (EMI-LINE1)
 10662*        LENGTH    (72)
 10663*    END-EXEC.
 10664     MOVE 72
 10665       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 205
* EL6501.cbl
 10666*    MOVE '."C                   ''   #00009410' TO DFHEIV0
 10667     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10669     MOVE X'2020233030303039343130' TO DFHEIV0(25:11)
 10670     CALL 'kxdfhei1' USING DFHEIV0,
 10671           PGM-NAME,
 10672           EMI-LINE1,
 10673           DFHEIV11,
 10674           DFHEIV99,
 10675           DFHEIV99,
 10676           DFHEIV99
 10677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10678
 10679
 10680     MOVE -1                     TO PFENTERL.
 10681     GO TO 8200-SEND-DATAONLY.
 10682
 10683
 10684* GOBACK.
 10685     MOVE '9%                    "   ' TO DFHEIV0
 10686     MOVE 'EL6501' TO DFHEIV1
 10687     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10688     GOBACK.
 10689
 10690 9995-SECURITY-VIOLATION.
 10691*                            COPY ELCSCTP.
 10692******************************************************************
 10693*                                                                *
 10694*                            ELCSCTP                             *
 10695*                            VMOD=2.001                          *
 10696*                                                                *
 10697*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10698******************************************************************
 10699
 10700
 10701     MOVE EIBDATE          TO SM-JUL-DATE.
 10702     MOVE EIBTRMID         TO SM-TERMID.
 10703     MOVE THIS-PGM         TO SM-PGM.
 10704     MOVE EIBTIME          TO TIME-IN.
 10705     MOVE TIME-OUT         TO SM-TIME.
 10706     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10707
 10708
 10709* EXEC CICS LINK
 10710*         PROGRAM  ('EL003')
 10711*         COMMAREA (SECURITY-MESSAGE)
 10712*         LENGTH   (80)
 10713*    END-EXEC.
 10714     MOVE 'EL003' TO DFHEIV1
 10715     MOVE 80
 10716       TO DFHEIV11
 10717*    MOVE '."C                   ''   #00009439' TO DFHEIV0
 10718     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10720     MOVE X'2020233030303039343339' TO DFHEIV0(25:11)
 10721     CALL 'kxdfhei1' USING DFHEIV0,
 10722           DFHEIV1,
 10723           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 206
* EL6501.cbl
 10724           DFHEIV11,
 10725           DFHEIV99,
 10726           DFHEIV99,
 10727           DFHEIV99
 10728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10729
 10730
 10731******************************************************************
 10732
 10733
 10734 9995-EXIT.
 10735     EXIT.
 10736
 10737 9999-DFHBACK SECTION.
 10738     MOVE '9%                    "   ' TO DFHEIV0
 10739     MOVE 'EL6501' TO DFHEIV1
 10740     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10741     GOBACK.
 10742 9999-DFHEXIT.
 10743     IF DFHEIGDJ EQUAL 0001
 10744         NEXT SENTENCE
 10745     ELSE IF DFHEIGDJ EQUAL 2
 10746         GO TO 9600-PGMID-ERROR,
 10747               9990-ABEND,
 10748               0500-CHECK-MAINT-TYPE
 10749         DEPENDING ON DFHEIGDI
 10750     ELSE IF DFHEIGDJ EQUAL 3
 10751         GO TO 1500-EXIT
 10752         DEPENDING ON DFHEIGDI
 10753     ELSE IF DFHEIGDJ EQUAL 4
 10754         GO TO 1799-EXIT,
 10755               1799-EXIT
 10756         DEPENDING ON DFHEIGDI
 10757     ELSE IF DFHEIGDJ EQUAL 5
 10758         GO TO 2100-EXIT
 10759         DEPENDING ON DFHEIGDI
 10760     ELSE IF DFHEIGDJ EQUAL 6
 10761         GO TO 2200-EXIT
 10762         DEPENDING ON DFHEIGDI
 10763     ELSE IF DFHEIGDJ EQUAL 7
 10764         GO TO 3030-END-FILE
 10765         DEPENDING ON DFHEIGDI
 10766     ELSE IF DFHEIGDJ EQUAL 8
 10767         GO TO 3530-END-FILE
 10768         DEPENDING ON DFHEIGDI
 10769     ELSE IF DFHEIGDJ EQUAL 9
 10770         GO TO 4020-BUS-TYPE-ERROR
 10771         DEPENDING ON DFHEIGDI
 10772     ELSE IF DFHEIGDJ EQUAL 10
 10773         GO TO 4099-STD-BEN-ERROR
 10774         DEPENDING ON DFHEIGDI
 10775     ELSE IF DFHEIGDJ EQUAL 11
 10776         GO TO 4180-REIN-ERROR
 10777         DEPENDING ON DFHEIGDI
 10778     ELSE IF DFHEIGDJ EQUAL 12
 10779         GO TO 5250-QID-ERROR
 10780         DEPENDING ON DFHEIGDI
 10781     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 207
* EL6501.cbl
 10782         GO TO 5399-EXIT,
 10783               5399-EXIT
 10784         DEPENDING ON DFHEIGDI
 10785     ELSE IF DFHEIGDJ EQUAL 14
 10786         GO TO 6450-NOT-FOUND
 10787         DEPENDING ON DFHEIGDI
 10788     ELSE IF DFHEIGDJ EQUAL 15
 10789         GO TO 6699-EXIT
 10790         DEPENDING ON DFHEIGDI
 10791     ELSE IF DFHEIGDJ EQUAL 16
 10792         GO TO 6880-NO-COMP
 10793         DEPENDING ON DFHEIGDI
 10794     ELSE IF DFHEIGDJ EQUAL 17
 10795         GO TO 6925-NOT-FIND,
 10796               6925-NOT-FIND
 10797         DEPENDING ON DFHEIGDI
 10798     ELSE IF DFHEIGDJ EQUAL 18
 10799         GO TO 7999-EXIT,
 10800               7999-EXIT
 10801         DEPENDING ON DFHEIGDI
 10802     ELSE IF DFHEIGDJ EQUAL 19
 10803         GO TO 8010-EXIT
 10804         DEPENDING ON DFHEIGDI
 10805     ELSE IF DFHEIGDJ EQUAL 20
 10806         GO TO 8055-NOTFND
 10807         DEPENDING ON DFHEIGDI
 10808     ELSE IF DFHEIGDJ EQUAL 21
 10809         GO TO 8300-SEND-TEXT
 10810         DEPENDING ON DFHEIGDI.
 10811     MOVE '9%                    "   ' TO DFHEIV0
 10812     MOVE 'EL6501' TO DFHEIV1
 10813     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10814     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39272     Code:       35168
