* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL689.cbl
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    59* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    60* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    61* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    62* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    63* 122011  CR2011022800001  AJRA  NAPERSOFT
    64* 090612  IR2012090600001  AJRA  NAPERSOFT
    65* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    66* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    67******************************************************************
    68
    69 DATA DIVISION.
    70 WORKING-STORAGE SECTION.
    71 01  DFH-START PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL689.cbl
    72 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    73 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    74                                   USAGE POINTER.
    75 77  FILLER  PIC X(32) VALUE '********************************'.
    76 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    77 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    78 01  P pointer.
    79 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    80 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    81 01  var-ptr pointer.
    82 01  env-var-len                 pic 9(4)  binary.
    83 01  rc                          pic 9(9)  binary.
    84 01  WS-KIXHOST                  PIC X(10).
    85 01  WS-KIXSYS.
    86     05  WS-KIX-FIL1             PIC X(10).
    87     05  WS-KIX-APPS             PIC X(10).
    88     05  WS-KIX-ENV              PIC X(10).
    89     05  WS-KIX-MYENV            PIC X(10).
    90     05  WS-KIX-SYS              PIC X(10).
    91 01 srch-commarea.
    92*                                copy ELCADLTRSPI.
    93******************************************************************
    94*                   C H A N G E   L O G
    95*
    96* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    97*-----------------------------------------------------------------
    98*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    99* EFFECTIVE    NUMBER
   100*-----------------------------------------------------------------
   101* 060611    2011022800001  PEMA  NEW COPYBOOK
   102******************************************************************
   103****************************************
   104*  commarea for NaperSoft On Demand Admin services letters
   105*  (business logic input & output)
   106****************************************
   107     03  BL-INPUT.
   108         05  BL-DATA-SRCE        PIC X.
   109         05  BL-LETTER-ID        PIC XXXX.
   110         05  BL-CARRIER          PIC X.
   111         05  BL-GROUP            PIC X(6).
   112         05  BL-STATE            PIC XX.
   113         05  BL-ACCOUNT          PIC X(10).
   114         05  BL-EFF-DT           PIC X(10).
   115         05  BL-CERT-NO          PIC X(11).
   116         05  BL-BATCH-NO         PIC X(6).
   117         05  BL-BATCH-SEQ        PIC 9(8).
   118         05  BL-RESP-NO          PIC X(10).
   119         05  BL-NO-OF-COPIES     PIC 99.
   120         05  BL-PROC-ID          PIC XXXX.
   121         05  BL-COMP-ID          PIC XXX.
   122         05  BL-PRINT-NOW-SW     PIC X.
   123         05  BL-ENC-CD           PIC XXX.
   124         05  BL-RESEND-DT        PIC X(10).
   125         05  BL-FOLLOW-UP-DT     PIC X(10).
   126         05  BL-ARCHIVE-NO       PIC 9(8).
   127         05  BL-FUNC             PIC X(8).
   128         05  BL-COMMENTS         PIC X(70).
   129         05  FILLER REDEFINES BL-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL689.cbl
   130             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   131             10  BL-LETTER-TO-ACCT PIC X.
   132             10  BL-LETTER-TO-BENE PIC X.
   133             10  BL-WRITE-ERARCH   PIC X.
   134                 88  ERARCH-QWS      VALUE 'Q'.
   135                 88  ERARCH-BATCH    VALUE 'B'.
   136                 88  ERARCH-TEMP     VALUE 'T'.
   137             10  BL-PROCESS-TYPE PIC X(07).
   138             10  BL-CERT-FORM-ID PIC X(05).
   139             10  FILLER          PIC X(07).
   140     03  BL-OUTPUT.
   141         05  BL-STATUS                   PIC X.
   142             88  BL-OK                      VALUE "P".
   143             88  BL-FAIL                  VALUE "F".
   144         05  BL-MESSAGE          PIC X(50).
   145     03  BL-RECORD-PASSED-DATA   PIC X(4754).
   146 01  W-WORK-AREAS.
   147     12  FILLER                  PIC  X(18)
   148                                      VALUE 'PROGRAM WORK AREA:'.
   149
   150     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   151     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   152     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   153     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   154     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   155     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   156     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   157     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   158     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   159     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   160
   161     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   162     12  W-DIFFERENCE            PIC S9(07)V9(02)
   163                                            VALUE +0   COMP-3.
   164     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   165     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   166     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   167     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   168     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   169     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   170     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   171     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   172     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   173     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   174     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   175     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   176     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   177     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   178     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   179     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   180     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   181     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   182     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   183     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   184     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   185     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   186     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   187     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL689.cbl
   188     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   189                                            VALUE +0   COMP-3.
   190
   191     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   192     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   193         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   194     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   195     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   196     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   197     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   198     12  W-SAVE-REVISION         PIC  9(03) value 0.
   199     12  W-DISPLAY-3             PIC  9(03) value 0.
   200     12  W-DISPLAY-8             PIC  9(08) value 0.
   201     12  W-DISPLAY-7             PIC  9(07) value 0.
   202     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   203     12  W-EDIT-3-0              PIC  ZZ9.
   204     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   205     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   206     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   207     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   208
   209     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   210         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   211
   212     12  W-ARCH-SUPPRESS         PIC 99999999.
   213     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   214                                 PIC  X(08).
   215     12  W-COMP-WORK-AREA.
   216         16  W-CWA-CHAR OCCURS 10 TIMES
   217                                 PIC  X(01).
   218     12  W-INCOMING-ARCHIVE      PIC  X(08).
   219     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   220                                 PIC  9(08).
   221
   222     12  W-BATCH-BREAKDOWN.
   223         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   224         16  W-BATCH-SEQ         PIC S9(04) COMP.
   225     12  W-BEN-HOLD              PIC  X(02).
   226     12  W-BENEFIT-WORK          PIC  X(03).
   227     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   228         16  W-ELIM-DAYS         PIC  X(02).
   229         16  FILLER              PIC  X(01).
   230     12  W-CALL-PGM              PIC  X(08).
   231     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   232
   233     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   234     12  W-LINE-CONTROL-RECORD.
   235         16  W-LC-LINE-WIDTH     PIC  9(02).
   236         16  FILLER              PIC  X(01).
   237         16  W-LC-PARAGRAPH-INDENT
   238                                 PIC  9(02).
   239         16  FILLER              PIC  X(01).
   240         16  W-LC-MAX-LINES-PER-PAGE
   241                                 PIC  9(02).
   242         16  FILLER              PIC  X(01).
   243         16  W-LC-LINE-ADJUST    PIC  9(02).
   244         16  FILLER              PIC  X(01).
   245         16  W-LC-LINE-INDENT-1  PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL689.cbl
   246         16  FILLER              PIC  X(01).
   247         16  W-LC-LINE-INDENT-2  PIC  9(02).
   248         16  FILLER              PIC  X(01).
   249         16  W-LC-LINE-INDENT-3  PIC  9(02).
   250         16  FILLER              PIC  X(01).
   251         16  W-LC-LINE-INDENT-4  PIC  9(02).
   252         16  FILLER              PIC  X(01).
   253         16  W-LC-LINE-INDENT-5  PIC  9(02).
   254         16  FILLER              PIC  X(01).
   255         16  W-LC-TOP-MARGIN     PIC  9(02).
   256         16  FILLER              PIC  X(01).
   257         16  W-LC-CASE-IND       PIC  X(01).
   258             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   259         16  FILLER              PIC  X(01).
   260         16  W-LC-PAGE-IND       PIC  X(01).
   261             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   262     12  W-DATE-WORK             PIC  9(07).
   263     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   264         16  FILLER              PIC  X(02).
   265         16  W-DT-WORK           PIC  9(05).
   266
   267     12  W-DEEDIT-FIELD          PIC  X(15).
   268     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   269
   270     12  W-EDIT-DATE-1.
   271         16  W-ED1-MM            PIC  X(02).
   272         16  FILLER              PIC  X(01) VALUE '/'.
   273         16  W-ED1-DD            PIC  X(02).
   274         16  FILLER              PIC  X(01) VALUE '/'.
   275         16  W-ED1-YY            PIC  X(02).
   276
   277     12  W-EDIT-DATE-2.
   278         16  W-ED2-DD            PIC  X(02).
   279         16  FILLER              PIC  X(01) VALUE '/'.
   280         16  W-ED2-MM            PIC  X(02).
   281         16  FILLER              PIC  X(01) VALUE '/'.
   282         16  W-ED2-YY            PIC  X(02).
   283
   284     12  W-LABEL-HOLD-AREA.
   285         16  W-LABEL-LINES OCCURS 6 TIMES.
   286             20  W-LABEL-ZIP.
   287                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   288                 24  W-LABEL-DASH     PIC  X(01).
   289                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   290             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   291                 24  W-LAB-CAN-POSTAL-CD-1
   292                                      PIC  X(03).
   293                 24  W-LAB-CAN-DASH   PIC  X(01).
   294                 24  W-LAB-CAN-POSTAL-CD-2
   295                                      PIC  X(03).
   296                 24  W-LAB-CAN-FILLER PIC  X(03).
   297             20  FILLER               PIC  X(10).
   298             20  W-LAST-ZIP.
   299                 24  W-LAST-1ST-ZIP   PIC  X(05).
   300                 24  W-LABEL-DASH-LAST
   301                                      PIC  X(01).
   302                 24  W-LAST-2ND-ZIP   PIC  X(04).
   303             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL689.cbl
   304                 24  W-LAST-CAN-POSTAL-CD-1
   305                                      PIC  X(03).
   306                 24  W-LAST-CAN-DASH  PIC  X(01).
   307                 24  W-LAST-CAN-POSTAL-CD-2
   308                                      PIC  X(03).
   309                 24  W-LAST-CAN-FILLER
   310                                      PIC  X(03).
   311
   312     12  W-LAST-CHAR             PIC  X(01).
   313         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   314     12  W-LAST-SQ-CHAR          PIC  X(01).
   315
   316     12  W-LINE-NUM.
   317         16  W-LINE1             PIC  X(01).
   318         16  W-LINE23            PIC  9(02).
   319     12  W-LIN-NUM REDEFINES W-LINE-NUM
   320                                 PIC  9(03).
   321
   322     12  W-NAME-LAST             PIC  X(15).
   323     12  W-NAME-FIRST.
   324         16  W-NAME-FIRST-INIT   PIC  X(01).
   325         16  W-NAME-FIRST-REMAIN PIC  X(14).
   326     12  W-NAME-MIDDLE.
   327         16  FILLER              PIC  X(01).
   328         16  W-NAME-MIDDLE-2     PIC  X(01).
   329         16  FILLER              PIC  X(13).
   330
   331     12  W-PAGE-PRT.
   332         16  FILLER              PIC  X(34) VALUE SPACES.
   333         16  W-PAGE-NUMBER       PIC  Z9.
   334         16  FILLER              PIC  X(01) VALUE '.'.
   335         16  FILLER              PIC  X(33) VALUE SPACES.
   336
   337     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   338     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   339         16  FILLER              PIC  9(01).
   340         16  W-PHI-AREA          PIC  9(03).
   341         16  W-PHI-PFX           PIC  9(03).
   342         16  W-PHI-SFX           PIC  9(04).
   343     12  W-PHONE-OUT.
   344         16  W-PO-AREA           PIC  X(03).
   345         16  FILLER              PIC  X(01) VALUE '-'.
   346         16  W-PO-PFX            PIC  X(03).
   347         16  FILLER              PIC  X(01) VALUE '-'.
   348         16  W-PO-SFX            PIC  X(04).
   349
   350     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   351     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   352     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   353
   354     12  W-SINGLE-LINE           PIC  X(70).
   355     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   356         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   357                                 PIC  X(01).
   358
   359     12  W-SQUEEZED-LINE.
   360         16  W-SQ-CHAR OCCURS 70 TIMES
   361                       INDEXED BY W-SQ-NDX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL689.cbl
   362                                 PIC  X(01).
   363
   364     12  W-TIME-IN               PIC S9(07).
   365     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   366         16  FILLER              PIC  X(01).
   367         16  W-TIME-OUT          PIC  99V9(02).
   368         16  FILLER              PIC  X(02).
   369
   370     12  W-TS-NAME-TEXT.
   371         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   372         16  W-TS-ID-TIME
   373             REDEFINES W-TS-ID-TEXT
   374                                 PIC S9(07) COMP-3.
   375         16  W-TS-TERM-TEXT.
   376             20 W-TS-TERM-PREFIX PIC  X(02).
   377             20 FILLER           PIC  X(02).
   378     12  W-TS-NAME-SCREEN.
   379         16  FILLER              PIC  X(04) VALUE '689X'.
   380         16  W-TS-TERM-SCREEN    PIC  X(04).
   381
   382     12  W-WORK-LINE.
   383         16  W-WORK-CHAR OCCURS 70 TIMES
   384                       INDEXED BY W-WC-NDX
   385                                  W-WC-NDX2
   386                                  W-WC-NDX3
   387                                 PIC  X(01).
   388
   389     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   390     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   391         16  W-WORK-ZIP5         PIC  X(05).
   392         16  W-WORK-ZIP4         PIC  X(04).
   393     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   394         16  W-CAN-POSTAL-CD-1.
   395             20  FILLER          PIC  X(01).
   396                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   397             20  FILLER          PIC  X(02).
   398         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   399         16  W-FILLER            PIC  X(03).
   400
   401**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   402*                   COPY ELCZREC.
   403******************************************************************
   404*                                                                *
   405*                                                                *
   406*                            ELCZREC.                            *
   407*                                                                *
   408*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   409*                                                                *
   410******************************************************************
   411*-----------------------------------------------------------------
   412*                   C H A N G E   L O G
   413*
   414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   415*-----------------------------------------------------------------
   416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   417* EFFECTIVE    NUMBER
   418*-----------------------------------------------------------------
   419* 122011    2011022800001  AJRA  NEW FILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL689.cbl
   420* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   421*-----------------------------------------------------------------
   422 01  W-Z-CONTROL-DATA.
   423     05  W-NUMBER-OF-COPIES      PIC  9.
   424     05  FILLER                  PIC  X.
   425     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   426     05  FILLER                  PIC  X.
   427     05  W-DAYS-TO-RESEND        PIC  999.
   428     05  FILLER                  PIC  X.
   429     05  W-FORM-TO-RESEND        PIC  X(4).
   430     05  FILLER                  PIC  X.
   431     05  W-PROMPT-LETTER         PIC  X.
   432     05  FILLER                  PIC  X.
   433     05  W-ENCLOSURE-CD          PIC  XXX.
   434     05  FILLER                  PIC  X.
   435     05  W-AUTO-CLOSE-IND        PIC  X.
   436     05  FILLER                  PIC  X.
   437     05  W-LETTER-TO-BENE        PIC  X.
   438     05  FILLER                  PIC  X.
   439     05  W-LETTER-TO-ACCT        PIC  X.
   440     05  FILLER                  PIC  X.
   441     05  W-LETTER-TYPE           PIC  X.
   442     05  FILLER                  PIC  X.
   443     05  W-PRINT-CERTIFICATE     PIC  X.
   444     05  FILLER                  PIC  X.
   445     05  W-REFUND-REQUIRED       PIC  X.
   446     05  FILLER                  PIC  X.
   447     05  W-ONBASE-CODE           PIC  XX.
   448     05  FILLER                  PIC  X.
   449     05  W-ACCT-SUMM             PIC  X.
   450     05  FILLER                  PIC  X.
   451     05  W-CSO-SUMM              PIC  X.
   452     05  FILLER                  PIC  X(31).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL689.cbl
   454 01  W-SWITCH-INDICATORS-AREA.
   455     12  FILLER                  PIC  X(16)
   456                                      VALUE 'PROGRAM SWITCHS:'.
   457     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   458         88  W-ADDRESS-ONLY      VALUE 'Y'.
   459         88  W-FULL-DATA         VALUE ' '.
   460     12  W-ACCT-BROWSE-STARTED-SW
   461                                 PIC  X(01) VALUE 'N'.
   462         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   463     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   464     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   465         88  W-CERT-FOUND                   VALUE 'Y'.
   466     12  W-CHARACTER-TYPE        PIC  X(01).
   467         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   468         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   469         88  W-SPACE             VALUE ' '.
   470     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   471         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   472     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   473         88  W-DATA-SHRINKING    VALUE 'Y'.
   474     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   475         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   476     12  W-FIRST-BAD-VARIABLE-IND
   477                                 PIC  X(01) VALUE SPACES.
   478         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   479     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   480         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   481         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   482     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   483         88  W-FORM-CHANGED                 VALUE 'Y'.
   484     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   485         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   486         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   487     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   488         88  W-HOLD-ON                      VALUE 'Y'.
   489         88  W-HOLD-OFF                     VALUE ' '.
   490     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   491         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   492         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   493     12  W-KEY-FIELDS-CHANGED-IND
   494                                 PIC  X(01) VALUE ' '.
   495         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   496         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   497     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   498         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   499     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   500         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   501                                                   'T' 'U'.
   502         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   503                                                   'G' 'H'.
   504         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   505         88  W-DO-NOT-ADJUST                VALUE 'N'.
   506         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   507         88  W-AS-IS                        VALUE 'A' 'N'.
   508         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   509                                                   '4' '5'.
   510
   511     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL689.cbl
   512         88  W-PNDB-FOUND                   VALUE 'Y'.
   513     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   514         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   515     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   516         88  W-REVERSE-DATE                 VALUE 'Y'.
   517     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   518         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   519         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL689.cbl
   521 01  WS-SAVE-AREA.
   522     12  WS-SAV-AM-DEFN-1.
   523         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   524             20  WS-SAV-AM-AGT             PIC  X(10).
   525             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   526             20  FILLER                    PIC  X(15).
   527     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   528     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   529     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   530     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   531     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   532     12  WS-SAV-AM-NAME                    PIC  X(30).
   533     12  WS-SAV-AM-PERSON                  PIC  X(30).
   534     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   535     12  WS-SAV-AM-CITY                    PIC  X(30).
   536     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   537     12  WS-SAV-AM-ZIP.
   538         16  WS-SAV-AM-ZIP-PRIME.
   539             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   540                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   541                     'A' THRU 'Z'.
   542             20  FILLER                    PIC  X(04).
   543         16  FILLER                        PIC  X(04).
   544     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   545                        WS-SAV-AM-ZIP      PIC  X(09).
   546     12  WS-SAV-AM-TEL-NO.
   547         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   548         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   549         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   550 01  W-KEY-AREAS.
   551     12  FILLER                    PIC  X(13)
   552                                      VALUE 'PROGRAM KEYS:'.
   553
   554     12  W-ACCT-SAVE-KEY           PIC  X(20).
   555     12  W-ACCT-KEY.
   556         16  W-ACCT-PARTIAL-KEY.
   557             20  W-ACCT-COMPANY-CD PIC  X(01).
   558             20  W-ACCT-CARRIER    PIC  X(01).
   559             20  W-ACCT-GROUPING   PIC  X(06).
   560             20  W-ACCT-STATE      PIC  X(02).
   561             20  W-ACCT-ACCOUNT    PIC  X(10).
   562         16  W-ACCT-EXP-DT         PIC  X(02).
   563
   564     12  W-ARCH-SAVE-KEY         PIC  X(05).
   565     12  W-ARCH-KEY.
   566         16  W-ARCH-PARTIAL-KEY.
   567             20  W-ARCH-COMPANY-CD
   568                                 PIC  X(01).
   569             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   570         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   571
   572     12  W-ARCT-KEY.
   573         16  W-ARCT-PARTIAL-KEY.
   574             20  W-ARCT-COMPANY-CD
   575                                 PIC  X(01).
   576             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   577         16  W-ARCT-REC-TYPE     PIC  X(01).
   578         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL689.cbl
   579
   580     12  W-CERT-KEY.
   581         16  W-CERT-COMPANY-CD   PIC  X(01).
   582         16  W-CERT-CARRIER      PIC  X(01).
   583         16  W-CERT-GROUPING     PIC  X(06).
   584         16  W-CERT-STATE        PIC  X(02).
   585         16  W-CERT-ACCOUNT      PIC  X(10).
   586         16  W-CERT-EFF-DT       PIC  X(02).
   587         16  W-CERT-CERT-NO.
   588             20  W-CERT-CERT-PRIME
   589                                 PIC  X(10).
   590             20  W-CERT-CERT-SFX PIC  X(01).
   591
   592     12  W-CHEK-KEY.
   593         16  W-CHEK-COMPANY-CD   PIC  X(01).
   594         16  W-CHEK-CARRIER      PIC  X(01).
   595         16  W-CHEK-GROUPING     PIC  X(06).
   596         16  W-CHEK-STATE        PIC  X(02).
   597         16  W-CHEK-ACCOUNT      PIC  X(10).
   598         16  W-CHEK-EFF-DT       PIC  X(02).
   599         16  W-CHEK-CERT-NO.
   600             20  W-CHEK-CERT-PRIME
   601                                 PIC  X(10).
   602             20  W-CHEK-CERT-SFX PIC  X(01).
   603         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   604
   605     12  W-CNTL-KEY.
   606         16  W-CNTL-COMPANY-ID   PIC  X(03).
   607         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   608         16  W-CNTL-GENL.
   609             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   610             20  W-CNTL-GEN2.
   611                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   612                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   613         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   614
   615     12  W-COMP-SAVE-KEY         PIC  X(29).
   616     12  W-COMP-KEY.
   617         16  W-COMP-COMPANY-CD   PIC  X(01).
   618         16  W-COMP-CARRIER      PIC  X(01).
   619         16  W-COMP-GROUPING     PIC  X(06).
   620         16  W-COMP-RESP-PERSON.
   621             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   622                                INDEXED BY W-COMP-NDX
   623                                 PIC  X(01).
   624         16  W-COMP-ACCOUNT      PIC  X(10).
   625         16  W-COMP-TYPE         PIC  X(01).
   626
   627     12  W-DELETE-KEY.
   628         16  W-DELETE-PARTIAL-KEY.
   629             20  W-DELETE-COMPANY-CD
   630                                 PIC  X(01).
   631             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   632         16  W-DELETE-RECORD-TYPE
   633                                 PIC  X(01).
   634         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   635
   636     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL689.cbl
   637         16  W-MAIL-COMPANY-CD   PIC  X(01).
   638         16  W-MAIL-CARRIER      PIC  X(01).
   639         16  W-MAIL-GROUPING     PIC  X(06).
   640         16  W-MAIL-STATE        PIC  X(02).
   641         16  W-MAIL-ACCOUNT      PIC  X(10).
   642         16  W-MAIL-EFF-DT       PIC  X(02).
   643         16  W-MAIL-CERT-NO.
   644             20  W-MAIL-CERT-PRIME
   645                                 PIC  X(10).
   646             20  W-MAIL-CERT-SFX PIC  X(01).
   647
   648     12  W-PNDB-KEY.
   649         16  W-PNDB-COMPANY-CD   PIC  X(01).
   650         16  W-PNDB-ENTRY        PIC  X(06).
   651         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   652         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   653
   654     12  W-PNDB2-KEY.
   655         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   656         16  W-PNDB2-CARRIER     PIC  X(01).
   657         16  W-PNDB2-GROUPING    PIC  X(06).
   658         16  W-PNDB2-STATE       PIC  X(02).
   659         16  W-PNDB2-ACCOUNT     PIC  X(10).
   660         16  W-PNDB2-EFF-DT      PIC  X(02).
   661         16  W-PNDB2-CERT-NO.
   662             20  W-PNDB2-CERT-PRIME
   663                                 PIC  X(10).
   664             20  W-PNDB2-CERT-SFX
   665                                 PIC  X(01).
   666         16  W-PNDB2-ALT-CHG-SEQ-NO
   667                                 PIC S9(04)  COMP.
   668         16  W-PNDB2-TYPE        PIC  X(01).
   669
   670     12  W-PYAJ-KEY.
   671         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   672         16  W-PYAJ-CARRIER      PIC  X(01).
   673         16  W-PYAJ-GROUPING     PIC  X(06).
   674         16  W-PYAJ-FIN-RESP     PIC  X(10).
   675         16  W-PYAJ-ACCOUNT      PIC  X(10).
   676         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   677         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   678
   679     12  W-SC-QUID-KEY.
   680         16  W-SC-QUID-TERMINAL  PIC  X(04).
   681         16  W-SC-QUID-SYSTEM    PIC  X(04).
   682
   683     12  W-TEXT-SAVE-KEY         PIC  X(05).
   684     12  W-TEXT-KEY.
   685         16  W-TEXT-PARTIAL-KEY.
   686             20  W-TEXT-COMPANY-CD
   687                                 PIC  X(01).
   688             20  W-TEXT-LETTER   PIC  X(04).
   689         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   690         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   691
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL689.cbl
   693 01  FILLER                      PIC  X(22)
   694                                 VALUE 'INTERFACE AREA STARTS:'.
   695*    COPY ELCINTF.
   696******************************************************************
   697*                                                                *
   698*                                                                *
   699*                            ELCINTF.                            *
   700*                            VMOD=2.017                          *
   701*                                                                *
   702*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   703*                                                                *
   704*       LENGTH = 1024                                            *
   705*                                                                *
   706******************************************************************
   707*                   C H A N G E   L O G
   708*
   709* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   710*-----------------------------------------------------------------
   711*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   712* EFFECTIVE    NUMBER
   713*-----------------------------------------------------------------
   714* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   715******************************************************************
   716 01  PROGRAM-INTERFACE-BLOCK.
   717     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   718     12  PI-CALLING-PROGRAM              PIC X(8).
   719     12  PI-SAVED-PROGRAM-1              PIC X(8).
   720     12  PI-SAVED-PROGRAM-2              PIC X(8).
   721     12  PI-SAVED-PROGRAM-3              PIC X(8).
   722     12  PI-SAVED-PROGRAM-4              PIC X(8).
   723     12  PI-SAVED-PROGRAM-5              PIC X(8).
   724     12  PI-SAVED-PROGRAM-6              PIC X(8).
   725     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   726     12  PI-COMPANY-ID                   PIC XXX.
   727     12  PI-COMPANY-CD                   PIC X.
   728
   729     12  PI-COMPANY-PASSWORD             PIC X(8).
   730
   731     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   732
   733     12  PI-CONTROL-IN-PROGRESS.
   734         16  PI-CARRIER                  PIC X.
   735         16  PI-GROUPING                 PIC X(6).
   736         16  PI-STATE                    PIC XX.
   737         16  PI-ACCOUNT                  PIC X(10).
   738         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   739                                         PIC X(10).
   740         16  PI-CLAIM-CERT-GRP.
   741             20  PI-CLAIM-NO             PIC X(7).
   742             20  PI-CERT-NO.
   743                 25  PI-CERT-PRIME       PIC X(10).
   744                 25  PI-CERT-SFX         PIC X.
   745             20  PI-CERT-EFF-DT          PIC XX.
   746         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   747             20  PI-PLAN-CODE            PIC X(2).
   748             20  PI-REVISION-NUMBER      PIC X(3).
   749             20  PI-PLAN-EFF-DT          PIC X(2).
   750             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL689.cbl
   751             20  FILLER                  PIC X(11).
   752         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   753             20  PI-OE-REFERENCE-1.
   754                 25  PI-OE-REF-1-PRIME   PIC X(18).
   755                 25  PI-OE-REF-1-SUFF    PIC XX.
   756
   757     12  PI-SESSION-IN-PROGRESS          PIC X.
   758         88  CLAIM-SESSION                   VALUE '1'.
   759         88  CREDIT-SESSION                  VALUE '2'.
   760         88  WARRANTY-SESSION                VALUE '3'.
   761         88  MORTGAGE-SESSION                VALUE '4'.
   762         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   763
   764
   765*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   766
   767     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   768     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   769
   770     12  PI-CREDIT-USER                  PIC X.
   771         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   772         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   773
   774     12  PI-CLAIM-USER                   PIC X.
   775         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   776         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   777
   778     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   779         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   780         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   781         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   782         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   783         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   784
   785     12  PI-PROCESSOR-ID                 PIC X(4).
   786
   787     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   788
   789     12  PI-MEMBER-CAPTION               PIC X(10).
   790
   791     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   792         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   793
   794     12  PI-LIFE-OVERRIDE-L1             PIC X.
   795     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   796     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   797     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   798
   799     12  PI-AH-OVERRIDE-L1               PIC X.
   800     12  PI-AH-OVERRIDE-L2               PIC XX.
   801     12  PI-AH-OVERRIDE-L6               PIC X(6).
   802     12  PI-AH-OVERRIDE-L12              PIC X(12).
   803
   804     12  PI-NEW-SYSTEM                   PIC X(2).
   805
   806     12  PI-PRIMARY-CERT-NO              PIC X(11).
   807     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   808         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL689.cbl
   809     12  PI-CRDTCRD-SYSTEM.
   810         16  PI-CRDTCRD-USER             PIC X.
   811             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   812             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   813         16  PI-CC-MONTH-END-DT          PIC XX.
   814     12  PI-PROCESSOR-PRINTER            PIC X(4).
   815
   816     12  PI-OE-REFERENCE-2.
   817         16  PI-OE-REF-2-PRIME           PIC X(10).
   818         16  PI-OE-REF-2-SUFF            PIC X.
   819
   820     12  PI-REM-TRM-CALC-OPTION          PIC X.
   821
   822     12  PI-LANGUAGE-TYPE                PIC X.
   823             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   824             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   825             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   826
   827     12  PI-POLICY-LINKAGE-IND           PIC X.
   828         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   829         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   830                                                   LOW-VALUES.
   831
   832     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   833     12  PI-CLAIM-PW-SESSION             PIC X(1).
   834         88  PI-CLAIM-CREDIT                 VALUE '1'.
   835         88  PI-CLAIM-CONVEN                 VALUE '2'.
   836
   837     12  PI-PROCESSOR-CSR-IND            PIC X.
   838         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   839         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   840
   841     12  FILLER                          PIC X(3).
   842
   843     12  PI-SYSTEM-LEVEL                 PIC X(145).
   844
   845     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   846         PI-SYSTEM-LEVEL.
   847
   848         16  PI-ENTRY-CODES.
   849             20  PI-ENTRY-CD-1           PIC X.
   850             20  PI-ENTRY-CD-2           PIC X.
   851
   852         16  PI-RETURN-CODES.
   853             20  PI-RETURN-CD-1          PIC X.
   854             20  PI-RETURN-CD-2          PIC X.
   855
   856         16  PI-UPDATE-STATUS-SAVE.
   857             20  PI-UPDATE-BY            PIC X(4).
   858             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   859
   860         16  PI-LOWER-CASE-LETTERS       PIC X.
   861             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   862
   863*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   864*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   865*            88  CARRIER-CLM-CNTL            VALUE '2'.
   866
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL689.cbl
   867         16  PI-CERT-ACCESS-CONTROL      PIC X.
   868             88  ST-ACCNT-CNTL               VALUE ' '.
   869             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   870             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   871             88  ACCNT-CNTL                  VALUE '3'.
   872             88  CARR-ACCNT-CNTL             VALUE '4'.
   873
   874         16  PI-PROCESSOR-CAP-LIST.
   875             20  PI-SYSTEM-CONTROLS.
   876                24 PI-SYSTEM-DISPLAY     PIC X.
   877                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   878                24 PI-SYSTEM-MODIFY      PIC X.
   879                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   880             20  FILLER                  PIC XX.
   881             20  PI-DISPLAY-CAP          PIC X.
   882                 88  DISPLAY-CAP             VALUE 'Y'.
   883             20  PI-MODIFY-CAP           PIC X.
   884                 88  MODIFY-CAP              VALUE 'Y'.
   885             20  PI-MSG-AT-LOGON-CAP     PIC X.
   886                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   887             20  PI-FORCE-CAP            PIC X.
   888                 88  FORCE-CAP               VALUE 'Y'.
   889
   890         16  PI-PROGRAM-CONTROLS.
   891             20  PI-PGM-PRINT-OPT        PIC X.
   892             20  PI-PGM-FORMAT-OPT       PIC X.
   893             20  PI-PGM-PROCESS-OPT      PIC X.
   894             20  PI-PGM-TOTALS-OPT       PIC X.
   895
   896         16  PI-HELP-INTERFACE.
   897             20  PI-LAST-ERROR-NO        PIC X(4).
   898             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   899
   900         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   901             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   902
   903         16  PI-CR-CONTROL-IN-PROGRESS.
   904             20  PI-CR-CARRIER           PIC X.
   905             20  PI-CR-GROUPING          PIC X(6).
   906             20  PI-CR-STATE             PIC XX.
   907             20  PI-CR-ACCOUNT           PIC X(10).
   908             20  PI-CR-FIN-RESP          PIC X(10).
   909             20  PI-CR-TYPE              PIC X.
   910
   911         16  PI-CR-BATCH-NUMBER          PIC X(6).
   912
   913         16  PI-CR-MONTH-END-DT          PIC XX.
   914
   915         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   916             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   917             88  PI-ZERO-CARRIER             VALUE '1'.
   918             88  PI-ZERO-GROUPING            VALUE '2'.
   919             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   920
   921         16  PI-CARRIER-SECURITY         PIC X.
   922             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   923
   924         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL689.cbl
   925             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   926             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   927
   928         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   929             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   930                                         INDEXED BY PI-ACCESS-NDX
   931                                         PIC X.
   932
   933         16  PI-GA-BILLING-CONTROL       PIC X.
   934             88  PI-GA-BILLING               VALUE '1'.
   935
   936         16  PI-MAIL-PROCESSING          PIC X.
   937             88  PI-MAIL-YES                 VALUE 'Y'.
   938
   939         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   940
   941         16  PI-AR-SYSTEM.
   942             20  PI-AR-PROCESSING-CNTL   PIC X.
   943                 88  PI-AR-PROCESSING        VALUE 'Y'.
   944             20  PI-AR-SUMMARY-CODE      PIC X(6).
   945             20  PI-AR-MONTH-END-DT      PIC XX.
   946
   947         16  PI-MP-SYSTEM.
   948             20  PI-MORTGAGE-USER            PIC X.
   949                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   950                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   951             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   952                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   953                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   954                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   955                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   956                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   957             20  PI-MP-MONTH-END-DT          PIC XX.
   958             20  PI-MP-REFERENCE-NO.
   959                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   960                 24  PI-MP-REFERENCE-SFX     PIC XX.
   961
   962         16  PI-LABEL-CONTROL            PIC X(01).
   963             88  PI-CREATE-LABELS                    VALUE 'Y'.
   964             88  PI-BYPASS-LABELS                    VALUE 'N'.
   965
   966         16  PI-BILL-GROUPING-CODE       PIC X(01).
   967             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   968
   969         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   970             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   971             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   972
   973         16  FILLER                      PIC X(14).
   974
   975     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   976******************************************************************
   977     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   978*    COPY ELC1042.
   979******************************************************************
   980*                                                                *
   981*                                                                *
   982*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL689.cbl
   983*                            VMOD=2.002                          *
   984*                                                                *
   985*    NOTE                                                        *
   986*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   987*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   988*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   989*        TO THESE PROGRAMS.                                      *
   990*                                                                *
   991*    NOTE                                                        *
   992*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   993*        USE ONLY!                                               *
   994*                                                                *
   995******************************************************************
   996
   997         16  PI-1042-WA.
   998             20  PI-ACTION       PIC  X(01).
   999                 88 PI-SHOW-MODE           VALUE '1'.
  1000                 88 PI-CLEAR-MODE          VALUE '2'.
  1001                 88 PI-CREATE-MODE         VALUE '3'.
  1002             20  PI-COMM-CONTROL PIC  X(12).
  1003             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1004             20  PI-EOF-SW       PIC  X(01).
  1005                 88  PI-FILE-EOF           VALUE 'Y'.
  1006             20  PI-FILETYP      PIC  X(01).
  1007             20  PI-FORM-SQUEEZE-CONTROL
  1008                                 PIC  X(01).
  1009                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1010                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1011             20  PI-LAST-CONTROL PIC  X(12).
  1012             20  PI-TEMP-STOR-ITEMS
  1013                                 PIC S9(04) COMP.
  1014             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1015             20  PI-UPDATE-SW    PIC  9(01).
  1016                 88 ANY-UPDATES            VALUE 1.
  1017             20  PI-104-SCREEN-SENT-IND
  1018                                 PIC  X(01).
  1019                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1020                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1021             20  PI-1042-SCREEN-SENT-IND
  1022                                 PIC  X(01).
  1023                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1024                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1025             20  PI-1042-ARCHIVE-IND
  1026                                 PIC  X(01).
  1027                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1028             20  FILLER          PIC  X(29).
  1029*    COPY ELC689PI.
  1030******************************************************************
  1031*                                                                *
  1032*                            ELC689PI                            *
  1033*                            VMOD=2.003                          *
  1034*                                                                *
  1035*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1036*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1037*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1038*                                                                *
  1039*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1040*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL689.cbl
  1041*    BETWEEN PROGRAMS.                                           *
  1042*                                                                *
  1043*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1044*                                                                *
  1045*               EL631 - EL689  - EL6891 - EL6892                 *
  1046*                                                                *
  1047******************************************************************
  1048*                   C H A N G E   L O G
  1049*
  1050* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1051*-----------------------------------------------------------------
  1052*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1053* EFFECTIVE    NUMBER
  1054*-----------------------------------------------------------------
  1055* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1056* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1057* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1058******************************************************************
  1059
  1060
  1061         16  PI-689-WORK-AREA.
  1062             20  PI-689-ALT-PRINTER-ID
  1063                                 PIC  X(04).
  1064             20  PI-689-ARCHIVE-NUMBER
  1065                                 PIC  9(08).
  1066             20  PI-689-ARCHIVE-SW
  1067                                 PIC  X(01).
  1068                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1069             20  PI-689-DATA-SOURCE
  1070                                 PIC  X(01).
  1071                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1072                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1073                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1074                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1075                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1076             20  PI-689-ERROR-IND
  1077                                 PIC  X(01).
  1078                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1079             20  PI-689-ERROR    PIC  9(04).
  1080                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1081                 88  PI-689-FATAL-ERROR
  1082                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1083                            0042 0047 0051 0066 0067 0070
  1084                            0168 0169 0174 0175 0176 0177 0179
  1085                            0180 0181 0182 0184 0185 0189 0190
  1086                            0191
  1087                            0215 0279 0280
  1088                            0412 0413 0454
  1089                            0533 0537
  1090                            2055 2114 2208 2209 2216 2232 2369
  1091                            2398 2433 2908 2999
  1092                            3000 3770 3771 3775
  1093                            7250 7365 7367 7368 7369 7370 7371
  1094                            7272 7373 7374 7376 7377 7378 7379
  1095                            7381 7388 7390 7393 7395 7396 7398
  1096                            9095 9096 9281 9298 9299 9320 9327
  1097                            9426 9427.
  1098                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL689.cbl
  1099                     VALUES 0004 0008 0013 0023 0029 0033
  1100                            0042 0047 0066 0067 0070
  1101                            0168 0169 0174 0175 0176 0177
  1102                            0181 0182 0184 0185 0189 0190
  1103                            0279 0280
  1104                            0412 0413 0454
  1105                            2055 2208 2209 2216 2232
  1106                            2398 2999
  1107                            3000 3770 3771 3775
  1108                            7250 7365 7369 7370 7371
  1109                            7272 7373 7374 7376 7377 7378 7379
  1110                            7381 7388 7390 7393 7396 7398
  1111                            9095 9096 9299 9320 9426.
  1112             20  PI-689-FOLLOW-UP-DATE
  1113                                 PIC  X(02).
  1114             20  PI-689-FORM-NUMBER
  1115                                 PIC  X(04).
  1116             20  PI-689-LABEL-SOURCE
  1117                                 PIC X(01).
  1118                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1119                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1120                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1121                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1122                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1123                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1124                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1125             20  PI-689-NUMBER-COPIES
  1126                                 PIC  9(01).
  1127             20  PI-689-NUMBER-LABEL-LINES
  1128                                 PIC  9(01).
  1129             20  PI-689-NUMBER-TEXT-RECORDS
  1130                                 PIC  9(03).
  1131             20  PI-689-PRINT-ORDER-SW
  1132                                 PIC  X(01).
  1133                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1134                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1135                 88  PI-689-PRINT-LATER     VALUE '3'.
  1136                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1137             20  PI-689-PRINT-RESTRICTION
  1138                                 PIC  X(01).
  1139                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1140                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1141                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1142             20  PI-689-PRINT-SW PIC  X(01).
  1143                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1144             20  PI-689-RESEND-DATE-1
  1145                                 PIC  X(02).
  1146             20  PI-689-RESEND-LETR-1
  1147                                 PIC X(4).
  1148             20  PI-689-TEMP-STOR-ID
  1149                                 PIC  X(08).
  1150             20  PI-689-USE-SCREEN-IND
  1151                                 PIC  X(01).
  1152                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1153             20  PI-689-ARCH-POINTER
  1154                                 PIC S9(08) COMP.
  1155                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1156             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL689.cbl
  1157                                 PIC S9(08) COMP.
  1158                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1159             20  PI-689-VARIABLE-DATA-GRP.
  1160                 24  PI-689-VARIABLE-DATA-1
  1161                                 PIC  X(30).
  1162                 24  PI-689-VARIABLE-DATA-2
  1163                                 PIC  X(30).
  1164                 24  PI-689-VARIABLE-DATA-3
  1165                                 PIC  X(30).
  1166                 24  PI-689-VARIABLE-DATA-4
  1167                                 PIC  X(30).
  1168
  1169         16  PI-689-KEY-DATA-FIELDS.
  1170             20  PI-689-ACCOUNT  PIC  X(10).
  1171             20  PI-689-CARRIER  PIC  X(01).
  1172             20  PI-689-CERT-NO.
  1173                 24  PI-689-CERT-PRIME
  1174                                 PIC  X(10).
  1175                 24  PI-689-CERT-SFX
  1176                                 PIC  X(01).
  1177             20  PI-689-CHG-SEQ-NO
  1178                                 PIC S9(04)    COMP.
  1179             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1180                                 PIC  X(02).
  1181             20  PI-689-ENTRY-BATCH
  1182                                 PIC  X(06).
  1183             20  PI-689-EFF-DATE PIC  X(02).
  1184             20  PI-689-EXP-DATE PIC  X(02).
  1185             20  PI-689-GROUPING PIC  X(06).
  1186             20  PI-689-RESP-PERSON
  1187                                 PIC  X(10).
  1188             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1189             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1190                                 PIC  X(04).
  1191             20  PI-689-STATE    PIC  X(02).
  1192             20  PI-689-TYPE     PIC  X(01).
  1193             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1194             20  PI-689-ALT-SEQ-NO
  1195                                 PIC S9(04)    COMP.
  1196         16  PI-689-DATE-EDIT    PIC  X(08).
  1197         16  PI-689-FOLLOW-UP-EDIT
  1198                                 PIC  X(08).
  1199         16  PI-689-RESEND1-EDIT PIC  X(08).
  1200         16  PI-689-SEQ-EDIT     PIC  X(08).
  1201         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1202         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1203             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1204         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1205         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1206         16  PI-PROMPT-IND       PIC X(1).
  1207         16  PI-CERT-FORM-ID     PIC X(5).
  1208         16  PI-PRINT-NOW        PIC X(1).
  1209         16  PI-ENCLOSURE-CD     PIC X(3).
  1210         16  PI-CERT-REQ-IND     PIC X(1).
  1211         16  FILLER              PIC X(253).
  1212*        16  FILLER                        PIC X(276).
  1213*        16  FILLER                        PIC X(280).
  1214
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL689.cbl
  1215 01  FILLER                      PIC  X(20)
  1216                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL689.cbl
  1218 01  FILLER                      PIC  X(16)
  1219                        VALUE 'MAP AREA STARTS:'.
  1220*    COPY EL689S.
  1221 01  EL689AI.
  1222     05  FILLER            PIC  X(0012).
  1223*    -------------------------------
  1224     05  RUNDTEL PIC S9(0004) COMP.
  1225     05  RUNDTEF PIC  X(0001).
  1226     05  FILLER REDEFINES RUNDTEF.
  1227         10  RUNDTEA PIC  X(0001).
  1228     05  RUNDTEI PIC  X(0008).
  1229*    -------------------------------
  1230     05  RUNTIMEL PIC S9(0004) COMP.
  1231     05  RUNTIMEF PIC  X(0001).
  1232     05  FILLER REDEFINES RUNTIMEF.
  1233         10  RUNTIMEA PIC  X(0001).
  1234     05  RUNTIMEI PIC  X(0005).
  1235*    -------------------------------
  1236     05  HOSTL PIC S9(0004) COMP.
  1237     05  HOSTF PIC  X(0001).
  1238     05  FILLER REDEFINES HOSTF.
  1239         10  HOSTA PIC  X(0001).
  1240     05  HOSTI PIC  X(0010).
  1241*    -------------------------------
  1242     05  SYSL PIC S9(0004) COMP.
  1243     05  SYSF PIC  X(0001).
  1244     05  FILLER REDEFINES SYSF.
  1245         10  SYSA PIC  X(0001).
  1246     05  SYSI PIC  X(0008).
  1247*    -------------------------------
  1248     05  COMPANYL PIC S9(0004) COMP.
  1249     05  COMPANYF PIC  X(0001).
  1250     05  FILLER REDEFINES COMPANYF.
  1251         10  COMPANYA PIC  X(0001).
  1252     05  COMPANYI PIC  X(0003).
  1253*    -------------------------------
  1254     05  USERIDL PIC S9(0004) COMP.
  1255     05  USERIDF PIC  X(0001).
  1256     05  FILLER REDEFINES USERIDF.
  1257         10  USERIDA PIC  X(0001).
  1258     05  USERIDI PIC  X(0004).
  1259*    -------------------------------
  1260     05  MAINTL PIC S9(0004) COMP.
  1261     05  MAINTF PIC  X(0001).
  1262     05  FILLER REDEFINES MAINTF.
  1263         10  MAINTA PIC  X(0001).
  1264     05  MAINTI PIC  X(0001).
  1265*    -------------------------------
  1266     05  FORML PIC S9(0004) COMP.
  1267     05  FORMF PIC  X(0001).
  1268     05  FILLER REDEFINES FORMF.
  1269         10  FORMA PIC  X(0001).
  1270     05  FORMI PIC  X(0004).
  1271*    -------------------------------
  1272     05  ARCHNUML PIC S9(0004) COMP.
  1273     05  ARCHNUMF PIC  X(0001).
  1274     05  FILLER REDEFINES ARCHNUMF.
  1275         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL689.cbl
  1276     05  ARCHNUMI PIC  99999999.
  1277*    -------------------------------
  1278     05  PRTNOWL PIC S9(0004) COMP.
  1279     05  PRTNOWF PIC  X(0001).
  1280     05  FILLER REDEFINES PRTNOWF.
  1281         10  PRTNOWA PIC  X(0001).
  1282     05  PRTNOWI PIC  X(0001).
  1283*    -------------------------------
  1284     05  CARRIERL PIC S9(0004) COMP.
  1285     05  CARRIERF PIC  X(0001).
  1286     05  FILLER REDEFINES CARRIERF.
  1287         10  CARRIERA PIC  X(0001).
  1288     05  CARRIERI PIC  X(0001).
  1289*    -------------------------------
  1290     05  GROUPL PIC S9(0004) COMP.
  1291     05  GROUPF PIC  X(0001).
  1292     05  FILLER REDEFINES GROUPF.
  1293         10  GROUPA PIC  X(0001).
  1294     05  GROUPI PIC  X(0006).
  1295*    -------------------------------
  1296     05  STATEL PIC S9(0004) COMP.
  1297     05  STATEF PIC  X(0001).
  1298     05  FILLER REDEFINES STATEF.
  1299         10  STATEA PIC  X(0001).
  1300     05  STATEI PIC  X(0002).
  1301*    -------------------------------
  1302     05  ACCTL PIC S9(0004) COMP.
  1303     05  ACCTF PIC  X(0001).
  1304     05  FILLER REDEFINES ACCTF.
  1305         10  ACCTA PIC  X(0001).
  1306     05  ACCTI PIC  X(0010).
  1307*    -------------------------------
  1308     05  CERTL PIC S9(0004) COMP.
  1309     05  CERTF PIC  X(0001).
  1310     05  FILLER REDEFINES CERTF.
  1311         10  CERTA PIC  X(0001).
  1312     05  CERTI PIC  X(0010).
  1313*    -------------------------------
  1314     05  SFXL PIC S9(0004) COMP.
  1315     05  SFXF PIC  X(0001).
  1316     05  FILLER REDEFINES SFXF.
  1317         10  SFXA PIC  X(0001).
  1318     05  SFXI PIC  X(0001).
  1319*    -------------------------------
  1320     05  TYPEL PIC S9(0004) COMP.
  1321     05  TYPEF PIC  X(0001).
  1322     05  FILLER REDEFINES TYPEF.
  1323         10  TYPEA PIC  X(0001).
  1324     05  TYPEI PIC  X(0001).
  1325*    -------------------------------
  1326     05  DATEL PIC S9(0004) COMP.
  1327     05  DATEF PIC  X(0001).
  1328     05  FILLER REDEFINES DATEF.
  1329         10  DATEA PIC  X(0001).
  1330     05  DATEI PIC  X(0008).
  1331*    -------------------------------
  1332     05  FOLLOWL PIC S9(0004) COMP.
  1333     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL689.cbl
  1334     05  FILLER REDEFINES FOLLOWF.
  1335         10  FOLLOWA PIC  X(0001).
  1336     05  FOLLOWI PIC  X(0008).
  1337*    -------------------------------
  1338     05  RESEND1L PIC S9(0004) COMP.
  1339     05  RESEND1F PIC  X(0001).
  1340     05  FILLER REDEFINES RESEND1F.
  1341         10  RESEND1A PIC  X(0001).
  1342     05  RESEND1I PIC  X(0008).
  1343*    -------------------------------
  1344     05  ENCL PIC S9(0004) COMP.
  1345     05  ENCF PIC  X(0001).
  1346     05  FILLER REDEFINES ENCF.
  1347         10  ENCA PIC  X(0001).
  1348     05  ENCI PIC  X(0003).
  1349*    -------------------------------
  1350     05  COMENTSL PIC S9(0004) COMP.
  1351     05  COMENTSF PIC  X(0001).
  1352     05  FILLER REDEFINES COMENTSF.
  1353         10  COMENTSA PIC  X(0001).
  1354     05  COMENTSI PIC  X(0047).
  1355*    -------------------------------
  1356     05  CERTIDL PIC S9(0004) COMP.
  1357     05  CERTIDF PIC  X(0001).
  1358     05  FILLER REDEFINES CERTIDF.
  1359         10  CERTIDA PIC  X(0001).
  1360     05  CERTIDI PIC  X(0005).
  1361*    -------------------------------
  1362     05  ADDRSL PIC S9(0004) COMP.
  1363     05  ADDRSF PIC  X(0001).
  1364     05  FILLER REDEFINES ADDRSF.
  1365         10  ADDRSA PIC  X(0001).
  1366     05  ADDRSI PIC  X(0001).
  1367*    -------------------------------
  1368     05  PRINTERL PIC S9(0004) COMP.
  1369     05  PRINTERF PIC  X(0001).
  1370     05  FILLER REDEFINES PRINTERF.
  1371         10  PRINTERA PIC  X(0001).
  1372     05  PRINTERI PIC  X(0004).
  1373*    -------------------------------
  1374     05  COPIESL PIC S9(0004) COMP.
  1375     05  COPIESF PIC  X(0001).
  1376     05  FILLER REDEFINES COPIESF.
  1377         10  COPIESA PIC  X(0001).
  1378     05  COPIESI PIC  X(0001).
  1379*    -------------------------------
  1380     05  DATASORL PIC S9(0004) COMP.
  1381     05  DATASORF PIC  X(0001).
  1382     05  FILLER REDEFINES DATASORF.
  1383         10  DATASORA PIC  X(0001).
  1384     05  DATASORI PIC  X(0001).
  1385*    -------------------------------
  1386     05  ADDRLBLL PIC S9(0004) COMP.
  1387     05  ADDRLBLF PIC  X(0001).
  1388     05  FILLER REDEFINES ADDRLBLF.
  1389         10  ADDRLBLA PIC  X(0001).
  1390     05  ADDRLBLI PIC  X(0001).
  1391*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL689.cbl
  1392     05  RPERSONL PIC S9(0004) COMP.
  1393     05  RPERSONF PIC  X(0001).
  1394     05  FILLER REDEFINES RPERSONF.
  1395         10  RPERSONA PIC  X(0001).
  1396     05  RPERSONI PIC  X(0010).
  1397*    -------------------------------
  1398     05  BENTRYL PIC S9(0004) COMP.
  1399     05  BENTRYF PIC  X(0001).
  1400     05  FILLER REDEFINES BENTRYF.
  1401         10  BENTRYA PIC  X(0001).
  1402     05  BENTRYI PIC  X(0006).
  1403*    -------------------------------
  1404     05  SEQL PIC S9(0004) COMP.
  1405     05  SEQF PIC  X(0001).
  1406     05  FILLER REDEFINES SEQF.
  1407         10  SEQA PIC  X(0001).
  1408     05  SEQI PIC  X(0008).
  1409*    -------------------------------
  1410     05  BCSEQL PIC S9(0004) COMP.
  1411     05  BCSEQF PIC  X(0001).
  1412     05  FILLER REDEFINES BCSEQF.
  1413         10  BCSEQA PIC  X(0001).
  1414     05  BCSEQI PIC  X(0004).
  1415*    -------------------------------
  1416     05  L1L PIC S9(0004) COMP.
  1417     05  L1F PIC  X(0001).
  1418     05  FILLER REDEFINES L1F.
  1419         10  L1A PIC  X(0001).
  1420     05  L1I PIC  X(0003).
  1421*    -------------------------------
  1422     05  TEXT1L PIC S9(0004) COMP.
  1423     05  TEXT1F PIC  X(0001).
  1424     05  FILLER REDEFINES TEXT1F.
  1425         10  TEXT1A PIC  X(0001).
  1426     05  TEXT1I PIC  X(0070).
  1427*    -------------------------------
  1428     05  L2L PIC S9(0004) COMP.
  1429     05  L2F PIC  X(0001).
  1430     05  FILLER REDEFINES L2F.
  1431         10  L2A PIC  X(0001).
  1432     05  L2I PIC  X(0003).
  1433*    -------------------------------
  1434     05  TEXT2L PIC S9(0004) COMP.
  1435     05  TEXT2F PIC  X(0001).
  1436     05  FILLER REDEFINES TEXT2F.
  1437         10  TEXT2A PIC  X(0001).
  1438     05  TEXT2I PIC  X(0070).
  1439*    -------------------------------
  1440     05  L3L PIC S9(0004) COMP.
  1441     05  L3F PIC  X(0001).
  1442     05  FILLER REDEFINES L3F.
  1443         10  L3A PIC  X(0001).
  1444     05  L3I PIC  X(0003).
  1445*    -------------------------------
  1446     05  TEXT3L PIC S9(0004) COMP.
  1447     05  TEXT3F PIC  X(0001).
  1448     05  FILLER REDEFINES TEXT3F.
  1449         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL689.cbl
  1450     05  TEXT3I PIC  X(0070).
  1451*    -------------------------------
  1452     05  L4L PIC S9(0004) COMP.
  1453     05  L4F PIC  X(0001).
  1454     05  FILLER REDEFINES L4F.
  1455         10  L4A PIC  X(0001).
  1456     05  L4I PIC  X(0003).
  1457*    -------------------------------
  1458     05  TEXT4L PIC S9(0004) COMP.
  1459     05  TEXT4F PIC  X(0001).
  1460     05  FILLER REDEFINES TEXT4F.
  1461         10  TEXT4A PIC  X(0001).
  1462     05  TEXT4I PIC  X(0070).
  1463*    -------------------------------
  1464     05  L5L PIC S9(0004) COMP.
  1465     05  L5F PIC  X(0001).
  1466     05  FILLER REDEFINES L5F.
  1467         10  L5A PIC  X(0001).
  1468     05  L5I PIC  X(0003).
  1469*    -------------------------------
  1470     05  TEXT5L PIC S9(0004) COMP.
  1471     05  TEXT5F PIC  X(0001).
  1472     05  FILLER REDEFINES TEXT5F.
  1473         10  TEXT5A PIC  X(0001).
  1474     05  TEXT5I PIC  X(0070).
  1475*    -------------------------------
  1476     05  L6L PIC S9(0004) COMP.
  1477     05  L6F PIC  X(0001).
  1478     05  FILLER REDEFINES L6F.
  1479         10  L6A PIC  X(0001).
  1480     05  L6I PIC  X(0003).
  1481*    -------------------------------
  1482     05  TEXT6L PIC S9(0004) COMP.
  1483     05  TEXT6F PIC  X(0001).
  1484     05  FILLER REDEFINES TEXT6F.
  1485         10  TEXT6A PIC  X(0001).
  1486     05  TEXT6I PIC  X(0070).
  1487*    -------------------------------
  1488     05  L7L PIC S9(0004) COMP.
  1489     05  L7F PIC  X(0001).
  1490     05  FILLER REDEFINES L7F.
  1491         10  L7A PIC  X(0001).
  1492     05  L7I PIC  X(0003).
  1493*    -------------------------------
  1494     05  TEXT7L PIC S9(0004) COMP.
  1495     05  TEXT7F PIC  X(0001).
  1496     05  FILLER REDEFINES TEXT7F.
  1497         10  TEXT7A PIC  X(0001).
  1498     05  TEXT7I PIC  X(0070).
  1499*    -------------------------------
  1500     05  L8L PIC S9(0004) COMP.
  1501     05  L8F PIC  X(0001).
  1502     05  FILLER REDEFINES L8F.
  1503         10  L8A PIC  X(0001).
  1504     05  L8I PIC  X(0003).
  1505*    -------------------------------
  1506     05  TEXT8L PIC S9(0004) COMP.
  1507     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL689.cbl
  1508     05  FILLER REDEFINES TEXT8F.
  1509         10  TEXT8A PIC  X(0001).
  1510     05  TEXT8I PIC  X(0070).
  1511*    -------------------------------
  1512     05  L9L PIC S9(0004) COMP.
  1513     05  L9F PIC  X(0001).
  1514     05  FILLER REDEFINES L9F.
  1515         10  L9A PIC  X(0001).
  1516     05  L9I PIC  X(0003).
  1517*    -------------------------------
  1518     05  TEXT9L PIC S9(0004) COMP.
  1519     05  TEXT9F PIC  X(0001).
  1520     05  FILLER REDEFINES TEXT9F.
  1521         10  TEXT9A PIC  X(0001).
  1522     05  TEXT9I PIC  X(0070).
  1523*    -------------------------------
  1524     05  L10L PIC S9(0004) COMP.
  1525     05  L10F PIC  X(0001).
  1526     05  FILLER REDEFINES L10F.
  1527         10  L10A PIC  X(0001).
  1528     05  L10I PIC  X(0003).
  1529*    -------------------------------
  1530     05  TEXT10L PIC S9(0004) COMP.
  1531     05  TEXT10F PIC  X(0001).
  1532     05  FILLER REDEFINES TEXT10F.
  1533         10  TEXT10A PIC  X(0001).
  1534     05  TEXT10I PIC  X(0070).
  1535*    -------------------------------
  1536     05  L11L PIC S9(0004) COMP.
  1537     05  L11F PIC  X(0001).
  1538     05  FILLER REDEFINES L11F.
  1539         10  L11A PIC  X(0001).
  1540     05  L11I PIC  X(0003).
  1541*    -------------------------------
  1542     05  TEXT11L PIC S9(0004) COMP.
  1543     05  TEXT11F PIC  X(0001).
  1544     05  FILLER REDEFINES TEXT11F.
  1545         10  TEXT11A PIC  X(0001).
  1546     05  TEXT11I PIC  X(0070).
  1547*    -------------------------------
  1548     05  L12L PIC S9(0004) COMP.
  1549     05  L12F PIC  X(0001).
  1550     05  FILLER REDEFINES L12F.
  1551         10  L12A PIC  X(0001).
  1552     05  L12I PIC  X(0003).
  1553*    -------------------------------
  1554     05  TEXT12L PIC S9(0004) COMP.
  1555     05  TEXT12F PIC  X(0001).
  1556     05  FILLER REDEFINES TEXT12F.
  1557         10  TEXT12A PIC  X(0001).
  1558     05  TEXT12I PIC  X(0070).
  1559*    -------------------------------
  1560     05  ERRMSGL PIC S9(0004) COMP.
  1561     05  ERRMSGF PIC  X(0001).
  1562     05  FILLER REDEFINES ERRMSGF.
  1563         10  ERRMSGA PIC  X(0001).
  1564     05  ERRMSGI PIC  X(0079).
  1565*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL689.cbl
  1566     05  ENTERPFL PIC S9(0004) COMP.
  1567     05  ENTERPFF PIC  X(0001).
  1568     05  FILLER REDEFINES ENTERPFF.
  1569         10  ENTERPFA PIC  X(0001).
  1570     05  ENTERPFI PIC  99.
  1571*    -------------------------------
  1572     05  PF8HDL PIC S9(0004) COMP.
  1573     05  PF8HDF PIC  X(0001).
  1574     05  FILLER REDEFINES PF8HDF.
  1575         10  PF8HDA PIC  X(0001).
  1576     05  PF8HDI PIC  X(0022).
  1577 01  EL689AO REDEFINES EL689AI.
  1578     05  FILLER            PIC  X(0012).
  1579*    -------------------------------
  1580     05  FILLER            PIC  X(0003).
  1581     05  RUNDTEO PIC  X(0008).
  1582*    -------------------------------
  1583     05  FILLER            PIC  X(0003).
  1584     05  RUNTIMEO PIC  99.99.
  1585*    -------------------------------
  1586     05  FILLER            PIC  X(0003).
  1587     05  HOSTO PIC  X(0010).
  1588*    -------------------------------
  1589     05  FILLER            PIC  X(0003).
  1590     05  SYSO PIC  X(0008).
  1591*    -------------------------------
  1592     05  FILLER            PIC  X(0003).
  1593     05  COMPANYO PIC  X(0003).
  1594*    -------------------------------
  1595     05  FILLER            PIC  X(0003).
  1596     05  USERIDO PIC  X(0004).
  1597*    -------------------------------
  1598     05  FILLER            PIC  X(0003).
  1599     05  MAINTO PIC  X(0001).
  1600*    -------------------------------
  1601     05  FILLER            PIC  X(0003).
  1602     05  FORMO PIC  X(0004).
  1603*    -------------------------------
  1604     05  FILLER            PIC  X(0003).
  1605     05  ARCHNUMO PIC  99999999.
  1606*    -------------------------------
  1607     05  FILLER            PIC  X(0003).
  1608     05  PRTNOWO PIC  X(0001).
  1609*    -------------------------------
  1610     05  FILLER            PIC  X(0003).
  1611     05  CARRIERO PIC  X(0001).
  1612*    -------------------------------
  1613     05  FILLER            PIC  X(0003).
  1614     05  GROUPO PIC  X(0006).
  1615*    -------------------------------
  1616     05  FILLER            PIC  X(0003).
  1617     05  STATEO PIC  X(0002).
  1618*    -------------------------------
  1619     05  FILLER            PIC  X(0003).
  1620     05  ACCTO PIC  X(0010).
  1621*    -------------------------------
  1622     05  FILLER            PIC  X(0003).
  1623     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL689.cbl
  1624*    -------------------------------
  1625     05  FILLER            PIC  X(0003).
  1626     05  SFXO PIC  X(0001).
  1627*    -------------------------------
  1628     05  FILLER            PIC  X(0003).
  1629     05  TYPEO PIC  X(0001).
  1630*    -------------------------------
  1631     05  FILLER            PIC  X(0003).
  1632     05  DATEO PIC  X(0008).
  1633*    -------------------------------
  1634     05  FILLER            PIC  X(0003).
  1635     05  FOLLOWO PIC  X(0008).
  1636*    -------------------------------
  1637     05  FILLER            PIC  X(0003).
  1638     05  RESEND1O PIC  X(0008).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  ENCO PIC  X(0003).
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
  1644     05  COMENTSO PIC  X(0047).
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  CERTIDO PIC  X(0005).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  ADDRSO PIC  X(0001).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  PRINTERO PIC  X(0004).
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  COPIESO PIC  X(0001).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  DATASORO PIC  X(0001).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  ADDRLBLO PIC  X(0001).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  RPERSONO PIC  X(0010).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  BENTRYO PIC  X(0006).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  SEQO PIC  X(0008).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  BCSEQO PIC  X(0004).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  L1O PIC  X(0003).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  TEXT1O PIC  X(0070).
  1681*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL689.cbl
  1682     05  FILLER            PIC  X(0003).
  1683     05  L2O PIC  X(0003).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  TEXT2O PIC  X(0070).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  L3O PIC  X(0003).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  TEXT3O PIC  X(0070).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  L4O PIC  X(0003).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  TEXT4O PIC  X(0070).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  L5O PIC  X(0003).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  TEXT5O PIC  X(0070).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  L6O PIC  X(0003).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  TEXT6O PIC  X(0070).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  L7O PIC  X(0003).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  TEXT7O PIC  X(0070).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  L8O PIC  X(0003).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  TEXT8O PIC  X(0070).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  L9O PIC  X(0003).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  TEXT9O PIC  X(0070).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  L10O PIC  X(0003).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  TEXT10O PIC  X(0070).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  L11O PIC  X(0003).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL689.cbl
  1740     05  TEXT11O PIC  X(0070).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  L12O PIC  X(0003).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  TEXT12O PIC  X(0070).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  ERRMSGO PIC  X(0079).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  ENTERPFO PIC  X(0002).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  PF8HDO PIC  X(0022).
  1756*    -------------------------------
  1757 01  W-MAP-REDEF REDEFINES EL689AI.
  1758*    12  FILLER                  PIC X(218).
  1759     12  FILLER                  PIC X(311).
  1760     12  EL689RI.
  1761         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1762             20  W-SC-LINEL      PIC S9(04) COMP.
  1763             20  W-SC-LINEA      PIC  X(01).
  1764             20  W-SC-LINE       PIC  X(03).
  1765             20  W-SC-TEXTL      PIC S9(04) COMP.
  1766             20  W-SC-TEXTA      PIC  X(01).
  1767             20  W-SC-TEXT       PIC  X(70).
  1768*    12  FILLER                  PIC  X(87).
  1769     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL689.cbl
  1771 01  W-CONSTANT-AREA.
  1772     12  FILLER                  PIC  X(18)
  1773                                 VALUE 'PROGRAM CONSTANTS:'.
  1774     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1775     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1776     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1777     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1778     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1779     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1780     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1781     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1782     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1783
  1784     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1785     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1786     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1787     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1788     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1789     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1790     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1791     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1792     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1793     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1794     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1795     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1796     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1797     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1798     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1799     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1800     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1801     12  W-LOWER-CASE            PIC  X(26)
  1802         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1803     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1804     12  W-MAP.
  1805         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1806         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1807         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1808     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1809     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1810     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1811     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1812     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1813     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1814     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1815
  1816     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1817     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1818     12  W-TOP-FORM              PIC  X(70)
  1819                              VALUE '*****TOP OF FORM *****'.
  1820     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1821     12  W-UPPER-CASE            PIC  X(26)
  1822         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1823     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  1824     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1825     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL689.cbl
  1827 01  W-VARIABLE-PROCESS-CNTLS.
  1828     12  FILLER                  PIC  X(26)
  1829                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1830     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1831     12  W-VAR-HOLD.
  1832         16  W-V1                PIC  X(01).
  1833         16  W-V2                PIC  X(01).
  1834         16  W-V3                PIC  X(01).
  1835     12  FILLER REDEFINES W-VAR-HOLD.
  1836         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1837     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1838         88  W-SQUEEZE-FIELD          VALUE '#'.
  1839
  1840 01  W-SUPPORTED-VARIABLES.
  1841
  1842*****************COMPANY VARIABLES - ELCNTL ********************
  1843*****COMPANY NAME
  1844     12  FILLER                  PIC  X(03) VALUE '001'.
  1845     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1846     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1847     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1848     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1849
  1850*****FULL COMPANY ADDRESS
  1851     12  FILLER                  PIC  X(03) VALUE '002'.
  1852     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1853     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1854     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1855     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1856
  1857     12  FILLER                  PIC  X(03) VALUE '003'.
  1858     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1859     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1860     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1861     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1862
  1863     12  FILLER                  PIC  X(03) VALUE '004'.
  1864     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1865     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1866     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1867     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1868
  1869     12  FILLER                  PIC  X(03) VALUE '005'.
  1870     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1871     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1872     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1873     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1874
  1875     12  FILLER                  PIC  X(03) VALUE '006'.
  1876     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1877     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1878     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1879     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1880
  1881*****REMAINING 4 ARE NOT CURRENTLY USED
  1882     12  FILLER                  PIC  X(03) VALUE '007'.
  1883     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1884     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL689.cbl
  1885     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1886     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1887
  1888     12  FILLER                  PIC  X(03) VALUE '008'.
  1889     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1890     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1891     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1892     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1893
  1894     12  FILLER                  PIC  X(03) VALUE '009'.
  1895     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1896     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1897     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1898     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1899
  1900     12  FILLER                  PIC  X(03) VALUE '010'.
  1901     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1902     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1903     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1904     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1905
  1906************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1907*****LIFE BENEFIT DESCRIPTION
  1908     12  FILLER                  PIC  X(03) VALUE '011'.
  1909     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1910     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1911     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1912     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1913
  1914*****REMAINING 3 ARE NOT CURRENTLY USED
  1915     12  FILLER                  PIC  X(03) VALUE '012'.
  1916     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1917     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1918     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1919     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1920
  1921     12  FILLER                  PIC  X(03) VALUE '013'.
  1922     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1923     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1924     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1925     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1926
  1927     12  FILLER                  PIC  X(03) VALUE '014'.
  1928     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1929     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1930     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1931     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1932
  1933************* A&H BENEFIT VARIABLES - ELCNTL *******************
  1934*****AH BENEFIT DESCRIPTION
  1935     12  FILLER                  PIC  X(03) VALUE '015'.
  1936     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1937     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1938     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1939     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1940
  1941*****ELIMINATION PERIOD
  1942     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL689.cbl
  1943     12  FILLER                  PIC S9(04) COMP VALUE +2.
  1944     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1945     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1946     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1947
  1948*****REMAINING 3 ARE NOT CURRENTLY USED
  1949     12  FILLER                  PIC  X(03) VALUE '017'.
  1950     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1951     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1952     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1953     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1954
  1955     12  FILLER                  PIC  X(03) VALUE '018'.
  1956     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1957     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1958     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1959     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1960
  1961     12  FILLER                  PIC  X(03) VALUE '019'.
  1962     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1963     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1964     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1965     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1966
  1967*****************CARRIER VARIABLES - ELCNTL ********************
  1968*****CARRIER NAME
  1969     12  FILLER                  PIC  X(03) VALUE '020'.
  1970     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1971     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1972     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1973     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1974
  1975*****FULL CARRIER ADDRESS
  1976     12  FILLER                  PIC  X(03) VALUE '021'.
  1977     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1978     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1979     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1980     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1981
  1982     12  FILLER                  PIC  X(03) VALUE '022'.
  1983     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1984     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1985     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1986     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1987
  1988     12  FILLER                  PIC  X(03) VALUE '023'.
  1989     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1990     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1991     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1992     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1993
  1994     12  FILLER                  PIC  X(03) VALUE '024'.
  1995     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1996     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1997     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1998     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1999
  2000     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL689.cbl
  2001     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2002     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2003     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2004     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2005
  2006*****CARRIER PHONE NUMBER
  2007     12  FILLER                  PIC  X(03) VALUE '026'.
  2008     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2009     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2010     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2011     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2012
  2013*****REMAINING 4 ARE NOT CURRENTLY USED
  2014     12  FILLER                  PIC  X(03) VALUE '027'.
  2015     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2016     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2017     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2018     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2019
  2020     12  FILLER                  PIC  X(03) VALUE '028'.
  2021     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2022     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2023     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2024     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2025
  2026     12  FILLER                  PIC  X(03) VALUE '029'.
  2027     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2028     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2029     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2030     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2031
  2032     12  FILLER                  PIC  X(03) VALUE '030'.
  2033     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2034     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2035     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2036     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2037
  2038***************** MAIL VARIABLES - ELMAIL **********************
  2039*****FULL MAIL ADDRESS
  2040     12  FILLER                  PIC  X(03) VALUE '031'.
  2041     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2042     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2043     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2044     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2045
  2046     12  FILLER                  PIC  X(03) VALUE '032'.
  2047     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2048     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2049     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2050     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2051
  2052     12  FILLER                  PIC  X(03) VALUE '033'.
  2053     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2054     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2055     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2056     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2057
  2058     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL689.cbl
  2059     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2060     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2061     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2062     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2063
  2064     12  FILLER                  PIC  X(03) VALUE '035'.
  2065     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2066     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2067     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2068     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2069
  2070     12  FILLER                  PIC  X(03) VALUE '036'.
  2071     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2073     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2074     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2075**** CRED BENE NAME FROM ERMAIL
  2076     12  FILLER                  PIC  X(03) VALUE '037'.
  2077     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2078     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2079     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2080     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2081*****REMAINING 2 ARE NOT CURRENTLY USED
  2082     12  FILLER                  PIC  X(03) VALUE '038'.
  2083     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2085     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2086     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2087
  2088     12  FILLER                  PIC  X(03) VALUE '039'.
  2089     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2090     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2091     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2092     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2093
  2094*************** ACCOUNT VARIABLES - ERACCT *********************
  2095*****ACCOUNT NAME
  2096     12  FILLER                  PIC  X(03) VALUE '040'.
  2097     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2098     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2099     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2100     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2101
  2102*****FULL ACCOUNT ADDRESS
  2103     12  FILLER                  PIC  X(03) VALUE '041'.
  2104     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2105     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2106     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2107     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2108
  2109     12  FILLER                  PIC  X(03) VALUE '042'.
  2110     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2111     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2112     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2113     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2114
  2115     12  FILLER                  PIC  X(03) VALUE '043'.
  2116     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL689.cbl
  2117     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2118     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2119     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2120
  2121     12  FILLER                  PIC  X(03) VALUE '044'.
  2122     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2123     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2124     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2125     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2126
  2127     12  FILLER                  PIC  X(03) VALUE '045'.
  2128     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2129     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2130     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2131     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2132
  2133*****ACCOUNT PHONE NUMBER
  2134     12  FILLER                  PIC  X(03) VALUE '046'.
  2135     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2136     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2137     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2138     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2139
  2140*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2141     12  FILLER                  PIC  X(03) VALUE '047'.
  2142     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2143     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2144     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2146
  2147****ACCOUNT CSR CODE
  2148     12  FILLER                  PIC  X(03) VALUE '048'.
  2149     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2150     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2151     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2152     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2153****ACCOUNT ACCOUNT NUMBER
  2154     12  FILLER                  PIC  X(03) VALUE '049'.
  2155     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2156     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2157     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2158     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2159
  2160**** CRED BENE ADDRESS LINE 1 ERMAIL
  2161     12  FILLER                  PIC  X(03) VALUE '050'.
  2162     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2163     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2164     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2165     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2166
  2167**** CRED BENE ADDRESS LINE 2 ERMAIL
  2168     12  FILLER                  PIC  X(03) VALUE '051'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2170     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2171     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2172     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2173
  2174**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL689.cbl
  2175     12  FILLER                  PIC  X(03) VALUE '052'.
  2176     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2177     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2178     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2179     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2180
  2181**** CRED BENE ZIP  1 ERMAIL
  2182     12  FILLER                  PIC  X(03) VALUE '053'.
  2183     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2184     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2185     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2186     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2187
  2188*****REMAINING 6 ARE NOT CURRENTLY USED
  2189     12  FILLER                  PIC  X(03) VALUE '054'.
  2190     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2191     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2192     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2193     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2194
  2195     12  FILLER                  PIC  X(03) VALUE '055'.
  2196     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2197     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2198     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2199     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2200
  2201     12  FILLER                  PIC  X(03) VALUE '056'.
  2202     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2203     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2204     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2205     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2206
  2207     12  FILLER                  PIC  X(03) VALUE '057'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2209     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2210     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2211     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2212
  2213     12  FILLER                  PIC  X(03) VALUE '058'.
  2214     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2215     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2216     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2217     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2218
  2219     12  FILLER                  PIC  X(03) VALUE '059'.
  2220     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2221     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2222     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2223     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2224
  2225*************** NON FILE VARIABLES *****************************
  2226*****CURRENT DATE
  2227     12  FILLER                  PIC  X(03) VALUE '060'.
  2228     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2229     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2230     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2231     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2232
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL689.cbl
  2233*****FULL CURRENT DATE
  2234     12  FILLER                  PIC  X(03) VALUE '061'.
  2235     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2236     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2237     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2238     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2239
  2240*****FORM
  2241     12  FILLER                  PIC  X(03) VALUE '062'.
  2242     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2243     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2244     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2245     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2246
  2247*****VARIABLE 1
  2248     12  FILLER                  PIC  X(03) VALUE '063'.
  2249     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2250     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2251     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2252     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2253
  2254*****VARIABLE 2
  2255     12  FILLER                  PIC  X(03) VALUE '064'.
  2256     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2257     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2258     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2259     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2260
  2261*****VARIABLE 3
  2262     12  FILLER                  PIC  X(03) VALUE '065'.
  2263     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2264     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2265     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2266     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2267
  2268*****VARIABLE 4
  2269     12  FILLER                  PIC  X(03) VALUE '066'.
  2270     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2271     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2272     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2273     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2274
  2275*****REMAINING 3 ARE NOT CURRENTLY USED
  2276     12  FILLER                  PIC  X(03) VALUE '067'.
  2277     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2278     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2279     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2280     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2281
  2282     12  FILLER                  PIC  X(03) VALUE '068'.
  2283     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2284     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2285     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2286     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2287
  2288     12  FILLER                  PIC  X(03) VALUE '069'.
  2289     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2290     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL689.cbl
  2291     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2292     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2293
  2294************** CERTIFICATE VARIABLES - ELCERT *****************
  2295*****CARRIER CODE IN CERT
  2296     12  FILLER                  PIC  X(03) VALUE '070'.
  2297     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2298     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2299     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2300     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2301
  2302*****GROUPING CODE IN CERT
  2303     12  FILLER                  PIC  X(03) VALUE '071'.
  2304     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2305     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2306     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2307     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2308
  2309*****ACCOUNT NUMBER IN CERT
  2310     12  FILLER                  PIC  X(03) VALUE '072'.
  2311     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2312     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2313     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2314     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2315
  2316*****CERTIFICATE NUMBER
  2317     12  FILLER                  PIC  X(03) VALUE '073'.
  2318     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2319     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2320     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2321     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2322
  2323*****CERT EFFECTIVE DATE
  2324     12  FILLER                  PIC  X(03) VALUE '074'.
  2325     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2326     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2327     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2328     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2329
  2330*****CERT EXPIRATION DATE (LIFE)
  2331     12  FILLER                  PIC  X(03) VALUE '075'.
  2332     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2333     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2334     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2335     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2336
  2337*****CERT EXPIRATION DATE (AH)
  2338     12  FILLER                  PIC  X(03) VALUE '076'.
  2339     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2340     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2341     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2342     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2343
  2344*****LIFE TERM
  2345     12  FILLER                  PIC  X(03) VALUE '077'.
  2346     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2347     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2348     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL689.cbl
  2349     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2350
  2351*****AH  TERM
  2352     12  FILLER                  PIC  X(03) VALUE '078'.
  2353     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2354     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2355     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2356     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2357
  2358*****LIFE COVERAGE AMOUNT
  2359     12  FILLER                  PIC  X(03) VALUE '079'.
  2360     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2361     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2362     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2363     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2364
  2365*****AH MONTHLY BENEFIT
  2366     12  FILLER                  PIC  X(03) VALUE '080'.
  2367     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2368     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2369     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2370     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2371
  2372*****LIFE CANCEL DATE
  2373     12  FILLER                  PIC  X(03) VALUE '081'.
  2374     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2375     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2376     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2377     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2378
  2379*****AH CANCEL DATE
  2380     12  FILLER                  PIC  X(03) VALUE '082'.
  2381     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2382     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2383     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2384     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2385
  2386*****LIFE COVERAGE FORM NUMBER
  2387     12  FILLER                  PIC  X(03) VALUE '083'.
  2388     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2389     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2390     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2391     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2392
  2393*****UNUSED
  2394     12  FILLER                  PIC  X(03) VALUE '084'.
  2395     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2396     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2397     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2398     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2399
  2400*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2401     12  FILLER                  PIC  X(03) VALUE '085'.
  2402     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2403     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2404     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2405     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2406
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL689.cbl
  2407*****LOAN NUMBER
  2408     12  FILLER                  PIC  X(03) VALUE '086'.
  2409     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2410     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2411     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2412     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2413
  2414*****LOAN BALANCE
  2415     12  FILLER                  PIC  X(03) VALUE '087'.
  2416     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2417     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2418     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2419     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2420
  2421*****MEMBER NUMBER
  2422     12  FILLER                  PIC  X(03) VALUE '088'.
  2423     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2424     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2425     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2426     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2427
  2428*****INSURED SOC SEC NUMBER
  2429     12  FILLER                  PIC  X(03) VALUE '089'.
  2430     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2431     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2432     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2433     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2434
  2435*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2436     12  FILLER                  PIC  X(03) VALUE '090'.
  2437     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2438     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2439     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2441
  2442*****INSURED FIRST NAME (CERTIFICATE)
  2443     12  FILLER                  PIC  X(03) VALUE '091'.
  2444     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2445     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2446     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2447     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2448
  2449*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2450     12  FILLER                  PIC  X(03) VALUE '092'.
  2451     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2452     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2453     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2455
  2456*****ORIG TERM * MON BEN
  2457     12  FILLER                  PIC  X(03) VALUE '093'.
  2458     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2459     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2460     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2462
  2463*****INSURED'S NAME (LAST, FIRST, INIT)
  2464     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL689.cbl
  2465     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2466     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2467     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2469
  2470*****INSURED'S NAME (FIRST, INIT, LAST)
  2471     12  FILLER                  PIC  X(03) VALUE  '095'.
  2472     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2473     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2474     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2476
  2477*****TITLE (MR/MS)
  2478     12  FILLER                  PIC  X(03) VALUE '096'.
  2479     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2480     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2481     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2483
  2484*****LIFE PREMIUM (CERTIFICATE)
  2485     12  FILLER                  PIC  X(03) VALUE '097'.
  2486     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2487     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2488     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2489     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2490
  2491*****A/H PREMIUM (CERTIFICATE)
  2492     12  FILLER                  PIC  X(03) VALUE '098'.
  2493     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2494     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2495     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2497
  2498*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2499     12  FILLER                  PIC  X(03) VALUE '099'.
  2500     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2501     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2502     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2504
  2505*****JOINT'S FIRST NAME (CERTIFICATE)
  2506     12  FILLER                  PIC  X(03) VALUE '100'.
  2507     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2508     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2509     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2510     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2511
  2512*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2513     12  FILLER                  PIC  X(03) VALUE '101'.
  2514     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2515     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2516     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2517     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2518
  2519*****JOINT'S NAME (LAST, FIRST, INIT)
  2520     12  FILLER                  PIC  X(03) VALUE '102'.
  2521     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2522     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL689.cbl
  2523     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2524     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2525
  2526*****JOINT'S NAME (FIRST, INIT, LAST)
  2527     12  FILLER                  PIC  X(03) VALUE '103'.
  2528     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2529     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2530     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2531     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2532
  2533*****INSURED'S FIRST AND LAST NAME
  2534     12  FILLER                  PIC  X(03) VALUE '104'.
  2535     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2536     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2537     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2538     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2539
  2540*****JOINT'S FIRST AND LAST NAME
  2541     12  FILLER                  PIC  X(03) VALUE '105'.
  2542     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2543     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2544     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2545     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2546
  2547*****ENTERED LIFE REFUND (CERT)
  2548     12  FILLER                  PIC  X(03) VALUE '106'.
  2549     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2550     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2551     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2552     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2553
  2554*****ENTERED A/H REFUND (CERT)
  2555     12  FILLER                  PIC  X(03) VALUE '107'.
  2556     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2557     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2558     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2559     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2560
  2561*****INSURED'S LAST NAME
  2562     12  FILLER                  PIC  X(03) VALUE '108'.
  2563     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2564     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2565     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2566     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2567
  2568*****BENEFICIARY
  2569     12  FILLER                  PIC  X(03) VALUE  '109'.
  2570     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2571     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2572     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2573     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2574
  2575************** PENDING VARIABLES - ERPNDB *********************
  2576*****INSURED DATE OF BIRTH
  2577     12  FILLER                  PIC  X(03) VALUE '110'.
  2578     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2579     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2580     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL689.cbl
  2581     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2582
  2583*****ENTERED LIFE PREMIUM (PENDING)
  2584     12  FILLER                  PIC  X(03) VALUE '111'.
  2585     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2586     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2587     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2588     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2589
  2590*****ENTERED A/H PREMIUM (PENDING)
  2591     12  FILLER                  PIC  X(03) VALUE '112'.
  2592     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2593     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2594     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2595     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2596
  2597*****CALCULATED LIFE PREMIUM (PENDING)
  2598     12  FILLER                  PIC  X(03) VALUE '113'.
  2599     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2600     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2601     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2602     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2603
  2604*****CALCULATED A/H PREMIUM (PENDING)
  2605     12  FILLER                  PIC  X(03) VALUE '114'.
  2606     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2607     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2608     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2609     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2610
  2611*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2612     12  FILLER                  PIC  X(03) VALUE '115'.
  2613     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2614     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2615     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2616     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2617
  2618*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2619     12  FILLER                  PIC  X(03) VALUE '116'.
  2620     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2621     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2622     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2623     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2624
  2625*****PRIOR CANCEL DATE
  2626     12  FILLER                  PIC  X(03) VALUE '117'.
  2627     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2628     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2629     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2630     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2631
  2632*****ENTERED LIFE REFUND (PENDING)
  2633     12  FILLER                  PIC  X(03) VALUE '118'.
  2634     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2635     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2636     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2637     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2638
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL689.cbl
  2639*****ENTERED A/H REFUND (PENDING)
  2640     12  FILLER                  PIC  X(03) VALUE '119'.
  2641     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2642     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2643     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2644     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2645
  2646*****CALCULATED LIFE REFUND (PENDING)
  2647     12  FILLER                  PIC  X(03) VALUE '120'.
  2648     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2649     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2650     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2651     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2652
  2653*****CALCULATED A/H REFUND (PENDING)
  2654     12  FILLER                  PIC  X(03) VALUE '121'.
  2655     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2656     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2657     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2658     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2659
  2660*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2661     12  FILLER                  PIC  X(03) VALUE '122'.
  2662     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2663     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2664     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2665     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2666
  2667*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2668     12  FILLER                  PIC  X(03) VALUE '123'.
  2669     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2670     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2671     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2672     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2673
  2674*****INSUREDS AGE
  2675     12  FILLER                  PIC  X(03) VALUE '124'.
  2676     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2677     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2678     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2679     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2680
  2681*****LIFE BENEFIT (PENDING)
  2682     12  FILLER                  PIC  X(03) VALUE '125'.
  2683     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2684     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2685     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2686     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2687
  2688*****A/H BENEFIT (PENDING)
  2689     12  FILLER                  PIC  X(03) VALUE '126'.
  2690     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2691     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2692     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2693     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2694
  2695*****LIFE RATE
  2696     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL689.cbl
  2697     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2698     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2699     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2700     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2701
  2702*****A/H RATE
  2703     12  FILLER                  PIC  X(03) VALUE '128'.
  2704     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2705     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2706     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2707     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2708
  2709*****TERM (PENDING)
  2710     12  FILLER                  PIC  X(03) VALUE '129'.
  2711     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2712     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2713     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2714     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2715
  2716*****BATCH NUMBER
  2717     12  FILLER                  PIC  X(03) VALUE '130'.
  2718     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2719     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2720     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2721     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2722
  2723*****TOTAL OF LIFE AND A&H REFUND
  2724     12  FILLER                  PIC  X(03) VALUE '131'.
  2725     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2726     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2727     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2728     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2729
  2730*****NH INTEREST ON REFUNDS
  2731     12  FILLER                  PIC  X(03) VALUE '132'.
  2732     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2733     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2734     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2735     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2736*****GREATER OF THE LIFE AND AH CANCEL DATE
  2737     12  FILLER                  PIC  X(03) VALUE '133'.
  2738     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2739     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2740     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2741     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2742
  2743*****THE NEXT 6 NOT CURRENTLY USED
  2744     12  FILLER                  PIC  X(03) VALUE '134'.
  2745     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2746     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2747     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2748     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2749
  2750     12  FILLER                  PIC  X(03) VALUE '135'.
  2751     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2752     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2753     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2754     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL689.cbl
  2755
  2756     12  FILLER                  PIC  X(03) VALUE '136'.
  2757     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2758     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2759     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2760     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2761
  2762     12  FILLER                  PIC  X(03) VALUE '137'.
  2763     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2764     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2765     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2766     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2767
  2768     12  FILLER                  PIC  X(03) VALUE '138'.
  2769     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2770     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2771     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2772     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2773
  2774     12  FILLER                  PIC  X(03) VALUE '139'.
  2775     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2776     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2777     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2778     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2779
  2780************** COMPENSATION VARIABLES - ERCOMP ****************
  2781*****COMPENSATION ACCT NAME
  2782     12  FILLER                  PIC  X(03) VALUE '140'.
  2783     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2784     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2785     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2786     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2787
  2788*****FULL COMPENSATION ADDRESS TYPE 'A'
  2789     12  FILLER                  PIC  X(03) VALUE '141'.
  2790     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2791     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2792     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2793     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2794
  2795     12  FILLER                  PIC  X(03) VALUE '142'.
  2796     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2797     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2798     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2799     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2800
  2801     12  FILLER                  PIC  X(03) VALUE '143'.
  2802     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2803     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2804     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2805     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2806
  2807     12  FILLER                  PIC  X(03) VALUE '144'.
  2808     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2809     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2810     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2811     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2812
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL689.cbl
  2813     12  FILLER                  PIC  X(03) VALUE '145'.
  2814     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2815     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2816     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2817     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2818
  2819     12  FILLER                  PIC  X(03) VALUE '146'.
  2820     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2821     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2822     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2823     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2824
  2825*****COMPENSATION PHONE NUMBER
  2826     12  FILLER                  PIC  X(03) VALUE '147'.
  2827     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2828     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2829     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2830     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2831
  2832*****COMPENSATION CSR NAME
  2833     12  FILLER                  PIC  X(03) VALUE '148'.
  2834     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2835     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2836     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2837     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2838
  2839*****COMPENSATION LAST STATEMENT DATE
  2840     12  FILLER                  PIC  X(03) VALUE '149'.
  2841     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2842     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2843     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2844     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2845
  2846*****COMPENSATION ENDING BALANCE
  2847     12  FILLER                  PIC  X(03) VALUE '150'.
  2848     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2849     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2850     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2851     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2852
  2853******************  PROCESSOR DATA - ELCNTL (2) ****************
  2854*****EXECUTING PROCESSOR NAME
  2855     12  FILLER                  PIC  X(03) VALUE '151'.
  2856     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2857     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2858     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2859     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2860
  2861*****PROCESSOR TITLE
  2862     12  FILLER                  PIC  X(03) VALUE '152'.
  2863     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2864     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2865     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2866     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2867
  2868*****PROCESSOR
  2869     12  FILLER                  PIC  X(03) VALUE '153'.
  2870     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL689.cbl
  2871     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2872     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2873     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2874
  2875*****CSR TITLE
  2876     12  FILLER                  PIC  X(03) VALUE '154'.
  2877     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2878     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2879     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2880     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2881*****REMAINING 2 ARE NOT CURRENTLY USED
  2882     12  FILLER                  PIC  X(03) VALUE '155'.
  2883     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2884     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2885     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2886     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2887
  2888     12  FILLER                  PIC  X(03) VALUE '156'.
  2889     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2890     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2891     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2892     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2893
  2894******************  CHECK DATA - ERCHEK    *********************
  2895*****CHECK AMOUNT
  2896     12  FILLER                  PIC  X(03) VALUE '157'.
  2897     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2898     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2899     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2900     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2901
  2902*****CHECK NUMBER
  2903     12  FILLER                  PIC  X(03) VALUE '158'.
  2904     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2905     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2906     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2907     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2908
  2909*****PAYEE 1 NAME
  2910     12  FILLER                  PIC  X(03) VALUE '159'.
  2911     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2912     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2913     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2914     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2915
  2916*****PAYEE 2 NAME
  2917     12  FILLER                  PIC  X(03) VALUE '160'.
  2918     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2919     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2920     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2921     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2922
  2923*****ADDRSS 1
  2924     12  FILLER                  PIC  X(03) VALUE '161'.
  2925     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2926     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2927     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2928     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL689.cbl
  2929
  2930*****ADDRESS 2
  2931     12  FILLER                  PIC  X(03) VALUE '162'.
  2932     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2933     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2934     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2935     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2936
  2937*****PAYEE CITY STATE
  2938     12  FILLER                  PIC  X(03) VALUE '163'.
  2939     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2940     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2941     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2942     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2943
  2944*****ZIP CODE
  2945     12  FILLER                  PIC  X(03) VALUE '164'.
  2946     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2947     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2948     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2949     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2950
  2951*****CHECK CONTROL
  2952     12  FILLER                  PIC  X(03) VALUE '165'.
  2953     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2954     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2955     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2956     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2957
  2958*****REASON FOR CHECK
  2959     12  FILLER                  PIC  X(03) VALUE '166'.
  2960     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2961     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2962     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2963     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2964
  2965*****REMAINING 3 ARE NOT CURRENTLY USED
  2966     12  FILLER                  PIC  X(03) VALUE '167'.
  2967     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2968     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2969     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2970     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2971
  2972     12  FILLER                  PIC  X(03) VALUE '168'.
  2973     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2974     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2975     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2976     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2977
  2978     12  FILLER                  PIC  X(03) VALUE '169'.
  2979     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2980     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2981     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2982     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2983
  2984
  2985*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  2986*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL689.cbl
  2987     12  FILLER                  PIC  X(03) VALUE '170'.
  2988     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2989     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2990     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2991     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2992
  2993*****CHECK NUMBER - PYAJ
  2994     12  FILLER                  PIC  X(03) VALUE '171'.
  2995     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2996     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2997     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2998     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2999
  3000*****CHECK CONTROL - PYAJ
  3001     12  FILLER                  PIC  X(03) VALUE '172'.
  3002     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3003     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3004     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3005     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3006
  3007***** COMMENT - PYAJ
  3008     12  FILLER                  PIC  X(03) VALUE '173'.
  3009     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3010     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3011     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3012     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3013
  3014*****NEW FIELDS.
  3015*****COMPENSATION FULL ADDRESS TYPE 'G'
  3016     12  FILLER                  PIC  X(03) VALUE '174'.
  3017     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3018     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3019     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3020     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3021
  3022     12  FILLER                  PIC  X(03) VALUE '175'.
  3023     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3024     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3025     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3026     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3027
  3028     12  FILLER                  PIC  X(03) VALUE '176'.
  3029     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3030     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3031     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3032     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3033
  3034     12  FILLER                  PIC  X(03) VALUE '177'.
  3035     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3036     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3037     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3038     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3039
  3040     12  FILLER                  PIC  X(03) VALUE '178'.
  3041     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3042     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3043     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3044     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL689.cbl
  3045
  3046     12  FILLER                  PIC  X(03) VALUE '179'.
  3047     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3048     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3049     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3050     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3051
  3052*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3053     12  FILLER                  PIC  X(03) VALUE '180'.
  3054     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3055     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3056     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3057     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3058**** COMPENSATION BILLING SWITCH
  3059     12  FILLER                  PIC XXX    VALUE '181'.
  3060     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3061     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3062     12  FILLER                  PIC X      VALUE ALL 'N'.
  3063     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3064*****COMPENSATION FAX NUMBER
  3065     12  FILLER                  PIC  X(03) VALUE '182'.
  3066     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3067     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3068     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3069     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3070**** COMPENSATION STATUS
  3071     12  FILLER                  PIC XXX    VALUE '183'.
  3072     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3073     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3074     12  FILLER                  PIC X      VALUE ALL 'N'.
  3075     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3076***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3077*****COMPENSATION FULL ADDRESS TYPE 'B'
  3078     12  FILLER                  PIC  X(03) VALUE '184'.
  3079     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3080     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3081     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3082     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3083
  3084     12  FILLER                  PIC  X(03) VALUE '185'.
  3085     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3086     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3087     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3088     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3089
  3090     12  FILLER                  PIC  X(03) VALUE '186'.
  3091     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3092     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3093     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3094     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3095
  3096     12  FILLER                  PIC  X(03) VALUE '187'.
  3097     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3098     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3099     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3100     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3101
  3102     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL689.cbl
  3103     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3104     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3105     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3106     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3107
  3108     12  FILLER                  PIC  X(03) VALUE '189'.
  3109     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3110     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3111     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3112     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3113
  3114
  3115 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3116*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3117     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3118                        INDEXED BY W-VG-NDX.
  3119         16  W-VARIABLE-ID         PIC  X(03).
  3120         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3121         16  W-VG-TEXT.
  3122             20  W-VAR-CHAR
  3123                        OCCURS 30 TIMES
  3124                        INDEXED BY W-VC-NDX
  3125                                   PIC  X(01).
  3126         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3127             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3128
  3129         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3130
  3131 01  W-VAR-END                   PIC  X(23)
  3132                        VALUE ':VARIABLE WORK AREA END'.
  3133
  3134 01  W-PROGRAM-TABLE-AREA.
  3135     12  FILLER                  PIC  X(15)
  3136                                 VALUE 'PROGRAM TABLES:'.
  3137
  3138     12  W-RECORD-TABLE              VALUE SPACES.
  3139         16  W-RC-GRP OCCURS 500 TIMES
  3140                       INDEXED BY W-RG-NDX
  3141                                  W-RG-NDX1.
  3142             20  W-RC-TEXT.
  3143                 24  W-RC-CHAR OCCURS 70 TIMES
  3144                                INDEXED BY W-RC-NDX
  3145                                           W-RC-NDX1
  3146                                 PIC  X(01).
  3147             20  W-RC-PC         PIC  9(02).
  3148             20  W-RC-SC         PIC  X(01).
  3149
  3150     12  FILLER REDEFINES W-RECORD-TABLE.
  3151         16  W-REC-CHAR OCCURS 36500 TIMES
  3152                        INDEXED BY W-RVS-NDX
  3153                                   W-RVS-NDX2
  3154                                 PIC  X(01).
  3155     12  FILLER REDEFINES W-RECORD-TABLE.
  3156         16  W-TS-GROUP OCCURS 10 TIMES
  3157                        INDEXED BY W-TS-NDX
  3158                                 PIC X(3650).
  3159
  3160     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL689.cbl
  3161                                 VALUE 'TEXT TABLE:'.
  3162     12  W-TX-TABLE                  VALUE SPACES.
  3163         16  W-TX-GRP OCCURS 500 TIMES
  3164                       INDEXED BY W-TG-NDX
  3165                                  W-TG-NDX2.
  3166             20  W-TX-TEXT.
  3167                 24  W-TX-CHAR OCCURS 70 TIMES
  3168                                    INDEXED BY W-TX-NDX
  3169                                               W-TX-NDX1
  3170                                               W-TX-NDX2
  3171                                 PIC  X(01).
  3172             20  W-TX-PC         PIC  9(02).
  3173             20  W-TX-SC         PIC  X(01).
  3174
  3175     12  FILLER                  PIC  X(11)
  3176                                 VALUE 'FILE TABLE:'.
  3177     12  W-FILE-TABLE                VALUE SPACES.
  3178         16  W-FILE-USE-IND OCCURS 20 TIMES
  3179                       INDEXED BY W-FILE-NDX
  3180                                 PIC  X(01).
  3181             88  W-FILE-NOT-USED     VALUE SPACE.
  3182             88  W-FILE-USED         VALUE 'Y'.
  3183
  3184     12  FILLER                  PIC  X(14)
  3185                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL689.cbl
  3187 01  ERROR-MESSAGES.
  3188     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3189     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3190     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3191     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3192     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3193     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3194     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3195     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3196     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3197     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3198     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3199     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3200     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3201     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3202     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3203     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3204     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3205     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3206     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3207     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3208     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3209     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3210     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3211     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3212     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3213     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3214     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3215     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3216     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3217     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3218     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3219     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3220     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3221     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3222     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3223     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3224     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3225     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3226     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3227     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3228     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3229     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3230     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3231     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3232     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3233     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3234     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3235     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3236     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3237     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3238     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3239     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3240     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3241     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3242     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3243     12  ER-3000                 PIC  X(04) VALUE '3000'.
  3244     12  ER-3770                 PIC  X(04) VALUE '3770'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL689.cbl
  3245     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3246     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3247     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3248     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3249     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3250     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3251     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3252     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3253     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3254     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3255     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3256     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3257     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3258     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3259     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3260     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3261     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3262     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3263     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3264     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3265     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3266     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3267     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3268     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3269     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3270     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3271     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3272     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3273     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3274     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3275     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3276     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3277     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3278     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3279     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3280     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3281     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3282     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3283     12  ER-9427                 PIC  X(04) VALUE '9427'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL689.cbl
  3285*    COPY ELCAID.
  3286******************************************************************
  3287*                                                                *
  3288*                            ELCAID.                             *
  3289*                            VMOD=2.001                          *
  3290*                                                                *
  3291*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3292*                                                                *
  3293*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3294*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3295******************************************************************
  3296
  3297 01  DFHAID.
  3298   02  DFHNULL   PIC  X  VALUE  ' '.
  3299   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3300   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3301   02  DFHPEN    PIC  X  VALUE  '='.
  3302   02  DFHOPID   PIC  X  VALUE  'W'.
  3303   02  DFHPA1    PIC  X  VALUE  '%'.
  3304   02  DFHPA2    PIC  X  VALUE  '>'.
  3305   02  DFHPA3    PIC  X  VALUE  ','.
  3306   02  DFHPF1    PIC  X  VALUE  '1'.
  3307   02  DFHPF2    PIC  X  VALUE  '2'.
  3308   02  DFHPF3    PIC  X  VALUE  '3'.
  3309   02  DFHPF4    PIC  X  VALUE  '4'.
  3310   02  DFHPF5    PIC  X  VALUE  '5'.
  3311   02  DFHPF6    PIC  X  VALUE  '6'.
  3312   02  DFHPF7    PIC  X  VALUE  '7'.
  3313   02  DFHPF8    PIC  X  VALUE  '8'.
  3314   02  DFHPF9    PIC  X  VALUE  '9'.
  3315   02  DFHPF10   PIC  X  VALUE  ':'.
  3316   02  DFHPF11   PIC  X  VALUE  '#'.
  3317   02  DFHPF12   PIC  X  VALUE  '@'.
  3318   02  DFHPF13   PIC  X  VALUE  'A'.
  3319   02  DFHPF14   PIC  X  VALUE  'B'.
  3320   02  DFHPF15   PIC  X  VALUE  'C'.
  3321   02  DFHPF16   PIC  X  VALUE  'D'.
  3322   02  DFHPF17   PIC  X  VALUE  'E'.
  3323   02  DFHPF18   PIC  X  VALUE  'F'.
  3324   02  DFHPF19   PIC  X  VALUE  'G'.
  3325   02  DFHPF20   PIC  X  VALUE  'H'.
  3326   02  DFHPF21   PIC  X  VALUE  'I'.
  3327*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3328   02  DFHPF22   PIC  X  VALUE  '['.
  3329   02  DFHPF23   PIC  X  VALUE  '.'.
  3330   02  DFHPF24   PIC  X  VALUE  '<'.
  3331   02  DFHMSRE   PIC  X  VALUE  'X'.
  3332   02  DFHSTRF   PIC  X  VALUE  'h'.
  3333   02  DFHTRIG   PIC  X  VALUE  '"'.
  3334 01  FILLER    REDEFINES DFHAID.
  3335     12  FILLER                  PIC  X(08).
  3336     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL689.cbl
  3338*    COPY ELCATTR.
  3339******************************************************************
  3340*                                                                *
  3341*                            ELCATTR.                            *
  3342*                            VMOD=2.001                          *
  3343*                                                                *
  3344*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3345*                                                                *
  3346*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3347*                                                                *
  3348*                   POS 1   P=PROTECTED                          *
  3349*                           U=UNPROTECTED                        *
  3350*                           S=ASKIP                              *
  3351*                   POS 2   A=ALPHA/NUMERIC                      *
  3352*                           N=NUMERIC                            *
  3353*                   POS 3   N=NORMAL                             *
  3354*                           B=BRIGHT                             *
  3355*                           D=DARK                               *
  3356*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3357*                           OF=MODIFIED DATA TAG OFF             *
  3358*                                                                *
  3359*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3360******************************************************************
  3361 01  ATTRIBUTE-LIST.
  3362     12  AL-PABOF            PIC X       VALUE 'Y'.
  3363     12  AL-PABON            PIC X       VALUE 'Z'.
  3364     12  AL-PADOF            PIC X       VALUE '%'.
  3365     12  AL-PADON            PIC X       VALUE '_'.
  3366     12  AL-PANOF            PIC X       VALUE '-'.
  3367     12  AL-PANON            PIC X       VALUE '/'.
  3368     12  AL-SABOF            PIC X       VALUE '8'.
  3369     12  AL-SABON            PIC X       VALUE '9'.
  3370     12  AL-SADOF            PIC X       VALUE '@'.
  3371     12  AL-SADON            PIC X       VALUE QUOTE.
  3372     12  AL-SANOF            PIC X       VALUE '0'.
  3373     12  AL-SANON            PIC X       VALUE '1'.
  3374     12  AL-UABOF            PIC X       VALUE 'H'.
  3375     12  AL-UABON            PIC X       VALUE 'I'.
  3376     12  AL-UADOF            PIC X       VALUE '<'.
  3377     12  AL-UADON            PIC X       VALUE '('.
  3378     12  AL-UANOF            PIC X       VALUE ' '.
  3379     12  AL-UANON            PIC X       VALUE 'A'.
  3380     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3381     12  AL-UNBON            PIC X       VALUE 'R'.
  3382     12  AL-UNDOF            PIC X       VALUE '*'.
  3383     12  AL-UNDON            PIC X       VALUE ')'.
  3384     12  AL-UNNOF            PIC X       VALUE '&'.
  3385     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL689.cbl
  3387*    COPY ELCDATE.
  3388******************************************************************
  3389*                                                                *
  3390*                                                                *
  3391*                            ELCDATE.                            *
  3392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3393*                            VMOD=2.003
  3394*                                                                *
  3395*                                                                *
  3396*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3397*                 LENGTH = 200                                   *
  3398******************************************************************
  3399
  3400 01  DATE-CONVERSION-DATA.
  3401     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3402     12  DC-OPTION-CODE                PIC X.
  3403         88  BIN-TO-GREG                VALUE ' '.
  3404         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3405         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3406         88  YMD-GREG-TO-BIN            VALUE '3'.
  3407         88  MDY-GREG-TO-BIN            VALUE '4'.
  3408         88  JULIAN-TO-BIN              VALUE '5'.
  3409         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3410         88  FIND-CENTURY               VALUE '7'.
  3411         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3412         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3413         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3414         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3415         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3416         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3417         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3418         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3419         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3420         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3421         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3422         88  BIN-3-TO-GREG              VALUE 'I'.
  3423         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3424         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3425         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3426         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3427         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3428         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3429         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3430         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3431         88  THREE-CHARACTER-BIN
  3432                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3433         88  GREGORIAN-TO-BIN
  3434                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3435         88  BIN-TO-GREGORIAN
  3436                  VALUES ' ' '1' 'I' '8' 'G'.
  3437         88  JULIAN-TO-BINARY
  3438                  VALUES '5' 'C' 'E' 'F'.
  3439     12  DC-ERROR-CODE                 PIC X.
  3440         88  NO-CONVERSION-ERROR        VALUE ' '.
  3441         88  DATE-CONVERSION-ERROR
  3442                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3443         88  DATE-IS-ZERO               VALUE '1'.
  3444         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL689.cbl
  3445         88  DATE-IS-INVALID            VALUE '3'.
  3446         88  DATE1-GREATER-DATE2        VALUE '4'.
  3447         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3448         88  DATE-INVALID-OPTION        VALUE '9'.
  3449         88  INVALID-CENTURY            VALUE 'A'.
  3450         88  ONLY-CENTURY               VALUE 'B'.
  3451         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3452         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3453     12  DC-END-OF-MONTH               PIC X.
  3454         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3455     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3456         88  USE-NORMAL-PROCESS         VALUE ' '.
  3457         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3458         88  ADJUST-UP-100-YRS          VALUE '2'.
  3459     12  FILLER                        PIC X.
  3460     12  DC-CONVERSION-DATES.
  3461         16  DC-BIN-DATE-1             PIC XX.
  3462         16  DC-BIN-DATE-2             PIC XX.
  3463         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3464         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3465                       DC-GREG-DATE-1-EDIT.
  3466             20  DC-EDIT1-MONTH        PIC 99.
  3467             20  SLASH1-1              PIC X.
  3468             20  DC-EDIT1-DAY          PIC 99.
  3469             20  SLASH1-2              PIC X.
  3470             20  DC-EDIT1-YEAR         PIC 99.
  3471         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3472         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3473                     DC-GREG-DATE-2-EDIT.
  3474             20  DC-EDIT2-MONTH        PIC 99.
  3475             20  SLASH2-1              PIC X.
  3476             20  DC-EDIT2-DAY          PIC 99.
  3477             20  SLASH2-2              PIC X.
  3478             20  DC-EDIT2-YEAR         PIC 99.
  3479         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3480         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3481                     DC-GREG-DATE-1-YMD.
  3482             20  DC-YMD-YEAR           PIC 99.
  3483             20  DC-YMD-MONTH          PIC 99.
  3484             20  DC-YMD-DAY            PIC 99.
  3485         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3486         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3487                      DC-GREG-DATE-1-MDY.
  3488             20  DC-MDY-MONTH          PIC 99.
  3489             20  DC-MDY-DAY            PIC 99.
  3490             20  DC-MDY-YEAR           PIC 99.
  3491         16  DC-GREG-DATE-1-ALPHA.
  3492             20  DC-ALPHA-MONTH        PIC X(10).
  3493             20  DC-ALPHA-DAY          PIC 99.
  3494             20  FILLER                PIC XX.
  3495             20  DC-ALPHA-CENTURY.
  3496                 24 DC-ALPHA-CEN-N     PIC 99.
  3497             20  DC-ALPHA-YEAR         PIC 99.
  3498         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3499         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3500         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3501         16  DC-JULIAN-DATE            PIC 9(05).
  3502         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL689.cbl
  3503                                       PIC 9(05).
  3504         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3505             20  DC-JULIAN-YEAR        PIC 99.
  3506             20  DC-JULIAN-DAYS        PIC 999.
  3507         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3508         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3509         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3510     12  DATE-CONVERSION-VARIBLES.
  3511         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3512         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3513             20  FILLER                PIC 9(3).
  3514             20  HOLD-CEN-1-CCYY.
  3515                 24  HOLD-CEN-1-CC     PIC 99.
  3516                 24  HOLD-CEN-1-YY     PIC 99.
  3517             20  HOLD-CEN-1-MO         PIC 99.
  3518             20  HOLD-CEN-1-DA         PIC 99.
  3519         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3520             20  HOLD-CEN-1-R-MO       PIC 99.
  3521             20  HOLD-CEN-1-R-DA       PIC 99.
  3522             20  HOLD-CEN-1-R-CCYY.
  3523                 24  HOLD-CEN-1-R-CC   PIC 99.
  3524                 24  HOLD-CEN-1-R-YY   PIC 99.
  3525             20  FILLER                PIC 9(3).
  3526         16  HOLD-CENTURY-1-X.
  3527             20  FILLER                PIC X(3)  VALUE SPACES.
  3528             20  HOLD-CEN-1-X-CCYY.
  3529                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3530                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3531             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3532             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3533         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3534             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3535             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3536             20  HOLD-CEN-1-R-X-CCYY.
  3537                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3538                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3539             20  FILLER                PIC XXX.
  3540         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3541         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3542         16  DC-JULIAN-DATE-1          PIC 9(07).
  3543         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3544             20  DC-JULIAN-1-CCYY.
  3545                 24  DC-JULIAN-1-CC    PIC 99.
  3546                 24  DC-JULIAN-1-YR    PIC 99.
  3547             20  DC-JULIAN-DA-1        PIC 999.
  3548         16  DC-JULIAN-DATE-2          PIC 9(07).
  3549         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3550             20  DC-JULIAN-2-CCYY.
  3551                 24  DC-JULIAN-2-CC    PIC 99.
  3552                 24  DC-JULIAN-2-YR    PIC 99.
  3553             20  DC-JULIAN-DA-2        PIC 999.
  3554         16  DC-GREG-DATE-A-EDIT.
  3555             20  DC-EDITA-MONTH        PIC 99.
  3556             20  SLASHA-1              PIC X VALUE '/'.
  3557             20  DC-EDITA-DAY          PIC 99.
  3558             20  SLASHA-2              PIC X VALUE '/'.
  3559             20  DC-EDITA-CCYY.
  3560                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL689.cbl
  3561                 24  DC-EDITA-YEAR     PIC 99.
  3562         16  DC-GREG-DATE-B-EDIT.
  3563             20  DC-EDITB-MONTH        PIC 99.
  3564             20  SLASHB-1              PIC X VALUE '/'.
  3565             20  DC-EDITB-DAY          PIC 99.
  3566             20  SLASHB-2              PIC X VALUE '/'.
  3567             20  DC-EDITB-CCYY.
  3568                 24  DC-EDITB-CENT     PIC 99.
  3569                 24  DC-EDITB-YEAR     PIC 99.
  3570         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3571         16  DC-GREG-DATE-CYMD-R REDEFINES
  3572                              DC-GREG-DATE-CYMD.
  3573             20  DC-CYMD-CEN           PIC 99.
  3574             20  DC-CYMD-YEAR          PIC 99.
  3575             20  DC-CYMD-MONTH         PIC 99.
  3576             20  DC-CYMD-DAY           PIC 99.
  3577         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3578         16  DC-GREG-DATE-MDCY-R REDEFINES
  3579                              DC-GREG-DATE-MDCY.
  3580             20  DC-MDCY-MONTH         PIC 99.
  3581             20  DC-MDCY-DAY           PIC 99.
  3582             20  DC-MDCY-CEN           PIC 99.
  3583             20  DC-MDCY-YEAR          PIC 99.
  3584    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3585        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3586    12  DC-EL310-DATE                  PIC X(21).
  3587    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL689.cbl
  3589*    COPY ELCNWA.
  3590*****************************************************************
  3591*                                                               *
  3592*                                                               *
  3593*                            ELCNWA.                            *
  3594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3595*                            VMOD=2.003                         *
  3596*                                                               *
  3597*            M O V E   N A M E   W O R K   A R E A.             *
  3598*                                                               *
  3599*****************************************************************.
  3600
  3601 01  WS-NAME-WORK-AREA.
  3602     05  WS-INSURED-LAST-NAME        PIC X(15).
  3603     05  WS-INSURED-1ST-NAME         PIC X(12).
  3604     05  WS-INSURED-MID-INIT         PIC X.
  3605
  3606     05  WS-NAME-WORK.
  3607         10  WS-NW                   PIC X
  3608             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3609
  3610     05  WS-NAME-WORK2.
  3611         10  WS-NW2                  PIC X
  3612             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3613                                        NWA-INDEX0.
  3614
  3615     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3616                                     COMP-3.
  3617
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL689.cbl
  3619*    COPY ELCEMIB.
  3620******************************************************************
  3621*                                                                *
  3622*                                                                *
  3623*                            ELCEMIB.                            *
  3624*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3625*                            VMOD=2.005                          *
  3626*                                                                *
  3627*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3628*                                                                *
  3629******************************************************************
  3630 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3631     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3632     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3633     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3634     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3635     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3636     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3637     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3638     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3639     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3640         88  EMI-NO-ERRORS                    VALUE '1'.
  3641         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3642         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3643     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3644         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3645     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3646         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3647         88  EMI-AREA1-FULL                   VALUE '2'.
  3648     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3649         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3650         88  EMI-AREA2-FULL                   VALUE '2'.
  3651     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3652         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3653         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3654         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3655         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3656         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3657     12  EMI-ERROR-LINES.
  3658         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3659         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3660         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3661         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3662             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3663                 24  EMI-ERR-NUM         PIC X(4).
  3664                 24  EMI-FILLER          PIC X.
  3665                 24  EMI-SEV             PIC X.
  3666                 24  FILLER              PIC X.
  3667             20  FILLER                  PIC X(02).
  3668     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3669         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3670             20  EMI-ERROR-NUMBER    PIC X(4).
  3671             20  EMI-FILL            PIC X.
  3672             20  EMI-SEVERITY        PIC X.
  3673             20  FILLER              PIC X.
  3674             20  EMI-ERROR-TEXT.
  3675                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3676                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL689.cbl
  3677     12  EMI-SEVERITY-SAVE           PIC X.
  3678         88  EMI-NOTE                    VALUE 'N'.
  3679         88  EMI-WARNING                 VALUE 'W'.
  3680         88  EMI-FORCABLE                VALUE 'F'.
  3681         88  EMI-FATAL                   VALUE 'X'.
  3682     12  EMI-MESSAGE-FLAG            PIC X.
  3683         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3684         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3685     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3686     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3687         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3688         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3689         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3690     12  FILLER                      PIC X(137)  VALUE SPACES.
  3691     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3692     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3693     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3694     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3695 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL689.cbl
  3697*    COPY ELCLOGOF.
  3698******************************************************************
  3699*                                                                *
  3700*                                                                *
  3701*                            ELCLOGOF.                           *
  3702*                            VMOD=2.001                          *
  3703*                                                                *
  3704*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3705*                                                                *
  3706******************************************************************
  3707 01  CLASIC-LOGOFF.
  3708     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3709     12  LOGOFF-TEXT.
  3710         16  FILLER          PIC X(5)    VALUE SPACES.
  3711         16  LOGOFF-MSG.
  3712             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3713             20  FILLER      PIC X       VALUE SPACES.
  3714             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3715         16  FILLER          PIC X(80)
  3716           VALUE '* YOU ARE NOW LOGGED OFF'.
  3717         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3718         16  FILLER          PIC X       VALUE QUOTE.
  3719         16  LOGOFF-SYS-MSG  PIC X(17)
  3720           VALUE 'S CLAS-IC SYSTEM '.
  3721     12  TEXT-MESSAGES.
  3722         16  UNACCESS-MSG    PIC X(29)
  3723             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3724         16  PGMIDERR-MSG    PIC X(17)
  3725             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL689.cbl
  3727*    COPY ELCSCTM.
  3728******************************************************************
  3729*                                                                *
  3730*                                                                *
  3731*                            ELCSCTM                             *
  3732*                            VMOD=2.001                          *
  3733*                                                                *
  3734*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3735*                                                                *
  3736******************************************************************
  3737 01  SECURITY-MESSAGE.
  3738     12  FILLER                          PIC X(30)
  3739            VALUE '** LOGIC SECURITY VIOLATION -'.
  3740     12  SM-READ                         PIC X(6).
  3741     12  FILLER                          PIC X(5)
  3742            VALUE ' PGM='.
  3743     12  SM-PGM                          PIC X(6).
  3744     12  FILLER                          PIC X(5)
  3745            VALUE ' OPR='.
  3746     12  SM-PROCESSOR-ID                 PIC X(4).
  3747     12  FILLER                          PIC X(6)
  3748            VALUE ' TERM='.
  3749     12  SM-TERMID                       PIC X(4).
  3750     12  FILLER                          PIC XX   VALUE SPACE.
  3751     12  SM-JUL-DATE                     PIC 9(5).
  3752     12  FILLER                          PIC X    VALUE SPACE.
  3753     12  SM-TIME                         PIC 99.99.
  3754
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL689.cbl
  3756*    COPY ELCSCRTY.
  3757******************************************************************
  3758*                                                                *
  3759*                                                                *
  3760*                            ELCSCRTY                            *
  3761*                            VMOD=2.001                          *
  3762*                                                                *
  3763*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3764*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3765*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3766*                                                                *
  3767******************************************************************
  3768 01  SECURITY-CONTROL.
  3769     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3770     12  FILLER                       PIC XX    VALUE 'SC'.
  3771     12  SC-CREDIT-CODES.
  3772         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3773             20  SC-CREDIT-DISPLAY    PIC X.
  3774             20  SC-CREDIT-UPDATE     PIC X.
  3775     12  SC-CLAIMS-CODES.
  3776         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3777             20  SC-CLAIMS-DISPLAY    PIC X.
  3778             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL689.cbl
  3780
  3781 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL689.cbl
  3783****************************************************************
  3784*
  3785* Copyright (c) 2007 by Clerity Solutions, Inc.
  3786* All rights reserved.
  3787*
  3788****************************************************************
  3789 01  DFHEIV.
  3790   02  DFHEIV0               PIC X(35).
  3791   02  DFHEIV1               PIC X(08).
  3792   02  DFHEIV2               PIC X(08).
  3793   02  DFHEIV3               PIC X(08).
  3794   02  DFHEIV4               PIC X(06).
  3795   02  DFHEIV5               PIC X(04).
  3796   02  DFHEIV6               PIC X(04).
  3797   02  DFHEIV7               PIC X(02).
  3798   02  DFHEIV8               PIC X(02).
  3799   02  DFHEIV9               PIC X(01).
  3800   02  DFHEIV10              PIC S9(7) COMP-3.
  3801   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3802   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3803   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3804   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3805   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3806   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3807   02  DFHEIV17              PIC X(04).
  3808   02  DFHEIV18              PIC X(04).
  3809   02  DFHEIV19              PIC X(04).
  3810   02  DFHEIV20              USAGE IS POINTER.
  3811   02  DFHEIV21              USAGE IS POINTER.
  3812   02  DFHEIV22              USAGE IS POINTER.
  3813   02  DFHEIV23              USAGE IS POINTER.
  3814   02  DFHEIV24              USAGE IS POINTER.
  3815   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3816   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3817   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3818   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3819   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3820   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3821   02  FILLER                PIC X(02).
  3822   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3823   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3824   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3825   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3826   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3827 LINKAGE  SECTION.
  3828*****************************************************************
  3829*                                                               *
  3830* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3831* All rights reserved.                                          *
  3832*                                                               *
  3833*****************************************************************
  3834 01  dfheiblk.
  3835     02  eibtime          pic s9(7) comp-3.
  3836     02  eibdate          pic s9(7) comp-3.
  3837     02  eibtrnid         pic x(4).
  3838     02  eibtaskn         pic s9(7) comp-3.
  3839     02  eibtrmid         pic x(4).
  3840     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL689.cbl
  3841     02  eibcposn         pic s9(4) comp.
  3842     02  eibcalen         pic s9(4) comp.
  3843     02  eibaid           pic x(1).
  3844     02  eibfiller1       pic x(1).
  3845     02  eibfn            pic x(2).
  3846     02  eibfiller2       pic x(2).
  3847     02  eibrcode         pic x(6).
  3848     02  eibfiller3       pic x(2).
  3849     02  eibds            pic x(8).
  3850     02  eibreqid         pic x(8).
  3851     02  eibrsrce         pic x(8).
  3852     02  eibsync          pic x(1).
  3853     02  eibfree          pic x(1).
  3854     02  eibrecv          pic x(1).
  3855     02  eibsend          pic x(1).
  3856     02  eibatt           pic x(1).
  3857     02  eibeoc           pic x(1).
  3858     02  eibfmh           pic x(1).
  3859     02  eibcompl         pic x(1).
  3860     02  eibsig           pic x(1).
  3861     02  eibconf          pic x(1).
  3862     02  eiberr           pic x(1).
  3863     02  eibrldbk         pic x(1).
  3864     02  eiberrcd         pic x(4).
  3865     02  eibsynrb         pic x(1).
  3866     02  eibnodat         pic x(1).
  3867     02  eibfiller5       pic x(2).
  3868     02  eibresp          pic 9(09) comp.
  3869     02  eibresp2         pic 9(09) comp.
  3870     02  dfheigdj         pic s9(4) comp.
  3871     02  dfheigdk         pic s9(4) comp.
  3872 01  DFHCOMMAREA                 PIC X(1024).
  3873 01  var  pic x(30).
  3874
  3875*    COPY ERCACCT.
  3876******************************************************************
  3877*                                                                *
  3878*                                                                *
  3879*                            ERCACCT                             *
  3880*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3881*                            VMOD=2.031                          *
  3882*                                                                *
  3883*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3884*                                                                *
  3885*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3886*   VSAM ACCOUNT MASTER FILES.                                   *
  3887*                                                                *
  3888*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3889*                                                                *
  3890*   FILE TYPE = VSAM,KSDS                                        *
  3891*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3892*                                                                *
  3893*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3894*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3895*                                                                *
  3896*   LOG = NO                                                     *
  3897*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3898*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL689.cbl
  3899*                                                                *
  3900******************************************************************
  3901*                   C H A N G E   L O G
  3902*
  3903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3904*-----------------------------------------------------------------
  3905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3906* EFFECTIVE    NUMBER
  3907*-----------------------------------------------------------------
  3908* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3909* 092705    2005050300006  PEMA  ADD SPP LEASES
  3910* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3911* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3912* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3913* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3914* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3915******************************************************************
  3916
  3917 01  ACCOUNT-MASTER.
  3918     12  AM-RECORD-ID                      PIC XX.
  3919         88  VALID-AM-ID                      VALUE 'AM'.
  3920
  3921     12  AM-CONTROL-PRIMARY.
  3922         16  AM-COMPANY-CD                 PIC X.
  3923         16  AM-MSTR-CNTRL.
  3924             20  AM-CONTROL-A.
  3925                 24  AM-CARRIER            PIC X.
  3926                 24  AM-GROUPING.
  3927                     28 AM-GROUPING-PREFIX PIC XXX.
  3928                     28 AM-GROUPING-PRIME  PIC XXX.
  3929                 24  AM-STATE              PIC XX.
  3930                 24  AM-ACCOUNT.
  3931                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3932                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3933             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3934                                           PIC X(19).
  3935             20  AM-CNTRL-B.
  3936                 24  AM-EXPIRATION-DT      PIC XX.
  3937                 24  FILLER                PIC X(4).
  3938             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3939                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3940
  3941     12  AM-CONTROL-BY-VAR-GRP.
  3942         16  AM-COMPANY-CD-A1              PIC X.
  3943         16  AM-VG-CARRIER                 PIC X.
  3944         16  AM-VG-GROUPING                PIC X(6).
  3945         16  AM-VG-STATE                   PIC XX.
  3946         16  AM-VG-ACCOUNT                 PIC X(10).
  3947         16  AM-VG-DATE.
  3948             20  AM-VG-EXPIRATION-DT       PIC XX.
  3949             20  FILLER                    PIC X(4).
  3950         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3951                                           PIC 9(11)      COMP-3.
  3952     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3953         16  FILLER                        PIC X(10).
  3954         16  AM-VG-KEY3.
  3955             20  AM-VG3-ACCOUNT            PIC X(10).
  3956             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL689.cbl
  3957         16  FILLER                        PIC X(4).
  3958     12  AM-MAINT-INFORMATION.
  3959         16  AM-LAST-MAINT-DT              PIC XX.
  3960         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3961         16  AM-LAST-MAINT-USER            PIC X(4).
  3962         16  FILLER                        PIC XX.
  3963
  3964     12  AM-EFFECTIVE-DT                   PIC XX.
  3965     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3966
  3967     12  AM-PREV-DATES  COMP-3.
  3968         16  AM-PREV-EXP-DT                PIC 9(11).
  3969         16  AM-PREV-EFF-DT                PIC 9(11).
  3970
  3971     12  AM-REPORT-CODE-1                  PIC X(10).
  3972     12  AM-REPORT-CODE-2                  PIC X(10).
  3973
  3974     12  AM-CITY-CODE                      PIC X(4).
  3975     12  AM-COUNTY-PARISH                  PIC X(6).
  3976
  3977     12  AM-NAME                           PIC X(30).
  3978     12  AM-PERSON                         PIC X(30).
  3979     12  AM-ADDRS                          PIC X(30).
  3980     12  AM-CITY.
  3981         16  AM-ADDR-CITY                  PIC X(28).
  3982         16  AM-ADDR-STATE                 PIC XX.
  3983     12  AM-ZIP.
  3984         16  AM-ZIP-PRIME.
  3985             20  AM-ZIP-PRI-1ST            PIC X.
  3986                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3987             20  FILLER                    PIC X(4).
  3988         16  AM-ZIP-PLUS4                  PIC X(4).
  3989     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3990         16  AM-CAN-POSTAL-1               PIC XXX.
  3991         16  AM-CAN-POSTAL-2               PIC XXX.
  3992         16  FILLER                        PIC XXX.
  3993     12  AM-TEL-NO.
  3994         16  AM-AREA-CODE                  PIC 999.
  3995         16  AM-TEL-PRE                    PIC 999.
  3996         16  AM-TEL-NBR                    PIC 9(4).
  3997     12  AM-TEL-LOC                        PIC X.
  3998         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3999         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4000
  4001     12  AM-COMM-STRUCTURE.
  4002         16  AM-DEFN-1.
  4003             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4004                 24  AM-AGT.
  4005                     28  AM-AGT-PREFIX     PIC X(4).
  4006                     28  AM-AGT-PRIME      PIC X(6).
  4007                 24  AM-COM-TYP            PIC X.
  4008                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4009                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4010                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4011                 24  AM-RECALC-LV-INDIC    PIC X.
  4012                 24  AM-RETRO-LV-INDIC     PIC X.
  4013                 24  AM-GL-CODES           PIC X.
  4014                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL689.cbl
  4015                 24  FILLER                PIC X(01).
  4016         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4017             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4018                 24  FILLER                PIC X(11).
  4019                 24  AM-L-COMA             PIC XXX.
  4020                 24  AM-J-COMA             PIC XXX.
  4021                 24  AM-A-COMA             PIC XXX.
  4022                 24  FILLER                PIC X(6).
  4023
  4024     12  AM-COMM-CHANGE-STATUS             PIC X.
  4025         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4026
  4027     12  AM-CSR-CODE                       PIC X(4).
  4028
  4029     12  AM-BILLING-STATUS                 PIC X.
  4030         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4031         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4032     12  AM-AUTO-REFUND-SW                 PIC X.
  4033         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4034         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4035     12  AM-GPCD                           PIC 99.
  4036     12  AM-IG                             PIC X.
  4037         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4038         88  AM-HAS-GROUP                     VALUE '2'.
  4039     12  AM-STATUS                         PIC X.
  4040         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4041         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4042         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4043         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4044         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4045         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4046     12  AM-REMIT-TO                       PIC 99.
  4047     12  AM-ID-NO                          PIC X(11).
  4048
  4049     12  AM-CAL-TABLE                      PIC XX.
  4050     12  AM-LF-DEVIATION                   PIC XXX.
  4051     12  AM-AH-DEVIATION                   PIC XXX.
  4052     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4053     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4054     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4055     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4056     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4057     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4058
  4059     12  AM-USER-FIELDS.
  4060         16  AM-FLD-1                      PIC XX.
  4061         16  AM-FLD-2                      PIC XX.
  4062         16  AM-FLD-3                      PIC XX.
  4063         16  AM-FLD-4                      PIC XX.
  4064         16  AM-FLD-5                      PIC XX.
  4065
  4066     12  AM-1ST-PROD-DATE.
  4067         16  AM-1ST-PROD-YR                PIC XX.
  4068         16  AM-1ST-PROD-MO                PIC XX.
  4069         16  AM-1ST-PROD-DA                PIC XX.
  4070     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4071     12  AM-CERTS-PURGED-DATE.
  4072         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL689.cbl
  4073         16  AM-PUR-MO                     PIC XX.
  4074         16  AM-PUR-DA                     PIC XX.
  4075     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4076     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4077     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4078     12  AM-INACTIVE-DATE.
  4079         16  AM-INA-MO                     PIC 99.
  4080         16  AM-INA-DA                     PIC 99.
  4081         16  AM-INA-YR                     PIC 99.
  4082     12  AM-AR-HI-CERT-DATE                PIC XX.
  4083
  4084     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4085     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4086
  4087     12  AM-OB-PAYMENT-MODE                PIC X.
  4088         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4089         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4090         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4091         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4092
  4093     12  AM-AH-ONLY-INDICATOR              PIC X.
  4094         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4095         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4096
  4097     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4098
  4099     12  AM-OVER-SHORT.
  4100         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4101         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4102
  4103     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4104     12  AM-DCC-CLP-STATE                  PIC XX.
  4105
  4106     12  AM-RECALC-COMM                    PIC X.
  4107     12  AM-RECALC-REIN                    PIC X.
  4108
  4109     12  AM-REI-TABLE                      PIC XXX.
  4110     12  AM-REI-ET-LF                      PIC X.
  4111     12  AM-REI-ET-AH                      PIC X.
  4112     12  AM-REI-PE-LF                      PIC X.
  4113     12  AM-REI-PE-AH                      PIC X.
  4114     12  AM-REI-PRT-ST                     PIC X.
  4115     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4116     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4117     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4118     12  AM-REI-GROUP-A                    PIC X(6).
  4119     12  AM-REI-MORT                       PIC X(4).
  4120     12  AM-REI-PRT-OW                     PIC X.
  4121     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4122     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4123     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4124     12  AM-REI-GROUP-B                    PIC X(6).
  4125
  4126     12  AM-TRUST-TYPE                     PIC X(2).
  4127
  4128     12  AM-EMPLOYER-STMT-USED             PIC X.
  4129     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4130
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL689.cbl
  4131     12  AM-STD-AH-TYPE                    PIC XX.
  4132     12  AM-EARN-METHODS.
  4133         16  AM-EARN-METHOD-R              PIC X.
  4134             88 AM-REF-RL-R78                 VALUE 'R'.
  4135             88 AM-REF-RL-PR                  VALUE 'P'.
  4136             88 AM-REF-RL-MEAN                VALUE 'M'.
  4137             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4138         16  AM-EARN-METHOD-L              PIC X.
  4139             88 AM-REF-LL-R78                 VALUE 'R'.
  4140             88 AM-REF-LL-PR                  VALUE 'P'.
  4141             88 AM-REF-LL-MEAN                VALUE 'M'.
  4142             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4143         16  AM-EARN-METHOD-A              PIC X.
  4144             88 AM-REF-AH-R78                 VALUE 'R'.
  4145             88 AM-REF-AH-PR                  VALUE 'P'.
  4146             88 AM-REF-AH-MEAN                VALUE 'M'.
  4147             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4148             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4149             88 AM-REF-AH-NET                 VALUE 'N'.
  4150
  4151     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4152     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4153     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4154
  4155     12  AM-RET-Y-N                        PIC X.
  4156     12  AM-RET-P-E                        PIC X.
  4157     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4158     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4159     12  AM-RET-GRP                        PIC X(6).
  4160     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4161         16  AM-POOL-PRIME                 PIC XXX.
  4162         16  AM-POOL-SUB                   PIC XXX.
  4163     12  AM-RETRO-EARNINGS.
  4164         16  AM-RET-EARN-R                 PIC X.
  4165         16  AM-RET-EARN-L                 PIC X.
  4166         16  AM-RET-EARN-A                 PIC X.
  4167     12  AM-RET-ST-TAX-USE                 PIC X.
  4168         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4169         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4170     12  AM-RETRO-BEG-EARNINGS.
  4171         16  AM-RET-BEG-EARN-R             PIC X.
  4172         16  AM-RET-BEG-EARN-L             PIC X.
  4173         16  AM-RET-BEG-EARN-A             PIC X.
  4174     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4175     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4176
  4177     12  AM-USER-SELECT-OPTIONS.
  4178         16  AM-USER-SELECT-1              PIC X(10).
  4179         16  AM-USER-SELECT-2              PIC X(10).
  4180         16  AM-USER-SELECT-3              PIC X(10).
  4181         16  AM-USER-SELECT-4              PIC X(10).
  4182         16  AM-USER-SELECT-5              PIC X(10).
  4183
  4184     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4185
  4186     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4187
  4188     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL689.cbl
  4189         88  RPT045A-OFF                   VALUE 'N'.
  4190
  4191     12  AM-INSURANCE-LIMITS.
  4192         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4193         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4194
  4195     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4196         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4197
  4198     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4199         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4200         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4201
  4202     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4203
  4204     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4205     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4206     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4207     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4208     12  AM-DCC-UEF-STATE                  PIC XX.
  4209     12  FILLER                            PIC XXX.
  4210     12  AM-REPORT-CODE-3                  PIC X(10).
  4211*    12  FILLER                            PIC X(22).
  4212
  4213     12  AM-RESERVE-DATE.
  4214         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4215         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4216         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4217
  4218     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4219     12  AM-NOTIFICATION-TYPES.
  4220         16  AM-NOTIF-OF-LETTERS           PIC X.
  4221         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4222         16  AM-NOTIF-OF-REPORTS           PIC X.
  4223         16  AM-NOTIF-OF-STATUS            PIC X.
  4224
  4225     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4226         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4227         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4228         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4229         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4230
  4231     12  AM-BENEFIT-CONTROLS.
  4232         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4233             20  AM-BENEFIT-CODE           PIC XX.
  4234             20  AM-BENEFIT-TYPE           PIC X.
  4235             20  AM-BENEFIT-REVISION       PIC XXX.
  4236             20  AM-BENEFIT-REM-TERM       PIC X.
  4237             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4238             20  FILLER                    PIC XX.
  4239         16  FILLER                        PIC X(80).
  4240
  4241     12  AM-TRANSFER-DATA.
  4242         16  AM-TRANSFERRED-FROM.
  4243             20  AM-TRNFROM-CARRIER        PIC X.
  4244             20  AM-TRNFROM-GROUPING.
  4245                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4246                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL689.cbl
  4247             20  AM-TRNFROM-STATE          PIC XX.
  4248             20  AM-TRNFROM-ACCOUNT.
  4249                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4250                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4251             20  AM-TRNFROM-DTE            PIC XX.
  4252         16  AM-TRANSFERRED-TO.
  4253             20  AM-TRNTO-CARRIER          PIC X.
  4254             20  AM-TRNTO-GROUPING.
  4255                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4256                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4257             20  AM-TRNTO-STATE            PIC XX.
  4258             20  AM-TRNTO-ACCOUNT.
  4259                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4260                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4261             20  AM-TRNTO-DTE              PIC XX.
  4262         16  FILLER                        PIC X(10).
  4263
  4264     12  AM-SAVED-REMIT-TO                 PIC 99.
  4265
  4266     12  AM-COMM-STRUCTURE-SAVED.
  4267         16  AM-DEFN-1-SAVED.
  4268             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4269                 24  AM-AGT-SV             PIC X(10).
  4270                 24  AM-COM-TYP-SV         PIC X.
  4271                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4272                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4273                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4274                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4275                 24  FILLER                PIC X.
  4276                 24  AM-GL-CODES-SV        PIC X.
  4277                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4278                 24  FILLER                PIC X.
  4279         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4280             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4281                 24  FILLER                PIC X(11).
  4282                 24  AM-L-COMA-SV          PIC XXX.
  4283                 24  AM-J-COMA-SV          PIC XXX.
  4284                 24  AM-A-COMA-SV          PIC XXX.
  4285                 24  FILLER                PIC X(6).
  4286
  4287     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4288         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4289            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4290            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4291            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4292
  4293     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4294     12  FILLER                            PIC X(120).
  4295
  4296     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4297         16  AM-CONTROL-NAME               PIC X(30).
  4298         16  AM-EXECUTIVE-ONE.
  4299             20  AM-EXEC1-NAME             PIC X(15).
  4300             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4301                                                          COMP-3.
  4302             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4303                                                          COMP-3.
  4304         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL689.cbl
  4305             20  AM-EXEC2-NAME             PIC X(15).
  4306             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4307                                                          COMP-3.
  4308             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4309                                                          COMP-3.
  4310
  4311     12  AM-RETRO-ADDITIONAL-DATA.
  4312         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4313         16  AM-RETRO-PREM-P-E             PIC X.
  4314         16  AM-RETRO-CLMS-P-I             PIC X.
  4315         16  AM-RETRO-RET-BRACKET-LF.
  4316             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4317                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4318                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4319             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4320                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4321                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4322             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4323                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4324                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4325         16  AM-RETRO-RET-BRACKET-AH.
  4326             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4327                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4328                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4329                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4330             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4331                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4332                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4333             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4334                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4335                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4336
  4337     12  AM-COMMENTS.
  4338         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4339
  4340     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4341         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4342         16  AM-FLI-BILLING-CODE           PIC X.
  4343         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4344         16  AM-FLI-UNITED-IDENT           PIC X.
  4345         16  AM-FLI-INTEREST-LOST-DATA.
  4346             20  AM-FLI-BANK-NO            PIC X(5).
  4347             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4348             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4349             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4350         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4351             20  AM-FLI-AGT                PIC X(9).
  4352             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4353             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4354         16  FILLER                        PIC X(102).
  4355
  4356     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4357         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4358             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4359             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4360             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4361             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4362             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL689.cbl
  4363         16  FILLER                          PIC X(10).
  4364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL689.cbl
  4366*    COPY ERCARCH.
  4367******************************************************************
  4368*                                                                *
  4369*                            ERCARCH.                            *
  4370*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4371*                            VMOD=2.002                          *
  4372*                                                                *
  4373*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4374*                                                                *
  4375*   FILE TYPE = VSAM,KSDS                                        *
  4376*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4377*                                                                *
  4378*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4379*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4380*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4381*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4382*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4383*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4384*                                                                *
  4385*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4386******************************************************************
  4387*                   C H A N G E   L O G
  4388*
  4389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4390*-----------------------------------------------------------------
  4391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4392* EFFECTIVE    NUMBER
  4393*-----------------------------------------------------------------
  4394* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4395* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4396******************************************************************
  4397 01  LETTER-ARCHIVE.
  4398     12  LA-RECORD-ID                PIC  X(02).
  4399         88  LA-VALID-ID                VALUE 'LA'.
  4400
  4401     12  LA-CONTROL-PRIMARY.
  4402         16  LA-COMPANY-CD           PIC  X(01).
  4403         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4404
  4405     12  LA-CONTROL-BY-CERT-RESP.
  4406         16  LA-COMPANY-CD-A2        PIC  X(01).
  4407         16  LA-CERT-NO-A2.
  4408             20  LA-CERT-PRIME-A2    PIC  X(10).
  4409             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4410         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4411             20  LA-RESP-PERSON-A2   PIC  X(10).
  4412             20  LA-TYPE-A2          PIC  X(01).
  4413         16  LA-CARRIER-A2           PIC  X(01).
  4414         16  LA-GROUPING-A2          PIC  X(06).
  4415         16  LA-STATE-A2             PIC  X(02).
  4416         16  LA-ACCOUNT-A2           PIC  X(10).
  4417         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4418         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4419
  4420     12  LA-CONTROL-BY-FORM.
  4421         16  LA-COMPANY-CD-A3        PIC  X(01).
  4422         16  LA-FORM-A3              PIC  X(04).
  4423         16  LA-CARRIER-A3           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL689.cbl
  4424         16  LA-GROUPING-A3          PIC  X(06).
  4425         16  LA-STATE-A3             PIC  X(02).
  4426         16  LA-ACCOUNT-A3           PIC  X(10).
  4427         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4428
  4429     12  LA-CONTROL-BY-PROCESSOR.
  4430         16  LA-COMPANY-CD-A4        PIC  X(01).
  4431         16  LA-PROCESSOR-CD         PIC  X(04).
  4432         16  LA-CARRIER-A4           PIC  X(01).
  4433         16  LA-GROUPING-A4          PIC  X(06).
  4434         16  LA-STATE-A4             PIC  X(02).
  4435         16  LA-ACCOUNT-A4           PIC  X(10).
  4436         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4437
  4438     12  LA-CONTROL-BY-KEY-FIELDS.
  4439         16  LA-COMPANY-CD-A5        PIC  X(01).
  4440         16  LA-CARRIER-A5           PIC  X(01).
  4441         16  LA-GROUPING-A5          PIC  X(06).
  4442         16  LA-STATE-A5             PIC  X(02).
  4443         16  LA-ACCOUNT-A5           PIC  X(10).
  4444         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4445
  4446     12  LA-CONTROL-BY-GROUP-CODE.
  4447         16  LA-COMPANY-CD-A6        PIC  X(01).
  4448         16  LA-ENTRY-A6.
  4449             20  LA-FILLER           PIC  X(02).
  4450             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4451         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4452
  4453     12  FILLER                      PIC  X(09).
  4454
  4455     12  LA-HEADER-RECORD.
  4456         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4457         16  LA-CREATION-DATE        PIC  X(02).
  4458         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4459         16  LA-FINAL-ACT-DATE       REDEFINES
  4460               LA-FOLLOW-UP-DATE     PIC  X(02).
  4461         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4462         16  LA-NO-OF-COPIES         PIC S9(01).
  4463         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4464         16  LA-REPLY-DATE           PIC  X(02).
  4465         16  LA-RESEND-DATES.
  4466             20  LA-RESEND-DATE      PIC  X(02).
  4467             20  LA-SENT-DATE        PIC  X(02).
  4468             20  FILLER              PIC  X(08).
  4469         16  LA-SOURCE-INFORMATION.
  4470             20  LA-DATA-SOURCE      PIC  X(01).
  4471             20  LA-ADDR-SOURCE      PIC  X(01).
  4472         16  LA-STATUS               PIC  X(01).
  4473             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4474             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4475             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4476             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4477             88  LA-STATUS-PURGED         VALUE 'P'.
  4478             88  LA-STATUS-VOIDED         VALUE 'V'.
  4479         16  LA-LAST-RESENT-PRINT-DATE
  4480                                     PIC  X(02).
  4481         16  LA-PRINT-RESTRICTION    PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL689.cbl
  4482             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4483                                          VALUE 'C'.
  4484             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4485                                          VALUE 'F'.
  4486             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4487                                          VALUE 'P'.
  4488         16  LA-PURGED-DATE          PIC  X(02).
  4489         16  LA-VOIDED-DATE          PIC  X(02).
  4490         16  LA-RESEND-LETR          PIC  X(4).
  4491         16  FILLER                  PIC  X(08).
  4492*        16  LA-RESEND-LETR-2        PIC  X(4).
  4493*        16  LA-RESEND-LETR-3        PIC  X(4).
  4494*        16  FILLER                  PIC  X(59).
  4495         16  LA-ARCHIVE-STATUS       PIC  X.
  4496             88  LA-TEMP                VALUE 'T'.
  4497             88  LA-QWS                 VALUE 'Q'.
  4498             88  LA-BATCH               VALUE 'B'.
  4499         16  LA-FINAL-ACT-IND        PIC  X(1).
  4500         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4501         16  FILLER                  PIC  X(46).
  4502*        16  FILLER                  PIC  X(71).
  4503         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4504         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4505         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4506                                     PIC  X(4).
  4507         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4508
  4509******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL689.cbl
  4511*    COPY ERCARCT.
  4512******************************************************************
  4513*                                                                *
  4514*                            ERCARCT.                            *
  4515*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4516*                            VMOD=2.002                          *
  4517*                                                                *
  4518*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4519*                                                                *
  4520*   FILE TYPE = VSAM,KSDS                                        *
  4521*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4522*                                                                *
  4523*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4524*                                                                *
  4525*   LOG = NO                                                     *
  4526*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4527******************************************************************
  4528*                   C H A N G E   L O G
  4529*
  4530* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4531*-----------------------------------------------------------------
  4532*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4533* EFFECTIVE    NUMBER
  4534*-----------------------------------------------------------------
  4535* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4536******************************************************************
  4537 01  LETTER-ARCHIVE-TEXT.
  4538     12  LT-RECORD-ID                PIC  X(02).
  4539         88  LT-VALID-ID                VALUE 'LT'.
  4540
  4541     12  LT-CONTROL-PRIMARY.
  4542         16  LT-COMPANY-CD           PIC  X(01).
  4543         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4544         16  LT-RECORD-TYPE          PIC  X(01).
  4545             88  LT-ADDRESS-DATA        VALUE '1'.
  4546             88  LT-TEXT-DATA           VALUE '2'.
  4547             88  LT-COMMENT-DATA        VALUE '3'.
  4548         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4549
  4550     12  FILLER                      PIC  X(28).
  4551     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4552
  4553     12  LT-TEXT-RECORD.
  4554         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4555                            INDEXED BY LT-NDX.
  4556             20  LT-TEXT-LINE        PIC  X(70).
  4557             20  LT-SKIP-CONTROL     PIC  X(02).
  4558                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4559                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4560             20  FILLER              PIC  X(08).
  4561
  4562     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4563         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4564             20  LT-COMMENT-LINE     PIC X(69).
  4565             20  LT-COMMENT-CHG-DT   PIC X(02).
  4566             20  LT-COMMENT-CHG-BY   PIC X(04).
  4567             20  FILLER              PIC X(05).
  4568
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL689.cbl
  4570*    COPY ELCCERT.
  4571******************************************************************
  4572*                                                                *
  4573*                            ELCCERT.                            *
  4574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4575*                            VMOD=2.013                          *
  4576*                                                                *
  4577*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4578*                                                                *
  4579*   FILE TYPE = VSAM,KSDS                                        *
  4580*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4581*                                                                *
  4582*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4583*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4584*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4585*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4586*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4587*                                                                *
  4588*   LOG = YES                                                    *
  4589*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4590******************************************************************
  4591*                   C H A N G E   L O G
  4592*
  4593* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4594*-----------------------------------------------------------------
  4595*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4596* EFFECTIVE    NUMBER
  4597*-----------------------------------------------------------------
  4598* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4599* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4600* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4601* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4602* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4603* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4604* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4605* 032612  CR2011110200001  PEMA  AHL CHANGES
  4606******************************************************************
  4607
  4608 01  CERTIFICATE-MASTER.
  4609     12  CM-RECORD-ID                      PIC XX.
  4610         88  VALID-CM-ID                      VALUE 'CM'.
  4611
  4612     12  CM-CONTROL-PRIMARY.
  4613         16  CM-COMPANY-CD                 PIC X.
  4614         16  CM-CARRIER                    PIC X.
  4615         16  CM-GROUPING.
  4616             20  CM-GROUPING-PREFIX        PIC X(3).
  4617             20  CM-GROUPING-PRIME         PIC X(3).
  4618         16  CM-STATE                      PIC XX.
  4619         16  CM-ACCOUNT.
  4620             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4621             20  CM-ACCOUNT-PRIME          PIC X(6).
  4622         16  CM-CERT-EFF-DT                PIC XX.
  4623         16  CM-CERT-NO.
  4624             20  CM-CERT-PRIME             PIC X(10).
  4625             20  CM-CERT-SFX               PIC X.
  4626
  4627     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL689.cbl
  4628         16  CM-COMPANY-CD-A1              PIC X.
  4629         16  CM-INSURED-LAST-NAME          PIC X(15).
  4630         16  CM-INSURED-INITIALS.
  4631             20  CM-INSURED-INITIAL1       PIC X.
  4632             20  CM-INSURED-INITIAL2       PIC X.
  4633
  4634     12  CM-CONTROL-BY-SSN.
  4635         16  CM-COMPANY-CD-A2              PIC X.
  4636         16  CM-SOC-SEC-NO.
  4637             20  CM-SSN-STATE              PIC XX.
  4638             20  CM-SSN-ACCOUNT            PIC X(6).
  4639             20  CM-SSN-LN3.
  4640                 25  CM-INSURED-INITIALS-A2.
  4641                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4642                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4643                 25 CM-PART-LAST-NAME-A2         PIC X.
  4644
  4645     12  CM-CONTROL-BY-CERT-NO.
  4646         16  CM-COMPANY-CD-A4              PIC X.
  4647         16  CM-CERT-NO-A4                 PIC X(11).
  4648
  4649     12  CM-CONTROL-BY-MEMB.
  4650         16  CM-COMPANY-CD-A5              PIC X.
  4651         16  CM-MEMBER-NO.
  4652             20  CM-MEMB-STATE             PIC XX.
  4653             20  CM-MEMB-ACCOUNT           PIC X(6).
  4654             20  CM-MEMB-LN4.
  4655                 25  CM-INSURED-INITIALS-A5.
  4656                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4657                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4658                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4659
  4660     12  CM-INSURED-PROFILE-DATA.
  4661         16  CM-INSURED-FIRST-NAME.
  4662             20  CM-INSURED-1ST-INIT       PIC X.
  4663             20  FILLER                    PIC X(9).
  4664         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4665         16  CM-INSURED-SEX                PIC X.
  4666             88  CM-SEX-MALE                  VALUE 'M'.
  4667             88  CM-SEX-FEMAL                 VALUE 'F'.
  4668         16  CM-INSURED-JOINT-AGE          PIC 99.
  4669         16  CM-JOINT-INSURED-NAME.
  4670             20  CM-JT-LAST-NAME           PIC X(15).
  4671             20  CM-JT-FIRST-NAME.
  4672                 24  CM-JT-1ST-INIT        PIC X.
  4673                 24  FILLER                PIC X(9).
  4674             20  CM-JT-INITIAL             PIC X.
  4675
  4676     12  CM-LIFE-DATA.
  4677         16  CM-LF-BENEFIT-CD              PIC XX.
  4678         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4679         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4680         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4681         16  CM-LF-DEV-CODE                PIC XXX.
  4682         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4683         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4684         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4685         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL689.cbl
  4686         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4687         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4688         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4689         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4690         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4691         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4692         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4693         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4694         16  FILLER                        PIC XX.
  4695
  4696     12  CM-AH-DATA.
  4697         16  CM-AH-BENEFIT-CD              PIC XX.
  4698         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4699         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4700         16  CM-AH-DEV-CODE                PIC XXX.
  4701         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4702         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4703         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4704         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4705         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4706         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4707         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4708         16  CM-AH-PAID-THRU-DT            PIC XX.
  4709             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4710         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4711         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4712         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4713         16  FILLER                        PIC X.
  4714
  4715     12  CM-LOAN-INFORMATION.
  4716         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4717         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4718                                           PIC S9(5)V99  COMP-3.
  4719         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4720         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4721         16  CM-PAY-FREQUENCY              PIC S99.
  4722         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4723         16  CM-RATE-CLASS                 PIC XX.
  4724         16  CM-BENEFICIARY                PIC X(25).
  4725         16  CM-POLICY-FORM-NO             PIC X(12).
  4726         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4727         16  CM-LAST-ADD-ON-DT             PIC XX.
  4728         16  CM-DEDUCTIBLE-AMOUNTS.
  4729             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4730             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4731         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4732             20  CM-RESIDENT-STATE         PIC XX.
  4733             20  CM-RATE-CODE              PIC X(4).
  4734             20  FILLER                    PIC XX.
  4735         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4736             20  CM-LOAN-OFFICER           PIC X(5).
  4737             20  FILLER                    PIC XXX.
  4738         16  CM-CSR-CODE                   PIC XXX.
  4739         16  CM-UNDERWRITING-CODE          PIC X.
  4740             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4741         16  CM-POST-CARD-IND              PIC X.
  4742         16  CM-NH-INTERFACE-SW            PIC X.
  4743         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL689.cbl
  4744             88  CM-SING-PRM                  VALUE '1'.
  4745             88  CM-O-B-COVERAGE              VALUE '2'.
  4746             88  CM-OPEN-END                  VALUE '3'.
  4747         16  CM-IND-GRP-TYPE               PIC X.
  4748             88  CM-INDIVIDUAL                VALUE 'I'.
  4749             88  CM-GROUP                     VALUE 'G'.
  4750         16  CM-SKIP-CODE                  PIC X.
  4751             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4752             88  SKIP-JULY                    VALUE '1'.
  4753             88  SKIP-AUGUST                  VALUE '2'.
  4754             88  SKIP-SEPTEMBER               VALUE '3'.
  4755             88  SKIP-JULY-AUG                VALUE '4'.
  4756             88  SKIP-AUG-SEPT                VALUE '5'.
  4757             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4758             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4759             88  SKIP-JUNE                    VALUE '8'.
  4760             88  SKIP-JUNE-JULY               VALUE '9'.
  4761             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4762             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4763         16  CM-PAYMENT-MODE               PIC X.
  4764             88  PAY-MONTHLY                  VALUE SPACE.
  4765             88  PAY-WEEKLY                   VALUE '1'.
  4766             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4767             88  PAY-BI-WEEKLY                VALUE '3'.
  4768             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4769         16  CM-LOAN-NUMBER                PIC X(8).
  4770         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4771         16  CM-OLD-LOF                    PIC XXX.
  4772*        16  CM-LOAN-OFFICER               PIC XXX.
  4773         16  CM-REIN-TABLE                 PIC XXX.
  4774         16  CM-SPECIAL-REIN-CODE          PIC X.
  4775         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4776         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4777         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4778
  4779     12  CM-STATUS-DATA.
  4780         16  CM-ENTRY-STATUS               PIC X.
  4781         16  CM-ENTRY-DT                   PIC XX.
  4782
  4783         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4784         16  CM-LF-CANCEL-DT               PIC XX.
  4785         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4786
  4787         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4788         16  CM-LF-DEATH-DT                PIC XX.
  4789         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4790
  4791         16  CM-LF-CURRENT-STATUS          PIC X.
  4792             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4793                                                'M' '4' '5' '9'.
  4794             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4795             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4796             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4797             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4798             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4799             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4800             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4801             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL689.cbl
  4802             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4803             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4804             88  CM-LF-DECLINED               VALUE 'D'.
  4805             88  CM-LF-VOIDED                 VALUE 'V'.
  4806
  4807         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4808         16  CM-AH-CANCEL-DT               PIC XX.
  4809         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4810
  4811         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4812         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4813         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4814
  4815         16  CM-AH-CURRENT-STATUS          PIC X.
  4816             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4817                                                'M' '4' '5' '9'.
  4818             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4819             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4820             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4821             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4822             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4823             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4824             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4825             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4826             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4827             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4828             88  CM-AH-DECLINED               VALUE 'D'.
  4829             88  CM-AH-VOIDED                 VALUE 'V'.
  4830
  4831         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4832             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4833             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4834             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4835         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4836
  4837         16  CM-ENTRY-BATCH                PIC X(6).
  4838         16  CM-LF-EXIT-BATCH              PIC X(6).
  4839         16  CM-AH-EXIT-BATCH              PIC X(6).
  4840         16  CM-LAST-MONTH-END             PIC XX.
  4841
  4842     12  CM-NOTE-SW                        PIC X.
  4843         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4844         88  CERT-NOTES-PRESENT               VALUE '1'.
  4845         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4846         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4847         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4848         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4849         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4850         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4851     12  CM-COMP-EXCP-SW                   PIC X.
  4852         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4853         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4854     12  CM-INSURED-ADDRESS-SW             PIC X.
  4855         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4856         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4857
  4858*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4859     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL689.cbl
  4860     12  FILLER                            PIC X.
  4861
  4862*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4863     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4864     12  FILLER                            PIC X.
  4865*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4866     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4867
  4868     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4869         88  CERT-ADDED-BATCH                 VALUE ' '.
  4870         88  CERT-ADDED-ONLINE                VALUE '1'.
  4871         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4872         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4873         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4874     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4875         88  CERT-AS-LOADED                   VALUE ' '.
  4876         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4877         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4878         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4879         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4880         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4881         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4882         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4883
  4884     12  CM-ACCOUNT-COMM-PCTS.
  4885         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4886         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4887
  4888     12  CM-USER-FIELD                     PIC X.
  4889     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4890     12  CM-CLP-STATE                      PIC XX.
  4891     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4892     12  CM-USER-RESERVED                  PIC XXX.
  4893     12  FILLER REDEFINES CM-USER-RESERVED.
  4894         16  CM-AH-CLASS-CD                PIC XX.
  4895         16  F                             PIC X.
  4896******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL689.cbl
  4898*    COPY ERCCHEK.
  4899******************************************************************
  4900*                                                                *
  4901*                                                                *
  4902*                            ERCCHEK                             *
  4903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4904*                            VMOD=2.008                          *
  4905*                                                                *
  4906*   FILE DESCRIPTION = CHECK RECORDS                             *
  4907*                                                                *
  4908*   FILE TYPE = VSAM,KSDS                                        *
  4909*   RECORD SIZE = 600    RECFORM = FIXED                         *
  4910*                                                                *
  4911*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  4912*       ALTERNATE INDEX = NONE                                   *
  4913*                                                                *
  4914*   LOG = YES                                                    *
  4915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4916******************************************************************
  4917 01  CHECK-RECORDS.
  4918     12  CH-RECORD-ID                      PIC XX.
  4919         88  VALID-CH-ID                      VALUE 'CH'.
  4920
  4921     12  CH-CONTROL-PRIMARY.
  4922         16  CH-COMPANY-CD                 PIC X.
  4923         16  CH-CARRIER                    PIC X.
  4924         16  CH-GROUPING                   PIC X(6).
  4925         16  CH-STATE                      PIC XX.
  4926         16  CH-ACCOUNT                    PIC X(10).
  4927         16  CH-CERT-EFF-DT                PIC XX.
  4928         16  CH-CERT-NO.
  4929             20  CH-CERT-PRIME             PIC X(10).
  4930             20  CH-CERT-SFX               PIC X.
  4931         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  4932
  4933     12  CH-RECORDED-DT                    PIC XX.
  4934     12  CH-RECORDED-BY                    PIC X(4).
  4935     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  4936
  4937     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  4938     12  CH-CHECK-NO                       PIC X(7).
  4939     12  CH-REASON-FOR-CHECK               PIC X(25).
  4940     12  CH-CHECK-WRITTEN-DT               PIC XX.
  4941     12  CH-OFFLINE-CHECK-IND              PIC X.
  4942         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  4943
  4944     12  CH-PAYEE-INFO.
  4945         16  CH-PAYEE-NAME-1               PIC X(30).
  4946         16  CH-PAYEE-NAME-2               PIC X(30).
  4947         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  4948         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  4949         16  CH-PAYEE-CITY-ST              PIC X(30).
  4950         16  CH-PAYEE-ZIP-CODE.
  4951             20  CH-PAYEE-ZIP.
  4952                 24  CH-ZIP-PRI-1ST        PIC X.
  4953                     88  CH-CANADIAN-POST-CODE
  4954                                           VALUES 'A' THRU 'Z'.
  4955                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL689.cbl
  4956             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  4957         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  4958             20  CH-CAN-POSTAL-1           PIC XXX.
  4959             20  CH-CAN-POSTAL-2           PIC XXX.
  4960             20  FILLER                    PIC XXX.
  4961
  4962     12  CH-CHECK-STUB-TEXT.
  4963         16  CH-STUB-LINE-1                PIC X(50).
  4964         16  CH-STUB-LINE-2                PIC X(50).
  4965         16  CH-STUB-LINE-3                PIC X(50).
  4966         16  FILLER.
  4967           18  CH-STUB-LINE-4              PIC X(20).
  4968           18  CH-LIENHOLDER-NAME          PIC X(30).
  4969
  4970     12  CH-COMPENSATION-CONTROL.
  4971         16  CH-COMP-CARRIER               PIC X.
  4972         16  CH-COMP-GROUPING              PIC X(6).
  4973         16  CH-COMP-FIN-RESP              PIC X(10).
  4974         16  CH-COMP-ACCOUNT               PIC X(10).
  4975
  4976     12  CH-CREDIT-SELECT-DT               PIC XX.
  4977     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  4978     12  CH-PAYEE-CODE                     PIC X(6).
  4979
  4980     12  CH-VOID-DATA.
  4981         20  CH-VOID-DT                    PIC XX.
  4982         20  CH-VOID-BY                    PIC X(4).
  4983         20  CH-VOID-REASON                PIC X(25).
  4984
  4985     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  4986             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4987     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  4988
  4989     12  CH-CHECK-REFERENCE                PIC X(12).
  4990     12  CH-CHECK-ORIGIN-SW                PIC X.
  4991             88  CH-REFUND-CHECK              VALUE 'R'.
  4992             88  CH-MAINT-CHECK               VALUE 'M'.
  4993
  4994     12  CH-CANC-DT                        PIC XX.
  4995     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  4996     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  4997
  4998     12  CH-INSURED-NAME                   PIC X(28).
  4999
  5000     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  5001     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  5002
  5003     12  CH-LETTER-TABLE.
  5004         16  CH-LETTERS OCCURS 3 TIMES
  5005                        INDEXED BY CH-LT-NDX
  5006                                           PIC X(04).
  5007
  5008     12  FILLER                            PIC X(07).
  5009
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL689.cbl
  5011*    COPY ELCCNTL.
  5012******************************************************************
  5013*                                                                *
  5014*                                                                *
  5015*                            ELCCNTL.                            *
  5016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5017*                            VMOD=2.059                          *
  5018*                                                                *
  5019*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5020*                                                                *
  5021*   FILE TYPE = VSAM,KSDS                                        *
  5022*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5023*                                                                *
  5024*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5025*       ALTERNATE INDEX = NONE                                   *
  5026*                                                                *
  5027*   LOG = YES                                                    *
  5028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5029******************************************************************
  5030*                   C H A N G E   L O G
  5031*
  5032* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5033*-----------------------------------------------------------------
  5034*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5035* EFFECTIVE    NUMBER
  5036*-----------------------------------------------------------------
  5037* 082503                   PEMA  ADD BENEFIT GROUP
  5038* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5039* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5040* 092705    2005050300006  PEMA  ADD SPP LEASES
  5041* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5042* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5043* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5044* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5045* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5046* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5047******************************************************************
  5048*
  5049 01  CONTROL-FILE.
  5050     12  CF-RECORD-ID                       PIC XX.
  5051         88  VALID-CF-ID                        VALUE 'CF'.
  5052
  5053     12  CF-CONTROL-PRIMARY.
  5054         16  CF-COMPANY-ID                  PIC XXX.
  5055         16  CF-RECORD-TYPE                 PIC X.
  5056             88  CF-COMPANY-MASTER              VALUE '1'.
  5057             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5058             88  CF-STATE-MASTER                VALUE '3'.
  5059             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5060             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5061             88  CF-CARRIER-MASTER              VALUE '6'.
  5062             88  CF-MORTALITY-MASTER            VALUE '7'.
  5063             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5064             88  CF-TERMINAL-MASTER             VALUE '9'.
  5065             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5066             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5067             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5068             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL689.cbl
  5069             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5070             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5071             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5072             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5073             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5074         16  CF-ACCESS-CD-GENL              PIC X(4).
  5075         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5076             20  CF-PROCESSOR               PIC X(4).
  5077         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5078             20  CF-STATE-CODE              PIC XX.
  5079             20  FILLER                     PIC XX.
  5080         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5081             20  FILLER                     PIC XX.
  5082             20  CF-HI-BEN-IN-REC           PIC XX.
  5083         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5084             20  FILLER                     PIC XXX.
  5085             20  CF-CARRIER-CNTL            PIC X.
  5086         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5087             20  FILLER                     PIC XX.
  5088             20  CF-HI-TYPE-IN-REC          PIC 99.
  5089         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5090             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5091                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5092             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5093             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5094         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5095             20  FILLER                     PIC X.
  5096             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5097         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5098             20  FILLER                     PIC XX.
  5099             20  CF-MORTGAGE-PLAN           PIC XX.
  5100         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5101
  5102     12  CF-LAST-MAINT-DT                   PIC XX.
  5103     12  CF-LAST-MAINT-BY                   PIC X(4).
  5104     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5105
  5106     12  CF-RECORD-BODY                     PIC X(728).
  5107
  5108
  5109****************************************************************
  5110*             COMPANY MASTER RECORD                            *
  5111****************************************************************
  5112
  5113     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5114         16  CF-COMPANY-ADDRESS.
  5115             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5116             20  CF-CL-IN-CARE-OF           PIC X(30).
  5117             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5118             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5119             20  CF-CL-CITY-STATE           PIC X(30).
  5120             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5121             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5122         16  CF-COMPANY-CD                  PIC X.
  5123         16  CF-COMPANY-PASSWORD            PIC X(8).
  5124         16  CF-SECURITY-OPTION             PIC X.
  5125             88  ALL-SECURITY                   VALUE '1'.
  5126             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL689.cbl
  5127             88  PROCESSOR-VERIFY               VALUE '3'.
  5128             88  NO-SECURITY                    VALUE '4'.
  5129             88  ALL-BUT-TERM                   VALUE '5'.
  5130         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5131             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5132         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5133             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5134         16  CF-INFORCE-LOCATION            PIC X.
  5135             88  CERTS-ARE-ONLINE               VALUE '1'.
  5136             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5137             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5138         16  CF-LOWER-CASE-LETTERS          PIC X.
  5139         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5140             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5141             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5142             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5143             88  CF-ACCNT-CNTL                  VALUE '3'.
  5144             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5145
  5146         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5147         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5148
  5149         16  CF-LGX-CREDIT-USER             PIC X.
  5150             88  CO-IS-NOT-USER                 VALUE 'N'.
  5151             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5152
  5153         16 CF-CREDIT-CALC-CODES.
  5154             20  CF-CR-REM-TERM-CALC PIC X.
  5155               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5156               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5157               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5158               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5159               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5160               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5161               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5162             20  CF-CR-R78-METHOD           PIC X.
  5163               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5164               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5165
  5166         16  CF-CLAIM-CONTROL-COUNTS.
  5167             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5168                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5169
  5170             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5171                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5172
  5173             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5174                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5175
  5176             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5177                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5178
  5179         16  CF-CURRENT-MONTH-END           PIC XX.
  5180
  5181         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5182             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5183             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5184             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL689.cbl
  5185             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5186                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5187                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5188             20  CF-CO-PREM-REJECT-SW       PIC X.
  5189                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5190                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5191             20  CF-CO-REF-REJECT-SW        PIC X.
  5192                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5193                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5194
  5195         16  CF-CO-REPORTING-DT             PIC XX.
  5196         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5197         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5198           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5199           88  CF-CO-MONTH-END                  VALUE '1'.
  5200
  5201         16  CF-LGX-CLAIM-USER              PIC X.
  5202             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5203             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5204
  5205         16  CF-CREDIT-EDIT-CONTROLS.
  5206             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5207             20  CF-MIN-AGE                 PIC 99.
  5208             20  CF-DEFAULT-AGE             PIC 99.
  5209             20  CF-MIN-TERM                PIC S999      COMP-3.
  5210             20  CF-MAX-TERM                PIC S999      COMP-3.
  5211             20  CF-DEFAULT-SEX             PIC X.
  5212             20  CF-JOINT-AGE-INPUT         PIC X.
  5213                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5214             20  CF-BIRTH-DATE-INPUT        PIC X.
  5215                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5216             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5217                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5218                 88  CF-ZERO-CARRIER            VALUE '1'.
  5219                 88  CF-ZERO-GROUPING           VALUE '2'.
  5220                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5221             20  CF-EDIT-SW                 PIC X.
  5222                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5223             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5224             20  CF-CR-PR-METHOD            PIC X.
  5225               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5226               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5227             20  FILLER                     PIC X.
  5228
  5229         16  CF-CREDIT-MISC-CONTROLS.
  5230             20  CF-REIN-TABLE-SW           PIC X.
  5231                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5232             20  CF-COMP-TABLE-SW           PIC X.
  5233                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5234             20  CF-EXPERIENCE-RETENTION-AGE
  5235                                            PIC S9        COMP-3.
  5236             20  CF-CONVERSION-DT           PIC XX.
  5237             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5238             20  CF-RUN-FREQUENCY-SW        PIC X.
  5239                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5240                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5241
  5242             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL689.cbl
  5243                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5244                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5245                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5246                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5247                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5248                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5249
  5250                 24  CF-CR-CHECK-COUNT       REDEFINES
  5251                     CF-CR-CHECK-COUNTER      PIC X(4).
  5252
  5253                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5254                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5255
  5256                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5257                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5258                 24  CF-MAIL-PROCESSING       PIC X.
  5259                     88  MAIL-PROCESSING          VALUE 'Y'.
  5260
  5261         16  CF-MISC-SYSTEM-CONTROL.
  5262             20  CF-SYSTEM-C                 PIC X.
  5263                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5264             20  CF-SYSTEM-D                 PIC X.
  5265                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5266             20  CF-SOC-SEC-NO-SW            PIC X.
  5267                 88  SOC-SEC-NO-USED             VALUE '1'.
  5268             20  CF-MEMBER-NO-SW             PIC X.
  5269                 88  MEMBER-NO-USED              VALUE '1'.
  5270             20  CF-TAX-ID-NUMBER            PIC X(11).
  5271             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5272             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5273                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5274                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5275                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5276                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5277             20  CF-SYSTEM-E                 PIC X.
  5278                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5279
  5280         16  CF-LGX-LIFE-USER               PIC X.
  5281             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5282             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5283
  5284         16  CF-CR-MONTH-END-DT             PIC XX.
  5285
  5286         16  CF-FILE-MAINT-DATES.
  5287             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5288                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5289             20  CF-LAST-BATCH       REDEFINES
  5290                 CF-LAST-BATCH-NO               PIC X(4).
  5291             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5292             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5293             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5294             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5295             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5296             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5297             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5298             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5299             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5300             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL689.cbl
  5301
  5302         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5303         16  FILLER                         PIC X.
  5304
  5305         16  CF-ALT-MORT-CODE               PIC X(4).
  5306         16  CF-MEMBER-CAPTION              PIC X(10).
  5307
  5308         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5309             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5310             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5311             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5312             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5313             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5314
  5315         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5316
  5317         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5318         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5319         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5320         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5321
  5322         16  CF-AH-OVERRIDE-L1              PIC X.
  5323         16  CF-AH-OVERRIDE-L2              PIC XX.
  5324         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5325         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5326
  5327         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5328         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5329
  5330         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5331         16  CF-AR-LAST-EL860-DT            PIC XX.
  5332         16  CF-MP-MONTH-END-DT             PIC XX.
  5333
  5334         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5335         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5336             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5337
  5338         16  CF-AR-MONTH-END-DT             PIC XX.
  5339
  5340         16  CF-CRDTCRD-USER                PIC X.
  5341             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5342             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5343
  5344         16  CF-CC-MONTH-END-DT             PIC XX.
  5345
  5346         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5347
  5348         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5349             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5350             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5351             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5352         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5353         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5354         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5355         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5356             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5357             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5358         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL689.cbl
  5359         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5360         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5361             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5362         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5363
  5364         16  CF-CL-ZIP-CODE.
  5365             20  CF-CL-ZIP-PRIME.
  5366                 24  CF-CL-ZIP-1ST          PIC X.
  5367                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5368                 24  FILLER                 PIC X(4).
  5369             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5370         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5371             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5372             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5373             20  FILLER                     PIC XXX.
  5374
  5375         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5376         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5377         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5378         16  CF-CO-OPTION-START-DATE        PIC XX.
  5379         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5380           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5381                                                      '3' '4'.
  5382           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5383           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5384           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5385           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5386           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5387           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5388
  5389         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5390
  5391         16  CF-PAYMENT-APPROVAL-LEVELS.
  5392             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5393             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5394             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5395             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5396             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5397             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5398
  5399         16  CF-END-USER-REPORTING-USER     PIC X.
  5400             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5401             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5402
  5403         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5404             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5405             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5406
  5407         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5408
  5409         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5410         16  FILLER                         PIC X.
  5411
  5412         16  CF-CREDIT-ARCHIVE-CNTL.
  5413             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5414             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5415             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5416
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL689.cbl
  5417         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5418
  5419         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5420             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5421             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5422
  5423         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5424             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5425             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5426
  5427         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5428
  5429         16  CF-CO-ACH-ID-CODE              PIC  X.
  5430             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5431             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5432             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5433         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5434         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5435         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5436         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5437         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5438         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5439         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5440         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5441         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5442                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5443         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5444                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5445
  5446         16  CF-CO-OVER-SHORT.
  5447             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5448             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5449
  5450*         16  FILLER                         PIC X(102).
  5451         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5452             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5453             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5454
  5455         16  CF-AH-APPROVAL-DAYS.
  5456             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5457             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5458             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5459             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5460
  5461         16  FILLER                         PIC X(82).
  5462****************************************************************
  5463*             PROCESSOR/USER RECORD                            *
  5464****************************************************************
  5465
  5466     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5467         16  CF-PROCESSOR-NAME              PIC X(30).
  5468         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5469         16  CF-PROCESSOR-TITLE             PIC X(26).
  5470         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5471                 88  MESSAGE-YES                VALUE 'Y'.
  5472                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5473
  5474*****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL689.cbl
  5475****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5476****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5477****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5478****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5479*****************************************************
  5480
  5481         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5482             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5483             20  CF-APPLICATION-FORCE       PIC X.
  5484             20  CF-INDIVIDUAL-APP.
  5485                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5486                     28  CF-BROWSE-APP      PIC X.
  5487                     28  CF-UPDATE-APP      PIC X.
  5488
  5489         16  CF-CURRENT-TERM-ON             PIC X(4).
  5490         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5491             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5492             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5493             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5494             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5495             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5496             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5497             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5498         16  CF-PROCESSOR-CARRIER           PIC X.
  5499             88  NO-CARRIER-SECURITY            VALUE ' '.
  5500         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5501             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5502         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5503             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5504         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5505             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5506
  5507         16  CF-PROC-SYS-ACCESS-SW.
  5508             20  CF-PROC-CREDIT-CLAIMS-SW.
  5509                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5510                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5511                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5512                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5513             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5514                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5515                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5516             20  CF-PROC-LIFE-GNRLDGR-SW.
  5517                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5518                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5519                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5520                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5521             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5522                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5523                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5524         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5525             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5526             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5527         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5528
  5529         16  CF-APPROVAL-LEVEL                  PIC X.
  5530             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5531             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5532             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL689.cbl
  5533             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5534
  5535         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5536
  5537         16  CF-LANGUAGE-TYPE                   PIC X.
  5538             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5539             88  CF-LANG-IS-FR                      VALUE 'F'.
  5540
  5541         16  CF-CSR-IND                         PIC X.
  5542         16  FILLER                             PIC X(239).
  5543
  5544****************************************************************
  5545*             PROCESSOR/REMINDERS RECORD                       *
  5546****************************************************************
  5547
  5548     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5549         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5550             20  CF-START-REMIND-DT         PIC XX.
  5551             20  CF-END-REMIND-DT           PIC XX.
  5552             20  CF-REMINDER-TEXT           PIC X(50).
  5553         16  FILLER                         PIC X(296).
  5554
  5555
  5556****************************************************************
  5557*             STATE MASTER RECORD                              *
  5558****************************************************************
  5559
  5560     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5561         16  CF-STATE-ABBREVIATION          PIC XX.
  5562         16  CF-STATE-NAME                  PIC X(25).
  5563         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5564         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5565             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5566             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5567             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5568             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5569                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5570                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5571             20  CF-ST-PREM-REJECT-SW       PIC X.
  5572                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5573                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5574             20  CF-ST-REF-REJECT-SW        PIC X.
  5575                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5576                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5577         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5578         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5579         16  CF-ST-REFUND-RULES.
  5580             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5581             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5582             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5583         16  CF-ST-FST-PMT-EXTENSION.
  5584             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5585             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5586                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5587                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5588                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5589                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5590         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL689.cbl
  5591             20  CF-ST-CALL-UNEARNED        PIC X.
  5592             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5593             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5594         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5595             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5596             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5597         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5598         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5599         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5600         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5601         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5602         16  FILLER                         PIC X.
  5603         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5604             20  CF-ST-BENEFIT-CD           PIC XX.
  5605             20  CF-ST-BENEFIT-KIND         PIC X.
  5606                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5607                 88  CF-ST-AH-KIND              VALUE 'A'.
  5608             20  CF-ST-REM-TERM-CALC        PIC X.
  5609                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5610                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5611                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5612                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5613                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5614                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5615                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5616                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5617
  5618             20  CF-ST-REFUND-CALC          PIC X.
  5619                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5620                 88  ST-REFD-BY-R78             VALUE '1'.
  5621                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5622                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5623                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5624                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5625                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5626                 88  ST-REFD-UTAH               VALUE '7'.
  5627                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5628                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5629                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5630
  5631             20  CF-ST-EARNING-CALC         PIC X.
  5632                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5633                 88  ST-EARN-BY-R78             VALUE '1'.
  5634                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5635                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5636                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5637                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5638                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5639                 88  ST-EARN-MEAN               VALUE '8'.
  5640                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5641
  5642             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5643                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5644                 88  ST-OVRD-BY-R78             VALUE '1'.
  5645                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5646                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5647                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5648                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL689.cbl
  5649                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5650                 88  ST-OVRD-MEAN               VALUE '8'.
  5651                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5652             20  FILLER                     PIC X.
  5653
  5654         16  CF-ST-COMMISSION-CAPS.
  5655             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5656             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5657             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5658             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5659         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5660                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5661
  5662         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5663
  5664         16  CF-ST-STATUTORY-INTEREST.
  5665             20  CF-ST-STAT-DATE-FROM       PIC X.
  5666                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5667                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5668             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5669             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5670             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5671             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5672             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5673
  5674         16  CF-ST-OVER-SHORT.
  5675             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5676             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5677
  5678         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5679
  5680         16  CF-ST-RT-CALC                  PIC X.
  5681
  5682         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5683         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5684         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5685         16  CF-ST-RF-LR-CALC               PIC X.
  5686         16  CF-ST-RF-LL-CALC               PIC X.
  5687         16  CF-ST-RF-LN-CALC               PIC X.
  5688         16  CF-ST-RF-AH-CALC               PIC X.
  5689         16  CF-ST-RF-CP-CALC               PIC X.
  5690*        16  FILLER                         PIC X(206).
  5691*CIDMOD         16  FILLER                         PIC X(192).
  5692         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5693             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5694         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5695         16  CF-ST-VFY-2ND-BENE             PIC X.
  5696         16  FILLER                         PIC X(186).
  5697
  5698****************************************************************
  5699*             BENEFIT MASTER RECORD                            *
  5700****************************************************************
  5701
  5702     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5703         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5704             20  CF-BENEFIT-CODE            PIC XX.
  5705             20  CF-BENEFIT-NUMERIC  REDEFINES
  5706                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL689.cbl
  5707             20  CF-BENEFIT-ALPHA           PIC XXX.
  5708             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5709             20  CF-BENEFIT-COMMENT         PIC X(10).
  5710
  5711             20  CF-LF-COVERAGE-TYPE        PIC X.
  5712                 88  CF-REDUCING                VALUE 'R'.
  5713                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5714
  5715             20  CF-SPECIAL-CALC-CD         PIC X.
  5716                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5717                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5718                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5719                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5720                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5721                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5722                 88  CF-FARM-PLAN               VALUE 'F'.
  5723                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5724                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5725                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5726                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5727                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5728                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5729                 88  CF-PRUDENTIAL              VALUE 'P'.
  5730                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5731                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5732                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5733                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5734                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5735                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5736
  5737             20  CF-JOINT-INDICATOR         PIC X.
  5738                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5739
  5740*            20  FILLER                     PIC X(12).
  5741             20  FILLER                     PIC X(11).
  5742             20  CF-BENEFIT-CATEGORY        PIC X.
  5743             20  CF-LOAN-TYPE               PIC X(8).
  5744
  5745             20  CF-CO-REM-TERM-CALC        PIC X.
  5746                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5747                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5748                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5749                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5750                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5751
  5752             20  CF-CO-EARNINGS-CALC        PIC X.
  5753                 88  CO-EARN-BY-R78             VALUE '1'.
  5754                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5755                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5756                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5757                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5758                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5759                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5760                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5761
  5762             20  CF-CO-REFUND-CALC          PIC X.
  5763                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5764                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL689.cbl
  5765                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5766                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5767                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5768                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5769                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5770                 88  CO-REFD-MEAN               VALUE '8'.
  5771                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5772                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5773                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5774
  5775             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5776                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5777                 88  CO-OVRD-BY-R78             VALUE '1'.
  5778                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5779                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5780                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5781                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5782                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5783                 88  CO-OVRD-MEAN               VALUE '8'.
  5784                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5785
  5786             20  CF-CO-BEN-I-G-CD           PIC X.
  5787                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5788                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5789                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5790
  5791         16  FILLER                         PIC X(304).
  5792
  5793
  5794****************************************************************
  5795*             CARRIER MASTER RECORD                            *
  5796****************************************************************
  5797
  5798     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5799         16  CF-ADDRESS-DATA.
  5800             20  CF-MAIL-TO-NAME            PIC X(30).
  5801             20  CF-IN-CARE-OF              PIC X(30).
  5802             20  CF-ADDRESS-LINE-1          PIC X(30).
  5803             20  CF-ADDRESS-LINE-2          PIC X(30).
  5804             20  CF-CITY-STATE              PIC X(30).
  5805             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5806             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5807
  5808         16  CF-CLAIM-NO-CONTROL.
  5809             20  CF-CLAIM-NO-METHOD         PIC X.
  5810                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5811                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5812                 88  CLAIM-NO-SEQ               VALUE '3'.
  5813                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5814             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5815                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5816                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5817                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5818
  5819         16  CF-CHECK-NO-CONTROL.
  5820             20  CF-CHECK-NO-METHOD         PIC X.
  5821                 88  CHECK-NO-MANUAL            VALUE '1'.
  5822                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL689.cbl
  5823                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5824                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5825             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5826                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5827
  5828         16  CF-DOMICILE-STATE              PIC XX.
  5829
  5830         16  CF-EXPENSE-CONTROLS.
  5831             20  CF-EXPENSE-METHOD          PIC X.
  5832                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5833                 88  DOLLARS-PER-PMT            VALUE '2'.
  5834                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5835                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5836             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5837             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5838
  5839         16  CF-CORRESPONDENCE-CONTROL.
  5840             20  CF-LETTER-RESEND-OPT       PIC X.
  5841                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5842                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5843             20  FILLER                     PIC X(4).
  5844
  5845         16  CF-RESERVE-CONTROLS.
  5846             20  CF-MANUAL-SW               PIC X.
  5847                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5848             20  CF-FUTURE-SW               PIC X.
  5849                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5850             20  CF-PTC-SW                  PIC X.
  5851                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5852             20  CF-IBNR-SW                 PIC X.
  5853                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5854             20  CF-PTC-LF-SW               PIC X.
  5855                 88  CF-LF-PTC-USED             VALUE '1'.
  5856             20  CF-CDT-ACCESS-METHOD       PIC X.
  5857                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5858                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5859                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5860             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5861
  5862         16  CF-CLAIM-CALC-METHOD           PIC X.
  5863             88  360-PLUS-MONTHS                VALUE '1'.
  5864             88  365-PLUS-MONTHS                VALUE '2'.
  5865             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5866             88  360-DAILY                      VALUE '4'.
  5867             88  365-DAILY                      VALUE '5'.
  5868
  5869         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5870         16  FILLER                         PIC X(11).
  5871
  5872         16  CF-LIMIT-AMOUNTS.
  5873             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5874             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5875             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5876             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5877             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5878             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5879             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5880             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL689.cbl
  5881             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5882             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5883
  5884         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5885         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5886         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5887
  5888         16  CF-ZIP-CODE.
  5889             20  CF-ZIP-PRIME.
  5890                 24  CF-ZIP-1ST             PIC X.
  5891                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5892                 24  FILLER                 PIC X(4).
  5893             20  CF-ZIP-PLUS4               PIC X(4).
  5894         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5895             20  CF-CAN-POSTAL-1            PIC XXX.
  5896             20  CF-CAN-POSTAL-2            PIC XXX.
  5897             20  FILLER                     PIC XXX.
  5898
  5899         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5900         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5901         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5902
  5903         16  CF-RATING-SWITCH               PIC X.
  5904             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5905             88  CF-NO-RATING                   VALUE 'N'.
  5906
  5907         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5908
  5909         16  CF-CARRIER-OVER-SHORT.
  5910             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5911             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5912
  5913         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5914         16  CF-SECPAY-SWITCH               PIC X.
  5915             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5916             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5917         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5918         16  FILLER                         PIC X(448).
  5919*        16  FILLER                         PIC X(452).
  5920
  5921
  5922****************************************************************
  5923*             MORTALITY MASTER RECORD                          *
  5924****************************************************************
  5925
  5926     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5927         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5928                                INDEXED BY CF-MORT-NDX.
  5929             20  CF-MORT-TABLE              PIC X(5).
  5930             20  CF-MORT-TABLE-TYPE         PIC X.
  5931                 88  CF-MORT-JOINT              VALUE 'J'.
  5932                 88  CF-MORT-SINGLE             VALUE 'S'.
  5933                 88  CF-MORT-COMBINED           VALUE 'C'.
  5934                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5935                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5936             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5937             20  CF-MORT-AGE-METHOD         PIC XX.
  5938                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL689.cbl
  5939                 88  CF-AGE-NEAR                VALUE 'AN'.
  5940             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5941             20  CF-MORT-ADJUSTMENT-DIRECTION
  5942                                            PIC X.
  5943                 88  CF-MINUS                   VALUE '-'.
  5944                 88  CF-PLUS                    VALUE '+'.
  5945             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5946             20  CF-MORT-JOINT-CODE         PIC X.
  5947                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5948             20  CF-MORT-PC-Q               PIC X.
  5949                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5950             20  CF-MORT-TABLE-CODE         PIC X(4).
  5951             20  CF-MORT-COMMENTS           PIC X(15).
  5952             20  FILLER                     PIC X(14).
  5953
  5954         16  FILLER                         PIC X(251).
  5955
  5956
  5957****************************************************************
  5958*             BUSSINESS TYPE MASTER RECORD                     *
  5959****************************************************************
  5960
  5961     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5962* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5963* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5964* AND RECORD 05 IS TYPES 81-99
  5965         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5966             20  CF-BUSINESS-TITLE          PIC  X(19).
  5967             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5968                                            PIC S9V9(4) COMP-3.
  5969             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5970             20  FILLER                     PIC  X.
  5971         16  FILLER                         PIC  X(248).
  5972
  5973
  5974****************************************************************
  5975*             TERMINAL MASTER RECORD                           *
  5976****************************************************************
  5977
  5978     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5979
  5980         16  CF-COMPANY-TERMINALS.
  5981             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5982                                  PIC X(4).
  5983         16  FILLER               PIC X(248).
  5984
  5985
  5986****************************************************************
  5987*             LIFE EDIT MASTER RECORD                          *
  5988****************************************************************
  5989
  5990     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5991         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5992             20  CF-LIFE-CODE-IN            PIC XX.
  5993             20  CF-LIFE-CODE-OUT           PIC XX.
  5994         16  FILLER                         PIC X(248).
  5995
  5996
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL689.cbl
  5997****************************************************************
  5998*             AH EDIT MASTER RECORD                            *
  5999****************************************************************
  6000
  6001     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6002         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6003             20  CF-AH-CODE-IN              PIC XXX.
  6004             20  CF-AH-CODE-OUT             PIC XX.
  6005         16  FILLER                         PIC X(248).
  6006
  6007
  6008****************************************************************
  6009*             CREDIBILITY TABLES                               *
  6010****************************************************************
  6011
  6012     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6013         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6014                             INDEXED BY CF-CRDB-NDX.
  6015             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6016             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6017             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6018         16  FILLER                         PIC  X(332).
  6019
  6020
  6021****************************************************************
  6022*             REPORT CUSTOMIZATION RECORD                      *
  6023****************************************************************
  6024
  6025     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6026         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6027             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6028             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6029             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6030**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6031****       A T-TRANSFER.                                   ****
  6032             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6033
  6034         16  FILLER                         PIC XX.
  6035
  6036         16  CF-CARRIER-CNTL-OPT.
  6037             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6038                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6039                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6040             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6041                                            PIC X.
  6042         16  CF-GROUP-CNTL-OPT.
  6043             20  CF-GROUP-OPT-SEQ           PIC 9.
  6044                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6045                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6046             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6047                                            PIC X(6).
  6048         16  CF-STATE-CNTL-OPT.
  6049             20  CF-STATE-OPT-SEQ           PIC 9.
  6050                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6051                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6052             20  CF-STATE-SELECT OCCURS 3 TIMES
  6053                                            PIC XX.
  6054         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL689.cbl
  6055             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6056                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6057                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6058             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6059                                            PIC X(10).
  6060         16  CF-BUS-TYP-CNTL-OPT.
  6061             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6062                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6063                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6064             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6065                                            PIC XX.
  6066         16  CF-LF-TYP-CNTL-OPT.
  6067             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6068                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6069                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6070             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6071                                            PIC XX.
  6072         16  CF-AH-TYP-CNTL-OPT.
  6073             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6074                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6075                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6076             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6077                                            PIC XX.
  6078         16  CF-REPTCD1-CNTL-OPT.
  6079             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6080                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6081                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6082             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6083                                            PIC X(10).
  6084         16  CF-REPTCD2-CNTL-OPT.
  6085             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6086                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6087                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6088             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6089                                            PIC X(10).
  6090         16  CF-USER1-CNTL-OPT.
  6091             20  CF-USER1-OPT-SEQ           PIC 9.
  6092                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6093                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6094             20  CF-USER1-SELECT OCCURS 3 TIMES
  6095                                            PIC X(10).
  6096         16  CF-USER2-CNTL-OPT.
  6097             20  CF-USER2-OPT-SEQ           PIC 9.
  6098                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6099                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6100             20  CF-USER2-SELECT OCCURS 3 TIMES
  6101                                            PIC X(10).
  6102         16  CF-USER3-CNTL-OPT.
  6103             20  CF-USER3-OPT-SEQ           PIC 9.
  6104                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6105                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6106             20  CF-USER3-SELECT OCCURS 3 TIMES
  6107                                            PIC X(10).
  6108         16  CF-USER4-CNTL-OPT.
  6109             20  CF-USER4-OPT-SEQ           PIC 9.
  6110                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6111                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6112             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL689.cbl
  6113                                            PIC X(10).
  6114         16  CF-USER5-CNTL-OPT.
  6115             20  CF-USER5-OPT-SEQ           PIC 9.
  6116                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6117                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6118             20  CF-USER5-SELECT OCCURS 3 TIMES
  6119                                            PIC X(10).
  6120         16  CF-REINS-CNTL-OPT.
  6121             20  CF-REINS-OPT-SEQ           PIC 9.
  6122                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6123                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6124             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6125                 24  CF-REINS-PRIME         PIC XXX.
  6126                 24  CF-REINS-SUB           PIC XXX.
  6127
  6128         16  CF-AGENT-CNTL-OPT.
  6129             20  CF-AGENT-OPT-SEQ           PIC 9.
  6130                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6131                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6132             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6133                                            PIC X(10).
  6134
  6135         16  FILLER                         PIC X(43).
  6136
  6137         16  CF-LOSS-RATIO-SELECT.
  6138             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6139             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6140         16  CF-ENTRY-DATE-SELECT.
  6141             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6142             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6143         16  CF-EFFECTIVE-DATE-SELECT.
  6144             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6145             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6146
  6147         16  CF-EXCEPTION-LIST-IND          PIC X.
  6148             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6149
  6150         16  FILLER                         PIC X(318).
  6151
  6152****************************************************************
  6153*                  EXCEPTION REPORTING RECORD                  *
  6154****************************************************************
  6155
  6156     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6157         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6158             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6159
  6160         16  CF-COMBINED-LIFE-AH-OPT.
  6161             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6162             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6163             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6164             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6165
  6166         16  CF-LIFE-OPT.
  6167             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6168             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6169             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6170             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL689.cbl
  6171             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6172             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6173             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6174             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6175             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6176             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6177
  6178         16  CF-AH-OPT.
  6179             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6180             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6181             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6182             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6183             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6184             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6185             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6186             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6187             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6188             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6189
  6190         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6191             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6192             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6193             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6194
  6195         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6196
  6197         16  FILLER                         PIC X(673).
  6198
  6199
  6200****************************************************************
  6201*             MORTGAGE SYSTEM PLAN RECORD                      *
  6202****************************************************************
  6203
  6204     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6205         16  CF-PLAN-TYPE                   PIC X.
  6206             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6207             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6208             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6209         16  CF-PLAN-ABBREV                 PIC XXX.
  6210         16  CF-PLAN-DESCRIPT               PIC X(10).
  6211         16  CF-PLAN-NOTES                  PIC X(20).
  6212         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6213         16  CF-PLAN-UNDERWRITING.
  6214             20  CF-PLAN-TERM-DATA.
  6215                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6216                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6217             20  CF-PLAN-AGE-DATA.
  6218                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6219                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6220                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6221             20  CF-PLAN-BENEFIT-DATA.
  6222                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6223                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6224                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6225                                            PIC S9(7)V99  COMP-3.
  6226         16  CF-PLAN-POLICY-FORMS.
  6227             20  CF-POLICY-FORM             PIC X(12).
  6228             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL689.cbl
  6229             20  CF-MASTER-POLICY           PIC X(12).
  6230         16  CF-PLAN-RATING.
  6231             20  CF-RATE-CODE               PIC X(5).
  6232             20  CF-SEX-RATING              PIC X.
  6233                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6234                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6235             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6236             20  CF-SUB-STD-TYPE            PIC X.
  6237                 88  CF-PCT-OF-PREM            VALUE '1'.
  6238                 88  CF-PCT-OF-BENE            VALUE '2'.
  6239         16  CF-PLAN-PREM-TOLERANCES.
  6240             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6241             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6242         16  CF-PLAN-PYMT-TOLERANCES.
  6243             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6244             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6245         16  CF-PLAN-MISC-DATA.
  6246             20  FILLER                     PIC X.
  6247             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6248             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6249         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6250         16  CF-PLAN-IND-GRP                PIC X.
  6251             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6252                                                     '1'.
  6253             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6254                                                     '2'.
  6255         16  CF-MIB-SEARCH-SW               PIC X.
  6256             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6257             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6258             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6259             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6260         16  CF-ALPHA-SEARCH-SW             PIC X.
  6261             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6262             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6263             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6264             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6265             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6266             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6267             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6268             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6269             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6270             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6271                                                     'A' 'B' 'C'
  6272                                                     'X' 'Y' 'Z'.
  6273         16  CF-EFF-DT-RULE-SW              PIC X.
  6274             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6275             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6276             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6277             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6278             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6279         16  FILLER                         PIC X(4).
  6280         16  CF-HEALTH-QUESTIONS            PIC X.
  6281             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6282         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6283         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6284         16  CF-PLAN-SNGL-JNT               PIC X.
  6285             88  CF-COMBINED-PLAN              VALUE 'C'.
  6286             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL689.cbl
  6287             88  CF-SNGL-PLAN                  VALUE 'S'.
  6288         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6289         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6290         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6291         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6292         16  CF-RERATE-CNTL                 PIC  X.
  6293             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6294             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6295             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6296             88  CF-AUTO-RECALC                 VALUE '4'.
  6297         16  CF-BENEFIT-TYPE                PIC  X.
  6298             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6299             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6300         16  CF-POLICY-FEE                  PIC S999V99
  6301                                                    COMP-3.
  6302         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6303         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6304         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6305         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6306         16  FILLER                         PIC  X(32).
  6307         16  CF-TERMINATION-FORM            PIC  X(04).
  6308         16  FILLER                         PIC  X(08).
  6309         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6310                                                       COMP-3.
  6311         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6312         16  CF-ISSUE-LETTER                PIC  X(4).
  6313         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6314         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6315             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6316             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6317         16  CF-MP-REFUND-CALC              PIC X.
  6318             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6319             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6320             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6321             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6322             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6323             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6324             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6325             88  CF-MP-REFD-MEAN                VALUE '8'.
  6326         16  CF-ALT-RATE-CODE               PIC  X(5).
  6327
  6328
  6329         16  FILLER                         PIC X(498).
  6330****************************************************************
  6331*             MORTGAGE COMPANY MASTER RECORD                   *
  6332****************************************************************
  6333
  6334     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6335         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6336         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6337             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6338             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6339             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6340             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6341             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6342
  6343         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6344         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL689.cbl
  6345         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6346         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6347         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6348
  6349         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6350             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6351         16  CF-MP-RECON-USE-IND            PIC X(1).
  6352             88  CF-MP-USE-RECON             VALUE 'Y'.
  6353         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6354             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6355         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6356             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6357             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6358         16  FILLER                         PIC X(1).
  6359         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6360             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6361         16  CF-MORTG-MIB-VERSION           PIC X.
  6362             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6363             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6364             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6365         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6366             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6367                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6368             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6369                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6370             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6371                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6372             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6373                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6374             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6375                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6376             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6377                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6378         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6379         16  FILLER                         PIC X(7).
  6380         16  CF-MORTG-DESTINATION-SYMBOL.
  6381             20  CF-MORTG-MIB-COMM          PIC X(5).
  6382             20  CF-MORTG-MIB-TERM          PIC X(5).
  6383         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6384             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6385         16  FILLER                         PIC X(03).
  6386         16  CF-MP-CHECK-NO-CONTROL.
  6387             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6388                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6389                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6390                                                ' ' LOW-VALUES.
  6391                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6392                                               VALUE '3'.
  6393         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6394         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6395         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6396             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6397                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6398             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6399                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6400             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6401                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6402             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL689.cbl
  6403                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6404             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6405                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6406             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6407                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6408         16  CF-MORTG-BILLING-AREA.
  6409             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6410                                            PIC X.
  6411         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6412         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6413         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6414         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6415             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6416             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6417         16  FILLER                         PIC X.
  6418         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6419             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6420             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6421         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6422         16  FILLER                         PIC X(8).
  6423         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6424         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6425         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6426         16  CF-ACH-COMPANY-ID.
  6427             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6428                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6429                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6430                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6431             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6432         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6433             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6434         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6435             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6436             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6437         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6438         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6439         16  FILLER                         PIC X(536).
  6440
  6441****************************************************************
  6442*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6443****************************************************************
  6444
  6445     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6446         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6447             20  CF-FEMALE-HEIGHT.
  6448                 24  CF-FEMALE-FT           PIC 99.
  6449                 24  CF-FEMALE-IN           PIC 99.
  6450             20  CF-FEMALE-MIN-WT           PIC 999.
  6451             20  CF-FEMALE-MAX-WT           PIC 999.
  6452         16  FILLER                         PIC X(428).
  6453
  6454     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6455         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6456             20  CF-MALE-HEIGHT.
  6457                 24  CF-MALE-FT             PIC 99.
  6458                 24  CF-MALE-IN             PIC 99.
  6459             20  CF-MALE-MIN-WT             PIC 999.
  6460             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL689.cbl
  6461         16  FILLER                         PIC X(428).
  6462******************************************************************
  6463*             AUTOMATIC ACTIVITY RECORD                          *
  6464******************************************************************
  6465     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6466         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6467             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6468             20  CF-SYS-LETTER-ID           PIC X(04).
  6469             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6470             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6471             20  CF-SYS-RESET-SW            PIC X(01).
  6472             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6473             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6474
  6475         16  FILLER                         PIC X(50).
  6476
  6477         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6478             20  CF-USER-ACTIVE-SW          PIC X(01).
  6479             20  CF-USER-LETTER-ID          PIC X(04).
  6480             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6481             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6482             20  CF-USER-RESET-SW           PIC X(01).
  6483             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6484             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6485             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6486
  6487         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL689.cbl
  6489*    COPY ERCCOMP.
  6490******************************************************************
  6491*                                                                *
  6492*                                                                *
  6493*                            ERCCOMP                             *
  6494*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6495*                            VMOD=2.019                          *
  6496*                                                                *
  6497*   ONLINE CREDIT SYSTEM                                         *
  6498*                                                                *
  6499*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6500*                                                                *
  6501*   FILE TYPE = VSAM,KSDS                                        *
  6502*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6503*                                                                *
  6504*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6505*       ALTERNATE PATH = NONE                                    *
  6506*                                                                *
  6507*   LOG = NO                                                     *
  6508*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6509*                                                                *
  6510******************************************************************
  6511*                   C H A N G E   L O G
  6512*
  6513* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6514*-----------------------------------------------------------------
  6515*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6516* EFFECTIVE    NUMBER
  6517*-----------------------------------------------------------------
  6518* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6519* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6520* 092205    2005050300006  PEMA  ADD LEASE FEE
  6521* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6522* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6523* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6524* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6525* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6526* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6527******************************************************************
  6528
  6529 01  COMPENSATION-MASTER.
  6530     12  CO-RECORD-ID                          PIC XX.
  6531         88  VALID-CO-ID                          VALUE 'CO'.
  6532
  6533     12  CO-CONTROL-PRIMARY.
  6534         16  CO-COMPANY-CD                     PIC X.
  6535         16  CO-CONTROL.
  6536             20  CO-CTL-1.
  6537                 24  CO-CARR-GROUP.
  6538                     28  CO-CARRIER            PIC X.
  6539                     28  CO-GROUPING.
  6540                         32  CO-GROUP-PREFIX   PIC XXX.
  6541                         32  CO-GROUP-PRIME    PIC XXX.
  6542                 24  CO-RESP-NO.
  6543                     28  CO-RESP-PREFIX        PIC X(4).
  6544                     28  CO-RESP-PRIME         PIC X(6).
  6545             20  CO-CTL-2.
  6546                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL689.cbl
  6547                     28  CO-ACCT-PREFIX        PIC X(4).
  6548                     28  CO-ACCT-PRIME         PIC X(6).
  6549         16  CO-TYPE                           PIC X.
  6550             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6551             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6552             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6553
  6554     12  CO-MAINT-INFORMATION.
  6555         16  CO-LAST-MAINT-DT                  PIC XX.
  6556         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6557         16  CO-LAST-MAINT-USER                PIC X(4).
  6558     12  FILLER                                PIC XX.
  6559     12  CO-STMT-TYPE                          PIC XXX.
  6560     12  CO-COMP-TYPE                          PIC X.
  6561         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6562     12  CO-STMT-OWNER                         PIC X(4).
  6563     12  CO-BALANCE-CONTROL                    PIC X.
  6564         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6565         88  CO-NO-BALANCE                        VALUE 'N'.
  6566
  6567     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6568         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6569         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6570         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6571
  6572     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6573         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6574         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6575
  6576     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6577     12  CO-GA-DIRECT-DEP                      PIC X.
  6578     12  CO-FUTURE-SPACE                       PIC X.
  6579         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6580
  6581     12  CO-ACCT-NAME                          PIC X(30).
  6582     12  CO-MAIL-NAME                          PIC X(30).
  6583     12  CO-ADDR-1                             PIC X(30).
  6584     12  CO-ADDR-2                             PIC X(30).
  6585     12  CO-ADDR-3.
  6586         16  CO-ADDR-CITY                      PIC X(27).
  6587         16  CO-ADDR-STATE                     PIC XX.
  6588     12  CO-CSO-1099                           PIC X.
  6589     12  CO-ZIP.
  6590         16  CO-ZIP-PRIME.
  6591             20  CO-ZIP-PRI-1ST                PIC X.
  6592                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6593             20  FILLER                        PIC X(4).
  6594         16  CO-ZIP-PLUS4                      PIC X(4).
  6595     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6596         16  CO-CAN-POSTAL-1                   PIC XXX.
  6597         16  CO-CAN-POSTAL-2                   PIC XXX.
  6598         16  FILLER                            PIC XXX.
  6599     12  CO-SOC-SEC                            PIC X(13).
  6600     12  CO-TELEPHONE.
  6601         16  CO-AREA-CODE                      PIC XXX.
  6602         16  CO-PREFIX                         PIC XXX.
  6603         16  CO-PHONE                          PIC X(4).
  6604
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL689.cbl
  6605     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6606
  6607     12  CO-AR-BAL-LEVEL                       PIC X.
  6608         88  CO-AR-REF-LVL                        VALUE '1'.
  6609         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6610         88  CO-AR-BILL-LVL                       VALUE '2'.
  6611         88  CO-AR-AGT-LVL                        VALUE '3'.
  6612         88  CO-AR-FR-LVL                         VALUE '4'.
  6613
  6614     12  CO-AR-NORMAL-PRINT                    PIC X.
  6615         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6616         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6617
  6618     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6619
  6620     12  CO-AR-REPORTING                       PIC X.
  6621         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6622         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6623
  6624     12  CO-AR-PULL-CHECK                      PIC X.
  6625         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6626         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6627
  6628     12  CO-AR-BALANCE-PRINT                   PIC X.
  6629         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6630
  6631     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6632         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6633         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6634         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6635
  6636     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6637
  6638     12  CO-USER-CODE                          PIC X.
  6639     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6640
  6641******************************************************************
  6642*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6643*    THE LAST MONTH END RUN.
  6644******************************************************************
  6645
  6646     12  CO-LAST-ACTIVITY-DATE.
  6647         16  CO-ACT-YEAR                       PIC 99.
  6648         16  CO-ACT-MONTH                      PIC 99.
  6649         16  CO-ACT-DAY                        PIC 99.
  6650
  6651     12  CO-LAST-STMT-DT.
  6652         16  CO-LAST-STMT-YEAR                 PIC 99.
  6653         16  CO-LAST-STMT-MONTH                PIC 99.
  6654         16  CO-LAST-STMT-DAY                  PIC 99.
  6655
  6656     12  CO-MO-END-TOTALS.
  6657         16  CO-MONTHLY-TOTALS.
  6658             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6659             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6660             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6661             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6662             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL689.cbl
  6663
  6664         16  CO-AGING-TOTALS.
  6665             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6666             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6667             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6668             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6669
  6670         16  CO-YTD-TOTALS.
  6671             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6672             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6673
  6674         16  CO-OVER-UNDER-TOTALS.
  6675             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6676             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6677
  6678     12  CO-MISCELLANEOUS-TOTALS.
  6679         16  CO-FICA-TOTALS.
  6680             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6681             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6682
  6683         16  CO-CLAIM-TOTALS.
  6684             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6685             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6686
  6687******************************************************************
  6688*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6689*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6690******************************************************************
  6691
  6692     12  CO-CURRENT-TOTALS.
  6693         16  CO-CURRENT-LAST-STMT-DT.
  6694             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6695             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6696             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6697
  6698         16  CO-CURRENT-MONTHLY-TOTALS.
  6699             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6700             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6701             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6702             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6703             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6704
  6705         16  CO-CURRENT-AGING-TOTALS.
  6706             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6707             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6708             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6709             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6710
  6711         16  CO-CURRENT-YTD-TOTALS.
  6712             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6713             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6714
  6715     12  CO-PAID-COMM-TOTALS.
  6716         16  CO-YTD-PAID-COMMS.
  6717             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6718             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6719
  6720     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL689.cbl
  6721         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6722         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6723
  6724     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6725         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6726         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6727         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6728         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6729         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6730         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6731         88  CO-FINAL-LETTER                  VALUE 'F'.
  6732         88  CO-RECONCILING                   VALUE 'R'.
  6733         88  CO-PHONE-CALL                    VALUE 'P'.
  6734         88  CO-LEGAL                         VALUE 'L'.
  6735         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6736         88  CO-WRITE-OFF                     VALUE 'W'.
  6737         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6738
  6739     12  CO-CSR-CODE                       PIC X(4).
  6740
  6741     12  CO-GA-STATUS-INFO.
  6742         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6743         16  CO-GA-TERMINATION-DT          PIC XX.
  6744         16  CO-GA-STATUS-CODE             PIC X.
  6745             88  CO-GA-ACTIVE                 VALUE 'A'.
  6746             88  CO-GA-INACTIVE               VALUE 'I'.
  6747             88  CO-GA-PENDING                VALUE 'P'.
  6748         16  CO-GA-COMMENTS.
  6749             20  CO-GA-COMMENT-1           PIC X(40).
  6750             20  CO-GA-COMMENT-2           PIC X(40).
  6751             20  CO-GA-COMMENT-3           PIC X(40).
  6752             20  CO-GA-COMMENT-4           PIC X(40).
  6753
  6754     12  CO-RPTCD2                         PIC X(10).
  6755     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6756         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6757         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6758
  6759     12  CO-TYPE-AGENT                     PIC X(01).
  6760         88  CO-CORPORATION                   VALUE 'C'.
  6761         88  CO-PARTNERSHIP                   VALUE 'P'.
  6762         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6763         88  CO-TRUST                         VALUE 'T'.
  6764         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6765
  6766     12  CO-FAXNO.
  6767         16  CO-FAX-AREA-CODE                  PIC XXX.
  6768         16  CO-FAX-PREFIX                     PIC XXX.
  6769         16  CO-FAX-PHONE                      PIC X(4).
  6770
  6771     12  CO-BANK-INFORMATION.
  6772         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6773         16  CO-BANK-TRANSIT-NON REDEFINES
  6774             CO-BANK-TRANSIT-NO                PIC 9(8).
  6775
  6776         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6777     12  CO-MISC-DEDUCT-INFO REDEFINES
  6778                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL689.cbl
  6779         16  CO-MD-GL-ACCT                     PIC X(10).
  6780         16  CO-MD-DIV                         PIC XX.
  6781         16  CO-MD-CENTER                      PIC X(4).
  6782         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6783         16  CO-CREATE-AP-CHECK                PIC X.
  6784         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6785         16  FILLER                            PIC XXX.
  6786     12  CO-ACH-STATUS                         PIC X.
  6787         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6788         88  CO-ACH-PENDING                        VALUE 'P'.
  6789
  6790     12  CO-BILL-SW                            PIC X.
  6791     12  CO-CONTROL-NAME                       PIC X(30).
  6792     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6793     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6794     12  CO-CLP-STATE                          PIC XX.
  6795     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6796     12  CO-SPP-REFUND-EDIT                    PIC X.
  6797
  6798******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL689.cbl
  6800*    COPY ERCMAIL.
  6801******************************************************************
  6802*                                                                *
  6803*                                                                *
  6804*                            ERCMAIL                             *
  6805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6806*                            VMOD=2.003                          *
  6807*                                                                *
  6808*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6809*                                                                *
  6810*   FILE TYPE = VSAM,KSDS                                        *
  6811*   RECORD SIZE = 374   RECFORM = FIX                            *
  6812*                                                                *
  6813*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6814*   ALTERNATE PATH    = NOT USED                                 *
  6815*                                                                *
  6816*   LOG = YES                                                    *
  6817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6818******************************************************************
  6819*                   C H A N G E   L O G
  6820*
  6821* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6822*-----------------------------------------------------------------
  6823*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6824* EFFECTIVE    NUMBER
  6825*-----------------------------------------------------------------
  6826* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6827* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6828* 111108                   PEMA  ADD CRED BENE ADDR2
  6829******************************************************************
  6830
  6831 01  MAILING-DATA.
  6832     12  MA-RECORD-ID                      PIC XX.
  6833         88  VALID-MA-ID                       VALUE 'MA'.
  6834
  6835     12  MA-CONTROL-PRIMARY.
  6836         16  MA-COMPANY-CD                 PIC X.
  6837         16  MA-CARRIER                    PIC X.
  6838         16  MA-GROUPING.
  6839             20  MA-GROUPING-PREFIX        PIC XXX.
  6840             20  MA-GROUPING-PRIME         PIC XXX.
  6841         16  MA-STATE                      PIC XX.
  6842         16  MA-ACCOUNT.
  6843             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6844             20  MA-ACCOUNT-PRIME          PIC X(6).
  6845         16  MA-CERT-EFF-DT                PIC XX.
  6846         16  MA-CERT-NO.
  6847             20  MA-CERT-PRIME             PIC X(10).
  6848             20  MA-CERT-SFX               PIC X.
  6849
  6850     12  FILLER                            PIC XX.
  6851
  6852     12  MA-ACCESS-CONTROL.
  6853         16  MA-SOURCE-SYSTEM              PIC XX.
  6854             88  MA-FROM-CREDIT                VALUE 'CR'.
  6855             88  MA-FROM-VSI                   VALUE 'VS'.
  6856             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6857             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL689.cbl
  6858         16  MA-RECORD-ADD-DT              PIC XX.
  6859         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6860         16  MA-LAST-MAINT-DT              PIC XX.
  6861         16  MA-LAST-MAINT-BY              PIC XXXX.
  6862         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6863
  6864     12  MA-PROFILE-INFO.
  6865         16  MA-QUALIFY-CODE-1             PIC XX.
  6866         16  MA-QUALIFY-CODE-2             PIC XX.
  6867         16  MA-QUALIFY-CODE-3             PIC XX.
  6868         16  MA-QUALIFY-CODE-4             PIC XX.
  6869         16  MA-QUALIFY-CODE-5             PIC XX.
  6870
  6871         16  MA-INSURED-LAST-NAME          PIC X(15).
  6872         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6873         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6874         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6875         16  MA-INSURED-BIRTH-DT           PIC XX.
  6876         16  MA-INSURED-SEX                PIC X.
  6877             88  MA-SEX-MALE                   VALUE 'M'.
  6878             88  MA-SEX-FEMALE                 VALUE 'F'.
  6879         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6880
  6881         16  MA-ADDRESS-CORRECTED          PIC X.
  6882         16  MA-JOINT-BIRTH-DT             PIC XX.
  6883*        16  FILLER                        PIC X(12).
  6884
  6885         16  MA-ADDRESS-LINE-1             PIC X(30).
  6886         16  MA-ADDRESS-LINE-2             PIC X(30).
  6887         16  MA-CITY-STATE.
  6888             20  MA-CITY                   PIC X(28).
  6889             20  MA-ADDR-STATE             PIC XX.
  6890         16  MA-ZIP.
  6891             20  MA-ZIP-CODE.
  6892                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6893                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6894                 24  FILLER                PIC X(4).
  6895             20  MA-ZIP-PLUS4              PIC X(4).
  6896         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6897             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6898             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6899             20  FILLER                    PIC X(3).
  6900
  6901         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6902
  6903         16  FILLER                        PIC XXX.
  6904*        16  FILLER                        PIC X(10).
  6905
  6906     12  MA-CRED-BENE-INFO.
  6907         16  MA-CRED-BENE-NAME                 PIC X(25).
  6908         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6909         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6910         16  MA-CRED-BENE-CTYST.
  6911             20  MA-CRED-BENE-CITY             PIC X(28).
  6912             20  MA-CRED-BENE-STATE            PIC XX.
  6913         16  MA-CRED-BENE-ZIP.
  6914             20  MA-CB-ZIP-CODE.
  6915                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL689.cbl
  6916                     88  MA-CB-CANADIAN-POST-CODE
  6917                                           VALUE 'A' THRU 'Z'.
  6918                 24  FILLER                    PIC X(4).
  6919             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6920         16  MA-CB-CANADIAN-POSTAL-CODE
  6921                            REDEFINES MA-CRED-BENE-ZIP.
  6922             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6923             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6924             20  FILLER                        PIC X(3).
  6925     12  MA-POST-CARD-MAIL-DATA.
  6926         16  MA-MAIL-DATA OCCURS 7.
  6927             20  MA-MAIL-TYPE              PIC X.
  6928                 88  MA-12MO-MAILING           VALUE '1'.
  6929                 88  MA-EXP-MAILING            VALUE '2'.
  6930             20  MA-MAIL-STATUS            PIC X.
  6931                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6932                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6933                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6934             20  MA-MAIL-DATE              PIC XX.
  6935     12  FILLER                            PIC XX.
  6936     12  FILLER                            PIC XX.
  6937*    12  FILLER                            PIC X(30).
  6938******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL689.cbl
  6940*    COPY ERCPNDB.
  6941******************************************************************
  6942*                                                                *
  6943*                                                                *
  6944*                            ERCPNDB.                            *
  6945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6946*                            VMOD=2.025                          *
  6947*                                                                *
  6948*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6949*                                                                *
  6950******************************************************************
  6951*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6952*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6953******************************************************************
  6954*                                                                *
  6955*                                                                *
  6956*   FILE TYPE = VSAM,KSDS                                        *
  6957*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6958*                                                                *
  6959*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6960*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6961*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6962*                                                 RKP=13,LEN=36  *
  6963*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6964*                                      AND CHG-SEQ.)             *
  6965*                                                RKP=49,LEN=11   *
  6966*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6967*                                      AND CHG-SEQ.)             *
  6968*                                                RKP=60,LEN=15   *
  6969*                                                                *
  6970*   LOG = NO                                                     *
  6971*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6972******************************************************************
  6973******************************************************************
  6974*                   C H A N G E   L O G
  6975*
  6976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6977*-----------------------------------------------------------------
  6978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6979* EFFECTIVE    NUMBER
  6980*-----------------------------------------------------------------
  6981* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6982* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6983* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6984* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6985* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6986* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6987* 032306                   PEMA  ADD BOW LOAN NUMBER
  6988* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6989* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6990* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6991* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6992* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6993* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6994* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6995* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6996******************************************************************
  6997
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL689.cbl
  6998 01  PENDING-BUSINESS.
  6999     12  PB-RECORD-ID                     PIC XX.
  7000         88  VALID-PB-ID                        VALUE 'PB'.
  7001
  7002     12  PB-CONTROL-PRIMARY.
  7003         16  PB-COMPANY-CD                PIC X.
  7004         16  PB-ENTRY-BATCH               PIC X(6).
  7005         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7006         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7007
  7008     12  PB-CONTROL-BY-ACCOUNT.
  7009         16  PB-COMPANY-CD-A1             PIC X.
  7010         16  PB-CARRIER                   PIC X.
  7011         16  PB-GROUPING.
  7012             20  PB-GROUPING-PREFIX       PIC XXX.
  7013             20  PB-GROUPING-PRIME        PIC XXX.
  7014         16  PB-STATE                     PIC XX.
  7015         16  PB-ACCOUNT.
  7016             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7017             20  PB-ACCOUNT-PRIME         PIC X(6).
  7018         16  PB-CERT-EFF-DT               PIC XX.
  7019         16  PB-CERT-NO.
  7020             20  PB-CERT-PRIME            PIC X(10).
  7021             20  PB-CERT-SFX              PIC X.
  7022         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7023
  7024         16  PB-RECORD-TYPE               PIC X.
  7025             88  PB-MAILING-DATA                VALUE '0'.
  7026             88  PB-ISSUE                       VALUE '1'.
  7027             88  PB-CANCELLATION                VALUE '2'.
  7028             88  PB-BATCH-TRAILER               VALUE '9'.
  7029
  7030     12  PB-CONTROL-BY-ORIG-BATCH.
  7031         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7032         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7033         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7034         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7035
  7036     12  PB-CONTROL-BY-CSR.
  7037         16  PB-CSR-COMPANY-CD            PIC X.
  7038         16  PB-CSR-ID                    PIC X(4).
  7039         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7040         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7041         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7042******************************************************************
  7043*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7044******************************************************************
  7045
  7046     12  PB-LAST-MAINT-DT                 PIC XX.
  7047     12  PB-LAST-MAINT-BY                 PIC X(4).
  7048     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7049
  7050     12  PB-RECORD-BODY                   PIC X(375).
  7051
  7052     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7053         16  PB-CERT-ORIGIN               PIC X.
  7054             88  CLASIC-CREATED-CERT         VALUE '1'.
  7055         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL689.cbl
  7056             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7057             20  PB-I-INSURED-FIRST-NAME.
  7058                 24  PB-I-INSURED-1ST-INIT PIC X.
  7059                 24  FILLER                PIC X(9).
  7060             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7061         16  PB-I-AGE                     PIC S99   COMP-3.
  7062         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7063         16  PB-I-BIRTHDAY                PIC XX.
  7064         16  PB-I-INSURED-SEX             PIC X.
  7065             88  PB-SEX-MALE     VALUE 'M'.
  7066             88  PB-SEX-FEMALE   VALUE 'F'.
  7067
  7068         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7069         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7070         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7071         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7072         16  PB-I-SKIP-CODE               PIC X.
  7073             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7074             88  PB-SKIP-JULY              VALUE '1'.
  7075             88  PB-SKIP-AUGUST            VALUE '2'.
  7076             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7077             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7078             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7079             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7080             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7081             88  PB-SKIP-JUNE              VALUE '8'.
  7082             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7083             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7084             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7085         16  PB-I-TERM-TYPE               PIC X.
  7086             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7087             88  PB-PAID-WEEKLY            VALUE 'W'.
  7088             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7089             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7090             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7091         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7092         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7093         16  PB-I-DATA-ENTRY-SW           PIC X.
  7094             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7095             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7096             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7097             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7098         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7099         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7100*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7101         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7102         16  FILLER                       PIC X.
  7103
  7104         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7105             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7106             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7107                                                   '90' THRU '99'.
  7108         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7109                                          PIC XX.
  7110         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7111         16  PB-I-AMOUNT-FINANCED REDEFINES
  7112                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7113         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL689.cbl
  7114         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7115                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7116         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7117         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7118         16  PB-I-CLP-AMOUNT REDEFINES
  7119                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7120         16  PB-I-LF-CALC-FLAG            PIC X.
  7121             88 PB-COMP-LF-PREM               VALUE '?'.
  7122         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7123         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7124         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7125         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7126         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7127         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7128         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7129         16  PB-I-LF-ABBR                 PIC XXX.
  7130         16  PB-I-LF-INPUT-CD             PIC XX.
  7131
  7132         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7133             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7134             88  PB-INVALID-AH               VALUE '  ' '00'
  7135                                                   '90' THRU '99'.
  7136         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7137         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7138         16  PB-I-AH-CALC-FLAG            PIC X.
  7139             88 PB-COMP-AH-PREM                  VALUE '?'.
  7140         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7141         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7142         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7143         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7144         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7145         16  PB-I-AH-ABBR                 PIC XXX.
  7146         16  PB-I-AH-INPUT-CD             PIC XXX.
  7147
  7148         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7149         16  PB-I-REIN-TABLE              PIC XXX.
  7150         16  PB-I-BUSINESS-TYPE           PIC 99.
  7151         16  PB-I-INDV-GRP-CD             PIC X.
  7152         16  PB-I-MORT-CODE.
  7153             20  PB-I-TABLE               PIC X.
  7154             20  PB-I-INTEREST            PIC XX.
  7155             20  PB-I-MORT-TYP            PIC X.
  7156         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7157         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7158         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7159         16  PB-I-INDV-GRP-OVRD           PIC X.
  7160         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7161         16  PB-I-SIG-SW                  PIC X.
  7162             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7163         16  PB-I-RATE-CLASS              PIC XX.
  7164         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7165         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7166         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7167         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7168         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7169         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7170         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7171         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL689.cbl
  7172         16  PB-I-OB-FLAG                 PIC X.
  7173             88  PB-I-OB                      VALUE 'B'.
  7174             88  PB-I-SUMMARY                 VALUE 'Z'.
  7175         16  PB-I-ENTRY-STATUS            PIC X.
  7176             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7177                                              'M' '5' '9' '2'.
  7178             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7179             88  PB-I-POLICY-PENDING          VALUE '2'.
  7180             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7181             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7182             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7183             88  PB-I-REIN-ONLY               VALUE '9'.
  7184             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7185             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7186             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7187             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7188         16  PB-I-INT-CODE                PIC X.
  7189             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7190             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7191         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7192         16  PB-I-SOC-SEC-NO              PIC X(11).
  7193         16  PB-I-MEMBER-NO               PIC X(12).
  7194         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7195*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7196         16  PB-I-OLD-LOF                 PIC XXX.
  7197         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7198         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7199         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7200         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7201         16  PB-I-LIFE-INDICATOR          PIC X.
  7202             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7203         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7204         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7205                                          PIC S9(5)V99    COMP-3.
  7206         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7207             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7208             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7209         16  PB-I-1ST-PMT-DT              PIC XX.
  7210         16  PB-I-JOINT-INSURED.
  7211             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7212             20 PB-I-JOINT-FIRST-NAME.
  7213                24  PB-I-JOINT-FIRST-INIT PIC X.
  7214                24  FILLER                PIC X(9).
  7215             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7216*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7217         16  PB-I-BENEFICIARY-NAME.
  7218             20  PB-I-BANK-NUMBER         PIC X(10).
  7219             20  FILLER                   PIC X(15).
  7220         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7221         16  PB-I-REFERENCE               PIC X(12).
  7222         16  FILLER REDEFINES PB-I-REFERENCE.
  7223             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7224             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7225             20  PB-I-CLP-STATE           PIC XX.
  7226         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7227             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7228             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7229             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL689.cbl
  7230         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7231         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7232         16  PB-I-RESIDENT-STATE          PIC XX.
  7233         16  PB-I-RATE-CODE               PIC X(4).
  7234         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7235         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7236         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7237         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7238         16  PB-I-BANK-NOCHRGB            PIC 99.
  7239         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7240         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7241
  7242     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7243         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7244             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7245         16  PB-C-CANCEL-ORIGIN           PIC X.
  7246             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7247         16  PB-C-LF-CANCEL-DT            PIC XX.
  7248         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7249         16  PB-C-LF-CALC-REQ             PIC X.
  7250             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7251         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7252         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7253         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7254             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7255         16  PB-C-AH-CANCEL-DT            PIC XX.
  7256         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7257         16  PB-C-AH-CALC-REQ             PIC X.
  7258             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7259         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7260         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7261         16  PB-C-LAST-NAME               PIC X(15).
  7262         16  PB-C-REFUND-SW               PIC X.
  7263             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7264             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7265         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7266         16  PB-C-PAYEE-CODE              PIC X(6).
  7267         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7268         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7269         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7270         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7271         16  PB-C-REFERENCE               PIC X(12).
  7272         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7273         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7274         16  PB-C-POST-CARD-IND           PIC X.
  7275         16  PB-C-CANCEL-REASON           PIC X.
  7276         16  PB-C-REF-INTERFACE-SW        PIC X.
  7277         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7278         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7279         16  FILLER                       PIC X(01).
  7280*        16  FILLER                       PIC X(18).
  7281         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7282*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7283         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7284         16  PB-CANCELED-CERT-DATA.
  7285             20  PB-CI-INSURED-NAME.
  7286                 24  PB-CI-LAST-NAME      PIC X(15).
  7287                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL689.cbl
  7288             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7289             20  PB-CI-INSURED-SEX        PIC X.
  7290             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7291             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7292             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7293             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7294             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7295             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7296             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7297             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7298             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7299             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7300             20  PB-CI-RATE-CLASS         PIC XX.
  7301             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7302             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7303             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7304             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7305             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7306             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7307             20  PB-CI-LF-ABBR            PIC X(3).
  7308             20  PB-CI-AH-ABBR            PIC X(3).
  7309             20  PB-CI-OB-FLAG            PIC X.
  7310                 88  PB-CI-OB                VALUE 'B'.
  7311             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7312                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7313                                           'M' '4' '5' '9' '2'.
  7314                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7315                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7316                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7317                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7318                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7319                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7320                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7321                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7322                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7323                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7324                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7325                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7326             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7327                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7328                                           'M' '4' '5' '9' '2'.
  7329                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7330                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7331                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7332                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7333                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7334                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7335                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7336                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7337                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7338                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7339                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7340                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7341             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7342             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7343             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7344             20  PB-CI-MEMBER-NO          PIC X(12).
  7345             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL689.cbl
  7346                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7347                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7348             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7349             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7350             20  PB-CI-COMP-EXCP-SW       PIC X.
  7351                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7352                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7353             20  PB-CI-ENTRY-STATUS       PIC X.
  7354             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7355             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7356             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7357             20  PB-CI-DEATH-DT           PIC XX.
  7358             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7359             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7360             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7361             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7362             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7363             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7364             20  PB-CI-ENTRY-DT              PIC XX.
  7365             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7366             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7367             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7368             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7369             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7370             20  PB-CI-OLD-LOF               PIC XXX.
  7371*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7372             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7373             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7374             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7375             20  PB-CI-INDV-GRP-CD           PIC X.
  7376             20  PB-CI-BENEFICIARY-NAME.
  7377                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7378                 24  FILLER                  PIC X(15).
  7379             20  PB-CI-NOTE-SW               PIC X.
  7380             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7381             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7382             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7383             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7384             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7385             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7386             20  PB-CI-FIRST-NAME            PIC X(10).
  7387             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7388
  7389         16  FILLER                       PIC X(13).
  7390*032306  16  FILLER                       PIC X(27).
  7391*        16  FILLER                       PIC X(46).
  7392
  7393     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7394         16  FILLER                       PIC X(10).
  7395         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7396         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7397         16  PB-M-INSURED-MID-INIT        PIC X.
  7398         16  PB-M-INSURED-AGE             PIC 99.
  7399         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7400         16  PB-M-INSURED-SEX             PIC X.
  7401         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7402         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7403         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL689.cbl
  7404         16  PB-M-INSURED-CITY-STATE.
  7405             20  PB-M-INSURED-CITY        PIC X(28).
  7406             20  PB-M-INSURED-STATE       PIC XX.
  7407         16  PB-M-INSURED-ZIP-CODE.
  7408             20  PB-M-INSURED-ZIP-PRIME.
  7409                 24  PB-M-INSURED-ZIP-1   PIC X.
  7410                     88  PB-M-CANADIAN-POST-CODE
  7411                                             VALUE 'A' THRU 'Z'.
  7412                 24  FILLER               PIC X(4).
  7413             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7414         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7415                                        PB-M-INSURED-ZIP-CODE.
  7416             20  PM-M-INS-CAN-POST1       PIC XXX.
  7417             20  PM-M-INS-CAN-POST2       PIC XXX.
  7418             20  FILLER                   PIC XXX.
  7419         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7420         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7421         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7422         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7423         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7424         16  PB-M-CRED-BENE-CITYST.
  7425             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7426             20  PB-M-CRED-BENE-STATE     PIC XX.
  7427         16  FILLER                       PIC X(92).
  7428
  7429     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7430         16  FILLER                       PIC X(10).
  7431         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7432         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7433         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7434         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7435         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7436         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7437         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7438         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7439         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7440         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7441         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7442         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7443         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7444         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7445         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7446         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7447         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7448         16  PB-ACCOUNT-NAME              PIC X(30).
  7449         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7450         16  PB-REFERENCE                 PIC X(12).
  7451         16  PB-B-RECEIVED-DT             PIC XX.
  7452         16  FILLER                       PIC X(234).
  7453
  7454     12  PB-RECORD-STATUS.
  7455         16  PB-CREDIT-SELECT-DT          PIC XX.
  7456         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7457         16  PB-BILLED-DT                 PIC XX.
  7458         16  PB-BILLING-STATUS            PIC X.
  7459             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7460             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7461             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL689.cbl
  7462         16  PB-RECORD-BILL               PIC X.
  7463             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7464             88  PB-RECORD-RETURNED           VALUE 'R'.
  7465             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7466             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7467             88  PB-OVERRIDE-AH               VALUE 'A'.
  7468             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7469         16  PB-BATCH-ENTRY               PIC X.
  7470             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7471             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7472             88  PB-REISSUED-CERT             VALUE 'E'.
  7473             88  PB-MONTHLY-CERT              VALUE 'M'.
  7474             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7475             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7476             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7477         16  PB-FORCE-CODE                PIC X.
  7478             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7479             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7480             88  PB-CANCEL-FORCE              VALUE '8'.
  7481             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7482             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7483             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7484             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7485             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7486             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7487             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7488         16  PB-FATAL-FLAG                PIC X.
  7489             88  PB-FATAL-ERRORS              VALUE 'X'.
  7490         16  PB-FORCE-ER-CD               PIC X.
  7491             88  PB-FORCE-ERRORS              VALUE 'F'.
  7492             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7493         16  PB-WARN-ER-CD                PIC X.
  7494             88  PB-WARNING-ERRORS            VALUE 'W'.
  7495         16  FILLER                       PIC X.
  7496         16  PB-OUT-BAL-CD                PIC X.
  7497             88  PB-OUT-OF-BAL                VALUE 'O'.
  7498         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7499         16  PB-AH-OVERRIDE-L1            PIC X.
  7500         16  PB-INPUT-DT                  PIC XX.
  7501         16  PB-INPUT-BY                  PIC X(4).
  7502         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7503         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7504         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7505         16  PB-LF-EARNING-METHOD         PIC X.
  7506         16  PB-AH-EARNING-METHOD         PIC X.
  7507         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7508         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7509         16  PB-REIN-CD                   PIC XXX.
  7510         16  PB-LF-REFUND-TYPE            PIC X.
  7511         16  PB-AH-REFUND-TYPE            PIC X.
  7512         16  PB-ACCT-EFF-DT               PIC XX.
  7513         16  PB-ACCT-EXP-DT               PIC XX.
  7514         16  PB-COMPANY-ID                PIC X(3).
  7515         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7516         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7517         16  PB-SV-CARRIER                PIC X.
  7518         16  PB-SV-GROUPING               PIC X(6).
  7519         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL689.cbl
  7520         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7521         16  PB-GA-BILLING-INFO.
  7522             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7523                                          PIC XX.
  7524         16  PB-SV-REMIT-TO  REDEFINES
  7525             PB-GA-BILLING-INFO           PIC X(10).
  7526         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7527         16  PB-I-LOAN-OFFICER            PIC X(5).
  7528         16  PB-I-VIN                     PIC X(17).
  7529
  7530         16  FILLER                       PIC X(04).
  7531         16  IMNET-BYPASS-SW              PIC X.
  7532
  7533******************************************************************
  7534*                COMMON EDIT ERRORS                              *
  7535******************************************************************
  7536
  7537     12  PB-COMMON-ERRORS.
  7538         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7539                                           PIC S9(4)     COMP.
  7540
  7541******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL689.cbl
  7543*    COPY ERCPYAJ.
  7544******************************************************************
  7545*                                                                *
  7546*                            ERCPYAJ                             *
  7547*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7548*                            VMOD=2.015                          *
  7549*                                                                *
  7550*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7551*                                                                *
  7552*                                                                *
  7553*   FILE TYPE = VSAM,KSDS                                        *
  7554*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7555*                                                                *
  7556*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7557*       ALTERNATE PATHS = NONE                                   *
  7558*                                                                *
  7559*   LOG = YES                                                    *
  7560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7561******************************************************************
  7562******************************************************************
  7563*                   C H A N G E   L O G
  7564*
  7565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7566*-----------------------------------------------------------------
  7567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7568* EFFECTIVE    NUMBER
  7569*-----------------------------------------------------------------
  7570* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7571* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7572******************************************************************
  7573
  7574 01  PENDING-PAY-ADJ.
  7575     12  PY-RECORD-ID                     PIC XX.
  7576         88  VALID-PY-ID                        VALUE 'PY'.
  7577
  7578     12  PY-CONTROL-PRIMARY.
  7579         16  PY-COMPANY-CD                PIC X.
  7580         16  PY-CARRIER                   PIC X.
  7581         16  PY-GROUPING                  PIC X(6).
  7582         16  PY-FIN-RESP                  PIC X(10).
  7583         16  PY-ACCOUNT                   PIC X(10).
  7584         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7585                                          PIC X(10).
  7586         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7587         16  PY-RECORD-TYPE               PIC X.
  7588             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7589             88  PY-DEPOSIT                   VALUE 'D'.
  7590             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7591             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7592             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7593             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7594             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7595             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7596             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7597             88  PY-FICA-ENTRY                VALUE 'F'.
  7598             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7599             88  PY-POLICY-FEE                VALUE 'W'.
  7600             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL689.cbl
  7601
  7602     12  PY-PYMT-TYPE                     PIC X.
  7603             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7604             88  PY-REINS-PYMT                VALUE 'R'.
  7605             88  PY-EXP-PYMT                  VALUE 'E'.
  7606
  7607     12  PY-BIL-INV                       PIC X(6).
  7608     12  PY-REF-NO                        PIC X(12).
  7609
  7610     12  PY-LAST-MAINT-DT                 PIC XX.
  7611     12  PY-LAST-MAINT-BY                 PIC X(4).
  7612     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7613
  7614     12  PY-PYADJ-RECORD.
  7615         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7616         16  PY-ENTRY-COMMENT             PIC X(30).
  7617         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7618             20  PY-GL-ACCOUNT            PIC X(10).
  7619             20  PY-GL-STATE              PIC X(02).
  7620             20  PY-GL-CANC-SW            PIC X(01).
  7621                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7622                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7623             20  PY-GL-COMMENT            PIC X(10).
  7624             20  FILLER      REDEFINES PY-GL-COMMENT.
  7625                 24  PY-GL-CHECK-NO       PIC 9(06).
  7626                 24  FILLER               PIC X(04).
  7627             20  FILLER                   PIC X(07).
  7628         16  PY-SAVE-ACCOUNT              PIC X(10).
  7629         16  PY-SAVE-TYPE                 PIC X(01).
  7630
  7631         16  PY-LETTERS.
  7632             20  PY-LETTER OCCURS 3 TIMES
  7633                           INDEXED BY PY-LET-NDX
  7634                                          PIC X(04).
  7635
  7636         16  PY-ERCOMP-TYPE               PIC X.
  7637             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7638             88  PY-GA-TYPE                   VALUE 'G'.
  7639             88  PY-BANK-TYPE                 VALUE 'B'.
  7640         16  FILLER                       PIC X(05).
  7641
  7642     12  PY-RECORD-STATUS.
  7643         16  PY-CREDIT-SELECT-DT          PIC XX.
  7644         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7645         16  PY-BILLED-DATE               PIC XX.
  7646         16  PY-REPORTED-DT               PIC XX.
  7647         16  PY-PMT-APPLIED               PIC X.
  7648             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7649             88  PY-GA-PMT                    VALUE 'G'.
  7650             88  PY-OVWRITE-PMT               VALUE 'O'.
  7651             88  PY-NON-AR-PMT                VALUE 'N'.
  7652         16  FILLER                       PIC X(5).
  7653         16  PY-INPUT-DT                  PIC XX.
  7654         16  PY-CHECK-NUMBER              PIC X(6).
  7655         16  PY-VOID-SW                   PIC X.
  7656             88  PY-CHECK-VOIDED              VALUE 'V'.
  7657         16  PY-CHECK-ORIGIN-SW           PIC X.
  7658             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL689.cbl
  7659             88  PY-REFUND-CHECK              VALUE 'R'.
  7660             88  PY-GA-CHECK                  VALUE 'G'.
  7661             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7662             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7663         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7664         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7665         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7666         16  PY-BILL-FLAG                 PIC X.
  7667             88  PY-BILLED                    VALUE 'B'.
  7668         16  PY-AR-FLAG                   PIC X.
  7669             88  PY-AR-CYCLE                  VALUE 'C'.
  7670             88  PY-AR-MONTH-END              VALUE 'M'.
  7671         16  PY-AR-DATE                   PIC XX.
  7672
  7673     12  PY-GL-CODES.
  7674         16  PY-GL-DB                     PIC X(14).
  7675         16  PY-GL-CR                     PIC X(14).
  7676         16  PY-GL-FLAG                   PIC X.
  7677         16  PY-GL-DATE                   PIC XX.
  7678
  7679     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7680     12  FILLER                           PIC X(3).
  7681******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL689.cbl
  7683*    COPY ELCTEXT.
  7684******************************************************************
  7685*                                                                *
  7686*                                                                *
  7687*                            ELCTEXT.                            *
  7688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7689*                            VMOD=2.008                          *
  7690*                                                                *
  7691*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7692*                                     FORM LETTERS,              *
  7693*                                     CERT FORM DISPLAY.
  7694*                                                                *
  7695*   FILE TYPE = VSAM,KSDS                                        *
  7696*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7697*                                                                *
  7698*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7699*       ALTERNATE INDEX = NONE                                   *
  7700*                                                                *
  7701*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7702*       ALTERNATE INDEX = NONE                                   *
  7703*                                                                *
  7704*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7705*       ALTERNATE INDEX = NONE                                   *
  7706*                                                                *
  7707*   LOG = NO                                                     *
  7708*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7709******************************************************************
  7710 01  TEXT-FILES.
  7711     12  TEXT-FILE-ID                PIC XX.
  7712         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7713         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7714         88  HELP-FILE-TEXT             VALUE 'TH'.
  7715
  7716     12  TX-CONTROL-PRIMARY.
  7717         16  TX-COMPANY-CD           PIC X.
  7718             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7719         16  TX-ACCESS-CD-GENL       PIC X(12).
  7720
  7721         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7722             20  TX-LETTER-NO        PIC X(4).
  7723             20  FILLER              PIC X(8).
  7724
  7725         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7726             20  TX-FORM-NO          PIC X(12).
  7727
  7728         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7729             20  TX-HELP-TYPE        PIC X.
  7730                 88  HELP-FOR-GENERAL   VALUE ' '.
  7731                 88  HELP-BY-SCREEN     VALUE 'S'.
  7732                 88  HELP-BY-ERROR      VALUE 'E'.
  7733             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7734                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7735             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7736                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7737             20  FILLER              PIC X(4).
  7738
  7739         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL689.cbl
  7741     12  TX-PROCESS-CONTROL          PIC XX.
  7742         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7743
  7744     12  TX-TEXT-LINE                PIC X(70).
  7745
  7746     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7747         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7748         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7749         88  TX-VALID-FORM-SQUEEZE-VALUE
  7750                                        VALUE 'Y' ' '.
  7751
  7752     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7753         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7754         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7755         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7756         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7757         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7758         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7759         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7760                                              'K' 'N' ' '
  7761                                              'Z'.
  7762
  7763     12  TX-ARCHIVE-SW               PIC X.
  7764         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7765         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7766         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7767
  7768     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7769     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7770
  7771     12  TX-BSR-CODE                 PIC X.
  7772         88  TX-BSR-LETTER              VALUE 'B'.
  7773         88  TX-NON-BSR-LETTER          VALUE ' '.
  7774
  7775     12  FILLER                      PIC X.
  7776*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL689.cbl
  7778 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  7779                          ACCOUNT-MASTER LETTER-ARCHIVE
  7780                          LETTER-ARCHIVE-TEXT
  7781                          CERTIFICATE-MASTER CHECK-RECORDS
  7782                          CONTROL-FILE COMPENSATION-MASTER
  7783                          MAILING-DATA PENDING-BUSINESS
  7784                          PENDING-PAY-ADJ TEXT-FILES.
  7785 0000-DFHEXIT SECTION.
  7786     MOVE '9#                    $   ' TO DFHEIV0.
  7787     MOVE 'EL689' TO DFHEIV1.
  7788     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7789     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7790
  7791     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7792     MOVE '5'                    TO DC-OPTION-CODE.
  7793     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  7794     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  7795     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  7796                                    W-CURRENT-SAVE.
  7797
  7798     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7799     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  7800                                 TO EMI-SAVE-AREA.
  7801
  7802     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7803                                    W-TS-TERM-SCREEN.
  7804
  7805     IF  EIBCALEN EQUAL 0
  7806         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  7807         GO TO 8300-SEND-TEXT
  7808     END-IF.
  7809     set P to address of KIXSYS
  7810     CALL "getenv" using by value P returning var-ptr
  7811     if var-ptr = null then
  7812        display ' kixsys not set '
  7813     else
  7814        set address of var to var-ptr
  7815        move 0 to env-var-len
  7816        inspect var tallying env-var-len
  7817          for characters before X'00'
  7818*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  7819        unstring var (1:env-var-len) delimited by '/'
  7820           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  7821              WS-KIX-SYS
  7822        end-unstring
  7823*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  7824*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  7825     end-if
  7826     set P to address of KIXHOST
  7827     CALL "getenv" using by value P returning var-ptr
  7828     if var-ptr = null then
  7829        display ' kixhost not set '
  7830     else
  7831        set address of var to var-ptr
  7832        move 0 to env-var-len
  7833        inspect var tallying env-var-len
  7834          for characters before X'00'
  7835*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL689.cbl
  7836        MOVE var(1:env-var-len)  to ws-kixhost
  7837*       unstring var (1:env-var-len) delimited by '/'
  7838*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  7839*             WS-KIX-SYS
  7840*       end-unstring
  7841        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  7842*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  7843     end-if
  7844     IF  PI-689-CREATE-NO-SCREENS
  7845         GO TO 0600-BYPASS-SCREEN-CNTL
  7846     END-IF.
  7847
  7848     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  7849         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  7850             MOVE PI-SAVED-PROGRAM-5
  7851                                 TO PI-SAVED-PROGRAM-6
  7852             MOVE PI-SAVED-PROGRAM-4
  7853                                 TO PI-SAVED-PROGRAM-5
  7854             MOVE PI-SAVED-PROGRAM-3
  7855                                 TO PI-SAVED-PROGRAM-4
  7856             MOVE PI-SAVED-PROGRAM-2
  7857                                 TO PI-SAVED-PROGRAM-3
  7858             MOVE PI-SAVED-PROGRAM-1
  7859                                 TO PI-SAVED-PROGRAM-2
  7860             MOVE PI-RETURN-TO-PROGRAM
  7861                                 TO PI-SAVED-PROGRAM-1
  7862             MOVE PI-CALLING-PROGRAM
  7863                                 TO PI-RETURN-TO-PROGRAM
  7864             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  7865             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7866             MOVE LOW-VALUES     TO EL689AO
  7867             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  7868             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  7869                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  7870             END-IF
  7871             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  7872                     AND
  7873                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  7874                 GO TO 0400-EL6311-INCOMING
  7875             ELSE
  7876                 MOVE PI-689-ARCHIVE-NUMBER
  7877                                 TO W-INCOMING-ARCHIVE
  7878                 MOVE LOW-VALUES TO PI-1042-WA
  7879                                    PI-689-WORK-AREA
  7880                 MOVE ZEROS      TO PI-CURRENT-LINE
  7881                                    PI-TEMP-STOR-ITEMS
  7882                                    PI-TOTAL-LINES
  7883                                    PI-UPDATE-SW
  7884                                    PI-689-NUMBER-LABEL-LINES
  7885                                    PI-689-NUMBER-TEXT-RECORDS
  7886                                    PI-689-ERROR
  7887                 MOVE SPACES     TO PI-689-PRINT-SW
  7888                                    PI-689-ALT-PRINTER-ID
  7889                                    PI-689-LBL-OVERRIDE
  7890                                    PI-COMM-CONTROL
  7891                                    PI-689-FORM-NUMBER
  7892                                    PI-689-TEMP-STOR-ID
  7893                                    PI-689-LABEL-SOURCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL689.cbl
  7894                                    PI-689-USE-SCREEN-IND
  7895                 MOVE '2'        TO PI-ACTION
  7896                 MOVE -1         TO MAINTL
  7897                 MOVE PI-LOWER-CASE-LETTERS
  7898                                 TO W-LC-CASE-IND
  7899                 IF  W-INCOMING-ARCHIVE NUMERIC
  7900                         AND
  7901                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  7902                     MOVE 'S'    TO MAINTI
  7903                     MOVE +1     TO MAINTL
  7904                     MOVE AL-UANON
  7905                                 TO MAINTA
  7906                     MOVE W-INCOMING-ARCH-NO
  7907                                 TO ARCHNUMI
  7908                     MOVE +8     TO ARCHNUML
  7909                     MOVE AL-UNNON
  7910                                 TO ARCHNUMA
  7911                     GO TO 1000-SHOW
  7912                 ELSE
  7913                     GO TO 0450-SPECIAL-INPUT-PROCESS
  7914                 END-IF
  7915             END-IF
  7916         ELSE
  7917             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  7918             MOVE PI-RETURN-TO-PROGRAM
  7919                                     TO PI-CALLING-PROGRAM
  7920             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  7921             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  7922             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  7923             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  7924             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  7925             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  7926             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  7927             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  7928             MOVE LOW-VALUES         TO EL689AO
  7929             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  7930             SET W-RG-NDX            TO PI-CURRENT-LINE
  7931             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  7932                 VARYING
  7933                     W-SC-NDX FROM 1 BY 1
  7934                 UNTIL
  7935                     W-SC-NDX GREATER THAN
  7936                     W-NUM-LINES-PER-SCREEN
  7937             MOVE PI-689-ALT-PRINTER-ID
  7938                                     TO PRINTERO
  7939             MOVE AL-UANON           TO PRINTERA
  7940             MOVE -1                 TO PRINTERL
  7941             GO TO 8100-SEND-INITIAL-MAP
  7942         END-IF
  7943     END-IF.
  7944
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL689.cbl
  7946 0200-RECEIVE.
  7947
  7948     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  7949     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  7950     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  7951             OR
  7952         EMI-FORCABLE-CTR GREATER THAN ZEROS
  7953         MOVE 'Y'                TO W-HOLD-IND.
  7954
  7955     MOVE W-TRANSACTION          TO EIBTRNID.
  7956     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  7957     MOVE ZEROS                  TO W-LAST-ERROR.
  7958     MOVE LOW-VALUES             TO EL689AI.
  7959     MOVE '104A'                 TO W-TS-ID-TEXT.
  7960     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7961                                    W-TS-TERM-SCREEN.
  7962
  7963
  7964* EXEC CICS HANDLE AID
  7965*        CLEAR    (9300-DFHCLEAR)
  7966*        PA1      (9200-PA)
  7967*        PA2      (9200-PA)
  7968*        PA3      (9200-PA)
  7969*    END-EXEC.
  7970*    MOVE '"&=!"#               V! " #00007959' TO DFHEIV0
  7971     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  7972     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  7973     MOVE X'2220233030303037393539' TO DFHEIV0(25:11)
  7974     CALL 'kxdfhei1' USING DFHEIV0
  7975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7976
  7977
  7978
  7979* EXEC CICS HANDLE CONDITION
  7980*        PGMIDERR (9700-PGMID-ERROR)
  7981*        ERROR    (9800-ABEND)
  7982*        MAPFAIL  (0325-MAPFAIL)
  7983*    END-EXEC.
  7984*    MOVE '"$L.?                 ! # #00007966' TO DFHEIV0
  7985     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  7986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7987     MOVE X'2320233030303037393636' TO DFHEIV0(25:11)
  7988     CALL 'kxdfhei1' USING DFHEIV0
  7989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7990
  7991
  7992
  7993* EXEC CICS SYNCPOINT
  7994*    END-EXEC.
  7995*    MOVE '6"                    !   #00007972' TO DFHEIV0
  7996     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7998     MOVE X'2020233030303037393732' TO DFHEIV0(25:11)
  7999     CALL 'kxdfhei1' USING DFHEIV0
  8000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8001
  8002
  8003     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL689.cbl
  8004*    IF  W-LC-USE-BOTH-CASES
  8005
  8006* EXEC CICS RECEIVE
  8007*            MAP      (W-MAP)
  8008*            MAPSET   (W-MAPSET)
  8009*            INTO     (EL689AI)
  8010*            ASIS
  8011*        END-EXEC
  8012     MOVE LENGTH OF
  8013      EL689AI
  8014       TO DFHEIV11
  8015*    MOVE '8"TAI  L              ''   #00007977' TO DFHEIV0
  8016     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8017     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8018     MOVE X'2020233030303037393737' TO DFHEIV0(25:11)
  8019     CALL 'kxdfhei1' USING DFHEIV0,
  8020           W-MAP,
  8021           EL689AI,
  8022           DFHEIV11,
  8023           W-MAPSET,
  8024           DFHEIV99,
  8025           DFHEIV99
  8026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8027     ELSE
  8028
  8029* EXEC CICS RECEIVE
  8030*            MAP      (W-MAP)
  8031*            MAPSET   (W-MAPSET)
  8032*            INTO     (EL689AI)
  8033*        END-EXEC.
  8034     MOVE LENGTH OF
  8035      EL689AI
  8036       TO DFHEIV11
  8037*    MOVE '8"T I  L              ''   #00007984' TO DFHEIV0
  8038     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8039     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8040     MOVE X'2020233030303037393834' TO DFHEIV0(25:11)
  8041     CALL 'kxdfhei1' USING DFHEIV0,
  8042           W-MAP,
  8043           EL689AI,
  8044           DFHEIV11,
  8045           W-MAPSET,
  8046           DFHEIV99,
  8047           DFHEIV99
  8048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8049
  8050
  8051     IF  NOT DISPLAY-CAP
  8052         MOVE 'READ'             TO SM-READ
  8053         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8054         MOVE ER-9097            TO EMI-ERROR
  8055         MOVE -1                 TO MAINTL
  8056         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8057         GO TO 8100-SEND-INITIAL-MAP.
  8058
  8059     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8060
  8061     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL689.cbl
  8062         GO TO 0300-CHECK-PFKEYS.
  8063
  8064     IF  EIBAID NOT EQUAL DFHENTER
  8065         MOVE ER-0004            TO EMI-ERROR
  8066         GO TO 0320-INPUT-ERROR.
  8067
  8068     IF  ENTERPFI NUMERIC
  8069             AND
  8070         ENTERPFI GREATER THAN 0
  8071             AND
  8072         ENTERPFI LESS THAN 25
  8073         MOVE PF-VALUES (ENTERPFI)
  8074                                 TO EIBAID
  8075     ELSE
  8076         MOVE ER-0029            TO EMI-ERROR
  8077         GO TO 0320-INPUT-ERROR.
  8078
  8079 0300-CHECK-PFKEYS.
  8080
  8081     IF  EIBAID EQUAL DFHPF23
  8082         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8083         MOVE ZEROS              TO PI-TOTAL-LINES
  8084                                    PI-CURRENT-LINE
  8085         MOVE EIBAID             TO PI-ENTRY-CD-1
  8086         MOVE W-XCTL-005         TO W-CALL-PGM
  8087         GO TO 9400-XCTL.
  8088
  8089     IF  EIBAID EQUAL DFHPF24
  8090         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8091         MOVE ZEROS              TO PI-TOTAL-LINES
  8092                                    PI-CURRENT-LINE
  8093         MOVE W-XCTL-626         TO W-CALL-PGM
  8094         GO TO 9400-XCTL.
  8095
  8096     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8097                                    W-FORM-CHANGED-IND.
  8098
  8099     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8100             OR
  8101         PI-SHOW-MODE
  8102         NEXT SENTENCE
  8103     ELSE
  8104         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8105                 AND
  8106             FORML NOT EQUAL ZEROS
  8107                 AND
  8108             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8109             MOVE FORMI          TO PI-689-FORM-NUMBER
  8110             MOVE LOW-VALUES     TO EL689AI
  8111                                    PI-1042-WA
  8112                                    PI-689-FOLLOW-UP-DATE
  8113                                    PI-689-PRINT-RESTRICTION
  8114                                    PI-689-RESEND-DATE-1
  8115                                    PI-689-RESEND1-EDIT
  8116                                    PI-689-FOLLOW-UP-DATE
  8117                                    PI-689-FOLLOW-UP-EDIT
  8118                                    PI-689-ERROR-IND
  8119             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL689.cbl
  8120                                    PI-689-NUMBER-COPIES
  8121                                    PI-689-NUMBER-LABEL-LINES
  8122                                    PI-689-NUMBER-TEXT-RECORDS
  8123                                    PI-CURRENT-LINE
  8124                                    PI-TEMP-STOR-ITEMS
  8125                                    PI-TOTAL-LINES
  8126                                    PI-UPDATE-SW
  8127             MOVE SPACES         TO PI-689-PRINT-SW
  8128                                    PI-689-ALT-PRINTER-ID
  8129                                    PI-COMM-CONTROL
  8130                                    PI-689-TEMP-STOR-ID
  8131                                    PI-689-USE-SCREEN-IND
  8132                                    PI-689-RESEND-LETR-1
  8133                                    PI-CERT-FORM-ID
  8134             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8135             MOVE DFHENTER       TO EIBAID
  8136             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8137             GO TO 0330-FUNCTION-CHECK
  8138         ELSE
  8139             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8140                     OR
  8141                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8142                         AND
  8143                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8144                             OR
  8145                         ADDRSI NOT EQUAL LOW-VALUES))
  8146                     OR
  8147                 PI-689-CARRIER NOT EQUAL CARRIERI
  8148                     OR
  8149                 PI-689-GROUPING NOT EQUAL GROUPI
  8150                     OR
  8151                 PI-689-STATE NOT EQUAL STATEI
  8152                     OR
  8153                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8154                     OR
  8155                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8156                     OR
  8157                 PI-689-CERT-SFX NOT EQUAL SFXI
  8158                     OR
  8159                 PI-689-TYPE NOT EQUAL TYPEI
  8160                     OR
  8161                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8162                     OR
  8163                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8164                     OR
  8165                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8166                     OR
  8167                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8168                     OR
  8169                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8170                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8171                 MOVE DFHENTER   TO EIBAID
  8172                 GO TO 0330-FUNCTION-CHECK.
  8173
  8174*    IF  EIBAID EQUAL DFHPF1
  8175*        MOVE +7                 TO W-ROLL-COUNTER
  8176*        GO TO 4000-ROLL-PAGE.
  8177
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL689.cbl
  8178*    IF  EIBAID EQUAL DFHPF2
  8179*        MOVE -7                 TO W-ROLL-COUNTER
  8180*        GO TO 4000-ROLL-PAGE.
  8181
  8182*    IF  EIBAID EQUAL DFHPF3
  8183*        IF  W-HOLD-ON
  8184*            MOVE ER-7245        TO EMI-ERROR
  8185*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8186*            MOVE -1             TO MAINTL
  8187*            MOVE AL-UABON       TO MAINTA
  8188*            GO TO 8200-SEND-DATAONLY
  8189*        ELSE
  8190*            GO TO 0330-FUNCTION-CHECK.
  8191*    IF (EIBAID = DFHPF8)
  8192*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8193*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8194*       MOVE ER-0029             TO EMI-ERROR
  8195*       GO TO 0320-INPUT-ERROR
  8196*    END-IF
  8197*    IF EIBAID = DFHPF4 OR DFHPF8
  8198*        IF  W-HOLD-ON
  8199*            MOVE ER-7245        TO EMI-ERROR
  8200*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8201*            MOVE -1             TO MAINTL
  8202*            MOVE AL-UABON       TO MAINTA
  8203*            GO TO 8200-SEND-DATAONLY
  8204*        ELSE
  8205*            GO TO 0330-FUNCTION-CHECK.
  8206
  8207*    IF  EIBAID = DFHPF5
  8208*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8209*        GO TO 4000-ROLL-PAGE.
  8210
  8211*    IF  EIBAID = DFHPF6
  8212*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8213*        GO TO 4000-ROLL-PAGE.
  8214
  8215     IF  EIBAID EQUAL DFHPF7
  8216         IF PI-PROMPT-IND EQUAL 'Y'
  8217             MOVE ER-0894        TO EMI-ERROR
  8218             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8219             MOVE -1             TO MAINTL
  8220             MOVE AL-UABON       TO MAINTA
  8221             GO TO 8200-SEND-DATAONLY
  8222         END-IF
  8223     END-IF.
  8224
  8225     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8226         IF  W-HOLD-ON
  8227             MOVE ER-7245        TO EMI-ERROR
  8228             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8229             MOVE -1             TO MAINTL
  8230             MOVE AL-UABON       TO MAINTA
  8231             GO TO 8200-SEND-DATAONLY
  8232         ELSE
  8233             GO TO 0330-FUNCTION-CHECK.
  8234
  8235     IF  EIBAID EQUAL DFHENTER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL689.cbl
  8236         GO TO 0330-FUNCTION-CHECK.
  8237
  8238     MOVE ER-0029                TO EMI-ERROR.
  8239
  8240 0320-INPUT-ERROR.
  8241
  8242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8243
  8244     IF  ENTERPFL EQUAL 0
  8245         MOVE -1                 TO MAINTL
  8246         MOVE AL-UABON           TO MAINTA
  8247     ELSE
  8248         MOVE AL-UNBON           TO ENTERPFA
  8249         MOVE -1                 TO ENTERPFL.
  8250
  8251     GO TO 8200-SEND-DATAONLY.
  8252
  8253 0325-MAPFAIL.
  8254***********************************************************
  8255*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8256*      LETTERS ON A 3275 PRINTER.                         *
  8257***********************************************************
  8258
  8259     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8260
  8261     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8262     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8263             VARYING
  8264         W-SC-NDX FROM 1 BY 1
  8265             UNTIL
  8266         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8267
  8268     MOVE -1                     TO MAINTL.
  8269     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL689.cbl
  8271 0330-FUNCTION-CHECK.
  8272
  8273     IF  MAINTI EQUAL 'S'
  8274*        IF EIBAID = DFHPF4 OR DFHPF8
  8275*            GO TO 7900-PRINT-LETTER-NOW
  8276*        ELSE
  8277             GO TO 1000-SHOW.
  8278
  8279     IF  NOT MODIFY-CAP
  8280         MOVE 'UPDATE'           TO SM-READ
  8281         PERFORM 9995-SECURITY-VIOLATION
  8282         MOVE ER-0070            TO EMI-ERROR
  8283         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8284         MOVE -1                 TO MAINTL
  8285         GO TO 8100-SEND-INITIAL-MAP.
  8286
  8287     IF  W-FORM-CHANGED
  8288             OR
  8289         W-KEY-FIELDS-CHANGED
  8290         GO TO 0330-EDIT.
  8291
  8292     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8293
  8294
  8295*    IF  EIBAID EQUAL DFHPF3
  8296*        IF  PI-NO-CARRIER-SECURITY
  8297*                AND
  8298*            PI-NO-ACCOUNT-SECURITY
  8299*            GO TO 5000-EDIT-MODE.
  8300
  8301     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8302         IF  PI-NO-CARRIER-SECURITY
  8303                 AND
  8304             PI-NO-ACCOUNT-SECURITY
  8305             GO TO 5400-LETTER-RELEASE
  8306         ELSE
  8307             IF  PI-689-PRINT-PERFORMED
  8308                 GO TO 5400-LETTER-RELEASE
  8309             ELSE
  8310                 MOVE AL-UNBON TO ENTERPFA
  8311                 MOVE -1       TO ENTERPFL
  8312                 MOVE ER-2398  TO EMI-ERROR
  8313                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8314                 GO TO 8200-SEND-DATAONLY.
  8315
  8316*    IF  EIBAID = DFHPF4 OR DFHPF8
  8317*        GO TO 7900-PRINT-LETTER-NOW.
  8318
  8319 0330-EDIT.
  8320
  8321     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8322             OR
  8323         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8324             OR
  8325         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8326             OR
  8327         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8328             OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL689.cbl
  8329         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8330             OR
  8331         W-SC-TEXTL (6) NOT EQUAL ZEROS
  8332             OR
  8333         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8334             OR
  8335         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8336             OR
  8337         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8338             OR
  8339         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8340             OR
  8341         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8342         IF  W-KEY-FIELDS-CHANGED
  8343                 OR
  8344             W-FORM-CHANGED
  8345             MOVE ER-7250        TO EMI-ERROR
  8346             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8347             MOVE -1             TO MAINTL
  8348             MOVE AL-UABON       TO MAINTA
  8349         ELSE
  8350             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8351             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8352                     VARYING
  8353                 W-SC-NDX FROM 1 BY 1
  8354                     UNTIL
  8355                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8356             MOVE ER-7398        TO EMI-ERROR
  8357             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8358             MOVE -1             TO MAINTL
  8359             MOVE AL-UABON       TO MAINTA
  8360             GO TO 8200-SEND-DATAONLY.
  8361
  8362     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8363
  8364     IF  W-KEY-FIELDS-CHANGED
  8365             OR
  8366         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8367         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8368         IF  MAINTI EQUAL 'C'
  8369             GO TO 2000-CREATE
  8370         ELSE
  8371             NEXT SENTENCE
  8372     ELSE
  8373         IF  W-FORM-CHANGED
  8374             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8375             IF  MAINTI EQUAL 'C'
  8376                 GO TO 2000-CREATE
  8377             ELSE
  8378                 NEXT SENTENCE
  8379         ELSE
  8380             MOVE -1             TO MAINTL
  8381             GO TO 8200-SEND-DATAONLY.
  8382
  8383     MOVE ER-0023                TO EMI-ERROR.
  8384     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8385     MOVE -1                     TO MAINTL.
  8386     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL689.cbl
  8387     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL689.cbl
  8389 0350-EDIT-ROUTINE.
  8390
  8391     IF  MAINTI EQUAL 'C'
  8392             AND
  8393         FORML EQUAL ZEROS
  8394         MOVE -1                 TO FORML
  8395         MOVE ER-0177            TO EMI-ERROR
  8396         MOVE AL-UABON           TO FORMA
  8397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8398
  8399     IF PRTNOWL > ZEROS
  8400        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  8401           MOVE PRTNOWI          TO PI-PRINT-NOW
  8402           MOVE AL-UANON         TO PRTNOWA
  8403        END-IF
  8404     END-IF
  8405     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  8406*    IF  PRTRESTL NOT EQUAL ZEROS
  8407*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8408
  8409     IF  FOLLOWL NOT EQUAL ZEROS
  8410         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8411         PERFORM 8600-DEEDIT
  8412         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8413         MOVE '4'                TO DC-OPTION-CODE
  8414         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8415         IF  DATE-CONVERSION-ERROR
  8416             MOVE ER-0182        TO EMI-ERROR
  8417             MOVE -1             TO FOLLOWL
  8418             MOVE AL-UABON       TO FOLLOWA
  8419             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8420         ELSE
  8421             MOVE DC-GREG-DATE-1-EDIT
  8422                                 TO FOLLOWO
  8423                                    PI-689-FOLLOW-UP-EDIT
  8424             MOVE AL-UANON       TO FOLLOWA
  8425             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8426     ELSE
  8427         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8428
  8429     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8430         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  8431                 W-SAVE-BIN-DATE
  8432             MOVE ER-0533        TO EMI-ERROR
  8433             MOVE AL-UABON       TO FOLLOWA
  8434             MOVE -1             TO FOLLOWL
  8435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8436
  8437     IF  RESEND1L NOT EQUAL ZEROS
  8438         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8439         PERFORM 8600-DEEDIT
  8440         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8441         MOVE '4'                TO DC-OPTION-CODE
  8442         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8443         IF  DATE-CONVERSION-ERROR
  8444             MOVE ER-0185        TO EMI-ERROR
  8445             MOVE -1             TO RESEND1L
  8446             MOVE AL-UABON       TO RESEND1A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL689.cbl
  8447             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8448         ELSE
  8449             MOVE DC-GREG-DATE-1-EDIT
  8450                                 TO RESEND1O
  8451                                    PI-689-RESEND1-EDIT
  8452             MOVE AL-UANON       TO RESEND1A
  8453             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  8454     ELSE
  8455         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8456
  8457     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8458         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8459                 W-SAVE-BIN-DATE
  8460             MOVE ER-0537        TO EMI-ERROR
  8461             MOVE AL-UABON       TO RESEND1A
  8462             MOVE -1             TO RESEND1L
  8463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8464
  8465     IF ENCL > ZEROS
  8466        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  8467                                          PI-ENCLOSURE-CD
  8468        IF ENCI  = 'A'   OR
  8469                   'C'   OR
  8470                   'CLM' OR
  8471                   'E'   OR
  8472                   'ENV' OR
  8473                   '0'
  8474              OR '1' OR '2' OR '3' OR 'B' OR 'D'
  8475           MOVE ENCI             TO PI-ENCLOSURE-CD
  8476                                    W-ENCLOSURE-CD
  8477           MOVE AL-UANON         TO ENCA
  8478        ELSE
  8479           MOVE ER-1560          TO EMI-ERROR
  8480           MOVE -1               TO ENCL
  8481           MOVE AL-UABON         TO ENCA
  8482           PERFORM 9900-ERROR-FORMAT
  8483                                 THRU 9900-EXIT
  8484        END-IF
  8485     END-IF
  8486
  8487
  8488     IF NOT PI-CREATE-LABELS
  8489         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8490         MOVE AL-PANON           TO ADDRLBLA
  8491         GO TO 0350-BYPASS-OVERRIDE.
  8492
  8493     IF  ADDRLBLL GREATER THAN ZEROS
  8494          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8495          IF ADDRLBLI = 'N' OR 'Y'
  8496              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  8497              MOVE AL-UANON      TO ADDRLBLA
  8498          ELSE
  8499             MOVE ER-3783        TO EMI-ERROR
  8500             MOVE -1             TO ADDRLBLL
  8501             MOVE AL-UABON       TO ADDRLBLA
  8502             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8503
  8504 0350-BYPASS-OVERRIDE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL689.cbl
  8505
  8506     IF  PI-BYPASS-LABELS
  8507             OR
  8508         FORMI EQUAL '9999'
  8509             OR
  8510         PI-689-LABELS-OVERRIDEN
  8511         MOVE SPACES             TO PI-689-LABEL-SOURCE
  8512         MOVE LOW-VALUES         TO ADDRSI
  8513         MOVE AL-UANOF           TO ADDRSA
  8514         MOVE ZEROS              TO ADDRSL
  8515     ELSE
  8516         IF  ADDRSL GREATER THAN ZEROS
  8517             MOVE ADDRSI         TO W-LABEL-SOURCE
  8518             IF  W-LABEL-SOURCE-VALID
  8519                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  8520             ELSE
  8521                 MOVE -1         TO ADDRSL
  8522                 MOVE ER-0176    TO EMI-ERROR
  8523                 MOVE AL-UABON   TO ADDRSA
  8524                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8525         ELSE
  8526             IF  MAINTI EQUAL 'C'
  8527                 MOVE -1         TO ADDRSL
  8528                 MOVE ER-0176    TO EMI-ERROR
  8529                 MOVE AL-UABON   TO ADDRSA
  8530                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8531
  8532     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8533     IF  PRINTERL GREATER ZERO
  8534         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8535         MOVE AL-UANON           TO PRINTERA
  8536         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  8537                                    PI-ALT-DMD-PRT-ID
  8538     ELSE
  8539         IF  PI-NO-CARRIER-SECURITY
  8540                 AND
  8541             PI-NO-ACCOUNT-SECURITY
  8542             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  8543                 MOVE PI-PROCESSOR-PRINTER
  8544                                 TO PI-689-ALT-PRINTER-ID
  8545                                    PRINTERI
  8546                 MOVE AL-UABON   TO PRINTERA
  8547             ELSE
  8548                 MOVE PI-COMPANY-ID
  8549                                 TO W-CNTL-COMPANY-ID
  8550                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  8551                 MOVE SPACES     TO W-CNTL-GENL
  8552                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  8553
  8554* EXEC CICS HANDLE CONDITION
  8555*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  8556*                     NOTFND     (7945-NOT-FOUND)
  8557*                END-EXEC
  8558*    MOVE '"$JI                  ! $ #00008492' TO DFHEIV0
  8559     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8561     MOVE X'2420233030303038343932' TO DFHEIV0(25:11)
  8562     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL689.cbl
  8563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8564
  8565* EXEC CICS READ
  8566*                     DATASET    (W-CNTL-FILE-ID)
  8567*                     SET        (ADDRESS OF CONTROL-FILE)
  8568*                     RIDFLD     (W-CNTL-KEY)
  8569*                END-EXEC
  8570*    MOVE '&"S        E          (   #00008496' TO DFHEIV0
  8571     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8573     MOVE X'2020233030303038343936' TO DFHEIV0(25:11)
  8574     CALL 'kxdfhei1' USING DFHEIV0,
  8575           W-CNTL-FILE-ID,
  8576           DFHEIV20,
  8577           DFHEIV99,
  8578           W-CNTL-KEY,
  8579           DFHEIV99,
  8580           DFHEIV99,
  8581           DFHEIV99
  8582     SET ADDRESS OF CONTROL-FILE TO
  8583         DFHEIV20
  8584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8585                 MOVE CF-FORMS-PRINTER-ID
  8586                                 TO PI-689-ALT-PRINTER-ID
  8587                                    PRINTERI
  8588                                    W-TS-TERM-TEXT
  8589                 MOVE AL-UABON   TO PRINTERA
  8590         ELSE
  8591             MOVE AL-UABON       TO PRINTERA
  8592             MOVE -1             TO PRINTERL
  8593             MOVE ER-9283        TO EMI-ERROR
  8594             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8595
  8596     IF  COPIESL NOT EQUAL ZEROS
  8597         IF  COPIESI NOT NUMERIC
  8598                 OR
  8599             COPIESI EQUAL '0'
  8600             MOVE ER-0184        TO EMI-ERROR
  8601             MOVE -1             TO COPIESL
  8602             MOVE AL-UABON       TO COPIESA
  8603             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8604         ELSE
  8605             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  8606             MOVE AL-UANON       TO COPIESA
  8607     ELSE
  8608         IF FORMI EQUAL '9999'
  8609             MOVE 1              TO PI-689-NUMBER-COPIES
  8610                                    COPIESL
  8611                                    COPIESO.
  8612
  8613     IF  FORML NOT EQUAL ZEROS
  8614         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8615         MOVE FORMI              TO PI-689-FORM-NUMBER.
  8616
  8617     MOVE SPACES                 TO W-HOLD-IND.
  8618
  8619     IF PI-CERT-REQ-IND = 'Y'
  8620       IF  CERTIDL NOT EQUAL ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL689.cbl
  8621         IF CERTIDI NUMERIC
  8622             MOVE AL-UANON      TO CERTIDA
  8623             MOVE CERTIDI       TO PI-CERT-FORM-ID
  8624         ELSE
  8625             MOVE ER-1778       TO EMI-ERROR
  8626             MOVE -1            TO CERTIDL
  8627             MOVE AL-UABON      TO CERTIDA
  8628             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8629         END-IF
  8630       ELSE
  8631          MOVE ER-0715       TO EMI-ERROR
  8632          MOVE -1            TO CERTIDL
  8633          MOVE AL-UABON      TO CERTIDA
  8634          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8635       END-IF
  8636     END-IF.
  8637
  8638     IF  NOT EMI-NO-ERRORS
  8639         IF  EMI-ERROR EQUAL ER-7250
  8640             GO TO 0350-EXIT
  8641         ELSE
  8642            MOVE -1             TO MAINTL
  8643            GO TO 8200-SEND-DATAONLY.
  8644
  8645 0350-EXIT.
  8646      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL689.cbl
  8648 0360-EDIT-PRINT-RESTRICTIONS.
  8649
  8650*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  8651*                                TO W-UPPER-CASE.
  8652*
  8653*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  8654*                                     OR 'P' OR LOW-VALUES)
  8655*            AND
  8656*        PRTRESTI EQUAL 'C'
  8657*            AND
  8658*        PI-689-CONTROL NOT GREATER THAN ZEROS
  8659*        MOVE ER-7243            TO EMI-ERROR
  8660*        MOVE -1                 TO PRTRESTL
  8661*        MOVE AL-UABON           TO PRTRESTA
  8662*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8663*        GO TO 0360-EXIT.
  8664*
  8665*    IF  PRTRESTL NOT EQUAL ZEROS
  8666*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  8667*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  8668*            MOVE AL-UANON       TO PRTRESTA
  8669*        ELSE
  8670*            IF  PRTRESTI EQUAL ' '
  8671*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  8672*                MOVE AL-UANON   TO PRTRESTA
  8673*            ELSE
  8674*                MOVE ER-7393    TO EMI-ERROR
  8675*                MOVE -1         TO PRTRESTL
  8676*                MOVE AL-UABON   TO PRTRESTA
  8677*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8678*
  8679*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  8680*            AND
  8681*        W-HOLD-ON
  8682*            AND
  8683*        PI-689-CONTROL NOT GREATER THAN ZEROS
  8684*        MOVE ER-7243            TO EMI-ERROR
  8685*        MOVE -1                 TO PRTRESTL
  8686*        MOVE AL-UABON           TO PRTRESTA
  8687*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8688     .
  8689 0360-EXIT.
  8690      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL689.cbl
  8692 0400-EL6311-INCOMING.
  8693
  8694     MOVE ZEROS                  TO PI-CURRENT-LINE
  8695                                    PI-TEMP-STOR-ITEMS
  8696                                    PI-TOTAL-LINES
  8697                                    PI-UPDATE-SW
  8698                                    PI-689-NUMBER-LABEL-LINES
  8699                                    PI-689-ERROR
  8700                                    PI-689-NUMBER-TEXT-RECORDS.
  8701     MOVE SPACES                 TO PI-689-PRINT-SW
  8702                                    PI-689-ALT-PRINTER-ID
  8703                                    PI-COMM-CONTROL
  8704                                    PI-689-FORM-NUMBER
  8705                                    PI-689-TEMP-STOR-ID
  8706                                    PI-689-LABEL-SOURCE
  8707                                    PI-689-USE-SCREEN-IND.
  8708
  8709     IF PI-CREATE-LABELS
  8710         MOVE  AL-UANON          TO ADDRLBLA
  8711         MOVE  +1                TO ADDRLBLL.
  8712
  8713     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8714                                    PI-689-LBL-OVERRIDE.
  8715
  8716     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  8717     MOVE '2'                    TO PI-ACTION.
  8718     MOVE -1                     TO MAINTL.
  8719
  8720     MOVE AL-UANON               TO PRTNOWA.
  8721     MOVE +1                     TO PRTNOWL.
  8722     MOVE 'N'                    TO PRTNOWI
  8723                                    PI-PRINT-NOW.
  8724
  8725     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  8726         MOVE AL-UANON           TO CARRIERA
  8727         MOVE +1                 TO CARRIERL
  8728         MOVE PI-689-CARRIER     TO CARRIERI.
  8729
  8730     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  8731         MOVE +6                 TO GROUPL
  8732         MOVE AL-UANON           TO GROUPA
  8733         MOVE PI-689-GROUPING    TO GROUPI.
  8734
  8735     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  8736         MOVE +2                 TO STATEL
  8737         MOVE AL-UANON           TO STATEA
  8738         MOVE PI-689-STATE       TO STATEI.
  8739
  8740     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  8741         MOVE +10                TO ACCTL
  8742         MOVE AL-UANON           TO ACCTA
  8743         MOVE PI-689-ACCOUNT     TO ACCTI.
  8744
  8745     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  8746         MOVE +10                TO CERTL
  8747         MOVE AL-UANON           TO CERTA
  8748         MOVE PI-689-CERT-PRIME  TO CERTI.
  8749
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL689.cbl
  8750     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  8751         MOVE +1                 TO SFXL
  8752         MOVE AL-UANON           TO SFXA
  8753         MOVE PI-689-CERT-SFX    TO SFXI.
  8754
  8755     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  8756         MOVE +6                 TO BENTRYL
  8757         MOVE AL-UANON           TO BENTRYA
  8758         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  8759
  8760     MOVE +4                     TO BCSEQL.
  8761     MOVE AL-UANON               TO BCSEQA.
  8762     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  8763
  8764     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  8765         MOVE +8                 TO SEQL
  8766         MOVE AL-UANON           TO SEQA
  8767         MOVE PI-689-SEQ-NO      TO SEQI.
  8768
  8769     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  8770         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  8771         MOVE ' '                TO DC-OPTION-CODE
  8772         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8773         MOVE +8                 TO DATEL
  8774         MOVE DC-GREG-DATE-1-EDIT
  8775                                 TO DATEI
  8776         MOVE AL-UANON           TO DATEA.
  8777
  8778     MOVE -1                     TO MAINTL.
  8779     MOVE '4'                    TO DATASORI
  8780                                    PI-689-DATA-SOURCE.
  8781     MOVE +1                     TO DATASORL.
  8782     MOVE AL-UANON               TO DATASORA.
  8783
  8784     GO TO 8100-SEND-INITIAL-MAP.
  8785
  8786 0400-EXIT.
  8787      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL689.cbl
  8789 0450-SPECIAL-INPUT-PROCESS.
  8790
  8791     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  8792             AND
  8793         PI-CARRIER GREATER THAN LOW-VALUES
  8794         MOVE '1'                TO DATASORI
  8795                                    PI-689-DATA-SOURCE
  8796         MOVE PI-CARRIER         TO CARRIERI
  8797         MOVE PI-GROUPING        TO GROUPI
  8798         MOVE PI-STATE           TO STATEI
  8799         MOVE PI-ACCOUNT         TO ACCTI
  8800         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  8801         MOVE ' '                TO DC-OPTION-CODE
  8802         PERFORM 9500-LINK-DATE-CONVERT
  8803             THRU 9500-EXIT
  8804         MOVE DC-GREG-DATE-1-EDIT
  8805                                 TO DATEI
  8806         MOVE 'N'                TO PRTNOWI
  8807                                    PI-PRINT-NOW
  8808         MOVE AL-UANON           TO ACCTA
  8809                                    CARRIERA
  8810                                    DATEA
  8811                                    DATASORA
  8812                                    GROUPA
  8813                                    STATEA
  8814                                    PRTNOWA
  8815         MOVE +1                 TO CARRIERL
  8816                                    DATASORL
  8817                                    PRTNOWL
  8818         MOVE -1                 TO MAINTL
  8819         MOVE +6                 TO GROUPL
  8820         MOVE +2                 TO STATEL
  8821         MOVE +8                 TO DATEL
  8822         MOVE +10                TO ACCTL
  8823     ELSE
  8824         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  8825                 AND
  8826             PI-CARRIER GREATER THAN LOW-VALUES
  8827             MOVE '3'            TO DATASORI
  8828                                    PI-689-DATA-SOURCE
  8829             MOVE PI-CR-CARRIER  TO CARRIERI
  8830             MOVE PI-CR-GROUPING TO GROUPI
  8831             MOVE PI-CR-ACCOUNT  TO ACCTI
  8832             MOVE PI-CR-FIN-RESP TO RPERSONI
  8833             MOVE PI-CR-TYPE     TO TYPEI
  8834             MOVE 'N'            TO PRTNOWI
  8835                                    PI-PRINT-NOW
  8836             MOVE AL-UANON       TO CARRIERA
  8837                                    GROUPA
  8838                                    ACCTA
  8839                                    DATASORA
  8840                                    RPERSONA
  8841                                    TYPEA
  8842                                    PRTNOWA
  8843             MOVE +1             TO CARRIERL
  8844                                    DATASORL
  8845                                    TYPEL
  8846                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL689.cbl
  8847             MOVE -1             TO MAINTL
  8848             MOVE +6             TO GROUPL
  8849             MOVE +10            TO ACCTL
  8850                                    RPERSONL
  8851         ELSE
  8852             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  8853                     AND
  8854                 PI-CARRIER GREATER THAN LOW-VALUES
  8855                 MOVE '2'        TO DATASORI
  8856                                    PI-689-DATA-SOURCE
  8857                 MOVE PI-CARRIER TO CARRIERI
  8858                 MOVE PI-GROUPING
  8859                                 TO GROUPI
  8860                 MOVE PI-STATE   TO STATEI
  8861                 MOVE PI-ACCOUNT TO ACCTI
  8862                 MOVE PI-CERT-PRIME
  8863                                 TO CERTI
  8864                 MOVE PI-CERT-SFX
  8865                                 TO SFXI
  8866                 MOVE PI-CERT-EFF-DT
  8867                                 TO DC-BIN-DATE-1
  8868                 MOVE ' '        TO DC-OPTION-CODE
  8869                 PERFORM 9500-LINK-DATE-CONVERT
  8870                     THRU 9500-EXIT
  8871                 MOVE DC-GREG-DATE-1-EDIT
  8872                                 TO DATEI
  8873                 MOVE 'N'        TO PRTNOWI
  8874                                    PI-PRINT-NOW
  8875                 MOVE AL-UANON   TO CARRIERA
  8876                                    GROUPA
  8877                                    STATEA
  8878                                    ACCTA
  8879                                    CERTA
  8880                                    SFXA
  8881                                    DATEA
  8882                                    ADDRSA
  8883                                    DATASORA
  8884                                    PRTNOWA
  8885                 MOVE +1         TO CARRIERL
  8886                                    SFXL
  8887                                    DATASORL
  8888                                    ADDRSL
  8889                                    PRTNOWL
  8890                 MOVE -1         TO MAINTL
  8891                 MOVE +6         TO GROUPL
  8892                 MOVE +2         TO STATEL
  8893                 MOVE +8         TO DATEL
  8894                 MOVE +10        TO ACCTL
  8895                                    CERTL.
  8896
  8897     IF PI-CREATE-LABELS
  8898         MOVE  AL-UANON          TO ADDRLBLA
  8899         MOVE  +1                TO ADDRLBLL.
  8900
  8901     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8902                                    PI-689-LBL-OVERRIDE.
  8903
  8904     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL689.cbl
  8905     GO TO 8100-SEND-INITIAL-MAP.
  8906
  8907 0450-EXIT.
  8908      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL689.cbl
  8910 0600-BYPASS-SCREEN-CNTL.
  8911***************************************************************
  8912*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  8913*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  8914*     PERFORMING ANY SCREEN IO.                               *
  8915***************************************************************
  8916
  8917
  8918* EXEC CICS HANDLE CONDITION
  8919*        PGMIDERR (9700-PGMID-ERROR)
  8920*        MAPFAIL  (0325-MAPFAIL)
  8921*        ERROR    (9800-ABEND)
  8922*    END-EXEC.
  8923*    MOVE '"$L?.                 ! % #00008833' TO DFHEIV0
  8924     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  8925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8926     MOVE X'2520233030303038383333' TO DFHEIV0(25:11)
  8927     CALL 'kxdfhei1' USING DFHEIV0
  8928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8929
  8930
  8931     MOVE LOW-VALUES             TO EL689AI.
  8932
  8933     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  8934
  8935     MOVE PI-689-FORM-NUMBER     TO FORMI.
  8936     MOVE +4                     TO FORML.
  8937
  8938     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  8939         MOVE PI-689-NUMBER-COPIES
  8940                                 TO COPIESI
  8941         MOVE +1                 TO COPIESL.
  8942
  8943     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  8944     MOVE +1                     TO ADDRSL.
  8945     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  8946     MOVE +1                     TO DATASORL.
  8947
  8948*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  8949*        MOVE PI-689-PRINT-RESTRICTION
  8950*                                TO PRTRESTI
  8951*        MOVE +1                 TO PRTRESTL.
  8952
  8953     MOVE SPACES                 TO PI-689-PRINT-SW
  8954                                    PI-689-LBL-OVERRIDE.
  8955     MOVE ZEROS                  TO PI-TOTAL-LINES
  8956                                    PI-CURRENT-LINE
  8957                                    PI-TEMP-STOR-ITEMS
  8958                                    PI-UPDATE-SW
  8959                                    PI-689-ERROR
  8960                                    PI-689-NUMBER-LABEL-LINES
  8961                                    PI-689-NUMBER-TEXT-RECORDS.
  8962
  8963     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  8964         MOVE +4                 TO PRINTERL
  8965         MOVE PI-689-ALT-PRINTER-ID
  8966                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  8967
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL689.cbl
  8968     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  8969
  8970     IF  PI-689-SOURCE-VARIABLE
  8971         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  8972
  8973     MOVE SPACES                 TO W-CNTL-KEY
  8974     MOVE LOW-VALUES             TO W-ACCT-KEY
  8975                                    W-CERT-KEY
  8976                                    W-CHEK-KEY
  8977                                    W-COMP-KEY
  8978                                    W-MAIL-KEY
  8979                                    W-PNDB-KEY
  8980                                    W-PNDB2-KEY
  8981                                    W-PYAJ-KEY.
  8982
  8983     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  8984     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  8985                                    W-CERT-COMPANY-CD
  8986                                    W-CHEK-COMPANY-CD
  8987                                    W-COMP-COMPANY-CD
  8988                                    W-MAIL-COMPANY-CD
  8989                                    W-PNDB-COMPANY-CD
  8990                                    W-PNDB2-COMPANY-CD
  8991                                    W-PYAJ-COMPANY-CD.
  8992
  8993     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  8994         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  8995                                    W-CERT-CARRIER
  8996                                    W-MAIL-CARRIER
  8997                                    W-CERT-CARRIER
  8998                                    W-COMP-CARRIER
  8999                                    W-CHEK-CARRIER
  9000                                    W-PNDB2-CARRIER
  9001                                    W-PYAJ-CARRIER.
  9002
  9003     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9004         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9005                                    W-CERT-GROUPING
  9006                                    W-CHEK-GROUPING
  9007                                    W-COMP-GROUPING
  9008                                    W-MAIL-GROUPING
  9009                                    W-PNDB2-GROUPING
  9010                                    W-PYAJ-GROUPING.
  9011
  9012     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9013         MOVE PI-689-STATE       TO W-ACCT-STATE
  9014                                    W-CERT-STATE
  9015                                    W-CHEK-STATE
  9016                                    W-MAIL-STATE
  9017                                    W-PNDB2-STATE.
  9018
  9019     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9020         IF PI-689-DATA-SOURCE = '3' OR '6'
  9021             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9022                                    W-PYAJ-ACCOUNT
  9023         ELSE
  9024             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9025                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL689.cbl
  9026                                    W-CHEK-ACCOUNT
  9027                                    W-MAIL-ACCOUNT
  9028                                    W-PNDB2-ACCOUNT.
  9029
  9030     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9031         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9032                                    W-CHEK-EFF-DT
  9033                                    W-MAIL-EFF-DT
  9034                                    W-PNDB2-EFF-DT.
  9035
  9036     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9037         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9038                                    W-CHEK-CERT-PRIME
  9039                                    W-MAIL-CERT-PRIME
  9040                                    W-PNDB2-CERT-PRIME
  9041
  9042         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9043             MOVE PI-689-CERT-SFX
  9044                                 TO W-CERT-CERT-SFX
  9045                                    W-CHEK-CERT-SFX
  9046                                    W-MAIL-CERT-SFX
  9047                                    W-PNDB2-CERT-SFX
  9048         ELSE
  9049             MOVE SPACES         TO W-CERT-CERT-SFX
  9050                                    W-CHEK-CERT-SFX
  9051                                    W-MAIL-CERT-SFX
  9052                                    W-PNDB2-CERT-SFX.
  9053
  9054     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9055         IF PI-689-DATA-SOURCE = '3' OR '6'
  9056             MOVE PI-689-RESP-PERSON
  9057                                 TO W-COMP-RESP-PERSON
  9058                                    W-PYAJ-FIN-RESP.
  9059
  9060     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9061         IF PI-689-DATA-SOURCE = '3' OR '6'
  9062             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9063                                    W-PYAJ-RECORD-TYPE
  9064         ELSE
  9065             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9066
  9067     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9068         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9069                                    W-PYAJ-FILE-SEQ-NO
  9070                                    W-CHEK-SEQ-NO.
  9071
  9072     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9073         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9074                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9075
  9076     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9077         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9078
  9079     IF  PI-689-NO-ERRORS-DETECTED
  9080         PERFORM 2000-CREATE THRU 2000-EXIT
  9081         IF  NOT PI-689-FATAL-ERROR
  9082                 AND
  9083             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL689.cbl
  9084             IF  PI-689-PRINT-ONLY
  9085                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9086             ELSE
  9087                 IF  PI-689-PRINT-FIRST
  9088                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9089                     IF  NOT PI-689-FATAL-ERROR
  9090                         IF  PI-689-ARCHIVE-LETTER
  9091                             PERFORM 5400-LETTER-RELEASE
  9092                                 THRU 5400-EXIT
  9093                         ELSE
  9094                             MOVE ER-7390
  9095                                 TO PI-689-ERROR
  9096                     ELSE
  9097                         NEXT SENTENCE
  9098                 ELSE
  9099                     IF  NOT PI-689-ARCHIVE-LETTER
  9100                         MOVE ER-7390
  9101                                 TO PI-689-ERROR
  9102                     ELSE
  9103                         PERFORM 5400-LETTER-RELEASE
  9104                             THRU 5400-EXIT
  9105                         IF  NOT PI-689-FATAL-ERROR
  9106                             IF  PI-689-PRINT-SECOND
  9107                                 PERFORM 7900-PRINT-LETTER-NOW
  9108                                     THRU 7900-EXIT.
  9109
  9110 0600-EXIT.
  9111     EXIT.
  9112
  9113 0620-RETURN-TO-CALLER.
  9114
  9115     MOVE PROGRAM-INTERFACE-BLOCK
  9116                                 TO DFHCOMMAREA.
  9117
  9118* EXEC CICS RETURN
  9119*    END-EXEC.
  9120*    MOVE '.(                    &   #00009025' TO DFHEIV0
  9121     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9122     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9123     MOVE X'2020233030303039303235' TO DFHEIV0(25:11)
  9124     CALL 'kxdfhei1' USING DFHEIV0,
  9125           DFHEIV99,
  9126           DFHEIV99,
  9127           DFHEIV99,
  9128           DFHEIV99,
  9129           DFHEIV99
  9130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9131
  9132
  9133 0700-GET-VARIABLE-LABEL.
  9134
  9135     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9136         MOVE '(VARIABLE NOT PROVIDED)'
  9137                                 TO W-RC-TEXT (1)
  9138                                    W-VG-TEXT (48)
  9139         GO TO 0700-EXIT.
  9140
  9141     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL689.cbl
  9142                                    W-VG-TEXT (48).
  9143     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9144                                    W-VG-TEXT (49).
  9145     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9146                                    W-VG-TEXT (50).
  9147     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9148                                    W-VG-TEXT (51).
  9149     SET W-RG-NDX                TO +5.
  9150
  9151 0700-EXIT.
  9152     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL689.cbl
  9154 0800-EDIT-KEY-FIELDS.
  9155***************************************************************
  9156*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9157*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9158*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9159*     PROCESSING.                                             *
  9160***************************************************************
  9161     MOVE SPACES                 TO W-CNTL-KEY
  9162     MOVE LOW-VALUES             TO W-ACCT-KEY
  9163                                    W-CERT-KEY
  9164                                    W-CHEK-KEY
  9165                                    W-COMP-KEY
  9166                                    W-MAIL-KEY
  9167                                    W-PNDB-KEY
  9168                                    W-PNDB2-KEY
  9169                                    W-PYAJ-KEY.
  9170
  9171     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9172     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9173                                    W-CERT-COMPANY-CD
  9174                                    W-CHEK-COMPANY-CD
  9175                                    W-COMP-COMPANY-CD
  9176                                    W-MAIL-COMPANY-CD
  9177                                    W-PNDB-COMPANY-CD
  9178                                    W-PNDB2-COMPANY-CD
  9179                                    W-PYAJ-COMPANY-CD.
  9180
  9181     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  9182     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  9183     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  9184     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  9185     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  9186     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  9187     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  9188     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  9189     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  9190     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  9191     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  9192     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  9193     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  9194     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  9195
  9196     IF  DATASORI NUMERIC
  9197         MOVE DATASORI           TO W-DATA-SOURCE
  9198                                    PI-689-DATA-SOURCE
  9199         GO TO 0800-SOURCE-ACCOUNT
  9200               0800-SOURCE-CERTIFICATE
  9201               0800-SOURCE-COMPENSATION
  9202               0800-SOURCE-PENDING
  9203               0800-SOURCE-CHEK
  9204               0800-SOURCE-PAYMENTS-ADJS
  9205                                 DEPENDING ON W-DATA-SOURCE.
  9206
  9207     IF  FORMI NOT EQUAL '9999'
  9208         MOVE ER-7365            TO EMI-ERROR
  9209         MOVE -1                 TO MAINTL
  9210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9211         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL689.cbl
  9212
  9213     ELSE
  9214         GO TO 0800-EXIT.
  9215
  9216 0800-SOURCE-ACCOUNT.
  9217
  9218     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  9219             OR
  9220         W-ACCT-CARRIER EQUAL LOW-VALUES
  9221             OR
  9222         W-ACCT-GROUPING EQUAL LOW-VALUES
  9223             OR
  9224         W-ACCT-STATE EQUAL LOW-VALUES
  9225             OR
  9226         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  9227             OR
  9228         W-ACCT-EXP-DT EQUAL LOW-VALUES
  9229         MOVE ER-7376            TO EMI-ERROR
  9230         MOVE -1                 TO MAINTL
  9231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9232
  9233     GO TO 0800-ERROR-TEST.
  9234
  9235 0800-SOURCE-CERTIFICATE.
  9236
  9237     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  9238             OR
  9239         W-CERT-CARRIER EQUAL LOW-VALUES
  9240             OR
  9241         W-CERT-GROUPING EQUAL LOW-VALUES
  9242             OR
  9243         W-CERT-STATE EQUAL LOW-VALUES
  9244             OR
  9245         W-CERT-ACCOUNT EQUAL LOW-VALUES
  9246             OR
  9247         W-CERT-EFF-DT EQUAL LOW-VALUES
  9248             OR
  9249         W-CERT-CERT-NO EQUAL LOW-VALUES
  9250         MOVE ER-7377            TO EMI-ERROR
  9251         MOVE -1                 TO MAINTL
  9252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9253
  9254     GO TO 0800-ERROR-TEST.
  9255
  9256 0800-SOURCE-COMPENSATION.
  9257
  9258     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  9259             OR
  9260         W-COMP-CARRIER EQUAL LOW-VALUES
  9261             OR
  9262         W-COMP-GROUPING EQUAL LOW-VALUES
  9263             OR
  9264         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  9265             OR
  9266         W-COMP-TYPE EQUAL LOW-VALUES
  9267             OR
  9268         (W-COMP-TYPE EQUAL 'A'
  9269                 AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL689.cbl
  9270             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  9271         MOVE ER-7378            TO EMI-ERROR
  9272         MOVE -1                 TO MAINTL
  9273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9274
  9275     GO TO 0800-ERROR-TEST.
  9276
  9277 0800-SOURCE-PENDING.
  9278
  9279     IF  BENTRYL EQUAL ZEROS
  9280         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  9281                 OR
  9282             W-PNDB2-CARRIER EQUAL LOW-VALUES
  9283                 OR
  9284             W-PNDB2-GROUPING EQUAL LOW-VALUES
  9285                 OR
  9286             W-PNDB2-STATE EQUAL LOW-VALUES
  9287                 OR
  9288             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  9289                 OR
  9290             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  9291                 OR
  9292             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  9293                 OR
  9294             W-PNDB2-TYPE EQUAL LOW-VALUES
  9295                 OR
  9296             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  9297             MOVE ER-7379        TO EMI-ERROR
  9298             MOVE -1             TO MAINTL
  9299             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9300         ELSE
  9301             NEXT SENTENCE
  9302     ELSE
  9303         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  9304                 OR
  9305             W-PNDB-ENTRY EQUAL LOW-VALUES
  9306                 OR
  9307             W-PNDB-SEQ-NO EQUAL ZEROS
  9308             MOVE ER-7379        TO EMI-ERROR
  9309             MOVE -1             TO MAINTL
  9310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9311
  9312     GO TO 0800-ERROR-TEST.
  9313
  9314 0800-SOURCE-CHEK.
  9315
  9316     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  9317             OR
  9318         W-CHEK-CARRIER EQUAL LOW-VALUES
  9319             OR
  9320         W-CHEK-GROUPING EQUAL LOW-VALUES
  9321             OR
  9322         W-CHEK-STATE EQUAL LOW-VALUES
  9323             OR
  9324         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  9325             OR
  9326         W-CHEK-EFF-DT EQUAL LOW-VALUES
  9327             OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL689.cbl
  9328         W-CHEK-CERT-NO EQUAL LOW-VALUES
  9329         MOVE ER-7381            TO EMI-ERROR
  9330         MOVE -1                 TO MAINTL
  9331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9332
  9333     GO TO 0800-ERROR-TEST.
  9334
  9335 0800-SOURCE-PAYMENTS-ADJS.
  9336
  9337     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  9338             OR
  9339         W-PYAJ-CARRIER EQUAL LOW-VALUES
  9340             OR
  9341         W-PYAJ-GROUPING EQUAL LOW-VALUES
  9342             OR
  9343         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  9344             OR
  9345         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  9346             OR
  9347         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  9348         MOVE ER-7396            TO EMI-ERROR
  9349         MOVE -1                 TO MAINTL
  9350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9351
  9352     GO TO 0800-ERROR-TEST.
  9353
  9354 0800-ERROR-TEST.
  9355
  9356     IF  NOT EMI-NO-ERRORS
  9357         IF  EMI-ERROR EQUAL ER-7250
  9358             GO TO 0800-EXIT
  9359         ELSE
  9360             GO TO 8200-SEND-DATAONLY.
  9361
  9362 0800-EXIT.
  9363     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL689.cbl
  9365 0900-EDIT-CARRIER.
  9366
  9367     IF  CARRIERL EQUAL ZEROES
  9368         MOVE LOW-VALUES         TO PI-689-CARRIER
  9369                                    W-ACCT-CARRIER
  9370                                    W-CERT-CARRIER
  9371                                    W-COMP-CARRIER
  9372                                    W-CHEK-CARRIER
  9373                                    W-MAIL-CARRIER
  9374                                    W-PNDB2-CARRIER
  9375                                    W-PYAJ-CARRIER
  9376     ELSE
  9377         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9378
  9379 0900-EXIT.
  9380     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL689.cbl
  9382 0905-EDIT-GROUPING.
  9383
  9384     IF  GROUPL EQUAL ZEROES
  9385         MOVE LOW-VALUES         TO PI-689-GROUPING
  9386                                    W-ACCT-GROUPING
  9387                                    W-CERT-GROUPING
  9388                                    W-CHEK-GROUPING
  9389                                    W-COMP-GROUPING
  9390                                    W-MAIL-GROUPING
  9391                                    W-PNDB2-GROUPING
  9392                                    W-PYAJ-GROUPING
  9393     ELSE
  9394         MOVE AL-UANON           TO GROUPA
  9395         MOVE GROUPI             TO PI-689-GROUPING
  9396                                    W-ACCT-GROUPING
  9397                                    W-CERT-GROUPING
  9398                                    W-CHEK-GROUPING
  9399                                    W-COMP-GROUPING
  9400                                    W-MAIL-GROUPING
  9401                                    W-PNDB2-GROUPING
  9402                                    W-PYAJ-GROUPING.
  9403
  9404 0905-EXIT.
  9405     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL689.cbl
  9407 0910-EDIT-STATE.
  9408
  9409     IF  STATEL EQUAL ZEROES
  9410         MOVE LOW-VALUES         TO PI-689-STATE
  9411                                    W-ACCT-STATE
  9412                                    W-CERT-STATE
  9413                                    W-CHEK-STATE
  9414                                    W-MAIL-STATE
  9415                                    W-PNDB2-STATE
  9416     ELSE
  9417         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9418
  9419 0910-EXIT.
  9420     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL689.cbl
  9422 0915-EDIT-ACCOUNT.
  9423
  9424     IF  ACCTL EQUAL ZEROES
  9425         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9426                                    W-ACCT-ACCOUNT
  9427                                    W-CERT-ACCOUNT
  9428                                    W-CHEK-ACCOUNT
  9429                                    W-COMP-ACCOUNT
  9430                                    W-MAIL-ACCOUNT
  9431                                    W-PNDB2-ACCOUNT
  9432                                    W-PYAJ-ACCOUNT
  9433     ELSE
  9434         MOVE AL-UANON           TO ACCTA
  9435         MOVE ACCTI              TO PI-689-ACCOUNT
  9436                                    W-ACCT-ACCOUNT
  9437                                    W-CERT-ACCOUNT
  9438                                    W-CHEK-ACCOUNT
  9439                                    W-COMP-ACCOUNT
  9440                                    W-MAIL-ACCOUNT
  9441                                    W-PYAJ-ACCOUNT
  9442                                    W-PNDB2-ACCOUNT.
  9443
  9444 0915-EXIT.
  9445     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL689.cbl
  9447 0920-EDIT-EXP-DATE.
  9448
  9449     IF  DATEL NOT EQUAL ZEROS
  9450         IF  DATEI EQUAL '99/99/99' OR '999999'
  9451             MOVE '99/99/99'     TO DATEO
  9452                                    PI-689-DATE-EDIT
  9453             MOVE AL-UANON       TO DATEA
  9454             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
  9455                                    W-ACCT-EXP-DT
  9456         ELSE
  9457             MOVE DATEI          TO W-DEEDIT-FIELD
  9458             PERFORM 8600-DEEDIT
  9459             MOVE W-DEEDIT-FIELD-V0
  9460                                 TO DC-GREG-DATE-1-MDY
  9461             MOVE '4'            TO DC-OPTION-CODE
  9462             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9463             IF  DATE-CONVERSION-ERROR
  9464                 MOVE ER-0454    TO EMI-ERROR
  9465                 MOVE -1         TO DATEL
  9466                 MOVE AL-UABON   TO DATEA
  9467                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9468             ELSE
  9469                 MOVE DC-GREG-DATE-1-EDIT
  9470                                 TO DATEO
  9471                                    PI-689-DATE-EDIT
  9472                 MOVE AL-UANON   TO DATEA
  9473                 MOVE DC-BIN-DATE-1
  9474                                 TO PI-689-EXP-DATE
  9475                                    W-ACCT-EXP-DT
  9476     ELSE
  9477         MOVE LOW-VALUES         TO PI-689-EXP-DATE
  9478                                    W-ACCT-EXP-DT
  9479                                    PI-689-DATE-EDIT.
  9480
  9481 0920-EXIT.
  9482     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL689.cbl
  9484 0925-EDIT-EFF-DATE.
  9485
  9486     IF  CERTL EQUAL ZERO
  9487             AND
  9488         DATASORI NOT EQUAL '2'
  9489         GO TO 0925-EXIT.
  9490
  9491     IF  DATEL NOT EQUAL ZEROS
  9492         MOVE DATEI              TO W-DEEDIT-FIELD
  9493         PERFORM 8600-DEEDIT
  9494         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9495         MOVE '4'                TO DC-OPTION-CODE
  9496         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9497
  9498         IF  DATE-CONVERSION-ERROR
  9499             MOVE ER-0215        TO EMI-ERROR
  9500             MOVE -1             TO DATEL
  9501             MOVE AL-UABON       TO DATEA
  9502             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9503         ELSE
  9504             MOVE DC-GREG-DATE-1-EDIT
  9505                                 TO DATEO
  9506                                    PI-689-DATE-EDIT
  9507             MOVE AL-UANON       TO DATEA
  9508             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
  9509                                    W-CERT-EFF-DT
  9510                                    W-CHEK-EFF-DT
  9511                                    W-MAIL-EFF-DT
  9512                                    W-PNDB2-EFF-DT
  9513     ELSE
  9514         MOVE LOW-VALUES         TO PI-689-EFF-DATE
  9515                                    W-PNDB2-EFF-DT
  9516                                    W-CHEK-EFF-DT
  9517                                    W-MAIL-EFF-DT
  9518                                    W-CERT-EFF-DT
  9519                                    PI-689-DATE-EDIT.
  9520
  9521 0925-EXIT.
  9522     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL689.cbl
  9524 0930-EDIT-CERTIFICATE.
  9525
  9526     IF  CERTL EQUAL ZEROES
  9527         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
  9528                                    W-CERT-CERT-PRIME
  9529                                    W-CHEK-CERT-PRIME
  9530                                    W-MAIL-CERT-PRIME
  9531                                    W-PNDB2-CERT-PRIME
  9532                                    PI-689-CERT-SFX
  9533                                    W-CERT-CERT-SFX
  9534                                    W-CHEK-CERT-SFX
  9535                                    W-MAIL-CERT-SFX
  9536                                    W-PNDB2-CERT-SFX
  9537     ELSE
  9538         MOVE AL-UANON           TO CERTA
  9539         MOVE CERTI              TO PI-689-CERT-PRIME
  9540                                    W-CERT-CERT-PRIME
  9541                                    W-CHEK-CERT-PRIME
  9542                                    W-MAIL-CERT-PRIME
  9543                                    W-PNDB2-CERT-PRIME
  9544         IF  SFXL EQUAL ZEROES
  9545                 OR
  9546             SFXI EQUAL LOW-VALUES
  9547             MOVE SPACES         TO PI-689-CERT-SFX
  9548                                    W-CERT-CERT-SFX
  9549                                    W-CHEK-CERT-SFX
  9550                                    W-MAIL-CERT-SFX
  9551                                    W-PNDB2-CERT-SFX
  9552         ELSE
  9553             MOVE AL-UANON       TO SFXA
  9554             MOVE SFXI           TO PI-689-CERT-SFX
  9555                                    W-CERT-CERT-SFX
  9556                                    W-CHEK-CERT-SFX
  9557                                    W-MAIL-CERT-SFX
  9558                                    W-PNDB2-CERT-SFX.
  9559
  9560 0930-EXIT.
  9561     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL689.cbl
  9563 0935-EDIT-RESP-PERSON.
  9564
  9565     IF  RPERSONL EQUAL ZEROES
  9566         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
  9567                                    W-COMP-RESP-PERSON
  9568                                    W-PYAJ-FIN-RESP
  9569     ELSE
  9570         MOVE AL-UANON           TO RPERSONA
  9571         MOVE RPERSONI           TO PI-689-RESP-PERSON
  9572                                    W-PYAJ-FIN-RESP
  9573                                    W-COMP-RESP-PERSON.
  9574
  9575 0935-EXIT.
  9576     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL689.cbl
  9578 0940-EDIT-ACCOUNT.
  9579
  9580     IF  ACCTL EQUAL ZEROES
  9581         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9582                                    W-COMP-ACCOUNT
  9583                                    W-PYAJ-ACCOUNT
  9584     ELSE
  9585         MOVE AL-UANON           TO ACCTA
  9586         MOVE ACCTI              TO PI-689-ACCOUNT
  9587                                    W-PYAJ-ACCOUNT
  9588                                    W-COMP-ACCOUNT.
  9589
  9590 0940-EXIT.
  9591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL689.cbl
  9593 0945-EDIT-TYPE.
  9594
  9595     IF  TYPEL EQUAL ZEROES
  9596         MOVE LOW-VALUES         TO PI-689-TYPE
  9597                                    W-COMP-TYPE
  9598                                    W-PYAJ-RECORD-TYPE
  9599     ELSE
  9600         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9601         IF TYPEI = 'C' OR 'G' OR 'A'
  9602             MOVE AL-UANON       TO TYPEA
  9603             MOVE TYPEI          TO PI-689-TYPE
  9604                                    W-COMP-TYPE
  9605                                    W-PYAJ-RECORD-TYPE
  9606         ELSE
  9607             MOVE ER-7368        TO EMI-ERROR
  9608             MOVE -1             TO TYPEL
  9609             MOVE AL-UABON       TO TYPEA
  9610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9611
  9612 0945-EXIT.
  9613     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL689.cbl
  9615 0950-EDIT-ENTRY.
  9616
  9617     IF  BENTRYL EQUAL ZEROES
  9618         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
  9619                                    W-PNDB-ENTRY
  9620     ELSE
  9621         MOVE AL-UANON           TO BENTRYA
  9622         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
  9623                                    W-PNDB-ENTRY.
  9624
  9625 0950-EXIT.
  9626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL689.cbl
  9628 0955-EDIT-SEQUENCE.
  9629
  9630     IF  SEQL NOT EQUAL ZEROS
  9631         IF  SEQI NOT NUMERIC
  9632                 OR
  9633             SEQI EQUAL '0'
  9634             MOVE ER-7367        TO EMI-ERROR
  9635             MOVE -1             TO SEQL
  9636             MOVE AL-UABON       TO SEQA
  9637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9638         ELSE
  9639             MOVE AL-UANON       TO SEQA
  9640             MOVE SEQI           TO PI-689-SEQ-NO
  9641                                    W-CHEK-SEQ-NO
  9642                                    W-PYAJ-FILE-SEQ-NO
  9643                                    W-PNDB-SEQ-NO
  9644                                    PI-689-SEQ-EDIT
  9645     ELSE
  9646         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
  9647
  9648 0955-EXIT.
  9649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL689.cbl
  9651 0960-EDIT-BATCH-SEQ.
  9652
  9653     IF  BCSEQL NOT EQUAL ZEROS
  9654         IF  BCSEQI NOT NUMERIC
  9655             MOVE ER-7368        TO EMI-ERROR
  9656             MOVE -1             TO BCSEQL
  9657             MOVE AL-UABON       TO BCSEQA
  9658             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9659         ELSE
  9660             MOVE AL-UANON       TO BCSEQA
  9661             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
  9662                                    W-PNDB-CHG-SEQ-NO
  9663                                    W-PNDB2-ALT-CHG-SEQ-NO
  9664                                    PI-689-BCSEQ-EDIT
  9665     ELSE
  9666         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
  9667
  9668 0960-EXIT.
  9669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL689.cbl
  9671 0965-EDIT-TYPE.
  9672
  9673     IF  TYPEL EQUAL ZEROES
  9674         MOVE LOW-VALUES         TO PI-689-TYPE
  9675                                    W-PNDB2-TYPE
  9676     ELSE
  9677         IF  DATASORI NOT EQUAL '4'
  9678             GO TO 0965-EXIT
  9679         ELSE
  9680             IF TYPEI = '0' OR '1' OR '2' OR '3'
  9681                 MOVE AL-UANON   TO TYPEA
  9682                 MOVE TYPEI      TO PI-689-TYPE
  9683                                    W-PNDB2-TYPE
  9684             ELSE
  9685                 MOVE ER-7370    TO EMI-ERROR
  9686                 MOVE -1         TO TYPEL
  9687                 MOVE AL-UABON   TO TYPEA
  9688                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9689
  9690 0965-EXIT.
  9691     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL689.cbl
  9693 0990-CARRIER-VALIDITY-CHECK.
  9694
  9695     IF  CARRIERI EQUAL SPACES
  9696         GO TO 0990-EXIT.
  9697
  9698     MOVE SPACES                 TO W-CNTL-KEY.
  9699     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9700     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
  9701     MOVE CARRIERI               TO W-CNTL-GEN4.
  9702     MOVE +0                     TO W-CNTL-SEQ-NO.
  9703
  9704
  9705* EXEC CICS HANDLE CONDITION
  9706*        NOTFND  (0990-CARRIER-NOT-FOUND)
  9707*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9708*    END-EXEC.
  9709*    MOVE '"$IJ                  ! & #00009599' TO DFHEIV0
  9710     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9712     MOVE X'2620233030303039353939' TO DFHEIV0(25:11)
  9713     CALL 'kxdfhei1' USING DFHEIV0
  9714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9715
  9716
  9717
  9718* EXEC CICS READ
  9719*        DATASET (W-CNTL-FILE-ID)
  9720*        SET     (ADDRESS OF CONTROL-FILE)
  9721*        RIDFLD  (W-CNTL-KEY)
  9722*    END-EXEC.
  9723*    MOVE '&"S        E          (   #00009604' TO DFHEIV0
  9724     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9725     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9726     MOVE X'2020233030303039363034' TO DFHEIV0(25:11)
  9727     CALL 'kxdfhei1' USING DFHEIV0,
  9728           W-CNTL-FILE-ID,
  9729           DFHEIV20,
  9730           DFHEIV99,
  9731           W-CNTL-KEY,
  9732           DFHEIV99,
  9733           DFHEIV99,
  9734           DFHEIV99
  9735     SET ADDRESS OF CONTROL-FILE TO
  9736         DFHEIV20
  9737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9738
  9739
  9740     IF  PI-NO-CARRIER-SECURITY
  9741             OR
  9742         PI-CARRIER-SECURITY EQUAL CARRIERI
  9743         MOVE AL-UANON           TO CARRIERA
  9744         MOVE CARRIERI           TO PI-689-CARRIER
  9745                                    W-ACCT-CARRIER
  9746                                    W-CERT-CARRIER
  9747                                    W-CHEK-CARRIER
  9748                                    W-COMP-CARRIER
  9749                                    W-MAIL-CARRIER
  9750                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL689.cbl
  9751                                    W-PYAJ-CARRIER
  9752     ELSE
  9753         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  9754         MOVE ER-9095            TO EMI-ERROR
  9755         MOVE -1                 TO MAINTL
  9756         MOVE AL-UANON           TO MAINTA
  9757         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9758
  9759     GO TO 0990-EXIT.
  9760
  9761 0990-CARRIER-NOT-FOUND.
  9762
  9763     MOVE -1                     TO CARRIERL.
  9764     MOVE AL-UABON               TO CARRIERA.
  9765     MOVE ER-2208                TO EMI-ERROR.
  9766     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9767
  9768 0990-EXIT.
  9769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL689.cbl
  9771 0994-STATE-VALIDITY-CHECK.
  9772
  9773     IF  STATEI EQUAL SPACES
  9774         GO TO 0994-EXIT.
  9775
  9776     MOVE SPACES                 TO W-CNTL-KEY.
  9777     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9778     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
  9779     MOVE STATEI                 TO W-CNTL-GEN1.
  9780     MOVE +0                     TO W-CNTL-SEQ-NO.
  9781
  9782
  9783* EXEC CICS HANDLE CONDITION
  9784*        NOTFND  (0994-STATE-NOT-FOUND)
  9785*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9786*    END-EXEC.
  9787*    MOVE '"$IJ                  ! '' #00009652' TO DFHEIV0
  9788     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9790     MOVE X'2720233030303039363532' TO DFHEIV0(25:11)
  9791     CALL 'kxdfhei1' USING DFHEIV0
  9792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9793
  9794
  9795
  9796* EXEC CICS READ
  9797*        DATASET (W-CNTL-FILE-ID)
  9798*        SET     (ADDRESS OF CONTROL-FILE)
  9799*        RIDFLD  (W-CNTL-KEY)
  9800*    END-EXEC.
  9801*    MOVE '&"S        E          (   #00009657' TO DFHEIV0
  9802     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9803     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9804     MOVE X'2020233030303039363537' TO DFHEIV0(25:11)
  9805     CALL 'kxdfhei1' USING DFHEIV0,
  9806           W-CNTL-FILE-ID,
  9807           DFHEIV20,
  9808           DFHEIV99,
  9809           W-CNTL-KEY,
  9810           DFHEIV99,
  9811           DFHEIV99,
  9812           DFHEIV99
  9813     SET ADDRESS OF CONTROL-FILE TO
  9814         DFHEIV20
  9815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9816
  9817
  9818     MOVE AL-UANON               TO STATEA.
  9819     MOVE STATEI                 TO PI-689-STATE
  9820                                    W-ACCT-STATE
  9821                                    W-CERT-STATE
  9822                                    W-CHEK-STATE
  9823                                    W-MAIL-STATE
  9824                                    W-PNDB2-STATE.
  9825
  9826     GO TO 0994-EXIT.
  9827
  9828 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL689.cbl
  9829
  9830     MOVE -1                     TO STATEL.
  9831     MOVE AL-UABON               TO STATEA.
  9832     MOVE ER-2209                TO EMI-ERROR.
  9833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9834
  9835 0994-EXIT.
  9836     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL689.cbl
  9838 1000-SHOW.
  9839***************************************************************
  9840*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  9841*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
  9842*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
  9843*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
  9844***************************************************************
  9845
  9846     MOVE SPACES                 TO W-RECORD-TABLE.
  9847
  9848     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
  9849          MOVE PI-689-LBL-OVERRIDE
  9850                                 TO ADDRLBLI
  9851          MOVE +1                TO ADDRLBLL
  9852          MOVE AL-UANON          TO ADDRLBLA
  9853     ELSE
  9854          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
  9855          MOVE +1                TO ADDRLBLL
  9856          MOVE AL-UANON          TO ADDRLBLA.
  9857
  9858     IF  ARCHNUML EQUAL ZEROS
  9859         MOVE -1                 TO ARCHNUML
  9860         MOVE AL-UNBON           TO ARCHNUMA
  9861         MOVE ER-0174            TO EMI-ERROR
  9862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9863         GO TO 8200-SEND-DATAONLY.
  9864
  9865     IF  ARCHNUMI NOT NUMERIC
  9866         MOVE -1                 TO ARCHNUML
  9867         MOVE AL-UNBON           TO ARCHNUMA
  9868         MOVE ER-0175            TO EMI-ERROR
  9869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9870         GO TO 8200-SEND-DATAONLY.
  9871
  9872     IF  PI-SHOW-MODE
  9873
  9874         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
  9875             MOVE -1             TO MAINTL
  9876             GO TO 8200-SEND-DATAONLY
  9877         ELSE
  9878             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
  9879
  9880     MOVE +0                     TO W-ARCH-SEQ-NO
  9881                                    W-ARCT-SEQ-NO.
  9882     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
  9883                                    W-ARCT-COMPANY-CD.
  9884     MOVE ARCHNUMI               TO W-ARCH-NUMBER
  9885                                    W-ARCT-NUMBER
  9886                                    PI-689-ARCHIVE-NUMBER.
  9887     MOVE ' '                    TO W-ARCT-REC-TYPE.
  9888     MOVE '1'                    TO PI-ACTION.
  9889     MOVE SPACES                 TO PI-689-PRINT-SW
  9890                                    PI-689-FORM-NUMBER
  9891                                    W-DELETE-KEY.
  9892     SET W-RG-NDX                TO W-ZEROS.
  9893
  9894
  9895* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL689.cbl
  9896*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  9897*         NOTFND     (1070-ARCH-NOT-FOUND)
  9898*         ENDFILE    (1070-ARCH-NOT-FOUND)
  9899*    END-EXEC.
  9900*    MOVE '"$JI''                 ! ( #00009739' TO DFHEIV0
  9901     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  9902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9903     MOVE X'2820233030303039373339' TO DFHEIV0(25:11)
  9904     CALL 'kxdfhei1' USING DFHEIV0
  9905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9906
  9907
  9908
  9909* EXEC CICS READ
  9910*        DATASET (W-ARCH-FILE-ID)
  9911*        SET     (ADDRESS OF LETTER-ARCHIVE)
  9912*        RIDFLD  (W-ARCH-KEY)
  9913*    END-EXEC.
  9914*    MOVE '&"S        E          (   #00009745' TO DFHEIV0
  9915     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9917     MOVE X'2020233030303039373435' TO DFHEIV0(25:11)
  9918     CALL 'kxdfhei1' USING DFHEIV0,
  9919           W-ARCH-FILE-ID,
  9920           DFHEIV20,
  9921           DFHEIV99,
  9922           W-ARCH-KEY,
  9923           DFHEIV99,
  9924           DFHEIV99,
  9925           DFHEIV99
  9926     SET ADDRESS OF LETTER-ARCHIVE TO
  9927         DFHEIV20
  9928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9929
  9930
  9931     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
  9932
  9933*    EXEC CICS HANDLE CONDITION
  9934*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  9935*         NOTFND     (1020-ARCT-ENDBR)
  9936*         ENDFILE    (1020-ARCT-ENDBR)
  9937*    END-EXEC.
  9938*
  9939*1005-START-BROWSE.
  9940*
  9941*    EXEC CICS STARTBR
  9942*         DATASET    (W-ARCT-FILE-ID)
  9943*         RIDFLD     (W-ARCT-KEY)
  9944*         GTEQ
  9945*    END-EXEC.
  9946*
  9947*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
  9948*
  9949*1010-READ-NEXT.
  9950*
  9951*    EXEC CICS READNEXT
  9952*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
  9953*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL689.cbl
  9954*         RIDFLD    (W-ARCT-KEY)
  9955*    END-EXEC.
  9956*
  9957*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
  9958*        IF  LT-ADDRESS-DATA
  9959*            IF  PI-CREATE-LABELS  AND
  9960*                NOT PI-689-LABELS-OVERRIDEN
  9961*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
  9962*                        VARYING
  9963*                    LT-NDX FROM 1 BY 1
  9964*                        UNTIL
  9965*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
  9966*                GO TO 1010-READ-NEXT
  9967*            ELSE
  9968*                MOVE LT-CONTROL-PRIMARY
  9969*                                TO W-DELETE-KEY
  9970*                GO TO 1010-READ-NEXT
  9971*        ELSE
  9972*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
  9973*                    VARYING
  9974*                LT-NDX FROM 1 BY 1
  9975*                    UNTIL
  9976*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
  9977*                    OR
  9978*                LT-NDX GREATER THAN +20
  9979*            GO TO 1010-READ-NEXT.
  9980*
  9981*1020-ARCT-ENDBR.
  9982*
  9983*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
  9984*        EXEC CICS ENDBR
  9985*             DATASET   (W-ARCT-FILE-ID)
  9986*        END-EXEC.
  9987*
  9988*    IF  W-RG-NDX EQUAL ZEROS
  9989*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
  9990*
  9991*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
  9992*            AND
  9993*        PI-BYPASS-LABELS
  9994*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
  9995*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
  9996*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
  9997*
  9998*    SET PI-TOTAL-LINES          TO W-RG-NDX.
  9999*    MOVE 1                      TO PI-CURRENT-LINE.
 10000*    SET W-RG-NDX                TO +1.
 10001*
 10002*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10003*            VARYING
 10004*        W-SC-NDX FROM 1 BY 1
 10005*            UNTIL
 10006*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10007
 10008     MOVE -1                     TO MAINTL.
 10009     GO TO 8100-SEND-INITIAL-MAP.
 10010
 10011 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL689.cbl
 10012     EXIT.
 10013
 10014 1030-TEXT-BUILD.
 10015
 10016     SET W-RG-NDX UP BY 1.
 10017     MOVE LT-SKIP-CONTROL (LT-NDX)
 10018                                 TO W-PRINT-CONTROL.
 10019
 10020     IF  W-PRINT-CONTROL EQUAL 99
 10021         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10022         SET W-RG-NDX UP BY 1
 10023     ELSE
 10024         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10025
 10026     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10027     MOVE LT-SKIP-CONTROL (LT-NDX)
 10028                                 TO W-RC-PC (W-RG-NDX).
 10029     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10030
 10031 1030-EXIT.
 10032     EXIT.
 10033
 10034 1040-FORMAT-HEADER-DATA.
 10035
 10036     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10037     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10038     MOVE LA-CARRIER-A2          TO CARRIERO.
 10039     MOVE LA-CERT-NO-A2          TO CERTO.
 10040     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10041     MOVE LA-DATA-SOURCE         TO DATASORO.
 10042
 10043     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10044         MOVE ZEROES             TO DATEO
 10045
 10046     ELSE
 10047         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10048         MOVE ' '                TO DC-OPTION-CODE
 10049         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10050         MOVE DC-GREG-DATE-1-EDIT
 10051                                 TO DATEO.
 10052
 10053     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10054         MOVE ZEROES             TO FOLLOWO
 10055     ELSE
 10056         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10057         MOVE ' '                TO DC-OPTION-CODE
 10058         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10059         MOVE DC-GREG-DATE-1-EDIT
 10060                                 TO FOLLOWO.
 10061
 10062     MOVE LA-FORM-A3             TO FORMO.
 10063     MOVE LA-GROUPING-A2         TO GROUPO.
 10064     MOVE LA-NO-OF-COPIES        TO COPIESO
 10065                                    PI-689-NUMBER-COPIES.
 10066
 10067*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10068*        MOVE LA-PRINT-RESTRICTION
 10069*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL689.cbl
 10070*    ELSE
 10071*        MOVE SPACES             TO PRTRESTO.
 10072
 10073     IF  LA-RESEND-DATE = LOW-VALUES
 10074         MOVE ZEROES             TO RESEND1O
 10075     ELSE
 10076         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10077         MOVE ' '                TO DC-OPTION-CODE
 10078         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10079         MOVE DC-GREG-DATE-1-EDIT
 10080                                 TO RESEND1O.
 10081
 10082     MOVE LA-STATE-A2            TO STATEO.
 10083
 10084     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10085
 10086 1040-EXIT.
 10087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL689.cbl
 10089 1050-MOVE-LABELS.
 10090
 10091     SET W-RG-NDX                TO LT-NDX.
 10092     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10093     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10094     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10095
 10096 1050-EXIT.
 10097     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL689.cbl
 10099 1060-DELETE-ADDRESS-RECORD.
 10100
 10101
 10102* EXEC CICS DELETE
 10103*        DATASET (W-ARCT-FILE-ID)
 10104*        RIDFLD  (W-DELETE-KEY)
 10105*    END-EXEC.
 10106*    MOVE '&(  R                 &   #00009921' TO DFHEIV0
 10107     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10108     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10109     MOVE X'2020233030303039393231' TO DFHEIV0(25:11)
 10110     CALL 'kxdfhei1' USING DFHEIV0,
 10111           W-ARCT-FILE-ID,
 10112           W-DELETE-KEY,
 10113           DFHEIV99,
 10114           DFHEIV99,
 10115           DFHEIV99
 10116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10117
 10118
 10119
 10120* EXEC CICS READ
 10121*        DATASET (W-ARCH-FILE-ID)
 10122*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10123*        RIDFLD  (W-ARCH-KEY)
 10124*        UPDATE
 10125*    END-EXEC.
 10126*    MOVE '&"S        EU         (   #00009926' TO DFHEIV0
 10127     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10128     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10129     MOVE X'2020233030303039393236' TO DFHEIV0(25:11)
 10130     CALL 'kxdfhei1' USING DFHEIV0,
 10131           W-ARCH-FILE-ID,
 10132           DFHEIV20,
 10133           DFHEIV99,
 10134           W-ARCH-KEY,
 10135           DFHEIV99,
 10136           DFHEIV99,
 10137           DFHEIV99
 10138     SET ADDRESS OF LETTER-ARCHIVE TO
 10139         DFHEIV20
 10140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10141
 10142
 10143     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 10144
 10145
 10146* EXEC CICS REWRITE
 10147*         FROM      (LETTER-ARCHIVE)
 10148*         DATASET   (W-ARCH-FILE-ID)
 10149*    END-EXEC.
 10150     MOVE LENGTH OF
 10151      LETTER-ARCHIVE
 10152       TO DFHEIV11
 10153*    MOVE '&& L                  %   #00009935' TO DFHEIV0
 10154     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10155     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10156     MOVE X'2020233030303039393335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL689.cbl
 10157     CALL 'kxdfhei1' USING DFHEIV0,
 10158           W-ARCH-FILE-ID,
 10159           LETTER-ARCHIVE,
 10160           DFHEIV11,
 10161           DFHEIV99
 10162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10163
 10164
 10165 1060-EXIT.
 10166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL689.cbl
 10168 1070-ARCH-NOT-FOUND.
 10169
 10170     MOVE ER-7371                TO EMI-ERROR.
 10171     MOVE -1                     TO ARCHNUML.
 10172     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10173     GO TO 8100-SEND-INITIAL-MAP.
 10174
 10175 1080-ARCHIVE-TEXT-NOT-FOUND.
 10176
 10177     MOVE ER-7372                TO EMI-ERROR.
 10178     MOVE -1                     TO ARCHNUML.
 10179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10180     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL689.cbl
 10182 2000-CREATE.
 10183***************************************************************
 10184*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 10185*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 10186*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 10187*    WILL BE DISPLAYED ON THE SCREEN.                         *
 10188*                                                             *
 10189***************************************************************
 10190
 10191***************************************************************
 10192*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 10193*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 10194*    THEN FORCE AN ERROR.                                     *
 10195***************************************************************
 10196
 10197     IF  PI-689-CREATE-NO-SCREENS
 10198         GO TO 2000-GET-TEXT.
 10199
 10200     IF  PI-CREATE-MODE
 10201         IF  PI-689-PRINT-PERFORMED
 10202                 AND
 10203             FORMI NOT EQUAL 9999
 10204             MOVE ER-0279    TO EMI-ERROR
 10205             MOVE -1         TO MAINTL
 10206             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10207             GO TO 8200-SEND-DATAONLY.
 10208
 10209     IF  ARCHNUML GREATER THAN ZEROS
 10210         MOVE ER-9320            TO EMI-ERROR
 10211         MOVE -1                 TO ARCHNUML
 10212         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10213         GO TO 8200-SEND-DATAONLY.
 10214
 10215***************************************************************
 10216*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 10217*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 10218***************************************************************
 10219
 10220     IF  FORMI EQUAL '9999'
 10221         MOVE 16                 TO PI-TOTAL-LINES
 10222         MOVE 1                  TO PI-CURRENT-LINE
 10223         MOVE SPACES             TO W-FILE-TABLE
 10224                                    W-LINE-CONTROL-RECORD
 10225                                    W-RECORD-TABLE
 10226                                    W-SINGLE-LINE
 10227                                    W-SQUEEZED-LINE
 10228                                    W-TS-WORK-AREA
 10229                                    W-TX-TABLE
 10230         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 10231         MOVE '3'                TO PI-ACTION
 10232         MOVE FORMI              TO PI-689-FORM-NUMBER
 10233                                    PI-COMM-CONTROL
 10234         MOVE ZEROS              TO PI-UPDATE-SW
 10235         MOVE W-PGM-EL1042       TO W-CALL-PGM
 10236         GO TO 9400-XCTL.
 10237
 10238 2000-GET-TEXT.
 10239
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL689.cbl
 10240     MOVE SPACES                 TO W-FILE-TABLE
 10241                                    W-LINE-CONTROL-RECORD
 10242                                    W-RECORD-TABLE
 10243                                    W-SINGLE-LINE
 10244                                    W-SQUEEZED-LINE
 10245                                    W-TS-WORK-AREA
 10246                                    W-TX-TABLE.
 10247     SET W-TG-NDX                TO +1
 10248     MOVE ZEROS                  TO W-INITIAL-COLUMN
 10249                                    W-LINE-COUNT
 10250                                    W-LINE-INDENT-1
 10251                                    W-LINE-INDENT-2
 10252                                    W-LINE-INDENT-3
 10253                                    W-LINE-INDENT-4
 10254                                    W-LINE-INDENT-5
 10255                                    W-PAGE
 10256                                    W-PARAGRAPH-INDENT
 10257                                    W-TOP-MARGIN
 10258                                    W-WORK-INDENT.
 10259     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 10260     MOVE +70                    TO W-LAST-COLUMN.
 10261     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 10262     MOVE +1                     TO W-START-COLUMN.
 10263     MOVE +71                    TO W-TOO-FAR.
 10264
 10265     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 10266     MOVE FORMI                  TO W-TEXT-LETTER.
 10267     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 10268     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 10269
 10270
 10271* EXEC CICS HANDLE CONDITION
 10272*         NOTFND     (2001-NOT-FOUND)
 10273*         ENDFILE    (2001-NOT-FOUND)
 10274*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 10275*    END-EXEC.
 10276*    MOVE '"$I''J                 ! ) #00010045' TO DFHEIV0
 10277     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10279     MOVE X'2920233030303130303435' TO DFHEIV0(25:11)
 10280     CALL 'kxdfhei1' USING DFHEIV0
 10281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10282
 10283
 10284
 10285* EXEC CICS STARTBR
 10286*         DATASET    (W-TEXT-FILE-ID)
 10287*         RIDFLD     (W-TEXT-KEY)
 10288*         GTEQ
 10289*    END-EXEC.
 10290     MOVE 0
 10291       TO DFHEIV11
 10292*    MOVE '&,         G          &   #00010051' TO DFHEIV0
 10293     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10295     MOVE X'2020233030303130303531' TO DFHEIV0(25:11)
 10296     CALL 'kxdfhei1' USING DFHEIV0,
 10297           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL689.cbl
 10298           W-TEXT-KEY,
 10299           DFHEIV99,
 10300           DFHEIV11,
 10301           DFHEIV99
 10302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10303
 10304
 10305
 10306* EXEC CICS HANDLE CONDITION
 10307*         ENDFILE    (2000-ENDBR)
 10308*    END-EXEC.
 10309*    MOVE '"$''                   ! * #00010057' TO DFHEIV0
 10310     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10312     MOVE X'2A20233030303130303537' TO DFHEIV0(25:11)
 10313     CALL 'kxdfhei1' USING DFHEIV0
 10314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10315
 10316
 10317 2000-READ-NEXT.
 10318
 10319     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10320         MOVE ER-0051            TO EMI-ERROR
 10321         MOVE -1                 TO MAINTL
 10322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10323         GO TO 2000-ENDBR.
 10324
 10325
 10326* EXEC CICS READNEXT
 10327*         DATASET    (W-TEXT-FILE-ID)
 10328*         SET        (ADDRESS OF TEXT-FILES)
 10329*         RIDFLD     (W-TEXT-KEY)
 10330*    END-EXEC.
 10331     MOVE 0
 10332       TO DFHEIV11
 10333*    MOVE '&.S                   )   #00010069' TO DFHEIV0
 10334     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10335     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10336     MOVE X'2020233030303130303639' TO DFHEIV0(25:11)
 10337     CALL 'kxdfhei1' USING DFHEIV0,
 10338           W-TEXT-FILE-ID,
 10339           DFHEIV20,
 10340           DFHEIV99,
 10341           W-TEXT-KEY,
 10342           DFHEIV99,
 10343           DFHEIV11,
 10344           DFHEIV99,
 10345           DFHEIV99
 10346     SET ADDRESS OF TEXT-FILES TO
 10347         DFHEIV20
 10348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10349
 10350
 10351     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10352         GO TO 2000-ENDBR.
 10353
 10354     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10355
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL689.cbl
 10356     MOVE TX-FORM-SQUEEZE-CONTROL
 10357                                 TO W-FORM-SQUEEZE-IND.
 10358
 10359     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10360         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10361
 10362     IF  TX-FORM-CONTROL-LINE
 10363         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10364         GO TO 2000-READ-NEXT.
 10365
 10366     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10367         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10368         GO TO 2000-READ-NEXT.
 10369
 10370     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10371     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10372     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10373     MOVE TX-LINE-SQUEEZE-CONTROL
 10374                                 TO W-TX-SC (W-TG-NDX).
 10375
 10376     SET W-TG-NDX UP BY 1.
 10377     GO TO 2000-READ-NEXT.
 10378
 10379 2000-ENDBR.
 10380
 10381
 10382* EXEC CICS ENDBR
 10383*        DATASET     (W-TEXT-FILE-ID)
 10384*    END-EXEC.
 10385     MOVE 0
 10386       TO DFHEIV11
 10387*    MOVE '&2                    $   #00010105' TO DFHEIV0
 10388     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10389     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10390     MOVE X'2020233030303130313035' TO DFHEIV0(25:11)
 10391     CALL 'kxdfhei1' USING DFHEIV0,
 10392           W-TEXT-FILE-ID,
 10393           DFHEIV11,
 10394           DFHEIV99
 10395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10396
 10397
 10398     IF  W-TEXT-BROWSE-NOT-STARTED
 10399         MOVE ER-0006            TO EMI-ERROR
 10400         MOVE -1                 TO FORML
 10401         MOVE AL-UABON           TO FORMA
 10402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10403         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10404
 10405     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 10406     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 10407     MOVE 1                      TO PI-CURRENT-LINE.
 10408
 10409     IF  COPIESL NOT GREATER THAN ZEROS
 10410         MOVE +1                 TO COPIESI
 10411                                    PI-689-NUMBER-COPIES
 10412         MOVE +1                 TO COPIESL
 10413         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL689.cbl
 10414
 10415***************************************************************
 10416*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 10417*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 10418***************************************************************
 10419
 10420     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 10421
 10422*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 10423*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 10424*            MOVE ER-7243        TO EMI-ERROR
 10425*            MOVE -1             TO PRTRESTL
 10426*            MOVE AL-UABON       TO PRTRESTA
 10427*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10428
 10429     IF  PI-CREATE-LABELS AND
 10430         NOT  PI-689-LABELS-OVERRIDEN
 10431         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 10432         SET W-RG-NDX UP BY +1
 10433     ELSE
 10434         SET W-RG-NDX            TO +1.
 10435
 10436     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 10437     SET W-RG-NDX UP BY W-TOP-MARGIN.
 10438
 10439     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 10440
 10441     SET PI-TOTAL-LINES          TO W-RG-NDX.
 10442
 10443     IF  W-FIRST-BAD-VARIABLE-FOUND
 10444         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 10445         MOVE W-FIRST-BAD-VARIABLE
 10446                                 TO PI-CURRENT-LINE
 10447     ELSE
 10448         SET W-RG-NDX            TO 1.
 10449
 10450     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10451             VARYING
 10452         W-SC-NDX FROM 1 BY 1
 10453             UNTIL
 10454         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10455     IF  PI-689-CREATE-NO-SCREENS
 10456         GO TO 2000-EXIT
 10457     ELSE
 10458         IF  W-FORM-CHANGED
 10459             MOVE '3'            TO PI-ACTION
 10460             MOVE -1             TO MAINTL
 10461             GO TO 8100-SEND-INITIAL-MAP
 10462         ELSE
 10463             MOVE '3'            TO PI-ACTION
 10464             MOVE -1             TO MAINTL
 10465             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10466
 10467 2000-EXIT.
 10468     EXIT.
 10469
 10470 2001-NOT-FOUND.
 10471
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL689.cbl
 10472     MOVE ER-0006                TO EMI-ERROR.
 10473     MOVE -1                     TO FORML.
 10474     MOVE AL-UABON               TO FORMA.
 10475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10476     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL689.cbl
 10478 2100-PROCESS-FORM-CONTROL-LINE.
 10479
 10480     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 10481
 10482     IF  W-LC-LINE-WIDTH NUMERIC
 10483             AND
 10484         W-LC-LINE-WIDTH GREATER THAN ZEROS
 10485         COMPUTE W-INITIAL-COLUMN
 10486             = (70 - W-LC-LINE-WIDTH) / 2
 10487         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 10488         COMPUTE W-LAST-COLUMN ROUNDED
 10489             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 10490         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 10491     ELSE
 10492         MOVE 70                 TO W-LC-LINE-WIDTH.
 10493
 10494     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 10495             AND
 10496         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 10497         MOVE W-LC-PARAGRAPH-INDENT
 10498                                 TO W-PARAGRAPH-INDENT.
 10499
 10500     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 10501             AND
 10502         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 10503         MOVE W-LC-MAX-LINES-PER-PAGE
 10504                                 TO W-MAX-LINES-PER-PAGE.
 10505
 10506     IF  W-LC-LINE-ADJUST NUMERIC
 10507             AND
 10508         W-LC-LINE-ADJUST GREATER THAN ZEROS
 10509         COMPUTE W-TOTAL-LINE-LENGTH
 10510             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 10511         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 10512             ADD W-LC-LINE-ADJUST
 10513                                 TO W-INITIAL-COLUMN
 10514                                    W-LAST-COLUMN
 10515                                    W-START-COLUMN
 10516                                    W-TOO-FAR.
 10517
 10518     IF  W-LC-LINE-INDENT-1 NUMERIC
 10519             AND
 10520         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 10521         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 10522     ELSE
 10523         MOVE +0                 TO W-LINE-INDENT-1.
 10524
 10525     IF  W-LC-LINE-INDENT-2 NUMERIC
 10526             AND
 10527         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 10528         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 10529     ELSE
 10530         MOVE +0                 TO W-LINE-INDENT-2.
 10531
 10532     IF  W-LC-LINE-INDENT-3 NUMERIC
 10533             AND
 10534         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 10535         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL689.cbl
 10536     ELSE
 10537         MOVE +0                 TO W-LINE-INDENT-3.
 10538
 10539     IF  W-LC-LINE-INDENT-4 NUMERIC
 10540             AND
 10541         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 10542         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 10543     ELSE
 10544         MOVE +0                 TO W-LINE-INDENT-4.
 10545
 10546     IF  W-LC-LINE-INDENT-5 NUMERIC
 10547             AND
 10548         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 10549         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 10550
 10551     ELSE
 10552         MOVE +0                 TO W-LINE-INDENT-5.
 10553
 10554     IF  W-LC-TOP-MARGIN NUMERIC
 10555         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 10556     ELSE
 10557         MOVE +0                 TO W-TOP-MARGIN.
 10558
 10559     IF W-LC-CASE-IND = 'Y' OR 'N'
 10560         NEXT SENTENCE
 10561     ELSE
 10562         MOVE PI-LOWER-CASE-LETTERS
 10563                                 TO W-LC-CASE-IND.
 10564
 10565 2100-EXIT.
 10566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL689.cbl
 10568 2150-PROCESS-Z-CONTROLS.
 10569
 10570     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 10571
 10572     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 10573        IF W-DAYS-TO-RESEND NUMERIC
 10574           IF W-DAYS-TO-RESEND > ZEROS
 10575              MOVE '6'           TO DC-OPTION-CODE
 10576              MOVE W-SAVE-BIN-DATE
 10577                                 TO DC-BIN-DATE-1
 10578              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 10579              MOVE W-DAYS-TO-RESEND
 10580                                 TO DC-ELAPSED-DAYS
 10581              PERFORM 9500-LINK-DATE-CONVERT
 10582                                 THRU 9500-EXIT
 10583              IF NO-CONVERSION-ERROR
 10584                 MOVE DC-BIN-DATE-2
 10585                                 TO PI-689-RESEND-DATE-1
 10586                 MOVE DC-GREG-DATE-1-EDIT
 10587                                 TO RESEND1O
 10588                                    PI-689-RESEND1-EDIT
 10589                 MOVE AL-UANON
 10590                                 TO RESEND1A
 10591                 MOVE +8         TO RESEND1L
 10592              ELSE
 10593                 MOVE ER-3770
 10594                                 TO EMI-ERROR
 10595                 MOVE -1         TO MAINTL
 10596                 PERFORM 9900-ERROR-FORMAT
 10597                                 THRU 9900-EXIT
 10598                 GO TO 8200-SEND-DATAONLY
 10599              END-IF
 10600           END-IF
 10601        END-IF
 10602     END-IF
 10603     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 10604        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 10605     END-IF
 10606     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10607         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 10608            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 10609                 MOVE '6'        TO DC-OPTION-CODE
 10610                 MOVE W-SAVE-BIN-DATE
 10611                                 TO DC-BIN-DATE-1
 10612                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 10613                 MOVE W-DAYS-TO-FOLLOW-UP
 10614                                 TO DC-ELAPSED-DAYS
 10615                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10616                 IF  NO-CONVERSION-ERROR
 10617                     MOVE DC-BIN-DATE-2
 10618                                 TO PI-689-FOLLOW-UP-DATE
 10619                     MOVE DC-GREG-DATE-1-EDIT
 10620                                 TO FOLLOWO
 10621                     MOVE AL-UANON
 10622                                 TO FOLLOWA
 10623                     MOVE +8     TO FOLLOWL
 10624                 ELSE
 10625                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL689.cbl
 10626                                 TO EMI-ERROR
 10627                     MOVE -1     TO MAINTL
 10628                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10629                     GO TO 8200-SEND-DATAONLY.
 10630
 10631     IF  COPIESI NOT NUMERIC
 10632             OR
 10633         COPIESI NOT GREATER THAN ZEROS
 10634         IF  W-NUMBER-OF-COPIES NUMERIC
 10635             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 10636                 MOVE W-NUMBER-OF-COPIES
 10637                                 TO COPIESI
 10638                                    PI-689-NUMBER-COPIES
 10639                 MOVE AL-UNNON   TO COPIESA
 10640                 MOVE +1         TO COPIESL
 10641             ELSE
 10642                 MOVE +1         TO COPIESI
 10643                                    PI-689-NUMBER-COPIES
 10644                 MOVE AL-UNNON   TO COPIESA
 10645                 MOVE +1         TO COPIESL
 10646         ELSE
 10647             MOVE +1             TO COPIESI
 10648                                    PI-689-NUMBER-COPIES
 10649             MOVE AL-UNNON       TO COPIESA
 10650             MOVE +1             TO COPIESL.
 10651
 10652     IF W-PROMPT-LETTER EQUAL 'Y'
 10653         MOVE 'Y'                TO PI-PROMPT-IND
 10654         MOVE ER-0894            TO EMI-ERROR
 10655         MOVE -1                 TO MAINTL
 10656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10657     END-IF.
 10658
 10659     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 10660                                           ENCO
 10661     MOVE AL-UANON                      TO ENCA
 10662     MOVE +3                            TO ENCL
 10663
 10664     IF W-PRINT-CERTIFICATE = 'Y'
 10665        MOVE 'Y' TO PI-CERT-REQ-IND
 10666        IF CERTIDL > ZEROS
 10667            IF CERTIDI NUMERIC
 10668              MOVE AL-UANON      TO CERTIDA
 10669              MOVE CERTIDI       TO PI-CERT-FORM-ID
 10670            ELSE
 10671              MOVE ER-1778       TO EMI-ERROR
 10672              MOVE -1            TO CERTIDL
 10673              MOVE AL-UABON      TO CERTIDA
 10674              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10675           END-IF
 10676        ELSE
 10677              MOVE ER-0715       TO EMI-ERROR
 10678              MOVE -1            TO CERTIDL
 10679              MOVE AL-UABON      TO CERTIDA
 10680              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10681        END-IF
 10682     END-IF.
 10683
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL689.cbl
 10684*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 10685*                                       SPACES
 10686*        IF  W-PRINT-RESTRICTED
 10687*            MOVE W-PRINT-RESTRICTED-IND
 10688*                                TO PRTRESTI
 10689*                                   PI-689-PRINT-RESTRICTION
 10690*            MOVE AL-UANON       TO PRTRESTA
 10691*            MOVE +1             TO PRTRESTL.
 10692     .
 10693 2150-EXIT.
 10694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL689.cbl
 10696 2200-CHECK-FOR-VARIABLE.
 10697
 10698     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 10699         GO TO 2200-EXIT.
 10700
 10701     SET W-TX-NDX                TO +1.
 10702
 10703 2200-CONTINUE.
 10704
 10705     SEARCH W-TX-CHAR
 10706         VARYING
 10707             W-TX-NDX
 10708         AT END
 10709             GO TO 2200-EXIT
 10710         WHEN
 10711             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10712             NEXT SENTENCE.
 10713
 10714     SET W-TX-NDX UP BY +1.
 10715
 10716     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10717         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 10718         GO TO 2200-CONTINUE.
 10719
 10720 2200-EXIT.
 10721     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL689.cbl
 10723 2220-BUILD-VARIABLE-NUMBER.
 10724
 10725     SET W-TX-NDX UP BY +1.
 10726     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 10727     SET W-TX-NDX UP BY +1.
 10728     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 10729     SET W-TX-NDX UP BY +1.
 10730     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 10731
 10732     IF  W-VAR-RELATIVE-NUM NUMERIC
 10733         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 10734         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 10735
 10736 2220-EXIT.
 10737     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL689.cbl
 10739 4000-ROLL-PAGE.
 10740
 10741     IF  ENTERPFL NOT EQUAL ZEROS
 10742         MOVE -1                 TO ENTERPFL
 10743     ELSE
 10744         MOVE -1                 TO MAINTL.
 10745
 10746     IF  PI-TOTAL-LINES EQUAL 0
 10747         MOVE ER-0047            TO EMI-ERROR
 10748         MOVE -1                 TO MAINTL
 10749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10750         GO TO 8200-SEND-DATAONLY.
 10751
 10752     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 10753         PI-CURRENT-LINE + W-ROLL-COUNTER.
 10754
 10755     IF  W-TEMP-CURRENT-LINE NEGATIVE
 10756             OR
 10757         W-TEMP-CURRENT-LINE EQUAL ZEROS
 10758         MOVE ER-0067            TO EMI-ERROR
 10759         MOVE -1                 TO MAINTL
 10760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10761         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 10762
 10763*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 10764*            AND
 10765*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 10766*        MOVE ER-0066            TO EMI-ERROR
 10767*        MOVE -1                 TO MAINTL
 10768*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10769*        COMPUTE W-TEMP-CURRENT-LINE
 10770*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 10771*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 10772*                OR
 10773*            W-TEMP-CURRENT-LINE = ZEROS
 10774*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 10775
 10776     IF  EMI-ERROR NOT EQUAL ER-0191
 10777             AND
 10778         MAINTI NOT EQUAL 'S'
 10779         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 10780         PERFORM 4100-SET-NDX THRU 4100-EXIT
 10781         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10782                 VARYING
 10783             W-SC-NDX FROM 1 BY 1
 10784                 UNTIL
 10785             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10786
 10787     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 10788                         ER-0191
 10789         NEXT SENTENCE
 10790     ELSE
 10791         GO TO 8200-SEND-DATAONLY.
 10792
 10793     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 10794     SET W-RG-NDX                TO PI-CURRENT-LINE
 10795     MOVE LOW-VALUES             TO EL689RI
 10796*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL689.cbl
 10797     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 10798     SET W-RG-NDX                TO PI-CURRENT-LINE
 10799     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10800             VARYING
 10801         W-SC-NDX FROM 1 BY 1
 10802             UNTIL
 10803         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10804
 10805     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL689.cbl
 10807 4100-SET-NDX.
 10808
 10809     IF  PI-CURRENT-LINE EQUAL 0
 10810         SET W-RG-NDX            TO 1
 10811     ELSE
 10812         SET W-RG-NDX            TO PI-CURRENT-LINE.
 10813
 10814 4100-EXIT.
 10815      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL689.cbl
 10817 4200-UPDATE-TABLE-FROM-SCREEN.
 10818
 10819     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 10820         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 10821         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 10822             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 10823                 MOVE ER-0051    TO EMI-ERROR
 10824                 MOVE -1         TO MAINTL
 10825                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10826                 GO TO 8200-SEND-DATAONLY
 10827             ELSE
 10828                 MOVE W-SC-TEXT (W-SC-NDX)
 10829                                 TO W-RC-TEXT (W-RG-NDX)
 10830                 ADD 1           TO PI-TOTAL-LINES
 10831         ELSE
 10832             MOVE W-SC-TEXT (W-SC-NDX)
 10833                                 TO W-RC-TEXT (W-RG-NDX).
 10834
 10835     SET W-RG-NDX UP BY 1.
 10836
 10837 4200-EXIT.
 10838      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL689.cbl
 10840 5000-EDIT-MODE.
 10841***************************************************************
 10842*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 10843*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 10844*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 10845***************************************************************
 10846
 10847     IF  PI-SHOW-MODE
 10848         MOVE ER-0188            TO EMI-ERROR
 10849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10850         MOVE -1                 TO MAINTL
 10851         MOVE AL-UABON           TO MAINTA
 10852         GO TO 8200-SEND-DATAONLY.
 10853
 10854     IF  PI-CURRENT-LINE EQUAL ZEROS
 10855         MOVE ER-0187            TO EMI-ERROR
 10856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10857         MOVE -1                 TO MAINTL
 10858         GO TO 8200-SEND-DATAONLY.
 10859
 10860     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10861     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 10862     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10863             VARYING
 10864         W-SC-NDX FROM 1 BY 1
 10865             UNTIL
 10866         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10867
 10868     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 10869
 10870     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 10871     MOVE ZEROS                  TO PI-UPDATE-SW.
 10872     MOVE '1'                    TO PI-ENTRY-CD-1.
 10873     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 10874     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL689.cbl
 10876 5400-LETTER-RELEASE.
 10877***************************************************************
 10878*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 10879*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 10880*    THE ARCHIVE FILE.                                        *
 10881*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 10882*        1. CHECK SECURITY.                                   *
 10883*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 10884*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 10885*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 10886*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 10887*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 10888***************************************************************
 10889
 10890     IF  NOT MODIFY-CAP
 10891         MOVE ER-0070            TO EMI-ERROR
 10892         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10893         MOVE -1                 TO MAINTL
 10894         GO TO 8200-SEND-DATAONLY.
 10895
 10896     IF  PI-SHOW-MODE
 10897         MOVE ER-0188            TO EMI-ERROR
 10898         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10899         MOVE -1                 TO MAINTL
 10900         MOVE AL-UABON           TO MAINTA
 10901         GO TO 8200-SEND-DATAONLY.
 10902
 10903     IF  ARCHNUML GREATER THAN ZEROS
 10904         MOVE ER-9320            TO EMI-ERROR
 10905         MOVE -1                 TO ARCHNUML
 10906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10907         GO TO 8200-SEND-DATAONLY.
 10908
 10909*     IF  PI-CURRENT-LINE EQUAL ZEROS
 10910*        MOVE ER-0187            TO EMI-ERROR
 10911*        MOVE -1                 TO MAINTL
 10912*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10913*        GO TO 8200-SEND-DATAONLY.
 10914
 10915*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10916*
 10917*    IF  NOT PI-689-CREATE-NO-SCREENS
 10918*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 10919*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10920*                VARYING
 10921*            W-SC-NDX FROM 1 BY 1
 10922*                UNTIL
 10923*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 10924*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 10925*                OR
 10926*            PI-689-FATAL-ERROR
 10927*            GO TO 8200-SEND-DATAONLY.
 10928*
 10929*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 10930*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 10931*            VARYING
 10932*        W-RVS-NDX FROM +1 BY +1
 10933*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL689.cbl
 10934*        W-RVS-NDX > +36500
 10935*            OR
 10936*        W-REMAINING-VAR-FOUND.
 10937*
 10938*    IF  NOT PI-689-CREATE-NO-SCREENS
 10939*        IF  W-REMAINING-VAR-FOUND
 10940*            GO TO 4000-ROLL-PAGE.
 10941
 10942*    MOVE SPACES                 TO W-CNTL-KEY.
 10943*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10944*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 10945*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 10946*
 10947*    EXEC CICS HANDLE CONDITION
 10948*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 10949*         NOTFND     (5470-CNTL-NOT-FOUND)
 10950*    END-EXEC.
 10951*
 10952*    EXEC CICS READ
 10953*         DATASET    (W-CNTL-FILE-ID)
 10954*         SET        (ADDRESS OF CONTROL-FILE)
 10955*         RIDFLD     (W-CNTL-KEY)
 10956*         UPDATE
 10957*    END-EXEC.
 10958*
 10959*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 10960*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 10961*                                   CF-CREDIT-START-ARCH-NUM.
 10962*
 10963*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 10964*    MOVE CF-CREDIT-LAST-ARCH-NUM
 10965*                                TO W-ARCH-NUMBER
 10966*                                   W-ARCT-NUMBER.
 10967*
 10968*    EXEC CICS REWRITE
 10969*         FROM      (CONTROL-FILE)
 10970*         DATASET   (W-CNTL-FILE-ID)
 10971*    END-EXEC
 10972
 10973*    EXEC CICS HANDLE CONDITION
 10974*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 10975*    END-EXEC.
 10976*
 10977*    EXEC CICS GETMAIN
 10978*       SET      (ADDRESS OF LETTER-ARCHIVE)
 10979*       LENGTH   (W-ARCH-LENGTH)
 10980*    END-EXEC
 10981*
 10982*    MOVE SPACES                 TO LETTER-ARCHIVE
 10983*    MOVE 'LA'                   TO LA-RECORD-ID.
 10984*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 10985*                                   LA-ARCHIVE-NO-A2
 10986*                                   LA-ARCHIVE-NO-A3
 10987*                                   LA-ARCHIVE-NO-A4
 10988*                                   LA-ARCHIVE-NO-A5
 10989*                                   LA-ARCHIVE-NO-A6
 10990*                                   PI-689-ARCHIVE-NUMBER.
 10991*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL689.cbl
 10992*                                   LA-COMPANY-CD-A2
 10993*                                   LA-COMPANY-CD-A3
 10994*                                   LA-COMPANY-CD-A4
 10995*                                   LA-COMPANY-CD-A5
 10996*                                   LA-COMPANY-CD-A6.
 10997*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 10998*                                   LA-CARRIER-A3
 10999*                                   LA-CARRIER-A4
 11000*                                   LA-CARRIER-A5.
 11001*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11002*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11003*                                   LA-GROUPING-A3
 11004*                                   LA-GROUPING-A4
 11005*                                   LA-GROUPING-A5.
 11006*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11007*                                   LA-ACCOUNT-A3
 11008*                                   LA-ACCOUNT-A4
 11009*                                   LA-ACCOUNT-A5.
 11010*    MOVE PI-689-STATE           TO LA-STATE-A2
 11011*                                   LA-STATE-A3
 11012*                                   LA-STATE-A4
 11013*                                   LA-STATE-A5.
 11014*
 11015*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11016*            AND
 11017*        PI-689-RESP-PERSON GREATER THAN SPACES
 11018*        MOVE PI-689-RESP-PERSON
 11019*                                TO LA-RESP-PERSON-A2
 11020*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11021*    ELSE
 11022*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11023*            MOVE PI-689-CERT-PRIME
 11024*                                TO LA-CERT-PRIME-A2
 11025*            MOVE PI-689-CERT-SFX
 11026*                                TO LA-CERT-SUFFIX-A2
 11027*        ELSE
 11028*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11029*                                   LA-TYPE-A2.
 11030*
 11031*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11032*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11033*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11034*                AND
 11035*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11036*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11037*            MOVE 'CK'           TO LA-FILLER
 11038*        ELSE
 11039*            NEXT SENTENCE
 11040*    ELSE
 11041*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11042*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11043*            MOVE 'CK'           TO LA-FILLER
 11044*        ELSE
 11045*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11046*
 11047*    MOVE ZEROS                  TO W-SEQ-CTR.
 11048*
 11049*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL689.cbl
 11050*
 11051*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11052*                                   LA-INITIAL-PRINT-DATE
 11053*                                   LA-SENT-DATE
 11054*                                   LA-REPLY-DATE.
 11055*    MOVE 'A'                    TO LA-STATUS.
 11056*
 11057*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 11058*            OR
 11059*        PI-689-NUMBER-COPIES EQUAL ZEROS
 11060*        MOVE  1                 TO LA-NO-OF-COPIES
 11061*    ELSE
 11062*        MOVE PI-689-NUMBER-COPIES
 11063*                                TO LA-NO-OF-COPIES.
 11064*
 11065*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 11066*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 11067*    MOVE PI-689-PRINT-RESTRICTION
 11068*                                TO LA-PRINT-RESTRICTION
 11069*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 11070*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 11071*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 11072*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 11073*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 11074*
 11075*    IF  PI-689-PRINT-PERFORMED
 11076*        MOVE SPACES             TO PI-689-PRINT-SW
 11077*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 11078*        IF  LA-RESEND-DATE = LOW-VALUES
 11079*            MOVE 'C'            TO LA-STATUS.
 11080*
 11081*    MOVE PI-689-NUMBER-LABEL-LINES
 11082*                                TO LA-NUMBER-LABEL-LINES.
 11083*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 11084*
 11085*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 11086*
 11087*    MOVE PI-689-NUMBER-TEXT-RECORDS
 11088*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 11089*
 11090*    EXEC CICS HANDLE CONDITION
 11091*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 11092*    END-EXEC.
 11093*
 11094*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 11095*    MOVE ER-0280                TO EMI-ERROR.
 11096*    MOVE -1                     TO MAINTL.
 11097*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11098*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11099*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 11100     .
 11101 5400-END.
 11102     DISPLAY ' MADE IT TO 5400 '
 11103     MOVE SPACES                 TO BL-INPUT
 11104     MOVE ZEROS                  TO BL-ARCHIVE-NO
 11105     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 11106     MOVE PI-689-CARRIER         TO BL-CARRIER
 11107     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL689.cbl
 11108     MOVE PI-689-STATE           TO BL-STATE
 11109     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 11110     IF PI-689-EFF-DATE NOT = LOW-VALUES
 11111        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 11112        MOVE ' '                 TO DC-OPTION-CODE
 11113        PERFORM 9500-LINK-DATE-CONVERT
 11114                                 THRU 9500-EXIT
 11115        IF NO-CONVERSION-ERROR
 11116           MOVE DC-GREG-DATE-1-EDIT
 11117                                 TO BL-EFF-DT
 11118        END-IF
 11119     END-IF
 11120     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 11121     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 11122     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 11123     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 11124     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 11125     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 11126     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 11127*    MOVE 'ALWA'                 TO BL-PROC-ID
 11128     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 11129*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 11130     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 11131     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 11132        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 11133        MOVE ' '                 TO DC-OPTION-CODE
 11134        PERFORM 9500-LINK-DATE-CONVERT
 11135                                 THRU 9500-EXIT
 11136        IF NO-CONVERSION-ERROR
 11137           MOVE DC-GREG-DATE-B-EDIT
 11138                                 TO BL-RESEND-DT
 11139        END-IF
 11140     END-IF
 11141     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 11142        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 11143        MOVE ' '                 TO DC-OPTION-CODE
 11144        PERFORM 9500-LINK-DATE-CONVERT
 11145                                 THRU 9500-EXIT
 11146        IF NO-CONVERSION-ERROR
 11147           MOVE DC-GREG-DATE-B-EDIT
 11148                                 TO BL-FOLLOW-UP-DT
 11149        END-IF
 11150     END-IF
 11151*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 11152*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 11153     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 11154     if eibaid = dfhpf7
 11155        move 'B'                 TO BL-WRITE-ERARCH
 11156     else
 11157        move 'T'                 to bl-write-erarch
 11158     end-if
 11159    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 11160*****************************************
 11161* Invoke the LETTER business logic
 11162*****************************************
 11163
 11164* exec cics link
 11165*       program('NSRASBL')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL689.cbl
 11166*       commarea(srch-commarea)
 11167*    end-exec.
 11168     MOVE LENGTH OF
 11169      srch-commarea
 11170       TO DFHEIV11
 11171     MOVE 'NSRASBL' TO DFHEIV1
 11172*    MOVE '."C                   ''   #00010874' TO DFHEIV0
 11173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11175     MOVE X'2020233030303130383734' TO DFHEIV0(25:11)
 11176     CALL 'kxdfhei1' USING DFHEIV0,
 11177           DFHEIV1,
 11178           srch-commarea,
 11179           DFHEIV11,
 11180           DFHEIV99,
 11181           DFHEIV99,
 11182           DFHEIV99
 11183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11184
 11185     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 11186        bl-message ' ' bl-archive-no
 11187     move bl-archive-no to w-arch-number
 11188
 11189     if eibaid = dfhpf7
 11190        MOVE ER-0280                TO EMI-ERROR
 11191        MOVE -1                     TO MAINTL
 11192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11193        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11194        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 11195        MOVE '2'                    TO PI-ACTION
 11196        MOVE ZEROS                  TO PI-TOTAL-LINES
 11197                                       PI-CURRENT-LINE
 11198        MOVE SPACES                 TO PI-689-PRINT-SW
 11199                                       PI-689-FORM-NUMBER
 11200     else
 11201        move w-arch-number          to archnumo
 11202        MOVE ER-1818                TO EMI-ERROR
 11203        MOVE -1                     TO MAINTL
 11204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11205     end-if
 11206     MOVE -1                     TO MAINTL
 11207     GO TO 8200-SEND-DATAONLY
 11208     .
 11209 5400-EXIT.
 11210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL689.cbl
 11212 5410-CREATE-TEXT-RECORDS.
 11213
 11214*    EXEC CICS HANDLE CONDITION
 11215*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 11216*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 11217*    END-EXEC.
 11218*
 11219*    IF  PI-689-CREATE-NO-SCREENS
 11220*        IF  PI-689-GET-ARCT-MAIN
 11221*            EXEC CICS GETMAIN
 11222*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11223*                 LENGTH   (W-ARCT-LENGTH)
 11224*            END-EXEC
 11225*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 11226*                                    LETTER-ARCHIVE-TEXT
 11227*            MOVE LCP-WS-ADDR-COMP
 11228*                                TO PI-689-ARCT-POINTER
 11229*        ELSE
 11230*            MOVE PI-689-ARCT-POINTER
 11231*                                TO LCP-WS-ADDR-COMP
 11232*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 11233*                                TO LCP-WS-ADDR-PNTR
 11234*    ELSE
 11235*        EXEC CICS GETMAIN
 11236*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11237*             LENGTH   (W-ARCT-LENGTH)
 11238*        END-EXEC.
 11239*
 11240*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11241*
 11242*    MOVE ZEROS                  TO W-SEQ-CTR
 11243*
 11244*    IF  PI-CREATE-LABELS AND
 11245*        NOT PI-689-LABELS-OVERRIDEN
 11246*        MOVE '1'                TO LT-RECORD-TYPE
 11247*        MOVE +0                 TO LT-LINE-SEQ-NO
 11248*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 11249*                VARYING
 11250*            W-RG-NDX FROM 1 BY 1
 11251*                UNTIL
 11252*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 11253*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11254*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 11255*    ELSE
 11256*        SET W-RG-NDX            TO +1.
 11257*
 11258*    SET LT-NDX                  TO W-ZEROS.
 11259*
 11260*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 11261*            VARYING
 11262*        W-RG-NDX FROM W-RG-NDX BY +1
 11263*            UNTIL
 11264*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 11265
 11266 5410-EXIT.
 11267     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL689.cbl
 11269 5415-INITIALIZE-TEXT.
 11270
 11271     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 11272     MOVE 'LT'                   TO LT-RECORD-ID.
 11273
 11274     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 11275     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 11276
 11277     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 11278                                    LT-NUM-LINES-ON-RECORD.
 11279
 11280 5415-EXIT.
 11281     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL689.cbl
 11283 5460-DUPLICATE-ARCHIVE-RCD.
 11284
 11285     IF  NOT PI-689-CREATE-NO-SCREENS
 11286
 11287* EXEC CICS SYNCPOINT ROLLBACK
 11288*        END-EXEC.
 11289*    MOVE '6"R                   !   #00010979' TO DFHEIV0
 11290     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11292     MOVE X'2020233030303130393739' TO DFHEIV0(25:11)
 11293     CALL 'kxdfhei1' USING DFHEIV0
 11294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11295
 11296
 11297     MOVE ER-9426                TO EMI-ERROR.
 11298     MOVE -1                     TO MAINTL.
 11299     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11300     GO TO 8200-SEND-DATAONLY.
 11301
 11302 5465-DUPLICATE-ARCH-TEXT.
 11303
 11304     IF  NOT PI-689-CREATE-NO-SCREENS
 11305
 11306* EXEC CICS SYNCPOINT ROLLBACK
 11307*        END-EXEC.
 11308*    MOVE '6"R                   !   #00010990' TO DFHEIV0
 11309     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11311     MOVE X'2020233030303130393930' TO DFHEIV0(25:11)
 11312     CALL 'kxdfhei1' USING DFHEIV0
 11313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11314
 11315
 11316     MOVE ER-7369                TO EMI-ERROR.
 11317     MOVE -1                     TO MAINTL.
 11318     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11319     GO TO 8200-SEND-DATAONLY.
 11320
 11321 5470-CNTL-NOT-FOUND.
 11322
 11323     MOVE ER-9299                TO EMI-ERROR.
 11324     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11325     MOVE -1                     TO MAINTL.
 11326     MOVE AL-UANON               TO MAINTA.
 11327     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL689.cbl
 11329 5500-FORMAT-TEXT.
 11330
 11331     SET LT-NDX UP BY +1.
 11332
 11333     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 11334         SET W-RG-NDX UP BY 1
 11335         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 11336         MOVE W-RC-TEXT (W-RG-NDX)
 11337                                 TO LT-TEXT-LINE (LT-NDX)
 11338     ELSE
 11339         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 11340             MOVE ZEROS          TO W-PRINT-CONTROL
 11341             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 11342                     VARYING
 11343                 W-RG-NDX FROM W-RG-NDX BY 1
 11344                     UNTIL
 11345                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11346                     OR
 11347                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 11348             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11349                 GO TO 5500-WRITE-TEST
 11350             ELSE
 11351                 MOVE W-PRINT-CONTROL
 11352                                 TO LT-SKIP-CONTROL (LT-NDX)
 11353                 MOVE W-RC-TEXT (W-RG-NDX)
 11354                                 TO LT-TEXT-LINE (LT-NDX)
 11355         ELSE
 11356             MOVE W-RC-TEXT (W-RG-NDX)
 11357                                 TO LT-TEXT-LINE (LT-NDX)
 11358             MOVE ZEROS          TO W-PRINT-CONTROL.
 11359
 11360     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 11361
 11362 5500-WRITE-TEST.
 11363
 11364     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 11365         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 11366             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11367             MOVE '2'            TO LT-RECORD-TYPE
 11368             ADD +1              TO W-SEQ-CTR
 11369             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11370             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11371         ELSE
 11372             NEXT SENTENCE
 11373     ELSE
 11374         IF  LT-NDX EQUAL +20
 11375             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11376             MOVE '2'            TO LT-RECORD-TYPE
 11377             ADD +1              TO W-SEQ-CTR
 11378             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11379             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11380             SET LT-NDX          TO W-ZEROS
 11381             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11382
 11383 5500-EXIT.
 11384      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL689.cbl
 11386 5505-FIND-USED-LINE.
 11387
 11388     ADD +1                      TO W-PRINT-CONTROL.
 11389
 11390 5505-EXIT.
 11391      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL689.cbl
 11393 5600-FORMAT-ADDRESS-LINE.
 11394
 11395     SET LT-NDX                  TO W-RG-NDX.
 11396     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 11397
 11398 5600-EXIT.
 11399     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL689.cbl
 11401 5650-WRITE-ARCHIVE.
 11402
 11403
 11404* EXEC CICS WRITE
 11405*         DATASET   (W-ARCH-FILE-ID)
 11406*         FROM      (LETTER-ARCHIVE)
 11407*         RIDFLD    (LA-CONTROL-PRIMARY)
 11408*    END-EXEC.
 11409     MOVE LENGTH OF
 11410      LETTER-ARCHIVE
 11411       TO DFHEIV11
 11412*    MOVE '&$ L                  ''   #00011080' TO DFHEIV0
 11413     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11415     MOVE X'2020233030303131303830' TO DFHEIV0(25:11)
 11416     CALL 'kxdfhei1' USING DFHEIV0,
 11417           W-ARCH-FILE-ID,
 11418           LETTER-ARCHIVE,
 11419           DFHEIV11,
 11420           LA-CONTROL-PRIMARY,
 11421           DFHEIV99,
 11422           DFHEIV99
 11423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11424
 11425
 11426 5650-EXIT.
 11427     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL689.cbl
 11429 5655-WRITE-ARCHIVE-TEXT.
 11430
 11431
 11432* EXEC CICS WRITE
 11433*         DATASET   (W-ARCT-FILE-ID)
 11434*         FROM      (LETTER-ARCHIVE-TEXT)
 11435*         RIDFLD    (LT-CONTROL-PRIMARY)
 11436*    END-EXEC.
 11437     MOVE LENGTH OF
 11438      LETTER-ARCHIVE-TEXT
 11439       TO DFHEIV11
 11440*    MOVE '&$ L                  ''   #00011091' TO DFHEIV0
 11441     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11443     MOVE X'2020233030303131303931' TO DFHEIV0(25:11)
 11444     CALL 'kxdfhei1' USING DFHEIV0,
 11445           W-ARCT-FILE-ID,
 11446           LETTER-ARCHIVE-TEXT,
 11447           DFHEIV11,
 11448           LT-CONTROL-PRIMARY,
 11449           DFHEIV99,
 11450           DFHEIV99
 11451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11452
 11453
 11454 5655-EXIT.
 11455     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL689.cbl
 11457 6000-RESOLVE-VARIABLES.
 11458***************************************************************
 11459*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 11460*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 11461*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 11462*    RESOLVE ALL OF THE SYMBOLS.                              *
 11463*                                                             *
 11464***************************************************************
 11465
 11466     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 11467     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 11468     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 11469     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 11470     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 11471*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 11472     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 11473     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 11474     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 11475     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 11476     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 11477     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 11478     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 11479     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 11480
 11481     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 11482
 11483 6000-EXIT.
 11484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL689.cbl
 11486 6200-GET-COMPANY-DATA.
 11487
 11488     IF  ADDRSI EQUAL '3'
 11489             AND
 11490         PI-CREATE-LABELS
 11491             AND
 11492         NOT PI-689-LABELS-OVERRIDEN
 11493         NEXT SENTENCE
 11494     ELSE
 11495         IF  W-FILE-NOT-USED (1)
 11496             GO TO 6200-EXIT.
 11497
 11498     MOVE SPACES                 TO W-CNTL-KEY.
 11499     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11500     MOVE +0                     TO W-CNTL-SEQ-NO.
 11501     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11502
 11503
 11504* EXEC CICS HANDLE CONDITION
 11505*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 11506*         NOTFND    (6200-CNTL1-NOT-FOUND)
 11507*    END-EXEC.
 11508*    MOVE '"$JI                  ! + #00011146' TO DFHEIV0
 11509     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11511     MOVE X'2B20233030303131313436' TO DFHEIV0(25:11)
 11512     CALL 'kxdfhei1' USING DFHEIV0
 11513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11514
 11515
 11516
 11517* EXEC CICS READ
 11518*         DATASET   (W-CNTL-FILE-ID)
 11519*         SET       (ADDRESS OF CONTROL-FILE)
 11520*         RIDFLD    (W-CNTL-KEY)
 11521*    END-EXEC.
 11522*    MOVE '&"S        E          (   #00011151' TO DFHEIV0
 11523     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11524     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11525     MOVE X'2020233030303131313531' TO DFHEIV0(25:11)
 11526     CALL 'kxdfhei1' USING DFHEIV0,
 11527           W-CNTL-FILE-ID,
 11528           DFHEIV20,
 11529           DFHEIV99,
 11530           W-CNTL-KEY,
 11531           DFHEIV99,
 11532           DFHEIV99,
 11533           DFHEIV99
 11534     SET ADDRESS OF CONTROL-FILE TO
 11535         DFHEIV20
 11536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11537
 11538
 11539     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11540     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 11541                                    W-VG-TEXT (25).
 11542     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 11543     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL689.cbl
 11544     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 11545     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 11546
 11547     IF  CF-CL-CAN-POST-CODE
 11548         MOVE CF-CL-CANADIAN-POSTAL-CODE
 11549                                 TO W-CANADIAN-POSTAL-CODES
 11550         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11551         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11552         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11553                                    W-LAB-CAN-FILLER (6)
 11554         GO TO 6200-CONTINUE.
 11555
 11556     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11557         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 11558         MOVE SPACES             TO W-LABEL-ZIP (6)
 11559         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11560
 11561         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11562             MOVE '-'            TO W-LABEL-DASH (6)
 11563             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 11564             GO TO 6200-CONTINUE
 11565         ELSE
 11566             MOVE SPACES         TO W-LABEL-DASH (6)
 11567                                    W-LABEL-2ND-ZIP (6)
 11568             GO TO 6200-CONTINUE.
 11569
 11570     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11571         GO TO 6200-CONTINUE.
 11572
 11573     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 11574
 11575     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11576         COMPUTE W-WORK-ZIP-NUMERIC
 11577             = W-WORK-ZIP-NUMERIC * 10000.
 11578
 11579     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11580     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11581
 11582     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11583         MOVE '-'                TO W-LABEL-DASH (6)
 11584         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11585         GO TO 6200-CONTINUE
 11586     ELSE
 11587         MOVE SPACES             TO W-LABEL-DASH (6)
 11588                                    W-LABEL-2ND-ZIP (6)
 11589         GO TO 6200-CONTINUE.
 11590
 11591 6200-CONTINUE.
 11592
 11593     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11594
 11595     IF  ADDRSI EQUAL '3'
 11596             AND
 11597         PI-CREATE-LABELS
 11598             AND
 11599         NOT PI-689-LABELS-OVERRIDEN
 11600         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 11601         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL689.cbl
 11602         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 11603         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 11604         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 11605         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 11606         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11607         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11608         SET W-RG-NDX UP BY +1
 11609     ELSE
 11610         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 11611         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 11612         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 11613         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 11614         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 11615         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 11616
 11617     GO TO 6200-EXIT.
 11618
 11619 6200-CNTL1-NOT-FOUND.
 11620
 11621     MOVE ER-9299                TO EMI-ERROR.
 11622     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11623     MOVE -1                     TO ADDRSL.
 11624     MOVE AL-UANON               TO ADDRSA.
 11625     GO TO 8200-SEND-DATAONLY.
 11626
 11627 6200-EXIT.
 11628     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL689.cbl
 11630 6250-GET-CNTL2-DATA.
 11631
 11632     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 11633         GO TO 6250-EXIT.
 11634
 11635     IF  W-FILE-NOT-USED (11)
 11636         GO TO 6250-EXIT.
 11637
 11638     MOVE SPACES                 TO W-CNTL-KEY.
 11639     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11640     MOVE +0                     TO W-CNTL-SEQ-NO.
 11641     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 11642     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 11643
 11644
 11645* EXEC CICS HANDLE CONDITION
 11646*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11647*         NOTFND     (6250-CNTL2-NOT-FOUND)
 11648*    END-EXEC.
 11649*    MOVE '"$JI                  ! , #00011262' TO DFHEIV0
 11650     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11652     MOVE X'2C20233030303131323632' TO DFHEIV0(25:11)
 11653     CALL 'kxdfhei1' USING DFHEIV0
 11654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11655
 11656
 11657
 11658* EXEC CICS READ
 11659*         DATASET    (W-CNTL-FILE-ID)
 11660*         SET        (ADDRESS OF CONTROL-FILE)
 11661*         RIDFLD     (W-CNTL-KEY)
 11662*    END-EXEC.
 11663*    MOVE '&"S        E          (   #00011267' TO DFHEIV0
 11664     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11666     MOVE X'2020233030303131323637' TO DFHEIV0(25:11)
 11667     CALL 'kxdfhei1' USING DFHEIV0,
 11668           W-CNTL-FILE-ID,
 11669           DFHEIV20,
 11670           DFHEIV99,
 11671           W-CNTL-KEY,
 11672           DFHEIV99,
 11673           DFHEIV99,
 11674           DFHEIV99
 11675     SET ADDRESS OF CONTROL-FILE TO
 11676         DFHEIV20
 11677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11678
 11679
 11680     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 11681     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 11682     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 11683     GO TO 6250-EXIT.
 11684
 11685 6250-CNTL2-NOT-FOUND.
 11686
 11687     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL689.cbl
 11688     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11689     MOVE -1                     TO MAINTL.
 11690     MOVE AL-UANON               TO MAINTA.
 11691     GO TO 8200-SEND-DATAONLY.
 11692
 11693 6250-EXIT.
 11694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL689.cbl
 11696 6300-GET-CARRIER-DATA.
 11697
 11698     IF  ADDRSI EQUAL '2'
 11699             AND
 11700         PI-CREATE-LABELS
 11701             AND
 11702         NOT PI-689-LABELS-OVERRIDEN
 11703         NEXT SENTENCE
 11704     ELSE
 11705         IF  W-FILE-NOT-USED (4)
 11706             GO TO 6300-EXIT.
 11707
 11708     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 11709         MOVE SPACES             TO W-CNTL-KEY
 11710         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 11711         MOVE +0                 TO W-CNTL-SEQ-NO
 11712         MOVE '6'                TO W-CNTL-RECORD-TYPE
 11713         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 11714     ELSE
 11715         MOVE ER-9327            TO EMI-ERROR
 11716         MOVE -1                 TO CARRIERL
 11717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11718         GO TO 6300-EXIT.
 11719
 11720
 11721* EXEC CICS HANDLE CONDITION
 11722*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11723*         NOTFND     (6300-CNTL6-NOT-FOUND)
 11724*    END-EXEC.
 11725*    MOVE '"$JI                  ! - #00011313' TO DFHEIV0
 11726     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11728     MOVE X'2D20233030303131333133' TO DFHEIV0(25:11)
 11729     CALL 'kxdfhei1' USING DFHEIV0
 11730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11731
 11732
 11733
 11734* EXEC CICS READ
 11735*         DATASET    (W-CNTL-FILE-ID)
 11736*         SET        (ADDRESS OF CONTROL-FILE)
 11737*         RIDFLD     (W-CNTL-KEY)
 11738*    END-EXEC.
 11739*    MOVE '&"S        E          (   #00011318' TO DFHEIV0
 11740     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11742     MOVE X'2020233030303131333138' TO DFHEIV0(25:11)
 11743     CALL 'kxdfhei1' USING DFHEIV0,
 11744           W-CNTL-FILE-ID,
 11745           DFHEIV20,
 11746           DFHEIV99,
 11747           W-CNTL-KEY,
 11748           DFHEIV99,
 11749           DFHEIV99,
 11750           DFHEIV99
 11751     SET ADDRESS OF CONTROL-FILE TO
 11752         DFHEIV20
 11753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL689.cbl
 11754
 11755
 11756     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11757     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 11758     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 11759     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 11760     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 11761     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 11762
 11763     IF  CF-CANADIAN-POST-CODE
 11764         MOVE CF-CANADIAN-POSTAL-CODE
 11765                                 TO W-CANADIAN-POSTAL-CODES
 11766         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11767         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11768         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11769                                    W-LAB-CAN-FILLER (6)
 11770         GO TO 6300-CONTINUE.
 11771
 11772     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11773         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 11774         MOVE SPACES             TO W-LABEL-ZIP (6)
 11775         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11776         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11777             MOVE '-'            TO W-LABEL-DASH (6)
 11778             MOVE W-WORK-ZIP4
 11779                                 TO W-LABEL-2ND-ZIP (6)
 11780             GO TO 6300-CONTINUE
 11781         ELSE
 11782             MOVE SPACES         TO W-LABEL-DASH (6)
 11783                                    W-LABEL-2ND-ZIP (6)
 11784             GO TO 6300-CONTINUE.
 11785
 11786     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 11787         GO TO 6300-CONTINUE.
 11788
 11789     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 11790
 11791     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11792         COMPUTE W-WORK-ZIP-NUMERIC
 11793             = W-WORK-ZIP-NUMERIC * 10000.
 11794
 11795     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11796     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11797
 11798     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11799         MOVE '-'                TO W-LABEL-DASH (6)
 11800         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11801         GO TO 6300-CONTINUE
 11802     ELSE
 11803         MOVE SPACES             TO W-LABEL-DASH (6)
 11804                                    W-LABEL-2ND-ZIP (6)
 11805         GO TO 6300-CONTINUE.
 11806
 11807 6300-CONTINUE.
 11808
 11809     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11810
 11811     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL689.cbl
 11812             AND
 11813         PI-CREATE-LABELS
 11814             AND
 11815         NOT PI-689-LABELS-OVERRIDEN
 11816         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 11817         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 11818         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 11819         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 11820         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 11821         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 11822         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11823         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11824         SET W-RG-NDX UP BY +1
 11825     ELSE
 11826         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 11827         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 11828         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 11829         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 11830         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 11831         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 11832
 11833     IF  W-FULL-DATA
 11834         MOVE ZEROS              TO W-PHONE-IN
 11835         MOVE CF-PHONE-NO        TO W-PHONE-IN
 11836         MOVE W-PHI-AREA         TO W-PO-AREA
 11837         MOVE W-PHI-PFX          TO W-PO-PFX
 11838         MOVE W-PHI-SFX          TO W-PO-SFX
 11839         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 11840
 11841     GO TO 6300-EXIT.
 11842
 11843 6300-CNTL6-NOT-FOUND.
 11844
 11845     MOVE ER-9298                TO EMI-ERROR.
 11846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11847     MOVE -1                     TO ADDRSL.
 11848     MOVE AL-UANON               TO ADDRSA.
 11849     GO TO 8200-SEND-DATAONLY.
 11850
 11851 6300-EXIT.
 11852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL689.cbl
 11854 6350-GET-CSR-DATA.
 11855     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 11856        GO TO 6350-EXIT
 11857     END-IF
 11858*    IF W-FILE-NOT-USED (11)
 11859*       GO TO 6350-EXIT
 11860*    END-IF
 11861     MOVE SPACES                 TO W-CNTL-KEY
 11862     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 11863     MOVE +0                     TO W-CNTL-SEQ-NO
 11864     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 11865     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 11866
 11867* EXEC CICS HANDLE CONDITION
 11868*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11869*         NOTFND     (6350-CNTL2-NOT-FOUND)
 11870*    END-EXEC
 11871*    MOVE '"$JI                  ! . #00011434' TO DFHEIV0
 11872     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11874     MOVE X'2E20233030303131343334' TO DFHEIV0(25:11)
 11875     CALL 'kxdfhei1' USING DFHEIV0
 11876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11877
 11878* EXEC CICS READ
 11879*         DATASET    (W-CNTL-FILE-ID)
 11880*         SET        (ADDRESS OF CONTROL-FILE)
 11881*         RIDFLD     (W-CNTL-KEY)
 11882*    END-EXEC
 11883*    MOVE '&"S        E          (   #00011438' TO DFHEIV0
 11884     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11886     MOVE X'2020233030303131343338' TO DFHEIV0(25:11)
 11887     CALL 'kxdfhei1' USING DFHEIV0,
 11888           W-CNTL-FILE-ID,
 11889           DFHEIV20,
 11890           DFHEIV99,
 11891           W-CNTL-KEY,
 11892           DFHEIV99,
 11893           DFHEIV99,
 11894           DFHEIV99
 11895     SET ADDRESS OF CONTROL-FILE TO
 11896         DFHEIV20
 11897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11898     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 11899     GO TO 6350-EXIT
 11900     .
 11901 6350-CNTL2-NOT-FOUND.
 11902     MOVE ER-9299                TO EMI-ERROR.
 11903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11904     MOVE -1                     TO MAINTL.
 11905     MOVE AL-UANON               TO MAINTA.
 11906     GO TO 8200-SEND-DATAONLY.
 11907 6350-EXIT.
 11908     EXIT.
 11909 6400-GET-PENDING-DATA.
 11910
 11911     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL689.cbl
 11912        AND (PI-CREATE-LABELS)
 11913        AND (NOT PI-689-LABELS-OVERRIDEN)
 11914        CONTINUE
 11915     ELSE
 11916        IF PI-689-DATA-SOURCE = '4'
 11917           CONTINUE
 11918        ELSE
 11919           IF W-FILE-NOT-USED (9)
 11920              GO TO 6400-EXIT
 11921           END-IF
 11922        END-IF
 11923     END-IF
 11924     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 11925         MOVE ER-9327            TO EMI-ERROR
 11926         MOVE -1                 TO MAINTL
 11927         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11928         GO TO 6400-EXIT.
 11929
 11930 6400-READ-PNDB-ONLY.
 11931
 11932
 11933* EXEC CICS HANDLE CONDITION
 11934*         NOTOPEN (8060-PNDB-NOT-OPEN)
 11935*         NOTFND  (8070-PNDB-NOT-FOUND)
 11936*    END-EXEC.
 11937*    MOVE '"$JI                  ! / #00011477' TO DFHEIV0
 11938     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11940     MOVE X'2F20233030303131343737' TO DFHEIV0(25:11)
 11941     CALL 'kxdfhei1' USING DFHEIV0
 11942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11943
 11944
 11945
 11946* EXEC CICS READ
 11947*         DATASET (W-PNDB-FILE-ID)
 11948*         SET     (ADDRESS OF PENDING-BUSINESS)
 11949*         RIDFLD  (W-PNDB-KEY)
 11950*    END-EXEC.
 11951*    MOVE '&"S        E          (   #00011482' TO DFHEIV0
 11952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11954     MOVE X'2020233030303131343832' TO DFHEIV0(25:11)
 11955     CALL 'kxdfhei1' USING DFHEIV0,
 11956           W-PNDB-FILE-ID,
 11957           DFHEIV20,
 11958           DFHEIV99,
 11959           W-PNDB-KEY,
 11960           DFHEIV99,
 11961           DFHEIV99,
 11962           DFHEIV99
 11963     SET ADDRESS OF PENDING-BUSINESS TO
 11964         DFHEIV20
 11965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11966
 11967
 11968     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 11969
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL689.cbl
 11970     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 11971         MOVE PB-SV-CARRIER      TO PB-CARRIER
 11972                                    PI-689-CARRIER
 11973         MOVE PB-SV-GROUPING     TO PB-GROUPING
 11974                                    PI-689-GROUPING
 11975         MOVE PB-SV-STATE        TO PB-STATE
 11976                                    PI-689-STATE
 11977         MOVE PB-CONTROL-BY-ACCOUNT
 11978                                 TO W-CERT-KEY
 11979                                    W-MAIL-KEY
 11980                                    W-ACCT-KEY
 11981         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 11982         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 11983         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 11984
 11985 6400-ONLY-STOP.
 11986
 11987     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 11988
 11989     IF  NOT PB-ISSUE
 11990         GO TO 6400-CANCEL.
 11991
 11992     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 11993     MOVE SPACES                 TO DC-OPTION-CODE.
 11994     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11995
 11996     IF  NO-CONVERSION-ERROR
 11997         MOVE DC-GREG-DATE-1-EDIT
 11998                                 TO W-VG-TEXT (110).
 11999
 12000     MOVE PB-I-AGE               TO W-EDIT-3-0.
 12001     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 12002     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 12003     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 12004     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 12005     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 12006     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 12007     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 12008     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 12009     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 12010     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 12011     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 12012     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 12013     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 12014     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 12015     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 12016     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 12017     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 12018     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 12019     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 12020
 12021     COMPUTE W-DIFFERENCE
 12022         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 12023
 12024     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12025     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 12026
 12027     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL689.cbl
 12028         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 12029
 12030     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12031     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 12032
 12033 6400-CANCEL.
 12034
 12035     IF  NOT PB-CANCELLATION
 12036         GO TO 6400-EXIT.
 12037
 12038     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 12039                                 TO DC-BIN-DATE-1.
 12040     MOVE SPACES                 TO DC-OPTION-CODE.
 12041     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12042
 12043     IF  NO-CONVERSION-ERROR
 12044         MOVE DC-GREG-DATE-1-EDIT
 12045                                 TO W-VG-TEXT (117).
 12046
 12047     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 12048     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 12049     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 12050     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 12051     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 12052     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 12053     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 12054     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 12055     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 12056     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 12057
 12058     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 12059        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 12060     END-IF
 12061     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 12062     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 12063     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 12064     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 12065        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 12066     END-IF
 12067     MOVE SPACES                 TO DC-OPTION-CODE
 12068     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 12069
 12070     IF NO-CONVERSION-ERROR
 12071        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 12072     END-IF
 12073
 12074     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 12075                           - PB-C-LF-CANCEL-AMT.
 12076
 12077     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12078     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 12079
 12080     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 12081                           - PB-C-AH-CANCEL-AMT.
 12082
 12083     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12084     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 12085
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL689.cbl
 12086 6400-EXIT.
 12087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL689.cbl
 12089 6450-GET-CERT-DATA.
 12090     IF  W-FILE-NOT-USED (8)
 12091         GO TO 6450-EXIT.
 12092
 12093     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12094         MOVE ER-9327            TO EMI-ERROR
 12095         MOVE -1                 TO MAINTL
 12096         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12097         GO TO 6450-EXIT.
 12098
 12099 6450-READ-CERT-ONLY.
 12100
 12101
 12102* EXEC CICS HANDLE CONDITION
 12103*         NOTOPEN (8030-CERT-NOT-OPEN)
 12104*         NOTFND  (8035-CERT-NOT-FOUND)
 12105*    END-EXEC.
 12106*    MOVE '"$JI                  ! 0 #00011621' TO DFHEIV0
 12107     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12109     MOVE X'3020233030303131363231' TO DFHEIV0(25:11)
 12110     CALL 'kxdfhei1' USING DFHEIV0
 12111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12112
 12113
 12114
 12115* EXEC CICS READ
 12116*         DATASET (W-CERT-FILE-ID)
 12117*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 12118*         RIDFLD  (W-CERT-KEY)
 12119*    END-EXEC.
 12120*    MOVE '&"S        E          (   #00011626' TO DFHEIV0
 12121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12123     MOVE X'2020233030303131363236' TO DFHEIV0(25:11)
 12124     CALL 'kxdfhei1' USING DFHEIV0,
 12125           W-CERT-FILE-ID,
 12126           DFHEIV20,
 12127           DFHEIV99,
 12128           W-CERT-KEY,
 12129           DFHEIV99,
 12130           DFHEIV99,
 12131           DFHEIV99
 12132     SET ADDRESS OF CERTIFICATE-MASTER TO
 12133         DFHEIV20
 12134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12135
 12136
 12137     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 12138
 12139 6450-ONLY-STOP.
 12140
 12141     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 12142
 12143     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 12144
 12145     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12146     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL689.cbl
 12147     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12148     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12149     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 12150
 12151     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12152     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12153     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12154     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 12155     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 12156
 12157     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12158     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12159     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 12160     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12161     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12162     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 12163
 12164     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12165     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12166     MOVE SPACES                 TO W-NAME-MIDDLE.
 12167     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12168     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 12169
 12170     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 12171     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 12172
 12173     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12174     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12175     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12176     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12177     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 12178                                    W-LABEL-JOINT-NAME.
 12179
 12180     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12181     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12182     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12183     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 12184     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 12185
 12186     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12187     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12188     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 12189     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12190     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12191     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 12192
 12193     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12194     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12195     MOVE SPACES                 TO W-NAME-MIDDLE.
 12196     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12197     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 12198
 12199     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 12200     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 12201
 12202     COMPUTE W-WORK-AMOUNT
 12203         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 12204     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL689.cbl
 12205     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 12206     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 12207     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 12208
 12209     IF  CM-SEX-FEMAL
 12210         MOVE 'MS.'              TO W-VG-TEXT (96)
 12211
 12212     ELSE
 12213         MOVE 'MR.'              TO W-VG-TEXT (96).
 12214
 12215     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 12216                                 TO W-VG-TEXT (70).
 12217     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 12218     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 12219     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 12220     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 12221     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 12222     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 12223     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 12224     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 12225     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 12226     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 12227     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 12228     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 12229     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 12230     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 12231     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 12232     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 12233     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 12234     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 12235     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 12236     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 12237     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 12238     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 12239     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 12240     IF PI-689-DATA-SOURCE NOT = '4'
 12241     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 12242        + CM-AH-ITD-CANCEL-AMT
 12243     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 12244     IF CM-NH-INT-ON-REFS NOT NUMERIC
 12245        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 12246     END-IF
 12247     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 12248     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 12249     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 12250     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 12251        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 12252     END-IF
 12253     MOVE SPACES                 TO DC-OPTION-CODE
 12254     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 12255
 12256     IF NO-CONVERSION-ERROR
 12257        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 12258     END-IF
 12259     END-IF
 12260     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 12261     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 12262     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 257
* EL689.cbl
 12263
 12264     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 12265     MOVE SPACES                 TO DC-OPTION-CODE.
 12266     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12267
 12268     IF  NO-CONVERSION-ERROR
 12269         MOVE DC-GREG-DATE-1-EDIT
 12270                                 TO W-VG-TEXT (81).
 12271
 12272     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 12273     MOVE SPACES                 TO DC-OPTION-CODE.
 12274     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12275
 12276     IF  NO-CONVERSION-ERROR
 12277         MOVE DC-GREG-DATE-1-EDIT
 12278                                 TO W-VG-TEXT (82).
 12279
 12280     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12281     MOVE SPACES                 TO DC-OPTION-CODE.
 12282     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12283
 12284     IF  NO-CONVERSION-ERROR
 12285         MOVE DC-GREG-DATE-1-EDIT
 12286                                 TO W-VG-TEXT (74).
 12287
 12288     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12289
 12290     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 12291         MOVE CM-PMT-EXTENSION-DAYS
 12292                                 TO DC-ELAPSED-DAYS
 12293     ELSE
 12294         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 12295
 12296     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12297     MOVE '6'                    TO DC-OPTION-CODE.
 12298     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12299
 12300     IF  NO-CONVERSION-ERROR
 12301         MOVE DC-GREG-DATE-1-EDIT
 12302                                 TO W-VG-TEXT (75).
 12303
 12304     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12305     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12306     MOVE '6'                    TO DC-OPTION-CODE.
 12307     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12308
 12309     IF  NO-CONVERSION-ERROR
 12310         MOVE DC-GREG-DATE-1-EDIT
 12311                                 TO W-VG-TEXT (76).
 12312
 12313 6450-EXIT.
 12314     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 258
* EL689.cbl
 12316 6500-GET-ACCOUNT-DATA.
 12317
 12318     IF  ADDRSI EQUAL '1'
 12319             AND
 12320         PI-CREATE-LABELS
 12321             AND
 12322         NOT PI-689-LABELS-OVERRIDEN
 12323         NEXT SENTENCE
 12324     ELSE
 12325         IF  W-FILE-NOT-USED (6)
 12326             GO TO 6500-EXIT
 12327         END-IF
 12328     END-IF.
 12329
 12330 6500-READ-ACCT-ONLY.
 12331
 12332     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 12333         MOVE ER-9327            TO EMI-ERROR
 12334         MOVE -1                 TO MAINTL
 12335         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12336         GO TO 6500-EXIT.
 12337
 12338
 12339* EXEC CICS HANDLE CONDITION
 12340*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 12341*         NOTFND     (6500-ACCT-NOT-FOUND)
 12342*         ENDFILE    (6500-ONLY-STOP)
 12343*    END-EXEC.
 12344*    MOVE '"$JI''                 ! 1 #00011833' TO DFHEIV0
 12345     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 12346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12347     MOVE X'3120233030303131383333' TO DFHEIV0(25:11)
 12348     CALL 'kxdfhei1' USING DFHEIV0
 12349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12350
 12351
 12352
 12353* EXEC CICS STARTBR
 12354*         RIDFLD     (W-ACCT-KEY)
 12355*         DATASET    (W-ACCT-FILE-ID)
 12356*         KEYLENGTH  (20)
 12357*         GENERIC
 12358*    END-EXEC.
 12359     MOVE 20
 12360       TO DFHEIV11
 12361     MOVE 0
 12362       TO DFHEIV12
 12363*    MOVE '&,   KG    G          &   #00011839' TO DFHEIV0
 12364     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12366     MOVE X'2020233030303131383339' TO DFHEIV0(25:11)
 12367     CALL 'kxdfhei1' USING DFHEIV0,
 12368           W-ACCT-FILE-ID,
 12369           W-ACCT-KEY,
 12370           DFHEIV11,
 12371           DFHEIV12,
 12372           DFHEIV99
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 259
* EL689.cbl
 12374
 12375
 12376     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 12377     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 12378
 12379 6500-READNEXT.
 12380
 12381
 12382* EXEC CICS READNEXT
 12383*         DATASET    (W-ACCT-FILE-ID)
 12384*         SET        (ADDRESS OF ACCOUNT-MASTER)
 12385*         RIDFLD     (W-ACCT-KEY)
 12386*    END-EXEC.
 12387     MOVE 0
 12388       TO DFHEIV11
 12389*    MOVE '&.S                   )   #00011851' TO DFHEIV0
 12390     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12391     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12392     MOVE X'2020233030303131383531' TO DFHEIV0(25:11)
 12393     CALL 'kxdfhei1' USING DFHEIV0,
 12394           W-ACCT-FILE-ID,
 12395           DFHEIV20,
 12396           DFHEIV99,
 12397           W-ACCT-KEY,
 12398           DFHEIV99,
 12399           DFHEIV11,
 12400           DFHEIV99,
 12401           DFHEIV99
 12402     SET ADDRESS OF ACCOUNT-MASTER TO
 12403         DFHEIV20
 12404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12405
 12406
 12407     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 12408         IF  PRIOR-MATCH-ACCT-PKEY
 12409             CONTINUE
 12410*            GO TO 6500-ONLY-STOP
 12411         ELSE
 12412             IF  W-FILE-NOT-USED (6)
 12413                 PERFORM 6500-ENDBR
 12414                 GO TO 6500-EXIT
 12415             ELSE
 12416                 GO TO 6500-ACCT-NOT-FOUND
 12417             END-IF
 12418         END-IF
 12419     ELSE
 12420         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 12421         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 12422         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 12423         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 12424         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 12425         MOVE AM-NAME              TO WS-SAV-AM-NAME
 12426         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 12427         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 12428         MOVE SPACES               TO WS-SAV-AM-CITY
 12429*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 12430         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 12431            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 260
* EL689.cbl
 12432         END-STRING
 12433         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 12434         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 12435         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 12436         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 12437         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 12438         GO TO 6500-READNEXT
 12439     END-IF
 12440     .
 12441 6500-ONLY-STOP.
 12442
 12443     IF  NOT PI-NO-CARRIER-SECURITY
 12444             AND
 12445         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 12446         MOVE -1                 TO CARRIERL
 12447         MOVE AL-UANON           TO CARRIERA
 12448         MOVE ER-9095            TO EMI-ERROR
 12449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12450         PERFORM 6500-ENDBR
 12451         GO TO 8200-SEND-DATAONLY.
 12452
 12453     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12454     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 12455     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 12456     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 12457     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 12458
 12459     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 12460     MOVE SPACES                 TO W-LABEL-ZIP (5).
 12461
 12462     IF  SAVE-AM-CANADIAN-POST-CODE
 12463         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 12464                                 TO W-CANADIAN-POSTAL-CODES
 12465         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 12466         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 12467         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 12468                                    W-LAB-CAN-FILLER (5)
 12469     ELSE
 12470         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 12471
 12472         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12473             MOVE '-'            TO W-LABEL-DASH (5)
 12474             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 12475         ELSE
 12476             MOVE SPACES         TO W-LABEL-DASH (5)
 12477                                    W-LABEL-2ND-ZIP (5).
 12478
 12479     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12480
 12481     IF  ADDRSI EQUAL '1'
 12482             AND
 12483         PI-CREATE-LABELS
 12484             AND
 12485         NOT PI-689-LABELS-OVERRIDEN
 12486         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12487                                    W-VG-TEXT (40)
 12488         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12489                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 261
* EL689.cbl
 12490         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12491                                    W-VG-TEXT (42)
 12492         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12493                                    W-VG-TEXT (43)
 12494         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12495                                    W-VG-TEXT (44)
 12496         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12497                                    W-VG-TEXT (45)
 12498         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12499         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12500         SET W-RG-NDX UP BY +1
 12501     ELSE
 12502         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 12503         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 12504         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 12505         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 12506         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 12507         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 12508
 12509     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 12510             OR
 12511         WS-SAV-AM-TEL-NO EQUAL ZEROS
 12512         MOVE SPACES             TO W-VG-TEXT (46)
 12513     ELSE
 12514         MOVE ZEROS                  TO W-PHONE-IN
 12515         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 12516         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 12517         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 12518         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 12519
 12520     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 12521        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 12522     ELSE
 12523        MOVE SPACES                   TO W-VG-TEXT (47)
 12524     END-IF.
 12525     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 12526     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 12527                                 TO W-VG-TEXT (49)
 12528
 12529     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 12530     PERFORM 6500-ENDBR.
 12531
 12532     GO TO 6500-EXIT.
 12533
 12534 6500-ENDBR.
 12535
 12536     IF  W-ACCT-BROWSE-STARTED
 12537         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 12538
 12539* EXEC CICS ENDBR
 12540*            DATASET (W-ACCT-FILE-ID)
 12541*        END-EXEC
 12542     MOVE 0
 12543       TO DFHEIV11
 12544*    MOVE '&2                    $   #00011988' TO DFHEIV0
 12545     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12546     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12547     MOVE X'2020233030303131393838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 262
* EL689.cbl
 12548     CALL 'kxdfhei1' USING DFHEIV0,
 12549           W-ACCT-FILE-ID,
 12550           DFHEIV11,
 12551           DFHEIV99
 12552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12553     END-IF.
 12554
 12555 6500-ACCT-NOT-FOUND.
 12556
 12557     PERFORM 6500-ENDBR.
 12558
 12559     IF  DATASORI NOT EQUAL '1'
 12560         MOVE ER-0179            TO EMI-ERROR
 12561         GO TO 6500-EXIT.
 12562
 12563     MOVE ER-0179                TO EMI-ERROR.
 12564     MOVE -1                     TO MAINTL.
 12565     MOVE AL-UNBON               TO MAINTA.
 12566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12567     GO TO 8200-SEND-DATAONLY.
 12568
 12569 6500-EXIT.
 12570     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 263
* EL689.cbl
 12572 6600-GET-COMPENSATION-DATA.
 12573
 12574     IF  ADDRSI EQUAL '4'
 12575             AND
 12576         PI-CREATE-LABELS
 12577             AND
 12578         NOT PI-689-LABELS-OVERRIDEN
 12579         NEXT SENTENCE
 12580     ELSE
 12581         IF  W-FILE-NOT-USED (10)
 12582             GO TO 6600-EXIT.
 12583
 12584     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 12585         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 12586         GO TO 6600-START.
 12587
 12588     IF  PI-ZERO-CARRIER
 12589             OR
 12590         PI-ZERO-CAR-GROUP
 12591         MOVE ZEROS              TO W-COMP-CARRIER.
 12592
 12593     IF  PI-ZERO-GROUPING
 12594             OR
 12595         PI-ZERO-CAR-GROUP
 12596         MOVE ZEROS              TO W-COMP-GROUPING.
 12597
 12598     IF  W-FILE-NOT-USED (6)
 12599         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 12600         IF  EMI-ERROR EQUAL ER-0179
 12601             MOVE ER-9327        TO EMI-ERROR
 12602             MOVE -1             TO MAINTL
 12603             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12604             GO TO 6600-EXIT.
 12605
 12606     MOVE  'A'                   TO W-COMP-TYPE.
 12607
 12608     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 12609         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 12610                                 TO W-COMP-RESP-PERSON
 12611     ELSE
 12612         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12613
 12614     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 12615        (W-NDX > +10)
 12616            OR
 12617         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 12618     END-PERFORM
 12619
 12620     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 12621         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 12622     ELSE
 12623         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12624
 12625     PERFORM 6500-ENDBR.
 12626     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12627
 12628     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 12629         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 264
* EL689.cbl
 12630         MOVE -1                 TO MAINTL
 12631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12632         GO TO 6600-EXIT.
 12633
 12634 6600-START.
 12635
 12636
 12637* EXEC CICS HANDLE CONDITION
 12638*         NOTOPEN (8080-COMP-NOT-OPEN)
 12639*         NOTFND  (6600-COMP-NOT-FOUND)
 12640*    END-EXEC.
 12641*    MOVE '"$JI                  ! 2 #00012074' TO DFHEIV0
 12642     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12644     MOVE X'3220233030303132303734' TO DFHEIV0(25:11)
 12645     CALL 'kxdfhei1' USING DFHEIV0
 12646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12647
 12648
 12649
 12650* EXEC CICS STARTBR
 12651*         RIDFLD  (W-COMP-KEY)
 12652*         DATASET (W-COMP-FILE-ID)
 12653*    END-EXEC.
 12654     MOVE 0
 12655       TO DFHEIV11
 12656*    MOVE '&,         G          &   #00012079' TO DFHEIV0
 12657     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12658     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12659     MOVE X'2020233030303132303739' TO DFHEIV0(25:11)
 12660     CALL 'kxdfhei1' USING DFHEIV0,
 12661           W-COMP-FILE-ID,
 12662           W-COMP-KEY,
 12663           DFHEIV99,
 12664           DFHEIV11,
 12665           DFHEIV99
 12666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12667
 12668
 12669     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 12670
 12671 6600-READNEXT.
 12672
 12673
 12674* EXEC CICS READNEXT
 12675*         DATASET (W-COMP-FILE-ID)
 12676*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12677*         RIDFLD  (W-COMP-KEY)
 12678*    END-EXEC.
 12679     MOVE 0
 12680       TO DFHEIV11
 12681*    MOVE '&.S                   )   #00012088' TO DFHEIV0
 12682     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12684     MOVE X'2020233030303132303838' TO DFHEIV0(25:11)
 12685     CALL 'kxdfhei1' USING DFHEIV0,
 12686           W-COMP-FILE-ID,
 12687           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 265
* EL689.cbl
 12688           DFHEIV99,
 12689           W-COMP-KEY,
 12690           DFHEIV99,
 12691           DFHEIV11,
 12692           DFHEIV99,
 12693           DFHEIV99
 12694     SET ADDRESS OF COMPENSATION-MASTER TO
 12695         DFHEIV20
 12696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12697
 12698
 12699     IF CO-CONTROL-PRIMARY
 12700           NOT = W-COMP-SAVE-KEY
 12701        GO TO 6600-COMP-NOT-FOUND.
 12702
 12703     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12704     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 12705                                    W-VG-TEXT (140).
 12706     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12707     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12708     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12709*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12710     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12711        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12712     END-STRING
 12713
 12714     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12715
 12716     IF  CO-CANADIAN-POST-CODE
 12717         MOVE CO-CANADIAN-POSTAL-CODE
 12718                                 TO W-CANADIAN-POSTAL-CODES
 12719         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12720         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12721         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12722                                    W-LAB-CAN-FILLER (6)
 12723     ELSE
 12724         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12725
 12726         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12727             MOVE '-'            TO W-LABEL-DASH (6)
 12728             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12729         ELSE
 12730             MOVE SPACES         TO W-LABEL-DASH (6)
 12731                                    W-LABEL-2ND-ZIP (6).
 12732
 12733     IF  CO-TELEPHONE NOT NUMERIC
 12734             OR
 12735         CO-TELEPHONE = ZEROS
 12736         MOVE SPACES             TO W-VG-TEXT (147)
 12737     ELSE
 12738         MOVE ZEROS              TO W-PHONE-IN
 12739         MOVE CO-AREA-CODE       TO W-PO-AREA
 12740         MOVE CO-PREFIX          TO W-PO-PFX
 12741         MOVE CO-PHONE           TO W-PO-SFX
 12742         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 12743
 12744     IF (CO-FAXNO NOT NUMERIC)
 12745        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 266
* EL689.cbl
 12746        MOVE SPACES              TO W-VG-TEXT (182)
 12747     ELSE
 12748        MOVE ZEROS               TO W-PHONE-IN
 12749        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 12750        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 12751        MOVE CO-FAX-PHONE        TO W-PO-SFX
 12752        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 12753     END-IF
 12754     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 12755        MOVE SPACES              TO W-VG-TEXT (183)
 12756     ELSE
 12757        EVALUATE CO-GA-STATUS-CODE
 12758           WHEN 'A'
 12759              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 12760           WHEN 'I'
 12761              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 12762           WHEN 'P'
 12763              MOVE 'PENDING'     TO W-VG-TEXT (183)
 12764        END-EVALUATE
 12765     END-IF
 12766     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 12767        MOVE SPACES              TO W-VG-TEXT (181)
 12768     ELSE
 12769        EVALUATE CO-BILL-SW
 12770           WHEN 'B'
 12771              MOVE 'BILLED'      TO W-VG-TEXT (181)
 12772           WHEN 'R'
 12773              MOVE 'REMIT'       TO W-VG-TEXT (181)
 12774           WHEN 'T'
 12775              MOVE 'T'           TO W-VG-TEXT (181)
 12776           WHEN 'S'
 12777              MOVE 'S'           TO W-VG-TEXT (181)
 12778        END-EVALUATE
 12779     END-IF
 12780     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12781
 12782     IF  ADDRSI EQUAL '4'
 12783             AND
 12784         PI-CREATE-LABELS
 12785             AND
 12786         NOT PI-689-LABELS-OVERRIDEN
 12787         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12788                                    W-VG-TEXT (141)
 12789         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12790                                    W-VG-TEXT (142)
 12791         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12792                                    W-VG-TEXT (143)
 12793         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12794                                    W-VG-TEXT (144)
 12795         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12796                                    W-VG-TEXT (145)
 12797         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12798                                    W-VG-TEXT (146)
 12799         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12800         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12801         SET W-RG-NDX UP BY +1
 12802     ELSE
 12803         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 267
* EL689.cbl
 12804         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 12805         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 12806         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 12807         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 12808         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 12809
 12810     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 12811
 12812     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 12813     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 12814     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 12815
 12816     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 12817     MOVE '3'                    TO DC-OPTION-CODE.
 12818     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12819
 12820     IF  NO-CONVERSION-ERROR
 12821         MOVE DC-GREG-DATE-1-ALPHA
 12822                                 TO W-VG-TEXT (149).
 12823
 12824     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 12825     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 12826
 12827     PERFORM 6600-ENDBR.
 12828     GO TO 6600-EXIT.
 12829
 12830 6600-ENDBR.
 12831
 12832     IF  W-COMP-BROWSE-STARTED
 12833         MOVE 'N'                      TO W-COMP-BROWSE-SW
 12834
 12835* EXEC CICS ENDBR
 12836*             DATASET(W-COMP-FILE-ID)
 12837*        END-EXEC.
 12838     MOVE 0
 12839       TO DFHEIV11
 12840*    MOVE '&2                    $   #00012229' TO DFHEIV0
 12841     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12843     MOVE X'2020233030303132323239' TO DFHEIV0(25:11)
 12844     CALL 'kxdfhei1' USING DFHEIV0,
 12845           W-COMP-FILE-ID,
 12846           DFHEIV11,
 12847           DFHEIV99
 12848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12849
 12850
 12851 6600-COMP-NOT-FOUND.
 12852
 12853     PERFORM 6600-ENDBR.
 12854
 12855     IF ADDRSL GREATER ZERO
 12856         IF ADDRSI = '4'
 12857            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 12858                MOVE ER-7378                TO EMI-ERROR
 12859                MOVE -1                     TO TYPEL
 12860                MOVE AL-UNBON               TO TYPEA
 12861                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 268
* EL689.cbl
 12862                GO TO 8200-SEND-DATAONLY
 12863            ELSE
 12864                MOVE ER-2114                TO EMI-ERROR
 12865                MOVE -1                     TO ADDRSL
 12866                MOVE AL-UNBON               TO ADDRSA
 12867                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12868                GO TO 8200-SEND-DATAONLY.
 12869
 12870 6600-EXIT.
 12871     EXIT.
 12872 6620-GET-G-DATA.
 12873
 12874     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 12875
 12876     IF  CO-RPTCD2 GREATER THAN SPACES
 12877         MOVE SPACES             TO W-COMP-RESP-PERSON
 12878         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 12879         MOVE +10                TO W-CWA-NDX
 12880         PERFORM 6622-FIND-LAST-NON-SPACE
 12881         SET W-COMP-NDX          TO +10
 12882         PERFORM 6625-FILL-IN-RESP-PERSON.
 12883         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 12884
 12885     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 12886     MOVE 'G'                    TO W-COMP-TYPE.
 12887     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12888
 12889
 12890* EXEC CICS RESETBR
 12891*         RIDFLD  (W-COMP-KEY)
 12892*         DATASET (W-COMP-FILE-ID)
 12893*    END-EXEC.
 12894     MOVE 0
 12895       TO DFHEIV11
 12896*    MOVE '&4         G          &   #00012271' TO DFHEIV0
 12897     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 12898     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12899     MOVE X'2020233030303132323731' TO DFHEIV0(25:11)
 12900     CALL 'kxdfhei1' USING DFHEIV0,
 12901           W-COMP-FILE-ID,
 12902           W-COMP-KEY,
 12903           DFHEIV99,
 12904           DFHEIV11,
 12905           DFHEIV99
 12906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12907
 12908
 12909
 12910* EXEC CICS READNEXT
 12911*         DATASET (W-COMP-FILE-ID)
 12912*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12913*         RIDFLD  (W-COMP-KEY)
 12914*    END-EXEC.
 12915     MOVE 0
 12916       TO DFHEIV11
 12917*    MOVE '&.S                   )   #00012276' TO DFHEIV0
 12918     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12919     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 269
* EL689.cbl
 12920     MOVE X'2020233030303132323736' TO DFHEIV0(25:11)
 12921     CALL 'kxdfhei1' USING DFHEIV0,
 12922           W-COMP-FILE-ID,
 12923           DFHEIV20,
 12924           DFHEIV99,
 12925           W-COMP-KEY,
 12926           DFHEIV99,
 12927           DFHEIV11,
 12928           DFHEIV99,
 12929           DFHEIV99
 12930     SET ADDRESS OF COMPENSATION-MASTER TO
 12931         DFHEIV20
 12932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12933
 12934
 12935     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 12936         GO TO 6620-EXIT.
 12937
 12938     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12939     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 12940     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12941     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12942     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12943*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12944     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12945        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12946     END-STRING
 12947
 12948     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12949
 12950     IF  CO-CANADIAN-POST-CODE
 12951         MOVE CO-CANADIAN-POSTAL-CODE
 12952                                 TO W-CANADIAN-POSTAL-CODES
 12953         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12954         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12955         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12956                                    W-LAB-CAN-FILLER (6)
 12957     ELSE
 12958         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12959         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12960             MOVE '-'            TO W-LABEL-DASH (6)
 12961             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12962         ELSE
 12963             MOVE SPACES         TO W-LABEL-DASH (6)
 12964                                    W-LABEL-2ND-ZIP (6).
 12965
 12966     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12967
 12968     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 12969     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 12970     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 12971     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 12972     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 12973     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 12974
 12975 6620-EXIT.
 12976     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 270
* EL689.cbl
 12978 6622-FIND-LAST-NON-SPACE.
 12979
 12980     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 12981         SUBTRACT +1 FROM W-CWA-NDX
 12982         GO TO 6622-FIND-LAST-NON-SPACE.
 12983
 12984 6622-EXIT.
 12985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 271
* EL689.cbl
 12987 6625-FILL-IN-RESP-PERSON.
 12988
 12989     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 12990     SET W-COMP-NDX DOWN BY +1.
 12991     SUBTRACT +1 FROM W-CWA-NDX.
 12992
 12993     IF  W-CWA-NDX GREATER THAN ZEROS
 12994         GO TO 6625-FILL-IN-RESP-PERSON.
 12995
 12996 6625-EXIT.
 12997     EXIT.
 12998 6626-GET-B-DATA.
 12999     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 13000     IF W-FILE-USED (8)
 13001        PERFORM 6450-READ-CERT-ONLY
 13002        IF W-CERT-FOUND
 13003           MOVE CM-BENEFICIARY (1:10)
 13004                                 TO W-COMP-RESP-PERSON
 13005        ELSE
 13006           MOVE SPACES           TO W-COMP-RESP-PERSON
 13007           GO TO 6626-EXIT
 13008        END-IF
 13009     ELSE
 13010        MOVE CM-BENEFICIARY (1:10)
 13011                                 TO W-COMP-RESP-PERSON
 13012     END-IF
 13013     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 13014     MOVE 'B'                    TO W-COMP-TYPE
 13015     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 13016
 13017
 13018* EXEC CICS RESETBR
 13019*         RIDFLD  (W-COMP-KEY)
 13020*         DATASET (W-COMP-FILE-ID)
 13021*    END-EXEC.
 13022     MOVE 0
 13023       TO DFHEIV11
 13024*    MOVE '&4         G          &   #00012364' TO DFHEIV0
 13025     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13027     MOVE X'2020233030303132333634' TO DFHEIV0(25:11)
 13028     CALL 'kxdfhei1' USING DFHEIV0,
 13029           W-COMP-FILE-ID,
 13030           W-COMP-KEY,
 13031           DFHEIV99,
 13032           DFHEIV11,
 13033           DFHEIV99
 13034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13035
 13036
 13037
 13038* EXEC CICS READNEXT
 13039*         DATASET (W-COMP-FILE-ID)
 13040*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13041*         RIDFLD  (W-COMP-KEY)
 13042*    END-EXEC.
 13043     MOVE 0
 13044       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 272
* EL689.cbl
 13045*    MOVE '&.S                   )   #00012369' TO DFHEIV0
 13046     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13047     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13048     MOVE X'2020233030303132333639' TO DFHEIV0(25:11)
 13049     CALL 'kxdfhei1' USING DFHEIV0,
 13050           W-COMP-FILE-ID,
 13051           DFHEIV20,
 13052           DFHEIV99,
 13053           W-COMP-KEY,
 13054           DFHEIV99,
 13055           DFHEIV11,
 13056           DFHEIV99,
 13057           DFHEIV99
 13058     SET ADDRESS OF COMPENSATION-MASTER TO
 13059         DFHEIV20
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13061
 13062
 13063     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13064         GO TO 6626-EXIT.
 13065
 13066     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13067     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13068     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13069     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13070     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13071*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13072     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13073        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13074     END-STRING
 13075
 13076     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13077
 13078     IF  CO-CANADIAN-POST-CODE
 13079         MOVE CO-CANADIAN-POSTAL-CODE
 13080                                 TO W-CANADIAN-POSTAL-CODES
 13081         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13082         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13083         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13084                                    W-LAB-CAN-FILLER (6)
 13085     ELSE
 13086         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13087         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13088             MOVE '-'            TO W-LABEL-DASH (6)
 13089             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13090         ELSE
 13091             MOVE SPACES         TO W-LABEL-DASH (6)
 13092                                    W-LABEL-2ND-ZIP (6).
 13093
 13094     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13095
 13096     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 13097     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 13098     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 13099     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 13100     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 13101     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 13102
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 273
* EL689.cbl
 13103 6626-EXIT.
 13104     EXIT.
 13105 6630-GET-CSR-NAME.
 13106
 13107     MOVE SPACES                 TO W-CNTL-KEY.
 13108     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 13109     MOVE +0                     TO W-CNTL-SEQ-NO.
 13110     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 13111     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 13112
 13113
 13114* EXEC CICS HANDLE CONDITION
 13115*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13116*         NOTFND     (6630-CNTL2-NOT-FOUND)
 13117*    END-EXEC.
 13118*    MOVE '"$JI                  ! 3 #00012425' TO DFHEIV0
 13119     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13121     MOVE X'3320233030303132343235' TO DFHEIV0(25:11)
 13122     CALL 'kxdfhei1' USING DFHEIV0
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13124
 13125
 13126
 13127* EXEC CICS READ
 13128*         DATASET    (W-CNTL-FILE-ID)
 13129*         SET        (ADDRESS OF CONTROL-FILE)
 13130*         RIDFLD     (W-CNTL-KEY)
 13131*    END-EXEC.
 13132*    MOVE '&"S        E          (   #00012430' TO DFHEIV0
 13133     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13135     MOVE X'2020233030303132343330' TO DFHEIV0(25:11)
 13136     CALL 'kxdfhei1' USING DFHEIV0,
 13137           W-CNTL-FILE-ID,
 13138           DFHEIV20,
 13139           DFHEIV99,
 13140           W-CNTL-KEY,
 13141           DFHEIV99,
 13142           DFHEIV99,
 13143           DFHEIV99
 13144     SET ADDRESS OF CONTROL-FILE TO
 13145         DFHEIV20
 13146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13147
 13148
 13149     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 13150     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13151     GO TO 6630-EXIT.
 13152
 13153 6630-CNTL2-NOT-FOUND.
 13154
 13155*    MOVE ER-8965                TO EMI-ERROR.
 13156*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13157*    MOVE -1                     TO MAINTL.
 13158*    MOVE AL-UANON               TO MAINTA.
 13159*    GO TO 8200-SEND-DATAONLY
 13160     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 274
* EL689.cbl
 13161 6630-EXIT.
 13162     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 275
* EL689.cbl
 13164 6700-GET-MAIL-DATA.
 13165
 13166     IF  ADDRSI EQUAL '5'
 13167             AND
 13168         PI-CREATE-LABELS
 13169             AND
 13170         NOT PI-689-LABELS-OVERRIDEN
 13171         NEXT SENTENCE
 13172     ELSE
 13173         IF  W-FILE-NOT-USED (5)
 13174             GO TO 6700-EXIT.
 13175
 13176     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 13177         MOVE ER-9327            TO EMI-ERROR
 13178         MOVE -1                 TO MAINTL
 13179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13180         GO TO 6700-EXIT.
 13181
 13182
 13183* EXEC CICS HANDLE CONDITION
 13184*         NOTOPEN (8090-MAIL-NOT-OPEN)
 13185*         NOTFND  (6700-MAIL-NOT-FOUND)
 13186*    END-EXEC.
 13187*    MOVE '"$JI                  ! 4 #00012469' TO DFHEIV0
 13188     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13190     MOVE X'3420233030303132343639' TO DFHEIV0(25:11)
 13191     CALL 'kxdfhei1' USING DFHEIV0
 13192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13193
 13194
 13195
 13196* EXEC CICS READ
 13197*         DATASET(W-MAIL-FILE-ID)
 13198*         SET    (ADDRESS OF MAILING-DATA)
 13199*         RIDFLD (W-MAIL-KEY)
 13200*    END-EXEC.
 13201*    MOVE '&"S        E          (   #00012474' TO DFHEIV0
 13202     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13204     MOVE X'2020233030303132343734' TO DFHEIV0(25:11)
 13205     CALL 'kxdfhei1' USING DFHEIV0,
 13206           W-MAIL-FILE-ID,
 13207           DFHEIV20,
 13208           DFHEIV99,
 13209           W-MAIL-KEY,
 13210           DFHEIV99,
 13211           DFHEIV99,
 13212           DFHEIV99
 13213     SET ADDRESS OF MAILING-DATA TO
 13214         DFHEIV20
 13215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13216
 13217
 13218     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 13219     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13220     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 13221     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 276
* EL689.cbl
 13222
 13223     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13224     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 13225     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 13226     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13227     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13228*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 13229     STRING MA-CITY ' ' MA-ADDR-STATE
 13230        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13231     END-STRING
 13232
 13233     MOVE MA-ZIP                 TO W-WORK-ZIP.
 13234     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13235
 13236     IF  MA-CANADIAN-POST-CODE
 13237         MOVE MA-CANADIAN-POSTAL-CODE
 13238                                 TO W-CANADIAN-POSTAL-CODES
 13239         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13240         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13241         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13242                                    W-LAB-CAN-FILLER (6)
 13243     ELSE
 13244         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13245         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13246             MOVE '-'            TO W-LABEL-DASH (6)
 13247             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13248         ELSE
 13249             MOVE SPACES         TO W-LABEL-DASH (6)
 13250                                    W-LABEL-2ND-ZIP (6).
 13251
 13252     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13253
 13254     IF  ADDRSI EQUAL '5'
 13255             AND
 13256         PI-CREATE-LABELS
 13257             AND
 13258         NOT PI-689-LABELS-OVERRIDEN
 13259         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13260                                    W-VG-TEXT (31)
 13261         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13262                                    W-VG-TEXT (32)
 13263         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13264                                    W-VG-TEXT (33)
 13265         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13266                                    W-VG-TEXT (34)
 13267         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13268                                    W-VG-TEXT (35)
 13269         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13270                                    W-VG-TEXT (36)
 13271         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13272         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13273         SET W-RG-NDX UP BY +1
 13274     ELSE
 13275         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 13276         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 13277         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 13278         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 13279         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 277
* EL689.cbl
 13280         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 13281     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13282     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 13283     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 13284     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 13285     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 13286        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 13287     END-STRING
 13288
 13289     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 13290     MOVE SPACES                 TO W-LABEL-ZIP (5)
 13291
 13292     IF  MA-CB-CANADIAN-POST-CODE
 13293         MOVE MA-CB-CANADIAN-POSTAL-CODE
 13294                                 TO W-CANADIAN-POSTAL-CODES
 13295         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13296         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13297         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13298                                    W-LAB-CAN-FILLER (5)
 13299     ELSE
 13300         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13301         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13302             MOVE '-'            TO W-LABEL-DASH (5)
 13303             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13304         ELSE
 13305             MOVE SPACES         TO W-LABEL-DASH (5)
 13306                                    W-LABEL-2ND-ZIP (5)
 13307         END-IF
 13308     END-IF
 13309     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 13310     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 13311     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 13312     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 13313     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 13314     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 13315     GO TO 6700-EXIT.
 13316
 13317 6700-MAIL-NOT-FOUND.
 13318
 13319     IF  ADDRSL GREATER ZERO
 13320         IF ADDRSI = '5'
 13321            MOVE ER-3000         TO EMI-ERROR
 13322            MOVE -1              TO ADDRSL
 13323            MOVE AL-UNBON        TO ADDRSA
 13324            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13325            GO TO 8200-SEND-DATAONLY.
 13326
 13327 6700-EXIT.
 13328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 278
* EL689.cbl
 13330 6750-GET-LIFE-BENEFIT-DATA.
 13331
 13332     IF  W-FILE-NOT-USED (2)
 13333         GO TO 6750-EXIT.
 13334
 13335     MOVE SPACES                 TO W-CNTL-GEN2.
 13336
 13337     IF  DATASORI EQUAL '2'
 13338         IF  W-FILE-NOT-USED (8)
 13339             PERFORM 6450-READ-CERT-ONLY
 13340             IF  W-CERT-FOUND
 13341                 MOVE CM-LF-BENEFIT-CD
 13342                                 TO W-BEN-HOLD
 13343                                    W-CNTL-GEN2
 13344             ELSE
 13345                 NEXT SENTENCE
 13346         ELSE
 13347             MOVE CM-LF-BENEFIT-CD
 13348                                 TO W-BEN-HOLD
 13349                                    W-CNTL-GEN2
 13350     ELSE
 13351         IF  DATASORI EQUAL '4'
 13352             IF  W-FILE-NOT-USED (9)
 13353                 PERFORM 6400-READ-PNDB-ONLY
 13354                 IF  W-PNDB-FOUND
 13355                     IF  PI-689-TYPE = '1'
 13356                         MOVE PB-I-LF-BENEFIT-CD
 13357                                 TO W-BEN-HOLD
 13358                                    W-CNTL-GEN2
 13359                     ELSE
 13360                         MOVE PB-CI-LF-BENEFIT-CD
 13361                                 TO W-BEN-HOLD
 13362                                    W-CNTL-GEN2
 13363             ELSE
 13364                 NEXT SENTENCE
 13365         ELSE
 13366             IF  W-FILE-USED (8)
 13367                 MOVE CM-LF-BENEFIT-CD
 13368                                 TO W-BEN-HOLD
 13369                                    W-CNTL-GEN2
 13370             ELSE
 13371                 IF  W-FILE-USED (9)
 13372                     IF  PI-689-TYPE = '1'
 13373                         MOVE PB-I-LF-BENEFIT-CD
 13374                                 TO W-BEN-HOLD
 13375                                    W-CNTL-GEN2
 13376                     ELSE
 13377                         MOVE PB-CI-LF-BENEFIT-CD
 13378                                 TO W-BEN-HOLD
 13379                                    W-CNTL-GEN2.
 13380
 13381     IF  W-CNTL-GEN2 EQUAL SPACES
 13382         MOVE ER-9327            TO EMI-ERROR
 13383         MOVE -1                 TO MAINTL
 13384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13385         GO TO 6750-EXIT.
 13386
 13387     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 279
* EL689.cbl
 13388     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 13389     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13390
 13391
 13392* EXEC CICS HANDLE CONDITION
 13393*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13394*         NOTFND  (6750-EXIT)
 13395*    END-EXEC.
 13396*    MOVE '"$JI                  ! 5 #00012653' TO DFHEIV0
 13397     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13399     MOVE X'3520233030303132363533' TO DFHEIV0(25:11)
 13400     CALL 'kxdfhei1' USING DFHEIV0
 13401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13402
 13403
 13404
 13405* EXEC CICS READ
 13406*         DATASET (W-CNTL-FILE-ID)
 13407*         SET     (ADDRESS OF CONTROL-FILE)
 13408*         GTEQ
 13409*         RIDFLD  (W-CNTL-KEY)
 13410*    END-EXEC.
 13411*    MOVE '&"S        G          (   #00012658' TO DFHEIV0
 13412     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13414     MOVE X'2020233030303132363538' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0,
 13416           W-CNTL-FILE-ID,
 13417           DFHEIV20,
 13418           DFHEIV99,
 13419           W-CNTL-KEY,
 13420           DFHEIV99,
 13421           DFHEIV99,
 13422           DFHEIV99
 13423     SET ADDRESS OF CONTROL-FILE TO
 13424         DFHEIV20
 13425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13426
 13427
 13428     MOVE 1                      TO W-NDX.
 13429
 13430 6750-LOOP.
 13431
 13432     IF  W-NDX = 9
 13433         GO TO 6750-EXIT.
 13434
 13435     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13436         ADD 1                   TO W-NDX
 13437         GO TO 6750-LOOP.
 13438
 13439     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13440         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13441                                 TO W-VG-TEXT (11).
 13442
 13443 6750-EXIT.
 13444     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 280
* EL689.cbl
 13446 6800-GET-A-H-BENEFIT-DATA.
 13447
 13448     IF  W-FILE-NOT-USED (3)
 13449         GO TO 6800-EXIT.
 13450
 13451     MOVE SPACES                 TO W-CNTL-GEN2.
 13452
 13453     IF  DATASORI EQUAL '2'
 13454         IF  W-FILE-NOT-USED (8)
 13455             PERFORM 6450-READ-CERT-ONLY
 13456             IF  W-CERT-FOUND
 13457                 MOVE CM-AH-BENEFIT-CD
 13458                                 TO W-BEN-HOLD
 13459                                    W-CNTL-GEN2
 13460             ELSE
 13461                 NEXT SENTENCE
 13462         ELSE
 13463             MOVE CM-AH-BENEFIT-CD
 13464                                 TO W-BEN-HOLD
 13465                                    W-CNTL-GEN2
 13466     ELSE
 13467         IF  DATASORI EQUAL '4'
 13468             IF  W-FILE-NOT-USED (9)
 13469                 PERFORM 6400-READ-PNDB-ONLY
 13470                 IF  W-PNDB-FOUND
 13471                     IF  PI-689-TYPE = '1'
 13472                         MOVE PB-I-AH-BENEFIT-CD
 13473                                 TO W-BEN-HOLD
 13474                                    W-CNTL-GEN2
 13475                     ELSE
 13476                         MOVE PB-CI-AH-BENEFIT-CD
 13477                                 TO W-BEN-HOLD
 13478                                    W-CNTL-GEN2
 13479             ELSE
 13480                 NEXT SENTENCE
 13481         ELSE
 13482             IF  W-FILE-USED (8)
 13483                 MOVE CM-AH-BENEFIT-CD
 13484                                 TO W-BEN-HOLD
 13485                                    W-CNTL-GEN2
 13486             ELSE
 13487                 IF  W-FILE-USED (9)
 13488                     IF  PI-689-TYPE = '1'
 13489                         MOVE PB-I-AH-BENEFIT-CD
 13490                                 TO W-BEN-HOLD
 13491                                    W-CNTL-GEN2
 13492                     ELSE
 13493                         MOVE PB-CI-AH-BENEFIT-CD
 13494                                 TO W-BEN-HOLD
 13495                                    W-CNTL-GEN2.
 13496
 13497     IF  W-CNTL-GEN2 EQUAL SPACES
 13498         MOVE ER-9327            TO EMI-ERROR
 13499         MOVE -1                 TO MAINTL
 13500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13501         GO TO 6800-EXIT.
 13502
 13503     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 281
* EL689.cbl
 13504     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 13505     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13506
 13507
 13508* EXEC CICS HANDLE CONDITION
 13509*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13510*         NOTFND  (6800-EXIT)
 13511*    END-EXEC.
 13512*    MOVE '"$JI                  ! 6 #00012744' TO DFHEIV0
 13513     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13515     MOVE X'3620233030303132373434' TO DFHEIV0(25:11)
 13516     CALL 'kxdfhei1' USING DFHEIV0
 13517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13518
 13519
 13520
 13521* EXEC CICS READ
 13522*         DATASET (W-CNTL-FILE-ID)
 13523*         SET     (ADDRESS OF CONTROL-FILE)
 13524*         RIDFLD  (W-CNTL-KEY)
 13525*         GTEQ
 13526*    END-EXEC.
 13527*    MOVE '&"S        G          (   #00012749' TO DFHEIV0
 13528     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13530     MOVE X'2020233030303132373439' TO DFHEIV0(25:11)
 13531     CALL 'kxdfhei1' USING DFHEIV0,
 13532           W-CNTL-FILE-ID,
 13533           DFHEIV20,
 13534           DFHEIV99,
 13535           W-CNTL-KEY,
 13536           DFHEIV99,
 13537           DFHEIV99,
 13538           DFHEIV99
 13539     SET ADDRESS OF CONTROL-FILE TO
 13540         DFHEIV20
 13541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13542
 13543
 13544     MOVE 1                      TO W-NDX.
 13545
 13546 6800-LOOP-AH.
 13547
 13548     IF  W-NDX = 9
 13549         GO TO 6800-EXIT.
 13550
 13551     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13552         ADD 1                   TO W-NDX
 13553         GO TO 6800-LOOP-AH.
 13554
 13555     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13556         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13557                                 TO W-VG-TEXT (15)
 13558         MOVE CF-BENEFIT-ALPHA (W-NDX)
 13559                                 TO W-BENEFIT-WORK
 13560         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 13561
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 282
* EL689.cbl
 13562 6800-EXIT.
 13563     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 283
* EL689.cbl
 13565 6850-GET-CHECK-DATA.
 13566
 13567     IF  ADDRSI EQUAL '6'
 13568             AND
 13569         PI-CREATE-LABELS
 13570             AND
 13571         NOT PI-689-LABELS-OVERRIDEN
 13572         NEXT SENTENCE
 13573     ELSE
 13574         IF  W-FILE-NOT-USED (12)
 13575             GO TO 6850-EXIT.
 13576
 13577     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 13578         MOVE ER-9327            TO EMI-ERROR
 13579         MOVE -1                 TO MAINTL
 13580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13581         GO TO 6850-EXIT.
 13582
 13583
 13584* EXEC CICS HANDLE CONDITION
 13585*         NOTOPEN (8045-CHEK-NOT-OPEN)
 13586*         NOTFND  (6850-CHEK-NOT-FOUND)
 13587*    END-EXEC.
 13588*    MOVE '"$JI                  ! 7 #00012795' TO DFHEIV0
 13589     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13591     MOVE X'3720233030303132373935' TO DFHEIV0(25:11)
 13592     CALL 'kxdfhei1' USING DFHEIV0
 13593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13594
 13595
 13596
 13597* EXEC CICS READ
 13598*         DATASET (W-CHEK-FILE-ID)
 13599*         SET     (ADDRESS OF CHECK-RECORDS)
 13600*         RIDFLD  (W-CHEK-KEY)
 13601*    END-EXEC.
 13602*    MOVE '&"S        E          (   #00012800' TO DFHEIV0
 13603     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13605     MOVE X'2020233030303132383030' TO DFHEIV0(25:11)
 13606     CALL 'kxdfhei1' USING DFHEIV0,
 13607           W-CHEK-FILE-ID,
 13608           DFHEIV20,
 13609           DFHEIV99,
 13610           W-CHEK-KEY,
 13611           DFHEIV99,
 13612           DFHEIV99,
 13613           DFHEIV99
 13614     SET ADDRESS OF CHECK-RECORDS TO
 13615         DFHEIV20
 13616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13617
 13618
 13619     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 13620     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 13621     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 13622     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 284
* EL689.cbl
 13623                                    PI-689-CONTROL.
 13624     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 13625     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 13626
 13627     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13628     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 13629     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 13630     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 13631     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 13632     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 13633
 13634     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 13635     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13636
 13637     IF  CH-CANADIAN-POST-CODE
 13638         MOVE CH-CANADIAN-POSTAL-CODE
 13639                                 TO W-CANADIAN-POSTAL-CODES
 13640         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13641         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13642         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13643                                    W-LAB-CAN-FILLER (6)
 13644     ELSE
 13645         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13646         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13647             MOVE '-'            TO W-LABEL-DASH (6)
 13648             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13649         ELSE
 13650             MOVE SPACES         TO W-LABEL-DASH (6)
 13651                                    W-LABEL-2ND-ZIP (6).
 13652
 13653     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13654
 13655     IF  ADDRSI EQUAL '6'
 13656             AND
 13657         PI-CREATE-LABELS
 13658             AND
 13659         NOT PI-689-LABELS-OVERRIDEN
 13660         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13661                                    W-VG-TEXT (159)
 13662         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13663                                    W-VG-TEXT (160)
 13664         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13665                                    W-VG-TEXT (161)
 13666         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13667                                    W-VG-TEXT (162)
 13668         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13669                                    W-VG-TEXT (163)
 13670         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13671                                    W-VG-TEXT (164)
 13672         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13673         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13674         SET W-RG-NDX UP BY +1
 13675     ELSE
 13676         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 13677         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 13678         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 13679         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 13680         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 285
* EL689.cbl
 13681         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 13682
 13683     GO TO 6850-EXIT.
 13684
 13685 6850-CHEK-NOT-FOUND.
 13686
 13687     IF  ADDRSL GREATER ZERO
 13688         IF ADDRSI = '6'
 13689            MOVE ER-2908         TO EMI-ERROR
 13690            MOVE -1              TO ADDRSL
 13691            MOVE AL-UNBON        TO ADDRSA
 13692            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13693            GO TO 8200-SEND-DATAONLY.
 13694
 13695 6850-EXIT.
 13696     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 286
* EL689.cbl
 13698 6900-GET-PYAJ-DATA.
 13699
 13700     IF  W-FILE-NOT-USED (13)
 13701         GO TO 6900-EXIT.
 13702
 13703     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 13704         MOVE ER-9327            TO EMI-ERROR
 13705         MOVE -1                 TO MAINTL
 13706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13707         GO TO 6900-EXIT.
 13708
 13709
 13710* EXEC CICS HANDLE CONDITION
 13711*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 13712*         NOTFND  (6900-PYAJ-NOT-FOUND)
 13713*    END-EXEC.
 13714*    MOVE '"$JI                  ! 8 #00012896' TO DFHEIV0
 13715     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13717     MOVE X'3820233030303132383936' TO DFHEIV0(25:11)
 13718     CALL 'kxdfhei1' USING DFHEIV0
 13719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13720
 13721
 13722 6900-READ-NEXT.
 13723
 13724
 13725* EXEC CICS READ
 13726*         DATASET (W-PYAJ-FILE-ID)
 13727*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 13728*         RIDFLD  (W-PYAJ-KEY)
 13729*         GTEQ
 13730*    END-EXEC.
 13731*    MOVE '&"S        G          (   #00012903' TO DFHEIV0
 13732     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13733     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13734     MOVE X'2020233030303132393033' TO DFHEIV0(25:11)
 13735     CALL 'kxdfhei1' USING DFHEIV0,
 13736           W-PYAJ-FILE-ID,
 13737           DFHEIV20,
 13738           DFHEIV99,
 13739           W-PYAJ-KEY,
 13740           DFHEIV99,
 13741           DFHEIV99,
 13742           DFHEIV99
 13743     SET ADDRESS OF PENDING-PAY-ADJ TO
 13744         DFHEIV20
 13745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13746
 13747
 13748     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 13749             OR
 13750         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 13751             OR
 13752         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 13753             OR
 13754         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 13755             OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 287
* EL689.cbl
 13756         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 13757         GO TO 6900-PYAJ-NOT-FOUND.
 13758
 13759     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 13760             AND
 13761         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 13762         GO TO 6900-PYAJ-NOT-FOUND.
 13763
 13764     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 13765         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 13766         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 13767         GO TO 6900-READ-NEXT.
 13768
 13769     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 13770     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 13771
 13772     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 13773     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 13774
 13775     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 13776                                    PI-689-CONTROL.
 13777     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 13778     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 13779
 13780     GO TO 6900-EXIT.
 13781
 13782 6900-PYAJ-NOT-FOUND.
 13783
 13784     MOVE ER-7395                TO EMI-ERROR
 13785     MOVE -1                     TO DATASORL
 13786     MOVE AL-UNBON               TO DATASORA
 13787     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13788     GO TO 8200-SEND-DATAONLY.
 13789
 13790 6900-EXIT.
 13791     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 288
* EL689.cbl
 13793 6950-MOVE-SYSTEM-DATA.
 13794
 13795     IF  W-FILE-NOT-USED (7)
 13796         GO TO 6950-EXIT.
 13797
 13798     MOVE EIBDATE                TO W-DATE-WORK.
 13799     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 13800     MOVE '5'                    TO DC-OPTION-CODE.
 13801     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13802     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 13803     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 13804
 13805     MOVE FORMI                  TO W-VG-TEXT (62).
 13806
 13807     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 13808         MOVE PI-689-VARIABLE-DATA-1
 13809                                 TO W-VG-TEXT (63)
 13810         MOVE PI-689-VARIABLE-DATA-2
 13811                                 TO W-VG-TEXT (64)
 13812         MOVE PI-689-VARIABLE-DATA-3
 13813                                 TO W-VG-TEXT (65)
 13814         MOVE PI-689-VARIABLE-DATA-4
 13815                                 TO W-VG-TEXT (66)
 13816     ELSE
 13817         MOVE '(VARIABLE NOT PROVIDED)'
 13818                                 TO W-VG-TEXT (63).
 13819
 13820 6950-EXIT.
 13821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 289
* EL689.cbl
 13823 7000-FORMAT-SCREEN.
 13824
 13825     IF  MAINTI EQUAL 'S'
 13826             OR
 13827         PI-SHOW-MODE
 13828         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 13829     ELSE
 13830         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 13831
 13832     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 13833         SET W-LINE23            TO W-RG-NDX
 13834         MOVE 'A'                TO W-LINE1
 13835     ELSE
 13836         SET W-LIN-NUM           TO W-RG-NDX
 13837         COMPUTE W-LIN-NUM
 13838             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 13839
 13840     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 13841     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 13842     SET W-RG-NDX UP BY 1.
 13843
 13844 7000-EXIT.
 13845      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 290
* EL689.cbl
 13847 7100-FORMAT-LAST-NAME-1ST.
 13848*****************************************************************
 13849*             M O V E   N A M E   R O U T I N E                 *
 13850*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13851*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13852*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13853*                  FIELD                   VALUE                *
 13854*           W-NAME-LAST    (CL15)      SMITH                    *
 13855*           W-NAME-FIRST   (CL15)      JOHN                     *
 13856*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13857*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13858*     CONTAIN                                                   *
 13859*                SMITH, JOHN ALLEN                              *
 13860*     OR                                                        *
 13861*                SMITH, JOHN A.                                 *
 13862*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13863*     COPYBOOK, ELCNWA.                                         *
 13864*****************************************************************.
 13865
 13866     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13867     MOVE ZERO                   TO WS-NAME-SW.
 13868     SET NWA-INDEX               TO +1.
 13869
 13870     IF  W-NAME-LAST EQUAL SPACES
 13871             AND
 13872         W-NAME-MIDDLE EQUAL SPACES
 13873         MOVE +1                 TO WS-NAME-SW.
 13874
 13875     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13876     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13877
 13878     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13879     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13880
 13881     SET NWA-INDEX UP BY +1.
 13882
 13883     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13884         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13885             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13886             SET NWA-INDEX UP BY +1
 13887             MOVE '.'            TO WS-NW (NWA-INDEX)
 13888             SET NWA-INDEX UP BY +2
 13889         ELSE
 13890             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13891             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13892
 13893 7100-EXIT.
 13894     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 291
* EL689.cbl
 13896 7110-MOVE-NAME.
 13897
 13898     IF  WS-NAME-SW GREATER THAN +1
 13899         GO TO 7110-EXIT.
 13900
 13901     IF  WS-NAME-WORK2 = SPACES
 13902         GO TO 7110-EXIT.
 13903
 13904     SET NWA-INDEX2            TO +1.
 13905     SET NWA-INDEX3            TO +2.
 13906
 13907 7110-MOVE-NAME-CYCLE.
 13908
 13909     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 13910
 13911     IF  NWA-INDEX LESS THAN +30
 13912         SET NWA-INDEX UP BY +1
 13913     ELSE
 13914         ADD +2                TO WS-NAME-SW
 13915         GO TO 7110-EXIT.
 13916
 13917     IF  NWA-INDEX2 LESS THAN +20
 13918         SET NWA-INDEX3 UP BY +1
 13919         SET NWA-INDEX2 UP BY +1.
 13920
 13921     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 13922             AND
 13923         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 13924         IF  WS-NAME-SW EQUAL ZERO
 13925             MOVE ','            TO WS-NW (NWA-INDEX)
 13926             SET NWA-INDEX UP BY +2
 13927             MOVE +1             TO WS-NAME-SW
 13928             GO TO 7110-EXIT
 13929         ELSE
 13930             GO TO 7110-EXIT.
 13931
 13932     GO TO 7110-MOVE-NAME-CYCLE.
 13933
 13934 7110-EXIT.
 13935     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 292
* EL689.cbl
 13937 7200-FORMAT-NAME-STRAIGHT.
 13938*****************************************************************
 13939*           M O V E   N A M E   R O U T I N E                   *
 13940*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13941*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13942*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13943*                  FIELD                   VALUE                *
 13944*           W-NAME-LAST    (CL15)      SMITH                    *
 13945*           W-NAME-FIRST   (CL15)      JOHN                     *
 13946*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13947*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13948*     CONTAIN                                                   *
 13949*              JOHN A. SMITH                                    *
 13950*     OR                                                        *
 13951*              JOHN ALLEN SMITH                                 *
 13952*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13953*     COPYBOOK, ELCNWA.                                         *
 13954*****************************************************************
 13955
 13956     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13957     MOVE ZERO                   TO WS-NAME-SW.
 13958     SET NWA-INDEX               TO +1.
 13959
 13960     IF  W-NAME-FIRST EQUAL SPACES
 13961             AND
 13962         W-NAME-MIDDLE EQUAL SPACES
 13963         MOVE W-NAME-LAST        TO WS-NAME-WORK
 13964         GO TO 7200-EXIT.
 13965
 13966     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13967     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13968
 13969     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13970         SET NWA-INDEX UP BY +1
 13971
 13972         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13973             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13974             SET NWA-INDEX UP BY +1
 13975             MOVE '.'            TO WS-NW (NWA-INDEX)
 13976             SET NWA-INDEX UP BY +1
 13977
 13978         ELSE
 13979             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13980             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13981
 13982     SET NWA-INDEX UP BY +1
 13983     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13984     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13985
 13986 7200-EXIT.
 13987     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 293
* EL689.cbl
 13989 7290-MOVE-NAME.
 13990
 13991     IF  WS-NAME-SW GREATER THAN +1
 13992         GO TO 7290-EXIT.
 13993
 13994     IF  WS-NAME-WORK2 EQUAL SPACES
 13995         GO TO 7290-EXIT.
 13996
 13997     SET NWA-INDEX2            TO +1.
 13998     SET NWA-INDEX3            TO +2.
 13999
 14000 7290-MOVE-NAME-CYCLE.
 14001
 14002     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14003
 14004     IF  NWA-INDEX LESS THAN +30
 14005         SET NWA-INDEX UP BY +1
 14006     ELSE
 14007         ADD +2                TO WS-NAME-SW
 14008         GO TO 7290-EXIT.
 14009
 14010     IF  NWA-INDEX2 LESS THAN +20
 14011         SET NWA-INDEX2 UP BY +1
 14012         SET NWA-INDEX3 UP BY +1.
 14013
 14014     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14015             AND
 14016         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14017         GO TO 7290-EXIT.
 14018
 14019     GO TO 7290-MOVE-NAME-CYCLE.
 14020
 14021 7290-EXIT.
 14022     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 294
* EL689.cbl
 14024 7300-LABEL-MOVE.
 14025
 14026     IF  W-LABEL-HOLD-AREA = SPACES
 14027         MOVE +0                 TO W-NUMB-LABEL-LINES
 14028         GO TO 7300-EXIT.
 14029
 14030     IF  W-LABEL-LINES (1) = SPACES
 14031         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 14032         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14033         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14034         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14035         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14036         MOVE SPACES             TO W-LABEL-LINES (6)
 14037         GO TO 7300-LABEL-MOVE.
 14038
 14039     IF  W-LABEL-LINES (2) = SPACES
 14040             AND
 14041         W-LABEL-LINES (3) = SPACES
 14042             AND
 14043         W-LABEL-LINES (4) = SPACES
 14044             AND
 14045         W-LABEL-LINES (5) = SPACES
 14046             AND
 14047         W-LABEL-LINES (6) = SPACES
 14048         MOVE 1                  TO W-NDX
 14049                                    W-NUMB-LABEL-LINES
 14050         GO TO 7300-EXIT.
 14051
 14052 7300-TRY-2.
 14053
 14054     IF  W-LABEL-LINES (2) = SPACES
 14055         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14056         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14057         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14058         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14059         MOVE SPACES             TO W-LABEL-LINES (6)
 14060         GO TO 7300-TRY-2.
 14061
 14062     IF  W-LABEL-LINES (3) = SPACES
 14063             AND
 14064         W-LABEL-LINES (4) = SPACES
 14065             AND
 14066         W-LABEL-LINES (5) = SPACES
 14067             AND
 14068         W-LABEL-LINES (6) = SPACES
 14069         MOVE 2                  TO W-NDX
 14070         GO TO 7300-MOVE-ZIP.
 14071
 14072 7300-TRY-3.
 14073
 14074     IF  W-LABEL-LINES (3) = SPACES
 14075         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14076         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14077         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14078         MOVE SPACES             TO W-LABEL-LINES (6)
 14079         GO TO 7300-TRY-3.
 14080
 14081     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 295
* EL689.cbl
 14082             AND
 14083         W-LABEL-LINES (5) = SPACES
 14084             AND
 14085         W-LABEL-LINES (6) = SPACES
 14086         MOVE 3                   TO W-NDX
 14087         GO TO 7300-MOVE-ZIP.
 14088
 14089 7300-TRY-4.
 14090
 14091     IF  W-LABEL-LINES (4) = SPACES
 14092         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14093         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14094         MOVE SPACES             TO W-LABEL-LINES (6)
 14095         GO TO 7300-TRY-4.
 14096
 14097     IF  W-LABEL-LINES (5) = SPACES
 14098             AND
 14099         W-LABEL-LINES (6) = SPACES
 14100         MOVE 4                  TO W-NDX
 14101         GO TO 7300-MOVE-ZIP.
 14102
 14103 7300-TRY-5.
 14104
 14105     IF  W-LABEL-LINES (5) = SPACES
 14106         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14107         MOVE SPACES             TO W-LABEL-LINES (6)
 14108         GO TO 7300-TRY-5
 14109     ELSE
 14110         IF  W-LABEL-LINES (6) = SPACES
 14111             MOVE 5              TO W-NDX
 14112             GO TO 7300-MOVE-ZIP
 14113         ELSE
 14114             MOVE 6              TO W-NDX.
 14115
 14116 7300-MOVE-ZIP.
 14117
 14118     COMPUTE W-NDX2 = W-NDX - 1.
 14119
 14120     IF  W-LAST-ZIP (W-NDX2) = SPACES
 14121*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 14122
 14123         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 14124                 MOVE W-LABEL-ZIP (W-NDX)
 14125                                 TO W-LAST-ZIP (W-NDX2)
 14126                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 14127                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 14128                 GO TO 7300-EXIT.
 14129
 14130     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 14131
 14132 7300-EXIT.
 14133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 296
* EL689.cbl
 14135 7400-CREATE-LETTER.
 14136****************************************************************
 14137*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 14138*    RECORDS.                                                  *
 14139****************************************************************
 14140
 14141     SET W-SQ-NDX                TO W-START-COLUMN.
 14142     MOVE SPACES                 TO W-SQUEEZED-LINE
 14143                                    W-WORK-LINE.
 14144     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 14145     MOVE +1                     TO W-LAST-WC-SPACE.
 14146     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 14147
 14148     SET W-TG-NDX                TO +1.
 14149
 14150     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 14151            VARYING
 14152         W-TG-NDX FROM W-TG-NDX BY +1
 14153            UNTIL
 14154         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 14155
 14156     IF  W-FORM-SQUEEZE-ON
 14157             AND
 14158         W-SQUEEZED-LINE GREATER THAN SPACES
 14159         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 14160
 14161     PERFORM 7640-PAGING THRU 7640-EXIT.
 14162
 14163 7400-EXIT.
 14164     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 297
* EL689.cbl
 14166 7410-TEXT-LINE-PROCESS.
 14167***************************************************************
 14168*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 14169*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 14170*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 14171*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 14172*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 14173*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 14174***************************************************************
 14175
 14176
 14177     SET W-WC-NDX                TO W-ZEROS.
 14178     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14179
 14180     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 14181
 14182     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 14183             VARYING
 14184         W-TX-NDX FROM +1 BY +1
 14185             UNTIL
 14186         W-TX-NDX GREATER THAN +70.
 14187
 14188****************************************************************
 14189*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 14190*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 14191*    LINE SQUEEZE CONTROL.                                     *
 14192****************************************************************
 14193     IF  W-FORM-SQUEEZE-ON
 14194
 14195         IF  W-WORK-LINE GREATER THAN SPACES
 14196                 OR
 14197             W-AS-IS
 14198             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 14199
 14200         ELSE
 14201             NEXT SENTENCE
 14202****************************************************************
 14203*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 14204*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 14205****************************************************************
 14206     ELSE
 14207         IF  W-WORK-LINE GREATER THAN SPACES
 14208             MOVE W-TX-PC (W-TG-NDX)
 14209                                 TO W-PRINT-CONTROL
 14210             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 14211             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14212             MOVE SPACES         TO W-WORK-LINE.
 14213
 14214 7410-EXIT.
 14215     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 298
* EL689.cbl
 14217 7420-TEXT-CHAR-PROCESS.
 14218****************************************************************
 14219*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 14220*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 14221*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 14222*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 14223****************************************************************
 14224
 14225     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 14226             AND
 14227         W-LAST-CHAR EQUAL '@'
 14228         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 14229
 14230     SET W-WC-NDX UP BY +1.
 14231
 14232     IF  W-WC-NDX GREATER THAN +70
 14233         IF  W-FORM-SQUEEZE-ON
 14234                 AND
 14235             NOT W-AS-IS
 14236             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 14237                     VARYING
 14238                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 14239                     UNTIL
 14240                 W-WC-NDX EQUAL +71
 14241             SET W-TX-NDX        TO W-LAST-TX-SPACE
 14242
 14243             IF  W-WORK-LINE GREATER THAN SPACES
 14244                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 14245                 MOVE SPACES     TO W-WORK-LINE
 14246                                    W-LINE-SQUEEZE-IND
 14247                 SET W-WC-NDX    TO +1
 14248             ELSE
 14249                 SET W-WC-NDX    TO +1
 14250         ELSE
 14251             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 14252
 14253     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14254                                 TO W-CHARACTER-TYPE.
 14255
 14256     SET W-WC-NDX2               TO W-WC-NDX.
 14257     SET W-WC-NDX2 DOWN BY +1.
 14258
 14259     IF  W-PUNCTUATION
 14260             AND
 14261         W-WC-NDX2 GREATER THAN W-ZEROS
 14262             AND
 14263         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 14264         SET W-WC-NDX DOWN BY +1.
 14265
 14266     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14267                                 TO W-LAST-CHAR
 14268                                    W-WORK-CHAR (W-WC-NDX).
 14269
 14270     IF  W-LAST-CHAR EQUAL SPACES
 14271         SET W-LAST-WC-SPACE     TO W-WC-NDX
 14272         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 14273
 14274 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 299
* EL689.cbl
 14275     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 300
* EL689.cbl
 14277 7430-PROCESS-VARIABLE.
 14278******************************************************************
 14279*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 14280*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 14281*    ITS CORRESPONDING VALUES.                                   *
 14282******************************************************************
 14283
 14284     SET W-TX-NDX UP BY +1.
 14285
 14286     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14287         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14288                                 TO W-V1
 14289         SET W-TX-NDX UP BY +1
 14290
 14291         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14292             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14293                                 TO W-V2
 14294             SET W-TX-NDX UP BY +1
 14295             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14296                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14297                                 TO W-V3
 14298                 SET W-TX-NDX UP BY +1
 14299                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14300                                 TO W-FIELD-SQUEEZE-IND
 14301                 GO TO 7430-CONTINUE
 14302             ELSE
 14303                 SET W-TX-NDX DOWN BY +3
 14304                 MOVE ER-0180    TO EMI-ERROR
 14305                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14306                 MOVE -1         TO MAINTL
 14307                 MOVE HIGH-VALUES
 14308                                 TO W-LAST-CHAR
 14309         ELSE
 14310             SET W-TX-NDX DOWN BY +2
 14311             MOVE ER-0180        TO EMI-ERROR
 14312             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14313             MOVE -1             TO MAINTL
 14314             MOVE HIGH-VALUES    TO W-LAST-CHAR
 14315     ELSE
 14316         SET W-TX-NDX DOWN BY +1
 14317         MOVE ER-7246            TO EMI-ERROR
 14318         MOVE -1                 TO MAINTL
 14319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14320         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 14321
 14322****************************************************************
 14323*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 14324*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 14325*    ACTION.                                                   *
 14326****************************************************************
 14327
 14328     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14329         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14330         GO TO 7430-EXIT
 14331     ELSE
 14332         GO TO 7430-EXIT.
 14333
 14334 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 301
* EL689.cbl
 14335
 14336     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 14337             OR
 14338         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 14339         SET W-TX-NDX DOWN BY +4
 14340         MOVE ER-0180            TO EMI-ERROR
 14341         MOVE -1                 TO MAINTL
 14342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14343         MOVE HIGH-VALUES        TO W-LAST-CHAR
 14344         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14345             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14346             GO TO 7430-EXIT
 14347         ELSE
 14348             GO TO 7430-EXIT.
 14349
 14350     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 14351
 14352     SET W-WC-NDX DOWN BY +1.
 14353
 14354     IF  (W-FORM-SQUEEZE-OFF
 14355                 AND
 14356             NOT W-SQUEEZE-FIELD)
 14357             OR
 14358         (W-FORM-SQUEEZE-ON
 14359                 AND
 14360             W-AS-IS)
 14361         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 14362                 VARYING
 14363             W-VC-NDX FROM +1 BY +1
 14364                 UNTIL
 14365             W-VC-NDX GREATER THAN
 14366                 W-VARIABLE-SIZE (W-VG-NDX)
 14367
 14368         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 14369             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14370             SET W-TX-NDX DOWN BY +5
 14371             IF  W-TX-NDX GREATER THAN +70
 14372                 SET W-TX-NDX    TO +70
 14373                 GO TO 7430-EXIT
 14374             ELSE
 14375                 GO TO 7430-EXIT
 14376         ELSE
 14377             COMPUTE W-ADJUST-SHORT
 14378                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 14379             SET W-WC-NDX UP BY W-ADJUST-SHORT
 14380             GO TO 7430-EXIT.
 14381
 14382     IF  W-SQUEEZE-FIELD
 14383         SET W-TX-NDX UP BY +1.
 14384
 14385     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 14386
 14387     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 14388             VARYING
 14389         W-VC-NDX FROM +1 BY +1
 14390             UNTIL
 14391         W-VC-NDX GREATER THAN
 14392             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 302
* EL689.cbl
 14393
 14394     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14395
 14396     IF  W-FORM-SQUEEZE-ON
 14397         GO TO 7430-EXIT.
 14398
 14399     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 14400         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14401         SET W-TX-NDX DOWN BY +6
 14402         IF  W-TX-NDX GREATER THAN +70
 14403             SET W-TX-NDX        TO +70.
 14404
 14405     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14406         SET W-WC-NDX DOWN BY +1.
 14407
 14408 7430-EXIT.
 14409     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 303
* EL689.cbl
 14411 7435-MOVE-VARIABLE-DIRECT.
 14412
 14413     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14414             AND
 14415         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14416             AND
 14417         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14418             AND
 14419         (W-VC-NDX GREATER THAN +1
 14420                 AND
 14421             W-LAST-CHAR NOT EQUAL SPACE
 14422                 AND
 14423             NOT W-LAST-CHAR-PUNC)
 14424         IF  W-LC-USE-BOTH-CASES
 14425             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14426                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14427         ELSE
 14428             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14429                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14430
 14431     SET W-WC-NDX UP BY +1.
 14432     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14433                                 TO W-WORK-CHAR (W-WC-NDX)
 14434                                    W-LAST-CHAR.
 14435
 14436 7435-EXIT.
 14437     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 304
* EL689.cbl
 14439 7437-FIND-NEXT-CHARACTER.
 14440*DELIBERATELY LEFT BLANK.
 14441 7437-EXIT.
 14442     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 305
* EL689.cbl
 14444 7440-BACK-TO-NEAREST-WORD.
 14445
 14446     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 14447
 14448 7440-EXIT.
 14449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 306
* EL689.cbl
 14451 7450-SQUEEZING.
 14452
 14453     IF  W-NEW-PARAGRAPH
 14454         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 14455         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 14456         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14457             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14458             MOVE W-TX-PC (W-TG-NDX)
 14459                                 TO W-PRINT-CONTROL
 14460             MOVE SPACES         TO W-SQUEEZED-LINE
 14461             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14462             SET W-SQ-NDX UP BY W-WORK-INDENT
 14463         ELSE
 14464             MOVE W-TX-PC (W-TG-NDX)
 14465                                 TO W-PRINT-CONTROL
 14466             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14467             SET W-SQ-NDX UP BY W-WORK-INDENT
 14468     ELSE
 14469         IF  W-DO-NOT-ADJUST
 14470             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 14471             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14472                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14473                 MOVE W-WORK-LINE
 14474                                 TO W-SQUEEZED-LINE
 14475                 MOVE W-TX-PC (W-TG-NDX)
 14476                                 TO W-PRINT-CONTROL
 14477                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14478                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14479                 MOVE SPACES     TO W-SQUEEZED-LINE
 14480                 GO TO 7450-EXIT
 14481             ELSE
 14482                 MOVE W-WORK-LINE
 14483                                 TO W-SQUEEZED-LINE
 14484                 MOVE W-TX-PC (W-TG-NDX)
 14485                                 TO W-PRINT-CONTROL
 14486                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14487                 MOVE SPACES     TO W-SQUEEZED-LINE
 14488                                    W-WORK-LINE
 14489                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14490                 GO TO 7450-EXIT
 14491         ELSE
 14492             IF  W-ADJUST-TO-LINE-LENGTH
 14493                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 14494
 14495                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14496                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14497                     SET W-SQ-NDX
 14498                                 TO W-INITIAL-COLUMN
 14499                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14500                             VARYING
 14501                         W-WC-NDX FROM 1 BY 1
 14502                             UNTIL
 14503                         W-SQ-NDX EQUAL W-TOO-FAR
 14504                     MOVE W-TX-PC (W-TG-NDX)
 14505                                 TO W-PRINT-CONTROL
 14506                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14507                     SET W-SQ-NDX
 14508                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 307
* EL689.cbl
 14509                     MOVE SPACES TO W-SQUEEZED-LINE
 14510                                    W-WORK-LINE
 14511                     GO TO 7450-EXIT
 14512                 ELSE
 14513                     SET W-SQ-NDX
 14514                                 TO W-INITIAL-COLUMN
 14515                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14516                             VARYING
 14517                         W-WC-NDX FROM 1 BY 1
 14518                             UNTIL
 14519                         W-SQ-NDX EQUAL W-TOO-FAR
 14520                     MOVE W-TX-PC (W-TG-NDX)
 14521                                 TO W-PRINT-CONTROL
 14522                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14523                     MOVE SPACES TO W-SQUEEZED-LINE
 14524                                    W-WORK-LINE
 14525                     SET W-SQ-NDX
 14526                                 TO W-INITIAL-COLUMN
 14527                     GO TO 7450-EXIT
 14528             ELSE
 14529                 IF  W-CONTINUE-PARAGRAPH
 14530                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14531                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14532                         PERFORM 7610-SET-CONP-INDENT
 14533                             THRU 7610-EXIT
 14534                         MOVE SPACES
 14535                                 TO W-LINE-SQUEEZE-IND
 14536                         MOVE W-TX-PC (W-TG-NDX)
 14537                                 TO W-PRINT-CONTROL
 14538                         MOVE SPACES
 14539                                 TO W-SQUEEZED-LINE
 14540                         SET W-SQ-NDX
 14541                                 TO W-INITIAL-COLUMN
 14542                         SET W-SQ-NDX UP BY W-WORK-INDENT
 14543                     ELSE
 14544                         PERFORM 7610-SET-CONP-INDENT
 14545                             THRU 7610-EXIT
 14546                         MOVE SPACES
 14547                                 TO W-LINE-SQUEEZE-IND
 14548                         MOVE W-TX-PC (W-TG-NDX)
 14549                                 TO W-PRINT-CONTROL
 14550                         MOVE SPACES
 14551                                 TO W-SQUEEZED-LINE
 14552                         SET W-SQ-NDX
 14553                                 TO W-INITIAL-COLUMN
 14554                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 14555
 14556
 14557     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 14558             VARYING
 14559         W-WC-NDX FROM +1 BY +1
 14560             UNTIL
 14561         W-WC-NDX GREATER THAN +70.
 14562
 14563 7450-EXIT.
 14564     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 308
* EL689.cbl
 14566 7460-REMAIN-CHAR-CHECK.
 14567
 14568     IF  W-TX-NDX EQUAL W-WC-NDX
 14569         MOVE W-TX-PC (W-TG-NDX)
 14570                                 TO W-PRINT-CONTROL
 14571         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 14572         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14573         MOVE SPACES             TO W-WORK-LINE
 14574         SET W-WC-NDX            TO +1
 14575     ELSE
 14576         SET W-TX-NDX1           TO W-TX-NDX
 14577         SEARCH W-TX-CHAR
 14578             VARYING W-TX-NDX1
 14579             AT END
 14580                 MOVE W-TX-PC (W-TG-NDX)
 14581                                 TO W-PRINT-CONTROL
 14582                 MOVE W-WORK-LINE
 14583                                 TO W-SQUEEZED-LINE
 14584                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14585                 MOVE SPACES     TO W-WORK-LINE
 14586                 SET W-WC-NDX    TO +1
 14587                 SET W-TX-NDX    TO +1
 14588                 SET W-TG-NDX UP BY +1
 14589             WHEN
 14590                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 14591                 MOVE ER-9427    TO EMI-ERROR
 14592                 MOVE -1         TO MAINTL
 14593                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14594                 MOVE W-TX-PC (W-TG-NDX)
 14595                                 TO W-PRINT-CONTROL
 14596                 MOVE W-WORK-LINE
 14597                                 TO W-SQUEEZED-LINE
 14598                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14599                 MOVE SPACES     TO W-WORK-LINE
 14600                 SET W-WC-NDX    TO +1.
 14601
 14602 7460-EXIT.
 14603     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 309
* EL689.cbl
 14605 7470-MOVE-CHAR.
 14606
 14607     IF  W-FIRST-CHAR-NOT-FOUND
 14608             AND
 14609         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14610         MOVE SPACES             TO W-LAST-CHAR
 14611         GO TO 7470-EXIT.
 14612
 14613     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 14614
 14615     IF  W-SQUEEZE-FIELD
 14616             AND
 14617         W-LAST-CHAR EQUAL SPACES
 14618             AND
 14619         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14620         GO TO 7470-EXIT.
 14621
 14622     SET W-WC-NDX UP BY +1.
 14623
 14624     IF  W-WC-NDX GREATER THAN +70
 14625         IF  W-FORM-SQUEEZE-ON
 14626             GO TO 7470-EXIT
 14627         ELSE
 14628             MOVE ER-9427        TO EMI-ERROR
 14629             MOVE -1             TO MAINTL
 14630             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14631             GO TO 7470-EXIT.
 14632
 14633     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14634             AND
 14635         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14636             AND
 14637         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14638             AND
 14639         (W-VC-NDX GREATER THAN +1
 14640                 AND
 14641             W-LAST-CHAR NOT EQUAL SPACE
 14642                 AND
 14643             NOT W-LAST-CHAR-PUNC)
 14644         IF  W-LC-USE-BOTH-CASES
 14645             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14646                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14647         ELSE
 14648             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14649                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14650
 14651     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14652                                 TO W-WORK-CHAR (W-WC-NDX)
 14653                                    W-LAST-CHAR.
 14654
 14655     IF  W-LAST-CHAR EQUAL SPACES
 14656         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 14657
 14658 7470-EXIT.
 14659     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 310
* EL689.cbl
 14661 7480-UPDATE-SQUEEZED-LINE.
 14662****************************************************************
 14663*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 14664*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 14665*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 14666*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 14667*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 14668*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 14669****************************************************************
 14670
 14671     SET W-SQ-NDX UP BY +1.
 14672
 14673     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 14674         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 14675                                 TO W-CHARACTER-TYPE
 14676         IF  W-PUNCTUATION
 14677                 OR
 14678             W-SPACE
 14679             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 14680             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14681             MOVE SPACES         TO W-SQUEEZED-LINE
 14682             SET W-SQ-NDX        TO W-START-COLUMN
 14683             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14684             SET W-LAST-SQUEEZED-SPACE
 14685                                 TO W-SQ-NDX
 14686         ELSE
 14687             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14688             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14689             MOVE SPACES         TO W-SQUEEZED-LINE
 14690             SET W-SQ-NDX        TO W-START-COLUMN
 14691             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14692             SET W-LAST-SQUEEZED-SPACE
 14693                                 TO W-SQ-NDX.
 14694
 14695     IF  W-WC-NDX GREATER THAN +70
 14696         GO TO 7480-EXIT.
 14697
 14698     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14699
 14700     IF  W-END-OF-SENTENCE
 14701         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 14702         SET W-WORK-NDX          TO W-SQ-NDX
 14703         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 14704         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 14705             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 14706         ELSE
 14707             NEXT SENTENCE
 14708     ELSE
 14709         IF  W-PUNCTUATION
 14710                 AND
 14711             W-LAST-SQ-CHAR EQUAL SPACES
 14712             SET W-SQ-NDX DOWN BY +1
 14713             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 14714         ELSE
 14715             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14716                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 14717                     IF  W-END-OF-SENTENCE-WORKING
 14718                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 311
* EL689.cbl
 14719                                 TO W-END-OF-SENTENCE-IND
 14720                         SET W-LAST-SQUEEZED-SPACE
 14721                                 TO W-SQ-NDX
 14722                     ELSE
 14723                         SET W-SQ-NDX DOWN BY +1
 14724                         GO TO 7480-EXIT
 14725                 ELSE
 14726                     SET W-LAST-SQUEEZED-SPACE
 14727                                 TO W-SQ-NDX
 14728             ELSE
 14729                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 14730
 14731     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 14732                                    W-LAST-SQ-CHAR.
 14733
 14734     IF  W-WC-NDX EQUAL +70
 14735             AND
 14736         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 14737             AND
 14738         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 14739         SET W-SQ-NDX UP BY +1
 14740         SET W-LAST-SQUEEZED-SPACE
 14741                                 TO W-SQ-NDX
 14742         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 14743                                    W-LAST-SQ-CHAR.
 14744
 14745 7480-EXIT.
 14746     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 312
* EL689.cbl
 14748 7485-FIND-NEXT-CHARACTER.
 14749
 14750     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14751
 14752     IF  W-PUNCTUATION
 14753         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14754     ELSE
 14755         SET W-WC-NDX            TO W-WC-NDX
 14756         SEARCH W-WORK-CHAR
 14757             VARYING W-WC-NDX
 14758             AT END
 14759                 GO TO 7485-EXIT
 14760             WHEN
 14761                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 14762                 GO TO 7485-EXIT.
 14763
 14764 7485-EXIT.
 14765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 313
* EL689.cbl
 14767 7490-REMOVE-LAST-WORD.
 14768
 14769*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 14770     IF  W-WC-NDX EQUAL +1
 14771         GO TO 7490-EXIT.
 14772
 14773     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 14774
 14775     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 14776             VARYING
 14777         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 14778             UNTIL
 14779         W-SQ-NDX EQUAL W-TOO-FAR.
 14780
 14781     SET W-WORK-NDX              TO W-WC-NDX.
 14782     COMPUTE W-LAST-WC-SPACE
 14783         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 14784     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 14785
 14786 7490-EXIT.
 14787     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 314
* EL689.cbl
 14789 7500-CLEAR-SQUEEZED-EXCESS.
 14790
 14791     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 14792
 14793 7500-EXIT.
 14794     EXIT.
 14795
 14796 7505-MOVE-STRAIGHT.
 14797
 14798     SET W-SQ-NDX UP BY +1.
 14799
 14800     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 14801
 14802 7505-EXIT.
 14803     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 315
* EL689.cbl
 14805 7510-MOVE-TO-TABLE.
 14806
 14807     IF  W-PRINT-CONTROL NOT NUMERIC
 14808         MOVE 00                 TO W-PRINT-CONTROL
 14809         ADD +1                  TO W-LINE-COUNT
 14810     ELSE
 14811         IF  W-PRINT-CONTROL EQUAL 99
 14812             PERFORM 7640-PAGING THRU 7640-EXIT
 14813             MOVE 00             TO W-PRINT-CONTROL
 14814             SET W-RG-NDX UP BY +1
 14815             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 14816             MOVE +1             TO W-LINE-COUNT
 14817             SET W-RG-NDX UP BY W-TOP-MARGIN
 14818         ELSE
 14819           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 14820             COMPUTE W-LINE-COUNT
 14821                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 14822
 14823     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 14824         PERFORM 7640-PAGING THRU 7640-EXIT
 14825         MOVE 00                 TO W-PRINT-CONTROL
 14826         SET W-RG-NDX UP BY +1
 14827         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 14828         SET W-RG-NDX UP BY W-TOP-MARGIN
 14829         MOVE +1                 TO W-LINE-COUNT.
 14830
 14831     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 14832     SET W-RG-NDX UP BY +1.
 14833     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 14834     MOVE 00                     TO W-PRINT-CONTROL.
 14835
 14836     IF  W-FIRST-BAD-VARIABLE-FOUND
 14837             AND
 14838         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14839         SET W-FIRST-BAD-VARIABLE
 14840                                 TO W-RG-NDX.
 14841
 14842 7510-EXIT.
 14843     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 316
* EL689.cbl
 14845 7600-SET-PARA-INDENT.
 14846
 14847     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 14848         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 14849     ELSE
 14850     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 14851         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14852         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14853     ELSE
 14854     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 14855         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14856         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14857     ELSE
 14858     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 14859         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14860         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14861     ELSE
 14862     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 14863         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14864         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14865     ELSE
 14866     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 14867         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 14868         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 14869
 14870     SET W-TG-NDX2               TO W-TG-NDX.
 14871     SET W-TG-NDX2 UP BY +1.
 14872
 14873     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14874         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14875     ELSE
 14876         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14877
 14878 7600-EXIT.
 14879     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 317
* EL689.cbl
 14881 7610-SET-CONP-INDENT.
 14882
 14883     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 14884         MOVE +0                 TO W-WORK-INDENT
 14885     ELSE
 14886     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 14887         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14888     ELSE
 14889     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 14890         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14891     ELSE
 14892     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 14893         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14894     ELSE
 14895     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 14896         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14897     ELSE
 14898     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 14899         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 14900
 14901     SET W-TG-NDX2               TO W-TG-NDX.
 14902     SET W-TG-NDX2 UP BY +1.
 14903
 14904     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14905         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14906     ELSE
 14907         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14908
 14909 7610-EXIT.
 14910     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 318
* EL689.cbl
 14912 7630-NEXT-LINE.
 14913
 14914     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 14915         MOVE ZEROS              TO W-NEXT-INDENT
 14916     ELSE
 14917     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 14918         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 14919     ELSE
 14920     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 14921         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 14922     ELSE
 14923     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 14924         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 14925     ELSE
 14926     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 14927         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 14928     ELSE
 14929     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 14930         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 14931     ELSE
 14932         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14933         SUBTRACT W-PARAGRAPH-INDENT
 14934                                  FROM W-NEXT-INDENT.
 14935
 14936 7630-EXIT.
 14937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 319
* EL689.cbl
 14939 7640-PAGING.
 14940
 14941     IF  NOT W-LC-CREATE-PAGES
 14942         GO TO 7640-EXIT.
 14943
 14944     IF  W-LINE-COUNT GREATER ZEROS
 14945             AND
 14946         W-RG-NDX GREATER THAN +1
 14947         ADD +1                  TO W-PAGE
 14948         MOVE W-PAGE             TO W-PAGE-NUMBER
 14949         COMPUTE W-PAGE-LINE
 14950             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 14951         IF  W-PAGE-LINE GREATER THAN +2
 14952             SET W-RG-NDX UP BY W-PAGE-LINE
 14953             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 14954         ELSE
 14955             SET W-RG-NDX UP BY +2
 14956             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 14957
 14958 7640-EXIT.
 14959     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 320
* EL689.cbl
 14961 7700-READ-TEXT-TS.
 14962**************************************************************
 14963*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 14964*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 14965*  AND EL1042.                                               *
 14966**************************************************************
 14967
 14968
 14969* EXEC CICS HANDLE CONDITION
 14970*         QIDERR     (7700-TS-ERROR)
 14971*         ITEMERR    (7700-TS-ERROR)
 14972*    END-EXEC.
 14973*    MOVE '"$N<                  ! 9 #00014130' TO DFHEIV0
 14974     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 14975     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14976     MOVE X'3920233030303134313330' TO DFHEIV0(25:11)
 14977     CALL 'kxdfhei1' USING DFHEIV0
 14978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14979
 14980
 14981     SET W-TS-NDX                TO 1.
 14982     MOVE 1                      TO W-TS-ITEM.
 14983
 14984 7700-LOOP.
 14985
 14986     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 14987         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 14988             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 14989             GO TO 7700-EXIT
 14990         ELSE
 14991             GO TO 7700-EXIT.
 14992
 14993
 14994* EXEC CICS READQ TS
 14995*         INTO     (W-TS-WORK-AREA)
 14996*         QUEUE    (W-TS-NAME-TEXT)
 14997*         LENGTH   (W-TS-LENGTH)
 14998*         ITEM     (W-TS-ITEM)
 14999*    END-EXEC.
 15000*    MOVE '*$II   L              ''   #00014147' TO DFHEIV0
 15001     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 15002     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15003     MOVE X'2020233030303134313437' TO DFHEIV0(25:11)
 15004     CALL 'kxdfhei1' USING DFHEIV0,
 15005           W-TS-NAME-TEXT,
 15006           W-TS-WORK-AREA,
 15007           W-TS-LENGTH,
 15008           W-TS-ITEM,
 15009           DFHEIV99,
 15010           DFHEIV99
 15011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15012
 15013
 15014     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 15015     SET W-TS-NDX UP BY 1.
 15016     ADD 1                       TO W-TS-ITEM.
 15017     GO TO 7700-LOOP.
 15018
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 321
* EL689.cbl
 15019 7700-TS-ERROR.
 15020
 15021     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 15022         MOVE ER-0033            TO EMI-ERROR
 15023         MOVE -1                 TO MAINTL
 15024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15025         GO TO 8200-SEND-DATAONLY.
 15026
 15027 7700-EXIT.
 15028      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 322
* EL689.cbl
 15030 7740-RESTORE-SCREEN.
 15031
 15032     MOVE 'C'                    TO MAINTI.
 15033     MOVE +1                     TO MAINTL.
 15034     MOVE AL-UANON               TO MAINTA.
 15035
 15036     MOVE PI-689-FORM-NUMBER     TO FORMI.
 15037     MOVE +4                     TO FORML.
 15038     MOVE AL-UANON               TO FORMA.
 15039
 15040*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 15041*        MOVE PI-689-PRINT-RESTRICTION
 15042*                                TO PRTRESTL
 15043*        MOVE +1                 TO PRTRESTL
 15044*        MOVE AL-UANON           TO PRTRESTA.
 15045
 15046     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 15047         MOVE PI-689-FOLLOW-UP-EDIT
 15048                                 TO FOLLOWI
 15049         MOVE +8                 TO FOLLOWL
 15050         MOVE AL-UANON           TO FOLLOWA.
 15051
 15052     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 15053         MOVE PI-689-RESEND1-EDIT
 15054                                 TO RESEND1I
 15055         MOVE +8                 TO RESEND1L
 15056         MOVE AL-UANON           TO RESEND1A.
 15057     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 15058         MOVE PI-689-ALT-PRINTER-ID
 15059                                 TO PRINTERI
 15060         MOVE +1                 TO PRINTERL
 15061         MOVE AL-UANON           TO PRINTERA.
 15062
 15063     IF  PI-BYPASS-LABELS
 15064          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 15065          MOVE +1                TO ADDRLBLL
 15066          MOVE AL-UANON          TO ADDRLBLA
 15067     ELSE
 15068          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 15069               MOVE PI-689-LBL-OVERRIDE
 15070                                 TO ADDRLBLI
 15071               MOVE +1           TO ADDRLBLL
 15072               MOVE AL-UANON     TO ADDRLBLA.
 15073
 15074     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 15075         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 15076         MOVE +1                     TO COPIESL
 15077         MOVE AL-UNNON               TO COPIESA.
 15078
 15079     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 15080         MOVE PI-689-LABEL-SOURCE
 15081                                 TO ADDRSI
 15082         MOVE +1                 TO ADDRSL
 15083         MOVE AL-UANON           TO ADDRSA.
 15084
 15085     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 15086     MOVE +1                     TO DATASORL.
 15087     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 323
* EL689.cbl
 15088
 15089     IF  PI-689-CARRIER GREATER THAN SPACES
 15090         MOVE PI-689-CARRIER     TO CARRIERI
 15091         MOVE +1                 TO CARRIERL
 15092         MOVE AL-UANON           TO CARRIERA.
 15093
 15094     IF  PI-689-GROUPING GREATER THAN SPACES
 15095         MOVE PI-689-GROUPING    TO GROUPI
 15096         MOVE +6                 TO GROUPL
 15097         MOVE AL-UANON           TO GROUPA.
 15098
 15099     IF  PI-689-STATE GREATER THAN SPACES
 15100         MOVE PI-689-STATE       TO STATEI
 15101         MOVE +2                 TO STATEL
 15102         MOVE AL-UANON           TO STATEA.
 15103
 15104     IF  PI-689-ACCOUNT GREATER THAN SPACES
 15105         MOVE PI-689-ACCOUNT     TO ACCTI
 15106         MOVE +10                TO ACCTL
 15107         MOVE AL-UANON           TO ACCTA.
 15108
 15109     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15110         MOVE PI-689-CERT-PRIME  TO CERTI
 15111         MOVE +10                TO CERTL
 15112         MOVE AL-UANON           TO CERTA.
 15113
 15114     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15115         MOVE PI-689-CERT-SFX    TO SFXI
 15116         MOVE +1                 TO SFXL
 15117         MOVE AL-UANON           TO SFXA.
 15118
 15119     IF  PI-689-TYPE GREATER THAN SPACES
 15120         MOVE PI-689-TYPE        TO TYPEI
 15121         MOVE +1                 TO TYPEL
 15122         MOVE AL-UANON           TO TYPEA.
 15123
 15124     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 15125         MOVE PI-689-RESP-PERSON TO RPERSONI
 15126         MOVE +10                TO RPERSONL
 15127         MOVE AL-UANON           TO RPERSONA.
 15128
 15129     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 15130         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 15131         MOVE +6                 TO BENTRYL
 15132         MOVE AL-UANON           TO BENTRYA.
 15133
 15134     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 15135         MOVE PI-689-SEQ-EDIT    TO SEQI
 15136         MOVE +8                 TO SEQL
 15137         MOVE AL-UNNON           TO SEQA.
 15138
 15139     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 15140         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 15141         MOVE +4                 TO BCSEQL
 15142         MOVE AL-UNNON           TO BCSEQA.
 15143
 15144     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 15145         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 324
* EL689.cbl
 15146         MOVE +8                 TO DATEL
 15147         MOVE AL-UNNON           TO DATEA.
 15148
 15149     IF PI-CERT-FORM-ID GREATER THAN SPACES
 15150        MOVE PI-CERT-FORM-ID     TO CERTIDI
 15151        MOVE +5                  TO CERTIDL
 15152        MOVE AL-UNNON            TO CERTIDA
 15153     END-IF.
 15154
 15155     IF PI-PRINT-NOW GREATER THAN SPACES
 15156        MOVE PI-PRINT-NOW        TO PRTNOWI
 15157        MOVE +1                  TO PRTNOWL
 15158        MOVE AL-UNNON            TO PRTNOWA
 15159     END-IF.
 15160
 15161     MOVE PI-ENCLOSURE-CD        TO ENCI.
 15162     MOVE +3                     TO ENCL.
 15163     MOVE AL-UANON               TO ENCA.
 15164
 15165 7749-EXIT.
 15166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 325
* EL689.cbl
 15168 7760-PUT-TEMP-STORAGE.
 15169**************************************************************
 15170*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 15171*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 15172*  EL1042 AND EL6892.                                        *
 15173**************************************************************
 15174
 15175     SET W-TS-NDX                TO 1.
 15176     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15177
 15178     MOVE -1                     TO MAINTL.
 15179     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15180             VARYING
 15181         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15182             UNTIL
 15183         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15184
 15185 7760-EXIT.
 15186      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 326
* EL689.cbl
 15188 7780-DELETE-TEMP-STOR-TEXT.
 15189
 15190
 15191* EXEC CICS HANDLE CONDITION
 15192*         QIDERR      (7780-EXIT)
 15193*    END-EXEC.
 15194*    MOVE '"$N                   ! : #00014330' TO DFHEIV0
 15195     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 15196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15197     MOVE X'3A20233030303134333330' TO DFHEIV0(25:11)
 15198     CALL 'kxdfhei1' USING DFHEIV0
 15199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15200
 15201
 15202
 15203* EXEC CICS DELETEQ TS
 15204*         QUEUE       (W-TS-NAME-TEXT)
 15205*    END-EXEC.
 15206*    MOVE '*&                    #   #00014334' TO DFHEIV0
 15207     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 15208     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15209     MOVE X'2020233030303134333334' TO DFHEIV0(25:11)
 15210     CALL 'kxdfhei1' USING DFHEIV0,
 15211           W-TS-NAME-TEXT,
 15212           DFHEIV99
 15213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15214
 15215
 15216 7780-EXIT.
 15217     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 327
* EL689.cbl
 15219 7840-WRITE-TS.
 15220
 15221     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 15222     SET W-TS-NDX UP BY 1.
 15223     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 15224
 15225
 15226* EXEC CICS WRITEQ TS
 15227*         FROM    (W-TS-WORK-AREA)
 15228*         QUEUE   (W-TS-NAME-TEXT)
 15229*         LENGTH  (W-TS-LENGTH)
 15230*         ITEM    (PI-TEMP-STOR-ITEMS)
 15231*    END-EXEC.
 15232*    MOVE '*" I                  ''   #00014347' TO DFHEIV0
 15233     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 15234     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15235     MOVE X'2020233030303134333437' TO DFHEIV0(25:11)
 15236     CALL 'kxdfhei1' USING DFHEIV0,
 15237           W-TS-NAME-TEXT,
 15238           W-TS-WORK-AREA,
 15239           W-TS-LENGTH,
 15240           PI-TEMP-STOR-ITEMS,
 15241           DFHEIV99,
 15242           DFHEIV99
 15243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15244
 15245
 15246 7840-EXIT.
 15247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 328
* EL689.cbl
 15249 7900-PRINT-LETTER-NOW.
 15250***************************************************************
 15251*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 15252*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 15253*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 15254*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 15255*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 15256*     ISSUED FOR THE PRINT TRANSACTION.                       *
 15257***************************************************************
 15258
 15259*    IF (EIBAID = DFHPF4 OR DFHPF8)
 15260*            AND
 15261*        PI-SHOW-MODE
 15262*        IF  PRINTERL GREATER ZERO
 15263*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 15264*                                                    W-UPPER-CASE
 15265*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 15266*                                   PI-ALT-DMD-PRT-ID.
 15267*
 15268*    IF  EIBAID EQUAL DFHPF8
 15269*            AND
 15270*        PI-SHOW-MODE
 15271*            AND
 15272*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 15273*        MOVE ER-7247            TO EMI-ERROR
 15274*        MOVE -1                 TO MAINTL
 15275*        MOVE AL-UABON           TO MAINTA
 15276*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15277*        GO TO 8200-SEND-DATAONLY.
 15278
 15279     IF  PI-TOTAL-LINES EQUAL 0
 15280         MOVE ER-0187            TO EMI-ERROR
 15281         MOVE -1                 TO MAINTL
 15282         MOVE AL-UABON           TO MAINTA
 15283         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15284         GO TO 8200-SEND-DATAONLY.
 15285
 15286     IF  EMI-ERROR NOT EQUAL ER-0191
 15287         IF  PI-689-CREATE-NO-SCREENS
 15288*                OR
 15289*            (EIBAID = DFHPF4 OR DFHPF8)
 15290             SET W-RG-NDX        TO +1
 15291         ELSE
 15292             PERFORM 4100-SET-NDX THRU 4100-EXIT
 15293             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15294                     VARYING
 15295                 W-SC-NDX FROM 1 BY 1
 15296                     UNTIL
 15297                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 15298
 15299     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 15300
 15301     IF EIBAID NOT = DFHPF4 AND DFHPF8
 15302         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 15303                 VARYING
 15304             W-RVS-NDX FROM +1 BY +1
 15305                 UNTIL
 15306             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 329
* EL689.cbl
 15307                 OR
 15308             W-REMAINING-VAR-FOUND
 15309         IF  W-REMAINING-VAR-FOUND
 15310             GO TO 4000-ROLL-PAGE.
 15311
 15312*    IF EIBAID = DFHPF4 OR DFHPF8
 15313*       PERFORM 7700-READ-TEXT-TS
 15314*                                THRU 7700-EXIT
 15315*
 15316*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 15317*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15318*                VARYING
 15319*            W-SC-NDX FROM 1 BY 1
 15320*                UNTIL
 15321*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 15322*
 15323*       PERFORM 7760-PUT-TEMP-STORAGE
 15324*                                THRU 7760-EXIT
 15325*    END-IF
 15326     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 15327         MOVE PI-689-ALT-PRINTER-ID
 15328                                 TO W-TS-TERM-TEXT
 15329     ELSE
 15330         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 15331             MOVE PI-PROCESSOR-PRINTER
 15332                                 TO W-TS-TERM-TEXT
 15333         ELSE
 15334             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 15335             MOVE '1'            TO W-CNTL-RECORD-TYPE
 15336             MOVE SPACES         TO W-CNTL-GENL
 15337             MOVE ZEROS          TO W-CNTL-SEQ-NO
 15338
 15339* EXEC CICS HANDLE CONDITION
 15340*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 15341*                 NOTFND     (7945-NOT-FOUND)
 15342*            END-EXEC
 15343*    MOVE '"$JI                  ! ; #00014446' TO DFHEIV0
 15344     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15346     MOVE X'3B20233030303134343436' TO DFHEIV0(25:11)
 15347     CALL 'kxdfhei1' USING DFHEIV0
 15348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15349
 15350* EXEC CICS READ
 15351*                 DATASET    (W-CNTL-FILE-ID)
 15352*                 SET        (ADDRESS OF CONTROL-FILE)
 15353*                 RIDFLD     (W-CNTL-KEY)
 15354*            END-EXEC
 15355*    MOVE '&"S        E          (   #00014450' TO DFHEIV0
 15356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15358     MOVE X'2020233030303134343530' TO DFHEIV0(25:11)
 15359     CALL 'kxdfhei1' USING DFHEIV0,
 15360           W-CNTL-FILE-ID,
 15361           DFHEIV20,
 15362           DFHEIV99,
 15363           W-CNTL-KEY,
 15364           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 330
* EL689.cbl
 15365           DFHEIV99,
 15366           DFHEIV99
 15367     SET ADDRESS OF CONTROL-FILE TO
 15368         DFHEIV20
 15369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15370             MOVE CF-FORMS-PRINTER-ID
 15371                                 TO W-TS-TERM-TEXT.
 15372
 15373***********************************************************
 15374*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 15375*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 15376***********************************************************
 15377
 15378     SET W-TS-NDX                TO 1.
 15379     MOVE EIBTIME                TO W-TS-ID-TIME.
 15380     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 15381     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15382
 15383     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15384             VARYING
 15385         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15386             UNTIL
 15387         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15388
 15389*    IF  EIBAID EQUAL DFHPF8
 15390*        MOVE '1'                TO PI-689-PRINT-SW
 15391*    ELSE
 15392         MOVE SPACES             TO PI-689-PRINT-SW.
 15393
 15394
 15395* EXEC CICS HANDLE CONDITION
 15396*         TERMIDERR  (7935-TERM-ERROR)
 15397*         TRANSIDERR (7940-TRAN-ERROR)
 15398*    END-EXEC.
 15399*    MOVE '"$[\                  ! < #00014479' TO DFHEIV0
 15400     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 15401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15402     MOVE X'3C20233030303134343739' TO DFHEIV0(25:11)
 15403     CALL 'kxdfhei1' USING DFHEIV0
 15404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15405
 15406
 15407
 15408* EXEC CICS START
 15409*             INTERVAL    (0)
 15410*             TRANSID     (W-PRINT-TRANS)
 15411*             FROM        (PROGRAM-INTERFACE-BLOCK)
 15412*             LENGTH      (PI-COMM-LENGTH)
 15413*             TERMID      (W-TS-TERM-TEXT)
 15414*    END-EXEC.
 15415     MOVE 0 TO DFHEIV10
 15416*    MOVE '0(ILFT                0   #00014484' TO DFHEIV0
 15417     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 15418     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
 15419     MOVE X'2020233030303134343834' TO DFHEIV0(25:11)
 15420     CALL 'kxdfhei1' USING DFHEIV0,
 15421           DFHEIV10,
 15422           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 331
* EL689.cbl
 15423           DFHEIV99,
 15424           PROGRAM-INTERFACE-BLOCK,
 15425           PI-COMM-LENGTH,
 15426           W-TS-TERM-TEXT,
 15427           DFHEIV99,
 15428           DFHEIV99,
 15429           DFHEIV99,
 15430           DFHEIV99,
 15431           DFHEIV99,
 15432           DFHEIV99,
 15433           DFHEIV99,
 15434           DFHEIV99,
 15435           DFHEIV99
 15436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15437
 15438
 15439
 15440* EXEC CICS SYNCPOINT
 15441*    END-EXEC.
 15442*    MOVE '6"                    !   #00014492' TO DFHEIV0
 15443     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 15444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15445     MOVE X'2020233030303134343932' TO DFHEIV0(25:11)
 15446     CALL 'kxdfhei1' USING DFHEIV0
 15447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15448
 15449
 15450     IF  PI-689-CREATE-NO-SCREENS
 15451         GO TO 7900-EXIT.
 15452
 15453*    IF  EIBAID EQUAL DFHPF8
 15454*            AND
 15455*        PI-SHOW-MODE
 15456*            AND
 15457*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 15458*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 15459
 15460     MOVE ER-0189                TO EMI-ERROR.
 15461     MOVE -1                     TO MAINTL.
 15462
 15463     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 15464     MOVE -1                     TO MAINTL
 15465     MOVE AL-UABON               TO MAINTA
 15466     MOVE '104A'                 TO W-TS-ID-TEXT
 15467     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15468                                    W-TS-TERM-SCREEN
 15469     GO TO 8200-SEND-DATAONLY.
 15470
 15471 7900-EXIT.
 15472     EXIT.
 15473
 15474 7915-SEARCH-REMAINING-VARS.
 15475
 15476     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 15477         SET W-RVS-NDX2          TO W-RVS-NDX
 15478         SET W-RVS-NDX2 UP BY +1
 15479         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
 15480             SET W-RVS-NDX2 UP BY +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 332
* EL689.cbl
 15481             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 15482                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 15483                 COMPUTE PI-CURRENT-LINE
 15484                     = PI-CURRENT-LINE / 73
 15485                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 15486                 MOVE +0         TO W-ROLL-COUNTER
 15487                 MOVE ER-0191    TO EMI-ERROR
 15488                 MOVE -1         TO MAINTL
 15489                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15490
 15491 7915-EXIT.
 15492     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 333
* EL689.cbl
 15494 7920-UPDATE-INITIAL-PRINT.
 15495
 15496
 15497* EXEC CICS HANDLE CONDITION
 15498*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 15499*         NOTFND     (1070-ARCH-NOT-FOUND)
 15500*         ENDFILE    (1070-ARCH-NOT-FOUND)
 15501*    END-EXEC.
 15502*    MOVE '"$JI''                 ! = #00014541' TO DFHEIV0
 15503     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 15504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15505     MOVE X'3D20233030303134353431' TO DFHEIV0(25:11)
 15506     CALL 'kxdfhei1' USING DFHEIV0
 15507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15508
 15509     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 15510     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 15511
 15512* EXEC CICS READ
 15513*        DATASET (W-ARCH-FILE-ID)
 15514*        SET     (ADDRESS OF LETTER-ARCHIVE)
 15515*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 15516*        UPDATE
 15517*    END-EXEC.
 15518*    MOVE '&"S        EU         (   #00014548' TO DFHEIV0
 15519     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15520     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15521     MOVE X'2020233030303134353438' TO DFHEIV0(25:11)
 15522     CALL 'kxdfhei1' USING DFHEIV0,
 15523           W-ARCH-FILE-ID,
 15524           DFHEIV20,
 15525           DFHEIV99,
 15526           W-ARCH-PARTIAL-KEY,
 15527           DFHEIV99,
 15528           DFHEIV99,
 15529           DFHEIV99
 15530     SET ADDRESS OF LETTER-ARCHIVE TO
 15531         DFHEIV20
 15532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15533
 15534
 15535     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 15536
 15537     IF  LA-RESEND-DATE = LOW-VALUES
 15538         MOVE 'C'                TO LA-STATUS.
 15539
 15540
 15541* EXEC CICS REWRITE
 15542*         FROM      (LETTER-ARCHIVE)
 15543*         DATASET   (W-ARCH-FILE-ID)
 15544*    END-EXEC.
 15545     MOVE LENGTH OF
 15546      LETTER-ARCHIVE
 15547       TO DFHEIV11
 15548*    MOVE '&& L                  %   #00014560' TO DFHEIV0
 15549     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15550     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15551     MOVE X'2020233030303134353630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 334
* EL689.cbl
 15552     CALL 'kxdfhei1' USING DFHEIV0,
 15553           W-ARCH-FILE-ID,
 15554           LETTER-ARCHIVE,
 15555           DFHEIV11,
 15556           DFHEIV99
 15557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15558
 15559
 15560 7920-EXIT.
 15561     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 335
* EL689.cbl
 15563 7935-TERM-ERROR.
 15564
 15565     MOVE ER-0412                TO EMI-ERROR.
 15566     MOVE SPACES                 TO PI-689-PRINT-SW.
 15567     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15568     MOVE -1                     TO MAINTL.
 15569     GO TO 8200-SEND-DATAONLY.
 15570
 15571 7940-TRAN-ERROR.
 15572
 15573     MOVE ER-0413                TO EMI-ERROR.
 15574     MOVE SPACES                 TO PI-689-PRINT-SW.
 15575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15576     MOVE -1                     TO MAINTL.
 15577     GO TO 8200-SEND-DATAONLY.
 15578
 15579 7945-NOT-FOUND.
 15580
 15581     MOVE ER-0190                TO EMI-ERROR.
 15582     MOVE -1                     TO MAINTL.
 15583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15584     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 336
* EL689.cbl
 15586 8010-ARCH-NOT-OPEN.
 15587
 15588     MOVE ER-7388                TO EMI-ERROR.
 15589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15590     MOVE -1                     TO MAINTL.
 15591     GO TO 8200-SEND-DATAONLY.
 15592
 15593 8015-ARCT-NOT-OPEN.
 15594
 15595     MOVE ER-7373                TO EMI-ERROR.
 15596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15597     MOVE -1                     TO MAINTL.
 15598     GO TO 8200-SEND-DATAONLY.
 15599
 15600 8020-ACCT-NOT-OPEN.
 15601
 15602     MOVE ER-0168 TO EMI-ERROR
 15603     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15604     MOVE -1                     TO MAINTL.
 15605     GO TO 8200-SEND-DATAONLY.
 15606
 15607 8030-CERT-NOT-OPEN.
 15608
 15609     MOVE ER-0169 TO EMI-ERROR.
 15610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15611     MOVE -1                     TO MAINTL.
 15612     GO TO 8200-SEND-DATAONLY.
 15613
 15614 8035-CERT-NOT-FOUND.
 15615
 15616     MOVE ER-2369 TO EMI-ERROR.
 15617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15618     MOVE -1                     TO MAINTL.
 15619     GO TO 8200-SEND-DATAONLY.
 15620
 15621 8040-CNTL-NOT-OPEN.
 15622
 15623     MOVE ER-0042                TO EMI-ERROR.
 15624     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15625     MOVE -1                     TO MAINTL.
 15626     GO TO 8200-SEND-DATAONLY.
 15627
 15628 8045-CHEK-NOT-OPEN.
 15629
 15630     MOVE ER-3775                TO EMI-ERROR.
 15631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15632     MOVE -1                     TO MAINTL.
 15633     GO TO 8200-SEND-DATAONLY.
 15634
 15635 8050-TEXT-NOT-OPEN.
 15636
 15637     MOVE ER-0013                TO EMI-ERROR.
 15638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15639     MOVE -1                     TO MAINTL.
 15640     GO TO 8200-SEND-DATAONLY.
 15641
 15642 8060-PNDB-NOT-OPEN.
 15643
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 337
* EL689.cbl
 15644     MOVE ER-2216 TO EMI-ERROR.
 15645     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15646     MOVE -1                     TO MAINTL.
 15647     GO TO 8200-SEND-DATAONLY.
 15648
 15649 8070-PNDB-NOT-FOUND.
 15650
 15651     MOVE ER-7374 TO EMI-ERROR.
 15652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15653     MOVE -1                     TO MAINTL.
 15654     GO TO 8200-SEND-DATAONLY.
 15655
 15656 8080-COMP-NOT-OPEN.
 15657
 15658     MOVE ER-2055 TO EMI-ERROR
 15659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15660     MOVE -1                     TO MAINTL.
 15661     GO TO 8200-SEND-DATAONLY.
 15662
 15663 8085-PYAJ-NOT-OPEN.
 15664
 15665     MOVE ER-2232 TO EMI-ERROR
 15666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15667     MOVE -1                     TO MAINTL.
 15668     GO TO 8200-SEND-DATAONLY.
 15669
 15670 8090-MAIL-NOT-OPEN.
 15671
 15672     MOVE ER-2999                TO EMI-ERROR.
 15673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15674     MOVE -1                     TO MAINTL.
 15675     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 338
* EL689.cbl
 15677 8100-SEND-INITIAL-MAP.
 15678
 15679     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 15680     IF  PI-689-CREATE-NO-SCREENS
 15681         MOVE '9999'             TO PI-689-ERROR
 15682         GO TO 0620-RETURN-TO-CALLER.
 15683
 15684     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15685
 15686     IF  NOT EMI-NO-ERRORS
 15687         MOVE EMI-MESSAGE-AREA (1)
 15688                                 TO ERRMSGO
 15689     ELSE
 15690         MOVE SPACES             TO ERRMSGO.
 15691     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 15692                                 TO SYSO
 15693     MOVE WS-KIXHOST             TO HOSTO
 15694     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 15695        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 15696        MOVE AL-SADOF            TO PF8HDA
 15697     END-IF
 15698     IF NOT PI-CREATE-LABELS
 15699         MOVE AL-PANON           TO ADDRLBLA.
 15700
 15701
 15702* EXEC CICS SEND
 15703*        MAP    (W-MAP)
 15704*        MAPSET (W-MAPSET)
 15705*        FROM   (EL689AO)
 15706*        ERASE
 15707*        CURSOR
 15708*    END-EXEC.
 15709     MOVE LENGTH OF
 15710      EL689AO
 15711       TO DFHEIV12
 15712     MOVE -1
 15713       TO DFHEIV11
 15714*    MOVE '8$     CT  E    H L F ,   #00014706' TO DFHEIV0
 15715     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15716     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15717     MOVE X'2020233030303134373036' TO DFHEIV0(25:11)
 15718     CALL 'kxdfhei1' USING DFHEIV0,
 15719           W-MAP,
 15720           EL689AO,
 15721           DFHEIV12,
 15722           W-MAPSET,
 15723           DFHEIV99,
 15724           DFHEIV99,
 15725           DFHEIV99,
 15726           DFHEIV11,
 15727           DFHEIV99,
 15728           DFHEIV99,
 15729           DFHEIV99
 15730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15731
 15732
 15733     GO TO 9000-RETURN-TRANS.
 15734
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 339
* EL689.cbl
 15735 8100-EXIT.
 15736     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 340
* EL689.cbl
 15738 8200-SEND-DATAONLY.
 15739
 15740     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 15741     IF  PI-689-CREATE-NO-SCREENS
 15742         MOVE '9999'             TO PI-689-ERROR
 15743         GO TO 0620-RETURN-TO-CALLER.
 15744
 15745     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15746
 15747     IF EMI-ERROR = ER-0715
 15748         DISPLAY 'ER 0715'
 15749         MOVE -1          TO CERTIDL
 15750         MOVE +0          TO MAINTL
 15751     END-IF
 15752
 15753     IF  NOT EMI-NO-ERRORS
 15754         MOVE EMI-MESSAGE-AREA (1)
 15755                                 TO ERRMSGO
 15756     ELSE
 15757         MOVE SPACES             TO ERRMSGO.
 15758
 15759
 15760* EXEC CICS SEND
 15761*        MAP    (W-MAP)
 15762*        MAPSET (W-MAPSET)
 15763*        FROM   (EL689AO)
 15764*        DATAONLY
 15765*        CURSOR
 15766*    END-EXEC.
 15767     MOVE LENGTH OF
 15768      EL689AO
 15769       TO DFHEIV12
 15770     MOVE -1
 15771       TO DFHEIV11
 15772*    MOVE '8$D    CT       H L F ,   #00014740' TO DFHEIV0
 15773     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15774     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15775     MOVE X'2020233030303134373430' TO DFHEIV0(25:11)
 15776     CALL 'kxdfhei1' USING DFHEIV0,
 15777           W-MAP,
 15778           EL689AO,
 15779           DFHEIV12,
 15780           W-MAPSET,
 15781           DFHEIV99,
 15782           DFHEIV99,
 15783           DFHEIV99,
 15784           DFHEIV11,
 15785           DFHEIV99,
 15786           DFHEIV99,
 15787           DFHEIV99
 15788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15789
 15790
 15791     GO TO 9000-RETURN-TRANS.
 15792
 15793 8200-EXIT.
 15794     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 341
* EL689.cbl
 15796 8300-SEND-TEXT.
 15797
 15798     IF  PI-689-CREATE-NO-SCREENS
 15799         MOVE '9999'             TO PI-689-ERROR
 15800         GO TO 0620-RETURN-TO-CALLER.
 15801
 15802
 15803* EXEC CICS SEND TEXT
 15804*        FROM    (LOGOFF-TEXT)
 15805*        LENGTH  (LOGOFF-LENGTH)
 15806*        ERASE
 15807*        FREEKB
 15808*    END-EXEC.
 15809*    MOVE '8&      T  E F  H   F -   #00014759' TO DFHEIV0
 15810     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15811     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15812     MOVE X'2020233030303134373539' TO DFHEIV0(25:11)
 15813     CALL 'kxdfhei1' USING DFHEIV0,
 15814           LOGOFF-TEXT,
 15815           LOGOFF-LENGTH,
 15816           DFHEIV99,
 15817           DFHEIV99,
 15818           DFHEIV99,
 15819           DFHEIV99,
 15820           DFHEIV99,
 15821           DFHEIV99,
 15822           DFHEIV99,
 15823           DFHEIV99,
 15824           DFHEIV99,
 15825           DFHEIV99
 15826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15827
 15828
 15829     GO TO 9000-RETURN-TRANS.
 15830
 15831 8300-EXIT.
 15832     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 342
* EL689.cbl
 15834 8350-SEND-DATAONLY-ERASEAUP.
 15835
 15836     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15837     PERFORM 7760-PUT-TEMP-STORAGE
 15838                                 THRU 7760-EXIT
 15839     IF  PI-689-CREATE-NO-SCREENS
 15840         MOVE '9999'             TO PI-689-ERROR
 15841         GO TO 0620-RETURN-TO-CALLER.
 15842
 15843     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15844
 15845     IF EMI-ERROR = ER-0715
 15846         DISPLAY 'ER 0715'
 15847         MOVE -1          TO CERTIDL
 15848         MOVE +0          TO MAINTL
 15849     END-IF
 15850
 15851     IF  NOT EMI-NO-ERRORS
 15852         MOVE EMI-MESSAGE-AREA (1)
 15853                                 TO ERRMSGO
 15854     ELSE
 15855         MOVE SPACES             TO ERRMSGO.
 15856
 15857
 15858* EXEC CICS SEND
 15859*        MAP      (W-MAP)
 15860*        MAPSET   (W-MAPSET)
 15861*        FROM     (EL689AO)
 15862*        DATAONLY
 15863*        ERASEAUP
 15864*        CURSOR
 15865*    END-EXEC.
 15866     MOVE LENGTH OF
 15867      EL689AO
 15868       TO DFHEIV12
 15869     MOVE -1
 15870       TO DFHEIV11
 15871*    MOVE '8$D    CT  A    H L F ,   #00014794' TO DFHEIV0
 15872     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 15873     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15874     MOVE X'2020233030303134373934' TO DFHEIV0(25:11)
 15875     CALL 'kxdfhei1' USING DFHEIV0,
 15876           W-MAP,
 15877           EL689AO,
 15878           DFHEIV12,
 15879           W-MAPSET,
 15880           DFHEIV99,
 15881           DFHEIV99,
 15882           DFHEIV99,
 15883           DFHEIV11,
 15884           DFHEIV99,
 15885           DFHEIV99,
 15886           DFHEIV99
 15887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15888
 15889
 15890     GO TO 9000-RETURN-TRANS.
 15891
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 343
* EL689.cbl
 15892 8350-EXIT.
 15893     EXIT.
 15894
 15895 8600-DEEDIT.
 15896
 15897
 15898* EXEC CICS BIF DEEDIT
 15899*         FIELD    (W-DEEDIT-FIELD)
 15900*         LENGTH   (15)
 15901*    END-EXEC.
 15902     MOVE 15
 15903       TO DFHEIV11
 15904*    MOVE '@"L                   #   #00014810' TO DFHEIV0
 15905     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 15906     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15907     MOVE X'2020233030303134383130' TO DFHEIV0(25:11)
 15908     CALL 'kxdfhei1' USING DFHEIV0,
 15909           W-DEEDIT-FIELD,
 15910           DFHEIV11
 15911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15912
 15913
 15914 8600-EXIT.
 15915     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 344
* EL689.cbl
 15917 9000-RETURN-TRANS.
 15918
 15919     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 15920     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 15921     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 15922     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 15923
 15924* EXEC CICS RETURN
 15925*        TRANSID    (W-TRANSACTION)
 15926*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 15927*        LENGTH     (PI-COMM-LENGTH)
 15928*    END-EXEC.
 15929*    MOVE '.(CT                  &   #00014824' TO DFHEIV0
 15930     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15931     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15932     MOVE X'2020233030303134383234' TO DFHEIV0(25:11)
 15933     CALL 'kxdfhei1' USING DFHEIV0,
 15934           W-TRANSACTION,
 15935           PROGRAM-INTERFACE-BLOCK,
 15936           PI-COMM-LENGTH,
 15937           DFHEIV99,
 15938           DFHEIV99
 15939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15940
 15941*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 15942*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15943*    GO TO 0200-RECEIVE.
 15944
 15945 9000-EXIT.
 15946     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 345
* EL689.cbl
 15948 9200-PA.
 15949
 15950     MOVE ER-0008                TO EMI-ERROR.
 15951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15952     MOVE -1                     TO MAINTL.
 15953     GO TO 8200-SEND-DATAONLY.
 15954
 15955 9200-EXIT.
 15956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 346
* EL689.cbl
 15958 9300-DFHCLEAR.
 15959
 15960     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 15961         MOVE '2'                TO PI-ACTION.
 15962
 15963     IF  PI-CLEAR-MODE
 15964         MOVE PI-RETURN-TO-PROGRAM
 15965                                 TO W-CALL-PGM
 15966         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15967         GO TO 9400-XCTL
 15968     ELSE
 15969         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15970         MOVE LOW-VALUES         TO EL689AO
 15971                                    PI-1042-WA
 15972                                    PI-689-WORK-AREA
 15973         MOVE ZEROS              TO PI-CURRENT-LINE
 15974                                    PI-TEMP-STOR-ITEMS
 15975                                    PI-TOTAL-LINES
 15976                                    PI-UPDATE-SW
 15977                                    PI-689-NUMBER-LABEL-LINES
 15978         MOVE SPACES             TO PI-689-PRINT-SW
 15979                                    PI-689-ALT-PRINTER-ID
 15980                                    PI-COMM-CONTROL
 15981                                    PI-689-FORM-NUMBER
 15982                                    PI-689-TEMP-STOR-ID
 15983                                    PI-689-LABEL-SOURCE
 15984                                    PI-689-USE-SCREEN-IND
 15985         MOVE '2'                TO PI-ACTION
 15986         MOVE -1                 TO MAINTL
 15987         GO TO 8100-SEND-INITIAL-MAP.
 15988
 15989 9300-EXIT.
 15990     EXIT.
 15991
 15992 9400-XCTL.
 15993
 15994
 15995* EXEC CICS XCTL
 15996*        PROGRAM  (W-CALL-PGM)
 15997*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 15998*        LENGTH   (PI-COMM-LENGTH)
 15999*    END-EXEC.
 16000*    MOVE '.$C                   $   #00014882' TO DFHEIV0
 16001     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16002     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16003     MOVE X'2020233030303134383832' TO DFHEIV0(25:11)
 16004     CALL 'kxdfhei1' USING DFHEIV0,
 16005           W-CALL-PGM,
 16006           PROGRAM-INTERFACE-BLOCK,
 16007           PI-COMM-LENGTH
 16008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16009
 16010
 16011 9400-EXIT.
 16012     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 347
* EL689.cbl
 16014 9500-LINK-DATE-CONVERT.
 16015
 16016     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 16017             AND
 16018         DC-OPTION-CODE EQUAL ' '
 16019         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 16020         GO TO 9500-EXIT.
 16021
 16022
 16023* EXEC CICS LINK
 16024*        PROGRAM    ('ELDATCV')
 16025*        COMMAREA   (DATE-CONVERSION-DATA)
 16026*        LENGTH     (DC-COMM-LENGTH)
 16027*    END-EXEC.
 16028     MOVE 'ELDATCV' TO DFHEIV1
 16029*    MOVE '."C                   ''   #00014899' TO DFHEIV0
 16030     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16031     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16032     MOVE X'2020233030303134383939' TO DFHEIV0(25:11)
 16033     CALL 'kxdfhei1' USING DFHEIV0,
 16034           DFHEIV1,
 16035           DATE-CONVERSION-DATA,
 16036           DC-COMM-LENGTH,
 16037           DFHEIV99,
 16038           DFHEIV99,
 16039           DFHEIV99
 16040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16041
 16042
 16043     IF  NO-CONVERSION-ERROR
 16044             AND
 16045         PI-COMPANY-ID EQUAL 'AUK'
 16046             AND
 16047         W-REVERSE-DATE
 16048         MOVE DC-GREG-DATE-1-EDIT
 16049                                 TO W-EDIT-DATE-1
 16050         MOVE W-ED1-MM           TO W-ED2-MM
 16051         MOVE W-ED1-DD           TO W-ED2-DD
 16052         MOVE W-ED1-YY           TO W-ED2-YY
 16053         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 16054
 16055 9500-EXIT.
 16056     EXIT.
 16057
 16058 9600-FORMAT-DATE-TIME.
 16059
 16060     MOVE W-SAVE-DATE            TO RUNDTEO.
 16061     MOVE EIBTIME                TO W-TIME-IN.
 16062     MOVE W-TIME-OUT             TO RUNTIMEO.
 16063     MOVE PI-COMPANY-ID          TO COMPANYO.
 16064     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16065     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16066
 16067 9600-EXIT.
 16068     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 348
* EL689.cbl
 16070 9700-PGMID-ERROR.
 16071
 16072     IF  PI-689-CREATE-NO-SCREENS
 16073         MOVE '9999'             TO PI-689-ERROR
 16074         GO TO 0620-RETURN-TO-CALLER.
 16075
 16076
 16077* EXEC CICS  HANDLE CONDITION
 16078*        PGMIDERR  (8300-SEND-TEXT)
 16079*    END-EXEC.
 16080*    MOVE '"$L                   ! > #00014938' TO DFHEIV0
 16081     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16083     MOVE X'3E20233030303134393338' TO DFHEIV0(25:11)
 16084     CALL 'kxdfhei1' USING DFHEIV0
 16085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16086
 16087
 16088     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 16089     MOVE ' '                    TO PI-ENTRY-CD-1.
 16090     MOVE W-XCTL-005             TO W-CALL-PGM
 16091                                    LOGOFF-PGM.
 16092     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16093
 16094     PERFORM 9400-XCTL THRU 9400-EXIT.
 16095
 16096 9700-EXIT.
 16097     EXIT.
 16098
 16099 9800-ABEND.
 16100
 16101     IF  PI-689-CREATE-NO-SCREENS
 16102         MOVE '9999'             TO PI-689-ERROR
 16103         GO TO 0620-RETURN-TO-CALLER.
 16104
 16105     MOVE W-LINK-004             TO W-CALL-PGM.
 16106     MOVE DFHEIBLK               TO EMI-LINE1
 16107
 16108
 16109* EXEC CICS  LINK
 16110*        PROGRAM   (W-CALL-PGM)
 16111*        COMMAREA  (EMI-LINE1)
 16112*        LENGTH    (72)
 16113*    END-EXEC.
 16114     MOVE 72
 16115       TO DFHEIV11
 16116*    MOVE '."C                   ''   #00014962' TO DFHEIV0
 16117     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16118     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16119     MOVE X'2020233030303134393632' TO DFHEIV0(25:11)
 16120     CALL 'kxdfhei1' USING DFHEIV0,
 16121           W-CALL-PGM,
 16122           EMI-LINE1,
 16123           DFHEIV11,
 16124           DFHEIV99,
 16125           DFHEIV99,
 16126           DFHEIV99
 16127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 349
* EL689.cbl
 16128
 16129
 16130     GO TO 8200-SEND-DATAONLY.
 16131
 16132 9800-EXIT.
 16133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 350
* EL689.cbl
 16135 9900-ERROR-FORMAT.
 16136
 16137     IF  PI-689-CREATE-NO-SCREENS
 16138         MOVE EMI-ERROR          TO PI-689-ERROR
 16139         IF  PI-689-FATAL-ERROR
 16140             GO TO 0620-RETURN-TO-CALLER
 16141         ELSE
 16142             GO TO 9900-EXIT.
 16143
 16144     IF  EMI-ERROR EQUAL ER-9097
 16145         NEXT SENTENCE
 16146     ELSE
 16147         IF  EMI-ERRORS-COMPLETE
 16148                 OR
 16149             EMI-ERROR EQUAL W-LAST-ERROR
 16150             GO TO 9900-EXIT.
 16151
 16152     MOVE W-LINK-001             TO W-CALL-PGM.
 16153
 16154
 16155* EXEC CICS LINK
 16156*        PROGRAM    (W-CALL-PGM)
 16157*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16158*        LENGTH     (EMI-COMM-LENGTH)
 16159*    END-EXEC.
 16160*    MOVE '."C                   ''   #00014992' TO DFHEIV0
 16161     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16162     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16163     MOVE X'2020233030303134393932' TO DFHEIV0(25:11)
 16164     CALL 'kxdfhei1' USING DFHEIV0,
 16165           W-CALL-PGM,
 16166           ERROR-MESSAGE-INTERFACE-BLOCK,
 16167           EMI-COMM-LENGTH,
 16168           DFHEIV99,
 16169           DFHEIV99,
 16170           DFHEIV99
 16171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16172
 16173
 16174     IF  EMI-SEVERITY (2) EQUAL 'X'
 16175             AND
 16176         EMI-SEVERITY (1) NOT EQUAL 'X'
 16177         MOVE EMI-MESSAGE-AREA (2)
 16178                                 TO EMI-MESSAGE-AREA (1).
 16179
 16180     MOVE EMI-ERROR              TO W-LAST-ERROR.
 16181
 16182 9900-EXIT.
 16183     EXIT.
 16184
 16185 9905-INITIALIZE-SECURITY.
 16186******************************************************************
 16187*                                                                *
 16188*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 16189*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 16190*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 16191*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
 16192*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 351
* EL689.cbl
 16193*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 16194*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 16195*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 16196*                                                                *
 16197*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 16198*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 16199*                                                                *
 16200******************************************************************
 16201
 16202     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 16203         MOVE 'Y'                TO PI-DISPLAY-CAP
 16204                                    PI-MODIFY-CAP
 16205     ELSE
 16206
 16207* EXEC CICS READQ TS
 16208*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 16209*            INTO   (SECURITY-CONTROL)
 16210*            LENGTH (SC-COMM-LENGTH)
 16211*            ITEM   (1)
 16212*        END-EXEC
 16213     MOVE 1
 16214       TO DFHEIV11
 16215*    MOVE '*$II   L              ''   #00015030' TO DFHEIV0
 16216     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16218     MOVE X'2020233030303135303330' TO DFHEIV0(25:11)
 16219     CALL 'kxdfhei1' USING DFHEIV0,
 16220           PI-SECURITY-TEMP-STORE-ID,
 16221           SECURITY-CONTROL,
 16222           SC-COMM-LENGTH,
 16223           DFHEIV11,
 16224           DFHEIV99,
 16225           DFHEIV99
 16226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16227         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 16228                                 TO PI-DISPLAY-CAP
 16229         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 16230                                 TO PI-MODIFY-CAP.
 16231
 16232 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 352
* EL689.cbl
 16234 9995-SECURITY-VIOLATION.
 16235
 16236     MOVE EIBDATE                TO SM-JUL-DATE.
 16237     MOVE EIBTRMID               TO SM-TERMID.
 16238     MOVE W-THIS-PGM             TO SM-PGM.
 16239     MOVE EIBTIME                TO W-TIME-IN.
 16240     MOVE W-TIME-OUT             TO SM-TIME.
 16241     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 16242
 16243
 16244* EXEC CICS LINK
 16245*         PROGRAM  ('EL003')
 16246*         COMMAREA (SECURITY-MESSAGE)
 16247*         LENGTH   (80)
 16248*    END-EXEC.
 16249     MOVE 'EL003' TO DFHEIV1
 16250     MOVE 80
 16251       TO DFHEIV11
 16252*    MOVE '."C                   ''   #00015052' TO DFHEIV0
 16253     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16254     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16255     MOVE X'2020233030303135303532' TO DFHEIV0(25:11)
 16256     CALL 'kxdfhei1' USING DFHEIV0,
 16257           DFHEIV1,
 16258           SECURITY-MESSAGE,
 16259           DFHEIV11,
 16260           DFHEIV99,
 16261           DFHEIV99,
 16262           DFHEIV99
 16263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16264
 16265
 16266 9995-EXIT.
 16267     EXIT.
 16268
 16269 9999-GOBACK.
 16270
 16271
 16272* GOBACK.
 16273     MOVE '9%                    "   ' TO DFHEIV0
 16274     MOVE 'EL689' TO DFHEIV1
 16275     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16276     GOBACK.
 16277
 16278 9999-EXIT.
 16279     EXIT.
 16280
 16281 9999-DFHBACK SECTION.
 16282     MOVE '9%                    "   ' TO DFHEIV0
 16283     MOVE 'EL689' TO DFHEIV1
 16284     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16285     GOBACK.
 16286 9999-DFHEXIT.
 16287     IF DFHEIGDJ EQUAL 0001
 16288         NEXT SENTENCE
 16289     ELSE IF DFHEIGDJ EQUAL 2
 16290         GO TO 9300-DFHCLEAR,
 16291               9200-PA,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 353
* EL689.cbl
 16292               9200-PA,
 16293               9200-PA
 16294         DEPENDING ON DFHEIGDI
 16295     ELSE IF DFHEIGDJ EQUAL 3
 16296         GO TO 9700-PGMID-ERROR,
 16297               9800-ABEND,
 16298               0325-MAPFAIL
 16299         DEPENDING ON DFHEIGDI
 16300     ELSE IF DFHEIGDJ EQUAL 4
 16301         GO TO 8040-CNTL-NOT-OPEN,
 16302               7945-NOT-FOUND
 16303         DEPENDING ON DFHEIGDI
 16304     ELSE IF DFHEIGDJ EQUAL 5
 16305         GO TO 9700-PGMID-ERROR,
 16306               0325-MAPFAIL,
 16307               9800-ABEND
 16308         DEPENDING ON DFHEIGDI
 16309     ELSE IF DFHEIGDJ EQUAL 6
 16310         GO TO 0990-CARRIER-NOT-FOUND,
 16311               8040-CNTL-NOT-OPEN
 16312         DEPENDING ON DFHEIGDI
 16313     ELSE IF DFHEIGDJ EQUAL 7
 16314         GO TO 0994-STATE-NOT-FOUND,
 16315               8040-CNTL-NOT-OPEN
 16316         DEPENDING ON DFHEIGDI
 16317     ELSE IF DFHEIGDJ EQUAL 8
 16318         GO TO 8010-ARCH-NOT-OPEN,
 16319               1070-ARCH-NOT-FOUND,
 16320               1070-ARCH-NOT-FOUND
 16321         DEPENDING ON DFHEIGDI
 16322     ELSE IF DFHEIGDJ EQUAL 9
 16323         GO TO 2001-NOT-FOUND,
 16324               2001-NOT-FOUND,
 16325               8050-TEXT-NOT-OPEN
 16326         DEPENDING ON DFHEIGDI
 16327     ELSE IF DFHEIGDJ EQUAL 10
 16328         GO TO 2000-ENDBR
 16329         DEPENDING ON DFHEIGDI
 16330     ELSE IF DFHEIGDJ EQUAL 11
 16331         GO TO 8040-CNTL-NOT-OPEN,
 16332               6200-CNTL1-NOT-FOUND
 16333         DEPENDING ON DFHEIGDI
 16334     ELSE IF DFHEIGDJ EQUAL 12
 16335         GO TO 8040-CNTL-NOT-OPEN,
 16336               6250-CNTL2-NOT-FOUND
 16337         DEPENDING ON DFHEIGDI
 16338     ELSE IF DFHEIGDJ EQUAL 13
 16339         GO TO 8040-CNTL-NOT-OPEN,
 16340               6300-CNTL6-NOT-FOUND
 16341         DEPENDING ON DFHEIGDI
 16342     ELSE IF DFHEIGDJ EQUAL 14
 16343         GO TO 8040-CNTL-NOT-OPEN,
 16344               6350-CNTL2-NOT-FOUND
 16345         DEPENDING ON DFHEIGDI
 16346     ELSE IF DFHEIGDJ EQUAL 15
 16347         GO TO 8060-PNDB-NOT-OPEN,
 16348               8070-PNDB-NOT-FOUND
 16349         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 354
* EL689.cbl
 16350     ELSE IF DFHEIGDJ EQUAL 16
 16351         GO TO 8030-CERT-NOT-OPEN,
 16352               8035-CERT-NOT-FOUND
 16353         DEPENDING ON DFHEIGDI
 16354     ELSE IF DFHEIGDJ EQUAL 17
 16355         GO TO 8020-ACCT-NOT-OPEN,
 16356               6500-ACCT-NOT-FOUND,
 16357               6500-ONLY-STOP
 16358         DEPENDING ON DFHEIGDI
 16359     ELSE IF DFHEIGDJ EQUAL 18
 16360         GO TO 8080-COMP-NOT-OPEN,
 16361               6600-COMP-NOT-FOUND
 16362         DEPENDING ON DFHEIGDI
 16363     ELSE IF DFHEIGDJ EQUAL 19
 16364         GO TO 8040-CNTL-NOT-OPEN,
 16365               6630-CNTL2-NOT-FOUND
 16366         DEPENDING ON DFHEIGDI
 16367     ELSE IF DFHEIGDJ EQUAL 20
 16368         GO TO 8090-MAIL-NOT-OPEN,
 16369               6700-MAIL-NOT-FOUND
 16370         DEPENDING ON DFHEIGDI
 16371     ELSE IF DFHEIGDJ EQUAL 21
 16372         GO TO 8040-CNTL-NOT-OPEN,
 16373               6750-EXIT
 16374         DEPENDING ON DFHEIGDI
 16375     ELSE IF DFHEIGDJ EQUAL 22
 16376         GO TO 8040-CNTL-NOT-OPEN,
 16377               6800-EXIT
 16378         DEPENDING ON DFHEIGDI
 16379     ELSE IF DFHEIGDJ EQUAL 23
 16380         GO TO 8045-CHEK-NOT-OPEN,
 16381               6850-CHEK-NOT-FOUND
 16382         DEPENDING ON DFHEIGDI
 16383     ELSE IF DFHEIGDJ EQUAL 24
 16384         GO TO 8085-PYAJ-NOT-OPEN,
 16385               6900-PYAJ-NOT-FOUND
 16386         DEPENDING ON DFHEIGDI
 16387     ELSE IF DFHEIGDJ EQUAL 25
 16388         GO TO 7700-TS-ERROR,
 16389               7700-TS-ERROR
 16390         DEPENDING ON DFHEIGDI
 16391     ELSE IF DFHEIGDJ EQUAL 26
 16392         GO TO 7780-EXIT
 16393         DEPENDING ON DFHEIGDI
 16394     ELSE IF DFHEIGDJ EQUAL 27
 16395         GO TO 8040-CNTL-NOT-OPEN,
 16396               7945-NOT-FOUND
 16397         DEPENDING ON DFHEIGDI
 16398     ELSE IF DFHEIGDJ EQUAL 28
 16399         GO TO 7935-TERM-ERROR,
 16400               7940-TRAN-ERROR
 16401         DEPENDING ON DFHEIGDI
 16402     ELSE IF DFHEIGDJ EQUAL 29
 16403         GO TO 8010-ARCH-NOT-OPEN,
 16404               1070-ARCH-NOT-FOUND,
 16405               1070-ARCH-NOT-FOUND
 16406         DEPENDING ON DFHEIGDI
 16407     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 355
* EL689.cbl
 16408         GO TO 8300-SEND-TEXT
 16409         DEPENDING ON DFHEIGDI.
 16410     MOVE '9%                    "   ' TO DFHEIV0
 16411     MOVE 'EL689' TO DFHEIV1
 16412     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16413     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       97256     Code:       54126
